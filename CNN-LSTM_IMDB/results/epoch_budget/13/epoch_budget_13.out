Fri Mar  1 11:58:01 2024       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 545.23.08              Driver Version: 545.23.08    CUDA Version: 12.3     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA TITAN Xp                Off | 00000000:18:00.0 Off |                  N/A |
| 42%   70C    P0              91W / 250W |      0MiB / 12288MiB |      0%      Default |
|                                         |                      |                  N/A |
+-----------------------------------------+----------------------+----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
|  No running processes found                                                           |
+---------------------------------------------------------------------------------------+


* * * Run SGD for cluster size = 13. * * *


Budget: 38


* * * Run SGD for ID = 13_1. * * *


2024-03-01 11:58:01.767711: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 11:58:08.453494: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 11:58:08.455462: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-01 11:58:08.500608: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 11:58:08.500654: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 11:58:08.539337: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 11:58:08.539439: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 11:58:08.558030: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 11:58:08.612204: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 11:58:08.675180: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 11:58:08.690963: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 11:58:08.715418: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 11:58:08.716310: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 11:58:08.716425: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
<__array_function__ internals>:5: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:159: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_train, y_train = np.array(xs[:idx]), np.array(labels[:idx])
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:160: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_test, y_test = np.array(xs[idx:]), np.array(labels[idx:])
2024-03-01 11:58:15.798404: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-01 11:58:15.799113: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 11:58:15.799766: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 11:58:15.799824: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 11:58:15.799917: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 11:58:15.799941: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 11:58:15.799963: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 11:58:15.799983: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 11:58:15.800002: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 11:58:15.800023: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 11:58:15.800044: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 11:58:15.800703: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 11:58:15.800747: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 11:58:16.652077: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-01 11:58:16.652135: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-01 11:58:16.652146: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-01 11:58:16.653305: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:18:00.0, compute capability: 6.1)
{'id': '13_01', 'seed': 1, 'out_folder': 'results/epoch_budget', 'batch_size': 32, 'epochs': 38, 'validation_split': 0.2, 'checkpointing': True, 'initial_lr': 0.1, 'momentum': 0.98, 'nesterov': True, 'bootstrapping': False, 'map_optimizer': True, 'model': 'CNN-LSTM', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Loading data...
Pad sequences (samples x time)
20000 train sequences
5000 validation sequences
25000 test sequences
x_train shape: (20000, 100)
x_val shape: (5000, 100)
x_test shape: (25000, 100)
Using MAP optimizer with reg_weight:  5e-05
CNN-LSTM

0epoch [00:00, ?epoch/s]
  0%|          | 0/38 [00:00<?, ?epoch/s]2024-03-01 11:58:17.118446: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-01 11:58:17.130946: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-03-01 11:58:18.804177: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 11:58:19.061710: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 11:58:20.105059: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-01 11:58:20.168689: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.

  3%|▎         | 1/38 [00:19<12:16, 19.92s/epoch, loss=0.693, accuracy=0.597, val_loss=0.507, val_accuracy=0.797]
  5%|▌         | 2/38 [00:30<08:49, 14.71s/epoch, loss=0.481, accuracy=0.818, val_loss=0.472, val_accuracy=0.839]
  8%|▊         | 3/38 [00:40<07:12, 12.35s/epoch, loss=0.453, accuracy=0.849, val_loss=0.488, val_accuracy=0.828]
 11%|█         | 4/38 [00:50<06:24, 11.31s/epoch, loss=0.479, accuracy=0.857, val_loss=0.618, val_accuracy=0.789]
 13%|█▎        | 5/38 [00:59<05:50, 10.62s/epoch, loss=0.637, accuracy=0.813, val_loss=0.737, val_accuracy=0.775]
 16%|█▌        | 6/38 [01:09<05:27, 10.23s/epoch, loss=0.915, accuracy=0.697, val_loss=0.995, val_accuracy=0.655]
 18%|█▊        | 7/38 [01:18<05:07,  9.91s/epoch, loss=1.05, accuracy=0.607, val_loss=1.05, val_accuracy=0.619]  
 21%|██        | 8/38 [01:27<04:50,  9.69s/epoch, loss=1.08, accuracy=0.575, val_loss=1.1, val_accuracy=0.54]  
 24%|██▎       | 9/38 [01:37<04:39,  9.63s/epoch, loss=1.06, accuracy=0.567, val_loss=1.04, val_accuracy=0.59]
 26%|██▋       | 10/38 [01:46<04:30,  9.65s/epoch, loss=1.02, accuracy=0.591, val_loss=0.951, val_accuracy=0.64]
 29%|██▉       | 11/38 [01:56<04:19,  9.60s/epoch, loss=0.957, accuracy=0.597, val_loss=0.943, val_accuracy=0.573]
 32%|███▏      | 12/38 [02:05<04:09,  9.60s/epoch, loss=0.96, accuracy=0.594, val_loss=0.931, val_accuracy=0.614] 
 34%|███▍      | 13/38 [02:15<03:59,  9.56s/epoch, loss=0.944, accuracy=0.593, val_loss=0.988, val_accuracy=0.585]
 37%|███▋      | 14/38 [02:24<03:47,  9.46s/epoch, loss=0.943, accuracy=0.585, val_loss=0.982, val_accuracy=0.554]
 39%|███▉      | 15/38 [02:33<03:37,  9.44s/epoch, loss=0.948, accuracy=0.545, val_loss=0.91, val_accuracy=0.49]  
 42%|████▏     | 16/38 [02:43<03:27,  9.43s/epoch, loss=0.89, accuracy=0.612, val_loss=0.948, val_accuracy=0.566]
 45%|████▍     | 17/38 [02:52<03:18,  9.47s/epoch, loss=0.91, accuracy=0.615, val_loss=0.911, val_accuracy=0.617]
 47%|████▋     | 18/38 [03:02<03:09,  9.50s/epoch, loss=0.912, accuracy=0.612, val_loss=0.917, val_accuracy=0.621]
 50%|█████     | 19/38 [03:12<03:01,  9.57s/epoch, loss=0.894, accuracy=0.615, val_loss=0.869, val_accuracy=0.648]
 53%|█████▎    | 20/38 [03:21<02:51,  9.50s/epoch, loss=0.897, accuracy=0.612, val_loss=0.929, val_accuracy=0.614]
 55%|█████▌    | 21/38 [03:31<02:41,  9.48s/epoch, loss=0.885, accuracy=0.645, val_loss=0.906, val_accuracy=0.607]
 58%|█████▊    | 22/38 [03:40<02:31,  9.48s/epoch, loss=0.974, accuracy=0.628, val_loss=0.96, val_accuracy=0.652] 
 61%|██████    | 23/38 [03:50<02:22,  9.51s/epoch, loss=0.984, accuracy=0.608, val_loss=0.935, val_accuracy=0.638]
 63%|██████▎   | 24/38 [03:59<02:12,  9.47s/epoch, loss=0.953, accuracy=0.609, val_loss=0.951, val_accuracy=0.584]
 66%|██████▌   | 25/38 [04:08<02:02,  9.46s/epoch, loss=0.886, accuracy=0.637, val_loss=0.839, val_accuracy=0.652]
 68%|██████▊   | 26/38 [04:18<01:54,  9.51s/epoch, loss=0.86, accuracy=0.644, val_loss=0.915, val_accuracy=0.513] 
 71%|███████   | 27/38 [04:28<01:45,  9.55s/epoch, loss=0.881, accuracy=0.633, val_loss=0.918, val_accuracy=0.573]
 74%|███████▎  | 28/38 [04:37<01:35,  9.55s/epoch, loss=0.903, accuracy=0.612, val_loss=0.9, val_accuracy=0.638]  
 76%|███████▋  | 29/38 [04:47<01:25,  9.49s/epoch, loss=0.913, accuracy=0.612, val_loss=0.921, val_accuracy=0.593]
 79%|███████▉  | 30/38 [04:56<01:15,  9.41s/epoch, loss=0.921, accuracy=0.582, val_loss=0.884, val_accuracy=0.62] 
 82%|████████▏ | 31/38 [05:05<01:05,  9.39s/epoch, loss=0.888, accuracy=0.618, val_loss=0.852, val_accuracy=0.645]
 84%|████████▍ | 32/38 [05:14<00:56,  9.34s/epoch, loss=0.86, accuracy=0.634, val_loss=0.851, val_accuracy=0.634] 
 87%|████████▋ | 33/38 [05:24<00:46,  9.34s/epoch, loss=0.849, accuracy=0.629, val_loss=0.839, val_accuracy=0.636]
 89%|████████▉ | 34/38 [05:33<00:37,  9.42s/epoch, loss=0.852, accuracy=0.619, val_loss=0.863, val_accuracy=0.618]
 92%|█████████▏| 35/38 [05:43<00:28,  9.46s/epoch, loss=0.848, accuracy=0.638, val_loss=0.863, val_accuracy=0.587]
 95%|█████████▍| 36/38 [05:52<00:18,  9.47s/epoch, loss=0.832, accuracy=0.65, val_loss=0.854, val_accuracy=0.667] 
 97%|█████████▋| 37/38 [06:02<00:09,  9.52s/epoch, loss=0.813, accuracy=0.678, val_loss=0.841, val_accuracy=0.657]
100%|██████████| 38/38 [06:12<00:00,  9.59s/epoch, loss=0.811, accuracy=0.67, val_loss=0.823, val_accuracy=0.665] 
100%|██████████| 38/38 [06:12<00:00,  9.80s/epoch, loss=0.811, accuracy=0.67, val_loss=0.823, val_accuracy=0.665]
Test score: 0.47594961524009705
Test accuracy: 0.8332800269126892


* * * Run SGD for ID = 13_2. * * *


2024-03-01 12:04:38.754994: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 12:04:42.435250: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 12:04:42.436684: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-01 12:04:42.480567: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 12:04:42.480613: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 12:04:42.484237: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 12:04:42.484316: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 12:04:42.487062: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 12:04:42.487945: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 12:04:42.491011: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 12:04:42.492804: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 12:04:42.498855: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 12:04:42.499640: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 12:04:42.499735: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
<__array_function__ internals>:5: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:159: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_train, y_train = np.array(xs[:idx]), np.array(labels[:idx])
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:160: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_test, y_test = np.array(xs[idx:]), np.array(labels[idx:])
2024-03-01 12:04:49.871276: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-01 12:04:49.872087: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 12:04:49.873472: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 12:04:49.873513: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 12:04:49.873584: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 12:04:49.873605: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 12:04:49.873624: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 12:04:49.873643: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 12:04:49.873660: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 12:04:49.873679: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 12:04:49.873699: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 12:04:49.874313: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 12:04:49.874356: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 12:04:50.590868: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-01 12:04:50.590922: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-01 12:04:50.590945: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-01 12:04:50.592100: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:18:00.0, compute capability: 6.1)
{'id': '13_02', 'seed': 2, 'out_folder': 'results/epoch_budget', 'batch_size': 32, 'epochs': 38, 'validation_split': 0.2, 'checkpointing': True, 'initial_lr': 0.1, 'momentum': 0.98, 'nesterov': True, 'bootstrapping': False, 'map_optimizer': True, 'model': 'CNN-LSTM', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Loading data...
Pad sequences (samples x time)
20000 train sequences
5000 validation sequences
25000 test sequences
x_train shape: (20000, 100)
x_val shape: (5000, 100)
x_test shape: (25000, 100)
Using MAP optimizer with reg_weight:  5e-05
CNN-LSTM

0epoch [00:00, ?epoch/s]
  0%|          | 0/38 [00:00<?, ?epoch/s]2024-03-01 12:04:51.047996: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-01 12:04:51.060958: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-03-01 12:04:52.761913: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 12:04:52.995705: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 12:04:53.886019: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-01 12:04:53.939653: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.

  3%|▎         | 1/38 [00:16<10:08, 16.45s/epoch, loss=0.664, accuracy=0.634, val_loss=0.525, val_accuracy=0.771]
  5%|▌         | 2/38 [00:26<07:38, 12.73s/epoch, loss=0.479, accuracy=0.819, val_loss=0.462, val_accuracy=0.837]
  8%|▊         | 3/38 [00:36<06:38, 11.37s/epoch, loss=0.432, accuracy=0.858, val_loss=0.483, val_accuracy=0.835]
 11%|█         | 4/38 [00:45<06:00, 10.61s/epoch, loss=0.422, accuracy=0.877, val_loss=0.528, val_accuracy=0.836]
 13%|█▎        | 5/38 [00:55<05:43, 10.41s/epoch, loss=0.43, accuracy=0.888, val_loss=0.538, val_accuracy=0.84]  
 16%|█▌        | 6/38 [01:05<05:24, 10.13s/epoch, loss=0.444, accuracy=0.896, val_loss=0.579, val_accuracy=0.831]
 18%|█▊        | 7/38 [01:14<05:07,  9.93s/epoch, loss=0.468, accuracy=0.9, val_loss=0.623, val_accuracy=0.837]  
 21%|██        | 8/38 [01:24<04:54,  9.81s/epoch, loss=0.483, accuracy=0.906, val_loss=0.655, val_accuracy=0.832]
 24%|██▎       | 9/38 [01:34<04:42,  9.74s/epoch, loss=0.494, accuracy=0.913, val_loss=0.733, val_accuracy=0.828]
 26%|██▋       | 10/38 [01:43<04:31,  9.69s/epoch, loss=0.584, accuracy=0.888, val_loss=0.808, val_accuracy=0.8] 
 29%|██▉       | 11/38 [01:53<04:21,  9.69s/epoch, loss=0.91, accuracy=0.762, val_loss=1.15, val_accuracy=0.66] 
 32%|███▏      | 12/38 [02:02<04:08,  9.56s/epoch, loss=1.19, accuracy=0.64, val_loss=1.33, val_accuracy=0.613]
 34%|███▍      | 13/38 [02:11<03:52,  9.31s/epoch, loss=1.32, accuracy=0.556, val_loss=1.27, val_accuracy=0.509]
 37%|███▋      | 14/38 [02:19<03:36,  9.02s/epoch, loss=1.2, accuracy=0.539, val_loss=1.18, val_accuracy=0.51]  
 39%|███▉      | 15/38 [02:28<03:22,  8.82s/epoch, loss=1.09, accuracy=0.538, val_loss=1.03, val_accuracy=0.535]
 42%|████▏     | 16/38 [02:36<03:10,  8.67s/epoch, loss=1.01, accuracy=0.566, val_loss=0.97, val_accuracy=0.611]
 45%|████▍     | 17/38 [02:45<03:05,  8.82s/epoch, loss=0.961, accuracy=0.585, val_loss=0.918, val_accuracy=0.608]
 47%|████▋     | 18/38 [02:54<02:54,  8.75s/epoch, loss=0.921, accuracy=0.616, val_loss=0.903, val_accuracy=0.64] 
 50%|█████     | 19/38 [03:03<02:50,  8.96s/epoch, loss=0.901, accuracy=0.624, val_loss=0.93, val_accuracy=0.491]
 53%|█████▎    | 20/38 [03:12<02:42,  9.04s/epoch, loss=0.902, accuracy=0.635, val_loss=0.905, val_accuracy=0.614]
 55%|█████▌    | 21/38 [03:21<02:33,  9.03s/epoch, loss=0.937, accuracy=0.631, val_loss=0.989, val_accuracy=0.545]
 58%|█████▊    | 22/38 [03:30<02:24,  9.04s/epoch, loss=1.01, accuracy=0.536, val_loss=0.991, val_accuracy=0.554] 
 61%|██████    | 23/38 [03:39<02:15,  9.04s/epoch, loss=0.946, accuracy=0.569, val_loss=0.93, val_accuracy=0.574]
 63%|██████▎   | 24/38 [03:49<02:07,  9.13s/epoch, loss=0.932, accuracy=0.544, val_loss=0.91, val_accuracy=0.491]
 66%|██████▌   | 25/38 [03:58<01:59,  9.19s/epoch, loss=0.873, accuracy=0.562, val_loss=0.836, val_accuracy=0.616]
 68%|██████▊   | 26/38 [04:07<01:50,  9.17s/epoch, loss=0.837, accuracy=0.606, val_loss=0.796, val_accuracy=0.649]
 71%|███████   | 27/38 [04:17<01:41,  9.21s/epoch, loss=0.829, accuracy=0.645, val_loss=1.01, val_accuracy=0.564] 
 74%|███████▎  | 28/38 [04:26<01:32,  9.25s/epoch, loss=0.903, accuracy=0.648, val_loss=0.956, val_accuracy=0.602]
 76%|███████▋  | 29/38 [04:35<01:23,  9.31s/epoch, loss=0.993, accuracy=0.591, val_loss=0.981, val_accuracy=0.546]
 79%|███████▉  | 30/38 [04:44<01:13,  9.23s/epoch, loss=0.976, accuracy=0.551, val_loss=0.934, val_accuracy=0.586]
 82%|████████▏ | 31/38 [04:54<01:04,  9.21s/epoch, loss=0.928, accuracy=0.593, val_loss=0.887, val_accuracy=0.63] 
 84%|████████▍ | 32/38 [05:03<00:54,  9.16s/epoch, loss=0.91, accuracy=0.584, val_loss=1.04, val_accuracy=0.513] 
 87%|████████▋ | 33/38 [05:12<00:45,  9.19s/epoch, loss=0.885, accuracy=0.589, val_loss=0.881, val_accuracy=0.59]
 89%|████████▉ | 34/38 [05:21<00:36,  9.23s/epoch, loss=0.883, accuracy=0.61, val_loss=0.895, val_accuracy=0.592]
 92%|█████████▏| 35/38 [05:30<00:27,  9.18s/epoch, loss=0.903, accuracy=0.586, val_loss=0.878, val_accuracy=0.587]
 95%|█████████▍| 36/38 [05:39<00:18,  9.16s/epoch, loss=0.856, accuracy=0.605, val_loss=0.812, val_accuracy=0.67] 
 97%|█████████▋| 37/38 [05:49<00:09,  9.20s/epoch, loss=0.851, accuracy=0.611, val_loss=0.857, val_accuracy=0.616]
100%|██████████| 38/38 [05:58<00:00,  9.23s/epoch, loss=0.849, accuracy=0.59, val_loss=0.839, val_accuracy=0.6]   
100%|██████████| 38/38 [05:58<00:00,  9.43s/epoch, loss=0.849, accuracy=0.59, val_loss=0.839, val_accuracy=0.6]
Test score: 0.5342012643814087
Test accuracy: 0.8367999792098999


* * * Run SGD for ID = 13_3. * * *


2024-03-01 12:10:58.793645: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 12:11:02.441131: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 12:11:02.442547: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-01 12:11:02.486311: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 12:11:02.486382: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 12:11:02.490224: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 12:11:02.490326: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 12:11:02.492967: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 12:11:02.494174: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 12:11:02.497187: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 12:11:02.499164: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 12:11:02.505751: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 12:11:02.506558: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 12:11:02.506666: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
<__array_function__ internals>:5: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:159: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_train, y_train = np.array(xs[:idx]), np.array(labels[:idx])
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:160: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_test, y_test = np.array(xs[idx:]), np.array(labels[idx:])
2024-03-01 12:11:09.723668: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-01 12:11:09.724403: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 12:11:09.725725: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 12:11:09.725777: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 12:11:09.725858: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 12:11:09.725880: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 12:11:09.725897: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 12:11:09.725914: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 12:11:09.725935: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 12:11:09.725951: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 12:11:09.725968: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 12:11:09.726577: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 12:11:09.726627: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 12:11:10.441923: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-01 12:11:10.441979: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-01 12:11:10.441991: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-01 12:11:10.443160: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:18:00.0, compute capability: 6.1)
{'id': '13_03', 'seed': 3, 'out_folder': 'results/epoch_budget', 'batch_size': 32, 'epochs': 38, 'validation_split': 0.2, 'checkpointing': True, 'initial_lr': 0.1, 'momentum': 0.98, 'nesterov': True, 'bootstrapping': False, 'map_optimizer': True, 'model': 'CNN-LSTM', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Loading data...
Pad sequences (samples x time)
20000 train sequences
5000 validation sequences
25000 test sequences
x_train shape: (20000, 100)
x_val shape: (5000, 100)
x_test shape: (25000, 100)
Using MAP optimizer with reg_weight:  5e-05
CNN-LSTM

0epoch [00:00, ?epoch/s]
  0%|          | 0/38 [00:00<?, ?epoch/s]2024-03-01 12:11:10.898290: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-01 12:11:10.911951: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-03-01 12:11:12.598735: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 12:11:12.833815: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 12:11:13.708613: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-01 12:11:13.762701: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.

  3%|▎         | 1/38 [00:15<09:51, 15.98s/epoch, loss=0.638, accuracy=0.667, val_loss=0.502, val_accuracy=0.802]
  5%|▌         | 2/38 [00:25<07:24, 12.36s/epoch, loss=0.461, accuracy=0.833, val_loss=0.465, val_accuracy=0.83] 
  8%|▊         | 3/38 [00:35<06:26, 11.05s/epoch, loss=0.42, accuracy=0.866, val_loss=0.488, val_accuracy=0.84] 
 11%|█         | 4/38 [00:44<05:52, 10.38s/epoch, loss=0.424, accuracy=0.878, val_loss=0.55, val_accuracy=0.836]
 13%|█▎        | 5/38 [00:54<05:32, 10.08s/epoch, loss=0.492, accuracy=0.87, val_loss=0.652, val_accuracy=0.808]
 16%|█▌        | 6/38 [01:03<05:14,  9.82s/epoch, loss=0.81, accuracy=0.758, val_loss=1.09, val_accuracy=0.613] 
 18%|█▊        | 7/38 [01:12<04:58,  9.63s/epoch, loss=1.07, accuracy=0.673, val_loss=1.14, val_accuracy=0.568]
 21%|██        | 8/38 [01:21<04:44,  9.48s/epoch, loss=1.14, accuracy=0.573, val_loss=1.14, val_accuracy=0.606]
 24%|██▎       | 9/38 [01:31<04:31,  9.36s/epoch, loss=1.09, accuracy=0.561, val_loss=1.06, val_accuracy=0.493]
 26%|██▋       | 10/38 [01:40<04:20,  9.30s/epoch, loss=1.03, accuracy=0.577, val_loss=1.01, val_accuracy=0.529]
 29%|██▉       | 11/38 [01:49<04:10,  9.27s/epoch, loss=0.982, accuracy=0.592, val_loss=0.996, val_accuracy=0.607]
 32%|███▏      | 12/38 [01:58<04:01,  9.28s/epoch, loss=0.981, accuracy=0.559, val_loss=1.02, val_accuracy=0.53]  
 34%|███▍      | 13/38 [02:07<03:47,  9.09s/epoch, loss=0.951, accuracy=0.574, val_loss=0.948, val_accuracy=0.507]
 37%|███▋      | 14/38 [02:15<03:33,  8.89s/epoch, loss=1.03, accuracy=0.566, val_loss=1.06, val_accuracy=0.582]  
 39%|███▉      | 15/38 [02:24<03:20,  8.73s/epoch, loss=1, accuracy=0.577, val_loss=1.04, val_accuracy=0.564]   
 42%|████▏     | 16/38 [02:33<03:15,  8.87s/epoch, loss=0.978, accuracy=0.562, val_loss=1.01, val_accuracy=0.54]
 45%|████▍     | 17/38 [02:42<03:08,  8.97s/epoch, loss=0.962, accuracy=0.563, val_loss=1.05, val_accuracy=0.528]
 47%|████▋     | 18/38 [02:51<03:02,  9.11s/epoch, loss=0.986, accuracy=0.539, val_loss=0.932, val_accuracy=0.562]
 50%|█████     | 19/38 [03:01<02:56,  9.26s/epoch, loss=0.926, accuracy=0.559, val_loss=0.879, val_accuracy=0.591]
 53%|█████▎    | 20/38 [03:11<02:48,  9.34s/epoch, loss=0.888, accuracy=0.594, val_loss=0.84, val_accuracy=0.639] 
 55%|█████▌    | 21/38 [03:20<02:39,  9.37s/epoch, loss=0.852, accuracy=0.644, val_loss=0.858, val_accuracy=0.66]
 58%|█████▊    | 22/38 [03:30<02:30,  9.40s/epoch, loss=0.9, accuracy=0.604, val_loss=0.886, val_accuracy=0.623] 
 61%|██████    | 23/38 [03:39<02:20,  9.39s/epoch, loss=0.914, accuracy=0.594, val_loss=0.958, val_accuracy=0.494]
 63%|██████▎   | 24/38 [03:49<02:13,  9.50s/epoch, loss=0.863, accuracy=0.63, val_loss=0.899, val_accuracy=0.605] 
 66%|██████▌   | 25/38 [03:58<02:04,  9.56s/epoch, loss=0.883, accuracy=0.61, val_loss=0.842, val_accuracy=0.639]
 68%|██████▊   | 26/38 [04:08<01:54,  9.52s/epoch, loss=0.865, accuracy=0.625, val_loss=0.845, val_accuracy=0.656]
 71%|███████   | 27/38 [04:17<01:43,  9.42s/epoch, loss=0.866, accuracy=0.633, val_loss=0.91, val_accuracy=0.622] 
 74%|███████▎  | 28/38 [04:26<01:33,  9.35s/epoch, loss=0.884, accuracy=0.633, val_loss=0.917, val_accuracy=0.608]
 76%|███████▋  | 29/38 [04:35<01:23,  9.33s/epoch, loss=0.922, accuracy=0.595, val_loss=0.968, val_accuracy=0.531]
 79%|███████▉  | 30/38 [04:45<01:14,  9.33s/epoch, loss=2.2, accuracy=0.586, val_loss=3.18, val_accuracy=0.545]   
 82%|████████▏ | 31/38 [04:54<01:05,  9.33s/epoch, loss=2.81, accuracy=0.583, val_loss=2.5, val_accuracy=0.617]
 84%|████████▍ | 32/38 [05:03<00:55,  9.28s/epoch, loss=2.27, accuracy=0.583, val_loss=2.06, val_accuracy=0.6] 
 87%|████████▋ | 33/38 [05:12<00:46,  9.24s/epoch, loss=1.88, accuracy=0.589, val_loss=1.69, val_accuracy=0.631]
 89%|████████▉ | 34/38 [05:22<00:36,  9.24s/epoch, loss=1.54, accuracy=0.645, val_loss=1.44, val_accuracy=0.599]
 92%|█████████▏| 35/38 [05:31<00:27,  9.24s/epoch, loss=1.42, accuracy=0.634, val_loss=1.49, val_accuracy=0.623]
 95%|█████████▍| 36/38 [05:40<00:18,  9.22s/epoch, loss=1.39, accuracy=0.631, val_loss=1.31, val_accuracy=0.614]
 97%|█████████▋| 37/38 [05:49<00:09,  9.18s/epoch, loss=1.24, accuracy=0.65, val_loss=1.16, val_accuracy=0.656] 
100%|██████████| 38/38 [05:58<00:00,  9.15s/epoch, loss=1.14, accuracy=0.634, val_loss=1.11, val_accuracy=0.643]
100%|██████████| 38/38 [05:58<00:00,  9.44s/epoch, loss=1.14, accuracy=0.634, val_loss=1.11, val_accuracy=0.643]
Test score: 0.47363078594207764
Test accuracy: 0.846560001373291


* * * Run SGD for ID = 13_4. * * *


2024-03-01 12:17:18.999071: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 12:17:22.866489: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 12:17:22.867915: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-01 12:17:22.914230: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 12:17:22.914283: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 12:17:22.918092: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 12:17:22.918201: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 12:17:22.920865: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 12:17:22.921867: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 12:17:22.925152: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 12:17:22.927171: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 12:17:22.933651: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 12:17:22.934523: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 12:17:22.934646: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
<__array_function__ internals>:5: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:159: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_train, y_train = np.array(xs[:idx]), np.array(labels[:idx])
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:160: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_test, y_test = np.array(xs[idx:]), np.array(labels[idx:])
2024-03-01 12:17:30.282970: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-01 12:17:30.283611: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 12:17:30.284540: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 12:17:30.284588: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 12:17:30.284688: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 12:17:30.284708: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 12:17:30.284726: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 12:17:30.284742: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 12:17:30.284759: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 12:17:30.284776: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 12:17:30.284801: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 12:17:30.285409: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 12:17:30.285451: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 12:17:30.959153: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-01 12:17:30.959239: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-01 12:17:30.959251: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-01 12:17:30.960391: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:18:00.0, compute capability: 6.1)
{'id': '13_04', 'seed': 4, 'out_folder': 'results/epoch_budget', 'batch_size': 32, 'epochs': 38, 'validation_split': 0.2, 'checkpointing': True, 'initial_lr': 0.1, 'momentum': 0.98, 'nesterov': True, 'bootstrapping': False, 'map_optimizer': True, 'model': 'CNN-LSTM', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Loading data...
Pad sequences (samples x time)
20000 train sequences
5000 validation sequences
25000 test sequences
x_train shape: (20000, 100)
x_val shape: (5000, 100)
x_test shape: (25000, 100)
Using MAP optimizer with reg_weight:  5e-05
CNN-LSTM

0epoch [00:00, ?epoch/s]
  0%|          | 0/38 [00:00<?, ?epoch/s]2024-03-01 12:17:31.442759: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-01 12:17:31.454967: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-03-01 12:17:33.164483: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 12:17:33.398217: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 12:17:34.279729: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-01 12:17:34.339941: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.

  3%|▎         | 1/38 [00:16<10:11, 16.53s/epoch, loss=0.674, accuracy=0.618, val_loss=0.531, val_accuracy=0.786]
  5%|▌         | 2/38 [00:27<07:58, 13.28s/epoch, loss=0.48, accuracy=0.824, val_loss=0.452, val_accuracy=0.843] 
  8%|▊         | 3/38 [00:38<07:15, 12.44s/epoch, loss=0.436, accuracy=0.859, val_loss=0.479, val_accuracy=0.846]
 11%|█         | 4/38 [00:48<06:19, 11.16s/epoch, loss=0.444, accuracy=0.871, val_loss=0.509, val_accuracy=0.846]
 13%|█▎        | 5/38 [00:57<05:46, 10.49s/epoch, loss=0.484, accuracy=0.871, val_loss=0.637, val_accuracy=0.816]
 16%|█▌        | 6/38 [01:06<05:21, 10.03s/epoch, loss=0.647, accuracy=0.826, val_loss=0.828, val_accuracy=0.754]
 18%|█▊        | 7/38 [01:15<05:02,  9.77s/epoch, loss=0.879, accuracy=0.748, val_loss=0.995, val_accuracy=0.695]
 21%|██        | 8/38 [01:25<04:48,  9.62s/epoch, loss=1.06, accuracy=0.687, val_loss=1.05, val_accuracy=0.705]  
 24%|██▎       | 9/38 [01:34<04:35,  9.52s/epoch, loss=1.11, accuracy=0.645, val_loss=1.09, val_accuracy=0.687]
 26%|██▋       | 10/38 [01:43<04:24,  9.45s/epoch, loss=1.07, accuracy=0.671, val_loss=1.1, val_accuracy=0.603]
 29%|██▉       | 11/38 [01:52<04:07,  9.18s/epoch, loss=1.1, accuracy=0.63, val_loss=1.06, val_accuracy=0.643] 
 32%|███▏      | 12/38 [02:00<03:53,  8.97s/epoch, loss=1.06, accuracy=0.613, val_loss=1.05, val_accuracy=0.563]
 34%|███▍      | 13/38 [02:09<03:41,  8.88s/epoch, loss=1.04, accuracy=0.61, val_loss=1.02, val_accuracy=0.627] 
 37%|███▋      | 14/38 [02:18<03:33,  8.88s/epoch, loss=1.03, accuracy=0.629, val_loss=1.04, val_accuracy=0.621]
 39%|███▉      | 15/38 [02:27<03:25,  8.95s/epoch, loss=1.04, accuracy=0.585, val_loss=1, val_accuracy=0.609]   
 42%|████▏     | 16/38 [02:36<03:17,  8.99s/epoch, loss=0.985, accuracy=0.606, val_loss=1.02, val_accuracy=0.592]
 45%|████▍     | 17/38 [02:45<03:09,  9.01s/epoch, loss=0.957, accuracy=0.597, val_loss=0.965, val_accuracy=0.604]
 47%|████▋     | 18/38 [02:54<03:00,  9.04s/epoch, loss=0.988, accuracy=0.558, val_loss=0.962, val_accuracy=0.588]
 50%|█████     | 19/38 [03:03<02:52,  9.08s/epoch, loss=0.947, accuracy=0.58, val_loss=0.928, val_accuracy=0.595] 
 53%|█████▎    | 20/38 [03:13<02:45,  9.20s/epoch, loss=0.92, accuracy=0.582, val_loss=0.88, val_accuracy=0.599] 
 55%|█████▌    | 21/38 [03:22<02:37,  9.28s/epoch, loss=0.874, accuracy=0.61, val_loss=0.849, val_accuracy=0.656]
 58%|█████▊    | 22/38 [03:32<02:29,  9.33s/epoch, loss=0.858, accuracy=0.638, val_loss=0.853, val_accuracy=0.613]
 61%|██████    | 23/38 [03:41<02:20,  9.40s/epoch, loss=0.855, accuracy=0.644, val_loss=0.851, val_accuracy=0.676]
 63%|██████▎   | 24/38 [03:51<02:11,  9.41s/epoch, loss=0.874, accuracy=0.648, val_loss=0.89, val_accuracy=0.674] 
 66%|██████▌   | 25/38 [04:00<02:02,  9.44s/epoch, loss=0.902, accuracy=0.643, val_loss=0.922, val_accuracy=0.599]
 68%|██████▊   | 26/38 [04:10<01:53,  9.43s/epoch, loss=0.924, accuracy=0.629, val_loss=1.02, val_accuracy=0.512] 
 71%|███████   | 27/38 [04:19<01:43,  9.37s/epoch, loss=0.919, accuracy=0.602, val_loss=0.891, val_accuracy=0.629]
 74%|███████▎  | 28/38 [04:28<01:33,  9.37s/epoch, loss=0.901, accuracy=0.623, val_loss=0.941, val_accuracy=0.611]
 76%|███████▋  | 29/38 [04:38<01:24,  9.37s/epoch, loss=0.946, accuracy=0.613, val_loss=0.944, val_accuracy=0.604]
 79%|███████▉  | 30/38 [04:47<01:15,  9.38s/epoch, loss=0.948, accuracy=0.631, val_loss=0.967, val_accuracy=0.604]
 82%|████████▏ | 31/38 [04:56<01:05,  9.37s/epoch, loss=0.953, accuracy=0.608, val_loss=0.954, val_accuracy=0.627]
 84%|████████▍ | 32/38 [05:06<00:55,  9.30s/epoch, loss=0.921, accuracy=0.609, val_loss=0.902, val_accuracy=0.612]
 87%|████████▋ | 33/38 [05:15<00:46,  9.33s/epoch, loss=0.91, accuracy=0.619, val_loss=0.873, val_accuracy=0.631] 
 89%|████████▉ | 34/38 [05:24<00:37,  9.32s/epoch, loss=0.929, accuracy=0.589, val_loss=0.968, val_accuracy=0.511]
 92%|█████████▏| 35/38 [05:34<00:28,  9.35s/epoch, loss=0.893, accuracy=0.619, val_loss=0.871, val_accuracy=0.636]
 95%|█████████▍| 36/38 [05:43<00:18,  9.32s/epoch, loss=0.961, accuracy=0.602, val_loss=1.23, val_accuracy=0.62]  
 97%|█████████▋| 37/38 [05:52<00:09,  9.34s/epoch, loss=1.2, accuracy=0.632, val_loss=1.19, val_accuracy=0.662] 
100%|██████████| 38/38 [06:02<00:00,  9.34s/epoch, loss=1.21, accuracy=0.618, val_loss=1.23, val_accuracy=0.502]
100%|██████████| 38/38 [06:02<00:00,  9.53s/epoch, loss=1.21, accuracy=0.618, val_loss=1.23, val_accuracy=0.502]
Test score: 0.48772281408309937
Test accuracy: 0.8420799970626831


* * * Run SGD for ID = 13_5. * * *


2024-03-01 12:23:44.321254: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 12:23:53.486103: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 12:23:53.487938: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-01 12:23:53.532925: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 12:23:53.532988: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 12:23:53.538391: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 12:23:53.538506: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 12:23:53.542443: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 12:23:53.544483: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 12:23:53.548173: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 12:23:53.550594: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 12:23:53.557729: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 12:23:53.558840: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 12:23:53.558988: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
<__array_function__ internals>:5: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:159: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_train, y_train = np.array(xs[:idx]), np.array(labels[:idx])
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:160: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_test, y_test = np.array(xs[idx:]), np.array(labels[idx:])
2024-03-01 12:24:01.008345: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-01 12:24:01.009043: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 12:24:01.010473: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 12:24:01.010521: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 12:24:01.010632: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 12:24:01.010660: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 12:24:01.010682: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 12:24:01.010713: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 12:24:01.010736: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 12:24:01.010761: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 12:24:01.010784: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 12:24:01.011402: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 12:24:01.011444: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 12:24:01.745091: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-01 12:24:01.745148: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-01 12:24:01.745161: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-01 12:24:01.746484: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:18:00.0, compute capability: 6.1)
{'id': '13_05', 'seed': 5, 'out_folder': 'results/epoch_budget', 'batch_size': 32, 'epochs': 38, 'validation_split': 0.2, 'checkpointing': True, 'initial_lr': 0.1, 'momentum': 0.98, 'nesterov': True, 'bootstrapping': False, 'map_optimizer': True, 'model': 'CNN-LSTM', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Loading data...
Pad sequences (samples x time)
20000 train sequences
5000 validation sequences
25000 test sequences
x_train shape: (20000, 100)
x_val shape: (5000, 100)
x_test shape: (25000, 100)
Using MAP optimizer with reg_weight:  5e-05
CNN-LSTM

0epoch [00:00, ?epoch/s]
  0%|          | 0/38 [00:00<?, ?epoch/s]2024-03-01 12:24:02.222190: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-01 12:24:02.234991: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-03-01 12:24:03.957203: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 12:24:04.182175: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 12:24:05.085212: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-01 12:24:05.272465: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.

  3%|▎         | 1/38 [00:19<12:06, 19.62s/epoch, loss=0.731, accuracy=0.54, val_loss=0.624, val_accuracy=0.717]
  5%|▌         | 2/38 [00:29<08:18, 13.84s/epoch, loss=0.544, accuracy=0.778, val_loss=0.513, val_accuracy=0.799]
  8%|▊         | 3/38 [00:39<07:01, 12.03s/epoch, loss=0.452, accuracy=0.842, val_loss=0.479, val_accuracy=0.832]
 11%|█         | 4/38 [00:48<06:11, 10.93s/epoch, loss=0.447, accuracy=0.858, val_loss=0.518, val_accuracy=0.82] 
 13%|█▎        | 5/38 [00:57<05:39, 10.30s/epoch, loss=0.441, accuracy=0.877, val_loss=0.592, val_accuracy=0.818]
 16%|█▌        | 6/38 [01:07<05:19,  9.98s/epoch, loss=0.447, accuracy=0.886, val_loss=0.612, val_accuracy=0.824]
 18%|█▊        | 7/38 [01:15<04:57,  9.61s/epoch, loss=0.458, accuracy=0.898, val_loss=0.623, val_accuracy=0.829]
 21%|██        | 8/38 [01:24<04:35,  9.17s/epoch, loss=0.508, accuracy=0.892, val_loss=0.682, val_accuracy=0.825]
 24%|██▎       | 9/38 [01:32<04:18,  8.90s/epoch, loss=0.639, accuracy=0.853, val_loss=0.904, val_accuracy=0.733]
 26%|██▋       | 10/38 [01:40<04:04,  8.74s/epoch, loss=1.08, accuracy=0.659, val_loss=1.29, val_accuracy=0.527] 
 29%|██▉       | 11/38 [01:49<03:57,  8.80s/epoch, loss=1.15, accuracy=0.6, val_loss=1.15, val_accuracy=0.594]  
 32%|███▏      | 12/38 [01:58<03:49,  8.82s/epoch, loss=1.11, accuracy=0.586, val_loss=1.05, val_accuracy=0.598]
 34%|███▍      | 13/38 [02:07<03:40,  8.81s/epoch, loss=1.02, accuracy=0.62, val_loss=1.04, val_accuracy=0.517] 
 37%|███▋      | 14/38 [02:16<03:31,  8.82s/epoch, loss=1.02, accuracy=0.596, val_loss=1.02, val_accuracy=0.553]
 39%|███▉      | 15/38 [02:25<03:23,  8.84s/epoch, loss=1.07, accuracy=0.588, val_loss=1.13, val_accuracy=0.556]
 42%|████▏     | 16/38 [02:34<03:14,  8.86s/epoch, loss=1.11, accuracy=0.571, val_loss=1.06, val_accuracy=0.609]
 45%|████▍     | 17/38 [02:42<03:06,  8.87s/epoch, loss=1.06, accuracy=0.597, val_loss=1.14, val_accuracy=0.571]
 47%|████▋     | 18/38 [02:51<02:57,  8.86s/epoch, loss=1.06, accuracy=0.547, val_loss=1.03, val_accuracy=0.512]
 50%|█████     | 19/38 [03:00<02:49,  8.92s/epoch, loss=1.03, accuracy=0.545, val_loss=1.04, val_accuracy=0.591]
 53%|█████▎    | 20/38 [03:09<02:40,  8.92s/epoch, loss=0.967, accuracy=0.575, val_loss=0.934, val_accuracy=0.616]
 55%|█████▌    | 21/38 [03:18<02:31,  8.90s/epoch, loss=1.04, accuracy=0.59, val_loss=2.41, val_accuracy=0.671]   
 58%|█████▊    | 22/38 [03:27<02:22,  8.90s/epoch, loss=2.7, accuracy=0.601, val_loss=2.56, val_accuracy=0.533]
 61%|██████    | 23/38 [03:36<02:13,  8.89s/epoch, loss=2.26, accuracy=0.549, val_loss=2.05, val_accuracy=0.585]
 63%|██████▎   | 24/38 [03:45<02:04,  8.89s/epoch, loss=1.84, accuracy=0.606, val_loss=1.69, val_accuracy=0.609]
 66%|██████▌   | 25/38 [03:54<01:55,  8.87s/epoch, loss=1.58, accuracy=0.624, val_loss=1.48, val_accuracy=0.643]
 68%|██████▊   | 26/38 [04:02<01:46,  8.88s/epoch, loss=1.58, accuracy=0.583, val_loss=1.7, val_accuracy=0.635] 
 71%|███████   | 27/38 [04:11<01:37,  8.87s/epoch, loss=1.65, accuracy=0.534, val_loss=1.54, val_accuracy=0.515]
 74%|███████▎  | 28/38 [04:20<01:28,  8.87s/epoch, loss=1.45, accuracy=0.557, val_loss=1.43, val_accuracy=0.605]
 76%|███████▋  | 29/38 [04:29<01:19,  8.88s/epoch, loss=1.38, accuracy=0.591, val_loss=1.3, val_accuracy=0.615] 
 79%|███████▉  | 30/38 [04:38<01:11,  8.90s/epoch, loss=1.23, accuracy=0.585, val_loss=1.18, val_accuracy=0.593]
 82%|████████▏ | 31/38 [04:47<01:02,  8.89s/epoch, loss=1.08, accuracy=0.623, val_loss=0.996, val_accuracy=0.691]
 84%|████████▍ | 32/38 [04:56<00:53,  8.87s/epoch, loss=1.05, accuracy=0.614, val_loss=1.05, val_accuracy=0.6]   
 87%|████████▋ | 33/38 [05:05<00:44,  8.91s/epoch, loss=0.993, accuracy=0.632, val_loss=0.95, val_accuracy=0.631]
 89%|████████▉ | 34/38 [05:14<00:35,  8.88s/epoch, loss=0.958, accuracy=0.625, val_loss=1.08, val_accuracy=0.493]
 92%|█████████▏| 35/38 [05:22<00:26,  8.86s/epoch, loss=1.05, accuracy=0.625, val_loss=1.12, val_accuracy=0.596] 
 95%|█████████▍| 36/38 [05:31<00:17,  8.85s/epoch, loss=1.03, accuracy=0.645, val_loss=1.03, val_accuracy=0.641]
 97%|█████████▋| 37/38 [05:40<00:08,  8.85s/epoch, loss=0.995, accuracy=0.641, val_loss=1.01, val_accuracy=0.605]
100%|██████████| 38/38 [05:49<00:00,  8.82s/epoch, loss=0.943, accuracy=0.639, val_loss=0.931, val_accuracy=0.64]
100%|██████████| 38/38 [05:49<00:00,  9.19s/epoch, loss=0.943, accuracy=0.639, val_loss=0.931, val_accuracy=0.64]
Test score: 0.47104284167289734
Test accuracy: 0.8374800086021423


* * * Run SGD for ID = 13_6. * * *


2024-03-01 12:30:02.418357: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 12:30:05.985640: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 12:30:05.987202: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-01 12:30:06.030105: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 12:30:06.030151: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 12:30:06.034072: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 12:30:06.034168: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 12:30:06.037185: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 12:30:06.038067: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 12:30:06.041367: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 12:30:06.043380: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 12:30:06.050478: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 12:30:06.051393: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 12:30:06.051498: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
<__array_function__ internals>:5: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:159: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_train, y_train = np.array(xs[:idx]), np.array(labels[:idx])
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:160: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_test, y_test = np.array(xs[idx:]), np.array(labels[idx:])
2024-03-01 12:30:12.992617: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-01 12:30:12.993222: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 12:30:12.993868: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 12:30:12.993905: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 12:30:12.993972: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 12:30:12.993990: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 12:30:12.994007: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 12:30:12.994024: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 12:30:12.994041: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 12:30:12.994058: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 12:30:12.994075: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 12:30:12.994665: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 12:30:12.994703: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 12:30:13.627375: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-01 12:30:13.627448: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-01 12:30:13.627460: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-01 12:30:13.628667: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:18:00.0, compute capability: 6.1)
{'id': '13_06', 'seed': 6, 'out_folder': 'results/epoch_budget', 'batch_size': 32, 'epochs': 38, 'validation_split': 0.2, 'checkpointing': True, 'initial_lr': 0.1, 'momentum': 0.98, 'nesterov': True, 'bootstrapping': False, 'map_optimizer': True, 'model': 'CNN-LSTM', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Loading data...
Pad sequences (samples x time)
20000 train sequences
5000 validation sequences
25000 test sequences
x_train shape: (20000, 100)
x_val shape: (5000, 100)
x_test shape: (25000, 100)
Using MAP optimizer with reg_weight:  5e-05
CNN-LSTM

0epoch [00:00, ?epoch/s]
  0%|          | 0/38 [00:00<?, ?epoch/s]2024-03-01 12:30:14.086454: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-01 12:30:14.098947: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-03-01 12:30:15.763242: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 12:30:15.990676: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 12:30:16.845123: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-01 12:30:16.896466: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.

  3%|▎         | 1/38 [00:16<09:55, 16.10s/epoch, loss=0.635, accuracy=0.663, val_loss=0.483, val_accuracy=0.812]
  5%|▌         | 2/38 [00:25<07:19, 12.21s/epoch, loss=0.462, accuracy=0.835, val_loss=0.452, val_accuracy=0.844]
  8%|▊         | 3/38 [00:34<06:16, 10.77s/epoch, loss=0.432, accuracy=0.862, val_loss=0.493, val_accuracy=0.839]
 11%|█         | 4/38 [00:43<05:41, 10.04s/epoch, loss=0.436, accuracy=0.878, val_loss=0.544, val_accuracy=0.836]
 13%|█▎        | 5/38 [00:52<05:12,  9.47s/epoch, loss=0.448, accuracy=0.885, val_loss=0.565, val_accuracy=0.838]
 16%|█▌        | 6/38 [01:00<04:50,  9.07s/epoch, loss=0.506, accuracy=0.878, val_loss=0.725, val_accuracy=0.79] 
 18%|█▊        | 7/38 [01:08<04:35,  8.88s/epoch, loss=0.827, accuracy=0.758, val_loss=0.994, val_accuracy=0.657]
 21%|██        | 8/38 [01:17<04:24,  8.83s/epoch, loss=1.05, accuracy=0.655, val_loss=1.1, val_accuracy=0.613]   
 24%|██▎       | 9/38 [01:26<04:15,  8.82s/epoch, loss=1.07, accuracy=0.614, val_loss=0.999, val_accuracy=0.663]
 26%|██▋       | 10/38 [01:35<04:06,  8.80s/epoch, loss=1.04, accuracy=0.597, val_loss=1.05, val_accuracy=0.537]
 29%|██▉       | 11/38 [01:43<03:56,  8.77s/epoch, loss=1.02, accuracy=0.583, val_loss=1.01, val_accuracy=0.515]
 32%|███▏      | 12/38 [01:52<03:48,  8.78s/epoch, loss=0.992, accuracy=0.556, val_loss=1.07, val_accuracy=0.487]
 34%|███▍      | 13/38 [02:01<03:40,  8.81s/epoch, loss=0.929, accuracy=0.55, val_loss=0.876, val_accuracy=0.604]
 37%|███▋      | 14/38 [02:10<03:31,  8.83s/epoch, loss=0.866, accuracy=0.596, val_loss=0.863, val_accuracy=0.488]
 39%|███▉      | 15/38 [02:19<03:22,  8.82s/epoch, loss=0.819, accuracy=0.633, val_loss=0.798, val_accuracy=0.666]
 42%|████▏     | 16/38 [02:28<03:14,  8.83s/epoch, loss=0.841, accuracy=0.628, val_loss=0.873, val_accuracy=0.619]
 45%|████▍     | 17/38 [02:36<03:05,  8.81s/epoch, loss=0.846, accuracy=0.625, val_loss=0.892, val_accuracy=0.654]
 47%|████▋     | 18/38 [02:45<02:56,  8.81s/epoch, loss=0.869, accuracy=0.645, val_loss=0.913, val_accuracy=0.661]
 50%|█████     | 19/38 [02:54<02:47,  8.81s/epoch, loss=0.943, accuracy=0.638, val_loss=0.986, val_accuracy=0.563]
 53%|█████▎    | 20/38 [03:03<02:39,  8.85s/epoch, loss=0.948, accuracy=0.616, val_loss=0.905, val_accuracy=0.677]
 55%|█████▌    | 21/38 [03:12<02:30,  8.85s/epoch, loss=0.931, accuracy=0.628, val_loss=0.935, val_accuracy=0.574]
 58%|█████▊    | 22/38 [03:21<02:21,  8.87s/epoch, loss=0.939, accuracy=0.62, val_loss=0.909, val_accuracy=0.65]  
 61%|██████    | 23/38 [03:29<02:13,  8.87s/epoch, loss=0.947, accuracy=0.599, val_loss=0.941, val_accuracy=0.591]
 63%|██████▎   | 24/38 [03:38<02:04,  8.86s/epoch, loss=1.03, accuracy=0.574, val_loss=1.07, val_accuracy=0.488]  
 66%|██████▌   | 25/38 [03:47<01:54,  8.85s/epoch, loss=0.979, accuracy=0.595, val_loss=0.954, val_accuracy=0.571]
 68%|██████▊   | 26/38 [03:56<01:46,  8.87s/epoch, loss=0.938, accuracy=0.613, val_loss=0.942, val_accuracy=0.621]
 71%|███████   | 27/38 [04:05<01:37,  8.86s/epoch, loss=0.932, accuracy=0.62, val_loss=0.931, val_accuracy=0.591] 
 74%|███████▎  | 28/38 [04:14<01:28,  8.87s/epoch, loss=0.929, accuracy=0.613, val_loss=0.946, val_accuracy=0.597]
 76%|███████▋  | 29/38 [04:23<01:19,  8.87s/epoch, loss=0.929, accuracy=0.585, val_loss=0.88, val_accuracy=0.631] 
 79%|███████▉  | 30/38 [04:31<01:10,  8.83s/epoch, loss=1.01, accuracy=0.602, val_loss=1.05, val_accuracy=0.598] 
 82%|████████▏ | 31/38 [04:40<01:01,  8.83s/epoch, loss=0.979, accuracy=0.587, val_loss=0.954, val_accuracy=0.594]
 84%|████████▍ | 32/38 [04:49<00:52,  8.83s/epoch, loss=0.917, accuracy=0.63, val_loss=0.915, val_accuracy=0.572] 
 87%|████████▋ | 33/38 [04:58<00:44,  8.85s/epoch, loss=0.911, accuracy=0.608, val_loss=0.892, val_accuracy=0.635]
 89%|████████▉ | 34/38 [05:07<00:35,  8.84s/epoch, loss=0.889, accuracy=0.612, val_loss=0.878, val_accuracy=0.613]
 92%|█████████▏| 35/38 [05:16<00:26,  8.85s/epoch, loss=0.886, accuracy=0.62, val_loss=0.889, val_accuracy=0.597] 
 95%|█████████▍| 36/38 [05:24<00:17,  8.85s/epoch, loss=0.941, accuracy=0.638, val_loss=0.942, val_accuracy=0.66]
 97%|█████████▋| 37/38 [05:33<00:08,  8.83s/epoch, loss=0.984, accuracy=0.604, val_loss=0.961, val_accuracy=0.623]
100%|██████████| 38/38 [05:42<00:00,  8.85s/epoch, loss=0.959, accuracy=0.582, val_loss=0.915, val_accuracy=0.618]
100%|██████████| 38/38 [05:42<00:00,  9.02s/epoch, loss=0.959, accuracy=0.582, val_loss=0.915, val_accuracy=0.618]
Test score: 0.44838446378707886
Test accuracy: 0.8409199714660645


* * * Run SGD for ID = 13_7. * * *


2024-03-01 12:36:05.762840: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 12:36:09.421079: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 12:36:09.422415: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-01 12:36:09.465748: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 12:36:09.465796: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 12:36:09.469537: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 12:36:09.469614: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 12:36:09.472442: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 12:36:09.473870: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 12:36:09.477153: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 12:36:09.479205: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 12:36:09.486291: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 12:36:09.487185: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 12:36:09.487285: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
<__array_function__ internals>:5: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:159: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_train, y_train = np.array(xs[:idx]), np.array(labels[:idx])
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:160: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_test, y_test = np.array(xs[idx:]), np.array(labels[idx:])
2024-03-01 12:36:16.566237: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-01 12:36:16.566884: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 12:36:16.567577: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 12:36:16.567621: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 12:36:16.567679: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 12:36:16.567697: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 12:36:16.567715: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 12:36:16.567733: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 12:36:16.567750: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 12:36:16.567768: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 12:36:16.567786: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 12:36:16.568398: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 12:36:16.568453: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 12:36:17.270254: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-01 12:36:17.270333: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-01 12:36:17.270345: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-01 12:36:17.272221: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:18:00.0, compute capability: 6.1)
{'id': '13_07', 'seed': 7, 'out_folder': 'results/epoch_budget', 'batch_size': 32, 'epochs': 38, 'validation_split': 0.2, 'checkpointing': True, 'initial_lr': 0.1, 'momentum': 0.98, 'nesterov': True, 'bootstrapping': False, 'map_optimizer': True, 'model': 'CNN-LSTM', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Loading data...
Pad sequences (samples x time)
20000 train sequences
5000 validation sequences
25000 test sequences
x_train shape: (20000, 100)
x_val shape: (5000, 100)
x_test shape: (25000, 100)
Using MAP optimizer with reg_weight:  5e-05
CNN-LSTM

0epoch [00:00, ?epoch/s]
  0%|          | 0/38 [00:00<?, ?epoch/s]2024-03-01 12:36:17.744147: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-01 12:36:17.756024: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-03-01 12:36:19.435759: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 12:36:19.645650: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 12:36:20.499008: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-01 12:36:20.587003: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.

  3%|▎         | 1/38 [00:17<10:42, 17.37s/epoch, loss=0.696, accuracy=0.594, val_loss=0.514, val_accuracy=0.79]
  5%|▌         | 2/38 [00:27<07:50, 13.08s/epoch, loss=0.48, accuracy=0.819, val_loss=0.485, val_accuracy=0.818]
  8%|▊         | 3/38 [00:36<06:36, 11.33s/epoch, loss=0.433, accuracy=0.857, val_loss=0.459, val_accuracy=0.849]
 11%|█         | 4/38 [00:45<05:47, 10.23s/epoch, loss=0.42, accuracy=0.873, val_loss=0.497, val_accuracy=0.84]  
 13%|█▎        | 5/38 [00:53<05:20,  9.70s/epoch, loss=0.418, accuracy=0.889, val_loss=0.557, val_accuracy=0.834]
 16%|█▌        | 6/38 [01:02<05:02,  9.45s/epoch, loss=0.432, accuracy=0.895, val_loss=0.588, val_accuracy=0.837]
 18%|█▊        | 7/38 [01:12<04:51,  9.39s/epoch, loss=0.527, accuracy=0.874, val_loss=0.781, val_accuracy=0.779]
 21%|██        | 8/38 [01:21<04:40,  9.35s/epoch, loss=0.956, accuracy=0.713, val_loss=1.13, val_accuracy=0.645] 
 24%|██▎       | 9/38 [01:30<04:29,  9.31s/epoch, loss=1.08, accuracy=0.636, val_loss=1.15, val_accuracy=0.537] 
 26%|██▋       | 10/38 [01:40<04:21,  9.33s/epoch, loss=1.09, accuracy=0.631, val_loss=1.13, val_accuracy=0.551]
 29%|██▉       | 11/38 [01:49<04:13,  9.37s/epoch, loss=1.11, accuracy=0.586, val_loss=1.07, val_accuracy=0.622]
 32%|███▏      | 12/38 [01:58<04:02,  9.31s/epoch, loss=1.02, accuracy=0.624, val_loss=1.06, val_accuracy=0.605]
 34%|███▍      | 13/38 [02:07<03:51,  9.27s/epoch, loss=1.04, accuracy=0.613, val_loss=1.05, val_accuracy=0.589]
 37%|███▋      | 14/38 [02:17<03:42,  9.25s/epoch, loss=1.03, accuracy=0.599, val_loss=1.02, val_accuracy=0.539]
 39%|███▉      | 15/38 [02:26<03:33,  9.26s/epoch, loss=1.01, accuracy=0.554, val_loss=0.991, val_accuracy=0.561]
 42%|████▏     | 16/38 [02:35<03:24,  9.32s/epoch, loss=0.949, accuracy=0.581, val_loss=0.919, val_accuracy=0.614]
 45%|████▍     | 17/38 [02:45<03:15,  9.30s/epoch, loss=0.954, accuracy=0.59, val_loss=0.976, val_accuracy=0.585] 
 47%|████▋     | 18/38 [02:54<03:05,  9.26s/epoch, loss=0.96, accuracy=0.557, val_loss=0.905, val_accuracy=0.587]
 50%|█████     | 19/38 [03:03<02:56,  9.27s/epoch, loss=1.11, accuracy=0.596, val_loss=1.12, val_accuracy=0.657] 
 53%|█████▎    | 20/38 [03:12<02:47,  9.30s/epoch, loss=1.11, accuracy=0.589, val_loss=1.06, val_accuracy=0.498]
 55%|█████▌    | 21/38 [03:22<02:38,  9.33s/epoch, loss=1.01, accuracy=0.621, val_loss=0.972, val_accuracy=0.613]
 58%|█████▊    | 22/38 [03:31<02:29,  9.35s/epoch, loss=0.993, accuracy=0.614, val_loss=1.01, val_accuracy=0.512]
 61%|██████    | 23/38 [03:41<02:20,  9.37s/epoch, loss=0.965, accuracy=0.623, val_loss=0.944, val_accuracy=0.574]
 63%|██████▎   | 24/38 [03:50<02:10,  9.30s/epoch, loss=0.938, accuracy=0.61, val_loss=0.925, val_accuracy=0.646] 
 66%|██████▌   | 25/38 [03:59<02:00,  9.29s/epoch, loss=0.914, accuracy=0.623, val_loss=0.95, val_accuracy=0.628]
 68%|██████▊   | 26/38 [04:08<01:51,  9.29s/epoch, loss=0.917, accuracy=0.625, val_loss=1, val_accuracy=0.595]   
 71%|███████   | 27/38 [04:18<01:42,  9.30s/epoch, loss=0.929, accuracy=0.633, val_loss=0.961, val_accuracy=0.628]
 74%|███████▎  | 28/38 [04:27<01:33,  9.34s/epoch, loss=0.932, accuracy=0.603, val_loss=0.929, val_accuracy=0.55] 
 76%|███████▋  | 29/38 [04:36<01:23,  9.27s/epoch, loss=0.929, accuracy=0.579, val_loss=0.946, val_accuracy=0.504]
 79%|███████▉  | 30/38 [04:45<01:13,  9.23s/epoch, loss=0.914, accuracy=0.569, val_loss=0.877, val_accuracy=0.555]
 82%|████████▏ | 31/38 [04:55<01:04,  9.23s/epoch, loss=0.9, accuracy=0.559, val_loss=0.897, val_accuracy=0.502]  
 84%|████████▍ | 32/38 [05:04<00:55,  9.21s/epoch, loss=1.02, accuracy=0.537, val_loss=1.04, val_accuracy=0.502]
 87%|████████▋ | 33/38 [05:13<00:46,  9.25s/epoch, loss=0.977, accuracy=0.585, val_loss=0.957, val_accuracy=0.607]
 89%|████████▉ | 34/38 [05:23<00:37,  9.32s/epoch, loss=0.889, accuracy=0.641, val_loss=0.855, val_accuracy=0.622]
 92%|█████████▏| 35/38 [05:32<00:28,  9.34s/epoch, loss=0.865, accuracy=0.632, val_loss=0.854, val_accuracy=0.597]
 95%|█████████▍| 36/38 [05:41<00:18,  9.30s/epoch, loss=0.829, accuracy=0.666, val_loss=0.844, val_accuracy=0.647]
 97%|█████████▋| 37/38 [05:50<00:09,  9.31s/epoch, loss=0.869, accuracy=0.643, val_loss=0.916, val_accuracy=0.594]
100%|██████████| 38/38 [06:00<00:00,  9.35s/epoch, loss=0.926, accuracy=0.606, val_loss=0.898, val_accuracy=0.639]
100%|██████████| 38/38 [06:00<00:00,  9.48s/epoch, loss=0.926, accuracy=0.606, val_loss=0.898, val_accuracy=0.639]
Test score: 0.45560508966445923
Test accuracy: 0.8451200127601624


* * * Run SGD for ID = 13_8. * * *


2024-03-01 12:42:28.525028: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 12:42:32.317834: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 12:42:32.319676: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-01 12:42:32.365476: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 12:42:32.365532: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 12:42:32.369588: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 12:42:32.369724: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 12:42:32.373313: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 12:42:32.374305: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 12:42:32.377727: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 12:42:32.380035: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 12:42:32.387522: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 12:42:32.388514: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 12:42:32.388642: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
<__array_function__ internals>:5: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:159: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_train, y_train = np.array(xs[:idx]), np.array(labels[:idx])
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:160: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_test, y_test = np.array(xs[idx:]), np.array(labels[idx:])
2024-03-01 12:42:39.666374: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-01 12:42:39.666949: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 12:42:39.667869: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 12:42:39.667917: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 12:42:39.668019: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 12:42:39.668038: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 12:42:39.668055: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 12:42:39.668074: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 12:42:39.668091: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 12:42:39.668107: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 12:42:39.668124: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 12:42:39.668724: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 12:42:39.668767: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 12:42:40.318344: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-01 12:42:40.318427: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-01 12:42:40.318439: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-01 12:42:40.319770: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:18:00.0, compute capability: 6.1)
{'id': '13_08', 'seed': 8, 'out_folder': 'results/epoch_budget', 'batch_size': 32, 'epochs': 38, 'validation_split': 0.2, 'checkpointing': True, 'initial_lr': 0.1, 'momentum': 0.98, 'nesterov': True, 'bootstrapping': False, 'map_optimizer': True, 'model': 'CNN-LSTM', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Loading data...
Pad sequences (samples x time)
20000 train sequences
5000 validation sequences
25000 test sequences
x_train shape: (20000, 100)
x_val shape: (5000, 100)
x_test shape: (25000, 100)
Using MAP optimizer with reg_weight:  5e-05
CNN-LSTM

0epoch [00:00, ?epoch/s]
  0%|          | 0/38 [00:00<?, ?epoch/s]2024-03-01 12:42:40.781069: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-01 12:42:40.793031: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-03-01 12:42:42.443572: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 12:42:42.656975: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 12:42:43.515469: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-01 12:42:43.572316: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.

  3%|▎         | 1/38 [00:16<09:58, 16.18s/epoch, loss=0.731, accuracy=0.546, val_loss=0.606, val_accuracy=0.72]
  5%|▌         | 2/38 [00:25<07:18, 12.19s/epoch, loss=0.494, accuracy=0.802, val_loss=0.452, val_accuracy=0.834]
  8%|▊         | 3/38 [00:34<06:21, 10.89s/epoch, loss=0.426, accuracy=0.856, val_loss=0.504, val_accuracy=0.807]
 11%|█         | 4/38 [00:43<05:44, 10.13s/epoch, loss=0.416, accuracy=0.874, val_loss=0.518, val_accuracy=0.829]
 13%|█▎        | 5/38 [00:52<05:20,  9.71s/epoch, loss=0.432, accuracy=0.884, val_loss=0.533, val_accuracy=0.832]
 16%|█▌        | 6/38 [01:02<05:06,  9.56s/epoch, loss=0.454, accuracy=0.89, val_loss=0.625, val_accuracy=0.823] 
 18%|█▊        | 7/38 [01:11<04:52,  9.44s/epoch, loss=0.472, accuracy=0.897, val_loss=0.61, val_accuracy=0.834]
 21%|██        | 8/38 [01:20<04:42,  9.41s/epoch, loss=0.527, accuracy=0.887, val_loss=0.76, val_accuracy=0.797]
 24%|██▎       | 9/38 [01:30<04:33,  9.44s/epoch, loss=0.913, accuracy=0.736, val_loss=1.09, val_accuracy=0.646]
 26%|██▋       | 10/38 [01:39<04:23,  9.41s/epoch, loss=1.16, accuracy=0.593, val_loss=1.16, val_accuracy=0.583]
 29%|██▉       | 11/38 [01:48<04:13,  9.38s/epoch, loss=1.08, accuracy=0.623, val_loss=1.07, val_accuracy=0.619]
 32%|███▏      | 12/38 [01:58<04:03,  9.35s/epoch, loss=1.07, accuracy=0.612, val_loss=1.09, val_accuracy=0.492]
 34%|███▍      | 13/38 [02:07<03:54,  9.36s/epoch, loss=1.06, accuracy=0.567, val_loss=1.38, val_accuracy=0.513]
 37%|███▋      | 14/38 [02:16<03:43,  9.33s/epoch, loss=1.04, accuracy=0.566, val_loss=1.03, val_accuracy=0.541]
 39%|███▉      | 15/38 [02:26<03:34,  9.33s/epoch, loss=0.978, accuracy=0.588, val_loss=1.08, val_accuracy=0.534]
 42%|████▏     | 16/38 [02:35<03:25,  9.35s/epoch, loss=0.945, accuracy=0.604, val_loss=0.981, val_accuracy=0.546]
 45%|████▍     | 17/38 [02:44<03:17,  9.39s/epoch, loss=0.934, accuracy=0.603, val_loss=0.905, val_accuracy=0.623]
 47%|████▋     | 18/38 [02:54<03:08,  9.42s/epoch, loss=0.91, accuracy=0.623, val_loss=0.902, val_accuracy=0.626] 
 50%|█████     | 19/38 [03:03<02:57,  9.32s/epoch, loss=0.911, accuracy=0.609, val_loss=0.917, val_accuracy=0.6] 
 53%|█████▎    | 20/38 [03:12<02:47,  9.30s/epoch, loss=0.947, accuracy=0.583, val_loss=0.93, val_accuracy=0.568]
 55%|█████▌    | 21/38 [03:22<02:38,  9.31s/epoch, loss=0.951, accuracy=0.565, val_loss=0.918, val_accuracy=0.514]
 58%|█████▊    | 22/38 [03:31<02:28,  9.29s/epoch, loss=0.918, accuracy=0.572, val_loss=0.871, val_accuracy=0.6]  
 61%|██████    | 23/38 [03:40<02:19,  9.30s/epoch, loss=0.896, accuracy=0.57, val_loss=0.874, val_accuracy=0.569]
 63%|██████▎   | 24/38 [03:49<02:10,  9.30s/epoch, loss=0.876, accuracy=0.601, val_loss=0.872, val_accuracy=0.619]
 66%|██████▌   | 25/38 [03:59<02:00,  9.31s/epoch, loss=0.846, accuracy=0.625, val_loss=0.855, val_accuracy=0.59] 
 68%|██████▊   | 26/38 [04:08<01:51,  9.33s/epoch, loss=0.865, accuracy=0.611, val_loss=0.85, val_accuracy=0.644]
 71%|███████   | 27/38 [04:18<01:43,  9.42s/epoch, loss=0.883, accuracy=0.583, val_loss=0.868, val_accuracy=0.587]
 74%|███████▎  | 28/38 [04:27<01:34,  9.47s/epoch, loss=0.863, accuracy=0.581, val_loss=0.835, val_accuracy=0.614]
 76%|███████▋  | 29/38 [04:37<01:25,  9.48s/epoch, loss=0.818, accuracy=0.621, val_loss=0.807, val_accuracy=0.624]
 79%|███████▉  | 30/38 [04:46<01:15,  9.40s/epoch, loss=0.789, accuracy=0.657, val_loss=0.937, val_accuracy=0.599]
 82%|████████▏ | 31/38 [04:55<01:05,  9.37s/epoch, loss=0.822, accuracy=0.679, val_loss=0.89, val_accuracy=0.613] 
 84%|████████▍ | 32/38 [05:05<00:56,  9.38s/epoch, loss=0.857, accuracy=0.664, val_loss=0.89, val_accuracy=0.662]
 87%|████████▋ | 33/38 [05:14<00:46,  9.37s/epoch, loss=0.926, accuracy=0.641, val_loss=0.919, val_accuracy=0.641]
 89%|████████▉ | 34/38 [05:23<00:37,  9.32s/epoch, loss=0.906, accuracy=0.654, val_loss=0.883, val_accuracy=0.645]
 92%|█████████▏| 35/38 [05:33<00:28,  9.39s/epoch, loss=0.893, accuracy=0.657, val_loss=0.897, val_accuracy=0.656]
 95%|█████████▍| 36/38 [05:42<00:18,  9.40s/epoch, loss=0.991, accuracy=0.666, val_loss=1.26, val_accuracy=0.625] 
 97%|█████████▋| 37/38 [05:52<00:09,  9.38s/epoch, loss=1.25, accuracy=0.618, val_loss=1.18, val_accuracy=0.631] 
100%|██████████| 38/38 [06:01<00:00,  9.38s/epoch, loss=1.12, accuracy=0.631, val_loss=1.06, val_accuracy=0.627]
100%|██████████| 38/38 [06:01<00:00,  9.52s/epoch, loss=1.12, accuracy=0.631, val_loss=1.06, val_accuracy=0.627]
Test score: 0.448550283908844
Test accuracy: 0.8361200094223022


* * * Run SGD for ID = 13_9. * * *


2024-03-01 12:48:51.285913: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 12:48:57.730547: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 12:48:57.731850: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-01 12:48:57.785714: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 12:48:57.785748: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 12:48:57.788736: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 12:48:57.788805: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 12:48:57.791203: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 12:48:57.792245: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 12:48:57.794970: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 12:48:57.796584: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 12:48:57.802622: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 12:48:57.803393: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 12:48:57.803496: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
<__array_function__ internals>:5: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:159: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_train, y_train = np.array(xs[:idx]), np.array(labels[:idx])
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:160: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_test, y_test = np.array(xs[idx:]), np.array(labels[idx:])
2024-03-01 12:49:04.438982: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-01 12:49:04.439621: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 12:49:04.440254: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 12:49:04.440294: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 12:49:04.440353: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 12:49:04.440371: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 12:49:04.440389: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 12:49:04.440406: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 12:49:04.440423: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 12:49:04.440440: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 12:49:04.440458: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 12:49:04.441050: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 12:49:04.441096: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 12:49:05.095559: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-01 12:49:05.095627: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-01 12:49:05.095639: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-01 12:49:05.096774: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:18:00.0, compute capability: 6.1)
{'id': '13_09', 'seed': 9, 'out_folder': 'results/epoch_budget', 'batch_size': 32, 'epochs': 38, 'validation_split': 0.2, 'checkpointing': True, 'initial_lr': 0.1, 'momentum': 0.98, 'nesterov': True, 'bootstrapping': False, 'map_optimizer': True, 'model': 'CNN-LSTM', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Loading data...
Pad sequences (samples x time)
20000 train sequences
5000 validation sequences
25000 test sequences
x_train shape: (20000, 100)
x_val shape: (5000, 100)
x_test shape: (25000, 100)
Using MAP optimizer with reg_weight:  5e-05
CNN-LSTM

0epoch [00:00, ?epoch/s]
  0%|          | 0/38 [00:00<?, ?epoch/s]2024-03-01 12:49:05.524219: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-01 12:49:05.535954: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-03-01 12:49:07.089710: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 12:49:07.302985: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 12:49:08.140870: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-01 12:49:08.197836: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.

  3%|▎         | 1/38 [00:16<10:14, 16.61s/epoch, loss=0.678, accuracy=0.612, val_loss=0.525, val_accuracy=0.787]
  5%|▌         | 2/38 [00:28<08:25, 14.04s/epoch, loss=0.478, accuracy=0.823, val_loss=0.516, val_accuracy=0.789]
  8%|▊         | 3/38 [00:38<07:04, 12.13s/epoch, loss=0.426, accuracy=0.863, val_loss=0.464, val_accuracy=0.848]
 11%|█         | 4/38 [00:48<06:18, 11.13s/epoch, loss=0.416, accuracy=0.883, val_loss=0.521, val_accuracy=0.841]
 13%|█▎        | 5/38 [00:57<05:44, 10.45s/epoch, loss=0.435, accuracy=0.889, val_loss=0.573, val_accuracy=0.833]
 16%|█▌        | 6/38 [01:06<05:22, 10.07s/epoch, loss=0.589, accuracy=0.836, val_loss=0.824, val_accuracy=0.748]
 18%|█▊        | 7/38 [01:16<05:07,  9.91s/epoch, loss=0.93, accuracy=0.717, val_loss=1.03, val_accuracy=0.663]  
 21%|██        | 8/38 [01:25<04:51,  9.73s/epoch, loss=1.07, accuracy=0.657, val_loss=1.15, val_accuracy=0.6]  
 24%|██▎       | 9/38 [01:34<04:37,  9.56s/epoch, loss=1.09, accuracy=0.629, val_loss=1, val_accuracy=0.703] 
 26%|██▋       | 10/38 [01:44<04:24,  9.46s/epoch, loss=1.03, accuracy=0.662, val_loss=1.04, val_accuracy=0.644]
 29%|██▉       | 11/38 [01:53<04:14,  9.42s/epoch, loss=1.05, accuracy=0.638, val_loss=1.06, val_accuracy=0.588]
 32%|███▏      | 12/38 [02:03<04:07,  9.50s/epoch, loss=1.06, accuracy=0.608, val_loss=1.06, val_accuracy=0.602]
 34%|███▍      | 13/38 [02:12<03:55,  9.42s/epoch, loss=1.11, accuracy=0.556, val_loss=1.08, val_accuracy=0.491]
 37%|███▋      | 14/38 [02:21<03:43,  9.33s/epoch, loss=1.05, accuracy=0.517, val_loss=0.998, val_accuracy=0.59]
 39%|███▉      | 15/38 [02:30<03:34,  9.33s/epoch, loss=0.988, accuracy=0.536, val_loss=0.931, val_accuracy=0.579]
 42%|████▏     | 16/38 [02:40<03:24,  9.32s/epoch, loss=0.922, accuracy=0.575, val_loss=0.994, val_accuracy=0.49] 
 45%|████▍     | 17/38 [02:49<03:15,  9.31s/epoch, loss=0.885, accuracy=0.595, val_loss=0.821, val_accuracy=0.631]
 47%|████▋     | 18/38 [02:58<03:06,  9.33s/epoch, loss=0.86, accuracy=0.62, val_loss=0.856, val_accuracy=0.628]  
 50%|█████     | 19/38 [03:08<02:56,  9.31s/epoch, loss=0.852, accuracy=0.635, val_loss=0.851, val_accuracy=0.668]
 53%|█████▎    | 20/38 [03:17<02:47,  9.32s/epoch, loss=0.87, accuracy=0.64, val_loss=0.907, val_accuracy=0.609]  
 55%|█████▌    | 21/38 [03:26<02:37,  9.28s/epoch, loss=0.92, accuracy=0.592, val_loss=0.945, val_accuracy=0.593]
 58%|█████▊    | 22/38 [03:35<02:28,  9.27s/epoch, loss=0.897, accuracy=0.616, val_loss=0.88, val_accuracy=0.614]
 61%|██████    | 23/38 [03:45<02:19,  9.32s/epoch, loss=0.871, accuracy=0.636, val_loss=0.891, val_accuracy=0.638]
 63%|██████▎   | 24/38 [03:55<02:11,  9.42s/epoch, loss=0.881, accuracy=0.627, val_loss=0.923, val_accuracy=0.631]
 66%|██████▌   | 25/38 [04:04<02:01,  9.36s/epoch, loss=0.907, accuracy=0.597, val_loss=0.94, val_accuracy=0.566] 
 68%|██████▊   | 26/38 [04:13<01:51,  9.32s/epoch, loss=0.904, accuracy=0.558, val_loss=0.924, val_accuracy=0.518]
 71%|███████   | 27/38 [04:22<01:42,  9.31s/epoch, loss=0.871, accuracy=0.585, val_loss=0.849, val_accuracy=0.609]
 74%|███████▎  | 28/38 [04:31<01:32,  9.25s/epoch, loss=0.871, accuracy=0.597, val_loss=0.914, val_accuracy=0.538]
 76%|███████▋  | 29/38 [04:41<01:23,  9.30s/epoch, loss=0.865, accuracy=0.616, val_loss=0.855, val_accuracy=0.625]
 79%|███████▉  | 30/38 [04:50<01:15,  9.38s/epoch, loss=0.835, accuracy=0.636, val_loss=0.831, val_accuracy=0.635]
 82%|████████▏ | 31/38 [05:00<01:05,  9.38s/epoch, loss=0.871, accuracy=0.618, val_loss=0.92, val_accuracy=0.604] 
 84%|████████▍ | 32/38 [05:09<00:56,  9.35s/epoch, loss=0.894, accuracy=0.617, val_loss=0.904, val_accuracy=0.6] 
 87%|████████▋ | 33/38 [05:18<00:46,  9.36s/epoch, loss=0.911, accuracy=0.614, val_loss=0.899, val_accuracy=0.627]
 89%|████████▉ | 34/38 [05:28<00:37,  9.41s/epoch, loss=0.911, accuracy=0.616, val_loss=0.88, val_accuracy=0.639] 
 92%|█████████▏| 35/38 [05:37<00:28,  9.42s/epoch, loss=0.906, accuracy=0.625, val_loss=0.925, val_accuracy=0.556]
 95%|█████████▍| 36/38 [05:46<00:18,  9.26s/epoch, loss=0.872, accuracy=0.643, val_loss=1.16, val_accuracy=0.551] 
 97%|█████████▋| 37/38 [05:55<00:08,  8.99s/epoch, loss=0.906, accuracy=0.614, val_loss=0.941, val_accuracy=0.547]
100%|██████████| 38/38 [06:03<00:00,  8.81s/epoch, loss=0.914, accuracy=0.611, val_loss=0.906, val_accuracy=0.61] 
100%|██████████| 38/38 [06:03<00:00,  9.57s/epoch, loss=0.914, accuracy=0.611, val_loss=0.906, val_accuracy=0.61]
Test score: 0.4663807451725006
Test accuracy: 0.8430399894714355


* * * Run SGD for ID = 13_10. * * *


2024-03-01 12:55:19.781931: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 12:55:22.921844: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 12:55:22.923230: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-01 12:55:22.966836: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 12:55:22.966889: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 12:55:22.970587: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 12:55:22.970690: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 12:55:22.973534: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 12:55:22.974375: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 12:55:22.977612: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 12:55:22.979554: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 12:55:22.986495: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 12:55:22.987381: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 12:55:22.987489: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
<__array_function__ internals>:5: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:159: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_train, y_train = np.array(xs[:idx]), np.array(labels[:idx])
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:160: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_test, y_test = np.array(xs[idx:]), np.array(labels[idx:])
2024-03-01 12:55:30.177798: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-01 12:55:30.178494: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 12:55:30.179154: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 12:55:30.179211: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 12:55:30.179285: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 12:55:30.179314: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 12:55:30.179340: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 12:55:30.179367: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 12:55:30.179394: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 12:55:30.179420: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 12:55:30.179446: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 12:55:30.180145: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 12:55:30.180204: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 12:55:30.893124: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-01 12:55:30.893211: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-01 12:55:30.893225: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-01 12:55:30.895309: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:18:00.0, compute capability: 6.1)
{'id': '13_10', 'seed': 10, 'out_folder': 'results/epoch_budget', 'batch_size': 32, 'epochs': 38, 'validation_split': 0.2, 'checkpointing': True, 'initial_lr': 0.1, 'momentum': 0.98, 'nesterov': True, 'bootstrapping': False, 'map_optimizer': True, 'model': 'CNN-LSTM', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Loading data...
Pad sequences (samples x time)
20000 train sequences
5000 validation sequences
25000 test sequences
x_train shape: (20000, 100)
x_val shape: (5000, 100)
x_test shape: (25000, 100)
Using MAP optimizer with reg_weight:  5e-05
CNN-LSTM

0epoch [00:00, ?epoch/s]
  0%|          | 0/38 [00:00<?, ?epoch/s]2024-03-01 12:55:31.362965: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-01 12:55:31.374959: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-03-01 12:55:33.024806: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 12:55:33.252935: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 12:55:34.147838: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-01 12:55:34.200303: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.

  3%|▎         | 1/38 [00:16<10:03, 16.32s/epoch, loss=0.639, accuracy=0.663, val_loss=0.492, val_accuracy=0.807]
  5%|▌         | 2/38 [00:26<07:34, 12.64s/epoch, loss=0.455, accuracy=0.837, val_loss=0.488, val_accuracy=0.824]
  8%|▊         | 3/38 [00:36<06:38, 11.37s/epoch, loss=0.418, accuracy=0.87, val_loss=0.51, val_accuracy=0.831]  
 11%|█         | 4/38 [00:46<06:07, 10.81s/epoch, loss=0.41, accuracy=0.887, val_loss=0.544, val_accuracy=0.832]
 13%|█▎        | 5/38 [00:55<05:39, 10.28s/epoch, loss=0.457, accuracy=0.883, val_loss=0.613, val_accuracy=0.822]
 16%|█▌        | 6/38 [01:04<05:17,  9.91s/epoch, loss=0.769, accuracy=0.776, val_loss=1.02, val_accuracy=0.642] 
 18%|█▊        | 7/38 [01:14<05:03,  9.79s/epoch, loss=1.09, accuracy=0.644, val_loss=1.11, val_accuracy=0.612] 
 21%|██        | 8/38 [01:23<04:49,  9.65s/epoch, loss=1.1, accuracy=0.61, val_loss=1.07, val_accuracy=0.626]  
 24%|██▎       | 9/38 [01:33<04:38,  9.62s/epoch, loss=1.05, accuracy=0.607, val_loss=0.997, val_accuracy=0.65]
 26%|██▋       | 10/38 [01:42<04:26,  9.53s/epoch, loss=1.04, accuracy=0.597, val_loss=1.02, val_accuracy=0.604]
 29%|██▉       | 11/38 [01:51<04:15,  9.45s/epoch, loss=1.03, accuracy=0.576, val_loss=1.01, val_accuracy=0.57] 
 32%|███▏      | 12/38 [02:01<04:06,  9.48s/epoch, loss=0.987, accuracy=0.569, val_loss=0.952, val_accuracy=0.591]
 34%|███▍      | 13/38 [02:10<03:56,  9.47s/epoch, loss=0.965, accuracy=0.561, val_loss=0.986, val_accuracy=0.498]
 37%|███▋      | 14/38 [02:20<03:46,  9.44s/epoch, loss=0.944, accuracy=0.583, val_loss=0.916, val_accuracy=0.559]
 39%|███▉      | 15/38 [02:29<03:35,  9.39s/epoch, loss=0.921, accuracy=0.585, val_loss=0.939, val_accuracy=0.502]
 42%|████▏     | 16/38 [02:38<03:25,  9.35s/epoch, loss=0.914, accuracy=0.558, val_loss=0.917, val_accuracy=0.503]
 45%|████▍     | 17/38 [02:48<03:16,  9.35s/epoch, loss=0.874, accuracy=0.583, val_loss=0.801, val_accuracy=0.642]
 47%|████▋     | 18/38 [02:57<03:07,  9.36s/epoch, loss=0.871, accuracy=0.621, val_loss=0.833, val_accuracy=0.643]
 50%|█████     | 19/38 [03:06<02:58,  9.42s/epoch, loss=0.863, accuracy=0.632, val_loss=0.833, val_accuracy=0.664]
 53%|█████▎    | 20/38 [03:16<02:48,  9.35s/epoch, loss=0.869, accuracy=0.645, val_loss=0.898, val_accuracy=0.628]
 55%|█████▌    | 21/38 [03:25<02:38,  9.33s/epoch, loss=0.861, accuracy=0.648, val_loss=0.84, val_accuracy=0.661] 
 58%|█████▊    | 22/38 [03:34<02:28,  9.31s/epoch, loss=0.852, accuracy=0.654, val_loss=0.858, val_accuracy=0.623]
 61%|██████    | 23/38 [03:44<02:19,  9.32s/epoch, loss=0.86, accuracy=0.634, val_loss=0.869, val_accuracy=0.608] 
 63%|██████▎   | 24/38 [03:53<02:11,  9.38s/epoch, loss=0.931, accuracy=0.626, val_loss=1.09, val_accuracy=0.609]
 66%|██████▌   | 25/38 [04:02<02:01,  9.36s/epoch, loss=0.985, accuracy=0.655, val_loss=0.987, val_accuracy=0.624]
 68%|██████▊   | 26/38 [04:12<01:52,  9.37s/epoch, loss=0.976, accuracy=0.624, val_loss=0.906, val_accuracy=0.679]
 71%|███████   | 27/38 [04:21<01:43,  9.39s/epoch, loss=0.919, accuracy=0.65, val_loss=0.924, val_accuracy=0.643] 
 74%|███████▎  | 28/38 [04:31<01:33,  9.37s/epoch, loss=0.938, accuracy=0.615, val_loss=0.913, val_accuracy=0.607]
 76%|███████▋  | 29/38 [04:40<01:24,  9.41s/epoch, loss=0.905, accuracy=0.64, val_loss=0.891, val_accuracy=0.647] 
 79%|███████▉  | 30/38 [04:49<01:15,  9.42s/epoch, loss=0.864, accuracy=0.655, val_loss=0.897, val_accuracy=0.661]
 82%|████████▏ | 31/38 [04:59<01:05,  9.41s/epoch, loss=0.905, accuracy=0.632, val_loss=1.03, val_accuracy=0.498] 
 84%|████████▍ | 32/38 [05:08<00:56,  9.38s/epoch, loss=0.959, accuracy=0.592, val_loss=0.988, val_accuracy=0.601]
 87%|████████▋ | 33/38 [05:17<00:46,  9.27s/epoch, loss=0.963, accuracy=0.615, val_loss=0.939, val_accuracy=0.586]
 89%|████████▉ | 34/38 [05:26<00:36,  9.01s/epoch, loss=0.956, accuracy=0.599, val_loss=0.962, val_accuracy=0.593]
 92%|█████████▏| 35/38 [05:34<00:26,  8.79s/epoch, loss=0.946, accuracy=0.611, val_loss=0.916, val_accuracy=0.64] 
 95%|█████████▍| 36/38 [05:42<00:17,  8.68s/epoch, loss=0.928, accuracy=0.611, val_loss=0.938, val_accuracy=0.499]
 97%|█████████▋| 37/38 [05:51<00:08,  8.69s/epoch, loss=0.885, accuracy=0.619, val_loss=0.867, val_accuracy=0.654]
100%|██████████| 38/38 [06:00<00:00,  8.70s/epoch, loss=0.892, accuracy=0.612, val_loss=0.955, val_accuracy=0.498]
100%|██████████| 38/38 [06:00<00:00,  9.48s/epoch, loss=0.892, accuracy=0.612, val_loss=0.955, val_accuracy=0.498]
Test score: 0.522541880607605
Test accuracy: 0.8441200256347656


* * * Run SGD for ID = 13_11. * * *


2024-03-01 13:01:40.045096: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:01:49.436618: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:01:49.438108: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-01 13:01:49.482822: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:01:49.482881: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:01:49.486481: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:01:49.486613: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:01:49.489501: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:01:49.490298: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:01:49.493204: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:01:49.494952: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:01:49.501091: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:01:49.501946: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:01:49.502088: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
<__array_function__ internals>:5: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:159: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_train, y_train = np.array(xs[:idx]), np.array(labels[:idx])
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:160: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_test, y_test = np.array(xs[idx:]), np.array(labels[idx:])
2024-03-01 13:01:57.276037: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-01 13:01:57.276795: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:01:57.277677: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:01:57.277729: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:01:57.277804: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:01:57.277843: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:01:57.277869: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:01:57.277893: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:01:57.277916: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:01:57.277939: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:01:57.277964: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:01:57.278583: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:01:57.278631: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:01:57.868912: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-01 13:01:57.868966: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-01 13:01:57.868978: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-01 13:01:57.870137: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:18:00.0, compute capability: 6.1)
{'id': '13_11', 'seed': 11, 'out_folder': 'results/epoch_budget', 'batch_size': 32, 'epochs': 38, 'validation_split': 0.2, 'checkpointing': True, 'initial_lr': 0.1, 'momentum': 0.98, 'nesterov': True, 'bootstrapping': False, 'map_optimizer': True, 'model': 'CNN-LSTM', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Loading data...
Pad sequences (samples x time)
20000 train sequences
5000 validation sequences
25000 test sequences
x_train shape: (20000, 100)
x_val shape: (5000, 100)
x_test shape: (25000, 100)
Using MAP optimizer with reg_weight:  5e-05
CNN-LSTM

0epoch [00:00, ?epoch/s]
  0%|          | 0/38 [00:00<?, ?epoch/s]2024-03-01 13:01:58.282305: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-01 13:01:58.294949: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-03-01 13:01:59.891138: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:02:00.122004: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:02:00.978326: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-01 13:02:01.061920: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.

  3%|▎         | 1/38 [00:16<10:09, 16.46s/epoch, loss=0.609, accuracy=0.703, val_loss=0.489, val_accuracy=0.808]
  5%|▌         | 2/38 [00:25<07:22, 12.30s/epoch, loss=0.456, accuracy=0.834, val_loss=0.44, val_accuracy=0.847] 
  8%|▊         | 3/38 [00:34<06:16, 10.75s/epoch, loss=0.422, accuracy=0.865, val_loss=0.487, val_accuracy=0.834]
 11%|█         | 4/38 [00:43<05:40, 10.01s/epoch, loss=0.416, accuracy=0.881, val_loss=0.532, val_accuracy=0.833]
 13%|█▎        | 5/38 [00:52<05:16,  9.59s/epoch, loss=0.435, accuracy=0.888, val_loss=0.562, val_accuracy=0.842]
 16%|█▌        | 6/38 [01:01<04:59,  9.35s/epoch, loss=0.619, accuracy=0.825, val_loss=0.797, val_accuracy=0.765]
 18%|█▊        | 7/38 [01:10<04:44,  9.18s/epoch, loss=0.963, accuracy=0.695, val_loss=1.05, val_accuracy=0.663] 
 21%|██        | 8/38 [01:18<04:31,  9.05s/epoch, loss=1.08, accuracy=0.598, val_loss=1.03, val_accuracy=0.64]  
 24%|██▎       | 9/38 [01:27<04:21,  9.00s/epoch, loss=1.06, accuracy=0.594, val_loss=1.04, val_accuracy=0.535]
 26%|██▋       | 10/38 [01:36<04:09,  8.93s/epoch, loss=1.04, accuracy=0.579, val_loss=1.04, val_accuracy=0.589]
 29%|██▉       | 11/38 [01:45<03:58,  8.85s/epoch, loss=1.02, accuracy=0.562, val_loss=1.16, val_accuracy=0.501]
 32%|███▏      | 12/38 [01:54<03:49,  8.81s/epoch, loss=0.97, accuracy=0.583, val_loss=0.912, val_accuracy=0.646]
 34%|███▍      | 13/38 [02:02<03:39,  8.79s/epoch, loss=0.941, accuracy=0.614, val_loss=1.05, val_accuracy=0.556]
 37%|███▋      | 14/38 [02:11<03:30,  8.79s/epoch, loss=0.958, accuracy=0.582, val_loss=0.946, val_accuracy=0.572]
 39%|███▉      | 15/38 [02:20<03:22,  8.79s/epoch, loss=0.952, accuracy=0.573, val_loss=0.918, val_accuracy=0.563]
 42%|████▏     | 16/38 [02:29<03:13,  8.80s/epoch, loss=0.914, accuracy=0.606, val_loss=0.945, val_accuracy=0.612]
 45%|████▍     | 17/38 [02:38<03:05,  8.82s/epoch, loss=0.911, accuracy=0.592, val_loss=0.9, val_accuracy=0.606]  
 47%|████▋     | 18/38 [02:47<02:57,  8.87s/epoch, loss=0.914, accuracy=0.606, val_loss=0.89, val_accuracy=0.607]
 50%|█████     | 19/38 [02:55<02:47,  8.83s/epoch, loss=0.88, accuracy=0.619, val_loss=0.876, val_accuracy=0.605]
 53%|█████▎    | 20/38 [03:04<02:39,  8.84s/epoch, loss=0.886, accuracy=0.605, val_loss=0.874, val_accuracy=0.651]
 55%|█████▌    | 21/38 [03:13<02:30,  8.84s/epoch, loss=0.92, accuracy=0.609, val_loss=0.964, val_accuracy=0.507] 
 58%|█████▊    | 22/38 [03:22<02:21,  8.85s/epoch, loss=0.932, accuracy=0.577, val_loss=0.884, val_accuracy=0.602]
 61%|██████    | 23/38 [03:31<02:12,  8.83s/epoch, loss=0.898, accuracy=0.592, val_loss=0.88, val_accuracy=0.568] 
 63%|██████▎   | 24/38 [03:39<02:03,  8.84s/epoch, loss=0.878, accuracy=0.621, val_loss=0.878, val_accuracy=0.628]
 66%|██████▌   | 25/38 [03:48<01:55,  8.85s/epoch, loss=0.904, accuracy=0.612, val_loss=0.939, val_accuracy=0.545]
 68%|██████▊   | 26/38 [03:57<01:46,  8.84s/epoch, loss=0.903, accuracy=0.61, val_loss=0.884, val_accuracy=0.634] 
 71%|███████   | 27/38 [04:06<01:37,  8.83s/epoch, loss=0.91, accuracy=0.615, val_loss=0.929, val_accuracy=0.64] 
 74%|███████▎  | 28/38 [04:15<01:28,  8.82s/epoch, loss=0.917, accuracy=0.582, val_loss=0.918, val_accuracy=0.601]
 76%|███████▋  | 29/38 [04:23<01:18,  8.78s/epoch, loss=0.885, accuracy=0.614, val_loss=0.868, val_accuracy=0.594]
 79%|███████▉  | 30/38 [04:32<01:10,  8.79s/epoch, loss=0.882, accuracy=0.605, val_loss=0.882, val_accuracy=0.604]
 82%|████████▏ | 31/38 [04:41<01:01,  8.77s/epoch, loss=0.862, accuracy=0.619, val_loss=0.85, val_accuracy=0.613] 
 84%|████████▍ | 32/38 [04:49<00:51,  8.62s/epoch, loss=0.842, accuracy=0.623, val_loss=0.87, val_accuracy=0.637]
 87%|████████▋ | 33/38 [04:58<00:42,  8.53s/epoch, loss=0.86, accuracy=0.612, val_loss=0.854, val_accuracy=0.617]
 89%|████████▉ | 34/38 [05:06<00:34,  8.56s/epoch, loss=0.855, accuracy=0.614, val_loss=0.873, val_accuracy=0.609]
 92%|█████████▏| 35/38 [05:15<00:25,  8.59s/epoch, loss=0.87, accuracy=0.577, val_loss=0.866, val_accuracy=0.605] 
 95%|█████████▍| 36/38 [05:24<00:17,  8.66s/epoch, loss=0.87, accuracy=0.572, val_loss=0.932, val_accuracy=0.548]
 97%|█████████▋| 37/38 [05:33<00:08,  8.77s/epoch, loss=0.834, accuracy=0.595, val_loss=0.864, val_accuracy=0.622]
100%|██████████| 38/38 [05:42<00:00,  8.82s/epoch, loss=0.86, accuracy=0.582, val_loss=0.822, val_accuracy=0.572] 
100%|██████████| 38/38 [05:42<00:00,  9.00s/epoch, loss=0.86, accuracy=0.582, val_loss=0.822, val_accuracy=0.572]
Test score: 0.45164477825164795
Test accuracy: 0.8389599919319153


* * * Run SGD for ID = 13_12. * * *


2024-03-01 13:07:49.045714: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:07:52.828519: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:07:52.829993: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-01 13:07:52.873947: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:07:52.874001: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:07:52.877616: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:07:52.877699: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:07:52.880340: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:07:52.881178: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:07:52.884330: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:07:52.886382: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:07:52.892864: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:07:52.893684: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:07:52.893807: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
<__array_function__ internals>:5: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:159: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_train, y_train = np.array(xs[:idx]), np.array(labels[:idx])
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:160: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_test, y_test = np.array(xs[idx:]), np.array(labels[idx:])
2024-03-01 13:08:00.093683: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-01 13:08:00.094385: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:08:00.095458: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:08:00.095530: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:08:00.095656: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:08:00.095676: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:08:00.095695: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:08:00.095712: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:08:00.095730: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:08:00.095747: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:08:00.095765: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:08:00.096464: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:08:00.096533: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:08:00.737239: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-01 13:08:00.737307: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-01 13:08:00.737328: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-01 13:08:00.738577: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:18:00.0, compute capability: 6.1)
{'id': '13_12', 'seed': 12, 'out_folder': 'results/epoch_budget', 'batch_size': 32, 'epochs': 38, 'validation_split': 0.2, 'checkpointing': True, 'initial_lr': 0.1, 'momentum': 0.98, 'nesterov': True, 'bootstrapping': False, 'map_optimizer': True, 'model': 'CNN-LSTM', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Loading data...
Pad sequences (samples x time)
20000 train sequences
5000 validation sequences
25000 test sequences
x_train shape: (20000, 100)
x_val shape: (5000, 100)
x_test shape: (25000, 100)
Using MAP optimizer with reg_weight:  5e-05
CNN-LSTM

0epoch [00:00, ?epoch/s]
  0%|          | 0/38 [00:00<?, ?epoch/s]2024-03-01 13:08:01.199628: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-01 13:08:01.212026: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-03-01 13:08:02.858904: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:08:03.074399: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:08:03.909661: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-01 13:08:03.957465: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.

  3%|▎         | 1/38 [00:15<09:22, 15.20s/epoch, loss=0.653, accuracy=0.648, val_loss=0.509, val_accuracy=0.79]
  5%|▌         | 2/38 [00:25<07:14, 12.06s/epoch, loss=0.474, accuracy=0.827, val_loss=0.477, val_accuracy=0.837]
  8%|▊         | 3/38 [00:34<06:18, 10.81s/epoch, loss=0.423, accuracy=0.864, val_loss=0.463, val_accuracy=0.847]
 11%|█         | 4/38 [00:43<05:42, 10.09s/epoch, loss=0.436, accuracy=0.875, val_loss=0.568, val_accuracy=0.833]
 13%|█▎        | 5/38 [00:52<05:18,  9.64s/epoch, loss=0.526, accuracy=0.861, val_loss=0.679, val_accuracy=0.794]
 16%|█▌        | 6/38 [01:01<05:00,  9.39s/epoch, loss=0.795, accuracy=0.77, val_loss=1.03, val_accuracy=0.683]  
 18%|█▊        | 7/38 [01:09<04:44,  9.19s/epoch, loss=1.14, accuracy=0.619, val_loss=1.14, val_accuracy=0.615]
 21%|██        | 8/38 [01:18<04:31,  9.06s/epoch, loss=1.12, accuracy=0.603, val_loss=1.12, val_accuracy=0.534]
 24%|██▎       | 9/38 [01:27<04:20,  8.99s/epoch, loss=1.1, accuracy=0.625, val_loss=1.1, val_accuracy=0.607]  
 26%|██▋       | 10/38 [01:36<04:10,  8.96s/epoch, loss=1.08, accuracy=0.606, val_loss=1.11, val_accuracy=0.488]
 29%|██▉       | 11/38 [01:45<04:00,  8.92s/epoch, loss=1.04, accuracy=0.579, val_loss=1.03, val_accuracy=0.528]
 32%|███▏      | 12/38 [01:54<03:52,  8.94s/epoch, loss=1.04, accuracy=0.549, val_loss=0.975, val_accuracy=0.59]
 34%|███▍      | 13/38 [02:03<03:42,  8.92s/epoch, loss=0.97, accuracy=0.562, val_loss=0.935, val_accuracy=0.488]
 37%|███▋      | 14/38 [02:11<03:33,  8.88s/epoch, loss=0.908, accuracy=0.583, val_loss=0.877, val_accuracy=0.612]
 39%|███▉      | 15/38 [02:20<03:24,  8.89s/epoch, loss=0.886, accuracy=0.612, val_loss=0.94, val_accuracy=0.589] 
 42%|████▏     | 16/38 [02:29<03:14,  8.84s/epoch, loss=0.887, accuracy=0.613, val_loss=0.866, val_accuracy=0.634]
 45%|████▍     | 17/38 [02:38<03:04,  8.79s/epoch, loss=0.855, accuracy=0.639, val_loss=0.829, val_accuracy=0.66] 
 47%|████▋     | 18/38 [02:47<02:56,  8.81s/epoch, loss=0.867, accuracy=0.627, val_loss=0.902, val_accuracy=0.615]
 50%|█████     | 19/38 [02:55<02:47,  8.81s/epoch, loss=0.906, accuracy=0.595, val_loss=0.885, val_accuracy=0.621]
 53%|█████▎    | 20/38 [03:04<02:39,  8.87s/epoch, loss=0.901, accuracy=0.604, val_loss=0.871, val_accuracy=0.619]
 55%|█████▌    | 21/38 [03:13<02:30,  8.84s/epoch, loss=0.875, accuracy=0.619, val_loss=0.929, val_accuracy=0.637]
 58%|█████▊    | 22/38 [03:22<02:20,  8.81s/epoch, loss=0.835, accuracy=0.645, val_loss=0.827, val_accuracy=0.632]
 61%|██████    | 23/38 [03:31<02:12,  8.81s/epoch, loss=0.868, accuracy=0.619, val_loss=0.868, val_accuracy=0.593]
 63%|██████▎   | 24/38 [03:39<02:03,  8.79s/epoch, loss=0.901, accuracy=0.562, val_loss=0.943, val_accuracy=0.513]
 66%|██████▌   | 25/38 [03:48<01:54,  8.79s/epoch, loss=0.87, accuracy=0.61, val_loss=0.853, val_accuracy=0.646]  
 68%|██████▊   | 26/38 [03:57<01:45,  8.78s/epoch, loss=0.832, accuracy=0.654, val_loss=0.837, val_accuracy=0.649]
 71%|███████   | 27/38 [04:06<01:36,  8.77s/epoch, loss=0.8, accuracy=0.678, val_loss=0.809, val_accuracy=0.656]  
 74%|███████▎  | 28/38 [04:14<01:27,  8.74s/epoch, loss=0.81, accuracy=0.668, val_loss=0.843, val_accuracy=0.634]
 76%|███████▋  | 29/38 [04:23<01:17,  8.65s/epoch, loss=0.837, accuracy=0.656, val_loss=0.908, val_accuracy=0.645]
 79%|███████▉  | 30/38 [04:31<01:08,  8.53s/epoch, loss=0.845, accuracy=0.655, val_loss=0.866, val_accuracy=0.604]
 82%|████████▏ | 31/38 [04:39<00:59,  8.45s/epoch, loss=0.858, accuracy=0.641, val_loss=0.818, val_accuracy=0.687]
 84%|████████▍ | 32/38 [04:48<00:51,  8.52s/epoch, loss=0.814, accuracy=0.683, val_loss=0.827, val_accuracy=0.666]
 87%|████████▋ | 33/38 [04:57<00:43,  8.60s/epoch, loss=0.779, accuracy=0.702, val_loss=0.831, val_accuracy=0.659]
 89%|████████▉ | 34/38 [05:06<00:34,  8.65s/epoch, loss=0.826, accuracy=0.667, val_loss=0.86, val_accuracy=0.647] 
 92%|█████████▏| 35/38 [05:15<00:26,  8.75s/epoch, loss=0.871, accuracy=0.653, val_loss=0.901, val_accuracy=0.621]
 95%|█████████▍| 36/38 [05:24<00:17,  8.81s/epoch, loss=0.887, accuracy=0.623, val_loss=0.907, val_accuracy=0.566]
 97%|█████████▋| 37/38 [05:32<00:08,  8.83s/epoch, loss=0.926, accuracy=0.588, val_loss=0.976, val_accuracy=0.533]
100%|██████████| 38/38 [05:41<00:00,  8.83s/epoch, loss=0.894, accuracy=0.604, val_loss=0.88, val_accuracy=0.63]  
100%|██████████| 38/38 [05:41<00:00,  8.99s/epoch, loss=0.894, accuracy=0.604, val_loss=0.88, val_accuracy=0.63]
Test score: 0.46377062797546387
Test accuracy: 0.8462399840354919


* * * Run SGD for ID = 13_13. * * *


2024-03-01 13:13:51.623803: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:13:55.325048: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:13:55.326491: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-01 13:13:55.368781: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:13:55.368838: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:13:55.372362: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:13:55.372450: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:13:55.375116: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:13:55.375970: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:13:55.379006: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:13:55.380908: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:13:55.387332: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:13:55.388144: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:13:55.388258: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
<__array_function__ internals>:5: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:159: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_train, y_train = np.array(xs[:idx]), np.array(labels[:idx])
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:160: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_test, y_test = np.array(xs[idx:]), np.array(labels[idx:])
2024-03-01 13:14:02.292063: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-01 13:14:02.292620: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:14:02.293262: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:14:02.293302: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:14:02.293360: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:14:02.293379: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:14:02.293397: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:14:02.293415: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:14:02.293431: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:14:02.293448: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:14:02.293466: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:14:02.294058: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:14:02.294115: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:14:02.936465: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-01 13:14:02.936529: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-01 13:14:02.936540: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-01 13:14:02.937708: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:18:00.0, compute capability: 6.1)
{'id': '13_13', 'seed': 13, 'out_folder': 'results/epoch_budget', 'batch_size': 32, 'epochs': 38, 'validation_split': 0.2, 'checkpointing': True, 'initial_lr': 0.1, 'momentum': 0.98, 'nesterov': True, 'bootstrapping': False, 'map_optimizer': True, 'model': 'CNN-LSTM', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Loading data...
Pad sequences (samples x time)
20000 train sequences
5000 validation sequences
25000 test sequences
x_train shape: (20000, 100)
x_val shape: (5000, 100)
x_test shape: (25000, 100)
Using MAP optimizer with reg_weight:  5e-05
CNN-LSTM

0epoch [00:00, ?epoch/s]
  0%|          | 0/38 [00:00<?, ?epoch/s]2024-03-01 13:14:03.407944: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-01 13:14:03.420025: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-03-01 13:14:05.054655: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:14:05.274667: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:14:06.143476: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-01 13:14:06.193919: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.

  3%|▎         | 1/38 [00:15<09:15, 15.02s/epoch, loss=0.616, accuracy=0.687, val_loss=0.473, val_accuracy=0.818]
  5%|▌         | 2/38 [00:24<07:00, 11.67s/epoch, loss=0.445, accuracy=0.841, val_loss=0.446, val_accuracy=0.842]
  8%|▊         | 3/38 [00:33<06:05, 10.45s/epoch, loss=0.406, accuracy=0.871, val_loss=0.482, val_accuracy=0.839]
 11%|█         | 4/38 [00:42<05:35,  9.86s/epoch, loss=0.412, accuracy=0.885, val_loss=0.514, val_accuracy=0.835]
 13%|█▎        | 5/38 [00:51<05:14,  9.53s/epoch, loss=0.415, accuracy=0.897, val_loss=0.568, val_accuracy=0.838]
 16%|█▌        | 6/38 [01:00<05:03,  9.47s/epoch, loss=0.415, accuracy=0.909, val_loss=0.598, val_accuracy=0.845]
 18%|█▊        | 7/38 [01:09<04:48,  9.29s/epoch, loss=0.439, accuracy=0.911, val_loss=0.645, val_accuracy=0.832]
 21%|██        | 8/38 [01:18<04:35,  9.17s/epoch, loss=0.46, accuracy=0.914, val_loss=0.687, val_accuracy=0.829] 
 24%|██▎       | 9/38 [01:27<04:23,  9.08s/epoch, loss=0.545, accuracy=0.897, val_loss=0.793, val_accuracy=0.788]
 26%|██▋       | 10/38 [01:36<04:12,  9.01s/epoch, loss=0.98, accuracy=0.738, val_loss=1.2, val_accuracy=0.654]  
 29%|██▉       | 11/38 [01:44<04:01,  8.93s/epoch, loss=1.2, accuracy=0.593, val_loss=1.11, val_accuracy=0.648]
 32%|███▏      | 12/38 [01:53<03:51,  8.89s/epoch, loss=1.14, accuracy=0.599, val_loss=1.14, val_accuracy=0.628]
 34%|███▍      | 13/38 [02:02<03:43,  8.92s/epoch, loss=1.13, accuracy=0.604, val_loss=1.13, val_accuracy=0.531]
 37%|███▋      | 14/38 [02:11<03:33,  8.90s/epoch, loss=1.1, accuracy=0.581, val_loss=1.04, val_accuracy=0.616] 
 39%|███▉      | 15/38 [02:20<03:25,  8.94s/epoch, loss=1.06, accuracy=0.591, val_loss=1.04, val_accuracy=0.592]
 42%|████▏     | 16/38 [02:29<03:16,  8.94s/epoch, loss=1.04, accuracy=0.569, val_loss=1.01, val_accuracy=0.577]
 45%|████▍     | 17/38 [02:38<03:07,  8.91s/epoch, loss=0.988, accuracy=0.578, val_loss=0.953, val_accuracy=0.573]
 47%|████▋     | 18/38 [02:47<02:57,  8.89s/epoch, loss=0.968, accuracy=0.57, val_loss=1.05, val_accuracy=0.496]  
 50%|█████     | 19/38 [02:56<02:48,  8.87s/epoch, loss=0.947, accuracy=0.548, val_loss=0.911, val_accuracy=0.562]
 53%|█████▎    | 20/38 [03:04<02:39,  8.87s/epoch, loss=0.905, accuracy=0.548, val_loss=0.864, val_accuracy=0.556]
 55%|█████▌    | 21/38 [03:13<02:31,  8.90s/epoch, loss=0.859, accuracy=0.555, val_loss=0.854, val_accuracy=0.511]
 58%|█████▊    | 22/38 [03:22<02:22,  8.90s/epoch, loss=0.826, accuracy=0.576, val_loss=0.826, val_accuracy=0.594]
 61%|██████    | 23/38 [03:31<02:13,  8.93s/epoch, loss=0.798, accuracy=0.616, val_loss=0.799, val_accuracy=0.631]
 63%|██████▎   | 24/38 [03:40<02:05,  8.95s/epoch, loss=0.827, accuracy=0.668, val_loss=0.926, val_accuracy=0.692]
 66%|██████▌   | 25/38 [03:49<01:55,  8.87s/epoch, loss=0.95, accuracy=0.668, val_loss=0.958, val_accuracy=0.664] 
 68%|██████▊   | 26/38 [03:57<01:44,  8.74s/epoch, loss=1.02, accuracy=0.599, val_loss=0.996, val_accuracy=0.647]
 71%|███████   | 27/38 [04:06<01:34,  8.60s/epoch, loss=1.04, accuracy=0.586, val_loss=1.03, val_accuracy=0.598] 
 74%|███████▎  | 28/38 [04:14<01:25,  8.54s/epoch, loss=0.984, accuracy=0.585, val_loss=0.958, val_accuracy=0.604]
 76%|███████▋  | 29/38 [04:23<01:17,  8.60s/epoch, loss=0.974, accuracy=0.608, val_loss=1.29, val_accuracy=0.504] 
 79%|███████▉  | 30/38 [04:32<01:09,  8.65s/epoch, loss=1.16, accuracy=0.602, val_loss=1.13, val_accuracy=0.502] 
 82%|████████▏ | 31/38 [04:40<01:00,  8.65s/epoch, loss=1.1, accuracy=0.572, val_loss=1.05, val_accuracy=0.59]  
 84%|████████▍ | 32/38 [04:49<00:52,  8.70s/epoch, loss=1.01, accuracy=0.567, val_loss=0.945, val_accuracy=0.595]
 87%|████████▋ | 33/38 [04:58<00:43,  8.70s/epoch, loss=0.927, accuracy=0.609, val_loss=0.909, val_accuracy=0.608]
 89%|████████▉ | 34/38 [05:06<00:34,  8.71s/epoch, loss=0.879, accuracy=0.608, val_loss=0.878, val_accuracy=0.592]
 92%|█████████▏| 35/38 [05:15<00:26,  8.73s/epoch, loss=0.846, accuracy=0.628, val_loss=0.85, val_accuracy=0.627] 
 95%|█████████▍| 36/38 [05:24<00:17,  8.74s/epoch, loss=1.02, accuracy=0.625, val_loss=1.63, val_accuracy=0.588] 
 97%|█████████▋| 37/38 [05:33<00:08,  8.70s/epoch, loss=1.56, accuracy=0.649, val_loss=1.51, val_accuracy=0.629]
100%|██████████| 38/38 [05:41<00:00,  8.72s/epoch, loss=1.4, accuracy=0.624, val_loss=1.38, val_accuracy=0.553] 
100%|██████████| 38/38 [05:41<00:00,  9.00s/epoch, loss=1.4, accuracy=0.624, val_loss=1.38, val_accuracy=0.553]
Test score: 0.589070200920105
Test accuracy: 0.8446800112724304

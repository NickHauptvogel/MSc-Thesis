Fri Mar  1 12:54:41 2024       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 545.23.08              Driver Version: 545.23.08    CUDA Version: 12.3     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA TITAN Xp                Off | 00000000:03:00.0 Off |                  N/A |
| 43%   69C    P0              91W / 250W |      0MiB / 12288MiB |      0%      Default |
|                                         |                      |                  N/A |
+-----------------------------------------+----------------------+----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
|  No running processes found                                                           |
+---------------------------------------------------------------------------------------+


* * * Run SGD for cluster size = 16. * * *


Budget: 31


* * * Run SGD for ID = 16_1. * * *


2024-03-01 12:54:42.732636: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 12:54:52.495892: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 12:54:52.497560: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-01 12:54:52.542116: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 12:54:52.542173: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 12:54:52.628236: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 12:54:52.628323: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 12:54:52.672637: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 12:54:52.809702: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 12:54:52.881342: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 12:54:52.930805: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 12:54:53.133779: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 12:54:53.134452: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 12:54:53.134563: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
<__array_function__ internals>:5: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:159: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_train, y_train = np.array(xs[:idx]), np.array(labels[:idx])
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:160: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_test, y_test = np.array(xs[idx:]), np.array(labels[idx:])
2024-03-01 12:54:59.339915: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-01 12:54:59.340373: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 12:54:59.341344: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 12:54:59.341381: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 12:54:59.341449: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 12:54:59.341472: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 12:54:59.341493: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 12:54:59.341514: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 12:54:59.341534: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 12:54:59.341555: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 12:54:59.341578: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 12:54:59.342034: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 12:54:59.342069: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 12:55:00.684936: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-01 12:55:00.685004: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-01 12:55:00.685014: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-01 12:55:00.686354: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:03:00.0, compute capability: 6.1)
{'id': '16_01', 'seed': 1, 'out_folder': 'results/epoch_budget', 'batch_size': 32, 'epochs': 31, 'validation_split': 0.2, 'checkpointing': True, 'initial_lr': 0.1, 'momentum': 0.98, 'nesterov': True, 'bootstrapping': False, 'map_optimizer': True, 'model': 'CNN-LSTM', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Loading data...
Pad sequences (samples x time)
20000 train sequences
5000 validation sequences
25000 test sequences
x_train shape: (20000, 100)
x_val shape: (5000, 100)
x_test shape: (25000, 100)
Using MAP optimizer with reg_weight:  5e-05
CNN-LSTM

0epoch [00:00, ?epoch/s]
  0%|          | 0/31 [00:00<?, ?epoch/s]2024-03-01 12:55:01.149001: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-01 12:55:01.160966: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199945000 Hz
2024-03-01 12:55:02.757358: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 12:55:03.080376: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 12:55:05.565902: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-01 12:55:05.637279: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.

  3%|▎         | 1/31 [00:14<07:05, 14.17s/epoch, loss=0.696, accuracy=0.596, val_loss=0.503, val_accuracy=0.795]
  6%|▋         | 2/31 [00:20<04:41,  9.72s/epoch, loss=0.473, accuracy=0.82, val_loss=0.447, val_accuracy=0.84]  
 10%|▉         | 3/31 [00:27<03:52,  8.31s/epoch, loss=0.433, accuracy=0.856, val_loss=0.47, val_accuracy=0.848]
 13%|█▎        | 4/31 [00:33<03:22,  7.51s/epoch, loss=0.449, accuracy=0.87, val_loss=0.544, val_accuracy=0.837]
 16%|█▌        | 5/31 [00:39<03:03,  7.07s/epoch, loss=0.517, accuracy=0.86, val_loss=0.685, val_accuracy=0.792]
 19%|█▉        | 6/31 [00:46<02:50,  6.81s/epoch, loss=0.91, accuracy=0.695, val_loss=1, val_accuracy=0.691]    
 23%|██▎       | 7/31 [00:52<02:39,  6.63s/epoch, loss=1.1, accuracy=0.627, val_loss=1.16, val_accuracy=0.575]
 26%|██▌       | 8/31 [00:58<02:30,  6.53s/epoch, loss=1.12, accuracy=0.585, val_loss=1.11, val_accuracy=0.557]
 29%|██▉       | 9/31 [01:05<02:22,  6.45s/epoch, loss=1.07, accuracy=0.581, val_loss=1.02, val_accuracy=0.601]
 32%|███▏      | 10/31 [01:11<02:14,  6.40s/epoch, loss=1, accuracy=0.589, val_loss=0.956, val_accuracy=0.616] 
 35%|███▌      | 11/31 [01:17<02:06,  6.32s/epoch, loss=0.968, accuracy=0.607, val_loss=0.962, val_accuracy=0.631]
 39%|███▊      | 12/31 [01:23<01:58,  6.26s/epoch, loss=0.972, accuracy=0.616, val_loss=0.969, val_accuracy=0.608]
 42%|████▏     | 13/31 [01:29<01:51,  6.22s/epoch, loss=0.977, accuracy=0.602, val_loss=1.04, val_accuracy=0.603] 
 45%|████▌     | 14/31 [01:35<01:45,  6.20s/epoch, loss=0.946, accuracy=0.614, val_loss=0.998, val_accuracy=0.582]
 48%|████▊     | 15/31 [01:42<01:38,  6.18s/epoch, loss=0.948, accuracy=0.612, val_loss=0.925, val_accuracy=0.637]
 52%|█████▏    | 16/31 [01:48<01:32,  6.15s/epoch, loss=0.974, accuracy=0.555, val_loss=1.03, val_accuracy=0.526] 
 55%|█████▍    | 17/31 [01:54<01:26,  6.16s/epoch, loss=0.944, accuracy=0.56, val_loss=0.911, val_accuracy=0.603]
 58%|█████▊    | 18/31 [02:00<01:19,  6.15s/epoch, loss=0.885, accuracy=0.62, val_loss=0.868, val_accuracy=0.629]
 61%|██████▏   | 19/31 [02:06<01:13,  6.13s/epoch, loss=0.883, accuracy=0.602, val_loss=0.883, val_accuracy=0.624]
 65%|██████▍   | 20/31 [02:12<01:07,  6.14s/epoch, loss=0.861, accuracy=0.61, val_loss=0.834, val_accuracy=0.643] 
 68%|██████▊   | 21/31 [02:18<01:01,  6.13s/epoch, loss=0.836, accuracy=0.636, val_loss=0.825, val_accuracy=0.635]
 71%|███████   | 22/31 [02:24<00:55,  6.14s/epoch, loss=0.86, accuracy=0.629, val_loss=0.904, val_accuracy=0.634] 
 74%|███████▍  | 23/31 [02:31<00:49,  6.14s/epoch, loss=0.857, accuracy=0.633, val_loss=0.843, val_accuracy=0.634]
 77%|███████▋  | 24/31 [02:37<00:43,  6.15s/epoch, loss=0.836, accuracy=0.636, val_loss=0.831, val_accuracy=0.635]
 81%|████████  | 25/31 [02:43<00:36,  6.15s/epoch, loss=0.834, accuracy=0.638, val_loss=0.833, val_accuracy=0.639]
 84%|████████▍ | 26/31 [02:49<00:30,  6.15s/epoch, loss=0.86, accuracy=0.634, val_loss=0.899, val_accuracy=0.555] 
 87%|████████▋ | 27/31 [02:55<00:24,  6.14s/epoch, loss=0.862, accuracy=0.644, val_loss=0.909, val_accuracy=0.605]
 90%|█████████ | 28/31 [03:01<00:18,  6.14s/epoch, loss=0.878, accuracy=0.624, val_loss=0.876, val_accuracy=0.62] 
 94%|█████████▎| 29/31 [03:08<00:12,  6.14s/epoch, loss=0.854, accuracy=0.652, val_loss=0.974, val_accuracy=0.592]
 97%|█████████▋| 30/31 [03:14<00:06,  6.13s/epoch, loss=0.962, accuracy=0.607, val_loss=0.951, val_accuracy=0.612]
100%|██████████| 31/31 [03:20<00:00,  6.14s/epoch, loss=0.953, accuracy=0.582, val_loss=0.928, val_accuracy=0.574]
100%|██████████| 31/31 [03:20<00:00,  6.46s/epoch, loss=0.953, accuracy=0.582, val_loss=0.928, val_accuracy=0.574]
Test score: 0.48212137818336487
Test accuracy: 0.8417999744415283


* * * Run SGD for ID = 16_2. * * *


2024-03-01 12:58:27.246044: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 12:58:30.670911: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 12:58:30.671970: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-01 12:58:30.731414: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 12:58:30.731458: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 12:58:30.734393: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 12:58:30.734435: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 12:58:30.736612: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 12:58:30.737358: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 12:58:30.739870: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 12:58:30.741450: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 12:58:30.746117: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 12:58:30.753306: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 12:58:30.753406: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
<__array_function__ internals>:5: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:159: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_train, y_train = np.array(xs[:idx]), np.array(labels[:idx])
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:160: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_test, y_test = np.array(xs[idx:]), np.array(labels[idx:])
2024-03-01 12:58:36.536720: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-01 12:58:36.537178: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 12:58:36.538422: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 12:58:36.538462: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 12:58:36.538510: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 12:58:36.538532: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 12:58:36.538552: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 12:58:36.538571: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 12:58:36.538589: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 12:58:36.538608: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 12:58:36.538627: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 12:58:36.539083: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 12:58:36.539135: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 12:58:37.275688: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-01 12:58:37.275740: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-01 12:58:37.275751: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-01 12:58:37.276649: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:03:00.0, compute capability: 6.1)
{'id': '16_02', 'seed': 2, 'out_folder': 'results/epoch_budget', 'batch_size': 32, 'epochs': 31, 'validation_split': 0.2, 'checkpointing': True, 'initial_lr': 0.1, 'momentum': 0.98, 'nesterov': True, 'bootstrapping': False, 'map_optimizer': True, 'model': 'CNN-LSTM', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Loading data...
Pad sequences (samples x time)
20000 train sequences
5000 validation sequences
25000 test sequences
x_train shape: (20000, 100)
x_val shape: (5000, 100)
x_test shape: (25000, 100)
Using MAP optimizer with reg_weight:  5e-05
CNN-LSTM

0epoch [00:00, ?epoch/s]
  0%|          | 0/31 [00:00<?, ?epoch/s]2024-03-01 12:58:37.710776: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-01 12:58:37.722958: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199945000 Hz
2024-03-01 12:58:39.329964: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 12:58:39.529347: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 12:58:40.282077: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-01 12:58:40.314449: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.

  3%|▎         | 1/31 [00:11<05:56, 11.88s/epoch, loss=0.664, accuracy=0.634, val_loss=0.51, val_accuracy=0.793]
  6%|▋         | 2/31 [00:18<04:11,  8.68s/epoch, loss=0.475, accuracy=0.821, val_loss=0.474, val_accuracy=0.831]
 10%|▉         | 3/31 [00:24<03:30,  7.52s/epoch, loss=0.425, accuracy=0.861, val_loss=0.507, val_accuracy=0.814]
 13%|█▎        | 4/31 [00:30<03:10,  7.07s/epoch, loss=0.432, accuracy=0.873, val_loss=0.518, val_accuracy=0.835]
 16%|█▌        | 5/31 [00:37<02:55,  6.74s/epoch, loss=0.454, accuracy=0.882, val_loss=0.574, val_accuracy=0.835]
 19%|█▉        | 6/31 [00:43<02:44,  6.59s/epoch, loss=0.474, accuracy=0.891, val_loss=0.608, val_accuracy=0.836]
 23%|██▎       | 7/31 [00:49<02:34,  6.45s/epoch, loss=0.505, accuracy=0.891, val_loss=0.691, val_accuracy=0.817]
 26%|██▌       | 8/31 [00:55<02:25,  6.34s/epoch, loss=0.703, accuracy=0.825, val_loss=0.935, val_accuracy=0.747]
 29%|██▉       | 9/31 [01:01<02:18,  6.28s/epoch, loss=1.03, accuracy=0.713, val_loss=1.21, val_accuracy=0.625]  
 32%|███▏      | 10/31 [01:07<02:10,  6.23s/epoch, loss=1.23, accuracy=0.567, val_loss=1.23, val_accuracy=0.58]
 35%|███▌      | 11/31 [01:14<02:04,  6.21s/epoch, loss=1.21, accuracy=0.55, val_loss=1.17, val_accuracy=0.571]
 39%|███▊      | 12/31 [01:20<01:57,  6.19s/epoch, loss=1.12, accuracy=0.53, val_loss=1.13, val_accuracy=0.491]
 42%|████▏     | 13/31 [01:26<01:51,  6.18s/epoch, loss=1.04, accuracy=0.52, val_loss=0.997, val_accuracy=0.511]
 45%|████▌     | 14/31 [01:32<01:44,  6.17s/epoch, loss=0.943, accuracy=0.557, val_loss=0.959, val_accuracy=0.513]
 48%|████▊     | 15/31 [01:38<01:38,  6.16s/epoch, loss=0.88, accuracy=0.622, val_loss=0.876, val_accuracy=0.652] 
 52%|█████▏    | 16/31 [01:44<01:32,  6.17s/epoch, loss=0.89, accuracy=0.62, val_loss=0.847, val_accuracy=0.678] 
 55%|█████▍    | 17/31 [01:50<01:26,  6.16s/epoch, loss=0.887, accuracy=0.648, val_loss=0.904, val_accuracy=0.648]
 58%|█████▊    | 18/31 [01:57<01:20,  6.16s/epoch, loss=0.921, accuracy=0.631, val_loss=0.914, val_accuracy=0.649]
 61%|██████▏   | 19/31 [02:03<01:13,  6.16s/epoch, loss=0.968, accuracy=0.587, val_loss=0.968, val_accuracy=0.586]
 65%|██████▍   | 20/31 [02:09<01:07,  6.14s/epoch, loss=0.933, accuracy=0.595, val_loss=0.906, val_accuracy=0.641]
 68%|██████▊   | 21/31 [02:15<01:01,  6.14s/epoch, loss=0.968, accuracy=0.585, val_loss=0.954, val_accuracy=0.572]
 71%|███████   | 22/31 [02:21<00:55,  6.13s/epoch, loss=0.972, accuracy=0.548, val_loss=0.94, val_accuracy=0.595] 
 74%|███████▍  | 23/31 [02:27<00:49,  6.14s/epoch, loss=0.975, accuracy=0.555, val_loss=0.942, val_accuracy=0.564]
 77%|███████▋  | 24/31 [02:33<00:42,  6.14s/epoch, loss=0.923, accuracy=0.593, val_loss=0.89, val_accuracy=0.615] 
 81%|████████  | 25/31 [02:40<00:36,  6.14s/epoch, loss=0.896, accuracy=0.595, val_loss=0.863, val_accuracy=0.645]
 84%|████████▍ | 26/31 [02:46<00:30,  6.14s/epoch, loss=0.874, accuracy=0.61, val_loss=0.836, val_accuracy=0.645] 
 87%|████████▋ | 27/31 [02:52<00:24,  6.14s/epoch, loss=0.821, accuracy=0.656, val_loss=0.915, val_accuracy=0.599]
 90%|█████████ | 28/31 [02:58<00:18,  6.15s/epoch, loss=0.859, accuracy=0.64, val_loss=0.886, val_accuracy=0.597] 
 94%|█████████▎| 29/31 [03:04<00:12,  6.16s/epoch, loss=0.897, accuracy=0.607, val_loss=0.888, val_accuracy=0.622]
 97%|█████████▋| 30/31 [03:10<00:06,  6.17s/epoch, loss=0.91, accuracy=0.602, val_loss=0.902, val_accuracy=0.604] 
100%|██████████| 31/31 [03:17<00:00,  6.19s/epoch, loss=0.886, accuracy=0.61, val_loss=0.845, val_accuracy=0.631]
100%|██████████| 31/31 [03:17<00:00,  6.36s/epoch, loss=0.886, accuracy=0.61, val_loss=0.845, val_accuracy=0.631]
Test score: 0.6068905591964722
Test accuracy: 0.8377199769020081


* * * Run SGD for ID = 16_3. * * *


2024-03-01 13:02:00.796347: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:02:04.460448: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:02:04.461638: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-01 13:02:04.504393: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:02:04.504436: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:02:04.507997: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:02:04.508044: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:02:04.510233: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:02:04.511020: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:02:04.513479: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:02:04.515015: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:02:04.519583: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:02:04.521055: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:02:04.521152: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
<__array_function__ internals>:5: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:159: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_train, y_train = np.array(xs[:idx]), np.array(labels[:idx])
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:160: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_test, y_test = np.array(xs[idx:]), np.array(labels[idx:])
2024-03-01 13:02:10.539944: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-01 13:02:10.540555: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:02:10.541062: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:02:10.541101: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:02:10.541189: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:02:10.541212: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:02:10.541233: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:02:10.541252: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:02:10.541271: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:02:10.541291: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:02:10.541311: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:02:10.541734: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:02:10.541769: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:02:11.283279: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-01 13:02:11.283324: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-01 13:02:11.283333: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-01 13:02:11.302409: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:03:00.0, compute capability: 6.1)
{'id': '16_03', 'seed': 3, 'out_folder': 'results/epoch_budget', 'batch_size': 32, 'epochs': 31, 'validation_split': 0.2, 'checkpointing': True, 'initial_lr': 0.1, 'momentum': 0.98, 'nesterov': True, 'bootstrapping': False, 'map_optimizer': True, 'model': 'CNN-LSTM', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Loading data...
Pad sequences (samples x time)
20000 train sequences
5000 validation sequences
25000 test sequences
x_train shape: (20000, 100)
x_val shape: (5000, 100)
x_test shape: (25000, 100)
Using MAP optimizer with reg_weight:  5e-05
CNN-LSTM

0epoch [00:00, ?epoch/s]
  0%|          | 0/31 [00:00<?, ?epoch/s]2024-03-01 13:02:11.750085: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-01 13:02:11.761965: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199945000 Hz
2024-03-01 13:02:13.412783: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:02:13.596991: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:02:14.312259: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-01 13:02:14.344985: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.

  3%|▎         | 1/31 [00:11<05:48, 11.60s/epoch, loss=0.639, accuracy=0.666, val_loss=0.478, val_accuracy=0.816]
  6%|▋         | 2/31 [00:18<04:12,  8.71s/epoch, loss=0.454, accuracy=0.836, val_loss=0.448, val_accuracy=0.842]
 10%|▉         | 3/31 [00:24<03:33,  7.62s/epoch, loss=0.417, accuracy=0.867, val_loss=0.565, val_accuracy=0.816]
 13%|█▎        | 4/31 [00:30<03:11,  7.10s/epoch, loss=0.459, accuracy=0.866, val_loss=0.626, val_accuracy=0.794]
 16%|█▌        | 5/31 [00:37<02:56,  6.81s/epoch, loss=0.626, accuracy=0.816, val_loss=0.758, val_accuracy=0.766]
 19%|█▉        | 6/31 [00:43<02:45,  6.63s/epoch, loss=0.843, accuracy=0.748, val_loss=1.05, val_accuracy=0.63]  
 23%|██▎       | 7/31 [00:49<02:36,  6.52s/epoch, loss=1.08, accuracy=0.662, val_loss=1.18, val_accuracy=0.539]
 26%|██▌       | 8/31 [00:56<02:28,  6.44s/epoch, loss=1.15, accuracy=0.6, val_loss=1.18, val_accuracy=0.602]  
 29%|██▉       | 9/31 [01:02<02:20,  6.39s/epoch, loss=1.13, accuracy=0.573, val_loss=1.1, val_accuracy=0.564]
 32%|███▏      | 10/31 [01:08<02:13,  6.35s/epoch, loss=1.11, accuracy=0.585, val_loss=1.1, val_accuracy=0.62]
 35%|███▌      | 11/31 [01:14<02:06,  6.34s/epoch, loss=1.13, accuracy=0.529, val_loss=1.09, val_accuracy=0.556]
 39%|███▊      | 12/31 [01:21<02:00,  6.32s/epoch, loss=1.09, accuracy=0.524, val_loss=1.15, val_accuracy=0.493]
 42%|████▏     | 13/31 [01:27<01:53,  6.30s/epoch, loss=1.03, accuracy=0.524, val_loss=0.977, val_accuracy=0.559]
 45%|████▌     | 14/31 [01:33<01:46,  6.29s/epoch, loss=0.953, accuracy=0.544, val_loss=0.919, val_accuracy=0.531]
 48%|████▊     | 15/31 [01:39<01:40,  6.28s/epoch, loss=0.892, accuracy=0.56, val_loss=0.845, val_accuracy=0.586] 
 52%|█████▏    | 16/31 [01:46<01:34,  6.28s/epoch, loss=0.857, accuracy=0.604, val_loss=0.85, val_accuracy=0.605]
 55%|█████▍    | 17/31 [01:52<01:27,  6.28s/epoch, loss=0.82, accuracy=0.634, val_loss=0.799, val_accuracy=0.653]
 58%|█████▊    | 18/31 [01:58<01:21,  6.27s/epoch, loss=0.783, accuracy=0.661, val_loss=0.799, val_accuracy=0.666]
 61%|██████▏   | 19/31 [02:05<01:15,  6.28s/epoch, loss=0.856, accuracy=0.622, val_loss=0.925, val_accuracy=0.532]
 65%|██████▍   | 20/31 [02:11<01:09,  6.29s/epoch, loss=0.877, accuracy=0.631, val_loss=0.876, val_accuracy=0.654]
 68%|██████▊   | 21/31 [02:17<01:02,  6.25s/epoch, loss=0.89, accuracy=0.629, val_loss=0.864, val_accuracy=0.652] 
 71%|███████   | 22/31 [02:23<00:56,  6.23s/epoch, loss=0.861, accuracy=0.648, val_loss=0.883, val_accuracy=0.607]
 74%|███████▍  | 23/31 [02:29<00:49,  6.21s/epoch, loss=0.858, accuracy=0.654, val_loss=0.955, val_accuracy=0.589]
 77%|███████▋  | 24/31 [02:36<00:43,  6.21s/epoch, loss=0.851, accuracy=0.656, val_loss=0.874, val_accuracy=0.638]
 81%|████████  | 25/31 [02:42<00:37,  6.23s/epoch, loss=0.881, accuracy=0.643, val_loss=0.972, val_accuracy=0.651]
 84%|████████▍ | 26/31 [02:48<00:31,  6.21s/epoch, loss=0.993, accuracy=0.654, val_loss=0.99, val_accuracy=0.636] 
 87%|████████▋ | 27/31 [02:54<00:24,  6.21s/epoch, loss=0.995, accuracy=0.621, val_loss=1, val_accuracy=0.593]   
 90%|█████████ | 28/31 [03:01<00:18,  6.23s/epoch, loss=0.975, accuracy=0.598, val_loss=0.939, val_accuracy=0.619]
 94%|█████████▎| 29/31 [03:07<00:12,  6.23s/epoch, loss=0.915, accuracy=0.622, val_loss=0.877, val_accuracy=0.648]
 97%|█████████▋| 30/31 [03:13<00:06,  6.23s/epoch, loss=0.863, accuracy=0.656, val_loss=0.87, val_accuracy=0.651] 
100%|██████████| 31/31 [03:19<00:00,  6.24s/epoch, loss=0.846, accuracy=0.678, val_loss=0.843, val_accuracy=0.676]
100%|██████████| 31/31 [03:19<00:00,  6.44s/epoch, loss=0.846, accuracy=0.678, val_loss=0.843, val_accuracy=0.676]
Test score: 0.4390380382537842
Test accuracy: 0.8432000279426575


* * * Run SGD for ID = 16_4. * * *


2024-03-01 13:05:37.265264: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:05:39.758858: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:05:39.759860: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-01 13:05:39.798777: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:05:39.798805: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:05:39.801777: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:05:39.801818: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:05:39.804099: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:05:39.804775: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:05:39.807347: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:05:39.808889: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:05:39.813562: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:05:39.814061: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:05:39.814174: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
<__array_function__ internals>:5: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:159: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_train, y_train = np.array(xs[:idx]), np.array(labels[:idx])
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:160: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_test, y_test = np.array(xs[idx:]), np.array(labels[idx:])
2024-03-01 13:05:45.357656: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-01 13:05:45.358196: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:05:45.358725: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:05:45.358757: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:05:45.358802: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:05:45.358821: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:05:45.358882: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:05:45.358903: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:05:45.358922: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:05:45.358941: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:05:45.358960: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:05:45.368383: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:05:45.368422: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:05:46.043759: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-01 13:05:46.043814: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-01 13:05:46.043835: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-01 13:05:46.050994: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:03:00.0, compute capability: 6.1)
{'id': '16_04', 'seed': 4, 'out_folder': 'results/epoch_budget', 'batch_size': 32, 'epochs': 31, 'validation_split': 0.2, 'checkpointing': True, 'initial_lr': 0.1, 'momentum': 0.98, 'nesterov': True, 'bootstrapping': False, 'map_optimizer': True, 'model': 'CNN-LSTM', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Loading data...
Pad sequences (samples x time)
20000 train sequences
5000 validation sequences
25000 test sequences
x_train shape: (20000, 100)
x_val shape: (5000, 100)
x_test shape: (25000, 100)
Using MAP optimizer with reg_weight:  5e-05
CNN-LSTM

0epoch [00:00, ?epoch/s]
  0%|          | 0/31 [00:00<?, ?epoch/s]2024-03-01 13:05:46.466197: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-01 13:05:46.477976: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199945000 Hz
2024-03-01 13:05:47.990068: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:05:48.182596: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:05:48.866408: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-01 13:05:48.896426: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.

  3%|▎         | 1/31 [00:12<06:04, 12.15s/epoch, loss=0.667, accuracy=0.624, val_loss=0.517, val_accuracy=0.795]
  6%|▋         | 2/31 [00:19<04:23,  9.08s/epoch, loss=0.479, accuracy=0.822, val_loss=0.455, val_accuracy=0.836]
 10%|▉         | 3/31 [00:25<03:38,  7.79s/epoch, loss=0.508, accuracy=0.829, val_loss=0.622, val_accuracy=0.806]
 13%|█▎        | 4/31 [00:31<03:13,  7.18s/epoch, loss=0.751, accuracy=0.739, val_loss=0.816, val_accuracy=0.743]
 16%|█▌        | 5/31 [00:37<02:57,  6.84s/epoch, loss=0.952, accuracy=0.644, val_loss=1.04, val_accuracy=0.584] 
 19%|█▉        | 6/31 [00:44<02:45,  6.64s/epoch, loss=1.04, accuracy=0.616, val_loss=1.1, val_accuracy=0.617]  
 23%|██▎       | 7/31 [00:50<02:35,  6.50s/epoch, loss=1.14, accuracy=0.562, val_loss=1.1, val_accuracy=0.501]
 26%|██▌       | 8/31 [00:56<02:27,  6.41s/epoch, loss=1.08, accuracy=0.543, val_loss=1.06, val_accuracy=0.502]
 29%|██▉       | 9/31 [01:02<02:19,  6.36s/epoch, loss=1.04, accuracy=0.522, val_loss=1, val_accuracy=0.502]   
 32%|███▏      | 10/31 [01:08<02:12,  6.32s/epoch, loss=0.981, accuracy=0.531, val_loss=0.93, val_accuracy=0.578]
 35%|███▌      | 11/31 [01:15<02:05,  6.29s/epoch, loss=0.936, accuracy=0.551, val_loss=0.91, val_accuracy=0.571]
 39%|███▊      | 12/31 [01:21<01:59,  6.27s/epoch, loss=0.901, accuracy=0.561, val_loss=0.901, val_accuracy=0.58]
 42%|████▏     | 13/31 [01:27<01:52,  6.26s/epoch, loss=0.93, accuracy=0.562, val_loss=0.906, val_accuracy=0.577]
 45%|████▌     | 14/31 [01:33<01:46,  6.26s/epoch, loss=0.884, accuracy=0.592, val_loss=0.862, val_accuracy=0.624]
 48%|████▊     | 15/31 [01:40<01:40,  6.25s/epoch, loss=0.837, accuracy=0.639, val_loss=0.828, val_accuracy=0.673]
 52%|█████▏    | 16/31 [01:46<01:33,  6.26s/epoch, loss=0.866, accuracy=0.634, val_loss=0.973, val_accuracy=0.591]
 55%|█████▍    | 17/31 [01:52<01:27,  6.25s/epoch, loss=0.915, accuracy=0.599, val_loss=0.897, val_accuracy=0.619]
 58%|█████▊    | 18/31 [01:58<01:21,  6.25s/epoch, loss=0.903, accuracy=0.628, val_loss=0.913, val_accuracy=0.619]
 61%|██████▏   | 19/31 [02:05<01:15,  6.25s/epoch, loss=0.9, accuracy=0.623, val_loss=0.872, val_accuracy=0.621]  
 65%|██████▍   | 20/31 [02:11<01:08,  6.24s/epoch, loss=0.884, accuracy=0.63, val_loss=0.861, val_accuracy=0.641]
 68%|██████▊   | 21/31 [02:17<01:02,  6.23s/epoch, loss=0.896, accuracy=0.614, val_loss=0.928, val_accuracy=0.59]
 71%|███████   | 22/31 [02:23<00:56,  6.23s/epoch, loss=0.916, accuracy=0.576, val_loss=0.886, val_accuracy=0.613]
 74%|███████▍  | 23/31 [02:30<00:49,  6.22s/epoch, loss=0.897, accuracy=0.6, val_loss=0.933, val_accuracy=0.583]  
 77%|███████▋  | 24/31 [02:36<00:43,  6.22s/epoch, loss=0.865, accuracy=0.612, val_loss=0.837, val_accuracy=0.666]
 81%|████████  | 25/31 [02:42<00:37,  6.22s/epoch, loss=0.848, accuracy=0.618, val_loss=0.841, val_accuracy=0.643]
 84%|████████▍ | 26/31 [02:48<00:31,  6.23s/epoch, loss=0.862, accuracy=0.622, val_loss=0.887, val_accuracy=0.618]
 87%|████████▋ | 27/31 [02:54<00:24,  6.23s/epoch, loss=0.916, accuracy=0.6, val_loss=0.918, val_accuracy=0.611]  
 90%|█████████ | 28/31 [03:01<00:18,  6.24s/epoch, loss=0.919, accuracy=0.569, val_loss=0.877, val_accuracy=0.601]
 94%|█████████▎| 29/31 [03:07<00:12,  6.24s/epoch, loss=0.878, accuracy=0.61, val_loss=0.828, val_accuracy=0.649] 
 97%|█████████▋| 30/31 [03:13<00:06,  6.25s/epoch, loss=0.857, accuracy=0.61, val_loss=1.07, val_accuracy=0.429] 
100%|██████████| 31/31 [03:19<00:00,  6.24s/epoch, loss=0.875, accuracy=0.603, val_loss=0.969, val_accuracy=0.499]
100%|██████████| 31/31 [03:19<00:00,  6.45s/epoch, loss=0.875, accuracy=0.603, val_loss=0.969, val_accuracy=0.499]
Test score: 0.4575740694999695
Test accuracy: 0.8385999798774719


* * * Run SGD for ID = 16_5. * * *


2024-03-01 13:09:12.354436: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:09:15.761379: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:09:15.762419: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-01 13:09:15.803230: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:09:15.803259: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:09:15.806260: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:09:15.806300: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:09:15.808583: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:09:15.809648: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:09:15.812253: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:09:15.813720: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:09:15.818381: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:09:15.818864: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:09:15.818956: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
<__array_function__ internals>:5: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:159: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_train, y_train = np.array(xs[:idx]), np.array(labels[:idx])
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:160: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_test, y_test = np.array(xs[idx:]), np.array(labels[idx:])
2024-03-01 13:09:21.696717: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-01 13:09:21.697214: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:09:21.699633: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:09:21.699680: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:09:21.699749: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:09:21.699770: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:09:21.699789: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:09:21.699807: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:09:21.699833: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:09:21.699890: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:09:21.699911: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:09:21.700365: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:09:21.700397: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:09:22.394628: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-01 13:09:22.394681: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-01 13:09:22.394691: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-01 13:09:22.395597: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:03:00.0, compute capability: 6.1)
{'id': '16_05', 'seed': 5, 'out_folder': 'results/epoch_budget', 'batch_size': 32, 'epochs': 31, 'validation_split': 0.2, 'checkpointing': True, 'initial_lr': 0.1, 'momentum': 0.98, 'nesterov': True, 'bootstrapping': False, 'map_optimizer': True, 'model': 'CNN-LSTM', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Loading data...
Pad sequences (samples x time)
20000 train sequences
5000 validation sequences
25000 test sequences
x_train shape: (20000, 100)
x_val shape: (5000, 100)
x_test shape: (25000, 100)
Using MAP optimizer with reg_weight:  5e-05
CNN-LSTM

0epoch [00:00, ?epoch/s]
  0%|          | 0/31 [00:00<?, ?epoch/s]2024-03-01 13:09:22.824336: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-01 13:09:22.835973: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199945000 Hz
2024-03-01 13:09:24.387800: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:09:24.568886: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:09:25.253949: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-01 13:09:25.284122: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.

  3%|▎         | 1/31 [00:11<05:43, 11.44s/epoch, loss=0.731, accuracy=0.54, val_loss=0.624, val_accuracy=0.717]
  6%|▋         | 2/31 [00:18<04:10,  8.64s/epoch, loss=0.541, accuracy=0.777, val_loss=0.525, val_accuracy=0.785]
 10%|▉         | 3/31 [00:24<03:33,  7.64s/epoch, loss=0.447, accuracy=0.843, val_loss=0.471, val_accuracy=0.837]
 13%|█▎        | 4/31 [00:30<03:11,  7.08s/epoch, loss=0.482, accuracy=0.847, val_loss=0.597, val_accuracy=0.806]
 16%|█▌        | 5/31 [00:37<02:56,  6.78s/epoch, loss=0.661, accuracy=0.798, val_loss=0.837, val_accuracy=0.722]
 19%|█▉        | 6/31 [00:43<02:44,  6.59s/epoch, loss=0.923, accuracy=0.695, val_loss=1.05, val_accuracy=0.61]  
 23%|██▎       | 7/31 [00:49<02:35,  6.48s/epoch, loss=1.07, accuracy=0.579, val_loss=1.14, val_accuracy=0.55] 
 26%|██▌       | 8/31 [00:55<02:27,  6.41s/epoch, loss=1.02, accuracy=0.563, val_loss=0.999, val_accuracy=0.535]
 29%|██▉       | 9/31 [01:02<02:20,  6.37s/epoch, loss=0.997, accuracy=0.571, val_loss=0.946, val_accuracy=0.593]
 32%|███▏      | 10/31 [01:08<02:13,  6.34s/epoch, loss=0.937, accuracy=0.603, val_loss=0.969, val_accuracy=0.572]
 35%|███▌      | 11/31 [01:14<02:06,  6.32s/epoch, loss=0.951, accuracy=0.607, val_loss=1.02, val_accuracy=0.572] 
 39%|███▊      | 12/31 [01:20<01:59,  6.29s/epoch, loss=1.03, accuracy=0.598, val_loss=1.03, val_accuracy=0.536] 
 42%|████▏     | 13/31 [01:27<01:53,  6.29s/epoch, loss=0.991, accuracy=0.597, val_loss=0.967, val_accuracy=0.525]
 45%|████▌     | 14/31 [01:33<01:46,  6.27s/epoch, loss=0.947, accuracy=0.62, val_loss=0.946, val_accuracy=0.635] 
 48%|████▊     | 15/31 [01:39<01:40,  6.26s/epoch, loss=0.969, accuracy=0.635, val_loss=0.999, val_accuracy=0.617]
 52%|█████▏    | 16/31 [01:45<01:33,  6.25s/epoch, loss=0.959, accuracy=0.633, val_loss=0.998, val_accuracy=0.609]
 55%|█████▍    | 17/31 [01:51<01:27,  6.23s/epoch, loss=0.948, accuracy=0.627, val_loss=0.963, val_accuracy=0.639]
 58%|█████▊    | 18/31 [01:58<01:21,  6.23s/epoch, loss=0.935, accuracy=0.635, val_loss=0.925, val_accuracy=0.642]
 61%|██████▏   | 19/31 [02:04<01:14,  6.23s/epoch, loss=0.929, accuracy=0.631, val_loss=0.981, val_accuracy=0.497]
 65%|██████▍   | 20/31 [02:10<01:08,  6.24s/epoch, loss=0.937, accuracy=0.623, val_loss=0.955, val_accuracy=0.626]
 68%|██████▊   | 21/31 [02:16<01:02,  6.23s/epoch, loss=0.949, accuracy=0.602, val_loss=0.934, val_accuracy=0.586]
 71%|███████   | 22/31 [02:23<00:56,  6.24s/epoch, loss=0.906, accuracy=0.608, val_loss=0.899, val_accuracy=0.597]
 74%|███████▍  | 23/31 [02:29<00:49,  6.23s/epoch, loss=0.866, accuracy=0.627, val_loss=0.881, val_accuracy=0.611]
 77%|███████▋  | 24/31 [02:35<00:43,  6.24s/epoch, loss=0.823, accuracy=0.646, val_loss=0.822, val_accuracy=0.647]
 81%|████████  | 25/31 [02:41<00:37,  6.24s/epoch, loss=0.809, accuracy=0.65, val_loss=0.804, val_accuracy=0.643] 
 84%|████████▍ | 26/31 [02:48<00:31,  6.25s/epoch, loss=0.825, accuracy=0.659, val_loss=0.843, val_accuracy=0.658]
 87%|████████▋ | 27/31 [02:54<00:24,  6.25s/epoch, loss=0.85, accuracy=0.661, val_loss=0.976, val_accuracy=0.634] 
 90%|█████████ | 28/31 [03:00<00:18,  6.25s/epoch, loss=0.964, accuracy=0.63, val_loss=0.993, val_accuracy=0.625]
 94%|█████████▎| 29/31 [03:06<00:12,  6.24s/epoch, loss=1.01, accuracy=0.573, val_loss=0.959, val_accuracy=0.608]
 97%|█████████▋| 30/31 [03:13<00:06,  6.24s/epoch, loss=0.976, accuracy=0.602, val_loss=0.988, val_accuracy=0.603]
100%|██████████| 31/31 [03:19<00:00,  6.23s/epoch, loss=0.974, accuracy=0.6, val_loss=0.982, val_accuracy=0.553]  
100%|██████████| 31/31 [03:19<00:00,  6.43s/epoch, loss=0.974, accuracy=0.6, val_loss=0.982, val_accuracy=0.553]
Test score: 0.46631738543510437
Test accuracy: 0.8383600115776062


* * * Run SGD for ID = 16_6. * * *


2024-03-01 13:12:48.059891: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:12:51.339319: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:12:51.340381: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-01 13:12:51.378854: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:12:51.378886: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:12:51.381806: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:12:51.381874: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:12:51.384037: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:12:51.384670: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:12:51.387140: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:12:51.388832: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:12:51.393517: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:12:51.394012: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:12:51.394098: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
<__array_function__ internals>:5: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:159: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_train, y_train = np.array(xs[:idx]), np.array(labels[:idx])
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:160: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_test, y_test = np.array(xs[idx:]), np.array(labels[idx:])
2024-03-01 13:12:57.004940: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-01 13:12:57.005430: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:12:57.012548: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:12:57.012602: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:12:57.012647: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:12:57.012668: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:12:57.012693: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:12:57.012712: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:12:57.012730: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:12:57.012749: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:12:57.012767: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:12:57.013254: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:12:57.013291: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:12:57.679662: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-01 13:12:57.679713: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-01 13:12:57.679723: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-01 13:12:57.680615: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:03:00.0, compute capability: 6.1)
{'id': '16_06', 'seed': 6, 'out_folder': 'results/epoch_budget', 'batch_size': 32, 'epochs': 31, 'validation_split': 0.2, 'checkpointing': True, 'initial_lr': 0.1, 'momentum': 0.98, 'nesterov': True, 'bootstrapping': False, 'map_optimizer': True, 'model': 'CNN-LSTM', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Loading data...
Pad sequences (samples x time)
20000 train sequences
5000 validation sequences
25000 test sequences
x_train shape: (20000, 100)
x_val shape: (5000, 100)
x_test shape: (25000, 100)
Using MAP optimizer with reg_weight:  5e-05
CNN-LSTM

0epoch [00:00, ?epoch/s]
  0%|          | 0/31 [00:00<?, ?epoch/s]2024-03-01 13:12:58.098984: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-01 13:12:58.110955: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199945000 Hz
2024-03-01 13:12:59.648503: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:12:59.841314: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:13:00.536750: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-01 13:13:00.573775: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.

  3%|▎         | 1/31 [00:11<05:42, 11.42s/epoch, loss=0.637, accuracy=0.661, val_loss=0.49, val_accuracy=0.797]
  6%|▋         | 2/31 [00:18<04:16,  8.84s/epoch, loss=0.463, accuracy=0.832, val_loss=0.449, val_accuracy=0.842]
 10%|▉         | 3/31 [00:24<03:34,  7.66s/epoch, loss=0.442, accuracy=0.858, val_loss=0.526, val_accuracy=0.835]
 13%|█▎        | 4/31 [00:30<03:11,  7.10s/epoch, loss=0.482, accuracy=0.859, val_loss=0.578, val_accuracy=0.82] 
 16%|█▌        | 5/31 [00:37<02:56,  6.79s/epoch, loss=0.67, accuracy=0.808, val_loss=0.849, val_accuracy=0.734]
 19%|█▉        | 6/31 [00:43<02:45,  6.61s/epoch, loss=0.934, accuracy=0.702, val_loss=1.05, val_accuracy=0.62] 
 23%|██▎       | 7/31 [00:49<02:36,  6.50s/epoch, loss=1.1, accuracy=0.595, val_loss=1.1, val_accuracy=0.586]  
 26%|██▌       | 8/31 [00:55<02:27,  6.42s/epoch, loss=1.04, accuracy=0.637, val_loss=1.01, val_accuracy=0.647]
 29%|██▉       | 9/31 [01:02<02:20,  6.38s/epoch, loss=1.04, accuracy=0.623, val_loss=1.01, val_accuracy=0.642]
 32%|███▏      | 10/31 [01:08<02:13,  6.35s/epoch, loss=1.01, accuracy=0.609, val_loss=1.12, val_accuracy=0.524]
 35%|███▌      | 11/31 [01:14<02:06,  6.33s/epoch, loss=0.987, accuracy=0.607, val_loss=0.947, val_accuracy=0.616]
 39%|███▊      | 12/31 [01:21<01:59,  6.29s/epoch, loss=1, accuracy=0.589, val_loss=1.16, val_accuracy=0.488]     
 42%|████▏     | 13/31 [01:27<01:52,  6.27s/epoch, loss=0.997, accuracy=0.566, val_loss=0.963, val_accuracy=0.598]
 45%|████▌     | 14/31 [01:33<01:46,  6.27s/epoch, loss=0.99, accuracy=0.548, val_loss=0.96, val_accuracy=0.565]  
 48%|████▊     | 15/31 [01:39<01:40,  6.26s/epoch, loss=0.946, accuracy=0.555, val_loss=0.912, val_accuracy=0.569]
 52%|█████▏    | 16/31 [01:46<01:33,  6.26s/epoch, loss=0.943, accuracy=0.572, val_loss=0.896, val_accuracy=0.59] 
 55%|█████▍    | 17/31 [01:52<01:27,  6.26s/epoch, loss=0.926, accuracy=0.573, val_loss=0.891, val_accuracy=0.604]
 58%|█████▊    | 18/31 [01:58<01:21,  6.26s/epoch, loss=0.87, accuracy=0.615, val_loss=0.86, val_accuracy=0.662]  
 61%|██████▏   | 19/31 [02:04<01:15,  6.26s/epoch, loss=0.901, accuracy=0.599, val_loss=0.912, val_accuracy=0.556]
 65%|██████▍   | 20/31 [02:11<01:08,  6.25s/epoch, loss=0.902, accuracy=0.601, val_loss=0.867, val_accuracy=0.608]
 68%|██████▊   | 21/31 [02:17<01:02,  6.26s/epoch, loss=0.918, accuracy=0.563, val_loss=0.899, val_accuracy=0.546]
 71%|███████   | 22/31 [02:23<00:56,  6.25s/epoch, loss=0.877, accuracy=0.6, val_loss=0.866, val_accuracy=0.572]  
 74%|███████▍  | 23/31 [02:29<00:49,  6.25s/epoch, loss=0.884, accuracy=0.598, val_loss=0.852, val_accuracy=0.631]
 77%|███████▋  | 24/31 [02:35<00:43,  6.24s/epoch, loss=0.884, accuracy=0.597, val_loss=1.02, val_accuracy=0.497] 
 81%|████████  | 25/31 [02:42<00:37,  6.23s/epoch, loss=0.872, accuracy=0.571, val_loss=0.844, val_accuracy=0.587]
 84%|████████▍ | 26/31 [02:48<00:31,  6.23s/epoch, loss=0.834, accuracy=0.605, val_loss=0.861, val_accuracy=0.664]
 87%|████████▋ | 27/31 [02:54<00:24,  6.23s/epoch, loss=1, accuracy=0.611, val_loss=0.992, val_accuracy=0.572]    
 90%|█████████ | 28/31 [03:00<00:18,  6.24s/epoch, loss=0.956, accuracy=0.625, val_loss=0.954, val_accuracy=0.512]
 94%|█████████▎| 29/31 [03:07<00:12,  6.24s/epoch, loss=0.928, accuracy=0.614, val_loss=0.915, val_accuracy=0.633]
 97%|█████████▋| 30/31 [03:13<00:06,  6.25s/epoch, loss=5.54, accuracy=0.619, val_loss=6.92, val_accuracy=0.512]  
100%|██████████| 31/31 [03:19<00:00,  6.26s/epoch, loss=6, accuracy=0.556, val_loss=5.24, val_accuracy=0.512]   
100%|██████████| 31/31 [03:19<00:00,  6.44s/epoch, loss=6, accuracy=0.556, val_loss=5.24, val_accuracy=0.512]
Test score: 0.44928252696990967
Test accuracy: 0.8432400226593018


* * * Run SGD for ID = 16_7. * * *


2024-03-01 13:16:23.668016: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:16:27.119313: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:16:27.120494: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-01 13:16:27.161064: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:16:27.161106: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:16:27.163977: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:16:27.164020: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:16:27.166280: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:16:27.167032: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:16:27.169482: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:16:27.170983: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:16:27.175419: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:16:27.175881: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:16:27.175978: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
<__array_function__ internals>:5: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:159: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_train, y_train = np.array(xs[:idx]), np.array(labels[:idx])
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:160: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_test, y_test = np.array(xs[idx:]), np.array(labels[idx:])
2024-03-01 13:16:32.728504: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-01 13:16:32.729049: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:16:32.729568: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:16:32.729601: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:16:32.729645: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:16:32.729666: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:16:32.729685: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:16:32.729703: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:16:32.729720: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:16:32.729745: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:16:32.729764: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:16:32.730261: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:16:32.730292: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:16:33.391980: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-01 13:16:33.392032: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-01 13:16:33.392042: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-01 13:16:33.394966: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:03:00.0, compute capability: 6.1)
{'id': '16_07', 'seed': 7, 'out_folder': 'results/epoch_budget', 'batch_size': 32, 'epochs': 31, 'validation_split': 0.2, 'checkpointing': True, 'initial_lr': 0.1, 'momentum': 0.98, 'nesterov': True, 'bootstrapping': False, 'map_optimizer': True, 'model': 'CNN-LSTM', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Loading data...
Pad sequences (samples x time)
20000 train sequences
5000 validation sequences
25000 test sequences
x_train shape: (20000, 100)
x_val shape: (5000, 100)
x_test shape: (25000, 100)
Using MAP optimizer with reg_weight:  5e-05
CNN-LSTM

0epoch [00:00, ?epoch/s]
  0%|          | 0/31 [00:00<?, ?epoch/s]2024-03-01 13:16:33.819631: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-01 13:16:33.831956: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199945000 Hz
2024-03-01 13:16:35.352719: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:16:35.536305: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:16:36.229969: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-01 13:16:36.267085: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.

  3%|▎         | 1/31 [00:11<05:37, 11.24s/epoch, loss=0.697, accuracy=0.594, val_loss=0.512, val_accuracy=0.79]
  6%|▋         | 2/31 [00:17<04:05,  8.48s/epoch, loss=0.492, accuracy=0.811, val_loss=0.463, val_accuracy=0.83]
 10%|▉         | 3/31 [00:24<03:28,  7.46s/epoch, loss=0.43, accuracy=0.855, val_loss=0.495, val_accuracy=0.828]
 13%|█▎        | 4/31 [00:30<03:15,  7.23s/epoch, loss=0.414, accuracy=0.874, val_loss=0.5, val_accuracy=0.835] 
 16%|█▌        | 5/31 [00:37<02:58,  6.88s/epoch, loss=0.419, accuracy=0.887, val_loss=0.585, val_accuracy=0.833]
 19%|█▉        | 6/31 [00:43<02:49,  6.78s/epoch, loss=0.442, accuracy=0.892, val_loss=0.558, val_accuracy=0.839]
 23%|██▎       | 7/31 [00:49<02:38,  6.60s/epoch, loss=0.479, accuracy=0.892, val_loss=0.699, val_accuracy=0.81] 
 26%|██▌       | 8/31 [00:56<02:28,  6.48s/epoch, loss=0.736, accuracy=0.813, val_loss=1.01, val_accuracy=0.663]
 29%|██▉       | 9/31 [01:02<02:21,  6.41s/epoch, loss=1.14, accuracy=0.633, val_loss=1.31, val_accuracy=0.506] 
 32%|███▏      | 10/31 [01:08<02:13,  6.36s/epoch, loss=1.19, accuracy=0.562, val_loss=1.18, val_accuracy=0.506]
 35%|███▌      | 11/31 [01:14<02:06,  6.34s/epoch, loss=1.12, accuracy=0.569, val_loss=1.11, val_accuracy=0.562]
 39%|███▊      | 12/31 [01:21<01:59,  6.31s/epoch, loss=1.07, accuracy=0.564, val_loss=1.08, val_accuracy=0.556]
 42%|████▏     | 13/31 [01:27<01:53,  6.29s/epoch, loss=1.03, accuracy=0.567, val_loss=1.01, val_accuracy=0.505]
 45%|████▌     | 14/31 [01:33<01:46,  6.29s/epoch, loss=0.983, accuracy=0.567, val_loss=0.943, val_accuracy=0.537]
 48%|████▊     | 15/31 [01:39<01:40,  6.26s/epoch, loss=0.955, accuracy=0.584, val_loss=0.998, val_accuracy=0.581]
 52%|█████▏    | 16/31 [01:46<01:33,  6.25s/epoch, loss=0.966, accuracy=0.571, val_loss=0.961, val_accuracy=0.502]
 55%|█████▍    | 17/31 [01:52<01:27,  6.25s/epoch, loss=0.968, accuracy=0.551, val_loss=0.907, val_accuracy=0.589]
 58%|█████▊    | 18/31 [01:58<01:21,  6.25s/epoch, loss=0.94, accuracy=0.579, val_loss=0.908, val_accuracy=0.581] 
 61%|██████▏   | 19/31 [02:04<01:15,  6.25s/epoch, loss=0.914, accuracy=0.559, val_loss=0.922, val_accuracy=0.573]
 65%|██████▍   | 20/31 [02:11<01:08,  6.25s/epoch, loss=0.891, accuracy=0.575, val_loss=0.887, val_accuracy=0.554]
 68%|██████▊   | 21/31 [02:17<01:02,  6.25s/epoch, loss=0.884, accuracy=0.581, val_loss=0.853, val_accuracy=0.606]
 71%|███████   | 22/31 [02:23<00:56,  6.24s/epoch, loss=0.857, accuracy=0.588, val_loss=0.829, val_accuracy=0.616]
 74%|███████▍  | 23/31 [02:29<00:49,  6.24s/epoch, loss=0.822, accuracy=0.623, val_loss=0.818, val_accuracy=0.617]
 77%|███████▋  | 24/31 [02:36<00:43,  6.25s/epoch, loss=0.833, accuracy=0.639, val_loss=0.852, val_accuracy=0.577]
 81%|████████  | 25/31 [02:42<00:37,  6.24s/epoch, loss=0.845, accuracy=0.621, val_loss=0.878, val_accuracy=0.574]
 84%|████████▍ | 26/31 [02:48<00:31,  6.23s/epoch, loss=0.836, accuracy=0.641, val_loss=0.869, val_accuracy=0.634]
 87%|████████▋ | 27/31 [02:54<00:24,  6.24s/epoch, loss=0.854, accuracy=0.639, val_loss=0.857, val_accuracy=0.645]
 90%|█████████ | 28/31 [03:01<00:18,  6.24s/epoch, loss=0.905, accuracy=0.595, val_loss=0.887, val_accuracy=0.609]
 94%|█████████▎| 29/31 [03:07<00:12,  6.25s/epoch, loss=0.914, accuracy=0.599, val_loss=0.981, val_accuracy=0.562]
 97%|█████████▋| 30/31 [03:13<00:06,  6.24s/epoch, loss=0.891, accuracy=0.594, val_loss=0.843, val_accuracy=0.634]
100%|██████████| 31/31 [03:19<00:00,  6.24s/epoch, loss=1.06, accuracy=0.619, val_loss=1.14, val_accuracy=0.611]  
100%|██████████| 31/31 [03:19<00:00,  6.45s/epoch, loss=1.06, accuracy=0.619, val_loss=1.14, val_accuracy=0.611]
Test score: 0.563925564289093
Test accuracy: 0.8353999853134155


* * * Run SGD for ID = 16_8. * * *


2024-03-01 13:19:59.291144: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:20:02.571017: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:20:02.572164: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-01 13:20:02.616093: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:20:02.616138: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:20:02.619007: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:20:02.619051: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:20:02.621174: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:20:02.621931: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:20:02.624288: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:20:02.625681: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:20:02.630163: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:20:02.630618: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:20:02.630709: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
<__array_function__ internals>:5: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:159: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_train, y_train = np.array(xs[:idx]), np.array(labels[:idx])
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:160: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_test, y_test = np.array(xs[idx:]), np.array(labels[idx:])
2024-03-01 13:20:08.291704: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-01 13:20:08.292217: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:20:08.305266: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:20:08.305320: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:20:08.305376: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:20:08.305396: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:20:08.305414: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:20:08.305432: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:20:08.305449: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:20:08.305467: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:20:08.305485: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:20:08.305923: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:20:08.305959: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:20:09.003482: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-01 13:20:09.003534: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-01 13:20:09.003550: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-01 13:20:09.004514: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:03:00.0, compute capability: 6.1)
{'id': '16_08', 'seed': 8, 'out_folder': 'results/epoch_budget', 'batch_size': 32, 'epochs': 31, 'validation_split': 0.2, 'checkpointing': True, 'initial_lr': 0.1, 'momentum': 0.98, 'nesterov': True, 'bootstrapping': False, 'map_optimizer': True, 'model': 'CNN-LSTM', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Loading data...
Pad sequences (samples x time)
20000 train sequences
5000 validation sequences
25000 test sequences
x_train shape: (20000, 100)
x_val shape: (5000, 100)
x_test shape: (25000, 100)
Using MAP optimizer with reg_weight:  5e-05
CNN-LSTM

0epoch [00:00, ?epoch/s]
  0%|          | 0/31 [00:00<?, ?epoch/s]2024-03-01 13:20:09.426070: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-01 13:20:09.437951: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199945000 Hz
2024-03-01 13:20:10.953464: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:20:11.123236: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:20:11.808718: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-01 13:20:11.862419: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.

  3%|▎         | 1/31 [00:11<05:41, 11.37s/epoch, loss=0.732, accuracy=0.546, val_loss=0.662, val_accuracy=0.666]
  6%|▋         | 2/31 [00:18<04:13,  8.76s/epoch, loss=0.508, accuracy=0.799, val_loss=0.466, val_accuracy=0.826]
 10%|▉         | 3/31 [00:24<03:32,  7.60s/epoch, loss=0.441, accuracy=0.852, val_loss=0.51, val_accuracy=0.818] 
 13%|█▎        | 4/31 [00:30<03:09,  7.04s/epoch, loss=0.434, accuracy=0.869, val_loss=0.559, val_accuracy=0.825]
 16%|█▌        | 5/31 [00:36<02:55,  6.75s/epoch, loss=0.536, accuracy=0.847, val_loss=0.711, val_accuracy=0.783]
 19%|█▉        | 6/31 [00:43<02:44,  6.58s/epoch, loss=0.78, accuracy=0.772, val_loss=0.936, val_accuracy=0.712] 
 23%|██▎       | 7/31 [00:49<02:35,  6.47s/epoch, loss=1.03, accuracy=0.679, val_loss=1.14, val_accuracy=0.641] 
 26%|██▌       | 8/31 [00:55<02:26,  6.39s/epoch, loss=1.07, accuracy=0.666, val_loss=1.11, val_accuracy=0.649]
 29%|██▉       | 9/31 [01:01<02:19,  6.34s/epoch, loss=1.09, accuracy=0.64, val_loss=1.13, val_accuracy=0.506] 
 32%|███▏      | 10/31 [01:08<02:12,  6.30s/epoch, loss=1.13, accuracy=0.568, val_loss=1.17, val_accuracy=0.519]
 35%|███▌      | 11/31 [01:14<02:05,  6.29s/epoch, loss=1.11, accuracy=0.541, val_loss=1.07, val_accuracy=0.523]
 39%|███▊      | 12/31 [01:20<01:59,  6.27s/epoch, loss=1.02, accuracy=0.562, val_loss=1, val_accuracy=0.528]   
 42%|████▏     | 13/31 [01:26<01:52,  6.26s/epoch, loss=0.971, accuracy=0.576, val_loss=1.17, val_accuracy=0.586]
 45%|████▌     | 14/31 [01:33<01:46,  6.26s/epoch, loss=0.922, accuracy=0.595, val_loss=0.895, val_accuracy=0.635]
 48%|████▊     | 15/31 [01:39<01:40,  6.26s/epoch, loss=0.905, accuracy=0.623, val_loss=0.919, val_accuracy=0.62] 
 52%|█████▏    | 16/31 [01:45<01:33,  6.26s/epoch, loss=0.929, accuracy=0.624, val_loss=0.938, val_accuracy=0.598]
 55%|█████▍    | 17/31 [01:51<01:27,  6.26s/epoch, loss=0.946, accuracy=0.606, val_loss=0.928, val_accuracy=0.56] 
 58%|█████▊    | 18/31 [01:58<01:21,  6.26s/epoch, loss=0.93, accuracy=0.599, val_loss=0.927, val_accuracy=0.616]
 61%|██████▏   | 19/31 [02:04<01:14,  6.24s/epoch, loss=0.928, accuracy=0.619, val_loss=0.938, val_accuracy=0.581]
 65%|██████▍   | 20/31 [02:10<01:08,  6.24s/epoch, loss=0.939, accuracy=0.586, val_loss=0.902, val_accuracy=0.62] 
 68%|██████▊   | 21/31 [02:16<01:02,  6.24s/epoch, loss=0.911, accuracy=0.615, val_loss=0.927, val_accuracy=0.607]
 71%|███████   | 22/31 [02:23<00:56,  6.24s/epoch, loss=0.92, accuracy=0.597, val_loss=0.881, val_accuracy=0.627] 
 74%|███████▍  | 23/31 [02:29<00:49,  6.23s/epoch, loss=0.864, accuracy=0.611, val_loss=0.862, val_accuracy=0.574]
 77%|███████▋  | 24/31 [02:35<00:43,  6.24s/epoch, loss=0.833, accuracy=0.626, val_loss=0.848, val_accuracy=0.625]
 81%|████████  | 25/31 [02:41<00:37,  6.24s/epoch, loss=0.859, accuracy=0.612, val_loss=0.86, val_accuracy=0.604] 
 84%|████████▍ | 26/31 [02:48<00:31,  6.24s/epoch, loss=0.885, accuracy=0.622, val_loss=0.911, val_accuracy=0.576]
 87%|████████▋ | 27/31 [02:54<00:24,  6.25s/epoch, loss=0.918, accuracy=0.605, val_loss=0.928, val_accuracy=0.572]
 90%|█████████ | 28/31 [03:00<00:18,  6.24s/epoch, loss=0.903, accuracy=0.596, val_loss=0.875, val_accuracy=0.605]
 94%|█████████▎| 29/31 [03:06<00:12,  6.24s/epoch, loss=0.874, accuracy=0.608, val_loss=0.856, val_accuracy=0.619]
 97%|█████████▋| 30/31 [03:13<00:06,  6.25s/epoch, loss=0.847, accuracy=0.624, val_loss=0.902, val_accuracy=0.575]
100%|██████████| 31/31 [03:19<00:00,  6.24s/epoch, loss=0.871, accuracy=0.609, val_loss=0.857, val_accuracy=0.61] 
100%|██████████| 31/31 [03:19<00:00,  6.43s/epoch, loss=0.871, accuracy=0.609, val_loss=0.857, val_accuracy=0.61]
Test score: 0.4654683470726013
Test accuracy: 0.8267599940299988


* * * Run SGD for ID = 16_9. * * *


2024-03-01 13:23:34.369259: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:23:37.676995: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:23:37.678079: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-01 13:23:37.717881: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:23:37.717915: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:23:37.720768: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:23:37.720807: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:23:37.723008: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:23:37.723648: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:23:37.726048: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:23:37.727521: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:23:37.732166: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:23:37.732634: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:23:37.732730: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
<__array_function__ internals>:5: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:159: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_train, y_train = np.array(xs[:idx]), np.array(labels[:idx])
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:160: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_test, y_test = np.array(xs[idx:]), np.array(labels[idx:])
2024-03-01 13:23:43.339318: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-01 13:23:43.339779: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:23:43.340594: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:23:43.340627: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:23:43.340678: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:23:43.340699: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:23:43.340717: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:23:43.340734: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:23:43.340752: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:23:43.340771: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:23:43.340790: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:23:43.341281: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:23:43.341314: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:23:44.011776: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-01 13:23:44.011853: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-01 13:23:44.011864: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-01 13:23:44.012722: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:03:00.0, compute capability: 6.1)
{'id': '16_09', 'seed': 9, 'out_folder': 'results/epoch_budget', 'batch_size': 32, 'epochs': 31, 'validation_split': 0.2, 'checkpointing': True, 'initial_lr': 0.1, 'momentum': 0.98, 'nesterov': True, 'bootstrapping': False, 'map_optimizer': True, 'model': 'CNN-LSTM', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Loading data...
Pad sequences (samples x time)
20000 train sequences
5000 validation sequences
25000 test sequences
x_train shape: (20000, 100)
x_val shape: (5000, 100)
x_test shape: (25000, 100)
Using MAP optimizer with reg_weight:  5e-05
CNN-LSTM

0epoch [00:00, ?epoch/s]
  0%|          | 0/31 [00:00<?, ?epoch/s]2024-03-01 13:23:44.423670: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-01 13:23:44.435954: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199945000 Hz
2024-03-01 13:23:46.062272: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:23:46.244567: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:23:46.939102: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-01 13:23:46.995191: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.

  3%|▎         | 1/31 [00:11<05:59, 12.00s/epoch, loss=0.678, accuracy=0.611, val_loss=0.524, val_accuracy=0.788]
  6%|▋         | 2/31 [00:18<04:16,  8.85s/epoch, loss=0.477, accuracy=0.822, val_loss=0.506, val_accuracy=0.804]
 10%|▉         | 3/31 [00:25<03:37,  7.78s/epoch, loss=0.424, accuracy=0.858, val_loss=0.481, val_accuracy=0.832]
 13%|█▎        | 4/31 [00:31<03:16,  7.29s/epoch, loss=0.404, accuracy=0.88, val_loss=0.512, val_accuracy=0.833] 
 16%|█▌        | 5/31 [00:38<03:02,  7.01s/epoch, loss=0.413, accuracy=0.892, val_loss=0.531, val_accuracy=0.839]
 19%|█▉        | 6/31 [00:45<02:56,  7.04s/epoch, loss=0.444, accuracy=0.897, val_loss=0.626, val_accuracy=0.841]
 23%|██▎       | 7/31 [00:51<02:43,  6.80s/epoch, loss=0.463, accuracy=0.897, val_loss=0.685, val_accuracy=0.827]
 26%|██▌       | 8/31 [00:57<02:32,  6.63s/epoch, loss=0.601, accuracy=0.856, val_loss=1.12, val_accuracy=0.709] 
 29%|██▉       | 9/31 [01:04<02:23,  6.51s/epoch, loss=1.18, accuracy=0.641, val_loss=1.29, val_accuracy=0.604] 
 32%|███▏      | 10/31 [01:10<02:15,  6.45s/epoch, loss=1.23, accuracy=0.583, val_loss=1.2, val_accuracy=0.587]
 35%|███▌      | 11/31 [01:16<02:07,  6.39s/epoch, loss=1.21, accuracy=0.534, val_loss=1.14, val_accuracy=0.51]
 39%|███▊      | 12/31 [01:22<02:00,  6.35s/epoch, loss=1.14, accuracy=0.522, val_loss=1.09, val_accuracy=0.536]
 42%|████▏     | 13/31 [01:29<01:53,  6.32s/epoch, loss=1.05, accuracy=0.553, val_loss=1.01, val_accuracy=0.527]
 45%|████▌     | 14/31 [01:35<01:47,  6.32s/epoch, loss=0.971, accuracy=0.596, val_loss=0.963, val_accuracy=0.592]
 48%|████▊     | 15/31 [01:41<01:40,  6.30s/epoch, loss=0.935, accuracy=0.615, val_loss=0.926, val_accuracy=0.63] 
 52%|█████▏    | 16/31 [01:48<01:34,  6.29s/epoch, loss=0.928, accuracy=0.625, val_loss=1.03, val_accuracy=0.547]
 55%|█████▍    | 17/31 [01:54<01:27,  6.28s/epoch, loss=0.959, accuracy=0.623, val_loss=1.02, val_accuracy=0.587]
 58%|█████▊    | 18/31 [02:00<01:21,  6.27s/epoch, loss=0.98, accuracy=0.609, val_loss=0.936, val_accuracy=0.657]
 61%|██████▏   | 19/31 [02:06<01:15,  6.26s/epoch, loss=0.965, accuracy=0.618, val_loss=0.968, val_accuracy=0.625]
 65%|██████▍   | 20/31 [02:13<01:08,  6.26s/epoch, loss=0.968, accuracy=0.591, val_loss=0.969, val_accuracy=0.562]
 68%|██████▊   | 21/31 [02:19<01:02,  6.25s/epoch, loss=0.935, accuracy=0.593, val_loss=0.915, val_accuracy=0.6]  
 71%|███████   | 22/31 [02:25<00:56,  6.25s/epoch, loss=0.955, accuracy=0.599, val_loss=0.938, val_accuracy=0.612]
 74%|███████▍  | 23/31 [02:31<00:49,  6.24s/epoch, loss=0.932, accuracy=0.617, val_loss=0.965, val_accuracy=0.492]
 77%|███████▋  | 24/31 [02:37<00:43,  6.24s/epoch, loss=0.955, accuracy=0.612, val_loss=0.936, val_accuracy=0.622]
 81%|████████  | 25/31 [02:44<00:37,  6.23s/epoch, loss=0.942, accuracy=0.594, val_loss=1.02, val_accuracy=0.491] 
 84%|████████▍ | 26/31 [02:50<00:31,  6.23s/epoch, loss=0.923, accuracy=0.571, val_loss=0.946, val_accuracy=0.494]
 87%|████████▋ | 27/31 [02:56<00:24,  6.23s/epoch, loss=0.876, accuracy=0.612, val_loss=0.842, val_accuracy=0.641]
 90%|█████████ | 28/31 [03:02<00:18,  6.23s/epoch, loss=0.836, accuracy=0.632, val_loss=0.817, val_accuracy=0.618]
 94%|█████████▎| 29/31 [03:09<00:12,  6.22s/epoch, loss=0.827, accuracy=0.646, val_loss=0.867, val_accuracy=0.604]
 97%|█████████▋| 30/31 [03:15<00:06,  6.21s/epoch, loss=0.854, accuracy=0.641, val_loss=0.842, val_accuracy=0.653]
100%|██████████| 31/31 [03:21<00:00,  6.23s/epoch, loss=0.85, accuracy=0.657, val_loss=0.869, val_accuracy=0.635] 
100%|██████████| 31/31 [03:21<00:00,  6.50s/epoch, loss=0.85, accuracy=0.657, val_loss=0.869, val_accuracy=0.635]
Test score: 0.6295724511146545
Test accuracy: 0.8356000185012817


* * * Run SGD for ID = 16_10. * * *


2024-03-01 13:27:11.665031: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:27:14.337182: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:27:14.338348: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-01 13:27:14.379631: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:27:14.379669: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:27:14.382415: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:27:14.382455: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:27:14.384562: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:27:14.385184: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:27:14.387591: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:27:14.388968: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:27:14.393494: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:27:14.393955: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:27:14.394052: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
<__array_function__ internals>:5: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:159: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_train, y_train = np.array(xs[:idx]), np.array(labels[:idx])
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:160: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_test, y_test = np.array(xs[idx:]), np.array(labels[idx:])
2024-03-01 13:27:20.082793: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-01 13:27:20.083281: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:27:20.084158: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:27:20.084207: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:27:20.084261: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:27:20.084282: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:27:20.084300: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:27:20.084318: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:27:20.084335: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:27:20.084352: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:27:20.084370: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:27:20.084764: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:27:20.084799: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:27:20.787239: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-01 13:27:20.787295: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-01 13:27:20.787305: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-01 13:27:20.790193: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:03:00.0, compute capability: 6.1)
{'id': '16_10', 'seed': 10, 'out_folder': 'results/epoch_budget', 'batch_size': 32, 'epochs': 31, 'validation_split': 0.2, 'checkpointing': True, 'initial_lr': 0.1, 'momentum': 0.98, 'nesterov': True, 'bootstrapping': False, 'map_optimizer': True, 'model': 'CNN-LSTM', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Loading data...
Pad sequences (samples x time)
20000 train sequences
5000 validation sequences
25000 test sequences
x_train shape: (20000, 100)
x_val shape: (5000, 100)
x_test shape: (25000, 100)
Using MAP optimizer with reg_weight:  5e-05
CNN-LSTM

0epoch [00:00, ?epoch/s]
  0%|          | 0/31 [00:00<?, ?epoch/s]2024-03-01 13:27:21.222883: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-01 13:27:21.234957: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199945000 Hz
2024-03-01 13:27:22.777051: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:27:22.960240: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:27:23.632265: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-01 13:27:23.671706: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.

  3%|▎         | 1/31 [00:11<05:47, 11.58s/epoch, loss=0.646, accuracy=0.657, val_loss=0.495, val_accuracy=0.805]
  6%|▋         | 2/31 [00:19<04:38,  9.59s/epoch, loss=0.459, accuracy=0.833, val_loss=0.482, val_accuracy=0.832]
 10%|▉         | 3/31 [00:26<03:46,  8.09s/epoch, loss=0.449, accuracy=0.855, val_loss=0.526, val_accuracy=0.817]
 13%|█▎        | 4/31 [00:32<03:18,  7.37s/epoch, loss=0.458, accuracy=0.87, val_loss=0.577, val_accuracy=0.819] 
 16%|█▌        | 5/31 [00:38<03:01,  6.98s/epoch, loss=0.594, accuracy=0.831, val_loss=0.883, val_accuracy=0.683]
 19%|█▉        | 6/31 [00:44<02:48,  6.75s/epoch, loss=0.942, accuracy=0.693, val_loss=1.01, val_accuracy=0.69]  
 23%|██▎       | 7/31 [00:51<02:38,  6.60s/epoch, loss=1.09, accuracy=0.644, val_loss=1.09, val_accuracy=0.652]
 26%|██▌       | 8/31 [00:57<02:29,  6.50s/epoch, loss=1.08, accuracy=0.624, val_loss=1.05, val_accuracy=0.675]
 29%|██▉       | 9/31 [01:03<02:21,  6.43s/epoch, loss=1.08, accuracy=0.599, val_loss=1.08, val_accuracy=0.578]
 32%|███▏      | 10/31 [01:10<02:14,  6.38s/epoch, loss=1.05, accuracy=0.572, val_loss=1.01, val_accuracy=0.604]
 35%|███▌      | 11/31 [01:16<02:06,  6.34s/epoch, loss=1.02, accuracy=0.582, val_loss=1.02, val_accuracy=0.546]
 39%|███▊      | 12/31 [01:22<02:00,  6.32s/epoch, loss=1.01, accuracy=0.56, val_loss=0.964, val_accuracy=0.595]
 42%|████▏     | 13/31 [01:28<01:53,  6.31s/epoch, loss=0.953, accuracy=0.567, val_loss=0.905, val_accuracy=0.513]
 45%|████▌     | 14/31 [01:35<01:47,  6.30s/epoch, loss=0.9, accuracy=0.598, val_loss=0.903, val_accuracy=0.613]  
 48%|████▊     | 15/31 [01:41<01:40,  6.29s/epoch, loss=0.883, accuracy=0.615, val_loss=0.847, val_accuracy=0.642]
 52%|█████▏    | 16/31 [01:47<01:34,  6.29s/epoch, loss=0.856, accuracy=0.639, val_loss=0.833, val_accuracy=0.662]
 55%|█████▍    | 17/31 [01:53<01:27,  6.28s/epoch, loss=0.85, accuracy=0.649, val_loss=0.86, val_accuracy=0.655]  
 58%|█████▊    | 18/31 [02:00<01:21,  6.29s/epoch, loss=0.903, accuracy=0.635, val_loss=0.896, val_accuracy=0.645]
 61%|██████▏   | 19/31 [02:06<01:15,  6.29s/epoch, loss=0.906, accuracy=0.62, val_loss=0.921, val_accuracy=0.6]   
 65%|██████▍   | 20/31 [02:12<01:09,  6.29s/epoch, loss=0.934, accuracy=0.605, val_loss=0.918, val_accuracy=0.614]
 68%|██████▊   | 21/31 [02:19<01:02,  6.30s/epoch, loss=0.909, accuracy=0.621, val_loss=0.911, val_accuracy=0.607]
 71%|███████   | 22/31 [02:25<00:56,  6.30s/epoch, loss=0.871, accuracy=0.64, val_loss=0.849, val_accuracy=0.655] 
 74%|███████▍  | 23/31 [02:31<00:50,  6.30s/epoch, loss=0.877, accuracy=0.635, val_loss=0.936, val_accuracy=0.547]
 77%|███████▋  | 24/31 [02:37<00:43,  6.28s/epoch, loss=0.904, accuracy=0.609, val_loss=0.961, val_accuracy=0.541]
 81%|████████  | 25/31 [02:44<00:37,  6.26s/epoch, loss=0.936, accuracy=0.592, val_loss=0.93, val_accuracy=0.628] 
 84%|████████▍ | 26/31 [02:50<00:31,  6.26s/epoch, loss=0.924, accuracy=0.589, val_loss=0.961, val_accuracy=0.608]
 87%|████████▋ | 27/31 [02:56<00:25,  6.26s/epoch, loss=0.897, accuracy=0.608, val_loss=0.868, val_accuracy=0.666]
 90%|█████████ | 28/31 [03:02<00:18,  6.26s/epoch, loss=0.902, accuracy=0.602, val_loss=0.914, val_accuracy=0.577]
 94%|█████████▎| 29/31 [03:09<00:12,  6.26s/epoch, loss=0.892, accuracy=0.601, val_loss=0.895, val_accuracy=0.59] 
 97%|█████████▋| 30/31 [03:15<00:06,  6.26s/epoch, loss=0.887, accuracy=0.629, val_loss=0.882, val_accuracy=0.637]
100%|██████████| 31/31 [03:21<00:00,  6.27s/epoch, loss=0.88, accuracy=0.623, val_loss=0.938, val_accuracy=0.592] 
100%|██████████| 31/31 [03:21<00:00,  6.51s/epoch, loss=0.88, accuracy=0.623, val_loss=0.938, val_accuracy=0.592]
Test score: 0.4699340760707855
Test accuracy: 0.830560028553009


* * * Run SGD for ID = 16_11. * * *


2024-03-01 13:30:48.745084: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:30:51.353177: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:30:51.354255: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-01 13:30:51.393031: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:30:51.393063: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:30:51.395724: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:30:51.395766: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:30:51.397787: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:30:51.398350: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:30:51.400615: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:30:51.402011: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:30:51.406476: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:30:51.409869: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:30:51.409968: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
<__array_function__ internals>:5: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:159: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_train, y_train = np.array(xs[:idx]), np.array(labels[:idx])
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:160: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_test, y_test = np.array(xs[idx:]), np.array(labels[idx:])
2024-03-01 13:30:57.062703: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-01 13:30:57.063213: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:30:57.063715: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:30:57.063749: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:30:57.063795: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:30:57.063815: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:30:57.063859: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:30:57.063879: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:30:57.063899: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:30:57.063918: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:30:57.063937: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:30:57.064371: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:30:57.064404: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:30:57.755694: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-01 13:30:57.755743: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-01 13:30:57.755753: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-01 13:30:57.756650: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:03:00.0, compute capability: 6.1)
{'id': '16_11', 'seed': 11, 'out_folder': 'results/epoch_budget', 'batch_size': 32, 'epochs': 31, 'validation_split': 0.2, 'checkpointing': True, 'initial_lr': 0.1, 'momentum': 0.98, 'nesterov': True, 'bootstrapping': False, 'map_optimizer': True, 'model': 'CNN-LSTM', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Loading data...
Pad sequences (samples x time)
20000 train sequences
5000 validation sequences
25000 test sequences
x_train shape: (20000, 100)
x_val shape: (5000, 100)
x_test shape: (25000, 100)
Using MAP optimizer with reg_weight:  5e-05
CNN-LSTM

0epoch [00:00, ?epoch/s]
  0%|          | 0/31 [00:00<?, ?epoch/s]2024-03-01 13:30:58.174559: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-01 13:30:58.186980: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199945000 Hz
2024-03-01 13:30:59.704165: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:30:59.875078: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:31:00.544337: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-01 13:31:00.576661: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.

  3%|▎         | 1/31 [00:12<06:01, 12.03s/epoch, loss=0.609, accuracy=0.7, val_loss=0.455, val_accuracy=0.831]
  6%|▋         | 2/31 [00:18<04:16,  8.86s/epoch, loss=0.45, accuracy=0.84, val_loss=0.433, val_accuracy=0.845]
 10%|▉         | 3/31 [00:24<03:35,  7.68s/epoch, loss=0.418, accuracy=0.868, val_loss=0.466, val_accuracy=0.838]
 13%|█▎        | 4/31 [00:31<03:12,  7.11s/epoch, loss=0.412, accuracy=0.886, val_loss=0.541, val_accuracy=0.836]
 16%|█▌        | 5/31 [00:37<02:59,  6.89s/epoch, loss=0.429, accuracy=0.894, val_loss=0.564, val_accuracy=0.845]
 19%|█▉        | 6/31 [00:44<02:50,  6.81s/epoch, loss=0.438, accuracy=0.903, val_loss=0.601, val_accuracy=0.845]
 23%|██▎       | 7/31 [00:50<02:38,  6.62s/epoch, loss=0.482, accuracy=0.902, val_loss=0.665, val_accuracy=0.833]
 26%|██▌       | 8/31 [00:56<02:29,  6.51s/epoch, loss=0.563, accuracy=0.884, val_loss=0.772, val_accuracy=0.8]  
 29%|██▉       | 9/31 [01:03<02:21,  6.43s/epoch, loss=0.878, accuracy=0.77, val_loss=1.05, val_accuracy=0.689]
 32%|███▏      | 10/31 [01:09<02:14,  6.39s/epoch, loss=1.09, accuracy=0.654, val_loss=1.09, val_accuracy=0.693]
 35%|███▌      | 11/31 [01:15<02:06,  6.35s/epoch, loss=1.11, accuracy=0.652, val_loss=1.11, val_accuracy=0.663]
 39%|███▊      | 12/31 [01:21<02:00,  6.32s/epoch, loss=1.15, accuracy=0.61, val_loss=1.16, val_accuracy=0.526] 
 42%|████▏     | 13/31 [01:28<01:53,  6.30s/epoch, loss=1.13, accuracy=0.572, val_loss=1.11, val_accuracy=0.559]
 45%|████▌     | 14/31 [01:34<01:46,  6.29s/epoch, loss=1.11, accuracy=0.582, val_loss=1.08, val_accuracy=0.609]
 48%|████▊     | 15/31 [01:40<01:40,  6.29s/epoch, loss=1.05, accuracy=0.554, val_loss=1.01, val_accuracy=0.585]
 52%|█████▏    | 16/31 [01:47<01:34,  6.30s/epoch, loss=0.966, accuracy=0.625, val_loss=0.954, val_accuracy=0.619]
 55%|█████▍    | 17/31 [01:53<01:28,  6.29s/epoch, loss=0.972, accuracy=0.605, val_loss=0.945, val_accuracy=0.637]
 58%|█████▊    | 18/31 [01:59<01:21,  6.29s/epoch, loss=0.993, accuracy=0.597, val_loss=0.995, val_accuracy=0.577]
 61%|██████▏   | 19/31 [02:05<01:15,  6.27s/epoch, loss=0.975, accuracy=0.595, val_loss=0.971, val_accuracy=0.597]
 65%|██████▍   | 20/31 [02:12<01:08,  6.27s/epoch, loss=0.953, accuracy=0.587, val_loss=0.932, val_accuracy=0.586]
 68%|██████▊   | 21/31 [02:18<01:02,  6.25s/epoch, loss=0.917, accuracy=0.595, val_loss=0.915, val_accuracy=0.517]
 71%|███████   | 22/31 [02:24<00:56,  6.25s/epoch, loss=0.921, accuracy=0.585, val_loss=0.909, val_accuracy=0.615]
 74%|███████▍  | 23/31 [02:30<00:50,  6.25s/epoch, loss=0.922, accuracy=0.574, val_loss=0.88, val_accuracy=0.619] 
 77%|███████▋  | 24/31 [02:37<00:43,  6.26s/epoch, loss=0.901, accuracy=0.6, val_loss=0.912, val_accuracy=0.597] 
 81%|████████  | 25/31 [02:43<00:37,  6.25s/epoch, loss=0.913, accuracy=0.59, val_loss=0.878, val_accuracy=0.639]
 84%|████████▍ | 26/31 [02:49<00:31,  6.26s/epoch, loss=0.904, accuracy=0.588, val_loss=0.88, val_accuracy=0.632]
 87%|████████▋ | 27/31 [02:55<00:25,  6.25s/epoch, loss=0.918, accuracy=0.557, val_loss=0.888, val_accuracy=0.554]
 90%|█████████ | 28/31 [03:02<00:18,  6.25s/epoch, loss=0.9, accuracy=0.536, val_loss=0.883, val_accuracy=0.508]  
 94%|█████████▎| 29/31 [03:08<00:12,  6.26s/epoch, loss=0.858, accuracy=0.585, val_loss=0.821, val_accuracy=0.627]
 97%|█████████▋| 30/31 [03:14<00:06,  6.26s/epoch, loss=0.824, accuracy=0.618, val_loss=0.766, val_accuracy=0.683]
100%|██████████| 31/31 [03:20<00:00,  6.26s/epoch, loss=0.82, accuracy=0.635, val_loss=0.851, val_accuracy=0.633] 
100%|██████████| 31/31 [03:20<00:00,  6.48s/epoch, loss=0.82, accuracy=0.635, val_loss=0.851, val_accuracy=0.633]
Test score: 0.6185641884803772
Test accuracy: 0.837119996547699


* * * Run SGD for ID = 16_12. * * *


2024-03-01 13:34:24.852652: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:34:28.100205: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:34:28.101269: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-01 13:34:28.140942: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:34:28.140974: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:34:28.143896: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:34:28.143940: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:34:28.146190: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:34:28.146940: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:34:28.149264: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:34:28.151031: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:34:28.155426: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:34:28.155908: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:34:28.155998: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
<__array_function__ internals>:5: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:159: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_train, y_train = np.array(xs[:idx]), np.array(labels[:idx])
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:160: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_test, y_test = np.array(xs[idx:]), np.array(labels[idx:])
2024-03-01 13:34:33.773078: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-01 13:34:33.773611: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:34:33.774130: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:34:33.774163: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:34:33.774208: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:34:33.774227: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:34:33.774245: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:34:33.774262: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:34:33.774280: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:34:33.774298: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:34:33.774315: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:34:33.774711: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:34:33.774742: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:34:34.458372: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-01 13:34:34.458422: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-01 13:34:34.458432: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-01 13:34:34.459326: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:03:00.0, compute capability: 6.1)
{'id': '16_12', 'seed': 12, 'out_folder': 'results/epoch_budget', 'batch_size': 32, 'epochs': 31, 'validation_split': 0.2, 'checkpointing': True, 'initial_lr': 0.1, 'momentum': 0.98, 'nesterov': True, 'bootstrapping': False, 'map_optimizer': True, 'model': 'CNN-LSTM', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Loading data...
Pad sequences (samples x time)
20000 train sequences
5000 validation sequences
25000 test sequences
x_train shape: (20000, 100)
x_val shape: (5000, 100)
x_test shape: (25000, 100)
Using MAP optimizer with reg_weight:  5e-05
CNN-LSTM

0epoch [00:00, ?epoch/s]
  0%|          | 0/31 [00:00<?, ?epoch/s]2024-03-01 13:34:34.885249: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-01 13:34:34.896964: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199945000 Hz
2024-03-01 13:34:36.432430: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:34:36.614644: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:34:37.275679: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-01 13:34:37.306816: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.

  3%|▎         | 1/31 [00:11<05:44, 11.48s/epoch, loss=0.653, accuracy=0.648, val_loss=0.525, val_accuracy=0.79]
  6%|▋         | 2/31 [00:18<04:18,  8.91s/epoch, loss=0.471, accuracy=0.829, val_loss=0.531, val_accuracy=0.82]
 10%|▉         | 3/31 [00:25<03:42,  7.94s/epoch, loss=0.455, accuracy=0.858, val_loss=0.513, val_accuracy=0.832]
 13%|█▎        | 4/31 [00:31<03:16,  7.29s/epoch, loss=0.492, accuracy=0.858, val_loss=0.624, val_accuracy=0.814]
 16%|█▌        | 5/31 [00:37<02:59,  6.91s/epoch, loss=0.645, accuracy=0.813, val_loss=0.934, val_accuracy=0.688]
 19%|█▉        | 6/31 [00:44<02:47,  6.69s/epoch, loss=0.989, accuracy=0.664, val_loss=1.09, val_accuracy=0.595] 
 23%|██▎       | 7/31 [00:50<02:37,  6.54s/epoch, loss=1.09, accuracy=0.634, val_loss=1.14, val_accuracy=0.594] 
 26%|██▌       | 8/31 [00:56<02:28,  6.46s/epoch, loss=1.13, accuracy=0.59, val_loss=1.14, val_accuracy=0.545] 
 29%|██▉       | 9/31 [01:02<02:20,  6.39s/epoch, loss=1.1, accuracy=0.555, val_loss=1.06, val_accuracy=0.571]
 32%|███▏      | 10/31 [01:09<02:13,  6.35s/epoch, loss=1.13, accuracy=0.534, val_loss=1.21, val_accuracy=0.488]
 35%|███▌      | 11/31 [01:15<02:06,  6.31s/epoch, loss=1.15, accuracy=0.572, val_loss=1.1, val_accuracy=0.592] 
 39%|███▊      | 12/31 [01:21<01:59,  6.29s/epoch, loss=1.08, accuracy=0.553, val_loss=1.03, val_accuracy=0.571]
 42%|████▏     | 13/31 [01:27<01:53,  6.29s/epoch, loss=1.02, accuracy=0.563, val_loss=0.969, val_accuracy=0.584]
 45%|████▌     | 14/31 [01:34<01:46,  6.28s/epoch, loss=0.975, accuracy=0.568, val_loss=0.932, val_accuracy=0.587]
 48%|████▊     | 15/31 [01:40<01:40,  6.27s/epoch, loss=0.912, accuracy=0.6, val_loss=0.901, val_accuracy=0.525]  
 52%|█████▏    | 16/31 [01:46<01:33,  6.25s/epoch, loss=0.852, accuracy=0.64, val_loss=0.882, val_accuracy=0.633]
 55%|█████▍    | 17/31 [01:52<01:27,  6.25s/epoch, loss=0.835, accuracy=0.661, val_loss=0.858, val_accuracy=0.661]
 58%|█████▊    | 18/31 [01:59<01:21,  6.25s/epoch, loss=0.874, accuracy=0.664, val_loss=0.888, val_accuracy=0.668]
 61%|██████▏   | 19/31 [02:05<01:15,  6.25s/epoch, loss=0.933, accuracy=0.65, val_loss=0.946, val_accuracy=0.656] 
 65%|██████▍   | 20/31 [02:11<01:08,  6.27s/epoch, loss=0.996, accuracy=0.582, val_loss=0.959, val_accuracy=0.598]
 68%|██████▊   | 21/31 [02:17<01:02,  6.26s/epoch, loss=0.96, accuracy=0.587, val_loss=1.01, val_accuracy=0.599]  
 71%|███████   | 22/31 [02:24<00:56,  6.25s/epoch, loss=0.904, accuracy=0.634, val_loss=0.913, val_accuracy=0.674]
 74%|███████▍  | 23/31 [02:30<00:49,  6.25s/epoch, loss=0.978, accuracy=0.585, val_loss=0.983, val_accuracy=0.643]
 77%|███████▋  | 24/31 [02:36<00:43,  6.24s/epoch, loss=0.96, accuracy=0.615, val_loss=0.951, val_accuracy=0.608] 
 81%|████████  | 25/31 [02:42<00:37,  6.25s/epoch, loss=0.979, accuracy=0.587, val_loss=0.951, val_accuracy=0.585]
 84%|████████▍ | 26/31 [02:49<00:31,  6.25s/epoch, loss=0.943, accuracy=0.59, val_loss=0.92, val_accuracy=0.616]  
 87%|████████▋ | 27/31 [02:55<00:24,  6.25s/epoch, loss=0.909, accuracy=0.619, val_loss=0.887, val_accuracy=0.59]
 90%|█████████ | 28/31 [03:01<00:18,  6.24s/epoch, loss=0.89, accuracy=0.623, val_loss=0.909, val_accuracy=0.594]
 94%|█████████▎| 29/31 [03:07<00:12,  6.24s/epoch, loss=0.903, accuracy=0.623, val_loss=0.944, val_accuracy=0.619]
 97%|█████████▋| 30/31 [03:14<00:06,  6.24s/epoch, loss=0.902, accuracy=0.633, val_loss=0.849, val_accuracy=0.673]
100%|██████████| 31/31 [03:20<00:00,  6.25s/epoch, loss=0.895, accuracy=0.628, val_loss=0.915, val_accuracy=0.526]
100%|██████████| 31/31 [03:20<00:00,  6.46s/epoch, loss=0.895, accuracy=0.628, val_loss=0.915, val_accuracy=0.526]
Test score: 0.5046120285987854
Test accuracy: 0.8346800208091736


* * * Run SGD for ID = 16_13. * * *


2024-03-01 13:38:01.202440: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:38:04.501233: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:38:04.502367: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-01 13:38:04.541145: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:38:04.541175: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:38:04.544032: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:38:04.544075: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:38:04.546237: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:38:04.546910: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:38:04.549076: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:38:04.550551: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:38:04.555096: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:38:04.555572: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:38:04.555666: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
<__array_function__ internals>:5: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:159: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_train, y_train = np.array(xs[:idx]), np.array(labels[:idx])
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:160: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_test, y_test = np.array(xs[idx:]), np.array(labels[idx:])
2024-03-01 13:38:10.275221: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-01 13:38:10.275794: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:38:10.276637: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:38:10.276673: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:38:10.276736: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:38:10.276760: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:38:10.276781: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:38:10.276802: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:38:10.276822: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:38:10.276868: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:38:10.276889: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:38:10.277340: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:38:10.277380: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:38:10.969408: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-01 13:38:10.969466: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-01 13:38:10.969476: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-01 13:38:10.970457: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:03:00.0, compute capability: 6.1)
{'id': '16_13', 'seed': 13, 'out_folder': 'results/epoch_budget', 'batch_size': 32, 'epochs': 31, 'validation_split': 0.2, 'checkpointing': True, 'initial_lr': 0.1, 'momentum': 0.98, 'nesterov': True, 'bootstrapping': False, 'map_optimizer': True, 'model': 'CNN-LSTM', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Loading data...
Pad sequences (samples x time)
20000 train sequences
5000 validation sequences
25000 test sequences
x_train shape: (20000, 100)
x_val shape: (5000, 100)
x_test shape: (25000, 100)
Using MAP optimizer with reg_weight:  5e-05
CNN-LSTM

0epoch [00:00, ?epoch/s]
  0%|          | 0/31 [00:00<?, ?epoch/s]2024-03-01 13:38:11.394666: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-01 13:38:11.406960: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199945000 Hz
2024-03-01 13:38:12.936672: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:38:13.116166: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:38:13.826953: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-01 13:38:13.860508: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.

  3%|▎         | 1/31 [00:11<05:47, 11.60s/epoch, loss=0.621, accuracy=0.684, val_loss=0.504, val_accuracy=0.795]
  6%|▋         | 2/31 [00:18<04:19,  8.96s/epoch, loss=0.451, accuracy=0.839, val_loss=0.445, val_accuracy=0.848]
 10%|▉         | 3/31 [00:24<03:36,  7.74s/epoch, loss=0.418, accuracy=0.866, val_loss=0.487, val_accuracy=0.839]
 13%|█▎        | 4/31 [00:31<03:13,  7.17s/epoch, loss=0.407, accuracy=0.888, val_loss=0.529, val_accuracy=0.822]
 16%|█▌        | 5/31 [00:37<02:58,  6.86s/epoch, loss=0.41, accuracy=0.901, val_loss=0.58, val_accuracy=0.844]  
 19%|█▉        | 6/31 [00:43<02:46,  6.66s/epoch, loss=0.436, accuracy=0.904, val_loss=0.636, val_accuracy=0.839]
 23%|██▎       | 7/31 [00:50<02:36,  6.53s/epoch, loss=0.462, accuracy=0.907, val_loss=0.667, val_accuracy=0.819]
 26%|██▌       | 8/31 [00:56<02:28,  6.46s/epoch, loss=0.786, accuracy=0.796, val_loss=1.13, val_accuracy=0.65]  
 29%|██▉       | 9/31 [01:02<02:21,  6.41s/epoch, loss=1.23, accuracy=0.605, val_loss=1.21, val_accuracy=0.609]
 32%|███▏      | 10/31 [01:09<02:13,  6.37s/epoch, loss=1.19, accuracy=0.588, val_loss=1.18, val_accuracy=0.533]
 35%|███▌      | 11/31 [01:15<02:06,  6.33s/epoch, loss=1.15, accuracy=0.589, val_loss=1.13, val_accuracy=0.525]
 39%|███▊      | 12/31 [01:21<01:59,  6.30s/epoch, loss=1.08, accuracy=0.583, val_loss=1.1, val_accuracy=0.585] 
 42%|████▏     | 13/31 [01:27<01:53,  6.29s/epoch, loss=1.03, accuracy=0.587, val_loss=1.01, val_accuracy=0.566]
 45%|████▌     | 14/31 [01:34<01:47,  6.30s/epoch, loss=1.02, accuracy=0.573, val_loss=0.97, val_accuracy=0.591]
 48%|████▊     | 15/31 [01:40<01:40,  6.29s/epoch, loss=0.966, accuracy=0.585, val_loss=0.957, val_accuracy=0.512]
 52%|█████▏    | 16/31 [01:46<01:34,  6.28s/epoch, loss=0.936, accuracy=0.6, val_loss=0.899, val_accuracy=0.636]  
 55%|█████▍    | 17/31 [01:52<01:27,  6.28s/epoch, loss=0.924, accuracy=0.613, val_loss=0.924, val_accuracy=0.61]
 58%|█████▊    | 18/31 [01:59<01:21,  6.28s/epoch, loss=0.896, accuracy=0.624, val_loss=0.997, val_accuracy=0.504]
 61%|██████▏   | 19/31 [02:05<01:15,  6.27s/epoch, loss=0.886, accuracy=0.62, val_loss=0.866, val_accuracy=0.634] 
 65%|██████▍   | 20/31 [02:11<01:08,  6.27s/epoch, loss=0.885, accuracy=0.612, val_loss=0.889, val_accuracy=0.618]
 68%|██████▊   | 21/31 [02:17<01:02,  6.28s/epoch, loss=0.882, accuracy=0.63, val_loss=0.904, val_accuracy=0.604] 
 71%|███████   | 22/31 [02:24<00:56,  6.27s/epoch, loss=0.895, accuracy=0.612, val_loss=0.877, val_accuracy=0.639]
 74%|███████▍  | 23/31 [02:30<00:50,  6.26s/epoch, loss=0.899, accuracy=0.621, val_loss=0.916, val_accuracy=0.599]
 77%|███████▋  | 24/31 [02:36<00:43,  6.26s/epoch, loss=0.918, accuracy=0.572, val_loss=0.877, val_accuracy=0.608]
 81%|████████  | 25/31 [02:42<00:37,  6.26s/epoch, loss=0.85, accuracy=0.629, val_loss=0.823, val_accuracy=0.644] 
 84%|████████▍ | 26/31 [02:49<00:31,  6.26s/epoch, loss=0.826, accuracy=0.64, val_loss=0.813, val_accuracy=0.644]
 87%|████████▋ | 27/31 [02:55<00:25,  6.27s/epoch, loss=0.824, accuracy=0.641, val_loss=0.875, val_accuracy=0.643]
 90%|█████████ | 28/31 [03:01<00:18,  6.27s/epoch, loss=0.873, accuracy=0.639, val_loss=0.96, val_accuracy=0.598] 
 94%|█████████▎| 29/31 [03:08<00:12,  6.26s/epoch, loss=1.62, accuracy=0.649, val_loss=1.85, val_accuracy=0.581] 
 97%|█████████▋| 30/31 [03:14<00:06,  6.25s/epoch, loss=1.63, accuracy=0.638, val_loss=1.51, val_accuracy=0.628]
100%|██████████| 31/31 [03:20<00:00,  6.25s/epoch, loss=1.43, accuracy=0.638, val_loss=1.35, val_accuracy=0.627]
100%|██████████| 31/31 [03:20<00:00,  6.47s/epoch, loss=1.43, accuracy=0.638, val_loss=1.35, val_accuracy=0.627]
Test score: 0.44191062450408936
Test accuracy: 0.8474000096321106


* * * Run SGD for ID = 16_14. * * *


2024-03-01 13:41:37.809589: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:41:41.128009: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:41:41.129174: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-01 13:41:41.171880: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:41:41.171916: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:41:41.174932: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:41:41.174977: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:41:41.177316: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:41:41.177989: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:41:41.180367: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:41:41.181885: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:41:41.186365: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:41:41.186801: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:41:41.186917: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
<__array_function__ internals>:5: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:159: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_train, y_train = np.array(xs[:idx]), np.array(labels[:idx])
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:160: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_test, y_test = np.array(xs[idx:]), np.array(labels[idx:])
2024-03-01 13:41:46.927583: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-01 13:41:46.928102: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:41:46.928947: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:41:46.928988: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:41:46.929046: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:41:46.929070: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:41:46.929090: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:41:46.929111: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:41:46.929131: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:41:46.929182: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:41:46.929201: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:41:46.929597: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:41:46.929628: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:41:47.610687: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-01 13:41:47.610737: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-01 13:41:47.610754: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-01 13:41:47.619568: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:03:00.0, compute capability: 6.1)
{'id': '16_14', 'seed': 14, 'out_folder': 'results/epoch_budget', 'batch_size': 32, 'epochs': 31, 'validation_split': 0.2, 'checkpointing': True, 'initial_lr': 0.1, 'momentum': 0.98, 'nesterov': True, 'bootstrapping': False, 'map_optimizer': True, 'model': 'CNN-LSTM', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Loading data...
Pad sequences (samples x time)
20000 train sequences
5000 validation sequences
25000 test sequences
x_train shape: (20000, 100)
x_val shape: (5000, 100)
x_test shape: (25000, 100)
Using MAP optimizer with reg_weight:  5e-05
CNN-LSTM

0epoch [00:00, ?epoch/s]
  0%|          | 0/31 [00:00<?, ?epoch/s]2024-03-01 13:41:48.046458: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-01 13:41:48.058970: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199945000 Hz
2024-03-01 13:41:49.609505: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:41:49.792201: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:41:50.474704: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-01 13:41:50.517190: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.

  3%|▎         | 1/31 [00:11<05:43, 11.46s/epoch, loss=0.688, accuracy=0.599, val_loss=0.506, val_accuracy=0.8]
  6%|▋         | 2/31 [00:18<04:15,  8.82s/epoch, loss=0.479, accuracy=0.817, val_loss=0.464, val_accuracy=0.84]
 10%|▉         | 3/31 [00:24<03:34,  7.65s/epoch, loss=0.441, accuracy=0.854, val_loss=0.478, val_accuracy=0.838]
 13%|█▎        | 4/31 [00:30<03:11,  7.10s/epoch, loss=0.452, accuracy=0.861, val_loss=0.564, val_accuracy=0.824]
 16%|█▌        | 5/31 [00:37<02:56,  6.79s/epoch, loss=0.524, accuracy=0.858, val_loss=0.681, val_accuracy=0.783]
 19%|█▉        | 6/31 [00:43<02:45,  6.62s/epoch, loss=0.895, accuracy=0.707, val_loss=1.08, val_accuracy=0.595] 
 23%|██▎       | 7/31 [00:49<02:36,  6.50s/epoch, loss=1.11, accuracy=0.624, val_loss=1.18, val_accuracy=0.582] 
 26%|██▌       | 8/31 [00:56<02:27,  6.43s/epoch, loss=1.14, accuracy=0.602, val_loss=1.1, val_accuracy=0.637] 
 29%|██▉       | 9/31 [01:02<02:20,  6.38s/epoch, loss=1.13, accuracy=0.572, val_loss=1.1, val_accuracy=0.597]
 32%|███▏      | 10/31 [01:08<02:13,  6.35s/epoch, loss=1.08, accuracy=0.573, val_loss=1.03, val_accuracy=0.589]
 35%|███▌      | 11/31 [01:14<02:06,  6.34s/epoch, loss=1.01, accuracy=0.573, val_loss=1.01, val_accuracy=0.534]
 39%|███▊      | 12/31 [01:21<02:00,  6.32s/epoch, loss=0.958, accuracy=0.57, val_loss=0.997, val_accuracy=0.507]
 42%|████▏     | 13/31 [01:27<01:53,  6.31s/epoch, loss=0.934, accuracy=0.605, val_loss=0.887, val_accuracy=0.639]
 45%|████▌     | 14/31 [01:33<01:46,  6.29s/epoch, loss=0.903, accuracy=0.625, val_loss=0.883, val_accuracy=0.654]
 48%|████▊     | 15/31 [01:39<01:40,  6.29s/epoch, loss=0.878, accuracy=0.635, val_loss=0.862, val_accuracy=0.661]
 52%|█████▏    | 16/31 [01:46<01:34,  6.28s/epoch, loss=0.899, accuracy=0.637, val_loss=0.953, val_accuracy=0.547]
 55%|█████▍    | 17/31 [01:52<01:27,  6.26s/epoch, loss=0.934, accuracy=0.596, val_loss=0.985, val_accuracy=0.545]
 58%|█████▊    | 18/31 [01:58<01:21,  6.24s/epoch, loss=0.901, accuracy=0.614, val_loss=0.871, val_accuracy=0.633]
 61%|██████▏   | 19/31 [02:04<01:14,  6.22s/epoch, loss=0.878, accuracy=0.604, val_loss=0.864, val_accuracy=0.575]
 65%|██████▍   | 20/31 [02:11<01:08,  6.22s/epoch, loss=0.864, accuracy=0.634, val_loss=0.872, val_accuracy=0.63] 
 68%|██████▊   | 21/31 [02:17<01:02,  6.22s/epoch, loss=0.901, accuracy=0.625, val_loss=1.09, val_accuracy=0.56] 
 71%|███████   | 22/31 [02:23<00:55,  6.22s/epoch, loss=1.03, accuracy=0.635, val_loss=1.02, val_accuracy=0.648]
 74%|███████▍  | 23/31 [02:29<00:49,  6.21s/epoch, loss=0.991, accuracy=0.644, val_loss=0.971, val_accuracy=0.659]
 77%|███████▋  | 24/31 [02:35<00:43,  6.21s/epoch, loss=0.992, accuracy=0.608, val_loss=0.951, val_accuracy=0.609]
 81%|████████  | 25/31 [02:42<00:37,  6.21s/epoch, loss=0.934, accuracy=0.629, val_loss=0.903, val_accuracy=0.61] 
 84%|████████▍ | 26/31 [02:48<00:31,  6.20s/epoch, loss=0.887, accuracy=0.65, val_loss=0.905, val_accuracy=0.631]
 87%|████████▋ | 27/31 [02:54<00:24,  6.20s/epoch, loss=0.883, accuracy=0.648, val_loss=0.863, val_accuracy=0.665]
 90%|█████████ | 28/31 [03:00<00:18,  6.20s/epoch, loss=0.862, accuracy=0.641, val_loss=0.916, val_accuracy=0.65] 
 94%|█████████▎| 29/31 [03:06<00:12,  6.19s/epoch, loss=0.845, accuracy=0.664, val_loss=0.825, val_accuracy=0.641]
 97%|█████████▋| 30/31 [03:13<00:06,  6.19s/epoch, loss=0.875, accuracy=0.657, val_loss=0.883, val_accuracy=0.668]
100%|██████████| 31/31 [03:19<00:00,  6.18s/epoch, loss=0.844, accuracy=0.685, val_loss=0.869, val_accuracy=0.672]
100%|██████████| 31/31 [03:19<00:00,  6.42s/epoch, loss=0.844, accuracy=0.685, val_loss=0.869, val_accuracy=0.672]
Test score: 0.46474140882492065
Test accuracy: 0.838919997215271


* * * Run SGD for ID = 16_15. * * *


2024-03-01 13:45:12.891531: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:45:16.252111: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:45:16.253192: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-01 13:45:16.290986: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:45:16.291018: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:45:16.293765: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:45:16.293809: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:45:16.295928: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:45:16.297169: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:45:16.299450: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:45:16.301017: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:45:16.305335: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:45:16.305800: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:45:16.305907: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
<__array_function__ internals>:5: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:159: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_train, y_train = np.array(xs[:idx]), np.array(labels[:idx])
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:160: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_test, y_test = np.array(xs[idx:]), np.array(labels[idx:])
2024-03-01 13:45:21.534326: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-01 13:45:21.534845: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:45:21.535536: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:45:21.535568: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:45:21.535613: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:45:21.535633: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:45:21.535659: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:45:21.535679: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:45:21.535698: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:45:21.535717: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:45:21.535737: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:45:21.536255: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:45:21.536291: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:45:22.143439: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-01 13:45:22.143489: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-01 13:45:22.143498: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-01 13:45:22.144353: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:03:00.0, compute capability: 6.1)
{'id': '16_15', 'seed': 15, 'out_folder': 'results/epoch_budget', 'batch_size': 32, 'epochs': 31, 'validation_split': 0.2, 'checkpointing': True, 'initial_lr': 0.1, 'momentum': 0.98, 'nesterov': True, 'bootstrapping': False, 'map_optimizer': True, 'model': 'CNN-LSTM', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Loading data...
Pad sequences (samples x time)
20000 train sequences
5000 validation sequences
25000 test sequences
x_train shape: (20000, 100)
x_val shape: (5000, 100)
x_test shape: (25000, 100)
Using MAP optimizer with reg_weight:  5e-05
CNN-LSTM

0epoch [00:00, ?epoch/s]
  0%|          | 0/31 [00:00<?, ?epoch/s]2024-03-01 13:45:22.535167: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-01 13:45:22.546980: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199945000 Hz
2024-03-01 13:45:23.970020: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:45:24.135362: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:45:24.745442: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-01 13:45:24.776288: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.

  3%|▎         | 1/31 [00:11<05:35, 11.18s/epoch, loss=0.753, accuracy=0.497, val_loss=0.74, val_accuracy=0.496]
  6%|▋         | 2/31 [00:17<04:08,  8.57s/epoch, loss=0.736, accuracy=0.497, val_loss=0.729, val_accuracy=0.504]
 10%|▉         | 3/31 [00:24<03:29,  7.48s/epoch, loss=0.727, accuracy=0.499, val_loss=0.719, val_accuracy=0.496]
 13%|█▎        | 4/31 [00:30<03:10,  7.05s/epoch, loss=0.602, accuracy=0.683, val_loss=0.466, val_accuracy=0.806]
 16%|█▌        | 5/31 [00:36<02:57,  6.84s/epoch, loss=0.434, accuracy=0.834, val_loss=0.432, val_accuracy=0.84] 
 19%|█▉        | 6/31 [00:43<02:45,  6.64s/epoch, loss=0.412, accuracy=0.862, val_loss=0.49, val_accuracy=0.825]
 23%|██▎       | 7/31 [00:49<02:36,  6.53s/epoch, loss=0.42, accuracy=0.875, val_loss=0.564, val_accuracy=0.82] 
 26%|██▌       | 8/31 [00:55<02:28,  6.44s/epoch, loss=0.52, accuracy=0.855, val_loss=0.75, val_accuracy=0.75] 
 29%|██▉       | 9/31 [01:01<02:19,  6.36s/epoch, loss=0.881, accuracy=0.723, val_loss=1.05, val_accuracy=0.645]
 32%|███▏      | 10/31 [01:08<02:12,  6.33s/epoch, loss=1.14, accuracy=0.655, val_loss=1.21, val_accuracy=0.666]
 35%|███▌      | 11/31 [01:14<02:05,  6.30s/epoch, loss=1.25, accuracy=0.556, val_loss=1.29, val_accuracy=0.496]
 39%|███▊      | 12/31 [01:20<01:59,  6.28s/epoch, loss=1.16, accuracy=0.543, val_loss=1.11, val_accuracy=0.583]
 42%|████▏     | 13/31 [01:26<01:52,  6.25s/epoch, loss=1.09, accuracy=0.555, val_loss=1.13, val_accuracy=0.526]
 45%|████▌     | 14/31 [01:33<01:46,  6.24s/epoch, loss=1.02, accuracy=0.558, val_loss=0.986, val_accuracy=0.58]
 48%|████▊     | 15/31 [01:39<01:39,  6.25s/epoch, loss=0.976, accuracy=0.579, val_loss=0.96, val_accuracy=0.593]
 52%|█████▏    | 16/31 [01:45<01:33,  6.24s/epoch, loss=0.943, accuracy=0.582, val_loss=0.931, val_accuracy=0.582]
 55%|█████▍    | 17/31 [01:51<01:27,  6.24s/epoch, loss=0.94, accuracy=0.587, val_loss=0.921, val_accuracy=0.588] 
 58%|█████▊    | 18/31 [01:58<01:20,  6.23s/epoch, loss=0.935, accuracy=0.576, val_loss=0.891, val_accuracy=0.629]
 61%|██████▏   | 19/31 [02:04<01:14,  6.22s/epoch, loss=0.939, accuracy=0.576, val_loss=0.938, val_accuracy=0.592]
 65%|██████▍   | 20/31 [02:10<01:08,  6.22s/epoch, loss=0.944, accuracy=0.567, val_loss=0.91, val_accuracy=0.611] 
 68%|██████▊   | 21/31 [02:16<01:02,  6.21s/epoch, loss=0.906, accuracy=0.595, val_loss=0.897, val_accuracy=0.602]
 71%|███████   | 22/31 [02:22<00:55,  6.20s/epoch, loss=0.889, accuracy=0.604, val_loss=0.872, val_accuracy=0.629]
 74%|███████▍  | 23/31 [02:29<00:49,  6.20s/epoch, loss=0.92, accuracy=0.582, val_loss=0.911, val_accuracy=0.554] 
 77%|███████▋  | 24/31 [02:35<00:43,  6.21s/epoch, loss=0.895, accuracy=0.601, val_loss=0.898, val_accuracy=0.603]
 81%|████████  | 25/31 [02:41<00:37,  6.23s/epoch, loss=0.931, accuracy=0.592, val_loss=0.964, val_accuracy=0.552]
 84%|████████▍ | 26/31 [02:47<00:31,  6.23s/epoch, loss=0.942, accuracy=0.584, val_loss=1.03, val_accuracy=0.496] 
 87%|████████▋ | 27/31 [02:53<00:24,  6.22s/epoch, loss=0.94, accuracy=0.577, val_loss=0.926, val_accuracy=0.613]
 90%|█████████ | 28/31 [03:00<00:18,  6.21s/epoch, loss=0.942, accuracy=0.585, val_loss=0.96, val_accuracy=0.504]
 94%|█████████▎| 29/31 [03:06<00:12,  6.21s/epoch, loss=0.93, accuracy=0.554, val_loss=0.996, val_accuracy=0.574]
 97%|█████████▋| 30/31 [03:12<00:06,  6.21s/epoch, loss=0.881, accuracy=0.574, val_loss=0.826, val_accuracy=0.613]
100%|██████████| 31/31 [03:18<00:00,  6.23s/epoch, loss=0.854, accuracy=0.6, val_loss=1.08, val_accuracy=0.496]   
100%|██████████| 31/31 [03:18<00:00,  6.41s/epoch, loss=0.854, accuracy=0.6, val_loss=1.08, val_accuracy=0.496]
Test score: 0.42836055159568787
Test accuracy: 0.8421599864959717


* * * Run SGD for ID = 16_16. * * *


2024-03-01 13:48:46.963733: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:48:50.395998: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:48:50.397073: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-01 13:48:50.436308: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:48:50.436338: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:48:50.439209: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:48:50.439248: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:48:50.441464: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:48:50.442168: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:48:50.444531: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:48:50.446092: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:48:50.450934: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:48:50.452817: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:48:50.452933: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
<__array_function__ internals>:5: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:159: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_train, y_train = np.array(xs[:idx]), np.array(labels[:idx])
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:160: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_test, y_test = np.array(xs[idx:]), np.array(labels[idx:])
2024-03-01 13:48:55.659591: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-01 13:48:55.660135: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:48:55.660644: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:48:55.660675: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:48:55.660719: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:48:55.660738: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:48:55.660757: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:48:55.660774: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:48:55.660792: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:48:55.660817: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:48:55.660862: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:48:55.661321: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:48:55.661354: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:48:56.455743: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-01 13:48:56.455792: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-01 13:48:56.455801: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-01 13:48:56.456725: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:03:00.0, compute capability: 6.1)
{'id': '16_16', 'seed': 16, 'out_folder': 'results/epoch_budget', 'batch_size': 32, 'epochs': 31, 'validation_split': 0.2, 'checkpointing': True, 'initial_lr': 0.1, 'momentum': 0.98, 'nesterov': True, 'bootstrapping': False, 'map_optimizer': True, 'model': 'CNN-LSTM', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Loading data...
Pad sequences (samples x time)
20000 train sequences
5000 validation sequences
25000 test sequences
x_train shape: (20000, 100)
x_val shape: (5000, 100)
x_test shape: (25000, 100)
Using MAP optimizer with reg_weight:  5e-05
CNN-LSTM

0epoch [00:00, ?epoch/s]
  0%|          | 0/31 [00:00<?, ?epoch/s]2024-03-01 13:48:56.850164: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-01 13:48:56.861949: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199945000 Hz
2024-03-01 13:48:58.275893: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:48:58.441153: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:48:59.055001: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-01 13:48:59.087464: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.

  3%|▎         | 1/31 [00:11<05:32, 11.07s/epoch, loss=0.692, accuracy=0.599, val_loss=0.521, val_accuracy=0.781]
  6%|▋         | 2/31 [00:18<04:10,  8.64s/epoch, loss=0.488, accuracy=0.812, val_loss=0.491, val_accuracy=0.813]
 10%|▉         | 3/31 [00:24<03:37,  7.77s/epoch, loss=0.434, accuracy=0.856, val_loss=0.464, val_accuracy=0.84] 
 13%|█▎        | 4/31 [00:30<03:13,  7.15s/epoch, loss=0.437, accuracy=0.869, val_loss=0.531, val_accuracy=0.825]
 16%|█▌        | 5/31 [00:37<02:57,  6.81s/epoch, loss=0.545, accuracy=0.847, val_loss=0.618, val_accuracy=0.824]
 19%|█▉        | 6/31 [00:43<02:45,  6.62s/epoch, loss=0.708, accuracy=0.804, val_loss=0.918, val_accuracy=0.727]
 23%|██▎       | 7/31 [00:49<02:35,  6.50s/epoch, loss=1.13, accuracy=0.615, val_loss=1.17, val_accuracy=0.612]  
 26%|██▌       | 8/31 [00:55<02:27,  6.41s/epoch, loss=1.18, accuracy=0.558, val_loss=1.16, val_accuracy=0.553]
 29%|██▉       | 9/31 [01:02<02:19,  6.34s/epoch, loss=1.12, accuracy=0.571, val_loss=1.08, val_accuracy=0.567]
 32%|███▏      | 10/31 [01:08<02:12,  6.29s/epoch, loss=1.06, accuracy=0.586, val_loss=1.06, val_accuracy=0.516]
 35%|███▌      | 11/31 [01:14<02:05,  6.28s/epoch, loss=1.01, accuracy=0.6, val_loss=0.983, val_accuracy=0.617] 
 39%|███▊      | 12/31 [01:20<01:58,  6.26s/epoch, loss=0.986, accuracy=0.577, val_loss=0.956, val_accuracy=0.608]
 42%|████▏     | 13/31 [01:26<01:52,  6.24s/epoch, loss=0.966, accuracy=0.583, val_loss=0.981, val_accuracy=0.531]
 45%|████▌     | 14/31 [01:33<01:46,  6.25s/epoch, loss=0.948, accuracy=0.579, val_loss=0.973, val_accuracy=0.513]
 48%|████▊     | 15/31 [01:39<01:39,  6.23s/epoch, loss=0.931, accuracy=0.586, val_loss=0.933, val_accuracy=0.578]
 52%|█████▏    | 16/31 [01:45<01:33,  6.24s/epoch, loss=0.94, accuracy=0.566, val_loss=0.965, val_accuracy=0.566] 
 55%|█████▍    | 17/31 [01:51<01:27,  6.23s/epoch, loss=0.911, accuracy=0.59, val_loss=0.903, val_accuracy=0.608]
 58%|█████▊    | 18/31 [01:58<01:20,  6.23s/epoch, loss=0.893, accuracy=0.573, val_loss=0.962, val_accuracy=0.484]
 61%|██████▏   | 19/31 [02:04<01:14,  6.23s/epoch, loss=0.864, accuracy=0.582, val_loss=0.855, val_accuracy=0.624]
 65%|██████▍   | 20/31 [02:10<01:08,  6.24s/epoch, loss=0.842, accuracy=0.6, val_loss=0.916, val_accuracy=0.485]  
 68%|██████▊   | 21/31 [02:16<01:02,  6.23s/epoch, loss=0.852, accuracy=0.597, val_loss=0.853, val_accuracy=0.486]
 71%|███████   | 22/31 [02:23<00:56,  6.24s/epoch, loss=0.864, accuracy=0.564, val_loss=0.856, val_accuracy=0.545]
 74%|███████▍  | 23/31 [02:29<00:49,  6.24s/epoch, loss=0.856, accuracy=0.579, val_loss=0.911, val_accuracy=0.553]
 77%|███████▋  | 24/31 [02:35<00:43,  6.23s/epoch, loss=0.857, accuracy=0.606, val_loss=0.898, val_accuracy=0.578]
 81%|████████  | 25/31 [02:41<00:37,  6.23s/epoch, loss=0.817, accuracy=0.642, val_loss=0.833, val_accuracy=0.646]
 84%|████████▍ | 26/31 [02:47<00:31,  6.24s/epoch, loss=0.818, accuracy=0.662, val_loss=0.913, val_accuracy=0.485]
 87%|████████▋ | 27/31 [02:54<00:24,  6.22s/epoch, loss=0.866, accuracy=0.631, val_loss=0.84, val_accuracy=0.673] 
 90%|█████████ | 28/31 [03:00<00:18,  6.20s/epoch, loss=0.859, accuracy=0.638, val_loss=0.936, val_accuracy=0.612]
 94%|█████████▎| 29/31 [03:06<00:12,  6.18s/epoch, loss=0.883, accuracy=0.636, val_loss=0.94, val_accuracy=0.593] 
 97%|█████████▋| 30/31 [03:12<00:06,  6.17s/epoch, loss=0.943, accuracy=0.587, val_loss=0.92, val_accuracy=0.587]
100%|██████████| 31/31 [03:18<00:00,  6.18s/epoch, loss=0.916, accuracy=0.594, val_loss=0.903, val_accuracy=0.606]
100%|██████████| 31/31 [03:18<00:00,  6.41s/epoch, loss=0.916, accuracy=0.594, val_loss=0.903, val_accuracy=0.606]
Test score: 0.4790351986885071
Test accuracy: 0.8346800208091736

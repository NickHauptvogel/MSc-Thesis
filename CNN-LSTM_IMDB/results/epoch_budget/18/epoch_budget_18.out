Fri Mar  1 13:04:43 2024       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 545.23.08              Driver Version: 545.23.08    CUDA Version: 12.3     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA TITAN Xp                Off | 00000000:83:00.0 Off |                  N/A |
| 28%   42C    P8              10W / 250W |      0MiB / 12288MiB |      0%      Default |
|                                         |                      |                  N/A |
+-----------------------------------------+----------------------+----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
|  No running processes found                                                           |
+---------------------------------------------------------------------------------------+


* * * Run SGD for cluster size = 18. * * *


Budget: 27


* * * Run SGD for ID = 18_1. * * *


2024-03-01 13:04:43.570339: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:04:48.045925: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:04:48.046974: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-01 13:04:48.082068: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:04:48.082100: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:04:48.085454: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:04:48.085495: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:04:48.087951: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:04:48.088975: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:04:48.091603: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:04:48.093281: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:04:48.097909: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:04:48.098395: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:04:48.098497: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
<__array_function__ internals>:5: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:159: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_train, y_train = np.array(xs[:idx]), np.array(labels[:idx])
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:160: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_test, y_test = np.array(xs[idx:]), np.array(labels[idx:])
2024-03-01 13:04:53.374120: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-01 13:04:53.374641: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:04:53.375480: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:04:53.375515: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:04:53.375568: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:04:53.375589: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:04:53.375608: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:04:53.375627: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:04:53.375646: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:04:53.375664: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:04:53.375683: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:04:53.376165: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:04:53.376198: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:04:54.016657: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-01 13:04:54.016711: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-01 13:04:54.016721: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-01 13:04:54.017665: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:83:00.0, compute capability: 6.1)
{'id': '18_01', 'seed': 1, 'out_folder': 'results/epoch_budget', 'batch_size': 32, 'epochs': 27, 'validation_split': 0.2, 'checkpointing': True, 'initial_lr': 0.1, 'momentum': 0.98, 'nesterov': True, 'bootstrapping': False, 'map_optimizer': True, 'model': 'CNN-LSTM', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Loading data...
Pad sequences (samples x time)
20000 train sequences
5000 validation sequences
25000 test sequences
x_train shape: (20000, 100)
x_val shape: (5000, 100)
x_test shape: (25000, 100)
Using MAP optimizer with reg_weight:  5e-05
CNN-LSTM

0epoch [00:00, ?epoch/s]
  0%|          | 0/27 [00:00<?, ?epoch/s]2024-03-01 13:04:54.415562: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-01 13:04:54.427970: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199945000 Hz
2024-03-01 13:04:55.850008: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:04:56.019012: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:04:56.642415: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-01 13:04:56.671823: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.

  4%|▎         | 1/27 [00:11<04:51, 11.20s/epoch, loss=0.694, accuracy=0.599, val_loss=0.508, val_accuracy=0.79]
  7%|▋         | 2/27 [00:18<03:39,  8.80s/epoch, loss=0.473, accuracy=0.82, val_loss=0.463, val_accuracy=0.824]
 11%|█         | 3/27 [00:24<03:06,  7.79s/epoch, loss=0.424, accuracy=0.858, val_loss=0.471, val_accuracy=0.836]
 15%|█▍        | 4/27 [00:31<02:48,  7.33s/epoch, loss=0.416, accuracy=0.878, val_loss=0.513, val_accuracy=0.838]
 19%|█▊        | 5/27 [00:37<02:34,  7.01s/epoch, loss=0.434, accuracy=0.886, val_loss=0.568, val_accuracy=0.841]
 22%|██▏       | 6/27 [00:44<02:21,  6.75s/epoch, loss=0.483, accuracy=0.885, val_loss=0.727, val_accuracy=0.816]
 26%|██▌       | 7/27 [00:50<02:11,  6.58s/epoch, loss=0.76, accuracy=0.794, val_loss=1.08, val_accuracy=0.67]   
 30%|██▉       | 8/27 [00:56<02:02,  6.46s/epoch, loss=1.19, accuracy=0.616, val_loss=1.2, val_accuracy=0.586]
 33%|███▎      | 9/27 [01:02<01:55,  6.39s/epoch, loss=1.16, accuracy=0.572, val_loss=1.1, val_accuracy=0.609]
 37%|███▋      | 10/27 [01:09<01:47,  6.33s/epoch, loss=1.11, accuracy=0.567, val_loss=1.05, val_accuracy=0.577]
 41%|████      | 11/27 [01:15<01:40,  6.29s/epoch, loss=1.01, accuracy=0.593, val_loss=0.969, val_accuracy=0.644]
 44%|████▍     | 12/27 [01:21<01:34,  6.28s/epoch, loss=1, accuracy=0.571, val_loss=0.98, val_accuracy=0.546]    
 48%|████▊     | 13/27 [01:27<01:27,  6.27s/epoch, loss=0.958, accuracy=0.572, val_loss=0.991, val_accuracy=0.548]
 52%|█████▏    | 14/27 [01:34<01:21,  6.27s/epoch, loss=0.946, accuracy=0.57, val_loss=1.04, val_accuracy=0.513]  
 56%|█████▌    | 15/27 [01:40<01:15,  6.27s/epoch, loss=0.923, accuracy=0.574, val_loss=0.885, val_accuracy=0.592]
 59%|█████▉    | 16/27 [01:46<01:08,  6.25s/epoch, loss=0.874, accuracy=0.591, val_loss=0.893, val_accuracy=0.513]
 63%|██████▎   | 17/27 [01:52<01:02,  6.24s/epoch, loss=0.826, accuracy=0.628, val_loss=0.834, val_accuracy=0.613]
 67%|██████▋   | 18/27 [01:58<00:56,  6.24s/epoch, loss=0.853, accuracy=0.61, val_loss=0.844, val_accuracy=0.624] 
 70%|███████   | 19/27 [02:05<00:49,  6.25s/epoch, loss=0.861, accuracy=0.629, val_loss=0.867, val_accuracy=0.617]
 74%|███████▍  | 20/27 [02:11<00:43,  6.24s/epoch, loss=0.879, accuracy=0.601, val_loss=0.859, val_accuracy=0.594]
 78%|███████▊  | 21/27 [02:17<00:37,  6.25s/epoch, loss=0.849, accuracy=0.618, val_loss=0.856, val_accuracy=0.636]
 81%|████████▏ | 22/27 [02:23<00:31,  6.25s/epoch, loss=0.82, accuracy=0.647, val_loss=0.835, val_accuracy=0.652] 
 85%|████████▌ | 23/27 [02:30<00:24,  6.24s/epoch, loss=0.827, accuracy=0.672, val_loss=0.788, val_accuracy=0.687]
 89%|████████▉ | 24/27 [02:36<00:18,  6.23s/epoch, loss=0.825, accuracy=0.673, val_loss=0.879, val_accuracy=0.632]
 93%|█████████▎| 25/27 [02:42<00:12,  6.22s/epoch, loss=0.853, accuracy=0.659, val_loss=0.902, val_accuracy=0.566]
 96%|█████████▋| 26/27 [02:48<00:06,  6.22s/epoch, loss=0.869, accuracy=0.637, val_loss=0.855, val_accuracy=0.666]
100%|██████████| 27/27 [02:54<00:00,  6.20s/epoch, loss=0.876, accuracy=0.642, val_loss=0.912, val_accuracy=0.633]
100%|██████████| 27/27 [02:54<00:00,  6.48s/epoch, loss=0.876, accuracy=0.642, val_loss=0.912, val_accuracy=0.633]
Test score: 0.557216465473175
Test accuracy: 0.840719997882843


* * * Run SGD for ID = 18_2. * * *


2024-03-01 13:07:55.081000: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:07:58.338759: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:07:58.339753: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-01 13:07:58.380073: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:07:58.380112: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:07:58.383114: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:07:58.383157: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:07:58.385774: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:07:58.386946: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:07:58.389502: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:07:58.390950: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:07:58.395962: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:07:58.396476: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:07:58.396585: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
<__array_function__ internals>:5: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:159: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_train, y_train = np.array(xs[:idx]), np.array(labels[:idx])
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:160: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_test, y_test = np.array(xs[idx:]), np.array(labels[idx:])
2024-03-01 13:08:03.664664: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-01 13:08:03.665218: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:08:03.666080: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:08:03.666120: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:08:03.666210: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:08:03.666232: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:08:03.666251: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:08:03.666270: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:08:03.666288: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:08:03.666307: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:08:03.666326: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:08:03.669168: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:08:03.669210: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:08:04.308681: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-01 13:08:04.308744: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-01 13:08:04.308754: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-01 13:08:04.309622: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:83:00.0, compute capability: 6.1)
{'id': '18_02', 'seed': 2, 'out_folder': 'results/epoch_budget', 'batch_size': 32, 'epochs': 27, 'validation_split': 0.2, 'checkpointing': True, 'initial_lr': 0.1, 'momentum': 0.98, 'nesterov': True, 'bootstrapping': False, 'map_optimizer': True, 'model': 'CNN-LSTM', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Loading data...
Pad sequences (samples x time)
20000 train sequences
5000 validation sequences
25000 test sequences
x_train shape: (20000, 100)
x_val shape: (5000, 100)
x_test shape: (25000, 100)
Using MAP optimizer with reg_weight:  5e-05
CNN-LSTM

0epoch [00:00, ?epoch/s]
  0%|          | 0/27 [00:00<?, ?epoch/s]2024-03-01 13:08:04.723235: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-01 13:08:04.735064: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199945000 Hz
2024-03-01 13:08:06.245793: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:08:06.425351: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:08:07.066222: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-01 13:08:07.094595: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.

  4%|▎         | 1/27 [00:10<04:42, 10.86s/epoch, loss=0.664, accuracy=0.635, val_loss=0.534, val_accuracy=0.773]
  7%|▋         | 2/27 [00:17<03:27,  8.30s/epoch, loss=0.48, accuracy=0.821, val_loss=0.444, val_accuracy=0.845] 
 11%|█         | 3/27 [00:23<02:56,  7.34s/epoch, loss=0.432, accuracy=0.859, val_loss=0.481, val_accuracy=0.842]
 15%|█▍        | 4/27 [00:29<02:38,  6.88s/epoch, loss=0.435, accuracy=0.872, val_loss=0.53, val_accuracy=0.836] 
 19%|█▊        | 5/27 [00:35<02:25,  6.63s/epoch, loss=0.567, accuracy=0.831, val_loss=0.867, val_accuracy=0.675]
 22%|██▏       | 6/27 [00:42<02:15,  6.47s/epoch, loss=0.92, accuracy=0.692, val_loss=1.04, val_accuracy=0.644]  
 26%|██▌       | 7/27 [00:48<02:07,  6.38s/epoch, loss=1.09, accuracy=0.636, val_loss=1.07, val_accuracy=0.676]
 30%|██▉       | 8/27 [00:54<02:00,  6.32s/epoch, loss=1.11, accuracy=0.603, val_loss=1.13, val_accuracy=0.545]
 33%|███▎      | 9/27 [01:00<01:52,  6.27s/epoch, loss=1.1, accuracy=0.603, val_loss=1.12, val_accuracy=0.638] 
 37%|███▋      | 10/27 [01:06<01:46,  6.24s/epoch, loss=1.12, accuracy=0.591, val_loss=1.08, val_accuracy=0.558]
 41%|████      | 11/27 [01:13<01:39,  6.25s/epoch, loss=1.08, accuracy=0.6, val_loss=1.1, val_accuracy=0.535]   
 44%|████▍     | 12/27 [01:19<01:33,  6.22s/epoch, loss=1.07, accuracy=0.573, val_loss=1.14, val_accuracy=0.51]
 48%|████▊     | 13/27 [01:25<01:26,  6.20s/epoch, loss=1.04, accuracy=0.535, val_loss=1.03, val_accuracy=0.509]
 52%|█████▏    | 14/27 [01:31<01:20,  6.19s/epoch, loss=0.958, accuracy=0.551, val_loss=0.986, val_accuracy=0.509]
 56%|█████▌    | 15/27 [01:37<01:14,  6.19s/epoch, loss=0.905, accuracy=0.577, val_loss=0.857, val_accuracy=0.605]
 59%|█████▉    | 16/27 [01:43<01:08,  6.19s/epoch, loss=0.879, accuracy=0.554, val_loss=0.84, val_accuracy=0.595] 
 63%|██████▎   | 17/27 [01:50<01:02,  6.20s/epoch, loss=0.847, accuracy=0.585, val_loss=0.837, val_accuracy=0.622]
 67%|██████▋   | 18/27 [01:56<00:55,  6.20s/epoch, loss=0.84, accuracy=0.621, val_loss=0.838, val_accuracy=0.616] 
 70%|███████   | 19/27 [02:02<00:49,  6.20s/epoch, loss=0.841, accuracy=0.621, val_loss=0.846, val_accuracy=0.627]
 74%|███████▍  | 20/27 [02:08<00:43,  6.20s/epoch, loss=0.815, accuracy=0.647, val_loss=0.809, val_accuracy=0.658]
 78%|███████▊  | 21/27 [02:14<00:37,  6.19s/epoch, loss=0.833, accuracy=0.636, val_loss=0.848, val_accuracy=0.625]
 81%|████████▏ | 22/27 [02:21<00:30,  6.19s/epoch, loss=0.866, accuracy=0.643, val_loss=0.9, val_accuracy=0.654]  
 85%|████████▌ | 23/27 [02:27<00:24,  6.18s/epoch, loss=0.893, accuracy=0.66, val_loss=0.896, val_accuracy=0.638]
 89%|████████▉ | 24/27 [02:33<00:18,  6.18s/epoch, loss=0.919, accuracy=0.63, val_loss=0.973, val_accuracy=0.59] 
 93%|█████████▎| 25/27 [02:39<00:12,  6.17s/epoch, loss=0.954, accuracy=0.588, val_loss=0.925, val_accuracy=0.599]
 96%|█████████▋| 26/27 [02:45<00:06,  6.17s/epoch, loss=0.926, accuracy=0.595, val_loss=0.925, val_accuracy=0.588]
100%|██████████| 27/27 [02:51<00:00,  6.16s/epoch, loss=0.914, accuracy=0.604, val_loss=0.965, val_accuracy=0.492]
100%|██████████| 27/27 [02:51<00:00,  6.37s/epoch, loss=0.914, accuracy=0.604, val_loss=0.965, val_accuracy=0.492]
Test score: 0.44386929273605347
Test accuracy: 0.8405200242996216


* * * Run SGD for ID = 18_3. * * *


2024-03-01 13:11:02.299185: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:11:05.658649: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:11:05.659664: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-01 13:11:05.697966: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:11:05.698000: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:11:05.700931: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:11:05.700972: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:11:05.703519: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:11:05.704230: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:11:05.706823: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:11:05.708259: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:11:05.712868: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:11:05.713354: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:11:05.713458: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
<__array_function__ internals>:5: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:159: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_train, y_train = np.array(xs[:idx]), np.array(labels[:idx])
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:160: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_test, y_test = np.array(xs[idx:]), np.array(labels[idx:])
2024-03-01 13:11:10.964885: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-01 13:11:10.965396: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:11:10.966295: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:11:10.966328: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:11:10.966385: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:11:10.966406: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:11:10.966424: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:11:10.966442: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:11:10.966459: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:11:10.966477: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:11:10.966495: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:11:10.966932: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:11:10.966966: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:11:11.577006: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-01 13:11:11.577081: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-01 13:11:11.577092: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-01 13:11:11.577969: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:83:00.0, compute capability: 6.1)
{'id': '18_03', 'seed': 3, 'out_folder': 'results/epoch_budget', 'batch_size': 32, 'epochs': 27, 'validation_split': 0.2, 'checkpointing': True, 'initial_lr': 0.1, 'momentum': 0.98, 'nesterov': True, 'bootstrapping': False, 'map_optimizer': True, 'model': 'CNN-LSTM', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Loading data...
Pad sequences (samples x time)
20000 train sequences
5000 validation sequences
25000 test sequences
x_train shape: (20000, 100)
x_val shape: (5000, 100)
x_test shape: (25000, 100)
Using MAP optimizer with reg_weight:  5e-05
CNN-LSTM

0epoch [00:00, ?epoch/s]
  0%|          | 0/27 [00:00<?, ?epoch/s]2024-03-01 13:11:11.974726: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-01 13:11:11.986961: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199945000 Hz
2024-03-01 13:11:13.411888: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:11:13.580280: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:11:14.248438: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-01 13:11:14.278638: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.

  4%|▎         | 1/27 [00:10<04:44, 10.96s/epoch, loss=0.641, accuracy=0.664, val_loss=0.483, val_accuracy=0.812]
  7%|▋         | 2/27 [00:17<03:32,  8.52s/epoch, loss=0.457, accuracy=0.837, val_loss=0.458, val_accuracy=0.836]
 11%|█         | 3/27 [00:24<03:04,  7.68s/epoch, loss=0.41, accuracy=0.869, val_loss=0.476, val_accuracy=0.845] 
 15%|█▍        | 4/27 [00:30<02:43,  7.10s/epoch, loss=0.403, accuracy=0.885, val_loss=0.512, val_accuracy=0.842]
 19%|█▊        | 5/27 [00:37<02:31,  6.88s/epoch, loss=0.409, accuracy=0.897, val_loss=0.559, val_accuracy=0.847]
 22%|██▏       | 6/27 [00:43<02:19,  6.66s/epoch, loss=0.426, accuracy=0.905, val_loss=0.611, val_accuracy=0.84] 
 26%|██▌       | 7/27 [00:49<02:10,  6.52s/epoch, loss=0.63, accuracy=0.841, val_loss=0.949, val_accuracy=0.729]
 30%|██▉       | 8/27 [00:55<02:02,  6.43s/epoch, loss=1.09, accuracy=0.66, val_loss=1.26, val_accuracy=0.507]  
 33%|███▎      | 9/27 [01:02<01:54,  6.37s/epoch, loss=1.18, accuracy=0.604, val_loss=1.14, val_accuracy=0.619]
 37%|███▋      | 10/27 [01:08<01:47,  6.32s/epoch, loss=1.16, accuracy=0.603, val_loss=1.12, val_accuracy=0.623]
 41%|████      | 11/27 [01:14<01:40,  6.30s/epoch, loss=1.16, accuracy=0.575, val_loss=1.15, val_accuracy=0.568]
 44%|████▍     | 12/27 [01:20<01:34,  6.28s/epoch, loss=1.11, accuracy=0.55, val_loss=1.15, val_accuracy=0.558] 
 48%|████▊     | 13/27 [01:27<01:27,  6.27s/epoch, loss=1.03, accuracy=0.555, val_loss=0.985, val_accuracy=0.587]
 52%|█████▏    | 14/27 [01:33<01:21,  6.27s/epoch, loss=0.966, accuracy=0.541, val_loss=0.96, val_accuracy=0.508]
 56%|█████▌    | 15/27 [01:39<01:15,  6.27s/epoch, loss=0.935, accuracy=0.535, val_loss=0.93, val_accuracy=0.559]
 59%|█████▉    | 16/27 [01:45<01:08,  6.26s/epoch, loss=0.909, accuracy=0.572, val_loss=0.861, val_accuracy=0.619]
 63%|██████▎   | 17/27 [01:52<01:02,  6.25s/epoch, loss=0.834, accuracy=0.632, val_loss=0.818, val_accuracy=0.652]
 67%|██████▋   | 18/27 [01:58<00:56,  6.25s/epoch, loss=0.885, accuracy=0.575, val_loss=0.874, val_accuracy=0.578]
 70%|███████   | 19/27 [02:04<00:49,  6.24s/epoch, loss=0.868, accuracy=0.584, val_loss=0.865, val_accuracy=0.593]
 74%|███████▍  | 20/27 [02:10<00:43,  6.23s/epoch, loss=0.838, accuracy=0.617, val_loss=0.833, val_accuracy=0.627]
 78%|███████▊  | 21/27 [02:16<00:37,  6.23s/epoch, loss=0.798, accuracy=0.646, val_loss=0.783, val_accuracy=0.65] 
 81%|████████▏ | 22/27 [02:23<00:31,  6.24s/epoch, loss=0.799, accuracy=0.655, val_loss=0.821, val_accuracy=0.664]
 85%|████████▌ | 23/27 [02:29<00:24,  6.22s/epoch, loss=0.861, accuracy=0.635, val_loss=0.965, val_accuracy=0.493]
 89%|████████▉ | 24/27 [02:35<00:18,  6.21s/epoch, loss=0.905, accuracy=0.613, val_loss=0.912, val_accuracy=0.619]
 93%|█████████▎| 25/27 [02:41<00:12,  6.20s/epoch, loss=0.924, accuracy=0.618, val_loss=0.926, val_accuracy=0.597]
 96%|█████████▋| 26/27 [02:47<00:06,  6.20s/epoch, loss=0.927, accuracy=0.611, val_loss=0.91, val_accuracy=0.618] 
100%|██████████| 27/27 [02:54<00:00,  6.20s/epoch, loss=0.899, accuracy=0.62, val_loss=0.888, val_accuracy=0.645]
100%|██████████| 27/27 [02:54<00:00,  6.45s/epoch, loss=0.899, accuracy=0.62, val_loss=0.888, val_accuracy=0.645]
Test score: 0.562750518321991
Test accuracy: 0.8433600068092346


* * * Run SGD for ID = 18_4. * * *


2024-03-01 13:14:11.685923: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:14:15.069000: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:14:15.069933: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-01 13:14:15.116766: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:14:15.116801: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:14:15.119999: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:14:15.120041: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:14:15.122532: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:14:15.123551: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:14:15.126368: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:14:15.127937: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:14:15.132716: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:14:15.133211: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:14:15.133309: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
<__array_function__ internals>:5: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:159: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_train, y_train = np.array(xs[:idx]), np.array(labels[:idx])
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:160: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_test, y_test = np.array(xs[idx:]), np.array(labels[idx:])
2024-03-01 13:14:20.295074: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-01 13:14:20.295565: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:14:20.296880: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:14:20.296918: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:14:20.296968: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:14:20.296990: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:14:20.297009: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:14:20.297029: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:14:20.297048: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:14:20.297068: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:14:20.297088: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:14:20.297555: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:14:20.297588: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:14:20.941255: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-01 13:14:20.941312: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-01 13:14:20.941321: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-01 13:14:20.942215: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:83:00.0, compute capability: 6.1)
{'id': '18_04', 'seed': 4, 'out_folder': 'results/epoch_budget', 'batch_size': 32, 'epochs': 27, 'validation_split': 0.2, 'checkpointing': True, 'initial_lr': 0.1, 'momentum': 0.98, 'nesterov': True, 'bootstrapping': False, 'map_optimizer': True, 'model': 'CNN-LSTM', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Loading data...
Pad sequences (samples x time)
20000 train sequences
5000 validation sequences
25000 test sequences
x_train shape: (20000, 100)
x_val shape: (5000, 100)
x_test shape: (25000, 100)
Using MAP optimizer with reg_weight:  5e-05
CNN-LSTM

0epoch [00:00, ?epoch/s]
  0%|          | 0/27 [00:00<?, ?epoch/s]2024-03-01 13:14:21.336773: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-01 13:14:21.349075: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199945000 Hz
2024-03-01 13:14:22.779235: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:14:22.943469: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:14:23.705045: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-01 13:14:23.831621: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.

  4%|▎         | 1/27 [00:11<04:47, 11.04s/epoch, loss=0.667, accuracy=0.625, val_loss=0.495, val_accuracy=0.816]
  7%|▋         | 2/27 [00:17<03:29,  8.38s/epoch, loss=0.467, accuracy=0.827, val_loss=0.434, val_accuracy=0.843]
 11%|█         | 3/27 [00:23<02:59,  7.47s/epoch, loss=0.424, accuracy=0.86, val_loss=0.478, val_accuracy=0.849] 
 15%|█▍        | 4/27 [00:30<02:41,  7.02s/epoch, loss=0.423, accuracy=0.878, val_loss=0.488, val_accuracy=0.85]
 19%|█▊        | 5/27 [00:36<02:27,  6.72s/epoch, loss=0.432, accuracy=0.887, val_loss=0.545, val_accuracy=0.85]
 22%|██▏       | 6/27 [00:42<02:17,  6.53s/epoch, loss=0.511, accuracy=0.87, val_loss=0.676, val_accuracy=0.814]
 26%|██▌       | 7/27 [00:48<02:08,  6.42s/epoch, loss=0.949, accuracy=0.698, val_loss=1.25, val_accuracy=0.509]
 30%|██▉       | 8/27 [00:54<02:00,  6.33s/epoch, loss=1.18, accuracy=0.532, val_loss=1.12, val_accuracy=0.504] 
 33%|███▎      | 9/27 [01:01<01:53,  6.29s/epoch, loss=1.08, accuracy=0.509, val_loss=1.02, val_accuracy=0.506]
 37%|███▋      | 10/27 [01:07<01:46,  6.25s/epoch, loss=0.965, accuracy=0.577, val_loss=0.968, val_accuracy=0.522]
 41%|████      | 11/27 [01:13<01:39,  6.23s/epoch, loss=0.918, accuracy=0.64, val_loss=0.927, val_accuracy=0.615] 
 44%|████▍     | 12/27 [01:19<01:33,  6.20s/epoch, loss=0.933, accuracy=0.625, val_loss=0.909, val_accuracy=0.665]
 48%|████▊     | 13/27 [01:25<01:26,  6.20s/epoch, loss=0.93, accuracy=0.616, val_loss=0.924, val_accuracy=0.629] 
 52%|█████▏    | 14/27 [01:31<01:20,  6.19s/epoch, loss=0.92, accuracy=0.618, val_loss=0.888, val_accuracy=0.645]
 56%|█████▌    | 15/27 [01:38<01:14,  6.19s/epoch, loss=0.917, accuracy=0.647, val_loss=0.97, val_accuracy=0.616]
 59%|█████▉    | 16/27 [01:44<01:08,  6.19s/epoch, loss=0.962, accuracy=0.619, val_loss=1.06, val_accuracy=0.62] 
 63%|██████▎   | 17/27 [01:50<01:01,  6.18s/epoch, loss=0.915, accuracy=0.643, val_loss=0.909, val_accuracy=0.665]
 67%|██████▋   | 18/27 [01:56<00:55,  6.19s/epoch, loss=0.928, accuracy=0.629, val_loss=0.913, val_accuracy=0.644]
 70%|███████   | 19/27 [02:02<00:49,  6.19s/epoch, loss=0.947, accuracy=0.584, val_loss=0.912, val_accuracy=0.616]
 74%|███████▍  | 20/27 [02:09<00:43,  6.21s/epoch, loss=0.921, accuracy=0.592, val_loss=0.892, val_accuracy=0.627]
 78%|███████▊  | 21/27 [02:15<00:37,  6.18s/epoch, loss=0.891, accuracy=0.625, val_loss=0.873, val_accuracy=0.645]
 81%|████████▏ | 22/27 [02:21<00:30,  6.18s/epoch, loss=0.923, accuracy=0.628, val_loss=0.919, val_accuracy=0.629]
 85%|████████▌ | 23/27 [02:27<00:24,  6.18s/epoch, loss=0.925, accuracy=0.63, val_loss=0.942, val_accuracy=0.649] 
 89%|████████▉ | 24/27 [02:33<00:18,  6.18s/epoch, loss=0.964, accuracy=0.608, val_loss=0.993, val_accuracy=0.61]
 93%|█████████▎| 25/27 [02:40<00:12,  6.18s/epoch, loss=0.986, accuracy=0.593, val_loss=0.953, val_accuracy=0.594]
 96%|█████████▋| 26/27 [02:46<00:06,  6.16s/epoch, loss=0.935, accuracy=0.608, val_loss=0.973, val_accuracy=0.499]
100%|██████████| 27/27 [02:52<00:00,  6.16s/epoch, loss=0.881, accuracy=0.636, val_loss=0.898, val_accuracy=0.639]
100%|██████████| 27/27 [02:52<00:00,  6.38s/epoch, loss=0.881, accuracy=0.636, val_loss=0.898, val_accuracy=0.639]
Test score: 0.5061658024787903
Test accuracy: 0.8411200046539307


* * * Run SGD for ID = 18_5. * * *


2024-03-01 13:17:19.120906: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:17:21.735444: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:17:21.736491: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-01 13:17:21.784930: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:17:21.784965: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:17:21.787611: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:17:21.787652: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:17:21.790012: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:17:21.790572: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:17:21.792868: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:17:21.794204: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:17:21.798723: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:17:21.799219: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:17:21.799339: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
<__array_function__ internals>:5: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:159: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_train, y_train = np.array(xs[:idx]), np.array(labels[:idx])
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:160: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_test, y_test = np.array(xs[idx:]), np.array(labels[idx:])
2024-03-01 13:17:26.959899: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-01 13:17:26.960429: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:17:26.960975: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:17:26.961015: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:17:26.961065: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:17:26.961086: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:17:26.961107: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:17:26.961143: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:17:26.961163: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:17:26.961182: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:17:26.961202: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:17:26.961633: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:17:26.961672: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:17:27.583680: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-01 13:17:27.583741: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-01 13:17:27.583751: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-01 13:17:27.584627: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:83:00.0, compute capability: 6.1)
{'id': '18_05', 'seed': 5, 'out_folder': 'results/epoch_budget', 'batch_size': 32, 'epochs': 27, 'validation_split': 0.2, 'checkpointing': True, 'initial_lr': 0.1, 'momentum': 0.98, 'nesterov': True, 'bootstrapping': False, 'map_optimizer': True, 'model': 'CNN-LSTM', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Loading data...
Pad sequences (samples x time)
20000 train sequences
5000 validation sequences
25000 test sequences
x_train shape: (20000, 100)
x_val shape: (5000, 100)
x_test shape: (25000, 100)
Using MAP optimizer with reg_weight:  5e-05
CNN-LSTM

0epoch [00:00, ?epoch/s]
  0%|          | 0/27 [00:00<?, ?epoch/s]2024-03-01 13:17:27.992931: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-01 13:17:28.004957: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199945000 Hz
2024-03-01 13:17:29.485382: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:17:29.657199: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:17:30.301908: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-01 13:17:30.330035: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.

  4%|▎         | 1/27 [00:11<05:03, 11.68s/epoch, loss=0.731, accuracy=0.54, val_loss=0.624, val_accuracy=0.717]
  7%|▋         | 2/27 [00:18<03:37,  8.72s/epoch, loss=0.535, accuracy=0.778, val_loss=0.542, val_accuracy=0.786]
 11%|█         | 3/27 [00:25<03:11,  7.97s/epoch, loss=0.451, accuracy=0.842, val_loss=0.486, val_accuracy=0.829]
 15%|█▍        | 4/27 [00:31<02:49,  7.39s/epoch, loss=0.439, accuracy=0.867, val_loss=0.497, val_accuracy=0.841]
 19%|█▊        | 5/27 [00:38<02:33,  6.97s/epoch, loss=0.433, accuracy=0.881, val_loss=0.574, val_accuracy=0.824]
 22%|██▏       | 6/27 [00:44<02:21,  6.72s/epoch, loss=0.45, accuracy=0.888, val_loss=0.657, val_accuracy=0.837] 
 26%|██▌       | 7/27 [00:50<02:10,  6.54s/epoch, loss=0.518, accuracy=0.88, val_loss=1.03, val_accuracy=0.706] 
 30%|██▉       | 8/27 [00:56<02:02,  6.42s/epoch, loss=1, accuracy=0.656, val_loss=1.13, val_accuracy=0.571]   
 33%|███▎      | 9/27 [01:02<01:54,  6.34s/epoch, loss=1.1, accuracy=0.55, val_loss=1.01, val_accuracy=0.608]
 37%|███▋      | 10/27 [01:09<01:46,  6.29s/epoch, loss=0.998, accuracy=0.632, val_loss=1.11, val_accuracy=0.494]
 41%|████      | 11/27 [01:15<01:40,  6.26s/epoch, loss=1.05, accuracy=0.594, val_loss=1.04, val_accuracy=0.586] 
 44%|████▍     | 12/27 [01:21<01:33,  6.24s/epoch, loss=1.04, accuracy=0.573, val_loss=0.971, val_accuracy=0.613]
 48%|████▊     | 13/27 [01:27<01:27,  6.22s/epoch, loss=0.985, accuracy=0.602, val_loss=1.09, val_accuracy=0.514]
 52%|█████▏    | 14/27 [01:33<01:20,  6.20s/epoch, loss=1.05, accuracy=0.555, val_loss=0.977, val_accuracy=0.611]
 56%|█████▌    | 15/27 [01:39<01:14,  6.20s/epoch, loss=0.987, accuracy=0.579, val_loss=0.964, val_accuracy=0.584]
 59%|█████▉    | 16/27 [01:46<01:08,  6.20s/epoch, loss=0.97, accuracy=0.568, val_loss=0.931, val_accuracy=0.541] 
 63%|██████▎   | 17/27 [01:52<01:01,  6.19s/epoch, loss=0.955, accuracy=0.544, val_loss=0.972, val_accuracy=0.508]
 67%|██████▋   | 18/27 [01:58<00:55,  6.20s/epoch, loss=0.915, accuracy=0.56, val_loss=0.864, val_accuracy=0.565] 
 70%|███████   | 19/27 [02:04<00:49,  6.19s/epoch, loss=0.874, accuracy=0.587, val_loss=0.878, val_accuracy=0.555]
 74%|███████▍  | 20/27 [02:10<00:43,  6.20s/epoch, loss=0.885, accuracy=0.584, val_loss=0.874, val_accuracy=0.494]
 78%|███████▊  | 21/27 [02:17<00:37,  6.19s/epoch, loss=0.878, accuracy=0.603, val_loss=0.885, val_accuracy=0.634]
 81%|████████▏ | 22/27 [02:23<00:31,  6.21s/epoch, loss=0.909, accuracy=0.613, val_loss=0.951, val_accuracy=0.529]
 85%|████████▌ | 23/27 [02:29<00:24,  6.19s/epoch, loss=0.898, accuracy=0.622, val_loss=0.946, val_accuracy=0.595]
 89%|████████▉ | 24/27 [02:35<00:18,  6.21s/epoch, loss=0.934, accuracy=0.585, val_loss=0.905, val_accuracy=0.573]
 93%|█████████▎| 25/27 [02:41<00:12,  6.19s/epoch, loss=0.918, accuracy=0.607, val_loss=0.886, val_accuracy=0.633]
 96%|█████████▋| 26/27 [02:48<00:06,  6.18s/epoch, loss=0.916, accuracy=0.615, val_loss=0.895, val_accuracy=0.646]
100%|██████████| 27/27 [02:54<00:00,  6.18s/epoch, loss=0.916, accuracy=0.588, val_loss=0.988, val_accuracy=0.564]
100%|██████████| 27/27 [02:54<00:00,  6.45s/epoch, loss=0.916, accuracy=0.588, val_loss=0.988, val_accuracy=0.564]
Test score: 0.4838719069957733
Test accuracy: 0.8438799977302551


* * * Run SGD for ID = 18_6. * * *


2024-03-01 13:20:27.832342: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:20:30.368206: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:20:30.369158: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-01 13:20:30.408192: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:20:30.408231: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:20:30.410956: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:20:30.410996: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:20:30.413377: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:20:30.414443: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:20:30.416787: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:20:30.418247: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:20:30.423065: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:20:30.423565: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:20:30.423666: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
<__array_function__ internals>:5: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:159: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_train, y_train = np.array(xs[:idx]), np.array(labels[:idx])
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:160: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_test, y_test = np.array(xs[idx:]), np.array(labels[idx:])
2024-03-01 13:20:35.714080: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-01 13:20:35.714550: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:20:35.715057: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:20:35.715093: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:20:35.715165: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:20:35.715185: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:20:35.715204: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:20:35.715222: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:20:35.715242: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:20:35.715262: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:20:35.715282: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:20:35.715688: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:20:35.715720: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:20:36.330436: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-01 13:20:36.330493: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-01 13:20:36.330503: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-01 13:20:36.331359: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:83:00.0, compute capability: 6.1)
{'id': '18_06', 'seed': 6, 'out_folder': 'results/epoch_budget', 'batch_size': 32, 'epochs': 27, 'validation_split': 0.2, 'checkpointing': True, 'initial_lr': 0.1, 'momentum': 0.98, 'nesterov': True, 'bootstrapping': False, 'map_optimizer': True, 'model': 'CNN-LSTM', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Loading data...
Pad sequences (samples x time)
20000 train sequences
5000 validation sequences
25000 test sequences
x_train shape: (20000, 100)
x_val shape: (5000, 100)
x_test shape: (25000, 100)
Using MAP optimizer with reg_weight:  5e-05
CNN-LSTM

0epoch [00:00, ?epoch/s]
  0%|          | 0/27 [00:00<?, ?epoch/s]2024-03-01 13:20:36.723590: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-01 13:20:36.735963: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199945000 Hz
2024-03-01 13:20:38.153221: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:20:38.322189: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:20:38.931684: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-01 13:20:38.960045: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.

  4%|▎         | 1/27 [00:10<04:42, 10.86s/epoch, loss=0.639, accuracy=0.658, val_loss=0.497, val_accuracy=0.8]
  7%|▋         | 2/27 [00:17<03:30,  8.42s/epoch, loss=0.475, accuracy=0.828, val_loss=0.454, val_accuracy=0.843]
 11%|█         | 3/27 [00:23<02:58,  7.43s/epoch, loss=0.471, accuracy=0.848, val_loss=0.545, val_accuracy=0.833]
 15%|█▍        | 4/27 [00:30<02:39,  6.95s/epoch, loss=0.646, accuracy=0.792, val_loss=0.849, val_accuracy=0.65] 
 19%|█▊        | 5/27 [00:36<02:27,  6.70s/epoch, loss=0.872, accuracy=0.706, val_loss=0.968, val_accuracy=0.673]
 22%|██▏       | 6/27 [00:42<02:17,  6.56s/epoch, loss=1.04, accuracy=0.614, val_loss=1.04, val_accuracy=0.639]  
 26%|██▌       | 7/27 [00:48<02:09,  6.48s/epoch, loss=1.03, accuracy=0.621, val_loss=1.03, val_accuracy=0.639]
 30%|██▉       | 8/27 [00:55<02:02,  6.42s/epoch, loss=1.02, accuracy=0.62, val_loss=1.01, val_accuracy=0.591] 
 33%|███▎      | 9/27 [01:01<01:54,  6.36s/epoch, loss=0.989, accuracy=0.613, val_loss=0.949, val_accuracy=0.639]
 37%|███▋      | 10/27 [01:07<01:47,  6.34s/epoch, loss=0.96, accuracy=0.62, val_loss=0.987, val_accuracy=0.585] 
 41%|████      | 11/27 [01:13<01:40,  6.30s/epoch, loss=0.945, accuracy=0.621, val_loss=0.929, val_accuracy=0.622]
 44%|████▍     | 12/27 [01:20<01:34,  6.27s/epoch, loss=0.91, accuracy=0.646, val_loss=0.919, val_accuracy=0.621] 
 48%|████▊     | 13/27 [01:26<01:27,  6.26s/epoch, loss=0.869, accuracy=0.662, val_loss=0.858, val_accuracy=0.644]
 52%|█████▏    | 14/27 [01:32<01:21,  6.23s/epoch, loss=0.846, accuracy=0.671, val_loss=0.867, val_accuracy=0.646]
 56%|█████▌    | 15/27 [01:38<01:14,  6.22s/epoch, loss=0.847, accuracy=0.685, val_loss=0.919, val_accuracy=0.676]
 59%|█████▉    | 16/27 [01:45<01:08,  6.23s/epoch, loss=0.882, accuracy=0.672, val_loss=0.888, val_accuracy=0.669]
 63%|██████▎   | 17/27 [01:51<01:02,  6.25s/epoch, loss=0.9, accuracy=0.666, val_loss=1.02, val_accuracy=0.547]   
 67%|██████▋   | 18/27 [01:57<00:56,  6.25s/epoch, loss=0.961, accuracy=0.64, val_loss=0.954, val_accuracy=0.642]
 70%|███████   | 19/27 [02:03<00:49,  6.24s/epoch, loss=0.941, accuracy=0.65, val_loss=0.936, val_accuracy=0.643]
 74%|███████▍  | 20/27 [02:10<00:43,  6.25s/epoch, loss=0.938, accuracy=0.647, val_loss=0.925, val_accuracy=0.661]
 78%|███████▊  | 21/27 [02:16<00:37,  6.27s/epoch, loss=0.997, accuracy=0.61, val_loss=1.05, val_accuracy=0.503]  
 81%|████████▏ | 22/27 [02:22<00:31,  6.27s/epoch, loss=1.04, accuracy=0.561, val_loss=0.984, val_accuracy=0.562]
 85%|████████▌ | 23/27 [02:28<00:25,  6.27s/epoch, loss=1.04, accuracy=0.579, val_loss=1.15, val_accuracy=0.566] 
 89%|████████▉ | 24/27 [02:35<00:18,  6.27s/epoch, loss=1.18, accuracy=0.533, val_loss=1.2, val_accuracy=0.488] 
 93%|█████████▎| 25/27 [02:41<00:12,  6.27s/epoch, loss=1.05, accuracy=0.585, val_loss=0.999, val_accuracy=0.601]
 96%|█████████▋| 26/27 [02:47<00:06,  6.28s/epoch, loss=1.04, accuracy=0.606, val_loss=1.12, val_accuracy=0.592] 
100%|██████████| 27/27 [02:53<00:00,  6.27s/epoch, loss=1.09, accuracy=0.575, val_loss=1.02, val_accuracy=0.585]
100%|██████████| 27/27 [02:53<00:00,  6.44s/epoch, loss=1.09, accuracy=0.575, val_loss=1.02, val_accuracy=0.585]
Test score: 0.4512685239315033
Test accuracy: 0.8425999879837036


* * * Run SGD for ID = 18_7. * * *


2024-03-01 13:23:36.651790: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:23:39.202646: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:23:39.203633: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-01 13:23:39.239419: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:23:39.239453: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:23:39.242115: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:23:39.242155: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:23:39.244272: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:23:39.244785: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:23:39.246989: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:23:39.248253: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:23:39.252595: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:23:39.253087: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:23:39.253187: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
<__array_function__ internals>:5: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:159: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_train, y_train = np.array(xs[:idx]), np.array(labels[:idx])
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:160: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_test, y_test = np.array(xs[idx:]), np.array(labels[idx:])
2024-03-01 13:23:44.437184: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-01 13:23:44.437655: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:23:44.438198: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:23:44.438238: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:23:44.438285: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:23:44.438305: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:23:44.438322: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:23:44.438339: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:23:44.438356: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:23:44.438373: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:23:44.438390: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:23:44.438792: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:23:44.438824: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:23:45.069597: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-01 13:23:45.069657: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-01 13:23:45.069667: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-01 13:23:45.070494: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:83:00.0, compute capability: 6.1)
{'id': '18_07', 'seed': 7, 'out_folder': 'results/epoch_budget', 'batch_size': 32, 'epochs': 27, 'validation_split': 0.2, 'checkpointing': True, 'initial_lr': 0.1, 'momentum': 0.98, 'nesterov': True, 'bootstrapping': False, 'map_optimizer': True, 'model': 'CNN-LSTM', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Loading data...
Pad sequences (samples x time)
20000 train sequences
5000 validation sequences
25000 test sequences
x_train shape: (20000, 100)
x_val shape: (5000, 100)
x_test shape: (25000, 100)
Using MAP optimizer with reg_weight:  5e-05
CNN-LSTM

0epoch [00:00, ?epoch/s]
  0%|          | 0/27 [00:00<?, ?epoch/s]2024-03-01 13:23:45.461959: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-01 13:23:45.474063: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199945000 Hz
2024-03-01 13:23:46.897177: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:23:47.068701: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:23:47.711352: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-01 13:23:47.743926: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.

  4%|▎         | 1/27 [00:11<04:53, 11.30s/epoch, loss=0.697, accuracy=0.593, val_loss=0.512, val_accuracy=0.795]
  7%|▋         | 2/27 [00:17<03:33,  8.55s/epoch, loss=0.484, accuracy=0.814, val_loss=0.459, val_accuracy=0.833]
 11%|█         | 3/27 [00:24<02:59,  7.48s/epoch, loss=0.434, accuracy=0.853, val_loss=0.492, val_accuracy=0.829]
 15%|█▍        | 4/27 [00:30<02:40,  6.98s/epoch, loss=0.429, accuracy=0.873, val_loss=0.528, val_accuracy=0.827]
 19%|█▊        | 5/27 [00:36<02:27,  6.70s/epoch, loss=0.478, accuracy=0.869, val_loss=0.582, val_accuracy=0.825]
 22%|██▏       | 6/27 [00:42<02:17,  6.54s/epoch, loss=0.586, accuracy=0.843, val_loss=0.804, val_accuracy=0.757]
 26%|██▌       | 7/27 [00:48<02:08,  6.43s/epoch, loss=0.85, accuracy=0.743, val_loss=1.04, val_accuracy=0.653]  
 30%|██▉       | 8/27 [00:55<02:00,  6.36s/epoch, loss=1.09, accuracy=0.608, val_loss=1.08, val_accuracy=0.628]
 33%|███▎      | 9/27 [01:01<01:53,  6.31s/epoch, loss=1.08, accuracy=0.62, val_loss=1.17, val_accuracy=0.502] 
 37%|███▋      | 10/27 [01:07<01:46,  6.28s/epoch, loss=1.06, accuracy=0.584, val_loss=1.03, val_accuracy=0.567]
 41%|████      | 11/27 [01:13<01:40,  6.26s/epoch, loss=1.08, accuracy=0.581, val_loss=1.19, val_accuracy=0.531]
 44%|████▍     | 12/27 [01:19<01:33,  6.23s/epoch, loss=1.12, accuracy=0.542, val_loss=1.07, val_accuracy=0.549]
 48%|████▊     | 13/27 [01:26<01:26,  6.21s/epoch, loss=1.03, accuracy=0.552, val_loss=0.996, val_accuracy=0.518]
 52%|█████▏    | 14/27 [01:32<01:20,  6.21s/epoch, loss=0.954, accuracy=0.588, val_loss=0.928, val_accuracy=0.605]
 56%|█████▌    | 15/27 [01:38<01:14,  6.19s/epoch, loss=0.913, accuracy=0.596, val_loss=0.923, val_accuracy=0.64] 
 59%|█████▉    | 16/27 [01:44<01:08,  6.22s/epoch, loss=0.918, accuracy=0.599, val_loss=0.918, val_accuracy=0.604]
 63%|██████▎   | 17/27 [01:50<01:02,  6.21s/epoch, loss=0.925, accuracy=0.572, val_loss=0.906, val_accuracy=0.579]
 67%|██████▋   | 18/27 [01:57<00:55,  6.20s/epoch, loss=0.919, accuracy=0.576, val_loss=0.897, val_accuracy=0.592]
 70%|███████   | 19/27 [02:03<00:49,  6.20s/epoch, loss=0.893, accuracy=0.597, val_loss=0.908, val_accuracy=0.526]
 74%|███████▍  | 20/27 [02:09<00:43,  6.20s/epoch, loss=0.862, accuracy=0.621, val_loss=0.864, val_accuracy=0.613]
 78%|███████▊  | 21/27 [02:15<00:37,  6.19s/epoch, loss=0.855, accuracy=0.616, val_loss=0.82, val_accuracy=0.633] 
 81%|████████▏ | 22/27 [02:21<00:30,  6.19s/epoch, loss=0.821, accuracy=0.636, val_loss=0.826, val_accuracy=0.593]
 85%|████████▌ | 23/27 [02:28<00:24,  6.18s/epoch, loss=0.822, accuracy=0.658, val_loss=0.818, val_accuracy=0.706]
 89%|████████▉ | 24/27 [02:34<00:18,  6.19s/epoch, loss=0.874, accuracy=0.637, val_loss=0.89, val_accuracy=0.627] 
 93%|█████████▎| 25/27 [02:40<00:12,  6.19s/epoch, loss=0.922, accuracy=0.596, val_loss=0.981, val_accuracy=0.57]
 96%|█████████▋| 26/27 [02:46<00:06,  6.19s/epoch, loss=0.915, accuracy=0.602, val_loss=0.998, val_accuracy=0.623]
100%|██████████| 27/27 [02:52<00:00,  6.19s/epoch, loss=0.933, accuracy=0.622, val_loss=0.943, val_accuracy=0.614]
100%|██████████| 27/27 [02:52<00:00,  6.40s/epoch, loss=0.933, accuracy=0.622, val_loss=0.943, val_accuracy=0.614]
Test score: 0.4591454565525055
Test accuracy: 0.8344799876213074


* * * Run SGD for ID = 18_8. * * *


2024-03-01 13:26:44.137426: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:26:47.456599: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:26:47.457669: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-01 13:26:47.496329: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:26:47.496363: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:26:47.499470: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:26:47.499512: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:26:47.502184: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:26:47.503024: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:26:47.505363: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:26:47.507070: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:26:47.511670: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:26:47.512171: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:26:47.512268: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
<__array_function__ internals>:5: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:159: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_train, y_train = np.array(xs[:idx]), np.array(labels[:idx])
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:160: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_test, y_test = np.array(xs[idx:]), np.array(labels[idx:])
2024-03-01 13:26:52.702895: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-01 13:26:52.703398: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:26:52.703968: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:26:52.704007: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:26:52.704058: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:26:52.704083: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:26:52.704104: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:26:52.704155: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:26:52.704176: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:26:52.704202: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:26:52.704222: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:26:52.704635: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:26:52.704674: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:26:53.330971: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-01 13:26:53.331035: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-01 13:26:53.331044: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-01 13:26:53.332410: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:83:00.0, compute capability: 6.1)
{'id': '18_08', 'seed': 8, 'out_folder': 'results/epoch_budget', 'batch_size': 32, 'epochs': 27, 'validation_split': 0.2, 'checkpointing': True, 'initial_lr': 0.1, 'momentum': 0.98, 'nesterov': True, 'bootstrapping': False, 'map_optimizer': True, 'model': 'CNN-LSTM', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Loading data...
Pad sequences (samples x time)
20000 train sequences
5000 validation sequences
25000 test sequences
x_train shape: (20000, 100)
x_val shape: (5000, 100)
x_test shape: (25000, 100)
Using MAP optimizer with reg_weight:  5e-05
CNN-LSTM

0epoch [00:00, ?epoch/s]
  0%|          | 0/27 [00:00<?, ?epoch/s]2024-03-01 13:26:53.738186: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-01 13:26:53.749971: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199945000 Hz
2024-03-01 13:26:55.200041: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:26:55.361504: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:26:55.985373: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-01 13:26:56.016625: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.

  4%|▎         | 1/27 [00:11<04:46, 11.00s/epoch, loss=0.731, accuracy=0.546, val_loss=0.608, val_accuracy=0.722]
  7%|▋         | 2/27 [00:17<03:33,  8.56s/epoch, loss=0.517, accuracy=0.789, val_loss=0.49, val_accuracy=0.807] 
 11%|█         | 3/27 [00:24<03:04,  7.69s/epoch, loss=0.457, accuracy=0.843, val_loss=0.487, val_accuracy=0.821]
 15%|█▍        | 4/27 [00:30<02:45,  7.21s/epoch, loss=0.438, accuracy=0.864, val_loss=0.507, val_accuracy=0.83] 
 19%|█▊        | 5/27 [00:37<02:30,  6.86s/epoch, loss=0.443, accuracy=0.88, val_loss=0.551, val_accuracy=0.826]
 22%|██▏       | 6/27 [00:45<02:32,  7.27s/epoch, loss=0.468, accuracy=0.881, val_loss=0.598, val_accuracy=0.832]
 26%|██▌       | 7/27 [00:51<02:18,  6.92s/epoch, loss=0.496, accuracy=0.883, val_loss=0.651, val_accuracy=0.813]
 30%|██▉       | 8/27 [00:57<02:07,  6.70s/epoch, loss=0.573, accuracy=0.866, val_loss=0.952, val_accuracy=0.719]
 33%|███▎      | 9/27 [01:03<01:58,  6.57s/epoch, loss=0.887, accuracy=0.759, val_loss=1.14, val_accuracy=0.681] 
 37%|███▋      | 10/27 [01:10<01:49,  6.46s/epoch, loss=1.17, accuracy=0.636, val_loss=1.21, val_accuracy=0.596]
 41%|████      | 11/27 [01:16<01:42,  6.40s/epoch, loss=1.11, accuracy=0.658, val_loss=1.16, val_accuracy=0.642]
 44%|████▍     | 12/27 [01:22<01:35,  6.35s/epoch, loss=1.18, accuracy=0.533, val_loss=1.13, val_accuracy=0.49] 
 48%|████▊     | 13/27 [01:28<01:28,  6.30s/epoch, loss=1.1, accuracy=0.568, val_loss=1.39, val_accuracy=0.511]
 52%|█████▏    | 14/27 [01:35<01:21,  6.27s/epoch, loss=1.06, accuracy=0.556, val_loss=1.04, val_accuracy=0.587]
 56%|█████▌    | 15/27 [01:41<01:15,  6.26s/epoch, loss=1, accuracy=0.552, val_loss=1.04, val_accuracy=0.49]    
 59%|█████▉    | 16/27 [01:47<01:08,  6.25s/epoch, loss=0.939, accuracy=0.558, val_loss=0.875, val_accuracy=0.629]
 63%|██████▎   | 17/27 [01:53<01:02,  6.24s/epoch, loss=0.887, accuracy=0.58, val_loss=0.819, val_accuracy=0.638] 
 67%|██████▋   | 18/27 [01:59<00:56,  6.23s/epoch, loss=0.851, accuracy=0.639, val_loss=0.868, val_accuracy=0.603]
 70%|███████   | 19/27 [02:06<00:49,  6.23s/epoch, loss=0.883, accuracy=0.638, val_loss=0.894, val_accuracy=0.636]
 74%|███████▍  | 20/27 [02:12<00:43,  6.23s/epoch, loss=0.927, accuracy=0.612, val_loss=0.937, val_accuracy=0.582]
 78%|███████▊  | 21/27 [02:18<00:37,  6.22s/epoch, loss=0.966, accuracy=0.601, val_loss=0.97, val_accuracy=0.633] 
 81%|████████▏ | 22/27 [02:24<00:30,  6.20s/epoch, loss=0.947, accuracy=0.628, val_loss=0.928, val_accuracy=0.623]
 85%|████████▌ | 23/27 [02:30<00:24,  6.19s/epoch, loss=0.956, accuracy=0.597, val_loss=0.962, val_accuracy=0.554]
 89%|████████▉ | 24/27 [02:37<00:18,  6.19s/epoch, loss=0.965, accuracy=0.577, val_loss=0.957, val_accuracy=0.601]
 93%|█████████▎| 25/27 [02:43<00:12,  6.19s/epoch, loss=0.942, accuracy=0.599, val_loss=0.942, val_accuracy=0.515]
 96%|█████████▋| 26/27 [02:49<00:06,  6.19s/epoch, loss=0.98, accuracy=0.614, val_loss=0.99, val_accuracy=0.611]  
100%|██████████| 27/27 [02:55<00:00,  6.20s/epoch, loss=0.961, accuracy=0.609, val_loss=0.951, val_accuracy=0.619]
100%|██████████| 27/27 [02:55<00:00,  6.51s/epoch, loss=0.961, accuracy=0.609, val_loss=0.951, val_accuracy=0.619]
Test score: 0.5946495532989502
Test accuracy: 0.8313199877738953


* * * Run SGD for ID = 18_9. * * *


2024-03-01 13:29:55.075779: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:29:58.508274: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:29:58.509283: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-01 13:29:58.550318: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:29:58.550351: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:29:58.553551: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:29:58.553592: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:29:58.555930: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:29:58.556641: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:29:58.559164: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:29:58.560601: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:29:58.565398: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:29:58.565883: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:29:58.565983: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
<__array_function__ internals>:5: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:159: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_train, y_train = np.array(xs[:idx]), np.array(labels[:idx])
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:160: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_test, y_test = np.array(xs[idx:]), np.array(labels[idx:])
2024-03-01 13:30:03.742428: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-01 13:30:03.742937: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:30:03.745482: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:30:03.745523: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:30:03.745573: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:30:03.745594: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:30:03.745613: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:30:03.745630: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:30:03.745648: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:30:03.745665: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:30:03.745683: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:30:03.746184: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:30:03.746221: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:30:04.384634: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-01 13:30:04.384698: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-01 13:30:04.384708: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-01 13:30:04.385597: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:83:00.0, compute capability: 6.1)
{'id': '18_09', 'seed': 9, 'out_folder': 'results/epoch_budget', 'batch_size': 32, 'epochs': 27, 'validation_split': 0.2, 'checkpointing': True, 'initial_lr': 0.1, 'momentum': 0.98, 'nesterov': True, 'bootstrapping': False, 'map_optimizer': True, 'model': 'CNN-LSTM', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Loading data...
Pad sequences (samples x time)
20000 train sequences
5000 validation sequences
25000 test sequences
x_train shape: (20000, 100)
x_val shape: (5000, 100)
x_test shape: (25000, 100)
Using MAP optimizer with reg_weight:  5e-05
CNN-LSTM

0epoch [00:00, ?epoch/s]
  0%|          | 0/27 [00:00<?, ?epoch/s]2024-03-01 13:30:04.792323: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-01 13:30:04.804027: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199945000 Hz
2024-03-01 13:30:06.299163: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:30:06.469913: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:30:07.145553: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-01 13:30:07.198158: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.

  4%|▎         | 1/27 [00:11<04:51, 11.21s/epoch, loss=0.68, accuracy=0.613, val_loss=0.519, val_accuracy=0.792]
  7%|▋         | 2/27 [00:18<03:45,  9.02s/epoch, loss=0.477, accuracy=0.821, val_loss=0.47, val_accuracy=0.826]
 11%|█         | 3/27 [00:25<03:08,  7.84s/epoch, loss=0.421, accuracy=0.866, val_loss=0.464, val_accuracy=0.85]
 15%|█▍        | 4/27 [00:31<02:44,  7.17s/epoch, loss=0.416, accuracy=0.882, val_loss=0.535, val_accuracy=0.835]
 19%|█▊        | 5/27 [00:37<02:29,  6.81s/epoch, loss=0.422, accuracy=0.889, val_loss=0.635, val_accuracy=0.826]
 22%|██▏       | 6/27 [00:43<02:18,  6.60s/epoch, loss=0.477, accuracy=0.883, val_loss=0.662, val_accuracy=0.828]
 26%|██▌       | 7/27 [00:49<02:09,  6.50s/epoch, loss=0.721, accuracy=0.799, val_loss=0.988, val_accuracy=0.652]
 30%|██▉       | 8/27 [00:56<02:01,  6.38s/epoch, loss=0.957, accuracy=0.723, val_loss=1.01, val_accuracy=0.723] 
 33%|███▎      | 9/27 [01:02<01:53,  6.32s/epoch, loss=1.1, accuracy=0.629, val_loss=1.14, val_accuracy=0.593]  
 37%|███▋      | 10/27 [01:08<01:46,  6.28s/epoch, loss=1.1, accuracy=0.637, val_loss=1.12, val_accuracy=0.624]
 41%|████      | 11/27 [01:14<01:40,  6.25s/epoch, loss=1.14, accuracy=0.548, val_loss=1.09, val_accuracy=0.586]
 44%|████▍     | 12/27 [01:20<01:33,  6.23s/epoch, loss=1.05, accuracy=0.55, val_loss=1.01, val_accuracy=0.579] 
 48%|████▊     | 13/27 [01:26<01:26,  6.21s/epoch, loss=0.992, accuracy=0.578, val_loss=0.968, val_accuracy=0.582]
 52%|█████▏    | 14/27 [01:33<01:20,  6.19s/epoch, loss=0.938, accuracy=0.616, val_loss=0.935, val_accuracy=0.619]
 56%|█████▌    | 15/27 [01:39<01:14,  6.19s/epoch, loss=0.912, accuracy=0.632, val_loss=0.93, val_accuracy=0.567] 
 59%|█████▉    | 16/27 [01:45<01:08,  6.19s/epoch, loss=0.906, accuracy=0.613, val_loss=0.94, val_accuracy=0.618]
 63%|██████▎   | 17/27 [01:51<01:01,  6.18s/epoch, loss=0.875, accuracy=0.641, val_loss=0.915, val_accuracy=0.646]
 67%|██████▋   | 18/27 [01:57<00:55,  6.17s/epoch, loss=0.856, accuracy=0.655, val_loss=0.871, val_accuracy=0.657]
 70%|███████   | 19/27 [02:03<00:49,  6.17s/epoch, loss=0.901, accuracy=0.634, val_loss=0.928, val_accuracy=0.606]
 74%|███████▍  | 20/27 [02:10<00:43,  6.17s/epoch, loss=0.954, accuracy=0.589, val_loss=0.938, val_accuracy=0.589]
 78%|███████▊  | 21/27 [02:16<00:37,  6.17s/epoch, loss=0.967, accuracy=0.601, val_loss=0.962, val_accuracy=0.594]
 81%|████████▏ | 22/27 [02:22<00:30,  6.15s/epoch, loss=0.969, accuracy=0.577, val_loss=0.941, val_accuracy=0.608]
 85%|████████▌ | 23/27 [02:28<00:24,  6.15s/epoch, loss=0.936, accuracy=0.575, val_loss=0.944, val_accuracy=0.508]
 89%|████████▉ | 24/27 [02:34<00:18,  6.15s/epoch, loss=0.898, accuracy=0.595, val_loss=0.895, val_accuracy=0.618]
 93%|█████████▎| 25/27 [02:40<00:12,  6.15s/epoch, loss=0.864, accuracy=0.611, val_loss=0.926, val_accuracy=0.491]
 96%|█████████▋| 26/27 [02:47<00:06,  6.16s/epoch, loss=0.842, accuracy=0.614, val_loss=0.894, val_accuracy=0.575]
100%|██████████| 27/27 [02:53<00:00,  6.14s/epoch, loss=0.817, accuracy=0.638, val_loss=0.813, val_accuracy=0.653]
100%|██████████| 27/27 [02:53<00:00,  6.41s/epoch, loss=0.817, accuracy=0.638, val_loss=0.813, val_accuracy=0.653]
Test score: 0.46843406558036804
Test accuracy: 0.8431599736213684


* * * Run SGD for ID = 18_10. * * *


2024-03-01 13:33:03.569644: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:33:06.967360: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:33:06.968461: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-01 13:33:07.013284: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:33:07.013321: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:33:07.016359: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:33:07.016400: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:33:07.018786: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:33:07.019565: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:33:07.022122: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:33:07.023796: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:33:07.028414: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:33:07.028998: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:33:07.029116: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
<__array_function__ internals>:5: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:159: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_train, y_train = np.array(xs[:idx]), np.array(labels[:idx])
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:160: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_test, y_test = np.array(xs[idx:]), np.array(labels[idx:])
2024-03-01 13:33:12.190053: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-01 13:33:12.190583: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:33:12.191160: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:33:12.191195: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:33:12.191241: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:33:12.191260: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:33:12.191278: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:33:12.191296: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:33:12.191314: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:33:12.191333: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:33:12.191352: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:33:12.191793: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:33:12.191854: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:33:12.836580: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-01 13:33:12.836648: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-01 13:33:12.836658: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-01 13:33:12.837518: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:83:00.0, compute capability: 6.1)
{'id': '18_10', 'seed': 10, 'out_folder': 'results/epoch_budget', 'batch_size': 32, 'epochs': 27, 'validation_split': 0.2, 'checkpointing': True, 'initial_lr': 0.1, 'momentum': 0.98, 'nesterov': True, 'bootstrapping': False, 'map_optimizer': True, 'model': 'CNN-LSTM', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Loading data...
Pad sequences (samples x time)
20000 train sequences
5000 validation sequences
25000 test sequences
x_train shape: (20000, 100)
x_val shape: (5000, 100)
x_test shape: (25000, 100)
Using MAP optimizer with reg_weight:  5e-05
CNN-LSTM

0epoch [00:00, ?epoch/s]
  0%|          | 0/27 [00:00<?, ?epoch/s]2024-03-01 13:33:13.230269: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-01 13:33:13.242066: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199945000 Hz
2024-03-01 13:33:14.724120: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:33:14.893282: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:33:15.528582: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-01 13:33:15.558354: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.

  4%|▎         | 1/27 [00:11<04:46, 11.03s/epoch, loss=0.635, accuracy=0.666, val_loss=0.494, val_accuracy=0.815]
  7%|▋         | 2/27 [00:17<03:29,  8.38s/epoch, loss=0.452, accuracy=0.838, val_loss=0.505, val_accuracy=0.821]
 11%|█         | 3/27 [00:23<02:59,  7.47s/epoch, loss=0.427, accuracy=0.866, val_loss=0.514, val_accuracy=0.83] 
 15%|█▍        | 4/27 [00:30<02:41,  7.04s/epoch, loss=0.407, accuracy=0.888, val_loss=0.538, val_accuracy=0.832]
 19%|█▊        | 5/27 [00:36<02:27,  6.71s/epoch, loss=0.477, accuracy=0.875, val_loss=0.716, val_accuracy=0.785]
 22%|██▏       | 6/27 [00:42<02:17,  6.52s/epoch, loss=0.812, accuracy=0.76, val_loss=1.02, val_accuracy=0.668]  
 26%|██▌       | 7/27 [00:48<02:08,  6.40s/epoch, loss=1.1, accuracy=0.628, val_loss=1.12, val_accuracy=0.564] 
 30%|██▉       | 8/27 [00:54<02:00,  6.33s/epoch, loss=1.11, accuracy=0.604, val_loss=1.15, val_accuracy=0.506]
 33%|███▎      | 9/27 [01:01<01:53,  6.28s/epoch, loss=1.12, accuracy=0.551, val_loss=1.04, val_accuracy=0.56] 
 37%|███▋      | 10/27 [01:07<01:46,  6.24s/epoch, loss=1.01, accuracy=0.59, val_loss=0.948, val_accuracy=0.657]
 41%|████      | 11/27 [01:13<01:39,  6.22s/epoch, loss=0.983, accuracy=0.598, val_loss=0.982, val_accuracy=0.546]
 44%|████▍     | 12/27 [01:19<01:33,  6.22s/epoch, loss=1.04, accuracy=0.571, val_loss=1.44, val_accuracy=0.523]  
 48%|████▊     | 13/27 [01:25<01:26,  6.20s/epoch, loss=1.44, accuracy=0.504, val_loss=1.35, val_accuracy=0.508]
 52%|█████▏    | 14/27 [01:32<01:20,  6.20s/epoch, loss=1.28, accuracy=0.515, val_loss=1.22, val_accuracy=0.54] 
 56%|█████▌    | 15/27 [01:38<01:14,  6.20s/epoch, loss=1.18, accuracy=0.516, val_loss=1.12, val_accuracy=0.502]
 59%|█████▉    | 16/27 [01:44<01:08,  6.20s/epoch, loss=1.09, accuracy=0.533, val_loss=1.03, val_accuracy=0.582]
 63%|██████▎   | 17/27 [01:50<01:02,  6.21s/epoch, loss=1.03, accuracy=0.533, val_loss=0.978, val_accuracy=0.5] 
 67%|██████▋   | 18/27 [01:56<00:55,  6.22s/epoch, loss=0.983, accuracy=0.526, val_loss=0.946, val_accuracy=0.502]
 70%|███████   | 19/27 [02:03<00:49,  6.21s/epoch, loss=0.962, accuracy=0.517, val_loss=0.924, val_accuracy=0.499]
 74%|███████▍  | 20/27 [02:09<00:43,  6.21s/epoch, loss=0.926, accuracy=0.511, val_loss=0.875, val_accuracy=0.523]
 78%|███████▊  | 21/27 [02:15<00:37,  6.20s/epoch, loss=0.874, accuracy=0.53, val_loss=0.873, val_accuracy=0.509] 
 81%|████████▏ | 22/27 [02:21<00:31,  6.21s/epoch, loss=0.842, accuracy=0.623, val_loss=0.82, val_accuracy=0.654]
 85%|████████▌ | 23/27 [02:27<00:24,  6.21s/epoch, loss=0.855, accuracy=0.624, val_loss=0.85, val_accuracy=0.648]
 89%|████████▉ | 24/27 [02:34<00:18,  6.21s/epoch, loss=0.867, accuracy=0.606, val_loss=0.936, val_accuracy=0.547]
 93%|█████████▎| 25/27 [02:40<00:12,  6.20s/epoch, loss=0.897, accuracy=0.568, val_loss=0.893, val_accuracy=0.572]
 96%|█████████▋| 26/27 [02:46<00:06,  6.18s/epoch, loss=0.912, accuracy=0.571, val_loss=0.946, val_accuracy=0.594]
100%|██████████| 27/27 [02:52<00:00,  6.18s/epoch, loss=0.948, accuracy=0.536, val_loss=0.929, val_accuracy=0.538]
100%|██████████| 27/27 [02:52<00:00,  6.39s/epoch, loss=0.948, accuracy=0.536, val_loss=0.929, val_accuracy=0.538]
Test score: 0.5167080163955688
Test accuracy: 0.837440013885498


* * * Run SGD for ID = 18_11. * * *


2024-03-01 13:36:11.656134: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:36:14.971313: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:36:14.972395: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-01 13:36:15.013729: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:36:15.013765: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:36:15.016738: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:36:15.016778: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:36:15.019083: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:36:15.020020: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:36:15.022430: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:36:15.024102: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:36:15.028808: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:36:15.029300: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:36:15.029400: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
<__array_function__ internals>:5: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:159: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_train, y_train = np.array(xs[:idx]), np.array(labels[:idx])
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:160: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_test, y_test = np.array(xs[idx:]), np.array(labels[idx:])
2024-03-01 13:36:20.315113: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-01 13:36:20.315619: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:36:20.316717: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:36:20.316753: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:36:20.316810: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:36:20.316859: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:36:20.316882: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:36:20.316902: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:36:20.316921: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:36:20.316941: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:36:20.316961: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:36:20.317413: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:36:20.317446: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:36:20.972326: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-01 13:36:20.972386: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-01 13:36:20.972396: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-01 13:36:20.973282: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:83:00.0, compute capability: 6.1)
{'id': '18_11', 'seed': 11, 'out_folder': 'results/epoch_budget', 'batch_size': 32, 'epochs': 27, 'validation_split': 0.2, 'checkpointing': True, 'initial_lr': 0.1, 'momentum': 0.98, 'nesterov': True, 'bootstrapping': False, 'map_optimizer': True, 'model': 'CNN-LSTM', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Loading data...
Pad sequences (samples x time)
20000 train sequences
5000 validation sequences
25000 test sequences
x_train shape: (20000, 100)
x_val shape: (5000, 100)
x_test shape: (25000, 100)
Using MAP optimizer with reg_weight:  5e-05
CNN-LSTM

0epoch [00:00, ?epoch/s]
  0%|          | 0/27 [00:00<?, ?epoch/s]2024-03-01 13:36:21.368857: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-01 13:36:21.380990: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199945000 Hz
2024-03-01 13:36:22.801075: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:36:22.965801: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:36:23.622447: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-01 13:36:23.652016: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.

  4%|▎         | 1/27 [00:11<04:49, 11.15s/epoch, loss=0.61, accuracy=0.704, val_loss=0.467, val_accuracy=0.824]
  7%|▋         | 2/27 [00:17<03:31,  8.48s/epoch, loss=0.454, accuracy=0.837, val_loss=0.446, val_accuracy=0.845]
 11%|█         | 3/27 [00:24<02:59,  7.47s/epoch, loss=0.419, accuracy=0.868, val_loss=0.483, val_accuracy=0.844]
 15%|█▍        | 4/27 [00:30<02:43,  7.10s/epoch, loss=0.411, accuracy=0.886, val_loss=0.53, val_accuracy=0.851] 
 19%|█▊        | 5/27 [00:36<02:29,  6.79s/epoch, loss=0.45, accuracy=0.886, val_loss=0.615, val_accuracy=0.834]
 22%|██▏       | 6/27 [00:43<02:18,  6.61s/epoch, loss=0.619, accuracy=0.841, val_loss=0.815, val_accuracy=0.767]
 26%|██▌       | 7/27 [00:49<02:09,  6.50s/epoch, loss=0.946, accuracy=0.728, val_loss=1.08, val_accuracy=0.635] 
 30%|██▉       | 8/27 [00:55<02:02,  6.43s/epoch, loss=1.23, accuracy=0.585, val_loss=1.24, val_accuracy=0.621] 
 33%|███▎      | 9/27 [01:01<01:54,  6.38s/epoch, loss=1.22, accuracy=0.565, val_loss=1.16, val_accuracy=0.587]
 37%|███▋      | 10/27 [01:08<01:47,  6.33s/epoch, loss=1.12, accuracy=0.577, val_loss=1.09, val_accuracy=0.552]
 41%|████      | 11/27 [01:14<01:41,  6.32s/epoch, loss=1.06, accuracy=0.557, val_loss=1.11, val_accuracy=0.512]
 44%|████▍     | 12/27 [01:20<01:34,  6.29s/epoch, loss=1.01, accuracy=0.578, val_loss=0.975, val_accuracy=0.576]
 48%|████▊     | 13/27 [01:26<01:27,  6.26s/epoch, loss=0.972, accuracy=0.613, val_loss=0.98, val_accuracy=0.632]
 52%|█████▏    | 14/27 [01:33<01:21,  6.26s/epoch, loss=0.963, accuracy=0.621, val_loss=0.926, val_accuracy=0.629]
 56%|█████▌    | 15/27 [01:39<01:14,  6.24s/epoch, loss=0.925, accuracy=0.628, val_loss=0.911, val_accuracy=0.584]
 59%|█████▉    | 16/27 [01:45<01:09,  6.28s/epoch, loss=0.931, accuracy=0.598, val_loss=0.935, val_accuracy=0.599]
 63%|██████▎   | 17/27 [01:51<01:02,  6.25s/epoch, loss=0.917, accuracy=0.588, val_loss=0.895, val_accuracy=0.589]
 67%|██████▋   | 18/27 [01:58<00:56,  6.26s/epoch, loss=0.894, accuracy=0.579, val_loss=0.956, val_accuracy=0.56] 
 70%|███████   | 19/27 [02:04<00:50,  6.25s/epoch, loss=0.864, accuracy=0.599, val_loss=0.836, val_accuracy=0.644]
 74%|███████▍  | 20/27 [02:10<00:43,  6.25s/epoch, loss=0.858, accuracy=0.597, val_loss=0.813, val_accuracy=0.635]
 78%|███████▊  | 21/27 [02:16<00:37,  6.25s/epoch, loss=0.852, accuracy=0.605, val_loss=0.833, val_accuracy=0.64] 
 81%|████████▏ | 22/27 [02:23<00:31,  6.25s/epoch, loss=0.827, accuracy=0.603, val_loss=0.783, val_accuracy=0.672]
 85%|████████▌ | 23/27 [02:29<00:25,  6.26s/epoch, loss=0.85, accuracy=0.607, val_loss=0.821, val_accuracy=0.64]  
 89%|████████▉ | 24/27 [02:35<00:18,  6.26s/epoch, loss=0.835, accuracy=0.63, val_loss=0.823, val_accuracy=0.665]
 93%|█████████▎| 25/27 [02:41<00:12,  6.25s/epoch, loss=0.885, accuracy=0.622, val_loss=0.92, val_accuracy=0.574]
 96%|█████████▋| 26/27 [02:48<00:06,  6.25s/epoch, loss=0.911, accuracy=0.585, val_loss=0.876, val_accuracy=0.608]
100%|██████████| 27/27 [02:54<00:00,  6.23s/epoch, loss=0.878, accuracy=0.605, val_loss=0.839, val_accuracy=0.641]
100%|██████████| 27/27 [02:54<00:00,  6.45s/epoch, loss=0.878, accuracy=0.605, val_loss=0.839, val_accuracy=0.641]
Test score: 0.5558691620826721
Test accuracy: 0.8348000049591064


* * * Run SGD for ID = 18_12. * * *


2024-03-01 13:39:21.329641: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:39:24.599806: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:39:24.600815: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-01 13:39:24.638201: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:39:24.638232: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:39:24.640995: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:39:24.641036: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:39:24.643324: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:39:24.644004: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:39:24.646401: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:39:24.647989: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:39:24.652516: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:39:24.653020: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:39:24.653131: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
<__array_function__ internals>:5: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:159: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_train, y_train = np.array(xs[:idx]), np.array(labels[:idx])
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:160: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_test, y_test = np.array(xs[idx:]), np.array(labels[idx:])
2024-03-01 13:39:29.903589: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-01 13:39:29.904148: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:39:29.906754: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:39:29.906791: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:39:29.906869: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:39:29.906894: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:39:29.906915: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:39:29.906943: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:39:29.906964: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:39:29.906984: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:39:29.907005: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:39:29.907477: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:39:29.907510: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:39:30.533670: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-01 13:39:30.533733: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-01 13:39:30.533742: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-01 13:39:30.534620: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:83:00.0, compute capability: 6.1)
{'id': '18_12', 'seed': 12, 'out_folder': 'results/epoch_budget', 'batch_size': 32, 'epochs': 27, 'validation_split': 0.2, 'checkpointing': True, 'initial_lr': 0.1, 'momentum': 0.98, 'nesterov': True, 'bootstrapping': False, 'map_optimizer': True, 'model': 'CNN-LSTM', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Loading data...
Pad sequences (samples x time)
20000 train sequences
5000 validation sequences
25000 test sequences
x_train shape: (20000, 100)
x_val shape: (5000, 100)
x_test shape: (25000, 100)
Using MAP optimizer with reg_weight:  5e-05
CNN-LSTM

0epoch [00:00, ?epoch/s]
  0%|          | 0/27 [00:00<?, ?epoch/s]2024-03-01 13:39:30.930505: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-01 13:39:30.943064: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199945000 Hz
2024-03-01 13:39:32.362668: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:39:32.538022: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:39:33.154446: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-01 13:39:33.184166: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.

  4%|▎         | 1/27 [00:10<04:41, 10.82s/epoch, loss=0.651, accuracy=0.651, val_loss=0.522, val_accuracy=0.791]
  7%|▋         | 2/27 [00:17<03:28,  8.34s/epoch, loss=0.469, accuracy=0.831, val_loss=0.518, val_accuracy=0.827]
 11%|█         | 3/27 [00:23<02:59,  7.46s/epoch, loss=0.432, accuracy=0.863, val_loss=0.473, val_accuracy=0.843]
 15%|█▍        | 4/27 [00:30<02:42,  7.06s/epoch, loss=0.414, accuracy=0.884, val_loss=0.521, val_accuracy=0.843]
 19%|█▊        | 5/27 [00:36<02:28,  6.74s/epoch, loss=0.422, accuracy=0.893, val_loss=0.553, val_accuracy=0.84] 
 22%|██▏       | 6/27 [00:42<02:17,  6.53s/epoch, loss=0.433, accuracy=0.904, val_loss=0.638, val_accuracy=0.839]
 26%|██▌       | 7/27 [00:48<02:08,  6.40s/epoch, loss=0.477, accuracy=0.899, val_loss=0.726, val_accuracy=0.815]
 30%|██▉       | 8/27 [00:54<02:00,  6.33s/epoch, loss=0.622, accuracy=0.865, val_loss=0.862, val_accuracy=0.759]
 33%|███▎      | 9/27 [01:01<01:53,  6.28s/epoch, loss=0.993, accuracy=0.72, val_loss=1.07, val_accuracy=0.7]    
 37%|███▋      | 10/27 [01:07<01:46,  6.25s/epoch, loss=1.13, accuracy=0.65, val_loss=1.19, val_accuracy=0.569]
 41%|████      | 11/27 [01:13<01:39,  6.22s/epoch, loss=1.12, accuracy=0.629, val_loss=1.11, val_accuracy=0.608]
 44%|████▍     | 12/27 [01:19<01:33,  6.21s/epoch, loss=1.09, accuracy=0.608, val_loss=1.07, val_accuracy=0.602]
 48%|████▊     | 13/27 [01:25<01:26,  6.20s/epoch, loss=1.04, accuracy=0.611, val_loss=1.01, val_accuracy=0.618]
 52%|█████▏    | 14/27 [01:31<01:20,  6.19s/epoch, loss=1, accuracy=0.626, val_loss=1.03, val_accuracy=0.584]   
 56%|█████▌    | 15/27 [01:38<01:14,  6.18s/epoch, loss=1.02, accuracy=0.619, val_loss=1, val_accuracy=0.645]
 59%|█████▉    | 16/27 [01:44<01:07,  6.17s/epoch, loss=1.04, accuracy=0.592, val_loss=1.04, val_accuracy=0.56]
 63%|██████▎   | 17/27 [01:50<01:01,  6.17s/epoch, loss=1.02, accuracy=0.567, val_loss=0.979, val_accuracy=0.612]
 67%|██████▋   | 18/27 [01:56<00:55,  6.17s/epoch, loss=0.976, accuracy=0.587, val_loss=0.939, val_accuracy=0.578]
 70%|███████   | 19/27 [02:02<00:49,  6.17s/epoch, loss=0.947, accuracy=0.565, val_loss=0.886, val_accuracy=0.62] 
 74%|███████▍  | 20/27 [02:09<00:43,  6.19s/epoch, loss=0.874, accuracy=0.628, val_loss=0.853, val_accuracy=0.6] 
 78%|███████▊  | 21/27 [02:15<00:37,  6.19s/epoch, loss=0.856, accuracy=0.626, val_loss=0.876, val_accuracy=0.656]
 81%|████████▏ | 22/27 [02:21<00:30,  6.18s/epoch, loss=0.851, accuracy=0.643, val_loss=0.865, val_accuracy=0.625]
 85%|████████▌ | 23/27 [02:27<00:24,  6.18s/epoch, loss=0.885, accuracy=0.613, val_loss=0.877, val_accuracy=0.629]
 89%|████████▉ | 24/27 [02:33<00:18,  6.18s/epoch, loss=0.856, accuracy=0.641, val_loss=0.84, val_accuracy=0.631] 
 93%|█████████▎| 25/27 [02:39<00:12,  6.18s/epoch, loss=0.84, accuracy=0.654, val_loss=0.885, val_accuracy=0.631]
 96%|█████████▋| 26/27 [02:46<00:06,  6.19s/epoch, loss=0.857, accuracy=0.65, val_loss=0.863, val_accuracy=0.643]
100%|██████████| 27/27 [02:52<00:00,  6.19s/epoch, loss=0.866, accuracy=0.631, val_loss=0.884, val_accuracy=0.621]
100%|██████████| 27/27 [02:52<00:00,  6.38s/epoch, loss=0.866, accuracy=0.631, val_loss=0.884, val_accuracy=0.621]
Test score: 0.5113245844841003
Test accuracy: 0.8483200073242188


* * * Run SGD for ID = 18_13. * * *


2024-03-01 13:42:28.943053: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:42:31.545056: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:42:31.546129: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-01 13:42:31.585084: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:42:31.585120: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:42:31.587625: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:42:31.587665: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:42:31.589939: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:42:31.590529: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:42:31.592731: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:42:31.594033: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:42:31.598331: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:42:31.599158: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:42:31.599260: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
<__array_function__ internals>:5: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:159: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_train, y_train = np.array(xs[:idx]), np.array(labels[:idx])
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:160: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_test, y_test = np.array(xs[idx:]), np.array(labels[idx:])
2024-03-01 13:42:36.814530: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-01 13:42:36.815096: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:42:36.815639: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:42:36.815674: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:42:36.815720: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:42:36.815741: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:42:36.815761: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:42:36.815779: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:42:36.815799: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:42:36.815818: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:42:36.815865: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:42:36.816319: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:42:36.816351: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:42:37.430168: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-01 13:42:37.430228: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-01 13:42:37.430239: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-01 13:42:37.431087: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:83:00.0, compute capability: 6.1)
{'id': '18_13', 'seed': 13, 'out_folder': 'results/epoch_budget', 'batch_size': 32, 'epochs': 27, 'validation_split': 0.2, 'checkpointing': True, 'initial_lr': 0.1, 'momentum': 0.98, 'nesterov': True, 'bootstrapping': False, 'map_optimizer': True, 'model': 'CNN-LSTM', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Loading data...
Pad sequences (samples x time)
20000 train sequences
5000 validation sequences
25000 test sequences
x_train shape: (20000, 100)
x_val shape: (5000, 100)
x_test shape: (25000, 100)
Using MAP optimizer with reg_weight:  5e-05
CNN-LSTM

0epoch [00:00, ?epoch/s]
  0%|          | 0/27 [00:00<?, ?epoch/s]2024-03-01 13:42:37.824600: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-01 13:42:37.836958: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199945000 Hz
2024-03-01 13:42:39.267799: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:42:39.441368: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:42:40.087377: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-01 13:42:40.116882: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.

  4%|▎         | 1/27 [00:11<05:04, 11.70s/epoch, loss=0.619, accuracy=0.686, val_loss=0.485, val_accuracy=0.813]
  7%|▋         | 2/27 [00:18<03:42,  8.92s/epoch, loss=0.445, accuracy=0.84, val_loss=0.467, val_accuracy=0.832] 
 11%|█         | 3/27 [00:25<03:10,  7.93s/epoch, loss=0.412, accuracy=0.871, val_loss=0.498, val_accuracy=0.841]
 15%|█▍        | 4/27 [00:31<02:47,  7.27s/epoch, loss=0.403, accuracy=0.886, val_loss=0.527, val_accuracy=0.826]
 19%|█▊        | 5/27 [00:37<02:31,  6.91s/epoch, loss=0.425, accuracy=0.893, val_loss=0.619, val_accuracy=0.833]
 22%|██▏       | 6/27 [00:44<02:20,  6.69s/epoch, loss=0.63, accuracy=0.828, val_loss=0.939, val_accuracy=0.705] 
 26%|██▌       | 7/27 [00:50<02:11,  6.56s/epoch, loss=1.12, accuracy=0.628, val_loss=1.24, val_accuracy=0.6]   
 30%|██▉       | 8/27 [00:56<02:02,  6.47s/epoch, loss=1.21, accuracy=0.574, val_loss=1.16, val_accuracy=0.587]
 33%|███▎      | 9/27 [01:03<01:55,  6.40s/epoch, loss=1.13, accuracy=0.592, val_loss=1.08, val_accuracy=0.568]
 37%|███▋      | 10/27 [01:09<01:48,  6.36s/epoch, loss=1.09, accuracy=0.607, val_loss=1.07, val_accuracy=0.588]
 41%|████      | 11/27 [01:15<01:41,  6.33s/epoch, loss=1.08, accuracy=0.603, val_loss=1.07, val_accuracy=0.617]
 44%|████▍     | 12/27 [01:21<01:34,  6.30s/epoch, loss=1.08, accuracy=0.558, val_loss=1.1, val_accuracy=0.539] 
 48%|████▊     | 13/27 [01:28<01:28,  6.30s/epoch, loss=1.01, accuracy=0.554, val_loss=0.964, val_accuracy=0.613]
 52%|█████▏    | 14/27 [01:34<01:21,  6.28s/epoch, loss=0.96, accuracy=0.567, val_loss=0.896, val_accuracy=0.619]
 56%|█████▌    | 15/27 [01:40<01:15,  6.27s/epoch, loss=0.899, accuracy=0.614, val_loss=0.887, val_accuracy=0.635]
 59%|█████▉    | 16/27 [01:46<01:09,  6.28s/epoch, loss=0.918, accuracy=0.621, val_loss=0.891, val_accuracy=0.64] 
 63%|██████▎   | 17/27 [01:53<01:02,  6.27s/epoch, loss=0.898, accuracy=0.638, val_loss=0.887, val_accuracy=0.643]
 67%|██████▋   | 18/27 [01:59<00:56,  6.27s/epoch, loss=0.9, accuracy=0.633, val_loss=0.958, val_accuracy=0.623]  
 70%|███████   | 19/27 [02:05<00:50,  6.28s/epoch, loss=0.87, accuracy=0.666, val_loss=0.905, val_accuracy=0.652]
 74%|███████▍  | 20/27 [02:11<00:43,  6.28s/epoch, loss=0.921, accuracy=0.648, val_loss=0.915, val_accuracy=0.631]
 78%|███████▊  | 21/27 [02:18<00:37,  6.27s/epoch, loss=0.936, accuracy=0.622, val_loss=0.94, val_accuracy=0.511] 
 81%|████████▏ | 22/27 [02:24<00:31,  6.26s/epoch, loss=0.899, accuracy=0.621, val_loss=0.897, val_accuracy=0.606]
 85%|████████▌ | 23/27 [02:30<00:25,  6.26s/epoch, loss=0.867, accuracy=0.654, val_loss=0.909, val_accuracy=0.649]
 89%|████████▉ | 24/27 [02:36<00:18,  6.25s/epoch, loss=0.948, accuracy=0.646, val_loss=0.946, val_accuracy=0.653]
 93%|█████████▎| 25/27 [02:43<00:12,  6.26s/epoch, loss=0.952, accuracy=0.633, val_loss=0.962, val_accuracy=0.63] 
 96%|█████████▋| 26/27 [02:49<00:06,  6.26s/epoch, loss=0.965, accuracy=0.621, val_loss=1.03, val_accuracy=0.611]
100%|██████████| 27/27 [02:55<00:00,  6.26s/epoch, loss=1.06, accuracy=0.603, val_loss=1.08, val_accuracy=0.51]  
100%|██████████| 27/27 [02:55<00:00,  6.51s/epoch, loss=1.06, accuracy=0.603, val_loss=1.08, val_accuracy=0.51]
Test score: 0.48966464400291443
Test accuracy: 0.8489999771118164


* * * Run SGD for ID = 18_14. * * *


2024-03-01 13:45:39.357686: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:45:42.006234: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:45:42.007263: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-01 13:45:42.044145: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:45:42.044177: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:45:42.046932: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:45:42.046974: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:45:42.049267: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:45:42.049840: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:45:42.052185: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:45:42.053530: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:45:42.058112: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:45:42.058603: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:45:42.058704: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
<__array_function__ internals>:5: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:159: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_train, y_train = np.array(xs[:idx]), np.array(labels[:idx])
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:160: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_test, y_test = np.array(xs[idx:]), np.array(labels[idx:])
2024-03-01 13:45:47.320486: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-01 13:45:47.321068: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:45:47.321595: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:45:47.321634: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:45:47.321682: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:45:47.321704: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:45:47.321726: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:45:47.321746: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:45:47.321766: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:45:47.321788: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:45:47.321809: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:45:47.322303: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:45:47.322340: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:45:47.935378: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-01 13:45:47.935438: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-01 13:45:47.935448: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-01 13:45:47.937590: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:83:00.0, compute capability: 6.1)
{'id': '18_14', 'seed': 14, 'out_folder': 'results/epoch_budget', 'batch_size': 32, 'epochs': 27, 'validation_split': 0.2, 'checkpointing': True, 'initial_lr': 0.1, 'momentum': 0.98, 'nesterov': True, 'bootstrapping': False, 'map_optimizer': True, 'model': 'CNN-LSTM', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Loading data...
Pad sequences (samples x time)
20000 train sequences
5000 validation sequences
25000 test sequences
x_train shape: (20000, 100)
x_val shape: (5000, 100)
x_test shape: (25000, 100)
Using MAP optimizer with reg_weight:  5e-05
CNN-LSTM

0epoch [00:00, ?epoch/s]
  0%|          | 0/27 [00:00<?, ?epoch/s]2024-03-01 13:45:48.343742: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-01 13:45:48.355976: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199945000 Hz
2024-03-01 13:45:49.850204: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:45:50.019636: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:45:50.631642: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-01 13:45:50.660514: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.

  4%|▎         | 1/27 [00:10<04:42, 10.87s/epoch, loss=0.687, accuracy=0.601, val_loss=0.49, val_accuracy=0.805]
  7%|▋         | 2/27 [00:17<03:28,  8.34s/epoch, loss=0.487, accuracy=0.814, val_loss=0.462, val_accuracy=0.836]
 11%|█         | 3/27 [00:23<02:59,  7.50s/epoch, loss=0.444, accuracy=0.851, val_loss=0.467, val_accuracy=0.845]
 15%|█▍        | 4/27 [00:30<02:40,  6.99s/epoch, loss=0.425, accuracy=0.871, val_loss=0.498, val_accuracy=0.834]
 19%|█▊        | 5/27 [00:36<02:27,  6.70s/epoch, loss=0.433, accuracy=0.883, val_loss=0.566, val_accuracy=0.832]
 22%|██▏       | 6/27 [00:42<02:17,  6.54s/epoch, loss=0.449, accuracy=0.891, val_loss=0.581, val_accuracy=0.843]
 26%|██▌       | 7/27 [00:48<02:08,  6.44s/epoch, loss=0.457, accuracy=0.898, val_loss=0.6, val_accuracy=0.842]  
 30%|██▉       | 8/27 [00:54<02:00,  6.36s/epoch, loss=0.496, accuracy=0.893, val_loss=0.677, val_accuracy=0.829]
 33%|███▎      | 9/27 [01:01<01:53,  6.32s/epoch, loss=0.594, accuracy=0.872, val_loss=0.883, val_accuracy=0.737]
 37%|███▋      | 10/27 [01:07<01:46,  6.28s/epoch, loss=1.02, accuracy=0.709, val_loss=1.17, val_accuracy=0.601] 
 41%|████      | 11/27 [01:13<01:40,  6.25s/epoch, loss=1.18, accuracy=0.601, val_loss=1.2, val_accuracy=0.521] 
 44%|████▍     | 12/27 [01:19<01:33,  6.23s/epoch, loss=1.15, accuracy=0.559, val_loss=1.13, val_accuracy=0.598]
 48%|████▊     | 13/27 [01:25<01:27,  6.22s/epoch, loss=1.07, accuracy=0.564, val_loss=1.04, val_accuracy=0.575]
 52%|█████▏    | 14/27 [01:32<01:20,  6.21s/epoch, loss=1.01, accuracy=0.562, val_loss=0.988, val_accuracy=0.572]
 56%|█████▌    | 15/27 [01:38<01:14,  6.20s/epoch, loss=0.957, accuracy=0.577, val_loss=0.943, val_accuracy=0.532]
 59%|█████▉    | 16/27 [01:44<01:08,  6.20s/epoch, loss=0.9, accuracy=0.608, val_loss=0.854, val_accuracy=0.65]   
 63%|██████▎   | 17/27 [01:50<01:01,  6.19s/epoch, loss=0.876, accuracy=0.626, val_loss=0.859, val_accuracy=0.663]
 67%|██████▋   | 18/27 [01:56<00:55,  6.20s/epoch, loss=0.855, accuracy=0.656, val_loss=0.874, val_accuracy=0.653]
 70%|███████   | 19/27 [02:03<00:49,  6.20s/epoch, loss=0.874, accuracy=0.647, val_loss=0.883, val_accuracy=0.644]
 74%|███████▍  | 20/27 [02:09<00:43,  6.26s/epoch, loss=0.887, accuracy=0.645, val_loss=0.901, val_accuracy=0.682]
 78%|███████▊  | 21/27 [02:15<00:37,  6.31s/epoch, loss=0.95, accuracy=0.619, val_loss=1.01, val_accuracy=0.513]  
 81%|████████▏ | 22/27 [02:22<00:31,  6.34s/epoch, loss=0.965, accuracy=0.621, val_loss=0.984, val_accuracy=0.606]
 85%|████████▌ | 23/27 [02:28<00:25,  6.31s/epoch, loss=0.984, accuracy=0.607, val_loss=0.995, val_accuracy=0.588]
 89%|████████▉ | 24/27 [02:34<00:18,  6.28s/epoch, loss=0.999, accuracy=0.586, val_loss=1.01, val_accuracy=0.519] 
 93%|█████████▎| 25/27 [02:41<00:12,  6.26s/epoch, loss=1.01, accuracy=0.549, val_loss=0.99, val_accuracy=0.497] 
 96%|█████████▋| 26/27 [02:47<00:06,  6.23s/epoch, loss=0.98, accuracy=0.545, val_loss=1.02, val_accuracy=0.496]
100%|██████████| 27/27 [02:53<00:00,  6.23s/epoch, loss=0.943, accuracy=0.585, val_loss=0.945, val_accuracy=0.583]
100%|██████████| 27/27 [02:53<00:00,  6.42s/epoch, loss=0.943, accuracy=0.585, val_loss=0.945, val_accuracy=0.583]
Test score: 0.4642414450645447
Test accuracy: 0.8463199734687805


* * * Run SGD for ID = 18_15. * * *


2024-03-01 13:48:47.459471: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:48:50.400003: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:48:50.400975: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-01 13:48:50.456059: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:48:50.456092: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:48:50.458712: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:48:50.458752: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:48:50.460935: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:48:50.462215: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:48:50.464432: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:48:50.465762: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:48:50.469939: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:48:50.471875: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:48:50.471972: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
<__array_function__ internals>:5: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:159: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_train, y_train = np.array(xs[:idx]), np.array(labels[:idx])
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:160: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_test, y_test = np.array(xs[idx:]), np.array(labels[idx:])
2024-03-01 13:48:55.744386: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-01 13:48:55.744878: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:48:55.799235: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:48:55.799276: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:48:55.799334: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:48:55.799356: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:48:55.799376: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:48:55.799395: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:48:55.799414: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:48:55.799434: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:48:55.799454: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:48:55.799929: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:48:55.799970: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:48:56.463362: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-01 13:48:56.463414: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-01 13:48:56.463424: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-01 13:48:56.472613: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:83:00.0, compute capability: 6.1)
{'id': '18_15', 'seed': 15, 'out_folder': 'results/epoch_budget', 'batch_size': 32, 'epochs': 27, 'validation_split': 0.2, 'checkpointing': True, 'initial_lr': 0.1, 'momentum': 0.98, 'nesterov': True, 'bootstrapping': False, 'map_optimizer': True, 'model': 'CNN-LSTM', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Loading data...
Pad sequences (samples x time)
20000 train sequences
5000 validation sequences
25000 test sequences
x_train shape: (20000, 100)
x_val shape: (5000, 100)
x_test shape: (25000, 100)
Using MAP optimizer with reg_weight:  5e-05
CNN-LSTM

0epoch [00:00, ?epoch/s]
  0%|          | 0/27 [00:00<?, ?epoch/s]2024-03-01 13:48:56.869897: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-01 13:48:56.870354: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199945000 Hz
2024-03-01 13:48:58.300291: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:48:58.457660: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:48:59.071925: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-01 13:48:59.101699: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.

  4%|▎         | 1/27 [00:10<04:42, 10.86s/epoch, loss=0.753, accuracy=0.497, val_loss=0.74, val_accuracy=0.496]
  7%|▋         | 2/27 [00:17<03:29,  8.40s/epoch, loss=0.736, accuracy=0.497, val_loss=0.729, val_accuracy=0.504]
 11%|█         | 3/27 [00:23<02:57,  7.40s/epoch, loss=0.727, accuracy=0.499, val_loss=0.719, val_accuracy=0.496]
 15%|█▍        | 4/27 [00:30<02:44,  7.17s/epoch, loss=0.607, accuracy=0.682, val_loss=0.476, val_accuracy=0.804]
 19%|█▊        | 5/27 [00:37<02:32,  6.91s/epoch, loss=0.452, accuracy=0.826, val_loss=0.47, val_accuracy=0.829] 
 22%|██▏       | 6/27 [00:43<02:23,  6.83s/epoch, loss=0.425, accuracy=0.858, val_loss=0.494, val_accuracy=0.831]
 26%|██▌       | 7/27 [00:50<02:17,  6.87s/epoch, loss=0.413, accuracy=0.88, val_loss=0.502, val_accuracy=0.846] 
 30%|██▉       | 8/27 [00:56<02:06,  6.64s/epoch, loss=0.421, accuracy=0.89, val_loss=0.608, val_accuracy=0.832]
 33%|███▎      | 9/27 [01:02<01:56,  6.49s/epoch, loss=0.523, accuracy=0.865, val_loss=0.695, val_accuracy=0.806]
 37%|███▋      | 10/27 [01:09<01:48,  6.41s/epoch, loss=0.791, accuracy=0.78, val_loss=1, val_accuracy=0.672]    
 41%|████      | 11/27 [01:15<01:41,  6.32s/epoch, loss=1.06, accuracy=0.681, val_loss=1.12, val_accuracy=0.66]
 44%|████▍     | 12/27 [01:21<01:34,  6.28s/epoch, loss=1.15, accuracy=0.639, val_loss=1.15, val_accuracy=0.633]
 48%|████▊     | 13/27 [01:27<01:27,  6.25s/epoch, loss=1.18, accuracy=0.609, val_loss=1.31, val_accuracy=0.528]
 52%|█████▏    | 14/27 [01:33<01:20,  6.22s/epoch, loss=1.25, accuracy=0.541, val_loss=1.23, val_accuracy=0.502]
 56%|█████▌    | 15/27 [01:40<01:14,  6.21s/epoch, loss=1.18, accuracy=0.508, val_loss=1.11, val_accuracy=0.496]
 59%|█████▉    | 16/27 [01:46<01:08,  6.19s/epoch, loss=1.06, accuracy=0.512, val_loss=1, val_accuracy=0.549]   
 63%|██████▎   | 17/27 [01:52<01:01,  6.18s/epoch, loss=0.973, accuracy=0.567, val_loss=0.921, val_accuracy=0.606]
 67%|██████▋   | 18/27 [01:58<00:55,  6.17s/epoch, loss=0.915, accuracy=0.609, val_loss=0.883, val_accuracy=0.643]
 70%|███████   | 19/27 [02:04<00:49,  6.17s/epoch, loss=0.897, accuracy=0.624, val_loss=0.869, val_accuracy=0.619]
 74%|███████▍  | 20/27 [02:10<00:43,  6.16s/epoch, loss=0.974, accuracy=0.593, val_loss=1.05, val_accuracy=0.535] 
 78%|███████▊  | 21/27 [02:16<00:37,  6.17s/epoch, loss=1.04, accuracy=0.58, val_loss=0.974, val_accuracy=0.611] 
 81%|████████▏ | 22/27 [02:23<00:30,  6.17s/epoch, loss=0.995, accuracy=0.563, val_loss=1, val_accuracy=0.496]  
 85%|████████▌ | 23/27 [02:29<00:24,  6.17s/epoch, loss=0.96, accuracy=0.584, val_loss=0.963, val_accuracy=0.56]
 89%|████████▉ | 24/27 [02:35<00:18,  6.19s/epoch, loss=0.95, accuracy=0.577, val_loss=0.98, val_accuracy=0.511]
 93%|█████████▎| 25/27 [02:41<00:12,  6.19s/epoch, loss=0.933, accuracy=0.577, val_loss=0.932, val_accuracy=0.61]
 96%|█████████▋| 26/27 [02:47<00:06,  6.19s/epoch, loss=0.888, accuracy=0.597, val_loss=0.935, val_accuracy=0.555]
100%|██████████| 27/27 [02:54<00:00,  6.19s/epoch, loss=0.854, accuracy=0.617, val_loss=0.834, val_accuracy=0.631]
100%|██████████| 27/27 [02:54<00:00,  6.45s/epoch, loss=0.854, accuracy=0.617, val_loss=0.834, val_accuracy=0.631]
Test score: 0.5028361678123474
Test accuracy: 0.8397200107574463


* * * Run SGD for ID = 18_16. * * *


2024-03-01 13:51:56.599138: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:51:59.959686: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:51:59.960683: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-01 13:51:59.999144: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:51:59.999174: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:52:00.002566: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:52:00.002607: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:52:00.004996: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:52:00.005942: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:52:00.008444: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:52:00.009901: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:52:00.014686: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:52:00.015154: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:52:00.015255: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
<__array_function__ internals>:5: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:159: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_train, y_train = np.array(xs[:idx]), np.array(labels[:idx])
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:160: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_test, y_test = np.array(xs[idx:]), np.array(labels[idx:])
2024-03-01 13:52:05.269121: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-01 13:52:05.269613: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:52:05.270426: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:52:05.270461: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:52:05.270516: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:52:05.270544: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:52:05.270562: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:52:05.270579: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:52:05.270597: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:52:05.270614: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:52:05.270632: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:52:05.271120: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:52:05.271171: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:52:05.890189: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-01 13:52:05.890249: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-01 13:52:05.890259: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-01 13:52:05.891144: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:83:00.0, compute capability: 6.1)
{'id': '18_16', 'seed': 16, 'out_folder': 'results/epoch_budget', 'batch_size': 32, 'epochs': 27, 'validation_split': 0.2, 'checkpointing': True, 'initial_lr': 0.1, 'momentum': 0.98, 'nesterov': True, 'bootstrapping': False, 'map_optimizer': True, 'model': 'CNN-LSTM', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Loading data...
Pad sequences (samples x time)
20000 train sequences
5000 validation sequences
25000 test sequences
x_train shape: (20000, 100)
x_val shape: (5000, 100)
x_test shape: (25000, 100)
Using MAP optimizer with reg_weight:  5e-05
CNN-LSTM

0epoch [00:00, ?epoch/s]
  0%|          | 0/27 [00:00<?, ?epoch/s]2024-03-01 13:52:06.290929: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-01 13:52:06.302983: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199945000 Hz
2024-03-01 13:52:07.719968: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:52:07.894437: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:52:08.513203: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-01 13:52:08.542758: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.

  4%|▎         | 1/27 [00:10<04:41, 10.81s/epoch, loss=0.689, accuracy=0.603, val_loss=0.564, val_accuracy=0.748]
  7%|▋         | 2/27 [00:17<03:33,  8.52s/epoch, loss=0.49, accuracy=0.812, val_loss=0.505, val_accuracy=0.795] 
 11%|█         | 3/27 [00:24<03:00,  7.52s/epoch, loss=0.442, accuracy=0.85, val_loss=0.447, val_accuracy=0.851]
 15%|█▍        | 4/27 [00:30<02:39,  6.94s/epoch, loss=0.429, accuracy=0.868, val_loss=0.505, val_accuracy=0.834]
 19%|█▊        | 5/27 [00:36<02:25,  6.60s/epoch, loss=0.452, accuracy=0.873, val_loss=0.563, val_accuracy=0.822]
 22%|██▏       | 6/27 [00:42<02:14,  6.41s/epoch, loss=0.548, accuracy=0.857, val_loss=0.733, val_accuracy=0.782]
 26%|██▌       | 7/27 [00:48<02:05,  6.27s/epoch, loss=0.961, accuracy=0.682, val_loss=1.1, val_accuracy=0.61]   
 30%|██▉       | 8/27 [00:54<01:57,  6.19s/epoch, loss=1.07, accuracy=0.576, val_loss=1.03, val_accuracy=0.557]
 33%|███▎      | 9/27 [01:00<01:50,  6.13s/epoch, loss=0.989, accuracy=0.619, val_loss=0.932, val_accuracy=0.682]
 37%|███▋      | 10/27 [01:06<01:43,  6.10s/epoch, loss=1.01, accuracy=0.588, val_loss=1.03, val_accuracy=0.524] 
 41%|████      | 11/27 [01:12<01:37,  6.07s/epoch, loss=1.01, accuracy=0.554, val_loss=0.969, val_accuracy=0.59]
 44%|████▍     | 12/27 [01:18<01:30,  6.05s/epoch, loss=0.95, accuracy=0.608, val_loss=1.03, val_accuracy=0.537]
 48%|████▊     | 13/27 [01:24<01:24,  6.04s/epoch, loss=0.984, accuracy=0.59, val_loss=1.04, val_accuracy=0.524]
 52%|█████▏    | 14/27 [01:30<01:18,  6.04s/epoch, loss=1, accuracy=0.54, val_loss=1.02, val_accuracy=0.485]    
 56%|█████▌    | 15/27 [01:36<01:12,  6.03s/epoch, loss=0.952, accuracy=0.535, val_loss=0.932, val_accuracy=0.568]
 59%|█████▉    | 16/27 [01:42<01:06,  6.02s/epoch, loss=0.909, accuracy=0.539, val_loss=0.91, val_accuracy=0.519] 
 63%|██████▎   | 17/27 [01:48<01:00,  6.02s/epoch, loss=0.872, accuracy=0.571, val_loss=0.827, val_accuracy=0.587]
 67%|██████▋   | 18/27 [01:54<00:54,  6.02s/epoch, loss=0.828, accuracy=0.61, val_loss=0.861, val_accuracy=0.6]   
 70%|███████   | 19/27 [02:00<00:48,  6.02s/epoch, loss=0.821, accuracy=0.646, val_loss=0.826, val_accuracy=0.659]
 74%|███████▍  | 20/27 [02:06<00:42,  6.02s/epoch, loss=0.857, accuracy=0.633, val_loss=0.903, val_accuracy=0.578]
 78%|███████▊  | 21/27 [02:12<00:36,  6.02s/epoch, loss=0.884, accuracy=0.619, val_loss=0.876, val_accuracy=0.599]
 81%|████████▏ | 22/27 [02:18<00:30,  6.02s/epoch, loss=0.891, accuracy=0.604, val_loss=0.873, val_accuracy=0.652]
 85%|████████▌ | 23/27 [02:24<00:24,  6.02s/epoch, loss=0.908, accuracy=0.607, val_loss=0.952, val_accuracy=0.589]
 89%|████████▉ | 24/27 [02:30<00:18,  6.02s/epoch, loss=0.899, accuracy=0.584, val_loss=0.956, val_accuracy=0.527]
 93%|█████████▎| 25/27 [02:36<00:12,  6.01s/epoch, loss=0.902, accuracy=0.582, val_loss=0.903, val_accuracy=0.618]
 96%|█████████▋| 26/27 [02:42<00:06,  6.01s/epoch, loss=0.875, accuracy=0.602, val_loss=0.833, val_accuracy=0.635]
100%|██████████| 27/27 [02:48<00:00,  6.00s/epoch, loss=0.858, accuracy=0.597, val_loss=0.833, val_accuracy=0.626]
100%|██████████| 27/27 [02:48<00:00,  6.24s/epoch, loss=0.858, accuracy=0.597, val_loss=0.833, val_accuracy=0.626]
Test score: 0.46552789211273193
Test accuracy: 0.8446400165557861


* * * Run SGD for ID = 18_17. * * *


2024-03-01 13:55:01.068323: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:55:16.977911: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:55:16.980178: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-01 13:55:17.024206: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:55:17.024242: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:55:17.111815: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:55:17.111902: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:55:17.126983: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:55:17.178875: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:55:17.201943: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:55:17.229816: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:55:17.253221: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:55:17.253868: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:55:17.253968: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
<__array_function__ internals>:5: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:159: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_train, y_train = np.array(xs[:idx]), np.array(labels[:idx])
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:160: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_test, y_test = np.array(xs[idx:]), np.array(labels[idx:])
2024-03-01 13:55:22.492615: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-01 13:55:22.493164: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:55:22.493692: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:55:22.493725: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:55:22.493772: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:55:22.493792: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:55:22.493811: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:55:22.493854: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:55:22.493875: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:55:22.493895: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:55:22.493915: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:55:22.494383: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:55:22.494418: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:55:23.447039: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-01 13:55:23.447096: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-01 13:55:23.447105: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-01 13:55:23.447980: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:83:00.0, compute capability: 6.1)
{'id': '18_17', 'seed': 17, 'out_folder': 'results/epoch_budget', 'batch_size': 32, 'epochs': 27, 'validation_split': 0.2, 'checkpointing': True, 'initial_lr': 0.1, 'momentum': 0.98, 'nesterov': True, 'bootstrapping': False, 'map_optimizer': True, 'model': 'CNN-LSTM', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Loading data...
Pad sequences (samples x time)
20000 train sequences
5000 validation sequences
25000 test sequences
x_train shape: (20000, 100)
x_val shape: (5000, 100)
x_test shape: (25000, 100)
Using MAP optimizer with reg_weight:  5e-05
CNN-LSTM

0epoch [00:00, ?epoch/s]
  0%|          | 0/27 [00:00<?, ?epoch/s]2024-03-01 13:55:23.835693: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-01 13:55:23.847970: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199945000 Hz
2024-03-01 13:55:25.248400: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:55:25.455086: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:55:26.398212: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-01 13:55:26.429364: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.

  4%|▎         | 1/27 [00:11<05:04, 11.70s/epoch, loss=0.639, accuracy=0.665, val_loss=0.535, val_accuracy=0.778]
  7%|▋         | 2/27 [00:18<03:34,  8.60s/epoch, loss=0.473, accuracy=0.828, val_loss=0.503, val_accuracy=0.808]
 11%|█         | 3/27 [00:25<03:07,  7.83s/epoch, loss=0.44, accuracy=0.858, val_loss=0.489, val_accuracy=0.833] 
 15%|█▍        | 4/27 [00:31<02:50,  7.42s/epoch, loss=0.433, accuracy=0.875, val_loss=0.507, val_accuracy=0.843]
 19%|█▊        | 5/27 [00:37<02:32,  6.93s/epoch, loss=0.453, accuracy=0.879, val_loss=0.562, val_accuracy=0.829]
 22%|██▏       | 6/27 [00:43<02:19,  6.63s/epoch, loss=0.508, accuracy=0.878, val_loss=0.655, val_accuracy=0.814]
 26%|██▌       | 7/27 [00:49<02:08,  6.42s/epoch, loss=0.712, accuracy=0.815, val_loss=0.934, val_accuracy=0.733]
 30%|██▉       | 8/27 [00:55<01:59,  6.29s/epoch, loss=1.01, accuracy=0.715, val_loss=1.1, val_accuracy=0.69]    
 33%|███▎      | 9/27 [01:01<01:51,  6.20s/epoch, loss=1.24, accuracy=0.585, val_loss=1.24, val_accuracy=0.51]
 37%|███▋      | 10/27 [01:07<01:44,  6.13s/epoch, loss=1.17, accuracy=0.56, val_loss=1.1, val_accuracy=0.591]
 41%|████      | 11/27 [01:13<01:37,  6.09s/epoch, loss=1.06, accuracy=0.577, val_loss=1.02, val_accuracy=0.598]
 44%|████▍     | 12/27 [01:19<01:30,  6.06s/epoch, loss=0.992, accuracy=0.592, val_loss=1.01, val_accuracy=0.599]
 48%|████▊     | 13/27 [01:25<01:24,  6.06s/epoch, loss=0.943, accuracy=0.609, val_loss=0.955, val_accuracy=0.625]
 52%|█████▏    | 14/27 [01:31<01:18,  6.05s/epoch, loss=0.914, accuracy=0.631, val_loss=0.923, val_accuracy=0.597]
 56%|█████▌    | 15/27 [01:38<01:12,  6.04s/epoch, loss=0.937, accuracy=0.592, val_loss=0.899, val_accuracy=0.628]
 59%|█████▉    | 16/27 [01:44<01:06,  6.03s/epoch, loss=0.936, accuracy=0.614, val_loss=0.969, val_accuracy=0.566]
 63%|██████▎   | 17/27 [01:49<01:00,  6.01s/epoch, loss=0.921, accuracy=0.618, val_loss=0.945, val_accuracy=0.613]
 67%|██████▋   | 18/27 [01:55<00:53,  5.99s/epoch, loss=0.91, accuracy=0.618, val_loss=0.912, val_accuracy=0.63]  
 70%|███████   | 19/27 [02:01<00:47,  5.99s/epoch, loss=0.888, accuracy=0.633, val_loss=0.906, val_accuracy=0.629]
 74%|███████▍  | 20/27 [02:07<00:41,  5.99s/epoch, loss=0.874, accuracy=0.638, val_loss=0.865, val_accuracy=0.64] 
 78%|███████▊  | 21/27 [02:13<00:35,  5.99s/epoch, loss=0.852, accuracy=0.661, val_loss=0.846, val_accuracy=0.663]
 81%|████████▏ | 22/27 [02:19<00:29,  5.99s/epoch, loss=0.889, accuracy=0.631, val_loss=0.883, val_accuracy=0.67] 
 85%|████████▌ | 23/27 [02:25<00:23,  5.98s/epoch, loss=0.933, accuracy=0.621, val_loss=0.978, val_accuracy=0.588]
 89%|████████▉ | 24/27 [02:31<00:17,  5.99s/epoch, loss=0.954, accuracy=0.599, val_loss=0.928, val_accuracy=0.637]
 93%|█████████▎| 25/27 [02:37<00:11,  5.99s/epoch, loss=0.967, accuracy=0.583, val_loss=1.01, val_accuracy=0.521] 
 96%|█████████▋| 26/27 [02:43<00:05,  5.99s/epoch, loss=0.961, accuracy=0.553, val_loss=0.901, val_accuracy=0.601]
100%|██████████| 27/27 [02:49<00:00,  6.00s/epoch, loss=0.903, accuracy=0.618, val_loss=0.866, val_accuracy=0.625]
100%|██████████| 27/27 [02:49<00:00,  6.29s/epoch, loss=0.903, accuracy=0.618, val_loss=0.866, val_accuracy=0.625]
Test score: 0.5123671889305115
Test accuracy: 0.8354799747467041


* * * Run SGD for ID = 18_18. * * *


2024-03-01 13:58:19.121908: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:58:22.431975: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:58:22.433012: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-01 13:58:22.470632: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:58:22.470667: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:58:22.473641: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:58:22.473682: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:58:22.475772: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:58:22.476461: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:58:22.478671: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:58:22.480089: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:58:22.484462: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:58:22.484962: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:58:22.485051: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
<__array_function__ internals>:5: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:159: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_train, y_train = np.array(xs[:idx]), np.array(labels[:idx])
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:160: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_test, y_test = np.array(xs[idx:]), np.array(labels[idx:])
2024-03-01 13:58:27.687936: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-01 13:58:27.688443: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:58:27.689278: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:58:27.689310: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:58:27.689360: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:58:27.689382: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:58:27.689401: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:58:27.689419: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:58:27.689437: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:58:27.689455: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:58:27.689474: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:58:27.689926: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:58:27.689960: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:58:28.289905: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-01 13:58:28.289969: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-01 13:58:28.289983: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-01 13:58:28.290868: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:83:00.0, compute capability: 6.1)
{'id': '18_18', 'seed': 18, 'out_folder': 'results/epoch_budget', 'batch_size': 32, 'epochs': 27, 'validation_split': 0.2, 'checkpointing': True, 'initial_lr': 0.1, 'momentum': 0.98, 'nesterov': True, 'bootstrapping': False, 'map_optimizer': True, 'model': 'CNN-LSTM', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Loading data...
Pad sequences (samples x time)
20000 train sequences
5000 validation sequences
25000 test sequences
x_train shape: (20000, 100)
x_val shape: (5000, 100)
x_test shape: (25000, 100)
Using MAP optimizer with reg_weight:  5e-05
CNN-LSTM

0epoch [00:00, ?epoch/s]
  0%|          | 0/27 [00:00<?, ?epoch/s]2024-03-01 13:58:28.688198: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-01 13:58:28.688639: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199945000 Hz
2024-03-01 13:58:30.114270: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:58:30.276131: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:58:30.895990: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-01 13:58:30.924913: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.

  4%|▎         | 1/27 [00:11<04:50, 11.18s/epoch, loss=0.641, accuracy=0.659, val_loss=0.511, val_accuracy=0.784]
  7%|▋         | 2/27 [00:17<03:28,  8.33s/epoch, loss=0.463, accuracy=0.83, val_loss=0.491, val_accuracy=0.817] 
 11%|█         | 3/27 [00:23<02:57,  7.40s/epoch, loss=0.428, accuracy=0.86, val_loss=0.511, val_accuracy=0.84] 
 15%|█▍        | 4/27 [00:30<02:40,  6.97s/epoch, loss=0.419, accuracy=0.88, val_loss=0.505, val_accuracy=0.845]
 19%|█▊        | 5/27 [00:36<02:25,  6.63s/epoch, loss=0.421, accuracy=0.894, val_loss=0.54, val_accuracy=0.841]
 22%|██▏       | 6/27 [00:42<02:14,  6.42s/epoch, loss=0.457, accuracy=0.894, val_loss=0.597, val_accuracy=0.841]
 26%|██▌       | 7/27 [00:48<02:06,  6.30s/epoch, loss=0.489, accuracy=0.892, val_loss=0.678, val_accuracy=0.815]
 30%|██▉       | 8/27 [00:54<01:57,  6.21s/epoch, loss=0.743, accuracy=0.804, val_loss=1.05, val_accuracy=0.662] 
 33%|███▎      | 9/27 [01:00<01:50,  6.15s/epoch, loss=1.11, accuracy=0.632, val_loss=1.19, val_accuracy=0.531] 
 37%|███▋      | 10/27 [01:06<01:43,  6.12s/epoch, loss=1.07, accuracy=0.632, val_loss=1.06, val_accuracy=0.629]
 41%|████      | 11/27 [01:12<01:37,  6.08s/epoch, loss=1.03, accuracy=0.637, val_loss=1.08, val_accuracy=0.618]
 44%|████▍     | 12/27 [01:18<01:31,  6.07s/epoch, loss=1.03, accuracy=0.626, val_loss=1.04, val_accuracy=0.619]
 48%|████▊     | 13/27 [01:24<01:24,  6.06s/epoch, loss=1.02, accuracy=0.617, val_loss=1.06, val_accuracy=0.532]
 52%|█████▏    | 14/27 [01:30<01:18,  6.04s/epoch, loss=1.01, accuracy=0.6, val_loss=1.01, val_accuracy=0.599]  
 56%|█████▌    | 15/27 [01:36<01:12,  6.02s/epoch, loss=1.01, accuracy=0.561, val_loss=0.991, val_accuracy=0.528]
 59%|█████▉    | 16/27 [01:42<01:06,  6.01s/epoch, loss=0.958, accuracy=0.546, val_loss=0.921, val_accuracy=0.5] 
 63%|██████▎   | 17/27 [01:48<01:00,  6.00s/epoch, loss=0.918, accuracy=0.57, val_loss=0.879, val_accuracy=0.607]
 67%|██████▋   | 18/27 [01:54<00:54,  6.00s/epoch, loss=0.889, accuracy=0.582, val_loss=0.922, val_accuracy=0.5] 
 70%|███████   | 19/27 [02:00<00:48,  6.01s/epoch, loss=0.892, accuracy=0.59, val_loss=0.894, val_accuracy=0.543]
 74%|███████▍  | 20/27 [02:06<00:41,  6.00s/epoch, loss=0.918, accuracy=0.598, val_loss=0.908, val_accuracy=0.585]
 78%|███████▊  | 21/27 [02:12<00:35,  5.99s/epoch, loss=0.918, accuracy=0.59, val_loss=0.963, val_accuracy=0.566] 
 81%|████████▏ | 22/27 [02:18<00:29,  6.00s/epoch, loss=0.91, accuracy=0.607, val_loss=0.899, val_accuracy=0.593]
 85%|████████▌ | 23/27 [02:24<00:24,  6.00s/epoch, loss=0.901, accuracy=0.611, val_loss=0.882, val_accuracy=0.635]
 89%|████████▉ | 24/27 [02:30<00:17,  6.00s/epoch, loss=0.914, accuracy=0.616, val_loss=0.885, val_accuracy=0.619]
 93%|█████████▎| 25/27 [02:36<00:11,  6.00s/epoch, loss=0.901, accuracy=0.63, val_loss=0.976, val_accuracy=0.571] 
 96%|█████████▋| 26/27 [02:42<00:05,  5.99s/epoch, loss=0.898, accuracy=0.62, val_loss=0.951, val_accuracy=0.553]
100%|██████████| 27/27 [02:48<00:00,  6.01s/epoch, loss=0.912, accuracy=0.587, val_loss=0.874, val_accuracy=0.607]
100%|██████████| 27/27 [02:48<00:00,  6.23s/epoch, loss=0.912, accuracy=0.587, val_loss=0.874, val_accuracy=0.607]
Test score: 0.5044760704040527
Test accuracy: 0.841759979724884

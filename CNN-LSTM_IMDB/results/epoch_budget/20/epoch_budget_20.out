Fri Mar  1 13:20:15 2024       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 545.23.08              Driver Version: 545.23.08    CUDA Version: 12.3     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA TITAN Xp                Off | 00000000:18:00.0 Off |                  N/A |
| 40%   67C    P0              79W / 250W |      0MiB / 12288MiB |      0%      Default |
|                                         |                      |                  N/A |
+-----------------------------------------+----------------------+----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
|  No running processes found                                                           |
+---------------------------------------------------------------------------------------+


* * * Run SGD for cluster size = 20. * * *


Budget: 25


* * * Run SGD for ID = 20_1. * * *


2024-03-01 13:20:23.085415: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:20:33.698849: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:20:33.701205: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-01 13:20:33.746638: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:20:33.746703: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:20:33.817655: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:20:33.817783: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:20:33.877242: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:20:34.082852: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:20:34.213342: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:20:34.259965: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:20:34.294316: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:20:34.295301: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:20:34.295490: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
<__array_function__ internals>:5: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:159: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_train, y_train = np.array(xs[:idx]), np.array(labels[:idx])
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:160: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_test, y_test = np.array(xs[idx:]), np.array(labels[idx:])
2024-03-01 13:20:41.560016: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-01 13:20:41.560710: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:20:41.562090: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:20:41.562154: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:20:41.562296: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:20:41.562331: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:20:41.562359: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:20:41.562387: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:20:41.562414: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:20:41.562441: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:20:41.562470: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:20:41.563157: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:20:41.563211: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:20:42.807653: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-01 13:20:42.807720: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-01 13:20:42.807731: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-01 13:20:42.808952: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:18:00.0, compute capability: 6.1)
{'id': '20_01', 'seed': 1, 'out_folder': 'results/epoch_budget', 'batch_size': 32, 'epochs': 25, 'validation_split': 0.2, 'checkpointing': True, 'initial_lr': 0.1, 'momentum': 0.98, 'nesterov': True, 'bootstrapping': False, 'map_optimizer': True, 'model': 'CNN-LSTM', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Loading data...
Pad sequences (samples x time)
20000 train sequences
5000 validation sequences
25000 test sequences
x_train shape: (20000, 100)
x_val shape: (5000, 100)
x_test shape: (25000, 100)
Using MAP optimizer with reg_weight:  5e-05
CNN-LSTM

0epoch [00:00, ?epoch/s]
  0%|          | 0/25 [00:00<?, ?epoch/s]2024-03-01 13:20:43.294931: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-01 13:20:43.306973: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-03-01 13:20:44.981658: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:20:45.799592: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:20:47.163272: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-01 13:20:47.220199: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.

  4%|▍         | 1/25 [00:16<06:41, 16.74s/epoch, loss=0.696, accuracy=0.596, val_loss=0.516, val_accuracy=0.789]
  8%|▊         | 2/25 [00:27<05:07, 13.38s/epoch, loss=0.478, accuracy=0.818, val_loss=0.479, val_accuracy=0.818]
 12%|█▏        | 3/25 [00:38<04:31, 12.32s/epoch, loss=0.427, accuracy=0.858, val_loss=0.49, val_accuracy=0.832] 
 16%|█▌        | 4/25 [00:47<03:49, 10.95s/epoch, loss=0.442, accuracy=0.87, val_loss=0.552, val_accuracy=0.829]
 20%|██        | 5/25 [00:56<03:24, 10.23s/epoch, loss=0.53, accuracy=0.851, val_loss=0.713, val_accuracy=0.774]
 24%|██▍       | 6/25 [01:05<03:05,  9.78s/epoch, loss=0.839, accuracy=0.738, val_loss=0.924, val_accuracy=0.698]
 28%|██▊       | 7/25 [01:14<02:50,  9.47s/epoch, loss=0.992, accuracy=0.66, val_loss=1.05, val_accuracy=0.606]  
 32%|███▏      | 8/25 [01:23<02:38,  9.32s/epoch, loss=1.01, accuracy=0.619, val_loss=0.948, val_accuracy=0.66]
 36%|███▌      | 9/25 [01:32<02:26,  9.18s/epoch, loss=1, accuracy=0.607, val_loss=0.969, val_accuracy=0.627]  
 40%|████      | 10/25 [01:41<02:16,  9.08s/epoch, loss=0.961, accuracy=0.649, val_loss=0.937, val_accuracy=0.623]
 44%|████▍     | 11/25 [01:49<02:06,  9.03s/epoch, loss=0.939, accuracy=0.636, val_loss=0.93, val_accuracy=0.64]  
 48%|████▊     | 12/25 [01:58<01:56,  9.00s/epoch, loss=0.924, accuracy=0.63, val_loss=0.92, val_accuracy=0.616]
 52%|█████▏    | 13/25 [02:07<01:47,  8.96s/epoch, loss=0.913, accuracy=0.636, val_loss=0.954, val_accuracy=0.636]
 56%|█████▌    | 14/25 [02:16<01:37,  8.90s/epoch, loss=0.897, accuracy=0.652, val_loss=0.992, val_accuracy=0.532]
 60%|██████    | 15/25 [02:25<01:28,  8.89s/epoch, loss=0.939, accuracy=0.606, val_loss=0.949, val_accuracy=0.575]
 64%|██████▍   | 16/25 [02:34<01:19,  8.85s/epoch, loss=0.949, accuracy=0.57, val_loss=0.955, val_accuracy=0.566] 
 68%|██████▊   | 17/25 [02:43<01:10,  8.86s/epoch, loss=0.903, accuracy=0.598, val_loss=0.879, val_accuracy=0.561]
 72%|███████▏  | 18/25 [02:51<01:02,  8.87s/epoch, loss=0.863, accuracy=0.626, val_loss=0.831, val_accuracy=0.643]
 76%|███████▌  | 19/25 [03:00<00:52,  8.75s/epoch, loss=0.86, accuracy=0.647, val_loss=0.851, val_accuracy=0.656] 
 80%|████████  | 20/25 [03:08<00:43,  8.62s/epoch, loss=0.885, accuracy=0.636, val_loss=0.866, val_accuracy=0.646]
 84%|████████▍ | 21/25 [03:17<00:34,  8.61s/epoch, loss=0.884, accuracy=0.634, val_loss=0.887, val_accuracy=0.644]
 88%|████████▊ | 22/25 [03:26<00:26,  8.79s/epoch, loss=0.911, accuracy=0.621, val_loss=0.936, val_accuracy=0.615]
 92%|█████████▏| 23/25 [03:35<00:17,  8.92s/epoch, loss=0.881, accuracy=0.632, val_loss=0.936, val_accuracy=0.634]
 96%|█████████▌| 24/25 [03:44<00:08,  8.99s/epoch, loss=0.903, accuracy=0.606, val_loss=0.868, val_accuracy=0.648]
100%|██████████| 25/25 [03:54<00:00,  9.09s/epoch, loss=0.888, accuracy=0.607, val_loss=0.944, val_accuracy=0.552]
100%|██████████| 25/25 [03:54<00:00,  9.37s/epoch, loss=0.888, accuracy=0.607, val_loss=0.944, val_accuracy=0.552]
Test score: 0.48811861872673035
Test accuracy: 0.8345199823379517


* * * Run SGD for ID = 20_2. * * *


2024-03-01 13:24:46.945159: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:24:50.810277: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:24:50.811679: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-01 13:24:50.855270: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:24:50.855318: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:24:50.859398: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:24:50.859501: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:24:50.862269: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:24:50.863223: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:24:50.866204: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:24:50.868144: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:24:50.874707: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:24:50.875564: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:24:50.875686: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
<__array_function__ internals>:5: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:159: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_train, y_train = np.array(xs[:idx]), np.array(labels[:idx])
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:160: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_test, y_test = np.array(xs[idx:]), np.array(labels[idx:])
2024-03-01 13:24:58.337229: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-01 13:24:58.338057: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:24:58.339405: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:24:58.339458: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:24:58.339581: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:24:58.339602: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:24:58.339619: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:24:58.339637: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:24:58.339654: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:24:58.339672: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:24:58.339690: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:24:58.340311: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:24:58.340354: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:24:59.010370: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-01 13:24:59.010430: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-01 13:24:59.010441: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-01 13:24:59.011633: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:18:00.0, compute capability: 6.1)
{'id': '20_02', 'seed': 2, 'out_folder': 'results/epoch_budget', 'batch_size': 32, 'epochs': 25, 'validation_split': 0.2, 'checkpointing': True, 'initial_lr': 0.1, 'momentum': 0.98, 'nesterov': True, 'bootstrapping': False, 'map_optimizer': True, 'model': 'CNN-LSTM', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Loading data...
Pad sequences (samples x time)
20000 train sequences
5000 validation sequences
25000 test sequences
x_train shape: (20000, 100)
x_val shape: (5000, 100)
x_test shape: (25000, 100)
Using MAP optimizer with reg_weight:  5e-05
CNN-LSTM

0epoch [00:00, ?epoch/s]
  0%|          | 0/25 [00:00<?, ?epoch/s]2024-03-01 13:24:59.504343: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-01 13:24:59.517031: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-03-01 13:25:01.217851: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:25:01.439629: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:25:02.338719: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-01 13:25:02.399284: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.

  4%|▍         | 1/25 [00:16<06:28, 16.18s/epoch, loss=0.665, accuracy=0.632, val_loss=0.522, val_accuracy=0.788]
  8%|▊         | 2/25 [00:26<04:48, 12.56s/epoch, loss=0.474, accuracy=0.822, val_loss=0.463, val_accuracy=0.836]
 12%|█▏        | 3/25 [00:36<04:13, 11.51s/epoch, loss=0.422, accuracy=0.863, val_loss=0.464, val_accuracy=0.847]
 16%|█▌        | 4/25 [00:45<03:43, 10.64s/epoch, loss=0.41, accuracy=0.882, val_loss=0.497, val_accuracy=0.84]  
 20%|██        | 5/25 [00:55<03:24, 10.20s/epoch, loss=0.422, accuracy=0.892, val_loss=0.563, val_accuracy=0.835]
 24%|██▍       | 6/25 [01:04<03:10, 10.02s/epoch, loss=0.472, accuracy=0.889, val_loss=0.621, val_accuracy=0.831]
 28%|██▊       | 7/25 [01:14<02:57,  9.87s/epoch, loss=0.627, accuracy=0.845, val_loss=0.882, val_accuracy=0.75] 
 32%|███▏      | 8/25 [01:23<02:44,  9.67s/epoch, loss=1.05, accuracy=0.646, val_loss=1.15, val_accuracy=0.503] 
 36%|███▌      | 9/25 [01:33<02:33,  9.59s/epoch, loss=1.11, accuracy=0.561, val_loss=1.07, val_accuracy=0.569]
 40%|████      | 10/25 [01:42<02:22,  9.51s/epoch, loss=1.05, accuracy=0.561, val_loss=1, val_accuracy=0.555]  
 44%|████▍     | 11/25 [01:51<02:12,  9.46s/epoch, loss=1, accuracy=0.547, val_loss=0.967, val_accuracy=0.491]
 48%|████▊     | 12/25 [02:01<02:02,  9.44s/epoch, loss=0.945, accuracy=0.528, val_loss=0.976, val_accuracy=0.491]
 52%|█████▏    | 13/25 [02:10<01:53,  9.42s/epoch, loss=0.88, accuracy=0.57, val_loss=0.851, val_accuracy=0.612]  
 56%|█████▌    | 14/25 [02:19<01:42,  9.35s/epoch, loss=0.846, accuracy=0.609, val_loss=0.901, val_accuracy=0.59]
 60%|██████    | 15/25 [02:29<01:33,  9.36s/epoch, loss=0.867, accuracy=0.609, val_loss=0.85, val_accuracy=0.634]
 64%|██████▍   | 16/25 [02:38<01:25,  9.46s/epoch, loss=0.865, accuracy=0.598, val_loss=0.868, val_accuracy=0.531]
 68%|██████▊   | 17/25 [02:48<01:16,  9.54s/epoch, loss=0.842, accuracy=0.601, val_loss=0.825, val_accuracy=0.639]
 72%|███████▏  | 18/25 [02:58<01:06,  9.53s/epoch, loss=0.828, accuracy=0.622, val_loss=0.835, val_accuracy=0.622]
 76%|███████▌  | 19/25 [03:07<00:57,  9.56s/epoch, loss=0.85, accuracy=0.619, val_loss=0.896, val_accuracy=0.492] 
 80%|████████  | 20/25 [03:17<00:47,  9.52s/epoch, loss=0.876, accuracy=0.624, val_loss=0.876, val_accuracy=0.651]
 84%|████████▍ | 21/25 [03:26<00:37,  9.46s/epoch, loss=0.921, accuracy=0.603, val_loss=0.939, val_accuracy=0.506]
 88%|████████▊ | 22/25 [03:35<00:28,  9.41s/epoch, loss=0.916, accuracy=0.574, val_loss=0.881, val_accuracy=0.588]
 92%|█████████▏| 23/25 [03:44<00:18,  9.34s/epoch, loss=1.06, accuracy=0.606, val_loss=1.12, val_accuracy=0.631]  
 96%|█████████▌| 24/25 [03:54<00:09,  9.31s/epoch, loss=1.1, accuracy=0.598, val_loss=1.06, val_accuracy=0.611] 
100%|██████████| 25/25 [04:03<00:00,  9.32s/epoch, loss=1.08, accuracy=0.582, val_loss=1.04, val_accuracy=0.58]
100%|██████████| 25/25 [04:03<00:00,  9.74s/epoch, loss=1.08, accuracy=0.582, val_loss=1.04, val_accuracy=0.58]
Test score: 0.46129491925239563
Test accuracy: 0.841480016708374


* * * Run SGD for ID = 20_3. * * *


2024-03-01 13:29:11.980322: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:29:15.631950: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:29:15.633322: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-01 13:29:15.676036: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:29:15.676106: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:29:15.679962: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:29:15.680044: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:29:15.682649: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:29:15.683962: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:29:15.686923: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:29:15.688785: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:29:15.695221: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:29:15.696027: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:29:15.696130: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
<__array_function__ internals>:5: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:159: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_train, y_train = np.array(xs[:idx]), np.array(labels[:idx])
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:160: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_test, y_test = np.array(xs[idx:]), np.array(labels[idx:])
2024-03-01 13:29:22.996003: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-01 13:29:22.996667: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:29:22.997925: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:29:22.997984: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:29:22.998058: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:29:22.998088: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:29:22.998114: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:29:22.998149: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:29:22.998177: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:29:22.998203: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:29:22.998230: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:29:22.998926: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:29:22.998978: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:29:23.709590: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-01 13:29:23.709648: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-01 13:29:23.709659: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-01 13:29:23.710811: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:18:00.0, compute capability: 6.1)
{'id': '20_03', 'seed': 3, 'out_folder': 'results/epoch_budget', 'batch_size': 32, 'epochs': 25, 'validation_split': 0.2, 'checkpointing': True, 'initial_lr': 0.1, 'momentum': 0.98, 'nesterov': True, 'bootstrapping': False, 'map_optimizer': True, 'model': 'CNN-LSTM', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Loading data...
Pad sequences (samples x time)
20000 train sequences
5000 validation sequences
25000 test sequences
x_train shape: (20000, 100)
x_val shape: (5000, 100)
x_test shape: (25000, 100)
Using MAP optimizer with reg_weight:  5e-05
CNN-LSTM

0epoch [00:00, ?epoch/s]
  0%|          | 0/25 [00:00<?, ?epoch/s]2024-03-01 13:29:24.197308: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-01 13:29:24.210020: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-03-01 13:29:25.936349: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:29:26.167730: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:29:27.385642: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-01 13:29:27.702334: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.

  4%|▍         | 1/25 [00:23<09:28, 23.70s/epoch, loss=0.64, accuracy=0.664, val_loss=0.494, val_accuracy=0.811]
  8%|▊         | 2/25 [00:32<05:44, 14.96s/epoch, loss=0.463, accuracy=0.832, val_loss=0.446, val_accuracy=0.845]
 12%|█▏        | 3/25 [00:40<04:20, 11.85s/epoch, loss=0.423, accuracy=0.864, val_loss=0.488, val_accuracy=0.838]
 16%|█▌        | 4/25 [00:48<03:38, 10.39s/epoch, loss=0.424, accuracy=0.878, val_loss=0.556, val_accuracy=0.833]
 20%|██        | 5/25 [00:56<03:11,  9.58s/epoch, loss=0.456, accuracy=0.884, val_loss=0.601, val_accuracy=0.824]
 24%|██▍       | 6/25 [01:05<02:53,  9.15s/epoch, loss=0.654, accuracy=0.817, val_loss=0.996, val_accuracy=0.571]
 28%|██▊       | 7/25 [01:13<02:39,  8.85s/epoch, loss=0.995, accuracy=0.649, val_loss=1.09, val_accuracy=0.547] 
 32%|███▏      | 8/25 [01:21<02:27,  8.68s/epoch, loss=1.08, accuracy=0.656, val_loss=1.17, val_accuracy=0.585] 
 36%|███▌      | 9/25 [01:30<02:16,  8.56s/epoch, loss=1.11, accuracy=0.595, val_loss=1.1, val_accuracy=0.574] 
 40%|████      | 10/25 [01:38<02:06,  8.46s/epoch, loss=1.06, accuracy=0.59, val_loss=1.01, val_accuracy=0.626]
 44%|████▍     | 11/25 [01:46<01:57,  8.36s/epoch, loss=0.982, accuracy=0.63, val_loss=0.998, val_accuracy=0.629]
 48%|████▊     | 12/25 [01:54<01:48,  8.37s/epoch, loss=0.984, accuracy=0.62, val_loss=1.06, val_accuracy=0.582] 
 52%|█████▏    | 13/25 [02:03<01:39,  8.32s/epoch, loss=0.998, accuracy=0.586, val_loss=0.983, val_accuracy=0.507]
 56%|█████▌    | 14/25 [02:11<01:31,  8.32s/epoch, loss=0.954, accuracy=0.608, val_loss=0.955, val_accuracy=0.613]
 60%|██████    | 15/25 [02:19<01:22,  8.26s/epoch, loss=0.932, accuracy=0.595, val_loss=0.931, val_accuracy=0.591]
 64%|██████▍   | 16/25 [02:27<01:14,  8.25s/epoch, loss=0.918, accuracy=0.605, val_loss=0.924, val_accuracy=0.61] 
 68%|██████▊   | 17/25 [02:36<01:06,  8.27s/epoch, loss=0.888, accuracy=0.627, val_loss=0.892, val_accuracy=0.618]
 72%|███████▏  | 18/25 [02:44<00:57,  8.22s/epoch, loss=0.895, accuracy=0.619, val_loss=0.896, val_accuracy=0.604]
 76%|███████▌  | 19/25 [02:52<00:49,  8.18s/epoch, loss=0.925, accuracy=0.59, val_loss=0.934, val_accuracy=0.601] 
 80%|████████  | 20/25 [03:00<00:40,  8.18s/epoch, loss=0.956, accuracy=0.565, val_loss=0.981, val_accuracy=0.547]
 84%|████████▍ | 21/25 [03:08<00:32,  8.16s/epoch, loss=0.995, accuracy=0.541, val_loss=0.945, val_accuracy=0.566]
 88%|████████▊ | 22/25 [03:16<00:24,  8.14s/epoch, loss=0.947, accuracy=0.54, val_loss=0.909, val_accuracy=0.507] 
 92%|█████████▏| 23/25 [03:24<00:16,  8.15s/epoch, loss=0.908, accuracy=0.561, val_loss=0.979, val_accuracy=0.533]
 96%|█████████▌| 24/25 [03:33<00:08,  8.19s/epoch, loss=0.92, accuracy=0.58, val_loss=0.941, val_accuracy=0.507]  
100%|██████████| 25/25 [03:41<00:00,  8.22s/epoch, loss=0.923, accuracy=0.58, val_loss=0.929, val_accuracy=0.577]
100%|██████████| 25/25 [03:41<00:00,  8.86s/epoch, loss=0.923, accuracy=0.58, val_loss=0.929, val_accuracy=0.577]
Test score: 0.4372245967388153
Test accuracy: 0.8476399779319763


* * * Run SGD for ID = 20_4. * * *


2024-03-01 13:33:13.695812: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:33:18.586154: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:33:18.587519: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-01 13:33:18.629561: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:33:18.629610: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:33:18.633508: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:33:18.633596: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:33:18.713686: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:33:18.735173: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:33:18.741147: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:33:18.802755: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:33:18.822840: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:33:18.823613: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:33:18.823717: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
<__array_function__ internals>:5: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:159: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_train, y_train = np.array(xs[:idx]), np.array(labels[:idx])
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:160: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_test, y_test = np.array(xs[idx:]), np.array(labels[idx:])
2024-03-01 13:33:25.082711: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-01 13:33:25.083328: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:33:25.083974: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:33:25.084013: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:33:25.084079: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:33:25.084099: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:33:25.084118: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:33:25.084136: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:33:25.084153: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:33:25.084171: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:33:25.084190: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:33:25.084765: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:33:25.084802: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:33:25.995925: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-01 13:33:25.995981: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-01 13:33:25.996001: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-01 13:33:25.997166: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:18:00.0, compute capability: 6.1)
{'id': '20_04', 'seed': 4, 'out_folder': 'results/epoch_budget', 'batch_size': 32, 'epochs': 25, 'validation_split': 0.2, 'checkpointing': True, 'initial_lr': 0.1, 'momentum': 0.98, 'nesterov': True, 'bootstrapping': False, 'map_optimizer': True, 'model': 'CNN-LSTM', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Loading data...
Pad sequences (samples x time)
20000 train sequences
5000 validation sequences
25000 test sequences
x_train shape: (20000, 100)
x_val shape: (5000, 100)
x_test shape: (25000, 100)
Using MAP optimizer with reg_weight:  5e-05
CNN-LSTM

0epoch [00:00, ?epoch/s]
  0%|          | 0/25 [00:00<?, ?epoch/s]2024-03-01 13:33:26.407591: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-01 13:33:26.420021: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-03-01 13:33:27.872684: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:33:28.074106: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:33:29.293335: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-01 13:33:29.338070: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.

  4%|▍         | 1/25 [00:14<05:51, 14.64s/epoch, loss=0.667, accuracy=0.624, val_loss=0.502, val_accuracy=0.808]
  8%|▊         | 2/25 [00:23<04:15, 11.10s/epoch, loss=0.465, accuracy=0.828, val_loss=0.452, val_accuracy=0.834]
 12%|█▏        | 3/25 [00:31<03:37,  9.90s/epoch, loss=0.43, accuracy=0.859, val_loss=0.477, val_accuracy=0.847] 
 16%|█▌        | 4/25 [00:40<03:16,  9.38s/epoch, loss=0.423, accuracy=0.874, val_loss=0.529, val_accuracy=0.848]
 20%|██        | 5/25 [00:48<02:59,  8.98s/epoch, loss=0.444, accuracy=0.883, val_loss=0.555, val_accuracy=0.833]
 24%|██▍       | 6/25 [00:56<02:45,  8.71s/epoch, loss=0.575, accuracy=0.845, val_loss=0.798, val_accuracy=0.774]
 28%|██▊       | 7/25 [01:05<02:33,  8.55s/epoch, loss=0.973, accuracy=0.687, val_loss=1.05, val_accuracy=0.641] 
 32%|███▏      | 8/25 [01:13<02:23,  8.46s/epoch, loss=1.04, accuracy=0.664, val_loss=1.04, val_accuracy=0.66]  
 36%|███▌      | 9/25 [01:21<02:13,  8.37s/epoch, loss=1.08, accuracy=0.649, val_loss=1.04, val_accuracy=0.687]
 40%|████      | 10/25 [01:29<02:04,  8.32s/epoch, loss=1.09, accuracy=0.614, val_loss=1.14, val_accuracy=0.55]
 44%|████▍     | 11/25 [01:37<01:55,  8.26s/epoch, loss=1.08, accuracy=0.612, val_loss=1.09, val_accuracy=0.584]
 48%|████▊     | 12/25 [01:46<01:47,  8.26s/epoch, loss=1.09, accuracy=0.563, val_loss=1.04, val_accuracy=0.553]
 52%|█████▏    | 13/25 [01:54<01:39,  8.29s/epoch, loss=1.03, accuracy=0.548, val_loss=0.971, val_accuracy=0.58]
 56%|█████▌    | 14/25 [02:02<01:31,  8.28s/epoch, loss=0.952, accuracy=0.574, val_loss=0.878, val_accuracy=0.655]
 60%|██████    | 15/25 [02:10<01:22,  8.28s/epoch, loss=0.917, accuracy=0.591, val_loss=0.869, val_accuracy=0.641]
 64%|██████▍   | 16/25 [02:19<01:15,  8.33s/epoch, loss=0.906, accuracy=0.615, val_loss=1.05, val_accuracy=0.576] 
 68%|██████▊   | 17/25 [02:27<01:06,  8.33s/epoch, loss=0.913, accuracy=0.615, val_loss=0.891, val_accuracy=0.634]
 72%|███████▏  | 18/25 [02:35<00:58,  8.29s/epoch, loss=0.902, accuracy=0.619, val_loss=0.903, val_accuracy=0.602]
 76%|███████▌  | 19/25 [02:44<00:49,  8.30s/epoch, loss=0.9, accuracy=0.617, val_loss=0.869, val_accuracy=0.651]  
 80%|████████  | 20/25 [02:52<00:41,  8.27s/epoch, loss=0.874, accuracy=0.623, val_loss=0.856, val_accuracy=0.629]
 84%|████████▍ | 21/25 [03:00<00:32,  8.24s/epoch, loss=0.854, accuracy=0.646, val_loss=0.854, val_accuracy=0.647]
 88%|████████▊ | 22/25 [03:08<00:24,  8.26s/epoch, loss=0.848, accuracy=0.648, val_loss=0.853, val_accuracy=0.642]
 92%|█████████▏| 23/25 [03:17<00:16,  8.28s/epoch, loss=0.841, accuracy=0.664, val_loss=0.876, val_accuracy=0.642]
 96%|█████████▌| 24/25 [03:25<00:08,  8.25s/epoch, loss=0.831, accuracy=0.674, val_loss=0.808, val_accuracy=0.67] 
100%|██████████| 25/25 [03:33<00:00,  8.25s/epoch, loss=0.815, accuracy=0.681, val_loss=0.796, val_accuracy=0.682]
100%|██████████| 25/25 [03:33<00:00,  8.55s/epoch, loss=0.815, accuracy=0.681, val_loss=0.796, val_accuracy=0.682]
Test score: 0.5496227741241455
Test accuracy: 0.8396400213241577


* * * Run SGD for ID = 20_5. * * *


2024-03-01 13:37:08.735867: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:37:11.979972: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:37:11.981381: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-01 13:37:12.023201: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:37:12.023246: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:37:12.026753: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:37:12.026823: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:37:12.029392: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:37:12.030207: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:37:12.032834: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:37:12.034590: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:37:12.040198: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:37:12.040930: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:37:12.041031: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
<__array_function__ internals>:5: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:159: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_train, y_train = np.array(xs[:idx]), np.array(labels[:idx])
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:160: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_test, y_test = np.array(xs[idx:]), np.array(labels[idx:])
2024-03-01 13:37:18.314630: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-01 13:37:18.315227: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:37:18.315984: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:37:18.316022: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:37:18.316084: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:37:18.316104: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:37:18.316123: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:37:18.316142: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:37:18.316158: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:37:18.316176: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:37:18.316194: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:37:18.316745: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:37:18.316782: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:37:18.908211: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-01 13:37:18.908267: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-01 13:37:18.908280: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-01 13:37:18.909423: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:18:00.0, compute capability: 6.1)
{'id': '20_05', 'seed': 5, 'out_folder': 'results/epoch_budget', 'batch_size': 32, 'epochs': 25, 'validation_split': 0.2, 'checkpointing': True, 'initial_lr': 0.1, 'momentum': 0.98, 'nesterov': True, 'bootstrapping': False, 'map_optimizer': True, 'model': 'CNN-LSTM', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Loading data...
Pad sequences (samples x time)
20000 train sequences
5000 validation sequences
25000 test sequences
x_train shape: (20000, 100)
x_val shape: (5000, 100)
x_test shape: (25000, 100)
Using MAP optimizer with reg_weight:  5e-05
CNN-LSTM

0epoch [00:00, ?epoch/s]
  0%|          | 0/25 [00:00<?, ?epoch/s]2024-03-01 13:37:19.316874: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-01 13:37:19.328951: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-03-01 13:37:20.779181: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:37:20.975704: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:37:21.731310: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-01 13:37:21.775917: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.

  4%|▍         | 1/25 [00:14<05:39, 14.14s/epoch, loss=0.731, accuracy=0.54, val_loss=0.624, val_accuracy=0.717]
  8%|▊         | 2/25 [00:23<04:17, 11.18s/epoch, loss=0.534, accuracy=0.777, val_loss=0.491, val_accuracy=0.809]
 12%|█▏        | 3/25 [00:33<03:52, 10.57s/epoch, loss=0.471, accuracy=0.835, val_loss=0.517, val_accuracy=0.815]
 16%|█▌        | 4/25 [00:41<03:24,  9.72s/epoch, loss=0.522, accuracy=0.834, val_loss=0.637, val_accuracy=0.802]
 20%|██        | 5/25 [00:49<03:04,  9.22s/epoch, loss=0.743, accuracy=0.763, val_loss=0.895, val_accuracy=0.719]
 24%|██▍       | 6/25 [00:58<02:49,  8.91s/epoch, loss=0.988, accuracy=0.673, val_loss=1.07, val_accuracy=0.631] 
 28%|██▊       | 7/25 [01:06<02:37,  8.73s/epoch, loss=1.09, accuracy=0.621, val_loss=1.2, val_accuracy=0.597]  
 32%|███▏      | 8/25 [01:14<02:25,  8.57s/epoch, loss=1.05, accuracy=0.603, val_loss=1, val_accuracy=0.603]  
 36%|███▌      | 9/25 [01:22<02:15,  8.46s/epoch, loss=0.992, accuracy=0.592, val_loss=0.982, val_accuracy=0.508]
 40%|████      | 10/25 [01:31<02:06,  8.41s/epoch, loss=0.946, accuracy=0.589, val_loss=1, val_accuracy=0.528]   
 44%|████▍     | 11/25 [01:39<01:56,  8.36s/epoch, loss=0.892, accuracy=0.625, val_loss=0.847, val_accuracy=0.697]
 48%|████▊     | 12/25 [01:47<01:47,  8.30s/epoch, loss=0.878, accuracy=0.652, val_loss=0.918, val_accuracy=0.636]
 52%|█████▏    | 13/25 [01:55<01:39,  8.26s/epoch, loss=0.923, accuracy=0.628, val_loss=0.956, val_accuracy=0.57] 
 56%|█████▌    | 14/25 [02:03<01:30,  8.24s/epoch, loss=0.924, accuracy=0.622, val_loss=0.892, val_accuracy=0.64]
 60%|██████    | 15/25 [02:12<01:22,  8.26s/epoch, loss=0.899, accuracy=0.633, val_loss=0.915, val_accuracy=0.615]
 64%|██████▍   | 16/25 [02:20<01:14,  8.30s/epoch, loss=0.906, accuracy=0.635, val_loss=0.901, val_accuracy=0.651]
 68%|██████▊   | 17/25 [02:28<01:06,  8.28s/epoch, loss=0.939, accuracy=0.603, val_loss=0.985, val_accuracy=0.567]
 72%|███████▏  | 18/25 [02:37<00:57,  8.26s/epoch, loss=0.92, accuracy=0.608, val_loss=0.885, val_accuracy=0.607] 
 76%|███████▌  | 19/25 [02:45<00:50,  8.37s/epoch, loss=0.898, accuracy=0.609, val_loss=0.972, val_accuracy=0.582]
 80%|████████  | 20/25 [02:54<00:41,  8.34s/epoch, loss=0.873, accuracy=0.612, val_loss=0.872, val_accuracy=0.562]
 84%|████████▍ | 21/25 [03:02<00:33,  8.28s/epoch, loss=0.867, accuracy=0.609, val_loss=0.86, val_accuracy=0.596] 
 88%|████████▊ | 22/25 [03:10<00:24,  8.26s/epoch, loss=0.859, accuracy=0.624, val_loss=0.863, val_accuracy=0.615]
 92%|█████████▏| 23/25 [03:18<00:16,  8.31s/epoch, loss=0.818, accuracy=0.648, val_loss=0.833, val_accuracy=0.607]
 96%|█████████▌| 24/25 [03:27<00:08,  8.33s/epoch, loss=0.808, accuracy=0.665, val_loss=0.844, val_accuracy=0.63] 
100%|██████████| 25/25 [03:35<00:00,  8.30s/epoch, loss=0.823, accuracy=0.65, val_loss=0.867, val_accuracy=0.602]
100%|██████████| 25/25 [03:35<00:00,  8.62s/epoch, loss=0.823, accuracy=0.65, val_loss=0.867, val_accuracy=0.602]
Test score: 0.5060105323791504
Test accuracy: 0.8234800100326538


* * * Run SGD for ID = 20_6. * * *


2024-03-01 13:41:02.677948: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:41:05.916280: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:41:05.917559: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-01 13:41:05.960566: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:41:05.960609: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:41:05.964110: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:41:05.964175: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:41:05.966572: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:41:05.967427: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:41:05.970242: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:41:05.972084: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:41:05.977703: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:41:05.978480: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:41:05.978582: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
<__array_function__ internals>:5: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:159: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_train, y_train = np.array(xs[:idx]), np.array(labels[:idx])
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:160: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_test, y_test = np.array(xs[idx:]), np.array(labels[idx:])
2024-03-01 13:41:12.250038: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-01 13:41:12.250675: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:41:12.251311: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:41:12.251365: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:41:12.251442: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:41:12.251471: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:41:12.251499: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:41:12.251529: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:41:12.251555: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:41:12.251583: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:41:12.251611: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:41:12.252226: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:41:12.252267: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:41:12.839009: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-01 13:41:12.839063: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-01 13:41:12.839074: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-01 13:41:12.840212: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:18:00.0, compute capability: 6.1)
{'id': '20_06', 'seed': 6, 'out_folder': 'results/epoch_budget', 'batch_size': 32, 'epochs': 25, 'validation_split': 0.2, 'checkpointing': True, 'initial_lr': 0.1, 'momentum': 0.98, 'nesterov': True, 'bootstrapping': False, 'map_optimizer': True, 'model': 'CNN-LSTM', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Loading data...
Pad sequences (samples x time)
20000 train sequences
5000 validation sequences
25000 test sequences
x_train shape: (20000, 100)
x_val shape: (5000, 100)
x_test shape: (25000, 100)
Using MAP optimizer with reg_weight:  5e-05
CNN-LSTM

0epoch [00:00, ?epoch/s]
  0%|          | 0/25 [00:00<?, ?epoch/s]2024-03-01 13:41:13.244461: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-01 13:41:13.257015: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-03-01 13:41:14.696027: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:41:14.892236: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:41:15.650467: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-01 13:41:15.705395: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.

  4%|▍         | 1/25 [00:14<05:59, 14.96s/epoch, loss=0.634, accuracy=0.661, val_loss=0.479, val_accuracy=0.818]
  8%|▊         | 2/25 [00:24<04:36, 12.04s/epoch, loss=0.46, accuracy=0.835, val_loss=0.443, val_accuracy=0.84]  
 12%|█▏        | 3/25 [00:33<03:50, 10.47s/epoch, loss=0.423, accuracy=0.866, val_loss=0.484, val_accuracy=0.845]
 16%|█▌        | 4/25 [00:41<03:22,  9.63s/epoch, loss=0.413, accuracy=0.882, val_loss=0.524, val_accuracy=0.84] 
 20%|██        | 5/25 [00:50<03:02,  9.11s/epoch, loss=0.42, accuracy=0.895, val_loss=0.593, val_accuracy=0.841]
 24%|██▍       | 6/25 [00:58<02:47,  8.82s/epoch, loss=0.529, accuracy=0.868, val_loss=0.705, val_accuracy=0.812]
 28%|██▊       | 7/25 [01:06<02:34,  8.59s/epoch, loss=0.936, accuracy=0.699, val_loss=1.11, val_accuracy=0.622] 
 32%|███▏      | 8/25 [01:14<02:24,  8.49s/epoch, loss=1.11, accuracy=0.572, val_loss=1.15, val_accuracy=0.513] 
 36%|███▌      | 9/25 [01:22<02:14,  8.39s/epoch, loss=1.06, accuracy=0.585, val_loss=0.992, val_accuracy=0.627]
 40%|████      | 10/25 [01:31<02:05,  8.35s/epoch, loss=1.01, accuracy=0.58, val_loss=1.07, val_accuracy=0.574] 
 44%|████▍     | 11/25 [01:39<01:56,  8.33s/epoch, loss=0.994, accuracy=0.563, val_loss=0.994, val_accuracy=0.556]
 48%|████▊     | 12/25 [01:47<01:47,  8.29s/epoch, loss=0.979, accuracy=0.544, val_loss=1.11, val_accuracy=0.488] 
 52%|█████▏    | 13/25 [01:55<01:39,  8.27s/epoch, loss=0.94, accuracy=0.551, val_loss=0.867, val_accuracy=0.609]
 56%|█████▌    | 14/25 [02:04<01:30,  8.26s/epoch, loss=0.869, accuracy=0.604, val_loss=0.853, val_accuracy=0.597]
 60%|██████    | 15/25 [02:12<01:22,  8.27s/epoch, loss=0.864, accuracy=0.599, val_loss=0.923, val_accuracy=0.585]
 64%|██████▍   | 16/25 [02:20<01:14,  8.27s/epoch, loss=0.873, accuracy=0.589, val_loss=0.864, val_accuracy=0.59] 
 68%|██████▊   | 17/25 [02:28<01:06,  8.29s/epoch, loss=0.89, accuracy=0.61, val_loss=0.941, val_accuracy=0.556] 
 72%|███████▏  | 18/25 [02:37<00:57,  8.26s/epoch, loss=0.922, accuracy=0.571, val_loss=0.885, val_accuracy=0.587]
 76%|███████▌  | 19/25 [02:45<00:49,  8.25s/epoch, loss=0.88, accuracy=0.58, val_loss=0.816, val_accuracy=0.623]  
 80%|████████  | 20/25 [02:53<00:41,  8.21s/epoch, loss=0.829, accuracy=0.641, val_loss=0.817, val_accuracy=0.646]
 84%|████████▍ | 21/25 [03:01<00:32,  8.22s/epoch, loss=0.843, accuracy=0.633, val_loss=0.891, val_accuracy=0.61] 
 88%|████████▊ | 22/25 [03:09<00:24,  8.22s/epoch, loss=0.856, accuracy=0.631, val_loss=0.826, val_accuracy=0.611]
 92%|█████████▏| 23/25 [03:18<00:16,  8.25s/epoch, loss=0.834, accuracy=0.646, val_loss=1.36, val_accuracy=0.572] 
 96%|█████████▌| 24/25 [03:26<00:08,  8.29s/epoch, loss=0.869, accuracy=0.672, val_loss=0.989, val_accuracy=0.638]
100%|██████████| 25/25 [03:35<00:00,  8.33s/epoch, loss=1, accuracy=0.654, val_loss=0.995, val_accuracy=0.634]    
100%|██████████| 25/25 [03:35<00:00,  8.60s/epoch, loss=1, accuracy=0.654, val_loss=0.995, val_accuracy=0.634]
Test score: 0.48250624537467957
Test accuracy: 0.8420799970626831


* * * Run SGD for ID = 20_7. * * *


2024-03-01 13:44:56.292695: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:44:59.624113: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:44:59.625443: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-01 13:44:59.667822: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:44:59.667871: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:44:59.671344: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:44:59.671416: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:44:59.673979: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:44:59.674727: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:44:59.677349: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:44:59.679183: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:44:59.684621: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:44:59.685330: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:44:59.685428: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
<__array_function__ internals>:5: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:159: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_train, y_train = np.array(xs[:idx]), np.array(labels[:idx])
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:160: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_test, y_test = np.array(xs[idx:]), np.array(labels[idx:])
2024-03-01 13:45:06.035763: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-01 13:45:06.036381: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:45:06.037030: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:45:06.037071: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:45:06.037133: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:45:06.037160: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:45:06.037185: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:45:06.037210: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:45:06.037233: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:45:06.037258: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:45:06.037283: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:45:06.037877: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:45:06.037930: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:45:06.632003: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-01 13:45:06.632060: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-01 13:45:06.632072: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-01 13:45:06.633215: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:18:00.0, compute capability: 6.1)
{'id': '20_07', 'seed': 7, 'out_folder': 'results/epoch_budget', 'batch_size': 32, 'epochs': 25, 'validation_split': 0.2, 'checkpointing': True, 'initial_lr': 0.1, 'momentum': 0.98, 'nesterov': True, 'bootstrapping': False, 'map_optimizer': True, 'model': 'CNN-LSTM', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Loading data...
Pad sequences (samples x time)
20000 train sequences
5000 validation sequences
25000 test sequences
x_train shape: (20000, 100)
x_val shape: (5000, 100)
x_test shape: (25000, 100)
Using MAP optimizer with reg_weight:  5e-05
CNN-LSTM

0epoch [00:00, ?epoch/s]
  0%|          | 0/25 [00:00<?, ?epoch/s]2024-03-01 13:45:07.045069: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-01 13:45:07.057013: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-03-01 13:45:08.512311: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:45:08.713314: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:45:09.545214: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-01 13:45:09.694966: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.

  4%|▍         | 1/25 [00:16<06:44, 16.84s/epoch, loss=0.697, accuracy=0.594, val_loss=0.524, val_accuracy=0.783]
  8%|▊         | 2/25 [00:26<04:47, 12.49s/epoch, loss=0.48, accuracy=0.819, val_loss=0.468, val_accuracy=0.838] 
 12%|█▏        | 3/25 [00:35<03:59, 10.88s/epoch, loss=0.432, accuracy=0.855, val_loss=0.468, val_accuracy=0.844]
 16%|█▌        | 4/25 [00:43<03:26,  9.85s/epoch, loss=0.422, accuracy=0.873, val_loss=0.55, val_accuracy=0.813] 
 20%|██        | 5/25 [00:51<03:05,  9.29s/epoch, loss=0.454, accuracy=0.877, val_loss=0.618, val_accuracy=0.814]
 24%|██▍       | 6/25 [01:00<02:49,  8.93s/epoch, loss=0.511, accuracy=0.872, val_loss=0.625, val_accuracy=0.831]
 28%|██▊       | 7/25 [01:08<02:37,  8.76s/epoch, loss=0.82, accuracy=0.754, val_loss=1.01, val_accuracy=0.664]  
 32%|███▏      | 8/25 [01:16<02:26,  8.64s/epoch, loss=1.03, accuracy=0.649, val_loss=1.05, val_accuracy=0.656]
 36%|███▌      | 9/25 [01:25<02:16,  8.52s/epoch, loss=1.07, accuracy=0.642, val_loss=1.19, val_accuracy=0.572]
 40%|████      | 10/25 [01:33<02:06,  8.47s/epoch, loss=1.15, accuracy=0.563, val_loss=1.16, val_accuracy=0.529]
 44%|████▍     | 11/25 [01:41<01:57,  8.38s/epoch, loss=1.15, accuracy=0.539, val_loss=1.11, val_accuracy=0.532]
 48%|████▊     | 12/25 [01:49<01:47,  8.28s/epoch, loss=1.06, accuracy=0.552, val_loss=1.01, val_accuracy=0.498]
 52%|█████▏    | 13/25 [01:57<01:39,  8.27s/epoch, loss=1, accuracy=0.535, val_loss=0.985, val_accuracy=0.502]  
 56%|█████▌    | 14/25 [02:06<01:31,  8.29s/epoch, loss=0.949, accuracy=0.538, val_loss=0.895, val_accuracy=0.54]
 60%|██████    | 15/25 [02:14<01:23,  8.31s/epoch, loss=0.901, accuracy=0.554, val_loss=0.889, val_accuracy=0.592]
 64%|██████▍   | 16/25 [02:22<01:14,  8.26s/epoch, loss=0.84, accuracy=0.618, val_loss=0.871, val_accuracy=0.586] 
 68%|██████▊   | 17/25 [02:30<01:05,  8.24s/epoch, loss=0.891, accuracy=0.602, val_loss=0.884, val_accuracy=0.594]
 72%|███████▏  | 18/25 [02:39<00:57,  8.23s/epoch, loss=0.929, accuracy=0.572, val_loss=0.884, val_accuracy=0.616]
 76%|███████▌  | 19/25 [02:47<00:49,  8.23s/epoch, loss=0.928, accuracy=0.573, val_loss=0.965, val_accuracy=0.502]
 80%|████████  | 20/25 [02:55<00:41,  8.25s/epoch, loss=0.916, accuracy=0.557, val_loss=0.926, val_accuracy=0.589]
 84%|████████▍ | 21/25 [03:03<00:33,  8.27s/epoch, loss=0.929, accuracy=0.557, val_loss=0.898, val_accuracy=0.584]
 88%|████████▊ | 22/25 [03:12<00:24,  8.27s/epoch, loss=0.906, accuracy=0.569, val_loss=0.88, val_accuracy=0.591] 
 92%|█████████▏| 23/25 [03:20<00:16,  8.25s/epoch, loss=0.899, accuracy=0.562, val_loss=0.884, val_accuracy=0.614]
 96%|█████████▌| 24/25 [03:28<00:08,  8.28s/epoch, loss=0.907, accuracy=0.563, val_loss=0.877, val_accuracy=0.583]
100%|██████████| 25/25 [03:37<00:00,  8.31s/epoch, loss=0.882, accuracy=0.594, val_loss=0.869, val_accuracy=0.609]
100%|██████████| 25/25 [03:37<00:00,  8.69s/epoch, loss=0.882, accuracy=0.594, val_loss=0.869, val_accuracy=0.609]
Test score: 0.46419504284858704
Test accuracy: 0.8368399739265442


* * * Run SGD for ID = 20_8. * * *


2024-03-01 13:48:52.698365: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:48:56.004594: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:48:56.005989: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-01 13:48:56.048592: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:48:56.048641: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:48:56.052379: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:48:56.052461: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:48:56.055254: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:48:56.056043: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:48:56.059081: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:48:56.060894: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:48:56.067095: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:48:56.067835: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:48:56.067964: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
<__array_function__ internals>:5: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:159: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_train, y_train = np.array(xs[:idx]), np.array(labels[:idx])
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:160: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_test, y_test = np.array(xs[idx:]), np.array(labels[idx:])
2024-03-01 13:49:02.738433: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-01 13:49:02.739136: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:49:02.740387: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:49:02.740429: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:49:02.740495: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:49:02.740534: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:49:02.740560: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:49:02.740586: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:49:02.740604: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:49:02.740628: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:49:02.740656: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:49:02.741276: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:49:02.741324: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:49:03.330388: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-01 13:49:03.330451: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-01 13:49:03.330462: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-01 13:49:03.331648: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:18:00.0, compute capability: 6.1)
{'id': '20_08', 'seed': 8, 'out_folder': 'results/epoch_budget', 'batch_size': 32, 'epochs': 25, 'validation_split': 0.2, 'checkpointing': True, 'initial_lr': 0.1, 'momentum': 0.98, 'nesterov': True, 'bootstrapping': False, 'map_optimizer': True, 'model': 'CNN-LSTM', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Loading data...
Pad sequences (samples x time)
20000 train sequences
5000 validation sequences
25000 test sequences
x_train shape: (20000, 100)
x_val shape: (5000, 100)
x_test shape: (25000, 100)
Using MAP optimizer with reg_weight:  5e-05
CNN-LSTM

0epoch [00:00, ?epoch/s]
  0%|          | 0/25 [00:00<?, ?epoch/s]2024-03-01 13:49:03.743017: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-01 13:49:03.755038: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-03-01 13:49:05.191167: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:49:05.406896: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:49:06.179591: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-01 13:49:06.231257: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.

  4%|▍         | 1/25 [00:18<07:13, 18.05s/epoch, loss=0.732, accuracy=0.546, val_loss=0.624, val_accuracy=0.708]
  8%|▊         | 2/25 [00:29<05:23, 14.07s/epoch, loss=0.5, accuracy=0.799, val_loss=0.494, val_accuracy=0.813]  
 12%|█▏        | 3/25 [00:37<04:09, 11.36s/epoch, loss=0.432, accuracy=0.852, val_loss=0.543, val_accuracy=0.799]
 16%|█▌        | 4/25 [00:46<03:35, 10.27s/epoch, loss=0.418, accuracy=0.872, val_loss=0.507, val_accuracy=0.841]
 20%|██        | 5/25 [00:54<03:09,  9.50s/epoch, loss=0.418, accuracy=0.887, val_loss=0.561, val_accuracy=0.821]
 24%|██▍       | 6/25 [01:02<02:52,  9.05s/epoch, loss=0.432, accuracy=0.892, val_loss=0.613, val_accuracy=0.831]
 28%|██▊       | 7/25 [01:10<02:38,  8.79s/epoch, loss=0.499, accuracy=0.887, val_loss=0.702, val_accuracy=0.8]  
 32%|███▏      | 8/25 [01:18<02:26,  8.60s/epoch, loss=0.722, accuracy=0.815, val_loss=0.976, val_accuracy=0.701]
 36%|███▌      | 9/25 [01:26<02:14,  8.40s/epoch, loss=1.08, accuracy=0.611, val_loss=1.08, val_accuracy=0.584]  
 40%|████      | 10/25 [01:34<02:03,  8.27s/epoch, loss=1.06, accuracy=0.6, val_loss=1.11, val_accuracy=0.568] 
 44%|████▍     | 11/25 [01:42<01:55,  8.21s/epoch, loss=1.03, accuracy=0.584, val_loss=1, val_accuracy=0.512] 
 48%|████▊     | 12/25 [01:51<01:46,  8.21s/epoch, loss=0.932, accuracy=0.627, val_loss=0.902, val_accuracy=0.635]
 52%|█████▏    | 13/25 [01:59<01:38,  8.18s/epoch, loss=0.89, accuracy=0.665, val_loss=1.1, val_accuracy=0.562]   
 56%|█████▌    | 14/25 [02:07<01:30,  8.18s/epoch, loss=0.915, accuracy=0.64, val_loss=0.94, val_accuracy=0.663]
 60%|██████    | 15/25 [02:15<01:22,  8.20s/epoch, loss=0.948, accuracy=0.658, val_loss=1.11, val_accuracy=0.59]
 64%|██████▍   | 16/25 [02:23<01:13,  8.14s/epoch, loss=1.02, accuracy=0.618, val_loss=1.01, val_accuracy=0.583]
 68%|██████▊   | 17/25 [02:31<01:05,  8.14s/epoch, loss=1.01, accuracy=0.574, val_loss=0.98, val_accuracy=0.579]
 72%|███████▏  | 18/25 [02:39<00:56,  8.14s/epoch, loss=0.965, accuracy=0.61, val_loss=0.962, val_accuracy=0.61]
 76%|███████▌  | 19/25 [02:48<00:49,  8.18s/epoch, loss=0.978, accuracy=0.598, val_loss=0.929, val_accuracy=0.625]
 80%|████████  | 20/25 [02:56<00:41,  8.23s/epoch, loss=0.941, accuracy=0.62, val_loss=0.961, val_accuracy=0.616] 
 84%|████████▍ | 21/25 [03:04<00:32,  8.17s/epoch, loss=0.993, accuracy=0.562, val_loss=0.975, val_accuracy=0.555]
 88%|████████▊ | 22/25 [03:12<00:24,  8.13s/epoch, loss=0.946, accuracy=0.573, val_loss=0.893, val_accuracy=0.622]
 92%|█████████▏| 23/25 [03:20<00:16,  8.11s/epoch, loss=1.04, accuracy=0.581, val_loss=1.04, val_accuracy=0.621]  
 96%|█████████▌| 24/25 [03:28<00:08,  8.08s/epoch, loss=1.01, accuracy=0.641, val_loss=0.957, val_accuracy=0.679]
100%|██████████| 25/25 [03:36<00:00,  8.06s/epoch, loss=0.962, accuracy=0.663, val_loss=1.16, val_accuracy=0.615]
100%|██████████| 25/25 [03:36<00:00,  8.67s/epoch, loss=0.962, accuracy=0.663, val_loss=1.16, val_accuracy=0.615]
Test score: 0.49429604411125183
Test accuracy: 0.8445199728012085


* * * Run SGD for ID = 20_9. * * *


2024-03-01 13:52:48.241948: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:52:51.499264: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:52:51.500591: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-01 13:52:51.540850: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:52:51.540898: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:52:51.544537: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:52:51.544608: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:52:51.547426: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:52:51.548644: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:52:51.551541: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:52:51.553703: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:52:51.559761: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:52:51.560515: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:52:51.560623: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
<__array_function__ internals>:5: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:159: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_train, y_train = np.array(xs[:idx]), np.array(labels[:idx])
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:160: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_test, y_test = np.array(xs[idx:]), np.array(labels[idx:])
2024-03-01 13:52:58.163098: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-01 13:52:58.163677: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:52:58.164790: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:52:58.164850: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:52:58.164921: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:52:58.164946: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:52:58.164969: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:52:58.164991: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:52:58.165013: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:52:58.165035: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:52:58.165058: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:52:58.165625: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:52:58.165661: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:52:58.743933: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-01 13:52:58.743994: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-01 13:52:58.744013: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-01 13:52:58.745107: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:18:00.0, compute capability: 6.1)
{'id': '20_09', 'seed': 9, 'out_folder': 'results/epoch_budget', 'batch_size': 32, 'epochs': 25, 'validation_split': 0.2, 'checkpointing': True, 'initial_lr': 0.1, 'momentum': 0.98, 'nesterov': True, 'bootstrapping': False, 'map_optimizer': True, 'model': 'CNN-LSTM', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Loading data...
Pad sequences (samples x time)
20000 train sequences
5000 validation sequences
25000 test sequences
x_train shape: (20000, 100)
x_val shape: (5000, 100)
x_test shape: (25000, 100)
Using MAP optimizer with reg_weight:  5e-05
CNN-LSTM

0epoch [00:00, ?epoch/s]
  0%|          | 0/25 [00:00<?, ?epoch/s]2024-03-01 13:52:59.134081: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-01 13:52:59.146021: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-03-01 13:53:00.581305: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:53:00.783617: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:53:01.542499: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-01 13:53:01.590672: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.

  4%|▍         | 1/25 [00:14<05:47, 14.46s/epoch, loss=0.677, accuracy=0.613, val_loss=0.496, val_accuracy=0.806]
  8%|▊         | 2/25 [00:24<04:30, 11.78s/epoch, loss=0.478, accuracy=0.821, val_loss=0.504, val_accuracy=0.819]
 12%|█▏        | 3/25 [00:32<03:43, 10.16s/epoch, loss=0.418, accuracy=0.864, val_loss=0.476, val_accuracy=0.839]
 16%|█▌        | 4/25 [00:40<03:17,  9.42s/epoch, loss=0.407, accuracy=0.886, val_loss=0.516, val_accuracy=0.839]
 20%|██        | 5/25 [00:48<02:56,  8.84s/epoch, loss=0.416, accuracy=0.89, val_loss=0.588, val_accuracy=0.831] 
 24%|██▍       | 6/25 [00:56<02:41,  8.51s/epoch, loss=0.452, accuracy=0.892, val_loss=0.629, val_accuracy=0.837]
 28%|██▊       | 7/25 [01:04<02:29,  8.32s/epoch, loss=0.578, accuracy=0.861, val_loss=0.812, val_accuracy=0.776]
 32%|███▏      | 8/25 [01:12<02:19,  8.19s/epoch, loss=0.908, accuracy=0.752, val_loss=1.08, val_accuracy=0.678] 
 36%|███▌      | 9/25 [01:20<02:09,  8.11s/epoch, loss=1.15, accuracy=0.64, val_loss=1.27, val_accuracy=0.569]  
 40%|████      | 10/25 [01:28<02:00,  8.07s/epoch, loss=1.2, accuracy=0.624, val_loss=1.2, val_accuracy=0.604]
 44%|████▍     | 11/25 [01:36<01:52,  8.05s/epoch, loss=1.23, accuracy=0.573, val_loss=1.21, val_accuracy=0.55]
 48%|████▊     | 12/25 [01:44<01:44,  8.02s/epoch, loss=1.16, accuracy=0.547, val_loss=1.1, val_accuracy=0.576]
 52%|█████▏    | 13/25 [01:52<01:36,  8.01s/epoch, loss=1.07, accuracy=0.565, val_loss=1.02, val_accuracy=0.538]
 56%|█████▌    | 14/25 [02:00<01:27,  7.97s/epoch, loss=1.01, accuracy=0.575, val_loss=1.01, val_accuracy=0.572]
 60%|██████    | 15/25 [02:08<01:19,  7.98s/epoch, loss=0.988, accuracy=0.553, val_loss=0.961, val_accuracy=0.561]
 64%|██████▍   | 16/25 [02:15<01:11,  7.93s/epoch, loss=0.931, accuracy=0.56, val_loss=1, val_accuracy=0.556]     
 68%|██████▊   | 17/25 [02:24<01:03,  7.96s/epoch, loss=0.897, accuracy=0.581, val_loss=0.907, val_accuracy=0.516]
 72%|███████▏  | 18/25 [02:31<00:55,  7.96s/epoch, loss=0.863, accuracy=0.601, val_loss=0.82, val_accuracy=0.662] 
 76%|███████▌  | 19/25 [02:39<00:47,  7.95s/epoch, loss=0.866, accuracy=0.59, val_loss=0.858, val_accuracy=0.577]
 80%|████████  | 20/25 [02:47<00:39,  7.97s/epoch, loss=0.865, accuracy=0.597, val_loss=0.854, val_accuracy=0.618]
 84%|████████▍ | 21/25 [02:55<00:31,  7.94s/epoch, loss=0.848, accuracy=0.598, val_loss=0.832, val_accuracy=0.634]
 88%|████████▊ | 22/25 [03:03<00:23,  7.92s/epoch, loss=0.848, accuracy=0.609, val_loss=0.868, val_accuracy=0.605]
 92%|█████████▏| 23/25 [03:11<00:15,  7.93s/epoch, loss=0.853, accuracy=0.623, val_loss=0.845, val_accuracy=0.64] 
 96%|█████████▌| 24/25 [03:19<00:07,  7.97s/epoch, loss=0.841, accuracy=0.652, val_loss=0.905, val_accuracy=0.641]
100%|██████████| 25/25 [03:27<00:00,  7.96s/epoch, loss=0.889, accuracy=0.629, val_loss=0.961, val_accuracy=0.574]
100%|██████████| 25/25 [03:27<00:00,  8.30s/epoch, loss=0.889, accuracy=0.629, val_loss=0.961, val_accuracy=0.574]
Test score: 0.5117350220680237
Test accuracy: 0.841159999370575


* * * Run SGD for ID = 20_10. * * *


2024-03-01 13:56:34.983457: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:56:38.296778: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:56:38.298046: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-01 13:56:38.340328: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:56:38.340382: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:56:38.343968: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:56:38.344038: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:56:38.346779: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:56:38.347653: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:56:38.350605: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:56:38.352415: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:56:38.358322: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:56:38.359059: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:56:38.359166: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
<__array_function__ internals>:5: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:159: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_train, y_train = np.array(xs[:idx]), np.array(labels[:idx])
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:160: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_test, y_test = np.array(xs[idx:]), np.array(labels[idx:])
2024-03-01 13:56:45.205182: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-01 13:56:45.205881: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 13:56:45.207310: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 13:56:45.207359: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:56:45.207465: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:56:45.207493: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 13:56:45.207517: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 13:56:45.207542: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 13:56:45.207573: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 13:56:45.207598: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 13:56:45.207623: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:56:45.208255: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 13:56:45.208305: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 13:56:45.832753: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-01 13:56:45.832807: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-01 13:56:45.832819: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-01 13:56:45.834022: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:18:00.0, compute capability: 6.1)
{'id': '20_10', 'seed': 10, 'out_folder': 'results/epoch_budget', 'batch_size': 32, 'epochs': 25, 'validation_split': 0.2, 'checkpointing': True, 'initial_lr': 0.1, 'momentum': 0.98, 'nesterov': True, 'bootstrapping': False, 'map_optimizer': True, 'model': 'CNN-LSTM', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Loading data...
Pad sequences (samples x time)
20000 train sequences
5000 validation sequences
25000 test sequences
x_train shape: (20000, 100)
x_val shape: (5000, 100)
x_test shape: (25000, 100)
Using MAP optimizer with reg_weight:  5e-05
CNN-LSTM

0epoch [00:00, ?epoch/s]
  0%|          | 0/25 [00:00<?, ?epoch/s]2024-03-01 13:56:46.265313: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-01 13:56:46.278029: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-03-01 13:56:47.765738: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 13:56:47.968616: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 13:56:48.749599: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-01 13:56:48.804076: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.

  4%|▍         | 1/25 [00:14<05:42, 14.28s/epoch, loss=0.647, accuracy=0.657, val_loss=0.488, val_accuracy=0.81]
  8%|▊         | 2/25 [00:22<04:11, 10.96s/epoch, loss=0.456, accuracy=0.834, val_loss=0.474, val_accuracy=0.84]
 12%|█▏        | 3/25 [00:30<03:31,  9.62s/epoch, loss=0.419, accuracy=0.868, val_loss=0.528, val_accuracy=0.819]
 16%|█▌        | 4/25 [00:39<03:10,  9.05s/epoch, loss=0.426, accuracy=0.878, val_loss=0.556, val_accuracy=0.833]
 20%|██        | 5/25 [00:47<02:54,  8.71s/epoch, loss=0.445, accuracy=0.888, val_loss=0.64, val_accuracy=0.823] 
 24%|██▍       | 6/25 [00:55<02:41,  8.48s/epoch, loss=0.505, accuracy=0.879, val_loss=0.704, val_accuracy=0.801]
 28%|██▊       | 7/25 [01:03<02:30,  8.36s/epoch, loss=0.678, accuracy=0.834, val_loss=0.893, val_accuracy=0.75] 
 32%|███▏      | 8/25 [01:11<02:20,  8.26s/epoch, loss=1.01, accuracy=0.707, val_loss=1.13, val_accuracy=0.559] 
 36%|███▌      | 9/25 [01:19<02:11,  8.20s/epoch, loss=1.13, accuracy=0.618, val_loss=1.13, val_accuracy=0.621]
 40%|████      | 10/25 [01:27<02:02,  8.18s/epoch, loss=1.16, accuracy=0.576, val_loss=1.12, val_accuracy=0.579]
 44%|████▍     | 11/25 [01:35<01:54,  8.21s/epoch, loss=1.09, accuracy=0.565, val_loss=1.05, val_accuracy=0.586]
 48%|████▊     | 12/25 [01:44<01:46,  8.22s/epoch, loss=1.03, accuracy=0.558, val_loss=0.977, val_accuracy=0.594]
 52%|█████▏    | 13/25 [01:52<01:37,  8.16s/epoch, loss=0.95, accuracy=0.566, val_loss=0.894, val_accuracy=0.647]
 56%|█████▌    | 14/25 [02:00<01:29,  8.12s/epoch, loss=0.912, accuracy=0.605, val_loss=0.934, val_accuracy=0.516]
 60%|██████    | 15/25 [02:08<01:20,  8.08s/epoch, loss=0.906, accuracy=0.599, val_loss=0.926, val_accuracy=0.582]
 64%|██████▍   | 16/25 [02:16<01:12,  8.11s/epoch, loss=0.907, accuracy=0.591, val_loss=0.931, val_accuracy=0.532]
 68%|██████▊   | 17/25 [02:24<01:05,  8.13s/epoch, loss=0.911, accuracy=0.559, val_loss=0.827, val_accuracy=0.665]
 72%|███████▏  | 18/25 [02:32<00:56,  8.11s/epoch, loss=0.865, accuracy=0.64, val_loss=0.899, val_accuracy=0.627] 
 76%|███████▌  | 19/25 [02:40<00:48,  8.11s/epoch, loss=0.922, accuracy=0.609, val_loss=0.888, val_accuracy=0.645]
 80%|████████  | 20/25 [02:48<00:40,  8.12s/epoch, loss=0.911, accuracy=0.608, val_loss=0.895, val_accuracy=0.625]
 84%|████████▍ | 21/25 [02:56<00:32,  8.09s/epoch, loss=0.966, accuracy=0.575, val_loss=1.07, val_accuracy=0.522] 
 88%|████████▊ | 22/25 [03:04<00:24,  8.08s/epoch, loss=0.962, accuracy=0.548, val_loss=0.918, val_accuracy=0.582]
 92%|█████████▏| 23/25 [03:13<00:16,  8.10s/epoch, loss=0.946, accuracy=0.569, val_loss=0.921, val_accuracy=0.6]  
 96%|█████████▌| 24/25 [03:21<00:08,  8.13s/epoch, loss=0.925, accuracy=0.577, val_loss=0.943, val_accuracy=0.551]
100%|██████████| 25/25 [03:29<00:00,  8.12s/epoch, loss=0.975, accuracy=0.577, val_loss=0.99, val_accuracy=0.509] 
100%|██████████| 25/25 [03:29<00:00,  8.38s/epoch, loss=0.975, accuracy=0.577, val_loss=0.99, val_accuracy=0.509]
Test score: 0.46593761444091797
Test accuracy: 0.8380799889564514


* * * Run SGD for ID = 20_11. * * *


2024-03-01 14:00:23.528623: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 14:00:26.946934: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 14:00:26.948213: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-01 14:00:26.988326: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 14:00:26.988368: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 14:00:26.991728: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 14:00:26.991799: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 14:00:26.994228: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 14:00:26.994959: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 14:00:26.997712: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 14:00:26.999515: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 14:00:27.005499: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 14:00:27.006270: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 14:00:27.006374: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
<__array_function__ internals>:5: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:159: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_train, y_train = np.array(xs[:idx]), np.array(labels[:idx])
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:160: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_test, y_test = np.array(xs[idx:]), np.array(labels[idx:])
2024-03-01 14:00:33.255664: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-01 14:00:33.256262: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 14:00:33.256975: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 14:00:33.257010: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 14:00:33.257073: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 14:00:33.257090: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 14:00:33.257121: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 14:00:33.257144: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 14:00:33.257159: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 14:00:33.257183: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 14:00:33.257205: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 14:00:33.257744: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 14:00:33.257780: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 14:00:33.837079: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-01 14:00:33.837137: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-01 14:00:33.837148: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-01 14:00:33.838300: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:18:00.0, compute capability: 6.1)
{'id': '20_11', 'seed': 11, 'out_folder': 'results/epoch_budget', 'batch_size': 32, 'epochs': 25, 'validation_split': 0.2, 'checkpointing': True, 'initial_lr': 0.1, 'momentum': 0.98, 'nesterov': True, 'bootstrapping': False, 'map_optimizer': True, 'model': 'CNN-LSTM', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Loading data...
Pad sequences (samples x time)
20000 train sequences
5000 validation sequences
25000 test sequences
x_train shape: (20000, 100)
x_val shape: (5000, 100)
x_test shape: (25000, 100)
Using MAP optimizer with reg_weight:  5e-05
CNN-LSTM

0epoch [00:00, ?epoch/s]
  0%|          | 0/25 [00:00<?, ?epoch/s]2024-03-01 14:00:34.246078: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-01 14:00:34.257949: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-03-01 14:00:35.696640: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 14:00:35.894105: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 14:00:36.709000: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-01 14:00:36.829108: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.

  4%|▍         | 1/25 [00:16<06:42, 16.78s/epoch, loss=0.608, accuracy=0.702, val_loss=0.466, val_accuracy=0.827]
  8%|▊         | 2/25 [00:25<04:40, 12.20s/epoch, loss=0.46, accuracy=0.835, val_loss=0.45, val_accuracy=0.844]  
 12%|█▏        | 3/25 [00:33<03:47, 10.33s/epoch, loss=0.427, accuracy=0.863, val_loss=0.475, val_accuracy=0.833]
 16%|█▌        | 4/25 [00:44<03:37, 10.38s/epoch, loss=0.422, accuracy=0.88, val_loss=0.503, val_accuracy=0.851] 
 20%|██        | 5/25 [00:52<03:11,  9.57s/epoch, loss=0.434, accuracy=0.893, val_loss=0.572, val_accuracy=0.833]
 24%|██▍       | 6/25 [01:00<02:52,  9.05s/epoch, loss=0.487, accuracy=0.886, val_loss=0.668, val_accuracy=0.809]
 28%|██▊       | 7/25 [01:08<02:37,  8.74s/epoch, loss=0.82, accuracy=0.767, val_loss=1.04, val_accuracy=0.68]   
 32%|███▏      | 8/25 [01:16<02:24,  8.49s/epoch, loss=1.11, accuracy=0.655, val_loss=1.14, val_accuracy=0.644]
 36%|███▌      | 9/25 [01:24<02:13,  8.35s/epoch, loss=1.13, accuracy=0.616, val_loss=1.11, val_accuracy=0.641]
 40%|████      | 10/25 [01:32<02:03,  8.22s/epoch, loss=1.12, accuracy=0.589, val_loss=1.11, val_accuracy=0.598]
 44%|████▍     | 11/25 [01:40<01:54,  8.15s/epoch, loss=1.06, accuracy=0.59, val_loss=1.02, val_accuracy=0.61]  
 48%|████▊     | 12/25 [01:48<01:45,  8.08s/epoch, loss=0.997, accuracy=0.619, val_loss=1.01, val_accuracy=0.603]
 52%|█████▏    | 13/25 [01:56<01:36,  8.07s/epoch, loss=0.975, accuracy=0.594, val_loss=0.985, val_accuracy=0.604]
 56%|█████▌    | 14/25 [02:04<01:28,  8.05s/epoch, loss=0.917, accuracy=0.627, val_loss=0.882, val_accuracy=0.635]
 60%|██████    | 15/25 [02:12<01:20,  8.05s/epoch, loss=0.868, accuracy=0.66, val_loss=0.867, val_accuracy=0.663] 
 64%|██████▍   | 16/25 [02:20<01:12,  8.02s/epoch, loss=1.19, accuracy=0.678, val_loss=1.28, val_accuracy=0.65]  
 68%|██████▊   | 17/25 [02:28<01:04,  8.02s/epoch, loss=1.28, accuracy=0.66, val_loss=1.93, val_accuracy=0.691]
 72%|███████▏  | 18/25 [02:36<00:55,  7.99s/epoch, loss=2.17, accuracy=0.65, val_loss=2.1, val_accuracy=0.495] 
 76%|███████▌  | 19/25 [02:44<00:47,  7.98s/epoch, loss=1.86, accuracy=0.634, val_loss=1.7, val_accuracy=0.642]
 80%|████████  | 20/25 [02:52<00:39,  7.99s/epoch, loss=1.61, accuracy=0.621, val_loss=1.51, val_accuracy=0.63]
 84%|████████▍ | 21/25 [03:00<00:31,  7.98s/epoch, loss=1.46, accuracy=0.589, val_loss=1.41, val_accuracy=0.507]
 88%|████████▊ | 22/25 [03:08<00:24,  8.00s/epoch, loss=1.33, accuracy=0.551, val_loss=1.25, val_accuracy=0.598]
 92%|█████████▏| 23/25 [03:16<00:16,  8.05s/epoch, loss=1.22, accuracy=0.584, val_loss=1.19, val_accuracy=0.507]
 96%|█████████▌| 24/25 [03:24<00:08,  8.05s/epoch, loss=1.15, accuracy=0.573, val_loss=1.06, val_accuracy=0.597]
100%|██████████| 25/25 [03:32<00:00,  8.08s/epoch, loss=1.08, accuracy=0.572, val_loss=1.06, val_accuracy=0.505]
100%|██████████| 25/25 [03:32<00:00,  8.51s/epoch, loss=1.08, accuracy=0.572, val_loss=1.06, val_accuracy=0.505]
Test score: 0.5295203328132629
Test accuracy: 0.8407599925994873


* * * Run SGD for ID = 20_12. * * *


2024-03-01 14:04:15.573380: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 14:04:18.902650: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 14:04:18.904103: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-01 14:04:18.943752: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 14:04:18.943799: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 14:04:18.947447: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 14:04:18.947523: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 14:04:18.950401: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 14:04:18.951242: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 14:04:18.954244: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 14:04:18.956130: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 14:04:18.961976: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 14:04:18.962711: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 14:04:18.962820: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
<__array_function__ internals>:5: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:159: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_train, y_train = np.array(xs[:idx]), np.array(labels[:idx])
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:160: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_test, y_test = np.array(xs[idx:]), np.array(labels[idx:])
2024-03-01 14:04:25.068762: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-01 14:04:25.069343: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 14:04:25.070446: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 14:04:25.070484: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 14:04:25.070558: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 14:04:25.070578: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 14:04:25.070594: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 14:04:25.070611: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 14:04:25.070625: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 14:04:25.070640: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 14:04:25.070657: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 14:04:25.071194: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 14:04:25.071229: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 14:04:25.649673: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-01 14:04:25.649731: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-01 14:04:25.649741: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-01 14:04:25.650839: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:18:00.0, compute capability: 6.1)
{'id': '20_12', 'seed': 12, 'out_folder': 'results/epoch_budget', 'batch_size': 32, 'epochs': 25, 'validation_split': 0.2, 'checkpointing': True, 'initial_lr': 0.1, 'momentum': 0.98, 'nesterov': True, 'bootstrapping': False, 'map_optimizer': True, 'model': 'CNN-LSTM', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Loading data...
Pad sequences (samples x time)
20000 train sequences
5000 validation sequences
25000 test sequences
x_train shape: (20000, 100)
x_val shape: (5000, 100)
x_test shape: (25000, 100)
Using MAP optimizer with reg_weight:  5e-05
CNN-LSTM

0epoch [00:00, ?epoch/s]
  0%|          | 0/25 [00:00<?, ?epoch/s]2024-03-01 14:04:26.056988: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-01 14:04:26.069027: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-03-01 14:04:27.494263: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 14:04:27.702741: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 14:04:28.530820: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-01 14:04:28.589333: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.

  4%|▍         | 1/25 [00:17<06:54, 17.28s/epoch, loss=0.655, accuracy=0.647, val_loss=0.503, val_accuracy=0.803]
  8%|▊         | 2/25 [00:26<04:47, 12.50s/epoch, loss=0.473, accuracy=0.827, val_loss=0.517, val_accuracy=0.828]
 12%|█▏        | 3/25 [00:34<03:54, 10.68s/epoch, loss=0.436, accuracy=0.859, val_loss=0.496, val_accuracy=0.824]
 16%|█▌        | 4/25 [00:47<03:57, 11.32s/epoch, loss=0.431, accuracy=0.877, val_loss=0.546, val_accuracy=0.846]
 20%|██        | 5/25 [00:55<03:23, 10.19s/epoch, loss=0.476, accuracy=0.872, val_loss=0.637, val_accuracy=0.81] 
 24%|██▍       | 6/25 [01:03<02:59,  9.44s/epoch, loss=0.687, accuracy=0.804, val_loss=0.86, val_accuracy=0.731]
 28%|██▊       | 7/25 [01:11<02:41,  8.97s/epoch, loss=1.01, accuracy=0.678, val_loss=1.15, val_accuracy=0.619] 
 32%|███▏      | 8/25 [01:19<02:27,  8.69s/epoch, loss=1.2, accuracy=0.588, val_loss=1.26, val_accuracy=0.503] 
 36%|███▌      | 9/25 [01:27<02:15,  8.48s/epoch, loss=1.17, accuracy=0.534, val_loss=1.08, val_accuracy=0.549]
 40%|████      | 10/25 [01:35<02:05,  8.38s/epoch, loss=1.07, accuracy=0.602, val_loss=1.13, val_accuracy=0.621]
 44%|████▍     | 11/25 [01:43<01:56,  8.32s/epoch, loss=1.12, accuracy=0.604, val_loss=1.12, val_accuracy=0.586]
 48%|████▊     | 12/25 [01:52<01:47,  8.27s/epoch, loss=1.1, accuracy=0.565, val_loss=1.05, val_accuracy=0.539] 
 52%|█████▏    | 13/25 [02:00<01:38,  8.21s/epoch, loss=1.04, accuracy=0.563, val_loss=0.983, val_accuracy=0.608]
 56%|█████▌    | 14/25 [02:08<01:29,  8.14s/epoch, loss=0.997, accuracy=0.581, val_loss=0.936, val_accuracy=0.623]
 60%|██████    | 15/25 [02:16<01:21,  8.12s/epoch, loss=0.968, accuracy=0.581, val_loss=0.939, val_accuracy=0.622]
 64%|██████▍   | 16/25 [02:24<01:12,  8.05s/epoch, loss=1.06, accuracy=0.582, val_loss=1.11, val_accuracy=0.557]  
 68%|██████▊   | 17/25 [02:32<01:04,  8.09s/epoch, loss=1.07, accuracy=0.564, val_loss=1.01, val_accuracy=0.604]
 72%|███████▏  | 18/25 [02:40<00:56,  8.13s/epoch, loss=1, accuracy=0.57, val_loss=0.961, val_accuracy=0.591]   
 76%|███████▌  | 19/25 [02:48<00:48,  8.14s/epoch, loss=0.94, accuracy=0.609, val_loss=0.953, val_accuracy=0.632]
 80%|████████  | 20/25 [02:56<00:40,  8.10s/epoch, loss=0.984, accuracy=0.587, val_loss=0.976, val_accuracy=0.605]
 84%|████████▍ | 21/25 [03:04<00:32,  8.08s/epoch, loss=0.948, accuracy=0.597, val_loss=0.967, val_accuracy=0.603]
 88%|████████▊ | 22/25 [03:12<00:24,  8.09s/epoch, loss=0.911, accuracy=0.639, val_loss=0.911, val_accuracy=0.636]
 92%|█████████▏| 23/25 [03:20<00:16,  8.09s/epoch, loss=0.916, accuracy=0.64, val_loss=0.935, val_accuracy=0.631] 
 96%|█████████▌| 24/25 [03:28<00:08,  8.09s/epoch, loss=0.979, accuracy=0.587, val_loss=1, val_accuracy=0.513]   
100%|██████████| 25/25 [03:36<00:00,  8.06s/epoch, loss=0.959, accuracy=0.557, val_loss=0.95, val_accuracy=0.608]
100%|██████████| 25/25 [03:36<00:00,  8.68s/epoch, loss=0.959, accuracy=0.557, val_loss=0.95, val_accuracy=0.608]
Test score: 0.5457178354263306
Test accuracy: 0.8402400016784668


* * * Run SGD for ID = 20_13. * * *


2024-03-01 14:08:14.739855: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 14:08:24.626481: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 14:08:24.627978: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-01 14:08:24.671144: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 14:08:24.671191: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 14:08:24.674798: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 14:08:24.674896: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 14:08:24.677560: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 14:08:24.678392: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 14:08:24.681299: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 14:08:24.683069: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 14:08:24.688870: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 14:08:24.689658: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 14:08:24.689786: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
<__array_function__ internals>:5: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:159: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_train, y_train = np.array(xs[:idx]), np.array(labels[:idx])
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:160: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_test, y_test = np.array(xs[idx:]), np.array(labels[idx:])
2024-03-01 14:08:31.643290: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-01 14:08:31.643984: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 14:08:31.645329: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 14:08:31.645377: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 14:08:31.645477: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 14:08:31.645506: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 14:08:31.645526: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 14:08:31.645544: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 14:08:31.645561: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 14:08:31.645580: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 14:08:31.645599: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 14:08:31.646192: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 14:08:31.646228: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 14:08:32.238201: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-01 14:08:32.238256: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-01 14:08:32.238268: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-01 14:08:32.239488: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:18:00.0, compute capability: 6.1)
{'id': '20_13', 'seed': 13, 'out_folder': 'results/epoch_budget', 'batch_size': 32, 'epochs': 25, 'validation_split': 0.2, 'checkpointing': True, 'initial_lr': 0.1, 'momentum': 0.98, 'nesterov': True, 'bootstrapping': False, 'map_optimizer': True, 'model': 'CNN-LSTM', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Loading data...
Pad sequences (samples x time)
20000 train sequences
5000 validation sequences
25000 test sequences
x_train shape: (20000, 100)
x_val shape: (5000, 100)
x_test shape: (25000, 100)
Using MAP optimizer with reg_weight:  5e-05
CNN-LSTM

0epoch [00:00, ?epoch/s]
  0%|          | 0/25 [00:00<?, ?epoch/s]2024-03-01 14:08:32.665488: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-01 14:08:32.678025: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-03-01 14:08:34.130445: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 14:08:34.324161: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 14:08:35.091669: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-01 14:08:35.145349: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.

  4%|▍         | 1/25 [00:19<07:57, 19.89s/epoch, loss=0.617, accuracy=0.686, val_loss=0.467, val_accuracy=0.831]
  8%|▊         | 2/25 [00:32<06:04, 15.83s/epoch, loss=0.443, accuracy=0.842, val_loss=0.459, val_accuracy=0.835]
 12%|█▏        | 3/25 [00:41<04:39, 12.72s/epoch, loss=0.406, accuracy=0.872, val_loss=0.461, val_accuracy=0.85] 
 16%|█▌        | 4/25 [00:49<03:48, 10.88s/epoch, loss=0.395, accuracy=0.889, val_loss=0.509, val_accuracy=0.824]
 20%|██        | 5/25 [00:58<03:17,  9.88s/epoch, loss=0.412, accuracy=0.899, val_loss=0.562, val_accuracy=0.843]
 24%|██▍       | 6/25 [01:06<02:57,  9.33s/epoch, loss=0.457, accuracy=0.896, val_loss=0.677, val_accuracy=0.825]
 28%|██▊       | 7/25 [01:14<02:41,  8.94s/epoch, loss=0.687, accuracy=0.822, val_loss=1.02, val_accuracy=0.658] 
 32%|███▏      | 8/25 [01:22<02:26,  8.65s/epoch, loss=1.12, accuracy=0.603, val_loss=1.12, val_accuracy=0.588] 
 36%|███▌      | 9/25 [01:30<02:14,  8.43s/epoch, loss=1.11, accuracy=0.599, val_loss=1.06, val_accuracy=0.635]
 40%|████      | 10/25 [01:38<02:05,  8.36s/epoch, loss=1.06, accuracy=0.617, val_loss=1.01, val_accuracy=0.636]
 44%|████▍     | 11/25 [01:46<01:55,  8.25s/epoch, loss=1.02, accuracy=0.637, val_loss=0.98, val_accuracy=0.664]
 48%|████▊     | 12/25 [01:54<01:46,  8.17s/epoch, loss=1.04, accuracy=0.633, val_loss=1.06, val_accuracy=0.584]
 52%|█████▏    | 13/25 [02:02<01:37,  8.10s/epoch, loss=1.02, accuracy=0.617, val_loss=0.993, val_accuracy=0.634]
 56%|█████▌    | 14/25 [02:10<01:29,  8.10s/epoch, loss=1, accuracy=0.614, val_loss=1.01, val_accuracy=0.614]    
 60%|██████    | 15/25 [02:18<01:20,  8.08s/epoch, loss=1.04, accuracy=0.579, val_loss=1.03, val_accuracy=0.589]
 64%|██████▍   | 16/25 [02:26<01:12,  8.10s/epoch, loss=1.02, accuracy=0.59, val_loss=0.964, val_accuracy=0.618]
 68%|██████▊   | 17/25 [02:35<01:05,  8.13s/epoch, loss=1, accuracy=0.592, val_loss=0.982, val_accuracy=0.619]  
 72%|███████▏  | 18/25 [02:43<00:57,  8.15s/epoch, loss=0.993, accuracy=0.612, val_loss=1.09, val_accuracy=0.546]
 76%|███████▌  | 19/25 [02:51<00:48,  8.12s/epoch, loss=0.938, accuracy=0.651, val_loss=0.917, val_accuracy=0.672]
 80%|████████  | 20/25 [02:59<00:40,  8.10s/epoch, loss=0.972, accuracy=0.616, val_loss=0.999, val_accuracy=0.53] 
 84%|████████▍ | 21/25 [03:07<00:32,  8.05s/epoch, loss=0.975, accuracy=0.596, val_loss=0.94, val_accuracy=0.593]
 88%|████████▊ | 22/25 [03:15<00:23,  7.98s/epoch, loss=0.916, accuracy=0.614, val_loss=0.889, val_accuracy=0.641]
 92%|█████████▏| 23/25 [03:23<00:15,  7.98s/epoch, loss=0.877, accuracy=0.64, val_loss=0.874, val_accuracy=0.638] 
 96%|█████████▌| 24/25 [03:31<00:07,  7.97s/epoch, loss=0.965, accuracy=0.605, val_loss=1.4, val_accuracy=0.605] 
100%|██████████| 25/25 [03:38<00:00,  7.96s/epoch, loss=1.4, accuracy=0.62, val_loss=1.31, val_accuracy=0.646]  
100%|██████████| 25/25 [03:38<00:00,  8.76s/epoch, loss=1.4, accuracy=0.62, val_loss=1.31, val_accuracy=0.646]
Test score: 0.4561883211135864
Test accuracy: 0.8471999764442444


* * * Run SGD for ID = 20_14. * * *


2024-03-01 14:12:26.297419: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 14:12:29.886445: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 14:12:29.887875: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-01 14:12:29.930707: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 14:12:29.930756: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 14:12:29.934416: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 14:12:29.934507: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 14:12:29.937185: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 14:12:29.938041: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 14:12:29.941145: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 14:12:29.942980: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 14:12:29.948525: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 14:12:29.949266: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 14:12:29.949391: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
<__array_function__ internals>:5: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:159: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_train, y_train = np.array(xs[:idx]), np.array(labels[:idx])
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:160: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_test, y_test = np.array(xs[idx:]), np.array(labels[idx:])
2024-03-01 14:12:36.549049: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-01 14:12:36.549657: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 14:12:36.550945: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 14:12:36.550999: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 14:12:36.551068: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 14:12:36.551109: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 14:12:36.551141: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 14:12:36.551173: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 14:12:36.551195: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 14:12:36.551223: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 14:12:36.551252: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 14:12:36.551854: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 14:12:36.551901: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 14:12:37.124805: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-01 14:12:37.124879: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-01 14:12:37.124890: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-01 14:12:37.125985: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:18:00.0, compute capability: 6.1)
{'id': '20_14', 'seed': 14, 'out_folder': 'results/epoch_budget', 'batch_size': 32, 'epochs': 25, 'validation_split': 0.2, 'checkpointing': True, 'initial_lr': 0.1, 'momentum': 0.98, 'nesterov': True, 'bootstrapping': False, 'map_optimizer': True, 'model': 'CNN-LSTM', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Loading data...
Pad sequences (samples x time)
20000 train sequences
5000 validation sequences
25000 test sequences
x_train shape: (20000, 100)
x_val shape: (5000, 100)
x_test shape: (25000, 100)
Using MAP optimizer with reg_weight:  5e-05
CNN-LSTM

0epoch [00:00, ?epoch/s]
  0%|          | 0/25 [00:00<?, ?epoch/s]2024-03-01 14:12:37.540125: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-01 14:12:37.552051: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-03-01 14:12:38.993656: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 14:12:39.190379: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 14:12:39.961371: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-01 14:12:40.011049: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.

  4%|▍         | 1/25 [00:20<08:23, 20.99s/epoch, loss=0.688, accuracy=0.6, val_loss=0.492, val_accuracy=0.798]
  8%|▊         | 2/25 [00:31<05:47, 15.09s/epoch, loss=0.481, accuracy=0.817, val_loss=0.455, val_accuracy=0.848]
 12%|█▏        | 3/25 [00:39<04:20, 11.85s/epoch, loss=0.434, accuracy=0.857, val_loss=0.47, val_accuracy=0.844] 
 16%|█▌        | 4/25 [00:48<03:45, 10.72s/epoch, loss=0.424, accuracy=0.875, val_loss=0.508, val_accuracy=0.849]
 20%|██        | 5/25 [00:56<03:15,  9.75s/epoch, loss=0.452, accuracy=0.879, val_loss=0.588, val_accuracy=0.83] 
 24%|██▍       | 6/25 [01:05<02:54,  9.19s/epoch, loss=0.608, accuracy=0.839, val_loss=0.919, val_accuracy=0.707]
 28%|██▊       | 7/25 [01:13<02:39,  8.86s/epoch, loss=0.974, accuracy=0.691, val_loss=1.16, val_accuracy=0.538] 
 32%|███▏      | 8/25 [01:21<02:27,  8.67s/epoch, loss=1.19, accuracy=0.568, val_loss=1.13, val_accuracy=0.597] 
 36%|███▌      | 9/25 [01:29<02:15,  8.48s/epoch, loss=1.16, accuracy=0.545, val_loss=1.18, val_accuracy=0.567]
 40%|████      | 10/25 [01:37<02:05,  8.34s/epoch, loss=1.16, accuracy=0.53, val_loss=1.08, val_accuracy=0.586]
 44%|████▍     | 11/25 [01:45<01:54,  8.19s/epoch, loss=1.06, accuracy=0.554, val_loss=1.02, val_accuracy=0.588]
 48%|████▊     | 12/25 [01:53<01:44,  8.07s/epoch, loss=0.992, accuracy=0.572, val_loss=1.01, val_accuracy=0.507]
 52%|█████▏    | 13/25 [02:01<01:36,  8.05s/epoch, loss=0.949, accuracy=0.557, val_loss=0.885, val_accuracy=0.636]
 56%|█████▌    | 14/25 [02:09<01:28,  8.01s/epoch, loss=0.921, accuracy=0.608, val_loss=0.913, val_accuracy=0.643]
 60%|██████    | 15/25 [02:17<01:19,  8.00s/epoch, loss=0.907, accuracy=0.615, val_loss=0.858, val_accuracy=0.662]
 64%|██████▍   | 16/25 [02:25<01:11,  7.98s/epoch, loss=0.946, accuracy=0.612, val_loss=1.05, val_accuracy=0.554] 
 68%|██████▊   | 17/25 [02:32<01:03,  7.96s/epoch, loss=1.01, accuracy=0.563, val_loss=1.18, val_accuracy=0.494] 
 72%|███████▏  | 18/25 [02:40<00:55,  7.95s/epoch, loss=0.98, accuracy=0.579, val_loss=0.979, val_accuracy=0.549]
 76%|███████▌  | 19/25 [02:48<00:47,  7.93s/epoch, loss=0.957, accuracy=0.596, val_loss=0.949, val_accuracy=0.595]
 80%|████████  | 20/25 [02:56<00:39,  7.95s/epoch, loss=0.99, accuracy=0.583, val_loss=1.02, val_accuracy=0.583]  
 84%|████████▍ | 21/25 [03:04<00:31,  7.95s/epoch, loss=0.981, accuracy=0.567, val_loss=1.01, val_accuracy=0.533]
 88%|████████▊ | 22/25 [03:12<00:23,  7.98s/epoch, loss=0.976, accuracy=0.555, val_loss=0.934, val_accuracy=0.583]
 92%|█████████▏| 23/25 [03:20<00:15,  7.97s/epoch, loss=0.938, accuracy=0.554, val_loss=0.916, val_accuracy=0.521]
 96%|█████████▌| 24/25 [03:28<00:07,  7.96s/epoch, loss=0.915, accuracy=0.559, val_loss=0.859, val_accuracy=0.603]
100%|██████████| 25/25 [03:36<00:00,  7.95s/epoch, loss=0.876, accuracy=0.612, val_loss=0.855, val_accuracy=0.64] 
100%|██████████| 25/25 [03:36<00:00,  8.66s/epoch, loss=0.876, accuracy=0.612, val_loss=0.855, val_accuracy=0.64]
Test score: 0.506083607673645
Test accuracy: 0.8496800065040588


* * * Run SGD for ID = 20_15. * * *


2024-03-01 14:16:23.706658: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 14:16:28.698451: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 14:16:28.699705: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-01 14:16:28.741396: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 14:16:28.741440: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 14:16:28.745420: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 14:16:28.745488: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 14:16:28.748380: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 14:16:28.749667: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 14:16:28.752689: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 14:16:28.754686: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 14:16:28.761214: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 14:16:28.762079: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 14:16:28.762206: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
<__array_function__ internals>:5: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:159: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_train, y_train = np.array(xs[:idx]), np.array(labels[:idx])
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:160: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_test, y_test = np.array(xs[idx:]), np.array(labels[idx:])
2024-03-01 14:16:35.394252: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-01 14:16:35.394813: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 14:16:35.395976: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 14:16:35.396023: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 14:16:35.396088: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 14:16:35.396108: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 14:16:35.396125: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 14:16:35.396143: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 14:16:35.396158: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 14:16:35.396174: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 14:16:35.396191: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 14:16:35.396727: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 14:16:35.396762: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 14:16:35.977113: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-01 14:16:35.977183: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-01 14:16:35.977194: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-01 14:16:35.978373: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:18:00.0, compute capability: 6.1)
{'id': '20_15', 'seed': 15, 'out_folder': 'results/epoch_budget', 'batch_size': 32, 'epochs': 25, 'validation_split': 0.2, 'checkpointing': True, 'initial_lr': 0.1, 'momentum': 0.98, 'nesterov': True, 'bootstrapping': False, 'map_optimizer': True, 'model': 'CNN-LSTM', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Loading data...
Pad sequences (samples x time)
20000 train sequences
5000 validation sequences
25000 test sequences
x_train shape: (20000, 100)
x_val shape: (5000, 100)
x_test shape: (25000, 100)
Using MAP optimizer with reg_weight:  5e-05
CNN-LSTM

0epoch [00:00, ?epoch/s]
  0%|          | 0/25 [00:00<?, ?epoch/s]2024-03-01 14:16:36.389260: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-01 14:16:36.402038: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-03-01 14:16:37.822994: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 14:16:38.028378: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 14:16:38.798258: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-01 14:16:38.853791: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.

  4%|▍         | 1/25 [00:14<05:38, 14.08s/epoch, loss=0.753, accuracy=0.497, val_loss=0.74, val_accuracy=0.496]
  8%|▊         | 2/25 [00:22<04:10, 10.91s/epoch, loss=0.736, accuracy=0.497, val_loss=0.729, val_accuracy=0.504]
 12%|█▏        | 3/25 [00:31<03:33,  9.71s/epoch, loss=0.727, accuracy=0.501, val_loss=0.719, val_accuracy=0.496]
 16%|█▌        | 4/25 [00:39<03:13,  9.23s/epoch, loss=0.604, accuracy=0.683, val_loss=0.472, val_accuracy=0.806]
 20%|██        | 5/25 [00:48<03:01,  9.05s/epoch, loss=0.466, accuracy=0.821, val_loss=0.451, val_accuracy=0.836]
 24%|██▍       | 6/25 [00:56<02:46,  8.75s/epoch, loss=0.436, accuracy=0.856, val_loss=0.559, val_accuracy=0.82] 
 28%|██▊       | 7/25 [01:04<02:33,  8.54s/epoch, loss=0.443, accuracy=0.867, val_loss=0.595, val_accuracy=0.81]
 32%|███▏      | 8/25 [01:12<02:23,  8.44s/epoch, loss=0.531, accuracy=0.853, val_loss=0.639, val_accuracy=0.815]
 36%|███▌      | 9/25 [01:20<02:12,  8.30s/epoch, loss=0.725, accuracy=0.791, val_loss=0.902, val_accuracy=0.718]
 40%|████      | 10/25 [01:28<02:03,  8.21s/epoch, loss=0.964, accuracy=0.688, val_loss=1.04, val_accuracy=0.656]
 44%|████▍     | 11/25 [01:36<01:54,  8.19s/epoch, loss=1.06, accuracy=0.584, val_loss=1.07, val_accuracy=0.498] 
 48%|████▊     | 12/25 [01:44<01:45,  8.15s/epoch, loss=1.01, accuracy=0.6, val_loss=0.991, val_accuracy=0.623] 
 52%|█████▏    | 13/25 [01:53<01:37,  8.13s/epoch, loss=0.985, accuracy=0.598, val_loss=1.01, val_accuracy=0.563]
 56%|█████▌    | 14/25 [02:01<01:30,  8.19s/epoch, loss=0.955, accuracy=0.618, val_loss=0.953, val_accuracy=0.617]
 60%|██████    | 15/25 [02:09<01:22,  8.25s/epoch, loss=0.925, accuracy=0.626, val_loss=0.957, val_accuracy=0.554]
 64%|██████▍   | 16/25 [02:18<01:14,  8.25s/epoch, loss=0.925, accuracy=0.603, val_loss=0.888, val_accuracy=0.623]
 68%|██████▊   | 17/25 [02:26<01:05,  8.19s/epoch, loss=0.919, accuracy=0.624, val_loss=0.93, val_accuracy=0.632] 
 72%|███████▏  | 18/25 [02:34<00:57,  8.16s/epoch, loss=0.94, accuracy=0.647, val_loss=0.975, val_accuracy=0.637]
 76%|███████▌  | 19/25 [02:42<00:48,  8.15s/epoch, loss=1.01, accuracy=0.543, val_loss=0.987, val_accuracy=0.504]
 80%|████████  | 20/25 [02:50<00:40,  8.12s/epoch, loss=0.972, accuracy=0.601, val_loss=0.931, val_accuracy=0.629]
 84%|████████▍ | 21/25 [02:58<00:32,  8.10s/epoch, loss=0.932, accuracy=0.634, val_loss=0.929, val_accuracy=0.637]
 88%|████████▊ | 22/25 [03:06<00:24,  8.17s/epoch, loss=0.962, accuracy=0.623, val_loss=0.983, val_accuracy=0.613]
 92%|█████████▏| 23/25 [03:14<00:16,  8.17s/epoch, loss=0.953, accuracy=0.627, val_loss=0.963, val_accuracy=0.641]
 96%|█████████▌| 24/25 [03:23<00:08,  8.16s/epoch, loss=1.19, accuracy=0.587, val_loss=1.26, val_accuracy=0.505]  
100%|██████████| 25/25 [03:31<00:00,  8.15s/epoch, loss=1.2, accuracy=0.567, val_loss=1.14, val_accuracy=0.604] 
100%|██████████| 25/25 [03:31<00:00,  8.45s/epoch, loss=1.2, accuracy=0.567, val_loss=1.14, val_accuracy=0.604]
Test score: 0.45616963505744934
Test accuracy: 0.8326399922370911


* * * Run SGD for ID = 20_16. * * *


2024-03-01 14:20:21.325255: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 14:20:31.179402: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 14:20:31.180751: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-01 14:20:31.221177: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 14:20:31.221223: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 14:20:31.271891: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 14:20:31.271968: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 14:20:31.275091: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 14:20:31.276332: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 14:20:31.280430: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 14:20:31.282260: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 14:20:31.288461: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 14:20:31.289198: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 14:20:31.289310: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
<__array_function__ internals>:5: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:159: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_train, y_train = np.array(xs[:idx]), np.array(labels[:idx])
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:160: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_test, y_test = np.array(xs[idx:]), np.array(labels[idx:])
2024-03-01 14:20:38.120846: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-01 14:20:38.121455: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 14:20:38.122111: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 14:20:38.122155: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 14:20:38.122219: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 14:20:38.122239: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 14:20:38.122258: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 14:20:38.122277: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 14:20:38.122295: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 14:20:38.122313: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 14:20:38.122332: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 14:20:38.122960: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 14:20:38.123008: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 14:20:38.709302: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-01 14:20:38.709363: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-01 14:20:38.709374: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-01 14:20:38.710536: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:18:00.0, compute capability: 6.1)
{'id': '20_16', 'seed': 16, 'out_folder': 'results/epoch_budget', 'batch_size': 32, 'epochs': 25, 'validation_split': 0.2, 'checkpointing': True, 'initial_lr': 0.1, 'momentum': 0.98, 'nesterov': True, 'bootstrapping': False, 'map_optimizer': True, 'model': 'CNN-LSTM', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Loading data...
Pad sequences (samples x time)
20000 train sequences
5000 validation sequences
25000 test sequences
x_train shape: (20000, 100)
x_val shape: (5000, 100)
x_test shape: (25000, 100)
Using MAP optimizer with reg_weight:  5e-05
CNN-LSTM

0epoch [00:00, ?epoch/s]
  0%|          | 0/25 [00:00<?, ?epoch/s]2024-03-01 14:20:39.109740: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-01 14:20:39.122075: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-03-01 14:20:40.564981: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 14:20:40.766678: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 14:20:41.588458: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-01 14:20:41.644707: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.

  4%|▍         | 1/25 [00:18<07:32, 18.86s/epoch, loss=0.689, accuracy=0.603, val_loss=0.541, val_accuracy=0.768]
  8%|▊         | 2/25 [00:28<05:06, 13.34s/epoch, loss=0.48, accuracy=0.817, val_loss=0.487, val_accuracy=0.81]  
 12%|█▏        | 3/25 [00:37<04:09, 11.32s/epoch, loss=0.42, accuracy=0.859, val_loss=0.446, val_accuracy=0.846]
 16%|█▌        | 4/25 [00:45<03:35, 10.25s/epoch, loss=0.403, accuracy=0.88, val_loss=0.472, val_accuracy=0.851]
 20%|██        | 5/25 [00:54<03:10,  9.54s/epoch, loss=0.421, accuracy=0.888, val_loss=0.527, val_accuracy=0.84]
 24%|██▍       | 6/25 [01:02<02:52,  9.06s/epoch, loss=0.514, accuracy=0.869, val_loss=0.728, val_accuracy=0.787]
 28%|██▊       | 7/25 [01:10<02:37,  8.75s/epoch, loss=0.93, accuracy=0.681, val_loss=1, val_accuracy=0.664]     
 32%|███▏      | 8/25 [01:18<02:25,  8.57s/epoch, loss=1.05, accuracy=0.616, val_loss=1.05, val_accuracy=0.616]
 36%|███▌      | 9/25 [01:26<02:14,  8.43s/epoch, loss=1.02, accuracy=0.625, val_loss=1.01, val_accuracy=0.622]
 40%|████      | 10/25 [01:34<02:04,  8.29s/epoch, loss=1.03, accuracy=0.595, val_loss=1.01, val_accuracy=0.599]
 44%|████▍     | 11/25 [01:42<01:54,  8.21s/epoch, loss=0.956, accuracy=0.641, val_loss=0.961, val_accuracy=0.617]
 48%|████▊     | 12/25 [01:50<01:46,  8.17s/epoch, loss=0.964, accuracy=0.61, val_loss=0.967, val_accuracy=0.524] 
 52%|█████▏    | 13/25 [01:58<01:38,  8.18s/epoch, loss=0.953, accuracy=0.624, val_loss=0.981, val_accuracy=0.618]
 56%|█████▌    | 14/25 [02:07<01:29,  8.16s/epoch, loss=0.938, accuracy=0.629, val_loss=0.978, val_accuracy=0.649]
 60%|██████    | 15/25 [02:15<01:21,  8.14s/epoch, loss=0.983, accuracy=0.624, val_loss=0.956, val_accuracy=0.624]
 64%|██████▍   | 16/25 [02:23<01:12,  8.07s/epoch, loss=0.97, accuracy=0.612, val_loss=1.01, val_accuracy=0.515]  
 68%|██████▊   | 17/25 [02:31<01:04,  8.07s/epoch, loss=0.985, accuracy=0.601, val_loss=1.09, val_accuracy=0.488]
 72%|███████▏  | 18/25 [02:39<00:56,  8.13s/epoch, loss=0.998, accuracy=0.574, val_loss=1.18, val_accuracy=0.485]
 76%|███████▌  | 19/25 [02:47<00:48,  8.15s/epoch, loss=0.955, accuracy=0.575, val_loss=0.98, val_accuracy=0.543]
 80%|████████  | 20/25 [02:55<00:40,  8.16s/epoch, loss=0.899, accuracy=0.628, val_loss=0.962, val_accuracy=0.586]
 84%|████████▍ | 21/25 [03:03<00:32,  8.12s/epoch, loss=0.906, accuracy=0.617, val_loss=0.928, val_accuracy=0.63] 
 88%|████████▊ | 22/25 [03:11<00:24,  8.09s/epoch, loss=0.928, accuracy=0.56, val_loss=0.938, val_accuracy=0.554]
 92%|█████████▏| 23/25 [03:19<00:16,  8.09s/epoch, loss=0.917, accuracy=0.559, val_loss=0.912, val_accuracy=0.596]
 96%|█████████▌| 24/25 [03:27<00:08,  8.07s/epoch, loss=0.926, accuracy=0.553, val_loss=0.883, val_accuracy=0.568]
100%|██████████| 25/25 [03:36<00:00,  8.07s/epoch, loss=0.891, accuracy=0.564, val_loss=0.854, val_accuracy=0.544]
100%|██████████| 25/25 [03:36<00:00,  8.64s/epoch, loss=0.891, accuracy=0.564, val_loss=0.854, val_accuracy=0.544]
Test score: 0.4901537597179413
Test accuracy: 0.8453999757766724


* * * Run SGD for ID = 20_17. * * *


2024-03-01 14:24:23.232979: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 14:24:26.534764: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 14:24:26.536127: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-01 14:24:26.578367: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 14:24:26.578412: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 14:24:26.582291: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 14:24:26.582371: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 14:24:26.585209: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 14:24:26.585934: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 14:24:26.589078: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 14:24:26.590925: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 14:24:26.596998: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 14:24:26.597734: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 14:24:26.597854: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
<__array_function__ internals>:5: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:159: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_train, y_train = np.array(xs[:idx]), np.array(labels[:idx])
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:160: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_test, y_test = np.array(xs[idx:]), np.array(labels[idx:])
2024-03-01 14:24:32.853679: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-01 14:24:32.854329: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 14:24:32.855111: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 14:24:32.855153: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 14:24:32.855215: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 14:24:32.855235: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 14:24:32.855254: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 14:24:32.855272: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 14:24:32.855288: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 14:24:32.855307: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 14:24:32.855332: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 14:24:32.855924: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 14:24:32.855963: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 14:24:33.447282: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-01 14:24:33.447343: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-01 14:24:33.447355: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-01 14:24:33.448525: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:18:00.0, compute capability: 6.1)
{'id': '20_17', 'seed': 17, 'out_folder': 'results/epoch_budget', 'batch_size': 32, 'epochs': 25, 'validation_split': 0.2, 'checkpointing': True, 'initial_lr': 0.1, 'momentum': 0.98, 'nesterov': True, 'bootstrapping': False, 'map_optimizer': True, 'model': 'CNN-LSTM', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Loading data...
Pad sequences (samples x time)
20000 train sequences
5000 validation sequences
25000 test sequences
x_train shape: (20000, 100)
x_val shape: (5000, 100)
x_test shape: (25000, 100)
Using MAP optimizer with reg_weight:  5e-05
CNN-LSTM

0epoch [00:00, ?epoch/s]
  0%|          | 0/25 [00:00<?, ?epoch/s]2024-03-01 14:24:33.838727: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-01 14:24:33.851024: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-03-01 14:24:35.261797: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 14:24:35.457964: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 14:24:36.238008: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-01 14:24:36.288655: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.

  4%|▍         | 1/25 [00:14<05:54, 14.79s/epoch, loss=0.645, accuracy=0.655, val_loss=0.507, val_accuracy=0.8]
  8%|▊         | 2/25 [00:24<04:26, 11.58s/epoch, loss=0.461, accuracy=0.833, val_loss=0.502, val_accuracy=0.809]
 12%|█▏        | 3/25 [00:33<03:48, 10.41s/epoch, loss=0.418, accuracy=0.865, val_loss=0.476, val_accuracy=0.841]
 16%|█▌        | 4/25 [00:41<03:18,  9.45s/epoch, loss=0.436, accuracy=0.877, val_loss=0.585, val_accuracy=0.819]
 20%|██        | 5/25 [00:49<02:58,  8.93s/epoch, loss=0.544, accuracy=0.853, val_loss=0.744, val_accuracy=0.766]
 24%|██▍       | 6/25 [00:57<02:43,  8.59s/epoch, loss=0.951, accuracy=0.71, val_loss=1.34, val_accuracy=0.524]  
 28%|██▊       | 7/25 [01:05<02:31,  8.43s/epoch, loss=1.18, accuracy=0.603, val_loss=1.12, val_accuracy=0.643]
 32%|███▏      | 8/25 [01:13<02:20,  8.28s/epoch, loss=1.13, accuracy=0.611, val_loss=1.13, val_accuracy=0.534]
 36%|███▌      | 9/25 [01:21<02:10,  8.18s/epoch, loss=1.1, accuracy=0.592, val_loss=1.09, val_accuracy=0.598] 
 40%|████      | 10/25 [01:29<02:01,  8.10s/epoch, loss=1.09, accuracy=0.578, val_loss=1.03, val_accuracy=0.626]
 44%|████▍     | 11/25 [01:37<01:53,  8.07s/epoch, loss=1.04, accuracy=0.582, val_loss=0.995, val_accuracy=0.618]
 48%|████▊     | 12/25 [01:45<01:44,  8.07s/epoch, loss=0.974, accuracy=0.601, val_loss=0.994, val_accuracy=0.527]
 52%|█████▏    | 13/25 [01:53<01:36,  8.04s/epoch, loss=0.938, accuracy=0.593, val_loss=0.925, val_accuracy=0.628]
 56%|█████▌    | 14/25 [02:01<01:28,  8.02s/epoch, loss=0.887, accuracy=0.618, val_loss=0.853, val_accuracy=0.643]
 60%|██████    | 15/25 [02:08<01:19,  7.98s/epoch, loss=0.903, accuracy=0.604, val_loss=0.887, val_accuracy=0.633]
 64%|██████▍   | 16/25 [02:16<01:11,  7.94s/epoch, loss=0.867, accuracy=0.639, val_loss=0.908, val_accuracy=0.561]
 68%|██████▊   | 17/25 [02:24<01:03,  7.94s/epoch, loss=0.859, accuracy=0.634, val_loss=0.935, val_accuracy=0.602]
 72%|███████▏  | 18/25 [02:32<00:55,  7.96s/epoch, loss=0.917, accuracy=0.624, val_loss=0.955, val_accuracy=0.625]
 76%|███████▌  | 19/25 [02:40<00:47,  7.96s/epoch, loss=0.953, accuracy=0.611, val_loss=0.952, val_accuracy=0.612]
 80%|████████  | 20/25 [02:48<00:39,  7.93s/epoch, loss=0.965, accuracy=0.583, val_loss=0.938, val_accuracy=0.602]
 84%|████████▍ | 21/25 [02:56<00:31,  7.92s/epoch, loss=0.959, accuracy=0.593, val_loss=0.96, val_accuracy=0.613] 
 88%|████████▊ | 22/25 [03:04<00:23,  7.92s/epoch, loss=0.972, accuracy=0.603, val_loss=0.984, val_accuracy=0.53]
 92%|█████████▏| 23/25 [03:12<00:15,  7.91s/epoch, loss=0.98, accuracy=0.553, val_loss=0.952, val_accuracy=0.584]
 96%|█████████▌| 24/25 [03:20<00:07,  7.91s/epoch, loss=0.943, accuracy=0.575, val_loss=0.89, val_accuracy=0.606]
100%|██████████| 25/25 [03:28<00:00,  7.91s/epoch, loss=0.898, accuracy=0.589, val_loss=0.882, val_accuracy=0.599]
100%|██████████| 25/25 [03:28<00:00,  8.32s/epoch, loss=0.898, accuracy=0.589, val_loss=0.882, val_accuracy=0.599]
Test score: 0.47734612226486206
Test accuracy: 0.8448799848556519


* * * Run SGD for ID = 20_18. * * *


2024-03-01 14:28:10.973517: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 14:28:23.937776: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 14:28:23.939217: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-01 14:28:23.980618: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 14:28:23.980666: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 14:28:23.985401: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 14:28:23.985472: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 14:28:23.988557: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 14:28:23.990228: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 14:28:24.034385: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 14:28:24.036763: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 14:28:24.045373: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 14:28:24.046100: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 14:28:24.046208: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
<__array_function__ internals>:5: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:159: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_train, y_train = np.array(xs[:idx]), np.array(labels[:idx])
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:160: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_test, y_test = np.array(xs[idx:]), np.array(labels[idx:])
2024-03-01 14:28:30.156545: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-01 14:28:30.157189: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 14:28:30.157856: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 14:28:30.157898: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 14:28:30.157970: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 14:28:30.157988: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 14:28:30.158004: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 14:28:30.158020: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 14:28:30.158035: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 14:28:30.158051: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 14:28:30.158067: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 14:28:30.158599: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 14:28:30.158633: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 14:28:30.745102: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-01 14:28:30.745163: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-01 14:28:30.745173: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-01 14:28:30.746302: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:18:00.0, compute capability: 6.1)
{'id': '20_18', 'seed': 18, 'out_folder': 'results/epoch_budget', 'batch_size': 32, 'epochs': 25, 'validation_split': 0.2, 'checkpointing': True, 'initial_lr': 0.1, 'momentum': 0.98, 'nesterov': True, 'bootstrapping': False, 'map_optimizer': True, 'model': 'CNN-LSTM', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Loading data...
Pad sequences (samples x time)
20000 train sequences
5000 validation sequences
25000 test sequences
x_train shape: (20000, 100)
x_val shape: (5000, 100)
x_test shape: (25000, 100)
Using MAP optimizer with reg_weight:  5e-05
CNN-LSTM

0epoch [00:00, ?epoch/s]
  0%|          | 0/25 [00:00<?, ?epoch/s]2024-03-01 14:28:31.136508: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-01 14:28:31.148989: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-03-01 14:28:32.570188: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 14:28:32.773669: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 14:28:33.551947: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-01 14:28:33.601758: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.

  4%|▍         | 1/25 [00:16<06:32, 16.37s/epoch, loss=0.647, accuracy=0.655, val_loss=0.494, val_accuracy=0.819]
  8%|▊         | 2/25 [00:25<04:40, 12.21s/epoch, loss=0.461, accuracy=0.828, val_loss=0.462, val_accuracy=0.839]
 12%|█▏        | 3/25 [00:33<03:47, 10.34s/epoch, loss=0.44, accuracy=0.859, val_loss=0.507, val_accuracy=0.836] 
 16%|█▌        | 4/25 [00:42<03:19,  9.50s/epoch, loss=0.482, accuracy=0.863, val_loss=0.602, val_accuracy=0.816]
 20%|██        | 5/25 [00:50<03:00,  9.03s/epoch, loss=0.552, accuracy=0.853, val_loss=0.744, val_accuracy=0.787]
 24%|██▍       | 6/25 [00:58<02:45,  8.73s/epoch, loss=0.79, accuracy=0.763, val_loss=0.914, val_accuracy=0.742] 
 28%|██▊       | 7/25 [01:06<02:33,  8.51s/epoch, loss=1.08, accuracy=0.636, val_loss=1.13, val_accuracy=0.548] 
 32%|███▏      | 8/25 [01:14<02:22,  8.36s/epoch, loss=1.11, accuracy=0.597, val_loss=1.04, val_accuracy=0.636]
 36%|███▌      | 9/25 [01:22<02:12,  8.28s/epoch, loss=1.08, accuracy=0.611, val_loss=1.11, val_accuracy=0.625]
 40%|████      | 10/25 [01:30<02:04,  8.28s/epoch, loss=1.03, accuracy=0.622, val_loss=1.01, val_accuracy=0.627]
 44%|████▍     | 11/25 [01:39<01:55,  8.26s/epoch, loss=1.05, accuracy=0.589, val_loss=1.12, val_accuracy=0.55] 
 48%|████▊     | 12/25 [01:47<01:46,  8.19s/epoch, loss=1.05, accuracy=0.557, val_loss=1.05, val_accuracy=0.5] 
 52%|█████▏    | 13/25 [01:55<01:37,  8.15s/epoch, loss=0.994, accuracy=0.548, val_loss=0.984, val_accuracy=0.6]
 56%|█████▌    | 14/25 [02:03<01:29,  8.16s/epoch, loss=0.929, accuracy=0.617, val_loss=0.912, val_accuracy=0.657]
 60%|██████    | 15/25 [02:11<01:21,  8.18s/epoch, loss=0.958, accuracy=0.6, val_loss=0.955, val_accuracy=0.612]  
 64%|██████▍   | 16/25 [02:19<01:13,  8.18s/epoch, loss=0.951, accuracy=0.59, val_loss=0.945, val_accuracy=0.598]
 68%|██████▊   | 17/25 [02:27<01:05,  8.17s/epoch, loss=0.98, accuracy=0.595, val_loss=1.22, val_accuracy=0.578] 
 72%|███████▏  | 18/25 [02:36<00:57,  8.17s/epoch, loss=1.18, accuracy=0.582, val_loss=1.24, val_accuracy=0.503]
 76%|███████▌  | 19/25 [02:44<00:48,  8.15s/epoch, loss=1.15, accuracy=0.56, val_loss=1.1, val_accuracy=0.578]  
 80%|████████  | 20/25 [02:52<00:40,  8.13s/epoch, loss=1.08, accuracy=0.577, val_loss=1.04, val_accuracy=0.579]
 84%|████████▍ | 21/25 [03:00<00:32,  8.16s/epoch, loss=1.03, accuracy=0.555, val_loss=1.02, val_accuracy=0.566]
 88%|████████▊ | 22/25 [03:08<00:24,  8.14s/epoch, loss=0.962, accuracy=0.583, val_loss=0.923, val_accuracy=0.571]
 92%|█████████▏| 23/25 [03:16<00:16,  8.15s/epoch, loss=1.04, accuracy=0.616, val_loss=1.09, val_accuracy=0.612]  
 96%|█████████▌| 24/25 [03:24<00:08,  8.15s/epoch, loss=1.09, accuracy=0.611, val_loss=1.06, val_accuracy=0.622]
100%|██████████| 25/25 [03:33<00:00,  8.15s/epoch, loss=1.09, accuracy=0.614, val_loss=1.12, val_accuracy=0.551]
100%|██████████| 25/25 [03:33<00:00,  8.52s/epoch, loss=1.09, accuracy=0.614, val_loss=1.12, val_accuracy=0.551]
Test score: 0.46260854601860046
Test accuracy: 0.8344799876213074


* * * Run SGD for ID = 20_19. * * *


2024-03-01 14:32:12.737824: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 14:32:19.302702: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 14:32:19.304020: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-01 14:32:19.346390: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 14:32:19.346442: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 14:32:19.350473: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 14:32:19.350589: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 14:32:19.353454: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 14:32:19.354518: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 14:32:19.357466: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 14:32:19.359392: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 14:32:19.365350: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 14:32:19.366193: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 14:32:19.366325: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
<__array_function__ internals>:5: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:159: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_train, y_train = np.array(xs[:idx]), np.array(labels[:idx])
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:160: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_test, y_test = np.array(xs[idx:]), np.array(labels[idx:])
2024-03-01 14:32:26.168572: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-01 14:32:26.169230: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 14:32:26.170271: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 14:32:26.170310: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 14:32:26.170372: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 14:32:26.170398: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 14:32:26.170420: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 14:32:26.170441: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 14:32:26.170461: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 14:32:26.170482: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 14:32:26.170504: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 14:32:26.171044: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 14:32:26.171085: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 14:32:26.742090: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-01 14:32:26.742148: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-01 14:32:26.742158: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-01 14:32:26.743268: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:18:00.0, compute capability: 6.1)
{'id': '20_19', 'seed': 19, 'out_folder': 'results/epoch_budget', 'batch_size': 32, 'epochs': 25, 'validation_split': 0.2, 'checkpointing': True, 'initial_lr': 0.1, 'momentum': 0.98, 'nesterov': True, 'bootstrapping': False, 'map_optimizer': True, 'model': 'CNN-LSTM', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Loading data...
Pad sequences (samples x time)
20000 train sequences
5000 validation sequences
25000 test sequences
x_train shape: (20000, 100)
x_val shape: (5000, 100)
x_test shape: (25000, 100)
Using MAP optimizer with reg_weight:  5e-05
CNN-LSTM

0epoch [00:00, ?epoch/s]
  0%|          | 0/25 [00:00<?, ?epoch/s]2024-03-01 14:32:27.132501: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-01 14:32:27.145073: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-03-01 14:32:28.550563: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 14:32:28.759544: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 14:32:29.528386: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-01 14:32:29.578608: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.

  4%|▍         | 1/25 [00:13<05:34, 13.95s/epoch, loss=0.661, accuracy=0.639, val_loss=0.497, val_accuracy=0.805]
  8%|▊         | 2/25 [00:22<04:08, 10.81s/epoch, loss=0.469, accuracy=0.829, val_loss=0.439, val_accuracy=0.846]
 12%|█▏        | 3/25 [00:30<03:29,  9.54s/epoch, loss=0.426, accuracy=0.861, val_loss=0.495, val_accuracy=0.831]
 16%|█▌        | 4/25 [00:39<03:17,  9.41s/epoch, loss=0.419, accuracy=0.876, val_loss=0.482, val_accuracy=0.851]
 20%|██        | 5/25 [00:47<02:57,  8.88s/epoch, loss=0.429, accuracy=0.888, val_loss=0.584, val_accuracy=0.822]
 24%|██▍       | 6/25 [00:55<02:42,  8.54s/epoch, loss=0.462, accuracy=0.886, val_loss=0.602, val_accuracy=0.831]
 28%|██▊       | 7/25 [01:03<02:30,  8.34s/epoch, loss=0.509, accuracy=0.886, val_loss=0.681, val_accuracy=0.815]
 32%|███▏      | 8/25 [01:11<02:20,  8.24s/epoch, loss=0.799, accuracy=0.793, val_loss=1.07, val_accuracy=0.704] 
 36%|███▌      | 9/25 [01:19<02:10,  8.16s/epoch, loss=1.05, accuracy=0.697, val_loss=1.06, val_accuracy=0.694] 
 40%|████      | 10/25 [01:27<02:01,  8.08s/epoch, loss=1.11, accuracy=0.669, val_loss=1.19, val_accuracy=0.613]
 44%|████▍     | 11/25 [01:35<01:52,  8.04s/epoch, loss=1.12, accuracy=0.656, val_loss=1.13, val_accuracy=0.66] 
 48%|████▊     | 12/25 [01:43<01:44,  8.03s/epoch, loss=1.16, accuracy=0.614, val_loss=1.19, val_accuracy=0.577]
 52%|█████▏    | 13/25 [01:51<01:36,  8.01s/epoch, loss=1.2, accuracy=0.545, val_loss=1.27, val_accuracy=0.502] 
 56%|█████▌    | 14/25 [01:59<01:28,  8.01s/epoch, loss=1.11, accuracy=0.545, val_loss=1.05, val_accuracy=0.57]
 60%|██████    | 15/25 [02:07<01:20,  8.01s/epoch, loss=0.991, accuracy=0.614, val_loss=0.997, val_accuracy=0.586]
 64%|██████▍   | 16/25 [02:15<01:11,  7.97s/epoch, loss=0.985, accuracy=0.584, val_loss=0.967, val_accuracy=0.598]
 68%|██████▊   | 17/25 [02:23<01:03,  7.91s/epoch, loss=0.984, accuracy=0.578, val_loss=0.981, val_accuracy=0.537]
 72%|███████▏  | 18/25 [02:30<00:55,  7.88s/epoch, loss=0.95, accuracy=0.581, val_loss=0.926, val_accuracy=0.58]  
 76%|███████▌  | 19/25 [02:38<00:47,  7.89s/epoch, loss=0.926, accuracy=0.591, val_loss=0.929, val_accuracy=0.58]
 80%|████████  | 20/25 [02:46<00:39,  7.92s/epoch, loss=0.907, accuracy=0.613, val_loss=0.911, val_accuracy=0.617]
 84%|████████▍ | 21/25 [02:54<00:31,  7.95s/epoch, loss=0.914, accuracy=0.599, val_loss=0.928, val_accuracy=0.499]
 88%|████████▊ | 22/25 [03:02<00:23,  7.95s/epoch, loss=0.938, accuracy=0.566, val_loss=0.911, val_accuracy=0.599]
 92%|█████████▏| 23/25 [03:10<00:15,  7.92s/epoch, loss=0.931, accuracy=0.562, val_loss=0.88, val_accuracy=0.589] 
 96%|█████████▌| 24/25 [03:18<00:07,  7.88s/epoch, loss=0.902, accuracy=0.583, val_loss=0.831, val_accuracy=0.645]
100%|██████████| 25/25 [03:26<00:00,  7.84s/epoch, loss=0.879, accuracy=0.596, val_loss=0.841, val_accuracy=0.609]
100%|██████████| 25/25 [03:26<00:00,  8.24s/epoch, loss=0.879, accuracy=0.596, val_loss=0.841, val_accuracy=0.609]
Test score: 0.4917501211166382
Test accuracy: 0.841759979724884


* * * Run SGD for ID = 20_20. * * *


2024-03-01 14:36:00.892496: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 14:36:05.230710: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 14:36:05.232002: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-01 14:36:05.272272: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 14:36:05.272316: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 14:36:05.275814: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 14:36:05.275888: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 14:36:05.278578: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 14:36:05.279757: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 14:36:05.287934: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 14:36:05.289665: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 14:36:05.295433: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 14:36:05.296167: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 14:36:05.296268: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
<__array_function__ internals>:5: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:159: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_train, y_train = np.array(xs[:idx]), np.array(labels[:idx])
/home/gkb738/.conda/envs/TF_KERAS_GPU/lib/python3.9/site-packages/tensorflow/python/keras/datasets/imdb.py:160: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_test, y_test = np.array(xs[idx:]), np.array(labels[idx:])
2024-03-01 14:36:11.446056: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-01 14:36:11.446611: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-01 14:36:11.447311: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-01 14:36:11.447362: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 14:36:11.447424: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 14:36:11.447448: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-01 14:36:11.447478: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-01 14:36:11.447500: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-01 14:36:11.447521: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-01 14:36:11.447543: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-01 14:36:11.447566: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 14:36:11.448149: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-01 14:36:11.448195: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-01 14:36:12.031389: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-01 14:36:12.031452: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-01 14:36:12.031463: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-01 14:36:12.032635: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:18:00.0, compute capability: 6.1)
{'id': '20_20', 'seed': 20, 'out_folder': 'results/epoch_budget', 'batch_size': 32, 'epochs': 25, 'validation_split': 0.2, 'checkpointing': True, 'initial_lr': 0.1, 'momentum': 0.98, 'nesterov': True, 'bootstrapping': False, 'map_optimizer': True, 'model': 'CNN-LSTM', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Loading data...
Pad sequences (samples x time)
20000 train sequences
5000 validation sequences
25000 test sequences
x_train shape: (20000, 100)
x_val shape: (5000, 100)
x_test shape: (25000, 100)
Using MAP optimizer with reg_weight:  5e-05
CNN-LSTM

0epoch [00:00, ?epoch/s]
  0%|          | 0/25 [00:00<?, ?epoch/s]2024-03-01 14:36:12.440909: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-01 14:36:12.453052: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-03-01 14:36:13.875275: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-01 14:36:14.074890: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-01 14:36:14.853855: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-01 14:36:14.909929: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.

  4%|▍         | 1/25 [00:13<05:32, 13.85s/epoch, loss=0.669, accuracy=0.622, val_loss=0.493, val_accuracy=0.806]
  8%|▊         | 2/25 [00:22<04:09, 10.84s/epoch, loss=0.46, accuracy=0.827, val_loss=0.467, val_accuracy=0.836] 
 12%|█▏        | 3/25 [00:30<03:31,  9.62s/epoch, loss=0.417, accuracy=0.862, val_loss=0.479, val_accuracy=0.834]
 16%|█▌        | 4/25 [00:39<03:12,  9.17s/epoch, loss=0.411, accuracy=0.882, val_loss=0.542, val_accuracy=0.84] 
 20%|██        | 5/25 [00:47<02:58,  8.93s/epoch, loss=0.422, accuracy=0.891, val_loss=0.549, val_accuracy=0.845]
 24%|██▍       | 6/25 [00:55<02:44,  8.65s/epoch, loss=0.465, accuracy=0.89, val_loss=0.633, val_accuracy=0.823] 
 28%|██▊       | 7/25 [01:03<02:32,  8.47s/epoch, loss=0.671, accuracy=0.829, val_loss=0.929, val_accuracy=0.722]
 32%|███▏      | 8/25 [01:12<02:21,  8.35s/epoch, loss=1.02, accuracy=0.694, val_loss=1.07, val_accuracy=0.699]  
 36%|███▌      | 9/25 [01:20<02:11,  8.24s/epoch, loss=1.15, accuracy=0.638, val_loss=1.2, val_accuracy=0.577] 
 40%|████      | 10/25 [01:28<02:03,  8.20s/epoch, loss=1.19, accuracy=0.63, val_loss=1.18, val_accuracy=0.657]
 44%|████▍     | 11/25 [01:36<01:54,  8.17s/epoch, loss=1.25, accuracy=0.6, val_loss=1.32, val_accuracy=0.506] 
 48%|████▊     | 12/25 [01:44<01:45,  8.14s/epoch, loss=1.24, accuracy=0.565, val_loss=1.15, val_accuracy=0.625]
 52%|█████▏    | 13/25 [01:52<01:37,  8.15s/epoch, loss=1.13, accuracy=0.569, val_loss=1.04, val_accuracy=0.644]
 56%|█████▌    | 14/25 [02:00<01:29,  8.14s/epoch, loss=1.07, accuracy=0.591, val_loss=1.14, val_accuracy=0.546]
 60%|██████    | 15/25 [02:08<01:21,  8.10s/epoch, loss=1.1, accuracy=0.561, val_loss=1.07, val_accuracy=0.502] 
 64%|██████▍   | 16/25 [02:16<01:12,  8.05s/epoch, loss=1.04, accuracy=0.555, val_loss=0.996, val_accuracy=0.503]
 68%|██████▊   | 17/25 [02:24<01:04,  8.03s/epoch, loss=1, accuracy=0.547, val_loss=0.981, val_accuracy=0.503]   
 72%|███████▏  | 18/25 [02:32<00:56,  8.02s/epoch, loss=0.965, accuracy=0.53, val_loss=1.01, val_accuracy=0.57]
 76%|███████▌  | 19/25 [02:40<00:47,  7.97s/epoch, loss=0.897, accuracy=0.563, val_loss=0.916, val_accuracy=0.569]
 80%|████████  | 20/25 [02:48<00:39,  7.97s/epoch, loss=0.853, accuracy=0.597, val_loss=0.803, val_accuracy=0.654]
 84%|████████▍ | 21/25 [02:56<00:31,  7.97s/epoch, loss=0.825, accuracy=0.656, val_loss=0.855, val_accuracy=0.663]
 88%|████████▊ | 22/25 [03:04<00:23,  7.98s/epoch, loss=0.876, accuracy=0.678, val_loss=0.903, val_accuracy=0.661]
 92%|█████████▏| 23/25 [03:12<00:15,  7.94s/epoch, loss=0.907, accuracy=0.671, val_loss=0.94, val_accuracy=0.644] 
 96%|█████████▌| 24/25 [03:20<00:07,  7.97s/epoch, loss=0.962, accuracy=0.625, val_loss=0.988, val_accuracy=0.588]
100%|██████████| 25/25 [03:28<00:00,  7.99s/epoch, loss=0.936, accuracy=0.64, val_loss=0.922, val_accuracy=0.651] 
100%|██████████| 25/25 [03:28<00:00,  8.33s/epoch, loss=0.936, accuracy=0.64, val_loss=0.922, val_accuracy=0.651]
Test score: 0.5558966994285583
Test accuracy: 0.8437600135803223

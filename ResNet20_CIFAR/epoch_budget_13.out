Tue Mar  5 03:45:11 2024       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 545.23.08              Driver Version: 545.23.08    CUDA Version: 12.3     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA TITAN Xp                Off | 00000000:02:00.0 Off |                  N/A |
| 39%   51C    P8              10W / 250W |      0MiB / 12288MiB |      0%      Default |
|                                         |                      |                  N/A |
+-----------------------------------------+----------------------+----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
|  No running processes found                                                           |
+---------------------------------------------------------------------------------------+


* * * Run SGD for cluster size = 13. * * *


Budget: 115


* * * Run SGD for ID = 13_1. * * *


2024-03-05 03:45:12.333328: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 03:45:17.210774: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 03:45:17.212399: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-05 03:45:17.253834: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-05 03:45:17.253865: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 03:45:17.266566: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 03:45:17.266618: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-05 03:45:17.286119: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-05 03:45:17.312963: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-05 03:45:17.339165: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-05 03:45:17.353450: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-05 03:45:17.370036: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 03:45:17.370742: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-05 03:45:17.370831: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 03:45:18.694362: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-05 03:45:18.695398: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 03:45:18.695859: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-05 03:45:18.695889: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 03:45:18.695927: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 03:45:18.695944: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-05 03:45:18.695966: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-05 03:45:18.695983: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-05 03:45:18.695999: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-05 03:45:18.696015: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-05 03:45:18.696032: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 03:45:18.696498: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-05 03:45:18.696530: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 03:45:19.582981: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-05 03:45:19.583041: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-05 03:45:19.583058: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-05 03:45:19.583965: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:02:00.0, compute capability: 6.1)
{'id': '13_01', 'seed': 1, 'out_folder': 'results/epoch_budget', 'batch_size': 128, 'epochs': 115, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/115 [00:00<?, ?epoch/s]2024-03-05 03:45:20.404624: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-05 03:45:20.417216: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199825000 Hz
2024-03-05 03:45:22.385616: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 03:45:22.586526: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 03:45:23.405613: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-05 03:45:23.469380: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/115 [00:52<1:39:21, 52.30s/epoch, loss=3.23, accuracy=0.237, val_loss=2.39, val_accuracy=0.249, lr=0.1]  2%|▏         | 2/115 [01:15<1:05:54, 34.99s/epoch, loss=1.6, accuracy=0.496, val_loss=4.38, val_accuracy=0.259, lr=0.1]   3%|▎         | 3/115 [01:39<55:48, 29.89s/epoch, loss=1.41, accuracy=0.599, val_loss=2.25, val_accuracy=0.411, lr=0.1]   3%|▎         | 4/115 [02:02<50:55, 27.52s/epoch, loss=1.31, accuracy=0.661, val_loss=1.98, val_accuracy=0.441, lr=0.1]  4%|▍         | 5/115 [02:26<47:43, 26.03s/epoch, loss=1.27, accuracy=0.69, val_loss=1.85, val_accuracy=0.456, lr=0.1]   5%|▌         | 6/115 [02:48<44:54, 24.72s/epoch, loss=1.26, accuracy=0.7, val_loss=2.95, val_accuracy=0.383, lr=0.1]   6%|▌         | 7/115 [03:12<43:52, 24.37s/epoch, loss=1.24, accuracy=0.71, val_loss=1.65, val_accuracy=0.57, lr=0.1]  7%|▋         | 8/115 [03:34<42:34, 23.87s/epoch, loss=1.23, accuracy=0.718, val_loss=2.2, val_accuracy=0.501, lr=0.1]  8%|▊         | 9/115 [03:58<42:01, 23.79s/epoch, loss=1.22, accuracy=0.721, val_loss=2.76, val_accuracy=0.382, lr=0.1]  9%|▊         | 10/115 [04:20<40:49, 23.33s/epoch, loss=1.21, accuracy=0.723, val_loss=1.7, val_accuracy=0.574, lr=0.1] 10%|▉         | 11/115 [04:42<39:48, 22.96s/epoch, loss=1.2, accuracy=0.73, val_loss=3.49, val_accuracy=0.338, lr=0.1]  10%|█         | 12/115 [05:06<39:44, 23.15s/epoch, loss=1.2, accuracy=0.729, val_loss=2.22, val_accuracy=0.512, lr=0.0316] 11%|█▏        | 13/115 [05:29<39:03, 22.98s/epoch, loss=1.19, accuracy=0.731, val_loss=3.81, val_accuracy=0.195, lr=0.1]   12%|█▏        | 14/115 [05:51<38:37, 22.94s/epoch, loss=1.19, accuracy=0.735, val_loss=2.44, val_accuracy=0.367, lr=0.1] 13%|█▎        | 15/115 [06:15<38:32, 23.12s/epoch, loss=1.18, accuracy=0.736, val_loss=2.65, val_accuracy=0.432, lr=0.1] 14%|█▍        | 16/115 [06:38<38:17, 23.21s/epoch, loss=1.18, accuracy=0.736, val_loss=2.18, val_accuracy=0.479, lr=0.1] 15%|█▍        | 17/115 [07:02<38:00, 23.28s/epoch, loss=1.18, accuracy=0.739, val_loss=1.91, val_accuracy=0.491, lr=0.0316] 16%|█▌        | 18/115 [07:24<36:59, 22.88s/epoch, loss=1.17, accuracy=0.744, val_loss=2.25, val_accuracy=0.461, lr=0.1]    17%|█▋        | 19/115 [07:46<36:11, 22.62s/epoch, loss=1.18, accuracy=0.737, val_loss=3.87, val_accuracy=0.32, lr=0.1]  17%|█▋        | 20/115 [08:09<36:11, 22.86s/epoch, loss=1.17, accuracy=0.741, val_loss=3.55, val_accuracy=0.363, lr=0.1] 18%|█▊        | 21/115 [08:33<36:12, 23.11s/epoch, loss=1.16, accuracy=0.743, val_loss=3.68, val_accuracy=0.331, lr=0.1] 19%|█▉        | 22/115 [08:57<36:08, 23.31s/epoch, loss=1.16, accuracy=0.745, val_loss=1.59, val_accuracy=0.614, lr=0.1] 20%|██        | 23/115 [09:20<35:33, 23.19s/epoch, loss=1.16, accuracy=0.748, val_loss=1.74, val_accuracy=0.578, lr=0.1] 21%|██        | 24/115 [09:42<34:54, 23.02s/epoch, loss=1.16, accuracy=0.745, val_loss=2, val_accuracy=0.51, lr=0.1]     22%|██▏       | 25/115 [10:06<34:51, 23.24s/epoch, loss=1.15, accuracy=0.746, val_loss=1.86, val_accuracy=0.521, lr=0.1] 23%|██▎       | 26/115 [10:29<34:13, 23.08s/epoch, loss=1.16, accuracy=0.746, val_loss=1.97, val_accuracy=0.444, lr=0.1] 23%|██▎       | 27/115 [10:51<33:32, 22.87s/epoch, loss=1.15, accuracy=0.747, val_loss=6.39, val_accuracy=0.149, lr=0.0316] 24%|██▍       | 28/115 [11:15<33:27, 23.07s/epoch, loss=1.16, accuracy=0.749, val_loss=1.62, val_accuracy=0.582, lr=0.1]    25%|██▌       | 29/115 [11:38<33:16, 23.21s/epoch, loss=1.15, accuracy=0.748, val_loss=5.06, val_accuracy=0.23, lr=0.1]  26%|██▌       | 30/115 [12:00<32:26, 22.90s/epoch, loss=1.15, accuracy=0.747, val_loss=2.13, val_accuracy=0.412, lr=0.1] 27%|██▋       | 31/115 [12:23<31:45, 22.68s/epoch, loss=1.14, accuracy=0.75, val_loss=2.11, val_accuracy=0.497, lr=0.1]  28%|██▊       | 32/115 [12:46<31:45, 22.96s/epoch, loss=1.15, accuracy=0.746, val_loss=1.51, val_accuracy=0.629, lr=0.1] 29%|██▊       | 33/115 [13:09<31:30, 23.06s/epoch, loss=1.15, accuracy=0.749, val_loss=2.66, val_accuracy=0.443, lr=0.1] 30%|██▉       | 34/115 [13:32<31:00, 22.97s/epoch, loss=1.14, accuracy=0.753, val_loss=3.09, val_accuracy=0.247, lr=0.1] 30%|███       | 35/115 [13:56<30:57, 23.22s/epoch, loss=1.14, accuracy=0.752, val_loss=2.95, val_accuracy=0.389, lr=0.1] 31%|███▏      | 36/115 [14:18<30:07, 22.88s/epoch, loss=1.14, accuracy=0.75, val_loss=1.97, val_accuracy=0.435, lr=0.1]  32%|███▏      | 37/115 [14:41<29:57, 23.05s/epoch, loss=1.13, accuracy=0.752, val_loss=1.98, val_accuracy=0.525, lr=0.0316] 33%|███▎      | 38/115 [15:05<29:49, 23.24s/epoch, loss=1.14, accuracy=0.755, val_loss=2.94, val_accuracy=0.323, lr=0.1]    34%|███▍      | 39/115 [15:27<29:03, 22.94s/epoch, loss=1.15, accuracy=0.752, val_loss=4.66, val_accuracy=0.271, lr=0.1] 35%|███▍      | 40/115 [15:51<28:50, 23.08s/epoch, loss=1.14, accuracy=0.754, val_loss=2.43, val_accuracy=0.342, lr=0.1] 36%|███▌      | 41/115 [16:13<28:16, 22.93s/epoch, loss=1.14, accuracy=0.755, val_loss=1.81, val_accuracy=0.54, lr=0.1]  37%|███▋      | 42/115 [16:37<28:05, 23.09s/epoch, loss=1.14, accuracy=0.753, val_loss=1.8, val_accuracy=0.533, lr=0.0316] 37%|███▋      | 43/115 [17:00<27:52, 23.22s/epoch, loss=1.13, accuracy=0.755, val_loss=4.23, val_accuracy=0.228, lr=0.1]   38%|███▊      | 44/115 [17:22<27:03, 22.86s/epoch, loss=1.13, accuracy=0.754, val_loss=1.91, val_accuracy=0.564, lr=0.1] 39%|███▉      | 45/115 [17:46<26:50, 23.00s/epoch, loss=1.13, accuracy=0.752, val_loss=2.06, val_accuracy=0.455, lr=0.1] 40%|████      | 46/115 [18:08<26:20, 22.90s/epoch, loss=1.13, accuracy=0.754, val_loss=4.97, val_accuracy=0.253, lr=0.1] 41%|████      | 47/115 [18:32<26:11, 23.11s/epoch, loss=1.13, accuracy=0.756, val_loss=2.95, val_accuracy=0.426, lr=0.0316] 42%|████▏     | 48/115 [18:56<26:00, 23.30s/epoch, loss=1.13, accuracy=0.757, val_loss=2.01, val_accuracy=0.494, lr=0.1]    43%|████▎     | 49/115 [19:19<25:41, 23.36s/epoch, loss=1.13, accuracy=0.753, val_loss=2.41, val_accuracy=0.39, lr=0.1]  43%|████▎     | 50/115 [19:43<25:26, 23.49s/epoch, loss=1.13, accuracy=0.753, val_loss=1.68, val_accuracy=0.566, lr=0.1] 44%|████▍     | 51/115 [20:06<25:02, 23.47s/epoch, loss=1.13, accuracy=0.755, val_loss=1.99, val_accuracy=0.524, lr=0.1] 45%|████▌     | 52/115 [20:30<24:43, 23.54s/epoch, loss=1.13, accuracy=0.755, val_loss=1.78, val_accuracy=0.531, lr=0.0316] 46%|████▌     | 53/115 [20:54<24:19, 23.54s/epoch, loss=1.13, accuracy=0.753, val_loss=1.98, val_accuracy=0.494, lr=0.1]    47%|████▋     | 54/115 [21:16<23:37, 23.23s/epoch, loss=1.13, accuracy=0.755, val_loss=1.87, val_accuracy=0.529, lr=0.1] 48%|████▊     | 55/115 [21:40<23:24, 23.41s/epoch, loss=1.12, accuracy=0.754, val_loss=2.19, val_accuracy=0.467, lr=0.1] 49%|████▊     | 56/115 [22:04<23:04, 23.46s/epoch, loss=1.12, accuracy=0.756, val_loss=2.31, val_accuracy=0.39, lr=0.1]  50%|████▉     | 57/115 [22:26<22:27, 23.23s/epoch, loss=1.13, accuracy=0.753, val_loss=2.5, val_accuracy=0.421, lr=0.0316] 50%|█████     | 58/115 [22:48<21:44, 22.88s/epoch, loss=1.12, accuracy=0.755, val_loss=3.65, val_accuracy=0.366, lr=0.1]   51%|█████▏    | 59/115 [23:12<21:32, 23.08s/epoch, loss=1.12, accuracy=0.756, val_loss=5, val_accuracy=0.265, lr=0.1]    52%|█████▏    | 60/115 [23:36<21:18, 23.24s/epoch, loss=1.12, accuracy=0.755, val_loss=2.1, val_accuracy=0.51, lr=0.1] 53%|█████▎    | 61/115 [23:58<20:38, 22.93s/epoch, loss=1.12, accuracy=0.757, val_loss=2.54, val_accuracy=0.498, lr=0.1] 54%|█████▍    | 62/115 [24:21<20:24, 23.09s/epoch, loss=1.12, accuracy=0.758, val_loss=1.59, val_accuracy=0.609, lr=0.0316] 55%|█████▍    | 63/115 [24:45<20:08, 23.23s/epoch, loss=1.12, accuracy=0.758, val_loss=2.81, val_accuracy=0.383, lr=0.1]    56%|█████▌    | 64/115 [25:08<19:49, 23.33s/epoch, loss=1.12, accuracy=0.757, val_loss=1.97, val_accuracy=0.528, lr=0.1] 57%|█████▋    | 65/115 [25:32<19:29, 23.40s/epoch, loss=1.12, accuracy=0.756, val_loss=2.47, val_accuracy=0.414, lr=0.1] 57%|█████▋    | 66/115 [25:55<19:06, 23.41s/epoch, loss=1.11, accuracy=0.759, val_loss=2.17, val_accuracy=0.429, lr=0.1] 58%|█████▊    | 67/115 [26:19<18:45, 23.45s/epoch, loss=1.11, accuracy=0.757, val_loss=1.68, val_accuracy=0.566, lr=0.0316] 59%|█████▉    | 68/115 [26:41<18:02, 23.02s/epoch, loss=1.12, accuracy=0.759, val_loss=3.08, val_accuracy=0.367, lr=0.1]    60%|██████    | 69/115 [27:05<17:47, 23.20s/epoch, loss=1.12, accuracy=0.756, val_loss=3.78, val_accuracy=0.248, lr=0.1] 61%|██████    | 70/115 [27:28<17:25, 23.23s/epoch, loss=1.12, accuracy=0.757, val_loss=2.35, val_accuracy=0.376, lr=0.1] 62%|██████▏   | 71/115 [27:50<16:48, 22.92s/epoch, loss=1.12, accuracy=0.756, val_loss=3.14, val_accuracy=0.292, lr=0.1] 63%|██████▎   | 72/115 [28:12<16:12, 22.62s/epoch, loss=1.12, accuracy=0.76, val_loss=2.35, val_accuracy=0.416, lr=0.0316] 63%|██████▎   | 73/115 [28:34<15:42, 22.43s/epoch, loss=1.12, accuracy=0.757, val_loss=2.28, val_accuracy=0.489, lr=0.1]   64%|██████▍   | 74/115 [28:57<15:24, 22.55s/epoch, loss=1.12, accuracy=0.756, val_loss=2.32, val_accuracy=0.408, lr=0.1] 65%|██████▌   | 75/115 [29:20<15:04, 22.61s/epoch, loss=1.12, accuracy=0.759, val_loss=1.99, val_accuracy=0.506, lr=0.1] 66%|██████▌   | 76/115 [29:43<14:51, 22.86s/epoch, loss=1.12, accuracy=0.756, val_loss=2.36, val_accuracy=0.426, lr=0.1] 67%|██████▋   | 77/115 [30:07<14:39, 23.14s/epoch, loss=1.12, accuracy=0.757, val_loss=1.91, val_accuracy=0.493, lr=0.0316] 68%|██████▊   | 78/115 [30:30<14:20, 23.26s/epoch, loss=1.12, accuracy=0.76, val_loss=4.5, val_accuracy=0.268, lr=0.1]      69%|██████▊   | 79/115 [30:54<14:01, 23.38s/epoch, loss=1.12, accuracy=0.757, val_loss=2.66, val_accuracy=0.338, lr=0.1] 70%|██████▉   | 80/115 [31:18<13:40, 23.45s/epoch, loss=1.12, accuracy=0.755, val_loss=2.22, val_accuracy=0.446, lr=0.1] 70%|███████   | 81/115 [31:40<13:11, 23.27s/epoch, loss=1.11, accuracy=0.757, val_loss=3.14, val_accuracy=0.252, lr=0.1] 71%|███████▏  | 82/115 [32:04<12:49, 23.33s/epoch, loss=0.906, accuracy=0.815, val_loss=0.938, val_accuracy=0.79, lr=0.01] 72%|███████▏  | 83/115 [32:27<12:21, 23.18s/epoch, loss=0.724, accuracy=0.848, val_loss=0.77, val_accuracy=0.822, lr=0.01] 73%|███████▎  | 84/115 [32:50<11:56, 23.12s/epoch, loss=0.649, accuracy=0.854, val_loss=1.23, val_accuracy=0.678, lr=0.01] 74%|███████▍  | 85/115 [33:13<11:32, 23.09s/epoch, loss=0.602, accuracy=0.859, val_loss=0.694, val_accuracy=0.825, lr=0.01] 75%|███████▍  | 86/115 [33:36<11:08, 23.06s/epoch, loss=0.58, accuracy=0.863, val_loss=0.779, val_accuracy=0.798, lr=0.01]  76%|███████▌  | 87/115 [33:59<10:45, 23.06s/epoch, loss=0.566, accuracy=0.861, val_loss=0.865, val_accuracy=0.761, lr=0.01] 77%|███████▋  | 88/115 [34:22<10:25, 23.17s/epoch, loss=0.565, accuracy=0.863, val_loss=0.733, val_accuracy=0.811, lr=0.01] 77%|███████▋  | 89/115 [34:45<10:03, 23.20s/epoch, loss=0.562, accuracy=0.863, val_loss=0.818, val_accuracy=0.789, lr=0.01] 78%|███████▊  | 90/115 [35:09<09:39, 23.18s/epoch, loss=0.557, accuracy=0.866, val_loss=0.855, val_accuracy=0.776, lr=0.00316] 79%|███████▉  | 91/115 [35:32<09:18, 23.27s/epoch, loss=0.553, accuracy=0.869, val_loss=0.74, val_accuracy=0.81, lr=0.01]      80%|████████  | 92/115 [35:55<08:50, 23.05s/epoch, loss=0.553, accuracy=0.871, val_loss=1.21, val_accuracy=0.71, lr=0.01] 81%|████████  | 93/115 [36:18<08:29, 23.17s/epoch, loss=0.559, accuracy=0.869, val_loss=1.41, val_accuracy=0.663, lr=0.01] 82%|████████▏ | 94/115 [36:41<08:06, 23.18s/epoch, loss=0.553, accuracy=0.87, val_loss=0.927, val_accuracy=0.749, lr=0.01] 83%|████████▎ | 95/115 [37:04<07:38, 22.94s/epoch, loss=0.554, accuracy=0.87, val_loss=0.793, val_accuracy=0.8, lr=0.00316] 83%|████████▎ | 96/115 [37:27<07:18, 23.09s/epoch, loss=0.555, accuracy=0.872, val_loss=0.776, val_accuracy=0.805, lr=0.01] 84%|████████▍ | 97/115 [37:50<06:55, 23.06s/epoch, loss=0.552, accuracy=0.874, val_loss=0.76, val_accuracy=0.804, lr=0.01]  85%|████████▌ | 98/115 [38:13<06:30, 22.98s/epoch, loss=0.555, accuracy=0.873, val_loss=0.831, val_accuracy=0.782, lr=0.01] 86%|████████▌ | 99/115 [38:35<06:03, 22.75s/epoch, loss=0.553, accuracy=0.874, val_loss=0.907, val_accuracy=0.768, lr=0.01] 87%|████████▋ | 100/115 [38:58<05:40, 22.68s/epoch, loss=0.553, accuracy=0.874, val_loss=0.774, val_accuracy=0.808, lr=0.00316] 88%|████████▊ | 101/115 [39:20<05:16, 22.64s/epoch, loss=0.555, accuracy=0.874, val_loss=0.708, val_accuracy=0.823, lr=0.01]    89%|████████▊ | 102/115 [39:43<04:57, 22.86s/epoch, loss=0.548, accuracy=0.877, val_loss=1.11, val_accuracy=0.731, lr=0.01]  90%|████████▉ | 103/115 [40:07<04:35, 22.99s/epoch, loss=0.549, accuracy=0.877, val_loss=1.67, val_accuracy=0.622, lr=0.01] 90%|█████████ | 104/115 [40:30<04:14, 23.11s/epoch, loss=0.551, accuracy=0.878, val_loss=0.825, val_accuracy=0.793, lr=0.01] 91%|█████████▏| 105/115 [40:53<03:50, 23.04s/epoch, loss=0.546, accuracy=0.878, val_loss=1.04, val_accuracy=0.742, lr=0.00316] 92%|█████████▏| 106/115 [41:15<03:25, 22.83s/epoch, loss=0.545, accuracy=0.879, val_loss=0.913, val_accuracy=0.777, lr=0.01]   93%|█████████▎| 107/115 [41:38<03:03, 22.90s/epoch, loss=0.548, accuracy=0.878, val_loss=0.812, val_accuracy=0.79, lr=0.01]  94%|█████████▍| 108/115 [42:00<02:37, 22.56s/epoch, loss=0.545, accuracy=0.881, val_loss=0.834, val_accuracy=0.789, lr=0.01] 95%|█████████▍| 109/115 [42:24<02:16, 22.79s/epoch, loss=0.55, accuracy=0.88, val_loss=0.9, val_accuracy=0.765, lr=0.01]     96%|█████████▌| 110/115 [42:45<01:52, 22.47s/epoch, loss=0.549, accuracy=0.88, val_loss=0.985, val_accuracy=0.747, lr=0.00316] 97%|█████████▋| 111/115 [43:08<01:30, 22.51s/epoch, loss=0.546, accuracy=0.882, val_loss=1.52, val_accuracy=0.644, lr=0.01]    97%|█████████▋| 112/115 [43:31<01:08, 22.74s/epoch, loss=0.551, accuracy=0.88, val_loss=0.764, val_accuracy=0.815, lr=0.01] 98%|█████████▊| 113/115 [43:54<00:45, 22.84s/epoch, loss=0.547, accuracy=0.881, val_loss=1.02, val_accuracy=0.746, lr=0.01] 99%|█████████▉| 114/115 [44:17<00:22, 22.95s/epoch, loss=0.546, accuracy=0.884, val_loss=1.07, val_accuracy=0.733, lr=0.01]100%|██████████| 115/115 [44:41<00:00, 23.04s/epoch, loss=0.548, accuracy=0.883, val_loss=0.765, val_accuracy=0.808, lr=0.00316]100%|██████████| 115/115 [44:41<00:00, 23.31s/epoch, loss=0.548, accuracy=0.883, val_loss=0.765, val_accuracy=0.808, lr=0.00316]
Using real-time data augmentation.
Test score: 0.7653610110282898
Test accuracy: 0.8079000115394592


* * * Run SGD for ID = 13_2. * * *


2024-03-05 04:30:05.382235: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 04:30:09.306276: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 04:30:09.307353: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-05 04:30:09.348850: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-05 04:30:09.348900: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 04:30:09.351880: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 04:30:09.351926: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-05 04:30:09.354379: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-05 04:30:09.355070: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-05 04:30:09.357654: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-05 04:30:09.359186: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-05 04:30:09.364153: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 04:30:09.364735: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-05 04:30:09.364821: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 04:30:10.722405: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-05 04:30:10.722968: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 04:30:10.723474: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-05 04:30:10.723506: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 04:30:10.723539: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 04:30:10.723557: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-05 04:30:10.723574: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-05 04:30:10.723591: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-05 04:30:10.723608: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-05 04:30:10.723624: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-05 04:30:10.723641: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 04:30:10.724147: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-05 04:30:10.724183: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 04:30:11.390016: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-05 04:30:11.390125: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-05 04:30:11.390138: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-05 04:30:11.392820: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:02:00.0, compute capability: 6.1)
{'id': '13_02', 'seed': 2, 'out_folder': 'results/epoch_budget', 'batch_size': 128, 'epochs': 115, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/115 [00:00<?, ?epoch/s]2024-03-05 04:30:12.518505: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-05 04:30:12.530182: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199825000 Hz
2024-03-05 04:30:14.640527: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 04:30:14.857891: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 04:30:15.651874: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-05 04:30:15.692808: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/115 [00:50<1:35:12, 50.11s/epoch, loss=2.74, accuracy=0.437, val_loss=2.07, val_accuracy=0.408, lr=0.1]  2%|▏         | 2/115 [01:13<1:04:31, 34.27s/epoch, loss=1.41, accuracy=0.618, val_loss=2.22, val_accuracy=0.38, lr=0.1]   3%|▎         | 3/115 [01:37<55:11, 29.57s/epoch, loss=1.29, accuracy=0.674, val_loss=3.18, val_accuracy=0.328, lr=0.1]   3%|▎         | 4/115 [02:01<50:39, 27.38s/epoch, loss=1.25, accuracy=0.701, val_loss=2.81, val_accuracy=0.299, lr=0.1]  4%|▍         | 5/115 [02:25<47:51, 26.10s/epoch, loss=1.24, accuracy=0.708, val_loss=1.69, val_accuracy=0.567, lr=0.1]  5%|▌         | 6/115 [02:49<46:10, 25.41s/epoch, loss=1.22, accuracy=0.718, val_loss=2.01, val_accuracy=0.479, lr=0.1]  6%|▌         | 7/115 [03:13<45:09, 25.09s/epoch, loss=1.21, accuracy=0.721, val_loss=1.59, val_accuracy=0.613, lr=0.1]  7%|▋         | 8/115 [03:37<44:02, 24.70s/epoch, loss=1.2, accuracy=0.726, val_loss=1.75, val_accuracy=0.54, lr=0.1]    8%|▊         | 9/115 [04:00<42:54, 24.29s/epoch, loss=1.2, accuracy=0.729, val_loss=2.17, val_accuracy=0.46, lr=0.1]  9%|▊         | 10/115 [04:24<42:11, 24.11s/epoch, loss=1.2, accuracy=0.731, val_loss=2.17, val_accuracy=0.469, lr=0.1] 10%|▉         | 11/115 [04:47<41:11, 23.76s/epoch, loss=1.19, accuracy=0.737, val_loss=2.65, val_accuracy=0.456, lr=0.1] 10%|█         | 12/115 [05:11<40:49, 23.78s/epoch, loss=1.19, accuracy=0.736, val_loss=1.72, val_accuracy=0.56, lr=0.0316] 11%|█▏        | 13/115 [05:34<40:08, 23.62s/epoch, loss=1.18, accuracy=0.739, val_loss=1.84, val_accuracy=0.554, lr=0.1]   12%|█▏        | 14/115 [05:56<39:07, 23.24s/epoch, loss=1.18, accuracy=0.74, val_loss=1.61, val_accuracy=0.566, lr=0.1]  13%|█▎        | 15/115 [06:20<38:51, 23.31s/epoch, loss=1.17, accuracy=0.743, val_loss=1.46, val_accuracy=0.645, lr=0.1] 14%|█▍        | 16/115 [06:44<38:37, 23.41s/epoch, loss=1.17, accuracy=0.744, val_loss=1.82, val_accuracy=0.558, lr=0.1] 15%|█▍        | 17/115 [07:07<38:24, 23.51s/epoch, loss=1.17, accuracy=0.746, val_loss=1.55, val_accuracy=0.586, lr=0.1] 16%|█▌        | 18/115 [07:30<37:46, 23.36s/epoch, loss=1.17, accuracy=0.745, val_loss=1.68, val_accuracy=0.55, lr=0.1]  17%|█▋        | 19/115 [07:53<36:51, 23.03s/epoch, loss=1.17, accuracy=0.746, val_loss=1.96, val_accuracy=0.54, lr=0.1] 17%|█▋        | 20/115 [08:16<36:49, 23.25s/epoch, loss=1.17, accuracy=0.747, val_loss=4.57, val_accuracy=0.237, lr=0.0316] 18%|█▊        | 21/115 [08:41<36:55, 23.57s/epoch, loss=1.16, accuracy=0.749, val_loss=1.5, val_accuracy=0.626, lr=0.1]     19%|█▉        | 22/115 [09:04<36:17, 23.41s/epoch, loss=1.16, accuracy=0.75, val_loss=1.74, val_accuracy=0.566, lr=0.1] 20%|██        | 23/115 [09:27<35:54, 23.42s/epoch, loss=1.16, accuracy=0.751, val_loss=1.99, val_accuracy=0.563, lr=0.1] 21%|██        | 24/115 [09:50<35:09, 23.19s/epoch, loss=1.16, accuracy=0.748, val_loss=1.85, val_accuracy=0.542, lr=0.1] 22%|██▏       | 25/115 [10:14<35:02, 23.36s/epoch, loss=1.16, accuracy=0.751, val_loss=1.76, val_accuracy=0.516, lr=0.0316] 23%|██▎       | 26/115 [10:38<34:54, 23.53s/epoch, loss=1.15, accuracy=0.751, val_loss=1.84, val_accuracy=0.533, lr=0.1]    23%|██▎       | 27/115 [11:01<34:20, 23.41s/epoch, loss=1.16, accuracy=0.749, val_loss=1.38, val_accuracy=0.677, lr=0.1] 24%|██▍       | 28/115 [11:24<34:01, 23.46s/epoch, loss=1.16, accuracy=0.749, val_loss=1.86, val_accuracy=0.533, lr=0.1] 25%|██▌       | 29/115 [11:48<33:37, 23.45s/epoch, loss=1.15, accuracy=0.75, val_loss=1.73, val_accuracy=0.559, lr=0.1]  26%|██▌       | 30/115 [12:11<33:10, 23.42s/epoch, loss=1.15, accuracy=0.75, val_loss=5.52, val_accuracy=0.16, lr=0.1]  27%|██▋       | 31/115 [12:34<32:44, 23.39s/epoch, loss=1.15, accuracy=0.752, val_loss=1.57, val_accuracy=0.593, lr=0.1] 28%|██▊       | 32/115 [12:56<31:50, 23.02s/epoch, loss=1.15, accuracy=0.749, val_loss=2.72, val_accuracy=0.3, lr=0.0316] 29%|██▊       | 33/115 [13:20<31:38, 23.15s/epoch, loss=1.14, accuracy=0.752, val_loss=1.64, val_accuracy=0.594, lr=0.1]  30%|██▉       | 34/115 [13:43<31:23, 23.25s/epoch, loss=1.14, accuracy=0.752, val_loss=1.5, val_accuracy=0.638, lr=0.1]  30%|███       | 35/115 [14:06<30:51, 23.14s/epoch, loss=1.14, accuracy=0.755, val_loss=2.9, val_accuracy=0.34, lr=0.1]  31%|███▏      | 36/115 [14:30<30:34, 23.22s/epoch, loss=1.14, accuracy=0.752, val_loss=2.17, val_accuracy=0.476, lr=0.1] 32%|███▏      | 37/115 [14:53<30:06, 23.16s/epoch, loss=1.14, accuracy=0.753, val_loss=1.83, val_accuracy=0.518, lr=0.0316] 33%|███▎      | 38/115 [15:16<29:44, 23.18s/epoch, loss=1.15, accuracy=0.75, val_loss=3.46, val_accuracy=0.301, lr=0.1]     34%|███▍      | 39/115 [15:39<29:29, 23.28s/epoch, loss=1.14, accuracy=0.755, val_loss=1.78, val_accuracy=0.562, lr=0.1] 35%|███▍      | 40/115 [16:03<29:08, 23.31s/epoch, loss=1.13, accuracy=0.755, val_loss=2.04, val_accuracy=0.525, lr=0.1] 36%|███▌      | 41/115 [16:26<28:42, 23.28s/epoch, loss=1.14, accuracy=0.754, val_loss=1.78, val_accuracy=0.551, lr=0.1] 37%|███▋      | 42/115 [16:49<28:20, 23.29s/epoch, loss=1.14, accuracy=0.755, val_loss=2.16, val_accuracy=0.516, lr=0.0316] 37%|███▋      | 43/115 [17:12<27:47, 23.16s/epoch, loss=1.14, accuracy=0.755, val_loss=1.66, val_accuracy=0.546, lr=0.1]    38%|███▊      | 44/115 [17:34<27:01, 22.83s/epoch, loss=1.14, accuracy=0.753, val_loss=1.38, val_accuracy=0.67, lr=0.1]  39%|███▉      | 45/115 [17:58<26:51, 23.02s/epoch, loss=1.14, accuracy=0.755, val_loss=2.85, val_accuracy=0.373, lr=0.1] 40%|████      | 46/115 [18:21<26:39, 23.19s/epoch, loss=1.13, accuracy=0.756, val_loss=1.62, val_accuracy=0.598, lr=0.1] 41%|████      | 47/115 [18:44<26:13, 23.13s/epoch, loss=1.14, accuracy=0.755, val_loss=2.56, val_accuracy=0.381, lr=0.1] 42%|████▏     | 48/115 [19:08<26:04, 23.35s/epoch, loss=1.13, accuracy=0.754, val_loss=2.57, val_accuracy=0.399, lr=0.1] 43%|████▎     | 49/115 [19:32<25:40, 23.35s/epoch, loss=1.14, accuracy=0.754, val_loss=1.97, val_accuracy=0.5, lr=0.0316] 43%|████▎     | 50/115 [19:54<25:02, 23.11s/epoch, loss=1.13, accuracy=0.756, val_loss=2.92, val_accuracy=0.375, lr=0.1]  44%|████▍     | 51/115 [20:18<24:49, 23.27s/epoch, loss=1.13, accuracy=0.756, val_loss=2.74, val_accuracy=0.354, lr=0.1] 45%|████▌     | 52/115 [20:40<24:07, 22.98s/epoch, loss=1.13, accuracy=0.758, val_loss=1.86, val_accuracy=0.574, lr=0.1] 46%|████▌     | 53/115 [21:04<23:55, 23.15s/epoch, loss=1.13, accuracy=0.756, val_loss=2.6, val_accuracy=0.454, lr=0.1]  47%|████▋     | 54/115 [21:27<23:37, 23.24s/epoch, loss=1.14, accuracy=0.755, val_loss=1.6, val_accuracy=0.586, lr=0.0316] 48%|████▊     | 55/115 [21:49<22:57, 22.96s/epoch, loss=1.12, accuracy=0.757, val_loss=1.85, val_accuracy=0.497, lr=0.1]   49%|████▊     | 56/115 [22:13<22:44, 23.13s/epoch, loss=1.13, accuracy=0.757, val_loss=2.11, val_accuracy=0.507, lr=0.1] 50%|████▉     | 57/115 [22:36<22:29, 23.27s/epoch, loss=1.13, accuracy=0.756, val_loss=2.34, val_accuracy=0.422, lr=0.1] 50%|█████     | 58/115 [22:59<21:55, 23.08s/epoch, loss=1.13, accuracy=0.755, val_loss=2.73, val_accuracy=0.455, lr=0.1] 51%|█████▏    | 59/115 [23:23<21:39, 23.20s/epoch, loss=1.14, accuracy=0.753, val_loss=2.48, val_accuracy=0.461, lr=0.0316] 52%|█████▏    | 60/115 [23:46<21:24, 23.36s/epoch, loss=1.12, accuracy=0.757, val_loss=2.84, val_accuracy=0.393, lr=0.1]    53%|█████▎    | 61/115 [24:10<21:04, 23.41s/epoch, loss=1.13, accuracy=0.755, val_loss=1.82, val_accuracy=0.533, lr=0.1] 54%|█████▍    | 62/115 [24:34<20:45, 23.50s/epoch, loss=1.13, accuracy=0.756, val_loss=1.7, val_accuracy=0.572, lr=0.1]  55%|█████▍    | 63/115 [24:56<20:12, 23.32s/epoch, loss=1.13, accuracy=0.756, val_loss=3.09, val_accuracy=0.367, lr=0.1] 56%|█████▌    | 64/115 [25:19<19:42, 23.19s/epoch, loss=1.13, accuracy=0.756, val_loss=5.09, val_accuracy=0.301, lr=0.0316] 57%|█████▋    | 65/115 [25:43<19:26, 23.34s/epoch, loss=1.13, accuracy=0.757, val_loss=2.3, val_accuracy=0.468, lr=0.1]     57%|█████▋    | 66/115 [26:06<19:01, 23.29s/epoch, loss=1.13, accuracy=0.756, val_loss=2, val_accuracy=0.509, lr=0.1]   58%|█████▊    | 67/115 [26:30<18:42, 23.39s/epoch, loss=1.13, accuracy=0.756, val_loss=3.17, val_accuracy=0.383, lr=0.1] 59%|█████▉    | 68/115 [26:53<18:16, 23.32s/epoch, loss=1.13, accuracy=0.755, val_loss=1.8, val_accuracy=0.543, lr=0.1]  60%|██████    | 69/115 [27:16<17:54, 23.36s/epoch, loss=1.13, accuracy=0.758, val_loss=1.61, val_accuracy=0.583, lr=0.0316] 61%|██████    | 70/115 [27:38<17:13, 22.96s/epoch, loss=1.13, accuracy=0.757, val_loss=2.3, val_accuracy=0.425, lr=0.1]     62%|██████▏   | 71/115 [28:01<16:51, 22.99s/epoch, loss=1.13, accuracy=0.757, val_loss=2.42, val_accuracy=0.47, lr=0.1] 63%|██████▎   | 72/115 [28:24<16:16, 22.70s/epoch, loss=1.13, accuracy=0.758, val_loss=1.97, val_accuracy=0.488, lr=0.1] 63%|██████▎   | 73/115 [28:46<15:56, 22.78s/epoch, loss=1.13, accuracy=0.757, val_loss=1.66, val_accuracy=0.603, lr=0.1] 64%|██████▍   | 74/115 [29:09<15:35, 22.82s/epoch, loss=1.12, accuracy=0.757, val_loss=3.06, val_accuracy=0.379, lr=0.0316] 65%|██████▌   | 75/115 [29:33<15:21, 23.03s/epoch, loss=1.12, accuracy=0.758, val_loss=1.73, val_accuracy=0.6, lr=0.1]      66%|██████▌   | 76/115 [29:56<15:01, 23.12s/epoch, loss=1.13, accuracy=0.757, val_loss=1.64, val_accuracy=0.572, lr=0.1] 67%|██████▋   | 77/115 [30:19<14:31, 22.94s/epoch, loss=1.13, accuracy=0.756, val_loss=1.66, val_accuracy=0.554, lr=0.1] 68%|██████▊   | 78/115 [30:42<14:12, 23.04s/epoch, loss=1.12, accuracy=0.758, val_loss=3.22, val_accuracy=0.315, lr=0.1] 69%|██████▊   | 79/115 [31:05<13:44, 22.91s/epoch, loss=1.13, accuracy=0.755, val_loss=2.08, val_accuracy=0.427, lr=0.0316] 70%|██████▉   | 80/115 [31:28<13:26, 23.05s/epoch, loss=1.13, accuracy=0.755, val_loss=2.24, val_accuracy=0.446, lr=0.1]    70%|███████   | 81/115 [31:51<13:02, 23.01s/epoch, loss=1.12, accuracy=0.755, val_loss=2.13, val_accuracy=0.456, lr=0.1] 71%|███████▏  | 82/115 [32:14<12:42, 23.12s/epoch, loss=0.908, accuracy=0.817, val_loss=0.867, val_accuracy=0.811, lr=0.01] 72%|███████▏  | 83/115 [32:37<12:17, 23.04s/epoch, loss=0.737, accuracy=0.845, val_loss=0.873, val_accuracy=0.784, lr=0.01] 73%|███████▎  | 84/115 [33:00<11:55, 23.09s/epoch, loss=0.651, accuracy=0.855, val_loss=0.793, val_accuracy=0.802, lr=0.01] 74%|███████▍  | 85/115 [33:22<11:22, 22.76s/epoch, loss=0.61, accuracy=0.859, val_loss=0.787, val_accuracy=0.8, lr=0.01]    75%|███████▍  | 86/115 [33:46<11:05, 22.94s/epoch, loss=0.582, accuracy=0.863, val_loss=0.74, val_accuracy=0.803, lr=0.01] 76%|███████▌  | 87/115 [34:09<10:45, 23.05s/epoch, loss=0.578, accuracy=0.861, val_loss=0.723, val_accuracy=0.813, lr=0.01] 77%|███████▋  | 88/115 [34:31<10:13, 22.71s/epoch, loss=0.567, accuracy=0.864, val_loss=0.825, val_accuracy=0.783, lr=0.01] 77%|███████▋  | 89/115 [34:53<09:46, 22.55s/epoch, loss=0.569, accuracy=0.863, val_loss=0.742, val_accuracy=0.804, lr=0.01] 78%|███████▊  | 90/115 [35:16<09:29, 22.78s/epoch, loss=0.563, accuracy=0.865, val_loss=0.839, val_accuracy=0.782, lr=0.01] 79%|███████▉  | 91/115 [35:40<09:09, 22.88s/epoch, loss=0.56, accuracy=0.867, val_loss=0.733, val_accuracy=0.811, lr=0.01]  80%|████████  | 92/115 [36:03<08:47, 22.96s/epoch, loss=0.56, accuracy=0.868, val_loss=0.898, val_accuracy=0.771, lr=0.00316] 81%|████████  | 93/115 [36:26<08:28, 23.10s/epoch, loss=0.561, accuracy=0.868, val_loss=1.07, val_accuracy=0.707, lr=0.01]    82%|████████▏ | 94/115 [36:49<08:05, 23.14s/epoch, loss=0.56, accuracy=0.872, val_loss=0.794, val_accuracy=0.792, lr=0.01] 83%|████████▎ | 95/115 [37:12<07:40, 23.05s/epoch, loss=0.557, accuracy=0.872, val_loss=0.835, val_accuracy=0.79, lr=0.01] 83%|████████▎ | 96/115 [37:34<07:11, 22.70s/epoch, loss=0.559, accuracy=0.872, val_loss=0.907, val_accuracy=0.764, lr=0.01] 84%|████████▍ | 97/115 [37:57<06:52, 22.89s/epoch, loss=0.555, accuracy=0.875, val_loss=0.93, val_accuracy=0.758, lr=0.00316] 85%|████████▌ | 98/115 [38:20<06:26, 22.75s/epoch, loss=0.557, accuracy=0.874, val_loss=0.828, val_accuracy=0.799, lr=0.01]   86%|████████▌ | 99/115 [38:42<06:02, 22.63s/epoch, loss=0.557, accuracy=0.875, val_loss=0.757, val_accuracy=0.813, lr=0.01] 87%|████████▋ | 100/115 [39:05<05:39, 22.61s/epoch, loss=0.56, accuracy=0.875, val_loss=0.769, val_accuracy=0.809, lr=0.01] 88%|████████▊ | 101/115 [39:27<05:16, 22.58s/epoch, loss=0.557, accuracy=0.876, val_loss=1.03, val_accuracy=0.742, lr=0.01] 89%|████████▊ | 102/115 [39:51<04:57, 22.85s/epoch, loss=0.556, accuracy=0.879, val_loss=0.807, val_accuracy=0.794, lr=0.00316] 90%|████████▉ | 103/115 [40:14<04:35, 22.95s/epoch, loss=0.557, accuracy=0.877, val_loss=1.03, val_accuracy=0.75, lr=0.01]      90%|█████████ | 104/115 [40:37<04:12, 22.96s/epoch, loss=0.554, accuracy=0.878, val_loss=1.07, val_accuracy=0.745, lr=0.01] 91%|█████████▏| 105/115 [41:00<03:49, 22.94s/epoch, loss=0.557, accuracy=0.879, val_loss=0.891, val_accuracy=0.771, lr=0.01] 92%|█████████▏| 106/115 [41:23<03:25, 22.88s/epoch, loss=0.552, accuracy=0.88, val_loss=0.997, val_accuracy=0.763, lr=0.01]  93%|█████████▎| 107/115 [41:46<03:04, 23.02s/epoch, loss=0.554, accuracy=0.879, val_loss=0.933, val_accuracy=0.765, lr=0.00316] 94%|█████████▍| 108/115 [42:09<02:41, 23.09s/epoch, loss=0.557, accuracy=0.879, val_loss=0.938, val_accuracy=0.778, lr=0.01]    95%|█████████▍| 109/115 [42:32<02:18, 23.12s/epoch, loss=0.553, accuracy=0.879, val_loss=0.804, val_accuracy=0.804, lr=0.01] 96%|█████████▌| 110/115 [42:54<01:54, 22.81s/epoch, loss=0.551, accuracy=0.883, val_loss=0.966, val_accuracy=0.744, lr=0.01] 97%|█████████▋| 111/115 [43:18<01:32, 23.00s/epoch, loss=0.554, accuracy=0.881, val_loss=0.755, val_accuracy=0.827, lr=0.01] 97%|█████████▋| 112/115 [43:41<01:08, 22.96s/epoch, loss=0.553, accuracy=0.882, val_loss=0.995, val_accuracy=0.759, lr=0.00316] 98%|█████████▊| 113/115 [44:03<00:45, 22.62s/epoch, loss=0.556, accuracy=0.883, val_loss=1.05, val_accuracy=0.732, lr=0.01]     99%|█████████▉| 114/115 [44:25<00:22, 22.66s/epoch, loss=0.553, accuracy=0.883, val_loss=0.857, val_accuracy=0.782, lr=0.01]100%|██████████| 115/115 [44:49<00:00, 22.82s/epoch, loss=0.555, accuracy=0.882, val_loss=0.817, val_accuracy=0.808, lr=0.01]100%|██████████| 115/115 [44:49<00:00, 23.38s/epoch, loss=0.555, accuracy=0.882, val_loss=0.817, val_accuracy=0.808, lr=0.01]
Using real-time data augmentation.
Test score: 0.8169667720794678
Test accuracy: 0.8077999949455261


* * * Run SGD for ID = 13_3. * * *


2024-03-05 05:15:06.238309: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 05:15:09.482378: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 05:15:09.483413: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-05 05:15:09.522343: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-05 05:15:09.522390: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 05:15:09.533952: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 05:15:09.533994: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-05 05:15:09.537231: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-05 05:15:09.538298: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-05 05:15:09.541575: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-05 05:15:09.543648: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-05 05:15:09.549692: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 05:15:09.550241: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-05 05:15:09.550327: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 05:15:10.785901: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-05 05:15:10.787062: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 05:15:10.787882: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-05 05:15:10.787920: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 05:15:10.787955: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 05:15:10.787973: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-05 05:15:10.787990: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-05 05:15:10.788009: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-05 05:15:10.788025: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-05 05:15:10.788041: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-05 05:15:10.788083: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 05:15:10.788575: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-05 05:15:10.788614: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 05:15:11.412737: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-05 05:15:11.412798: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-05 05:15:11.412808: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-05 05:15:11.413769: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:02:00.0, compute capability: 6.1)
{'id': '13_03', 'seed': 3, 'out_folder': 'results/epoch_budget', 'batch_size': 128, 'epochs': 115, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/115 [00:00<?, ?epoch/s]2024-03-05 05:15:12.246842: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-05 05:15:12.259176: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199825000 Hz
2024-03-05 05:15:14.250410: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 05:15:14.471702: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 05:15:15.363610: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-05 05:15:15.418275: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/115 [00:58<1:51:59, 58.94s/epoch, loss=2.94, accuracy=0.383, val_loss=3.4, val_accuracy=0.16, lr=0.1]  2%|▏         | 2/115 [01:22<1:11:27, 37.95s/epoch, loss=1.49, accuracy=0.577, val_loss=2.12, val_accuracy=0.452, lr=0.1]  3%|▎         | 3/115 [01:44<57:43, 30.92s/epoch, loss=1.31, accuracy=0.661, val_loss=2.7, val_accuracy=0.333, lr=0.1]     3%|▎         | 4/115 [02:08<51:43, 27.96s/epoch, loss=1.26, accuracy=0.693, val_loss=1.69, val_accuracy=0.567, lr=0.1]  4%|▍         | 5/115 [02:31<48:14, 26.32s/epoch, loss=1.24, accuracy=0.708, val_loss=1.71, val_accuracy=0.579, lr=0.1]  5%|▌         | 6/115 [02:54<45:37, 25.11s/epoch, loss=1.22, accuracy=0.718, val_loss=2.5, val_accuracy=0.445, lr=0.1]   6%|▌         | 7/115 [03:16<43:35, 24.22s/epoch, loss=1.2, accuracy=0.726, val_loss=1.9, val_accuracy=0.567, lr=0.1]   7%|▋         | 8/115 [03:39<42:36, 23.89s/epoch, loss=1.2, accuracy=0.731, val_loss=1.74, val_accuracy=0.537, lr=0.1]  8%|▊         | 9/115 [04:02<41:26, 23.46s/epoch, loss=1.19, accuracy=0.734, val_loss=1.76, val_accuracy=0.542, lr=0.0316]  9%|▊         | 10/115 [04:25<40:41, 23.25s/epoch, loss=1.19, accuracy=0.736, val_loss=2.67, val_accuracy=0.408, lr=0.1]   10%|▉         | 11/115 [04:46<39:23, 22.72s/epoch, loss=1.18, accuracy=0.736, val_loss=1.52, val_accuracy=0.618, lr=0.1] 10%|█         | 12/115 [05:09<39:04, 22.76s/epoch, loss=1.19, accuracy=0.739, val_loss=2.43, val_accuracy=0.461, lr=0.1] 11%|█▏        | 13/115 [05:31<38:04, 22.40s/epoch, loss=1.18, accuracy=0.744, val_loss=2.17, val_accuracy=0.471, lr=0.1] 12%|█▏        | 14/115 [05:53<37:42, 22.40s/epoch, loss=1.18, accuracy=0.743, val_loss=1.63, val_accuracy=0.567, lr=0.1] 13%|█▎        | 15/115 [06:15<36:55, 22.16s/epoch, loss=1.17, accuracy=0.746, val_loss=1.87, val_accuracy=0.529, lr=0.1] 14%|█▍        | 16/115 [06:37<36:51, 22.33s/epoch, loss=1.17, accuracy=0.746, val_loss=3.14, val_accuracy=0.362, lr=0.0316] 15%|█▍        | 17/115 [07:01<36:53, 22.59s/epoch, loss=1.17, accuracy=0.748, val_loss=2.78, val_accuracy=0.39, lr=0.1]     16%|█▌        | 18/115 [07:23<36:25, 22.53s/epoch, loss=1.16, accuracy=0.748, val_loss=1.51, val_accuracy=0.622, lr=0.1] 17%|█▋        | 19/115 [07:46<36:25, 22.76s/epoch, loss=1.16, accuracy=0.748, val_loss=1.45, val_accuracy=0.64, lr=0.1]  17%|█▋        | 20/115 [08:10<36:23, 22.98s/epoch, loss=1.15, accuracy=0.749, val_loss=1.89, val_accuracy=0.513, lr=0.1] 18%|█▊        | 21/115 [08:33<35:54, 22.92s/epoch, loss=1.15, accuracy=0.749, val_loss=1.69, val_accuracy=0.55, lr=0.1]  19%|█▉        | 22/115 [08:55<35:30, 22.91s/epoch, loss=1.15, accuracy=0.751, val_loss=2.03, val_accuracy=0.486, lr=0.1] 20%|██        | 23/115 [09:19<35:14, 22.99s/epoch, loss=1.14, accuracy=0.753, val_loss=2.6, val_accuracy=0.407, lr=0.1]  21%|██        | 24/115 [09:41<34:47, 22.94s/epoch, loss=1.14, accuracy=0.755, val_loss=2.16, val_accuracy=0.495, lr=0.0316] 22%|██▏       | 25/115 [10:05<34:29, 23.00s/epoch, loss=1.15, accuracy=0.752, val_loss=1.71, val_accuracy=0.542, lr=0.1]    23%|██▎       | 26/115 [10:28<34:09, 23.02s/epoch, loss=1.14, accuracy=0.753, val_loss=2.09, val_accuracy=0.428, lr=0.1] 23%|██▎       | 27/115 [10:49<33:13, 22.66s/epoch, loss=1.14, accuracy=0.752, val_loss=1.78, val_accuracy=0.554, lr=0.1] 24%|██▍       | 28/115 [11:13<33:03, 22.80s/epoch, loss=1.14, accuracy=0.754, val_loss=2.41, val_accuracy=0.362, lr=0.1] 25%|██▌       | 29/115 [11:35<32:35, 22.74s/epoch, loss=1.14, accuracy=0.752, val_loss=1.39, val_accuracy=0.664, lr=0.1] 26%|██▌       | 30/115 [11:58<32:16, 22.78s/epoch, loss=1.13, accuracy=0.753, val_loss=1.61, val_accuracy=0.572, lr=0.1] 27%|██▋       | 31/115 [12:21<31:55, 22.80s/epoch, loss=1.13, accuracy=0.755, val_loss=2.07, val_accuracy=0.45, lr=0.1]  28%|██▊       | 32/115 [12:44<31:37, 22.86s/epoch, loss=1.13, accuracy=0.756, val_loss=5.24, val_accuracy=0.228, lr=0.1] 29%|██▊       | 33/115 [13:06<31:04, 22.74s/epoch, loss=1.13, accuracy=0.757, val_loss=6.42, val_accuracy=0.174, lr=0.1] 30%|██▉       | 34/115 [13:29<30:46, 22.79s/epoch, loss=1.13, accuracy=0.755, val_loss=1.59, val_accuracy=0.604, lr=0.0316] 30%|███       | 35/115 [13:52<30:14, 22.68s/epoch, loss=1.13, accuracy=0.756, val_loss=2.11, val_accuracy=0.519, lr=0.1]    31%|███▏      | 36/115 [14:13<29:20, 22.29s/epoch, loss=1.13, accuracy=0.757, val_loss=2.18, val_accuracy=0.389, lr=0.1] 32%|███▏      | 37/115 [14:35<28:57, 22.28s/epoch, loss=1.13, accuracy=0.755, val_loss=1.81, val_accuracy=0.515, lr=0.1] 33%|███▎      | 38/115 [14:58<28:48, 22.45s/epoch, loss=1.12, accuracy=0.757, val_loss=1.87, val_accuracy=0.486, lr=0.1] 34%|███▍      | 39/115 [15:21<28:32, 22.54s/epoch, loss=1.13, accuracy=0.755, val_loss=2.9, val_accuracy=0.371, lr=0.0316] 35%|███▍      | 40/115 [15:44<28:24, 22.73s/epoch, loss=1.13, accuracy=0.755, val_loss=1.62, val_accuracy=0.608, lr=0.1]   36%|███▌      | 41/115 [16:07<28:13, 22.88s/epoch, loss=1.12, accuracy=0.757, val_loss=3.15, val_accuracy=0.337, lr=0.1] 37%|███▋      | 42/115 [16:30<27:55, 22.95s/epoch, loss=1.12, accuracy=0.756, val_loss=2.54, val_accuracy=0.432, lr=0.1] 37%|███▋      | 43/115 [16:53<27:32, 22.96s/epoch, loss=1.12, accuracy=0.757, val_loss=2.07, val_accuracy=0.504, lr=0.1] 38%|███▊      | 44/115 [17:16<26:59, 22.80s/epoch, loss=1.12, accuracy=0.758, val_loss=1.96, val_accuracy=0.498, lr=0.0316] 39%|███▉      | 45/115 [17:39<26:33, 22.76s/epoch, loss=1.11, accuracy=0.759, val_loss=2.16, val_accuracy=0.556, lr=0.1]    40%|████      | 46/115 [18:02<26:15, 22.83s/epoch, loss=1.11, accuracy=0.76, val_loss=1.83, val_accuracy=0.571, lr=0.1]  41%|████      | 47/115 [18:24<25:54, 22.87s/epoch, loss=1.12, accuracy=0.758, val_loss=1.49, val_accuracy=0.654, lr=0.1] 42%|████▏     | 48/115 [18:47<25:30, 22.85s/epoch, loss=1.11, accuracy=0.756, val_loss=2.5, val_accuracy=0.301, lr=0.1]  43%|████▎     | 49/115 [19:09<24:41, 22.45s/epoch, loss=1.11, accuracy=0.757, val_loss=5.96, val_accuracy=0.189, lr=0.0316] 43%|████▎     | 50/115 [19:32<24:31, 22.64s/epoch, loss=1.11, accuracy=0.759, val_loss=2.73, val_accuracy=0.396, lr=0.1]    44%|████▍     | 51/115 [19:55<24:09, 22.64s/epoch, loss=1.11, accuracy=0.759, val_loss=2.19, val_accuracy=0.461, lr=0.1] 45%|████▌     | 52/115 [20:17<23:46, 22.64s/epoch, loss=1.11, accuracy=0.76, val_loss=2.11, val_accuracy=0.515, lr=0.1]  46%|████▌     | 53/115 [20:39<23:16, 22.53s/epoch, loss=1.11, accuracy=0.759, val_loss=1.72, val_accuracy=0.574, lr=0.1] 47%|████▋     | 54/115 [21:02<23:02, 22.67s/epoch, loss=1.11, accuracy=0.759, val_loss=1.72, val_accuracy=0.586, lr=0.0316] 48%|████▊     | 55/115 [21:25<22:46, 22.77s/epoch, loss=1.11, accuracy=0.761, val_loss=2.21, val_accuracy=0.526, lr=0.1]    49%|████▊     | 56/115 [21:48<22:27, 22.85s/epoch, loss=1.11, accuracy=0.76, val_loss=2.73, val_accuracy=0.347, lr=0.1]  50%|████▉     | 57/115 [22:12<22:12, 22.98s/epoch, loss=1.12, accuracy=0.758, val_loss=2.39, val_accuracy=0.364, lr=0.1] 50%|█████     | 58/115 [22:33<21:25, 22.55s/epoch, loss=1.11, accuracy=0.759, val_loss=2.72, val_accuracy=0.377, lr=0.1] 51%|█████▏    | 59/115 [22:56<21:00, 22.52s/epoch, loss=1.11, accuracy=0.76, val_loss=1.75, val_accuracy=0.6, lr=0.0316] 52%|█████▏    | 60/115 [23:19<20:43, 22.62s/epoch, loss=1.11, accuracy=0.762, val_loss=1.99, val_accuracy=0.507, lr=0.1] 53%|█████▎    | 61/115 [23:41<20:21, 22.63s/epoch, loss=1.11, accuracy=0.761, val_loss=1.87, val_accuracy=0.481, lr=0.1] 54%|█████▍    | 62/115 [24:04<20:02, 22.69s/epoch, loss=1.11, accuracy=0.758, val_loss=2.29, val_accuracy=0.361, lr=0.1] 55%|█████▍    | 63/115 [24:27<19:44, 22.78s/epoch, loss=1.11, accuracy=0.759, val_loss=3.17, val_accuracy=0.249, lr=0.1] 56%|█████▌    | 64/115 [24:49<19:16, 22.68s/epoch, loss=1.11, accuracy=0.76, val_loss=1.33, val_accuracy=0.681, lr=0.1]  57%|█████▋    | 65/115 [25:11<18:33, 22.28s/epoch, loss=1.1, accuracy=0.761, val_loss=2.89, val_accuracy=0.397, lr=0.1] 57%|█████▋    | 66/115 [25:34<18:19, 22.45s/epoch, loss=1.11, accuracy=0.759, val_loss=1.32, val_accuracy=0.682, lr=0.1] 58%|█████▊    | 67/115 [25:56<17:59, 22.50s/epoch, loss=1.1, accuracy=0.761, val_loss=2.1, val_accuracy=0.459, lr=0.1]   59%|█████▉    | 68/115 [26:18<17:22, 22.18s/epoch, loss=1.1, accuracy=0.761, val_loss=1.56, val_accuracy=0.605, lr=0.1] 60%|██████    | 69/115 [26:40<17:07, 22.34s/epoch, loss=1.1, accuracy=0.76, val_loss=2.22, val_accuracy=0.509, lr=0.1]  61%|██████    | 70/115 [27:02<16:32, 22.05s/epoch, loss=1.1, accuracy=0.761, val_loss=2.33, val_accuracy=0.525, lr=0.1] 62%|██████▏   | 71/115 [27:24<16:16, 22.19s/epoch, loss=1.1, accuracy=0.761, val_loss=2.98, val_accuracy=0.386, lr=0.0316] 63%|██████▎   | 72/115 [27:47<16:03, 22.41s/epoch, loss=1.11, accuracy=0.758, val_loss=2.3, val_accuracy=0.495, lr=0.1]    63%|██████▎   | 73/115 [28:10<15:48, 22.58s/epoch, loss=1.11, accuracy=0.761, val_loss=2.35, val_accuracy=0.451, lr=0.1] 64%|██████▍   | 74/115 [28:33<15:27, 22.62s/epoch, loss=1.11, accuracy=0.759, val_loss=1.82, val_accuracy=0.535, lr=0.1] 65%|██████▌   | 75/115 [28:55<15:02, 22.57s/epoch, loss=1.11, accuracy=0.761, val_loss=1.65, val_accuracy=0.554, lr=0.1] 66%|██████▌   | 76/115 [29:18<14:44, 22.68s/epoch, loss=1.1, accuracy=0.761, val_loss=1.66, val_accuracy=0.574, lr=0.0316] 67%|██████▋   | 77/115 [29:41<14:23, 22.72s/epoch, loss=1.1, accuracy=0.761, val_loss=1.99, val_accuracy=0.527, lr=0.1]    68%|██████▊   | 78/115 [30:04<13:59, 22.69s/epoch, loss=1.11, accuracy=0.758, val_loss=1.75, val_accuracy=0.551, lr=0.1] 69%|██████▊   | 79/115 [30:27<13:41, 22.81s/epoch, loss=1.11, accuracy=0.759, val_loss=3.21, val_accuracy=0.328, lr=0.1] 70%|██████▉   | 80/115 [30:49<13:08, 22.52s/epoch, loss=1.1, accuracy=0.761, val_loss=2.09, val_accuracy=0.51, lr=0.1]   70%|███████   | 81/115 [31:11<12:47, 22.57s/epoch, loss=1.11, accuracy=0.759, val_loss=1.86, val_accuracy=0.556, lr=0.0316] 71%|███████▏  | 82/115 [31:34<12:29, 22.71s/epoch, loss=0.912, accuracy=0.817, val_loss=0.906, val_accuracy=0.8, lr=0.01]   72%|███████▏  | 83/115 [31:57<12:06, 22.69s/epoch, loss=0.729, accuracy=0.848, val_loss=0.756, val_accuracy=0.828, lr=0.01] 73%|███████▎  | 84/115 [32:20<11:44, 22.74s/epoch, loss=0.646, accuracy=0.858, val_loss=0.721, val_accuracy=0.827, lr=0.01] 74%|███████▍  | 85/115 [32:43<11:22, 22.74s/epoch, loss=0.598, accuracy=0.862, val_loss=1.22, val_accuracy=0.674, lr=0.01]  75%|███████▍  | 86/115 [33:05<10:55, 22.60s/epoch, loss=0.578, accuracy=0.863, val_loss=1.03, val_accuracy=0.741, lr=0.01] 76%|███████▌  | 87/115 [33:28<10:35, 22.70s/epoch, loss=0.568, accuracy=0.863, val_loss=0.701, val_accuracy=0.817, lr=0.01] 77%|███████▋  | 88/115 [33:51<10:13, 22.72s/epoch, loss=0.558, accuracy=0.865, val_loss=0.865, val_accuracy=0.776, lr=0.01] 77%|███████▋  | 89/115 [34:13<09:51, 22.74s/epoch, loss=0.557, accuracy=0.865, val_loss=1.02, val_accuracy=0.73, lr=0.01]   78%|███████▊  | 90/115 [34:36<09:25, 22.64s/epoch, loss=0.551, accuracy=0.868, val_loss=0.932, val_accuracy=0.748, lr=0.01] 79%|███████▉  | 91/115 [34:58<09:02, 22.61s/epoch, loss=0.55, accuracy=0.87, val_loss=0.821, val_accuracy=0.783, lr=0.01]   80%|████████  | 92/115 [35:21<08:39, 22.57s/epoch, loss=0.548, accuracy=0.872, val_loss=0.807, val_accuracy=0.787, lr=0.00316] 81%|████████  | 93/115 [35:42<08:08, 22.20s/epoch, loss=0.548, accuracy=0.873, val_loss=0.714, val_accuracy=0.821, lr=0.01]    82%|████████▏ | 94/115 [36:03<07:40, 21.92s/epoch, loss=0.541, accuracy=0.876, val_loss=0.713, val_accuracy=0.819, lr=0.01] 83%|████████▎ | 95/115 [36:26<07:21, 22.09s/epoch, loss=0.548, accuracy=0.875, val_loss=0.775, val_accuracy=0.809, lr=0.01] 83%|████████▎ | 96/115 [36:47<06:54, 21.83s/epoch, loss=0.552, accuracy=0.875, val_loss=0.787, val_accuracy=0.797, lr=0.01] 84%|████████▍ | 97/115 [37:10<06:38, 22.12s/epoch, loss=0.546, accuracy=0.877, val_loss=0.781, val_accuracy=0.801, lr=0.00316] 85%|████████▌ | 98/115 [37:32<06:18, 22.24s/epoch, loss=0.548, accuracy=0.877, val_loss=0.895, val_accuracy=0.771, lr=0.01]    86%|████████▌ | 99/115 [37:55<05:57, 22.31s/epoch, loss=0.542, accuracy=0.879, val_loss=0.819, val_accuracy=0.787, lr=0.01] 87%|████████▋ | 100/115 [38:18<05:37, 22.52s/epoch, loss=0.543, accuracy=0.879, val_loss=0.863, val_accuracy=0.768, lr=0.01] 88%|████████▊ | 101/115 [38:41<05:15, 22.57s/epoch, loss=0.543, accuracy=0.879, val_loss=0.777, val_accuracy=0.807, lr=0.01] 89%|████████▊ | 102/115 [39:02<04:48, 22.20s/epoch, loss=0.543, accuracy=0.881, val_loss=0.784, val_accuracy=0.799, lr=0.00316] 90%|████████▉ | 103/115 [39:23<04:23, 21.95s/epoch, loss=0.54, accuracy=0.883, val_loss=0.86, val_accuracy=0.787, lr=0.01]      90%|█████████ | 104/115 [39:45<03:59, 21.78s/epoch, loss=0.54, accuracy=0.882, val_loss=0.878, val_accuracy=0.779, lr=0.01] 91%|█████████▏| 105/115 [40:07<03:39, 22.00s/epoch, loss=0.549, accuracy=0.88, val_loss=0.897, val_accuracy=0.761, lr=0.01] 92%|█████████▏| 106/115 [40:30<03:18, 22.09s/epoch, loss=0.546, accuracy=0.88, val_loss=0.86, val_accuracy=0.792, lr=0.01]  93%|█████████▎| 107/115 [40:52<02:58, 22.33s/epoch, loss=0.539, accuracy=0.885, val_loss=0.896, val_accuracy=0.781, lr=0.00316] 94%|█████████▍| 108/115 [41:14<02:34, 22.03s/epoch, loss=0.545, accuracy=0.884, val_loss=0.926, val_accuracy=0.773, lr=0.01]    95%|█████████▍| 109/115 [41:36<02:12, 22.05s/epoch, loss=0.543, accuracy=0.882, val_loss=0.77, val_accuracy=0.811, lr=0.01]  96%|█████████▌| 110/115 [41:59<01:51, 22.28s/epoch, loss=0.543, accuracy=0.883, val_loss=0.698, val_accuracy=0.838, lr=0.01] 97%|█████████▋| 111/115 [42:21<01:29, 22.28s/epoch, loss=0.541, accuracy=0.886, val_loss=0.798, val_accuracy=0.81, lr=0.01]  97%|█████████▋| 112/115 [42:44<01:07, 22.41s/epoch, loss=0.545, accuracy=0.884, val_loss=0.847, val_accuracy=0.785, lr=0.01] 98%|█████████▊| 113/115 [43:07<00:45, 22.62s/epoch, loss=0.541, accuracy=0.886, val_loss=0.803, val_accuracy=0.8, lr=0.01]   99%|█████████▉| 114/115 [43:29<00:22, 22.64s/epoch, loss=0.544, accuracy=0.885, val_loss=0.993, val_accuracy=0.769, lr=0.01]100%|██████████| 115/115 [43:52<00:00, 22.75s/epoch, loss=0.542, accuracy=0.885, val_loss=1.29, val_accuracy=0.693, lr=0.00316]100%|██████████| 115/115 [43:52<00:00, 22.90s/epoch, loss=0.542, accuracy=0.885, val_loss=1.29, val_accuracy=0.693, lr=0.00316]
Using real-time data augmentation.
Test score: 1.2945486307144165
Test accuracy: 0.6934000253677368


* * * Run SGD for ID = 13_4. * * *


2024-03-05 05:59:08.898405: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 05:59:11.751364: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 05:59:11.752321: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-05 05:59:11.792020: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-05 05:59:11.792083: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 05:59:11.795201: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 05:59:11.795254: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-05 05:59:11.797684: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-05 05:59:11.798410: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-05 05:59:11.801048: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-05 05:59:11.802653: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-05 05:59:11.807588: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 05:59:11.808165: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-05 05:59:11.808252: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 05:59:13.187476: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-05 05:59:13.188452: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 05:59:13.188909: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-05 05:59:13.188941: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 05:59:13.188978: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 05:59:13.188998: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-05 05:59:13.189017: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-05 05:59:13.189035: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-05 05:59:13.189063: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-05 05:59:13.189083: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-05 05:59:13.189102: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 05:59:13.189594: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-05 05:59:13.189634: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 05:59:13.895226: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-05 05:59:13.895296: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-05 05:59:13.895306: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-05 05:59:13.896662: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:02:00.0, compute capability: 6.1)
{'id': '13_04', 'seed': 4, 'out_folder': 'results/epoch_budget', 'batch_size': 128, 'epochs': 115, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/115 [00:00<?, ?epoch/s]2024-03-05 05:59:14.799359: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-05 05:59:14.811183: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199825000 Hz
2024-03-05 05:59:17.047852: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 05:59:17.326744: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 05:59:18.101341: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-05 05:59:18.147209: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/115 [00:58<1:51:23, 58.62s/epoch, loss=2.86, accuracy=0.388, val_loss=2.9, val_accuracy=0.228, lr=0.1]  2%|▏         | 2/115 [01:22<1:11:37, 38.03s/epoch, loss=1.46, accuracy=0.593, val_loss=2.68, val_accuracy=0.324, lr=0.1]  3%|▎         | 3/115 [01:45<58:28, 31.33s/epoch, loss=1.3, accuracy=0.668, val_loss=1.68, val_accuracy=0.534, lr=0.1]     3%|▎         | 4/115 [02:08<52:02, 28.13s/epoch, loss=1.25, accuracy=0.695, val_loss=2.76, val_accuracy=0.317, lr=0.1]  4%|▍         | 5/115 [02:30<47:23, 25.85s/epoch, loss=1.23, accuracy=0.708, val_loss=2.69, val_accuracy=0.332, lr=0.1]  5%|▌         | 6/115 [02:52<44:24, 24.44s/epoch, loss=1.22, accuracy=0.715, val_loss=2.36, val_accuracy=0.419, lr=0.1]  6%|▌         | 7/115 [03:14<42:24, 23.56s/epoch, loss=1.21, accuracy=0.722, val_loss=2.19, val_accuracy=0.402, lr=0.1]  7%|▋         | 8/115 [03:36<41:25, 23.23s/epoch, loss=1.2, accuracy=0.726, val_loss=1.88, val_accuracy=0.531, lr=0.0316]  8%|▊         | 9/115 [03:59<41:06, 23.27s/epoch, loss=1.19, accuracy=0.732, val_loss=2.19, val_accuracy=0.526, lr=0.1]    9%|▊         | 10/115 [04:23<40:47, 23.31s/epoch, loss=1.2, accuracy=0.731, val_loss=2.15, val_accuracy=0.499, lr=0.1] 10%|▉         | 11/115 [04:45<39:41, 22.90s/epoch, loss=1.19, accuracy=0.737, val_loss=1.91, val_accuracy=0.54, lr=0.1] 10%|█         | 12/115 [05:08<39:20, 22.92s/epoch, loss=1.18, accuracy=0.737, val_loss=1.39, val_accuracy=0.656, lr=0.1] 11%|█▏        | 13/115 [05:31<38:57, 22.91s/epoch, loss=1.18, accuracy=0.74, val_loss=1.66, val_accuracy=0.593, lr=0.1]  12%|█▏        | 14/115 [05:53<38:11, 22.69s/epoch, loss=1.17, accuracy=0.744, val_loss=1.37, val_accuracy=0.687, lr=0.1] 13%|█▎        | 15/115 [06:15<37:20, 22.41s/epoch, loss=1.17, accuracy=0.744, val_loss=1.93, val_accuracy=0.498, lr=0.1] 14%|█▍        | 16/115 [06:36<36:41, 22.23s/epoch, loss=1.16, accuracy=0.744, val_loss=1.76, val_accuracy=0.543, lr=0.1] 15%|█▍        | 17/115 [06:59<36:28, 22.33s/epoch, loss=1.16, accuracy=0.746, val_loss=2.92, val_accuracy=0.34, lr=0.1]  16%|█▌        | 18/115 [07:22<36:19, 22.47s/epoch, loss=1.17, accuracy=0.747, val_loss=1.98, val_accuracy=0.49, lr=0.1] 17%|█▋        | 19/115 [07:45<36:04, 22.55s/epoch, loss=1.16, accuracy=0.748, val_loss=1.73, val_accuracy=0.598, lr=0.0316] 17%|█▋        | 20/115 [08:08<36:03, 22.77s/epoch, loss=1.16, accuracy=0.749, val_loss=2.5, val_accuracy=0.365, lr=0.1]     18%|█▊        | 21/115 [08:31<35:56, 22.94s/epoch, loss=1.16, accuracy=0.75, val_loss=1.64, val_accuracy=0.582, lr=0.1] 19%|█▉        | 22/115 [08:54<35:42, 23.03s/epoch, loss=1.16, accuracy=0.748, val_loss=1.56, val_accuracy=0.627, lr=0.1] 20%|██        | 23/115 [09:18<35:30, 23.16s/epoch, loss=1.14, accuracy=0.751, val_loss=2.29, val_accuracy=0.51, lr=0.1]  21%|██        | 24/115 [09:40<34:35, 22.81s/epoch, loss=1.16, accuracy=0.749, val_loss=2.3, val_accuracy=0.378, lr=0.0316] 22%|██▏       | 25/115 [10:02<34:05, 22.72s/epoch, loss=1.15, accuracy=0.751, val_loss=1.83, val_accuracy=0.576, lr=0.1]   23%|██▎       | 26/115 [10:26<34:02, 22.95s/epoch, loss=1.16, accuracy=0.75, val_loss=1.74, val_accuracy=0.58, lr=0.1]   23%|██▎       | 27/115 [10:49<33:53, 23.11s/epoch, loss=1.15, accuracy=0.75, val_loss=2.83, val_accuracy=0.442, lr=0.1] 24%|██▍       | 28/115 [11:13<33:32, 23.13s/epoch, loss=1.15, accuracy=0.751, val_loss=1.77, val_accuracy=0.553, lr=0.1] 25%|██▌       | 29/115 [11:34<32:35, 22.74s/epoch, loss=1.15, accuracy=0.752, val_loss=4.63, val_accuracy=0.221, lr=0.0316] 26%|██▌       | 30/115 [11:56<31:43, 22.40s/epoch, loss=1.14, accuracy=0.753, val_loss=2.07, val_accuracy=0.481, lr=0.1]    27%|██▋       | 31/115 [12:19<31:45, 22.68s/epoch, loss=1.15, accuracy=0.753, val_loss=6.85, val_accuracy=0.123, lr=0.1] 28%|██▊       | 32/115 [12:42<31:33, 22.81s/epoch, loss=1.15, accuracy=0.754, val_loss=2.38, val_accuracy=0.415, lr=0.1] 29%|██▊       | 33/115 [13:05<31:03, 22.72s/epoch, loss=1.15, accuracy=0.752, val_loss=2.28, val_accuracy=0.41, lr=0.1]  30%|██▉       | 34/115 [13:27<30:16, 22.43s/epoch, loss=1.15, accuracy=0.755, val_loss=1.74, val_accuracy=0.541, lr=0.0316] 30%|███       | 35/115 [13:49<29:58, 22.48s/epoch, loss=1.14, accuracy=0.753, val_loss=1.74, val_accuracy=0.583, lr=0.1]    31%|███▏      | 36/115 [14:13<30:03, 22.84s/epoch, loss=1.14, accuracy=0.756, val_loss=2, val_accuracy=0.541, lr=0.1]    32%|███▏      | 37/115 [14:37<30:04, 23.13s/epoch, loss=1.14, accuracy=0.756, val_loss=1.87, val_accuracy=0.529, lr=0.1] 33%|███▎      | 38/115 [14:59<29:17, 22.83s/epoch, loss=1.14, accuracy=0.756, val_loss=3.21, val_accuracy=0.377, lr=0.1] 34%|███▍      | 39/115 [15:22<29:10, 23.04s/epoch, loss=1.14, accuracy=0.759, val_loss=1.57, val_accuracy=0.624, lr=0.0316] 35%|███▍      | 40/115 [15:45<28:39, 22.93s/epoch, loss=1.14, accuracy=0.752, val_loss=1.87, val_accuracy=0.519, lr=0.1]    36%|███▌      | 41/115 [16:07<27:55, 22.64s/epoch, loss=1.14, accuracy=0.755, val_loss=1.53, val_accuracy=0.62, lr=0.1]  37%|███▋      | 42/115 [16:30<27:44, 22.80s/epoch, loss=1.13, accuracy=0.755, val_loss=1.76, val_accuracy=0.538, lr=0.1] 37%|███▋      | 43/115 [16:53<27:29, 22.91s/epoch, loss=1.14, accuracy=0.755, val_loss=2.17, val_accuracy=0.408, lr=0.1] 38%|███▊      | 44/115 [17:17<27:12, 23.00s/epoch, loss=1.13, accuracy=0.756, val_loss=1.61, val_accuracy=0.594, lr=0.0316] 39%|███▉      | 45/115 [17:40<26:57, 23.11s/epoch, loss=1.13, accuracy=0.754, val_loss=3.91, val_accuracy=0.393, lr=0.1]    40%|████      | 46/115 [18:03<26:32, 23.09s/epoch, loss=1.13, accuracy=0.757, val_loss=1.48, val_accuracy=0.638, lr=0.1] 41%|████      | 47/115 [18:26<26:10, 23.09s/epoch, loss=1.13, accuracy=0.759, val_loss=2.14, val_accuracy=0.518, lr=0.1] 42%|████▏     | 48/115 [18:50<25:55, 23.21s/epoch, loss=1.13, accuracy=0.76, val_loss=1.83, val_accuracy=0.539, lr=0.1]  43%|████▎     | 49/115 [19:13<25:38, 23.31s/epoch, loss=1.13, accuracy=0.756, val_loss=4.62, val_accuracy=0.3, lr=0.0316] 43%|████▎     | 50/115 [19:37<25:16, 23.34s/epoch, loss=1.13, accuracy=0.759, val_loss=2.15, val_accuracy=0.49, lr=0.1]   44%|████▍     | 51/115 [19:59<24:38, 23.10s/epoch, loss=1.13, accuracy=0.758, val_loss=2.56, val_accuracy=0.417, lr=0.1] 45%|████▌     | 52/115 [20:22<24:18, 23.15s/epoch, loss=1.12, accuracy=0.759, val_loss=2, val_accuracy=0.51, lr=0.1]     46%|████▌     | 53/115 [20:46<24:01, 23.25s/epoch, loss=1.13, accuracy=0.757, val_loss=4.06, val_accuracy=0.304, lr=0.1] 47%|████▋     | 54/115 [21:09<23:41, 23.30s/epoch, loss=1.13, accuracy=0.759, val_loss=2.94, val_accuracy=0.383, lr=0.0316] 48%|████▊     | 55/115 [21:33<23:25, 23.43s/epoch, loss=1.14, accuracy=0.757, val_loss=1.48, val_accuracy=0.633, lr=0.1]    49%|████▊     | 56/115 [21:56<23:02, 23.43s/epoch, loss=1.12, accuracy=0.758, val_loss=3.33, val_accuracy=0.28, lr=0.1]  50%|████▉     | 57/115 [22:20<22:37, 23.41s/epoch, loss=1.13, accuracy=0.757, val_loss=1.96, val_accuracy=0.481, lr=0.1] 50%|█████     | 58/115 [22:43<22:10, 23.35s/epoch, loss=1.13, accuracy=0.754, val_loss=2.78, val_accuracy=0.409, lr=0.1] 51%|█████▏    | 59/115 [23:06<21:46, 23.32s/epoch, loss=1.13, accuracy=0.759, val_loss=1.66, val_accuracy=0.574, lr=0.0316] 52%|█████▏    | 60/115 [23:28<21:00, 22.93s/epoch, loss=1.13, accuracy=0.757, val_loss=3.24, val_accuracy=0.407, lr=0.1]    53%|█████▎    | 61/115 [23:50<20:22, 22.64s/epoch, loss=1.12, accuracy=0.759, val_loss=1.83, val_accuracy=0.515, lr=0.1] 54%|█████▍    | 62/115 [24:12<19:48, 22.43s/epoch, loss=1.12, accuracy=0.759, val_loss=2.22, val_accuracy=0.375, lr=0.1] 55%|█████▍    | 63/115 [24:34<19:15, 22.23s/epoch, loss=1.12, accuracy=0.757, val_loss=1.66, val_accuracy=0.577, lr=0.1] 56%|█████▌    | 64/115 [24:57<19:10, 22.56s/epoch, loss=1.13, accuracy=0.759, val_loss=2.43, val_accuracy=0.418, lr=0.0316] 57%|█████▋    | 65/115 [25:21<19:03, 22.87s/epoch, loss=1.12, accuracy=0.759, val_loss=2.04, val_accuracy=0.455, lr=0.1]    57%|█████▋    | 66/115 [25:44<18:45, 22.97s/epoch, loss=1.12, accuracy=0.757, val_loss=2.44, val_accuracy=0.301, lr=0.1] 58%|█████▊    | 67/115 [26:07<18:21, 22.95s/epoch, loss=1.12, accuracy=0.759, val_loss=3.42, val_accuracy=0.287, lr=0.1] 59%|█████▉    | 68/115 [26:30<18:05, 23.09s/epoch, loss=1.12, accuracy=0.759, val_loss=2.07, val_accuracy=0.458, lr=0.1] 60%|██████    | 69/115 [26:52<17:23, 22.69s/epoch, loss=1.12, accuracy=0.756, val_loss=1.51, val_accuracy=0.63, lr=0.0316] 61%|██████    | 70/115 [27:15<17:10, 22.89s/epoch, loss=1.12, accuracy=0.758, val_loss=1.48, val_accuracy=0.631, lr=0.1]   62%|██████▏   | 71/115 [27:38<16:40, 22.73s/epoch, loss=1.12, accuracy=0.757, val_loss=1.35, val_accuracy=0.675, lr=0.1] 63%|██████▎   | 72/115 [28:00<16:06, 22.47s/epoch, loss=1.12, accuracy=0.759, val_loss=2.04, val_accuracy=0.493, lr=0.1] 63%|██████▎   | 73/115 [28:23<15:53, 22.70s/epoch, loss=1.12, accuracy=0.757, val_loss=2.03, val_accuracy=0.477, lr=0.1] 64%|██████▍   | 74/115 [28:46<15:37, 22.86s/epoch, loss=1.12, accuracy=0.757, val_loss=2.92, val_accuracy=0.285, lr=0.1] 65%|██████▌   | 75/115 [29:10<15:21, 23.05s/epoch, loss=1.12, accuracy=0.76, val_loss=1.75, val_accuracy=0.551, lr=0.1]  66%|██████▌   | 76/115 [29:33<15:02, 23.14s/epoch, loss=1.11, accuracy=0.758, val_loss=1.6, val_accuracy=0.593, lr=0.0316] 67%|██████▋   | 77/115 [29:57<14:45, 23.30s/epoch, loss=1.12, accuracy=0.757, val_loss=1.8, val_accuracy=0.539, lr=0.1]    68%|██████▊   | 78/115 [30:20<14:21, 23.27s/epoch, loss=1.13, accuracy=0.755, val_loss=1.89, val_accuracy=0.529, lr=0.1] 69%|██████▊   | 79/115 [30:43<14:00, 23.34s/epoch, loss=1.12, accuracy=0.757, val_loss=2.11, val_accuracy=0.525, lr=0.1] 70%|██████▉   | 80/115 [31:07<13:37, 23.36s/epoch, loss=1.12, accuracy=0.76, val_loss=1.94, val_accuracy=0.543, lr=0.1]  70%|███████   | 81/115 [31:30<13:12, 23.31s/epoch, loss=1.12, accuracy=0.76, val_loss=2.93, val_accuracy=0.397, lr=0.0316] 71%|███████▏  | 82/115 [31:54<12:52, 23.40s/epoch, loss=0.899, accuracy=0.821, val_loss=0.898, val_accuracy=0.798, lr=0.01] 72%|███████▏  | 83/115 [32:17<12:25, 23.30s/epoch, loss=0.727, accuracy=0.85, val_loss=0.886, val_accuracy=0.785, lr=0.01]  73%|███████▎  | 84/115 [32:40<12:04, 23.36s/epoch, loss=0.645, accuracy=0.857, val_loss=0.733, val_accuracy=0.824, lr=0.01] 74%|███████▍  | 85/115 [33:04<11:42, 23.40s/epoch, loss=0.602, accuracy=0.861, val_loss=0.84, val_accuracy=0.77, lr=0.01]   75%|███████▍  | 86/115 [33:25<11:04, 22.91s/epoch, loss=0.581, accuracy=0.862, val_loss=0.862, val_accuracy=0.772, lr=0.01] 76%|███████▌  | 87/115 [33:48<10:39, 22.84s/epoch, loss=0.566, accuracy=0.865, val_loss=0.767, val_accuracy=0.796, lr=0.01] 77%|███████▋  | 88/115 [34:11<10:19, 22.96s/epoch, loss=0.564, accuracy=0.865, val_loss=0.89, val_accuracy=0.768, lr=0.01]  77%|███████▋  | 89/115 [34:34<09:53, 22.83s/epoch, loss=0.559, accuracy=0.865, val_loss=0.745, val_accuracy=0.811, lr=0.00316] 78%|███████▊  | 90/115 [34:57<09:33, 22.95s/epoch, loss=0.557, accuracy=0.87, val_loss=0.813, val_accuracy=0.78, lr=0.01]      79%|███████▉  | 91/115 [35:20<09:12, 23.04s/epoch, loss=0.556, accuracy=0.868, val_loss=0.976, val_accuracy=0.751, lr=0.01] 80%|████████  | 92/115 [35:43<08:47, 22.92s/epoch, loss=0.555, accuracy=0.87, val_loss=0.778, val_accuracy=0.794, lr=0.01]  81%|████████  | 93/115 [36:06<08:27, 23.07s/epoch, loss=0.553, accuracy=0.872, val_loss=0.84, val_accuracy=0.786, lr=0.01] 82%|████████▏ | 94/115 [36:29<07:58, 22.79s/epoch, loss=0.55, accuracy=0.875, val_loss=0.946, val_accuracy=0.756, lr=0.00316] 83%|████████▎ | 95/115 [36:51<07:34, 22.72s/epoch, loss=0.553, accuracy=0.874, val_loss=0.997, val_accuracy=0.737, lr=0.01]   83%|████████▎ | 96/115 [37:13<07:09, 22.59s/epoch, loss=0.55, accuracy=0.876, val_loss=0.808, val_accuracy=0.801, lr=0.01]  84%|████████▍ | 97/115 [37:35<06:41, 22.31s/epoch, loss=0.551, accuracy=0.875, val_loss=0.84, val_accuracy=0.792, lr=0.01] 85%|████████▌ | 98/115 [37:58<06:20, 22.37s/epoch, loss=0.551, accuracy=0.877, val_loss=1.15, val_accuracy=0.719, lr=0.01] 86%|████████▌ | 99/115 [38:19<05:55, 22.24s/epoch, loss=0.55, accuracy=0.878, val_loss=0.701, val_accuracy=0.827, lr=0.01] 87%|████████▋ | 100/115 [38:41<05:31, 22.09s/epoch, loss=0.547, accuracy=0.88, val_loss=1.07, val_accuracy=0.752, lr=0.01] 88%|████████▊ | 101/115 [39:04<05:12, 22.32s/epoch, loss=0.546, accuracy=0.88, val_loss=0.79, val_accuracy=0.801, lr=0.01] 89%|████████▊ | 102/115 [39:27<04:52, 22.53s/epoch, loss=0.55, accuracy=0.88, val_loss=0.862, val_accuracy=0.777, lr=0.01] 90%|████████▉ | 103/115 [39:50<04:31, 22.61s/epoch, loss=0.546, accuracy=0.881, val_loss=0.846, val_accuracy=0.799, lr=0.01] 90%|█████████ | 104/115 [40:13<04:11, 22.84s/epoch, loss=0.55, accuracy=0.881, val_loss=0.677, val_accuracy=0.841, lr=0.01]  91%|█████████▏| 105/115 [40:35<03:45, 22.57s/epoch, loss=0.55, accuracy=0.88, val_loss=0.884, val_accuracy=0.782, lr=0.01]  92%|█████████▏| 106/115 [40:58<03:24, 22.73s/epoch, loss=0.551, accuracy=0.882, val_loss=0.992, val_accuracy=0.747, lr=0.01] 93%|█████████▎| 107/115 [41:21<03:02, 22.84s/epoch, loss=0.547, accuracy=0.883, val_loss=1.12, val_accuracy=0.715, lr=0.01]  94%|█████████▍| 108/115 [41:44<02:39, 22.85s/epoch, loss=0.55, accuracy=0.883, val_loss=1.22, val_accuracy=0.711, lr=0.01]  95%|█████████▍| 109/115 [42:07<02:17, 22.95s/epoch, loss=0.542, accuracy=0.885, val_loss=0.802, val_accuracy=0.807, lr=0.00316] 96%|█████████▌| 110/115 [42:31<01:55, 23.06s/epoch, loss=0.544, accuracy=0.885, val_loss=1.48, val_accuracy=0.632, lr=0.01]     97%|█████████▋| 111/115 [42:54<01:31, 22.99s/epoch, loss=0.546, accuracy=0.884, val_loss=0.832, val_accuracy=0.8, lr=0.01]  97%|█████████▋| 112/115 [43:16<01:08, 22.89s/epoch, loss=0.547, accuracy=0.883, val_loss=0.791, val_accuracy=0.82, lr=0.01] 98%|█████████▊| 113/115 [43:39<00:45, 22.84s/epoch, loss=0.546, accuracy=0.884, val_loss=1.1, val_accuracy=0.743, lr=0.01]  99%|█████████▉| 114/115 [44:02<00:22, 22.93s/epoch, loss=0.552, accuracy=0.884, val_loss=0.788, val_accuracy=0.813, lr=0.00316]100%|██████████| 115/115 [44:25<00:00, 22.98s/epoch, loss=0.542, accuracy=0.888, val_loss=1.09, val_accuracy=0.742, lr=0.01]    100%|██████████| 115/115 [44:25<00:00, 23.18s/epoch, loss=0.542, accuracy=0.888, val_loss=1.09, val_accuracy=0.742, lr=0.01]
Using real-time data augmentation.
Test score: 1.0928939580917358
Test accuracy: 0.7422999739646912


* * * Run SGD for ID = 13_5. * * *


2024-03-05 06:43:43.982218: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 06:43:46.687120: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 06:43:46.688108: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-05 06:43:46.727002: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-05 06:43:46.727036: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 06:43:46.729774: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 06:43:46.729815: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-05 06:43:46.731860: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-05 06:43:46.732726: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-05 06:43:46.734953: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-05 06:43:46.736362: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-05 06:43:46.740962: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 06:43:46.741505: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-05 06:43:46.741589: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 06:43:47.955749: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-05 06:43:47.956511: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 06:43:47.958703: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-05 06:43:47.958746: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 06:43:47.958797: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 06:43:47.958817: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-05 06:43:47.958850: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-05 06:43:47.958875: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-05 06:43:47.958893: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-05 06:43:47.958909: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-05 06:43:47.958926: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 06:43:47.959419: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-05 06:43:47.959463: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 06:43:48.683360: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-05 06:43:48.683417: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-05 06:43:48.683427: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-05 06:43:48.684442: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:02:00.0, compute capability: 6.1)
{'id': '13_05', 'seed': 5, 'out_folder': 'results/epoch_budget', 'batch_size': 128, 'epochs': 115, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/115 [00:00<?, ?epoch/s]2024-03-05 06:43:49.634472: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-05 06:43:49.646167: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199825000 Hz
2024-03-05 06:43:51.623973: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 06:43:51.893254: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 06:43:52.708029: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-05 06:43:52.762526: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/115 [00:59<1:53:29, 59.73s/epoch, loss=2.91, accuracy=0.346, val_loss=2.54, val_accuracy=0.245, lr=0.1]  2%|▏         | 2/115 [01:23<1:12:09, 38.32s/epoch, loss=1.47, accuracy=0.58, val_loss=1.75, val_accuracy=0.491, lr=0.1]   3%|▎         | 3/115 [01:46<58:49, 31.52s/epoch, loss=1.29, accuracy=0.663, val_loss=1.89, val_accuracy=0.51, lr=0.1]    3%|▎         | 4/115 [02:10<52:36, 28.44s/epoch, loss=1.24, accuracy=0.694, val_loss=1.41, val_accuracy=0.636, lr=0.1]  4%|▍         | 5/115 [02:33<48:43, 26.57s/epoch, loss=1.21, accuracy=0.708, val_loss=1.96, val_accuracy=0.47, lr=0.1]   5%|▌         | 6/115 [02:56<46:20, 25.51s/epoch, loss=1.2, accuracy=0.719, val_loss=2.33, val_accuracy=0.449, lr=0.1]  6%|▌         | 7/115 [03:20<44:38, 24.80s/epoch, loss=1.19, accuracy=0.725, val_loss=1.72, val_accuracy=0.548, lr=0.1]  7%|▋         | 8/115 [03:43<43:29, 24.38s/epoch, loss=1.19, accuracy=0.728, val_loss=2.09, val_accuracy=0.47, lr=0.1]   8%|▊         | 9/115 [04:07<42:34, 24.10s/epoch, loss=1.19, accuracy=0.729, val_loss=1.55, val_accuracy=0.588, lr=0.0316]  9%|▊         | 10/115 [04:30<41:38, 23.79s/epoch, loss=1.17, accuracy=0.735, val_loss=1.78, val_accuracy=0.506, lr=0.1]   10%|▉         | 11/115 [04:52<40:13, 23.21s/epoch, loss=1.18, accuracy=0.734, val_loss=2.75, val_accuracy=0.388, lr=0.1] 10%|█         | 12/115 [05:14<39:09, 22.81s/epoch, loss=1.17, accuracy=0.737, val_loss=2.29, val_accuracy=0.403, lr=0.1] 11%|█▏        | 13/115 [05:37<38:49, 22.84s/epoch, loss=1.17, accuracy=0.739, val_loss=3.18, val_accuracy=0.234, lr=0.1] 12%|█▏        | 14/115 [06:00<38:38, 22.95s/epoch, loss=1.16, accuracy=0.741, val_loss=1.52, val_accuracy=0.607, lr=0.0316] 13%|█▎        | 15/115 [06:22<37:42, 22.63s/epoch, loss=1.17, accuracy=0.74, val_loss=1.89, val_accuracy=0.52, lr=0.1]      14%|█▍        | 16/115 [06:45<37:43, 22.86s/epoch, loss=1.16, accuracy=0.743, val_loss=3.53, val_accuracy=0.333, lr=0.1] 15%|█▍        | 17/115 [07:08<37:32, 22.98s/epoch, loss=1.16, accuracy=0.743, val_loss=3.48, val_accuracy=0.283, lr=0.1] 16%|█▌        | 18/115 [07:30<36:37, 22.65s/epoch, loss=1.15, accuracy=0.746, val_loss=2.43, val_accuracy=0.427, lr=0.1] 17%|█▋        | 19/115 [07:53<36:27, 22.79s/epoch, loss=1.15, accuracy=0.744, val_loss=1.64, val_accuracy=0.584, lr=0.0316] 17%|█▋        | 20/115 [08:16<36:17, 22.92s/epoch, loss=1.15, accuracy=0.744, val_loss=1.99, val_accuracy=0.501, lr=0.1]    18%|█▊        | 21/115 [08:38<35:26, 22.62s/epoch, loss=1.15, accuracy=0.745, val_loss=1.94, val_accuracy=0.488, lr=0.1] 19%|█▉        | 22/115 [09:02<35:33, 22.94s/epoch, loss=1.14, accuracy=0.75, val_loss=2.15, val_accuracy=0.44, lr=0.1]   20%|██        | 23/115 [09:25<35:22, 23.07s/epoch, loss=1.15, accuracy=0.746, val_loss=1.94, val_accuracy=0.493, lr=0.1] 21%|██        | 24/115 [09:49<35:02, 23.11s/epoch, loss=1.15, accuracy=0.748, val_loss=1.93, val_accuracy=0.495, lr=0.0316] 22%|██▏       | 25/115 [10:11<34:17, 22.87s/epoch, loss=1.14, accuracy=0.751, val_loss=1.61, val_accuracy=0.573, lr=0.1]    23%|██▎       | 26/115 [10:35<34:16, 23.11s/epoch, loss=1.13, accuracy=0.75, val_loss=1.85, val_accuracy=0.525, lr=0.1]  23%|██▎       | 27/115 [10:58<34:05, 23.25s/epoch, loss=1.14, accuracy=0.748, val_loss=2.15, val_accuracy=0.417, lr=0.1] 24%|██▍       | 28/115 [11:22<33:45, 23.28s/epoch, loss=1.14, accuracy=0.748, val_loss=3.63, val_accuracy=0.294, lr=0.1] 25%|██▌       | 29/115 [11:45<33:17, 23.22s/epoch, loss=1.13, accuracy=0.749, val_loss=4.52, val_accuracy=0.289, lr=0.0316] 26%|██▌       | 30/115 [12:07<32:19, 22.82s/epoch, loss=1.14, accuracy=0.748, val_loss=1.56, val_accuracy=0.603, lr=0.1]    27%|██▋       | 31/115 [12:30<32:02, 22.89s/epoch, loss=1.13, accuracy=0.752, val_loss=1.48, val_accuracy=0.626, lr=0.1] 28%|██▊       | 32/115 [12:52<31:31, 22.79s/epoch, loss=1.13, accuracy=0.752, val_loss=1.52, val_accuracy=0.615, lr=0.1] 29%|██▊       | 33/115 [13:14<30:47, 22.53s/epoch, loss=1.12, accuracy=0.754, val_loss=2.12, val_accuracy=0.511, lr=0.1] 30%|██▉       | 34/115 [13:37<30:37, 22.69s/epoch, loss=1.13, accuracy=0.754, val_loss=2.51, val_accuracy=0.36, lr=0.0316] 30%|███       | 35/115 [14:01<30:31, 22.90s/epoch, loss=1.12, accuracy=0.753, val_loss=1.84, val_accuracy=0.563, lr=0.1]   31%|███▏      | 36/115 [14:24<30:15, 22.98s/epoch, loss=1.12, accuracy=0.754, val_loss=1.54, val_accuracy=0.619, lr=0.1] 32%|███▏      | 37/115 [14:47<29:59, 23.07s/epoch, loss=1.12, accuracy=0.753, val_loss=1.96, val_accuracy=0.517, lr=0.1] 33%|███▎      | 38/115 [15:10<29:42, 23.15s/epoch, loss=1.12, accuracy=0.754, val_loss=2.32, val_accuracy=0.4, lr=0.1]   34%|███▍      | 39/115 [15:33<29:14, 23.09s/epoch, loss=1.12, accuracy=0.755, val_loss=1.57, val_accuracy=0.594, lr=0.0316] 35%|███▍      | 40/115 [15:55<28:32, 22.84s/epoch, loss=1.11, accuracy=0.754, val_loss=2.76, val_accuracy=0.407, lr=0.1]    36%|███▌      | 41/115 [16:17<27:47, 22.54s/epoch, loss=1.11, accuracy=0.753, val_loss=1.89, val_accuracy=0.527, lr=0.1] 37%|███▋      | 42/115 [16:39<27:10, 22.34s/epoch, loss=1.11, accuracy=0.754, val_loss=1.71, val_accuracy=0.565, lr=0.1] 37%|███▋      | 43/115 [17:02<27:00, 22.50s/epoch, loss=1.11, accuracy=0.756, val_loss=3.53, val_accuracy=0.342, lr=0.1] 38%|███▊      | 44/115 [17:26<26:57, 22.78s/epoch, loss=1.12, accuracy=0.756, val_loss=3.16, val_accuracy=0.247, lr=0.0316] 39%|███▉      | 45/115 [17:47<26:17, 22.53s/epoch, loss=1.11, accuracy=0.756, val_loss=2.19, val_accuracy=0.484, lr=0.1]    40%|████      | 46/115 [18:09<25:42, 22.35s/epoch, loss=1.11, accuracy=0.756, val_loss=3.26, val_accuracy=0.288, lr=0.1] 41%|████      | 47/115 [18:31<25:14, 22.27s/epoch, loss=1.11, accuracy=0.758, val_loss=4.53, val_accuracy=0.292, lr=0.1] 42%|████▏     | 48/115 [18:55<25:09, 22.53s/epoch, loss=1.11, accuracy=0.757, val_loss=1.55, val_accuracy=0.618, lr=0.1] 43%|████▎     | 49/115 [19:17<24:35, 22.36s/epoch, loss=1.11, accuracy=0.757, val_loss=1.49, val_accuracy=0.627, lr=0.0316] 43%|████▎     | 50/115 [19:39<24:12, 22.34s/epoch, loss=1.11, accuracy=0.755, val_loss=2.4, val_accuracy=0.395, lr=0.1]     44%|████▍     | 51/115 [20:02<24:07, 22.62s/epoch, loss=1.11, accuracy=0.756, val_loss=1.97, val_accuracy=0.518, lr=0.1] 45%|████▌     | 52/115 [20:24<23:28, 22.35s/epoch, loss=1.11, accuracy=0.758, val_loss=1.87, val_accuracy=0.526, lr=0.1] 46%|████▌     | 53/115 [20:48<23:30, 22.75s/epoch, loss=1.1, accuracy=0.759, val_loss=3.71, val_accuracy=0.321, lr=0.1]  47%|████▋     | 54/115 [21:11<23:19, 22.95s/epoch, loss=1.11, accuracy=0.755, val_loss=3.09, val_accuracy=0.346, lr=0.0316] 48%|████▊     | 55/115 [21:33<22:39, 22.66s/epoch, loss=1.11, accuracy=0.758, val_loss=1.91, val_accuracy=0.492, lr=0.1]    49%|████▊     | 56/115 [21:56<22:31, 22.91s/epoch, loss=1.1, accuracy=0.759, val_loss=3.4, val_accuracy=0.29, lr=0.1]    50%|████▉     | 57/115 [22:20<22:16, 23.04s/epoch, loss=1.11, accuracy=0.759, val_loss=2.01, val_accuracy=0.487, lr=0.1] 50%|█████     | 58/115 [22:43<21:57, 23.12s/epoch, loss=1.11, accuracy=0.759, val_loss=2.17, val_accuracy=0.568, lr=0.1] 51%|█████▏    | 59/115 [23:05<21:16, 22.79s/epoch, loss=1.1, accuracy=0.759, val_loss=2.46, val_accuracy=0.472, lr=0.0316] 52%|█████▏    | 60/115 [23:28<20:58, 22.89s/epoch, loss=1.1, accuracy=0.759, val_loss=1.72, val_accuracy=0.551, lr=0.1]    53%|█████▎    | 61/115 [23:52<20:44, 23.04s/epoch, loss=1.11, accuracy=0.758, val_loss=1.78, val_accuracy=0.56, lr=0.1] 54%|█████▍    | 62/115 [24:15<20:24, 23.11s/epoch, loss=1.11, accuracy=0.757, val_loss=2.47, val_accuracy=0.468, lr=0.1] 55%|█████▍    | 63/115 [24:38<20:06, 23.21s/epoch, loss=1.1, accuracy=0.758, val_loss=2.8, val_accuracy=0.288, lr=0.1]   56%|█████▌    | 64/115 [25:02<19:49, 23.33s/epoch, loss=1.11, accuracy=0.757, val_loss=2.45, val_accuracy=0.381, lr=0.0316] 57%|█████▋    | 65/115 [25:25<19:27, 23.35s/epoch, loss=1.1, accuracy=0.759, val_loss=2.41, val_accuracy=0.38, lr=0.1]      57%|█████▋    | 66/115 [25:49<19:10, 23.49s/epoch, loss=1.1, accuracy=0.76, val_loss=2.14, val_accuracy=0.524, lr=0.1] 58%|█████▊    | 67/115 [26:13<18:48, 23.51s/epoch, loss=1.1, accuracy=0.759, val_loss=1.69, val_accuracy=0.577, lr=0.1] 59%|█████▉    | 68/115 [26:36<18:19, 23.39s/epoch, loss=1.11, accuracy=0.759, val_loss=2.45, val_accuracy=0.398, lr=0.1] 60%|██████    | 69/115 [26:59<17:58, 23.45s/epoch, loss=1.1, accuracy=0.76, val_loss=2.93, val_accuracy=0.321, lr=0.0316] 61%|██████    | 70/115 [27:23<17:32, 23.38s/epoch, loss=1.1, accuracy=0.76, val_loss=1.94, val_accuracy=0.473, lr=0.1]    62%|██████▏   | 71/115 [27:46<17:05, 23.31s/epoch, loss=1.1, accuracy=0.76, val_loss=1.87, val_accuracy=0.55, lr=0.1]  63%|██████▎   | 72/115 [28:08<16:27, 22.96s/epoch, loss=1.11, accuracy=0.758, val_loss=3.9, val_accuracy=0.269, lr=0.1] 63%|██████▎   | 73/115 [28:30<15:59, 22.84s/epoch, loss=1.1, accuracy=0.76, val_loss=2.32, val_accuracy=0.385, lr=0.1]  64%|██████▍   | 74/115 [28:52<15:25, 22.58s/epoch, loss=1.11, accuracy=0.759, val_loss=2.57, val_accuracy=0.374, lr=0.0316] 65%|██████▌   | 75/115 [29:16<15:12, 22.81s/epoch, loss=1.11, accuracy=0.758, val_loss=3, val_accuracy=0.339, lr=0.1]       66%|██████▌   | 76/115 [29:38<14:41, 22.61s/epoch, loss=1.1, accuracy=0.759, val_loss=2.14, val_accuracy=0.436, lr=0.1] 67%|██████▋   | 77/115 [30:02<14:30, 22.92s/epoch, loss=1.1, accuracy=0.759, val_loss=1.7, val_accuracy=0.574, lr=0.1]  68%|██████▊   | 78/115 [30:25<14:11, 23.01s/epoch, loss=1.09, accuracy=0.759, val_loss=1.79, val_accuracy=0.547, lr=0.1] 69%|██████▊   | 79/115 [30:47<13:38, 22.73s/epoch, loss=1.1, accuracy=0.759, val_loss=2.33, val_accuracy=0.427, lr=0.0316] 70%|██████▉   | 80/115 [31:10<13:19, 22.84s/epoch, loss=1.1, accuracy=0.759, val_loss=2.38, val_accuracy=0.432, lr=0.1]    70%|███████   | 81/115 [31:33<12:55, 22.81s/epoch, loss=1.1, accuracy=0.761, val_loss=1.61, val_accuracy=0.581, lr=0.1] 71%|███████▏  | 82/115 [31:56<12:40, 23.05s/epoch, loss=0.894, accuracy=0.818, val_loss=0.894, val_accuracy=0.801, lr=0.01] 72%|███████▏  | 83/115 [32:20<12:21, 23.16s/epoch, loss=0.722, accuracy=0.848, val_loss=0.792, val_accuracy=0.811, lr=0.01] 73%|███████▎  | 84/115 [32:43<12:02, 23.30s/epoch, loss=0.642, accuracy=0.856, val_loss=0.744, val_accuracy=0.809, lr=0.01] 74%|███████▍  | 85/115 [33:07<11:39, 23.31s/epoch, loss=0.6, accuracy=0.861, val_loss=0.678, val_accuracy=0.827, lr=0.01]   75%|███████▍  | 86/115 [33:30<11:17, 23.36s/epoch, loss=0.58, accuracy=0.861, val_loss=0.788, val_accuracy=0.791, lr=0.01] 76%|███████▌  | 87/115 [33:53<10:51, 23.27s/epoch, loss=0.57, accuracy=0.862, val_loss=0.851, val_accuracy=0.776, lr=0.01] 77%|███████▋  | 88/115 [34:16<10:26, 23.21s/epoch, loss=0.565, accuracy=0.863, val_loss=0.731, val_accuracy=0.806, lr=0.01] 77%|███████▋  | 89/115 [34:39<10:02, 23.16s/epoch, loss=0.561, accuracy=0.864, val_loss=0.761, val_accuracy=0.809, lr=0.01] 78%|███████▊  | 90/115 [35:03<09:41, 23.26s/epoch, loss=0.559, accuracy=0.865, val_loss=0.812, val_accuracy=0.786, lr=0.00316] 79%|███████▉  | 91/115 [35:25<09:12, 23.00s/epoch, loss=0.554, accuracy=0.868, val_loss=0.975, val_accuracy=0.743, lr=0.01]    80%|████████  | 92/115 [35:47<08:41, 22.68s/epoch, loss=0.556, accuracy=0.869, val_loss=0.845, val_accuracy=0.779, lr=0.01] 81%|████████  | 93/115 [36:11<08:23, 22.90s/epoch, loss=0.549, accuracy=0.871, val_loss=0.858, val_accuracy=0.777, lr=0.01] 82%|████████▏ | 94/115 [36:32<07:53, 22.55s/epoch, loss=0.554, accuracy=0.871, val_loss=0.803, val_accuracy=0.795, lr=0.01] 83%|████████▎ | 95/115 [36:55<07:32, 22.61s/epoch, loss=0.551, accuracy=0.871, val_loss=0.892, val_accuracy=0.758, lr=0.00316] 83%|████████▎ | 96/115 [37:18<07:11, 22.70s/epoch, loss=0.551, accuracy=0.874, val_loss=0.764, val_accuracy=0.802, lr=0.01]    84%|████████▍ | 97/115 [37:41<06:50, 22.83s/epoch, loss=0.549, accuracy=0.875, val_loss=0.761, val_accuracy=0.805, lr=0.01] 85%|████████▌ | 98/115 [38:04<06:30, 22.96s/epoch, loss=0.55, accuracy=0.875, val_loss=0.814, val_accuracy=0.799, lr=0.01]  86%|████████▌ | 99/115 [38:27<06:05, 22.84s/epoch, loss=0.55, accuracy=0.876, val_loss=0.761, val_accuracy=0.812, lr=0.01] 87%|████████▋ | 100/115 [38:49<05:38, 22.54s/epoch, loss=0.553, accuracy=0.877, val_loss=0.895, val_accuracy=0.763, lr=0.00316] 88%|████████▊ | 101/115 [39:12<05:19, 22.83s/epoch, loss=0.549, accuracy=0.875, val_loss=0.744, val_accuracy=0.823, lr=0.01]    89%|████████▊ | 102/115 [39:36<04:58, 22.98s/epoch, loss=0.548, accuracy=0.877, val_loss=0.812, val_accuracy=0.791, lr=0.01] 90%|████████▉ | 103/115 [39:59<04:37, 23.08s/epoch, loss=0.546, accuracy=0.878, val_loss=0.907, val_accuracy=0.766, lr=0.01] 90%|█████████ | 104/115 [40:22<04:13, 23.07s/epoch, loss=0.55, accuracy=0.877, val_loss=0.771, val_accuracy=0.808, lr=0.01]  91%|█████████▏| 105/115 [40:45<03:50, 23.02s/epoch, loss=0.547, accuracy=0.879, val_loss=0.832, val_accuracy=0.787, lr=0.00316] 92%|█████████▏| 106/115 [41:08<03:27, 23.10s/epoch, loss=0.548, accuracy=0.878, val_loss=0.818, val_accuracy=0.796, lr=0.01]    93%|█████████▎| 107/115 [41:31<03:04, 23.02s/epoch, loss=0.552, accuracy=0.878, val_loss=1.35, val_accuracy=0.69, lr=0.01]   94%|█████████▍| 108/115 [41:54<02:41, 23.12s/epoch, loss=0.545, accuracy=0.881, val_loss=1.12, val_accuracy=0.717, lr=0.01] 95%|█████████▍| 109/115 [42:18<02:18, 23.15s/epoch, loss=0.55, accuracy=0.879, val_loss=0.673, val_accuracy=0.841, lr=0.01] 96%|█████████▌| 110/115 [42:41<01:55, 23.13s/epoch, loss=0.549, accuracy=0.881, val_loss=0.794, val_accuracy=0.804, lr=0.01] 97%|█████████▋| 111/115 [43:04<01:32, 23.08s/epoch, loss=0.548, accuracy=0.881, val_loss=0.775, val_accuracy=0.81, lr=0.01]  97%|█████████▋| 112/115 [43:27<01:09, 23.10s/epoch, loss=0.552, accuracy=0.879, val_loss=0.886, val_accuracy=0.778, lr=0.01] 98%|█████████▊| 113/115 [43:50<00:46, 23.06s/epoch, loss=0.549, accuracy=0.882, val_loss=0.909, val_accuracy=0.776, lr=0.01] 99%|█████████▉| 114/115 [44:13<00:23, 23.09s/epoch, loss=0.547, accuracy=0.882, val_loss=0.742, val_accuracy=0.821, lr=0.00316]100%|██████████| 115/115 [44:36<00:00, 23.08s/epoch, loss=0.546, accuracy=0.883, val_loss=0.87, val_accuracy=0.779, lr=0.01]    100%|██████████| 115/115 [44:36<00:00, 23.27s/epoch, loss=0.546, accuracy=0.883, val_loss=0.87, val_accuracy=0.779, lr=0.01]
Using real-time data augmentation.
Test score: 0.8700898289680481
Test accuracy: 0.7793999910354614


* * * Run SGD for ID = 13_6. * * *


2024-03-05 07:28:29.723854: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 07:28:33.195219: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 07:28:33.196188: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-05 07:28:33.234837: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-05 07:28:33.234868: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 07:28:33.238893: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 07:28:33.238934: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-05 07:28:33.241553: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-05 07:28:33.242633: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-05 07:28:33.245479: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-05 07:28:33.247201: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-05 07:28:33.252417: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 07:28:33.252932: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-05 07:28:33.253012: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 07:28:34.543032: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-05 07:28:34.544107: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 07:28:34.544908: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-05 07:28:34.544940: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 07:28:34.544976: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 07:28:34.544994: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-05 07:28:34.545010: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-05 07:28:34.545026: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-05 07:28:34.545043: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-05 07:28:34.545114: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-05 07:28:34.545135: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 07:28:34.545611: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-05 07:28:34.545643: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 07:28:35.179282: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-05 07:28:35.179344: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-05 07:28:35.179354: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-05 07:28:35.180293: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:02:00.0, compute capability: 6.1)
{'id': '13_06', 'seed': 6, 'out_folder': 'results/epoch_budget', 'batch_size': 128, 'epochs': 115, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/115 [00:00<?, ?epoch/s]2024-03-05 07:28:36.029029: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-05 07:28:36.041180: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199825000 Hz
2024-03-05 07:28:38.077264: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 07:28:38.343787: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 07:28:39.121220: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-05 07:28:39.170035: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/115 [00:56<1:47:17, 56.47s/epoch, loss=3.15, accuracy=0.3, val_loss=2.37, val_accuracy=0.229, lr=0.1]  2%|▏         | 2/115 [01:19<1:09:48, 37.07s/epoch, loss=1.59, accuracy=0.511, val_loss=2.29, val_accuracy=0.408, lr=0.1]  3%|▎         | 3/115 [01:43<57:32, 30.83s/epoch, loss=1.34, accuracy=0.634, val_loss=1.79, val_accuracy=0.491, lr=0.1]    3%|▎         | 4/115 [02:06<51:20, 27.75s/epoch, loss=1.26, accuracy=0.681, val_loss=1.64, val_accuracy=0.576, lr=0.1]  4%|▍         | 5/115 [02:29<47:50, 26.10s/epoch, loss=1.23, accuracy=0.7, val_loss=1.37, val_accuracy=0.66, lr=0.1]     5%|▌         | 6/115 [02:52<45:40, 25.14s/epoch, loss=1.22, accuracy=0.715, val_loss=1.77, val_accuracy=0.564, lr=0.1]  6%|▌         | 7/115 [03:15<43:48, 24.34s/epoch, loss=1.21, accuracy=0.719, val_loss=2.38, val_accuracy=0.447, lr=0.1]  7%|▋         | 8/115 [03:39<42:55, 24.07s/epoch, loss=1.19, accuracy=0.725, val_loss=1.83, val_accuracy=0.565, lr=0.1]  8%|▊         | 9/115 [04:01<41:40, 23.59s/epoch, loss=1.2, accuracy=0.73, val_loss=1.67, val_accuracy=0.577, lr=0.1]    9%|▊         | 10/115 [04:24<41:06, 23.49s/epoch, loss=1.19, accuracy=0.731, val_loss=2.08, val_accuracy=0.46, lr=0.0316] 10%|▉         | 11/115 [04:48<40:40, 23.46s/epoch, loss=1.2, accuracy=0.732, val_loss=2.41, val_accuracy=0.469, lr=0.1]    10%|█         | 12/115 [05:11<40:08, 23.38s/epoch, loss=1.19, accuracy=0.733, val_loss=2.08, val_accuracy=0.512, lr=0.1] 11%|█▏        | 13/115 [05:34<39:35, 23.29s/epoch, loss=1.18, accuracy=0.737, val_loss=4.51, val_accuracy=0.256, lr=0.1] 12%|█▏        | 14/115 [05:57<39:15, 23.32s/epoch, loss=1.18, accuracy=0.738, val_loss=3.61, val_accuracy=0.356, lr=0.1] 13%|█▎        | 15/115 [06:20<38:25, 23.06s/epoch, loss=1.18, accuracy=0.738, val_loss=1.89, val_accuracy=0.519, lr=0.0316] 14%|█▍        | 16/115 [06:42<37:22, 22.65s/epoch, loss=1.18, accuracy=0.739, val_loss=2.15, val_accuracy=0.516, lr=0.1]    15%|█▍        | 17/115 [07:04<37:02, 22.68s/epoch, loss=1.17, accuracy=0.74, val_loss=1.94, val_accuracy=0.552, lr=0.1]  16%|█▌        | 18/115 [07:27<36:29, 22.57s/epoch, loss=1.16, accuracy=0.742, val_loss=1.75, val_accuracy=0.58, lr=0.1] 17%|█▋        | 19/115 [07:50<36:28, 22.80s/epoch, loss=1.16, accuracy=0.744, val_loss=1.44, val_accuracy=0.652, lr=0.1] 17%|█▋        | 20/115 [08:13<36:13, 22.87s/epoch, loss=1.16, accuracy=0.745, val_loss=2.54, val_accuracy=0.418, lr=0.0316] 18%|█▊        | 21/115 [08:36<36:07, 23.05s/epoch, loss=1.16, accuracy=0.743, val_loss=1.58, val_accuracy=0.616, lr=0.1]    19%|█▉        | 22/115 [08:59<35:24, 22.84s/epoch, loss=1.15, accuracy=0.747, val_loss=1.41, val_accuracy=0.662, lr=0.1] 20%|██        | 23/115 [09:22<35:11, 22.95s/epoch, loss=1.16, accuracy=0.745, val_loss=2.53, val_accuracy=0.438, lr=0.1] 21%|██        | 24/115 [09:45<35:03, 23.11s/epoch, loss=1.15, accuracy=0.749, val_loss=2.25, val_accuracy=0.404, lr=0.1] 22%|██▏       | 25/115 [10:09<34:49, 23.21s/epoch, loss=1.15, accuracy=0.749, val_loss=1.62, val_accuracy=0.601, lr=0.0316] 23%|██▎       | 26/115 [10:32<34:33, 23.30s/epoch, loss=1.14, accuracy=0.751, val_loss=2.28, val_accuracy=0.511, lr=0.1]    23%|██▎       | 27/115 [10:56<34:11, 23.31s/epoch, loss=1.14, accuracy=0.749, val_loss=2.5, val_accuracy=0.415, lr=0.1]  24%|██▍       | 28/115 [11:19<33:32, 23.13s/epoch, loss=1.14, accuracy=0.75, val_loss=1.8, val_accuracy=0.575, lr=0.1]  25%|██▌       | 29/115 [11:40<32:36, 22.75s/epoch, loss=1.14, accuracy=0.751, val_loss=2.41, val_accuracy=0.383, lr=0.1] 26%|██▌       | 30/115 [12:03<32:22, 22.85s/epoch, loss=1.14, accuracy=0.752, val_loss=2.78, val_accuracy=0.336, lr=0.0316] 27%|██▋       | 31/115 [12:26<31:58, 22.84s/epoch, loss=1.14, accuracy=0.751, val_loss=5.77, val_accuracy=0.19, lr=0.1]     28%|██▊       | 32/115 [12:49<31:41, 22.91s/epoch, loss=1.14, accuracy=0.75, val_loss=2.55, val_accuracy=0.336, lr=0.1] 29%|██▊       | 33/115 [13:13<31:32, 23.08s/epoch, loss=1.13, accuracy=0.754, val_loss=1.97, val_accuracy=0.538, lr=0.1] 30%|██▉       | 34/115 [13:36<31:17, 23.18s/epoch, loss=1.14, accuracy=0.75, val_loss=2.24, val_accuracy=0.472, lr=0.1]  30%|███       | 35/115 [13:59<30:54, 23.18s/epoch, loss=1.13, accuracy=0.754, val_loss=2.65, val_accuracy=0.372, lr=0.0316] 31%|███▏      | 36/115 [14:23<30:30, 23.17s/epoch, loss=1.13, accuracy=0.754, val_loss=1.56, val_accuracy=0.615, lr=0.1]    32%|███▏      | 37/115 [14:46<30:13, 23.25s/epoch, loss=1.13, accuracy=0.754, val_loss=2.4, val_accuracy=0.422, lr=0.1]  33%|███▎      | 38/115 [15:09<29:44, 23.18s/epoch, loss=1.12, accuracy=0.753, val_loss=1.76, val_accuracy=0.576, lr=0.1] 34%|███▍      | 39/115 [15:32<29:22, 23.20s/epoch, loss=1.13, accuracy=0.754, val_loss=2.54, val_accuracy=0.4, lr=0.1]   35%|███▍      | 40/115 [15:55<28:50, 23.07s/epoch, loss=1.12, accuracy=0.755, val_loss=1.56, val_accuracy=0.613, lr=0.0316] 36%|███▌      | 41/115 [16:18<28:34, 23.17s/epoch, loss=1.13, accuracy=0.752, val_loss=2.27, val_accuracy=0.419, lr=0.1]    37%|███▋      | 42/115 [16:42<28:09, 23.15s/epoch, loss=1.12, accuracy=0.754, val_loss=2.24, val_accuracy=0.435, lr=0.1] 37%|███▋      | 43/115 [17:03<27:17, 22.74s/epoch, loss=1.12, accuracy=0.754, val_loss=3.31, val_accuracy=0.338, lr=0.1] 38%|███▊      | 44/115 [17:25<26:35, 22.47s/epoch, loss=1.12, accuracy=0.754, val_loss=2.4, val_accuracy=0.405, lr=0.1]  39%|███▉      | 45/115 [17:47<25:58, 22.27s/epoch, loss=1.12, accuracy=0.754, val_loss=1.6, val_accuracy=0.598, lr=0.0316] 40%|████      | 46/115 [18:10<25:58, 22.59s/epoch, loss=1.11, accuracy=0.756, val_loss=1.41, val_accuracy=0.654, lr=0.1]   41%|████      | 47/115 [18:34<25:55, 22.87s/epoch, loss=1.12, accuracy=0.756, val_loss=2.71, val_accuracy=0.43, lr=0.1]  42%|████▏     | 48/115 [18:57<25:33, 22.90s/epoch, loss=1.11, accuracy=0.755, val_loss=2.38, val_accuracy=0.358, lr=0.1] 43%|████▎     | 49/115 [19:19<24:51, 22.60s/epoch, loss=1.11, accuracy=0.755, val_loss=3.25, val_accuracy=0.354, lr=0.1] 43%|████▎     | 50/115 [19:41<24:13, 22.37s/epoch, loss=1.12, accuracy=0.753, val_loss=1.55, val_accuracy=0.613, lr=0.0316] 44%|████▍     | 51/115 [20:04<24:08, 22.63s/epoch, loss=1.11, accuracy=0.758, val_loss=2.39, val_accuracy=0.396, lr=0.1]    45%|████▌     | 52/115 [20:27<24:00, 22.87s/epoch, loss=1.11, accuracy=0.758, val_loss=1.87, val_accuracy=0.507, lr=0.1] 46%|████▌     | 53/115 [20:51<23:51, 23.08s/epoch, loss=1.11, accuracy=0.759, val_loss=2.12, val_accuracy=0.403, lr=0.1] 47%|████▋     | 54/115 [21:14<23:36, 23.22s/epoch, loss=1.11, accuracy=0.754, val_loss=2.5, val_accuracy=0.357, lr=0.1]  48%|████▊     | 55/115 [21:38<23:17, 23.29s/epoch, loss=1.11, accuracy=0.756, val_loss=1.58, val_accuracy=0.617, lr=0.0316] 49%|████▊     | 56/115 [22:01<22:49, 23.21s/epoch, loss=1.11, accuracy=0.759, val_loss=1.74, val_accuracy=0.558, lr=0.1]    50%|████▉     | 57/115 [22:24<22:31, 23.30s/epoch, loss=1.11, accuracy=0.756, val_loss=2.34, val_accuracy=0.438, lr=0.1] 50%|█████     | 58/115 [22:48<22:07, 23.30s/epoch, loss=1.11, accuracy=0.756, val_loss=3.38, val_accuracy=0.248, lr=0.1] 51%|█████▏    | 59/115 [23:09<21:20, 22.87s/epoch, loss=1.11, accuracy=0.754, val_loss=1.59, val_accuracy=0.611, lr=0.1] 52%|█████▏    | 60/115 [23:33<21:04, 23.00s/epoch, loss=1.11, accuracy=0.759, val_loss=1.72, val_accuracy=0.563, lr=0.0316] 53%|█████▎    | 61/115 [23:56<20:47, 23.10s/epoch, loss=1.1, accuracy=0.758, val_loss=1.99, val_accuracy=0.497, lr=0.1]     54%|█████▍    | 62/115 [24:19<20:28, 23.18s/epoch, loss=1.1, accuracy=0.759, val_loss=3.3, val_accuracy=0.314, lr=0.1]  55%|█████▍    | 63/115 [24:43<20:15, 23.38s/epoch, loss=1.1, accuracy=0.757, val_loss=1.68, val_accuracy=0.546, lr=0.1] 56%|█████▌    | 64/115 [25:07<19:58, 23.51s/epoch, loss=1.11, accuracy=0.759, val_loss=1.62, val_accuracy=0.591, lr=0.1] 57%|█████▋    | 65/115 [25:30<19:18, 23.18s/epoch, loss=1.11, accuracy=0.758, val_loss=1.67, val_accuracy=0.568, lr=0.0316] 57%|█████▋    | 66/115 [25:52<18:43, 22.92s/epoch, loss=1.1, accuracy=0.76, val_loss=1.4, val_accuracy=0.658, lr=0.1]       58%|█████▊    | 67/115 [26:14<18:02, 22.56s/epoch, loss=1.1, accuracy=0.76, val_loss=2.65, val_accuracy=0.454, lr=0.1] 59%|█████▉    | 68/115 [26:37<17:49, 22.76s/epoch, loss=1.11, accuracy=0.758, val_loss=1.72, val_accuracy=0.609, lr=0.1] 60%|██████    | 69/115 [26:59<17:22, 22.66s/epoch, loss=1.11, accuracy=0.755, val_loss=2.05, val_accuracy=0.447, lr=0.1] 61%|██████    | 70/115 [27:21<16:46, 22.37s/epoch, loss=1.11, accuracy=0.757, val_loss=1.56, val_accuracy=0.594, lr=0.0316] 62%|██████▏   | 71/115 [27:44<16:35, 22.61s/epoch, loss=1.1, accuracy=0.758, val_loss=1.94, val_accuracy=0.494, lr=0.1]     63%|██████▎   | 72/115 [28:06<16:05, 22.46s/epoch, loss=1.11, accuracy=0.758, val_loss=3.23, val_accuracy=0.385, lr=0.1] 63%|██████▎   | 73/115 [28:29<15:53, 22.70s/epoch, loss=1.11, accuracy=0.757, val_loss=5.13, val_accuracy=0.267, lr=0.1] 64%|██████▍   | 74/115 [28:52<15:27, 22.63s/epoch, loss=1.11, accuracy=0.759, val_loss=2.86, val_accuracy=0.359, lr=0.1] 65%|██████▌   | 75/115 [29:15<15:13, 22.85s/epoch, loss=1.11, accuracy=0.757, val_loss=1.88, val_accuracy=0.549, lr=0.0316] 66%|██████▌   | 76/115 [29:38<14:53, 22.90s/epoch, loss=1.11, accuracy=0.759, val_loss=2.26, val_accuracy=0.476, lr=0.1]    67%|██████▋   | 77/115 [30:01<14:32, 22.95s/epoch, loss=1.11, accuracy=0.758, val_loss=1.92, val_accuracy=0.489, lr=0.1] 68%|██████▊   | 78/115 [30:24<14:03, 22.79s/epoch, loss=1.11, accuracy=0.756, val_loss=1.94, val_accuracy=0.445, lr=0.1] 69%|██████▊   | 79/115 [30:47<13:44, 22.90s/epoch, loss=1.11, accuracy=0.757, val_loss=2.46, val_accuracy=0.428, lr=0.1] 70%|██████▉   | 80/115 [31:10<13:21, 22.91s/epoch, loss=1.1, accuracy=0.757, val_loss=2.54, val_accuracy=0.395, lr=0.0316] 70%|███████   | 81/115 [31:33<13:01, 22.99s/epoch, loss=1.11, accuracy=0.757, val_loss=2.44, val_accuracy=0.49, lr=0.1]    71%|███████▏  | 82/115 [31:56<12:37, 22.96s/epoch, loss=0.899, accuracy=0.819, val_loss=0.933, val_accuracy=0.79, lr=0.01] 72%|███████▏  | 83/115 [32:18<12:03, 22.60s/epoch, loss=0.727, accuracy=0.847, val_loss=0.872, val_accuracy=0.783, lr=0.01] 73%|███████▎  | 84/115 [32:39<11:30, 22.26s/epoch, loss=0.647, accuracy=0.856, val_loss=0.753, val_accuracy=0.809, lr=0.01] 74%|███████▍  | 85/115 [33:02<11:10, 22.36s/epoch, loss=0.605, accuracy=0.858, val_loss=1.07, val_accuracy=0.71, lr=0.01]   75%|███████▍  | 86/115 [33:24<10:46, 22.28s/epoch, loss=0.585, accuracy=0.859, val_loss=0.948, val_accuracy=0.762, lr=0.01] 76%|███████▌  | 87/115 [33:47<10:28, 22.46s/epoch, loss=0.573, accuracy=0.861, val_loss=0.72, val_accuracy=0.813, lr=0.01]  77%|███████▋  | 88/115 [34:09<10:04, 22.40s/epoch, loss=0.57, accuracy=0.861, val_loss=0.741, val_accuracy=0.804, lr=0.01] 77%|███████▋  | 89/115 [34:31<09:42, 22.40s/epoch, loss=0.566, accuracy=0.863, val_loss=0.868, val_accuracy=0.757, lr=0.01] 78%|███████▊  | 90/115 [34:54<09:25, 22.61s/epoch, loss=0.568, accuracy=0.864, val_loss=1.22, val_accuracy=0.667, lr=0.01]  79%|███████▉  | 91/115 [35:17<09:02, 22.61s/epoch, loss=0.564, accuracy=0.866, val_loss=0.752, val_accuracy=0.808, lr=0.01] 80%|████████  | 92/115 [35:40<08:44, 22.80s/epoch, loss=0.56, accuracy=0.867, val_loss=0.796, val_accuracy=0.786, lr=0.00316] 81%|████████  | 93/115 [36:03<08:23, 22.90s/epoch, loss=0.561, accuracy=0.868, val_loss=1.07, val_accuracy=0.719, lr=0.01]    82%|████████▏ | 94/115 [36:26<08:01, 22.94s/epoch, loss=0.558, accuracy=0.868, val_loss=0.898, val_accuracy=0.773, lr=0.01] 83%|████████▎ | 95/115 [36:49<07:35, 22.79s/epoch, loss=0.56, accuracy=0.871, val_loss=0.941, val_accuracy=0.757, lr=0.01]  83%|████████▎ | 96/115 [37:11<07:11, 22.71s/epoch, loss=0.56, accuracy=0.87, val_loss=0.787, val_accuracy=0.801, lr=0.01]  84%|████████▍ | 97/115 [37:34<06:47, 22.64s/epoch, loss=0.557, accuracy=0.872, val_loss=0.744, val_accuracy=0.81, lr=0.00316] 85%|████████▌ | 98/115 [37:56<06:22, 22.51s/epoch, loss=0.554, accuracy=0.873, val_loss=1.2, val_accuracy=0.723, lr=0.01]     86%|████████▌ | 99/115 [38:18<05:55, 22.22s/epoch, loss=0.562, accuracy=0.872, val_loss=0.921, val_accuracy=0.764, lr=0.01] 87%|████████▋ | 100/115 [38:40<05:34, 22.29s/epoch, loss=0.557, accuracy=0.873, val_loss=0.875, val_accuracy=0.772, lr=0.01] 88%|████████▊ | 101/115 [39:03<05:16, 22.61s/epoch, loss=0.558, accuracy=0.874, val_loss=0.88, val_accuracy=0.789, lr=0.01]  89%|████████▊ | 102/115 [39:25<04:50, 22.37s/epoch, loss=0.555, accuracy=0.876, val_loss=1.17, val_accuracy=0.708, lr=0.00316] 90%|████████▉ | 103/115 [39:47<04:25, 22.13s/epoch, loss=0.558, accuracy=0.875, val_loss=1.37, val_accuracy=0.644, lr=0.01]    90%|█████████ | 104/115 [40:08<04:01, 21.97s/epoch, loss=0.557, accuracy=0.876, val_loss=0.755, val_accuracy=0.815, lr=0.01] 91%|█████████▏| 105/115 [40:32<03:43, 22.30s/epoch, loss=0.555, accuracy=0.877, val_loss=0.888, val_accuracy=0.771, lr=0.01] 92%|█████████▏| 106/115 [40:53<03:18, 22.10s/epoch, loss=0.552, accuracy=0.877, val_loss=0.906, val_accuracy=0.771, lr=0.01] 93%|█████████▎| 107/115 [41:16<02:58, 22.30s/epoch, loss=0.555, accuracy=0.879, val_loss=0.796, val_accuracy=0.803, lr=0.00316] 94%|█████████▍| 108/115 [41:39<02:37, 22.46s/epoch, loss=0.554, accuracy=0.878, val_loss=0.99, val_accuracy=0.75, lr=0.01]      95%|█████████▍| 109/115 [42:00<02:13, 22.17s/epoch, loss=0.56, accuracy=0.877, val_loss=0.725, val_accuracy=0.829, lr=0.01] 96%|█████████▌| 110/115 [42:24<01:52, 22.50s/epoch, loss=0.554, accuracy=0.881, val_loss=0.795, val_accuracy=0.813, lr=0.01] 97%|█████████▋| 111/115 [42:46<01:29, 22.49s/epoch, loss=0.553, accuracy=0.879, val_loss=0.866, val_accuracy=0.781, lr=0.01] 97%|█████████▋| 112/115 [43:09<01:07, 22.64s/epoch, loss=0.56, accuracy=0.879, val_loss=1.02, val_accuracy=0.719, lr=0.00316] 98%|█████████▊| 113/115 [43:31<00:45, 22.58s/epoch, loss=0.551, accuracy=0.88, val_loss=0.848, val_accuracy=0.795, lr=0.01]   99%|█████████▉| 114/115 [43:54<00:22, 22.45s/epoch, loss=0.554, accuracy=0.881, val_loss=0.897, val_accuracy=0.769, lr=0.01]100%|██████████| 115/115 [44:16<00:00, 22.37s/epoch, loss=0.55, accuracy=0.88, val_loss=0.959, val_accuracy=0.762, lr=0.01]  100%|██████████| 115/115 [44:16<00:00, 23.10s/epoch, loss=0.55, accuracy=0.88, val_loss=0.959, val_accuracy=0.762, lr=0.01]
Using real-time data augmentation.
Test score: 0.9591649174690247
Test accuracy: 0.7620000243186951


* * * Run SGD for ID = 13_7. * * *


2024-03-05 08:12:55.862909: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 08:12:58.664076: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 08:12:58.665192: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-05 08:12:58.703319: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-05 08:12:58.703364: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 08:12:58.706282: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 08:12:58.706324: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-05 08:12:58.708778: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-05 08:12:58.710175: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-05 08:12:58.712560: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-05 08:12:58.714035: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-05 08:12:58.718690: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 08:12:58.719197: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-05 08:12:58.719276: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 08:12:59.965181: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-05 08:12:59.965724: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 08:12:59.966621: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-05 08:12:59.966654: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 08:12:59.966690: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 08:12:59.966707: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-05 08:12:59.966725: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-05 08:12:59.966743: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-05 08:12:59.966759: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-05 08:12:59.966781: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-05 08:12:59.966798: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 08:12:59.967245: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-05 08:12:59.967279: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 08:13:00.585970: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-05 08:13:00.586025: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-05 08:13:00.586033: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-05 08:13:00.586950: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:02:00.0, compute capability: 6.1)
{'id': '13_07', 'seed': 7, 'out_folder': 'results/epoch_budget', 'batch_size': 128, 'epochs': 115, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/115 [00:00<?, ?epoch/s]2024-03-05 08:13:01.417252: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-05 08:13:01.429167: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199825000 Hz
2024-03-05 08:13:03.406785: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 08:13:03.593129: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 08:13:04.410752: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-05 08:13:04.459177: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/115 [00:55<1:45:06, 55.32s/epoch, loss=3.14, accuracy=0.328, val_loss=2.64, val_accuracy=0.197, lr=0.1]  2%|▏         | 2/115 [01:18<1:08:38, 36.45s/epoch, loss=1.57, accuracy=0.524, val_loss=1.87, val_accuracy=0.475, lr=0.1]  3%|▎         | 3/115 [01:40<55:34, 29.77s/epoch, loss=1.35, accuracy=0.622, val_loss=2.18, val_accuracy=0.365, lr=0.1]    3%|▎         | 4/115 [02:03<50:31, 27.31s/epoch, loss=1.28, accuracy=0.67, val_loss=1.95, val_accuracy=0.474, lr=0.1]   4%|▍         | 5/115 [02:26<46:41, 25.47s/epoch, loss=1.24, accuracy=0.696, val_loss=2.2, val_accuracy=0.428, lr=0.1]  5%|▌         | 6/115 [02:47<43:55, 24.18s/epoch, loss=1.22, accuracy=0.707, val_loss=1.83, val_accuracy=0.518, lr=0.1]  6%|▌         | 7/115 [03:11<43:06, 23.95s/epoch, loss=1.22, accuracy=0.716, val_loss=1.99, val_accuracy=0.509, lr=0.1]  7%|▋         | 8/115 [03:34<42:20, 23.74s/epoch, loss=1.21, accuracy=0.721, val_loss=2.07, val_accuracy=0.467, lr=0.1]  8%|▊         | 9/115 [03:57<41:28, 23.48s/epoch, loss=1.21, accuracy=0.725, val_loss=2.61, val_accuracy=0.389, lr=0.1]  9%|▊         | 10/115 [04:20<40:56, 23.39s/epoch, loss=1.19, accuracy=0.729, val_loss=2.32, val_accuracy=0.486, lr=0.1] 10%|▉         | 11/115 [04:44<40:32, 23.39s/epoch, loss=1.2, accuracy=0.732, val_loss=2.01, val_accuracy=0.442, lr=0.0316] 10%|█         | 12/115 [05:07<40:09, 23.40s/epoch, loss=1.18, accuracy=0.736, val_loss=2.45, val_accuracy=0.451, lr=0.1]   11%|█▏        | 13/115 [05:30<39:39, 23.33s/epoch, loss=1.19, accuracy=0.735, val_loss=2.13, val_accuracy=0.523, lr=0.1] 12%|█▏        | 14/115 [05:53<38:58, 23.15s/epoch, loss=1.18, accuracy=0.735, val_loss=2.53, val_accuracy=0.448, lr=0.1] 13%|█▎        | 15/115 [06:15<38:14, 22.94s/epoch, loss=1.18, accuracy=0.739, val_loss=2.04, val_accuracy=0.428, lr=0.1] 14%|█▍        | 16/115 [06:39<37:59, 23.02s/epoch, loss=1.18, accuracy=0.739, val_loss=2.3, val_accuracy=0.354, lr=0.0316] 15%|█▍        | 17/115 [07:00<36:59, 22.65s/epoch, loss=1.17, accuracy=0.74, val_loss=2.22, val_accuracy=0.423, lr=0.1]    16%|█▌        | 18/115 [07:24<37:02, 22.92s/epoch, loss=1.17, accuracy=0.742, val_loss=2.69, val_accuracy=0.268, lr=0.1] 17%|█▋        | 19/115 [07:47<36:51, 23.03s/epoch, loss=1.17, accuracy=0.744, val_loss=2.42, val_accuracy=0.366, lr=0.1] 17%|█▋        | 20/115 [08:10<36:36, 23.12s/epoch, loss=1.16, accuracy=0.742, val_loss=1.66, val_accuracy=0.616, lr=0.1] 18%|█▊        | 21/115 [08:34<36:14, 23.13s/epoch, loss=1.16, accuracy=0.745, val_loss=2.88, val_accuracy=0.353, lr=0.1] 19%|█▉        | 22/115 [08:57<36:03, 23.26s/epoch, loss=1.16, accuracy=0.746, val_loss=2.12, val_accuracy=0.402, lr=0.1] 20%|██        | 23/115 [09:21<35:46, 23.33s/epoch, loss=1.16, accuracy=0.747, val_loss=2.09, val_accuracy=0.463, lr=0.1] 21%|██        | 24/115 [09:43<34:43, 22.90s/epoch, loss=1.16, accuracy=0.746, val_loss=2.01, val_accuracy=0.431, lr=0.1] 22%|██▏       | 25/115 [10:05<33:54, 22.61s/epoch, loss=1.15, accuracy=0.75, val_loss=1.86, val_accuracy=0.512, lr=0.0316] 23%|██▎       | 26/115 [10:28<34:01, 22.94s/epoch, loss=1.16, accuracy=0.747, val_loss=2.63, val_accuracy=0.411, lr=0.1]   23%|██▎       | 27/115 [10:52<33:57, 23.15s/epoch, loss=1.15, accuracy=0.747, val_loss=2.02, val_accuracy=0.503, lr=0.1] 24%|██▍       | 28/115 [11:15<33:38, 23.20s/epoch, loss=1.15, accuracy=0.747, val_loss=2.22, val_accuracy=0.495, lr=0.1] 25%|██▌       | 29/115 [11:39<33:19, 23.25s/epoch, loss=1.15, accuracy=0.747, val_loss=2.9, val_accuracy=0.448, lr=0.1]  26%|██▌       | 30/115 [12:02<32:55, 23.24s/epoch, loss=1.15, accuracy=0.749, val_loss=2.31, val_accuracy=0.4, lr=0.0316] 27%|██▋       | 31/115 [12:24<31:55, 22.81s/epoch, loss=1.15, accuracy=0.751, val_loss=1.66, val_accuracy=0.598, lr=0.1]  28%|██▊       | 32/115 [12:47<31:43, 22.93s/epoch, loss=1.14, accuracy=0.751, val_loss=2.07, val_accuracy=0.511, lr=0.1] 29%|██▊       | 33/115 [13:10<31:30, 23.05s/epoch, loss=1.15, accuracy=0.748, val_loss=1.69, val_accuracy=0.566, lr=0.1] 30%|██▉       | 34/115 [13:34<31:16, 23.17s/epoch, loss=1.14, accuracy=0.751, val_loss=3.9, val_accuracy=0.303, lr=0.1]  30%|███       | 35/115 [13:57<30:55, 23.19s/epoch, loss=1.15, accuracy=0.752, val_loss=2.43, val_accuracy=0.44, lr=0.0316] 31%|███▏      | 36/115 [14:19<30:09, 22.91s/epoch, loss=1.15, accuracy=0.75, val_loss=2.54, val_accuracy=0.4, lr=0.1]      32%|███▏      | 37/115 [14:43<30:01, 23.09s/epoch, loss=1.14, accuracy=0.753, val_loss=2.03, val_accuracy=0.464, lr=0.1] 33%|███▎      | 38/115 [15:06<29:35, 23.05s/epoch, loss=1.14, accuracy=0.754, val_loss=2.03, val_accuracy=0.477, lr=0.1] 34%|███▍      | 39/115 [15:29<29:17, 23.12s/epoch, loss=1.14, accuracy=0.753, val_loss=1.61, val_accuracy=0.592, lr=0.1] 35%|███▍      | 40/115 [15:52<28:54, 23.13s/epoch, loss=1.13, accuracy=0.756, val_loss=4.57, val_accuracy=0.269, lr=0.1] 36%|███▌      | 41/115 [16:15<28:36, 23.19s/epoch, loss=1.14, accuracy=0.752, val_loss=2.44, val_accuracy=0.34, lr=0.1]  37%|███▋      | 42/115 [16:37<27:42, 22.78s/epoch, loss=1.14, accuracy=0.753, val_loss=1.88, val_accuracy=0.518, lr=0.1] 37%|███▋      | 43/115 [16:59<26:58, 22.48s/epoch, loss=1.13, accuracy=0.754, val_loss=2.18, val_accuracy=0.488, lr=0.1] 38%|███▊      | 44/115 [17:22<26:54, 22.75s/epoch, loss=1.14, accuracy=0.754, val_loss=2.69, val_accuracy=0.377, lr=0.0316] 39%|███▉      | 45/115 [17:46<26:43, 22.90s/epoch, loss=1.15, accuracy=0.752, val_loss=1.72, val_accuracy=0.552, lr=0.1]    40%|████      | 46/115 [18:09<26:26, 23.00s/epoch, loss=1.14, accuracy=0.754, val_loss=2.08, val_accuracy=0.428, lr=0.1] 41%|████      | 47/115 [18:31<25:40, 22.65s/epoch, loss=1.15, accuracy=0.753, val_loss=2.59, val_accuracy=0.388, lr=0.1] 42%|████▏     | 48/115 [18:54<25:30, 22.84s/epoch, loss=1.14, accuracy=0.754, val_loss=2.58, val_accuracy=0.35, lr=0.1]  43%|████▎     | 49/115 [19:17<25:14, 22.95s/epoch, loss=1.14, accuracy=0.755, val_loss=2.09, val_accuracy=0.481, lr=0.0316] 43%|████▎     | 50/115 [19:40<24:59, 23.07s/epoch, loss=1.14, accuracy=0.754, val_loss=2.1, val_accuracy=0.465, lr=0.1]     44%|████▍     | 51/115 [20:04<24:42, 23.16s/epoch, loss=1.14, accuracy=0.754, val_loss=3.41, val_accuracy=0.276, lr=0.1] 45%|████▌     | 52/115 [20:27<24:15, 23.11s/epoch, loss=1.13, accuracy=0.756, val_loss=2.7, val_accuracy=0.423, lr=0.1]  46%|████▌     | 53/115 [20:50<23:57, 23.19s/epoch, loss=1.13, accuracy=0.756, val_loss=2.75, val_accuracy=0.41, lr=0.1] 47%|████▋     | 54/115 [21:13<23:33, 23.16s/epoch, loss=1.14, accuracy=0.754, val_loss=2.31, val_accuracy=0.408, lr=0.0316] 48%|████▊     | 55/115 [21:36<23:10, 23.17s/epoch, loss=1.13, accuracy=0.757, val_loss=2.33, val_accuracy=0.405, lr=0.1]    49%|████▊     | 56/115 [22:00<22:45, 23.15s/epoch, loss=1.13, accuracy=0.754, val_loss=1.45, val_accuracy=0.653, lr=0.1] 50%|████▉     | 57/115 [22:23<22:26, 23.21s/epoch, loss=1.13, accuracy=0.756, val_loss=1.43, val_accuracy=0.649, lr=0.1] 50%|█████     | 58/115 [22:46<22:01, 23.19s/epoch, loss=1.12, accuracy=0.759, val_loss=2.85, val_accuracy=0.308, lr=0.1] 51%|█████▏    | 59/115 [23:08<21:16, 22.80s/epoch, loss=1.13, accuracy=0.756, val_loss=4.05, val_accuracy=0.303, lr=0.1] 52%|█████▏    | 60/115 [23:31<21:02, 22.95s/epoch, loss=1.13, accuracy=0.754, val_loss=2.54, val_accuracy=0.376, lr=0.1] 53%|█████▎    | 61/115 [23:55<20:46, 23.08s/epoch, loss=1.13, accuracy=0.754, val_loss=5.21, val_accuracy=0.166, lr=0.1] 54%|█████▍    | 62/115 [24:18<20:28, 23.18s/epoch, loss=1.13, accuracy=0.754, val_loss=2.36, val_accuracy=0.439, lr=0.0316] 55%|█████▍    | 63/115 [24:40<19:47, 22.84s/epoch, loss=1.13, accuracy=0.76, val_loss=2.37, val_accuracy=0.425, lr=0.1]     56%|█████▌    | 64/115 [25:03<19:19, 22.73s/epoch, loss=1.13, accuracy=0.756, val_loss=1.77, val_accuracy=0.528, lr=0.1] 57%|█████▋    | 65/115 [25:26<19:05, 22.90s/epoch, loss=1.13, accuracy=0.754, val_loss=2.03, val_accuracy=0.502, lr=0.1] 57%|█████▋    | 66/115 [25:48<18:36, 22.79s/epoch, loss=1.13, accuracy=0.757, val_loss=3.92, val_accuracy=0.321, lr=0.1] 58%|█████▊    | 67/115 [26:12<18:22, 22.98s/epoch, loss=1.12, accuracy=0.757, val_loss=2.39, val_accuracy=0.376, lr=0.0316] 59%|█████▉    | 68/115 [26:35<18:05, 23.10s/epoch, loss=1.13, accuracy=0.758, val_loss=2.82, val_accuracy=0.394, lr=0.1]    60%|██████    | 69/115 [26:58<17:44, 23.15s/epoch, loss=1.13, accuracy=0.758, val_loss=1.79, val_accuracy=0.564, lr=0.1] 61%|██████    | 70/115 [27:22<17:24, 23.20s/epoch, loss=1.13, accuracy=0.755, val_loss=1.72, val_accuracy=0.535, lr=0.1] 62%|██████▏   | 71/115 [27:45<17:02, 23.24s/epoch, loss=1.12, accuracy=0.756, val_loss=2.94, val_accuracy=0.368, lr=0.1] 63%|██████▎   | 72/115 [28:08<16:30, 23.03s/epoch, loss=1.12, accuracy=0.759, val_loss=2.56, val_accuracy=0.337, lr=0.0316] 63%|██████▎   | 73/115 [28:29<15:51, 22.65s/epoch, loss=1.12, accuracy=0.759, val_loss=1.81, val_accuracy=0.494, lr=0.1]    64%|██████▍   | 74/115 [28:51<15:20, 22.44s/epoch, loss=1.12, accuracy=0.755, val_loss=1.44, val_accuracy=0.64, lr=0.1]  65%|██████▌   | 75/115 [29:15<15:06, 22.67s/epoch, loss=1.12, accuracy=0.759, val_loss=4.35, val_accuracy=0.214, lr=0.1] 66%|██████▌   | 76/115 [29:38<14:50, 22.84s/epoch, loss=1.13, accuracy=0.757, val_loss=1.9, val_accuracy=0.504, lr=0.1]  67%|██████▋   | 77/115 [30:01<14:34, 23.00s/epoch, loss=1.12, accuracy=0.758, val_loss=2.14, val_accuracy=0.433, lr=0.0316] 68%|██████▊   | 78/115 [30:25<14:19, 23.23s/epoch, loss=1.12, accuracy=0.756, val_loss=3.47, val_accuracy=0.261, lr=0.1]    69%|██████▊   | 79/115 [30:47<13:40, 22.80s/epoch, loss=1.12, accuracy=0.76, val_loss=1.95, val_accuracy=0.465, lr=0.1]  70%|██████▉   | 80/115 [31:10<13:22, 22.92s/epoch, loss=1.12, accuracy=0.757, val_loss=2.27, val_accuracy=0.484, lr=0.1] 70%|███████   | 81/115 [31:32<12:48, 22.61s/epoch, loss=1.12, accuracy=0.758, val_loss=2.25, val_accuracy=0.447, lr=0.1] 71%|███████▏  | 82/115 [31:54<12:20, 22.43s/epoch, loss=0.907, accuracy=0.817, val_loss=0.874, val_accuracy=0.811, lr=0.01] 72%|███████▏  | 83/115 [32:15<11:50, 22.19s/epoch, loss=0.728, accuracy=0.848, val_loss=1.01, val_accuracy=0.752, lr=0.01]  73%|███████▎  | 84/115 [32:39<11:37, 22.51s/epoch, loss=0.65, accuracy=0.856, val_loss=0.855, val_accuracy=0.784, lr=0.01] 74%|███████▍  | 85/115 [33:02<11:20, 22.69s/epoch, loss=0.607, accuracy=0.861, val_loss=0.809, val_accuracy=0.779, lr=0.01] 75%|███████▍  | 86/115 [33:25<11:01, 22.80s/epoch, loss=0.59, accuracy=0.86, val_loss=0.899, val_accuracy=0.767, lr=0.01]   76%|███████▌  | 87/115 [33:48<10:41, 22.89s/epoch, loss=0.576, accuracy=0.863, val_loss=0.788, val_accuracy=0.796, lr=0.01] 77%|███████▋  | 88/115 [34:11<10:17, 22.89s/epoch, loss=0.568, accuracy=0.864, val_loss=0.82, val_accuracy=0.781, lr=0.01]  77%|███████▋  | 89/115 [34:33<09:48, 22.65s/epoch, loss=0.568, accuracy=0.864, val_loss=0.85, val_accuracy=0.786, lr=0.01] 78%|███████▊  | 90/115 [34:56<09:27, 22.69s/epoch, loss=0.564, accuracy=0.866, val_loss=1.06, val_accuracy=0.723, lr=0.01] 79%|███████▉  | 91/115 [35:19<09:08, 22.87s/epoch, loss=0.562, accuracy=0.867, val_loss=0.794, val_accuracy=0.795, lr=0.01] 80%|████████  | 92/115 [35:42<08:48, 22.97s/epoch, loss=0.563, accuracy=0.868, val_loss=0.773, val_accuracy=0.803, lr=0.01] 81%|████████  | 93/115 [36:05<08:22, 22.83s/epoch, loss=0.556, accuracy=0.872, val_loss=1.11, val_accuracy=0.705, lr=0.01]  82%|████████▏ | 94/115 [36:28<08:01, 22.91s/epoch, loss=0.562, accuracy=0.872, val_loss=0.907, val_accuracy=0.761, lr=0.01] 83%|████████▎ | 95/115 [36:51<07:39, 22.95s/epoch, loss=0.558, accuracy=0.874, val_loss=1.33, val_accuracy=0.662, lr=0.01]  83%|████████▎ | 96/115 [37:14<07:16, 22.99s/epoch, loss=0.559, accuracy=0.872, val_loss=0.701, val_accuracy=0.832, lr=0.01] 84%|████████▍ | 97/115 [37:37<06:54, 23.03s/epoch, loss=0.56, accuracy=0.874, val_loss=0.828, val_accuracy=0.79, lr=0.01]   85%|████████▌ | 98/115 [37:59<06:25, 22.66s/epoch, loss=0.557, accuracy=0.875, val_loss=0.819, val_accuracy=0.801, lr=0.01] 86%|████████▌ | 99/115 [38:22<06:03, 22.72s/epoch, loss=0.556, accuracy=0.876, val_loss=1.2, val_accuracy=0.663, lr=0.01]   87%|████████▋ | 100/115 [38:45<05:43, 22.87s/epoch, loss=0.555, accuracy=0.878, val_loss=0.828, val_accuracy=0.794, lr=0.01] 88%|████████▊ | 101/115 [39:08<05:21, 22.98s/epoch, loss=0.558, accuracy=0.878, val_loss=0.844, val_accuracy=0.786, lr=0.00316] 89%|████████▊ | 102/115 [39:31<04:56, 22.81s/epoch, loss=0.555, accuracy=0.878, val_loss=0.844, val_accuracy=0.78, lr=0.01]     90%|████████▉ | 103/115 [39:54<04:35, 22.97s/epoch, loss=0.554, accuracy=0.879, val_loss=0.83, val_accuracy=0.789, lr=0.01] 90%|█████████ | 104/115 [40:17<04:14, 23.10s/epoch, loss=0.554, accuracy=0.879, val_loss=0.793, val_accuracy=0.8, lr=0.01]  91%|█████████▏| 105/115 [40:40<03:49, 22.99s/epoch, loss=0.554, accuracy=0.879, val_loss=0.93, val_accuracy=0.789, lr=0.01] 92%|█████████▏| 106/115 [41:03<03:26, 22.97s/epoch, loss=0.558, accuracy=0.88, val_loss=0.83, val_accuracy=0.807, lr=0.00316] 93%|█████████▎| 107/115 [41:26<03:03, 22.94s/epoch, loss=0.553, accuracy=0.883, val_loss=0.775, val_accuracy=0.808, lr=0.01]  94%|█████████▍| 108/115 [41:49<02:40, 22.90s/epoch, loss=0.557, accuracy=0.882, val_loss=0.747, val_accuracy=0.823, lr=0.01] 95%|█████████▍| 109/115 [42:11<02:16, 22.72s/epoch, loss=0.553, accuracy=0.884, val_loss=1.23, val_accuracy=0.716, lr=0.01]  96%|█████████▌| 110/115 [42:33<01:53, 22.64s/epoch, loss=0.554, accuracy=0.881, val_loss=0.751, val_accuracy=0.816, lr=0.01] 97%|█████████▋| 111/115 [42:57<01:31, 22.78s/epoch, loss=0.555, accuracy=0.881, val_loss=0.804, val_accuracy=0.804, lr=0.00316] 97%|█████████▋| 112/115 [43:18<01:07, 22.48s/epoch, loss=0.552, accuracy=0.883, val_loss=0.761, val_accuracy=0.813, lr=0.01]    98%|█████████▊| 113/115 [43:41<00:45, 22.64s/epoch, loss=0.552, accuracy=0.884, val_loss=0.848, val_accuracy=0.784, lr=0.01] 99%|█████████▉| 114/115 [44:03<00:22, 22.33s/epoch, loss=0.555, accuracy=0.883, val_loss=0.829, val_accuracy=0.798, lr=0.01]100%|██████████| 115/115 [44:26<00:00, 22.59s/epoch, loss=0.559, accuracy=0.883, val_loss=0.908, val_accuracy=0.777, lr=0.01]100%|██████████| 115/115 [44:26<00:00, 23.19s/epoch, loss=0.559, accuracy=0.883, val_loss=0.908, val_accuracy=0.777, lr=0.01]
Using real-time data augmentation.
Test score: 0.9084075093269348
Test accuracy: 0.7767999768257141


* * * Run SGD for ID = 13_8. * * *


2024-03-05 08:57:32.183900: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 08:57:38.426795: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 08:57:38.427827: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-05 08:57:38.466919: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-05 08:57:38.466958: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 08:57:38.473235: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 08:57:38.473281: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-05 08:57:38.477002: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-05 08:57:38.479447: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-05 08:57:38.483137: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-05 08:57:38.486154: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-05 08:57:38.492494: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 08:57:38.493017: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-05 08:57:38.493112: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 08:57:39.788386: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-05 08:57:39.789524: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 08:57:39.789969: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-05 08:57:39.790002: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 08:57:39.790035: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 08:57:39.790084: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-05 08:57:39.790109: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-05 08:57:39.790128: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-05 08:57:39.790145: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-05 08:57:39.790163: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-05 08:57:39.790180: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 08:57:39.790659: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-05 08:57:39.790693: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 08:57:40.483480: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-05 08:57:40.483565: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-05 08:57:40.483576: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-05 08:57:40.484900: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:02:00.0, compute capability: 6.1)
{'id': '13_08', 'seed': 8, 'out_folder': 'results/epoch_budget', 'batch_size': 128, 'epochs': 115, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/115 [00:00<?, ?epoch/s]2024-03-05 08:57:41.361493: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-05 08:57:41.373177: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199825000 Hz
2024-03-05 08:57:43.490211: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 08:57:43.727991: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 08:57:44.457088: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-05 08:57:44.497596: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/115 [00:52<1:39:51, 52.56s/epoch, loss=2.84, accuracy=0.4, val_loss=2.12, val_accuracy=0.374, lr=0.1]  2%|▏         | 2/115 [01:14<1:05:23, 34.72s/epoch, loss=1.46, accuracy=0.597, val_loss=1.56, val_accuracy=0.571, lr=0.1]  3%|▎         | 3/115 [01:38<55:00, 29.47s/epoch, loss=1.29, accuracy=0.67, val_loss=2.12, val_accuracy=0.415, lr=0.1]     3%|▎         | 4/115 [02:01<49:50, 26.94s/epoch, loss=1.25, accuracy=0.698, val_loss=1.74, val_accuracy=0.51, lr=0.1]  4%|▍         | 5/115 [02:22<45:53, 25.03s/epoch, loss=1.22, accuracy=0.714, val_loss=2.02, val_accuracy=0.479, lr=0.1]  5%|▌         | 6/115 [02:46<44:25, 24.45s/epoch, loss=1.2, accuracy=0.723, val_loss=1.75, val_accuracy=0.506, lr=0.1]   6%|▌         | 7/115 [03:07<42:30, 23.61s/epoch, loss=1.19, accuracy=0.729, val_loss=2.47, val_accuracy=0.466, lr=0.0316]  7%|▋         | 8/115 [03:31<42:01, 23.56s/epoch, loss=1.18, accuracy=0.735, val_loss=1.79, val_accuracy=0.515, lr=0.1]     8%|▊         | 9/115 [03:54<41:27, 23.47s/epoch, loss=1.18, accuracy=0.736, val_loss=1.45, val_accuracy=0.641, lr=0.1]  9%|▊         | 10/115 [04:17<40:53, 23.37s/epoch, loss=1.17, accuracy=0.738, val_loss=2.67, val_accuracy=0.365, lr=0.1] 10%|▉         | 11/115 [04:40<40:14, 23.21s/epoch, loss=1.17, accuracy=0.743, val_loss=1.54, val_accuracy=0.627, lr=0.1] 10%|█         | 12/115 [05:04<39:57, 23.27s/epoch, loss=1.16, accuracy=0.742, val_loss=1.87, val_accuracy=0.519, lr=0.1] 11%|█▏        | 13/115 [05:27<39:32, 23.26s/epoch, loss=1.16, accuracy=0.742, val_loss=2.18, val_accuracy=0.506, lr=0.1] 12%|█▏        | 14/115 [05:50<39:09, 23.26s/epoch, loss=1.17, accuracy=0.744, val_loss=2.06, val_accuracy=0.504, lr=0.0316] 13%|█▎        | 15/115 [06:12<38:19, 22.99s/epoch, loss=1.16, accuracy=0.747, val_loss=2.27, val_accuracy=0.475, lr=0.1]    14%|█▍        | 16/115 [06:34<37:19, 22.62s/epoch, loss=1.16, accuracy=0.746, val_loss=1.83, val_accuracy=0.509, lr=0.1] 15%|█▍        | 17/115 [06:57<37:13, 22.80s/epoch, loss=1.17, accuracy=0.745, val_loss=2.58, val_accuracy=0.425, lr=0.1] 16%|█▌        | 18/115 [07:19<36:15, 22.42s/epoch, loss=1.16, accuracy=0.746, val_loss=1.61, val_accuracy=0.591, lr=0.1] 17%|█▋        | 19/115 [07:42<36:03, 22.54s/epoch, loss=1.15, accuracy=0.746, val_loss=1.94, val_accuracy=0.514, lr=0.0316] 17%|█▋        | 20/115 [08:03<35:17, 22.29s/epoch, loss=1.16, accuracy=0.748, val_loss=1.52, val_accuracy=0.626, lr=0.1]    18%|█▊        | 21/115 [08:25<34:40, 22.13s/epoch, loss=1.16, accuracy=0.748, val_loss=2.05, val_accuracy=0.561, lr=0.1] 19%|█▉        | 22/115 [08:48<34:45, 22.43s/epoch, loss=1.14, accuracy=0.752, val_loss=1.64, val_accuracy=0.575, lr=0.1] 20%|██        | 23/115 [09:11<34:37, 22.58s/epoch, loss=1.15, accuracy=0.751, val_loss=2.19, val_accuracy=0.485, lr=0.1] 21%|██        | 24/115 [09:34<34:22, 22.66s/epoch, loss=1.15, accuracy=0.752, val_loss=2.39, val_accuracy=0.421, lr=0.0316] 22%|██▏       | 25/115 [09:56<33:33, 22.37s/epoch, loss=1.14, accuracy=0.751, val_loss=1.99, val_accuracy=0.473, lr=0.1]    23%|██▎       | 26/115 [10:19<33:36, 22.66s/epoch, loss=1.14, accuracy=0.754, val_loss=4.24, val_accuracy=0.256, lr=0.1] 23%|██▎       | 27/115 [10:43<33:33, 22.88s/epoch, loss=1.14, accuracy=0.752, val_loss=2.1, val_accuracy=0.505, lr=0.1]  24%|██▍       | 28/115 [11:06<33:14, 22.93s/epoch, loss=1.13, accuracy=0.753, val_loss=1.95, val_accuracy=0.498, lr=0.1] 25%|██▌       | 29/115 [11:29<32:58, 23.00s/epoch, loss=1.14, accuracy=0.753, val_loss=1.48, val_accuracy=0.641, lr=0.0316] 26%|██▌       | 30/115 [11:52<32:39, 23.05s/epoch, loss=1.13, accuracy=0.753, val_loss=1.65, val_accuracy=0.583, lr=0.1]    27%|██▋       | 31/115 [12:15<32:07, 22.94s/epoch, loss=1.13, accuracy=0.754, val_loss=2.48, val_accuracy=0.399, lr=0.1] 28%|██▊       | 32/115 [12:36<31:14, 22.58s/epoch, loss=1.13, accuracy=0.754, val_loss=1.79, val_accuracy=0.564, lr=0.1] 29%|██▊       | 33/115 [12:58<30:28, 22.30s/epoch, loss=1.14, accuracy=0.754, val_loss=1.98, val_accuracy=0.496, lr=0.1] 30%|██▉       | 34/115 [13:20<29:58, 22.20s/epoch, loss=1.14, accuracy=0.752, val_loss=2.37, val_accuracy=0.434, lr=0.0316] 30%|███       | 35/115 [13:43<30:02, 22.53s/epoch, loss=1.13, accuracy=0.755, val_loss=1.41, val_accuracy=0.654, lr=0.1]    31%|███▏      | 36/115 [14:06<29:56, 22.74s/epoch, loss=1.14, accuracy=0.755, val_loss=2.26, val_accuracy=0.393, lr=0.1] 32%|███▏      | 37/115 [14:29<29:30, 22.69s/epoch, loss=1.14, accuracy=0.755, val_loss=2.84, val_accuracy=0.419, lr=0.1] 33%|███▎      | 38/115 [14:53<29:26, 22.94s/epoch, loss=1.14, accuracy=0.754, val_loss=1.6, val_accuracy=0.577, lr=0.1]  34%|███▍      | 39/115 [15:16<29:06, 22.98s/epoch, loss=1.12, accuracy=0.758, val_loss=1.59, val_accuracy=0.595, lr=0.1] 35%|███▍      | 40/115 [15:39<28:42, 22.96s/epoch, loss=1.12, accuracy=0.757, val_loss=1.98, val_accuracy=0.48, lr=0.0316] 36%|███▌      | 41/115 [16:02<28:25, 23.05s/epoch, loss=1.13, accuracy=0.754, val_loss=1.73, val_accuracy=0.567, lr=0.1]   37%|███▋      | 42/115 [16:23<27:30, 22.61s/epoch, loss=1.12, accuracy=0.756, val_loss=1.95, val_accuracy=0.499, lr=0.1] 37%|███▋      | 43/115 [16:47<27:20, 22.79s/epoch, loss=1.13, accuracy=0.758, val_loss=1.84, val_accuracy=0.511, lr=0.1] 38%|███▊      | 44/115 [17:08<26:32, 22.43s/epoch, loss=1.13, accuracy=0.756, val_loss=2.83, val_accuracy=0.365, lr=0.1] 39%|███▉      | 45/115 [17:31<26:14, 22.49s/epoch, loss=1.13, accuracy=0.757, val_loss=1.58, val_accuracy=0.589, lr=0.0316] 40%|████      | 46/115 [17:54<26:04, 22.67s/epoch, loss=1.13, accuracy=0.761, val_loss=2.93, val_accuracy=0.208, lr=0.1]    41%|████      | 47/115 [18:17<25:48, 22.78s/epoch, loss=1.13, accuracy=0.76, val_loss=1.77, val_accuracy=0.539, lr=0.1]  42%|████▏     | 48/115 [18:40<25:37, 22.94s/epoch, loss=1.12, accuracy=0.759, val_loss=2.27, val_accuracy=0.42, lr=0.1] 43%|████▎     | 49/115 [19:02<24:50, 22.58s/epoch, loss=1.13, accuracy=0.758, val_loss=1.68, val_accuracy=0.543, lr=0.1] 43%|████▎     | 50/115 [19:25<24:38, 22.74s/epoch, loss=1.12, accuracy=0.757, val_loss=2.56, val_accuracy=0.406, lr=0.0316] 44%|████▍     | 51/115 [19:48<24:09, 22.64s/epoch, loss=1.13, accuracy=0.755, val_loss=4.98, val_accuracy=0.232, lr=0.1]    45%|████▌     | 52/115 [20:11<23:52, 22.74s/epoch, loss=1.12, accuracy=0.758, val_loss=2.08, val_accuracy=0.474, lr=0.1] 46%|████▌     | 53/115 [20:34<23:38, 22.88s/epoch, loss=1.13, accuracy=0.755, val_loss=2.15, val_accuracy=0.546, lr=0.1] 47%|████▋     | 54/115 [20:57<23:15, 22.88s/epoch, loss=1.12, accuracy=0.757, val_loss=1.99, val_accuracy=0.493, lr=0.1] 48%|████▊     | 55/115 [21:19<22:49, 22.83s/epoch, loss=1.12, accuracy=0.758, val_loss=2.99, val_accuracy=0.214, lr=0.0316] 49%|████▊     | 56/115 [21:42<22:32, 22.93s/epoch, loss=1.12, accuracy=0.757, val_loss=1.74, val_accuracy=0.582, lr=0.1]    50%|████▉     | 57/115 [22:04<21:46, 22.53s/epoch, loss=1.12, accuracy=0.756, val_loss=1.92, val_accuracy=0.498, lr=0.1] 50%|█████     | 58/115 [22:26<21:20, 22.47s/epoch, loss=1.12, accuracy=0.758, val_loss=1.81, val_accuracy=0.584, lr=0.1] 51%|█████▏    | 59/115 [22:50<21:09, 22.67s/epoch, loss=1.13, accuracy=0.757, val_loss=2.59, val_accuracy=0.444, lr=0.1] 52%|█████▏    | 60/115 [23:12<20:48, 22.71s/epoch, loss=1.12, accuracy=0.759, val_loss=1.75, val_accuracy=0.545, lr=0.0316] 53%|█████▎    | 61/115 [23:36<20:34, 22.86s/epoch, loss=1.12, accuracy=0.757, val_loss=1.8, val_accuracy=0.531, lr=0.1]     54%|█████▍    | 62/115 [23:58<20:07, 22.78s/epoch, loss=1.12, accuracy=0.756, val_loss=1.7, val_accuracy=0.551, lr=0.1] 55%|█████▍    | 63/115 [24:21<19:47, 22.84s/epoch, loss=1.12, accuracy=0.757, val_loss=2.41, val_accuracy=0.466, lr=0.1] 56%|█████▌    | 64/115 [24:44<19:18, 22.72s/epoch, loss=1.11, accuracy=0.76, val_loss=4.61, val_accuracy=0.253, lr=0.1]  57%|█████▋    | 65/115 [25:06<18:52, 22.65s/epoch, loss=1.12, accuracy=0.757, val_loss=1.89, val_accuracy=0.551, lr=0.0316] 57%|█████▋    | 66/115 [25:29<18:32, 22.71s/epoch, loss=1.12, accuracy=0.76, val_loss=2.06, val_accuracy=0.456, lr=0.1]     58%|█████▊    | 67/115 [25:52<18:13, 22.78s/epoch, loss=1.12, accuracy=0.759, val_loss=2.07, val_accuracy=0.528, lr=0.1] 59%|█████▉    | 68/115 [26:15<17:55, 22.88s/epoch, loss=1.12, accuracy=0.76, val_loss=2.26, val_accuracy=0.49, lr=0.1]   60%|██████    | 69/115 [26:37<17:18, 22.57s/epoch, loss=1.11, accuracy=0.761, val_loss=2.21, val_accuracy=0.426, lr=0.1] 61%|██████    | 70/115 [26:59<16:55, 22.57s/epoch, loss=1.12, accuracy=0.758, val_loss=2.99, val_accuracy=0.343, lr=0.0316] 62%|██████▏   | 71/115 [27:22<16:27, 22.44s/epoch, loss=1.12, accuracy=0.756, val_loss=2.42, val_accuracy=0.507, lr=0.1]    63%|██████▎   | 72/115 [27:43<15:50, 22.11s/epoch, loss=1.12, accuracy=0.759, val_loss=2.05, val_accuracy=0.53, lr=0.1]  63%|██████▎   | 73/115 [28:05<15:34, 22.25s/epoch, loss=1.12, accuracy=0.757, val_loss=2.65, val_accuracy=0.372, lr=0.1] 64%|██████▍   | 74/115 [28:28<15:16, 22.35s/epoch, loss=1.12, accuracy=0.76, val_loss=2.15, val_accuracy=0.484, lr=0.1]  65%|██████▌   | 75/115 [28:51<15:04, 22.61s/epoch, loss=1.12, accuracy=0.758, val_loss=2.09, val_accuracy=0.478, lr=0.0316] 66%|██████▌   | 76/115 [29:14<14:48, 22.79s/epoch, loss=1.12, accuracy=0.757, val_loss=3.52, val_accuracy=0.306, lr=0.1]    67%|██████▋   | 77/115 [29:37<14:18, 22.60s/epoch, loss=1.12, accuracy=0.757, val_loss=1.84, val_accuracy=0.561, lr=0.1] 68%|██████▊   | 78/115 [29:59<13:52, 22.51s/epoch, loss=1.12, accuracy=0.758, val_loss=1.66, val_accuracy=0.582, lr=0.1] 69%|██████▊   | 79/115 [30:22<13:31, 22.55s/epoch, loss=1.12, accuracy=0.757, val_loss=3.61, val_accuracy=0.357, lr=0.1] 70%|██████▉   | 80/115 [30:44<13:12, 22.65s/epoch, loss=1.12, accuracy=0.76, val_loss=2.5, val_accuracy=0.457, lr=0.0316] 70%|███████   | 81/115 [31:07<12:50, 22.67s/epoch, loss=1.12, accuracy=0.759, val_loss=1.56, val_accuracy=0.597, lr=0.1]  71%|███████▏  | 82/115 [31:30<12:30, 22.75s/epoch, loss=0.908, accuracy=0.818, val_loss=0.877, val_accuracy=0.814, lr=0.01] 72%|███████▏  | 83/115 [31:53<12:11, 22.85s/epoch, loss=0.728, accuracy=0.85, val_loss=0.833, val_accuracy=0.796, lr=0.01]  73%|███████▎  | 84/115 [32:16<11:49, 22.89s/epoch, loss=0.649, accuracy=0.857, val_loss=0.915, val_accuracy=0.763, lr=0.01] 74%|███████▍  | 85/115 [32:39<11:25, 22.84s/epoch, loss=0.602, accuracy=0.86, val_loss=0.914, val_accuracy=0.756, lr=0.01]  75%|███████▍  | 86/115 [33:00<10:48, 22.38s/epoch, loss=0.582, accuracy=0.862, val_loss=0.781, val_accuracy=0.799, lr=0.01] 76%|███████▌  | 87/115 [33:23<10:30, 22.52s/epoch, loss=0.572, accuracy=0.863, val_loss=0.997, val_accuracy=0.731, lr=0.01] 77%|███████▋  | 88/115 [33:45<10:06, 22.45s/epoch, loss=0.563, accuracy=0.864, val_loss=0.861, val_accuracy=0.775, lr=0.01] 77%|███████▋  | 89/115 [34:08<09:47, 22.61s/epoch, loss=0.559, accuracy=0.867, val_loss=0.742, val_accuracy=0.804, lr=0.01] 78%|███████▊  | 90/115 [34:31<09:27, 22.70s/epoch, loss=0.559, accuracy=0.866, val_loss=1.28, val_accuracy=0.675, lr=0.01]  79%|███████▉  | 91/115 [34:54<09:06, 22.76s/epoch, loss=0.558, accuracy=0.867, val_loss=0.797, val_accuracy=0.79, lr=0.01] 80%|████████  | 92/115 [35:17<08:41, 22.69s/epoch, loss=0.555, accuracy=0.87, val_loss=1.03, val_accuracy=0.739, lr=0.01]  81%|████████  | 93/115 [35:39<08:20, 22.73s/epoch, loss=0.558, accuracy=0.87, val_loss=1.24, val_accuracy=0.692, lr=0.01] 82%|████████▏ | 94/115 [36:01<07:50, 22.41s/epoch, loss=0.553, accuracy=0.872, val_loss=0.767, val_accuracy=0.802, lr=0.00316] 83%|████████▎ | 95/115 [36:24<07:33, 22.67s/epoch, loss=0.55, accuracy=0.874, val_loss=0.779, val_accuracy=0.805, lr=0.01]     83%|████████▎ | 96/115 [36:47<07:08, 22.53s/epoch, loss=0.553, accuracy=0.873, val_loss=0.802, val_accuracy=0.79, lr=0.01] 84%|████████▍ | 97/115 [37:09<06:45, 22.55s/epoch, loss=0.551, accuracy=0.874, val_loss=0.811, val_accuracy=0.798, lr=0.01] 85%|████████▌ | 98/115 [37:32<06:24, 22.60s/epoch, loss=0.555, accuracy=0.875, val_loss=0.845, val_accuracy=0.786, lr=0.01] 86%|████████▌ | 99/115 [37:55<06:03, 22.71s/epoch, loss=0.555, accuracy=0.875, val_loss=0.914, val_accuracy=0.765, lr=0.00316] 87%|████████▋ | 100/115 [38:17<05:38, 22.54s/epoch, loss=0.556, accuracy=0.875, val_loss=0.825, val_accuracy=0.797, lr=0.01]   88%|████████▊ | 101/115 [38:38<05:10, 22.21s/epoch, loss=0.55, accuracy=0.879, val_loss=0.805, val_accuracy=0.797, lr=0.01]  89%|████████▊ | 102/115 [39:00<04:47, 22.13s/epoch, loss=0.551, accuracy=0.878, val_loss=0.86, val_accuracy=0.783, lr=0.01] 90%|████████▉ | 103/115 [39:23<04:27, 22.33s/epoch, loss=0.548, accuracy=0.879, val_loss=0.995, val_accuracy=0.757, lr=0.01] 90%|█████████ | 104/115 [39:46<04:07, 22.53s/epoch, loss=0.551, accuracy=0.878, val_loss=0.723, val_accuracy=0.826, lr=0.01] 91%|█████████▏| 105/115 [40:09<03:47, 22.70s/epoch, loss=0.549, accuracy=0.878, val_loss=1.19, val_accuracy=0.688, lr=0.01]  92%|█████████▏| 106/115 [40:32<03:24, 22.77s/epoch, loss=0.549, accuracy=0.878, val_loss=0.854, val_accuracy=0.777, lr=0.01] 93%|█████████▎| 107/115 [40:55<03:02, 22.76s/epoch, loss=0.55, accuracy=0.879, val_loss=0.831, val_accuracy=0.793, lr=0.01]  94%|█████████▍| 108/115 [41:16<02:36, 22.33s/epoch, loss=0.55, accuracy=0.88, val_loss=0.946, val_accuracy=0.782, lr=0.01]  95%|█████████▍| 109/115 [41:39<02:15, 22.55s/epoch, loss=0.549, accuracy=0.881, val_loss=0.81, val_accuracy=0.797, lr=0.00316] 96%|█████████▌| 110/115 [42:02<01:53, 22.70s/epoch, loss=0.554, accuracy=0.879, val_loss=1.19, val_accuracy=0.718, lr=0.01]    97%|█████████▋| 111/115 [42:24<01:29, 22.44s/epoch, loss=0.554, accuracy=0.881, val_loss=0.806, val_accuracy=0.793, lr=0.01] 97%|█████████▋| 112/115 [42:46<01:06, 22.21s/epoch, loss=0.552, accuracy=0.88, val_loss=0.853, val_accuracy=0.795, lr=0.01]  98%|█████████▊| 113/115 [43:08<00:44, 22.17s/epoch, loss=0.55, accuracy=0.881, val_loss=0.994, val_accuracy=0.757, lr=0.01] 99%|█████████▉| 114/115 [43:30<00:22, 22.09s/epoch, loss=0.546, accuracy=0.881, val_loss=0.98, val_accuracy=0.774, lr=0.00316]100%|██████████| 115/115 [43:53<00:00, 22.36s/epoch, loss=0.549, accuracy=0.883, val_loss=1.16, val_accuracy=0.731, lr=0.01]   100%|██████████| 115/115 [43:53<00:00, 22.90s/epoch, loss=0.549, accuracy=0.883, val_loss=1.16, val_accuracy=0.731, lr=0.01]
Using real-time data augmentation.
Test score: 1.1554404497146606
Test accuracy: 0.7310000061988831


* * * Run SGD for ID = 13_9. * * *


2024-03-05 09:41:38.650555: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 09:41:41.608002: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 09:41:41.608940: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-05 09:41:41.647906: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-05 09:41:41.647937: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 09:41:41.650864: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 09:41:41.650912: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-05 09:41:41.653038: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-05 09:41:41.653815: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-05 09:41:41.656122: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-05 09:41:41.657696: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-05 09:41:41.662338: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 09:41:41.662842: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-05 09:41:41.662919: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 09:41:43.006422: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-05 09:41:43.007598: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 09:41:43.008420: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-05 09:41:43.008451: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 09:41:43.008487: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 09:41:43.008505: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-05 09:41:43.008521: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-05 09:41:43.008546: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-05 09:41:43.008562: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-05 09:41:43.008579: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-05 09:41:43.008595: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 09:41:43.009029: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-05 09:41:43.009089: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 09:41:43.636636: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-05 09:41:43.636697: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-05 09:41:43.636708: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-05 09:41:43.637673: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:02:00.0, compute capability: 6.1)
{'id': '13_09', 'seed': 9, 'out_folder': 'results/epoch_budget', 'batch_size': 128, 'epochs': 115, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/115 [00:00<?, ?epoch/s]2024-03-05 09:41:44.469101: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-05 09:41:44.481170: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199825000 Hz
2024-03-05 09:41:46.452843: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 09:41:46.637555: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 09:41:47.628332: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-05 09:41:47.678789: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/115 [00:58<1:51:17, 58.57s/epoch, loss=2.72, accuracy=0.454, val_loss=2.06, val_accuracy=0.446, lr=0.1]  2%|▏         | 2/115 [01:21<1:11:01, 37.72s/epoch, loss=1.41, accuracy=0.628, val_loss=1.69, val_accuracy=0.542, lr=0.1]  3%|▎         | 3/115 [01:45<58:23, 31.28s/epoch, loss=1.28, accuracy=0.683, val_loss=2.36, val_accuracy=0.464, lr=0.1]    3%|▎         | 4/115 [02:08<52:02, 28.13s/epoch, loss=1.25, accuracy=0.701, val_loss=1.82, val_accuracy=0.541, lr=0.1]  4%|▍         | 5/115 [02:32<48:29, 26.45s/epoch, loss=1.23, accuracy=0.713, val_loss=1.54, val_accuracy=0.619, lr=0.1]  5%|▌         | 6/115 [02:55<46:01, 25.34s/epoch, loss=1.22, accuracy=0.724, val_loss=1.62, val_accuracy=0.551, lr=0.1]  6%|▌         | 7/115 [03:18<44:28, 24.71s/epoch, loss=1.21, accuracy=0.726, val_loss=1.82, val_accuracy=0.495, lr=0.1]  7%|▋         | 8/115 [03:42<43:17, 24.27s/epoch, loss=1.2, accuracy=0.732, val_loss=3.8, val_accuracy=0.175, lr=0.1]    8%|▊         | 9/115 [04:04<41:45, 23.64s/epoch, loss=1.2, accuracy=0.731, val_loss=1.54, val_accuracy=0.619, lr=0.1]  9%|▊         | 10/115 [04:27<41:12, 23.55s/epoch, loss=1.19, accuracy=0.735, val_loss=1.48, val_accuracy=0.631, lr=0.1] 10%|▉         | 11/115 [04:50<40:19, 23.27s/epoch, loss=1.19, accuracy=0.738, val_loss=5.66, val_accuracy=0.279, lr=0.1] 10%|█         | 12/115 [05:12<39:20, 22.92s/epoch, loss=1.19, accuracy=0.738, val_loss=2.11, val_accuracy=0.443, lr=0.1] 11%|█▏        | 13/115 [05:35<39:17, 23.11s/epoch, loss=1.19, accuracy=0.739, val_loss=1.95, val_accuracy=0.485, lr=0.1] 12%|█▏        | 14/115 [05:59<39:07, 23.24s/epoch, loss=1.18, accuracy=0.74, val_loss=2.35, val_accuracy=0.473, lr=0.1]  13%|█▎        | 15/115 [06:22<38:42, 23.22s/epoch, loss=1.17, accuracy=0.743, val_loss=2.22, val_accuracy=0.456, lr=0.0316] 14%|█▍        | 16/115 [06:45<38:19, 23.23s/epoch, loss=1.17, accuracy=0.745, val_loss=2.9, val_accuracy=0.34, lr=0.1]      15%|█▍        | 17/115 [07:09<37:59, 23.26s/epoch, loss=1.17, accuracy=0.745, val_loss=2.48, val_accuracy=0.444, lr=0.1] 16%|█▌        | 18/115 [07:31<37:21, 23.11s/epoch, loss=1.16, accuracy=0.746, val_loss=2.2, val_accuracy=0.418, lr=0.1]  17%|█▋        | 19/115 [07:55<36:59, 23.12s/epoch, loss=1.17, accuracy=0.742, val_loss=1.49, val_accuracy=0.633, lr=0.1] 17%|█▋        | 20/115 [08:17<36:06, 22.81s/epoch, loss=1.16, accuracy=0.748, val_loss=1.72, val_accuracy=0.545, lr=0.0316] 18%|█▊        | 21/115 [08:39<35:16, 22.52s/epoch, loss=1.16, accuracy=0.746, val_loss=2.04, val_accuracy=0.493, lr=0.1]    19%|█▉        | 22/115 [09:02<35:18, 22.78s/epoch, loss=1.16, accuracy=0.748, val_loss=1.92, val_accuracy=0.524, lr=0.1] 20%|██        | 23/115 [09:25<34:52, 22.74s/epoch, loss=1.16, accuracy=0.75, val_loss=2.02, val_accuracy=0.444, lr=0.1]  21%|██        | 24/115 [09:46<34:03, 22.45s/epoch, loss=1.15, accuracy=0.75, val_loss=2.21, val_accuracy=0.428, lr=0.1] 22%|██▏       | 25/115 [10:10<34:04, 22.72s/epoch, loss=1.16, accuracy=0.749, val_loss=1.82, val_accuracy=0.534, lr=0.0316] 23%|██▎       | 26/115 [10:33<33:56, 22.88s/epoch, loss=1.15, accuracy=0.751, val_loss=1.57, val_accuracy=0.603, lr=0.1]    23%|██▎       | 27/115 [10:56<33:47, 23.03s/epoch, loss=1.15, accuracy=0.753, val_loss=3.74, val_accuracy=0.358, lr=0.1] 24%|██▍       | 28/115 [11:19<33:01, 22.78s/epoch, loss=1.15, accuracy=0.753, val_loss=2.23, val_accuracy=0.452, lr=0.1] 25%|██▌       | 29/115 [11:41<32:31, 22.69s/epoch, loss=1.14, accuracy=0.755, val_loss=2.39, val_accuracy=0.372, lr=0.1] 26%|██▌       | 30/115 [12:04<32:18, 22.80s/epoch, loss=1.14, accuracy=0.755, val_loss=2.08, val_accuracy=0.397, lr=0.0316] 27%|██▋       | 31/115 [12:26<31:44, 22.67s/epoch, loss=1.14, accuracy=0.753, val_loss=1.7, val_accuracy=0.573, lr=0.1]     28%|██▊       | 32/115 [12:50<31:36, 22.84s/epoch, loss=1.13, accuracy=0.755, val_loss=1.58, val_accuracy=0.603, lr=0.1] 29%|██▊       | 33/115 [13:12<30:49, 22.55s/epoch, loss=1.14, accuracy=0.755, val_loss=1.94, val_accuracy=0.505, lr=0.1] 30%|██▉       | 34/115 [13:35<30:46, 22.79s/epoch, loss=1.14, accuracy=0.757, val_loss=2.11, val_accuracy=0.488, lr=0.1] 30%|███       | 35/115 [13:58<30:40, 23.01s/epoch, loss=1.14, accuracy=0.753, val_loss=2.76, val_accuracy=0.416, lr=0.0316] 31%|███▏      | 36/115 [14:22<30:22, 23.07s/epoch, loss=1.14, accuracy=0.753, val_loss=2.12, val_accuracy=0.479, lr=0.1]    32%|███▏      | 37/115 [14:45<29:57, 23.05s/epoch, loss=1.13, accuracy=0.754, val_loss=1.71, val_accuracy=0.58, lr=0.1]  33%|███▎      | 38/115 [15:06<29:04, 22.66s/epoch, loss=1.13, accuracy=0.756, val_loss=2.77, val_accuracy=0.397, lr=0.1] 34%|███▍      | 39/115 [15:29<28:51, 22.78s/epoch, loss=1.13, accuracy=0.755, val_loss=1.88, val_accuracy=0.486, lr=0.1] 35%|███▍      | 40/115 [15:53<28:43, 22.98s/epoch, loss=1.13, accuracy=0.756, val_loss=2.1, val_accuracy=0.52, lr=0.0316] 36%|███▌      | 41/115 [16:16<28:23, 23.01s/epoch, loss=1.13, accuracy=0.757, val_loss=2.21, val_accuracy=0.478, lr=0.1]  37%|███▋      | 42/115 [16:39<28:00, 23.01s/epoch, loss=1.13, accuracy=0.757, val_loss=1.29, val_accuracy=0.698, lr=0.1] 37%|███▋      | 43/115 [17:02<27:43, 23.10s/epoch, loss=1.13, accuracy=0.76, val_loss=1.5, val_accuracy=0.614, lr=0.1]   38%|███▊      | 44/115 [17:25<27:19, 23.09s/epoch, loss=1.13, accuracy=0.756, val_loss=2.03, val_accuracy=0.511, lr=0.1] 39%|███▉      | 45/115 [17:49<27:02, 23.18s/epoch, loss=1.13, accuracy=0.757, val_loss=2.57, val_accuracy=0.272, lr=0.1] 40%|████      | 46/115 [18:12<26:46, 23.28s/epoch, loss=1.12, accuracy=0.76, val_loss=2.11, val_accuracy=0.449, lr=0.1]  41%|████      | 47/115 [18:36<26:23, 23.29s/epoch, loss=1.13, accuracy=0.758, val_loss=2.29, val_accuracy=0.383, lr=0.0316] 42%|████▏     | 48/115 [18:59<26:09, 23.42s/epoch, loss=1.12, accuracy=0.759, val_loss=2.15, val_accuracy=0.48, lr=0.1]     43%|████▎     | 49/115 [19:23<25:48, 23.46s/epoch, loss=1.12, accuracy=0.757, val_loss=2.79, val_accuracy=0.418, lr=0.1] 43%|████▎     | 50/115 [19:47<25:29, 23.53s/epoch, loss=1.11, accuracy=0.757, val_loss=1.63, val_accuracy=0.554, lr=0.1] 44%|████▍     | 51/115 [20:09<24:46, 23.23s/epoch, loss=1.12, accuracy=0.759, val_loss=1.96, val_accuracy=0.535, lr=0.1] 45%|████▌     | 52/115 [20:31<23:58, 22.83s/epoch, loss=1.12, accuracy=0.757, val_loss=2.02, val_accuracy=0.551, lr=0.0316] 46%|████▌     | 53/115 [20:53<23:20, 22.59s/epoch, loss=1.12, accuracy=0.758, val_loss=2.23, val_accuracy=0.415, lr=0.1]    47%|████▋     | 54/115 [21:16<23:03, 22.67s/epoch, loss=1.12, accuracy=0.758, val_loss=1.82, val_accuracy=0.525, lr=0.1] 48%|████▊     | 55/115 [21:38<22:27, 22.46s/epoch, loss=1.12, accuracy=0.761, val_loss=10.1, val_accuracy=0.123, lr=0.1] 49%|████▊     | 56/115 [22:00<21:56, 22.31s/epoch, loss=1.11, accuracy=0.761, val_loss=2.06, val_accuracy=0.484, lr=0.1] 50%|████▉     | 57/115 [22:23<21:56, 22.70s/epoch, loss=1.12, accuracy=0.76, val_loss=2.52, val_accuracy=0.331, lr=0.0316] 50%|█████     | 58/115 [22:47<21:49, 22.98s/epoch, loss=1.12, accuracy=0.758, val_loss=3.53, val_accuracy=0.344, lr=0.1]   51%|█████▏    | 59/115 [23:10<21:21, 22.88s/epoch, loss=1.12, accuracy=0.758, val_loss=2.13, val_accuracy=0.487, lr=0.1] 52%|█████▏    | 60/115 [23:33<21:05, 23.00s/epoch, loss=1.11, accuracy=0.755, val_loss=1.57, val_accuracy=0.577, lr=0.1] 53%|█████▎    | 61/115 [23:56<20:45, 23.06s/epoch, loss=1.12, accuracy=0.757, val_loss=2.04, val_accuracy=0.516, lr=0.1] 54%|█████▍    | 62/115 [24:20<20:27, 23.16s/epoch, loss=1.12, accuracy=0.76, val_loss=2.72, val_accuracy=0.375, lr=0.0316] 55%|█████▍    | 63/115 [24:43<20:09, 23.26s/epoch, loss=1.11, accuracy=0.757, val_loss=3.11, val_accuracy=0.38, lr=0.1]    56%|█████▌    | 64/115 [25:06<19:45, 23.24s/epoch, loss=1.11, accuracy=0.757, val_loss=2.86, val_accuracy=0.254, lr=0.1] 57%|█████▋    | 65/115 [25:30<19:22, 23.25s/epoch, loss=1.12, accuracy=0.757, val_loss=2.85, val_accuracy=0.288, lr=0.1] 57%|█████▋    | 66/115 [25:53<19:01, 23.29s/epoch, loss=1.11, accuracy=0.759, val_loss=2.6, val_accuracy=0.392, lr=0.1]  58%|█████▊    | 67/115 [26:16<18:38, 23.31s/epoch, loss=1.11, accuracy=0.759, val_loss=2.16, val_accuracy=0.428, lr=0.0316] 59%|█████▉    | 68/115 [26:40<18:14, 23.28s/epoch, loss=1.11, accuracy=0.758, val_loss=1.49, val_accuracy=0.615, lr=0.1]    60%|██████    | 69/115 [27:03<17:51, 23.30s/epoch, loss=1.11, accuracy=0.76, val_loss=1.69, val_accuracy=0.587, lr=0.1]  61%|██████    | 70/115 [27:26<17:31, 23.36s/epoch, loss=1.11, accuracy=0.759, val_loss=1.72, val_accuracy=0.56, lr=0.1] 62%|██████▏   | 71/115 [27:50<17:07, 23.34s/epoch, loss=1.11, accuracy=0.759, val_loss=2.22, val_accuracy=0.463, lr=0.1] 63%|██████▎   | 72/115 [28:12<16:31, 23.05s/epoch, loss=1.11, accuracy=0.758, val_loss=1.93, val_accuracy=0.499, lr=0.0316] 63%|██████▎   | 73/115 [28:35<16:12, 23.15s/epoch, loss=1.11, accuracy=0.76, val_loss=2.3, val_accuracy=0.48, lr=0.1]       64%|██████▍   | 74/115 [28:58<15:46, 23.09s/epoch, loss=1.12, accuracy=0.757, val_loss=2, val_accuracy=0.489, lr=0.1] 65%|██████▌   | 75/115 [29:22<15:28, 23.22s/epoch, loss=1.11, accuracy=0.759, val_loss=2.14, val_accuracy=0.413, lr=0.1] 66%|██████▌   | 76/115 [29:45<15:06, 23.25s/epoch, loss=1.11, accuracy=0.759, val_loss=2.72, val_accuracy=0.311, lr=0.1] 67%|██████▋   | 77/115 [30:09<14:44, 23.29s/epoch, loss=1.11, accuracy=0.759, val_loss=2.47, val_accuracy=0.474, lr=0.0316] 68%|██████▊   | 78/115 [30:32<14:19, 23.22s/epoch, loss=1.11, accuracy=0.76, val_loss=1.9, val_accuracy=0.53, lr=0.1]       69%|██████▊   | 79/115 [30:55<13:59, 23.32s/epoch, loss=1.11, accuracy=0.757, val_loss=1.67, val_accuracy=0.585, lr=0.1] 70%|██████▉   | 80/115 [31:19<13:40, 23.44s/epoch, loss=1.11, accuracy=0.758, val_loss=2.09, val_accuracy=0.456, lr=0.1] 70%|███████   | 81/115 [31:41<13:01, 22.98s/epoch, loss=1.11, accuracy=0.76, val_loss=2.12, val_accuracy=0.436, lr=0.1]  71%|███████▏  | 82/115 [32:04<12:42, 23.11s/epoch, loss=0.893, accuracy=0.819, val_loss=0.942, val_accuracy=0.776, lr=0.01] 72%|███████▏  | 83/115 [32:26<12:07, 22.73s/epoch, loss=0.717, accuracy=0.852, val_loss=0.802, val_accuracy=0.809, lr=0.01] 73%|███████▎  | 84/115 [32:49<11:49, 22.90s/epoch, loss=0.635, accuracy=0.859, val_loss=0.741, val_accuracy=0.815, lr=0.01] 74%|███████▍  | 85/115 [33:12<11:23, 22.79s/epoch, loss=0.595, accuracy=0.861, val_loss=0.817, val_accuracy=0.789, lr=0.01] 75%|███████▍  | 86/115 [33:35<11:07, 23.02s/epoch, loss=0.576, accuracy=0.863, val_loss=0.726, val_accuracy=0.808, lr=0.01] 76%|███████▌  | 87/115 [33:57<10:34, 22.67s/epoch, loss=0.566, accuracy=0.864, val_loss=0.764, val_accuracy=0.801, lr=0.01] 77%|███████▋  | 88/115 [34:21<10:18, 22.90s/epoch, loss=0.561, accuracy=0.865, val_loss=0.962, val_accuracy=0.745, lr=0.01] 77%|███████▋  | 89/115 [34:43<09:54, 22.85s/epoch, loss=0.558, accuracy=0.865, val_loss=0.889, val_accuracy=0.756, lr=0.01] 78%|███████▊  | 90/115 [35:06<09:30, 22.82s/epoch, loss=0.553, accuracy=0.868, val_loss=1.08, val_accuracy=0.692, lr=0.01]  79%|███████▉  | 91/115 [35:30<09:12, 23.02s/epoch, loss=0.556, accuracy=0.869, val_loss=0.783, val_accuracy=0.795, lr=0.00316] 80%|████████  | 92/115 [35:51<08:40, 22.61s/epoch, loss=0.554, accuracy=0.87, val_loss=0.7, val_accuracy=0.82, lr=0.01]        81%|████████  | 93/115 [36:14<08:18, 22.66s/epoch, loss=0.546, accuracy=0.875, val_loss=0.88, val_accuracy=0.775, lr=0.01] 82%|████████▏ | 94/115 [36:37<07:58, 22.77s/epoch, loss=0.548, accuracy=0.874, val_loss=0.774, val_accuracy=0.797, lr=0.01] 83%|████████▎ | 95/115 [37:00<07:36, 22.84s/epoch, loss=0.545, accuracy=0.877, val_loss=1.75, val_accuracy=0.609, lr=0.01]  83%|████████▎ | 96/115 [37:23<07:14, 22.88s/epoch, loss=0.549, accuracy=0.876, val_loss=0.731, val_accuracy=0.817, lr=0.01] 84%|████████▍ | 97/115 [37:45<06:44, 22.50s/epoch, loss=0.552, accuracy=0.875, val_loss=0.814, val_accuracy=0.797, lr=0.00316] 85%|████████▌ | 98/115 [38:06<06:18, 22.25s/epoch, loss=0.547, accuracy=0.878, val_loss=0.863, val_accuracy=0.783, lr=0.01]    86%|████████▌ | 99/115 [38:29<05:59, 22.46s/epoch, loss=0.545, accuracy=0.878, val_loss=0.864, val_accuracy=0.785, lr=0.01] 87%|████████▋ | 100/115 [38:52<05:36, 22.46s/epoch, loss=0.549, accuracy=0.878, val_loss=1.06, val_accuracy=0.737, lr=0.01] 88%|████████▊ | 101/115 [39:15<05:16, 22.58s/epoch, loss=0.543, accuracy=0.88, val_loss=1.01, val_accuracy=0.755, lr=0.01]  89%|████████▊ | 102/115 [39:37<04:53, 22.54s/epoch, loss=0.545, accuracy=0.88, val_loss=0.882, val_accuracy=0.785, lr=0.00316] 90%|████████▉ | 103/115 [40:00<04:32, 22.70s/epoch, loss=0.552, accuracy=0.879, val_loss=0.895, val_accuracy=0.798, lr=0.01]   90%|█████████ | 104/115 [40:24<04:13, 23.04s/epoch, loss=0.544, accuracy=0.883, val_loss=0.902, val_accuracy=0.758, lr=0.01] 91%|█████████▏| 105/115 [40:48<03:52, 23.26s/epoch, loss=0.543, accuracy=0.884, val_loss=1.05, val_accuracy=0.725, lr=0.01]  92%|█████████▏| 106/115 [41:12<03:30, 23.40s/epoch, loss=0.543, accuracy=0.883, val_loss=1.49, val_accuracy=0.642, lr=0.01] 93%|█████████▎| 107/115 [41:35<03:07, 23.48s/epoch, loss=0.545, accuracy=0.882, val_loss=1.05, val_accuracy=0.752, lr=0.00316] 94%|█████████▍| 108/115 [41:58<02:43, 23.39s/epoch, loss=0.547, accuracy=0.882, val_loss=0.883, val_accuracy=0.794, lr=0.01]   95%|█████████▍| 109/115 [42:20<02:17, 22.95s/epoch, loss=0.545, accuracy=0.884, val_loss=0.852, val_accuracy=0.787, lr=0.01] 96%|█████████▌| 110/115 [42:44<01:55, 23.02s/epoch, loss=0.547, accuracy=0.883, val_loss=1.49, val_accuracy=0.667, lr=0.01]  97%|█████████▋| 111/115 [43:05<01:30, 22.57s/epoch, loss=0.544, accuracy=0.884, val_loss=1.12, val_accuracy=0.722, lr=0.01] 97%|█████████▋| 112/115 [43:27<01:06, 22.29s/epoch, loss=0.545, accuracy=0.884, val_loss=1, val_accuracy=0.755, lr=0.00316] 98%|█████████▊| 113/115 [43:48<00:44, 22.13s/epoch, loss=0.543, accuracy=0.886, val_loss=0.744, val_accuracy=0.822, lr=0.01] 99%|█████████▉| 114/115 [44:11<00:22, 22.33s/epoch, loss=0.542, accuracy=0.886, val_loss=1.34, val_accuracy=0.68, lr=0.01]  100%|██████████| 115/115 [44:34<00:00, 22.48s/epoch, loss=0.544, accuracy=0.885, val_loss=0.926, val_accuracy=0.774, lr=0.01]100%|██████████| 115/115 [44:34<00:00, 23.26s/epoch, loss=0.544, accuracy=0.885, val_loss=0.926, val_accuracy=0.774, lr=0.01]
Using real-time data augmentation.
Test score: 0.9259622097015381
Test accuracy: 0.7738999724388123


* * * Run SGD for ID = 13_10. * * *


2024-03-05 10:26:22.678042: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 10:26:25.353619: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 10:26:25.354445: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-05 10:26:25.392728: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-05 10:26:25.392762: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 10:26:25.395389: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 10:26:25.395429: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-05 10:26:25.397443: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-05 10:26:25.398098: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-05 10:26:25.400272: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-05 10:26:25.401663: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-05 10:26:25.406238: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 10:26:25.406771: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-05 10:26:25.406867: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 10:26:26.600161: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-05 10:26:26.601223: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 10:26:26.602002: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-05 10:26:26.602035: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 10:26:26.602120: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 10:26:26.602151: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-05 10:26:26.602180: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-05 10:26:26.602200: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-05 10:26:26.602217: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-05 10:26:26.602233: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-05 10:26:26.602250: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 10:26:26.602699: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-05 10:26:26.602731: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 10:26:27.215595: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-05 10:26:27.215661: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-05 10:26:27.215672: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-05 10:26:27.216572: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:02:00.0, compute capability: 6.1)
{'id': '13_10', 'seed': 10, 'out_folder': 'results/epoch_budget', 'batch_size': 128, 'epochs': 115, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/115 [00:00<?, ?epoch/s]2024-03-05 10:26:28.035402: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-05 10:26:28.047257: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199825000 Hz
2024-03-05 10:26:29.999597: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 10:26:30.273459: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 10:26:30.976028: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-05 10:26:31.006765: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/115 [00:55<1:45:29, 55.52s/epoch, loss=2.87, accuracy=0.383, val_loss=2.32, val_accuracy=0.338, lr=0.1]  2%|▏         | 2/115 [01:18<1:09:02, 36.66s/epoch, loss=1.5, accuracy=0.58, val_loss=1.58, val_accuracy=0.565, lr=0.1]    3%|▎         | 3/115 [01:42<57:19, 30.71s/epoch, loss=1.32, accuracy=0.663, val_loss=2.08, val_accuracy=0.449, lr=0.1]  3%|▎         | 4/115 [02:06<51:30, 27.85s/epoch, loss=1.27, accuracy=0.691, val_loss=2.05, val_accuracy=0.447, lr=0.1]  4%|▍         | 5/115 [02:29<47:50, 26.10s/epoch, loss=1.24, accuracy=0.704, val_loss=1.55, val_accuracy=0.591, lr=0.1]  5%|▌         | 6/115 [02:52<45:42, 25.16s/epoch, loss=1.23, accuracy=0.717, val_loss=1.77, val_accuracy=0.535, lr=0.1]  6%|▌         | 7/115 [03:15<43:53, 24.38s/epoch, loss=1.21, accuracy=0.727, val_loss=1.94, val_accuracy=0.46, lr=0.1]   7%|▋         | 8/115 [03:37<42:04, 23.60s/epoch, loss=1.21, accuracy=0.726, val_loss=1.84, val_accuracy=0.522, lr=0.1]  8%|▊         | 9/115 [03:58<40:44, 23.06s/epoch, loss=1.19, accuracy=0.733, val_loss=3.4, val_accuracy=0.34, lr=0.1]    9%|▊         | 10/115 [04:20<39:41, 22.68s/epoch, loss=1.19, accuracy=0.734, val_loss=2.7, val_accuracy=0.407, lr=0.0316] 10%|▉         | 11/115 [04:44<39:48, 22.96s/epoch, loss=1.18, accuracy=0.737, val_loss=2.2, val_accuracy=0.545, lr=0.1]    10%|█         | 12/115 [05:07<39:35, 23.07s/epoch, loss=1.17, accuracy=0.743, val_loss=1.8, val_accuracy=0.555, lr=0.1] 11%|█▏        | 13/115 [05:29<38:33, 22.68s/epoch, loss=1.17, accuracy=0.741, val_loss=1.68, val_accuracy=0.596, lr=0.1] 12%|█▏        | 14/115 [05:52<38:17, 22.75s/epoch, loss=1.17, accuracy=0.74, val_loss=2.16, val_accuracy=0.429, lr=0.1]  13%|█▎        | 15/115 [06:15<38:11, 22.92s/epoch, loss=1.16, accuracy=0.744, val_loss=1.51, val_accuracy=0.63, lr=0.1] 14%|█▍        | 16/115 [06:38<37:30, 22.73s/epoch, loss=1.16, accuracy=0.743, val_loss=1.9, val_accuracy=0.53, lr=0.1]  15%|█▍        | 17/115 [07:01<37:32, 22.99s/epoch, loss=1.15, accuracy=0.746, val_loss=2.17, val_accuracy=0.415, lr=0.1] 16%|█▌        | 18/115 [07:24<37:12, 23.01s/epoch, loss=1.15, accuracy=0.749, val_loss=1.55, val_accuracy=0.624, lr=0.1] 17%|█▋        | 19/115 [07:47<36:52, 23.05s/epoch, loss=1.14, accuracy=0.75, val_loss=2.27, val_accuracy=0.527, lr=0.1]  17%|█▋        | 20/115 [08:10<36:32, 23.08s/epoch, loss=1.14, accuracy=0.751, val_loss=2.36, val_accuracy=0.453, lr=0.0316] 18%|█▊        | 21/115 [08:34<36:17, 23.17s/epoch, loss=1.15, accuracy=0.75, val_loss=1.8, val_accuracy=0.539, lr=0.1]      19%|█▉        | 22/115 [08:57<36:00, 23.23s/epoch, loss=1.15, accuracy=0.752, val_loss=2.04, val_accuracy=0.526, lr=0.1] 20%|██        | 23/115 [09:21<35:49, 23.36s/epoch, loss=1.14, accuracy=0.754, val_loss=1.58, val_accuracy=0.593, lr=0.1] 21%|██        | 24/115 [09:44<35:27, 23.38s/epoch, loss=1.14, accuracy=0.751, val_loss=1.56, val_accuracy=0.605, lr=0.1] 22%|██▏       | 25/115 [10:07<34:50, 23.23s/epoch, loss=1.13, accuracy=0.751, val_loss=1.73, val_accuracy=0.563, lr=0.0316] 23%|██▎       | 26/115 [10:31<34:29, 23.26s/epoch, loss=1.14, accuracy=0.753, val_loss=2.07, val_accuracy=0.477, lr=0.1]    23%|██▎       | 27/115 [10:54<34:15, 23.35s/epoch, loss=1.14, accuracy=0.755, val_loss=1.85, val_accuracy=0.48, lr=0.1]  24%|██▍       | 28/115 [11:17<33:45, 23.28s/epoch, loss=1.13, accuracy=0.753, val_loss=2.38, val_accuracy=0.345, lr=0.1] 25%|██▌       | 29/115 [11:40<33:16, 23.22s/epoch, loss=1.14, accuracy=0.753, val_loss=2.27, val_accuracy=0.496, lr=0.1] 26%|██▌       | 30/115 [12:04<32:55, 23.24s/epoch, loss=1.13, accuracy=0.756, val_loss=1.78, val_accuracy=0.552, lr=0.0316] 27%|██▋       | 31/115 [12:27<32:36, 23.29s/epoch, loss=1.13, accuracy=0.756, val_loss=2.06, val_accuracy=0.529, lr=0.1]    28%|██▊       | 32/115 [12:50<32:07, 23.23s/epoch, loss=1.13, accuracy=0.755, val_loss=1.79, val_accuracy=0.544, lr=0.1] 29%|██▊       | 33/115 [13:13<31:42, 23.20s/epoch, loss=1.12, accuracy=0.756, val_loss=1.53, val_accuracy=0.617, lr=0.1] 30%|██▉       | 34/115 [13:36<31:16, 23.16s/epoch, loss=1.12, accuracy=0.757, val_loss=1.88, val_accuracy=0.573, lr=0.1] 30%|███       | 35/115 [14:00<31:03, 23.29s/epoch, loss=1.13, accuracy=0.757, val_loss=2.44, val_accuracy=0.366, lr=0.0316] 31%|███▏      | 36/115 [14:23<30:44, 23.34s/epoch, loss=1.13, accuracy=0.754, val_loss=1.63, val_accuracy=0.621, lr=0.1]    32%|███▏      | 37/115 [14:47<30:20, 23.34s/epoch, loss=1.13, accuracy=0.755, val_loss=1.81, val_accuracy=0.549, lr=0.1] 33%|███▎      | 38/115 [15:10<30:00, 23.38s/epoch, loss=1.13, accuracy=0.758, val_loss=1.63, val_accuracy=0.598, lr=0.1] 34%|███▍      | 39/115 [15:34<29:39, 23.41s/epoch, loss=1.13, accuracy=0.758, val_loss=1.65, val_accuracy=0.574, lr=0.1] 35%|███▍      | 40/115 [15:57<29:13, 23.38s/epoch, loss=1.12, accuracy=0.758, val_loss=2.85, val_accuracy=0.438, lr=0.0316] 36%|███▌      | 41/115 [16:20<28:41, 23.27s/epoch, loss=1.12, accuracy=0.76, val_loss=1.59, val_accuracy=0.623, lr=0.1]     37%|███▋      | 42/115 [16:43<28:17, 23.25s/epoch, loss=1.12, accuracy=0.758, val_loss=2.4, val_accuracy=0.512, lr=0.1] 37%|███▋      | 43/115 [17:06<27:56, 23.29s/epoch, loss=1.12, accuracy=0.758, val_loss=1.92, val_accuracy=0.522, lr=0.1] 38%|███▊      | 44/115 [17:30<27:33, 23.29s/epoch, loss=1.12, accuracy=0.758, val_loss=2.06, val_accuracy=0.459, lr=0.1] 39%|███▉      | 45/115 [17:53<27:14, 23.35s/epoch, loss=1.12, accuracy=0.755, val_loss=2.46, val_accuracy=0.407, lr=0.0316] 40%|████      | 46/115 [18:16<26:34, 23.11s/epoch, loss=1.12, accuracy=0.759, val_loss=2.27, val_accuracy=0.456, lr=0.1]    41%|████      | 47/115 [18:39<26:20, 23.25s/epoch, loss=1.13, accuracy=0.756, val_loss=4.95, val_accuracy=0.185, lr=0.1] 42%|████▏     | 48/115 [19:03<26:03, 23.33s/epoch, loss=1.12, accuracy=0.756, val_loss=1.61, val_accuracy=0.641, lr=0.1] 43%|████▎     | 49/115 [19:26<25:42, 23.37s/epoch, loss=1.12, accuracy=0.757, val_loss=2.7, val_accuracy=0.397, lr=0.1]  43%|████▎     | 50/115 [19:50<25:22, 23.43s/epoch, loss=1.13, accuracy=0.754, val_loss=1.56, val_accuracy=0.6, lr=0.0316] 44%|████▍     | 51/115 [20:13<24:56, 23.39s/epoch, loss=1.12, accuracy=0.757, val_loss=2, val_accuracy=0.503, lr=0.1]     45%|████▌     | 52/115 [20:36<24:30, 23.34s/epoch, loss=1.13, accuracy=0.756, val_loss=2.51, val_accuracy=0.379, lr=0.1] 46%|████▌     | 53/115 [21:00<24:11, 23.41s/epoch, loss=1.13, accuracy=0.754, val_loss=3.12, val_accuracy=0.385, lr=0.1] 47%|████▋     | 54/115 [21:24<23:53, 23.50s/epoch, loss=1.12, accuracy=0.756, val_loss=2.4, val_accuracy=0.424, lr=0.1]  48%|████▊     | 55/115 [21:47<23:22, 23.37s/epoch, loss=1.12, accuracy=0.757, val_loss=1.53, val_accuracy=0.637, lr=0.0316] 49%|████▊     | 56/115 [22:10<23:01, 23.41s/epoch, loss=1.12, accuracy=0.758, val_loss=1.81, val_accuracy=0.56, lr=0.1]     50%|████▉     | 57/115 [22:34<22:38, 23.42s/epoch, loss=1.12, accuracy=0.761, val_loss=1.47, val_accuracy=0.644, lr=0.1] 50%|█████     | 58/115 [22:57<22:14, 23.42s/epoch, loss=1.12, accuracy=0.758, val_loss=3.98, val_accuracy=0.294, lr=0.1] 51%|█████▏    | 59/115 [23:21<21:56, 23.52s/epoch, loss=1.12, accuracy=0.759, val_loss=1.72, val_accuracy=0.55, lr=0.1]  52%|█████▏    | 60/115 [23:44<21:29, 23.44s/epoch, loss=1.11, accuracy=0.762, val_loss=2.16, val_accuracy=0.502, lr=0.1] 53%|█████▎    | 61/115 [24:08<21:10, 23.52s/epoch, loss=1.12, accuracy=0.756, val_loss=2.55, val_accuracy=0.492, lr=0.1] 54%|█████▍    | 62/115 [24:32<20:48, 23.56s/epoch, loss=1.12, accuracy=0.759, val_loss=2.2, val_accuracy=0.393, lr=0.0316] 55%|█████▍    | 63/115 [24:55<20:27, 23.60s/epoch, loss=1.11, accuracy=0.76, val_loss=2.16, val_accuracy=0.477, lr=0.1]    56%|█████▌    | 64/115 [25:19<20:01, 23.56s/epoch, loss=1.12, accuracy=0.758, val_loss=1.91, val_accuracy=0.567, lr=0.1] 57%|█████▋    | 65/115 [25:42<19:32, 23.45s/epoch, loss=1.13, accuracy=0.756, val_loss=2.14, val_accuracy=0.47, lr=0.1]  57%|█████▋    | 66/115 [26:05<19:03, 23.33s/epoch, loss=1.12, accuracy=0.758, val_loss=1.81, val_accuracy=0.533, lr=0.1] 58%|█████▊    | 67/115 [26:28<18:34, 23.22s/epoch, loss=1.12, accuracy=0.759, val_loss=1.88, val_accuracy=0.584, lr=0.0316] 59%|█████▉    | 68/115 [26:50<17:53, 22.85s/epoch, loss=1.12, accuracy=0.759, val_loss=2.52, val_accuracy=0.4, lr=0.1]      60%|██████    | 69/115 [27:12<17:22, 22.65s/epoch, loss=1.12, accuracy=0.758, val_loss=4.77, val_accuracy=0.348, lr=0.1] 61%|██████    | 70/115 [27:35<17:05, 22.80s/epoch, loss=1.12, accuracy=0.757, val_loss=3.57, val_accuracy=0.275, lr=0.1] 62%|██████▏   | 71/115 [27:59<16:49, 22.94s/epoch, loss=1.12, accuracy=0.758, val_loss=2.38, val_accuracy=0.515, lr=0.1] 63%|██████▎   | 72/115 [28:22<16:34, 23.12s/epoch, loss=1.12, accuracy=0.756, val_loss=1.84, val_accuracy=0.518, lr=0.0316] 63%|██████▎   | 73/115 [28:45<16:13, 23.17s/epoch, loss=1.12, accuracy=0.757, val_loss=2, val_accuracy=0.518, lr=0.1]       64%|██████▍   | 74/115 [29:09<15:57, 23.36s/epoch, loss=1.11, accuracy=0.758, val_loss=2.04, val_accuracy=0.489, lr=0.1] 65%|██████▌   | 75/115 [29:33<15:40, 23.52s/epoch, loss=1.12, accuracy=0.757, val_loss=1.69, val_accuracy=0.6, lr=0.1]   66%|██████▌   | 76/115 [29:56<15:15, 23.47s/epoch, loss=1.12, accuracy=0.756, val_loss=3.28, val_accuracy=0.38, lr=0.1] 67%|██████▋   | 77/115 [30:20<14:53, 23.51s/epoch, loss=1.11, accuracy=0.76, val_loss=1.65, val_accuracy=0.578, lr=0.0316] 68%|██████▊   | 78/115 [30:43<14:28, 23.47s/epoch, loss=1.12, accuracy=0.756, val_loss=2.33, val_accuracy=0.464, lr=0.1]   69%|██████▊   | 79/115 [31:07<14:07, 23.55s/epoch, loss=1.12, accuracy=0.757, val_loss=2.36, val_accuracy=0.471, lr=0.1] 70%|██████▉   | 80/115 [31:30<13:41, 23.47s/epoch, loss=1.12, accuracy=0.759, val_loss=3.19, val_accuracy=0.361, lr=0.1] 70%|███████   | 81/115 [31:54<13:16, 23.43s/epoch, loss=1.12, accuracy=0.756, val_loss=1.96, val_accuracy=0.505, lr=0.1] 71%|███████▏  | 82/115 [32:16<12:42, 23.12s/epoch, loss=0.895, accuracy=0.818, val_loss=0.897, val_accuracy=0.803, lr=0.01] 72%|███████▏  | 83/115 [32:39<12:20, 23.15s/epoch, loss=0.73, accuracy=0.848, val_loss=0.833, val_accuracy=0.801, lr=0.01]  73%|███████▎  | 84/115 [33:03<12:01, 23.26s/epoch, loss=0.649, accuracy=0.856, val_loss=0.711, val_accuracy=0.826, lr=0.01] 74%|███████▍  | 85/115 [33:26<11:35, 23.18s/epoch, loss=0.604, accuracy=0.859, val_loss=0.859, val_accuracy=0.769, lr=0.01] 75%|███████▍  | 86/115 [33:49<11:14, 23.26s/epoch, loss=0.582, accuracy=0.86, val_loss=0.71, val_accuracy=0.817, lr=0.01]   76%|███████▌  | 87/115 [34:12<10:45, 23.06s/epoch, loss=0.571, accuracy=0.861, val_loss=0.802, val_accuracy=0.796, lr=0.01] 77%|███████▋  | 88/115 [34:35<10:25, 23.15s/epoch, loss=0.57, accuracy=0.863, val_loss=0.813, val_accuracy=0.79, lr=0.01]   77%|███████▋  | 89/115 [34:58<10:00, 23.08s/epoch, loss=0.564, accuracy=0.865, val_loss=0.767, val_accuracy=0.805, lr=0.01] 78%|███████▊  | 90/115 [35:21<09:33, 22.95s/epoch, loss=0.565, accuracy=0.863, val_loss=1.23, val_accuracy=0.672, lr=0.01]  79%|███████▉  | 91/115 [35:44<09:14, 23.11s/epoch, loss=0.552, accuracy=0.87, val_loss=0.795, val_accuracy=0.795, lr=0.00316] 80%|████████  | 92/115 [36:06<08:44, 22.79s/epoch, loss=0.558, accuracy=0.868, val_loss=0.87, val_accuracy=0.758, lr=0.01]    81%|████████  | 93/115 [36:30<08:25, 22.98s/epoch, loss=0.559, accuracy=0.87, val_loss=1.04, val_accuracy=0.734, lr=0.01]  82%|████████▏ | 94/115 [36:53<08:04, 23.07s/epoch, loss=0.556, accuracy=0.872, val_loss=0.942, val_accuracy=0.756, lr=0.01] 83%|████████▎ | 95/115 [37:16<07:40, 23.05s/epoch, loss=0.553, accuracy=0.874, val_loss=0.87, val_accuracy=0.766, lr=0.01]  83%|████████▎ | 96/115 [37:39<07:16, 22.95s/epoch, loss=0.551, accuracy=0.873, val_loss=0.795, val_accuracy=0.793, lr=0.00316] 84%|████████▍ | 97/115 [38:02<06:54, 23.03s/epoch, loss=0.553, accuracy=0.876, val_loss=0.871, val_accuracy=0.791, lr=0.01]    85%|████████▌ | 98/115 [38:25<06:30, 22.96s/epoch, loss=0.551, accuracy=0.876, val_loss=0.703, val_accuracy=0.829, lr=0.01] 86%|████████▌ | 99/115 [38:48<06:08, 23.06s/epoch, loss=0.554, accuracy=0.876, val_loss=0.912, val_accuracy=0.779, lr=0.01] 87%|████████▋ | 100/115 [39:10<05:40, 22.71s/epoch, loss=0.552, accuracy=0.877, val_loss=0.732, val_accuracy=0.822, lr=0.01] 88%|████████▊ | 101/115 [39:32<05:14, 22.43s/epoch, loss=0.551, accuracy=0.878, val_loss=0.822, val_accuracy=0.781, lr=0.01] 89%|████████▊ | 102/115 [39:55<04:54, 22.67s/epoch, loss=0.554, accuracy=0.875, val_loss=1.34, val_accuracy=0.655, lr=0.01]  90%|████████▉ | 103/115 [40:17<04:30, 22.58s/epoch, loss=0.55, accuracy=0.879, val_loss=0.833, val_accuracy=0.8, lr=0.00316] 90%|█████████ | 104/115 [40:40<04:08, 22.55s/epoch, loss=0.547, accuracy=0.88, val_loss=1.02, val_accuracy=0.754, lr=0.01]   91%|█████████▏| 105/115 [41:02<03:43, 22.35s/epoch, loss=0.549, accuracy=0.879, val_loss=0.794, val_accuracy=0.804, lr=0.01] 92%|█████████▏| 106/115 [41:24<03:21, 22.42s/epoch, loss=0.549, accuracy=0.882, val_loss=0.93, val_accuracy=0.774, lr=0.01]  93%|█████████▎| 107/115 [41:47<02:59, 22.42s/epoch, loss=0.555, accuracy=0.879, val_loss=0.756, val_accuracy=0.813, lr=0.01] 94%|█████████▍| 108/115 [42:09<02:35, 22.25s/epoch, loss=0.55, accuracy=0.882, val_loss=0.86, val_accuracy=0.792, lr=0.00316] 95%|█████████▍| 109/115 [42:32<02:15, 22.60s/epoch, loss=0.548, accuracy=0.882, val_loss=0.875, val_accuracy=0.78, lr=0.01]   96%|█████████▌| 110/115 [42:56<01:54, 22.91s/epoch, loss=0.552, accuracy=0.881, val_loss=0.843, val_accuracy=0.795, lr=0.01] 97%|█████████▋| 111/115 [43:19<01:31, 22.95s/epoch, loss=0.552, accuracy=0.881, val_loss=0.975, val_accuracy=0.76, lr=0.01]  97%|█████████▋| 112/115 [43:42<01:09, 23.04s/epoch, loss=0.548, accuracy=0.882, val_loss=0.746, val_accuracy=0.82, lr=0.01] 98%|█████████▊| 113/115 [44:04<00:45, 22.81s/epoch, loss=0.548, accuracy=0.883, val_loss=0.774, val_accuracy=0.815, lr=0.00316] 99%|█████████▉| 114/115 [44:27<00:22, 22.86s/epoch, loss=0.547, accuracy=0.884, val_loss=1.02, val_accuracy=0.734, lr=0.01]    100%|██████████| 115/115 [44:50<00:00, 22.72s/epoch, loss=0.545, accuracy=0.886, val_loss=0.805, val_accuracy=0.803, lr=0.01]100%|██████████| 115/115 [44:50<00:00, 23.39s/epoch, loss=0.545, accuracy=0.886, val_loss=0.805, val_accuracy=0.803, lr=0.01]
Using real-time data augmentation.
Test score: 0.8049190640449524
Test accuracy: 0.8029999732971191


* * * Run SGD for ID = 13_11. * * *


2024-03-05 11:11:22.032134: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 11:11:24.304090: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 11:11:24.305127: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-05 11:11:24.345344: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-05 11:11:24.345409: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 11:11:24.348106: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 11:11:24.348151: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-05 11:11:24.350411: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-05 11:11:24.350986: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-05 11:11:24.353424: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-05 11:11:24.354830: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-05 11:11:24.359645: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 11:11:24.360671: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-05 11:11:24.360757: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 11:11:25.725763: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-05 11:11:25.726427: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 11:11:25.727273: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-05 11:11:25.727308: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 11:11:25.727345: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 11:11:25.727364: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-05 11:11:25.727382: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-05 11:11:25.727400: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-05 11:11:25.727418: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-05 11:11:25.727434: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-05 11:11:25.727452: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 11:11:25.728068: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-05 11:11:25.728111: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 11:11:26.436815: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-05 11:11:26.436857: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-05 11:11:26.436867: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-05 11:11:26.437832: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:02:00.0, compute capability: 6.1)
{'id': '13_11', 'seed': 11, 'out_folder': 'results/epoch_budget', 'batch_size': 128, 'epochs': 115, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/115 [00:00<?, ?epoch/s]2024-03-05 11:11:27.355863: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-05 11:11:27.368288: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199825000 Hz
2024-03-05 11:11:29.613921: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 11:11:29.840545: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 11:11:30.725231: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-05 11:11:30.772296: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/115 [01:02<1:59:03, 62.66s/epoch, loss=2.73, accuracy=0.434, val_loss=2, val_accuracy=0.394, lr=0.1]  2%|▏         | 2/115 [01:26<1:15:17, 39.98s/epoch, loss=1.41, accuracy=0.626, val_loss=2.36, val_accuracy=0.448, lr=0.1]  3%|▎         | 3/115 [01:50<1:00:29, 32.40s/epoch, loss=1.29, accuracy=0.677, val_loss=2.74, val_accuracy=0.408, lr=0.1]  3%|▎         | 4/115 [02:13<53:17, 28.80s/epoch, loss=1.25, accuracy=0.699, val_loss=2.58, val_accuracy=0.375, lr=0.1]    4%|▍         | 5/115 [02:36<49:12, 26.84s/epoch, loss=1.24, accuracy=0.712, val_loss=2, val_accuracy=0.514, lr=0.1]     5%|▌         | 6/115 [03:00<46:47, 25.75s/epoch, loss=1.22, accuracy=0.719, val_loss=1.9, val_accuracy=0.49, lr=0.1]  6%|▌         | 7/115 [03:22<44:26, 24.69s/epoch, loss=1.2, accuracy=0.723, val_loss=1.93, val_accuracy=0.516, lr=0.1]  7%|▋         | 8/115 [03:45<42:38, 23.91s/epoch, loss=1.2, accuracy=0.73, val_loss=1.93, val_accuracy=0.518, lr=0.1]   8%|▊         | 9/115 [04:09<42:11, 23.88s/epoch, loss=1.19, accuracy=0.734, val_loss=1.6, val_accuracy=0.597, lr=0.1]  9%|▊         | 10/115 [04:32<41:44, 23.85s/epoch, loss=1.18, accuracy=0.739, val_loss=1.65, val_accuracy=0.567, lr=0.1] 10%|▉         | 11/115 [04:56<41:08, 23.74s/epoch, loss=1.17, accuracy=0.74, val_loss=1.76, val_accuracy=0.559, lr=0.1]  10%|█         | 12/115 [05:19<40:24, 23.54s/epoch, loss=1.17, accuracy=0.742, val_loss=1.9, val_accuracy=0.508, lr=0.1] 11%|█▏        | 13/115 [05:42<40:01, 23.55s/epoch, loss=1.17, accuracy=0.744, val_loss=2.15, val_accuracy=0.46, lr=0.1] 12%|█▏        | 14/115 [06:06<39:31, 23.48s/epoch, loss=1.16, accuracy=0.742, val_loss=2.07, val_accuracy=0.511, lr=0.0316] 13%|█▎        | 15/115 [06:29<39:15, 23.55s/epoch, loss=1.17, accuracy=0.742, val_loss=1.65, val_accuracy=0.592, lr=0.1]    14%|█▍        | 16/115 [06:53<38:36, 23.40s/epoch, loss=1.15, accuracy=0.745, val_loss=1.96, val_accuracy=0.532, lr=0.1] 15%|█▍        | 17/115 [07:16<38:18, 23.45s/epoch, loss=1.15, accuracy=0.746, val_loss=3.61, val_accuracy=0.278, lr=0.1] 16%|█▌        | 18/115 [07:39<37:42, 23.32s/epoch, loss=1.15, accuracy=0.745, val_loss=1.7, val_accuracy=0.575, lr=0.1]  17%|█▋        | 19/115 [08:01<36:49, 23.01s/epoch, loss=1.13, accuracy=0.753, val_loss=1.44, val_accuracy=0.651, lr=0.1] 17%|█▋        | 20/115 [08:25<36:47, 23.24s/epoch, loss=1.15, accuracy=0.749, val_loss=1.51, val_accuracy=0.604, lr=0.1] 18%|█▊        | 21/115 [08:48<36:11, 23.10s/epoch, loss=1.14, accuracy=0.749, val_loss=1.76, val_accuracy=0.544, lr=0.1] 19%|█▉        | 22/115 [09:10<35:31, 22.92s/epoch, loss=1.14, accuracy=0.753, val_loss=1.93, val_accuracy=0.486, lr=0.1] 20%|██        | 23/115 [09:35<35:41, 23.27s/epoch, loss=1.14, accuracy=0.752, val_loss=2.52, val_accuracy=0.45, lr=0.1]  21%|██        | 24/115 [09:58<35:28, 23.39s/epoch, loss=1.13, accuracy=0.753, val_loss=1.95, val_accuracy=0.531, lr=0.0316] 22%|██▏       | 25/115 [10:22<35:09, 23.44s/epoch, loss=1.13, accuracy=0.755, val_loss=3.55, val_accuracy=0.2, lr=0.1]      23%|██▎       | 26/115 [10:46<34:58, 23.58s/epoch, loss=1.13, accuracy=0.755, val_loss=1.77, val_accuracy=0.542, lr=0.1] 23%|██▎       | 27/115 [11:10<34:42, 23.66s/epoch, loss=1.13, accuracy=0.753, val_loss=3.17, val_accuracy=0.359, lr=0.1] 24%|██▍       | 28/115 [11:33<34:13, 23.61s/epoch, loss=1.12, accuracy=0.756, val_loss=1.55, val_accuracy=0.603, lr=0.1] 25%|██▌       | 29/115 [11:55<33:14, 23.19s/epoch, loss=1.13, accuracy=0.753, val_loss=2.17, val_accuracy=0.475, lr=0.0316] 26%|██▌       | 30/115 [12:19<33:00, 23.30s/epoch, loss=1.13, accuracy=0.755, val_loss=2.84, val_accuracy=0.382, lr=0.1]    27%|██▋       | 31/115 [12:41<32:14, 23.03s/epoch, loss=1.13, accuracy=0.755, val_loss=1.54, val_accuracy=0.637, lr=0.1] 28%|██▊       | 32/115 [13:05<32:05, 23.20s/epoch, loss=1.13, accuracy=0.756, val_loss=1.84, val_accuracy=0.534, lr=0.1] 29%|██▊       | 33/115 [13:27<31:17, 22.89s/epoch, loss=1.12, accuracy=0.756, val_loss=1.97, val_accuracy=0.521, lr=0.1] 30%|██▉       | 34/115 [13:50<31:05, 23.03s/epoch, loss=1.12, accuracy=0.758, val_loss=2.01, val_accuracy=0.526, lr=0.0316] 30%|███       | 35/115 [14:14<30:51, 23.15s/epoch, loss=1.11, accuracy=0.759, val_loss=1.58, val_accuracy=0.595, lr=0.1]    31%|███▏      | 36/115 [14:37<30:42, 23.33s/epoch, loss=1.12, accuracy=0.758, val_loss=1.69, val_accuracy=0.585, lr=0.1] 32%|███▏      | 37/115 [15:01<30:31, 23.48s/epoch, loss=1.12, accuracy=0.757, val_loss=1.93, val_accuracy=0.51, lr=0.1]  33%|███▎      | 38/115 [15:25<30:15, 23.57s/epoch, loss=1.11, accuracy=0.759, val_loss=1.48, val_accuracy=0.618, lr=0.1] 34%|███▍      | 39/115 [15:49<29:59, 23.68s/epoch, loss=1.11, accuracy=0.76, val_loss=1.96, val_accuracy=0.501, lr=0.0316] 35%|███▍      | 40/115 [16:12<29:25, 23.55s/epoch, loss=1.11, accuracy=0.76, val_loss=1.91, val_accuracy=0.538, lr=0.1]    36%|███▌      | 41/115 [16:36<28:58, 23.49s/epoch, loss=1.12, accuracy=0.757, val_loss=1.76, val_accuracy=0.575, lr=0.1] 37%|███▋      | 42/115 [17:00<28:46, 23.65s/epoch, loss=1.11, accuracy=0.758, val_loss=1.64, val_accuracy=0.568, lr=0.1] 37%|███▋      | 43/115 [17:23<28:23, 23.66s/epoch, loss=1.11, accuracy=0.76, val_loss=2.02, val_accuracy=0.494, lr=0.1]  38%|███▊      | 44/115 [17:47<28:02, 23.69s/epoch, loss=1.11, accuracy=0.759, val_loss=2.16, val_accuracy=0.426, lr=0.0316] 39%|███▉      | 45/115 [18:09<27:10, 23.29s/epoch, loss=1.11, accuracy=0.758, val_loss=1.47, val_accuracy=0.626, lr=0.1]    40%|████      | 46/115 [18:32<26:24, 22.97s/epoch, loss=1.11, accuracy=0.76, val_loss=1.67, val_accuracy=0.596, lr=0.1]  41%|████      | 47/115 [18:55<26:15, 23.17s/epoch, loss=1.11, accuracy=0.757, val_loss=1.79, val_accuracy=0.522, lr=0.1] 42%|████▏     | 48/115 [19:18<25:44, 23.06s/epoch, loss=1.11, accuracy=0.757, val_loss=2.36, val_accuracy=0.458, lr=0.1] 43%|████▎     | 49/115 [19:41<25:12, 22.92s/epoch, loss=1.1, accuracy=0.76, val_loss=2.07, val_accuracy=0.509, lr=0.0316] 43%|████▎     | 50/115 [20:04<24:55, 23.00s/epoch, loss=1.11, accuracy=0.759, val_loss=1.92, val_accuracy=0.491, lr=0.1]  44%|████▍     | 51/115 [20:28<24:44, 23.19s/epoch, loss=1.11, accuracy=0.757, val_loss=2.73, val_accuracy=0.302, lr=0.1] 45%|████▌     | 52/115 [20:50<24:14, 23.08s/epoch, loss=1.1, accuracy=0.761, val_loss=1.76, val_accuracy=0.547, lr=0.1]  46%|████▌     | 53/115 [21:13<23:50, 23.07s/epoch, loss=1.1, accuracy=0.76, val_loss=1.54, val_accuracy=0.63, lr=0.1]   47%|████▋     | 54/115 [21:37<23:32, 23.16s/epoch, loss=1.11, accuracy=0.757, val_loss=1.97, val_accuracy=0.506, lr=0.0316] 48%|████▊     | 55/115 [21:59<22:58, 22.97s/epoch, loss=1.11, accuracy=0.76, val_loss=2.46, val_accuracy=0.441, lr=0.1]     49%|████▊     | 56/115 [22:23<22:41, 23.07s/epoch, loss=1.11, accuracy=0.758, val_loss=1.82, val_accuracy=0.516, lr=0.1] 50%|████▉     | 57/115 [22:46<22:29, 23.27s/epoch, loss=1.11, accuracy=0.758, val_loss=1.76, val_accuracy=0.526, lr=0.1] 50%|█████     | 58/115 [23:09<21:51, 23.00s/epoch, loss=1.11, accuracy=0.759, val_loss=2.46, val_accuracy=0.391, lr=0.1] 51%|█████▏    | 59/115 [23:32<21:24, 22.94s/epoch, loss=1.11, accuracy=0.762, val_loss=1.5, val_accuracy=0.632, lr=0.0316] 52%|█████▏    | 60/115 [23:55<21:10, 23.10s/epoch, loss=1.11, accuracy=0.759, val_loss=4.45, val_accuracy=0.227, lr=0.1]   53%|█████▎    | 61/115 [24:19<20:58, 23.31s/epoch, loss=1.11, accuracy=0.758, val_loss=1.69, val_accuracy=0.567, lr=0.1] 54%|█████▍    | 62/115 [24:43<20:43, 23.47s/epoch, loss=1.1, accuracy=0.76, val_loss=2.37, val_accuracy=0.508, lr=0.1]   55%|█████▍    | 63/115 [25:06<20:22, 23.51s/epoch, loss=1.11, accuracy=0.759, val_loss=3.54, val_accuracy=0.305, lr=0.1] 56%|█████▌    | 64/115 [25:30<20:03, 23.59s/epoch, loss=1.11, accuracy=0.757, val_loss=1.91, val_accuracy=0.533, lr=0.0316] 57%|█████▋    | 65/115 [25:52<19:18, 23.18s/epoch, loss=1.1, accuracy=0.76, val_loss=3.72, val_accuracy=0.224, lr=0.1]      57%|█████▋    | 66/115 [26:16<19:06, 23.40s/epoch, loss=1.1, accuracy=0.761, val_loss=1.74, val_accuracy=0.574, lr=0.1] 58%|█████▊    | 67/115 [26:39<18:29, 23.11s/epoch, loss=1.11, accuracy=0.76, val_loss=1.85, val_accuracy=0.53, lr=0.1]  59%|█████▉    | 68/115 [27:02<18:08, 23.16s/epoch, loss=1.11, accuracy=0.758, val_loss=2.08, val_accuracy=0.545, lr=0.1] 60%|██████    | 69/115 [27:24<17:35, 22.94s/epoch, loss=1.11, accuracy=0.758, val_loss=1.84, val_accuracy=0.55, lr=0.0316] 61%|██████    | 70/115 [27:46<16:58, 22.63s/epoch, loss=1.11, accuracy=0.759, val_loss=2.44, val_accuracy=0.406, lr=0.1]   62%|██████▏   | 71/115 [28:10<16:53, 23.02s/epoch, loss=1.1, accuracy=0.759, val_loss=2.18, val_accuracy=0.43, lr=0.1]   63%|██████▎   | 72/115 [28:32<16:19, 22.79s/epoch, loss=1.1, accuracy=0.758, val_loss=1.69, val_accuracy=0.591, lr=0.1] 63%|██████▎   | 73/115 [28:56<16:06, 23.01s/epoch, loss=1.1, accuracy=0.761, val_loss=2.69, val_accuracy=0.359, lr=0.1] 64%|██████▍   | 74/115 [29:20<15:51, 23.20s/epoch, loss=1.1, accuracy=0.758, val_loss=1.96, val_accuracy=0.515, lr=0.0316] 65%|██████▌   | 75/115 [29:43<15:26, 23.16s/epoch, loss=1.1, accuracy=0.759, val_loss=2.56, val_accuracy=0.464, lr=0.1]    66%|██████▌   | 76/115 [30:07<15:15, 23.46s/epoch, loss=1.1, accuracy=0.759, val_loss=2.59, val_accuracy=0.449, lr=0.1] 67%|██████▋   | 77/115 [30:31<14:56, 23.58s/epoch, loss=1.1, accuracy=0.759, val_loss=1.71, val_accuracy=0.56, lr=0.1]  68%|██████▊   | 78/115 [30:54<14:34, 23.65s/epoch, loss=1.09, accuracy=0.761, val_loss=2.29, val_accuracy=0.439, lr=0.1] 69%|██████▊   | 79/115 [31:18<14:12, 23.69s/epoch, loss=1.1, accuracy=0.76, val_loss=2.2, val_accuracy=0.445, lr=0.0316] 70%|██████▉   | 80/115 [31:42<13:46, 23.60s/epoch, loss=1.1, accuracy=0.758, val_loss=1.86, val_accuracy=0.559, lr=0.1]  70%|███████   | 81/115 [32:05<13:24, 23.65s/epoch, loss=1.1, accuracy=0.761, val_loss=2.18, val_accuracy=0.414, lr=0.1] 71%|███████▏  | 82/115 [32:29<12:58, 23.58s/epoch, loss=0.899, accuracy=0.816, val_loss=0.914, val_accuracy=0.794, lr=0.01] 72%|███████▏  | 83/115 [32:52<12:33, 23.56s/epoch, loss=0.718, accuracy=0.849, val_loss=0.785, val_accuracy=0.811, lr=0.01] 73%|███████▎  | 84/115 [33:16<12:11, 23.61s/epoch, loss=0.64, accuracy=0.857, val_loss=0.716, val_accuracy=0.823, lr=0.01]  74%|███████▍  | 85/115 [33:40<11:51, 23.70s/epoch, loss=0.593, accuracy=0.862, val_loss=0.693, val_accuracy=0.828, lr=0.01] 75%|███████▍  | 86/115 [34:04<11:29, 23.77s/epoch, loss=0.579, accuracy=0.862, val_loss=0.716, val_accuracy=0.815, lr=0.01] 76%|███████▌  | 87/115 [34:28<11:06, 23.80s/epoch, loss=0.564, accuracy=0.862, val_loss=0.771, val_accuracy=0.801, lr=0.01] 77%|███████▋  | 88/115 [34:52<10:46, 23.96s/epoch, loss=0.563, accuracy=0.862, val_loss=0.857, val_accuracy=0.772, lr=0.01] 77%|███████▋  | 89/115 [35:15<10:17, 23.76s/epoch, loss=0.559, accuracy=0.864, val_loss=0.961, val_accuracy=0.745, lr=0.01] 78%|███████▊  | 90/115 [35:40<09:57, 23.91s/epoch, loss=0.554, accuracy=0.867, val_loss=0.799, val_accuracy=0.785, lr=0.00316] 79%|███████▉  | 91/115 [36:03<09:32, 23.86s/epoch, loss=0.554, accuracy=0.868, val_loss=0.773, val_accuracy=0.791, lr=0.01]    80%|████████  | 92/115 [36:27<09:07, 23.81s/epoch, loss=0.553, accuracy=0.868, val_loss=0.814, val_accuracy=0.788, lr=0.01] 81%|████████  | 93/115 [36:51<08:45, 23.87s/epoch, loss=0.548, accuracy=0.871, val_loss=0.698, val_accuracy=0.825, lr=0.01] 82%|████████▏ | 94/115 [37:15<08:21, 23.87s/epoch, loss=0.549, accuracy=0.873, val_loss=1, val_accuracy=0.731, lr=0.01]     83%|████████▎ | 95/115 [37:39<07:56, 23.84s/epoch, loss=0.55, accuracy=0.871, val_loss=0.735, val_accuracy=0.816, lr=0.00316] 83%|████████▎ | 96/115 [38:02<07:31, 23.78s/epoch, loss=0.546, accuracy=0.874, val_loss=0.742, val_accuracy=0.812, lr=0.01]   84%|████████▍ | 97/115 [38:26<07:07, 23.72s/epoch, loss=0.55, accuracy=0.874, val_loss=0.779, val_accuracy=0.808, lr=0.01]  85%|████████▌ | 98/115 [38:49<06:41, 23.60s/epoch, loss=0.548, accuracy=0.876, val_loss=1.19, val_accuracy=0.714, lr=0.01] 86%|████████▌ | 99/115 [39:13<06:19, 23.73s/epoch, loss=0.546, accuracy=0.876, val_loss=0.778, val_accuracy=0.802, lr=0.01] 87%|████████▋ | 100/115 [39:36<05:50, 23.34s/epoch, loss=0.545, accuracy=0.878, val_loss=0.791, val_accuracy=0.803, lr=0.00316] 88%|████████▊ | 101/115 [39:58<05:22, 23.06s/epoch, loss=0.546, accuracy=0.876, val_loss=0.801, val_accuracy=0.795, lr=0.01]    89%|████████▊ | 102/115 [40:21<04:57, 22.86s/epoch, loss=0.549, accuracy=0.877, val_loss=0.899, val_accuracy=0.778, lr=0.01] 90%|████████▉ | 103/115 [40:43<04:32, 22.68s/epoch, loss=0.547, accuracy=0.878, val_loss=1.02, val_accuracy=0.736, lr=0.01]  90%|█████████ | 104/115 [41:05<04:07, 22.54s/epoch, loss=0.545, accuracy=0.879, val_loss=0.799, val_accuracy=0.805, lr=0.01] 91%|█████████▏| 105/115 [41:29<03:49, 22.92s/epoch, loss=0.547, accuracy=0.879, val_loss=0.919, val_accuracy=0.769, lr=0.00316] 92%|█████████▏| 106/115 [41:52<03:25, 22.87s/epoch, loss=0.548, accuracy=0.878, val_loss=0.954, val_accuracy=0.768, lr=0.01]    93%|█████████▎| 107/115 [42:15<03:04, 23.11s/epoch, loss=0.548, accuracy=0.878, val_loss=1.03, val_accuracy=0.757, lr=0.01]  94%|█████████▍| 108/115 [42:39<02:43, 23.29s/epoch, loss=0.542, accuracy=0.882, val_loss=0.894, val_accuracy=0.764, lr=0.01] 95%|█████████▍| 109/115 [43:03<02:20, 23.38s/epoch, loss=0.543, accuracy=0.88, val_loss=0.802, val_accuracy=0.796, lr=0.01]  96%|█████████▌| 110/115 [43:25<01:55, 23.17s/epoch, loss=0.541, accuracy=0.883, val_loss=0.947, val_accuracy=0.75, lr=0.00316] 97%|█████████▋| 111/115 [43:48<01:31, 22.91s/epoch, loss=0.542, accuracy=0.882, val_loss=0.787, val_accuracy=0.819, lr=0.01]   97%|█████████▋| 112/115 [44:10<01:08, 22.71s/epoch, loss=0.546, accuracy=0.883, val_loss=1.17, val_accuracy=0.73, lr=0.01]   98%|█████████▊| 113/115 [44:34<00:46, 23.05s/epoch, loss=0.545, accuracy=0.883, val_loss=0.885, val_accuracy=0.778, lr=0.01] 99%|█████████▉| 114/115 [44:57<00:23, 23.25s/epoch, loss=0.543, accuracy=0.884, val_loss=1.39, val_accuracy=0.672, lr=0.01] 100%|██████████| 115/115 [45:21<00:00, 23.35s/epoch, loss=0.547, accuracy=0.88, val_loss=0.725, val_accuracy=0.832, lr=0.00316]100%|██████████| 115/115 [45:21<00:00, 23.66s/epoch, loss=0.547, accuracy=0.88, val_loss=0.725, val_accuracy=0.832, lr=0.00316]
Using real-time data augmentation.
Test score: 0.7246907353401184
Test accuracy: 0.8319000005722046


* * * Run SGD for ID = 13_12. * * *


2024-03-05 11:56:53.059102: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 11:56:59.611841: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 11:56:59.612805: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-05 11:56:59.654905: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-05 11:56:59.654938: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 11:56:59.672366: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 11:56:59.672407: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-05 11:56:59.675156: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-05 11:56:59.676329: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-05 11:56:59.678644: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-05 11:56:59.680043: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-05 11:56:59.684619: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 11:56:59.685145: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-05 11:56:59.685226: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 11:57:01.074288: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-05 11:57:01.075350: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 11:57:01.077587: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-05 11:57:01.077634: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 11:57:01.077695: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 11:57:01.077716: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-05 11:57:01.077741: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-05 11:57:01.077767: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-05 11:57:01.077786: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-05 11:57:01.077803: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-05 11:57:01.077820: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 11:57:01.078329: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-05 11:57:01.078375: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 11:57:01.805257: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-05 11:57:01.805315: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-05 11:57:01.805326: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-05 11:57:01.806368: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:02:00.0, compute capability: 6.1)
{'id': '13_12', 'seed': 12, 'out_folder': 'results/epoch_budget', 'batch_size': 128, 'epochs': 115, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/115 [00:00<?, ?epoch/s]2024-03-05 11:57:02.745588: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-05 11:57:02.758185: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199825000 Hz
2024-03-05 11:57:04.725068: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 11:57:05.018077: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 11:57:05.814562: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-05 11:57:05.873953: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/115 [01:02<1:59:25, 62.86s/epoch, loss=2.95, accuracy=0.361, val_loss=2.34, val_accuracy=0.357, lr=0.1]  2%|▏         | 2/115 [01:26<1:14:39, 39.64s/epoch, loss=1.49, accuracy=0.579, val_loss=1.76, val_accuracy=0.522, lr=0.1]  3%|▎         | 3/115 [01:49<59:50, 32.06s/epoch, loss=1.31, accuracy=0.667, val_loss=3.02, val_accuracy=0.362, lr=0.1]    3%|▎         | 4/115 [02:12<52:50, 28.57s/epoch, loss=1.25, accuracy=0.698, val_loss=1.96, val_accuracy=0.468, lr=0.1]  4%|▍         | 5/115 [02:34<47:51, 26.10s/epoch, loss=1.24, accuracy=0.706, val_loss=3.42, val_accuracy=0.332, lr=0.1]  5%|▌         | 6/115 [02:56<44:48, 24.67s/epoch, loss=1.21, accuracy=0.719, val_loss=1.56, val_accuracy=0.596, lr=0.1]  6%|▌         | 7/115 [03:19<43:37, 24.24s/epoch, loss=1.19, accuracy=0.727, val_loss=1.54, val_accuracy=0.636, lr=0.1]  7%|▋         | 8/115 [03:41<41:47, 23.44s/epoch, loss=1.19, accuracy=0.73, val_loss=2.25, val_accuracy=0.45, lr=0.1]    8%|▊         | 9/115 [04:03<40:35, 22.97s/epoch, loss=1.18, accuracy=0.733, val_loss=2.06, val_accuracy=0.451, lr=0.1]  9%|▊         | 10/115 [04:26<40:23, 23.08s/epoch, loss=1.18, accuracy=0.736, val_loss=2.19, val_accuracy=0.44, lr=0.1] 10%|▉         | 11/115 [04:48<39:17, 22.67s/epoch, loss=1.17, accuracy=0.739, val_loss=4.02, val_accuracy=0.278, lr=0.1] 10%|█         | 12/115 [05:11<39:01, 22.73s/epoch, loss=1.17, accuracy=0.739, val_loss=2.03, val_accuracy=0.476, lr=0.0316] 11%|█▏        | 13/115 [05:32<38:07, 22.43s/epoch, loss=1.16, accuracy=0.743, val_loss=1.77, val_accuracy=0.565, lr=0.1]    12%|█▏        | 14/115 [05:55<38:08, 22.65s/epoch, loss=1.16, accuracy=0.743, val_loss=3.66, val_accuracy=0.351, lr=0.1] 13%|█▎        | 15/115 [06:19<38:01, 22.81s/epoch, loss=1.16, accuracy=0.746, val_loss=1.41, val_accuracy=0.655, lr=0.1] 14%|█▍        | 16/115 [06:42<37:54, 22.97s/epoch, loss=1.16, accuracy=0.748, val_loss=1.69, val_accuracy=0.567, lr=0.1] 15%|█▍        | 17/115 [07:05<37:35, 23.02s/epoch, loss=1.15, accuracy=0.749, val_loss=1.62, val_accuracy=0.581, lr=0.1] 16%|█▌        | 18/115 [07:27<36:46, 22.75s/epoch, loss=1.16, accuracy=0.746, val_loss=2.18, val_accuracy=0.547, lr=0.1] 17%|█▋        | 19/115 [07:50<36:37, 22.89s/epoch, loss=1.15, accuracy=0.748, val_loss=2.46, val_accuracy=0.446, lr=0.1] 17%|█▋        | 20/115 [08:13<36:03, 22.78s/epoch, loss=1.15, accuracy=0.748, val_loss=1.69, val_accuracy=0.563, lr=0.0316] 18%|█▊        | 21/115 [08:36<35:58, 22.96s/epoch, loss=1.14, accuracy=0.753, val_loss=1.57, val_accuracy=0.6, lr=0.1]      19%|█▉        | 22/115 [08:59<35:22, 22.83s/epoch, loss=1.14, accuracy=0.752, val_loss=1.66, val_accuracy=0.554, lr=0.1] 20%|██        | 23/115 [09:22<35:01, 22.84s/epoch, loss=1.13, accuracy=0.751, val_loss=1.73, val_accuracy=0.525, lr=0.1] 21%|██        | 24/115 [09:44<34:18, 22.62s/epoch, loss=1.14, accuracy=0.753, val_loss=2.27, val_accuracy=0.496, lr=0.1] 22%|██▏       | 25/115 [10:06<33:33, 22.37s/epoch, loss=1.14, accuracy=0.752, val_loss=1.64, val_accuracy=0.587, lr=0.0316] 23%|██▎       | 26/115 [10:28<33:02, 22.27s/epoch, loss=1.14, accuracy=0.753, val_loss=1.66, val_accuracy=0.596, lr=0.1]    23%|██▎       | 27/115 [10:50<32:43, 22.31s/epoch, loss=1.13, accuracy=0.756, val_loss=3.84, val_accuracy=0.343, lr=0.1] 24%|██▍       | 28/115 [11:13<32:38, 22.51s/epoch, loss=1.13, accuracy=0.754, val_loss=1.87, val_accuracy=0.51, lr=0.1]  25%|██▌       | 29/115 [11:36<32:30, 22.68s/epoch, loss=1.13, accuracy=0.753, val_loss=2.08, val_accuracy=0.482, lr=0.1] 26%|██▌       | 30/115 [11:59<32:12, 22.74s/epoch, loss=1.13, accuracy=0.753, val_loss=3.11, val_accuracy=0.399, lr=0.0316] 27%|██▋       | 31/115 [12:22<31:58, 22.84s/epoch, loss=1.13, accuracy=0.755, val_loss=3.56, val_accuracy=0.369, lr=0.1]    28%|██▊       | 32/115 [12:44<31:07, 22.50s/epoch, loss=1.13, accuracy=0.757, val_loss=2.31, val_accuracy=0.457, lr=0.1] 29%|██▊       | 33/115 [13:07<30:58, 22.67s/epoch, loss=1.13, accuracy=0.754, val_loss=1.52, val_accuracy=0.609, lr=0.1] 30%|██▉       | 34/115 [13:29<30:25, 22.54s/epoch, loss=1.13, accuracy=0.754, val_loss=2.13, val_accuracy=0.491, lr=0.1] 30%|███       | 35/115 [13:52<30:21, 22.76s/epoch, loss=1.12, accuracy=0.755, val_loss=1.62, val_accuracy=0.56, lr=0.0316] 31%|███▏      | 36/115 [14:15<30:02, 22.81s/epoch, loss=1.13, accuracy=0.754, val_loss=2.22, val_accuracy=0.464, lr=0.1]   32%|███▏      | 37/115 [14:37<29:12, 22.47s/epoch, loss=1.13, accuracy=0.753, val_loss=1.61, val_accuracy=0.598, lr=0.1] 33%|███▎      | 38/115 [14:59<28:37, 22.30s/epoch, loss=1.12, accuracy=0.757, val_loss=2.11, val_accuracy=0.481, lr=0.1] 34%|███▍      | 39/115 [15:22<28:32, 22.53s/epoch, loss=1.12, accuracy=0.755, val_loss=3.37, val_accuracy=0.379, lr=0.1] 35%|███▍      | 40/115 [15:45<28:18, 22.64s/epoch, loss=1.12, accuracy=0.757, val_loss=1.7, val_accuracy=0.565, lr=0.0316] 36%|███▌      | 41/115 [16:08<28:09, 22.83s/epoch, loss=1.12, accuracy=0.757, val_loss=3.04, val_accuracy=0.366, lr=0.1]   37%|███▋      | 42/115 [16:30<27:24, 22.53s/epoch, loss=1.12, accuracy=0.757, val_loss=3.28, val_accuracy=0.338, lr=0.1] 37%|███▋      | 43/115 [16:52<26:56, 22.45s/epoch, loss=1.12, accuracy=0.757, val_loss=2.2, val_accuracy=0.407, lr=0.1]  38%|███▊      | 44/115 [17:15<26:49, 22.67s/epoch, loss=1.12, accuracy=0.757, val_loss=2.23, val_accuracy=0.435, lr=0.1] 39%|███▉      | 45/115 [17:37<26:06, 22.38s/epoch, loss=1.11, accuracy=0.76, val_loss=1.97, val_accuracy=0.463, lr=0.0316] 40%|████      | 46/115 [17:59<25:28, 22.15s/epoch, loss=1.13, accuracy=0.755, val_loss=2.31, val_accuracy=0.435, lr=0.1]   41%|████      | 47/115 [18:21<25:15, 22.29s/epoch, loss=1.11, accuracy=0.759, val_loss=2.61, val_accuracy=0.449, lr=0.1] 42%|████▏     | 48/115 [18:43<24:41, 22.11s/epoch, loss=1.11, accuracy=0.758, val_loss=1.66, val_accuracy=0.579, lr=0.1] 43%|████▎     | 49/115 [19:06<24:44, 22.49s/epoch, loss=1.12, accuracy=0.755, val_loss=2.14, val_accuracy=0.426, lr=0.1] 43%|████▎     | 50/115 [19:29<24:33, 22.67s/epoch, loss=1.11, accuracy=0.759, val_loss=2.03, val_accuracy=0.538, lr=0.0316] 44%|████▍     | 51/115 [19:52<24:15, 22.75s/epoch, loss=1.12, accuracy=0.757, val_loss=1.94, val_accuracy=0.514, lr=0.1]    45%|████▌     | 52/115 [20:16<24:04, 22.93s/epoch, loss=1.12, accuracy=0.757, val_loss=2.85, val_accuracy=0.438, lr=0.1] 46%|████▌     | 53/115 [20:39<23:48, 23.05s/epoch, loss=1.12, accuracy=0.756, val_loss=2.2, val_accuracy=0.466, lr=0.1]  47%|████▋     | 54/115 [21:02<23:27, 23.08s/epoch, loss=1.12, accuracy=0.759, val_loss=1.82, val_accuracy=0.541, lr=0.1] 48%|████▊     | 55/115 [21:24<22:49, 22.82s/epoch, loss=1.12, accuracy=0.757, val_loss=1.95, val_accuracy=0.505, lr=0.0316] 49%|████▊     | 56/115 [21:48<22:31, 22.91s/epoch, loss=1.12, accuracy=0.758, val_loss=1.62, val_accuracy=0.585, lr=0.1]    50%|████▉     | 57/115 [22:10<22:05, 22.85s/epoch, loss=1.11, accuracy=0.759, val_loss=2.35, val_accuracy=0.363, lr=0.1] 50%|█████     | 58/115 [22:33<21:45, 22.91s/epoch, loss=1.11, accuracy=0.76, val_loss=1.71, val_accuracy=0.582, lr=0.1]  51%|█████▏    | 59/115 [22:57<21:31, 23.07s/epoch, loss=1.12, accuracy=0.757, val_loss=2.2, val_accuracy=0.434, lr=0.1] 52%|█████▏    | 60/115 [23:20<21:06, 23.02s/epoch, loss=1.11, accuracy=0.758, val_loss=3.08, val_accuracy=0.307, lr=0.0316] 53%|█████▎    | 61/115 [23:42<20:24, 22.67s/epoch, loss=1.11, accuracy=0.758, val_loss=1.99, val_accuracy=0.482, lr=0.1]    54%|█████▍    | 62/115 [24:03<19:45, 22.38s/epoch, loss=1.11, accuracy=0.757, val_loss=2.54, val_accuracy=0.426, lr=0.1] 55%|█████▍    | 63/115 [24:26<19:30, 22.51s/epoch, loss=1.11, accuracy=0.759, val_loss=1.85, val_accuracy=0.516, lr=0.1] 56%|█████▌    | 64/115 [24:49<19:17, 22.70s/epoch, loss=1.1, accuracy=0.761, val_loss=3.66, val_accuracy=0.29, lr=0.1]   57%|█████▋    | 65/115 [25:12<18:49, 22.60s/epoch, loss=1.11, accuracy=0.76, val_loss=4.77, val_accuracy=0.185, lr=0.0316] 57%|█████▋    | 66/115 [25:33<18:14, 22.34s/epoch, loss=1.12, accuracy=0.757, val_loss=3.55, val_accuracy=0.271, lr=0.1]   58%|█████▊    | 67/115 [25:55<17:43, 22.16s/epoch, loss=1.12, accuracy=0.757, val_loss=1.84, val_accuracy=0.535, lr=0.1] 59%|█████▉    | 68/115 [26:17<17:15, 22.02s/epoch, loss=1.12, accuracy=0.758, val_loss=2.11, val_accuracy=0.47, lr=0.1]  60%|██████    | 69/115 [26:40<17:11, 22.41s/epoch, loss=1.11, accuracy=0.761, val_loss=2.34, val_accuracy=0.417, lr=0.1] 61%|██████    | 70/115 [27:03<16:49, 22.44s/epoch, loss=1.12, accuracy=0.758, val_loss=2.31, val_accuracy=0.363, lr=0.0316] 62%|██████▏   | 71/115 [27:26<16:38, 22.69s/epoch, loss=1.11, accuracy=0.757, val_loss=1.62, val_accuracy=0.585, lr=0.1]    63%|██████▎   | 72/115 [27:49<16:26, 22.94s/epoch, loss=1.11, accuracy=0.756, val_loss=2.96, val_accuracy=0.329, lr=0.1] 63%|██████▎   | 73/115 [28:12<16:01, 22.89s/epoch, loss=1.11, accuracy=0.759, val_loss=2.42, val_accuracy=0.368, lr=0.1] 64%|██████▍   | 74/115 [28:36<15:45, 23.06s/epoch, loss=1.11, accuracy=0.76, val_loss=2.28, val_accuracy=0.499, lr=0.1]  65%|██████▌   | 75/115 [28:58<15:16, 22.92s/epoch, loss=1.1, accuracy=0.758, val_loss=1.51, val_accuracy=0.623, lr=0.0316] 66%|██████▌   | 76/115 [29:20<14:42, 22.63s/epoch, loss=1.11, accuracy=0.757, val_loss=2.76, val_accuracy=0.353, lr=0.1]   67%|██████▋   | 77/115 [29:43<14:24, 22.76s/epoch, loss=1.11, accuracy=0.759, val_loss=2.4, val_accuracy=0.387, lr=0.1]  68%|██████▊   | 78/115 [30:05<13:54, 22.55s/epoch, loss=1.12, accuracy=0.758, val_loss=1.6, val_accuracy=0.604, lr=0.1] 69%|██████▊   | 79/115 [30:28<13:36, 22.69s/epoch, loss=1.11, accuracy=0.76, val_loss=2.22, val_accuracy=0.418, lr=0.1] 70%|██████▉   | 80/115 [30:50<13:03, 22.38s/epoch, loss=1.11, accuracy=0.758, val_loss=1.71, val_accuracy=0.542, lr=0.0316] 70%|███████   | 81/115 [31:12<12:37, 22.29s/epoch, loss=1.12, accuracy=0.757, val_loss=2.95, val_accuracy=0.417, lr=0.1]    71%|███████▏  | 82/115 [31:35<12:26, 22.61s/epoch, loss=0.91, accuracy=0.815, val_loss=0.873, val_accuracy=0.817, lr=0.01] 72%|███████▏  | 83/115 [31:58<12:08, 22.75s/epoch, loss=0.726, accuracy=0.85, val_loss=0.778, val_accuracy=0.823, lr=0.01] 73%|███████▎  | 84/115 [32:21<11:44, 22.74s/epoch, loss=0.647, accuracy=0.856, val_loss=0.779, val_accuracy=0.812, lr=0.01] 74%|███████▍  | 85/115 [32:44<11:23, 22.79s/epoch, loss=0.602, accuracy=0.863, val_loss=0.844, val_accuracy=0.789, lr=0.01] 75%|███████▍  | 86/115 [33:06<10:50, 22.42s/epoch, loss=0.578, accuracy=0.862, val_loss=0.876, val_accuracy=0.778, lr=0.01] 76%|███████▌  | 87/115 [33:28<10:30, 22.52s/epoch, loss=0.567, accuracy=0.863, val_loss=0.822, val_accuracy=0.768, lr=0.01] 77%|███████▋  | 88/115 [33:51<10:11, 22.67s/epoch, loss=0.566, accuracy=0.863, val_loss=0.959, val_accuracy=0.739, lr=0.00316] 77%|███████▋  | 89/115 [34:13<09:42, 22.39s/epoch, loss=0.558, accuracy=0.867, val_loss=0.833, val_accuracy=0.791, lr=0.01]    78%|███████▊  | 90/115 [34:36<09:20, 22.44s/epoch, loss=0.553, accuracy=0.869, val_loss=0.741, val_accuracy=0.807, lr=0.01] 79%|███████▉  | 91/115 [34:59<09:02, 22.60s/epoch, loss=0.55, accuracy=0.869, val_loss=1.03, val_accuracy=0.728, lr=0.01]   80%|████████  | 92/115 [35:22<08:42, 22.73s/epoch, loss=0.549, accuracy=0.871, val_loss=0.884, val_accuracy=0.758, lr=0.01] 81%|████████  | 93/115 [35:45<08:24, 22.92s/epoch, loss=0.548, accuracy=0.873, val_loss=1.12, val_accuracy=0.71, lr=0.01]   82%|████████▏ | 94/115 [36:08<07:59, 22.81s/epoch, loss=0.546, accuracy=0.873, val_loss=0.849, val_accuracy=0.784, lr=0.01] 83%|████████▎ | 95/115 [36:31<07:37, 22.85s/epoch, loss=0.549, accuracy=0.874, val_loss=0.787, val_accuracy=0.795, lr=0.00316] 83%|████████▎ | 96/115 [36:54<07:15, 22.91s/epoch, loss=0.549, accuracy=0.876, val_loss=0.769, val_accuracy=0.807, lr=0.01]    84%|████████▍ | 97/115 [37:17<06:54, 23.04s/epoch, loss=0.545, accuracy=0.878, val_loss=1.66, val_accuracy=0.632, lr=0.01]  85%|████████▌ | 98/115 [37:40<06:31, 23.01s/epoch, loss=0.546, accuracy=0.876, val_loss=0.979, val_accuracy=0.746, lr=0.01] 86%|████████▌ | 99/115 [38:03<06:09, 23.09s/epoch, loss=0.547, accuracy=0.879, val_loss=0.922, val_accuracy=0.77, lr=0.01]  87%|████████▋ | 100/115 [38:26<05:45, 23.01s/epoch, loss=0.549, accuracy=0.877, val_loss=0.734, val_accuracy=0.821, lr=0.01] 88%|████████▊ | 101/115 [38:49<05:22, 23.03s/epoch, loss=0.543, accuracy=0.88, val_loss=0.826, val_accuracy=0.801, lr=0.01]  89%|████████▊ | 102/115 [39:12<04:59, 23.06s/epoch, loss=0.543, accuracy=0.882, val_loss=0.778, val_accuracy=0.8, lr=0.01]  90%|████████▉ | 103/115 [39:35<04:36, 23.01s/epoch, loss=0.545, accuracy=0.881, val_loss=0.847, val_accuracy=0.795, lr=0.01] 90%|█████████ | 104/115 [39:58<04:12, 22.98s/epoch, loss=0.544, accuracy=0.881, val_loss=0.934, val_accuracy=0.766, lr=0.01] 91%|█████████▏| 105/115 [40:21<03:50, 23.07s/epoch, loss=0.539, accuracy=0.884, val_loss=0.736, val_accuracy=0.821, lr=0.00316] 92%|█████████▏| 106/115 [40:44<03:26, 22.96s/epoch, loss=0.542, accuracy=0.884, val_loss=0.804, val_accuracy=0.812, lr=0.01]    93%|█████████▎| 107/115 [41:07<03:03, 22.90s/epoch, loss=0.55, accuracy=0.882, val_loss=0.784, val_accuracy=0.814, lr=0.01]  94%|█████████▍| 108/115 [41:30<02:40, 22.90s/epoch, loss=0.54, accuracy=0.884, val_loss=0.758, val_accuracy=0.814, lr=0.01] 95%|█████████▍| 109/115 [41:52<02:17, 22.87s/epoch, loss=0.543, accuracy=0.883, val_loss=0.772, val_accuracy=0.809, lr=0.01] 96%|█████████▌| 110/115 [42:15<01:54, 22.87s/epoch, loss=0.539, accuracy=0.886, val_loss=0.821, val_accuracy=0.794, lr=0.00316] 97%|█████████▋| 111/115 [42:37<01:29, 22.41s/epoch, loss=0.543, accuracy=0.884, val_loss=1.02, val_accuracy=0.737, lr=0.01]     97%|█████████▋| 112/115 [42:59<01:07, 22.46s/epoch, loss=0.539, accuracy=0.888, val_loss=1.09, val_accuracy=0.733, lr=0.01] 98%|█████████▊| 113/115 [43:21<00:44, 22.13s/epoch, loss=0.544, accuracy=0.884, val_loss=0.724, val_accuracy=0.827, lr=0.01] 99%|█████████▉| 114/115 [43:43<00:22, 22.29s/epoch, loss=0.541, accuracy=0.886, val_loss=0.914, val_accuracy=0.787, lr=0.01]100%|██████████| 115/115 [44:05<00:00, 22.06s/epoch, loss=0.546, accuracy=0.884, val_loss=1.05, val_accuracy=0.739, lr=0.01] 100%|██████████| 115/115 [44:05<00:00, 23.00s/epoch, loss=0.546, accuracy=0.884, val_loss=1.05, val_accuracy=0.739, lr=0.01]
Using real-time data augmentation.
Test score: 1.0496331453323364
Test accuracy: 0.7391999959945679


* * * Run SGD for ID = 13_13. * * *


2024-03-05 12:41:11.611222: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 12:41:14.456158: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 12:41:14.457261: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-05 12:41:14.495981: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-05 12:41:14.496011: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 12:41:14.498934: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 12:41:14.498974: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-05 12:41:14.501157: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-05 12:41:14.502306: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-05 12:41:14.504524: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-05 12:41:14.506104: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-05 12:41:14.510791: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 12:41:14.511311: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-05 12:41:14.511398: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 12:41:15.752215: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-05 12:41:15.752817: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 12:41:15.753732: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-05 12:41:15.753766: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 12:41:15.753802: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 12:41:15.753819: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-05 12:41:15.753836: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-05 12:41:15.753854: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-05 12:41:15.753870: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-05 12:41:15.753885: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-05 12:41:15.753901: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 12:41:15.754410: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-05 12:41:15.754449: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 12:41:16.378714: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-05 12:41:16.378768: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-05 12:41:16.378777: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-05 12:41:16.379737: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:02:00.0, compute capability: 6.1)
{'id': '13_13', 'seed': 13, 'out_folder': 'results/epoch_budget', 'batch_size': 128, 'epochs': 115, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/115 [00:00<?, ?epoch/s]2024-03-05 12:41:17.212144: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-05 12:41:17.224190: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199825000 Hz
2024-03-05 12:41:19.330429: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 12:41:19.547475: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 12:41:20.231200: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-05 12:41:20.269527: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/115 [00:51<1:38:40, 51.93s/epoch, loss=2.82, accuracy=0.414, val_loss=1.92, val_accuracy=0.45, lr=0.1]  2%|▏         | 2/115 [01:15<1:06:27, 35.29s/epoch, loss=1.42, accuracy=0.612, val_loss=1.79, val_accuracy=0.499, lr=0.1]  3%|▎         | 3/115 [01:37<54:47, 29.35s/epoch, loss=1.28, accuracy=0.674, val_loss=1.87, val_accuracy=0.507, lr=0.1]    3%|▎         | 4/115 [02:00<49:27, 26.73s/epoch, loss=1.24, accuracy=0.696, val_loss=2.94, val_accuracy=0.314, lr=0.1]  4%|▍         | 5/115 [02:23<46:46, 25.51s/epoch, loss=1.23, accuracy=0.71, val_loss=2.3, val_accuracy=0.432, lr=0.1]    5%|▌         | 6/115 [02:45<44:06, 24.28s/epoch, loss=1.2, accuracy=0.721, val_loss=1.58, val_accuracy=0.587, lr=0.1]  6%|▌         | 7/115 [03:08<42:50, 23.80s/epoch, loss=1.2, accuracy=0.725, val_loss=1.99, val_accuracy=0.481, lr=0.1]  7%|▋         | 8/115 [03:32<42:15, 23.70s/epoch, loss=1.19, accuracy=0.729, val_loss=1.54, val_accuracy=0.613, lr=0.1]  8%|▊         | 9/115 [03:54<40:53, 23.15s/epoch, loss=1.18, accuracy=0.733, val_loss=2.14, val_accuracy=0.438, lr=0.1]  9%|▊         | 10/115 [04:16<40:02, 22.88s/epoch, loss=1.18, accuracy=0.737, val_loss=2.21, val_accuracy=0.506, lr=0.1] 10%|▉         | 11/115 [04:39<39:57, 23.05s/epoch, loss=1.17, accuracy=0.74, val_loss=1.46, val_accuracy=0.632, lr=0.1]  10%|█         | 12/115 [05:02<39:36, 23.07s/epoch, loss=1.17, accuracy=0.741, val_loss=2.06, val_accuracy=0.455, lr=0.1] 11%|█▏        | 13/115 [05:26<39:26, 23.20s/epoch, loss=1.17, accuracy=0.744, val_loss=2.07, val_accuracy=0.469, lr=0.1] 12%|█▏        | 14/115 [05:49<39:01, 23.18s/epoch, loss=1.17, accuracy=0.743, val_loss=2.15, val_accuracy=0.418, lr=0.1] 13%|█▎        | 15/115 [06:12<38:34, 23.15s/epoch, loss=1.17, accuracy=0.744, val_loss=1.62, val_accuracy=0.608, lr=0.1] 14%|█▍        | 16/115 [06:35<38:17, 23.21s/epoch, loss=1.17, accuracy=0.743, val_loss=2.29, val_accuracy=0.439, lr=0.0316] 15%|█▍        | 17/115 [06:59<37:51, 23.18s/epoch, loss=1.16, accuracy=0.748, val_loss=2.28, val_accuracy=0.402, lr=0.1]    16%|█▌        | 18/115 [07:21<37:13, 23.03s/epoch, loss=1.16, accuracy=0.749, val_loss=1.73, val_accuracy=0.552, lr=0.1] 17%|█▋        | 19/115 [07:44<36:53, 23.05s/epoch, loss=1.16, accuracy=0.749, val_loss=2.1, val_accuracy=0.464, lr=0.1]  17%|█▋        | 20/115 [08:08<36:47, 23.24s/epoch, loss=1.16, accuracy=0.746, val_loss=2.03, val_accuracy=0.45, lr=0.1] 18%|█▊        | 21/115 [08:31<36:15, 23.15s/epoch, loss=1.15, accuracy=0.75, val_loss=3.01, val_accuracy=0.348, lr=0.0316] 19%|█▉        | 22/115 [08:55<36:08, 23.32s/epoch, loss=1.15, accuracy=0.75, val_loss=2.42, val_accuracy=0.45, lr=0.1]     20%|██        | 23/115 [09:18<35:54, 23.42s/epoch, loss=1.14, accuracy=0.749, val_loss=5.18, val_accuracy=0.284, lr=0.1] 21%|██        | 24/115 [09:42<35:38, 23.50s/epoch, loss=1.14, accuracy=0.752, val_loss=1.66, val_accuracy=0.563, lr=0.1] 22%|██▏       | 25/115 [10:06<35:20, 23.56s/epoch, loss=1.15, accuracy=0.749, val_loss=1.53, val_accuracy=0.625, lr=0.1] 23%|██▎       | 26/115 [10:29<35:02, 23.62s/epoch, loss=1.14, accuracy=0.755, val_loss=1.67, val_accuracy=0.542, lr=0.0316] 23%|██▎       | 27/115 [10:53<34:39, 23.63s/epoch, loss=1.14, accuracy=0.753, val_loss=2.96, val_accuracy=0.31, lr=0.1]     24%|██▍       | 28/115 [11:17<34:18, 23.66s/epoch, loss=1.14, accuracy=0.754, val_loss=2.2, val_accuracy=0.408, lr=0.1] 25%|██▌       | 29/115 [11:40<33:44, 23.54s/epoch, loss=1.14, accuracy=0.754, val_loss=1.74, val_accuracy=0.583, lr=0.1] 26%|██▌       | 30/115 [12:04<33:20, 23.54s/epoch, loss=1.13, accuracy=0.751, val_loss=1.35, val_accuracy=0.668, lr=0.1] 27%|██▋       | 31/115 [12:27<32:48, 23.43s/epoch, loss=1.13, accuracy=0.756, val_loss=2.68, val_accuracy=0.431, lr=0.1] 28%|██▊       | 32/115 [12:50<32:28, 23.48s/epoch, loss=1.13, accuracy=0.755, val_loss=2.09, val_accuracy=0.468, lr=0.1] 29%|██▊       | 33/115 [13:14<32:05, 23.49s/epoch, loss=1.14, accuracy=0.753, val_loss=1.72, val_accuracy=0.523, lr=0.1] 30%|██▉       | 34/115 [13:36<31:13, 23.12s/epoch, loss=1.13, accuracy=0.757, val_loss=2.15, val_accuracy=0.383, lr=0.1] 30%|███       | 35/115 [13:59<30:47, 23.10s/epoch, loss=1.13, accuracy=0.755, val_loss=2.95, val_accuracy=0.344, lr=0.0316] 31%|███▏      | 36/115 [14:22<30:25, 23.10s/epoch, loss=1.13, accuracy=0.756, val_loss=1.74, val_accuracy=0.511, lr=0.1]    32%|███▏      | 37/115 [14:46<30:09, 23.20s/epoch, loss=1.13, accuracy=0.756, val_loss=2.33, val_accuracy=0.354, lr=0.1] 33%|███▎      | 38/115 [15:09<29:37, 23.09s/epoch, loss=1.13, accuracy=0.755, val_loss=2.22, val_accuracy=0.403, lr=0.1] 34%|███▍      | 39/115 [15:31<29:08, 23.01s/epoch, loss=1.13, accuracy=0.756, val_loss=1.89, val_accuracy=0.481, lr=0.1] 35%|███▍      | 40/115 [15:53<28:21, 22.69s/epoch, loss=1.12, accuracy=0.759, val_loss=1.64, val_accuracy=0.578, lr=0.0316] 36%|███▌      | 41/115 [16:17<28:17, 22.94s/epoch, loss=1.12, accuracy=0.759, val_loss=1.81, val_accuracy=0.524, lr=0.1]    37%|███▋      | 42/115 [16:39<27:33, 22.65s/epoch, loss=1.11, accuracy=0.76, val_loss=4.23, val_accuracy=0.289, lr=0.1]  37%|███▋      | 43/115 [17:01<26:55, 22.44s/epoch, loss=1.12, accuracy=0.759, val_loss=2.36, val_accuracy=0.417, lr=0.1] 38%|███▊      | 44/115 [17:23<26:38, 22.51s/epoch, loss=1.12, accuracy=0.757, val_loss=1.82, val_accuracy=0.545, lr=0.1] 39%|███▉      | 45/115 [17:46<26:13, 22.48s/epoch, loss=1.12, accuracy=0.757, val_loss=2.49, val_accuracy=0.457, lr=0.0316] 40%|████      | 46/115 [18:08<25:46, 22.41s/epoch, loss=1.12, accuracy=0.758, val_loss=2.16, val_accuracy=0.462, lr=0.1]    41%|████      | 47/115 [18:30<25:22, 22.39s/epoch, loss=1.12, accuracy=0.756, val_loss=1.88, val_accuracy=0.557, lr=0.1] 42%|████▏     | 48/115 [18:52<24:52, 22.27s/epoch, loss=1.11, accuracy=0.758, val_loss=1.95, val_accuracy=0.501, lr=0.1] 43%|████▎     | 49/115 [19:14<24:23, 22.18s/epoch, loss=1.12, accuracy=0.757, val_loss=2.05, val_accuracy=0.445, lr=0.1] 43%|████▎     | 50/115 [19:37<24:02, 22.19s/epoch, loss=1.11, accuracy=0.76, val_loss=2.99, val_accuracy=0.452, lr=0.0316] 44%|████▍     | 51/115 [20:00<24:06, 22.61s/epoch, loss=1.11, accuracy=0.757, val_loss=1.99, val_accuracy=0.49, lr=0.1]    45%|████▌     | 52/115 [20:24<24:06, 22.96s/epoch, loss=1.12, accuracy=0.76, val_loss=1.86, val_accuracy=0.53, lr=0.1]  46%|████▌     | 53/115 [20:48<23:53, 23.13s/epoch, loss=1.11, accuracy=0.759, val_loss=1.55, val_accuracy=0.61, lr=0.1] 47%|████▋     | 54/115 [21:11<23:41, 23.30s/epoch, loss=1.11, accuracy=0.759, val_loss=3.26, val_accuracy=0.298, lr=0.1] 48%|████▊     | 55/115 [21:35<23:22, 23.38s/epoch, loss=1.11, accuracy=0.758, val_loss=1.55, val_accuracy=0.618, lr=0.0316] 49%|████▊     | 56/115 [21:59<23:11, 23.58s/epoch, loss=1.1, accuracy=0.762, val_loss=5.23, val_accuracy=0.269, lr=0.1]     50%|████▉     | 57/115 [22:23<22:54, 23.69s/epoch, loss=1.12, accuracy=0.757, val_loss=2.05, val_accuracy=0.469, lr=0.1] 50%|█████     | 58/115 [22:47<22:30, 23.70s/epoch, loss=1.11, accuracy=0.76, val_loss=2.16, val_accuracy=0.508, lr=0.1]  51%|█████▏    | 59/115 [23:08<21:36, 23.15s/epoch, loss=1.11, accuracy=0.759, val_loss=1.77, val_accuracy=0.564, lr=0.1] 52%|█████▏    | 60/115 [23:32<21:15, 23.20s/epoch, loss=1.11, accuracy=0.757, val_loss=2.22, val_accuracy=0.506, lr=0.0316] 53%|█████▎    | 61/115 [23:54<20:45, 23.06s/epoch, loss=1.11, accuracy=0.759, val_loss=1.36, val_accuracy=0.661, lr=0.1]    54%|█████▍    | 62/115 [24:17<20:20, 23.03s/epoch, loss=1.11, accuracy=0.76, val_loss=1.56, val_accuracy=0.612, lr=0.1]  55%|█████▍    | 63/115 [24:41<20:00, 23.08s/epoch, loss=1.11, accuracy=0.758, val_loss=1.77, val_accuracy=0.575, lr=0.1] 56%|█████▌    | 64/115 [25:03<19:33, 23.00s/epoch, loss=1.1, accuracy=0.757, val_loss=1.85, val_accuracy=0.495, lr=0.1]  57%|█████▋    | 65/115 [25:27<19:16, 23.14s/epoch, loss=1.11, accuracy=0.758, val_loss=4.86, val_accuracy=0.249, lr=0.0316] 57%|█████▋    | 66/115 [25:50<18:50, 23.08s/epoch, loss=1.11, accuracy=0.759, val_loss=1.99, val_accuracy=0.478, lr=0.1]    58%|█████▊    | 67/115 [26:13<18:27, 23.08s/epoch, loss=1.11, accuracy=0.76, val_loss=2.01, val_accuracy=0.46, lr=0.1]   59%|█████▉    | 68/115 [26:35<17:57, 22.92s/epoch, loss=1.1, accuracy=0.762, val_loss=2.88, val_accuracy=0.366, lr=0.1] 60%|██████    | 69/115 [26:59<17:37, 22.98s/epoch, loss=1.11, accuracy=0.761, val_loss=1.79, val_accuracy=0.525, lr=0.1] 61%|██████    | 70/115 [27:22<17:22, 23.17s/epoch, loss=1.1, accuracy=0.761, val_loss=2.39, val_accuracy=0.457, lr=0.0316] 62%|██████▏   | 71/115 [27:45<17:00, 23.20s/epoch, loss=1.11, accuracy=0.759, val_loss=1.53, val_accuracy=0.632, lr=0.1]   63%|██████▎   | 72/115 [28:09<16:38, 23.23s/epoch, loss=1.1, accuracy=0.759, val_loss=2.75, val_accuracy=0.501, lr=0.1]  63%|██████▎   | 73/115 [28:32<16:16, 23.26s/epoch, loss=1.1, accuracy=0.761, val_loss=2.21, val_accuracy=0.423, lr=0.1] 64%|██████▍   | 74/115 [28:54<15:36, 22.83s/epoch, loss=1.11, accuracy=0.761, val_loss=5.04, val_accuracy=0.245, lr=0.1] 65%|██████▌   | 75/115 [29:16<14:59, 22.48s/epoch, loss=1.1, accuracy=0.761, val_loss=1.75, val_accuracy=0.563, lr=0.0316] 66%|██████▌   | 76/115 [29:38<14:30, 22.32s/epoch, loss=1.1, accuracy=0.76, val_loss=4.77, val_accuracy=0.214, lr=0.1]     67%|██████▋   | 77/115 [30:01<14:19, 22.63s/epoch, loss=1.1, accuracy=0.762, val_loss=1.54, val_accuracy=0.633, lr=0.1] 68%|██████▊   | 78/115 [30:24<14:06, 22.87s/epoch, loss=1.11, accuracy=0.759, val_loss=1.77, val_accuracy=0.584, lr=0.1] 69%|██████▊   | 79/115 [30:46<13:32, 22.57s/epoch, loss=1.1, accuracy=0.759, val_loss=1.91, val_accuracy=0.511, lr=0.1]  70%|██████▉   | 80/115 [31:10<13:20, 22.87s/epoch, loss=1.11, accuracy=0.758, val_loss=1.96, val_accuracy=0.546, lr=0.0316] 70%|███████   | 81/115 [31:32<12:49, 22.64s/epoch, loss=1.1, accuracy=0.76, val_loss=1.8, val_accuracy=0.508, lr=0.1]       71%|███████▏  | 82/115 [31:55<12:29, 22.71s/epoch, loss=0.897, accuracy=0.816, val_loss=0.86, val_accuracy=0.815, lr=0.01] 72%|███████▏  | 83/115 [32:18<12:10, 22.83s/epoch, loss=0.718, accuracy=0.847, val_loss=0.773, val_accuracy=0.818, lr=0.01] 73%|███████▎  | 84/115 [32:41<11:53, 23.00s/epoch, loss=0.641, accuracy=0.859, val_loss=0.744, val_accuracy=0.811, lr=0.01] 74%|███████▍  | 85/115 [33:04<11:32, 23.08s/epoch, loss=0.601, accuracy=0.86, val_loss=0.868, val_accuracy=0.762, lr=0.01]  75%|███████▍  | 86/115 [33:28<11:12, 23.20s/epoch, loss=0.578, accuracy=0.861, val_loss=0.736, val_accuracy=0.81, lr=0.01] 76%|███████▌  | 87/115 [33:51<10:50, 23.24s/epoch, loss=0.568, accuracy=0.862, val_loss=0.728, val_accuracy=0.808, lr=0.01] 77%|███████▋  | 88/115 [34:14<10:26, 23.21s/epoch, loss=0.561, accuracy=0.863, val_loss=1.01, val_accuracy=0.73, lr=0.01]   77%|███████▋  | 89/115 [34:37<10:02, 23.17s/epoch, loss=0.561, accuracy=0.864, val_loss=1.06, val_accuracy=0.719, lr=0.01] 78%|███████▊  | 90/115 [35:00<09:36, 23.08s/epoch, loss=0.558, accuracy=0.866, val_loss=0.802, val_accuracy=0.795, lr=0.01] 79%|███████▉  | 91/115 [35:24<09:16, 23.20s/epoch, loss=0.553, accuracy=0.869, val_loss=0.8, val_accuracy=0.797, lr=0.01]   80%|████████  | 92/115 [35:47<08:56, 23.30s/epoch, loss=0.556, accuracy=0.869, val_loss=0.787, val_accuracy=0.8, lr=0.00316] 81%|████████  | 93/115 [36:11<08:33, 23.35s/epoch, loss=0.551, accuracy=0.872, val_loss=0.852, val_accuracy=0.785, lr=0.01]  82%|████████▏ | 94/115 [36:33<08:00, 22.88s/epoch, loss=0.554, accuracy=0.872, val_loss=0.903, val_accuracy=0.757, lr=0.01] 83%|████████▎ | 95/115 [36:56<07:41, 23.05s/epoch, loss=0.55, accuracy=0.874, val_loss=0.705, val_accuracy=0.821, lr=0.01]  83%|████████▎ | 96/115 [37:19<07:19, 23.13s/epoch, loss=0.549, accuracy=0.874, val_loss=0.905, val_accuracy=0.753, lr=0.01] 84%|████████▍ | 97/115 [37:42<06:55, 23.11s/epoch, loss=0.551, accuracy=0.875, val_loss=1.07, val_accuracy=0.719, lr=0.01]  85%|████████▌ | 98/115 [38:04<06:27, 22.78s/epoch, loss=0.55, accuracy=0.874, val_loss=0.818, val_accuracy=0.792, lr=0.01] 86%|████████▌ | 99/115 [38:27<06:05, 22.84s/epoch, loss=0.547, accuracy=0.876, val_loss=0.708, val_accuracy=0.826, lr=0.01] 87%|████████▋ | 100/115 [38:51<05:43, 22.91s/epoch, loss=0.546, accuracy=0.878, val_loss=0.692, val_accuracy=0.828, lr=0.01] 88%|████████▊ | 101/115 [39:14<05:22, 23.05s/epoch, loss=0.547, accuracy=0.877, val_loss=0.778, val_accuracy=0.797, lr=0.01] 89%|████████▊ | 102/115 [39:37<05:01, 23.17s/epoch, loss=0.551, accuracy=0.878, val_loss=0.761, val_accuracy=0.811, lr=0.01] 90%|████████▉ | 103/115 [39:59<04:34, 22.85s/epoch, loss=0.546, accuracy=0.878, val_loss=0.834, val_accuracy=0.793, lr=0.01] 90%|█████████ | 104/115 [40:23<04:13, 23.03s/epoch, loss=0.551, accuracy=0.88, val_loss=0.718, val_accuracy=0.823, lr=0.01]  91%|█████████▏| 105/115 [40:45<03:47, 22.76s/epoch, loss=0.544, accuracy=0.881, val_loss=1.04, val_accuracy=0.73, lr=0.00316] 92%|█████████▏| 106/115 [41:08<03:25, 22.83s/epoch, loss=0.546, accuracy=0.88, val_loss=1.02, val_accuracy=0.754, lr=0.01]    93%|█████████▎| 107/115 [41:31<03:03, 22.96s/epoch, loss=0.548, accuracy=0.88, val_loss=0.837, val_accuracy=0.788, lr=0.01] 94%|█████████▍| 108/115 [41:55<02:41, 23.07s/epoch, loss=0.549, accuracy=0.878, val_loss=0.913, val_accuracy=0.778, lr=0.01] 95%|█████████▍| 109/115 [42:17<02:17, 23.00s/epoch, loss=0.55, accuracy=0.88, val_loss=0.925, val_accuracy=0.751, lr=0.01]   96%|█████████▌| 110/115 [42:40<01:54, 22.92s/epoch, loss=0.547, accuracy=0.88, val_loss=0.88, val_accuracy=0.775, lr=0.00316] 97%|█████████▋| 111/115 [43:03<01:31, 22.98s/epoch, loss=0.548, accuracy=0.881, val_loss=0.739, val_accuracy=0.82, lr=0.01]   97%|█████████▋| 112/115 [43:26<01:08, 22.80s/epoch, loss=0.547, accuracy=0.882, val_loss=0.963, val_accuracy=0.754, lr=0.01] 98%|█████████▊| 113/115 [43:49<00:46, 23.02s/epoch, loss=0.544, accuracy=0.883, val_loss=0.968, val_accuracy=0.756, lr=0.01] 99%|█████████▉| 114/115 [44:12<00:22, 22.99s/epoch, loss=0.552, accuracy=0.879, val_loss=0.822, val_accuracy=0.802, lr=0.01]100%|██████████| 115/115 [44:35<00:00, 22.90s/epoch, loss=0.55, accuracy=0.883, val_loss=1.19, val_accuracy=0.697, lr=0.00316]100%|██████████| 115/115 [44:35<00:00, 23.26s/epoch, loss=0.55, accuracy=0.883, val_loss=1.19, val_accuracy=0.697, lr=0.00316]
Using real-time data augmentation.
Test score: 1.191394329071045
Test accuracy: 0.6965000033378601

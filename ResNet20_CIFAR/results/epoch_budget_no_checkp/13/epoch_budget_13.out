Thu Feb 15 12:58:03 2024       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 535.104.05             Driver Version: 535.104.05   CUDA Version: 12.2     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA TITAN X (Pascal)        Off | 00000000:03:00.0 Off |                  N/A |
| 50%   82C    P0             105W / 250W |      0MiB / 12288MiB |      0%      Default |
|                                         |                      |                  N/A |
+-----------------------------------------+----------------------+----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
|  No running processes found                                                           |
+---------------------------------------------------------------------------------------+


* * * Run SGD for cluster size = 13. * * *


Budget: 115


* * * Run SGD for ID = 13_1. * * *


2024-02-15 12:58:04.735884: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 12:58:16.175057: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 12:58:16.177384: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-15 12:58:16.215896: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-02-15 12:58:16.215933: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 12:58:16.255773: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 12:58:16.255844: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 12:58:16.296529: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 12:58:16.369515: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 12:58:16.423192: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 12:58:16.455894: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 12:58:16.496244: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 12:58:16.496905: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 12:58:16.497000: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 12:58:18.027539: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-15 12:58:18.028059: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 12:58:18.028603: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-02-15 12:58:18.028642: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 12:58:18.028676: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 12:58:18.028693: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 12:58:18.028709: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 12:58:18.028724: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 12:58:18.028740: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 12:58:18.028756: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 12:58:18.028772: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 12:58:18.029191: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 12:58:18.029226: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 12:58:19.492879: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-15 12:58:19.492957: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-15 12:58:19.492966: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-15 12:58:19.494190: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11227 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN X (Pascal), pci bus id: 0000:03:00.0, compute capability: 6.1)
{'id': 131, 'batch_size': 128, 'epochs': 115, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN X (Pascal)'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/115 [00:00<?, ?epoch/s]2024-02-15 12:58:20.252794: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-15 12:58:20.264403: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2599900000 Hz
2024-02-15 12:58:22.099679: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 12:58:22.377487: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 12:58:23.422967: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-15 12:58:23.460211: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/115 [00:50<1:36:45, 50.93s/epoch, loss=3.2, accuracy=0.299, val_loss=4.05, val_accuracy=0.138, lr=0.1]  2%|▏         | 2/115 [01:14<1:05:16, 34.66s/epoch, loss=1.61, accuracy=0.501, val_loss=2.18, val_accuracy=0.448, lr=0.1]  3%|▎         | 3/115 [01:37<54:45, 29.33s/epoch, loss=1.33, accuracy=0.641, val_loss=1.6, val_accuracy=0.565, lr=0.1]     3%|▎         | 4/115 [02:00<49:46, 26.91s/epoch, loss=1.26, accuracy=0.688, val_loss=2.9, val_accuracy=0.418, lr=0.1]  4%|▍         | 5/115 [02:23<46:54, 25.59s/epoch, loss=1.24, accuracy=0.703, val_loss=6.6, val_accuracy=0.157, lr=0.1]  5%|▌         | 6/115 [02:46<45:01, 24.78s/epoch, loss=1.23, accuracy=0.716, val_loss=2.11, val_accuracy=0.486, lr=0.1]  6%|▌         | 7/115 [03:09<43:15, 24.03s/epoch, loss=1.21, accuracy=0.724, val_loss=2.55, val_accuracy=0.283, lr=0.1]  7%|▋         | 8/115 [03:32<42:23, 23.78s/epoch, loss=1.22, accuracy=0.725, val_loss=2.33, val_accuracy=0.421, lr=0.0316]  8%|▊         | 9/115 [03:55<41:28, 23.48s/epoch, loss=1.2, accuracy=0.729, val_loss=1.59, val_accuracy=0.633, lr=0.1]      9%|▊         | 10/115 [04:18<40:55, 23.39s/epoch, loss=1.2, accuracy=0.733, val_loss=1.86, val_accuracy=0.547, lr=0.1] 10%|▉         | 11/115 [04:41<40:32, 23.39s/epoch, loss=1.2, accuracy=0.734, val_loss=1.89, val_accuracy=0.505, lr=0.1] 10%|█         | 12/115 [05:05<40:11, 23.42s/epoch, loss=1.2, accuracy=0.734, val_loss=1.65, val_accuracy=0.593, lr=0.1] 11%|█▏        | 13/115 [05:28<39:48, 23.42s/epoch, loss=1.19, accuracy=0.735, val_loss=1.87, val_accuracy=0.523, lr=0.1] 12%|█▏        | 14/115 [05:52<39:19, 23.36s/epoch, loss=1.19, accuracy=0.742, val_loss=2.12, val_accuracy=0.434, lr=0.0316] 13%|█▎        | 15/115 [06:15<38:47, 23.27s/epoch, loss=1.18, accuracy=0.743, val_loss=1.7, val_accuracy=0.568, lr=0.1]     14%|█▍        | 16/115 [06:38<38:22, 23.26s/epoch, loss=1.18, accuracy=0.743, val_loss=3.26, val_accuracy=0.246, lr=0.1] 15%|█▍        | 17/115 [07:01<37:55, 23.22s/epoch, loss=1.17, accuracy=0.744, val_loss=2.78, val_accuracy=0.463, lr=0.1] 16%|█▌        | 18/115 [07:24<37:30, 23.20s/epoch, loss=1.16, accuracy=0.745, val_loss=1.78, val_accuracy=0.56, lr=0.1]  17%|█▋        | 19/115 [07:48<37:13, 23.26s/epoch, loss=1.17, accuracy=0.745, val_loss=1.78, val_accuracy=0.559, lr=0.0316] 17%|█▋        | 20/115 [08:10<36:35, 23.11s/epoch, loss=1.17, accuracy=0.746, val_loss=3.42, val_accuracy=0.352, lr=0.1]    18%|█▊        | 21/115 [08:34<36:14, 23.13s/epoch, loss=1.16, accuracy=0.749, val_loss=2.69, val_accuracy=0.427, lr=0.1] 19%|█▉        | 22/115 [08:57<35:57, 23.20s/epoch, loss=1.16, accuracy=0.749, val_loss=1.77, val_accuracy=0.543, lr=0.1] 20%|██        | 23/115 [09:20<35:31, 23.17s/epoch, loss=1.16, accuracy=0.75, val_loss=1.39, val_accuracy=0.655, lr=0.1]  21%|██        | 24/115 [09:43<35:08, 23.18s/epoch, loss=1.16, accuracy=0.75, val_loss=1.55, val_accuracy=0.629, lr=0.1] 22%|██▏       | 25/115 [10:06<34:47, 23.20s/epoch, loss=1.16, accuracy=0.749, val_loss=1.61, val_accuracy=0.592, lr=0.1] 23%|██▎       | 26/115 [10:29<34:19, 23.14s/epoch, loss=1.15, accuracy=0.752, val_loss=1.41, val_accuracy=0.646, lr=0.1] 23%|██▎       | 27/115 [10:52<33:38, 22.94s/epoch, loss=1.15, accuracy=0.752, val_loss=1.57, val_accuracy=0.614, lr=0.1] 24%|██▍       | 28/115 [11:15<33:22, 23.01s/epoch, loss=1.15, accuracy=0.75, val_loss=2.59, val_accuracy=0.391, lr=0.0316] 25%|██▌       | 29/115 [11:39<33:10, 23.15s/epoch, loss=1.14, accuracy=0.753, val_loss=3.14, val_accuracy=0.369, lr=0.1]   26%|██▌       | 30/115 [12:01<32:39, 23.05s/epoch, loss=1.15, accuracy=0.751, val_loss=1.86, val_accuracy=0.552, lr=0.1] 27%|██▋       | 31/115 [12:25<32:21, 23.11s/epoch, loss=1.15, accuracy=0.753, val_loss=2.24, val_accuracy=0.469, lr=0.1] 28%|██▊       | 32/115 [12:48<32:02, 23.16s/epoch, loss=1.15, accuracy=0.751, val_loss=2.02, val_accuracy=0.473, lr=0.1] 29%|██▊       | 33/115 [13:11<31:34, 23.10s/epoch, loss=1.14, accuracy=0.756, val_loss=2.75, val_accuracy=0.381, lr=0.0316] 30%|██▉       | 34/115 [13:34<31:13, 23.13s/epoch, loss=1.14, accuracy=0.758, val_loss=2.69, val_accuracy=0.332, lr=0.1]    30%|███       | 35/115 [13:57<30:45, 23.06s/epoch, loss=1.14, accuracy=0.753, val_loss=2.13, val_accuracy=0.467, lr=0.1] 31%|███▏      | 36/115 [14:20<30:14, 22.97s/epoch, loss=1.14, accuracy=0.752, val_loss=1.99, val_accuracy=0.529, lr=0.1] 32%|███▏      | 37/115 [14:43<29:54, 23.01s/epoch, loss=1.14, accuracy=0.754, val_loss=1.99, val_accuracy=0.493, lr=0.1] 33%|███▎      | 38/115 [15:06<29:26, 22.94s/epoch, loss=1.14, accuracy=0.754, val_loss=2.45, val_accuracy=0.415, lr=0.0316] 34%|███▍      | 39/115 [15:28<29:01, 22.91s/epoch, loss=1.15, accuracy=0.753, val_loss=1.95, val_accuracy=0.459, lr=0.1]    35%|███▍      | 40/115 [15:51<28:30, 22.80s/epoch, loss=1.14, accuracy=0.756, val_loss=2.08, val_accuracy=0.503, lr=0.1] 36%|███▌      | 41/115 [16:14<28:06, 22.79s/epoch, loss=1.14, accuracy=0.755, val_loss=1.81, val_accuracy=0.553, lr=0.1] 37%|███▋      | 42/115 [16:37<27:45, 22.81s/epoch, loss=1.14, accuracy=0.757, val_loss=3.63, val_accuracy=0.323, lr=0.1] 37%|███▋      | 43/115 [17:00<27:24, 22.84s/epoch, loss=1.13, accuracy=0.754, val_loss=1.69, val_accuracy=0.576, lr=0.0316] 38%|███▊      | 44/115 [17:23<27:07, 22.93s/epoch, loss=1.13, accuracy=0.756, val_loss=1.93, val_accuracy=0.512, lr=0.1]    39%|███▉      | 45/115 [17:45<26:39, 22.84s/epoch, loss=1.14, accuracy=0.754, val_loss=1.42, val_accuracy=0.648, lr=0.1] 40%|████      | 46/115 [18:08<26:21, 22.92s/epoch, loss=1.13, accuracy=0.756, val_loss=1.77, val_accuracy=0.529, lr=0.1] 41%|████      | 47/115 [18:31<25:59, 22.93s/epoch, loss=1.14, accuracy=0.755, val_loss=1.79, val_accuracy=0.529, lr=0.1] 42%|████▏     | 48/115 [18:54<25:36, 22.93s/epoch, loss=1.14, accuracy=0.754, val_loss=2.34, val_accuracy=0.367, lr=0.0316] 43%|████▎     | 49/115 [19:17<25:12, 22.92s/epoch, loss=1.14, accuracy=0.754, val_loss=4.05, val_accuracy=0.251, lr=0.1]    43%|████▎     | 50/115 [19:40<24:48, 22.91s/epoch, loss=1.13, accuracy=0.759, val_loss=2.05, val_accuracy=0.52, lr=0.1]  44%|████▍     | 51/115 [20:03<24:29, 22.97s/epoch, loss=1.14, accuracy=0.755, val_loss=2.46, val_accuracy=0.387, lr=0.1] 45%|████▌     | 52/115 [20:26<23:59, 22.85s/epoch, loss=1.12, accuracy=0.758, val_loss=1.66, val_accuracy=0.569, lr=0.1] 46%|████▌     | 53/115 [20:49<23:37, 22.86s/epoch, loss=1.13, accuracy=0.757, val_loss=1.53, val_accuracy=0.588, lr=0.0316] 47%|████▋     | 54/115 [21:11<23:14, 22.86s/epoch, loss=1.13, accuracy=0.757, val_loss=1.54, val_accuracy=0.61, lr=0.1]     48%|████▊     | 55/115 [21:34<22:52, 22.87s/epoch, loss=1.13, accuracy=0.756, val_loss=1.53, val_accuracy=0.609, lr=0.1] 49%|████▊     | 56/115 [21:57<22:26, 22.83s/epoch, loss=1.13, accuracy=0.757, val_loss=2.22, val_accuracy=0.459, lr=0.1] 50%|████▉     | 57/115 [22:20<22:05, 22.85s/epoch, loss=1.13, accuracy=0.755, val_loss=1.74, val_accuracy=0.519, lr=0.1] 50%|█████     | 58/115 [22:43<21:42, 22.85s/epoch, loss=1.12, accuracy=0.758, val_loss=1.82, val_accuracy=0.515, lr=0.0316] 51%|█████▏    | 59/115 [23:06<21:23, 22.93s/epoch, loss=1.12, accuracy=0.757, val_loss=1.7, val_accuracy=0.552, lr=0.1]     52%|█████▏    | 60/115 [23:29<20:57, 22.87s/epoch, loss=1.12, accuracy=0.757, val_loss=1.85, val_accuracy=0.545, lr=0.1] 53%|█████▎    | 61/115 [23:51<20:31, 22.81s/epoch, loss=1.13, accuracy=0.755, val_loss=2.44, val_accuracy=0.465, lr=0.1] 54%|█████▍    | 62/115 [24:14<20:04, 22.73s/epoch, loss=1.12, accuracy=0.756, val_loss=1.94, val_accuracy=0.492, lr=0.1] 55%|█████▍    | 63/115 [24:37<19:41, 22.73s/epoch, loss=1.12, accuracy=0.757, val_loss=1.35, val_accuracy=0.664, lr=0.1] 56%|█████▌    | 64/115 [24:59<19:21, 22.77s/epoch, loss=1.11, accuracy=0.758, val_loss=3.2, val_accuracy=0.294, lr=0.1]  57%|█████▋    | 65/115 [25:22<18:59, 22.80s/epoch, loss=1.12, accuracy=0.756, val_loss=2.77, val_accuracy=0.45, lr=0.1] 57%|█████▋    | 66/115 [25:45<18:37, 22.81s/epoch, loss=1.12, accuracy=0.757, val_loss=2.64, val_accuracy=0.444, lr=0.1] 58%|█████▊    | 67/115 [26:08<18:13, 22.79s/epoch, loss=1.12, accuracy=0.756, val_loss=1.77, val_accuracy=0.563, lr=0.1] 59%|█████▉    | 68/115 [26:31<17:50, 22.78s/epoch, loss=1.12, accuracy=0.758, val_loss=1.66, val_accuracy=0.597, lr=0.0316] 60%|██████    | 69/115 [26:53<17:24, 22.71s/epoch, loss=1.12, accuracy=0.756, val_loss=2.51, val_accuracy=0.344, lr=0.1]    61%|██████    | 70/115 [27:16<17:06, 22.81s/epoch, loss=1.12, accuracy=0.757, val_loss=1.6, val_accuracy=0.604, lr=0.1]  62%|██████▏   | 71/115 [27:39<16:45, 22.85s/epoch, loss=1.13, accuracy=0.758, val_loss=2.56, val_accuracy=0.456, lr=0.1] 63%|██████▎   | 72/115 [28:02<16:20, 22.81s/epoch, loss=1.11, accuracy=0.76, val_loss=2.16, val_accuracy=0.464, lr=0.1]  63%|██████▎   | 73/115 [28:24<15:54, 22.73s/epoch, loss=1.13, accuracy=0.758, val_loss=2.33, val_accuracy=0.371, lr=0.0316] 64%|██████▍   | 74/115 [28:47<15:31, 22.72s/epoch, loss=1.12, accuracy=0.757, val_loss=1.93, val_accuracy=0.529, lr=0.1]    65%|██████▌   | 75/115 [29:10<15:11, 22.79s/epoch, loss=1.12, accuracy=0.758, val_loss=1.66, val_accuracy=0.622, lr=0.1] 66%|██████▌   | 76/115 [29:33<14:51, 22.86s/epoch, loss=1.13, accuracy=0.755, val_loss=1.99, val_accuracy=0.503, lr=0.1] 67%|██████▋   | 77/115 [29:56<14:29, 22.89s/epoch, loss=1.11, accuracy=0.759, val_loss=1.55, val_accuracy=0.6, lr=0.1]   68%|██████▊   | 78/115 [30:19<14:05, 22.85s/epoch, loss=1.12, accuracy=0.759, val_loss=1.89, val_accuracy=0.55, lr=0.0316] 69%|██████▊   | 79/115 [30:42<13:43, 22.88s/epoch, loss=1.12, accuracy=0.756, val_loss=1.4, val_accuracy=0.642, lr=0.1]    70%|██████▉   | 80/115 [31:05<13:21, 22.91s/epoch, loss=1.12, accuracy=0.756, val_loss=2.58, val_accuracy=0.428, lr=0.1] 70%|███████   | 81/115 [31:28<12:59, 22.91s/epoch, loss=1.12, accuracy=0.76, val_loss=1.53, val_accuracy=0.638, lr=0.1]  71%|███████▏  | 82/115 [31:51<12:36, 22.93s/epoch, loss=0.9, accuracy=0.817, val_loss=0.915, val_accuracy=0.796, lr=0.01] 72%|███████▏  | 83/115 [32:14<12:13, 22.93s/epoch, loss=0.726, accuracy=0.848, val_loss=0.86, val_accuracy=0.791, lr=0.01] 73%|███████▎  | 84/115 [32:36<11:46, 22.80s/epoch, loss=0.647, accuracy=0.855, val_loss=0.732, val_accuracy=0.823, lr=0.01] 74%|███████▍  | 85/115 [32:59<11:23, 22.78s/epoch, loss=0.606, accuracy=0.858, val_loss=0.742, val_accuracy=0.809, lr=0.01] 75%|███████▍  | 86/115 [33:21<10:57, 22.69s/epoch, loss=0.585, accuracy=0.86, val_loss=0.746, val_accuracy=0.808, lr=0.01]  76%|███████▌  | 87/115 [33:44<10:32, 22.59s/epoch, loss=0.573, accuracy=0.862, val_loss=0.961, val_accuracy=0.743, lr=0.01] 77%|███████▋  | 88/115 [34:07<10:11, 22.66s/epoch, loss=0.567, accuracy=0.865, val_loss=0.813, val_accuracy=0.789, lr=0.01] 77%|███████▋  | 89/115 [34:29<09:51, 22.74s/epoch, loss=0.563, accuracy=0.865, val_loss=0.724, val_accuracy=0.818, lr=0.01] 78%|███████▊  | 90/115 [34:52<09:29, 22.77s/epoch, loss=0.562, accuracy=0.866, val_loss=0.939, val_accuracy=0.756, lr=0.01] 79%|███████▉  | 91/115 [35:15<09:06, 22.79s/epoch, loss=0.557, accuracy=0.87, val_loss=0.92, val_accuracy=0.766, lr=0.01]   80%|████████  | 92/115 [35:38<08:43, 22.77s/epoch, loss=0.559, accuracy=0.87, val_loss=1, val_accuracy=0.748, lr=0.01]    81%|████████  | 93/115 [36:00<08:19, 22.71s/epoch, loss=0.557, accuracy=0.871, val_loss=0.703, val_accuracy=0.82, lr=0.01] 82%|████████▏ | 94/115 [36:23<07:58, 22.77s/epoch, loss=0.557, accuracy=0.873, val_loss=0.918, val_accuracy=0.77, lr=0.01] 83%|████████▎ | 95/115 [36:46<07:35, 22.77s/epoch, loss=0.557, accuracy=0.873, val_loss=0.787, val_accuracy=0.8, lr=0.01]  83%|████████▎ | 96/115 [37:09<07:11, 22.73s/epoch, loss=0.558, accuracy=0.874, val_loss=1.06, val_accuracy=0.72, lr=0.01] 84%|████████▍ | 97/115 [37:31<06:48, 22.70s/epoch, loss=0.56, accuracy=0.873, val_loss=0.764, val_accuracy=0.811, lr=0.01] 85%|████████▌ | 98/115 [37:54<06:24, 22.61s/epoch, loss=0.552, accuracy=0.878, val_loss=0.864, val_accuracy=0.771, lr=0.00316] 86%|████████▌ | 99/115 [38:17<06:02, 22.64s/epoch, loss=0.556, accuracy=0.876, val_loss=0.871, val_accuracy=0.784, lr=0.01]    87%|████████▋ | 100/115 [38:39<05:40, 22.69s/epoch, loss=0.555, accuracy=0.878, val_loss=0.768, val_accuracy=0.808, lr=0.01] 88%|████████▊ | 101/115 [39:02<05:18, 22.78s/epoch, loss=0.556, accuracy=0.879, val_loss=0.953, val_accuracy=0.768, lr=0.01] 89%|████████▊ | 102/115 [39:25<04:56, 22.80s/epoch, loss=0.559, accuracy=0.877, val_loss=0.867, val_accuracy=0.782, lr=0.01] 90%|████████▉ | 103/115 [39:48<04:33, 22.83s/epoch, loss=0.556, accuracy=0.878, val_loss=1.03, val_accuracy=0.736, lr=0.00316] 90%|█████████ | 104/115 [40:10<04:09, 22.70s/epoch, loss=0.552, accuracy=0.879, val_loss=0.816, val_accuracy=0.8, lr=0.01]     91%|█████████▏| 105/115 [40:33<03:46, 22.62s/epoch, loss=0.549, accuracy=0.882, val_loss=0.794, val_accuracy=0.804, lr=0.01] 92%|█████████▏| 106/115 [40:56<03:23, 22.63s/epoch, loss=0.558, accuracy=0.878, val_loss=1.01, val_accuracy=0.743, lr=0.01]  93%|█████████▎| 107/115 [41:18<03:01, 22.73s/epoch, loss=0.557, accuracy=0.88, val_loss=0.756, val_accuracy=0.815, lr=0.01] 94%|█████████▍| 108/115 [41:41<02:38, 22.70s/epoch, loss=0.557, accuracy=0.88, val_loss=0.982, val_accuracy=0.757, lr=0.00316] 95%|█████████▍| 109/115 [42:03<02:15, 22.55s/epoch, loss=0.557, accuracy=0.881, val_loss=0.793, val_accuracy=0.805, lr=0.01]   96%|█████████▌| 110/115 [42:26<01:52, 22.58s/epoch, loss=0.556, accuracy=0.881, val_loss=0.824, val_accuracy=0.798, lr=0.01] 97%|█████████▋| 111/115 [42:49<01:30, 22.67s/epoch, loss=0.553, accuracy=0.883, val_loss=0.966, val_accuracy=0.758, lr=0.01] 97%|█████████▋| 112/115 [43:12<01:08, 22.74s/epoch, loss=0.556, accuracy=0.882, val_loss=1.45, val_accuracy=0.662, lr=0.01]  98%|█████████▊| 113/115 [43:34<00:45, 22.65s/epoch, loss=0.558, accuracy=0.88, val_loss=1.09, val_accuracy=0.734, lr=0.00316] 99%|█████████▉| 114/115 [43:56<00:22, 22.52s/epoch, loss=0.555, accuracy=0.884, val_loss=0.869, val_accuracy=0.775, lr=0.01] 100%|██████████| 115/115 [44:19<00:00, 22.57s/epoch, loss=0.554, accuracy=0.883, val_loss=1.1, val_accuracy=0.758, lr=0.01]  100%|██████████| 115/115 [44:19<00:00, 23.13s/epoch, loss=0.554, accuracy=0.883, val_loss=1.1, val_accuracy=0.758, lr=0.01]
Using real-time data augmentation.
Test loss: 1.0963082313537598
Test accuracy: 0.7577000260353088


* * * Run SGD for ID = 13_2. * * *


2024-02-15 13:42:42.131953: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 13:42:44.587557: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 13:42:44.588751: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-15 13:42:44.624071: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-02-15 13:42:44.624133: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 13:42:44.626874: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 13:42:44.626911: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 13:42:44.629532: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 13:42:44.630235: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 13:42:44.632562: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 13:42:44.633927: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 13:42:44.638589: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 13:42:44.639072: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 13:42:44.639147: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 13:42:45.875941: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-15 13:42:45.876962: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 13:42:45.878304: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-02-15 13:42:45.878340: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 13:42:45.878447: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 13:42:45.878474: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 13:42:45.878500: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 13:42:45.878526: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 13:42:45.878551: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 13:42:45.878575: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 13:42:45.878601: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 13:42:45.879027: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 13:42:45.879060: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 13:42:46.511592: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-15 13:42:46.511643: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-15 13:42:46.511660: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-15 13:42:46.512594: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11227 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN X (Pascal), pci bus id: 0000:03:00.0, compute capability: 6.1)
{'id': 132, 'batch_size': 128, 'epochs': 115, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN X (Pascal)'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/115 [00:00<?, ?epoch/s]2024-02-15 13:42:47.292049: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-15 13:42:47.304419: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2599900000 Hz
2024-02-15 13:42:49.151135: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 13:42:49.385024: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 13:42:50.175121: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-15 13:42:50.225222: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/115 [00:57<1:49:59, 57.89s/epoch, loss=3.15, accuracy=0.294, val_loss=3.35, val_accuracy=0.165, lr=0.1]  2%|▏         | 2/115 [01:20<1:10:02, 37.19s/epoch, loss=1.6, accuracy=0.51, val_loss=1.65, val_accuracy=0.513, lr=0.1]    3%|▎         | 3/115 [01:43<57:08, 30.61s/epoch, loss=1.38, accuracy=0.62, val_loss=3.74, val_accuracy=0.271, lr=0.1]   3%|▎         | 4/115 [02:05<50:44, 27.43s/epoch, loss=1.29, accuracy=0.671, val_loss=1.9, val_accuracy=0.454, lr=0.1]  4%|▍         | 5/115 [02:28<47:14, 25.76s/epoch, loss=1.25, accuracy=0.694, val_loss=2.06, val_accuracy=0.501, lr=0.1]  5%|▌         | 6/115 [02:51<44:56, 24.74s/epoch, loss=1.23, accuracy=0.707, val_loss=2.02, val_accuracy=0.533, lr=0.1]  6%|▌         | 7/115 [03:14<43:20, 24.07s/epoch, loss=1.23, accuracy=0.715, val_loss=2.9, val_accuracy=0.355, lr=0.0316]  7%|▋         | 8/115 [03:36<42:06, 23.61s/epoch, loss=1.22, accuracy=0.722, val_loss=3.02, val_accuracy=0.264, lr=0.1]    8%|▊         | 9/115 [03:59<41:02, 23.23s/epoch, loss=1.22, accuracy=0.725, val_loss=1.86, val_accuracy=0.517, lr=0.1]  9%|▊         | 10/115 [04:22<40:26, 23.11s/epoch, loss=1.22, accuracy=0.727, val_loss=1.84, val_accuracy=0.54, lr=0.1] 10%|▉         | 11/115 [04:44<39:49, 22.97s/epoch, loss=1.2, accuracy=0.732, val_loss=1.46, val_accuracy=0.644, lr=0.1] 10%|█         | 12/115 [05:07<39:18, 22.90s/epoch, loss=1.2, accuracy=0.735, val_loss=2.28, val_accuracy=0.479, lr=0.1] 11%|█▏        | 13/115 [05:29<38:45, 22.80s/epoch, loss=1.2, accuracy=0.736, val_loss=3.14, val_accuracy=0.343, lr=0.1] 12%|█▏        | 14/115 [05:52<38:16, 22.74s/epoch, loss=1.2, accuracy=0.738, val_loss=2.01, val_accuracy=0.465, lr=0.1] 13%|█▎        | 15/115 [06:15<37:56, 22.77s/epoch, loss=1.2, accuracy=0.737, val_loss=1.54, val_accuracy=0.629, lr=0.1] 14%|█▍        | 16/115 [06:38<37:32, 22.76s/epoch, loss=1.2, accuracy=0.74, val_loss=1.65, val_accuracy=0.611, lr=0.0316] 15%|█▍        | 17/115 [07:00<37:05, 22.71s/epoch, loss=1.19, accuracy=0.74, val_loss=1.9, val_accuracy=0.531, lr=0.1]    16%|█▌        | 18/115 [07:23<36:40, 22.69s/epoch, loss=1.19, accuracy=0.744, val_loss=2.55, val_accuracy=0.399, lr=0.1] 17%|█▋        | 19/115 [07:46<36:20, 22.72s/epoch, loss=1.19, accuracy=0.742, val_loss=1.9, val_accuracy=0.469, lr=0.1]  17%|█▋        | 20/115 [08:08<35:43, 22.57s/epoch, loss=1.18, accuracy=0.745, val_loss=1.92, val_accuracy=0.463, lr=0.1] 18%|█▊        | 21/115 [08:30<35:17, 22.52s/epoch, loss=1.18, accuracy=0.745, val_loss=1.54, val_accuracy=0.633, lr=0.0316] 19%|█▉        | 22/115 [08:52<34:45, 22.42s/epoch, loss=1.18, accuracy=0.746, val_loss=2.18, val_accuracy=0.464, lr=0.1]    20%|██        | 23/115 [09:15<34:29, 22.49s/epoch, loss=1.18, accuracy=0.747, val_loss=2.72, val_accuracy=0.427, lr=0.1] 21%|██        | 24/115 [09:38<34:14, 22.57s/epoch, loss=1.17, accuracy=0.747, val_loss=1.54, val_accuracy=0.603, lr=0.1] 22%|██▏       | 25/115 [10:01<33:52, 22.59s/epoch, loss=1.17, accuracy=0.746, val_loss=1.9, val_accuracy=0.494, lr=0.1]  23%|██▎       | 26/115 [10:23<33:36, 22.66s/epoch, loss=1.17, accuracy=0.745, val_loss=2.97, val_accuracy=0.3, lr=0.0316] 23%|██▎       | 27/115 [10:46<33:11, 22.63s/epoch, loss=1.16, accuracy=0.748, val_loss=1.73, val_accuracy=0.544, lr=0.1]  24%|██▍       | 28/115 [11:09<32:50, 22.65s/epoch, loss=1.16, accuracy=0.749, val_loss=1.79, val_accuracy=0.59, lr=0.1]  25%|██▌       | 29/115 [11:31<32:29, 22.67s/epoch, loss=1.16, accuracy=0.749, val_loss=1.52, val_accuracy=0.633, lr=0.1] 26%|██▌       | 30/115 [11:54<32:13, 22.75s/epoch, loss=1.16, accuracy=0.752, val_loss=2.12, val_accuracy=0.539, lr=0.1] 27%|██▋       | 31/115 [12:17<31:51, 22.76s/epoch, loss=1.16, accuracy=0.751, val_loss=2.36, val_accuracy=0.455, lr=0.0316] 28%|██▊       | 32/115 [12:40<31:33, 22.81s/epoch, loss=1.16, accuracy=0.75, val_loss=3.14, val_accuracy=0.366, lr=0.1]     29%|██▊       | 33/115 [13:03<31:09, 22.79s/epoch, loss=1.16, accuracy=0.749, val_loss=1.96, val_accuracy=0.539, lr=0.1] 30%|██▉       | 34/115 [13:25<30:33, 22.64s/epoch, loss=1.15, accuracy=0.75, val_loss=1.69, val_accuracy=0.612, lr=0.1]  30%|███       | 35/115 [13:48<30:15, 22.69s/epoch, loss=1.16, accuracy=0.751, val_loss=3.42, val_accuracy=0.357, lr=0.1] 31%|███▏      | 36/115 [14:11<29:53, 22.70s/epoch, loss=1.15, accuracy=0.751, val_loss=1.37, val_accuracy=0.684, lr=0.1] 32%|███▏      | 37/115 [14:33<29:29, 22.69s/epoch, loss=1.15, accuracy=0.752, val_loss=2.19, val_accuracy=0.441, lr=0.1] 33%|███▎      | 38/115 [14:56<29:10, 22.73s/epoch, loss=1.15, accuracy=0.752, val_loss=3.83, val_accuracy=0.214, lr=0.1] 34%|███▍      | 39/115 [15:19<28:47, 22.74s/epoch, loss=1.15, accuracy=0.752, val_loss=1.76, val_accuracy=0.529, lr=0.1] 35%|███▍      | 40/115 [15:42<28:30, 22.80s/epoch, loss=1.15, accuracy=0.753, val_loss=1.69, val_accuracy=0.575, lr=0.1] 36%|███▌      | 41/115 [16:04<28:06, 22.78s/epoch, loss=1.15, accuracy=0.75, val_loss=5.62, val_accuracy=0.232, lr=0.0316] 37%|███▋      | 42/115 [16:27<27:39, 22.74s/epoch, loss=1.15, accuracy=0.753, val_loss=2.32, val_accuracy=0.454, lr=0.1]   37%|███▋      | 43/115 [16:50<27:18, 22.76s/epoch, loss=1.15, accuracy=0.752, val_loss=2.2, val_accuracy=0.476, lr=0.1]  38%|███▊      | 44/115 [17:13<27:01, 22.83s/epoch, loss=1.15, accuracy=0.75, val_loss=3.22, val_accuracy=0.308, lr=0.1] 39%|███▉      | 45/115 [17:36<26:36, 22.81s/epoch, loss=1.15, accuracy=0.753, val_loss=1.66, val_accuracy=0.573, lr=0.1] 40%|████      | 46/115 [17:59<26:15, 22.84s/epoch, loss=1.15, accuracy=0.753, val_loss=1.74, val_accuracy=0.553, lr=0.0316] 41%|████      | 47/115 [18:21<25:48, 22.78s/epoch, loss=1.14, accuracy=0.751, val_loss=1.44, val_accuracy=0.632, lr=0.1]    42%|████▏     | 48/115 [18:44<25:24, 22.75s/epoch, loss=1.14, accuracy=0.755, val_loss=2.32, val_accuracy=0.449, lr=0.1] 43%|████▎     | 49/115 [19:06<24:57, 22.69s/epoch, loss=1.14, accuracy=0.754, val_loss=2.16, val_accuracy=0.447, lr=0.1] 43%|████▎     | 50/115 [19:29<24:37, 22.73s/epoch, loss=1.14, accuracy=0.755, val_loss=2.6, val_accuracy=0.424, lr=0.1]  44%|████▍     | 51/115 [19:52<24:15, 22.74s/epoch, loss=1.14, accuracy=0.756, val_loss=2.38, val_accuracy=0.363, lr=0.0316] 45%|████▌     | 52/115 [20:15<23:56, 22.81s/epoch, loss=1.14, accuracy=0.754, val_loss=1.5, val_accuracy=0.628, lr=0.1]     46%|████▌     | 53/115 [20:38<23:33, 22.80s/epoch, loss=1.14, accuracy=0.754, val_loss=1.6, val_accuracy=0.609, lr=0.1] 47%|████▋     | 54/115 [20:59<22:49, 22.45s/epoch, loss=1.13, accuracy=0.754, val_loss=1.91, val_accuracy=0.506, lr=0.1] 48%|████▊     | 55/115 [21:22<22:32, 22.55s/epoch, loss=1.14, accuracy=0.754, val_loss=2.02, val_accuracy=0.495, lr=0.1] 49%|████▊     | 56/115 [21:45<22:15, 22.64s/epoch, loss=1.14, accuracy=0.754, val_loss=1.53, val_accuracy=0.608, lr=0.0316] 50%|████▉     | 57/115 [22:08<21:56, 22.70s/epoch, loss=1.15, accuracy=0.755, val_loss=1.81, val_accuracy=0.55, lr=0.1]     50%|█████     | 58/115 [22:31<21:37, 22.77s/epoch, loss=1.14, accuracy=0.756, val_loss=1.72, val_accuracy=0.594, lr=0.1] 51%|█████▏    | 59/115 [22:53<21:10, 22.69s/epoch, loss=1.14, accuracy=0.755, val_loss=4.81, val_accuracy=0.237, lr=0.1] 52%|█████▏    | 60/115 [23:16<20:49, 22.71s/epoch, loss=1.13, accuracy=0.757, val_loss=1.8, val_accuracy=0.521, lr=0.1]  53%|█████▎    | 61/115 [23:39<20:23, 22.67s/epoch, loss=1.14, accuracy=0.756, val_loss=2.16, val_accuracy=0.421, lr=0.0316] 54%|█████▍    | 62/115 [24:01<19:55, 22.55s/epoch, loss=1.14, accuracy=0.753, val_loss=2.15, val_accuracy=0.493, lr=0.1]    55%|█████▍    | 63/115 [24:24<19:35, 22.60s/epoch, loss=1.13, accuracy=0.756, val_loss=1.76, val_accuracy=0.516, lr=0.1] 56%|█████▌    | 64/115 [24:46<19:10, 22.57s/epoch, loss=1.13, accuracy=0.756, val_loss=1.92, val_accuracy=0.491, lr=0.1] 57%|█████▋    | 65/115 [25:08<18:31, 22.23s/epoch, loss=1.13, accuracy=0.757, val_loss=2.19, val_accuracy=0.459, lr=0.1] 57%|█████▋    | 66/115 [25:30<18:11, 22.27s/epoch, loss=1.14, accuracy=0.757, val_loss=1.99, val_accuracy=0.516, lr=0.0316] 58%|█████▊    | 67/115 [25:52<17:48, 22.26s/epoch, loss=1.13, accuracy=0.756, val_loss=1.36, val_accuracy=0.677, lr=0.1]    59%|█████▉    | 68/115 [26:15<17:29, 22.33s/epoch, loss=1.12, accuracy=0.758, val_loss=3.68, val_accuracy=0.255, lr=0.1] 60%|██████    | 69/115 [26:37<17:07, 22.34s/epoch, loss=1.13, accuracy=0.757, val_loss=3.5, val_accuracy=0.322, lr=0.1]  61%|██████    | 70/115 [27:00<16:50, 22.45s/epoch, loss=1.12, accuracy=0.755, val_loss=2.05, val_accuracy=0.471, lr=0.1] 62%|██████▏   | 71/115 [27:22<16:25, 22.40s/epoch, loss=1.13, accuracy=0.754, val_loss=1.84, val_accuracy=0.529, lr=0.1] 63%|██████▎   | 72/115 [27:45<16:04, 22.43s/epoch, loss=1.13, accuracy=0.757, val_loss=1.52, val_accuracy=0.642, lr=0.0316] 63%|██████▎   | 73/115 [28:07<15:45, 22.52s/epoch, loss=1.12, accuracy=0.757, val_loss=2.13, val_accuracy=0.449, lr=0.1]    64%|██████▍   | 74/115 [28:30<15:23, 22.51s/epoch, loss=1.12, accuracy=0.757, val_loss=1.71, val_accuracy=0.56, lr=0.1]  65%|██████▌   | 75/115 [28:53<15:03, 22.58s/epoch, loss=1.12, accuracy=0.759, val_loss=1.84, val_accuracy=0.561, lr=0.1] 66%|██████▌   | 76/115 [29:15<14:42, 22.63s/epoch, loss=1.12, accuracy=0.758, val_loss=2.23, val_accuracy=0.505, lr=0.1] 67%|██████▋   | 77/115 [29:38<14:21, 22.68s/epoch, loss=1.12, accuracy=0.757, val_loss=1.85, val_accuracy=0.569, lr=0.0316] 68%|██████▊   | 78/115 [29:59<13:45, 22.31s/epoch, loss=1.12, accuracy=0.759, val_loss=1.75, val_accuracy=0.543, lr=0.1]    69%|██████▊   | 79/115 [30:22<13:27, 22.43s/epoch, loss=1.12, accuracy=0.759, val_loss=1.99, val_accuracy=0.486, lr=0.1] 70%|██████▉   | 80/115 [30:45<13:06, 22.48s/epoch, loss=1.12, accuracy=0.757, val_loss=1.68, val_accuracy=0.576, lr=0.1] 70%|███████   | 81/115 [31:07<12:41, 22.41s/epoch, loss=1.13, accuracy=0.757, val_loss=2.37, val_accuracy=0.446, lr=0.1] 71%|███████▏  | 82/115 [31:29<12:19, 22.42s/epoch, loss=0.91, accuracy=0.817, val_loss=0.903, val_accuracy=0.8, lr=0.01] 72%|███████▏  | 83/115 [31:52<11:58, 22.46s/epoch, loss=0.73, accuracy=0.85, val_loss=0.805, val_accuracy=0.811, lr=0.01] 73%|███████▎  | 84/115 [32:14<11:34, 22.41s/epoch, loss=0.648, accuracy=0.858, val_loss=0.849, val_accuracy=0.782, lr=0.01] 74%|███████▍  | 85/115 [32:37<11:13, 22.45s/epoch, loss=0.606, accuracy=0.862, val_loss=0.725, val_accuracy=0.81, lr=0.01]  75%|███████▍  | 86/115 [32:59<10:51, 22.45s/epoch, loss=0.584, accuracy=0.862, val_loss=0.717, val_accuracy=0.815, lr=0.01] 76%|███████▌  | 87/115 [33:22<10:29, 22.47s/epoch, loss=0.576, accuracy=0.862, val_loss=0.731, val_accuracy=0.814, lr=0.01] 77%|███████▋  | 88/115 [33:44<10:06, 22.47s/epoch, loss=0.566, accuracy=0.864, val_loss=0.789, val_accuracy=0.799, lr=0.01] 77%|███████▋  | 89/115 [34:07<09:43, 22.45s/epoch, loss=0.566, accuracy=0.865, val_loss=0.836, val_accuracy=0.786, lr=0.01] 78%|███████▊  | 90/115 [34:29<09:19, 22.36s/epoch, loss=0.56, accuracy=0.866, val_loss=0.912, val_accuracy=0.755, lr=0.01]  79%|███████▉  | 91/115 [34:51<08:57, 22.40s/epoch, loss=0.558, accuracy=0.869, val_loss=0.698, val_accuracy=0.824, lr=0.01] 80%|████████  | 92/115 [35:14<08:34, 22.37s/epoch, loss=0.559, accuracy=0.871, val_loss=0.772, val_accuracy=0.805, lr=0.01] 81%|████████  | 93/115 [35:36<08:13, 22.45s/epoch, loss=0.556, accuracy=0.872, val_loss=0.761, val_accuracy=0.797, lr=0.01] 82%|████████▏ | 94/115 [35:59<07:52, 22.50s/epoch, loss=0.554, accuracy=0.873, val_loss=0.767, val_accuracy=0.809, lr=0.01] 83%|████████▎ | 95/115 [36:21<07:29, 22.48s/epoch, loss=0.555, accuracy=0.876, val_loss=0.868, val_accuracy=0.785, lr=0.01] 83%|████████▎ | 96/115 [36:44<07:06, 22.44s/epoch, loss=0.554, accuracy=0.874, val_loss=0.832, val_accuracy=0.776, lr=0.00316] 84%|████████▍ | 97/115 [37:06<06:44, 22.45s/epoch, loss=0.549, accuracy=0.878, val_loss=0.753, val_accuracy=0.818, lr=0.01]    85%|████████▌ | 98/115 [37:28<06:20, 22.38s/epoch, loss=0.55, accuracy=0.878, val_loss=0.793, val_accuracy=0.804, lr=0.01]  86%|████████▌ | 99/115 [37:51<05:57, 22.37s/epoch, loss=0.553, accuracy=0.877, val_loss=0.791, val_accuracy=0.794, lr=0.01] 87%|████████▋ | 100/115 [38:13<05:36, 22.43s/epoch, loss=0.551, accuracy=0.877, val_loss=0.745, val_accuracy=0.815, lr=0.01] 88%|████████▊ | 101/115 [38:36<05:13, 22.42s/epoch, loss=0.55, accuracy=0.877, val_loss=0.922, val_accuracy=0.776, lr=0.00316] 89%|████████▊ | 102/115 [38:58<04:49, 22.26s/epoch, loss=0.551, accuracy=0.88, val_loss=0.842, val_accuracy=0.796, lr=0.01]    90%|████████▉ | 103/115 [39:20<04:27, 22.28s/epoch, loss=0.552, accuracy=0.879, val_loss=1.44, val_accuracy=0.67, lr=0.01]  90%|█████████ | 104/115 [39:42<04:05, 22.34s/epoch, loss=0.549, accuracy=0.881, val_loss=0.836, val_accuracy=0.782, lr=0.01] 91%|█████████▏| 105/115 [40:05<03:43, 22.37s/epoch, loss=0.55, accuracy=0.881, val_loss=0.764, val_accuracy=0.813, lr=0.01]  92%|█████████▏| 106/115 [40:27<03:20, 22.27s/epoch, loss=0.551, accuracy=0.882, val_loss=0.892, val_accuracy=0.785, lr=0.00316] 93%|█████████▎| 107/115 [40:49<02:58, 22.29s/epoch, loss=0.553, accuracy=0.88, val_loss=0.891, val_accuracy=0.778, lr=0.01]     94%|█████████▍| 108/115 [41:12<02:36, 22.37s/epoch, loss=0.552, accuracy=0.882, val_loss=0.839, val_accuracy=0.791, lr=0.01] 95%|█████████▍| 109/115 [41:34<02:13, 22.27s/epoch, loss=0.551, accuracy=0.883, val_loss=0.928, val_accuracy=0.782, lr=0.01] 96%|█████████▌| 110/115 [41:56<01:51, 22.24s/epoch, loss=0.549, accuracy=0.883, val_loss=1.04, val_accuracy=0.76, lr=0.01]   97%|█████████▋| 111/115 [42:18<01:29, 22.32s/epoch, loss=0.55, accuracy=0.882, val_loss=0.746, val_accuracy=0.823, lr=0.00316] 97%|█████████▋| 112/115 [42:41<01:06, 22.28s/epoch, loss=0.553, accuracy=0.883, val_loss=0.895, val_accuracy=0.78, lr=0.01]    98%|█████████▊| 113/115 [43:03<00:44, 22.21s/epoch, loss=0.549, accuracy=0.885, val_loss=0.889, val_accuracy=0.775, lr=0.01] 99%|█████████▉| 114/115 [43:25<00:22, 22.23s/epoch, loss=0.55, accuracy=0.885, val_loss=0.825, val_accuracy=0.799, lr=0.01] 100%|██████████| 115/115 [43:48<00:00, 22.32s/epoch, loss=0.549, accuracy=0.885, val_loss=1.16, val_accuracy=0.715, lr=0.01]100%|██████████| 115/115 [43:48<00:00, 22.85s/epoch, loss=0.549, accuracy=0.885, val_loss=1.16, val_accuracy=0.715, lr=0.01]
Using real-time data augmentation.
Test loss: 1.1643478870391846
Test accuracy: 0.7153000235557556


* * * Run SGD for ID = 13_3. * * *


2024-02-15 14:26:37.576698: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 14:26:40.271885: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 14:26:40.272998: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-15 14:26:40.307718: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-02-15 14:26:40.307744: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 14:26:40.310447: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 14:26:40.310486: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 14:26:40.312762: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 14:26:40.313376: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 14:26:40.315658: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 14:26:40.317061: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 14:26:40.321533: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 14:26:40.321997: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 14:26:40.322077: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 14:26:41.497640: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-15 14:26:41.498772: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 14:26:41.500128: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-02-15 14:26:41.500169: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 14:26:41.500312: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 14:26:41.500341: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 14:26:41.500365: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 14:26:41.500388: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 14:26:41.500412: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 14:26:41.500436: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 14:26:41.500469: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 14:26:41.500900: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 14:26:41.500935: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 14:26:42.129711: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-15 14:26:42.129776: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-15 14:26:42.129786: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-15 14:26:42.131613: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11227 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN X (Pascal), pci bus id: 0000:03:00.0, compute capability: 6.1)
{'id': 133, 'batch_size': 128, 'epochs': 115, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN X (Pascal)'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/115 [00:00<?, ?epoch/s]2024-02-15 14:26:42.880966: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-15 14:26:42.893388: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2599900000 Hz
2024-02-15 14:26:44.701308: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 14:26:44.941668: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 14:26:45.710135: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-15 14:26:45.749676: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/115 [00:56<1:47:16, 56.46s/epoch, loss=3.13, accuracy=0.31, val_loss=2.83, val_accuracy=0.24, lr=0.1]  2%|▏         | 2/115 [01:19<1:09:09, 36.73s/epoch, loss=1.51, accuracy=0.558, val_loss=3.12, val_accuracy=0.302, lr=0.1]  3%|▎         | 3/115 [01:42<56:42, 30.38s/epoch, loss=1.3, accuracy=0.655, val_loss=1.79, val_accuracy=0.496, lr=0.1]     3%|▎         | 4/115 [02:05<50:56, 27.54s/epoch, loss=1.25, accuracy=0.686, val_loss=5.92, val_accuracy=0.165, lr=0.1]  4%|▍         | 5/115 [02:28<47:35, 25.96s/epoch, loss=1.23, accuracy=0.702, val_loss=1.92, val_accuracy=0.438, lr=0.1]  5%|▌         | 6/115 [02:51<45:21, 24.97s/epoch, loss=1.21, accuracy=0.711, val_loss=2.14, val_accuracy=0.451, lr=0.1]  6%|▌         | 7/115 [03:14<43:50, 24.35s/epoch, loss=1.2, accuracy=0.719, val_loss=1.75, val_accuracy=0.531, lr=0.1]   7%|▋         | 8/115 [03:37<42:42, 23.95s/epoch, loss=1.19, accuracy=0.725, val_loss=1.98, val_accuracy=0.512, lr=0.1]  8%|▊         | 9/115 [04:00<41:52, 23.71s/epoch, loss=1.19, accuracy=0.729, val_loss=2.09, val_accuracy=0.511, lr=0.1]  9%|▊         | 10/115 [04:23<40:58, 23.42s/epoch, loss=1.18, accuracy=0.734, val_loss=1.8, val_accuracy=0.543, lr=0.1] 10%|▉         | 11/115 [04:46<40:14, 23.22s/epoch, loss=1.17, accuracy=0.734, val_loss=4.24, val_accuracy=0.213, lr=0.1] 10%|█         | 12/115 [05:09<39:48, 23.19s/epoch, loss=1.16, accuracy=0.738, val_loss=1.47, val_accuracy=0.62, lr=0.1]  11%|█▏        | 13/115 [05:32<39:19, 23.13s/epoch, loss=1.17, accuracy=0.738, val_loss=1.83, val_accuracy=0.548, lr=0.1] 12%|█▏        | 14/115 [05:54<38:33, 22.91s/epoch, loss=1.16, accuracy=0.742, val_loss=2.54, val_accuracy=0.395, lr=0.1] 13%|█▎        | 15/115 [06:18<38:24, 23.04s/epoch, loss=1.16, accuracy=0.742, val_loss=1.89, val_accuracy=0.563, lr=0.1] 14%|█▍        | 16/115 [06:41<37:53, 22.97s/epoch, loss=1.15, accuracy=0.743, val_loss=3.12, val_accuracy=0.263, lr=0.1] 15%|█▍        | 17/115 [07:04<37:36, 23.03s/epoch, loss=1.15, accuracy=0.743, val_loss=1.92, val_accuracy=0.536, lr=0.0316] 16%|█▌        | 18/115 [07:27<37:13, 23.03s/epoch, loss=1.14, accuracy=0.747, val_loss=1.84, val_accuracy=0.566, lr=0.1]    17%|█▋        | 19/115 [07:50<36:54, 23.07s/epoch, loss=1.15, accuracy=0.745, val_loss=2.11, val_accuracy=0.485, lr=0.1] 17%|█▋        | 20/115 [08:13<36:21, 22.97s/epoch, loss=1.14, accuracy=0.747, val_loss=2.49, val_accuracy=0.333, lr=0.1] 18%|█▊        | 21/115 [08:36<35:54, 22.92s/epoch, loss=1.14, accuracy=0.748, val_loss=2.17, val_accuracy=0.454, lr=0.1] 19%|█▉        | 22/115 [08:58<35:30, 22.91s/epoch, loss=1.13, accuracy=0.753, val_loss=1.64, val_accuracy=0.605, lr=0.0316] 20%|██        | 23/115 [09:21<35:02, 22.86s/epoch, loss=1.14, accuracy=0.749, val_loss=2.13, val_accuracy=0.452, lr=0.1]    21%|██        | 24/115 [09:44<34:45, 22.92s/epoch, loss=1.14, accuracy=0.749, val_loss=1.74, val_accuracy=0.555, lr=0.1] 22%|██▏       | 25/115 [10:07<34:24, 22.94s/epoch, loss=1.13, accuracy=0.75, val_loss=1.78, val_accuracy=0.535, lr=0.1]  23%|██▎       | 26/115 [10:30<34:09, 23.02s/epoch, loss=1.14, accuracy=0.751, val_loss=1.59, val_accuracy=0.6, lr=0.1]  23%|██▎       | 27/115 [10:54<33:47, 23.04s/epoch, loss=1.14, accuracy=0.751, val_loss=1.74, val_accuracy=0.566, lr=0.0316] 24%|██▍       | 28/115 [11:17<33:24, 23.05s/epoch, loss=1.13, accuracy=0.752, val_loss=1.41, val_accuracy=0.666, lr=0.1]    25%|██▌       | 29/115 [11:40<32:59, 23.01s/epoch, loss=1.13, accuracy=0.752, val_loss=2.05, val_accuracy=0.523, lr=0.1] 26%|██▌       | 30/115 [12:03<32:41, 23.08s/epoch, loss=1.12, accuracy=0.752, val_loss=2.74, val_accuracy=0.46, lr=0.1]  27%|██▋       | 31/115 [12:26<32:17, 23.07s/epoch, loss=1.13, accuracy=0.755, val_loss=2.87, val_accuracy=0.356, lr=0.1] 28%|██▊       | 32/115 [12:49<31:53, 23.05s/epoch, loss=1.13, accuracy=0.754, val_loss=2.3, val_accuracy=0.419, lr=0.1]  29%|██▊       | 33/115 [13:12<31:30, 23.06s/epoch, loss=1.12, accuracy=0.755, val_loss=2.25, val_accuracy=0.444, lr=0.0316] 30%|██▉       | 34/115 [13:35<31:09, 23.08s/epoch, loss=1.12, accuracy=0.753, val_loss=1.91, val_accuracy=0.534, lr=0.1]    30%|███       | 35/115 [13:58<30:46, 23.08s/epoch, loss=1.12, accuracy=0.756, val_loss=2.38, val_accuracy=0.441, lr=0.1] 31%|███▏      | 36/115 [14:21<30:22, 23.07s/epoch, loss=1.12, accuracy=0.756, val_loss=1.65, val_accuracy=0.592, lr=0.1] 32%|███▏      | 37/115 [14:44<29:51, 22.97s/epoch, loss=1.11, accuracy=0.757, val_loss=2.73, val_accuracy=0.467, lr=0.1] 33%|███▎      | 38/115 [15:07<29:32, 23.03s/epoch, loss=1.12, accuracy=0.753, val_loss=2.11, val_accuracy=0.497, lr=0.0316] 34%|███▍      | 39/115 [15:30<29:10, 23.03s/epoch, loss=1.11, accuracy=0.756, val_loss=2.07, val_accuracy=0.428, lr=0.1]    35%|███▍      | 40/115 [15:53<28:47, 23.03s/epoch, loss=1.12, accuracy=0.753, val_loss=2.56, val_accuracy=0.467, lr=0.1] 36%|███▌      | 41/115 [16:16<28:25, 23.04s/epoch, loss=1.11, accuracy=0.757, val_loss=1.66, val_accuracy=0.572, lr=0.1] 37%|███▋      | 42/115 [16:39<27:59, 23.01s/epoch, loss=1.12, accuracy=0.756, val_loss=1.43, val_accuracy=0.65, lr=0.1]  37%|███▋      | 43/115 [17:02<27:36, 23.00s/epoch, loss=1.11, accuracy=0.755, val_loss=2.21, val_accuracy=0.461, lr=0.0316] 38%|███▊      | 44/115 [17:25<27:12, 22.99s/epoch, loss=1.11, accuracy=0.758, val_loss=1.75, val_accuracy=0.538, lr=0.1]    39%|███▉      | 45/115 [17:48<26:47, 22.97s/epoch, loss=1.11, accuracy=0.757, val_loss=4.06, val_accuracy=0.34, lr=0.1]  40%|████      | 46/115 [18:11<26:23, 22.95s/epoch, loss=1.11, accuracy=0.756, val_loss=1.88, val_accuracy=0.477, lr=0.1] 41%|████      | 47/115 [18:34<26:00, 22.95s/epoch, loss=1.11, accuracy=0.759, val_loss=1.66, val_accuracy=0.577, lr=0.1] 42%|████▏     | 48/115 [18:57<25:35, 22.93s/epoch, loss=1.11, accuracy=0.755, val_loss=3.4, val_accuracy=0.441, lr=0.0316] 43%|████▎     | 49/115 [19:20<25:14, 22.95s/epoch, loss=1.11, accuracy=0.758, val_loss=1.77, val_accuracy=0.567, lr=0.1]   43%|████▎     | 50/115 [19:43<24:52, 22.96s/epoch, loss=1.11, accuracy=0.754, val_loss=2.28, val_accuracy=0.464, lr=0.1] 44%|████▍     | 51/115 [20:06<24:33, 23.03s/epoch, loss=1.11, accuracy=0.757, val_loss=3.57, val_accuracy=0.31, lr=0.1]  45%|████▌     | 52/115 [20:29<24:14, 23.09s/epoch, loss=1.11, accuracy=0.756, val_loss=3, val_accuracy=0.343, lr=0.1]   46%|████▌     | 53/115 [20:52<23:51, 23.08s/epoch, loss=1.1, accuracy=0.761, val_loss=1.9, val_accuracy=0.486, lr=0.0316] 47%|████▋     | 54/115 [21:15<23:28, 23.09s/epoch, loss=1.12, accuracy=0.754, val_loss=2.08, val_accuracy=0.473, lr=0.1]  48%|████▊     | 55/115 [21:38<23:04, 23.07s/epoch, loss=1.11, accuracy=0.755, val_loss=1.72, val_accuracy=0.557, lr=0.1] 49%|████▊     | 56/115 [22:01<22:42, 23.10s/epoch, loss=1.12, accuracy=0.756, val_loss=3.02, val_accuracy=0.274, lr=0.1] 50%|████▉     | 57/115 [22:24<22:18, 23.07s/epoch, loss=1.11, accuracy=0.757, val_loss=1.61, val_accuracy=0.602, lr=0.1] 50%|█████     | 58/115 [22:48<21:55, 23.08s/epoch, loss=1.11, accuracy=0.758, val_loss=1.38, val_accuracy=0.665, lr=0.1] 51%|█████▏    | 59/115 [23:11<21:33, 23.10s/epoch, loss=1.11, accuracy=0.757, val_loss=2.3, val_accuracy=0.381, lr=0.1]  52%|█████▏    | 60/115 [23:34<21:09, 23.08s/epoch, loss=1.11, accuracy=0.758, val_loss=2.35, val_accuracy=0.4, lr=0.1]  53%|█████▎    | 61/115 [23:57<20:48, 23.12s/epoch, loss=1.11, accuracy=0.757, val_loss=4.1, val_accuracy=0.318, lr=0.1] 54%|█████▍    | 62/115 [24:19<20:06, 22.76s/epoch, loss=1.1, accuracy=0.757, val_loss=1.61, val_accuracy=0.56, lr=0.1]  55%|█████▍    | 63/115 [24:42<19:47, 22.84s/epoch, loss=1.11, accuracy=0.758, val_loss=3.14, val_accuracy=0.336, lr=0.0316] 56%|█████▌    | 64/115 [25:05<19:27, 22.90s/epoch, loss=1.11, accuracy=0.757, val_loss=1.45, val_accuracy=0.623, lr=0.1]    57%|█████▋    | 65/115 [25:28<19:06, 22.92s/epoch, loss=1.11, accuracy=0.758, val_loss=1.94, val_accuracy=0.524, lr=0.1] 57%|█████▋    | 66/115 [25:51<18:40, 22.87s/epoch, loss=1.11, accuracy=0.758, val_loss=2.12, val_accuracy=0.434, lr=0.1] 58%|█████▊    | 67/115 [26:14<18:20, 22.93s/epoch, loss=1.11, accuracy=0.756, val_loss=1.9, val_accuracy=0.511, lr=0.1]  59%|█████▉    | 68/115 [26:37<17:59, 22.97s/epoch, loss=1.1, accuracy=0.759, val_loss=3.29, val_accuracy=0.308, lr=0.0316] 60%|██████    | 69/115 [27:00<17:34, 22.92s/epoch, loss=1.11, accuracy=0.758, val_loss=2.81, val_accuracy=0.417, lr=0.1]   61%|██████    | 70/115 [27:23<17:11, 22.92s/epoch, loss=1.1, accuracy=0.76, val_loss=2.99, val_accuracy=0.252, lr=0.1]   62%|██████▏   | 71/115 [27:46<16:51, 22.99s/epoch, loss=1.1, accuracy=0.758, val_loss=2.46, val_accuracy=0.397, lr=0.1] 63%|██████▎   | 72/115 [28:08<16:24, 22.90s/epoch, loss=1.1, accuracy=0.756, val_loss=3.71, val_accuracy=0.266, lr=0.1] 63%|██████▎   | 73/115 [28:31<16:03, 22.94s/epoch, loss=1.1, accuracy=0.758, val_loss=2.26, val_accuracy=0.496, lr=0.0316] 64%|██████▍   | 74/115 [28:55<15:43, 23.02s/epoch, loss=1.1, accuracy=0.76, val_loss=1.95, val_accuracy=0.493, lr=0.1]     65%|██████▌   | 75/115 [29:18<15:23, 23.08s/epoch, loss=1.1, accuracy=0.758, val_loss=2.53, val_accuracy=0.419, lr=0.1] 66%|██████▌   | 76/115 [29:41<14:59, 23.07s/epoch, loss=1.1, accuracy=0.759, val_loss=2.04, val_accuracy=0.527, lr=0.1] 67%|██████▋   | 77/115 [30:03<14:29, 22.88s/epoch, loss=1.1, accuracy=0.759, val_loss=1.98, val_accuracy=0.525, lr=0.1] 68%|██████▊   | 78/115 [30:26<14:08, 22.94s/epoch, loss=1.1, accuracy=0.759, val_loss=3.04, val_accuracy=0.372, lr=0.0316] 69%|██████▊   | 79/115 [30:49<13:39, 22.76s/epoch, loss=1.1, accuracy=0.757, val_loss=4.14, val_accuracy=0.226, lr=0.1]    70%|██████▉   | 80/115 [31:12<13:21, 22.91s/epoch, loss=1.1, accuracy=0.758, val_loss=2.31, val_accuracy=0.503, lr=0.1] 70%|███████   | 81/115 [31:34<12:52, 22.72s/epoch, loss=1.1, accuracy=0.758, val_loss=3, val_accuracy=0.338, lr=0.1]    71%|███████▏  | 82/115 [31:58<12:35, 22.89s/epoch, loss=0.917, accuracy=0.811, val_loss=0.892, val_accuracy=0.806, lr=0.01] 72%|███████▏  | 83/115 [32:21<12:14, 22.94s/epoch, loss=0.729, accuracy=0.848, val_loss=0.904, val_accuracy=0.772, lr=0.01] 73%|███████▎  | 84/115 [32:44<11:53, 23.00s/epoch, loss=0.648, accuracy=0.855, val_loss=0.758, val_accuracy=0.813, lr=0.01] 74%|███████▍  | 85/115 [33:07<11:31, 23.06s/epoch, loss=0.603, accuracy=0.861, val_loss=1.07, val_accuracy=0.725, lr=0.01]  75%|███████▍  | 86/115 [33:30<11:08, 23.05s/epoch, loss=0.584, accuracy=0.86, val_loss=0.787, val_accuracy=0.795, lr=0.01] 76%|███████▌  | 87/115 [33:53<10:45, 23.06s/epoch, loss=0.569, accuracy=0.861, val_loss=0.874, val_accuracy=0.772, lr=0.01] 77%|███████▋  | 88/115 [34:16<10:22, 23.07s/epoch, loss=0.561, accuracy=0.864, val_loss=0.879, val_accuracy=0.757, lr=0.01] 77%|███████▋  | 89/115 [34:39<10:00, 23.09s/epoch, loss=0.564, accuracy=0.862, val_loss=0.816, val_accuracy=0.786, lr=0.00316] 78%|███████▊  | 90/115 [35:02<09:37, 23.09s/epoch, loss=0.558, accuracy=0.866, val_loss=0.964, val_accuracy=0.74, lr=0.01]     79%|███████▉  | 91/115 [35:25<09:12, 23.04s/epoch, loss=0.559, accuracy=0.867, val_loss=0.776, val_accuracy=0.794, lr=0.01] 80%|████████  | 92/115 [35:48<08:50, 23.09s/epoch, loss=0.557, accuracy=0.867, val_loss=0.897, val_accuracy=0.757, lr=0.01] 81%|████████  | 93/115 [36:12<08:29, 23.15s/epoch, loss=0.55, accuracy=0.871, val_loss=0.86, val_accuracy=0.779, lr=0.01]   82%|████████▏ | 94/115 [36:35<08:05, 23.13s/epoch, loss=0.554, accuracy=0.871, val_loss=0.856, val_accuracy=0.783, lr=0.00316] 83%|████████▎ | 95/115 [36:58<07:42, 23.13s/epoch, loss=0.552, accuracy=0.872, val_loss=1.01, val_accuracy=0.736, lr=0.01]     83%|████████▎ | 96/115 [37:21<07:19, 23.14s/epoch, loss=0.552, accuracy=0.872, val_loss=0.853, val_accuracy=0.781, lr=0.01] 84%|████████▍ | 97/115 [37:44<06:54, 23.02s/epoch, loss=0.549, accuracy=0.874, val_loss=0.901, val_accuracy=0.76, lr=0.01]  85%|████████▌ | 98/115 [38:06<06:28, 22.84s/epoch, loss=0.552, accuracy=0.874, val_loss=0.85, val_accuracy=0.774, lr=0.01] 86%|████████▌ | 99/115 [38:30<06:08, 23.01s/epoch, loss=0.549, accuracy=0.875, val_loss=0.814, val_accuracy=0.785, lr=0.00316] 87%|████████▋ | 100/115 [38:53<05:46, 23.09s/epoch, loss=0.553, accuracy=0.874, val_loss=0.97, val_accuracy=0.749, lr=0.01]    88%|████████▊ | 101/115 [39:16<05:24, 23.16s/epoch, loss=0.549, accuracy=0.876, val_loss=0.911, val_accuracy=0.78, lr=0.01] 89%|████████▊ | 102/115 [39:40<05:01, 23.20s/epoch, loss=0.544, accuracy=0.878, val_loss=1.05, val_accuracy=0.737, lr=0.01] 90%|████████▉ | 103/115 [40:03<04:38, 23.21s/epoch, loss=0.546, accuracy=0.878, val_loss=0.876, val_accuracy=0.77, lr=0.01] 90%|█████████ | 104/115 [40:26<04:15, 23.18s/epoch, loss=0.544, accuracy=0.879, val_loss=0.872, val_accuracy=0.768, lr=0.00316] 91%|█████████▏| 105/115 [40:49<03:51, 23.17s/epoch, loss=0.544, accuracy=0.88, val_loss=1.12, val_accuracy=0.74, lr=0.01]       92%|█████████▏| 106/115 [41:12<03:28, 23.21s/epoch, loss=0.546, accuracy=0.88, val_loss=0.873, val_accuracy=0.784, lr=0.01] 93%|█████████▎| 107/115 [41:36<03:05, 23.19s/epoch, loss=0.546, accuracy=0.881, val_loss=0.925, val_accuracy=0.757, lr=0.01] 94%|█████████▍| 108/115 [41:58<02:40, 23.00s/epoch, loss=0.547, accuracy=0.881, val_loss=1.69, val_accuracy=0.603, lr=0.01]  95%|█████████▍| 109/115 [42:21<02:18, 23.05s/epoch, loss=0.548, accuracy=0.878, val_loss=0.993, val_accuracy=0.752, lr=0.00316] 96%|█████████▌| 110/115 [42:44<01:55, 23.02s/epoch, loss=0.547, accuracy=0.881, val_loss=1.18, val_accuracy=0.701, lr=0.01]     97%|█████████▋| 111/115 [43:07<01:32, 23.06s/epoch, loss=0.542, accuracy=0.882, val_loss=1.12, val_accuracy=0.732, lr=0.01] 97%|█████████▋| 112/115 [43:31<01:09, 23.12s/epoch, loss=0.545, accuracy=0.882, val_loss=0.827, val_accuracy=0.795, lr=0.01] 98%|█████████▊| 113/115 [43:54<00:46, 23.09s/epoch, loss=0.549, accuracy=0.882, val_loss=1.16, val_accuracy=0.728, lr=0.01]  99%|█████████▉| 114/115 [44:16<00:22, 22.98s/epoch, loss=0.546, accuracy=0.882, val_loss=1.24, val_accuracy=0.682, lr=0.00316]100%|██████████| 115/115 [44:40<00:00, 23.07s/epoch, loss=0.546, accuracy=0.882, val_loss=1.32, val_accuracy=0.685, lr=0.01]   100%|██████████| 115/115 [44:40<00:00, 23.31s/epoch, loss=0.546, accuracy=0.882, val_loss=1.32, val_accuracy=0.685, lr=0.01]
Using real-time data augmentation.
Test loss: 1.3162325620651245
Test accuracy: 0.6848000288009644


* * * Run SGD for ID = 13_4. * * *


2024-02-15 15:11:25.778996: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 15:11:27.805669: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 15:11:27.806723: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-15 15:11:27.842051: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-02-15 15:11:27.842101: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 15:11:27.844552: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 15:11:27.844597: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 15:11:27.846588: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 15:11:27.847112: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 15:11:27.849284: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 15:11:27.850571: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 15:11:27.855256: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 15:11:27.855772: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 15:11:27.855850: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 15:11:29.053961: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-15 15:11:29.054532: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 15:11:29.055109: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-02-15 15:11:29.055140: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 15:11:29.055192: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 15:11:29.055213: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 15:11:29.055232: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 15:11:29.055251: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 15:11:29.055270: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 15:11:29.055310: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 15:11:29.055331: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 15:11:29.055756: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 15:11:29.055793: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 15:11:29.680389: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-15 15:11:29.680440: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-15 15:11:29.680449: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-15 15:11:29.681344: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11227 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN X (Pascal), pci bus id: 0000:03:00.0, compute capability: 6.1)
{'id': 134, 'batch_size': 128, 'epochs': 115, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN X (Pascal)'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/115 [00:00<?, ?epoch/s]2024-02-15 15:11:30.441369: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-15 15:11:30.453409: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2599900000 Hz
2024-02-15 15:11:32.272237: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 15:11:32.492816: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 15:11:33.222498: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-15 15:11:33.278394: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/115 [00:52<1:40:25, 52.85s/epoch, loss=3.24, accuracy=0.296, val_loss=2.17, val_accuracy=0.306, lr=0.1]  2%|▏         | 2/115 [01:16<1:06:42, 35.42s/epoch, loss=1.64, accuracy=0.494, val_loss=2.05, val_accuracy=0.386, lr=0.1]  3%|▎         | 3/115 [01:39<55:47, 29.89s/epoch, loss=1.41, accuracy=0.606, val_loss=1.79, val_accuracy=0.48, lr=0.1]     3%|▎         | 4/115 [02:02<50:22, 27.23s/epoch, loss=1.29, accuracy=0.669, val_loss=1.44, val_accuracy=0.629, lr=0.1]  4%|▍         | 5/115 [02:25<47:10, 25.73s/epoch, loss=1.26, accuracy=0.691, val_loss=1.75, val_accuracy=0.539, lr=0.1]  5%|▌         | 6/115 [02:48<44:56, 24.74s/epoch, loss=1.24, accuracy=0.705, val_loss=1.57, val_accuracy=0.574, lr=0.1]  6%|▌         | 7/115 [03:11<43:36, 24.22s/epoch, loss=1.23, accuracy=0.714, val_loss=2.15, val_accuracy=0.433, lr=0.1]  7%|▋         | 8/115 [03:34<42:38, 23.91s/epoch, loss=1.22, accuracy=0.721, val_loss=1.64, val_accuracy=0.572, lr=0.1]  8%|▊         | 9/115 [03:57<41:46, 23.65s/epoch, loss=1.22, accuracy=0.725, val_loss=2.2, val_accuracy=0.454, lr=0.0316]  9%|▊         | 10/115 [04:21<41:08, 23.51s/epoch, loss=1.21, accuracy=0.726, val_loss=1.7, val_accuracy=0.6, lr=0.1]     10%|▉         | 11/115 [04:44<40:37, 23.44s/epoch, loss=1.21, accuracy=0.732, val_loss=2.09, val_accuracy=0.54, lr=0.1] 10%|█         | 12/115 [05:07<40:01, 23.32s/epoch, loss=1.2, accuracy=0.732, val_loss=1.57, val_accuracy=0.625, lr=0.1] 11%|█▏        | 13/115 [05:30<39:40, 23.34s/epoch, loss=1.2, accuracy=0.735, val_loss=2.66, val_accuracy=0.406, lr=0.1] 12%|█▏        | 14/115 [05:54<39:15, 23.32s/epoch, loss=1.2, accuracy=0.734, val_loss=1.49, val_accuracy=0.652, lr=0.0316] 13%|█▎        | 15/115 [06:17<38:51, 23.32s/epoch, loss=1.19, accuracy=0.736, val_loss=2.33, val_accuracy=0.479, lr=0.1]   14%|█▍        | 16/115 [06:39<38:06, 23.10s/epoch, loss=1.19, accuracy=0.736, val_loss=1.81, val_accuracy=0.568, lr=0.1] 15%|█▍        | 17/115 [07:03<37:47, 23.14s/epoch, loss=1.18, accuracy=0.739, val_loss=1.43, val_accuracy=0.651, lr=0.1] 16%|█▌        | 18/115 [07:25<36:56, 22.85s/epoch, loss=1.19, accuracy=0.737, val_loss=1.72, val_accuracy=0.555, lr=0.1] 17%|█▋        | 19/115 [07:48<36:44, 22.96s/epoch, loss=1.18, accuracy=0.741, val_loss=2.16, val_accuracy=0.406, lr=0.1] 17%|█▋        | 20/115 [08:11<36:17, 22.92s/epoch, loss=1.18, accuracy=0.739, val_loss=1.81, val_accuracy=0.558, lr=0.1] 18%|█▊        | 21/115 [08:33<35:34, 22.71s/epoch, loss=1.17, accuracy=0.745, val_loss=2.57, val_accuracy=0.411, lr=0.1] 19%|█▉        | 22/115 [08:55<34:56, 22.54s/epoch, loss=1.18, accuracy=0.742, val_loss=2.97, val_accuracy=0.369, lr=0.0316] 20%|██        | 23/115 [09:18<34:48, 22.70s/epoch, loss=1.17, accuracy=0.743, val_loss=1.83, val_accuracy=0.549, lr=0.1]    21%|██        | 24/115 [09:41<34:34, 22.79s/epoch, loss=1.17, accuracy=0.745, val_loss=1.95, val_accuracy=0.593, lr=0.1] 22%|██▏       | 25/115 [10:04<34:17, 22.86s/epoch, loss=1.17, accuracy=0.745, val_loss=1.74, val_accuracy=0.573, lr=0.1] 23%|██▎       | 26/115 [10:28<34:04, 22.98s/epoch, loss=1.17, accuracy=0.744, val_loss=3.45, val_accuracy=0.348, lr=0.1] 23%|██▎       | 27/115 [10:51<33:46, 23.03s/epoch, loss=1.16, accuracy=0.746, val_loss=1.34, val_accuracy=0.679, lr=0.1] 24%|██▍       | 28/115 [11:14<33:34, 23.16s/epoch, loss=1.17, accuracy=0.743, val_loss=1.69, val_accuracy=0.564, lr=0.1] 25%|██▌       | 29/115 [11:37<33:11, 23.15s/epoch, loss=1.17, accuracy=0.746, val_loss=2.52, val_accuracy=0.434, lr=0.1] 26%|██▌       | 30/115 [12:00<32:44, 23.11s/epoch, loss=1.17, accuracy=0.744, val_loss=1.53, val_accuracy=0.632, lr=0.1] 27%|██▋       | 31/115 [12:24<32:31, 23.23s/epoch, loss=1.17, accuracy=0.746, val_loss=1.64, val_accuracy=0.554, lr=0.1] 28%|██▊       | 32/115 [12:47<32:06, 23.21s/epoch, loss=1.16, accuracy=0.75, val_loss=1.81, val_accuracy=0.546, lr=0.0316] 29%|██▊       | 33/115 [13:10<31:33, 23.10s/epoch, loss=1.16, accuracy=0.75, val_loss=1.75, val_accuracy=0.562, lr=0.1]    30%|██▉       | 34/115 [13:33<31:15, 23.15s/epoch, loss=1.16, accuracy=0.749, val_loss=1.98, val_accuracy=0.49, lr=0.1] 30%|███       | 35/115 [13:56<30:44, 23.05s/epoch, loss=1.16, accuracy=0.748, val_loss=1.83, val_accuracy=0.556, lr=0.1] 31%|███▏      | 36/115 [14:19<30:23, 23.08s/epoch, loss=1.16, accuracy=0.749, val_loss=2.01, val_accuracy=0.513, lr=0.1] 32%|███▏      | 37/115 [14:43<30:06, 23.16s/epoch, loss=1.16, accuracy=0.748, val_loss=1.64, val_accuracy=0.62, lr=0.0316] 33%|███▎      | 38/115 [15:06<29:46, 23.20s/epoch, loss=1.15, accuracy=0.748, val_loss=2.48, val_accuracy=0.472, lr=0.1]   34%|███▍      | 39/115 [15:29<29:25, 23.23s/epoch, loss=1.16, accuracy=0.75, val_loss=2.26, val_accuracy=0.491, lr=0.1]  35%|███▍      | 40/115 [15:51<28:35, 22.87s/epoch, loss=1.16, accuracy=0.75, val_loss=1.8, val_accuracy=0.602, lr=0.1]  36%|███▌      | 41/115 [16:14<28:20, 22.98s/epoch, loss=1.15, accuracy=0.75, val_loss=2.92, val_accuracy=0.35, lr=0.1] 37%|███▋      | 42/115 [16:38<28:03, 23.07s/epoch, loss=1.15, accuracy=0.75, val_loss=2.72, val_accuracy=0.379, lr=0.0316] 37%|███▋      | 43/115 [17:01<27:48, 23.17s/epoch, loss=1.16, accuracy=0.75, val_loss=3.99, val_accuracy=0.276, lr=0.1]    38%|███▊      | 44/115 [17:24<27:20, 23.11s/epoch, loss=1.15, accuracy=0.75, val_loss=1.8, val_accuracy=0.557, lr=0.1]  39%|███▉      | 45/115 [17:47<27:00, 23.15s/epoch, loss=1.15, accuracy=0.751, val_loss=1.68, val_accuracy=0.597, lr=0.1] 40%|████      | 46/115 [18:10<26:32, 23.08s/epoch, loss=1.15, accuracy=0.749, val_loss=2.17, val_accuracy=0.496, lr=0.1] 41%|████      | 47/115 [18:33<26:11, 23.10s/epoch, loss=1.15, accuracy=0.753, val_loss=1.57, val_accuracy=0.606, lr=0.0316] 42%|████▏     | 48/115 [18:56<25:44, 23.06s/epoch, loss=1.15, accuracy=0.753, val_loss=1.91, val_accuracy=0.561, lr=0.1]    43%|████▎     | 49/115 [19:19<25:22, 23.07s/epoch, loss=1.15, accuracy=0.753, val_loss=2.34, val_accuracy=0.362, lr=0.1] 43%|████▎     | 50/115 [19:43<25:04, 23.14s/epoch, loss=1.14, accuracy=0.754, val_loss=2.16, val_accuracy=0.481, lr=0.1] 44%|████▍     | 51/115 [20:06<24:42, 23.17s/epoch, loss=1.15, accuracy=0.75, val_loss=1.8, val_accuracy=0.527, lr=0.1]   45%|████▌     | 52/115 [20:29<24:21, 23.20s/epoch, loss=1.15, accuracy=0.751, val_loss=1.58, val_accuracy=0.614, lr=0.0316] 46%|████▌     | 53/115 [20:52<23:59, 23.22s/epoch, loss=1.15, accuracy=0.754, val_loss=2.47, val_accuracy=0.424, lr=0.1]    47%|████▋     | 54/115 [21:16<23:36, 23.22s/epoch, loss=1.15, accuracy=0.755, val_loss=2.38, val_accuracy=0.482, lr=0.1] 48%|████▊     | 55/115 [21:39<23:12, 23.20s/epoch, loss=1.15, accuracy=0.752, val_loss=1.7, val_accuracy=0.562, lr=0.1]  49%|████▊     | 56/115 [22:02<22:53, 23.27s/epoch, loss=1.15, accuracy=0.753, val_loss=1.62, val_accuracy=0.604, lr=0.1] 50%|████▉     | 57/115 [22:25<22:27, 23.24s/epoch, loss=1.15, accuracy=0.753, val_loss=1.75, val_accuracy=0.538, lr=0.0316] 50%|█████     | 58/115 [22:49<22:05, 23.25s/epoch, loss=1.14, accuracy=0.755, val_loss=1.95, val_accuracy=0.527, lr=0.1]    51%|█████▏    | 59/115 [23:12<21:38, 23.20s/epoch, loss=1.14, accuracy=0.754, val_loss=2.95, val_accuracy=0.475, lr=0.1] 52%|█████▏    | 60/115 [23:35<21:17, 23.23s/epoch, loss=1.14, accuracy=0.755, val_loss=1.68, val_accuracy=0.601, lr=0.1] 53%|█████▎    | 61/115 [23:58<20:54, 23.23s/epoch, loss=1.14, accuracy=0.754, val_loss=2.19, val_accuracy=0.458, lr=0.1] 54%|█████▍    | 62/115 [24:22<20:31, 23.24s/epoch, loss=1.14, accuracy=0.752, val_loss=2.68, val_accuracy=0.327, lr=0.0316] 55%|█████▍    | 63/115 [24:45<20:09, 23.26s/epoch, loss=1.14, accuracy=0.753, val_loss=2.26, val_accuracy=0.396, lr=0.1]    56%|█████▌    | 64/115 [25:08<19:44, 23.23s/epoch, loss=1.14, accuracy=0.752, val_loss=2.6, val_accuracy=0.415, lr=0.1]  57%|█████▋    | 65/115 [25:31<19:19, 23.19s/epoch, loss=1.14, accuracy=0.753, val_loss=2.82, val_accuracy=0.401, lr=0.1] 57%|█████▋    | 66/115 [25:54<18:54, 23.14s/epoch, loss=1.14, accuracy=0.756, val_loss=1.84, val_accuracy=0.523, lr=0.1] 58%|█████▊    | 67/115 [26:17<18:31, 23.15s/epoch, loss=1.14, accuracy=0.753, val_loss=1.49, val_accuracy=0.628, lr=0.0316] 59%|█████▉    | 68/115 [26:41<18:11, 23.23s/epoch, loss=1.14, accuracy=0.755, val_loss=1.61, val_accuracy=0.605, lr=0.1]    60%|██████    | 69/115 [27:04<17:48, 23.22s/epoch, loss=1.13, accuracy=0.756, val_loss=4.32, val_accuracy=0.254, lr=0.1] 61%|██████    | 70/115 [27:27<17:23, 23.19s/epoch, loss=1.14, accuracy=0.754, val_loss=1.89, val_accuracy=0.486, lr=0.1] 62%|██████▏   | 71/115 [27:50<17:01, 23.20s/epoch, loss=1.14, accuracy=0.754, val_loss=1.81, val_accuracy=0.582, lr=0.1] 63%|██████▎   | 72/115 [28:13<16:36, 23.17s/epoch, loss=1.14, accuracy=0.754, val_loss=1.8, val_accuracy=0.573, lr=0.0316] 63%|██████▎   | 73/115 [28:36<16:09, 23.09s/epoch, loss=1.14, accuracy=0.755, val_loss=2.53, val_accuracy=0.395, lr=0.1]   64%|██████▍   | 74/115 [28:59<15:47, 23.11s/epoch, loss=1.14, accuracy=0.753, val_loss=1.52, val_accuracy=0.61, lr=0.1]  65%|██████▌   | 75/115 [29:23<15:23, 23.08s/epoch, loss=1.13, accuracy=0.754, val_loss=4.69, val_accuracy=0.328, lr=0.1] 66%|██████▌   | 76/115 [29:46<15:00, 23.10s/epoch, loss=1.14, accuracy=0.752, val_loss=1.74, val_accuracy=0.547, lr=0.1] 67%|██████▋   | 77/115 [30:09<14:39, 23.16s/epoch, loss=1.13, accuracy=0.756, val_loss=1.96, val_accuracy=0.558, lr=0.0316] 68%|██████▊   | 78/115 [30:32<14:12, 23.04s/epoch, loss=1.14, accuracy=0.753, val_loss=2.08, val_accuracy=0.505, lr=0.1]    69%|██████▊   | 79/115 [30:55<13:49, 23.05s/epoch, loss=1.14, accuracy=0.754, val_loss=4.48, val_accuracy=0.226, lr=0.1] 70%|██████▉   | 80/115 [31:18<13:25, 23.01s/epoch, loss=1.13, accuracy=0.756, val_loss=3.31, val_accuracy=0.345, lr=0.1] 70%|███████   | 81/115 [31:40<12:57, 22.86s/epoch, loss=1.14, accuracy=0.756, val_loss=4.44, val_accuracy=0.354, lr=0.1] 71%|███████▏  | 82/115 [32:03<12:36, 22.93s/epoch, loss=0.932, accuracy=0.814, val_loss=0.917, val_accuracy=0.801, lr=0.01] 72%|███████▏  | 83/115 [32:26<12:16, 23.01s/epoch, loss=0.749, accuracy=0.846, val_loss=0.764, val_accuracy=0.829, lr=0.01] 73%|███████▎  | 84/115 [32:50<11:56, 23.10s/epoch, loss=0.663, accuracy=0.854, val_loss=0.769, val_accuracy=0.814, lr=0.01] 74%|███████▍  | 85/115 [33:13<11:32, 23.10s/epoch, loss=0.615, accuracy=0.86, val_loss=0.781, val_accuracy=0.802, lr=0.01]  75%|███████▍  | 86/115 [33:36<11:09, 23.09s/epoch, loss=0.593, accuracy=0.86, val_loss=0.759, val_accuracy=0.801, lr=0.01] 76%|███████▌  | 87/115 [33:59<10:45, 23.07s/epoch, loss=0.579, accuracy=0.863, val_loss=0.724, val_accuracy=0.808, lr=0.01] 77%|███████▋  | 88/115 [34:22<10:22, 23.06s/epoch, loss=0.576, accuracy=0.862, val_loss=0.765, val_accuracy=0.805, lr=0.01] 77%|███████▋  | 89/115 [34:45<09:58, 23.02s/epoch, loss=0.572, accuracy=0.865, val_loss=0.743, val_accuracy=0.811, lr=0.01] 78%|███████▊  | 90/115 [35:08<09:32, 22.90s/epoch, loss=0.569, accuracy=0.867, val_loss=0.824, val_accuracy=0.786, lr=0.01] 79%|███████▉  | 91/115 [35:31<09:12, 23.01s/epoch, loss=0.565, accuracy=0.869, val_loss=0.737, val_accuracy=0.808, lr=0.01] 80%|████████  | 92/115 [35:54<08:49, 23.03s/epoch, loss=0.563, accuracy=0.868, val_loss=0.772, val_accuracy=0.811, lr=0.00316] 81%|████████  | 93/115 [36:17<08:28, 23.10s/epoch, loss=0.563, accuracy=0.87, val_loss=0.684, val_accuracy=0.831, lr=0.01]     82%|████████▏ | 94/115 [36:40<08:04, 23.08s/epoch, loss=0.564, accuracy=0.872, val_loss=0.998, val_accuracy=0.75, lr=0.01] 83%|████████▎ | 95/115 [37:03<07:41, 23.09s/epoch, loss=0.564, accuracy=0.872, val_loss=0.773, val_accuracy=0.804, lr=0.01] 83%|████████▎ | 96/115 [37:26<07:17, 23.04s/epoch, loss=0.561, accuracy=0.875, val_loss=0.8, val_accuracy=0.801, lr=0.01]   84%|████████▍ | 97/115 [37:49<06:55, 23.10s/epoch, loss=0.561, accuracy=0.875, val_loss=0.828, val_accuracy=0.791, lr=0.01] 85%|████████▌ | 98/115 [38:13<06:33, 23.12s/epoch, loss=0.561, accuracy=0.876, val_loss=0.841, val_accuracy=0.79, lr=0.00316] 86%|████████▌ | 99/115 [38:36<06:08, 23.05s/epoch, loss=0.56, accuracy=0.878, val_loss=0.893, val_accuracy=0.782, lr=0.01]    87%|████████▋ | 100/115 [38:59<05:46, 23.09s/epoch, loss=0.56, accuracy=0.876, val_loss=0.828, val_accuracy=0.794, lr=0.01] 88%|████████▊ | 101/115 [39:22<05:24, 23.15s/epoch, loss=0.554, accuracy=0.878, val_loss=0.792, val_accuracy=0.806, lr=0.01] 89%|████████▊ | 102/115 [39:45<05:00, 23.15s/epoch, loss=0.56, accuracy=0.878, val_loss=0.748, val_accuracy=0.811, lr=0.01]  90%|████████▉ | 103/115 [40:08<04:37, 23.15s/epoch, loss=0.557, accuracy=0.88, val_loss=0.78, val_accuracy=0.812, lr=0.00316] 90%|█████████ | 104/115 [40:32<04:14, 23.17s/epoch, loss=0.562, accuracy=0.878, val_loss=0.995, val_accuracy=0.74, lr=0.01]   91%|█████████▏| 105/115 [40:54<03:51, 23.10s/epoch, loss=0.561, accuracy=0.88, val_loss=0.788, val_accuracy=0.807, lr=0.01] 92%|█████████▏| 106/115 [41:18<03:28, 23.17s/epoch, loss=0.558, accuracy=0.879, val_loss=0.861, val_accuracy=0.797, lr=0.01] 93%|█████████▎| 107/115 [41:41<03:05, 23.20s/epoch, loss=0.558, accuracy=0.88, val_loss=0.834, val_accuracy=0.808, lr=0.01]  94%|█████████▍| 108/115 [42:04<02:42, 23.18s/epoch, loss=0.558, accuracy=0.883, val_loss=1.1, val_accuracy=0.73, lr=0.00316] 95%|█████████▍| 109/115 [42:27<02:18, 23.16s/epoch, loss=0.564, accuracy=0.88, val_loss=0.763, val_accuracy=0.82, lr=0.01]   96%|█████████▌| 110/115 [42:51<01:55, 23.17s/epoch, loss=0.559, accuracy=0.881, val_loss=0.929, val_accuracy=0.77, lr=0.01] 97%|█████████▋| 111/115 [43:14<01:32, 23.20s/epoch, loss=0.56, accuracy=0.882, val_loss=0.824, val_accuracy=0.807, lr=0.01] 97%|█████████▋| 112/115 [43:37<01:09, 23.25s/epoch, loss=0.561, accuracy=0.881, val_loss=0.945, val_accuracy=0.764, lr=0.01] 98%|█████████▊| 113/115 [44:00<00:46, 23.22s/epoch, loss=0.562, accuracy=0.88, val_loss=0.742, val_accuracy=0.828, lr=0.00316] 99%|█████████▉| 114/115 [44:23<00:23, 23.21s/epoch, loss=0.56, accuracy=0.884, val_loss=0.94, val_accuracy=0.771, lr=0.01]    100%|██████████| 115/115 [44:47<00:00, 23.20s/epoch, loss=0.556, accuracy=0.884, val_loss=0.953, val_accuracy=0.771, lr=0.01]100%|██████████| 115/115 [44:47<00:00, 23.37s/epoch, loss=0.556, accuracy=0.884, val_loss=0.953, val_accuracy=0.771, lr=0.01]
Using real-time data augmentation.
Test loss: 0.953277051448822
Test accuracy: 0.770799994468689


* * * Run SGD for ID = 13_5. * * *


2024-02-15 15:56:21.112342: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 15:56:26.704513: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 15:56:26.705768: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-15 15:56:26.740661: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-02-15 15:56:26.740690: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 15:56:26.743554: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 15:56:26.743607: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 15:56:26.745983: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 15:56:26.746722: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 15:56:26.749072: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 15:56:26.750472: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 15:56:26.754932: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 15:56:26.755408: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 15:56:26.755486: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 15:56:27.964454: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-15 15:56:27.965497: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 15:56:27.966122: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-02-15 15:56:27.966152: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 15:56:27.966204: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 15:56:27.966223: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 15:56:27.966242: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 15:56:27.966268: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 15:56:27.966314: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 15:56:27.966335: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 15:56:27.966354: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 15:56:27.966787: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 15:56:27.966820: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 15:56:28.567332: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-15 15:56:28.567393: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-15 15:56:28.567403: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-15 15:56:28.568251: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11227 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN X (Pascal), pci bus id: 0000:03:00.0, compute capability: 6.1)
{'id': 135, 'batch_size': 128, 'epochs': 115, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN X (Pascal)'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/115 [00:00<?, ?epoch/s]2024-02-15 15:56:29.329960: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-15 15:56:29.342427: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2599900000 Hz
2024-02-15 15:56:31.174672: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 15:56:31.422700: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 15:56:32.244515: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-15 15:56:32.278628: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/115 [00:55<1:44:32, 55.02s/epoch, loss=3.21, accuracy=0.309, val_loss=2.19, val_accuracy=0.311, lr=0.1]  2%|▏         | 2/115 [01:18<1:08:15, 36.25s/epoch, loss=1.65, accuracy=0.49, val_loss=2.96, val_accuracy=0.324, lr=0.1]   3%|▎         | 3/115 [01:41<56:35, 30.32s/epoch, loss=1.47, accuracy=0.587, val_loss=2.41, val_accuracy=0.314, lr=0.1]   3%|▎         | 4/115 [02:04<50:49, 27.48s/epoch, loss=1.38, accuracy=0.64, val_loss=1.72, val_accuracy=0.554, lr=0.1]   4%|▍         | 5/115 [02:27<47:26, 25.88s/epoch, loss=1.32, accuracy=0.673, val_loss=2.05, val_accuracy=0.404, lr=0.1]  5%|▌         | 6/115 [02:50<45:10, 24.87s/epoch, loss=1.28, accuracy=0.69, val_loss=2.27, val_accuracy=0.385, lr=0.1]   6%|▌         | 7/115 [03:13<43:37, 24.24s/epoch, loss=1.26, accuracy=0.706, val_loss=3.05, val_accuracy=0.367, lr=0.1]  7%|▋         | 8/115 [03:36<42:36, 23.89s/epoch, loss=1.25, accuracy=0.713, val_loss=1.91, val_accuracy=0.477, lr=0.1]  8%|▊         | 9/115 [03:59<41:40, 23.59s/epoch, loss=1.24, accuracy=0.717, val_loss=1.68, val_accuracy=0.566, lr=0.1]  9%|▊         | 10/115 [04:22<41:00, 23.43s/epoch, loss=1.24, accuracy=0.724, val_loss=4.89, val_accuracy=0.273, lr=0.1] 10%|▉         | 11/115 [04:45<40:22, 23.29s/epoch, loss=1.23, accuracy=0.728, val_loss=1.6, val_accuracy=0.599, lr=0.1]  10%|█         | 12/115 [05:08<39:49, 23.20s/epoch, loss=1.22, accuracy=0.731, val_loss=1.63, val_accuracy=0.576, lr=0.1] 11%|█▏        | 13/115 [05:31<39:20, 23.15s/epoch, loss=1.22, accuracy=0.73, val_loss=2.52, val_accuracy=0.398, lr=0.1]  12%|█▏        | 14/115 [05:54<38:48, 23.05s/epoch, loss=1.21, accuracy=0.735, val_loss=2.11, val_accuracy=0.392, lr=0.1] 13%|█▎        | 15/115 [06:17<38:23, 23.04s/epoch, loss=1.2, accuracy=0.738, val_loss=2.02, val_accuracy=0.493, lr=0.1]  14%|█▍        | 16/115 [06:40<38:01, 23.05s/epoch, loss=1.19, accuracy=0.74, val_loss=2.88, val_accuracy=0.305, lr=0.0316] 15%|█▍        | 17/115 [07:03<37:30, 22.97s/epoch, loss=1.2, accuracy=0.741, val_loss=1.56, val_accuracy=0.609, lr=0.1]    16%|█▌        | 18/115 [07:26<37:05, 22.95s/epoch, loss=1.19, accuracy=0.74, val_loss=1.99, val_accuracy=0.514, lr=0.1] 17%|█▋        | 19/115 [07:49<36:45, 22.98s/epoch, loss=1.2, accuracy=0.741, val_loss=2.36, val_accuracy=0.476, lr=0.1] 17%|█▋        | 20/115 [08:12<36:21, 22.97s/epoch, loss=1.18, accuracy=0.742, val_loss=1.87, val_accuracy=0.52, lr=0.1] 18%|█▊        | 21/115 [08:35<36:00, 22.98s/epoch, loss=1.18, accuracy=0.745, val_loss=2.01, val_accuracy=0.507, lr=0.1] 19%|█▉        | 22/115 [08:57<35:23, 22.84s/epoch, loss=1.2, accuracy=0.741, val_loss=1.89, val_accuracy=0.478, lr=0.0316] 20%|██        | 23/115 [09:20<35:06, 22.89s/epoch, loss=1.18, accuracy=0.745, val_loss=1.8, val_accuracy=0.545, lr=0.1]    21%|██        | 24/115 [09:43<34:49, 22.96s/epoch, loss=1.18, accuracy=0.744, val_loss=1.76, val_accuracy=0.557, lr=0.1] 22%|██▏       | 25/115 [10:06<34:28, 22.99s/epoch, loss=1.18, accuracy=0.744, val_loss=1.64, val_accuracy=0.59, lr=0.1]  23%|██▎       | 26/115 [10:29<34:05, 22.99s/epoch, loss=1.18, accuracy=0.747, val_loss=1.96, val_accuracy=0.478, lr=0.1] 23%|██▎       | 27/115 [10:53<33:53, 23.11s/epoch, loss=1.18, accuracy=0.744, val_loss=1.75, val_accuracy=0.574, lr=0.0316] 24%|██▍       | 28/115 [11:16<33:36, 23.18s/epoch, loss=1.18, accuracy=0.745, val_loss=2.22, val_accuracy=0.377, lr=0.1]    25%|██▌       | 29/115 [11:39<33:12, 23.17s/epoch, loss=1.18, accuracy=0.748, val_loss=1.53, val_accuracy=0.631, lr=0.1] 26%|██▌       | 30/115 [12:03<32:53, 23.22s/epoch, loss=1.17, accuracy=0.746, val_loss=2.18, val_accuracy=0.486, lr=0.1] 27%|██▋       | 31/115 [12:26<32:31, 23.23s/epoch, loss=1.17, accuracy=0.749, val_loss=1.75, val_accuracy=0.547, lr=0.1] 28%|██▊       | 32/115 [12:49<31:57, 23.10s/epoch, loss=1.17, accuracy=0.748, val_loss=1.34, val_accuracy=0.691, lr=0.1] 29%|██▊       | 33/115 [13:11<31:20, 22.93s/epoch, loss=1.16, accuracy=0.752, val_loss=3.08, val_accuracy=0.44, lr=0.1]  30%|██▉       | 34/115 [13:34<30:59, 22.96s/epoch, loss=1.17, accuracy=0.747, val_loss=2.31, val_accuracy=0.452, lr=0.1] 30%|███       | 35/115 [13:57<30:38, 22.98s/epoch, loss=1.16, accuracy=0.751, val_loss=2.67, val_accuracy=0.394, lr=0.1] 31%|███▏      | 36/115 [14:20<30:07, 22.89s/epoch, loss=1.16, accuracy=0.75, val_loss=1.85, val_accuracy=0.586, lr=0.1]  32%|███▏      | 37/115 [14:43<29:48, 22.92s/epoch, loss=1.16, accuracy=0.749, val_loss=2.22, val_accuracy=0.504, lr=0.0316] 33%|███▎      | 38/115 [15:06<29:28, 22.97s/epoch, loss=1.16, accuracy=0.752, val_loss=1.62, val_accuracy=0.572, lr=0.1]    34%|███▍      | 39/115 [15:29<29:08, 23.01s/epoch, loss=1.16, accuracy=0.749, val_loss=2.81, val_accuracy=0.416, lr=0.1] 35%|███▍      | 40/115 [15:52<28:49, 23.06s/epoch, loss=1.15, accuracy=0.753, val_loss=1.54, val_accuracy=0.638, lr=0.1] 36%|███▌      | 41/115 [16:15<28:24, 23.04s/epoch, loss=1.15, accuracy=0.753, val_loss=2.18, val_accuracy=0.539, lr=0.1] 37%|███▋      | 42/115 [16:38<28:04, 23.08s/epoch, loss=1.15, accuracy=0.752, val_loss=2.64, val_accuracy=0.349, lr=0.0316] 37%|███▋      | 43/115 [17:02<27:42, 23.09s/epoch, loss=1.15, accuracy=0.754, val_loss=4.01, val_accuracy=0.289, lr=0.1]    38%|███▊      | 44/115 [17:24<27:15, 23.03s/epoch, loss=1.15, accuracy=0.754, val_loss=1.52, val_accuracy=0.614, lr=0.1] 39%|███▉      | 45/115 [17:48<26:55, 23.07s/epoch, loss=1.15, accuracy=0.754, val_loss=1.64, val_accuracy=0.594, lr=0.1] 40%|████      | 46/115 [18:11<26:31, 23.07s/epoch, loss=1.15, accuracy=0.753, val_loss=2.73, val_accuracy=0.389, lr=0.1] 41%|████      | 47/115 [18:34<26:05, 23.03s/epoch, loss=1.14, accuracy=0.757, val_loss=1.52, val_accuracy=0.644, lr=0.0316] 42%|████▏     | 48/115 [18:57<25:42, 23.02s/epoch, loss=1.15, accuracy=0.752, val_loss=1.98, val_accuracy=0.495, lr=0.1]    43%|████▎     | 49/115 [19:19<25:16, 22.98s/epoch, loss=1.15, accuracy=0.752, val_loss=1.65, val_accuracy=0.575, lr=0.1] 43%|████▎     | 50/115 [19:42<24:53, 22.97s/epoch, loss=1.15, accuracy=0.757, val_loss=2.32, val_accuracy=0.412, lr=0.1] 44%|████▍     | 51/115 [20:05<24:28, 22.94s/epoch, loss=1.14, accuracy=0.753, val_loss=1.75, val_accuracy=0.566, lr=0.1] 45%|████▌     | 52/115 [20:28<24:07, 22.97s/epoch, loss=1.14, accuracy=0.755, val_loss=2.05, val_accuracy=0.461, lr=0.0316] 46%|████▌     | 53/115 [20:51<23:41, 22.94s/epoch, loss=1.14, accuracy=0.756, val_loss=8.18, val_accuracy=0.193, lr=0.1]    47%|████▋     | 54/115 [21:14<23:25, 23.04s/epoch, loss=1.14, accuracy=0.755, val_loss=2.63, val_accuracy=0.273, lr=0.1] 48%|████▊     | 55/115 [21:38<23:04, 23.07s/epoch, loss=1.14, accuracy=0.754, val_loss=2.15, val_accuracy=0.512, lr=0.1] 49%|████▊     | 56/115 [22:01<22:43, 23.11s/epoch, loss=1.15, accuracy=0.754, val_loss=5.23, val_accuracy=0.231, lr=0.1] 50%|████▉     | 57/115 [22:24<22:18, 23.08s/epoch, loss=1.14, accuracy=0.754, val_loss=2.22, val_accuracy=0.456, lr=0.0316] 50%|█████     | 58/115 [22:47<22:00, 23.17s/epoch, loss=1.14, accuracy=0.755, val_loss=2.19, val_accuracy=0.449, lr=0.1]    51%|█████▏    | 59/115 [23:10<21:35, 23.14s/epoch, loss=1.14, accuracy=0.753, val_loss=2.07, val_accuracy=0.471, lr=0.1] 52%|█████▏    | 60/115 [23:33<21:08, 23.07s/epoch, loss=1.15, accuracy=0.752, val_loss=1.99, val_accuracy=0.53, lr=0.1]  53%|█████▎    | 61/115 [23:56<20:42, 23.01s/epoch, loss=1.15, accuracy=0.754, val_loss=1.82, val_accuracy=0.527, lr=0.1] 54%|█████▍    | 62/115 [24:19<20:14, 22.91s/epoch, loss=1.14, accuracy=0.755, val_loss=2.1, val_accuracy=0.437, lr=0.0316] 55%|█████▍    | 63/115 [24:42<19:52, 22.93s/epoch, loss=1.15, accuracy=0.753, val_loss=1.88, val_accuracy=0.565, lr=0.1]   56%|█████▌    | 64/115 [25:05<19:28, 22.91s/epoch, loss=1.14, accuracy=0.754, val_loss=1.96, val_accuracy=0.498, lr=0.1] 57%|█████▋    | 65/115 [25:28<19:06, 22.93s/epoch, loss=1.14, accuracy=0.756, val_loss=1.47, val_accuracy=0.622, lr=0.1] 57%|█████▋    | 66/115 [25:50<18:40, 22.87s/epoch, loss=1.14, accuracy=0.757, val_loss=1.85, val_accuracy=0.558, lr=0.1] 58%|█████▊    | 67/115 [26:13<18:16, 22.84s/epoch, loss=1.14, accuracy=0.757, val_loss=1.58, val_accuracy=0.618, lr=0.0316] 59%|█████▉    | 68/115 [26:36<17:53, 22.85s/epoch, loss=1.14, accuracy=0.756, val_loss=1.79, val_accuracy=0.568, lr=0.1]    60%|██████    | 69/115 [26:58<17:26, 22.74s/epoch, loss=1.14, accuracy=0.757, val_loss=2.06, val_accuracy=0.522, lr=0.1] 61%|██████    | 70/115 [27:21<16:58, 22.64s/epoch, loss=1.13, accuracy=0.757, val_loss=1.98, val_accuracy=0.568, lr=0.1] 62%|██████▏   | 71/115 [27:44<16:39, 22.72s/epoch, loss=1.14, accuracy=0.755, val_loss=2, val_accuracy=0.495, lr=0.1]    63%|██████▎   | 72/115 [28:06<16:15, 22.70s/epoch, loss=1.13, accuracy=0.758, val_loss=1.92, val_accuracy=0.521, lr=0.0316] 63%|██████▎   | 73/115 [28:29<15:51, 22.66s/epoch, loss=1.14, accuracy=0.756, val_loss=1.8, val_accuracy=0.584, lr=0.1]     64%|██████▍   | 74/115 [28:52<15:34, 22.79s/epoch, loss=1.14, accuracy=0.756, val_loss=1.79, val_accuracy=0.57, lr=0.1] 65%|██████▌   | 75/115 [29:15<15:11, 22.79s/epoch, loss=1.13, accuracy=0.756, val_loss=1.67, val_accuracy=0.581, lr=0.1] 66%|██████▌   | 76/115 [29:38<14:50, 22.83s/epoch, loss=1.14, accuracy=0.756, val_loss=2.34, val_accuracy=0.468, lr=0.1] 67%|██████▋   | 77/115 [30:01<14:29, 22.87s/epoch, loss=1.14, accuracy=0.753, val_loss=1.76, val_accuracy=0.559, lr=0.0316] 68%|██████▊   | 78/115 [30:23<14:06, 22.87s/epoch, loss=1.13, accuracy=0.754, val_loss=2.69, val_accuracy=0.455, lr=0.1]    69%|██████▊   | 79/115 [30:46<13:41, 22.81s/epoch, loss=1.13, accuracy=0.757, val_loss=2.01, val_accuracy=0.482, lr=0.1] 70%|██████▉   | 80/115 [31:09<13:18, 22.80s/epoch, loss=1.14, accuracy=0.755, val_loss=2.76, val_accuracy=0.36, lr=0.1]  70%|███████   | 81/115 [31:32<12:54, 22.79s/epoch, loss=1.13, accuracy=0.755, val_loss=1.63, val_accuracy=0.605, lr=0.1] 71%|███████▏  | 82/115 [31:54<12:29, 22.71s/epoch, loss=0.936, accuracy=0.814, val_loss=0.901, val_accuracy=0.817, lr=0.01] 72%|███████▏  | 83/115 [32:17<12:09, 22.79s/epoch, loss=0.746, accuracy=0.847, val_loss=0.848, val_accuracy=0.798, lr=0.01] 73%|███████▎  | 84/115 [32:40<11:46, 22.78s/epoch, loss=0.661, accuracy=0.856, val_loss=0.742, val_accuracy=0.82, lr=0.01]  74%|███████▍  | 85/115 [33:03<11:24, 22.82s/epoch, loss=0.611, accuracy=0.86, val_loss=0.733, val_accuracy=0.815, lr=0.01] 75%|███████▍  | 86/115 [33:26<11:03, 22.89s/epoch, loss=0.594, accuracy=0.861, val_loss=0.746, val_accuracy=0.812, lr=0.01] 76%|███████▌  | 87/115 [33:49<10:40, 22.89s/epoch, loss=0.58, accuracy=0.864, val_loss=0.69, val_accuracy=0.825, lr=0.01]   77%|███████▋  | 88/115 [34:11<10:14, 22.77s/epoch, loss=0.573, accuracy=0.862, val_loss=0.803, val_accuracy=0.789, lr=0.01] 77%|███████▋  | 89/115 [34:34<09:54, 22.85s/epoch, loss=0.57, accuracy=0.864, val_loss=0.884, val_accuracy=0.765, lr=0.01]  78%|███████▊  | 90/115 [34:57<09:29, 22.78s/epoch, loss=0.565, accuracy=0.866, val_loss=0.701, val_accuracy=0.823, lr=0.01] 79%|███████▉  | 91/115 [35:20<09:05, 22.73s/epoch, loss=0.568, accuracy=0.867, val_loss=0.724, val_accuracy=0.819, lr=0.01] 80%|████████  | 92/115 [35:42<08:42, 22.70s/epoch, loss=0.566, accuracy=0.868, val_loss=0.791, val_accuracy=0.797, lr=0.00316] 81%|████████  | 93/115 [36:05<08:19, 22.72s/epoch, loss=0.563, accuracy=0.87, val_loss=1.03, val_accuracy=0.733, lr=0.01]      82%|████████▏ | 94/115 [36:28<07:58, 22.79s/epoch, loss=0.565, accuracy=0.871, val_loss=0.806, val_accuracy=0.787, lr=0.01] 83%|████████▎ | 95/115 [36:50<07:33, 22.67s/epoch, loss=0.561, accuracy=0.872, val_loss=0.75, val_accuracy=0.813, lr=0.01]  83%|████████▎ | 96/115 [37:13<07:11, 22.69s/epoch, loss=0.562, accuracy=0.872, val_loss=0.923, val_accuracy=0.757, lr=0.01] 84%|████████▍ | 97/115 [37:35<06:46, 22.60s/epoch, loss=0.558, accuracy=0.875, val_loss=0.867, val_accuracy=0.783, lr=0.00316] 85%|████████▌ | 98/115 [37:58<06:22, 22.51s/epoch, loss=0.558, accuracy=0.875, val_loss=0.842, val_accuracy=0.79, lr=0.01]     86%|████████▌ | 99/115 [38:20<06:00, 22.52s/epoch, loss=0.558, accuracy=0.876, val_loss=0.923, val_accuracy=0.762, lr=0.01] 87%|████████▋ | 100/115 [38:43<05:39, 22.62s/epoch, loss=0.558, accuracy=0.876, val_loss=1.11, val_accuracy=0.724, lr=0.01] 88%|████████▊ | 101/115 [39:06<05:17, 22.68s/epoch, loss=0.562, accuracy=0.876, val_loss=0.783, val_accuracy=0.811, lr=0.01] 89%|████████▊ | 102/115 [39:29<04:55, 22.71s/epoch, loss=0.557, accuracy=0.878, val_loss=0.688, val_accuracy=0.834, lr=0.01] 90%|████████▉ | 103/115 [39:51<04:32, 22.71s/epoch, loss=0.558, accuracy=0.88, val_loss=0.763, val_accuracy=0.813, lr=0.01]  90%|█████████ | 104/115 [40:14<04:09, 22.65s/epoch, loss=0.561, accuracy=0.878, val_loss=0.855, val_accuracy=0.787, lr=0.01] 91%|█████████▏| 105/115 [40:37<03:47, 22.70s/epoch, loss=0.558, accuracy=0.879, val_loss=0.771, val_accuracy=0.816, lr=0.01] 92%|█████████▏| 106/115 [40:59<03:23, 22.60s/epoch, loss=0.56, accuracy=0.879, val_loss=0.829, val_accuracy=0.786, lr=0.01]  93%|█████████▎| 107/115 [41:22<03:00, 22.61s/epoch, loss=0.558, accuracy=0.879, val_loss=0.958, val_accuracy=0.754, lr=0.00316] 94%|█████████▍| 108/115 [41:44<02:38, 22.61s/epoch, loss=0.559, accuracy=0.88, val_loss=0.847, val_accuracy=0.782, lr=0.01]     95%|█████████▍| 109/115 [42:07<02:14, 22.47s/epoch, loss=0.555, accuracy=0.881, val_loss=0.735, val_accuracy=0.825, lr=0.01] 96%|█████████▌| 110/115 [42:29<01:51, 22.36s/epoch, loss=0.558, accuracy=0.88, val_loss=0.729, val_accuracy=0.831, lr=0.01]  97%|█████████▋| 111/115 [42:51<01:29, 22.29s/epoch, loss=0.56, accuracy=0.88, val_loss=0.73, val_accuracy=0.825, lr=0.01]   97%|█████████▋| 112/115 [43:14<01:07, 22.42s/epoch, loss=0.56, accuracy=0.881, val_loss=0.788, val_accuracy=0.81, lr=0.00316] 98%|█████████▊| 113/115 [43:36<00:44, 22.41s/epoch, loss=0.557, accuracy=0.883, val_loss=0.738, val_accuracy=0.826, lr=0.01]  99%|█████████▉| 114/115 [43:58<00:22, 22.46s/epoch, loss=0.557, accuracy=0.881, val_loss=0.86, val_accuracy=0.806, lr=0.01] 100%|██████████| 115/115 [44:21<00:00, 22.52s/epoch, loss=0.561, accuracy=0.88, val_loss=0.943, val_accuracy=0.773, lr=0.01]100%|██████████| 115/115 [44:21<00:00, 23.14s/epoch, loss=0.561, accuracy=0.88, val_loss=0.943, val_accuracy=0.773, lr=0.01]
Using real-time data augmentation.
Test loss: 0.9430659413337708
Test accuracy: 0.7728000283241272


* * * Run SGD for ID = 13_6. * * *


2024-02-15 16:40:53.370566: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 16:40:55.785092: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 16:40:55.786322: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-15 16:40:55.821511: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-02-15 16:40:55.821541: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 16:40:55.824184: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 16:40:55.824224: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 16:40:55.826188: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 16:40:55.826733: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 16:40:55.829033: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 16:40:55.830343: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 16:40:55.834706: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 16:40:55.835255: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 16:40:55.835341: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 16:40:57.030970: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-15 16:40:57.032026: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 16:40:57.032630: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-02-15 16:40:57.032662: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 16:40:57.032713: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 16:40:57.032734: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 16:40:57.032753: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 16:40:57.032772: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 16:40:57.032795: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 16:40:57.032819: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 16:40:57.032838: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 16:40:57.033259: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 16:40:57.033300: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 16:40:57.680521: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-15 16:40:57.680587: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-15 16:40:57.680604: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-15 16:40:57.681840: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11227 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN X (Pascal), pci bus id: 0000:03:00.0, compute capability: 6.1)
{'id': 136, 'batch_size': 128, 'epochs': 115, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN X (Pascal)'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/115 [00:00<?, ?epoch/s]2024-02-15 16:40:58.450320: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-15 16:40:58.462408: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2599900000 Hz
2024-02-15 16:41:00.271159: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 16:41:00.508650: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 16:41:01.286410: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-15 16:41:01.347556: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/115 [00:50<1:36:44, 50.92s/epoch, loss=3.2, accuracy=0.303, val_loss=2.84, val_accuracy=0.224, lr=0.1]  2%|▏         | 2/115 [01:13<1:05:03, 34.54s/epoch, loss=1.55, accuracy=0.538, val_loss=1.95, val_accuracy=0.435, lr=0.1]  3%|▎         | 3/115 [01:36<54:36, 29.26s/epoch, loss=1.35, accuracy=0.628, val_loss=1.68, val_accuracy=0.53, lr=0.1]     3%|▎         | 4/115 [01:59<49:25, 26.72s/epoch, loss=1.28, accuracy=0.675, val_loss=2.57, val_accuracy=0.319, lr=0.1]  4%|▍         | 5/115 [02:22<46:24, 25.31s/epoch, loss=1.25, accuracy=0.696, val_loss=1.6, val_accuracy=0.58, lr=0.1]    5%|▌         | 6/115 [02:45<44:16, 24.37s/epoch, loss=1.24, accuracy=0.706, val_loss=1.54, val_accuracy=0.573, lr=0.1]  6%|▌         | 7/115 [03:07<42:54, 23.83s/epoch, loss=1.22, accuracy=0.714, val_loss=2.28, val_accuracy=0.476, lr=0.1]  7%|▋         | 8/115 [03:30<41:52, 23.48s/epoch, loss=1.21, accuracy=0.719, val_loss=1.71, val_accuracy=0.531, lr=0.1]  8%|▊         | 9/115 [03:53<41:08, 23.29s/epoch, loss=1.21, accuracy=0.722, val_loss=1.63, val_accuracy=0.584, lr=0.1]  9%|▊         | 10/115 [04:16<40:30, 23.15s/epoch, loss=1.19, accuracy=0.73, val_loss=1.93, val_accuracy=0.498, lr=0.1] 10%|▉         | 11/115 [04:38<39:49, 22.98s/epoch, loss=1.19, accuracy=0.732, val_loss=2.42, val_accuracy=0.473, lr=0.0316] 10%|█         | 12/115 [05:01<39:20, 22.92s/epoch, loss=1.19, accuracy=0.733, val_loss=1.84, val_accuracy=0.548, lr=0.1]    11%|█▏        | 13/115 [05:24<38:54, 22.89s/epoch, loss=1.19, accuracy=0.735, val_loss=2.02, val_accuracy=0.543, lr=0.1] 12%|█▏        | 14/115 [05:46<38:14, 22.72s/epoch, loss=1.18, accuracy=0.738, val_loss=2.04, val_accuracy=0.436, lr=0.1] 13%|█▎        | 15/115 [06:09<37:58, 22.79s/epoch, loss=1.17, accuracy=0.739, val_loss=1.67, val_accuracy=0.568, lr=0.1] 14%|█▍        | 16/115 [06:32<37:40, 22.83s/epoch, loss=1.17, accuracy=0.741, val_loss=2.15, val_accuracy=0.432, lr=0.0316] 15%|█▍        | 17/115 [06:55<37:08, 22.74s/epoch, loss=1.17, accuracy=0.741, val_loss=1.45, val_accuracy=0.627, lr=0.1]    16%|█▌        | 18/115 [07:17<36:41, 22.69s/epoch, loss=1.17, accuracy=0.741, val_loss=1.93, val_accuracy=0.454, lr=0.1] 17%|█▋        | 19/115 [07:40<36:20, 22.71s/epoch, loss=1.17, accuracy=0.744, val_loss=1.81, val_accuracy=0.55, lr=0.1]  17%|█▋        | 20/115 [08:03<35:52, 22.66s/epoch, loss=1.17, accuracy=0.742, val_loss=1.91, val_accuracy=0.454, lr=0.1] 18%|█▊        | 21/115 [08:25<35:33, 22.69s/epoch, loss=1.16, accuracy=0.743, val_loss=3.72, val_accuracy=0.374, lr=0.1] 19%|█▉        | 22/115 [08:48<34:59, 22.57s/epoch, loss=1.16, accuracy=0.745, val_loss=2.39, val_accuracy=0.414, lr=0.0316] 20%|██        | 23/115 [09:10<34:42, 22.64s/epoch, loss=1.16, accuracy=0.744, val_loss=1.88, val_accuracy=0.562, lr=0.1]    21%|██        | 24/115 [09:33<34:20, 22.64s/epoch, loss=1.16, accuracy=0.745, val_loss=1.65, val_accuracy=0.57, lr=0.1]  22%|██▏       | 25/115 [09:56<34:02, 22.70s/epoch, loss=1.16, accuracy=0.746, val_loss=1.41, val_accuracy=0.663, lr=0.1] 23%|██▎       | 26/115 [10:19<33:42, 22.72s/epoch, loss=1.16, accuracy=0.749, val_loss=3.79, val_accuracy=0.296, lr=0.1] 23%|██▎       | 27/115 [10:42<33:22, 22.75s/epoch, loss=1.15, accuracy=0.749, val_loss=1.66, val_accuracy=0.597, lr=0.1] 24%|██▍       | 28/115 [11:04<33:03, 22.80s/epoch, loss=1.15, accuracy=0.748, val_loss=1.55, val_accuracy=0.603, lr=0.1] 25%|██▌       | 29/115 [11:27<32:31, 22.69s/epoch, loss=1.14, accuracy=0.751, val_loss=1.68, val_accuracy=0.535, lr=0.1] 26%|██▌       | 30/115 [11:50<32:13, 22.74s/epoch, loss=1.14, accuracy=0.751, val_loss=3.43, val_accuracy=0.386, lr=0.0316] 27%|██▋       | 31/115 [12:12<31:45, 22.68s/epoch, loss=1.14, accuracy=0.751, val_loss=1.45, val_accuracy=0.647, lr=0.1]    28%|██▊       | 32/115 [12:35<31:31, 22.79s/epoch, loss=1.14, accuracy=0.753, val_loss=3.08, val_accuracy=0.345, lr=0.1] 29%|██▊       | 33/115 [12:58<31:06, 22.76s/epoch, loss=1.14, accuracy=0.752, val_loss=1.77, val_accuracy=0.602, lr=0.1] 30%|██▉       | 34/115 [13:21<30:43, 22.76s/epoch, loss=1.14, accuracy=0.751, val_loss=1.9, val_accuracy=0.491, lr=0.1]  30%|███       | 35/115 [13:44<30:21, 22.77s/epoch, loss=1.14, accuracy=0.752, val_loss=2.29, val_accuracy=0.445, lr=0.0316] 31%|███▏      | 36/115 [14:06<29:59, 22.78s/epoch, loss=1.14, accuracy=0.751, val_loss=1.82, val_accuracy=0.562, lr=0.1]    32%|███▏      | 37/115 [14:29<29:40, 22.82s/epoch, loss=1.14, accuracy=0.751, val_loss=1.63, val_accuracy=0.594, lr=0.1] 33%|███▎      | 38/115 [14:52<29:09, 22.73s/epoch, loss=1.14, accuracy=0.751, val_loss=1.76, val_accuracy=0.571, lr=0.1] 34%|███▍      | 39/115 [15:15<28:47, 22.74s/epoch, loss=1.13, accuracy=0.752, val_loss=2.16, val_accuracy=0.485, lr=0.1] 35%|███▍      | 40/115 [15:38<28:31, 22.82s/epoch, loss=1.13, accuracy=0.755, val_loss=1.42, val_accuracy=0.658, lr=0.0316] 36%|███▌      | 41/115 [16:01<28:11, 22.85s/epoch, loss=1.14, accuracy=0.753, val_loss=3.85, val_accuracy=0.286, lr=0.1]    37%|███▋      | 42/115 [16:23<27:50, 22.88s/epoch, loss=1.14, accuracy=0.752, val_loss=1.77, val_accuracy=0.546, lr=0.1] 37%|███▋      | 43/115 [16:46<27:27, 22.89s/epoch, loss=1.14, accuracy=0.749, val_loss=2.55, val_accuracy=0.391, lr=0.1] 38%|███▊      | 44/115 [17:09<27:04, 22.88s/epoch, loss=1.13, accuracy=0.755, val_loss=2.47, val_accuracy=0.451, lr=0.1] 39%|███▉      | 45/115 [17:32<26:44, 22.93s/epoch, loss=1.14, accuracy=0.753, val_loss=3.22, val_accuracy=0.44, lr=0.0316] 40%|████      | 46/115 [17:55<26:16, 22.85s/epoch, loss=1.13, accuracy=0.753, val_loss=1.87, val_accuracy=0.563, lr=0.1]   41%|████      | 47/115 [18:18<25:53, 22.84s/epoch, loss=1.13, accuracy=0.753, val_loss=2.25, val_accuracy=0.519, lr=0.1] 42%|████▏     | 48/115 [18:41<25:34, 22.90s/epoch, loss=1.13, accuracy=0.752, val_loss=4.32, val_accuracy=0.332, lr=0.1] 43%|████▎     | 49/115 [19:04<25:10, 22.89s/epoch, loss=1.13, accuracy=0.751, val_loss=2.42, val_accuracy=0.484, lr=0.1] 43%|████▎     | 50/115 [19:26<24:46, 22.87s/epoch, loss=1.14, accuracy=0.753, val_loss=1.67, val_accuracy=0.577, lr=0.0316] 44%|████▍     | 51/115 [19:49<24:23, 22.86s/epoch, loss=1.13, accuracy=0.756, val_loss=4.03, val_accuracy=0.354, lr=0.1]    45%|████▌     | 52/115 [20:12<23:57, 22.82s/epoch, loss=1.13, accuracy=0.755, val_loss=2.41, val_accuracy=0.444, lr=0.1] 46%|████▌     | 53/115 [20:35<23:33, 22.80s/epoch, loss=1.13, accuracy=0.754, val_loss=1.62, val_accuracy=0.588, lr=0.1] 47%|████▋     | 54/115 [20:58<23:10, 22.80s/epoch, loss=1.14, accuracy=0.753, val_loss=2.18, val_accuracy=0.442, lr=0.1] 48%|████▊     | 55/115 [21:20<22:41, 22.69s/epoch, loss=1.13, accuracy=0.753, val_loss=2, val_accuracy=0.448, lr=0.0316] 49%|████▊     | 56/115 [21:43<22:18, 22.69s/epoch, loss=1.14, accuracy=0.751, val_loss=2.28, val_accuracy=0.443, lr=0.1] 50%|████▉     | 57/115 [22:05<21:57, 22.71s/epoch, loss=1.13, accuracy=0.752, val_loss=1.8, val_accuracy=0.537, lr=0.1]  50%|█████     | 58/115 [22:28<21:38, 22.78s/epoch, loss=1.13, accuracy=0.752, val_loss=1.64, val_accuracy=0.609, lr=0.1] 51%|█████▏    | 59/115 [22:51<21:19, 22.85s/epoch, loss=1.13, accuracy=0.755, val_loss=1.67, val_accuracy=0.587, lr=0.1] 52%|█████▏    | 60/115 [23:14<20:55, 22.83s/epoch, loss=1.13, accuracy=0.754, val_loss=1.78, val_accuracy=0.571, lr=0.0316] 53%|█████▎    | 61/115 [23:37<20:34, 22.86s/epoch, loss=1.13, accuracy=0.755, val_loss=1.42, val_accuracy=0.661, lr=0.1]    54%|█████▍    | 62/115 [24:00<20:12, 22.87s/epoch, loss=1.14, accuracy=0.752, val_loss=2.12, val_accuracy=0.524, lr=0.1] 55%|█████▍    | 63/115 [24:23<19:50, 22.89s/epoch, loss=1.13, accuracy=0.756, val_loss=2.58, val_accuracy=0.477, lr=0.1] 56%|█████▌    | 64/115 [24:46<19:22, 22.80s/epoch, loss=1.12, accuracy=0.755, val_loss=1.89, val_accuracy=0.525, lr=0.1] 57%|█████▋    | 65/115 [25:08<19:01, 22.82s/epoch, loss=1.13, accuracy=0.753, val_loss=2.63, val_accuracy=0.365, lr=0.0316] 57%|█████▋    | 66/115 [25:31<18:32, 22.70s/epoch, loss=1.13, accuracy=0.753, val_loss=2.89, val_accuracy=0.402, lr=0.1]    58%|█████▊    | 67/115 [25:53<18:05, 22.62s/epoch, loss=1.13, accuracy=0.756, val_loss=1.72, val_accuracy=0.592, lr=0.1] 59%|█████▉    | 68/115 [26:16<17:46, 22.70s/epoch, loss=1.13, accuracy=0.755, val_loss=3.13, val_accuracy=0.345, lr=0.1] 60%|██████    | 69/115 [26:39<17:24, 22.72s/epoch, loss=1.13, accuracy=0.752, val_loss=2.11, val_accuracy=0.513, lr=0.1] 61%|██████    | 70/115 [27:02<17:02, 22.72s/epoch, loss=1.13, accuracy=0.756, val_loss=1.57, val_accuracy=0.594, lr=0.0316] 62%|██████▏   | 71/115 [27:25<16:41, 22.76s/epoch, loss=1.13, accuracy=0.755, val_loss=5.28, val_accuracy=0.26, lr=0.1]     63%|██████▎   | 72/115 [27:47<16:16, 22.72s/epoch, loss=1.13, accuracy=0.757, val_loss=3.48, val_accuracy=0.429, lr=0.1] 63%|██████▎   | 73/115 [28:10<15:57, 22.79s/epoch, loss=1.13, accuracy=0.757, val_loss=2.73, val_accuracy=0.395, lr=0.1] 64%|██████▍   | 74/115 [28:33<15:31, 22.71s/epoch, loss=1.13, accuracy=0.756, val_loss=4.37, val_accuracy=0.243, lr=0.1] 65%|██████▌   | 75/115 [28:55<15:09, 22.74s/epoch, loss=1.12, accuracy=0.757, val_loss=1.92, val_accuracy=0.476, lr=0.0316] 66%|██████▌   | 76/115 [29:18<14:41, 22.60s/epoch, loss=1.12, accuracy=0.755, val_loss=1.91, val_accuracy=0.46, lr=0.1]     67%|██████▋   | 77/115 [29:41<14:21, 22.67s/epoch, loss=1.13, accuracy=0.755, val_loss=1.55, val_accuracy=0.599, lr=0.1] 68%|██████▊   | 78/115 [30:03<14:01, 22.75s/epoch, loss=1.13, accuracy=0.755, val_loss=2.06, val_accuracy=0.444, lr=0.1] 69%|██████▊   | 79/115 [30:26<13:38, 22.74s/epoch, loss=1.13, accuracy=0.755, val_loss=2.87, val_accuracy=0.384, lr=0.1] 70%|██████▉   | 80/115 [30:49<13:12, 22.64s/epoch, loss=1.13, accuracy=0.757, val_loss=1.82, val_accuracy=0.555, lr=0.0316] 70%|███████   | 81/115 [31:11<12:51, 22.71s/epoch, loss=1.13, accuracy=0.755, val_loss=2.47, val_accuracy=0.407, lr=0.1]    71%|███████▏  | 82/115 [31:34<12:29, 22.72s/epoch, loss=0.911, accuracy=0.815, val_loss=0.974, val_accuracy=0.771, lr=0.01] 72%|███████▏  | 83/115 [31:57<12:06, 22.71s/epoch, loss=0.735, accuracy=0.847, val_loss=0.781, val_accuracy=0.82, lr=0.01]  73%|███████▎  | 84/115 [32:20<11:43, 22.68s/epoch, loss=0.652, accuracy=0.854, val_loss=0.939, val_accuracy=0.762, lr=0.01] 74%|███████▍  | 85/115 [32:42<11:16, 22.55s/epoch, loss=0.61, accuracy=0.859, val_loss=0.724, val_accuracy=0.816, lr=0.01]  75%|███████▍  | 86/115 [33:04<10:55, 22.59s/epoch, loss=0.586, accuracy=0.861, val_loss=0.916, val_accuracy=0.75, lr=0.01] 76%|███████▌  | 87/115 [33:27<10:29, 22.48s/epoch, loss=0.573, accuracy=0.863, val_loss=0.839, val_accuracy=0.791, lr=0.01] 77%|███████▋  | 88/115 [33:49<10:05, 22.43s/epoch, loss=0.569, accuracy=0.863, val_loss=1.23, val_accuracy=0.655, lr=0.01]  77%|███████▋  | 89/115 [34:12<09:45, 22.53s/epoch, loss=0.57, accuracy=0.865, val_loss=0.778, val_accuracy=0.795, lr=0.01] 78%|███████▊  | 90/115 [34:34<09:23, 22.54s/epoch, loss=0.562, accuracy=0.867, val_loss=0.77, val_accuracy=0.794, lr=0.00316] 79%|███████▉  | 91/115 [34:57<09:01, 22.58s/epoch, loss=0.565, accuracy=0.866, val_loss=0.753, val_accuracy=0.799, lr=0.01]   80%|████████  | 92/115 [35:19<08:38, 22.56s/epoch, loss=0.562, accuracy=0.87, val_loss=0.761, val_accuracy=0.802, lr=0.01]  81%|████████  | 93/115 [35:42<08:18, 22.64s/epoch, loss=0.554, accuracy=0.872, val_loss=1.16, val_accuracy=0.726, lr=0.01] 82%|████████▏ | 94/115 [36:05<07:55, 22.64s/epoch, loss=0.554, accuracy=0.872, val_loss=1.04, val_accuracy=0.745, lr=0.01] 83%|████████▎ | 95/115 [36:27<07:31, 22.59s/epoch, loss=0.558, accuracy=0.872, val_loss=0.841, val_accuracy=0.78, lr=0.00316] 83%|████████▎ | 96/115 [36:50<07:10, 22.66s/epoch, loss=0.564, accuracy=0.871, val_loss=0.69, val_accuracy=0.83, lr=0.01]     84%|████████▍ | 97/115 [37:13<06:48, 22.68s/epoch, loss=0.559, accuracy=0.875, val_loss=0.87, val_accuracy=0.775, lr=0.01] 85%|████████▌ | 98/115 [37:36<06:26, 22.71s/epoch, loss=0.555, accuracy=0.876, val_loss=0.809, val_accuracy=0.797, lr=0.01] 86%|████████▌ | 99/115 [37:59<06:04, 22.77s/epoch, loss=0.557, accuracy=0.877, val_loss=0.744, val_accuracy=0.809, lr=0.01] 87%|████████▋ | 100/115 [38:21<05:39, 22.64s/epoch, loss=0.552, accuracy=0.877, val_loss=0.921, val_accuracy=0.772, lr=0.01] 88%|████████▊ | 101/115 [38:44<05:17, 22.67s/epoch, loss=0.554, accuracy=0.877, val_loss=0.876, val_accuracy=0.774, lr=0.00316] 89%|████████▊ | 102/115 [39:06<04:51, 22.46s/epoch, loss=0.553, accuracy=0.878, val_loss=0.767, val_accuracy=0.812, lr=0.01]    90%|████████▉ | 103/115 [39:29<04:30, 22.57s/epoch, loss=0.552, accuracy=0.88, val_loss=1.07, val_accuracy=0.738, lr=0.01]   90%|█████████ | 104/115 [39:51<04:09, 22.67s/epoch, loss=0.557, accuracy=0.878, val_loss=1.09, val_accuracy=0.735, lr=0.01] 91%|█████████▏| 105/115 [40:14<03:46, 22.68s/epoch, loss=0.551, accuracy=0.88, val_loss=0.808, val_accuracy=0.804, lr=0.01] 92%|█████████▏| 106/115 [40:37<03:24, 22.69s/epoch, loss=0.553, accuracy=0.881, val_loss=1.19, val_accuracy=0.724, lr=0.00316] 93%|█████████▎| 107/115 [41:00<03:01, 22.68s/epoch, loss=0.55, accuracy=0.881, val_loss=0.9, val_accuracy=0.783, lr=0.01]      94%|█████████▍| 108/115 [41:22<02:38, 22.71s/epoch, loss=0.553, accuracy=0.882, val_loss=0.804, val_accuracy=0.802, lr=0.01] 95%|█████████▍| 109/115 [41:45<02:16, 22.69s/epoch, loss=0.557, accuracy=0.881, val_loss=0.785, val_accuracy=0.812, lr=0.01] 96%|█████████▌| 110/115 [42:08<01:53, 22.68s/epoch, loss=0.55, accuracy=0.882, val_loss=0.795, val_accuracy=0.813, lr=0.01]  97%|█████████▋| 111/115 [42:30<01:30, 22.61s/epoch, loss=0.555, accuracy=0.881, val_loss=0.679, val_accuracy=0.842, lr=0.01] 97%|█████████▋| 112/115 [42:53<01:07, 22.63s/epoch, loss=0.549, accuracy=0.883, val_loss=0.717, val_accuracy=0.825, lr=0.01] 98%|█████████▊| 113/115 [43:15<00:45, 22.64s/epoch, loss=0.553, accuracy=0.882, val_loss=1.1, val_accuracy=0.731, lr=0.01]   99%|█████████▉| 114/115 [43:38<00:22, 22.60s/epoch, loss=0.551, accuracy=0.883, val_loss=0.8, val_accuracy=0.803, lr=0.01]100%|██████████| 115/115 [44:00<00:00, 22.60s/epoch, loss=0.55, accuracy=0.884, val_loss=1.03, val_accuracy=0.744, lr=0.01]100%|██████████| 115/115 [44:00<00:00, 22.97s/epoch, loss=0.55, accuracy=0.884, val_loss=1.03, val_accuracy=0.744, lr=0.01]
Using real-time data augmentation.
Test loss: 1.0339473485946655
Test accuracy: 0.7444000244140625


* * * Run SGD for ID = 13_7. * * *


2024-02-15 17:25:01.678287: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 17:25:04.396477: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 17:25:04.397529: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-15 17:25:04.432581: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-02-15 17:25:04.432628: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 17:25:04.435243: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 17:25:04.435285: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 17:25:04.437654: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 17:25:04.438472: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 17:25:04.440641: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 17:25:04.441995: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 17:25:04.446493: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 17:25:04.446976: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 17:25:04.447064: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 17:25:05.655827: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-15 17:25:05.656870: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 17:25:05.658116: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-02-15 17:25:05.658152: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 17:25:05.658261: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 17:25:05.658302: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 17:25:05.658331: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 17:25:05.658357: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 17:25:05.658382: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 17:25:05.658408: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 17:25:05.658433: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 17:25:05.658878: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 17:25:05.658922: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 17:25:06.296373: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-15 17:25:06.296435: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-15 17:25:06.296445: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-15 17:25:06.297370: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11227 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN X (Pascal), pci bus id: 0000:03:00.0, compute capability: 6.1)
{'id': 137, 'batch_size': 128, 'epochs': 115, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN X (Pascal)'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/115 [00:00<?, ?epoch/s]2024-02-15 17:25:07.089198: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-15 17:25:07.101401: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2599900000 Hz
2024-02-15 17:25:08.923190: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 17:25:09.124339: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 17:25:09.898439: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-15 17:25:09.943828: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/115 [01:07<2:08:25, 67.60s/epoch, loss=3.55, accuracy=0.31, val_loss=2.26, val_accuracy=0.326, lr=0.1]  2%|▏         | 2/115 [01:30<1:17:18, 41.05s/epoch, loss=1.62, accuracy=0.509, val_loss=2.26, val_accuracy=0.325, lr=0.1]  3%|▎         | 3/115 [01:52<1:00:37, 32.48s/epoch, loss=1.39, accuracy=0.618, val_loss=1.48, val_accuracy=0.603, lr=0.1]  3%|▎         | 4/115 [02:14<52:41, 28.48s/epoch, loss=1.3, accuracy=0.67, val_loss=2.09, val_accuracy=0.494, lr=0.1]      4%|▍         | 5/115 [02:37<48:44, 26.59s/epoch, loss=1.27, accuracy=0.694, val_loss=2.35, val_accuracy=0.432, lr=0.1]  5%|▌         | 6/115 [03:01<46:30, 25.60s/epoch, loss=1.24, accuracy=0.708, val_loss=1.92, val_accuracy=0.476, lr=0.1]  6%|▌         | 7/115 [03:25<44:54, 24.94s/epoch, loss=1.24, accuracy=0.712, val_loss=1.48, val_accuracy=0.629, lr=0.1]  7%|▋         | 8/115 [03:48<43:42, 24.51s/epoch, loss=1.22, accuracy=0.72, val_loss=2.27, val_accuracy=0.443, lr=0.1]   8%|▊         | 9/115 [04:11<42:29, 24.05s/epoch, loss=1.22, accuracy=0.722, val_loss=2.06, val_accuracy=0.489, lr=0.1]  9%|▊         | 10/115 [04:35<41:54, 23.95s/epoch, loss=1.22, accuracy=0.726, val_loss=2, val_accuracy=0.458, lr=0.1]   10%|▉         | 11/115 [04:58<40:47, 23.54s/epoch, loss=1.21, accuracy=0.729, val_loss=1.46, val_accuracy=0.633, lr=0.1] 10%|█         | 12/115 [05:21<40:30, 23.60s/epoch, loss=1.21, accuracy=0.733, val_loss=2.05, val_accuracy=0.476, lr=0.1] 11%|█▏        | 13/115 [05:45<39:56, 23.50s/epoch, loss=1.21, accuracy=0.733, val_loss=1.58, val_accuracy=0.588, lr=0.1] 12%|█▏        | 14/115 [06:09<39:44, 23.61s/epoch, loss=1.21, accuracy=0.731, val_loss=1.65, val_accuracy=0.562, lr=0.1] 13%|█▎        | 15/115 [06:32<39:26, 23.67s/epoch, loss=1.2, accuracy=0.738, val_loss=1.98, val_accuracy=0.53, lr=0.1]   14%|█▍        | 16/115 [06:56<39:08, 23.73s/epoch, loss=1.2, accuracy=0.736, val_loss=3.37, val_accuracy=0.298, lr=0.0316] 15%|█▍        | 17/115 [07:20<38:45, 23.73s/epoch, loss=1.2, accuracy=0.738, val_loss=1.95, val_accuracy=0.513, lr=0.1]    16%|█▌        | 18/115 [07:44<38:22, 23.74s/epoch, loss=1.2, accuracy=0.738, val_loss=2.05, val_accuracy=0.503, lr=0.1] 17%|█▋        | 19/115 [08:07<37:54, 23.70s/epoch, loss=1.19, accuracy=0.74, val_loss=1.83, val_accuracy=0.544, lr=0.1] 17%|█▋        | 20/115 [08:31<37:22, 23.60s/epoch, loss=1.2, accuracy=0.738, val_loss=2.02, val_accuracy=0.44, lr=0.1]  18%|█▊        | 21/115 [08:54<36:57, 23.59s/epoch, loss=1.19, accuracy=0.742, val_loss=1.51, val_accuracy=0.617, lr=0.0316] 19%|█▉        | 22/115 [09:18<36:36, 23.62s/epoch, loss=1.19, accuracy=0.744, val_loss=1.86, val_accuracy=0.467, lr=0.1]    20%|██        | 23/115 [09:41<36:07, 23.56s/epoch, loss=1.18, accuracy=0.743, val_loss=2.55, val_accuracy=0.418, lr=0.1] 21%|██        | 24/115 [10:05<35:47, 23.60s/epoch, loss=1.18, accuracy=0.744, val_loss=1.88, val_accuracy=0.558, lr=0.1] 22%|██▏       | 25/115 [10:29<35:24, 23.61s/epoch, loss=1.18, accuracy=0.742, val_loss=1.78, val_accuracy=0.576, lr=0.1] 23%|██▎       | 26/115 [10:52<35:05, 23.66s/epoch, loss=1.18, accuracy=0.744, val_loss=2.43, val_accuracy=0.406, lr=0.0316] 23%|██▎       | 27/115 [11:16<34:36, 23.60s/epoch, loss=1.17, accuracy=0.747, val_loss=2.09, val_accuracy=0.492, lr=0.1]    24%|██▍       | 28/115 [11:40<34:23, 23.72s/epoch, loss=1.18, accuracy=0.747, val_loss=1.81, val_accuracy=0.551, lr=0.1] 25%|██▌       | 29/115 [12:04<33:58, 23.70s/epoch, loss=1.17, accuracy=0.749, val_loss=2.44, val_accuracy=0.438, lr=0.1] 26%|██▌       | 30/115 [12:27<33:36, 23.73s/epoch, loss=1.17, accuracy=0.748, val_loss=2.54, val_accuracy=0.449, lr=0.1] 27%|██▋       | 31/115 [12:51<33:10, 23.70s/epoch, loss=1.17, accuracy=0.748, val_loss=2.09, val_accuracy=0.532, lr=0.0316] 28%|██▊       | 32/115 [13:15<32:46, 23.69s/epoch, loss=1.17, accuracy=0.748, val_loss=4.83, val_accuracy=0.229, lr=0.1]    29%|██▊       | 33/115 [13:38<32:23, 23.70s/epoch, loss=1.17, accuracy=0.749, val_loss=2.3, val_accuracy=0.424, lr=0.1]  30%|██▉       | 34/115 [14:02<31:54, 23.64s/epoch, loss=1.16, accuracy=0.748, val_loss=3.05, val_accuracy=0.316, lr=0.1] 30%|███       | 35/115 [14:25<31:23, 23.54s/epoch, loss=1.16, accuracy=0.749, val_loss=2.35, val_accuracy=0.46, lr=0.1]  31%|███▏      | 36/115 [14:49<31:09, 23.66s/epoch, loss=1.16, accuracy=0.748, val_loss=1.61, val_accuracy=0.619, lr=0.0316] 32%|███▏      | 37/115 [15:13<30:45, 23.67s/epoch, loss=1.15, accuracy=0.753, val_loss=2.15, val_accuracy=0.498, lr=0.1]    33%|███▎      | 38/115 [15:37<30:24, 23.70s/epoch, loss=1.16, accuracy=0.751, val_loss=1.94, val_accuracy=0.551, lr=0.1] 34%|███▍      | 39/115 [16:00<29:56, 23.63s/epoch, loss=1.16, accuracy=0.749, val_loss=1.86, val_accuracy=0.534, lr=0.1] 35%|███▍      | 40/115 [16:24<29:33, 23.64s/epoch, loss=1.16, accuracy=0.752, val_loss=2.2, val_accuracy=0.453, lr=0.1]  36%|███▌      | 41/115 [16:47<29:10, 23.66s/epoch, loss=1.15, accuracy=0.753, val_loss=3.17, val_accuracy=0.306, lr=0.0316] 37%|███▋      | 42/115 [17:11<28:44, 23.63s/epoch, loss=1.16, accuracy=0.75, val_loss=1.6, val_accuracy=0.646, lr=0.1]      37%|███▋      | 43/115 [17:35<28:21, 23.63s/epoch, loss=1.16, accuracy=0.751, val_loss=2.88, val_accuracy=0.348, lr=0.1] 38%|███▊      | 44/115 [17:58<27:55, 23.60s/epoch, loss=1.16, accuracy=0.751, val_loss=2.1, val_accuracy=0.425, lr=0.1]  39%|███▉      | 45/115 [18:22<27:31, 23.60s/epoch, loss=1.15, accuracy=0.751, val_loss=3.41, val_accuracy=0.326, lr=0.1] 40%|████      | 46/115 [18:45<27:06, 23.57s/epoch, loss=1.15, accuracy=0.751, val_loss=1.62, val_accuracy=0.584, lr=0.0316] 41%|████      | 47/115 [19:09<26:45, 23.61s/epoch, loss=1.15, accuracy=0.75, val_loss=3.06, val_accuracy=0.193, lr=0.1]     42%|████▏     | 48/115 [19:32<26:20, 23.59s/epoch, loss=1.15, accuracy=0.753, val_loss=1.76, val_accuracy=0.524, lr=0.1] 43%|████▎     | 49/115 [19:56<25:59, 23.63s/epoch, loss=1.15, accuracy=0.754, val_loss=3.5, val_accuracy=0.296, lr=0.1]  43%|████▎     | 50/115 [20:19<25:26, 23.49s/epoch, loss=1.14, accuracy=0.752, val_loss=1.59, val_accuracy=0.612, lr=0.1] 44%|████▍     | 51/115 [20:43<25:04, 23.51s/epoch, loss=1.15, accuracy=0.751, val_loss=1.62, val_accuracy=0.603, lr=0.0316] 45%|████▌     | 52/115 [21:07<24:45, 23.58s/epoch, loss=1.15, accuracy=0.752, val_loss=4.65, val_accuracy=0.296, lr=0.1]    46%|████▌     | 53/115 [21:30<24:22, 23.59s/epoch, loss=1.14, accuracy=0.753, val_loss=1.66, val_accuracy=0.569, lr=0.1] 47%|████▋     | 54/115 [21:54<24:02, 23.65s/epoch, loss=1.15, accuracy=0.752, val_loss=2.51, val_accuracy=0.339, lr=0.1] 48%|████▊     | 55/115 [22:17<23:33, 23.55s/epoch, loss=1.14, accuracy=0.757, val_loss=1.91, val_accuracy=0.502, lr=0.1] 49%|████▊     | 56/115 [22:41<23:13, 23.61s/epoch, loss=1.14, accuracy=0.756, val_loss=2.41, val_accuracy=0.442, lr=0.0316] 50%|████▉     | 57/115 [23:05<22:52, 23.67s/epoch, loss=1.14, accuracy=0.753, val_loss=2.45, val_accuracy=0.409, lr=0.1]    50%|█████     | 58/115 [23:29<22:28, 23.66s/epoch, loss=1.14, accuracy=0.754, val_loss=1.51, val_accuracy=0.629, lr=0.1] 51%|█████▏    | 59/115 [23:52<22:05, 23.67s/epoch, loss=1.15, accuracy=0.753, val_loss=2.41, val_accuracy=0.386, lr=0.1] 52%|█████▏    | 60/115 [24:16<21:42, 23.68s/epoch, loss=1.14, accuracy=0.756, val_loss=2.22, val_accuracy=0.428, lr=0.1] 53%|█████▎    | 61/115 [24:40<21:17, 23.67s/epoch, loss=1.14, accuracy=0.754, val_loss=1.67, val_accuracy=0.585, lr=0.0316] 54%|█████▍    | 62/115 [25:03<20:52, 23.64s/epoch, loss=1.13, accuracy=0.755, val_loss=3.08, val_accuracy=0.42, lr=0.1]     55%|█████▍    | 63/115 [25:27<20:29, 23.65s/epoch, loss=1.13, accuracy=0.753, val_loss=3.14, val_accuracy=0.366, lr=0.1] 56%|█████▌    | 64/115 [25:50<20:03, 23.59s/epoch, loss=1.14, accuracy=0.755, val_loss=2.39, val_accuracy=0.411, lr=0.1] 57%|█████▋    | 65/115 [26:14<19:40, 23.61s/epoch, loss=1.14, accuracy=0.754, val_loss=1.89, val_accuracy=0.494, lr=0.1] 57%|█████▋    | 66/115 [26:38<19:16, 23.61s/epoch, loss=1.13, accuracy=0.756, val_loss=3.76, val_accuracy=0.276, lr=0.0316] 58%|█████▊    | 67/115 [27:01<18:52, 23.59s/epoch, loss=1.13, accuracy=0.757, val_loss=1.92, val_accuracy=0.548, lr=0.1]    59%|█████▉    | 68/115 [27:25<18:30, 23.64s/epoch, loss=1.14, accuracy=0.756, val_loss=2.51, val_accuracy=0.303, lr=0.1] 60%|██████    | 69/115 [27:49<18:09, 23.67s/epoch, loss=1.13, accuracy=0.755, val_loss=2.4, val_accuracy=0.494, lr=0.1]  61%|██████    | 70/115 [28:12<17:46, 23.70s/epoch, loss=1.12, accuracy=0.757, val_loss=1.93, val_accuracy=0.473, lr=0.1] 62%|██████▏   | 71/115 [28:36<17:24, 23.73s/epoch, loss=1.13, accuracy=0.756, val_loss=3.59, val_accuracy=0.291, lr=0.0316] 63%|██████▎   | 72/115 [29:00<17:03, 23.80s/epoch, loss=1.13, accuracy=0.758, val_loss=1.67, val_accuracy=0.601, lr=0.1]    63%|██████▎   | 73/115 [29:24<16:39, 23.79s/epoch, loss=1.13, accuracy=0.759, val_loss=1.87, val_accuracy=0.528, lr=0.1] 64%|██████▍   | 74/115 [29:48<16:14, 23.76s/epoch, loss=1.13, accuracy=0.759, val_loss=1.58, val_accuracy=0.582, lr=0.1] 65%|██████▌   | 75/115 [30:11<15:49, 23.73s/epoch, loss=1.13, accuracy=0.755, val_loss=2.52, val_accuracy=0.384, lr=0.1] 66%|██████▌   | 76/115 [30:35<15:24, 23.71s/epoch, loss=1.13, accuracy=0.758, val_loss=1.98, val_accuracy=0.554, lr=0.0316] 67%|██████▋   | 77/115 [30:59<15:01, 23.71s/epoch, loss=1.13, accuracy=0.758, val_loss=1.81, val_accuracy=0.518, lr=0.1]    68%|██████▊   | 78/115 [31:23<14:39, 23.76s/epoch, loss=1.13, accuracy=0.757, val_loss=1.94, val_accuracy=0.482, lr=0.1] 69%|██████▊   | 79/115 [31:46<14:15, 23.75s/epoch, loss=1.12, accuracy=0.758, val_loss=1.83, val_accuracy=0.535, lr=0.1] 70%|██████▉   | 80/115 [32:10<13:53, 23.81s/epoch, loss=1.13, accuracy=0.757, val_loss=2.32, val_accuracy=0.38, lr=0.1]  70%|███████   | 81/115 [32:34<13:28, 23.77s/epoch, loss=1.12, accuracy=0.758, val_loss=2.21, val_accuracy=0.453, lr=0.0316] 71%|███████▏  | 82/115 [32:58<13:03, 23.74s/epoch, loss=0.91, accuracy=0.819, val_loss=0.92, val_accuracy=0.794, lr=0.01]   72%|███████▏  | 83/115 [33:21<12:39, 23.75s/epoch, loss=0.73, accuracy=0.849, val_loss=0.81, val_accuracy=0.811, lr=0.01] 73%|███████▎  | 84/115 [33:45<12:14, 23.68s/epoch, loss=0.65, accuracy=0.856, val_loss=0.704, val_accuracy=0.83, lr=0.01] 74%|███████▍  | 85/115 [34:09<11:51, 23.71s/epoch, loss=0.604, accuracy=0.861, val_loss=0.854, val_accuracy=0.775, lr=0.01] 75%|███████▍  | 86/115 [34:32<11:25, 23.64s/epoch, loss=0.58, accuracy=0.863, val_loss=0.715, val_accuracy=0.815, lr=0.01]  76%|███████▌  | 87/115 [34:56<11:01, 23.63s/epoch, loss=0.572, accuracy=0.862, val_loss=0.763, val_accuracy=0.804, lr=0.01] 77%|███████▋  | 88/115 [35:19<10:37, 23.60s/epoch, loss=0.565, accuracy=0.865, val_loss=0.985, val_accuracy=0.738, lr=0.01] 77%|███████▋  | 89/115 [35:43<10:13, 23.60s/epoch, loss=0.561, accuracy=0.867, val_loss=0.725, val_accuracy=0.81, lr=0.00316] 78%|███████▊  | 90/115 [36:06<09:49, 23.59s/epoch, loss=0.558, accuracy=0.867, val_loss=1.14, val_accuracy=0.72, lr=0.01]     79%|███████▉  | 91/115 [36:30<09:27, 23.63s/epoch, loss=0.559, accuracy=0.869, val_loss=0.847, val_accuracy=0.778, lr=0.01] 80%|████████  | 92/115 [36:53<09:01, 23.54s/epoch, loss=0.557, accuracy=0.869, val_loss=0.909, val_accuracy=0.754, lr=0.01] 81%|████████  | 93/115 [37:17<08:35, 23.44s/epoch, loss=0.558, accuracy=0.872, val_loss=0.835, val_accuracy=0.78, lr=0.01]  82%|████████▏ | 94/115 [37:40<08:14, 23.55s/epoch, loss=0.552, accuracy=0.873, val_loss=0.893, val_accuracy=0.773, lr=0.00316] 83%|████████▎ | 95/115 [38:04<07:51, 23.58s/epoch, loss=0.553, accuracy=0.874, val_loss=0.824, val_accuracy=0.792, lr=0.01]    83%|████████▎ | 96/115 [38:28<07:29, 23.63s/epoch, loss=0.553, accuracy=0.875, val_loss=0.854, val_accuracy=0.777, lr=0.01] 84%|████████▍ | 97/115 [38:52<07:06, 23.72s/epoch, loss=0.555, accuracy=0.876, val_loss=1.34, val_accuracy=0.641, lr=0.01]  85%|████████▌ | 98/115 [39:16<06:43, 23.71s/epoch, loss=0.554, accuracy=0.877, val_loss=0.849, val_accuracy=0.781, lr=0.01] 86%|████████▌ | 99/115 [39:39<06:19, 23.69s/epoch, loss=0.549, accuracy=0.878, val_loss=1.09, val_accuracy=0.739, lr=0.00316] 87%|████████▋ | 100/115 [40:03<05:55, 23.67s/epoch, loss=0.551, accuracy=0.88, val_loss=0.968, val_accuracy=0.756, lr=0.01]   88%|████████▊ | 101/115 [40:27<05:31, 23.71s/epoch, loss=0.553, accuracy=0.877, val_loss=0.793, val_accuracy=0.794, lr=0.01] 89%|████████▊ | 102/115 [40:49<05:04, 23.39s/epoch, loss=0.55, accuracy=0.882, val_loss=1.44, val_accuracy=0.682, lr=0.01]   90%|████████▉ | 103/115 [41:12<04:38, 23.19s/epoch, loss=0.548, accuracy=0.882, val_loss=0.882, val_accuracy=0.788, lr=0.01] 90%|█████████ | 104/115 [41:35<04:14, 23.18s/epoch, loss=0.551, accuracy=0.88, val_loss=0.855, val_accuracy=0.786, lr=0.00316] 91%|█████████▏| 105/115 [41:59<03:53, 23.33s/epoch, loss=0.554, accuracy=0.88, val_loss=0.769, val_accuracy=0.813, lr=0.01]    92%|█████████▏| 106/115 [42:22<03:30, 23.36s/epoch, loss=0.554, accuracy=0.88, val_loss=0.78, val_accuracy=0.809, lr=0.01]  93%|█████████▎| 107/115 [42:46<03:07, 23.38s/epoch, loss=0.554, accuracy=0.882, val_loss=0.814, val_accuracy=0.802, lr=0.01] 94%|█████████▍| 108/115 [43:09<02:44, 23.43s/epoch, loss=0.546, accuracy=0.883, val_loss=0.784, val_accuracy=0.813, lr=0.01] 95%|█████████▍| 109/115 [43:33<02:20, 23.40s/epoch, loss=0.552, accuracy=0.881, val_loss=0.929, val_accuracy=0.785, lr=0.00316] 96%|█████████▌| 110/115 [43:56<01:57, 23.48s/epoch, loss=0.551, accuracy=0.881, val_loss=0.977, val_accuracy=0.77, lr=0.01]     97%|█████████▋| 111/115 [44:20<01:34, 23.50s/epoch, loss=0.549, accuracy=0.884, val_loss=0.745, val_accuracy=0.817, lr=0.01] 97%|█████████▋| 112/115 [44:43<01:10, 23.50s/epoch, loss=0.55, accuracy=0.884, val_loss=1.08, val_accuracy=0.735, lr=0.01]   98%|█████████▊| 113/115 [45:07<00:47, 23.60s/epoch, loss=0.547, accuracy=0.884, val_loss=0.856, val_accuracy=0.791, lr=0.01] 99%|█████████▉| 114/115 [45:31<00:23, 23.57s/epoch, loss=0.556, accuracy=0.882, val_loss=0.95, val_accuracy=0.737, lr=0.00316]100%|██████████| 115/115 [45:54<00:00, 23.57s/epoch, loss=0.549, accuracy=0.885, val_loss=1.47, val_accuracy=0.677, lr=0.01]   100%|██████████| 115/115 [45:54<00:00, 23.95s/epoch, loss=0.549, accuracy=0.885, val_loss=1.47, val_accuracy=0.677, lr=0.01]
Using real-time data augmentation.
Test loss: 1.4659546613693237
Test accuracy: 0.6765000224113464


* * * Run SGD for ID = 13_8. * * *


2024-02-15 18:11:04.106472: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 18:11:06.638401: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 18:11:06.639591: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-15 18:11:06.674851: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-02-15 18:11:06.674893: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 18:11:06.677962: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 18:11:06.678008: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 18:11:06.680108: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 18:11:06.680785: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 18:11:06.683027: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 18:11:06.684499: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 18:11:06.688749: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 18:11:06.689270: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 18:11:06.689375: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 18:11:07.894408: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-15 18:11:07.894995: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 18:11:07.895593: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-02-15 18:11:07.895623: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 18:11:07.895674: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 18:11:07.895692: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 18:11:07.895710: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 18:11:07.895728: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 18:11:07.895745: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 18:11:07.895763: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 18:11:07.895781: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 18:11:07.896198: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 18:11:07.896229: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 18:11:08.512634: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-15 18:11:08.512695: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-15 18:11:08.512715: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-15 18:11:08.513585: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11227 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN X (Pascal), pci bus id: 0000:03:00.0, compute capability: 6.1)
{'id': 138, 'batch_size': 128, 'epochs': 115, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN X (Pascal)'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/115 [00:00<?, ?epoch/s]2024-02-15 18:11:09.269348: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-15 18:11:09.281406: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2599900000 Hz
2024-02-15 18:11:11.101407: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 18:11:11.328539: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 18:11:12.232028: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-15 18:11:12.287433: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/115 [01:00<1:54:18, 60.16s/epoch, loss=3.06, accuracy=0.334, val_loss=3.32, val_accuracy=0.18, lr=0.1]  2%|▏         | 2/115 [01:23<1:12:56, 38.73s/epoch, loss=1.54, accuracy=0.549, val_loss=2.35, val_accuracy=0.443, lr=0.1]  3%|▎         | 3/115 [01:47<59:43, 32.00s/epoch, loss=1.36, accuracy=0.637, val_loss=2.1, val_accuracy=0.442, lr=0.1]     3%|▎         | 4/115 [02:11<52:58, 28.64s/epoch, loss=1.29, accuracy=0.67, val_loss=1.79, val_accuracy=0.518, lr=0.1]  4%|▍         | 5/115 [02:35<49:14, 26.86s/epoch, loss=1.27, accuracy=0.687, val_loss=1.75, val_accuracy=0.538, lr=0.1]  5%|▌         | 6/115 [02:58<46:50, 25.78s/epoch, loss=1.24, accuracy=0.702, val_loss=1.77, val_accuracy=0.562, lr=0.1]  6%|▌         | 7/115 [03:22<45:07, 25.06s/epoch, loss=1.23, accuracy=0.711, val_loss=1.81, val_accuracy=0.492, lr=0.1]  7%|▋         | 8/115 [03:46<43:55, 24.63s/epoch, loss=1.23, accuracy=0.713, val_loss=1.71, val_accuracy=0.569, lr=0.1]  8%|▊         | 9/115 [04:09<43:02, 24.36s/epoch, loss=1.21, accuracy=0.722, val_loss=2.04, val_accuracy=0.448, lr=0.1]  9%|▊         | 10/115 [04:33<42:18, 24.18s/epoch, loss=1.21, accuracy=0.722, val_loss=2.52, val_accuracy=0.466, lr=0.1] 10%|▉         | 11/115 [04:57<41:48, 24.12s/epoch, loss=1.21, accuracy=0.724, val_loss=1.9, val_accuracy=0.537, lr=0.1]  10%|█         | 12/115 [05:21<41:18, 24.06s/epoch, loss=1.2, accuracy=0.727, val_loss=1.63, val_accuracy=0.572, lr=0.1] 11%|█▏        | 13/115 [05:45<40:44, 23.97s/epoch, loss=1.19, accuracy=0.732, val_loss=1.81, val_accuracy=0.539, lr=0.1] 12%|█▏        | 14/115 [06:09<40:20, 23.97s/epoch, loss=1.18, accuracy=0.734, val_loss=1.65, val_accuracy=0.596, lr=0.1] 13%|█▎        | 15/115 [06:33<39:56, 23.97s/epoch, loss=1.19, accuracy=0.733, val_loss=1.7, val_accuracy=0.556, lr=0.1]  14%|█▍        | 16/115 [06:57<39:36, 24.01s/epoch, loss=1.18, accuracy=0.735, val_loss=1.85, val_accuracy=0.545, lr=0.1] 15%|█▍        | 17/115 [07:21<39:06, 23.94s/epoch, loss=1.17, accuracy=0.739, val_loss=2.99, val_accuracy=0.418, lr=0.0316] 16%|█▌        | 18/115 [07:44<38:39, 23.92s/epoch, loss=1.18, accuracy=0.738, val_loss=3.36, val_accuracy=0.303, lr=0.1]    17%|█▋        | 19/115 [08:08<38:05, 23.81s/epoch, loss=1.17, accuracy=0.74, val_loss=1.7, val_accuracy=0.551, lr=0.1]   17%|█▋        | 20/115 [08:32<37:38, 23.78s/epoch, loss=1.17, accuracy=0.738, val_loss=1.69, val_accuracy=0.569, lr=0.1] 18%|█▊        | 21/115 [08:55<37:08, 23.71s/epoch, loss=1.18, accuracy=0.74, val_loss=1.65, val_accuracy=0.586, lr=0.1]  19%|█▉        | 22/115 [09:19<36:50, 23.77s/epoch, loss=1.17, accuracy=0.742, val_loss=1.55, val_accuracy=0.61, lr=0.1] 20%|██        | 23/115 [09:43<36:25, 23.75s/epoch, loss=1.17, accuracy=0.744, val_loss=1.82, val_accuracy=0.514, lr=0.1] 21%|██        | 24/115 [10:07<36:01, 23.75s/epoch, loss=1.16, accuracy=0.743, val_loss=2.02, val_accuracy=0.519, lr=0.1] 22%|██▏       | 25/115 [10:31<35:41, 23.79s/epoch, loss=1.16, accuracy=0.745, val_loss=1.71, val_accuracy=0.571, lr=0.1] 23%|██▎       | 26/115 [10:54<35:20, 23.83s/epoch, loss=1.17, accuracy=0.744, val_loss=2.34, val_accuracy=0.462, lr=0.1] 23%|██▎       | 27/115 [11:18<34:55, 23.81s/epoch, loss=1.16, accuracy=0.746, val_loss=2.72, val_accuracy=0.378, lr=0.0316] 24%|██▍       | 28/115 [11:42<34:35, 23.86s/epoch, loss=1.16, accuracy=0.746, val_loss=2.81, val_accuracy=0.299, lr=0.1]    25%|██▌       | 29/115 [12:06<34:13, 23.88s/epoch, loss=1.16, accuracy=0.744, val_loss=1.6, val_accuracy=0.612, lr=0.1]  26%|██▌       | 30/115 [12:30<33:52, 23.91s/epoch, loss=1.15, accuracy=0.747, val_loss=3.18, val_accuracy=0.365, lr=0.1] 27%|██▋       | 31/115 [12:54<33:29, 23.92s/epoch, loss=1.16, accuracy=0.747, val_loss=3.12, val_accuracy=0.348, lr=0.1] 28%|██▊       | 32/115 [13:18<33:01, 23.87s/epoch, loss=1.16, accuracy=0.747, val_loss=5.6, val_accuracy=0.24, lr=0.0316] 29%|██▊       | 33/115 [13:42<32:37, 23.88s/epoch, loss=1.15, accuracy=0.748, val_loss=2.3, val_accuracy=0.361, lr=0.1]   30%|██▉       | 34/115 [14:05<32:07, 23.80s/epoch, loss=1.16, accuracy=0.745, val_loss=1.56, val_accuracy=0.61, lr=0.1] 30%|███       | 35/115 [14:29<31:47, 23.84s/epoch, loss=1.16, accuracy=0.747, val_loss=1.69, val_accuracy=0.606, lr=0.1] 31%|███▏      | 36/115 [14:53<31:21, 23.81s/epoch, loss=1.15, accuracy=0.75, val_loss=1.88, val_accuracy=0.506, lr=0.1]  32%|███▏      | 37/115 [15:17<30:56, 23.81s/epoch, loss=1.15, accuracy=0.746, val_loss=2.59, val_accuracy=0.394, lr=0.0316] 33%|███▎      | 38/115 [15:41<30:38, 23.87s/epoch, loss=1.15, accuracy=0.748, val_loss=2.2, val_accuracy=0.454, lr=0.1]     34%|███▍      | 39/115 [16:04<29:55, 23.63s/epoch, loss=1.15, accuracy=0.748, val_loss=1.65, val_accuracy=0.605, lr=0.1] 35%|███▍      | 40/115 [16:28<29:39, 23.72s/epoch, loss=1.15, accuracy=0.748, val_loss=2.27, val_accuracy=0.369, lr=0.1] 36%|███▌      | 41/115 [16:52<29:21, 23.80s/epoch, loss=1.14, accuracy=0.751, val_loss=2.91, val_accuracy=0.326, lr=0.1] 37%|███▋      | 42/115 [17:15<28:52, 23.73s/epoch, loss=1.15, accuracy=0.749, val_loss=2.32, val_accuracy=0.5, lr=0.0316] 37%|███▋      | 43/115 [17:39<28:33, 23.80s/epoch, loss=1.14, accuracy=0.749, val_loss=2.86, val_accuracy=0.42, lr=0.1]   38%|███▊      | 44/115 [18:03<28:00, 23.67s/epoch, loss=1.15, accuracy=0.751, val_loss=1.73, val_accuracy=0.57, lr=0.1] 39%|███▉      | 45/115 [18:26<27:39, 23.71s/epoch, loss=1.15, accuracy=0.75, val_loss=2.69, val_accuracy=0.377, lr=0.1] 40%|████      | 46/115 [18:50<27:16, 23.72s/epoch, loss=1.15, accuracy=0.75, val_loss=3.22, val_accuracy=0.301, lr=0.1] 41%|████      | 47/115 [19:14<26:53, 23.73s/epoch, loss=1.15, accuracy=0.751, val_loss=1.96, val_accuracy=0.502, lr=0.0316] 42%|████▏     | 48/115 [19:38<26:35, 23.81s/epoch, loss=1.15, accuracy=0.749, val_loss=1.86, val_accuracy=0.546, lr=0.1]    43%|████▎     | 49/115 [20:02<26:06, 23.73s/epoch, loss=1.14, accuracy=0.749, val_loss=2.31, val_accuracy=0.387, lr=0.1] 43%|████▎     | 50/115 [20:25<25:42, 23.73s/epoch, loss=1.15, accuracy=0.751, val_loss=2.32, val_accuracy=0.485, lr=0.1] 44%|████▍     | 51/115 [20:49<25:21, 23.78s/epoch, loss=1.14, accuracy=0.751, val_loss=1.83, val_accuracy=0.562, lr=0.1] 45%|████▌     | 52/115 [21:13<25:03, 23.86s/epoch, loss=1.15, accuracy=0.75, val_loss=3.21, val_accuracy=0.297, lr=0.0316] 46%|████▌     | 53/115 [21:37<24:37, 23.84s/epoch, loss=1.14, accuracy=0.751, val_loss=1.84, val_accuracy=0.563, lr=0.1]   47%|████▋     | 54/115 [22:01<24:15, 23.86s/epoch, loss=1.14, accuracy=0.752, val_loss=1.97, val_accuracy=0.521, lr=0.1] 48%|████▊     | 55/115 [22:25<23:52, 23.87s/epoch, loss=1.15, accuracy=0.748, val_loss=2.17, val_accuracy=0.508, lr=0.1] 49%|████▊     | 56/115 [22:49<23:30, 23.90s/epoch, loss=1.14, accuracy=0.752, val_loss=2.96, val_accuracy=0.371, lr=0.1] 50%|████▉     | 57/115 [23:12<23:02, 23.84s/epoch, loss=1.14, accuracy=0.754, val_loss=1.63, val_accuracy=0.592, lr=0.0316] 50%|█████     | 58/115 [23:36<22:38, 23.84s/epoch, loss=1.14, accuracy=0.75, val_loss=1.78, val_accuracy=0.536, lr=0.1]     51%|█████▏    | 59/115 [24:00<22:13, 23.81s/epoch, loss=1.14, accuracy=0.75, val_loss=4.36, val_accuracy=0.316, lr=0.1] 52%|█████▏    | 60/115 [24:24<21:49, 23.80s/epoch, loss=1.14, accuracy=0.751, val_loss=1.88, val_accuracy=0.558, lr=0.1] 53%|█████▎    | 61/115 [24:47<21:13, 23.59s/epoch, loss=1.14, accuracy=0.75, val_loss=1.66, val_accuracy=0.598, lr=0.1]  54%|█████▍    | 62/115 [25:10<20:50, 23.59s/epoch, loss=1.14, accuracy=0.752, val_loss=1.59, val_accuracy=0.59, lr=0.0316] 55%|█████▍    | 63/115 [25:34<20:29, 23.64s/epoch, loss=1.14, accuracy=0.752, val_loss=2.29, val_accuracy=0.391, lr=0.1]   56%|█████▌    | 64/115 [25:58<20:09, 23.71s/epoch, loss=1.14, accuracy=0.751, val_loss=2, val_accuracy=0.548, lr=0.1]    57%|█████▋    | 65/115 [26:22<19:44, 23.70s/epoch, loss=1.14, accuracy=0.752, val_loss=1.46, val_accuracy=0.635, lr=0.1] 57%|█████▋    | 66/115 [26:45<19:20, 23.67s/epoch, loss=1.15, accuracy=0.75, val_loss=1.83, val_accuracy=0.522, lr=0.1]  58%|█████▊    | 67/115 [27:09<19:01, 23.77s/epoch, loss=1.13, accuracy=0.752, val_loss=1.76, val_accuracy=0.556, lr=0.1] 59%|█████▉    | 68/115 [27:33<18:37, 23.77s/epoch, loss=1.14, accuracy=0.753, val_loss=3.26, val_accuracy=0.409, lr=0.1] 60%|██████    | 69/115 [27:57<18:15, 23.81s/epoch, loss=1.13, accuracy=0.754, val_loss=1.82, val_accuracy=0.523, lr=0.1] 61%|██████    | 70/115 [28:21<17:53, 23.86s/epoch, loss=1.13, accuracy=0.753, val_loss=1.69, val_accuracy=0.566, lr=0.0316] 62%|██████▏   | 71/115 [28:45<17:29, 23.84s/epoch, loss=1.14, accuracy=0.75, val_loss=1.66, val_accuracy=0.577, lr=0.1]     63%|██████▎   | 72/115 [29:08<16:59, 23.71s/epoch, loss=1.13, accuracy=0.751, val_loss=2.17, val_accuracy=0.455, lr=0.1] 63%|██████▎   | 73/115 [29:32<16:32, 23.63s/epoch, loss=1.13, accuracy=0.756, val_loss=1.93, val_accuracy=0.488, lr=0.1] 64%|██████▍   | 74/115 [29:56<16:11, 23.69s/epoch, loss=1.13, accuracy=0.751, val_loss=2.63, val_accuracy=0.43, lr=0.1]  65%|██████▌   | 75/115 [30:19<15:47, 23.70s/epoch, loss=1.13, accuracy=0.756, val_loss=2.34, val_accuracy=0.484, lr=0.0316] 66%|██████▌   | 76/115 [30:43<15:25, 23.74s/epoch, loss=1.13, accuracy=0.752, val_loss=2.47, val_accuracy=0.476, lr=0.1]    67%|██████▋   | 77/115 [31:07<15:04, 23.80s/epoch, loss=1.13, accuracy=0.754, val_loss=4.58, val_accuracy=0.345, lr=0.1] 68%|██████▊   | 78/115 [31:31<14:39, 23.77s/epoch, loss=1.13, accuracy=0.753, val_loss=3.22, val_accuracy=0.315, lr=0.1] 69%|██████▊   | 79/115 [31:54<14:13, 23.71s/epoch, loss=1.13, accuracy=0.753, val_loss=3.19, val_accuracy=0.414, lr=0.1] 70%|██████▉   | 80/115 [32:18<13:48, 23.68s/epoch, loss=1.13, accuracy=0.752, val_loss=2.02, val_accuracy=0.514, lr=0.0316] 70%|███████   | 81/115 [32:41<13:19, 23.52s/epoch, loss=1.13, accuracy=0.756, val_loss=1.96, val_accuracy=0.591, lr=0.1]    71%|███████▏  | 82/115 [33:05<12:58, 23.58s/epoch, loss=0.923, accuracy=0.815, val_loss=0.893, val_accuracy=0.809, lr=0.01] 72%|███████▏  | 83/115 [33:28<12:35, 23.62s/epoch, loss=0.745, accuracy=0.845, val_loss=0.79, val_accuracy=0.822, lr=0.01]  73%|███████▎  | 84/115 [33:52<12:10, 23.57s/epoch, loss=0.664, accuracy=0.853, val_loss=0.821, val_accuracy=0.787, lr=0.01] 74%|███████▍  | 85/115 [34:16<11:47, 23.57s/epoch, loss=0.617, accuracy=0.858, val_loss=0.764, val_accuracy=0.796, lr=0.01] 75%|███████▍  | 86/115 [34:39<11:22, 23.54s/epoch, loss=0.593, accuracy=0.858, val_loss=0.795, val_accuracy=0.793, lr=0.01] 76%|███████▌  | 87/115 [35:02<10:58, 23.53s/epoch, loss=0.582, accuracy=0.86, val_loss=0.869, val_accuracy=0.768, lr=0.01]  77%|███████▋  | 88/115 [35:26<10:35, 23.54s/epoch, loss=0.58, accuracy=0.86, val_loss=0.787, val_accuracy=0.797, lr=0.01]  77%|███████▋  | 89/115 [35:50<10:12, 23.55s/epoch, loss=0.581, accuracy=0.86, val_loss=0.86, val_accuracy=0.776, lr=0.01] 78%|███████▊  | 90/115 [36:13<09:50, 23.63s/epoch, loss=0.573, accuracy=0.863, val_loss=0.94, val_accuracy=0.752, lr=0.00316] 79%|███████▉  | 91/115 [36:37<09:26, 23.62s/epoch, loss=0.571, accuracy=0.864, val_loss=0.841, val_accuracy=0.777, lr=0.01]   80%|████████  | 92/115 [37:01<09:04, 23.66s/epoch, loss=0.569, accuracy=0.867, val_loss=1.32, val_accuracy=0.657, lr=0.01]  81%|████████  | 93/115 [37:24<08:39, 23.62s/epoch, loss=0.57, accuracy=0.867, val_loss=0.982, val_accuracy=0.743, lr=0.01] 82%|████████▏ | 94/115 [37:48<08:16, 23.63s/epoch, loss=0.566, accuracy=0.868, val_loss=0.971, val_accuracy=0.75, lr=0.01] 83%|████████▎ | 95/115 [38:12<07:54, 23.71s/epoch, loss=0.566, accuracy=0.871, val_loss=0.841, val_accuracy=0.787, lr=0.00316] 83%|████████▎ | 96/115 [38:36<07:30, 23.73s/epoch, loss=0.564, accuracy=0.871, val_loss=0.781, val_accuracy=0.806, lr=0.01]    84%|████████▍ | 97/115 [38:59<07:07, 23.73s/epoch, loss=0.568, accuracy=0.87, val_loss=0.845, val_accuracy=0.789, lr=0.01]  85%|████████▌ | 98/115 [39:23<06:43, 23.72s/epoch, loss=0.562, accuracy=0.873, val_loss=0.9, val_accuracy=0.766, lr=0.01]  86%|████████▌ | 99/115 [39:47<06:20, 23.76s/epoch, loss=0.567, accuracy=0.873, val_loss=0.892, val_accuracy=0.765, lr=0.01] 87%|████████▋ | 100/115 [40:11<05:56, 23.77s/epoch, loss=0.565, accuracy=0.875, val_loss=0.802, val_accuracy=0.796, lr=0.00316] 88%|████████▊ | 101/115 [40:34<05:31, 23.71s/epoch, loss=0.566, accuracy=0.873, val_loss=0.893, val_accuracy=0.778, lr=0.01]    89%|████████▊ | 102/115 [40:58<05:06, 23.61s/epoch, loss=0.561, accuracy=0.877, val_loss=0.834, val_accuracy=0.797, lr=0.01] 90%|████████▉ | 103/115 [41:21<04:41, 23.46s/epoch, loss=0.565, accuracy=0.875, val_loss=0.879, val_accuracy=0.787, lr=0.01] 90%|█████████ | 104/115 [41:45<04:19, 23.59s/epoch, loss=0.557, accuracy=0.877, val_loss=0.766, val_accuracy=0.804, lr=0.01] 91%|█████████▏| 105/115 [42:08<03:55, 23.60s/epoch, loss=0.562, accuracy=0.876, val_loss=0.946, val_accuracy=0.755, lr=0.00316] 92%|█████████▏| 106/115 [42:32<03:32, 23.66s/epoch, loss=0.562, accuracy=0.877, val_loss=0.974, val_accuracy=0.749, lr=0.01]    93%|█████████▎| 107/115 [42:56<03:09, 23.63s/epoch, loss=0.557, accuracy=0.879, val_loss=0.699, val_accuracy=0.832, lr=0.01] 94%|█████████▍| 108/115 [43:19<02:45, 23.68s/epoch, loss=0.563, accuracy=0.877, val_loss=0.971, val_accuracy=0.771, lr=0.01] 95%|█████████▍| 109/115 [43:43<02:22, 23.68s/epoch, loss=0.563, accuracy=0.878, val_loss=0.892, val_accuracy=0.78, lr=0.01]  96%|█████████▌| 110/115 [44:07<01:58, 23.71s/epoch, loss=0.562, accuracy=0.88, val_loss=0.829, val_accuracy=0.801, lr=0.01] 97%|█████████▋| 111/115 [44:31<01:34, 23.71s/epoch, loss=0.558, accuracy=0.881, val_loss=0.954, val_accuracy=0.766, lr=0.01] 97%|█████████▋| 112/115 [44:54<01:11, 23.68s/epoch, loss=0.56, accuracy=0.879, val_loss=0.792, val_accuracy=0.806, lr=0.00316] 98%|█████████▊| 113/115 [45:18<00:47, 23.63s/epoch, loss=0.562, accuracy=0.879, val_loss=0.879, val_accuracy=0.79, lr=0.01]    99%|█████████▉| 114/115 [45:41<00:23, 23.59s/epoch, loss=0.561, accuracy=0.88, val_loss=0.99, val_accuracy=0.763, lr=0.01] 100%|██████████| 115/115 [46:05<00:00, 23.57s/epoch, loss=0.559, accuracy=0.881, val_loss=0.88, val_accuracy=0.785, lr=0.01]100%|██████████| 115/115 [46:05<00:00, 24.05s/epoch, loss=0.559, accuracy=0.881, val_loss=0.88, val_accuracy=0.785, lr=0.01]
Using real-time data augmentation.
Test loss: 0.880204975605011
Test accuracy: 0.7853000164031982


* * * Run SGD for ID = 13_9. * * *


2024-02-15 18:57:16.790023: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 18:57:19.365830: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 18:57:19.366913: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-15 18:57:19.401896: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-02-15 18:57:19.401933: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 18:57:19.404524: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 18:57:19.404563: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 18:57:19.407006: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 18:57:19.408029: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 18:57:19.410179: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 18:57:19.411490: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 18:57:19.415959: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 18:57:19.416476: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 18:57:19.416552: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 18:57:20.594718: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-15 18:57:20.595262: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 18:57:20.595925: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-02-15 18:57:20.595955: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 18:57:20.596032: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 18:57:20.596052: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 18:57:20.596070: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 18:57:20.596088: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 18:57:20.596106: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 18:57:20.596124: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 18:57:20.596142: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 18:57:20.596618: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 18:57:20.596664: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 18:57:21.195368: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-15 18:57:21.195427: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-15 18:57:21.195436: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-15 18:57:21.196344: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11227 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN X (Pascal), pci bus id: 0000:03:00.0, compute capability: 6.1)
{'id': 139, 'batch_size': 128, 'epochs': 115, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN X (Pascal)'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/115 [00:00<?, ?epoch/s]2024-02-15 18:57:21.932396: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-15 18:57:21.944391: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2599900000 Hz
2024-02-15 18:57:23.744760: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 18:57:24.048878: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 18:57:24.773200: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-15 18:57:24.812625: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/115 [00:54<1:43:35, 54.52s/epoch, loss=3.38, accuracy=0.291, val_loss=2.83, val_accuracy=0.247, lr=0.1]  2%|▏         | 2/115 [01:17<1:08:07, 36.17s/epoch, loss=1.73, accuracy=0.445, val_loss=1.87, val_accuracy=0.378, lr=0.1]  3%|▎         | 3/115 [01:41<56:25, 30.23s/epoch, loss=1.53, accuracy=0.534, val_loss=2.69, val_accuracy=0.299, lr=0.1]    3%|▎         | 4/115 [02:04<50:50, 27.48s/epoch, loss=1.39, accuracy=0.623, val_loss=2.01, val_accuracy=0.446, lr=0.1]  4%|▍         | 5/115 [02:27<47:28, 25.89s/epoch, loss=1.3, accuracy=0.667, val_loss=3, val_accuracy=0.254, lr=0.1]      5%|▌         | 6/115 [02:49<44:57, 24.74s/epoch, loss=1.25, accuracy=0.693, val_loss=1.86, val_accuracy=0.509, lr=0.1]  6%|▌         | 7/115 [03:11<42:53, 23.83s/epoch, loss=1.24, accuracy=0.706, val_loss=1.49, val_accuracy=0.624, lr=0.1]  7%|▋         | 8/115 [03:34<42:04, 23.60s/epoch, loss=1.23, accuracy=0.715, val_loss=1.88, val_accuracy=0.472, lr=0.1]  8%|▊         | 9/115 [03:58<41:25, 23.45s/epoch, loss=1.22, accuracy=0.716, val_loss=2.08, val_accuracy=0.426, lr=0.1]  9%|▊         | 10/115 [04:21<40:52, 23.36s/epoch, loss=1.22, accuracy=0.721, val_loss=1.99, val_accuracy=0.461, lr=0.1] 10%|▉         | 11/115 [04:44<40:22, 23.29s/epoch, loss=1.22, accuracy=0.722, val_loss=1.5, val_accuracy=0.619, lr=0.1]  10%|█         | 12/115 [05:07<39:53, 23.24s/epoch, loss=1.22, accuracy=0.725, val_loss=1.61, val_accuracy=0.595, lr=0.0316] 11%|█▏        | 13/115 [05:30<39:26, 23.20s/epoch, loss=1.21, accuracy=0.729, val_loss=2.84, val_accuracy=0.37, lr=0.1]     12%|█▏        | 14/115 [05:53<38:59, 23.16s/epoch, loss=1.22, accuracy=0.729, val_loss=2.11, val_accuracy=0.451, lr=0.1] 13%|█▎        | 15/115 [06:16<38:35, 23.16s/epoch, loss=1.21, accuracy=0.733, val_loss=1.95, val_accuracy=0.527, lr=0.1] 14%|█▍        | 16/115 [06:39<38:13, 23.17s/epoch, loss=1.2, accuracy=0.733, val_loss=1.97, val_accuracy=0.476, lr=0.1]  15%|█▍        | 17/115 [07:02<37:46, 23.13s/epoch, loss=1.2, accuracy=0.736, val_loss=4.41, val_accuracy=0.309, lr=0.0316] 16%|█▌        | 18/115 [07:26<37:27, 23.17s/epoch, loss=1.21, accuracy=0.734, val_loss=2.24, val_accuracy=0.389, lr=0.1]   17%|█▋        | 19/115 [07:49<37:05, 23.18s/epoch, loss=1.21, accuracy=0.734, val_loss=2.59, val_accuracy=0.343, lr=0.1] 17%|█▋        | 20/115 [08:12<36:42, 23.18s/epoch, loss=1.2, accuracy=0.737, val_loss=1.91, val_accuracy=0.556, lr=0.1]  18%|█▊        | 21/115 [08:35<36:18, 23.18s/epoch, loss=1.2, accuracy=0.738, val_loss=1.76, val_accuracy=0.566, lr=0.1] 19%|█▉        | 22/115 [08:58<35:51, 23.14s/epoch, loss=1.19, accuracy=0.74, val_loss=1.9, val_accuracy=0.52, lr=0.0316] 20%|██        | 23/115 [09:21<35:21, 23.06s/epoch, loss=1.2, accuracy=0.739, val_loss=4.75, val_accuracy=0.259, lr=0.1]  21%|██        | 24/115 [09:44<34:59, 23.07s/epoch, loss=1.19, accuracy=0.74, val_loss=1.41, val_accuracy=0.659, lr=0.1] 22%|██▏       | 25/115 [10:08<34:43, 23.15s/epoch, loss=1.19, accuracy=0.74, val_loss=3, val_accuracy=0.398, lr=0.1]    23%|██▎       | 26/115 [10:31<34:23, 23.19s/epoch, loss=1.18, accuracy=0.74, val_loss=2.12, val_accuracy=0.49, lr=0.1] 23%|██▎       | 27/115 [10:54<34:02, 23.21s/epoch, loss=1.2, accuracy=0.74, val_loss=2.13, val_accuracy=0.467, lr=0.1] 24%|██▍       | 28/115 [11:17<33:37, 23.19s/epoch, loss=1.18, accuracy=0.738, val_loss=2.41, val_accuracy=0.47, lr=0.1] 25%|██▌       | 29/115 [11:40<33:09, 23.14s/epoch, loss=1.18, accuracy=0.742, val_loss=2.22, val_accuracy=0.403, lr=0.0316] 26%|██▌       | 30/115 [12:03<32:43, 23.10s/epoch, loss=1.17, accuracy=0.742, val_loss=1.84, val_accuracy=0.506, lr=0.1]    27%|██▋       | 31/115 [12:27<32:26, 23.18s/epoch, loss=1.18, accuracy=0.742, val_loss=2.27, val_accuracy=0.503, lr=0.1] 28%|██▊       | 32/115 [12:50<32:03, 23.18s/epoch, loss=1.18, accuracy=0.74, val_loss=1.77, val_accuracy=0.559, lr=0.1]  29%|██▊       | 33/115 [13:13<31:31, 23.07s/epoch, loss=1.18, accuracy=0.743, val_loss=1.69, val_accuracy=0.573, lr=0.1] 30%|██▉       | 34/115 [13:36<31:11, 23.11s/epoch, loss=1.18, accuracy=0.74, val_loss=2.3, val_accuracy=0.444, lr=0.0316] 30%|███       | 35/115 [13:59<30:46, 23.08s/epoch, loss=1.18, accuracy=0.745, val_loss=1.84, val_accuracy=0.49, lr=0.1]   31%|███▏      | 36/115 [14:22<30:23, 23.09s/epoch, loss=1.18, accuracy=0.744, val_loss=2.5, val_accuracy=0.397, lr=0.1] 32%|███▏      | 37/115 [14:45<30:02, 23.11s/epoch, loss=1.18, accuracy=0.742, val_loss=3.68, val_accuracy=0.342, lr=0.1] 33%|███▎      | 38/115 [15:08<29:37, 23.09s/epoch, loss=1.17, accuracy=0.745, val_loss=2.1, val_accuracy=0.524, lr=0.1]  34%|███▍      | 39/115 [15:31<29:15, 23.10s/epoch, loss=1.17, accuracy=0.745, val_loss=1.74, val_accuracy=0.534, lr=0.0316] 35%|███▍      | 40/115 [15:54<28:49, 23.06s/epoch, loss=1.17, accuracy=0.744, val_loss=1.6, val_accuracy=0.625, lr=0.1]     36%|███▌      | 41/115 [16:17<28:25, 23.05s/epoch, loss=1.17, accuracy=0.748, val_loss=2.16, val_accuracy=0.507, lr=0.1] 37%|███▋      | 42/115 [16:41<28:04, 23.08s/epoch, loss=1.18, accuracy=0.744, val_loss=2.49, val_accuracy=0.383, lr=0.1] 37%|███▋      | 43/115 [17:04<27:43, 23.11s/epoch, loss=1.16, accuracy=0.748, val_loss=1.52, val_accuracy=0.639, lr=0.1] 38%|███▊      | 44/115 [17:27<27:19, 23.09s/epoch, loss=1.16, accuracy=0.745, val_loss=2.4, val_accuracy=0.386, lr=0.0316] 39%|███▉      | 45/115 [17:50<26:57, 23.11s/epoch, loss=1.17, accuracy=0.743, val_loss=1.46, val_accuracy=0.638, lr=0.1]   40%|████      | 46/115 [18:13<26:32, 23.08s/epoch, loss=1.17, accuracy=0.745, val_loss=2.01, val_accuracy=0.461, lr=0.1] 41%|████      | 47/115 [18:36<26:11, 23.12s/epoch, loss=1.17, accuracy=0.747, val_loss=1.86, val_accuracy=0.541, lr=0.1] 42%|████▏     | 48/115 [18:59<25:42, 23.02s/epoch, loss=1.17, accuracy=0.745, val_loss=2.6, val_accuracy=0.483, lr=0.1]  43%|████▎     | 49/115 [19:22<25:16, 22.98s/epoch, loss=1.16, accuracy=0.747, val_loss=5.01, val_accuracy=0.26, lr=0.0316] 43%|████▎     | 50/115 [19:45<25:01, 23.10s/epoch, loss=1.17, accuracy=0.748, val_loss=1.5, val_accuracy=0.634, lr=0.1]    44%|████▍     | 51/115 [20:08<24:31, 22.99s/epoch, loss=1.15, accuracy=0.748, val_loss=1.81, val_accuracy=0.518, lr=0.1] 45%|████▌     | 52/115 [20:31<24:13, 23.06s/epoch, loss=1.16, accuracy=0.748, val_loss=1.82, val_accuracy=0.557, lr=0.1] 46%|████▌     | 53/115 [20:54<23:53, 23.12s/epoch, loss=1.17, accuracy=0.746, val_loss=2.4, val_accuracy=0.525, lr=0.1]  47%|████▋     | 54/115 [21:17<23:27, 23.08s/epoch, loss=1.16, accuracy=0.747, val_loss=3.29, val_accuracy=0.267, lr=0.0316] 48%|████▊     | 55/115 [21:40<23:00, 23.01s/epoch, loss=1.16, accuracy=0.747, val_loss=1.46, val_accuracy=0.647, lr=0.1]    49%|████▊     | 56/115 [22:03<22:39, 23.04s/epoch, loss=1.14, accuracy=0.75, val_loss=2.22, val_accuracy=0.445, lr=0.1]  50%|████▉     | 57/115 [22:26<22:07, 22.89s/epoch, loss=1.16, accuracy=0.748, val_loss=1.45, val_accuracy=0.664, lr=0.1] 50%|█████     | 58/115 [22:49<21:46, 22.92s/epoch, loss=1.16, accuracy=0.748, val_loss=1.73, val_accuracy=0.578, lr=0.1] 51%|█████▏    | 59/115 [23:12<21:24, 22.94s/epoch, loss=1.15, accuracy=0.751, val_loss=2.83, val_accuracy=0.457, lr=0.0316] 52%|█████▏    | 60/115 [23:35<21:05, 23.00s/epoch, loss=1.15, accuracy=0.75, val_loss=2.47, val_accuracy=0.477, lr=0.1]     53%|█████▎    | 61/115 [23:58<20:37, 22.92s/epoch, loss=1.15, accuracy=0.75, val_loss=2.42, val_accuracy=0.407, lr=0.1] 54%|█████▍    | 62/115 [24:21<20:13, 22.89s/epoch, loss=1.15, accuracy=0.749, val_loss=2.79, val_accuracy=0.428, lr=0.1] 55%|█████▍    | 63/115 [24:43<19:45, 22.81s/epoch, loss=1.15, accuracy=0.75, val_loss=1.69, val_accuracy=0.553, lr=0.1]  56%|█████▌    | 64/115 [25:06<19:28, 22.90s/epoch, loss=1.15, accuracy=0.75, val_loss=3.17, val_accuracy=0.23, lr=0.0316] 57%|█████▋    | 65/115 [25:29<19:08, 22.97s/epoch, loss=1.15, accuracy=0.749, val_loss=1.66, val_accuracy=0.602, lr=0.1]  57%|█████▋    | 66/115 [25:53<18:49, 23.06s/epoch, loss=1.15, accuracy=0.748, val_loss=2.63, val_accuracy=0.402, lr=0.1] 58%|█████▊    | 67/115 [26:15<18:23, 22.98s/epoch, loss=1.15, accuracy=0.751, val_loss=2.46, val_accuracy=0.354, lr=0.1] 59%|█████▉    | 68/115 [26:38<17:58, 22.95s/epoch, loss=1.16, accuracy=0.751, val_loss=2.97, val_accuracy=0.355, lr=0.1] 60%|██████    | 69/115 [27:02<17:38, 23.02s/epoch, loss=1.15, accuracy=0.748, val_loss=1.73, val_accuracy=0.563, lr=0.0316] 61%|██████    | 70/115 [27:25<17:18, 23.08s/epoch, loss=1.15, accuracy=0.749, val_loss=4.87, val_accuracy=0.25, lr=0.1]     62%|██████▏   | 71/115 [27:48<16:55, 23.09s/epoch, loss=1.15, accuracy=0.75, val_loss=1.52, val_accuracy=0.625, lr=0.1] 63%|██████▎   | 72/115 [28:11<16:35, 23.14s/epoch, loss=1.16, accuracy=0.749, val_loss=1.58, val_accuracy=0.607, lr=0.1] 63%|██████▎   | 73/115 [28:34<16:10, 23.11s/epoch, loss=1.15, accuracy=0.752, val_loss=2.33, val_accuracy=0.457, lr=0.1] 64%|██████▍   | 74/115 [28:57<15:49, 23.15s/epoch, loss=1.14, accuracy=0.753, val_loss=1.96, val_accuracy=0.445, lr=0.0316] 65%|██████▌   | 75/115 [29:21<15:26, 23.16s/epoch, loss=1.15, accuracy=0.75, val_loss=1.74, val_accuracy=0.583, lr=0.1]     66%|██████▌   | 76/115 [29:43<14:59, 23.06s/epoch, loss=1.15, accuracy=0.751, val_loss=2.97, val_accuracy=0.405, lr=0.1] 67%|██████▋   | 77/115 [30:06<14:34, 23.00s/epoch, loss=1.14, accuracy=0.749, val_loss=1.6, val_accuracy=0.597, lr=0.1]  68%|██████▊   | 78/115 [30:30<14:14, 23.10s/epoch, loss=1.14, accuracy=0.753, val_loss=2.1, val_accuracy=0.483, lr=0.1] 69%|██████▊   | 79/115 [30:53<13:54, 23.18s/epoch, loss=1.15, accuracy=0.747, val_loss=1.65, val_accuracy=0.561, lr=0.0316] 70%|██████▉   | 80/115 [31:16<13:30, 23.14s/epoch, loss=1.15, accuracy=0.751, val_loss=1.75, val_accuracy=0.532, lr=0.1]    70%|███████   | 81/115 [31:39<13:02, 23.00s/epoch, loss=1.14, accuracy=0.751, val_loss=2.32, val_accuracy=0.396, lr=0.1] 71%|███████▏  | 82/115 [32:00<12:23, 22.52s/epoch, loss=0.938, accuracy=0.809, val_loss=0.927, val_accuracy=0.798, lr=0.01] 72%|███████▏  | 83/115 [32:23<12:05, 22.66s/epoch, loss=0.755, accuracy=0.843, val_loss=0.805, val_accuracy=0.815, lr=0.01] 73%|███████▎  | 84/115 [32:46<11:47, 22.82s/epoch, loss=0.667, accuracy=0.852, val_loss=0.803, val_accuracy=0.796, lr=0.01] 74%|███████▍  | 85/115 [33:10<11:28, 22.96s/epoch, loss=0.624, accuracy=0.855, val_loss=0.879, val_accuracy=0.773, lr=0.01] 75%|███████▍  | 86/115 [33:33<11:06, 22.98s/epoch, loss=0.601, accuracy=0.857, val_loss=0.719, val_accuracy=0.818, lr=0.01] 76%|███████▌  | 87/115 [33:56<10:44, 23.00s/epoch, loss=0.588, accuracy=0.859, val_loss=0.727, val_accuracy=0.818, lr=0.01] 77%|███████▋  | 88/115 [34:19<10:21, 23.01s/epoch, loss=0.584, accuracy=0.859, val_loss=0.778, val_accuracy=0.797, lr=0.01] 77%|███████▋  | 89/115 [34:42<09:57, 22.99s/epoch, loss=0.58, accuracy=0.861, val_loss=0.77, val_accuracy=0.801, lr=0.01]   78%|███████▊  | 90/115 [35:05<09:35, 23.03s/epoch, loss=0.578, accuracy=0.862, val_loss=0.715, val_accuracy=0.819, lr=0.01] 79%|███████▉  | 91/115 [35:28<09:13, 23.06s/epoch, loss=0.577, accuracy=0.864, val_loss=0.823, val_accuracy=0.786, lr=0.01] 80%|████████  | 92/115 [35:51<08:50, 23.08s/epoch, loss=0.578, accuracy=0.864, val_loss=0.878, val_accuracy=0.772, lr=0.01] 81%|████████  | 93/115 [36:14<08:28, 23.11s/epoch, loss=0.574, accuracy=0.867, val_loss=0.837, val_accuracy=0.783, lr=0.01] 82%|████████▏ | 94/115 [36:37<08:05, 23.11s/epoch, loss=0.575, accuracy=0.868, val_loss=0.736, val_accuracy=0.814, lr=0.01] 83%|████████▎ | 95/115 [37:00<07:41, 23.05s/epoch, loss=0.572, accuracy=0.868, val_loss=0.8, val_accuracy=0.799, lr=0.00316] 83%|████████▎ | 96/115 [37:23<07:17, 23.03s/epoch, loss=0.574, accuracy=0.869, val_loss=0.95, val_accuracy=0.761, lr=0.01]   84%|████████▍ | 97/115 [37:45<06:46, 22.61s/epoch, loss=0.573, accuracy=0.868, val_loss=0.847, val_accuracy=0.792, lr=0.01] 85%|████████▌ | 98/115 [38:08<06:27, 22.78s/epoch, loss=0.572, accuracy=0.872, val_loss=0.821, val_accuracy=0.803, lr=0.01] 86%|████████▌ | 99/115 [38:31<06:06, 22.92s/epoch, loss=0.576, accuracy=0.87, val_loss=0.753, val_accuracy=0.812, lr=0.01]  87%|████████▋ | 100/115 [38:54<05:44, 22.96s/epoch, loss=0.571, accuracy=0.872, val_loss=0.82, val_accuracy=0.8, lr=0.00316] 88%|████████▊ | 101/115 [39:17<05:21, 22.98s/epoch, loss=0.569, accuracy=0.874, val_loss=0.988, val_accuracy=0.759, lr=0.01] 89%|████████▊ | 102/115 [39:40<04:58, 22.93s/epoch, loss=0.571, accuracy=0.874, val_loss=1.24, val_accuracy=0.692, lr=0.01]  90%|████████▉ | 103/115 [40:03<04:35, 22.99s/epoch, loss=0.567, accuracy=0.874, val_loss=0.824, val_accuracy=0.801, lr=0.01] 90%|█████████ | 104/115 [40:27<04:14, 23.11s/epoch, loss=0.572, accuracy=0.875, val_loss=0.751, val_accuracy=0.814, lr=0.01] 91%|█████████▏| 105/115 [40:50<03:52, 23.21s/epoch, loss=0.573, accuracy=0.875, val_loss=0.896, val_accuracy=0.784, lr=0.00316] 92%|█████████▏| 106/115 [41:13<03:28, 23.16s/epoch, loss=0.567, accuracy=0.877, val_loss=0.833, val_accuracy=0.793, lr=0.01]    93%|█████████▎| 107/115 [41:36<03:05, 23.17s/epoch, loss=0.571, accuracy=0.877, val_loss=0.768, val_accuracy=0.816, lr=0.01] 94%|█████████▍| 108/115 [41:59<02:41, 23.07s/epoch, loss=0.568, accuracy=0.877, val_loss=0.914, val_accuracy=0.766, lr=0.01] 95%|█████████▍| 109/115 [42:22<02:17, 22.99s/epoch, loss=0.568, accuracy=0.878, val_loss=0.795, val_accuracy=0.804, lr=0.01] 96%|█████████▌| 110/115 [42:45<01:55, 23.04s/epoch, loss=0.57, accuracy=0.878, val_loss=0.749, val_accuracy=0.822, lr=0.00316] 97%|█████████▋| 111/115 [43:08<01:32, 23.10s/epoch, loss=0.569, accuracy=0.88, val_loss=0.759, val_accuracy=0.823, lr=0.01]    97%|█████████▋| 112/115 [43:32<01:09, 23.14s/epoch, loss=0.573, accuracy=0.878, val_loss=0.951, val_accuracy=0.762, lr=0.01] 98%|█████████▊| 113/115 [43:55<00:46, 23.14s/epoch, loss=0.575, accuracy=0.876, val_loss=0.853, val_accuracy=0.799, lr=0.01] 99%|█████████▉| 114/115 [44:18<00:23, 23.10s/epoch, loss=0.571, accuracy=0.879, val_loss=0.74, val_accuracy=0.825, lr=0.01] 100%|██████████| 115/115 [44:41<00:00, 23.09s/epoch, loss=0.569, accuracy=0.879, val_loss=1.08, val_accuracy=0.734, lr=0.00316]100%|██████████| 115/115 [44:41<00:00, 23.32s/epoch, loss=0.569, accuracy=0.879, val_loss=1.08, val_accuracy=0.734, lr=0.00316]
Using real-time data augmentation.
Test loss: 1.082798957824707
Test accuracy: 0.7340999841690063


* * * Run SGD for ID = 13_10. * * *


2024-02-15 19:42:05.966905: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 19:42:08.530814: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 19:42:08.532003: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-15 19:42:08.567546: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-02-15 19:42:08.567584: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 19:42:08.570171: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 19:42:08.570209: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 19:42:08.572217: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 19:42:08.572847: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 19:42:08.575042: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 19:42:08.576413: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 19:42:08.580742: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 19:42:08.581253: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 19:42:08.581341: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 19:42:09.776027: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-15 19:42:09.777128: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 19:42:09.777751: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-02-15 19:42:09.777781: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 19:42:09.777849: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 19:42:09.777870: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 19:42:09.777890: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 19:42:09.777908: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 19:42:09.777927: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 19:42:09.777946: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 19:42:09.777965: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 19:42:09.778393: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 19:42:09.778425: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 19:42:10.403109: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-15 19:42:10.403160: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-15 19:42:10.403173: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-15 19:42:10.404028: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11227 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN X (Pascal), pci bus id: 0000:03:00.0, compute capability: 6.1)
{'id': 1310, 'batch_size': 128, 'epochs': 115, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN X (Pascal)'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/115 [00:00<?, ?epoch/s]2024-02-15 19:42:11.164973: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-15 19:42:11.177408: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2599900000 Hz
2024-02-15 19:42:13.007927: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 19:42:13.242206: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 19:42:13.972575: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-15 19:42:14.020502: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/115 [00:54<1:44:22, 54.93s/epoch, loss=3.39, accuracy=0.275, val_loss=2.46, val_accuracy=0.249, lr=0.1]  2%|▏         | 2/115 [01:17<1:07:33, 35.87s/epoch, loss=1.59, accuracy=0.523, val_loss=2.72, val_accuracy=0.257, lr=0.1]  3%|▎         | 3/115 [01:39<55:35, 29.78s/epoch, loss=1.44, accuracy=0.595, val_loss=1.76, val_accuracy=0.509, lr=0.1]    3%|▎         | 4/115 [02:03<50:35, 27.35s/epoch, loss=1.37, accuracy=0.637, val_loss=2.35, val_accuracy=0.426, lr=0.1]  4%|▍         | 5/115 [02:27<47:42, 26.03s/epoch, loss=1.33, accuracy=0.664, val_loss=2.05, val_accuracy=0.497, lr=0.1]  5%|▌         | 6/115 [02:50<45:46, 25.20s/epoch, loss=1.3, accuracy=0.688, val_loss=2.24, val_accuracy=0.476, lr=0.1]   6%|▌         | 7/115 [03:14<44:19, 24.62s/epoch, loss=1.27, accuracy=0.702, val_loss=1.55, val_accuracy=0.609, lr=0.1]  7%|▋         | 8/115 [03:37<43:19, 24.29s/epoch, loss=1.26, accuracy=0.707, val_loss=2.36, val_accuracy=0.395, lr=0.1]  8%|▊         | 9/115 [04:01<42:33, 24.09s/epoch, loss=1.25, accuracy=0.716, val_loss=2.55, val_accuracy=0.415, lr=0.1]  9%|▊         | 10/115 [04:24<41:48, 23.89s/epoch, loss=1.23, accuracy=0.72, val_loss=2.47, val_accuracy=0.467, lr=0.1] 10%|▉         | 11/115 [04:48<41:12, 23.77s/epoch, loss=1.23, accuracy=0.723, val_loss=1.69, val_accuracy=0.567, lr=0.1] 10%|█         | 12/115 [05:11<40:33, 23.63s/epoch, loss=1.22, accuracy=0.725, val_loss=2.42, val_accuracy=0.451, lr=0.0316] 11%|█▏        | 13/115 [05:34<39:53, 23.47s/epoch, loss=1.22, accuracy=0.728, val_loss=2.26, val_accuracy=0.419, lr=0.1]    12%|█▏        | 14/115 [05:58<39:35, 23.52s/epoch, loss=1.21, accuracy=0.733, val_loss=1.93, val_accuracy=0.522, lr=0.1] 13%|█▎        | 15/115 [06:22<39:18, 23.58s/epoch, loss=1.21, accuracy=0.733, val_loss=2.15, val_accuracy=0.488, lr=0.1] 14%|█▍        | 16/115 [06:46<39:01, 23.65s/epoch, loss=1.2, accuracy=0.732, val_loss=3.38, val_accuracy=0.372, lr=0.1]  15%|█▍        | 17/115 [07:09<38:36, 23.63s/epoch, loss=1.21, accuracy=0.734, val_loss=2.33, val_accuracy=0.513, lr=0.0316] 16%|█▌        | 18/115 [07:33<38:09, 23.60s/epoch, loss=1.21, accuracy=0.735, val_loss=1.64, val_accuracy=0.566, lr=0.1]    17%|█▋        | 19/115 [07:56<37:38, 23.52s/epoch, loss=1.2, accuracy=0.736, val_loss=2.39, val_accuracy=0.446, lr=0.1]  17%|█▋        | 20/115 [08:19<37:11, 23.49s/epoch, loss=1.2, accuracy=0.737, val_loss=1.87, val_accuracy=0.532, lr=0.1] 18%|█▊        | 21/115 [08:43<36:43, 23.44s/epoch, loss=1.2, accuracy=0.738, val_loss=1.83, val_accuracy=0.53, lr=0.1]  19%|█▉        | 22/115 [09:06<36:21, 23.46s/epoch, loss=1.2, accuracy=0.737, val_loss=2.04, val_accuracy=0.53, lr=0.0316] 20%|██        | 23/115 [09:30<36:01, 23.49s/epoch, loss=1.19, accuracy=0.739, val_loss=1.66, val_accuracy=0.596, lr=0.1]  21%|██        | 24/115 [09:53<35:23, 23.34s/epoch, loss=1.18, accuracy=0.739, val_loss=1.98, val_accuracy=0.524, lr=0.1] 22%|██▏       | 25/115 [10:16<35:04, 23.38s/epoch, loss=1.18, accuracy=0.742, val_loss=2.35, val_accuracy=0.442, lr=0.1] 23%|██▎       | 26/115 [10:40<34:38, 23.36s/epoch, loss=1.18, accuracy=0.741, val_loss=1.5, val_accuracy=0.628, lr=0.1]  23%|██▎       | 27/115 [11:03<34:25, 23.47s/epoch, loss=1.18, accuracy=0.744, val_loss=2.87, val_accuracy=0.436, lr=0.1] 24%|██▍       | 28/115 [11:27<34:07, 23.53s/epoch, loss=1.18, accuracy=0.742, val_loss=3.49, val_accuracy=0.403, lr=0.1] 25%|██▌       | 29/115 [11:51<33:47, 23.58s/epoch, loss=1.17, accuracy=0.744, val_loss=1.62, val_accuracy=0.595, lr=0.1] 26%|██▌       | 30/115 [12:15<33:30, 23.65s/epoch, loss=1.17, accuracy=0.747, val_loss=1.91, val_accuracy=0.484, lr=0.1] 27%|██▋       | 31/115 [12:38<33:04, 23.63s/epoch, loss=1.17, accuracy=0.745, val_loss=1.71, val_accuracy=0.568, lr=0.0316] 28%|██▊       | 32/115 [13:01<32:35, 23.56s/epoch, loss=1.17, accuracy=0.747, val_loss=1.47, val_accuracy=0.632, lr=0.1]    29%|██▊       | 33/115 [13:25<32:09, 23.53s/epoch, loss=1.17, accuracy=0.747, val_loss=1.71, val_accuracy=0.554, lr=0.1] 30%|██▉       | 34/115 [13:48<31:43, 23.49s/epoch, loss=1.16, accuracy=0.749, val_loss=1.62, val_accuracy=0.605, lr=0.1] 30%|███       | 35/115 [14:12<31:23, 23.55s/epoch, loss=1.16, accuracy=0.749, val_loss=1.72, val_accuracy=0.567, lr=0.1] 31%|███▏      | 36/115 [14:36<31:03, 23.59s/epoch, loss=1.16, accuracy=0.748, val_loss=1.75, val_accuracy=0.555, lr=0.1] 32%|███▏      | 37/115 [14:59<30:40, 23.59s/epoch, loss=1.16, accuracy=0.748, val_loss=1.74, val_accuracy=0.572, lr=0.0316] 33%|███▎      | 38/115 [15:23<30:19, 23.63s/epoch, loss=1.16, accuracy=0.746, val_loss=1.87, val_accuracy=0.527, lr=0.1]    34%|███▍      | 39/115 [15:46<29:49, 23.54s/epoch, loss=1.16, accuracy=0.749, val_loss=2.09, val_accuracy=0.468, lr=0.1] 35%|███▍      | 40/115 [16:10<29:25, 23.54s/epoch, loss=1.16, accuracy=0.749, val_loss=1.93, val_accuracy=0.526, lr=0.1] 36%|███▌      | 41/115 [16:33<29:02, 23.54s/epoch, loss=1.16, accuracy=0.751, val_loss=1.54, val_accuracy=0.618, lr=0.1] 37%|███▋      | 42/115 [16:57<28:37, 23.52s/epoch, loss=1.16, accuracy=0.75, val_loss=1.88, val_accuracy=0.552, lr=0.0316] 37%|███▋      | 43/115 [17:20<28:14, 23.53s/epoch, loss=1.16, accuracy=0.75, val_loss=1.43, val_accuracy=0.665, lr=0.1]    38%|███▊      | 44/115 [17:44<27:47, 23.49s/epoch, loss=1.15, accuracy=0.749, val_loss=1.7, val_accuracy=0.561, lr=0.1] 39%|███▉      | 45/115 [18:07<27:21, 23.45s/epoch, loss=1.15, accuracy=0.752, val_loss=1.83, val_accuracy=0.577, lr=0.1] 40%|████      | 46/115 [18:31<27:02, 23.52s/epoch, loss=1.15, accuracy=0.75, val_loss=2.3, val_accuracy=0.413, lr=0.1]   41%|████      | 47/115 [18:55<26:42, 23.57s/epoch, loss=1.15, accuracy=0.75, val_loss=1.54, val_accuracy=0.621, lr=0.1] 42%|████▏     | 48/115 [19:18<26:19, 23.58s/epoch, loss=1.15, accuracy=0.752, val_loss=3.38, val_accuracy=0.395, lr=0.0316] 43%|████▎     | 49/115 [19:42<25:55, 23.58s/epoch, loss=1.15, accuracy=0.752, val_loss=1.75, val_accuracy=0.556, lr=0.1]    43%|████▎     | 50/115 [20:05<25:32, 23.58s/epoch, loss=1.15, accuracy=0.752, val_loss=1.96, val_accuracy=0.492, lr=0.1] 44%|████▍     | 51/115 [20:29<25:11, 23.61s/epoch, loss=1.15, accuracy=0.753, val_loss=1.67, val_accuracy=0.582, lr=0.1] 45%|████▌     | 52/115 [20:53<24:51, 23.67s/epoch, loss=1.14, accuracy=0.753, val_loss=1.98, val_accuracy=0.483, lr=0.1] 46%|████▌     | 53/115 [21:17<24:31, 23.73s/epoch, loss=1.15, accuracy=0.751, val_loss=2.05, val_accuracy=0.521, lr=0.0316] 47%|████▋     | 54/115 [21:40<24:07, 23.74s/epoch, loss=1.14, accuracy=0.752, val_loss=1.88, val_accuracy=0.528, lr=0.1]    48%|████▊     | 55/115 [22:04<23:41, 23.69s/epoch, loss=1.14, accuracy=0.754, val_loss=2.08, val_accuracy=0.438, lr=0.1] 49%|████▊     | 56/115 [22:28<23:18, 23.70s/epoch, loss=1.15, accuracy=0.752, val_loss=1.63, val_accuracy=0.577, lr=0.1] 50%|████▉     | 57/115 [22:51<22:51, 23.64s/epoch, loss=1.14, accuracy=0.754, val_loss=1.81, val_accuracy=0.559, lr=0.1] 50%|█████     | 58/115 [23:15<22:23, 23.58s/epoch, loss=1.14, accuracy=0.754, val_loss=3.04, val_accuracy=0.237, lr=0.0316] 51%|█████▏    | 59/115 [23:38<22:01, 23.61s/epoch, loss=1.14, accuracy=0.754, val_loss=1.96, val_accuracy=0.526, lr=0.1]    52%|█████▏    | 60/115 [24:02<21:35, 23.55s/epoch, loss=1.14, accuracy=0.753, val_loss=1.61, val_accuracy=0.604, lr=0.1] 53%|█████▎    | 61/115 [24:25<21:10, 23.53s/epoch, loss=1.14, accuracy=0.752, val_loss=1.58, val_accuracy=0.601, lr=0.1] 54%|█████▍    | 62/115 [24:49<20:43, 23.46s/epoch, loss=1.14, accuracy=0.755, val_loss=1.55, val_accuracy=0.634, lr=0.1] 55%|█████▍    | 63/115 [25:12<20:15, 23.38s/epoch, loss=1.13, accuracy=0.755, val_loss=1.91, val_accuracy=0.523, lr=0.0316] 56%|█████▌    | 64/115 [25:35<19:47, 23.29s/epoch, loss=1.14, accuracy=0.754, val_loss=1.66, val_accuracy=0.567, lr=0.1]    57%|█████▋    | 65/115 [25:58<19:25, 23.31s/epoch, loss=1.14, accuracy=0.753, val_loss=2.86, val_accuracy=0.404, lr=0.1] 57%|█████▋    | 66/115 [26:22<19:06, 23.40s/epoch, loss=1.14, accuracy=0.753, val_loss=1.49, val_accuracy=0.627, lr=0.1] 58%|█████▊    | 67/115 [26:45<18:46, 23.48s/epoch, loss=1.14, accuracy=0.755, val_loss=2.07, val_accuracy=0.415, lr=0.1] 59%|█████▉    | 68/115 [27:09<18:26, 23.55s/epoch, loss=1.15, accuracy=0.755, val_loss=1.52, val_accuracy=0.629, lr=0.0316] 60%|██████    | 69/115 [27:33<18:05, 23.60s/epoch, loss=1.14, accuracy=0.756, val_loss=1.51, val_accuracy=0.623, lr=0.1]    61%|██████    | 70/115 [27:57<17:42, 23.60s/epoch, loss=1.14, accuracy=0.759, val_loss=1.95, val_accuracy=0.547, lr=0.1] 62%|██████▏   | 71/115 [28:20<17:16, 23.56s/epoch, loss=1.14, accuracy=0.756, val_loss=1.61, val_accuracy=0.615, lr=0.1] 63%|██████▎   | 72/115 [28:44<16:53, 23.56s/epoch, loss=1.13, accuracy=0.753, val_loss=1.84, val_accuracy=0.552, lr=0.1] 63%|██████▎   | 73/115 [29:07<16:29, 23.55s/epoch, loss=1.13, accuracy=0.755, val_loss=1.32, val_accuracy=0.696, lr=0.1] 64%|██████▍   | 74/115 [29:31<16:06, 23.58s/epoch, loss=1.14, accuracy=0.752, val_loss=1.81, val_accuracy=0.577, lr=0.1] 65%|██████▌   | 75/115 [29:54<15:42, 23.56s/epoch, loss=1.13, accuracy=0.756, val_loss=1.41, val_accuracy=0.653, lr=0.1] 66%|██████▌   | 76/115 [30:17<15:13, 23.41s/epoch, loss=1.13, accuracy=0.755, val_loss=2.42, val_accuracy=0.493, lr=0.1] 67%|██████▋   | 77/115 [30:41<14:49, 23.40s/epoch, loss=1.15, accuracy=0.754, val_loss=1.9, val_accuracy=0.509, lr=0.1]  68%|██████▊   | 78/115 [31:04<14:28, 23.48s/epoch, loss=1.13, accuracy=0.755, val_loss=1.72, val_accuracy=0.572, lr=0.0316] 69%|██████▊   | 79/115 [31:28<14:06, 23.51s/epoch, loss=1.13, accuracy=0.755, val_loss=1.71, val_accuracy=0.55, lr=0.1]     70%|██████▉   | 80/115 [31:52<13:44, 23.55s/epoch, loss=1.13, accuracy=0.754, val_loss=3.04, val_accuracy=0.396, lr=0.1] 70%|███████   | 81/115 [32:15<13:19, 23.53s/epoch, loss=1.13, accuracy=0.755, val_loss=2.48, val_accuracy=0.456, lr=0.1] 71%|███████▏  | 82/115 [32:39<12:58, 23.59s/epoch, loss=0.918, accuracy=0.816, val_loss=0.938, val_accuracy=0.796, lr=0.01] 72%|███████▏  | 83/115 [33:02<12:34, 23.59s/epoch, loss=0.737, accuracy=0.848, val_loss=0.795, val_accuracy=0.813, lr=0.01] 73%|███████▎  | 84/115 [33:26<12:11, 23.60s/epoch, loss=0.655, accuracy=0.857, val_loss=0.845, val_accuracy=0.796, lr=0.01] 74%|███████▍  | 85/115 [33:49<11:45, 23.52s/epoch, loss=0.611, accuracy=0.858, val_loss=0.808, val_accuracy=0.794, lr=0.01] 75%|███████▍  | 86/115 [34:13<11:23, 23.57s/epoch, loss=0.593, accuracy=0.859, val_loss=0.809, val_accuracy=0.791, lr=0.01] 76%|███████▌  | 87/115 [34:36<10:51, 23.26s/epoch, loss=0.579, accuracy=0.862, val_loss=0.7, val_accuracy=0.823, lr=0.01]   77%|███████▋  | 88/115 [34:59<10:31, 23.38s/epoch, loss=0.568, accuracy=0.866, val_loss=0.701, val_accuracy=0.821, lr=0.01] 77%|███████▋  | 89/115 [35:23<10:09, 23.43s/epoch, loss=0.566, accuracy=0.865, val_loss=0.826, val_accuracy=0.789, lr=0.01] 78%|███████▊  | 90/115 [35:47<09:50, 23.62s/epoch, loss=0.571, accuracy=0.865, val_loss=0.814, val_accuracy=0.789, lr=0.01] 79%|███████▉  | 91/115 [36:10<09:23, 23.48s/epoch, loss=0.568, accuracy=0.865, val_loss=0.829, val_accuracy=0.792, lr=0.01] 80%|████████  | 92/115 [36:34<09:00, 23.51s/epoch, loss=0.566, accuracy=0.868, val_loss=0.721, val_accuracy=0.813, lr=0.00316] 81%|████████  | 93/115 [36:57<08:36, 23.46s/epoch, loss=0.562, accuracy=0.871, val_loss=1.04, val_accuracy=0.736, lr=0.01]     82%|████████▏ | 94/115 [37:20<08:12, 23.45s/epoch, loss=0.56, accuracy=0.872, val_loss=0.846, val_accuracy=0.787, lr=0.01] 83%|████████▎ | 95/115 [37:44<07:50, 23.51s/epoch, loss=0.558, accuracy=0.873, val_loss=0.88, val_accuracy=0.787, lr=0.01] 83%|████████▎ | 96/115 [38:07<07:22, 23.29s/epoch, loss=0.565, accuracy=0.873, val_loss=0.732, val_accuracy=0.819, lr=0.01] 84%|████████▍ | 97/115 [38:29<06:54, 23.03s/epoch, loss=0.561, accuracy=0.874, val_loss=1.3, val_accuracy=0.701, lr=0.00316] 85%|████████▌ | 98/115 [38:53<06:33, 23.12s/epoch, loss=0.563, accuracy=0.874, val_loss=0.73, val_accuracy=0.811, lr=0.01]   86%|████████▌ | 99/115 [39:16<06:11, 23.25s/epoch, loss=0.564, accuracy=0.876, val_loss=0.696, val_accuracy=0.834, lr=0.01] 87%|████████▋ | 100/115 [39:40<05:50, 23.36s/epoch, loss=0.56, accuracy=0.875, val_loss=0.827, val_accuracy=0.796, lr=0.01] 88%|████████▊ | 101/115 [40:03<05:27, 23.39s/epoch, loss=0.561, accuracy=0.876, val_loss=0.735, val_accuracy=0.821, lr=0.01] 89%|████████▊ | 102/115 [40:27<05:05, 23.47s/epoch, loss=0.561, accuracy=0.877, val_loss=0.774, val_accuracy=0.811, lr=0.01] 90%|████████▉ | 103/115 [40:50<04:39, 23.29s/epoch, loss=0.556, accuracy=0.881, val_loss=0.862, val_accuracy=0.785, lr=0.01] 90%|█████████ | 104/115 [41:13<04:15, 23.26s/epoch, loss=0.558, accuracy=0.879, val_loss=0.782, val_accuracy=0.813, lr=0.00316] 91%|█████████▏| 105/115 [41:36<03:51, 23.18s/epoch, loss=0.561, accuracy=0.878, val_loss=0.803, val_accuracy=0.8, lr=0.01]      92%|█████████▏| 106/115 [41:59<03:29, 23.24s/epoch, loss=0.559, accuracy=0.881, val_loss=0.761, val_accuracy=0.823, lr=0.01] 93%|█████████▎| 107/115 [42:22<03:05, 23.13s/epoch, loss=0.559, accuracy=0.879, val_loss=0.728, val_accuracy=0.826, lr=0.01] 94%|█████████▍| 108/115 [42:45<02:41, 23.12s/epoch, loss=0.557, accuracy=0.881, val_loss=0.811, val_accuracy=0.803, lr=0.01] 95%|█████████▍| 109/115 [43:09<02:19, 23.20s/epoch, loss=0.558, accuracy=0.88, val_loss=0.967, val_accuracy=0.761, lr=0.00316] 96%|█████████▌| 110/115 [43:32<01:56, 23.29s/epoch, loss=0.555, accuracy=0.881, val_loss=0.792, val_accuracy=0.811, lr=0.01]   97%|█████████▋| 111/115 [43:55<01:33, 23.28s/epoch, loss=0.558, accuracy=0.881, val_loss=0.795, val_accuracy=0.796, lr=0.01] 97%|█████████▋| 112/115 [44:19<01:09, 23.28s/epoch, loss=0.552, accuracy=0.884, val_loss=0.957, val_accuracy=0.777, lr=0.01] 98%|█████████▊| 113/115 [44:42<00:46, 23.28s/epoch, loss=0.558, accuracy=0.882, val_loss=0.763, val_accuracy=0.826, lr=0.01] 99%|█████████▉| 114/115 [45:06<00:23, 23.40s/epoch, loss=0.56, accuracy=0.882, val_loss=0.745, val_accuracy=0.822, lr=0.00316]100%|██████████| 115/115 [45:29<00:00, 23.43s/epoch, loss=0.553, accuracy=0.884, val_loss=0.848, val_accuracy=0.789, lr=0.01]  100%|██████████| 115/115 [45:29<00:00, 23.74s/epoch, loss=0.553, accuracy=0.884, val_loss=0.848, val_accuracy=0.789, lr=0.01]
Using real-time data augmentation.
Test loss: 0.8475419878959656
Test accuracy: 0.7889000177383423


* * * Run SGD for ID = 13_11. * * *


2024-02-15 20:27:43.098196: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 20:27:45.617504: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 20:27:45.618606: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-15 20:27:45.653583: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-02-15 20:27:45.653612: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 20:27:45.656433: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 20:27:45.656471: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 20:27:45.658707: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 20:27:45.659410: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 20:27:45.661705: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 20:27:45.663088: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 20:27:45.667712: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 20:27:45.668166: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 20:27:45.668233: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 20:27:46.830942: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-15 20:27:46.831514: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 20:27:46.832125: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-02-15 20:27:46.832162: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 20:27:46.832208: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 20:27:46.832229: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 20:27:46.832248: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 20:27:46.832266: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 20:27:46.832295: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 20:27:46.832317: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 20:27:46.832335: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 20:27:46.832748: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 20:27:46.832786: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 20:27:47.425957: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-15 20:27:47.426013: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-15 20:27:47.426022: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-15 20:27:47.426899: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11227 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN X (Pascal), pci bus id: 0000:03:00.0, compute capability: 6.1)
{'id': 1311, 'batch_size': 128, 'epochs': 115, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN X (Pascal)'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/115 [00:00<?, ?epoch/s]2024-02-15 20:27:48.170638: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-15 20:27:48.182385: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2599900000 Hz
2024-02-15 20:27:49.984524: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 20:27:50.175834: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 20:27:50.908905: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-15 20:27:50.951110: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/115 [00:55<1:44:40, 55.10s/epoch, loss=8.76, accuracy=0.162, val_loss=3.65, val_accuracy=0.145, lr=0.1]  2%|▏         | 2/115 [01:17<1:08:00, 36.11s/epoch, loss=2.16, accuracy=0.389, val_loss=2.54, val_accuracy=0.193, lr=0.1]  3%|▎         | 3/115 [01:40<55:32, 29.75s/epoch, loss=1.5, accuracy=0.545, val_loss=2.25, val_accuracy=0.411, lr=0.1]     3%|▎         | 4/115 [02:03<50:22, 27.23s/epoch, loss=1.33, accuracy=0.641, val_loss=3.62, val_accuracy=0.28, lr=0.1]  4%|▍         | 5/115 [02:27<47:30, 25.92s/epoch, loss=1.27, accuracy=0.678, val_loss=2.38, val_accuracy=0.425, lr=0.1]  5%|▌         | 6/115 [02:50<45:26, 25.01s/epoch, loss=1.26, accuracy=0.696, val_loss=3.54, val_accuracy=0.309, lr=0.1]  6%|▌         | 7/115 [03:13<43:47, 24.33s/epoch, loss=1.24, accuracy=0.71, val_loss=1.73, val_accuracy=0.544, lr=0.1]   7%|▋         | 8/115 [03:36<42:53, 24.05s/epoch, loss=1.24, accuracy=0.709, val_loss=2.8, val_accuracy=0.366, lr=0.1]  8%|▊         | 9/115 [03:59<41:57, 23.75s/epoch, loss=1.22, accuracy=0.719, val_loss=2.39, val_accuracy=0.373, lr=0.1]  9%|▊         | 10/115 [04:22<41:15, 23.57s/epoch, loss=1.22, accuracy=0.722, val_loss=2.12, val_accuracy=0.433, lr=0.1] 10%|▉         | 11/115 [04:45<40:33, 23.40s/epoch, loss=1.21, accuracy=0.726, val_loss=1.6, val_accuracy=0.594, lr=0.1]  10%|█         | 12/115 [05:09<39:59, 23.30s/epoch, loss=1.22, accuracy=0.725, val_loss=2.07, val_accuracy=0.434, lr=0.1] 11%|█▏        | 13/115 [05:32<39:35, 23.29s/epoch, loss=1.21, accuracy=0.731, val_loss=1.92, val_accuracy=0.482, lr=0.1] 12%|█▏        | 14/115 [05:55<39:08, 23.25s/epoch, loss=1.2, accuracy=0.733, val_loss=1.48, val_accuracy=0.641, lr=0.1]  13%|█▎        | 15/115 [06:18<38:46, 23.26s/epoch, loss=1.21, accuracy=0.731, val_loss=12.8, val_accuracy=0.1, lr=0.1]  14%|█▍        | 16/115 [06:42<38:23, 23.27s/epoch, loss=1.2, accuracy=0.734, val_loss=3.6, val_accuracy=0.336, lr=0.1] 15%|█▍        | 17/115 [07:04<37:34, 23.00s/epoch, loss=1.19, accuracy=0.733, val_loss=2.12, val_accuracy=0.513, lr=0.1] 16%|█▌        | 18/115 [07:27<37:23, 23.12s/epoch, loss=1.19, accuracy=0.738, val_loss=2.34, val_accuracy=0.381, lr=0.1] 17%|█▋        | 19/115 [07:51<37:04, 23.18s/epoch, loss=1.19, accuracy=0.74, val_loss=2.56, val_accuracy=0.336, lr=0.0316] 17%|█▋        | 20/115 [08:14<36:46, 23.23s/epoch, loss=1.18, accuracy=0.739, val_loss=2.72, val_accuracy=0.412, lr=0.1]   18%|█▊        | 21/115 [08:37<36:27, 23.27s/epoch, loss=1.19, accuracy=0.739, val_loss=1.91, val_accuracy=0.501, lr=0.1] 19%|█▉        | 22/115 [09:00<35:48, 23.10s/epoch, loss=1.18, accuracy=0.742, val_loss=1.92, val_accuracy=0.471, lr=0.1] 20%|██        | 23/115 [09:23<35:24, 23.09s/epoch, loss=1.17, accuracy=0.747, val_loss=1.62, val_accuracy=0.605, lr=0.1] 21%|██        | 24/115 [09:46<35:01, 23.10s/epoch, loss=1.17, accuracy=0.743, val_loss=4.16, val_accuracy=0.226, lr=0.0316] 22%|██▏       | 25/115 [10:09<34:32, 23.03s/epoch, loss=1.17, accuracy=0.744, val_loss=2.06, val_accuracy=0.428, lr=0.1]    23%|██▎       | 26/115 [10:32<34:12, 23.06s/epoch, loss=1.17, accuracy=0.746, val_loss=1.63, val_accuracy=0.613, lr=0.1] 23%|██▎       | 27/115 [10:56<33:55, 23.13s/epoch, loss=1.17, accuracy=0.745, val_loss=2.67, val_accuracy=0.416, lr=0.1] 24%|██▍       | 28/115 [11:19<33:36, 23.17s/epoch, loss=1.17, accuracy=0.746, val_loss=1.38, val_accuracy=0.675, lr=0.1] 25%|██▌       | 29/115 [11:42<33:12, 23.17s/epoch, loss=1.17, accuracy=0.746, val_loss=1.84, val_accuracy=0.517, lr=0.1] 26%|██▌       | 30/115 [12:05<32:54, 23.23s/epoch, loss=1.16, accuracy=0.748, val_loss=2.28, val_accuracy=0.487, lr=0.1] 27%|██▋       | 31/115 [12:29<32:36, 23.29s/epoch, loss=1.16, accuracy=0.75, val_loss=2.04, val_accuracy=0.531, lr=0.1]  28%|██▊       | 32/115 [12:52<32:19, 23.36s/epoch, loss=1.16, accuracy=0.748, val_loss=2.68, val_accuracy=0.322, lr=0.1] 29%|██▊       | 33/115 [13:16<31:54, 23.35s/epoch, loss=1.16, accuracy=0.746, val_loss=2.75, val_accuracy=0.43, lr=0.0316] 30%|██▉       | 34/115 [13:39<31:33, 23.37s/epoch, loss=1.16, accuracy=0.749, val_loss=1.79, val_accuracy=0.556, lr=0.1]   30%|███       | 35/115 [14:02<31:03, 23.30s/epoch, loss=1.15, accuracy=0.751, val_loss=1.92, val_accuracy=0.512, lr=0.1] 31%|███▏      | 36/115 [14:26<30:46, 23.37s/epoch, loss=1.15, accuracy=0.751, val_loss=1.59, val_accuracy=0.614, lr=0.1] 32%|███▏      | 37/115 [14:49<30:20, 23.34s/epoch, loss=1.15, accuracy=0.749, val_loss=1.75, val_accuracy=0.531, lr=0.1] 33%|███▎      | 38/115 [15:12<29:52, 23.29s/epoch, loss=1.15, accuracy=0.751, val_loss=2.04, val_accuracy=0.425, lr=0.0316] 34%|███▍      | 39/115 [15:35<29:26, 23.25s/epoch, loss=1.14, accuracy=0.751, val_loss=1.76, val_accuracy=0.523, lr=0.1]    35%|███▍      | 40/115 [15:58<29:02, 23.23s/epoch, loss=1.15, accuracy=0.754, val_loss=1.62, val_accuracy=0.591, lr=0.1] 36%|███▌      | 41/115 [16:22<28:41, 23.26s/epoch, loss=1.14, accuracy=0.751, val_loss=2.71, val_accuracy=0.389, lr=0.1] 37%|███▋      | 42/115 [16:45<28:13, 23.20s/epoch, loss=1.15, accuracy=0.754, val_loss=2.35, val_accuracy=0.453, lr=0.1] 37%|███▋      | 43/115 [17:08<27:54, 23.26s/epoch, loss=1.14, accuracy=0.753, val_loss=3.56, val_accuracy=0.338, lr=0.0316] 38%|███▊      | 44/115 [17:32<27:32, 23.27s/epoch, loss=1.14, accuracy=0.751, val_loss=1.72, val_accuracy=0.552, lr=0.1]    39%|███▉      | 45/115 [17:55<27:12, 23.32s/epoch, loss=1.14, accuracy=0.755, val_loss=1.78, val_accuracy=0.571, lr=0.1] 40%|████      | 46/115 [18:18<26:44, 23.25s/epoch, loss=1.13, accuracy=0.755, val_loss=1.74, val_accuracy=0.529, lr=0.1] 41%|████      | 47/115 [18:41<26:21, 23.25s/epoch, loss=1.14, accuracy=0.755, val_loss=3.46, val_accuracy=0.305, lr=0.1] 42%|████▏     | 48/115 [19:05<25:58, 23.27s/epoch, loss=1.13, accuracy=0.754, val_loss=1.67, val_accuracy=0.549, lr=0.0316] 43%|████▎     | 49/115 [19:28<25:39, 23.32s/epoch, loss=1.14, accuracy=0.753, val_loss=2.57, val_accuracy=0.47, lr=0.1]     43%|████▎     | 50/115 [19:51<25:06, 23.17s/epoch, loss=1.14, accuracy=0.755, val_loss=1.47, val_accuracy=0.628, lr=0.1] 44%|████▍     | 51/115 [20:14<24:46, 23.22s/epoch, loss=1.13, accuracy=0.755, val_loss=2.62, val_accuracy=0.287, lr=0.1] 45%|████▌     | 52/115 [20:38<24:26, 23.27s/epoch, loss=1.13, accuracy=0.755, val_loss=6.77, val_accuracy=0.227, lr=0.1] 46%|████▌     | 53/115 [21:01<24:07, 23.34s/epoch, loss=1.12, accuracy=0.754, val_loss=1.56, val_accuracy=0.593, lr=0.0316] 47%|████▋     | 54/115 [21:24<23:43, 23.34s/epoch, loss=1.13, accuracy=0.754, val_loss=1.54, val_accuracy=0.609, lr=0.1]    48%|████▊     | 55/115 [21:48<23:20, 23.35s/epoch, loss=1.13, accuracy=0.752, val_loss=2.58, val_accuracy=0.459, lr=0.1] 49%|████▊     | 56/115 [22:11<22:56, 23.33s/epoch, loss=1.13, accuracy=0.755, val_loss=1.82, val_accuracy=0.518, lr=0.1] 50%|████▉     | 57/115 [22:35<22:34, 23.36s/epoch, loss=1.13, accuracy=0.756, val_loss=2.13, val_accuracy=0.531, lr=0.1] 50%|█████     | 58/115 [22:58<22:12, 23.37s/epoch, loss=1.13, accuracy=0.755, val_loss=1.47, val_accuracy=0.631, lr=0.0316] 51%|█████▏    | 59/115 [23:21<21:50, 23.41s/epoch, loss=1.13, accuracy=0.753, val_loss=3.03, val_accuracy=0.391, lr=0.1]    52%|█████▏    | 60/115 [23:45<21:27, 23.41s/epoch, loss=1.12, accuracy=0.758, val_loss=1.91, val_accuracy=0.478, lr=0.1] 53%|█████▎    | 61/115 [24:08<21:00, 23.35s/epoch, loss=1.13, accuracy=0.757, val_loss=2.49, val_accuracy=0.417, lr=0.1] 54%|█████▍    | 62/115 [24:31<20:38, 23.37s/epoch, loss=1.13, accuracy=0.757, val_loss=2.56, val_accuracy=0.44, lr=0.1]  55%|█████▍    | 63/115 [24:54<20:09, 23.26s/epoch, loss=1.13, accuracy=0.758, val_loss=2.01, val_accuracy=0.483, lr=0.0316] 56%|█████▌    | 64/115 [25:18<19:45, 23.25s/epoch, loss=1.12, accuracy=0.756, val_loss=2.72, val_accuracy=0.417, lr=0.1]    57%|█████▋    | 65/115 [25:41<19:21, 23.24s/epoch, loss=1.13, accuracy=0.755, val_loss=1.76, val_accuracy=0.538, lr=0.1] 57%|█████▋    | 66/115 [26:04<18:57, 23.21s/epoch, loss=1.13, accuracy=0.754, val_loss=2.27, val_accuracy=0.431, lr=0.1] 58%|█████▊    | 67/115 [26:27<18:30, 23.13s/epoch, loss=1.12, accuracy=0.756, val_loss=1.9, val_accuracy=0.519, lr=0.1]  59%|█████▉    | 68/115 [26:50<18:07, 23.13s/epoch, loss=1.13, accuracy=0.755, val_loss=1.8, val_accuracy=0.539, lr=0.0316] 60%|██████    | 69/115 [27:13<17:42, 23.11s/epoch, loss=1.12, accuracy=0.756, val_loss=2.58, val_accuracy=0.32, lr=0.1]    61%|██████    | 70/115 [27:36<17:21, 23.15s/epoch, loss=1.12, accuracy=0.756, val_loss=1.84, val_accuracy=0.505, lr=0.1] 62%|██████▏   | 71/115 [28:00<16:59, 23.16s/epoch, loss=1.12, accuracy=0.756, val_loss=2.02, val_accuracy=0.503, lr=0.1] 63%|██████▎   | 72/115 [28:23<16:35, 23.16s/epoch, loss=1.13, accuracy=0.757, val_loss=2.38, val_accuracy=0.441, lr=0.1] 63%|██████▎   | 73/115 [28:46<16:08, 23.05s/epoch, loss=1.12, accuracy=0.757, val_loss=2.1, val_accuracy=0.485, lr=0.0316] 64%|██████▍   | 74/115 [29:09<15:46, 23.09s/epoch, loss=1.12, accuracy=0.757, val_loss=2.24, val_accuracy=0.488, lr=0.1]   65%|██████▌   | 75/115 [29:32<15:27, 23.18s/epoch, loss=1.12, accuracy=0.756, val_loss=4.49, val_accuracy=0.339, lr=0.1] 66%|██████▌   | 76/115 [29:55<15:05, 23.21s/epoch, loss=1.12, accuracy=0.757, val_loss=1.72, val_accuracy=0.546, lr=0.1] 67%|██████▋   | 77/115 [30:19<14:42, 23.22s/epoch, loss=1.12, accuracy=0.756, val_loss=1.71, val_accuracy=0.548, lr=0.1] 68%|██████▊   | 78/115 [30:42<14:19, 23.24s/epoch, loss=1.12, accuracy=0.754, val_loss=2.46, val_accuracy=0.359, lr=0.0316] 69%|██████▊   | 79/115 [31:05<13:54, 23.19s/epoch, loss=1.12, accuracy=0.756, val_loss=2.05, val_accuracy=0.474, lr=0.1]    70%|██████▉   | 80/115 [31:29<13:34, 23.28s/epoch, loss=1.12, accuracy=0.757, val_loss=2.14, val_accuracy=0.468, lr=0.1] 70%|███████   | 81/115 [31:52<13:13, 23.33s/epoch, loss=1.12, accuracy=0.756, val_loss=1.86, val_accuracy=0.502, lr=0.1] 71%|███████▏  | 82/115 [32:15<12:50, 23.35s/epoch, loss=0.913, accuracy=0.815, val_loss=0.904, val_accuracy=0.798, lr=0.01] 72%|███████▏  | 83/115 [32:39<12:27, 23.35s/epoch, loss=0.733, accuracy=0.848, val_loss=0.862, val_accuracy=0.794, lr=0.01] 73%|███████▎  | 84/115 [33:02<11:59, 23.22s/epoch, loss=0.653, accuracy=0.855, val_loss=0.889, val_accuracy=0.772, lr=0.01] 74%|███████▍  | 85/115 [33:25<11:37, 23.26s/epoch, loss=0.612, accuracy=0.858, val_loss=0.711, val_accuracy=0.821, lr=0.01] 75%|███████▍  | 86/115 [33:48<11:13, 23.22s/epoch, loss=0.591, accuracy=0.856, val_loss=0.83, val_accuracy=0.778, lr=0.01]  76%|███████▌  | 87/115 [34:12<10:52, 23.29s/epoch, loss=0.575, accuracy=0.86, val_loss=0.803, val_accuracy=0.78, lr=0.01]  77%|███████▋  | 88/115 [34:35<10:28, 23.29s/epoch, loss=0.571, accuracy=0.861, val_loss=0.799, val_accuracy=0.795, lr=0.01] 77%|███████▋  | 89/115 [34:58<10:04, 23.27s/epoch, loss=0.569, accuracy=0.862, val_loss=0.862, val_accuracy=0.774, lr=0.01] 78%|███████▊  | 90/115 [35:21<09:41, 23.27s/epoch, loss=0.565, accuracy=0.863, val_loss=0.75, val_accuracy=0.802, lr=0.00316] 79%|███████▉  | 91/115 [35:44<09:16, 23.20s/epoch, loss=0.561, accuracy=0.867, val_loss=0.881, val_accuracy=0.781, lr=0.01]   80%|████████  | 92/115 [36:07<08:52, 23.15s/epoch, loss=0.558, accuracy=0.867, val_loss=0.713, val_accuracy=0.818, lr=0.01] 81%|████████  | 93/115 [36:30<08:26, 23.03s/epoch, loss=0.566, accuracy=0.865, val_loss=0.769, val_accuracy=0.796, lr=0.01] 82%|████████▏ | 94/115 [36:53<08:00, 22.90s/epoch, loss=0.563, accuracy=0.867, val_loss=1.21, val_accuracy=0.706, lr=0.01]  83%|████████▎ | 95/115 [37:16<07:39, 22.97s/epoch, loss=0.563, accuracy=0.868, val_loss=0.961, val_accuracy=0.747, lr=0.00316] 83%|████████▎ | 96/115 [37:39<07:15, 22.92s/epoch, loss=0.556, accuracy=0.871, val_loss=0.706, val_accuracy=0.822, lr=0.01]    84%|████████▍ | 97/115 [38:02<06:53, 22.96s/epoch, loss=0.561, accuracy=0.87, val_loss=0.823, val_accuracy=0.795, lr=0.01]  85%|████████▌ | 98/115 [38:24<06:25, 22.70s/epoch, loss=0.556, accuracy=0.872, val_loss=0.851, val_accuracy=0.783, lr=0.01] 86%|████████▌ | 99/115 [38:47<06:04, 22.79s/epoch, loss=0.557, accuracy=0.872, val_loss=0.784, val_accuracy=0.802, lr=0.01] 87%|████████▋ | 100/115 [39:10<05:41, 22.79s/epoch, loss=0.554, accuracy=0.874, val_loss=0.773, val_accuracy=0.803, lr=0.01] 88%|████████▊ | 101/115 [39:33<05:19, 22.82s/epoch, loss=0.555, accuracy=0.874, val_loss=0.885, val_accuracy=0.775, lr=0.00316] 89%|████████▊ | 102/115 [39:56<04:57, 22.87s/epoch, loss=0.559, accuracy=0.876, val_loss=0.829, val_accuracy=0.787, lr=0.01]    90%|████████▉ | 103/115 [40:18<04:34, 22.86s/epoch, loss=0.556, accuracy=0.875, val_loss=0.896, val_accuracy=0.777, lr=0.01] 90%|█████████ | 104/115 [40:41<04:11, 22.90s/epoch, loss=0.556, accuracy=0.876, val_loss=0.753, val_accuracy=0.813, lr=0.01] 91%|█████████▏| 105/115 [41:05<03:49, 22.98s/epoch, loss=0.554, accuracy=0.877, val_loss=0.821, val_accuracy=0.791, lr=0.01] 92%|█████████▏| 106/115 [41:28<03:26, 22.99s/epoch, loss=0.559, accuracy=0.876, val_loss=0.835, val_accuracy=0.801, lr=0.00316] 93%|█████████▎| 107/115 [41:51<03:04, 23.03s/epoch, loss=0.561, accuracy=0.876, val_loss=1.07, val_accuracy=0.733, lr=0.01]     94%|█████████▍| 108/115 [42:14<02:41, 23.01s/epoch, loss=0.558, accuracy=0.877, val_loss=0.698, val_accuracy=0.838, lr=0.01] 95%|█████████▍| 109/115 [42:37<02:18, 23.07s/epoch, loss=0.556, accuracy=0.877, val_loss=0.834, val_accuracy=0.789, lr=0.01] 96%|█████████▌| 110/115 [43:00<01:55, 23.09s/epoch, loss=0.555, accuracy=0.879, val_loss=1.04, val_accuracy=0.762, lr=0.01]  97%|█████████▋| 111/115 [43:23<01:32, 23.04s/epoch, loss=0.555, accuracy=0.879, val_loss=0.721, val_accuracy=0.823, lr=0.01] 97%|█████████▋| 112/115 [43:46<01:09, 23.11s/epoch, loss=0.559, accuracy=0.876, val_loss=0.951, val_accuracy=0.762, lr=0.01] 98%|█████████▊| 113/115 [44:09<00:46, 23.04s/epoch, loss=0.556, accuracy=0.881, val_loss=0.787, val_accuracy=0.809, lr=0.00316] 99%|█████████▉| 114/115 [44:32<00:23, 23.12s/epoch, loss=0.552, accuracy=0.882, val_loss=0.901, val_accuracy=0.793, lr=0.01]   100%|██████████| 115/115 [44:56<00:00, 23.16s/epoch, loss=0.553, accuracy=0.88, val_loss=0.745, val_accuracy=0.822, lr=0.01] 100%|██████████| 115/115 [44:56<00:00, 23.44s/epoch, loss=0.553, accuracy=0.88, val_loss=0.745, val_accuracy=0.822, lr=0.01]
Using real-time data augmentation.
Test loss: 0.7453061938285828
Test accuracy: 0.8216999769210815


* * * Run SGD for ID = 13_12. * * *


2024-02-15 21:12:46.731513: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 21:12:49.255896: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 21:12:49.257073: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-15 21:12:49.292488: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-02-15 21:12:49.292515: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 21:12:49.295716: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 21:12:49.295754: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 21:12:49.298007: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 21:12:49.298631: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 21:12:49.300887: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 21:12:49.302235: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 21:12:49.306576: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 21:12:49.307026: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 21:12:49.307101: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 21:12:50.567021: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-15 21:12:50.567693: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 21:12:50.568315: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-02-15 21:12:50.568368: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 21:12:50.568436: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 21:12:50.568465: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 21:12:50.568485: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 21:12:50.568503: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 21:12:50.568529: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 21:12:50.568548: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 21:12:50.568566: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 21:12:50.568999: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 21:12:50.569035: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 21:12:51.169678: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-15 21:12:51.169740: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-15 21:12:51.169749: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-15 21:12:51.170662: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11227 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN X (Pascal), pci bus id: 0000:03:00.0, compute capability: 6.1)
{'id': 1312, 'batch_size': 128, 'epochs': 115, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN X (Pascal)'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/115 [00:00<?, ?epoch/s]2024-02-15 21:12:51.921066: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-15 21:12:51.933398: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2599900000 Hz
2024-02-15 21:12:53.699185: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 21:12:53.925203: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 21:12:54.674000: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-15 21:12:54.759484: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/115 [00:51<1:37:46, 51.46s/epoch, loss=3.21, accuracy=0.296, val_loss=2.81, val_accuracy=0.212, lr=0.1]  2%|▏         | 2/115 [01:14<1:05:13, 34.63s/epoch, loss=1.63, accuracy=0.501, val_loss=2.06, val_accuracy=0.362, lr=0.1]  3%|▎         | 3/115 [01:37<54:37, 29.26s/epoch, loss=1.41, accuracy=0.608, val_loss=1.74, val_accuracy=0.495, lr=0.1]    3%|▎         | 4/115 [02:00<49:25, 26.72s/epoch, loss=1.32, accuracy=0.662, val_loss=2.06, val_accuracy=0.485, lr=0.1]  4%|▍         | 5/115 [02:22<46:10, 25.18s/epoch, loss=1.28, accuracy=0.692, val_loss=2.14, val_accuracy=0.459, lr=0.1]  5%|▌         | 6/115 [02:44<43:57, 24.20s/epoch, loss=1.26, accuracy=0.705, val_loss=1.44, val_accuracy=0.64, lr=0.1]   6%|▌         | 7/115 [03:07<42:50, 23.80s/epoch, loss=1.24, accuracy=0.711, val_loss=3.5, val_accuracy=0.352, lr=0.1]  7%|▋         | 8/115 [03:30<41:53, 23.49s/epoch, loss=1.23, accuracy=0.717, val_loss=1.91, val_accuracy=0.506, lr=0.1]  8%|▊         | 9/115 [03:53<41:01, 23.22s/epoch, loss=1.22, accuracy=0.724, val_loss=1.84, val_accuracy=0.531, lr=0.1]  9%|▊         | 10/115 [04:16<40:29, 23.13s/epoch, loss=1.22, accuracy=0.725, val_loss=3.33, val_accuracy=0.362, lr=0.1] 10%|▉         | 11/115 [04:38<39:51, 23.00s/epoch, loss=1.2, accuracy=0.733, val_loss=2.14, val_accuracy=0.474, lr=0.0316] 10%|█         | 12/115 [05:01<39:22, 22.94s/epoch, loss=1.2, accuracy=0.732, val_loss=1.85, val_accuracy=0.505, lr=0.1]    11%|█▏        | 13/115 [05:24<38:59, 22.93s/epoch, loss=1.19, accuracy=0.735, val_loss=2.81, val_accuracy=0.356, lr=0.1] 12%|█▏        | 14/115 [05:47<38:33, 22.91s/epoch, loss=1.2, accuracy=0.736, val_loss=1.81, val_accuracy=0.543, lr=0.1]  13%|█▎        | 15/115 [06:10<38:16, 22.96s/epoch, loss=1.19, accuracy=0.739, val_loss=2.34, val_accuracy=0.421, lr=0.1] 14%|█▍        | 16/115 [06:33<37:59, 23.03s/epoch, loss=1.19, accuracy=0.74, val_loss=1.84, val_accuracy=0.532, lr=0.0316] 15%|█▍        | 17/115 [06:56<37:37, 23.03s/epoch, loss=1.19, accuracy=0.74, val_loss=1.52, val_accuracy=0.632, lr=0.1]    16%|█▌        | 18/115 [07:19<37:08, 22.98s/epoch, loss=1.18, accuracy=0.743, val_loss=2.01, val_accuracy=0.51, lr=0.1] 17%|█▋        | 19/115 [07:42<36:38, 22.90s/epoch, loss=1.18, accuracy=0.745, val_loss=1.85, val_accuracy=0.545, lr=0.1] 17%|█▋        | 20/115 [08:05<36:22, 22.98s/epoch, loss=1.17, accuracy=0.745, val_loss=1.63, val_accuracy=0.587, lr=0.1] 18%|█▊        | 21/115 [08:28<35:56, 22.94s/epoch, loss=1.17, accuracy=0.745, val_loss=3.08, val_accuracy=0.283, lr=0.0316] 19%|█▉        | 22/115 [08:51<35:34, 22.95s/epoch, loss=1.17, accuracy=0.745, val_loss=1.9, val_accuracy=0.52, lr=0.1]      20%|██        | 23/115 [09:14<35:08, 22.92s/epoch, loss=1.18, accuracy=0.746, val_loss=1.85, val_accuracy=0.549, lr=0.1] 21%|██        | 24/115 [09:36<34:43, 22.89s/epoch, loss=1.17, accuracy=0.748, val_loss=2.04, val_accuracy=0.494, lr=0.1] 22%|██▏       | 25/115 [09:59<34:15, 22.84s/epoch, loss=1.17, accuracy=0.748, val_loss=1.54, val_accuracy=0.627, lr=0.1] 23%|██▎       | 26/115 [10:22<33:54, 22.86s/epoch, loss=1.17, accuracy=0.751, val_loss=1.97, val_accuracy=0.469, lr=0.0316] 23%|██▎       | 27/115 [10:45<33:36, 22.91s/epoch, loss=1.17, accuracy=0.749, val_loss=1.58, val_accuracy=0.606, lr=0.1]    24%|██▍       | 28/115 [11:08<33:11, 22.89s/epoch, loss=1.17, accuracy=0.746, val_loss=1.61, val_accuracy=0.573, lr=0.1] 25%|██▌       | 29/115 [11:31<32:43, 22.83s/epoch, loss=1.17, accuracy=0.746, val_loss=2.74, val_accuracy=0.413, lr=0.1] 26%|██▌       | 30/115 [11:54<32:25, 22.89s/epoch, loss=1.17, accuracy=0.749, val_loss=2.54, val_accuracy=0.354, lr=0.1] 27%|██▋       | 31/115 [12:17<32:03, 22.89s/epoch, loss=1.16, accuracy=0.75, val_loss=1.55, val_accuracy=0.602, lr=0.0316] 28%|██▊       | 32/115 [12:39<31:40, 22.90s/epoch, loss=1.16, accuracy=0.75, val_loss=2.02, val_accuracy=0.453, lr=0.1]    29%|██▊       | 33/115 [13:02<31:05, 22.75s/epoch, loss=1.17, accuracy=0.748, val_loss=3.09, val_accuracy=0.26, lr=0.1] 30%|██▉       | 34/115 [13:25<30:47, 22.81s/epoch, loss=1.16, accuracy=0.751, val_loss=1.44, val_accuracy=0.643, lr=0.1] 30%|███       | 35/115 [13:48<30:25, 22.82s/epoch, loss=1.15, accuracy=0.754, val_loss=2.18, val_accuracy=0.422, lr=0.1] 31%|███▏      | 36/115 [14:10<30:00, 22.79s/epoch, loss=1.17, accuracy=0.75, val_loss=2.36, val_accuracy=0.438, lr=0.0316] 32%|███▏      | 37/115 [14:33<29:36, 22.78s/epoch, loss=1.15, accuracy=0.754, val_loss=2.19, val_accuracy=0.49, lr=0.1]    33%|███▎      | 38/115 [14:56<29:18, 22.83s/epoch, loss=1.15, accuracy=0.754, val_loss=1.91, val_accuracy=0.528, lr=0.1] 34%|███▍      | 39/115 [15:19<28:55, 22.83s/epoch, loss=1.16, accuracy=0.753, val_loss=2.44, val_accuracy=0.402, lr=0.1] 35%|███▍      | 40/115 [15:42<28:35, 22.87s/epoch, loss=1.15, accuracy=0.75, val_loss=1.94, val_accuracy=0.51, lr=0.1]   36%|███▌      | 41/115 [16:05<28:14, 22.90s/epoch, loss=1.15, accuracy=0.75, val_loss=1.98, val_accuracy=0.535, lr=0.0316] 37%|███▋      | 42/115 [16:28<27:52, 22.90s/epoch, loss=1.15, accuracy=0.752, val_loss=1.64, val_accuracy=0.573, lr=0.1]   37%|███▋      | 43/115 [16:51<27:29, 22.91s/epoch, loss=1.15, accuracy=0.753, val_loss=2.08, val_accuracy=0.491, lr=0.1] 38%|███▊      | 44/115 [17:14<27:11, 22.97s/epoch, loss=1.15, accuracy=0.752, val_loss=2.07, val_accuracy=0.535, lr=0.1] 39%|███▉      | 45/115 [17:37<26:46, 22.95s/epoch, loss=1.14, accuracy=0.753, val_loss=1.81, val_accuracy=0.527, lr=0.1] 40%|████      | 46/115 [18:00<26:23, 22.94s/epoch, loss=1.15, accuracy=0.75, val_loss=2.43, val_accuracy=0.414, lr=0.0316] 41%|████      | 47/115 [18:22<25:53, 22.85s/epoch, loss=1.16, accuracy=0.752, val_loss=2.47, val_accuracy=0.425, lr=0.1]   42%|████▏     | 48/115 [18:45<25:31, 22.86s/epoch, loss=1.16, accuracy=0.75, val_loss=1.87, val_accuracy=0.526, lr=0.1]  43%|████▎     | 49/115 [19:08<25:05, 22.81s/epoch, loss=1.15, accuracy=0.753, val_loss=1.72, val_accuracy=0.587, lr=0.1] 43%|████▎     | 50/115 [19:31<24:44, 22.84s/epoch, loss=1.15, accuracy=0.752, val_loss=2.59, val_accuracy=0.478, lr=0.1] 44%|████▍     | 51/115 [19:54<24:23, 22.87s/epoch, loss=1.16, accuracy=0.752, val_loss=1.76, val_accuracy=0.55, lr=0.0316] 45%|████▌     | 52/115 [20:16<23:59, 22.85s/epoch, loss=1.15, accuracy=0.752, val_loss=1.63, val_accuracy=0.582, lr=0.1]   46%|████▌     | 53/115 [20:39<23:35, 22.84s/epoch, loss=1.15, accuracy=0.752, val_loss=1.64, val_accuracy=0.602, lr=0.1] 47%|████▋     | 54/115 [21:02<23:13, 22.84s/epoch, loss=1.14, accuracy=0.752, val_loss=2.07, val_accuracy=0.462, lr=0.1] 48%|████▊     | 55/115 [21:25<22:48, 22.80s/epoch, loss=1.14, accuracy=0.753, val_loss=1.77, val_accuracy=0.498, lr=0.1] 49%|████▊     | 56/115 [21:48<22:24, 22.79s/epoch, loss=1.13, accuracy=0.756, val_loss=1.63, val_accuracy=0.589, lr=0.0316] 50%|████▉     | 57/115 [22:10<21:58, 22.74s/epoch, loss=1.15, accuracy=0.753, val_loss=1.71, val_accuracy=0.549, lr=0.1]    50%|█████     | 58/115 [22:33<21:37, 22.77s/epoch, loss=1.15, accuracy=0.751, val_loss=2.16, val_accuracy=0.494, lr=0.1] 51%|█████▏    | 59/115 [22:56<21:16, 22.79s/epoch, loss=1.14, accuracy=0.753, val_loss=2.93, val_accuracy=0.389, lr=0.1] 52%|█████▏    | 60/115 [23:19<20:53, 22.80s/epoch, loss=1.15, accuracy=0.75, val_loss=2.61, val_accuracy=0.42, lr=0.1]   53%|█████▎    | 61/115 [23:41<20:29, 22.78s/epoch, loss=1.15, accuracy=0.751, val_loss=2.76, val_accuracy=0.391, lr=0.0316] 54%|█████▍    | 62/115 [24:05<20:11, 22.87s/epoch, loss=1.14, accuracy=0.753, val_loss=1.87, val_accuracy=0.527, lr=0.1]    55%|█████▍    | 63/115 [24:27<19:49, 22.88s/epoch, loss=1.14, accuracy=0.751, val_loss=2.15, val_accuracy=0.468, lr=0.1] 56%|█████▌    | 64/115 [24:50<19:25, 22.86s/epoch, loss=1.14, accuracy=0.753, val_loss=1.81, val_accuracy=0.533, lr=0.1] 57%|█████▋    | 65/115 [25:13<18:56, 22.73s/epoch, loss=1.14, accuracy=0.754, val_loss=2.2, val_accuracy=0.456, lr=0.1]  57%|█████▋    | 66/115 [25:36<18:37, 22.81s/epoch, loss=1.14, accuracy=0.752, val_loss=1.5, val_accuracy=0.609, lr=0.0316] 58%|█████▊    | 67/115 [25:59<18:15, 22.83s/epoch, loss=1.14, accuracy=0.755, val_loss=3.41, val_accuracy=0.29, lr=0.1]    59%|█████▉    | 68/115 [26:21<17:54, 22.87s/epoch, loss=1.14, accuracy=0.754, val_loss=5.39, val_accuracy=0.239, lr=0.1] 60%|██████    | 69/115 [26:44<17:30, 22.84s/epoch, loss=1.14, accuracy=0.756, val_loss=2.12, val_accuracy=0.471, lr=0.1] 61%|██████    | 70/115 [27:07<17:07, 22.83s/epoch, loss=1.15, accuracy=0.754, val_loss=1.93, val_accuracy=0.548, lr=0.1] 62%|██████▏   | 71/115 [27:30<16:45, 22.86s/epoch, loss=1.14, accuracy=0.754, val_loss=2, val_accuracy=0.507, lr=0.0316] 63%|██████▎   | 72/115 [27:53<16:19, 22.78s/epoch, loss=1.14, accuracy=0.752, val_loss=2.17, val_accuracy=0.517, lr=0.1] 63%|██████▎   | 73/115 [28:15<15:56, 22.77s/epoch, loss=1.15, accuracy=0.752, val_loss=1.5, val_accuracy=0.664, lr=0.1]  64%|██████▍   | 74/115 [28:37<15:24, 22.55s/epoch, loss=1.14, accuracy=0.752, val_loss=2.11, val_accuracy=0.497, lr=0.1] 65%|██████▌   | 75/115 [29:00<15:05, 22.64s/epoch, loss=1.14, accuracy=0.754, val_loss=2.14, val_accuracy=0.495, lr=0.1] 66%|██████▌   | 76/115 [29:23<14:44, 22.68s/epoch, loss=1.14, accuracy=0.754, val_loss=1.9, val_accuracy=0.479, lr=0.0316] 67%|██████▋   | 77/115 [29:46<14:23, 22.73s/epoch, loss=1.14, accuracy=0.756, val_loss=1.38, val_accuracy=0.669, lr=0.1]   68%|██████▊   | 78/115 [30:09<14:02, 22.77s/epoch, loss=1.13, accuracy=0.757, val_loss=2.19, val_accuracy=0.509, lr=0.1] 69%|██████▊   | 79/115 [30:31<13:36, 22.67s/epoch, loss=1.13, accuracy=0.755, val_loss=1.91, val_accuracy=0.547, lr=0.1] 70%|██████▉   | 80/115 [30:54<13:14, 22.70s/epoch, loss=1.13, accuracy=0.756, val_loss=1.71, val_accuracy=0.55, lr=0.1]  70%|███████   | 81/115 [31:16<12:47, 22.58s/epoch, loss=1.13, accuracy=0.752, val_loss=1.98, val_accuracy=0.525, lr=0.1] 71%|███████▏  | 82/115 [31:39<12:29, 22.70s/epoch, loss=0.915, accuracy=0.817, val_loss=0.94, val_accuracy=0.789, lr=0.01] 72%|███████▏  | 83/115 [32:02<12:08, 22.76s/epoch, loss=0.739, accuracy=0.847, val_loss=0.778, val_accuracy=0.818, lr=0.01] 73%|███████▎  | 84/115 [32:25<11:45, 22.76s/epoch, loss=0.656, accuracy=0.856, val_loss=0.76, val_accuracy=0.81, lr=0.01]   74%|███████▍  | 85/115 [32:48<11:23, 22.78s/epoch, loss=0.618, accuracy=0.857, val_loss=0.725, val_accuracy=0.817, lr=0.01] 75%|███████▍  | 86/115 [33:10<10:59, 22.73s/epoch, loss=0.591, accuracy=0.86, val_loss=0.757, val_accuracy=0.806, lr=0.01]  76%|███████▌  | 87/115 [33:33<10:36, 22.75s/epoch, loss=0.578, accuracy=0.862, val_loss=0.801, val_accuracy=0.792, lr=0.01] 77%|███████▋  | 88/115 [33:56<10:14, 22.77s/epoch, loss=0.576, accuracy=0.863, val_loss=0.716, val_accuracy=0.817, lr=0.01] 77%|███████▋  | 89/115 [34:19<09:51, 22.75s/epoch, loss=0.576, accuracy=0.862, val_loss=1.04, val_accuracy=0.725, lr=0.01]  78%|███████▊  | 90/115 [34:41<09:27, 22.70s/epoch, loss=0.571, accuracy=0.864, val_loss=0.944, val_accuracy=0.754, lr=0.01] 79%|███████▉  | 91/115 [35:03<08:56, 22.34s/epoch, loss=0.568, accuracy=0.868, val_loss=0.97, val_accuracy=0.755, lr=0.01]  80%|████████  | 92/115 [35:25<08:35, 22.43s/epoch, loss=0.569, accuracy=0.868, val_loss=0.742, val_accuracy=0.814, lr=0.01] 81%|████████  | 93/115 [35:48<08:15, 22.54s/epoch, loss=0.569, accuracy=0.866, val_loss=0.765, val_accuracy=0.806, lr=0.00316] 82%|████████▏ | 94/115 [36:10<07:51, 22.43s/epoch, loss=0.564, accuracy=0.87, val_loss=0.787, val_accuracy=0.801, lr=0.01]     83%|████████▎ | 95/115 [36:33<07:30, 22.55s/epoch, loss=0.561, accuracy=0.872, val_loss=0.779, val_accuracy=0.794, lr=0.01] 83%|████████▎ | 96/115 [36:56<07:10, 22.64s/epoch, loss=0.564, accuracy=0.871, val_loss=0.754, val_accuracy=0.811, lr=0.01] 84%|████████▍ | 97/115 [37:19<06:47, 22.64s/epoch, loss=0.561, accuracy=0.875, val_loss=0.75, val_accuracy=0.812, lr=0.01]  85%|████████▌ | 98/115 [37:42<06:26, 22.74s/epoch, loss=0.562, accuracy=0.874, val_loss=0.993, val_accuracy=0.732, lr=0.00316] 86%|████████▌ | 99/115 [38:03<05:55, 22.24s/epoch, loss=0.557, accuracy=0.878, val_loss=0.844, val_accuracy=0.783, lr=0.01]    87%|████████▋ | 100/115 [38:25<05:33, 22.24s/epoch, loss=0.562, accuracy=0.876, val_loss=0.858, val_accuracy=0.783, lr=0.01] 88%|████████▊ | 101/115 [38:47<05:08, 22.04s/epoch, loss=0.558, accuracy=0.878, val_loss=0.897, val_accuracy=0.775, lr=0.01] 89%|████████▊ | 102/115 [39:09<04:47, 22.13s/epoch, loss=0.56, accuracy=0.877, val_loss=1.15, val_accuracy=0.692, lr=0.01]   90%|████████▉ | 103/115 [39:31<04:25, 22.08s/epoch, loss=0.563, accuracy=0.876, val_loss=0.846, val_accuracy=0.795, lr=0.00316] 90%|█████████ | 104/115 [39:53<04:02, 22.07s/epoch, loss=0.561, accuracy=0.878, val_loss=0.786, val_accuracy=0.815, lr=0.01]    91%|█████████▏| 105/115 [40:15<03:40, 22.07s/epoch, loss=0.559, accuracy=0.88, val_loss=0.84, val_accuracy=0.784, lr=0.01]   92%|█████████▏| 106/115 [40:37<03:18, 22.07s/epoch, loss=0.563, accuracy=0.879, val_loss=0.712, val_accuracy=0.831, lr=0.01] 93%|█████████▎| 107/115 [40:59<02:56, 22.04s/epoch, loss=0.555, accuracy=0.881, val_loss=0.917, val_accuracy=0.767, lr=0.01] 94%|█████████▍| 108/115 [41:21<02:33, 21.99s/epoch, loss=0.56, accuracy=0.879, val_loss=0.91, val_accuracy=0.781, lr=0.01]   95%|█████████▍| 109/115 [41:43<02:11, 21.99s/epoch, loss=0.554, accuracy=0.882, val_loss=0.724, val_accuracy=0.827, lr=0.01] 96%|█████████▌| 110/115 [42:05<01:49, 21.94s/epoch, loss=0.561, accuracy=0.88, val_loss=1.15, val_accuracy=0.711, lr=0.01]   97%|█████████▋| 111/115 [42:26<01:27, 21.82s/epoch, loss=0.558, accuracy=0.882, val_loss=1.03, val_accuracy=0.741, lr=0.00316] 97%|█████████▋| 112/115 [42:48<01:05, 21.90s/epoch, loss=0.56, accuracy=0.882, val_loss=0.83, val_accuracy=0.804, lr=0.01]     98%|█████████▊| 113/115 [43:10<00:43, 21.91s/epoch, loss=0.561, accuracy=0.882, val_loss=0.882, val_accuracy=0.775, lr=0.01] 99%|█████████▉| 114/115 [43:32<00:21, 22.00s/epoch, loss=0.559, accuracy=0.881, val_loss=0.893, val_accuracy=0.788, lr=0.01]100%|██████████| 115/115 [43:54<00:00, 22.01s/epoch, loss=0.559, accuracy=0.882, val_loss=0.912, val_accuracy=0.783, lr=0.01]100%|██████████| 115/115 [43:54<00:00, 22.91s/epoch, loss=0.559, accuracy=0.882, val_loss=0.912, val_accuracy=0.783, lr=0.01]
Using real-time data augmentation.
Test loss: 0.9123398661613464
Test accuracy: 0.7832000255584717


* * * Run SGD for ID = 13_13. * * *


2024-02-15 21:56:49.373440: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 21:56:51.879573: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 21:56:51.880651: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-15 21:56:51.915601: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-02-15 21:56:51.915634: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 21:56:51.918226: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 21:56:51.918263: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 21:56:51.920435: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 21:56:51.921043: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 21:56:51.923160: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 21:56:51.924508: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 21:56:51.928804: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 21:56:51.929347: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 21:56:51.929419: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 21:56:53.165610: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-15 21:56:53.166574: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 21:56:53.167174: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-02-15 21:56:53.167207: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 21:56:53.167268: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 21:56:53.167309: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 21:56:53.167331: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 21:56:53.167350: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 21:56:53.167368: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 21:56:53.167392: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 21:56:53.167411: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 21:56:53.167869: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 21:56:53.167907: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 21:56:53.790906: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-15 21:56:53.790983: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-15 21:56:53.790993: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-15 21:56:53.792930: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11227 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN X (Pascal), pci bus id: 0000:03:00.0, compute capability: 6.1)
{'id': 1313, 'batch_size': 128, 'epochs': 115, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN X (Pascal)'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/115 [00:00<?, ?epoch/s]2024-02-15 21:56:54.559053: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-15 21:56:54.559509: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2599900000 Hz
2024-02-15 21:56:56.336361: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 21:56:56.579060: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 21:56:57.196077: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-15 21:56:57.229262: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/115 [00:51<1:38:21, 51.76s/epoch, loss=3.13, accuracy=0.309, val_loss=3.04, val_accuracy=0.234, lr=0.1]  2%|▏         | 2/115 [01:14<1:05:02, 34.53s/epoch, loss=1.58, accuracy=0.53, val_loss=3.05, val_accuracy=0.275, lr=0.1]   3%|▎         | 3/115 [01:36<53:50, 28.84s/epoch, loss=1.41, accuracy=0.614, val_loss=1.89, val_accuracy=0.45, lr=0.1]    3%|▎         | 4/115 [01:59<48:59, 26.48s/epoch, loss=1.33, accuracy=0.664, val_loss=2.38, val_accuracy=0.349, lr=0.1]  4%|▍         | 5/115 [02:21<45:58, 25.08s/epoch, loss=1.28, accuracy=0.692, val_loss=2.11, val_accuracy=0.482, lr=0.1]  5%|▌         | 6/115 [02:44<44:07, 24.29s/epoch, loss=1.25, accuracy=0.705, val_loss=2.44, val_accuracy=0.397, lr=0.1]  6%|▌         | 7/115 [03:07<42:49, 23.79s/epoch, loss=1.24, accuracy=0.716, val_loss=3.72, val_accuracy=0.203, lr=0.1]  7%|▋         | 8/115 [03:30<42:01, 23.56s/epoch, loss=1.21, accuracy=0.724, val_loss=2.29, val_accuracy=0.431, lr=0.0316]  8%|▊         | 9/115 [03:53<41:14, 23.34s/epoch, loss=1.22, accuracy=0.724, val_loss=2.93, val_accuracy=0.385, lr=0.1]     9%|▊         | 10/115 [04:15<40:15, 23.01s/epoch, loss=1.2, accuracy=0.73, val_loss=1.97, val_accuracy=0.508, lr=0.1]  10%|▉         | 11/115 [04:37<39:36, 22.85s/epoch, loss=1.2, accuracy=0.734, val_loss=1.72, val_accuracy=0.555, lr=0.1] 10%|█         | 12/115 [05:00<38:59, 22.71s/epoch, loss=1.19, accuracy=0.736, val_loss=2.17, val_accuracy=0.502, lr=0.1] 11%|█▏        | 13/115 [05:22<38:25, 22.61s/epoch, loss=1.19, accuracy=0.737, val_loss=2.79, val_accuracy=0.382, lr=0.1] 12%|█▏        | 14/115 [05:45<38:05, 22.63s/epoch, loss=1.18, accuracy=0.741, val_loss=1.53, val_accuracy=0.604, lr=0.1] 13%|█▎        | 15/115 [06:08<37:57, 22.78s/epoch, loss=1.18, accuracy=0.739, val_loss=2.04, val_accuracy=0.491, lr=0.1] 14%|█▍        | 16/115 [06:30<37:24, 22.68s/epoch, loss=1.18, accuracy=0.742, val_loss=3.14, val_accuracy=0.261, lr=0.1] 15%|█▍        | 17/115 [06:53<37:00, 22.66s/epoch, loss=1.17, accuracy=0.742, val_loss=1.65, val_accuracy=0.599, lr=0.1] 16%|█▌        | 18/115 [07:16<36:37, 22.65s/epoch, loss=1.17, accuracy=0.743, val_loss=1.75, val_accuracy=0.553, lr=0.1] 17%|█▋        | 19/115 [07:39<36:21, 22.72s/epoch, loss=1.17, accuracy=0.743, val_loss=2.53, val_accuracy=0.354, lr=0.0316] 17%|█▋        | 20/115 [08:02<36:06, 22.81s/epoch, loss=1.16, accuracy=0.747, val_loss=2.1, val_accuracy=0.495, lr=0.1]     18%|█▊        | 21/115 [08:24<35:23, 22.59s/epoch, loss=1.17, accuracy=0.746, val_loss=2.1, val_accuracy=0.466, lr=0.1] 19%|█▉        | 22/115 [08:46<34:46, 22.44s/epoch, loss=1.16, accuracy=0.747, val_loss=2.91, val_accuracy=0.36, lr=0.1] 20%|██        | 23/115 [09:07<33:59, 22.17s/epoch, loss=1.16, accuracy=0.748, val_loss=1.93, val_accuracy=0.524, lr=0.1] 21%|██        | 24/115 [09:29<33:27, 22.06s/epoch, loss=1.16, accuracy=0.749, val_loss=1.7, val_accuracy=0.593, lr=0.0316] 22%|██▏       | 25/115 [09:52<33:16, 22.18s/epoch, loss=1.16, accuracy=0.747, val_loss=1.96, val_accuracy=0.495, lr=0.1]   23%|██▎       | 26/115 [10:14<32:59, 22.24s/epoch, loss=1.16, accuracy=0.749, val_loss=2.05, val_accuracy=0.49, lr=0.1]  23%|██▎       | 27/115 [10:37<32:50, 22.39s/epoch, loss=1.16, accuracy=0.749, val_loss=1.68, val_accuracy=0.554, lr=0.1] 24%|██▍       | 28/115 [10:59<32:17, 22.26s/epoch, loss=1.16, accuracy=0.75, val_loss=1.39, val_accuracy=0.663, lr=0.1]  25%|██▌       | 29/115 [11:21<31:58, 22.31s/epoch, loss=1.16, accuracy=0.748, val_loss=1.6, val_accuracy=0.604, lr=0.1] 26%|██▌       | 30/115 [11:44<31:42, 22.39s/epoch, loss=1.15, accuracy=0.75, val_loss=1.78, val_accuracy=0.553, lr=0.1] 27%|██▋       | 31/115 [12:06<31:30, 22.50s/epoch, loss=1.15, accuracy=0.751, val_loss=1.95, val_accuracy=0.502, lr=0.1] 28%|██▊       | 32/115 [12:29<31:10, 22.53s/epoch, loss=1.15, accuracy=0.752, val_loss=1.94, val_accuracy=0.534, lr=0.1] 29%|██▊       | 33/115 [12:52<30:58, 22.67s/epoch, loss=1.14, accuracy=0.752, val_loss=3.78, val_accuracy=0.258, lr=0.0316] 30%|██▉       | 34/115 [13:15<30:43, 22.76s/epoch, loss=1.14, accuracy=0.753, val_loss=2.06, val_accuracy=0.538, lr=0.1]    30%|███       | 35/115 [13:38<30:22, 22.78s/epoch, loss=1.13, accuracy=0.757, val_loss=2.46, val_accuracy=0.431, lr=0.1] 31%|███▏      | 36/115 [14:00<29:37, 22.49s/epoch, loss=1.14, accuracy=0.752, val_loss=3.11, val_accuracy=0.227, lr=0.1] 32%|███▏      | 37/115 [14:22<29:22, 22.59s/epoch, loss=1.13, accuracy=0.755, val_loss=2.29, val_accuracy=0.357, lr=0.1] 33%|███▎      | 38/115 [14:45<28:58, 22.58s/epoch, loss=1.14, accuracy=0.755, val_loss=1.57, val_accuracy=0.605, lr=0.0316] 34%|███▍      | 39/115 [15:07<28:29, 22.50s/epoch, loss=1.14, accuracy=0.753, val_loss=1.87, val_accuracy=0.516, lr=0.1]    35%|███▍      | 40/115 [15:30<28:10, 22.54s/epoch, loss=1.13, accuracy=0.755, val_loss=2.31, val_accuracy=0.473, lr=0.1] 36%|███▌      | 41/115 [15:52<27:32, 22.33s/epoch, loss=1.13, accuracy=0.757, val_loss=2.01, val_accuracy=0.536, lr=0.1] 37%|███▋      | 42/115 [16:15<27:27, 22.57s/epoch, loss=1.13, accuracy=0.757, val_loss=2.15, val_accuracy=0.427, lr=0.1] 37%|███▋      | 43/115 [16:38<27:16, 22.73s/epoch, loss=1.14, accuracy=0.753, val_loss=1.69, val_accuracy=0.572, lr=0.0316] 38%|███▊      | 44/115 [17:01<26:59, 22.81s/epoch, loss=1.13, accuracy=0.755, val_loss=2.05, val_accuracy=0.447, lr=0.1]    39%|███▉      | 45/115 [17:24<26:37, 22.83s/epoch, loss=1.13, accuracy=0.757, val_loss=2.97, val_accuracy=0.428, lr=0.1] 40%|████      | 46/115 [17:47<26:15, 22.83s/epoch, loss=1.13, accuracy=0.753, val_loss=1.64, val_accuracy=0.614, lr=0.1] 41%|████      | 47/115 [18:10<25:53, 22.84s/epoch, loss=1.12, accuracy=0.755, val_loss=1.75, val_accuracy=0.556, lr=0.1] 42%|████▏     | 48/115 [18:32<25:26, 22.78s/epoch, loss=1.12, accuracy=0.756, val_loss=1.94, val_accuracy=0.484, lr=0.0316] 43%|████▎     | 49/115 [18:54<24:41, 22.45s/epoch, loss=1.13, accuracy=0.756, val_loss=1.53, val_accuracy=0.608, lr=0.1]    43%|████▎     | 50/115 [19:17<24:29, 22.60s/epoch, loss=1.12, accuracy=0.758, val_loss=1.82, val_accuracy=0.555, lr=0.1] 44%|████▍     | 51/115 [19:40<24:13, 22.71s/epoch, loss=1.13, accuracy=0.754, val_loss=2.22, val_accuracy=0.553, lr=0.1] 45%|████▌     | 52/115 [20:03<23:53, 22.75s/epoch, loss=1.12, accuracy=0.756, val_loss=2.15, val_accuracy=0.453, lr=0.1] 46%|████▌     | 53/115 [20:25<23:25, 22.67s/epoch, loss=1.13, accuracy=0.756, val_loss=2.33, val_accuracy=0.456, lr=0.0316] 47%|████▋     | 54/115 [20:47<22:55, 22.55s/epoch, loss=1.13, accuracy=0.757, val_loss=1.83, val_accuracy=0.554, lr=0.1]    48%|████▊     | 55/115 [21:10<22:35, 22.58s/epoch, loss=1.12, accuracy=0.755, val_loss=2.38, val_accuracy=0.447, lr=0.1] 49%|████▊     | 56/115 [21:33<22:16, 22.66s/epoch, loss=1.13, accuracy=0.757, val_loss=1.48, val_accuracy=0.628, lr=0.1] 50%|████▉     | 57/115 [21:55<21:52, 22.63s/epoch, loss=1.13, accuracy=0.756, val_loss=2.05, val_accuracy=0.474, lr=0.1] 50%|█████     | 58/115 [22:18<21:29, 22.62s/epoch, loss=1.12, accuracy=0.756, val_loss=1.57, val_accuracy=0.59, lr=0.0316] 51%|█████▏    | 59/115 [22:40<21:02, 22.54s/epoch, loss=1.12, accuracy=0.756, val_loss=3.13, val_accuracy=0.259, lr=0.1]   52%|█████▏    | 60/115 [23:03<20:33, 22.43s/epoch, loss=1.13, accuracy=0.756, val_loss=2.53, val_accuracy=0.431, lr=0.1] 53%|█████▎    | 61/115 [23:25<20:04, 22.30s/epoch, loss=1.12, accuracy=0.759, val_loss=2.59, val_accuracy=0.299, lr=0.1] 54%|█████▍    | 62/115 [23:47<19:40, 22.28s/epoch, loss=1.12, accuracy=0.758, val_loss=1.74, val_accuracy=0.564, lr=0.1] 55%|█████▍    | 63/115 [24:10<19:26, 22.42s/epoch, loss=1.12, accuracy=0.758, val_loss=2.77, val_accuracy=0.351, lr=0.0316] 56%|█████▌    | 64/115 [24:31<18:51, 22.19s/epoch, loss=1.12, accuracy=0.759, val_loss=3, val_accuracy=0.388, lr=0.1]       57%|█████▋    | 65/115 [24:53<18:30, 22.20s/epoch, loss=1.12, accuracy=0.758, val_loss=2.21, val_accuracy=0.492, lr=0.1] 57%|█████▋    | 66/115 [25:16<18:10, 22.25s/epoch, loss=1.12, accuracy=0.757, val_loss=2.1, val_accuracy=0.46, lr=0.1]   58%|█████▊    | 67/115 [25:38<17:53, 22.36s/epoch, loss=1.13, accuracy=0.756, val_loss=1.79, val_accuracy=0.528, lr=0.1] 59%|█████▉    | 68/115 [26:01<17:36, 22.47s/epoch, loss=1.11, accuracy=0.761, val_loss=2.11, val_accuracy=0.464, lr=0.0316] 60%|██████    | 69/115 [26:23<17:10, 22.39s/epoch, loss=1.12, accuracy=0.757, val_loss=1.73, val_accuracy=0.527, lr=0.1]    61%|██████    | 70/115 [26:45<16:37, 22.16s/epoch, loss=1.12, accuracy=0.758, val_loss=1.94, val_accuracy=0.467, lr=0.1] 62%|██████▏   | 71/115 [27:08<16:22, 22.33s/epoch, loss=1.11, accuracy=0.761, val_loss=2.37, val_accuracy=0.405, lr=0.1] 63%|██████▎   | 72/115 [27:29<15:46, 22.02s/epoch, loss=1.12, accuracy=0.76, val_loss=2.18, val_accuracy=0.535, lr=0.1]  63%|██████▎   | 73/115 [27:51<15:26, 22.05s/epoch, loss=1.12, accuracy=0.756, val_loss=2.13, val_accuracy=0.501, lr=0.0316] 64%|██████▍   | 74/115 [28:14<15:08, 22.15s/epoch, loss=1.11, accuracy=0.757, val_loss=1.58, val_accuracy=0.602, lr=0.1]    65%|██████▌   | 75/115 [28:36<14:50, 22.27s/epoch, loss=1.12, accuracy=0.759, val_loss=2.56, val_accuracy=0.372, lr=0.1] 66%|██████▌   | 76/115 [28:59<14:33, 22.39s/epoch, loss=1.12, accuracy=0.758, val_loss=1.84, val_accuracy=0.503, lr=0.1] 67%|██████▋   | 77/115 [29:22<14:15, 22.51s/epoch, loss=1.11, accuracy=0.758, val_loss=1.67, val_accuracy=0.561, lr=0.1] 68%|██████▊   | 78/115 [29:44<13:54, 22.54s/epoch, loss=1.12, accuracy=0.756, val_loss=6.36, val_accuracy=0.229, lr=0.0316] 69%|██████▊   | 79/115 [30:06<13:27, 22.43s/epoch, loss=1.11, accuracy=0.758, val_loss=2.08, val_accuracy=0.494, lr=0.1]    70%|██████▉   | 80/115 [30:29<13:05, 22.44s/epoch, loss=1.11, accuracy=0.76, val_loss=1.66, val_accuracy=0.559, lr=0.1]  70%|███████   | 81/115 [30:52<12:46, 22.55s/epoch, loss=1.11, accuracy=0.757, val_loss=2.71, val_accuracy=0.393, lr=0.1] 71%|███████▏  | 82/115 [31:14<12:24, 22.57s/epoch, loss=0.912, accuracy=0.814, val_loss=0.888, val_accuracy=0.806, lr=0.01] 72%|███████▏  | 83/115 [31:36<11:58, 22.44s/epoch, loss=0.728, accuracy=0.848, val_loss=0.775, val_accuracy=0.82, lr=0.01]  73%|███████▎  | 84/115 [31:59<11:35, 22.43s/epoch, loss=0.643, accuracy=0.858, val_loss=0.814, val_accuracy=0.795, lr=0.01] 74%|███████▍  | 85/115 [32:21<11:14, 22.49s/epoch, loss=0.602, accuracy=0.859, val_loss=0.902, val_accuracy=0.767, lr=0.01] 75%|███████▍  | 86/115 [32:44<10:51, 22.46s/epoch, loss=0.582, accuracy=0.862, val_loss=1.01, val_accuracy=0.728, lr=0.01]  76%|███████▌  | 87/115 [33:06<10:26, 22.36s/epoch, loss=0.566, accuracy=0.863, val_loss=0.738, val_accuracy=0.804, lr=0.01] 77%|███████▋  | 88/115 [33:29<10:05, 22.43s/epoch, loss=0.559, accuracy=0.866, val_loss=0.889, val_accuracy=0.778, lr=0.01] 77%|███████▋  | 89/115 [33:51<09:43, 22.45s/epoch, loss=0.559, accuracy=0.866, val_loss=0.927, val_accuracy=0.766, lr=0.01] 78%|███████▊  | 90/115 [34:13<09:20, 22.43s/epoch, loss=0.556, accuracy=0.868, val_loss=0.795, val_accuracy=0.792, lr=0.01] 79%|███████▉  | 91/115 [34:36<08:58, 22.44s/epoch, loss=0.553, accuracy=0.869, val_loss=0.759, val_accuracy=0.797, lr=0.01] 80%|████████  | 92/115 [34:59<08:38, 22.53s/epoch, loss=0.552, accuracy=0.869, val_loss=0.766, val_accuracy=0.81, lr=0.00316] 81%|████████  | 93/115 [35:21<08:13, 22.44s/epoch, loss=0.553, accuracy=0.873, val_loss=0.81, val_accuracy=0.791, lr=0.01]    82%|████████▏ | 94/115 [35:43<07:52, 22.50s/epoch, loss=0.552, accuracy=0.873, val_loss=1.01, val_accuracy=0.727, lr=0.01] 83%|████████▎ | 95/115 [36:06<07:30, 22.53s/epoch, loss=0.553, accuracy=0.874, val_loss=0.892, val_accuracy=0.767, lr=0.01] 83%|████████▎ | 96/115 [36:29<07:07, 22.51s/epoch, loss=0.543, accuracy=0.878, val_loss=0.792, val_accuracy=0.799, lr=0.01] 84%|████████▍ | 97/115 [36:51<06:45, 22.51s/epoch, loss=0.547, accuracy=0.878, val_loss=0.803, val_accuracy=0.789, lr=0.00316] 85%|████████▌ | 98/115 [37:12<06:16, 22.17s/epoch, loss=0.548, accuracy=0.878, val_loss=0.953, val_accuracy=0.765, lr=0.01]    86%|████████▌ | 99/115 [37:35<05:56, 22.25s/epoch, loss=0.553, accuracy=0.876, val_loss=1.17, val_accuracy=0.691, lr=0.01]  87%|████████▋ | 100/115 [37:56<05:30, 22.07s/epoch, loss=0.551, accuracy=0.878, val_loss=1.04, val_accuracy=0.739, lr=0.01] 88%|████████▊ | 101/115 [38:18<05:07, 21.99s/epoch, loss=0.549, accuracy=0.88, val_loss=1.25, val_accuracy=0.688, lr=0.01]  89%|████████▊ | 102/115 [38:41<04:48, 22.20s/epoch, loss=0.548, accuracy=0.879, val_loss=0.915, val_accuracy=0.769, lr=0.00316] 90%|████████▉ | 103/115 [39:03<04:26, 22.20s/epoch, loss=0.549, accuracy=0.88, val_loss=1.01, val_accuracy=0.751, lr=0.01]      90%|█████████ | 104/115 [39:26<04:05, 22.30s/epoch, loss=0.547, accuracy=0.881, val_loss=0.841, val_accuracy=0.792, lr=0.01] 91%|█████████▏| 105/115 [39:48<03:41, 22.17s/epoch, loss=0.546, accuracy=0.882, val_loss=0.776, val_accuracy=0.809, lr=0.01] 92%|█████████▏| 106/115 [40:10<03:19, 22.16s/epoch, loss=0.549, accuracy=0.881, val_loss=0.861, val_accuracy=0.791, lr=0.01] 93%|█████████▎| 107/115 [40:32<02:58, 22.26s/epoch, loss=0.548, accuracy=0.883, val_loss=0.774, val_accuracy=0.809, lr=0.00316] 94%|█████████▍| 108/115 [40:54<02:35, 22.25s/epoch, loss=0.545, accuracy=0.882, val_loss=0.747, val_accuracy=0.82, lr=0.01]     95%|█████████▍| 109/115 [41:17<02:13, 22.21s/epoch, loss=0.548, accuracy=0.883, val_loss=0.757, val_accuracy=0.821, lr=0.01] 96%|█████████▌| 110/115 [41:39<01:51, 22.22s/epoch, loss=0.546, accuracy=0.883, val_loss=0.948, val_accuracy=0.771, lr=0.01] 97%|█████████▋| 111/115 [42:01<01:28, 22.08s/epoch, loss=0.548, accuracy=0.882, val_loss=0.824, val_accuracy=0.804, lr=0.01] 97%|█████████▋| 112/115 [42:23<01:06, 22.13s/epoch, loss=0.547, accuracy=0.883, val_loss=0.864, val_accuracy=0.78, lr=0.00316] 98%|█████████▊| 113/115 [42:45<00:44, 22.22s/epoch, loss=0.543, accuracy=0.886, val_loss=0.851, val_accuracy=0.799, lr=0.01]   99%|█████████▉| 114/115 [43:08<00:22, 22.32s/epoch, loss=0.546, accuracy=0.886, val_loss=1.04, val_accuracy=0.752, lr=0.01] 100%|██████████| 115/115 [43:30<00:00, 22.27s/epoch, loss=0.551, accuracy=0.884, val_loss=0.93, val_accuracy=0.769, lr=0.01]100%|██████████| 115/115 [43:30<00:00, 22.70s/epoch, loss=0.551, accuracy=0.884, val_loss=0.93, val_accuracy=0.769, lr=0.01]
Using real-time data augmentation.
Test loss: 0.9302472472190857
Test accuracy: 0.7689999938011169

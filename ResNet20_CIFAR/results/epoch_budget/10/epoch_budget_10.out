Tue Mar  5 01:25:07 2024       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 545.23.08              Driver Version: 545.23.08    CUDA Version: 12.3     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA TITAN X (Pascal)        Off | 00000000:83:00.0 Off |                  N/A |
| 45%   63C    P8              15W / 250W |      0MiB / 12288MiB |      0%      Default |
|                                         |                      |                  N/A |
+-----------------------------------------+----------------------+----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
|  No running processes found                                                           |
+---------------------------------------------------------------------------------------+


* * * Run SGD for cluster size = 10. * * *


Budget: 150


* * * Run SGD for ID = 10_1. * * *


2024-03-05 01:25:07.815351: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 01:25:13.627280: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 01:25:13.628712: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-05 01:25:13.667050: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-03-05 01:25:13.667096: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 01:25:13.685986: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 01:25:13.686087: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-05 01:25:13.707930: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-05 01:25:13.765629: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-05 01:25:13.808750: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-05 01:25:13.829417: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-05 01:25:13.852666: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 01:25:13.853375: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-05 01:25:13.853470: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 01:25:15.158731: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-05 01:25:15.159833: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 01:25:15.160316: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-03-05 01:25:15.160346: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 01:25:15.160377: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 01:25:15.160393: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-05 01:25:15.160416: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-05 01:25:15.160431: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-05 01:25:15.160445: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-05 01:25:15.160460: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-05 01:25:15.160474: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 01:25:15.160908: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-05 01:25:15.160941: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 01:25:15.976630: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-05 01:25:15.976678: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-05 01:25:15.976688: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-05 01:25:15.977594: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11227 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN X (Pascal), pci bus id: 0000:83:00.0, compute capability: 6.1)
{'id': '10_01', 'seed': 1, 'out_folder': 'results/epoch_budget', 'batch_size': 128, 'epochs': 150, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN X (Pascal)'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/150 [00:00<?, ?epoch/s]2024-03-05 01:25:16.833621: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-05 01:25:16.834243: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2600020000 Hz
2024-03-05 01:25:18.815480: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 01:25:19.034263: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 01:25:19.857662: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-05 01:25:19.908455: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/150 [00:56<2:21:12, 56.86s/epoch, loss=3.61, accuracy=0.317, val_loss=2.59, val_accuracy=0.269, lr=0.1]  1%|▏         | 2/150 [01:17<1:28:10, 35.75s/epoch, loss=1.58, accuracy=0.54, val_loss=1.86, val_accuracy=0.468, lr=0.1]   2%|▏         | 3/150 [01:38<1:10:11, 28.65s/epoch, loss=1.37, accuracy=0.633, val_loss=2.94, val_accuracy=0.284, lr=0.1]  3%|▎         | 4/150 [01:58<1:01:42, 25.36s/epoch, loss=1.31, accuracy=0.671, val_loss=3.81, val_accuracy=0.281, lr=0.1]  3%|▎         | 5/150 [02:18<56:53, 23.54s/epoch, loss=1.27, accuracy=0.692, val_loss=2.2, val_accuracy=0.444, lr=0.1]     4%|▍         | 6/150 [02:39<53:53, 22.46s/epoch, loss=1.26, accuracy=0.705, val_loss=1.49, val_accuracy=0.626, lr=0.1]  5%|▍         | 7/150 [02:59<51:41, 21.69s/epoch, loss=1.24, accuracy=0.715, val_loss=2.02, val_accuracy=0.426, lr=0.1]  5%|▌         | 8/150 [03:19<50:13, 21.22s/epoch, loss=1.25, accuracy=0.717, val_loss=2.04, val_accuracy=0.521, lr=0.1]  6%|▌         | 9/150 [03:39<49:07, 20.90s/epoch, loss=1.23, accuracy=0.721, val_loss=2.41, val_accuracy=0.392, lr=0.1]  7%|▋         | 10/150 [03:59<48:10, 20.64s/epoch, loss=1.22, accuracy=0.727, val_loss=2.44, val_accuracy=0.37, lr=0.1]  7%|▋         | 11/150 [04:19<47:34, 20.53s/epoch, loss=1.21, accuracy=0.732, val_loss=2.07, val_accuracy=0.557, lr=0.0316]  8%|▊         | 12/150 [04:40<46:59, 20.43s/epoch, loss=1.21, accuracy=0.732, val_loss=2.2, val_accuracy=0.431, lr=0.1]      9%|▊         | 13/150 [05:00<46:23, 20.32s/epoch, loss=1.21, accuracy=0.734, val_loss=1.76, val_accuracy=0.558, lr=0.1]  9%|▉         | 14/150 [05:20<45:58, 20.28s/epoch, loss=1.2, accuracy=0.737, val_loss=1.52, val_accuracy=0.628, lr=0.1]  10%|█         | 15/150 [05:40<45:37, 20.28s/epoch, loss=1.19, accuracy=0.74, val_loss=1.63, val_accuracy=0.594, lr=0.1] 11%|█         | 16/150 [06:00<45:10, 20.23s/epoch, loss=1.19, accuracy=0.739, val_loss=1.87, val_accuracy=0.536, lr=0.0316] 11%|█▏        | 17/150 [06:20<44:25, 20.04s/epoch, loss=1.18, accuracy=0.742, val_loss=1.53, val_accuracy=0.627, lr=0.1]    12%|█▏        | 18/150 [06:40<43:56, 19.98s/epoch, loss=1.18, accuracy=0.745, val_loss=2.16, val_accuracy=0.468, lr=0.1] 13%|█▎        | 19/150 [07:00<43:37, 19.98s/epoch, loss=1.19, accuracy=0.745, val_loss=4.02, val_accuracy=0.339, lr=0.1] 13%|█▎        | 20/150 [07:20<43:47, 20.21s/epoch, loss=1.18, accuracy=0.744, val_loss=2.53, val_accuracy=0.456, lr=0.1] 14%|█▍        | 21/150 [07:41<43:23, 20.18s/epoch, loss=1.18, accuracy=0.744, val_loss=1.68, val_accuracy=0.577, lr=0.0316] 15%|█▍        | 22/150 [08:01<43:10, 20.24s/epoch, loss=1.17, accuracy=0.747, val_loss=2.2, val_accuracy=0.519, lr=0.1]     15%|█▌        | 23/150 [08:21<42:45, 20.20s/epoch, loss=1.17, accuracy=0.747, val_loss=1.83, val_accuracy=0.538, lr=0.1] 16%|█▌        | 24/150 [08:41<42:26, 20.21s/epoch, loss=1.18, accuracy=0.747, val_loss=2.94, val_accuracy=0.35, lr=0.1]  17%|█▋        | 25/150 [09:01<42:00, 20.16s/epoch, loss=1.17, accuracy=0.748, val_loss=2.8, val_accuracy=0.435, lr=0.1] 17%|█▋        | 26/150 [09:21<41:36, 20.13s/epoch, loss=1.17, accuracy=0.746, val_loss=5.8, val_accuracy=0.208, lr=0.0316] 18%|█▊        | 27/150 [09:41<41:13, 20.11s/epoch, loss=1.16, accuracy=0.748, val_loss=1.78, val_accuracy=0.561, lr=0.1]   19%|█▊        | 28/150 [10:01<40:52, 20.10s/epoch, loss=1.16, accuracy=0.751, val_loss=2.44, val_accuracy=0.383, lr=0.1] 19%|█▉        | 29/150 [10:22<40:29, 20.08s/epoch, loss=1.16, accuracy=0.751, val_loss=1.97, val_accuracy=0.515, lr=0.1] 20%|██        | 30/150 [10:42<40:07, 20.07s/epoch, loss=1.16, accuracy=0.748, val_loss=2.06, val_accuracy=0.507, lr=0.1] 21%|██        | 31/150 [11:02<39:46, 20.05s/epoch, loss=1.15, accuracy=0.753, val_loss=1.83, val_accuracy=0.534, lr=0.0316] 21%|██▏       | 32/150 [11:22<39:25, 20.05s/epoch, loss=1.16, accuracy=0.752, val_loss=1.37, val_accuracy=0.675, lr=0.1]    22%|██▏       | 33/150 [11:42<39:05, 20.05s/epoch, loss=1.16, accuracy=0.751, val_loss=1.72, val_accuracy=0.561, lr=0.1] 23%|██▎       | 34/150 [12:02<38:41, 20.01s/epoch, loss=1.15, accuracy=0.751, val_loss=1.59, val_accuracy=0.612, lr=0.1] 23%|██▎       | 35/150 [12:21<38:13, 19.94s/epoch, loss=1.14, accuracy=0.759, val_loss=2.44, val_accuracy=0.476, lr=0.1] 24%|██▍       | 36/150 [12:41<37:53, 19.94s/epoch, loss=1.15, accuracy=0.751, val_loss=1.64, val_accuracy=0.576, lr=0.1] 25%|██▍       | 37/150 [13:01<37:27, 19.89s/epoch, loss=1.15, accuracy=0.754, val_loss=2.47, val_accuracy=0.391, lr=0.0316] 25%|██▌       | 38/150 [13:21<37:05, 19.87s/epoch, loss=1.15, accuracy=0.753, val_loss=2.36, val_accuracy=0.419, lr=0.1]    26%|██▌       | 39/150 [13:41<36:47, 19.88s/epoch, loss=1.15, accuracy=0.751, val_loss=2.01, val_accuracy=0.496, lr=0.1] 27%|██▋       | 40/150 [14:01<36:44, 20.04s/epoch, loss=1.14, accuracy=0.752, val_loss=2.25, val_accuracy=0.576, lr=0.1] 27%|██▋       | 41/150 [14:21<36:18, 19.98s/epoch, loss=1.14, accuracy=0.753, val_loss=5.12, val_accuracy=0.207, lr=0.1] 28%|██▊       | 42/150 [14:41<35:54, 19.95s/epoch, loss=1.14, accuracy=0.752, val_loss=5.71, val_accuracy=0.226, lr=0.0316] 29%|██▊       | 43/150 [15:01<35:35, 19.96s/epoch, loss=1.14, accuracy=0.755, val_loss=1.85, val_accuracy=0.518, lr=0.1]    29%|██▉       | 44/150 [15:21<35:16, 19.96s/epoch, loss=1.14, accuracy=0.753, val_loss=2.16, val_accuracy=0.477, lr=0.1] 30%|███       | 45/150 [15:41<34:56, 19.96s/epoch, loss=1.14, accuracy=0.753, val_loss=1.67, val_accuracy=0.594, lr=0.1] 31%|███       | 46/150 [16:01<34:38, 19.99s/epoch, loss=1.14, accuracy=0.754, val_loss=2.55, val_accuracy=0.38, lr=0.1]  31%|███▏      | 47/150 [16:21<34:14, 19.95s/epoch, loss=1.14, accuracy=0.754, val_loss=1.94, val_accuracy=0.512, lr=0.0316] 32%|███▏      | 48/150 [16:41<33:58, 19.99s/epoch, loss=1.13, accuracy=0.758, val_loss=1.86, val_accuracy=0.548, lr=0.1]    33%|███▎      | 49/150 [17:01<33:38, 19.99s/epoch, loss=1.14, accuracy=0.756, val_loss=2.21, val_accuracy=0.445, lr=0.1] 33%|███▎      | 50/150 [17:21<33:17, 19.98s/epoch, loss=1.13, accuracy=0.755, val_loss=1.65, val_accuracy=0.576, lr=0.1] 34%|███▍      | 51/150 [17:41<32:55, 19.95s/epoch, loss=1.14, accuracy=0.755, val_loss=2.99, val_accuracy=0.416, lr=0.1] 35%|███▍      | 52/150 [18:01<32:34, 19.95s/epoch, loss=1.13, accuracy=0.755, val_loss=2.07, val_accuracy=0.526, lr=0.0316] 35%|███▌      | 53/150 [18:21<32:14, 19.94s/epoch, loss=1.13, accuracy=0.754, val_loss=1.89, val_accuracy=0.517, lr=0.1]    36%|███▌      | 54/150 [18:41<31:57, 19.97s/epoch, loss=1.13, accuracy=0.756, val_loss=2.41, val_accuracy=0.431, lr=0.1] 37%|███▋      | 55/150 [19:01<31:39, 19.99s/epoch, loss=1.13, accuracy=0.755, val_loss=2.96, val_accuracy=0.356, lr=0.1] 37%|███▋      | 56/150 [19:21<31:21, 20.01s/epoch, loss=1.14, accuracy=0.755, val_loss=3.02, val_accuracy=0.436, lr=0.1] 38%|███▊      | 57/150 [19:41<31:05, 20.06s/epoch, loss=1.13, accuracy=0.754, val_loss=1.58, val_accuracy=0.63, lr=0.0316] 39%|███▊      | 58/150 [20:01<30:44, 20.05s/epoch, loss=1.13, accuracy=0.756, val_loss=2.18, val_accuracy=0.39, lr=0.1]    39%|███▉      | 59/150 [20:21<30:22, 20.02s/epoch, loss=1.13, accuracy=0.754, val_loss=1.71, val_accuracy=0.544, lr=0.1] 40%|████      | 60/150 [20:41<30:00, 20.01s/epoch, loss=1.13, accuracy=0.754, val_loss=2.6, val_accuracy=0.343, lr=0.1]  41%|████      | 61/150 [21:01<29:39, 20.00s/epoch, loss=1.13, accuracy=0.757, val_loss=2.51, val_accuracy=0.366, lr=0.1] 41%|████▏     | 62/150 [21:21<29:22, 20.03s/epoch, loss=1.13, accuracy=0.755, val_loss=2, val_accuracy=0.5, lr=0.0316]   42%|████▏     | 63/150 [21:41<28:55, 19.95s/epoch, loss=1.14, accuracy=0.755, val_loss=1.79, val_accuracy=0.524, lr=0.1] 43%|████▎     | 64/150 [22:01<28:38, 19.99s/epoch, loss=1.13, accuracy=0.755, val_loss=1.78, val_accuracy=0.579, lr=0.1] 43%|████▎     | 65/150 [22:21<28:20, 20.00s/epoch, loss=1.13, accuracy=0.757, val_loss=1.79, val_accuracy=0.557, lr=0.1] 44%|████▍     | 66/150 [22:41<28:01, 20.02s/epoch, loss=1.13, accuracy=0.754, val_loss=2.45, val_accuracy=0.463, lr=0.1] 45%|████▍     | 67/150 [23:01<27:49, 20.12s/epoch, loss=1.13, accuracy=0.757, val_loss=1.76, val_accuracy=0.552, lr=0.0316] 45%|████▌     | 68/150 [23:21<27:33, 20.16s/epoch, loss=1.12, accuracy=0.757, val_loss=1.66, val_accuracy=0.572, lr=0.1]    46%|████▌     | 69/150 [23:41<27:07, 20.09s/epoch, loss=1.13, accuracy=0.757, val_loss=2.79, val_accuracy=0.344, lr=0.1] 47%|████▋     | 70/150 [24:01<26:44, 20.06s/epoch, loss=1.12, accuracy=0.757, val_loss=1.75, val_accuracy=0.577, lr=0.1] 47%|████▋     | 71/150 [24:21<26:20, 20.00s/epoch, loss=1.13, accuracy=0.756, val_loss=2.37, val_accuracy=0.471, lr=0.1] 48%|████▊     | 72/150 [24:41<25:58, 19.98s/epoch, loss=1.12, accuracy=0.756, val_loss=3.09, val_accuracy=0.417, lr=0.0316] 49%|████▊     | 73/150 [25:01<25:38, 19.98s/epoch, loss=1.12, accuracy=0.758, val_loss=1.53, val_accuracy=0.631, lr=0.1]    49%|████▉     | 74/150 [25:21<25:23, 20.04s/epoch, loss=1.13, accuracy=0.753, val_loss=1.91, val_accuracy=0.519, lr=0.1] 50%|█████     | 75/150 [25:41<25:04, 20.06s/epoch, loss=1.13, accuracy=0.757, val_loss=1.99, val_accuracy=0.482, lr=0.1] 51%|█████     | 76/150 [26:02<24:46, 20.09s/epoch, loss=1.12, accuracy=0.756, val_loss=1.64, val_accuracy=0.574, lr=0.1] 51%|█████▏    | 77/150 [26:22<24:30, 20.15s/epoch, loss=1.12, accuracy=0.756, val_loss=3.26, val_accuracy=0.258, lr=0.0316] 52%|█████▏    | 78/150 [26:42<24:08, 20.12s/epoch, loss=1.13, accuracy=0.755, val_loss=2.43, val_accuracy=0.516, lr=0.1]    53%|█████▎    | 79/150 [27:02<23:48, 20.12s/epoch, loss=1.13, accuracy=0.755, val_loss=1.9, val_accuracy=0.512, lr=0.1]  53%|█████▎    | 80/150 [27:22<23:26, 20.10s/epoch, loss=1.12, accuracy=0.756, val_loss=2.08, val_accuracy=0.469, lr=0.1] 54%|█████▍    | 81/150 [27:42<23:01, 20.02s/epoch, loss=1.13, accuracy=0.756, val_loss=3.97, val_accuracy=0.211, lr=0.1] 55%|█████▍    | 82/150 [28:02<22:38, 19.98s/epoch, loss=0.922, accuracy=0.814, val_loss=0.928, val_accuracy=0.799, lr=0.01] 55%|█████▌    | 83/150 [28:22<22:14, 19.92s/epoch, loss=0.737, accuracy=0.848, val_loss=0.84, val_accuracy=0.798, lr=0.01]  56%|█████▌    | 84/150 [28:42<21:55, 19.93s/epoch, loss=0.653, accuracy=0.856, val_loss=0.794, val_accuracy=0.802, lr=0.01] 57%|█████▋    | 85/150 [29:01<21:30, 19.86s/epoch, loss=0.611, accuracy=0.859, val_loss=0.77, val_accuracy=0.807, lr=0.01]  57%|█████▋    | 86/150 [29:21<21:11, 19.86s/epoch, loss=0.589, accuracy=0.86, val_loss=0.676, val_accuracy=0.833, lr=0.01] 58%|█████▊    | 87/150 [29:41<20:49, 19.83s/epoch, loss=0.578, accuracy=0.86, val_loss=0.678, val_accuracy=0.826, lr=0.01] 59%|█████▊    | 88/150 [30:01<20:27, 19.80s/epoch, loss=0.572, accuracy=0.861, val_loss=0.739, val_accuracy=0.803, lr=0.01] 59%|█████▉    | 89/150 [30:20<20:00, 19.68s/epoch, loss=0.568, accuracy=0.863, val_loss=0.812, val_accuracy=0.787, lr=0.01] 60%|██████    | 90/150 [30:39<19:35, 19.59s/epoch, loss=0.568, accuracy=0.864, val_loss=0.813, val_accuracy=0.798, lr=0.01] 61%|██████    | 91/150 [30:59<19:17, 19.62s/epoch, loss=0.563, accuracy=0.867, val_loss=0.979, val_accuracy=0.752, lr=0.00316] 61%|██████▏   | 92/150 [31:18<18:51, 19.51s/epoch, loss=0.558, accuracy=0.871, val_loss=0.81, val_accuracy=0.793, lr=0.01]     62%|██████▏   | 93/150 [31:38<18:37, 19.60s/epoch, loss=0.559, accuracy=0.87, val_loss=0.736, val_accuracy=0.813, lr=0.01] 63%|██████▎   | 94/150 [31:58<18:15, 19.57s/epoch, loss=0.561, accuracy=0.871, val_loss=0.806, val_accuracy=0.797, lr=0.01] 63%|██████▎   | 95/150 [32:17<17:56, 19.58s/epoch, loss=0.559, accuracy=0.872, val_loss=0.984, val_accuracy=0.721, lr=0.01] 64%|██████▍   | 96/150 [32:37<17:37, 19.59s/epoch, loss=0.555, accuracy=0.875, val_loss=0.865, val_accuracy=0.786, lr=0.00316] 65%|██████▍   | 97/150 [32:56<17:19, 19.62s/epoch, loss=0.56, accuracy=0.874, val_loss=0.764, val_accuracy=0.8, lr=0.01]       65%|██████▌   | 98/150 [33:16<17:01, 19.65s/epoch, loss=0.561, accuracy=0.873, val_loss=0.832, val_accuracy=0.789, lr=0.01] 66%|██████▌   | 99/150 [33:36<16:45, 19.71s/epoch, loss=0.554, accuracy=0.877, val_loss=0.721, val_accuracy=0.82, lr=0.01]  67%|██████▋   | 100/150 [33:56<16:26, 19.73s/epoch, loss=0.555, accuracy=0.876, val_loss=0.847, val_accuracy=0.787, lr=0.01] 67%|██████▋   | 101/150 [34:15<16:05, 19.70s/epoch, loss=0.559, accuracy=0.877, val_loss=0.941, val_accuracy=0.756, lr=0.00316] 68%|██████▊   | 102/150 [34:35<15:46, 19.73s/epoch, loss=0.557, accuracy=0.878, val_loss=0.936, val_accuracy=0.775, lr=0.01]    69%|██████▊   | 103/150 [34:55<15:24, 19.67s/epoch, loss=0.556, accuracy=0.876, val_loss=1.07, val_accuracy=0.745, lr=0.01]  69%|██████▉   | 104/150 [35:14<15:02, 19.62s/epoch, loss=0.56, accuracy=0.878, val_loss=0.88, val_accuracy=0.779, lr=0.01]  70%|███████   | 105/150 [35:34<14:47, 19.72s/epoch, loss=0.558, accuracy=0.877, val_loss=0.848, val_accuracy=0.788, lr=0.01] 71%|███████   | 106/150 [35:54<14:25, 19.67s/epoch, loss=0.556, accuracy=0.879, val_loss=0.987, val_accuracy=0.751, lr=0.00316] 71%|███████▏  | 107/150 [36:13<14:05, 19.67s/epoch, loss=0.562, accuracy=0.879, val_loss=1.03, val_accuracy=0.759, lr=0.01]     72%|███████▏  | 108/150 [36:33<13:43, 19.62s/epoch, loss=0.56, accuracy=0.879, val_loss=0.942, val_accuracy=0.765, lr=0.01] 73%|███████▎  | 109/150 [36:53<13:27, 19.69s/epoch, loss=0.553, accuracy=0.882, val_loss=0.771, val_accuracy=0.808, lr=0.01] 73%|███████▎  | 110/150 [37:12<13:06, 19.66s/epoch, loss=0.56, accuracy=0.88, val_loss=0.867, val_accuracy=0.793, lr=0.01]   74%|███████▍  | 111/150 [37:32<12:45, 19.62s/epoch, loss=0.56, accuracy=0.879, val_loss=0.771, val_accuracy=0.805, lr=0.00316] 75%|███████▍  | 112/150 [37:52<12:28, 19.70s/epoch, loss=0.56, accuracy=0.88, val_loss=0.9, val_accuracy=0.777, lr=0.01]       75%|███████▌  | 113/150 [38:11<12:06, 19.64s/epoch, loss=0.553, accuracy=0.882, val_loss=0.817, val_accuracy=0.802, lr=0.01] 76%|███████▌  | 114/150 [38:31<11:46, 19.62s/epoch, loss=0.56, accuracy=0.88, val_loss=1.17, val_accuracy=0.738, lr=0.01]    77%|███████▋  | 115/150 [38:51<11:27, 19.64s/epoch, loss=0.556, accuracy=0.883, val_loss=0.799, val_accuracy=0.808, lr=0.01] 77%|███████▋  | 116/150 [39:10<11:07, 19.64s/epoch, loss=0.557, accuracy=0.882, val_loss=0.85, val_accuracy=0.79, lr=0.00316] 78%|███████▊  | 117/150 [39:30<10:47, 19.61s/epoch, loss=0.552, accuracy=0.885, val_loss=0.806, val_accuracy=0.805, lr=0.01]  79%|███████▊  | 118/150 [39:49<10:26, 19.56s/epoch, loss=0.555, accuracy=0.883, val_loss=0.834, val_accuracy=0.789, lr=0.01] 79%|███████▉  | 119/150 [40:09<10:06, 19.56s/epoch, loss=0.558, accuracy=0.882, val_loss=0.743, val_accuracy=0.821, lr=0.01] 80%|████████  | 120/150 [40:28<09:47, 19.57s/epoch, loss=0.552, accuracy=0.887, val_loss=1.06, val_accuracy=0.756, lr=0.01]  81%|████████  | 121/150 [40:48<09:27, 19.58s/epoch, loss=0.56, accuracy=0.882, val_loss=1.05, val_accuracy=0.76, lr=0.00316] 81%|████████▏ | 122/150 [41:08<09:09, 19.62s/epoch, loss=0.478, accuracy=0.911, val_loss=0.544, val_accuracy=0.888, lr=0.001] 82%|████████▏ | 123/150 [41:27<08:50, 19.66s/epoch, loss=0.425, accuracy=0.927, val_loss=0.522, val_accuracy=0.897, lr=0.001] 83%|████████▎ | 124/150 [41:47<08:31, 19.68s/epoch, loss=0.406, accuracy=0.931, val_loss=0.512, val_accuracy=0.895, lr=0.001] 83%|████████▎ | 125/150 [42:07<08:12, 19.72s/epoch, loss=0.387, accuracy=0.937, val_loss=0.506, val_accuracy=0.898, lr=0.001] 84%|████████▍ | 126/150 [42:27<07:55, 19.80s/epoch, loss=0.375, accuracy=0.938, val_loss=0.496, val_accuracy=0.898, lr=0.001] 85%|████████▍ | 127/150 [42:47<07:35, 19.78s/epoch, loss=0.358, accuracy=0.943, val_loss=0.491, val_accuracy=0.9, lr=0.001]   85%|████████▌ | 128/150 [43:07<07:15, 19.79s/epoch, loss=0.353, accuracy=0.942, val_loss=0.484, val_accuracy=0.899, lr=0.001] 86%|████████▌ | 129/150 [43:26<06:54, 19.74s/epoch, loss=0.342, accuracy=0.945, val_loss=0.485, val_accuracy=0.903, lr=0.001] 87%|████████▋ | 130/150 [43:46<06:35, 19.75s/epoch, loss=0.332, accuracy=0.947, val_loss=0.472, val_accuracy=0.902, lr=0.001] 87%|████████▋ | 131/150 [44:06<06:15, 19.77s/epoch, loss=0.322, accuracy=0.95, val_loss=0.474, val_accuracy=0.897, lr=0.001]  88%|████████▊ | 132/150 [44:26<05:56, 19.81s/epoch, loss=0.315, accuracy=0.95, val_loss=0.482, val_accuracy=0.897, lr=0.001] 89%|████████▊ | 133/150 [44:45<05:33, 19.63s/epoch, loss=0.306, accuracy=0.952, val_loss=0.467, val_accuracy=0.898, lr=0.001] 89%|████████▉ | 134/150 [45:05<05:14, 19.67s/epoch, loss=0.302, accuracy=0.951, val_loss=0.49, val_accuracy=0.895, lr=0.001]  90%|█████████ | 135/150 [45:24<04:53, 19.59s/epoch, loss=0.294, accuracy=0.952, val_loss=0.471, val_accuracy=0.897, lr=0.001] 91%|█████████ | 136/150 [45:44<04:34, 19.59s/epoch, loss=0.286, accuracy=0.954, val_loss=0.504, val_accuracy=0.887, lr=0.001] 91%|█████████▏| 137/150 [46:04<04:16, 19.70s/epoch, loss=0.28, accuracy=0.954, val_loss=0.478, val_accuracy=0.897, lr=0.001]  92%|█████████▏| 138/150 [46:23<03:56, 19.70s/epoch, loss=0.277, accuracy=0.955, val_loss=0.451, val_accuracy=0.901, lr=0.001] 93%|█████████▎| 139/150 [46:43<03:36, 19.70s/epoch, loss=0.268, accuracy=0.957, val_loss=0.469, val_accuracy=0.895, lr=0.001] 93%|█████████▎| 140/150 [47:03<03:17, 19.72s/epoch, loss=0.262, accuracy=0.958, val_loss=0.477, val_accuracy=0.889, lr=0.001] 94%|█████████▍| 141/150 [47:22<02:57, 19.73s/epoch, loss=0.257, accuracy=0.959, val_loss=0.478, val_accuracy=0.891, lr=0.001] 95%|█████████▍| 142/150 [47:42<02:37, 19.73s/epoch, loss=0.259, accuracy=0.956, val_loss=0.457, val_accuracy=0.897, lr=0.001] 95%|█████████▌| 143/150 [48:02<02:18, 19.73s/epoch, loss=0.255, accuracy=0.958, val_loss=0.49, val_accuracy=0.89, lr=0.000316] 96%|█████████▌| 144/150 [48:22<01:58, 19.75s/epoch, loss=0.25, accuracy=0.958, val_loss=0.454, val_accuracy=0.894, lr=0.001]   97%|█████████▋| 145/150 [48:41<01:38, 19.74s/epoch, loss=0.245, accuracy=0.959, val_loss=0.475, val_accuracy=0.893, lr=0.001] 97%|█████████▋| 146/150 [49:01<01:19, 19.78s/epoch, loss=0.243, accuracy=0.959, val_loss=0.471, val_accuracy=0.891, lr=0.001] 98%|█████████▊| 147/150 [49:21<00:59, 19.80s/epoch, loss=0.24, accuracy=0.961, val_loss=0.479, val_accuracy=0.889, lr=0.001]  99%|█████████▊| 148/150 [49:41<00:39, 19.81s/epoch, loss=0.239, accuracy=0.959, val_loss=0.483, val_accuracy=0.891, lr=0.000316] 99%|█████████▉| 149/150 [50:01<00:19, 19.84s/epoch, loss=0.234, accuracy=0.96, val_loss=0.45, val_accuracy=0.891, lr=0.001]     100%|██████████| 150/150 [50:21<00:00, 19.87s/epoch, loss=0.233, accuracy=0.96, val_loss=0.505, val_accuracy=0.885, lr=0.001]100%|██████████| 150/150 [50:21<00:00, 20.14s/epoch, loss=0.233, accuracy=0.96, val_loss=0.505, val_accuracy=0.885, lr=0.001]
Using real-time data augmentation.
Test score: 0.5052593946456909
Test accuracy: 0.8849999904632568


* * * Run SGD for ID = 10_2. * * *


2024-03-05 02:15:42.339122: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 02:15:48.213778: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 02:15:48.215019: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-05 02:15:48.254859: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-03-05 02:15:48.254902: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 02:15:48.263248: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 02:15:48.263317: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-05 02:15:48.265459: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-05 02:15:48.266147: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-05 02:15:48.268386: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-05 02:15:48.270192: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-05 02:15:48.274888: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 02:15:48.275484: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-05 02:15:48.275573: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 02:15:49.535091: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-05 02:15:49.535648: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 02:15:49.536427: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-03-05 02:15:49.536459: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 02:15:49.536503: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 02:15:49.536521: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-05 02:15:49.536536: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-05 02:15:49.536552: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-05 02:15:49.536568: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-05 02:15:49.536594: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-05 02:15:49.536611: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 02:15:49.537063: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-05 02:15:49.537099: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 02:15:50.213233: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-05 02:15:50.213290: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-05 02:15:50.213299: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-05 02:15:50.214274: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11227 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN X (Pascal), pci bus id: 0000:83:00.0, compute capability: 6.1)
{'id': '10_02', 'seed': 2, 'out_folder': 'results/epoch_budget', 'batch_size': 128, 'epochs': 150, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN X (Pascal)'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/150 [00:00<?, ?epoch/s]2024-03-05 02:15:51.085626: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-05 02:15:51.098126: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2600020000 Hz
2024-03-05 02:15:53.167962: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 02:15:53.416531: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 02:15:54.174232: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-05 02:15:54.233604: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/150 [01:03<2:38:23, 63.78s/epoch, loss=2.96, accuracy=0.352, val_loss=2.41, val_accuracy=0.227, lr=0.1]  1%|▏         | 2/150 [01:24<1:34:21, 38.25s/epoch, loss=1.5, accuracy=0.57, val_loss=2.15, val_accuracy=0.466, lr=0.1]    2%|▏         | 3/150 [01:44<1:14:00, 30.21s/epoch, loss=1.32, accuracy=0.662, val_loss=1.69, val_accuracy=0.531, lr=0.1]  3%|▎         | 4/150 [02:05<1:04:00, 26.30s/epoch, loss=1.27, accuracy=0.689, val_loss=1.66, val_accuracy=0.573, lr=0.1]  3%|▎         | 5/150 [02:25<58:36, 24.25s/epoch, loss=1.25, accuracy=0.703, val_loss=2.02, val_accuracy=0.496, lr=0.1]    4%|▍         | 6/150 [02:45<54:53, 22.87s/epoch, loss=1.23, accuracy=0.712, val_loss=2.16, val_accuracy=0.449, lr=0.1]  5%|▍         | 7/150 [03:06<52:25, 22.00s/epoch, loss=1.22, accuracy=0.719, val_loss=2.8, val_accuracy=0.356, lr=0.1]   5%|▌         | 8/150 [03:26<50:40, 21.42s/epoch, loss=1.21, accuracy=0.726, val_loss=2.7, val_accuracy=0.391, lr=0.1]  6%|▌         | 9/150 [03:46<49:26, 21.04s/epoch, loss=1.21, accuracy=0.73, val_loss=2.5, val_accuracy=0.458, lr=0.0316]  7%|▋         | 10/150 [04:06<48:28, 20.77s/epoch, loss=1.21, accuracy=0.732, val_loss=1.92, val_accuracy=0.527, lr=0.1]  7%|▋         | 11/150 [04:26<47:38, 20.56s/epoch, loss=1.2, accuracy=0.732, val_loss=1.9, val_accuracy=0.51, lr=0.1]     8%|▊         | 12/150 [04:47<47:15, 20.55s/epoch, loss=1.2, accuracy=0.734, val_loss=2.17, val_accuracy=0.442, lr=0.1]  9%|▊         | 13/150 [05:07<46:39, 20.43s/epoch, loss=1.2, accuracy=0.736, val_loss=2.59, val_accuracy=0.344, lr=0.1]  9%|▉         | 14/150 [05:27<46:05, 20.33s/epoch, loss=1.2, accuracy=0.737, val_loss=1.58, val_accuracy=0.598, lr=0.1] 10%|█         | 15/150 [05:47<45:39, 20.29s/epoch, loss=1.2, accuracy=0.741, val_loss=1.93, val_accuracy=0.576, lr=0.1] 11%|█         | 16/150 [06:08<45:18, 20.29s/epoch, loss=1.18, accuracy=0.742, val_loss=2.19, val_accuracy=0.441, lr=0.1] 11%|█▏        | 17/150 [06:28<45:00, 20.31s/epoch, loss=1.18, accuracy=0.745, val_loss=4.59, val_accuracy=0.214, lr=0.1] 12%|█▏        | 18/150 [06:48<44:35, 20.27s/epoch, loss=1.19, accuracy=0.742, val_loss=2.46, val_accuracy=0.424, lr=0.1] 13%|█▎        | 19/150 [07:08<44:04, 20.18s/epoch, loss=1.18, accuracy=0.743, val_loss=1.95, val_accuracy=0.568, lr=0.0316] 13%|█▎        | 20/150 [07:28<43:48, 20.22s/epoch, loss=1.18, accuracy=0.744, val_loss=1.81, val_accuracy=0.56, lr=0.1]     14%|█▍        | 21/150 [07:49<43:26, 20.21s/epoch, loss=1.17, accuracy=0.744, val_loss=1.58, val_accuracy=0.6, lr=0.1]  15%|█▍        | 22/150 [08:09<43:11, 20.24s/epoch, loss=1.18, accuracy=0.744, val_loss=2.7, val_accuracy=0.41, lr=0.1] 15%|█▌        | 23/150 [08:29<42:54, 20.27s/epoch, loss=1.17, accuracy=0.747, val_loss=2.22, val_accuracy=0.469, lr=0.1] 16%|█▌        | 24/150 [08:49<42:30, 20.24s/epoch, loss=1.17, accuracy=0.747, val_loss=1.61, val_accuracy=0.627, lr=0.1] 17%|█▋        | 25/150 [09:10<42:06, 20.21s/epoch, loss=1.17, accuracy=0.748, val_loss=2.1, val_accuracy=0.494, lr=0.1]  17%|█▋        | 26/150 [09:30<41:58, 20.31s/epoch, loss=1.16, accuracy=0.751, val_loss=1.68, val_accuracy=0.554, lr=0.0316] 18%|█▊        | 27/150 [09:51<41:43, 20.36s/epoch, loss=1.17, accuracy=0.75, val_loss=2.4, val_accuracy=0.469, lr=0.1]      19%|█▊        | 28/150 [10:11<41:09, 20.25s/epoch, loss=1.16, accuracy=0.749, val_loss=1.99, val_accuracy=0.49, lr=0.1] 19%|█▉        | 29/150 [10:31<40:48, 20.24s/epoch, loss=1.15, accuracy=0.751, val_loss=2.16, val_accuracy=0.478, lr=0.1] 20%|██        | 30/150 [10:51<40:29, 20.24s/epoch, loss=1.16, accuracy=0.751, val_loss=1.88, val_accuracy=0.561, lr=0.1] 21%|██        | 31/150 [11:11<39:58, 20.16s/epoch, loss=1.16, accuracy=0.751, val_loss=1.72, val_accuracy=0.541, lr=0.0316] 21%|██▏       | 32/150 [11:31<39:33, 20.12s/epoch, loss=1.16, accuracy=0.752, val_loss=1.93, val_accuracy=0.497, lr=0.1]    22%|██▏       | 33/150 [11:51<39:12, 20.10s/epoch, loss=1.15, accuracy=0.752, val_loss=1.43, val_accuracy=0.653, lr=0.1] 23%|██▎       | 34/150 [12:11<38:49, 20.08s/epoch, loss=1.16, accuracy=0.752, val_loss=1.67, val_accuracy=0.576, lr=0.1] 23%|██▎       | 35/150 [12:31<38:31, 20.10s/epoch, loss=1.15, accuracy=0.751, val_loss=3.31, val_accuracy=0.17, lr=0.1]  24%|██▍       | 36/150 [12:51<38:17, 20.15s/epoch, loss=1.15, accuracy=0.751, val_loss=1.96, val_accuracy=0.506, lr=0.1] 25%|██▍       | 37/150 [13:12<37:56, 20.14s/epoch, loss=1.15, accuracy=0.753, val_loss=2.02, val_accuracy=0.526, lr=0.1] 25%|██▌       | 38/150 [13:32<37:41, 20.19s/epoch, loss=1.14, accuracy=0.755, val_loss=1.43, val_accuracy=0.669, lr=0.1] 26%|██▌       | 39/150 [13:52<37:15, 20.14s/epoch, loss=1.16, accuracy=0.751, val_loss=4.31, val_accuracy=0.261, lr=0.1] 27%|██▋       | 40/150 [14:12<36:58, 20.17s/epoch, loss=1.14, accuracy=0.754, val_loss=2.08, val_accuracy=0.491, lr=0.1] 27%|██▋       | 41/150 [14:33<36:47, 20.25s/epoch, loss=1.15, accuracy=0.752, val_loss=1.37, val_accuracy=0.682, lr=0.1] 28%|██▊       | 42/150 [14:53<36:22, 20.21s/epoch, loss=1.14, accuracy=0.755, val_loss=1.57, val_accuracy=0.637, lr=0.1] 29%|██▊       | 43/150 [15:13<36:01, 20.20s/epoch, loss=1.15, accuracy=0.753, val_loss=2.36, val_accuracy=0.412, lr=0.1] 29%|██▉       | 44/150 [15:33<35:40, 20.19s/epoch, loss=1.15, accuracy=0.755, val_loss=1.9, val_accuracy=0.538, lr=0.1]  30%|███       | 45/150 [15:54<35:40, 20.38s/epoch, loss=1.14, accuracy=0.756, val_loss=2.44, val_accuracy=0.388, lr=0.1] 31%|███       | 46/150 [16:15<35:26, 20.45s/epoch, loss=1.15, accuracy=0.755, val_loss=2.73, val_accuracy=0.339, lr=0.0316] 31%|███▏      | 47/150 [16:35<35:13, 20.52s/epoch, loss=1.14, accuracy=0.754, val_loss=2.69, val_accuracy=0.433, lr=0.1]    32%|███▏      | 48/150 [16:56<34:55, 20.54s/epoch, loss=1.14, accuracy=0.755, val_loss=2.08, val_accuracy=0.485, lr=0.1] 33%|███▎      | 49/150 [17:16<34:29, 20.49s/epoch, loss=1.15, accuracy=0.753, val_loss=2.17, val_accuracy=0.46, lr=0.1]  33%|███▎      | 50/150 [17:36<34:03, 20.43s/epoch, loss=1.14, accuracy=0.754, val_loss=2.15, val_accuracy=0.525, lr=0.1] 34%|███▍      | 51/150 [17:57<33:40, 20.41s/epoch, loss=1.14, accuracy=0.755, val_loss=2.24, val_accuracy=0.439, lr=0.0316] 35%|███▍      | 52/150 [18:17<33:17, 20.38s/epoch, loss=1.14, accuracy=0.753, val_loss=2.32, val_accuracy=0.501, lr=0.1]    35%|███▌      | 53/150 [18:38<33:05, 20.46s/epoch, loss=1.14, accuracy=0.754, val_loss=1.9, val_accuracy=0.473, lr=0.1]  36%|███▌      | 54/150 [18:58<32:43, 20.45s/epoch, loss=1.13, accuracy=0.756, val_loss=1.8, val_accuracy=0.574, lr=0.1] 37%|███▋      | 55/150 [19:19<32:20, 20.43s/epoch, loss=1.14, accuracy=0.757, val_loss=1.77, val_accuracy=0.552, lr=0.1] 37%|███▋      | 56/150 [19:39<31:56, 20.39s/epoch, loss=1.14, accuracy=0.758, val_loss=1.56, val_accuracy=0.617, lr=0.0316] 38%|███▊      | 57/150 [19:59<31:34, 20.37s/epoch, loss=1.14, accuracy=0.754, val_loss=8.81, val_accuracy=0.161, lr=0.1]    39%|███▊      | 58/150 [20:20<31:13, 20.36s/epoch, loss=1.14, accuracy=0.755, val_loss=2.59, val_accuracy=0.454, lr=0.1] 39%|███▉      | 59/150 [20:40<30:48, 20.32s/epoch, loss=1.14, accuracy=0.757, val_loss=1.7, val_accuracy=0.599, lr=0.1]  40%|████      | 60/150 [21:00<30:26, 20.29s/epoch, loss=1.13, accuracy=0.759, val_loss=1.55, val_accuracy=0.627, lr=0.1] 41%|████      | 61/150 [21:20<30:07, 20.30s/epoch, loss=1.14, accuracy=0.756, val_loss=1.75, val_accuracy=0.55, lr=0.0316] 41%|████▏     | 62/150 [21:41<29:47, 20.31s/epoch, loss=1.13, accuracy=0.758, val_loss=2.74, val_accuracy=0.507, lr=0.1]   42%|████▏     | 63/150 [22:01<29:25, 20.30s/epoch, loss=1.13, accuracy=0.758, val_loss=3.25, val_accuracy=0.336, lr=0.1] 43%|████▎     | 64/150 [22:21<29:03, 20.28s/epoch, loss=1.14, accuracy=0.756, val_loss=4.12, val_accuracy=0.26, lr=0.1]  43%|████▎     | 65/150 [22:41<28:41, 20.26s/epoch, loss=1.14, accuracy=0.757, val_loss=1.88, val_accuracy=0.52, lr=0.1] 44%|████▍     | 66/150 [23:02<28:19, 20.24s/epoch, loss=1.13, accuracy=0.755, val_loss=1.81, val_accuracy=0.545, lr=0.0316] 45%|████▍     | 67/150 [23:22<28:03, 20.28s/epoch, loss=1.13, accuracy=0.757, val_loss=1.99, val_accuracy=0.479, lr=0.1]    45%|████▌     | 68/150 [23:42<27:39, 20.24s/epoch, loss=1.13, accuracy=0.757, val_loss=2.2, val_accuracy=0.469, lr=0.1]  46%|████▌     | 69/150 [24:02<27:15, 20.19s/epoch, loss=1.12, accuracy=0.757, val_loss=2.18, val_accuracy=0.434, lr=0.1] 47%|████▋     | 70/150 [24:22<26:55, 20.20s/epoch, loss=1.13, accuracy=0.756, val_loss=4.57, val_accuracy=0.34, lr=0.1]  47%|████▋     | 71/150 [24:42<26:29, 20.12s/epoch, loss=1.13, accuracy=0.759, val_loss=2.54, val_accuracy=0.465, lr=0.0316] 48%|████▊     | 72/150 [25:02<26:05, 20.07s/epoch, loss=1.13, accuracy=0.759, val_loss=2.18, val_accuracy=0.495, lr=0.1]    49%|████▊     | 73/150 [25:22<25:40, 20.01s/epoch, loss=1.12, accuracy=0.759, val_loss=2.68, val_accuracy=0.419, lr=0.1] 49%|████▉     | 74/150 [25:42<25:17, 19.97s/epoch, loss=1.13, accuracy=0.756, val_loss=1.6, val_accuracy=0.589, lr=0.1]  50%|█████     | 75/150 [26:02<24:58, 19.98s/epoch, loss=1.13, accuracy=0.758, val_loss=2.58, val_accuracy=0.392, lr=0.1] 51%|█████     | 76/150 [26:22<24:38, 19.99s/epoch, loss=1.12, accuracy=0.76, val_loss=2.07, val_accuracy=0.441, lr=0.0316] 51%|█████▏    | 77/150 [26:42<24:27, 20.10s/epoch, loss=1.12, accuracy=0.759, val_loss=2.57, val_accuracy=0.446, lr=0.1]   52%|█████▏    | 78/150 [27:02<24:04, 20.06s/epoch, loss=1.13, accuracy=0.757, val_loss=2.79, val_accuracy=0.263, lr=0.1] 53%|█████▎    | 79/150 [27:22<23:44, 20.06s/epoch, loss=1.13, accuracy=0.758, val_loss=3.87, val_accuracy=0.277, lr=0.1] 53%|█████▎    | 80/150 [27:42<23:19, 19.99s/epoch, loss=1.13, accuracy=0.758, val_loss=3.81, val_accuracy=0.318, lr=0.1] 54%|█████▍    | 81/150 [28:02<22:58, 19.97s/epoch, loss=1.12, accuracy=0.755, val_loss=8.61, val_accuracy=0.182, lr=0.0316] 55%|█████▍    | 82/150 [28:22<22:35, 19.93s/epoch, loss=0.914, accuracy=0.818, val_loss=0.988, val_accuracy=0.773, lr=0.01] 55%|█████▌    | 83/150 [28:42<22:15, 19.93s/epoch, loss=0.738, accuracy=0.85, val_loss=0.787, val_accuracy=0.822, lr=0.01]  56%|█████▌    | 84/150 [29:02<21:56, 19.94s/epoch, loss=0.653, accuracy=0.857, val_loss=0.751, val_accuracy=0.819, lr=0.01] 57%|█████▋    | 85/150 [29:22<21:36, 19.95s/epoch, loss=0.606, accuracy=0.86, val_loss=0.832, val_accuracy=0.786, lr=0.01]  57%|█████▋    | 86/150 [29:42<21:14, 19.92s/epoch, loss=0.587, accuracy=0.861, val_loss=0.9, val_accuracy=0.774, lr=0.01]  58%|█████▊    | 87/150 [30:02<20:53, 19.90s/epoch, loss=0.573, accuracy=0.865, val_loss=0.836, val_accuracy=0.774, lr=0.01] 59%|█████▊    | 88/150 [30:21<20:32, 19.89s/epoch, loss=0.569, accuracy=0.862, val_loss=0.701, val_accuracy=0.824, lr=0.01] 59%|█████▉    | 89/150 [30:42<20:17, 19.95s/epoch, loss=0.563, accuracy=0.866, val_loss=0.73, val_accuracy=0.813, lr=0.01]  60%|██████    | 90/150 [31:01<19:54, 19.91s/epoch, loss=0.567, accuracy=0.866, val_loss=0.927, val_accuracy=0.766, lr=0.01] 61%|██████    | 91/150 [31:21<19:33, 19.90s/epoch, loss=0.561, accuracy=0.869, val_loss=0.892, val_accuracy=0.762, lr=0.01] 61%|██████▏   | 92/150 [31:41<19:14, 19.91s/epoch, loss=0.557, accuracy=0.869, val_loss=1.05, val_accuracy=0.746, lr=0.01]  62%|██████▏   | 93/150 [32:01<18:55, 19.92s/epoch, loss=0.561, accuracy=0.87, val_loss=0.872, val_accuracy=0.786, lr=0.00316] 63%|██████▎   | 94/150 [32:21<18:33, 19.89s/epoch, loss=0.554, accuracy=0.872, val_loss=0.856, val_accuracy=0.775, lr=0.01]   63%|██████▎   | 95/150 [32:41<18:16, 19.94s/epoch, loss=0.557, accuracy=0.873, val_loss=0.777, val_accuracy=0.808, lr=0.01] 64%|██████▍   | 96/150 [33:01<17:55, 19.91s/epoch, loss=0.558, accuracy=0.873, val_loss=0.864, val_accuracy=0.782, lr=0.01] 65%|██████▍   | 97/150 [33:20<17:29, 19.80s/epoch, loss=0.555, accuracy=0.875, val_loss=0.884, val_accuracy=0.787, lr=0.01] 65%|██████▌   | 98/150 [33:40<17:09, 19.80s/epoch, loss=0.554, accuracy=0.877, val_loss=0.905, val_accuracy=0.763, lr=0.00316] 66%|██████▌   | 99/150 [34:00<16:51, 19.83s/epoch, loss=0.552, accuracy=0.878, val_loss=0.739, val_accuracy=0.814, lr=0.01]    67%|██████▋   | 100/150 [34:20<16:33, 19.88s/epoch, loss=0.558, accuracy=0.875, val_loss=0.744, val_accuracy=0.817, lr=0.01] 67%|██████▋   | 101/150 [34:40<16:17, 19.94s/epoch, loss=0.552, accuracy=0.877, val_loss=0.772, val_accuracy=0.814, lr=0.01] 68%|██████▊   | 102/150 [35:00<15:55, 19.90s/epoch, loss=0.558, accuracy=0.877, val_loss=0.975, val_accuracy=0.753, lr=0.01] 69%|██████▊   | 103/150 [35:20<15:35, 19.90s/epoch, loss=0.554, accuracy=0.879, val_loss=0.873, val_accuracy=0.786, lr=0.00316] 69%|██████▉   | 104/150 [35:40<15:15, 19.89s/epoch, loss=0.552, accuracy=0.879, val_loss=0.834, val_accuracy=0.804, lr=0.01]    70%|███████   | 105/150 [36:00<14:55, 19.90s/epoch, loss=0.552, accuracy=0.881, val_loss=0.986, val_accuracy=0.737, lr=0.01] 71%|███████   | 106/150 [36:19<14:33, 19.86s/epoch, loss=0.55, accuracy=0.883, val_loss=0.721, val_accuracy=0.83, lr=0.01]   71%|███████▏  | 107/150 [36:39<14:16, 19.91s/epoch, loss=0.55, accuracy=0.882, val_loss=0.753, val_accuracy=0.812, lr=0.01] 72%|███████▏  | 108/150 [36:59<13:57, 19.93s/epoch, loss=0.554, accuracy=0.882, val_loss=0.756, val_accuracy=0.818, lr=0.00316] 73%|███████▎  | 109/150 [37:19<13:35, 19.90s/epoch, loss=0.557, accuracy=0.881, val_loss=0.747, val_accuracy=0.826, lr=0.01]    73%|███████▎  | 110/150 [37:39<13:12, 19.81s/epoch, loss=0.55, accuracy=0.881, val_loss=0.805, val_accuracy=0.808, lr=0.01]  74%|███████▍  | 111/150 [37:59<12:55, 19.88s/epoch, loss=0.554, accuracy=0.882, val_loss=0.875, val_accuracy=0.798, lr=0.01] 75%|███████▍  | 112/150 [38:19<12:35, 19.87s/epoch, loss=0.558, accuracy=0.88, val_loss=0.838, val_accuracy=0.794, lr=0.01]  75%|███████▌  | 113/150 [38:38<12:11, 19.78s/epoch, loss=0.555, accuracy=0.884, val_loss=0.898, val_accuracy=0.779, lr=0.00316] 76%|███████▌  | 114/150 [38:58<11:49, 19.70s/epoch, loss=0.555, accuracy=0.884, val_loss=0.803, val_accuracy=0.804, lr=0.01]    77%|███████▋  | 115/150 [39:17<11:27, 19.66s/epoch, loss=0.556, accuracy=0.882, val_loss=0.783, val_accuracy=0.816, lr=0.01] 77%|███████▋  | 116/150 [39:37<11:08, 19.66s/epoch, loss=0.552, accuracy=0.883, val_loss=0.927, val_accuracy=0.783, lr=0.01] 78%|███████▊  | 117/150 [39:57<10:48, 19.66s/epoch, loss=0.559, accuracy=0.882, val_loss=0.877, val_accuracy=0.782, lr=0.01] 79%|███████▊  | 118/150 [40:17<10:31, 19.73s/epoch, loss=0.555, accuracy=0.885, val_loss=0.85, val_accuracy=0.791, lr=0.00316] 79%|███████▉  | 119/150 [40:36<10:08, 19.64s/epoch, loss=0.555, accuracy=0.885, val_loss=0.775, val_accuracy=0.817, lr=0.01]   80%|████████  | 120/150 [40:56<09:50, 19.67s/epoch, loss=0.551, accuracy=0.886, val_loss=0.885, val_accuracy=0.791, lr=0.01] 81%|████████  | 121/150 [41:15<09:30, 19.68s/epoch, loss=0.554, accuracy=0.885, val_loss=0.847, val_accuracy=0.788, lr=0.01] 81%|████████▏ | 122/150 [41:35<09:11, 19.69s/epoch, loss=0.477, accuracy=0.912, val_loss=0.547, val_accuracy=0.891, lr=0.001] 82%|████████▏ | 123/150 [41:55<08:54, 19.80s/epoch, loss=0.423, accuracy=0.929, val_loss=0.527, val_accuracy=0.893, lr=0.001] 83%|████████▎ | 124/150 [42:15<08:37, 19.89s/epoch, loss=0.402, accuracy=0.933, val_loss=0.516, val_accuracy=0.896, lr=0.001] 83%|████████▎ | 125/150 [42:35<08:18, 19.94s/epoch, loss=0.385, accuracy=0.938, val_loss=0.514, val_accuracy=0.893, lr=0.001] 84%|████████▍ | 126/150 [42:55<07:58, 19.94s/epoch, loss=0.371, accuracy=0.94, val_loss=0.495, val_accuracy=0.896, lr=0.001]  85%|████████▍ | 127/150 [43:15<07:39, 19.97s/epoch, loss=0.356, accuracy=0.943, val_loss=0.493, val_accuracy=0.896, lr=0.001] 85%|████████▌ | 128/150 [43:36<07:20, 20.03s/epoch, loss=0.346, accuracy=0.945, val_loss=0.495, val_accuracy=0.896, lr=0.001] 86%|████████▌ | 129/150 [43:56<07:00, 20.04s/epoch, loss=0.336, accuracy=0.947, val_loss=0.491, val_accuracy=0.898, lr=0.001] 87%|████████▋ | 130/150 [44:16<06:42, 20.14s/epoch, loss=0.328, accuracy=0.949, val_loss=0.488, val_accuracy=0.899, lr=0.001] 87%|████████▋ | 131/150 [44:36<06:22, 20.15s/epoch, loss=0.319, accuracy=0.949, val_loss=0.479, val_accuracy=0.898, lr=0.001] 88%|████████▊ | 132/150 [44:56<06:03, 20.17s/epoch, loss=0.31, accuracy=0.951, val_loss=0.49, val_accuracy=0.895, lr=0.001]   89%|████████▊ | 133/150 [45:16<05:42, 20.13s/epoch, loss=0.305, accuracy=0.952, val_loss=0.471, val_accuracy=0.898, lr=0.001] 89%|████████▉ | 134/150 [45:36<05:21, 20.11s/epoch, loss=0.298, accuracy=0.953, val_loss=0.476, val_accuracy=0.897, lr=0.001] 90%|█████████ | 135/150 [45:56<05:01, 20.08s/epoch, loss=0.289, accuracy=0.954, val_loss=0.481, val_accuracy=0.892, lr=0.001] 91%|█████████ | 136/150 [46:17<04:41, 20.09s/epoch, loss=0.283, accuracy=0.956, val_loss=0.473, val_accuracy=0.896, lr=0.001] 91%|█████████▏| 137/150 [46:37<04:20, 20.05s/epoch, loss=0.278, accuracy=0.956, val_loss=0.481, val_accuracy=0.896, lr=0.001] 92%|█████████▏| 138/150 [46:57<04:00, 20.06s/epoch, loss=0.272, accuracy=0.956, val_loss=0.467, val_accuracy=0.896, lr=0.001] 93%|█████████▎| 139/150 [47:16<03:40, 20.01s/epoch, loss=0.268, accuracy=0.956, val_loss=0.478, val_accuracy=0.893, lr=0.001] 93%|█████████▎| 140/150 [47:36<03:19, 19.98s/epoch, loss=0.26, accuracy=0.959, val_loss=0.465, val_accuracy=0.895, lr=0.001]  94%|█████████▍| 141/150 [47:56<02:59, 19.95s/epoch, loss=0.256, accuracy=0.959, val_loss=0.46, val_accuracy=0.898, lr=0.001] 95%|█████████▍| 142/150 [48:16<02:39, 19.89s/epoch, loss=0.254, accuracy=0.959, val_loss=0.486, val_accuracy=0.889, lr=0.001] 95%|█████████▌| 143/150 [48:36<02:19, 19.90s/epoch, loss=0.25, accuracy=0.958, val_loss=0.478, val_accuracy=0.893, lr=0.001]  96%|█████████▌| 144/150 [48:56<01:59, 19.91s/epoch, loss=0.247, accuracy=0.959, val_loss=0.487, val_accuracy=0.892, lr=0.001] 97%|█████████▋| 145/150 [49:16<01:39, 19.91s/epoch, loss=0.242, accuracy=0.96, val_loss=0.477, val_accuracy=0.89, lr=0.001]   97%|█████████▋| 146/150 [49:36<01:19, 19.87s/epoch, loss=0.241, accuracy=0.959, val_loss=0.486, val_accuracy=0.885, lr=0.000316] 98%|█████████▊| 147/150 [49:55<00:59, 19.88s/epoch, loss=0.24, accuracy=0.959, val_loss=0.478, val_accuracy=0.895, lr=0.001]     99%|█████████▊| 148/150 [50:15<00:39, 19.90s/epoch, loss=0.239, accuracy=0.959, val_loss=0.456, val_accuracy=0.894, lr=0.001] 99%|█████████▉| 149/150 [50:35<00:19, 19.88s/epoch, loss=0.232, accuracy=0.961, val_loss=0.477, val_accuracy=0.893, lr=0.001]100%|██████████| 150/150 [50:55<00:00, 19.91s/epoch, loss=0.229, accuracy=0.961, val_loss=0.504, val_accuracy=0.883, lr=0.001]100%|██████████| 150/150 [50:55<00:00, 20.37s/epoch, loss=0.229, accuracy=0.961, val_loss=0.504, val_accuracy=0.883, lr=0.001]
Using real-time data augmentation.
Test score: 0.504021167755127
Test accuracy: 0.8834999799728394


* * * Run SGD for ID = 10_3. * * *


2024-03-05 03:06:50.515218: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 03:06:53.050722: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 03:06:53.051733: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-05 03:06:53.087616: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-03-05 03:06:53.087640: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 03:06:53.090491: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 03:06:53.090527: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-05 03:06:53.092496: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-05 03:06:53.093067: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-05 03:06:53.095252: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-05 03:06:53.097632: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-05 03:06:53.102202: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 03:06:53.102686: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-05 03:06:53.102768: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 03:06:54.275884: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-05 03:06:54.276432: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 03:06:54.276850: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-03-05 03:06:54.276880: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 03:06:54.276912: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 03:06:54.276927: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-05 03:06:54.276942: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-05 03:06:54.276964: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-05 03:06:54.276980: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-05 03:06:54.276995: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-05 03:06:54.277010: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 03:06:54.277426: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-05 03:06:54.277462: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 03:06:54.920507: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-05 03:06:54.920563: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-05 03:06:54.920572: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-05 03:06:54.921741: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11227 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN X (Pascal), pci bus id: 0000:83:00.0, compute capability: 6.1)
{'id': '10_03', 'seed': 3, 'out_folder': 'results/epoch_budget', 'batch_size': 128, 'epochs': 150, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN X (Pascal)'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/150 [00:00<?, ?epoch/s]2024-03-05 03:06:55.767275: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-05 03:06:55.779125: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2600020000 Hz
2024-03-05 03:06:57.732175: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 03:06:57.961506: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 03:06:58.695287: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-05 03:06:58.755878: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/150 [01:06<2:44:54, 66.41s/epoch, loss=2.88, accuracy=0.391, val_loss=2.53, val_accuracy=0.262, lr=0.1]  1%|▏         | 2/150 [01:26<1:37:18, 39.45s/epoch, loss=1.45, accuracy=0.599, val_loss=2.25, val_accuracy=0.404, lr=0.1]  2%|▏         | 3/150 [01:47<1:15:14, 30.71s/epoch, loss=1.29, accuracy=0.667, val_loss=2.09, val_accuracy=0.407, lr=0.1]  3%|▎         | 4/150 [02:07<1:04:38, 26.57s/epoch, loss=1.24, accuracy=0.696, val_loss=3.2, val_accuracy=0.234, lr=0.1]   3%|▎         | 5/150 [02:27<58:33, 24.23s/epoch, loss=1.23, accuracy=0.707, val_loss=1.85, val_accuracy=0.527, lr=0.1]   4%|▍         | 6/150 [02:47<54:54, 22.88s/epoch, loss=1.22, accuracy=0.718, val_loss=1.5, val_accuracy=0.613, lr=0.1]   5%|▍         | 7/150 [03:08<52:24, 21.99s/epoch, loss=1.21, accuracy=0.726, val_loss=2.25, val_accuracy=0.484, lr=0.1]  5%|▌         | 8/150 [03:28<50:36, 21.38s/epoch, loss=1.2, accuracy=0.726, val_loss=2.42, val_accuracy=0.427, lr=0.1]   6%|▌         | 9/150 [03:48<49:23, 21.02s/epoch, loss=1.18, accuracy=0.733, val_loss=2.01, val_accuracy=0.473, lr=0.1]  7%|▋         | 10/150 [04:08<48:23, 20.74s/epoch, loss=1.19, accuracy=0.731, val_loss=1.98, val_accuracy=0.516, lr=0.1]  7%|▋         | 11/150 [04:28<47:19, 20.43s/epoch, loss=1.17, accuracy=0.738, val_loss=1.91, val_accuracy=0.517, lr=0.0316]  8%|▊         | 12/150 [04:48<46:41, 20.30s/epoch, loss=1.17, accuracy=0.738, val_loss=1.55, val_accuracy=0.608, lr=0.1]     9%|▊         | 13/150 [05:08<46:13, 20.24s/epoch, loss=1.17, accuracy=0.739, val_loss=1.93, val_accuracy=0.525, lr=0.1]  9%|▉         | 14/150 [05:28<45:48, 20.21s/epoch, loss=1.17, accuracy=0.741, val_loss=1.91, val_accuracy=0.57, lr=0.1]  10%|█         | 15/150 [05:48<45:18, 20.14s/epoch, loss=1.17, accuracy=0.743, val_loss=2.15, val_accuracy=0.462, lr=0.1] 11%|█         | 16/150 [06:08<44:56, 20.12s/epoch, loss=1.16, accuracy=0.743, val_loss=1.44, val_accuracy=0.65, lr=0.1]  11%|█▏        | 17/150 [06:28<44:38, 20.14s/epoch, loss=1.16, accuracy=0.743, val_loss=1.57, val_accuracy=0.594, lr=0.1] 12%|█▏        | 18/150 [06:48<44:11, 20.09s/epoch, loss=1.16, accuracy=0.745, val_loss=1.82, val_accuracy=0.541, lr=0.1] 13%|█▎        | 19/150 [07:08<43:44, 20.03s/epoch, loss=1.15, accuracy=0.75, val_loss=2.96, val_accuracy=0.269, lr=0.1]  13%|█▎        | 20/150 [07:28<43:25, 20.04s/epoch, loss=1.15, accuracy=0.749, val_loss=1.4, val_accuracy=0.645, lr=0.1] 14%|█▍        | 21/150 [07:48<43:05, 20.05s/epoch, loss=1.14, accuracy=0.75, val_loss=2.02, val_accuracy=0.44, lr=0.1]  15%|█▍        | 22/150 [08:08<42:47, 20.06s/epoch, loss=1.14, accuracy=0.752, val_loss=1.98, val_accuracy=0.428, lr=0.1] 15%|█▌        | 23/150 [08:28<42:32, 20.10s/epoch, loss=1.15, accuracy=0.75, val_loss=2.66, val_accuracy=0.455, lr=0.1]  16%|█▌        | 24/150 [08:49<42:22, 20.18s/epoch, loss=1.14, accuracy=0.752, val_loss=1.85, val_accuracy=0.529, lr=0.1] 17%|█▋        | 25/150 [09:09<42:03, 20.19s/epoch, loss=1.14, accuracy=0.753, val_loss=1.84, val_accuracy=0.512, lr=0.0316] 17%|█▋        | 26/150 [09:29<41:43, 20.19s/epoch, loss=1.14, accuracy=0.751, val_loss=1.61, val_accuracy=0.609, lr=0.1]    18%|█▊        | 27/150 [09:50<41:31, 20.26s/epoch, loss=1.13, accuracy=0.753, val_loss=2.6, val_accuracy=0.43, lr=0.1]   19%|█▊        | 28/150 [10:10<41:06, 20.21s/epoch, loss=1.14, accuracy=0.754, val_loss=2.04, val_accuracy=0.476, lr=0.1] 19%|█▉        | 29/150 [10:30<40:36, 20.14s/epoch, loss=1.13, accuracy=0.757, val_loss=1.8, val_accuracy=0.534, lr=0.1]  20%|██        | 30/150 [10:50<40:21, 20.18s/epoch, loss=1.13, accuracy=0.755, val_loss=2.05, val_accuracy=0.472, lr=0.0316] 21%|██        | 31/150 [11:10<39:58, 20.15s/epoch, loss=1.13, accuracy=0.756, val_loss=2.18, val_accuracy=0.431, lr=0.1]    21%|██▏       | 32/150 [11:30<39:36, 20.14s/epoch, loss=1.13, accuracy=0.757, val_loss=2.45, val_accuracy=0.464, lr=0.1] 22%|██▏       | 33/150 [11:50<39:14, 20.12s/epoch, loss=1.13, accuracy=0.753, val_loss=2.96, val_accuracy=0.393, lr=0.1] 23%|██▎       | 34/150 [12:10<38:55, 20.13s/epoch, loss=1.13, accuracy=0.755, val_loss=1.63, val_accuracy=0.604, lr=0.1] 23%|██▎       | 35/150 [12:31<38:35, 20.13s/epoch, loss=1.13, accuracy=0.756, val_loss=1.37, val_accuracy=0.675, lr=0.1] 24%|██▍       | 36/150 [12:51<38:16, 20.14s/epoch, loss=1.12, accuracy=0.756, val_loss=2.62, val_accuracy=0.441, lr=0.1] 25%|██▍       | 37/150 [13:11<37:58, 20.16s/epoch, loss=1.12, accuracy=0.758, val_loss=2.29, val_accuracy=0.414, lr=0.1] 25%|██▌       | 38/150 [13:31<37:35, 20.14s/epoch, loss=1.13, accuracy=0.755, val_loss=1.5, val_accuracy=0.635, lr=0.1]  26%|██▌       | 39/150 [13:51<37:11, 20.10s/epoch, loss=1.13, accuracy=0.754, val_loss=1.9, val_accuracy=0.476, lr=0.1] 27%|██▋       | 40/150 [14:11<36:48, 20.08s/epoch, loss=1.13, accuracy=0.757, val_loss=1.55, val_accuracy=0.605, lr=0.0316] 27%|██▋       | 41/150 [14:31<36:36, 20.16s/epoch, loss=1.13, accuracy=0.755, val_loss=3.37, val_accuracy=0.262, lr=0.1]    28%|██▊       | 42/150 [14:52<36:17, 20.16s/epoch, loss=1.12, accuracy=0.757, val_loss=3.97, val_accuracy=0.323, lr=0.1] 29%|██▊       | 43/150 [15:12<35:53, 20.13s/epoch, loss=1.12, accuracy=0.76, val_loss=2.94, val_accuracy=0.402, lr=0.1]  29%|██▉       | 44/150 [15:32<35:40, 20.19s/epoch, loss=1.12, accuracy=0.757, val_loss=2.49, val_accuracy=0.408, lr=0.1] 30%|███       | 45/150 [15:52<35:22, 20.22s/epoch, loss=1.12, accuracy=0.758, val_loss=1.67, val_accuracy=0.602, lr=0.0316] 31%|███       | 46/150 [16:12<35:04, 20.23s/epoch, loss=1.12, accuracy=0.76, val_loss=1.7, val_accuracy=0.6, lr=0.1]        31%|███▏      | 47/150 [16:33<34:50, 20.30s/epoch, loss=1.12, accuracy=0.757, val_loss=3.37, val_accuracy=0.406, lr=0.1] 32%|███▏      | 48/150 [16:53<34:38, 20.38s/epoch, loss=1.12, accuracy=0.759, val_loss=2.32, val_accuracy=0.471, lr=0.1] 33%|███▎      | 49/150 [17:14<34:17, 20.37s/epoch, loss=1.12, accuracy=0.759, val_loss=2.18, val_accuracy=0.423, lr=0.1] 33%|███▎      | 50/150 [17:34<34:00, 20.40s/epoch, loss=1.12, accuracy=0.758, val_loss=3.03, val_accuracy=0.34, lr=0.0316] 34%|███▍      | 51/150 [17:54<33:33, 20.34s/epoch, loss=1.11, accuracy=0.761, val_loss=2.78, val_accuracy=0.436, lr=0.1]   35%|███▍      | 52/150 [18:15<33:08, 20.29s/epoch, loss=1.12, accuracy=0.756, val_loss=1.98, val_accuracy=0.553, lr=0.1] 35%|███▌      | 53/150 [18:35<32:52, 20.33s/epoch, loss=1.12, accuracy=0.757, val_loss=1.84, val_accuracy=0.529, lr=0.1] 36%|███▌      | 54/150 [18:56<32:33, 20.35s/epoch, loss=1.12, accuracy=0.758, val_loss=2.73, val_accuracy=0.358, lr=0.1] 37%|███▋      | 55/150 [19:16<32:09, 20.31s/epoch, loss=1.11, accuracy=0.758, val_loss=2.21, val_accuracy=0.441, lr=0.0316] 37%|███▋      | 56/150 [19:36<31:42, 20.24s/epoch, loss=1.11, accuracy=0.758, val_loss=1.66, val_accuracy=0.529, lr=0.1]    38%|███▊      | 57/150 [19:56<31:24, 20.27s/epoch, loss=1.12, accuracy=0.756, val_loss=2.75, val_accuracy=0.363, lr=0.1] 39%|███▊      | 58/150 [20:17<31:09, 20.32s/epoch, loss=1.11, accuracy=0.76, val_loss=2.08, val_accuracy=0.484, lr=0.1]  39%|███▉      | 59/150 [20:37<30:46, 20.29s/epoch, loss=1.11, accuracy=0.758, val_loss=2.1, val_accuracy=0.472, lr=0.1] 40%|████      | 60/150 [20:57<30:24, 20.27s/epoch, loss=1.11, accuracy=0.761, val_loss=1.68, val_accuracy=0.544, lr=0.0316] 41%|████      | 61/150 [21:17<29:58, 20.20s/epoch, loss=1.11, accuracy=0.759, val_loss=2.33, val_accuracy=0.355, lr=0.1]    41%|████▏     | 62/150 [21:37<29:39, 20.23s/epoch, loss=1.11, accuracy=0.761, val_loss=2.44, val_accuracy=0.464, lr=0.1] 42%|████▏     | 63/150 [21:57<29:14, 20.17s/epoch, loss=1.11, accuracy=0.759, val_loss=2.6, val_accuracy=0.396, lr=0.1]  43%|████▎     | 64/150 [22:17<28:50, 20.12s/epoch, loss=1.12, accuracy=0.76, val_loss=1.52, val_accuracy=0.613, lr=0.1] 43%|████▎     | 65/150 [22:37<28:23, 20.04s/epoch, loss=1.11, accuracy=0.758, val_loss=1.88, val_accuracy=0.538, lr=0.0316] 44%|████▍     | 66/150 [22:57<28:06, 20.08s/epoch, loss=1.11, accuracy=0.762, val_loss=1.55, val_accuracy=0.624, lr=0.1]    45%|████▍     | 67/150 [23:17<27:46, 20.08s/epoch, loss=1.11, accuracy=0.759, val_loss=1.61, val_accuracy=0.595, lr=0.1] 45%|████▌     | 68/150 [23:37<27:24, 20.06s/epoch, loss=1.11, accuracy=0.758, val_loss=1.99, val_accuracy=0.504, lr=0.1] 46%|████▌     | 69/150 [23:57<27:01, 20.02s/epoch, loss=1.11, accuracy=0.759, val_loss=2.11, val_accuracy=0.512, lr=0.1] 47%|████▋     | 70/150 [24:17<26:41, 20.02s/epoch, loss=1.11, accuracy=0.761, val_loss=1.53, val_accuracy=0.614, lr=0.0316] 47%|████▋     | 71/150 [24:37<26:16, 19.95s/epoch, loss=1.11, accuracy=0.759, val_loss=1.95, val_accuracy=0.53, lr=0.1]     48%|████▊     | 72/150 [24:57<25:58, 19.98s/epoch, loss=1.1, accuracy=0.761, val_loss=1.69, val_accuracy=0.554, lr=0.1] 49%|████▊     | 73/150 [25:17<25:35, 19.94s/epoch, loss=1.1, accuracy=0.759, val_loss=2.07, val_accuracy=0.513, lr=0.1] 49%|████▉     | 74/150 [25:37<25:15, 19.94s/epoch, loss=1.11, accuracy=0.76, val_loss=1.6, val_accuracy=0.598, lr=0.1]  50%|█████     | 75/150 [25:57<24:58, 19.99s/epoch, loss=1.11, accuracy=0.758, val_loss=2.36, val_accuracy=0.344, lr=0.0316] 51%|█████     | 76/150 [26:17<24:39, 20.00s/epoch, loss=1.11, accuracy=0.759, val_loss=2.3, val_accuracy=0.419, lr=0.1]     51%|█████▏    | 77/150 [26:37<24:23, 20.05s/epoch, loss=1.1, accuracy=0.759, val_loss=2.1, val_accuracy=0.443, lr=0.1]  52%|█████▏    | 78/150 [26:57<24:03, 20.04s/epoch, loss=1.11, accuracy=0.761, val_loss=2.8, val_accuracy=0.369, lr=0.1] 53%|█████▎    | 79/150 [27:17<23:42, 20.04s/epoch, loss=1.11, accuracy=0.758, val_loss=2.15, val_accuracy=0.443, lr=0.1] 53%|█████▎    | 80/150 [27:38<23:24, 20.06s/epoch, loss=1.11, accuracy=0.757, val_loss=1.35, val_accuracy=0.669, lr=0.1] 54%|█████▍    | 81/150 [27:57<23:00, 20.01s/epoch, loss=1.11, accuracy=0.759, val_loss=2.4, val_accuracy=0.433, lr=0.1]  55%|█████▍    | 82/150 [28:17<22:40, 20.00s/epoch, loss=0.89, accuracy=0.818, val_loss=0.937, val_accuracy=0.782, lr=0.01] 55%|█████▌    | 83/150 [28:37<22:17, 19.96s/epoch, loss=0.718, accuracy=0.85, val_loss=0.877, val_accuracy=0.785, lr=0.01] 56%|█████▌    | 84/150 [28:57<21:55, 19.94s/epoch, loss=0.638, accuracy=0.857, val_loss=0.837, val_accuracy=0.776, lr=0.01] 57%|█████▋    | 85/150 [29:17<21:36, 19.94s/epoch, loss=0.601, accuracy=0.86, val_loss=0.779, val_accuracy=0.793, lr=0.01]  57%|█████▋    | 86/150 [29:37<21:20, 20.01s/epoch, loss=0.578, accuracy=0.863, val_loss=0.726, val_accuracy=0.81, lr=0.01] 58%|█████▊    | 87/150 [29:57<21:01, 20.02s/epoch, loss=0.566, accuracy=0.864, val_loss=0.738, val_accuracy=0.805, lr=0.01] 59%|█████▊    | 88/150 [30:17<20:40, 20.01s/epoch, loss=0.561, accuracy=0.865, val_loss=0.781, val_accuracy=0.791, lr=0.01] 59%|█████▉    | 89/150 [30:37<20:18, 19.98s/epoch, loss=0.556, accuracy=0.867, val_loss=0.811, val_accuracy=0.793, lr=0.01] 60%|██████    | 90/150 [30:57<20:01, 20.02s/epoch, loss=0.558, accuracy=0.867, val_loss=1.05, val_accuracy=0.735, lr=0.01]  61%|██████    | 91/150 [31:17<19:38, 19.98s/epoch, loss=0.561, accuracy=0.866, val_loss=0.864, val_accuracy=0.771, lr=0.00316] 61%|██████▏   | 92/150 [31:37<19:17, 19.95s/epoch, loss=0.551, accuracy=0.87, val_loss=0.839, val_accuracy=0.776, lr=0.01]     62%|██████▏   | 93/150 [31:57<18:58, 19.97s/epoch, loss=0.546, accuracy=0.875, val_loss=0.819, val_accuracy=0.785, lr=0.01] 63%|██████▎   | 94/150 [32:17<18:40, 20.00s/epoch, loss=0.55, accuracy=0.871, val_loss=1.02, val_accuracy=0.73, lr=0.01]    63%|██████▎   | 95/150 [32:37<18:17, 19.96s/epoch, loss=0.549, accuracy=0.874, val_loss=0.88, val_accuracy=0.765, lr=0.01] 64%|██████▍   | 96/150 [32:57<17:56, 19.93s/epoch, loss=0.55, accuracy=0.874, val_loss=0.83, val_accuracy=0.781, lr=0.00316] 65%|██████▍   | 97/150 [33:17<17:36, 19.93s/epoch, loss=0.551, accuracy=0.874, val_loss=0.809, val_accuracy=0.801, lr=0.01]  65%|██████▌   | 98/150 [33:37<17:19, 19.99s/epoch, loss=0.55, accuracy=0.876, val_loss=0.995, val_accuracy=0.742, lr=0.01]  66%|██████▌   | 99/150 [33:57<16:59, 19.98s/epoch, loss=0.547, accuracy=0.877, val_loss=0.806, val_accuracy=0.794, lr=0.01] 67%|██████▋   | 100/150 [34:17<16:40, 20.00s/epoch, loss=0.547, accuracy=0.878, val_loss=0.847, val_accuracy=0.784, lr=0.01] 67%|██████▋   | 101/150 [34:37<16:21, 20.03s/epoch, loss=0.546, accuracy=0.879, val_loss=0.691, val_accuracy=0.836, lr=0.01] 68%|██████▊   | 102/150 [34:57<16:03, 20.07s/epoch, loss=0.547, accuracy=0.88, val_loss=1.25, val_accuracy=0.693, lr=0.01]   69%|██████▊   | 103/150 [35:17<15:43, 20.07s/epoch, loss=0.545, accuracy=0.88, val_loss=0.881, val_accuracy=0.776, lr=0.01] 69%|██████▉   | 104/150 [35:37<15:24, 20.09s/epoch, loss=0.547, accuracy=0.88, val_loss=0.822, val_accuracy=0.801, lr=0.01] 70%|███████   | 105/150 [35:58<15:04, 20.09s/epoch, loss=0.549, accuracy=0.88, val_loss=1.08, val_accuracy=0.718, lr=0.01]  71%|███████   | 106/150 [36:18<14:43, 20.07s/epoch, loss=0.545, accuracy=0.881, val_loss=0.86, val_accuracy=0.773, lr=0.00316] 71%|███████▏  | 107/150 [36:38<14:21, 20.04s/epoch, loss=0.545, accuracy=0.882, val_loss=0.724, val_accuracy=0.826, lr=0.01]   72%|███████▏  | 108/150 [36:58<14:02, 20.05s/epoch, loss=0.544, accuracy=0.882, val_loss=0.761, val_accuracy=0.806, lr=0.01] 73%|███████▎  | 109/150 [37:18<13:41, 20.04s/epoch, loss=0.546, accuracy=0.883, val_loss=1.24, val_accuracy=0.686, lr=0.01]  73%|███████▎  | 110/150 [37:37<13:18, 19.96s/epoch, loss=0.549, accuracy=0.881, val_loss=0.818, val_accuracy=0.805, lr=0.01] 74%|███████▍  | 111/150 [37:57<12:56, 19.91s/epoch, loss=0.546, accuracy=0.882, val_loss=0.85, val_accuracy=0.801, lr=0.00316] 75%|███████▍  | 112/150 [38:17<12:37, 19.94s/epoch, loss=0.546, accuracy=0.884, val_loss=0.921, val_accuracy=0.775, lr=0.01]   75%|███████▌  | 113/150 [38:37<12:17, 19.95s/epoch, loss=0.542, accuracy=0.885, val_loss=0.747, val_accuracy=0.814, lr=0.01] 76%|███████▌  | 114/150 [38:57<11:54, 19.84s/epoch, loss=0.542, accuracy=0.884, val_loss=1.32, val_accuracy=0.718, lr=0.01]  77%|███████▋  | 115/150 [39:17<11:35, 19.86s/epoch, loss=0.547, accuracy=0.884, val_loss=0.835, val_accuracy=0.786, lr=0.01] 77%|███████▋  | 116/150 [39:37<11:15, 19.87s/epoch, loss=0.546, accuracy=0.883, val_loss=1.11, val_accuracy=0.736, lr=0.00316] 78%|███████▊  | 117/150 [39:56<10:54, 19.85s/epoch, loss=0.547, accuracy=0.883, val_loss=0.916, val_accuracy=0.773, lr=0.01]   79%|███████▊  | 118/150 [40:16<10:35, 19.86s/epoch, loss=0.544, accuracy=0.885, val_loss=0.828, val_accuracy=0.795, lr=0.01] 79%|███████▉  | 119/150 [40:36<10:13, 19.80s/epoch, loss=0.542, accuracy=0.886, val_loss=0.884, val_accuracy=0.773, lr=0.01] 80%|████████  | 120/150 [40:56<09:54, 19.81s/epoch, loss=0.546, accuracy=0.887, val_loss=0.858, val_accuracy=0.783, lr=0.01] 81%|████████  | 121/150 [41:16<09:35, 19.84s/epoch, loss=0.542, accuracy=0.887, val_loss=0.736, val_accuracy=0.826, lr=0.00316] 81%|████████▏ | 122/150 [41:36<09:16, 19.86s/epoch, loss=0.467, accuracy=0.914, val_loss=0.526, val_accuracy=0.893, lr=0.001]   82%|████████▏ | 123/150 [41:56<08:57, 19.89s/epoch, loss=0.415, accuracy=0.929, val_loss=0.508, val_accuracy=0.897, lr=0.001] 83%|████████▎ | 124/150 [42:15<08:37, 19.91s/epoch, loss=0.397, accuracy=0.933, val_loss=0.501, val_accuracy=0.899, lr=0.001] 83%|████████▎ | 125/150 [42:35<08:14, 19.80s/epoch, loss=0.379, accuracy=0.938, val_loss=0.494, val_accuracy=0.897, lr=0.001] 84%|████████▍ | 126/150 [42:55<07:54, 19.78s/epoch, loss=0.365, accuracy=0.941, val_loss=0.493, val_accuracy=0.901, lr=0.001] 85%|████████▍ | 127/150 [43:15<07:35, 19.79s/epoch, loss=0.356, accuracy=0.942, val_loss=0.491, val_accuracy=0.897, lr=0.001] 85%|████████▌ | 128/150 [43:34<07:15, 19.79s/epoch, loss=0.345, accuracy=0.944, val_loss=0.48, val_accuracy=0.899, lr=0.001]  86%|████████▌ | 129/150 [43:54<06:53, 19.69s/epoch, loss=0.334, accuracy=0.946, val_loss=0.484, val_accuracy=0.898, lr=0.001] 87%|████████▋ | 130/150 [44:13<06:32, 19.63s/epoch, loss=0.325, accuracy=0.947, val_loss=0.464, val_accuracy=0.9, lr=0.001]   87%|████████▋ | 131/150 [44:33<06:13, 19.65s/epoch, loss=0.318, accuracy=0.948, val_loss=0.468, val_accuracy=0.899, lr=0.001] 88%|████████▊ | 132/150 [44:52<05:52, 19.59s/epoch, loss=0.309, accuracy=0.951, val_loss=0.469, val_accuracy=0.899, lr=0.001] 89%|████████▊ | 133/150 [45:12<05:32, 19.58s/epoch, loss=0.303, accuracy=0.952, val_loss=0.468, val_accuracy=0.9, lr=0.001]   89%|████████▉ | 134/150 [45:32<05:13, 19.60s/epoch, loss=0.296, accuracy=0.953, val_loss=0.454, val_accuracy=0.902, lr=0.001] 90%|█████████ | 135/150 [45:51<04:54, 19.64s/epoch, loss=0.288, accuracy=0.953, val_loss=0.46, val_accuracy=0.897, lr=0.001]  91%|█████████ | 136/150 [46:11<04:36, 19.72s/epoch, loss=0.281, accuracy=0.955, val_loss=0.457, val_accuracy=0.898, lr=0.001] 91%|█████████▏| 137/150 [46:31<04:15, 19.63s/epoch, loss=0.273, accuracy=0.956, val_loss=0.448, val_accuracy=0.898, lr=0.001] 92%|█████████▏| 138/150 [46:50<03:55, 19.59s/epoch, loss=0.272, accuracy=0.955, val_loss=0.469, val_accuracy=0.895, lr=0.001] 93%|█████████▎| 139/150 [47:10<03:36, 19.68s/epoch, loss=0.27, accuracy=0.955, val_loss=0.458, val_accuracy=0.898, lr=0.001]  93%|█████████▎| 140/150 [47:30<03:17, 19.73s/epoch, loss=0.261, accuracy=0.957, val_loss=0.48, val_accuracy=0.892, lr=0.001] 94%|█████████▍| 141/150 [47:50<02:58, 19.78s/epoch, loss=0.256, accuracy=0.958, val_loss=0.466, val_accuracy=0.893, lr=0.001] 95%|█████████▍| 142/150 [48:10<02:38, 19.87s/epoch, loss=0.251, accuracy=0.959, val_loss=0.459, val_accuracy=0.895, lr=0.000316] 95%|█████████▌| 143/150 [48:30<02:19, 19.87s/epoch, loss=0.25, accuracy=0.958, val_loss=0.458, val_accuracy=0.896, lr=0.001]     96%|█████████▌| 144/150 [48:50<01:59, 19.97s/epoch, loss=0.247, accuracy=0.958, val_loss=0.448, val_accuracy=0.901, lr=0.001] 97%|█████████▋| 145/150 [49:10<01:39, 19.95s/epoch, loss=0.243, accuracy=0.959, val_loss=0.48, val_accuracy=0.891, lr=0.001]  97%|█████████▋| 146/150 [49:30<01:19, 19.94s/epoch, loss=0.239, accuracy=0.959, val_loss=0.469, val_accuracy=0.888, lr=0.001] 98%|█████████▊| 147/150 [49:50<00:59, 19.98s/epoch, loss=0.235, accuracy=0.96, val_loss=0.463, val_accuracy=0.894, lr=0.001]  99%|█████████▊| 148/150 [50:10<00:39, 19.95s/epoch, loss=0.236, accuracy=0.959, val_loss=0.463, val_accuracy=0.891, lr=0.001] 99%|█████████▉| 149/150 [50:30<00:19, 19.96s/epoch, loss=0.229, accuracy=0.96, val_loss=0.451, val_accuracy=0.894, lr=0.000316]100%|██████████| 150/150 [50:50<00:00, 19.95s/epoch, loss=0.23, accuracy=0.96, val_loss=0.467, val_accuracy=0.888, lr=0.001]    100%|██████████| 150/150 [50:50<00:00, 20.33s/epoch, loss=0.23, accuracy=0.96, val_loss=0.467, val_accuracy=0.888, lr=0.001]
Using real-time data augmentation.
Test score: 0.467165470123291
Test accuracy: 0.8876000046730042


* * * Run SGD for ID = 10_4. * * *


2024-03-05 03:57:49.947660: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 03:57:55.733561: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 03:57:55.734633: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-05 03:57:55.771275: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-03-05 03:57:55.771318: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 03:57:55.776340: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 03:57:55.776381: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-05 03:57:55.780437: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-05 03:57:55.783283: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-05 03:57:55.786914: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-05 03:57:55.788398: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-05 03:57:55.794636: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 03:57:55.795311: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-05 03:57:55.795395: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 03:57:57.057015: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-05 03:57:57.057538: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 03:57:57.058295: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-03-05 03:57:57.058334: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 03:57:57.058371: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 03:57:57.058388: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-05 03:57:57.058404: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-05 03:57:57.058420: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-05 03:57:57.058435: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-05 03:57:57.058450: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-05 03:57:57.058465: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 03:57:57.058896: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-05 03:57:57.058930: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 03:57:57.716248: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-05 03:57:57.716299: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-05 03:57:57.716315: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-05 03:57:57.717239: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11227 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN X (Pascal), pci bus id: 0000:83:00.0, compute capability: 6.1)
{'id': '10_04', 'seed': 4, 'out_folder': 'results/epoch_budget', 'batch_size': 128, 'epochs': 150, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN X (Pascal)'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/150 [00:00<?, ?epoch/s]2024-03-05 03:57:58.570202: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-05 03:57:58.582135: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2600020000 Hz
2024-03-05 03:58:00.557215: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 03:58:00.791301: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 03:58:01.585431: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-05 03:58:01.630136: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/150 [00:57<2:23:42, 57.87s/epoch, loss=2.86, accuracy=0.394, val_loss=2.57, val_accuracy=0.336, lr=0.1]  1%|▏         | 2/150 [01:18<1:28:36, 35.92s/epoch, loss=1.49, accuracy=0.577, val_loss=4.62, val_accuracy=0.267, lr=0.1]  2%|▏         | 3/150 [01:38<1:10:21, 28.71s/epoch, loss=1.31, accuracy=0.66, val_loss=1.97, val_accuracy=0.457, lr=0.1]   3%|▎         | 4/150 [01:58<1:01:34, 25.31s/epoch, loss=1.26, accuracy=0.691, val_loss=3.36, val_accuracy=0.236, lr=0.1]  3%|▎         | 5/150 [02:18<56:44, 23.48s/epoch, loss=1.24, accuracy=0.707, val_loss=2.69, val_accuracy=0.394, lr=0.1]    4%|▍         | 6/150 [02:39<53:51, 22.44s/epoch, loss=1.23, accuracy=0.716, val_loss=1.57, val_accuracy=0.599, lr=0.1]  5%|▍         | 7/150 [02:59<51:42, 21.70s/epoch, loss=1.22, accuracy=0.721, val_loss=1.85, val_accuracy=0.528, lr=0.1]  5%|▌         | 8/150 [03:19<50:07, 21.18s/epoch, loss=1.21, accuracy=0.727, val_loss=1.73, val_accuracy=0.58, lr=0.1]   6%|▌         | 9/150 [03:39<48:53, 20.81s/epoch, loss=1.21, accuracy=0.729, val_loss=1.81, val_accuracy=0.517, lr=0.1]  7%|▋         | 10/150 [03:59<48:01, 20.58s/epoch, loss=1.21, accuracy=0.735, val_loss=1.5, val_accuracy=0.621, lr=0.1]  7%|▋         | 11/150 [04:19<47:13, 20.38s/epoch, loss=1.19, accuracy=0.738, val_loss=2.54, val_accuracy=0.422, lr=0.1]  8%|▊         | 12/150 [04:39<46:32, 20.24s/epoch, loss=1.2, accuracy=0.736, val_loss=3.57, val_accuracy=0.309, lr=0.1]   9%|▊         | 13/150 [04:59<46:02, 20.16s/epoch, loss=1.19, accuracy=0.74, val_loss=3.07, val_accuracy=0.267, lr=0.1]  9%|▉         | 14/150 [05:19<45:36, 20.12s/epoch, loss=1.19, accuracy=0.74, val_loss=1.77, val_accuracy=0.559, lr=0.1] 10%|█         | 15/150 [05:39<45:14, 20.11s/epoch, loss=1.19, accuracy=0.741, val_loss=2.21, val_accuracy=0.46, lr=0.0316] 11%|█         | 16/150 [05:59<44:50, 20.08s/epoch, loss=1.19, accuracy=0.743, val_loss=2.19, val_accuracy=0.498, lr=0.1]   11%|█▏        | 17/150 [06:19<44:25, 20.05s/epoch, loss=1.19, accuracy=0.744, val_loss=1.47, val_accuracy=0.639, lr=0.1] 12%|█▏        | 18/150 [06:39<44:11, 20.08s/epoch, loss=1.19, accuracy=0.744, val_loss=1.78, val_accuracy=0.586, lr=0.1] 13%|█▎        | 19/150 [06:59<43:54, 20.11s/epoch, loss=1.19, accuracy=0.745, val_loss=4.18, val_accuracy=0.389, lr=0.1] 13%|█▎        | 20/150 [07:19<43:29, 20.08s/epoch, loss=1.18, accuracy=0.744, val_loss=1.81, val_accuracy=0.512, lr=0.1] 14%|█▍        | 21/150 [07:39<43:06, 20.05s/epoch, loss=1.17, accuracy=0.749, val_loss=1.6, val_accuracy=0.604, lr=0.1]  15%|█▍        | 22/150 [07:59<42:43, 20.03s/epoch, loss=1.18, accuracy=0.745, val_loss=1.78, val_accuracy=0.563, lr=0.0316] 15%|█▌        | 23/150 [08:19<42:23, 20.02s/epoch, loss=1.17, accuracy=0.746, val_loss=1.57, val_accuracy=0.626, lr=0.1]    16%|█▌        | 24/150 [08:39<41:58, 19.99s/epoch, loss=1.18, accuracy=0.749, val_loss=1.39, val_accuracy=0.67, lr=0.1]  17%|█▋        | 25/150 [08:59<41:33, 19.95s/epoch, loss=1.19, accuracy=0.743, val_loss=4.07, val_accuracy=0.28, lr=0.1] 17%|█▋        | 26/150 [09:19<41:14, 19.96s/epoch, loss=1.18, accuracy=0.747, val_loss=1.54, val_accuracy=0.609, lr=0.1] 18%|█▊        | 27/150 [09:39<40:54, 19.95s/epoch, loss=1.18, accuracy=0.75, val_loss=1.58, val_accuracy=0.611, lr=0.1]  19%|█▊        | 28/150 [09:59<40:30, 19.92s/epoch, loss=1.17, accuracy=0.749, val_loss=1.78, val_accuracy=0.567, lr=0.1] 19%|█▉        | 29/150 [10:19<40:06, 19.88s/epoch, loss=1.18, accuracy=0.747, val_loss=2.1, val_accuracy=0.499, lr=0.0316] 20%|██        | 30/150 [10:38<39:37, 19.81s/epoch, loss=1.17, accuracy=0.749, val_loss=7.94, val_accuracy=0.119, lr=0.1]   21%|██        | 31/150 [10:58<39:19, 19.83s/epoch, loss=1.17, accuracy=0.751, val_loss=2.07, val_accuracy=0.503, lr=0.1] 21%|██▏       | 32/150 [11:18<38:58, 19.82s/epoch, loss=1.17, accuracy=0.752, val_loss=2.39, val_accuracy=0.464, lr=0.1] 22%|██▏       | 33/150 [11:38<38:43, 19.86s/epoch, loss=1.17, accuracy=0.751, val_loss=1.82, val_accuracy=0.58, lr=0.1]  23%|██▎       | 34/150 [11:58<38:19, 19.82s/epoch, loss=1.18, accuracy=0.748, val_loss=1.38, val_accuracy=0.677, lr=0.1] 23%|██▎       | 35/150 [12:17<37:56, 19.79s/epoch, loss=1.17, accuracy=0.75, val_loss=1.32, val_accuracy=0.695, lr=0.1]  24%|██▍       | 36/150 [12:37<37:36, 19.79s/epoch, loss=1.17, accuracy=0.749, val_loss=1.66, val_accuracy=0.592, lr=0.1] 25%|██▍       | 37/150 [12:57<37:22, 19.85s/epoch, loss=1.18, accuracy=0.752, val_loss=2.14, val_accuracy=0.468, lr=0.1] 25%|██▌       | 38/150 [13:17<37:07, 19.89s/epoch, loss=1.17, accuracy=0.752, val_loss=2.79, val_accuracy=0.406, lr=0.1] 26%|██▌       | 39/150 [13:37<36:43, 19.85s/epoch, loss=1.17, accuracy=0.753, val_loss=2.08, val_accuracy=0.534, lr=0.1] 27%|██▋       | 40/150 [13:57<36:21, 19.84s/epoch, loss=1.17, accuracy=0.751, val_loss=2.12, val_accuracy=0.517, lr=0.0316] 27%|██▋       | 41/150 [14:16<36:00, 19.82s/epoch, loss=1.16, accuracy=0.749, val_loss=1.45, val_accuracy=0.648, lr=0.1]    28%|██▊       | 42/150 [14:36<35:42, 19.84s/epoch, loss=1.17, accuracy=0.75, val_loss=1.71, val_accuracy=0.588, lr=0.1]  29%|██▊       | 43/150 [14:56<35:24, 19.86s/epoch, loss=1.16, accuracy=0.754, val_loss=2.29, val_accuracy=0.468, lr=0.1] 29%|██▉       | 44/150 [15:16<34:57, 19.79s/epoch, loss=1.17, accuracy=0.751, val_loss=1.71, val_accuracy=0.565, lr=0.1] 30%|███       | 45/150 [15:36<34:47, 19.88s/epoch, loss=1.17, accuracy=0.752, val_loss=1.37, val_accuracy=0.686, lr=0.0316] 31%|███       | 46/150 [15:56<34:25, 19.86s/epoch, loss=1.16, accuracy=0.752, val_loss=2.15, val_accuracy=0.512, lr=0.1]    31%|███▏      | 47/150 [16:16<34:07, 19.88s/epoch, loss=1.17, accuracy=0.75, val_loss=2.46, val_accuracy=0.467, lr=0.1]  32%|███▏      | 48/150 [16:36<33:52, 19.93s/epoch, loss=1.15, accuracy=0.753, val_loss=4.24, val_accuracy=0.212, lr=0.1] 33%|███▎      | 49/150 [16:56<33:29, 19.90s/epoch, loss=1.16, accuracy=0.752, val_loss=3.02, val_accuracy=0.338, lr=0.1] 33%|███▎      | 50/150 [17:16<33:12, 19.93s/epoch, loss=1.16, accuracy=0.753, val_loss=1.68, val_accuracy=0.581, lr=0.0316] 34%|███▍      | 51/150 [17:35<32:47, 19.88s/epoch, loss=1.17, accuracy=0.752, val_loss=1.52, val_accuracy=0.639, lr=0.1]    35%|███▍      | 52/150 [17:55<32:26, 19.87s/epoch, loss=1.16, accuracy=0.754, val_loss=2.95, val_accuracy=0.343, lr=0.1] 35%|███▌      | 53/150 [18:15<32:12, 19.93s/epoch, loss=1.16, accuracy=0.755, val_loss=1.89, val_accuracy=0.562, lr=0.1] 36%|███▌      | 54/150 [18:35<31:54, 19.95s/epoch, loss=1.16, accuracy=0.753, val_loss=1.95, val_accuracy=0.558, lr=0.1] 37%|███▋      | 55/150 [18:55<31:28, 19.88s/epoch, loss=1.15, accuracy=0.756, val_loss=1.67, val_accuracy=0.612, lr=0.0316] 37%|███▋      | 56/150 [19:15<31:12, 19.92s/epoch, loss=1.15, accuracy=0.756, val_loss=1.63, val_accuracy=0.612, lr=0.1]    38%|███▊      | 57/150 [19:35<30:59, 19.99s/epoch, loss=1.16, accuracy=0.752, val_loss=5.05, val_accuracy=0.184, lr=0.1] 39%|███▊      | 58/150 [19:55<30:42, 20.02s/epoch, loss=1.15, accuracy=0.753, val_loss=1.55, val_accuracy=0.622, lr=0.1] 39%|███▉      | 59/150 [20:15<30:24, 20.04s/epoch, loss=1.15, accuracy=0.754, val_loss=2.42, val_accuracy=0.428, lr=0.1] 40%|████      | 60/150 [20:35<30:04, 20.06s/epoch, loss=1.15, accuracy=0.756, val_loss=1.43, val_accuracy=0.679, lr=0.0316] 41%|████      | 61/150 [20:55<29:40, 20.01s/epoch, loss=1.16, accuracy=0.755, val_loss=2.15, val_accuracy=0.454, lr=0.1]    41%|████▏     | 62/150 [21:16<29:27, 20.08s/epoch, loss=1.16, accuracy=0.754, val_loss=1.61, val_accuracy=0.603, lr=0.1] 42%|████▏     | 63/150 [21:36<29:03, 20.04s/epoch, loss=1.16, accuracy=0.753, val_loss=1.41, val_accuracy=0.678, lr=0.1] 43%|████▎     | 64/150 [21:56<28:45, 20.07s/epoch, loss=1.15, accuracy=0.754, val_loss=1.67, val_accuracy=0.589, lr=0.1] 43%|████▎     | 65/150 [22:16<28:24, 20.05s/epoch, loss=1.15, accuracy=0.755, val_loss=1.57, val_accuracy=0.612, lr=0.0316] 44%|████▍     | 66/150 [22:36<27:59, 19.99s/epoch, loss=1.15, accuracy=0.753, val_loss=1.74, val_accuracy=0.548, lr=0.1]    45%|████▍     | 67/150 [22:55<27:33, 19.92s/epoch, loss=1.15, accuracy=0.753, val_loss=2.28, val_accuracy=0.495, lr=0.1] 45%|████▌     | 68/150 [23:15<27:13, 19.92s/epoch, loss=1.15, accuracy=0.752, val_loss=2.18, val_accuracy=0.442, lr=0.1] 46%|████▌     | 69/150 [23:35<26:57, 19.98s/epoch, loss=1.15, accuracy=0.754, val_loss=2.21, val_accuracy=0.431, lr=0.1] 47%|████▋     | 70/150 [23:55<26:37, 19.97s/epoch, loss=1.15, accuracy=0.757, val_loss=1.9, val_accuracy=0.565, lr=0.0316] 47%|████▋     | 71/150 [24:15<26:21, 20.02s/epoch, loss=1.15, accuracy=0.754, val_loss=1.65, val_accuracy=0.573, lr=0.1]   48%|████▊     | 72/150 [24:36<26:03, 20.05s/epoch, loss=1.16, accuracy=0.75, val_loss=2.17, val_accuracy=0.444, lr=0.1]  49%|████▊     | 73/150 [24:56<25:44, 20.06s/epoch, loss=1.15, accuracy=0.752, val_loss=1.77, val_accuracy=0.546, lr=0.1] 49%|████▉     | 74/150 [25:16<25:24, 20.06s/epoch, loss=1.15, accuracy=0.753, val_loss=1.86, val_accuracy=0.559, lr=0.1] 50%|█████     | 75/150 [25:36<25:01, 20.01s/epoch, loss=1.14, accuracy=0.752, val_loss=2.48, val_accuracy=0.39, lr=0.0316] 51%|█████     | 76/150 [25:55<24:38, 19.98s/epoch, loss=1.15, accuracy=0.754, val_loss=2.21, val_accuracy=0.46, lr=0.1]    51%|█████▏    | 77/150 [26:16<24:19, 19.99s/epoch, loss=1.14, accuracy=0.756, val_loss=1.7, val_accuracy=0.558, lr=0.1] 52%|█████▏    | 78/150 [26:36<24:00, 20.00s/epoch, loss=1.15, accuracy=0.756, val_loss=2.23, val_accuracy=0.455, lr=0.1] 53%|█████▎    | 79/150 [26:55<23:38, 19.98s/epoch, loss=1.15, accuracy=0.754, val_loss=2.37, val_accuracy=0.477, lr=0.1] 53%|█████▎    | 80/150 [27:16<23:22, 20.03s/epoch, loss=1.14, accuracy=0.754, val_loss=1.81, val_accuracy=0.55, lr=0.0316] 54%|█████▍    | 81/150 [27:36<23:01, 20.03s/epoch, loss=1.15, accuracy=0.756, val_loss=1.52, val_accuracy=0.65, lr=0.1]    55%|█████▍    | 82/150 [27:56<22:39, 19.99s/epoch, loss=0.927, accuracy=0.814, val_loss=0.961, val_accuracy=0.78, lr=0.01] 55%|█████▌    | 83/150 [28:15<22:18, 19.97s/epoch, loss=0.744, accuracy=0.848, val_loss=0.776, val_accuracy=0.822, lr=0.01] 56%|█████▌    | 84/150 [28:35<21:53, 19.91s/epoch, loss=0.66, accuracy=0.856, val_loss=0.854, val_accuracy=0.777, lr=0.01]  57%|█████▋    | 85/150 [28:55<21:30, 19.85s/epoch, loss=0.614, accuracy=0.86, val_loss=0.781, val_accuracy=0.798, lr=0.01] 57%|█████▋    | 86/150 [29:15<21:16, 19.95s/epoch, loss=0.591, accuracy=0.862, val_loss=0.725, val_accuracy=0.811, lr=0.01] 58%|█████▊    | 87/150 [29:35<20:55, 19.93s/epoch, loss=0.58, accuracy=0.861, val_loss=0.754, val_accuracy=0.8, lr=0.01]    59%|█████▊    | 88/150 [29:55<20:40, 20.00s/epoch, loss=0.578, accuracy=0.863, val_loss=0.888, val_accuracy=0.771, lr=0.01] 59%|█████▉    | 89/150 [30:15<20:17, 19.95s/epoch, loss=0.57, accuracy=0.865, val_loss=1.14, val_accuracy=0.703, lr=0.01]   60%|██████    | 90/150 [30:35<19:52, 19.88s/epoch, loss=0.569, accuracy=0.866, val_loss=0.918, val_accuracy=0.754, lr=0.01] 61%|██████    | 91/150 [30:54<19:30, 19.84s/epoch, loss=0.567, accuracy=0.867, val_loss=0.753, val_accuracy=0.809, lr=0.00316] 61%|██████▏   | 92/150 [31:14<19:08, 19.80s/epoch, loss=0.567, accuracy=0.868, val_loss=0.797, val_accuracy=0.797, lr=0.01]    62%|██████▏   | 93/150 [31:34<18:47, 19.79s/epoch, loss=0.561, accuracy=0.87, val_loss=0.702, val_accuracy=0.825, lr=0.01]  63%|██████▎   | 94/150 [31:54<18:25, 19.74s/epoch, loss=0.559, accuracy=0.872, val_loss=0.819, val_accuracy=0.791, lr=0.01] 63%|██████▎   | 95/150 [32:14<18:10, 19.83s/epoch, loss=0.56, accuracy=0.873, val_loss=0.784, val_accuracy=0.8, lr=0.01]    64%|██████▍   | 96/150 [32:33<17:46, 19.74s/epoch, loss=0.559, accuracy=0.876, val_loss=0.836, val_accuracy=0.782, lr=0.01] 65%|██████▍   | 97/150 [32:53<17:26, 19.75s/epoch, loss=0.564, accuracy=0.873, val_loss=0.734, val_accuracy=0.815, lr=0.01] 65%|██████▌   | 98/150 [33:13<17:09, 19.80s/epoch, loss=0.557, accuracy=0.876, val_loss=0.68, val_accuracy=0.836, lr=0.01]  66%|██████▌   | 99/150 [33:33<16:48, 19.77s/epoch, loss=0.559, accuracy=0.876, val_loss=0.806, val_accuracy=0.8, lr=0.01]  67%|██████▋   | 100/150 [33:52<16:26, 19.73s/epoch, loss=0.562, accuracy=0.876, val_loss=0.775, val_accuracy=0.803, lr=0.01] 67%|██████▋   | 101/150 [34:12<16:04, 19.67s/epoch, loss=0.558, accuracy=0.878, val_loss=0.809, val_accuracy=0.805, lr=0.01] 68%|██████▊   | 102/150 [34:31<15:45, 19.70s/epoch, loss=0.559, accuracy=0.878, val_loss=0.868, val_accuracy=0.791, lr=0.01] 69%|██████▊   | 103/150 [34:51<15:28, 19.77s/epoch, loss=0.559, accuracy=0.879, val_loss=0.763, val_accuracy=0.809, lr=0.00316] 69%|██████▉   | 104/150 [35:11<15:09, 19.76s/epoch, loss=0.561, accuracy=0.878, val_loss=0.831, val_accuracy=0.793, lr=0.01]    70%|███████   | 105/150 [35:31<14:46, 19.71s/epoch, loss=0.56, accuracy=0.879, val_loss=0.814, val_accuracy=0.801, lr=0.01]  71%|███████   | 106/150 [35:50<14:27, 19.71s/epoch, loss=0.555, accuracy=0.881, val_loss=0.944, val_accuracy=0.764, lr=0.01] 71%|███████▏  | 107/150 [36:10<14:04, 19.65s/epoch, loss=0.558, accuracy=0.882, val_loss=0.827, val_accuracy=0.805, lr=0.01] 72%|███████▏  | 108/150 [36:30<13:45, 19.66s/epoch, loss=0.56, accuracy=0.879, val_loss=0.875, val_accuracy=0.799, lr=0.00316] 73%|███████▎  | 109/150 [36:49<13:23, 19.61s/epoch, loss=0.555, accuracy=0.882, val_loss=0.764, val_accuracy=0.818, lr=0.01]   73%|███████▎  | 110/150 [37:09<13:07, 19.69s/epoch, loss=0.551, accuracy=0.884, val_loss=0.752, val_accuracy=0.825, lr=0.01] 74%|███████▍  | 111/150 [37:29<12:46, 19.66s/epoch, loss=0.558, accuracy=0.883, val_loss=0.79, val_accuracy=0.804, lr=0.01]  75%|███████▍  | 112/150 [37:48<12:27, 19.68s/epoch, loss=0.559, accuracy=0.883, val_loss=0.734, val_accuracy=0.823, lr=0.01] 75%|███████▌  | 113/150 [38:08<12:07, 19.67s/epoch, loss=0.559, accuracy=0.882, val_loss=0.707, val_accuracy=0.83, lr=0.00316] 76%|███████▌  | 114/150 [38:28<11:49, 19.70s/epoch, loss=0.552, accuracy=0.886, val_loss=0.85, val_accuracy=0.804, lr=0.01]    77%|███████▋  | 115/150 [38:47<11:29, 19.70s/epoch, loss=0.554, accuracy=0.883, val_loss=0.753, val_accuracy=0.827, lr=0.01] 77%|███████▋  | 116/150 [39:07<11:08, 19.65s/epoch, loss=0.555, accuracy=0.883, val_loss=0.793, val_accuracy=0.807, lr=0.01] 78%|███████▊  | 117/150 [39:27<10:48, 19.64s/epoch, loss=0.556, accuracy=0.884, val_loss=0.87, val_accuracy=0.785, lr=0.01]  79%|███████▊  | 118/150 [39:46<10:29, 19.67s/epoch, loss=0.552, accuracy=0.885, val_loss=0.869, val_accuracy=0.791, lr=0.00316] 79%|███████▉  | 119/150 [40:06<10:10, 19.70s/epoch, loss=0.557, accuracy=0.882, val_loss=0.857, val_accuracy=0.798, lr=0.01]    80%|████████  | 120/150 [40:26<09:51, 19.73s/epoch, loss=0.557, accuracy=0.883, val_loss=0.881, val_accuracy=0.787, lr=0.01] 81%|████████  | 121/150 [40:46<09:32, 19.73s/epoch, loss=0.561, accuracy=0.883, val_loss=0.692, val_accuracy=0.84, lr=0.01]  81%|████████▏ | 122/150 [41:05<09:13, 19.77s/epoch, loss=0.483, accuracy=0.911, val_loss=0.56, val_accuracy=0.885, lr=0.001] 82%|████████▏ | 123/150 [41:25<08:55, 19.82s/epoch, loss=0.433, accuracy=0.926, val_loss=0.53, val_accuracy=0.894, lr=0.001] 83%|████████▎ | 124/150 [41:45<08:34, 19.79s/epoch, loss=0.407, accuracy=0.934, val_loss=0.524, val_accuracy=0.893, lr=0.001] 83%|████████▎ | 125/150 [42:05<08:15, 19.80s/epoch, loss=0.389, accuracy=0.938, val_loss=0.513, val_accuracy=0.897, lr=0.001] 84%|████████▍ | 126/150 [42:25<07:55, 19.79s/epoch, loss=0.377, accuracy=0.94, val_loss=0.501, val_accuracy=0.897, lr=0.001]  85%|████████▍ | 127/150 [42:45<07:35, 19.81s/epoch, loss=0.365, accuracy=0.942, val_loss=0.507, val_accuracy=0.896, lr=0.001] 85%|████████▌ | 128/150 [43:05<07:17, 19.88s/epoch, loss=0.355, accuracy=0.943, val_loss=0.487, val_accuracy=0.899, lr=0.001] 86%|████████▌ | 129/150 [43:24<06:57, 19.86s/epoch, loss=0.344, accuracy=0.945, val_loss=0.495, val_accuracy=0.899, lr=0.001] 87%|████████▋ | 130/150 [43:44<06:36, 19.85s/epoch, loss=0.335, accuracy=0.947, val_loss=0.487, val_accuracy=0.899, lr=0.001] 87%|████████▋ | 131/150 [44:04<06:15, 19.76s/epoch, loss=0.326, accuracy=0.948, val_loss=0.481, val_accuracy=0.899, lr=0.001] 88%|████████▊ | 132/150 [44:23<05:55, 19.72s/epoch, loss=0.316, accuracy=0.951, val_loss=0.502, val_accuracy=0.895, lr=0.001] 89%|████████▊ | 133/150 [44:43<05:34, 19.70s/epoch, loss=0.307, accuracy=0.953, val_loss=0.473, val_accuracy=0.9, lr=0.001]   89%|████████▉ | 134/150 [45:03<05:14, 19.65s/epoch, loss=0.3, accuracy=0.953, val_loss=0.494, val_accuracy=0.893, lr=0.001] 90%|█████████ | 135/150 [45:22<04:54, 19.67s/epoch, loss=0.293, accuracy=0.954, val_loss=0.463, val_accuracy=0.9, lr=0.001] 91%|█████████ | 136/150 [45:42<04:35, 19.66s/epoch, loss=0.291, accuracy=0.954, val_loss=0.469, val_accuracy=0.899, lr=0.001] 91%|█████████▏| 137/150 [46:02<04:15, 19.65s/epoch, loss=0.282, accuracy=0.956, val_loss=0.481, val_accuracy=0.895, lr=0.001] 92%|█████████▏| 138/150 [46:21<03:55, 19.64s/epoch, loss=0.278, accuracy=0.956, val_loss=0.465, val_accuracy=0.898, lr=0.001] 93%|█████████▎| 139/150 [46:41<03:36, 19.64s/epoch, loss=0.272, accuracy=0.956, val_loss=0.475, val_accuracy=0.895, lr=0.001] 93%|█████████▎| 140/150 [47:00<03:16, 19.63s/epoch, loss=0.265, accuracy=0.958, val_loss=0.454, val_accuracy=0.899, lr=0.001] 94%|█████████▍| 141/150 [47:20<02:56, 19.64s/epoch, loss=0.259, accuracy=0.96, val_loss=0.464, val_accuracy=0.894, lr=0.001]  95%|█████████▍| 142/150 [47:40<02:36, 19.60s/epoch, loss=0.255, accuracy=0.959, val_loss=0.47, val_accuracy=0.897, lr=0.001] 95%|█████████▌| 143/150 [47:59<02:16, 19.53s/epoch, loss=0.253, accuracy=0.958, val_loss=0.471, val_accuracy=0.894, lr=0.001] 96%|█████████▌| 144/150 [48:18<01:56, 19.50s/epoch, loss=0.25, accuracy=0.959, val_loss=0.458, val_accuracy=0.897, lr=0.001]  97%|█████████▋| 145/150 [48:38<01:37, 19.46s/epoch, loss=0.243, accuracy=0.961, val_loss=0.474, val_accuracy=0.892, lr=0.000316] 97%|█████████▋| 146/150 [48:57<01:17, 19.40s/epoch, loss=0.243, accuracy=0.96, val_loss=0.474, val_accuracy=0.895, lr=0.001]     98%|█████████▊| 147/150 [49:17<00:58, 19.49s/epoch, loss=0.24, accuracy=0.96, val_loss=0.458, val_accuracy=0.897, lr=0.001]  99%|█████████▊| 148/150 [49:37<00:39, 19.58s/epoch, loss=0.238, accuracy=0.96, val_loss=0.455, val_accuracy=0.895, lr=0.001] 99%|█████████▉| 149/150 [49:56<00:19, 19.59s/epoch, loss=0.234, accuracy=0.962, val_loss=0.458, val_accuracy=0.897, lr=0.001]100%|██████████| 150/150 [50:16<00:00, 19.60s/epoch, loss=0.232, accuracy=0.961, val_loss=0.471, val_accuracy=0.892, lr=0.000316]100%|██████████| 150/150 [50:16<00:00, 20.11s/epoch, loss=0.232, accuracy=0.961, val_loss=0.471, val_accuracy=0.892, lr=0.000316]
Using real-time data augmentation.
Test score: 0.4713016152381897
Test accuracy: 0.8917999863624573


* * * Run SGD for ID = 10_5. * * *


2024-03-05 04:48:19.466301: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 04:48:22.061595: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 04:48:22.062711: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-05 04:48:22.102529: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-03-05 04:48:22.102581: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 04:48:22.105278: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 04:48:22.105336: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-05 04:48:22.107564: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-05 04:48:22.108333: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-05 04:48:22.110750: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-05 04:48:22.112129: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-05 04:48:22.116579: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 04:48:22.117195: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-05 04:48:22.117301: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 04:48:23.366637: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-05 04:48:23.367230: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 04:48:23.367951: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-03-05 04:48:23.368004: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 04:48:23.368041: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 04:48:23.368059: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-05 04:48:23.368075: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-05 04:48:23.368092: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-05 04:48:23.368108: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-05 04:48:23.368123: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-05 04:48:23.368139: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 04:48:23.368554: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-05 04:48:23.368586: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 04:48:24.036127: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-05 04:48:24.036181: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-05 04:48:24.036190: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-05 04:48:24.037092: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11227 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN X (Pascal), pci bus id: 0000:83:00.0, compute capability: 6.1)
{'id': '10_05', 'seed': 5, 'out_folder': 'results/epoch_budget', 'batch_size': 128, 'epochs': 150, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN X (Pascal)'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/150 [00:00<?, ?epoch/s]2024-03-05 04:48:24.906999: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-05 04:48:24.907501: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2600020000 Hz
2024-03-05 04:48:26.959797: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 04:48:27.182136: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 04:48:27.942857: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-05 04:48:28.000571: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/150 [01:03<2:38:51, 63.97s/epoch, loss=3, accuracy=0.331, val_loss=2.01, val_accuracy=0.365, lr=0.1]  1%|▏         | 2/150 [01:24<1:34:50, 38.45s/epoch, loss=1.53, accuracy=0.554, val_loss=1.98, val_accuracy=0.415, lr=0.1]  2%|▏         | 3/150 [01:44<1:13:40, 30.07s/epoch, loss=1.34, accuracy=0.645, val_loss=3.59, val_accuracy=0.32, lr=0.1]   3%|▎         | 4/150 [02:04<1:03:45, 26.20s/epoch, loss=1.29, accuracy=0.68, val_loss=2.04, val_accuracy=0.505, lr=0.1]  3%|▎         | 5/150 [02:25<58:06, 24.04s/epoch, loss=1.25, accuracy=0.701, val_loss=1.52, val_accuracy=0.61, lr=0.1]    4%|▍         | 6/150 [02:45<54:38, 22.77s/epoch, loss=1.24, accuracy=0.71, val_loss=2.03, val_accuracy=0.526, lr=0.1]  5%|▍         | 7/150 [03:05<52:07, 21.87s/epoch, loss=1.21, accuracy=0.719, val_loss=1.6, val_accuracy=0.598, lr=0.1]  5%|▌         | 8/150 [03:25<50:21, 21.28s/epoch, loss=1.21, accuracy=0.724, val_loss=2.88, val_accuracy=0.396, lr=0.1]  6%|▌         | 9/150 [03:45<49:04, 20.88s/epoch, loss=1.2, accuracy=0.73, val_loss=1.46, val_accuracy=0.638, lr=0.1]    7%|▋         | 10/150 [04:05<48:02, 20.59s/epoch, loss=1.19, accuracy=0.736, val_loss=1.91, val_accuracy=0.525, lr=0.1]  7%|▋         | 11/150 [04:25<47:16, 20.40s/epoch, loss=1.19, accuracy=0.735, val_loss=2.2, val_accuracy=0.404, lr=0.1]   8%|▊         | 12/150 [04:45<46:36, 20.27s/epoch, loss=1.18, accuracy=0.737, val_loss=1.57, val_accuracy=0.607, lr=0.1]  9%|▊         | 13/150 [05:05<46:02, 20.17s/epoch, loss=1.17, accuracy=0.741, val_loss=1.47, val_accuracy=0.654, lr=0.1]  9%|▉         | 14/150 [05:25<45:37, 20.13s/epoch, loss=1.17, accuracy=0.743, val_loss=1.97, val_accuracy=0.511, lr=0.0316] 10%|█         | 15/150 [05:45<45:13, 20.10s/epoch, loss=1.17, accuracy=0.743, val_loss=4.37, val_accuracy=0.307, lr=0.1]    11%|█         | 16/150 [06:05<44:48, 20.07s/epoch, loss=1.17, accuracy=0.745, val_loss=2.69, val_accuracy=0.318, lr=0.1] 11%|█▏        | 17/150 [06:25<44:32, 20.09s/epoch, loss=1.17, accuracy=0.744, val_loss=1.63, val_accuracy=0.577, lr=0.1] 12%|█▏        | 18/150 [06:45<44:16, 20.13s/epoch, loss=1.16, accuracy=0.746, val_loss=2.66, val_accuracy=0.387, lr=0.1] 13%|█▎        | 19/150 [07:05<43:49, 20.07s/epoch, loss=1.16, accuracy=0.749, val_loss=1.66, val_accuracy=0.583, lr=0.0316] 13%|█▎        | 20/150 [07:25<43:27, 20.06s/epoch, loss=1.15, accuracy=0.749, val_loss=1.46, val_accuracy=0.653, lr=0.1]    14%|█▍        | 21/150 [07:45<43:09, 20.07s/epoch, loss=1.15, accuracy=0.751, val_loss=1.99, val_accuracy=0.492, lr=0.1] 15%|█▍        | 22/150 [08:06<42:54, 20.12s/epoch, loss=1.15, accuracy=0.75, val_loss=3.59, val_accuracy=0.31, lr=0.1]   15%|█▌        | 23/150 [08:26<42:45, 20.20s/epoch, loss=1.15, accuracy=0.75, val_loss=2.19, val_accuracy=0.475, lr=0.1] 16%|█▌        | 24/150 [08:46<42:25, 20.20s/epoch, loss=1.14, accuracy=0.752, val_loss=1.5, val_accuracy=0.609, lr=0.1] 17%|█▋        | 25/150 [09:06<42:07, 20.22s/epoch, loss=1.14, accuracy=0.753, val_loss=1.75, val_accuracy=0.551, lr=0.0316] 17%|█▋        | 26/150 [09:26<41:43, 20.19s/epoch, loss=1.14, accuracy=0.754, val_loss=2.55, val_accuracy=0.346, lr=0.1]    18%|█▊        | 27/150 [09:47<41:23, 20.19s/epoch, loss=1.14, accuracy=0.754, val_loss=1.77, val_accuracy=0.581, lr=0.1] 19%|█▊        | 28/150 [10:07<41:00, 20.17s/epoch, loss=1.14, accuracy=0.751, val_loss=1.98, val_accuracy=0.526, lr=0.1] 19%|█▉        | 29/150 [10:27<40:39, 20.16s/epoch, loss=1.14, accuracy=0.757, val_loss=1.78, val_accuracy=0.554, lr=0.1] 20%|██        | 30/150 [10:47<40:27, 20.23s/epoch, loss=1.14, accuracy=0.752, val_loss=1.46, val_accuracy=0.664, lr=0.0316] 21%|██        | 31/150 [11:08<40:06, 20.22s/epoch, loss=1.13, accuracy=0.756, val_loss=1.88, val_accuracy=0.508, lr=0.1]    21%|██▏       | 32/150 [11:28<39:48, 20.24s/epoch, loss=1.13, accuracy=0.756, val_loss=1.81, val_accuracy=0.502, lr=0.1] 22%|██▏       | 33/150 [11:48<39:28, 20.24s/epoch, loss=1.13, accuracy=0.755, val_loss=2.79, val_accuracy=0.36, lr=0.1]  23%|██▎       | 34/150 [12:08<39:09, 20.26s/epoch, loss=1.12, accuracy=0.757, val_loss=1.76, val_accuracy=0.57, lr=0.1] 23%|██▎       | 35/150 [12:29<38:49, 20.26s/epoch, loss=1.12, accuracy=0.756, val_loss=2.65, val_accuracy=0.375, lr=0.0316] 24%|██▍       | 36/150 [12:49<38:25, 20.23s/epoch, loss=1.12, accuracy=0.757, val_loss=1.83, val_accuracy=0.563, lr=0.1]    25%|██▍       | 37/150 [13:09<38:07, 20.24s/epoch, loss=1.12, accuracy=0.757, val_loss=1.73, val_accuracy=0.586, lr=0.1] 25%|██▌       | 38/150 [13:29<37:46, 20.24s/epoch, loss=1.12, accuracy=0.758, val_loss=1.86, val_accuracy=0.479, lr=0.1] 26%|██▌       | 39/150 [13:50<37:29, 20.26s/epoch, loss=1.12, accuracy=0.759, val_loss=2.37, val_accuracy=0.454, lr=0.1] 27%|██▋       | 40/150 [14:10<37:08, 20.26s/epoch, loss=1.12, accuracy=0.756, val_loss=2.08, val_accuracy=0.485, lr=0.0316] 27%|██▋       | 41/150 [14:30<36:43, 20.22s/epoch, loss=1.11, accuracy=0.756, val_loss=1.78, val_accuracy=0.527, lr=0.1]    28%|██▊       | 42/150 [14:50<36:21, 20.20s/epoch, loss=1.12, accuracy=0.756, val_loss=2.06, val_accuracy=0.483, lr=0.1] 29%|██▊       | 43/150 [15:11<36:10, 20.28s/epoch, loss=1.12, accuracy=0.757, val_loss=1.54, val_accuracy=0.601, lr=0.1] 29%|██▉       | 44/150 [15:31<35:48, 20.27s/epoch, loss=1.12, accuracy=0.757, val_loss=1.35, val_accuracy=0.679, lr=0.1] 30%|███       | 45/150 [15:51<35:24, 20.23s/epoch, loss=1.12, accuracy=0.756, val_loss=2.01, val_accuracy=0.462, lr=0.1] 31%|███       | 46/150 [16:11<34:56, 20.16s/epoch, loss=1.12, accuracy=0.757, val_loss=1.69, val_accuracy=0.587, lr=0.1] 31%|███▏      | 47/150 [16:31<34:35, 20.15s/epoch, loss=1.12, accuracy=0.757, val_loss=2.98, val_accuracy=0.372, lr=0.1] 32%|███▏      | 48/150 [16:51<34:15, 20.15s/epoch, loss=1.12, accuracy=0.756, val_loss=2.01, val_accuracy=0.496, lr=0.1] 33%|███▎      | 49/150 [17:11<33:49, 20.09s/epoch, loss=1.12, accuracy=0.758, val_loss=5.67, val_accuracy=0.204, lr=0.0316] 33%|███▎      | 50/150 [17:31<33:32, 20.13s/epoch, loss=1.12, accuracy=0.758, val_loss=1.76, val_accuracy=0.548, lr=0.1]    34%|███▍      | 51/150 [17:52<33:13, 20.13s/epoch, loss=1.12, accuracy=0.758, val_loss=1.83, val_accuracy=0.556, lr=0.1] 35%|███▍      | 52/150 [18:12<32:54, 20.15s/epoch, loss=1.11, accuracy=0.76, val_loss=2.06, val_accuracy=0.447, lr=0.1]  35%|███▌      | 53/150 [18:32<32:44, 20.25s/epoch, loss=1.11, accuracy=0.76, val_loss=2.09, val_accuracy=0.506, lr=0.1] 36%|███▌      | 54/150 [18:53<32:27, 20.28s/epoch, loss=1.11, accuracy=0.759, val_loss=3.19, val_accuracy=0.245, lr=0.0316] 37%|███▋      | 55/150 [19:13<32:12, 20.34s/epoch, loss=1.1, accuracy=0.759, val_loss=1.68, val_accuracy=0.555, lr=0.1]     37%|███▋      | 56/150 [19:33<31:49, 20.31s/epoch, loss=1.11, accuracy=0.757, val_loss=1.86, val_accuracy=0.535, lr=0.1] 38%|███▊      | 57/150 [19:53<31:24, 20.27s/epoch, loss=1.11, accuracy=0.759, val_loss=1.83, val_accuracy=0.578, lr=0.1] 39%|███▊      | 58/150 [20:14<31:03, 20.25s/epoch, loss=1.1, accuracy=0.756, val_loss=4.1, val_accuracy=0.252, lr=0.1]   39%|███▉      | 59/150 [20:34<30:51, 20.35s/epoch, loss=1.11, accuracy=0.757, val_loss=2.49, val_accuracy=0.367, lr=0.0316] 40%|████      | 60/150 [20:55<30:35, 20.40s/epoch, loss=1.1, accuracy=0.761, val_loss=1.86, val_accuracy=0.515, lr=0.1]     41%|████      | 61/150 [21:15<30:11, 20.35s/epoch, loss=1.11, accuracy=0.757, val_loss=2.11, val_accuracy=0.529, lr=0.1] 41%|████▏     | 62/150 [21:35<29:47, 20.31s/epoch, loss=1.11, accuracy=0.76, val_loss=3.77, val_accuracy=0.383, lr=0.1]  42%|████▏     | 63/150 [21:55<29:20, 20.24s/epoch, loss=1.1, accuracy=0.761, val_loss=2.46, val_accuracy=0.356, lr=0.1] 43%|████▎     | 64/150 [22:16<29:00, 20.24s/epoch, loss=1.11, accuracy=0.758, val_loss=2.01, val_accuracy=0.454, lr=0.0316] 43%|████▎     | 65/150 [22:36<28:34, 20.17s/epoch, loss=1.11, accuracy=0.758, val_loss=2.49, val_accuracy=0.367, lr=0.1]    44%|████▍     | 66/150 [22:56<28:13, 20.16s/epoch, loss=1.11, accuracy=0.758, val_loss=2.2, val_accuracy=0.393, lr=0.1]  45%|████▍     | 67/150 [23:16<27:52, 20.15s/epoch, loss=1.1, accuracy=0.761, val_loss=2.45, val_accuracy=0.403, lr=0.1] 45%|████▌     | 68/150 [23:36<27:33, 20.17s/epoch, loss=1.1, accuracy=0.761, val_loss=2, val_accuracy=0.517, lr=0.1]    46%|████▌     | 69/150 [23:56<27:10, 20.13s/epoch, loss=1.1, accuracy=0.761, val_loss=2.01, val_accuracy=0.449, lr=0.0316] 47%|████▋     | 70/150 [24:16<26:50, 20.13s/epoch, loss=1.1, accuracy=0.757, val_loss=2.1, val_accuracy=0.505, lr=0.1]     47%|████▋     | 71/150 [24:36<26:25, 20.07s/epoch, loss=1.1, accuracy=0.761, val_loss=4.09, val_accuracy=0.351, lr=0.1] 48%|████▊     | 72/150 [24:56<26:05, 20.08s/epoch, loss=1.11, accuracy=0.759, val_loss=3.75, val_accuracy=0.262, lr=0.1] 49%|████▊     | 73/150 [25:16<25:43, 20.05s/epoch, loss=1.11, accuracy=0.757, val_loss=1.55, val_accuracy=0.632, lr=0.1] 49%|████▉     | 74/150 [25:36<25:26, 20.09s/epoch, loss=1.1, accuracy=0.761, val_loss=7.04, val_accuracy=0.211, lr=0.0316] 50%|█████     | 75/150 [25:57<25:07, 20.10s/epoch, loss=1.1, accuracy=0.759, val_loss=5.84, val_accuracy=0.206, lr=0.1]    51%|█████     | 76/150 [26:17<24:51, 20.16s/epoch, loss=1.1, accuracy=0.76, val_loss=3.22, val_accuracy=0.346, lr=0.1]  51%|█████▏    | 77/150 [26:37<24:29, 20.14s/epoch, loss=1.11, accuracy=0.756, val_loss=1.93, val_accuracy=0.538, lr=0.1] 52%|█████▏    | 78/150 [26:57<24:10, 20.15s/epoch, loss=1.1, accuracy=0.761, val_loss=3.71, val_accuracy=0.31, lr=0.1]   53%|█████▎    | 79/150 [27:17<23:51, 20.16s/epoch, loss=1.11, accuracy=0.759, val_loss=1.94, val_accuracy=0.522, lr=0.0316] 53%|█████▎    | 80/150 [27:38<23:33, 20.19s/epoch, loss=1.11, accuracy=0.757, val_loss=2.66, val_accuracy=0.359, lr=0.1]    54%|█████▍    | 81/150 [27:58<23:11, 20.17s/epoch, loss=1.11, accuracy=0.757, val_loss=1.73, val_accuracy=0.549, lr=0.1] 55%|█████▍    | 82/150 [28:18<22:51, 20.17s/epoch, loss=0.899, accuracy=0.816, val_loss=0.903, val_accuracy=0.798, lr=0.01] 55%|█████▌    | 83/150 [28:38<22:33, 20.21s/epoch, loss=0.721, accuracy=0.849, val_loss=0.8, val_accuracy=0.812, lr=0.01]   56%|█████▌    | 84/150 [28:58<22:16, 20.25s/epoch, loss=0.641, accuracy=0.857, val_loss=0.782, val_accuracy=0.797, lr=0.01] 57%|█████▋    | 85/150 [29:18<21:48, 20.14s/epoch, loss=0.599, accuracy=0.861, val_loss=0.791, val_accuracy=0.797, lr=0.01] 57%|█████▋    | 86/150 [29:39<21:30, 20.17s/epoch, loss=0.576, accuracy=0.862, val_loss=0.926, val_accuracy=0.767, lr=0.01] 58%|█████▊    | 87/150 [29:59<21:11, 20.19s/epoch, loss=0.569, accuracy=0.862, val_loss=0.937, val_accuracy=0.748, lr=0.01] 59%|█████▊    | 88/150 [30:19<20:49, 20.15s/epoch, loss=0.563, accuracy=0.863, val_loss=0.879, val_accuracy=0.744, lr=0.01] 59%|█████▉    | 89/150 [30:39<20:26, 20.11s/epoch, loss=0.559, accuracy=0.866, val_loss=0.907, val_accuracy=0.75, lr=0.00316] 60%|██████    | 90/150 [30:59<20:08, 20.14s/epoch, loss=0.553, accuracy=0.867, val_loss=0.998, val_accuracy=0.722, lr=0.01]   61%|██████    | 91/150 [31:19<19:51, 20.19s/epoch, loss=0.554, accuracy=0.866, val_loss=0.747, val_accuracy=0.802, lr=0.01] 61%|██████▏   | 92/150 [31:39<19:28, 20.15s/epoch, loss=0.552, accuracy=0.87, val_loss=0.725, val_accuracy=0.811, lr=0.01]  62%|██████▏   | 93/150 [31:59<19:05, 20.09s/epoch, loss=0.546, accuracy=0.871, val_loss=1.09, val_accuracy=0.71, lr=0.01]  63%|██████▎   | 94/150 [32:20<18:48, 20.16s/epoch, loss=0.551, accuracy=0.871, val_loss=0.855, val_accuracy=0.788, lr=0.01] 63%|██████▎   | 95/150 [32:40<18:29, 20.17s/epoch, loss=0.546, accuracy=0.873, val_loss=0.968, val_accuracy=0.74, lr=0.01]  64%|██████▍   | 96/150 [33:00<18:09, 20.18s/epoch, loss=0.553, accuracy=0.872, val_loss=0.967, val_accuracy=0.743, lr=0.01] 65%|██████▍   | 97/150 [33:20<17:47, 20.14s/epoch, loss=0.552, accuracy=0.874, val_loss=0.902, val_accuracy=0.773, lr=0.00316] 65%|██████▌   | 98/150 [33:40<17:27, 20.15s/epoch, loss=0.548, accuracy=0.875, val_loss=0.838, val_accuracy=0.779, lr=0.01]    66%|██████▌   | 99/150 [34:01<17:09, 20.18s/epoch, loss=0.55, accuracy=0.876, val_loss=0.786, val_accuracy=0.805, lr=0.01]  67%|██████▋   | 100/150 [34:21<16:52, 20.25s/epoch, loss=0.548, accuracy=0.876, val_loss=1.02, val_accuracy=0.725, lr=0.01] 67%|██████▋   | 101/150 [34:41<16:31, 20.24s/epoch, loss=0.549, accuracy=0.877, val_loss=1.1, val_accuracy=0.725, lr=0.01]  68%|██████▊   | 102/150 [35:01<16:10, 20.23s/epoch, loss=0.549, accuracy=0.875, val_loss=0.994, val_accuracy=0.753, lr=0.00316] 69%|██████▊   | 103/150 [35:22<15:49, 20.21s/epoch, loss=0.544, accuracy=0.878, val_loss=0.866, val_accuracy=0.777, lr=0.01]    69%|██████▉   | 104/150 [35:42<15:31, 20.25s/epoch, loss=0.545, accuracy=0.879, val_loss=0.931, val_accuracy=0.757, lr=0.01] 70%|███████   | 105/150 [36:02<15:07, 20.18s/epoch, loss=0.545, accuracy=0.878, val_loss=0.945, val_accuracy=0.762, lr=0.01] 71%|███████   | 106/150 [36:22<14:46, 20.16s/epoch, loss=0.549, accuracy=0.878, val_loss=1.06, val_accuracy=0.735, lr=0.01]  71%|███████▏  | 107/150 [36:42<14:24, 20.11s/epoch, loss=0.549, accuracy=0.879, val_loss=0.847, val_accuracy=0.779, lr=0.00316] 72%|███████▏  | 108/150 [37:02<14:05, 20.13s/epoch, loss=0.547, accuracy=0.881, val_loss=0.957, val_accuracy=0.761, lr=0.01]    73%|███████▎  | 109/150 [37:22<13:45, 20.13s/epoch, loss=0.546, accuracy=0.881, val_loss=0.828, val_accuracy=0.802, lr=0.01] 73%|███████▎  | 110/150 [37:42<13:24, 20.12s/epoch, loss=0.546, accuracy=0.88, val_loss=1.06, val_accuracy=0.742, lr=0.01]   74%|███████▍  | 111/150 [38:03<13:05, 20.15s/epoch, loss=0.544, accuracy=0.882, val_loss=0.811, val_accuracy=0.799, lr=0.01] 75%|███████▍  | 112/150 [38:23<12:45, 20.14s/epoch, loss=0.546, accuracy=0.881, val_loss=0.927, val_accuracy=0.76, lr=0.00316] 75%|███████▌  | 113/150 [38:43<12:24, 20.12s/epoch, loss=0.545, accuracy=0.884, val_loss=0.818, val_accuracy=0.801, lr=0.01]   76%|███████▌  | 114/150 [39:03<12:05, 20.14s/epoch, loss=0.546, accuracy=0.883, val_loss=0.828, val_accuracy=0.804, lr=0.01] 77%|███████▋  | 115/150 [39:23<11:42, 20.09s/epoch, loss=0.549, accuracy=0.881, val_loss=0.798, val_accuracy=0.803, lr=0.01] 77%|███████▋  | 116/150 [39:43<11:22, 20.06s/epoch, loss=0.546, accuracy=0.882, val_loss=0.946, val_accuracy=0.776, lr=0.01] 78%|███████▊  | 117/150 [40:03<11:00, 20.02s/epoch, loss=0.546, accuracy=0.883, val_loss=0.822, val_accuracy=0.801, lr=0.00316] 79%|███████▊  | 118/150 [40:23<10:38, 19.96s/epoch, loss=0.542, accuracy=0.884, val_loss=0.744, val_accuracy=0.818, lr=0.01]    79%|███████▉  | 119/150 [40:43<10:16, 19.90s/epoch, loss=0.546, accuracy=0.882, val_loss=1.06, val_accuracy=0.751, lr=0.01]  80%|████████  | 120/150 [41:03<09:58, 19.97s/epoch, loss=0.547, accuracy=0.883, val_loss=0.745, val_accuracy=0.82, lr=0.01] 81%|████████  | 121/150 [41:22<09:37, 19.92s/epoch, loss=0.549, accuracy=0.881, val_loss=1.03, val_accuracy=0.753, lr=0.01] 81%|████████▏ | 122/150 [41:42<09:18, 19.93s/epoch, loss=0.475, accuracy=0.909, val_loss=0.533, val_accuracy=0.89, lr=0.001] 82%|████████▏ | 123/150 [42:02<08:57, 19.92s/epoch, loss=0.422, accuracy=0.925, val_loss=0.513, val_accuracy=0.895, lr=0.001] 83%|████████▎ | 124/150 [42:22<08:37, 19.92s/epoch, loss=0.4, accuracy=0.932, val_loss=0.503, val_accuracy=0.898, lr=0.001]   83%|████████▎ | 125/150 [42:42<08:17, 19.90s/epoch, loss=0.382, accuracy=0.936, val_loss=0.503, val_accuracy=0.896, lr=0.001] 84%|████████▍ | 126/150 [43:02<07:57, 19.88s/epoch, loss=0.371, accuracy=0.937, val_loss=0.505, val_accuracy=0.893, lr=0.001] 85%|████████▍ | 127/150 [43:22<07:38, 19.93s/epoch, loss=0.36, accuracy=0.94, val_loss=0.495, val_accuracy=0.897, lr=0.001]   85%|████████▌ | 128/150 [43:42<07:18, 19.95s/epoch, loss=0.348, accuracy=0.942, val_loss=0.478, val_accuracy=0.902, lr=0.001] 86%|████████▌ | 129/150 [44:02<06:59, 19.98s/epoch, loss=0.338, accuracy=0.944, val_loss=0.476, val_accuracy=0.896, lr=0.001] 87%|████████▋ | 130/150 [44:22<06:41, 20.07s/epoch, loss=0.328, accuracy=0.946, val_loss=0.469, val_accuracy=0.901, lr=0.001] 87%|████████▋ | 131/150 [44:42<06:20, 20.03s/epoch, loss=0.323, accuracy=0.946, val_loss=0.474, val_accuracy=0.9, lr=0.001]   88%|████████▊ | 132/150 [45:02<05:59, 19.96s/epoch, loss=0.311, accuracy=0.948, val_loss=0.475, val_accuracy=0.896, lr=0.001] 89%|████████▊ | 133/150 [45:22<05:38, 19.89s/epoch, loss=0.306, accuracy=0.949, val_loss=0.468, val_accuracy=0.894, lr=0.001] 89%|████████▉ | 134/150 [45:42<05:18, 19.88s/epoch, loss=0.3, accuracy=0.951, val_loss=0.476, val_accuracy=0.894, lr=0.001]   90%|█████████ | 135/150 [46:01<04:58, 19.87s/epoch, loss=0.294, accuracy=0.951, val_loss=0.472, val_accuracy=0.895, lr=0.001] 91%|█████████ | 136/150 [46:21<04:38, 19.86s/epoch, loss=0.288, accuracy=0.952, val_loss=0.469, val_accuracy=0.894, lr=0.001] 91%|█████████▏| 137/150 [46:41<04:16, 19.74s/epoch, loss=0.28, accuracy=0.953, val_loss=0.464, val_accuracy=0.896, lr=0.001]  92%|█████████▏| 138/150 [47:00<03:56, 19.71s/epoch, loss=0.276, accuracy=0.952, val_loss=0.474, val_accuracy=0.89, lr=0.001] 93%|█████████▎| 139/150 [47:20<03:36, 19.72s/epoch, loss=0.271, accuracy=0.954, val_loss=0.449, val_accuracy=0.899, lr=0.001] 93%|█████████▎| 140/150 [47:40<03:17, 19.70s/epoch, loss=0.268, accuracy=0.954, val_loss=0.472, val_accuracy=0.894, lr=0.001] 94%|█████████▍| 141/150 [47:59<02:57, 19.69s/epoch, loss=0.26, accuracy=0.956, val_loss=0.47, val_accuracy=0.895, lr=0.001]   95%|█████████▍| 142/150 [48:19<02:37, 19.69s/epoch, loss=0.258, accuracy=0.955, val_loss=0.476, val_accuracy=0.888, lr=0.001] 95%|█████████▌| 143/150 [48:39<02:17, 19.69s/epoch, loss=0.254, accuracy=0.956, val_loss=0.481, val_accuracy=0.886, lr=0.001] 96%|█████████▌| 144/150 [48:59<01:58, 19.70s/epoch, loss=0.25, accuracy=0.956, val_loss=0.441, val_accuracy=0.897, lr=0.001]  97%|█████████▋| 145/150 [49:18<01:38, 19.72s/epoch, loss=0.245, accuracy=0.957, val_loss=0.466, val_accuracy=0.891, lr=0.001] 97%|█████████▋| 146/150 [49:38<01:18, 19.71s/epoch, loss=0.242, accuracy=0.958, val_loss=0.488, val_accuracy=0.888, lr=0.001] 98%|█████████▊| 147/150 [49:58<00:59, 19.73s/epoch, loss=0.24, accuracy=0.957, val_loss=0.48, val_accuracy=0.884, lr=0.001]   99%|█████████▊| 148/150 [50:18<00:39, 19.76s/epoch, loss=0.236, accuracy=0.959, val_loss=0.447, val_accuracy=0.898, lr=0.001] 99%|█████████▉| 149/150 [50:37<00:19, 19.78s/epoch, loss=0.236, accuracy=0.958, val_loss=0.485, val_accuracy=0.883, lr=0.000316]100%|██████████| 150/150 [50:57<00:00, 19.79s/epoch, loss=0.234, accuracy=0.958, val_loss=0.462, val_accuracy=0.892, lr=0.001]   100%|██████████| 150/150 [50:57<00:00, 20.39s/epoch, loss=0.234, accuracy=0.958, val_loss=0.462, val_accuracy=0.892, lr=0.001]
Using real-time data augmentation.
Test score: 0.4624955952167511
Test accuracy: 0.892300009727478


* * * Run SGD for ID = 10_6. * * *


2024-03-05 05:39:26.366681: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 05:39:28.905584: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 05:39:28.906719: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-05 05:39:28.944386: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-03-05 05:39:28.944432: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 05:39:28.947168: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 05:39:28.947206: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-05 05:39:28.949450: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-05 05:39:28.950133: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-05 05:39:28.952468: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-05 05:39:28.953806: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-05 05:39:28.958118: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 05:39:28.958700: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-05 05:39:28.958806: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 05:39:30.205267: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-05 05:39:30.206289: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 05:39:30.207029: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-03-05 05:39:30.207060: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 05:39:30.207096: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 05:39:30.207115: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-05 05:39:30.207130: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-05 05:39:30.207147: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-05 05:39:30.207162: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-05 05:39:30.207177: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-05 05:39:30.207192: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 05:39:30.207616: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-05 05:39:30.207649: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 05:39:30.892567: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-05 05:39:30.892619: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-05 05:39:30.892627: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-05 05:39:30.893543: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11227 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN X (Pascal), pci bus id: 0000:83:00.0, compute capability: 6.1)
{'id': '10_06', 'seed': 6, 'out_folder': 'results/epoch_budget', 'batch_size': 128, 'epochs': 150, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN X (Pascal)'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/150 [00:00<?, ?epoch/s]2024-03-05 05:39:31.754723: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-05 05:39:31.767118: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2600020000 Hz
2024-03-05 05:39:33.776641: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 05:39:34.036349: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 05:39:34.912945: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-05 05:39:34.975786: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/150 [01:04<2:39:14, 64.12s/epoch, loss=3.07, accuracy=0.313, val_loss=2.68, val_accuracy=0.244, lr=0.1]  1%|▏         | 2/150 [01:24<1:34:51, 38.45s/epoch, loss=1.54, accuracy=0.543, val_loss=2.28, val_accuracy=0.365, lr=0.1]  2%|▏         | 3/150 [01:44<1:13:56, 30.18s/epoch, loss=1.31, accuracy=0.655, val_loss=1.78, val_accuracy=0.477, lr=0.1]  3%|▎         | 4/150 [02:05<1:04:02, 26.32s/epoch, loss=1.25, accuracy=0.694, val_loss=2.03, val_accuracy=0.457, lr=0.1]  3%|▎         | 5/150 [02:25<58:08, 24.06s/epoch, loss=1.22, accuracy=0.709, val_loss=1.7, val_accuracy=0.537, lr=0.1]     4%|▍         | 6/150 [02:46<55:03, 22.94s/epoch, loss=1.21, accuracy=0.714, val_loss=1.55, val_accuracy=0.593, lr=0.1]  5%|▍         | 7/150 [03:06<52:31, 22.04s/epoch, loss=1.19, accuracy=0.726, val_loss=2.88, val_accuracy=0.347, lr=0.1]  5%|▌         | 8/150 [03:26<50:42, 21.42s/epoch, loss=1.19, accuracy=0.728, val_loss=1.48, val_accuracy=0.636, lr=0.1]  6%|▌         | 9/150 [03:46<49:22, 21.01s/epoch, loss=1.18, accuracy=0.733, val_loss=2.59, val_accuracy=0.41, lr=0.1]   7%|▋         | 10/150 [04:06<48:29, 20.78s/epoch, loss=1.18, accuracy=0.732, val_loss=1.65, val_accuracy=0.564, lr=0.1]  7%|▋         | 11/150 [04:27<47:53, 20.67s/epoch, loss=1.17, accuracy=0.737, val_loss=3.31, val_accuracy=0.276, lr=0.1]  8%|▊         | 12/150 [04:47<47:06, 20.48s/epoch, loss=1.17, accuracy=0.742, val_loss=2.27, val_accuracy=0.413, lr=0.1]  9%|▊         | 13/150 [05:07<46:33, 20.39s/epoch, loss=1.16, accuracy=0.743, val_loss=1.66, val_accuracy=0.576, lr=0.0316]  9%|▉         | 14/150 [05:27<46:05, 20.34s/epoch, loss=1.16, accuracy=0.744, val_loss=1.71, val_accuracy=0.565, lr=0.1]    10%|█         | 15/150 [05:47<45:33, 20.25s/epoch, loss=1.16, accuracy=0.744, val_loss=1.86, val_accuracy=0.512, lr=0.1] 11%|█         | 16/150 [06:07<45:04, 20.19s/epoch, loss=1.16, accuracy=0.743, val_loss=2.79, val_accuracy=0.294, lr=0.1] 11%|█▏        | 17/150 [06:27<44:36, 20.12s/epoch, loss=1.15, accuracy=0.746, val_loss=2.62, val_accuracy=0.395, lr=0.1] 12%|█▏        | 18/150 [06:48<44:23, 20.18s/epoch, loss=1.15, accuracy=0.75, val_loss=1.77, val_accuracy=0.592, lr=0.0316] 13%|█▎        | 19/150 [07:08<44:09, 20.23s/epoch, loss=1.15, accuracy=0.747, val_loss=1.72, val_accuracy=0.54, lr=0.1]    13%|█▎        | 20/150 [07:28<43:50, 20.24s/epoch, loss=1.14, accuracy=0.751, val_loss=1.78, val_accuracy=0.541, lr=0.1] 14%|█▍        | 21/150 [07:48<43:27, 20.21s/epoch, loss=1.15, accuracy=0.749, val_loss=3.25, val_accuracy=0.302, lr=0.1] 15%|█▍        | 22/150 [08:09<43:30, 20.39s/epoch, loss=1.15, accuracy=0.749, val_loss=1.78, val_accuracy=0.543, lr=0.1] 15%|█▌        | 23/150 [08:29<42:49, 20.23s/epoch, loss=1.15, accuracy=0.747, val_loss=3.19, val_accuracy=0.425, lr=0.0316] 16%|█▌        | 24/150 [08:49<42:20, 20.17s/epoch, loss=1.14, accuracy=0.749, val_loss=7.47, val_accuracy=0.229, lr=0.1]    17%|█▋        | 25/150 [09:09<42:04, 20.19s/epoch, loss=1.14, accuracy=0.75, val_loss=2.18, val_accuracy=0.467, lr=0.1]  17%|█▋        | 26/150 [09:29<41:38, 20.15s/epoch, loss=1.14, accuracy=0.75, val_loss=1.91, val_accuracy=0.533, lr=0.1] 18%|█▊        | 27/150 [09:50<41:36, 20.30s/epoch, loss=1.14, accuracy=0.75, val_loss=1.67, val_accuracy=0.583, lr=0.1] 19%|█▊        | 28/150 [10:10<41:18, 20.31s/epoch, loss=1.14, accuracy=0.754, val_loss=1.68, val_accuracy=0.604, lr=0.0316] 19%|█▉        | 29/150 [10:31<40:58, 20.32s/epoch, loss=1.14, accuracy=0.751, val_loss=2.14, val_accuracy=0.476, lr=0.1]    20%|██        | 30/150 [10:51<40:41, 20.34s/epoch, loss=1.13, accuracy=0.752, val_loss=3.69, val_accuracy=0.377, lr=0.1] 21%|██        | 31/150 [11:11<40:20, 20.34s/epoch, loss=1.13, accuracy=0.755, val_loss=1.75, val_accuracy=0.55, lr=0.1]  21%|██▏       | 32/150 [11:32<39:54, 20.29s/epoch, loss=1.13, accuracy=0.751, val_loss=1.78, val_accuracy=0.554, lr=0.1] 22%|██▏       | 33/150 [11:52<39:27, 20.23s/epoch, loss=1.12, accuracy=0.755, val_loss=4.03, val_accuracy=0.346, lr=0.0316] 23%|██▎       | 34/150 [12:12<39:06, 20.23s/epoch, loss=1.13, accuracy=0.752, val_loss=1.97, val_accuracy=0.51, lr=0.1]     23%|██▎       | 35/150 [12:32<38:40, 20.18s/epoch, loss=1.13, accuracy=0.753, val_loss=1.44, val_accuracy=0.654, lr=0.1] 24%|██▍       | 36/150 [12:52<38:16, 20.14s/epoch, loss=1.13, accuracy=0.755, val_loss=4.86, val_accuracy=0.162, lr=0.1] 25%|██▍       | 37/150 [13:12<37:49, 20.08s/epoch, loss=1.13, accuracy=0.757, val_loss=1.65, val_accuracy=0.539, lr=0.1] 25%|██▌       | 38/150 [13:32<37:26, 20.06s/epoch, loss=1.12, accuracy=0.755, val_loss=2.57, val_accuracy=0.426, lr=0.1] 26%|██▌       | 39/150 [13:52<37:05, 20.05s/epoch, loss=1.12, accuracy=0.754, val_loss=1.66, val_accuracy=0.576, lr=0.1] 27%|██▋       | 40/150 [14:12<36:44, 20.04s/epoch, loss=1.13, accuracy=0.753, val_loss=1.71, val_accuracy=0.537, lr=0.0316] 27%|██▋       | 41/150 [14:32<36:30, 20.09s/epoch, loss=1.12, accuracy=0.758, val_loss=2.63, val_accuracy=0.378, lr=0.1]    28%|██▊       | 42/150 [14:52<36:06, 20.06s/epoch, loss=1.12, accuracy=0.757, val_loss=2.6, val_accuracy=0.383, lr=0.1]  29%|██▊       | 43/150 [15:12<35:50, 20.10s/epoch, loss=1.12, accuracy=0.757, val_loss=1.86, val_accuracy=0.548, lr=0.1] 29%|██▉       | 44/150 [15:32<35:30, 20.10s/epoch, loss=1.12, accuracy=0.757, val_loss=1.87, val_accuracy=0.532, lr=0.1] 30%|███       | 45/150 [15:53<35:16, 20.16s/epoch, loss=1.12, accuracy=0.757, val_loss=2.7, val_accuracy=0.362, lr=0.0316] 31%|███       | 46/150 [16:13<34:53, 20.13s/epoch, loss=1.12, accuracy=0.754, val_loss=1.44, val_accuracy=0.637, lr=0.1]   31%|███▏      | 47/150 [16:33<34:30, 20.10s/epoch, loss=1.11, accuracy=0.759, val_loss=2.66, val_accuracy=0.337, lr=0.1] 32%|███▏      | 48/150 [16:53<34:07, 20.07s/epoch, loss=1.12, accuracy=0.757, val_loss=2.09, val_accuracy=0.55, lr=0.1]  33%|███▎      | 49/150 [17:13<33:47, 20.07s/epoch, loss=1.11, accuracy=0.759, val_loss=1.57, val_accuracy=0.597, lr=0.1] 33%|███▎      | 50/150 [17:33<33:22, 20.03s/epoch, loss=1.11, accuracy=0.757, val_loss=3.44, val_accuracy=0.364, lr=0.1] 34%|███▍      | 51/150 [17:53<33:05, 20.06s/epoch, loss=1.11, accuracy=0.758, val_loss=10.9, val_accuracy=0.142, lr=0.0316] 35%|███▍      | 52/150 [18:13<32:47, 20.08s/epoch, loss=1.11, accuracy=0.759, val_loss=2.33, val_accuracy=0.459, lr=0.1]    35%|███▌      | 53/150 [18:33<32:29, 20.09s/epoch, loss=1.11, accuracy=0.758, val_loss=3.16, val_accuracy=0.361, lr=0.1] 36%|███▌      | 54/150 [18:53<32:07, 20.07s/epoch, loss=1.11, accuracy=0.757, val_loss=1.88, val_accuracy=0.532, lr=0.1] 37%|███▋      | 55/150 [19:13<31:45, 20.05s/epoch, loss=1.11, accuracy=0.755, val_loss=2.07, val_accuracy=0.496, lr=0.1] 37%|███▋      | 56/150 [19:33<31:25, 20.06s/epoch, loss=1.1, accuracy=0.758, val_loss=2.63, val_accuracy=0.408, lr=0.0316] 38%|███▊      | 57/150 [19:53<31:04, 20.05s/epoch, loss=1.11, accuracy=0.76, val_loss=2.5, val_accuracy=0.406, lr=0.1]     39%|███▊      | 58/150 [20:13<30:43, 20.03s/epoch, loss=1.11, accuracy=0.757, val_loss=1.87, val_accuracy=0.514, lr=0.1] 39%|███▉      | 59/150 [20:34<30:31, 20.12s/epoch, loss=1.11, accuracy=0.758, val_loss=2.25, val_accuracy=0.442, lr=0.1] 40%|████      | 60/150 [20:53<30:01, 20.01s/epoch, loss=1.1, accuracy=0.759, val_loss=1.57, val_accuracy=0.604, lr=0.1]  41%|████      | 61/150 [21:13<29:37, 19.97s/epoch, loss=1.1, accuracy=0.758, val_loss=3.09, val_accuracy=0.316, lr=0.0316] 41%|████▏     | 62/150 [21:33<29:17, 19.97s/epoch, loss=1.11, accuracy=0.761, val_loss=2.21, val_accuracy=0.432, lr=0.1]   42%|████▏     | 63/150 [21:53<28:56, 19.96s/epoch, loss=1.1, accuracy=0.759, val_loss=2.73, val_accuracy=0.432, lr=0.1]  43%|████▎     | 64/150 [22:13<28:37, 19.97s/epoch, loss=1.09, accuracy=0.762, val_loss=1.57, val_accuracy=0.62, lr=0.1] 43%|████▎     | 65/150 [22:33<28:17, 19.97s/epoch, loss=1.11, accuracy=0.76, val_loss=2.81, val_accuracy=0.327, lr=0.1] 44%|████▍     | 66/150 [22:53<27:55, 19.94s/epoch, loss=1.11, accuracy=0.758, val_loss=1.69, val_accuracy=0.567, lr=0.0316] 45%|████▍     | 67/150 [23:13<27:33, 19.92s/epoch, loss=1.11, accuracy=0.759, val_loss=1.91, val_accuracy=0.51, lr=0.1]     45%|████▌     | 68/150 [23:33<27:14, 19.93s/epoch, loss=1.1, accuracy=0.76, val_loss=1.96, val_accuracy=0.44, lr=0.1]   46%|████▌     | 69/150 [23:53<26:52, 19.91s/epoch, loss=1.1, accuracy=0.76, val_loss=1.6, val_accuracy=0.587, lr=0.1] 47%|████▋     | 70/150 [24:13<26:29, 19.87s/epoch, loss=1.1, accuracy=0.76, val_loss=1.97, val_accuracy=0.506, lr=0.1] 47%|████▋     | 71/150 [24:32<26:08, 19.86s/epoch, loss=1.1, accuracy=0.76, val_loss=3.41, val_accuracy=0.403, lr=0.0316] 48%|████▊     | 72/150 [24:52<25:47, 19.84s/epoch, loss=1.1, accuracy=0.759, val_loss=1.54, val_accuracy=0.637, lr=0.1]   49%|████▊     | 73/150 [25:12<25:22, 19.77s/epoch, loss=1.1, accuracy=0.76, val_loss=2.03, val_accuracy=0.423, lr=0.1]  49%|████▉     | 74/150 [25:32<25:06, 19.82s/epoch, loss=1.11, accuracy=0.759, val_loss=3.68, val_accuracy=0.4, lr=0.1] 50%|█████     | 75/150 [25:52<24:47, 19.83s/epoch, loss=1.1, accuracy=0.759, val_loss=1.95, val_accuracy=0.513, lr=0.1] 51%|█████     | 76/150 [26:11<24:28, 19.84s/epoch, loss=1.11, accuracy=0.759, val_loss=1.7, val_accuracy=0.576, lr=0.0316] 51%|█████▏    | 77/150 [26:31<24:08, 19.85s/epoch, loss=1.1, accuracy=0.76, val_loss=2.67, val_accuracy=0.449, lr=0.1]     52%|█████▏    | 78/150 [26:51<23:54, 19.92s/epoch, loss=1.1, accuracy=0.762, val_loss=2.35, val_accuracy=0.498, lr=0.1] 53%|█████▎    | 79/150 [27:11<23:37, 19.97s/epoch, loss=1.11, accuracy=0.761, val_loss=2.19, val_accuracy=0.402, lr=0.1] 53%|█████▎    | 80/150 [27:32<23:20, 20.00s/epoch, loss=1.11, accuracy=0.758, val_loss=2.06, val_accuracy=0.44, lr=0.1]  54%|█████▍    | 81/150 [27:51<22:59, 19.99s/epoch, loss=1.1, accuracy=0.76, val_loss=2.2, val_accuracy=0.513, lr=0.0316] 55%|█████▍    | 82/150 [28:11<22:38, 19.98s/epoch, loss=0.886, accuracy=0.82, val_loss=0.955, val_accuracy=0.774, lr=0.01] 55%|█████▌    | 83/150 [28:31<22:13, 19.90s/epoch, loss=0.72, accuracy=0.847, val_loss=0.781, val_accuracy=0.815, lr=0.01] 56%|█████▌    | 84/150 [28:52<22:03, 20.05s/epoch, loss=0.64, accuracy=0.857, val_loss=0.752, val_accuracy=0.812, lr=0.01] 57%|█████▋    | 85/150 [29:11<21:40, 20.01s/epoch, loss=0.598, accuracy=0.861, val_loss=0.949, val_accuracy=0.743, lr=0.01] 57%|█████▋    | 86/150 [29:31<21:20, 20.01s/epoch, loss=0.578, accuracy=0.863, val_loss=0.739, val_accuracy=0.809, lr=0.01] 58%|█████▊    | 87/150 [29:51<21:00, 20.01s/epoch, loss=0.567, accuracy=0.863, val_loss=0.757, val_accuracy=0.806, lr=0.01] 59%|█████▊    | 88/150 [30:11<20:38, 19.98s/epoch, loss=0.564, accuracy=0.863, val_loss=0.866, val_accuracy=0.769, lr=0.01] 59%|█████▉    | 89/150 [30:31<20:16, 19.93s/epoch, loss=0.561, accuracy=0.866, val_loss=0.902, val_accuracy=0.772, lr=0.01] 60%|██████    | 90/150 [30:51<19:59, 20.00s/epoch, loss=0.555, accuracy=0.867, val_loss=0.765, val_accuracy=0.805, lr=0.01] 61%|██████    | 91/150 [31:11<19:37, 19.96s/epoch, loss=0.555, accuracy=0.868, val_loss=0.821, val_accuracy=0.785, lr=0.00316] 61%|██████▏   | 92/150 [31:31<19:17, 19.95s/epoch, loss=0.554, accuracy=0.871, val_loss=0.785, val_accuracy=0.796, lr=0.01]    62%|██████▏   | 93/150 [31:51<19:01, 20.03s/epoch, loss=0.551, accuracy=0.871, val_loss=1.25, val_accuracy=0.673, lr=0.01]  63%|██████▎   | 94/150 [32:11<18:40, 20.01s/epoch, loss=0.557, accuracy=0.869, val_loss=0.754, val_accuracy=0.81, lr=0.01] 63%|██████▎   | 95/150 [32:31<18:18, 19.97s/epoch, loss=0.55, accuracy=0.873, val_loss=0.699, val_accuracy=0.823, lr=0.01] 64%|██████▍   | 96/150 [32:51<18:03, 20.07s/epoch, loss=0.55, accuracy=0.875, val_loss=0.934, val_accuracy=0.759, lr=0.01] 65%|██████▍   | 97/150 [33:11<17:41, 20.03s/epoch, loss=0.545, accuracy=0.876, val_loss=0.784, val_accuracy=0.806, lr=0.01] 65%|██████▌   | 98/150 [33:31<17:19, 20.00s/epoch, loss=0.546, accuracy=0.877, val_loss=0.947, val_accuracy=0.766, lr=0.01] 66%|██████▌   | 99/150 [33:52<17:04, 20.10s/epoch, loss=0.552, accuracy=0.875, val_loss=0.92, val_accuracy=0.762, lr=0.01]  67%|██████▋   | 100/150 [34:12<16:44, 20.08s/epoch, loss=0.549, accuracy=0.877, val_loss=0.76, val_accuracy=0.814, lr=0.00316] 67%|██████▋   | 101/150 [34:32<16:24, 20.09s/epoch, loss=0.547, accuracy=0.88, val_loss=0.776, val_accuracy=0.796, lr=0.01]    68%|██████▊   | 102/150 [34:52<16:10, 20.21s/epoch, loss=0.548, accuracy=0.879, val_loss=0.882, val_accuracy=0.781, lr=0.01] 69%|██████▊   | 103/150 [35:12<15:46, 20.15s/epoch, loss=0.549, accuracy=0.879, val_loss=0.742, val_accuracy=0.818, lr=0.01] 69%|██████▉   | 104/150 [35:32<15:26, 20.13s/epoch, loss=0.546, accuracy=0.879, val_loss=0.782, val_accuracy=0.817, lr=0.01] 70%|███████   | 105/150 [35:53<15:06, 20.15s/epoch, loss=0.547, accuracy=0.879, val_loss=0.796, val_accuracy=0.795, lr=0.00316] 71%|███████   | 106/150 [36:13<14:44, 20.11s/epoch, loss=0.549, accuracy=0.879, val_loss=0.979, val_accuracy=0.765, lr=0.01]    71%|███████▏  | 107/150 [36:33<14:23, 20.08s/epoch, loss=0.546, accuracy=0.881, val_loss=0.853, val_accuracy=0.791, lr=0.01] 72%|███████▏  | 108/150 [36:53<14:02, 20.05s/epoch, loss=0.552, accuracy=0.88, val_loss=0.868, val_accuracy=0.781, lr=0.01]  73%|███████▎  | 109/150 [37:13<13:41, 20.05s/epoch, loss=0.548, accuracy=0.882, val_loss=0.946, val_accuracy=0.746, lr=0.01] 73%|███████▎  | 110/150 [37:33<13:20, 20.02s/epoch, loss=0.546, accuracy=0.883, val_loss=1.29, val_accuracy=0.697, lr=0.00316] 74%|███████▍  | 111/150 [37:53<12:59, 19.99s/epoch, loss=0.545, accuracy=0.883, val_loss=0.834, val_accuracy=0.796, lr=0.01]   75%|███████▍  | 112/150 [38:12<12:38, 19.96s/epoch, loss=0.545, accuracy=0.883, val_loss=0.81, val_accuracy=0.806, lr=0.01]  75%|███████▌  | 113/150 [38:32<12:19, 19.98s/epoch, loss=0.549, accuracy=0.882, val_loss=0.683, val_accuracy=0.84, lr=0.01] 76%|███████▌  | 114/150 [38:52<11:58, 19.95s/epoch, loss=0.546, accuracy=0.884, val_loss=0.809, val_accuracy=0.799, lr=0.01] 77%|███████▋  | 115/150 [39:12<11:39, 19.97s/epoch, loss=0.548, accuracy=0.882, val_loss=0.833, val_accuracy=0.797, lr=0.01] 77%|███████▋  | 116/150 [39:32<11:19, 19.98s/epoch, loss=0.544, accuracy=0.883, val_loss=0.863, val_accuracy=0.786, lr=0.01] 78%|███████▊  | 117/150 [39:52<11:00, 20.01s/epoch, loss=0.542, accuracy=0.886, val_loss=0.762, val_accuracy=0.815, lr=0.01] 79%|███████▊  | 118/150 [40:12<10:40, 20.02s/epoch, loss=0.542, accuracy=0.885, val_loss=0.801, val_accuracy=0.81, lr=0.00316] 79%|███████▉  | 119/150 [40:33<10:20, 20.02s/epoch, loss=0.541, accuracy=0.886, val_loss=0.803, val_accuracy=0.805, lr=0.01]   80%|████████  | 120/150 [40:53<10:00, 20.02s/epoch, loss=0.546, accuracy=0.886, val_loss=0.99, val_accuracy=0.766, lr=0.01]  81%|████████  | 121/150 [41:12<09:39, 19.97s/epoch, loss=0.545, accuracy=0.886, val_loss=0.956, val_accuracy=0.771, lr=0.01] 81%|████████▏ | 122/150 [41:32<09:19, 19.98s/epoch, loss=0.477, accuracy=0.911, val_loss=0.532, val_accuracy=0.889, lr=0.001] 82%|████████▏ | 123/150 [41:52<08:59, 19.99s/epoch, loss=0.417, accuracy=0.929, val_loss=0.517, val_accuracy=0.894, lr=0.001] 83%|████████▎ | 124/150 [42:12<08:39, 19.99s/epoch, loss=0.397, accuracy=0.934, val_loss=0.506, val_accuracy=0.898, lr=0.001] 83%|████████▎ | 125/150 [42:32<08:17, 19.92s/epoch, loss=0.377, accuracy=0.939, val_loss=0.496, val_accuracy=0.896, lr=0.001] 84%|████████▍ | 126/150 [42:52<07:56, 19.87s/epoch, loss=0.366, accuracy=0.941, val_loss=0.488, val_accuracy=0.901, lr=0.001] 85%|████████▍ | 127/150 [43:12<07:38, 19.94s/epoch, loss=0.353, accuracy=0.945, val_loss=0.49, val_accuracy=0.9, lr=0.001]    85%|████████▌ | 128/150 [43:32<07:19, 20.00s/epoch, loss=0.344, accuracy=0.945, val_loss=0.477, val_accuracy=0.901, lr=0.001] 86%|████████▌ | 129/150 [43:52<06:59, 19.97s/epoch, loss=0.333, accuracy=0.946, val_loss=0.482, val_accuracy=0.897, lr=0.001] 87%|████████▋ | 130/150 [44:12<06:39, 19.96s/epoch, loss=0.324, accuracy=0.949, val_loss=0.48, val_accuracy=0.899, lr=0.001]  87%|████████▋ | 131/150 [44:32<06:18, 19.90s/epoch, loss=0.315, accuracy=0.951, val_loss=0.463, val_accuracy=0.904, lr=0.001] 88%|████████▊ | 132/150 [44:52<05:58, 19.94s/epoch, loss=0.305, accuracy=0.952, val_loss=0.463, val_accuracy=0.9, lr=0.001]   89%|████████▊ | 133/150 [45:12<05:39, 19.96s/epoch, loss=0.298, accuracy=0.954, val_loss=0.474, val_accuracy=0.895, lr=0.001] 89%|████████▉ | 134/150 [45:32<05:18, 19.92s/epoch, loss=0.292, accuracy=0.955, val_loss=0.463, val_accuracy=0.899, lr=0.001] 90%|█████████ | 135/150 [45:51<04:58, 19.91s/epoch, loss=0.281, accuracy=0.957, val_loss=0.475, val_accuracy=0.897, lr=0.001] 91%|█████████ | 136/150 [46:11<04:38, 19.88s/epoch, loss=0.28, accuracy=0.955, val_loss=0.464, val_accuracy=0.899, lr=0.000316] 91%|█████████▏| 137/150 [46:31<04:18, 19.87s/epoch, loss=0.273, accuracy=0.956, val_loss=0.462, val_accuracy=0.9, lr=0.001]     92%|█████████▏| 138/150 [46:51<03:58, 19.84s/epoch, loss=0.268, accuracy=0.957, val_loss=0.46, val_accuracy=0.896, lr=0.001] 93%|█████████▎| 139/150 [47:11<03:38, 19.87s/epoch, loss=0.262, accuracy=0.958, val_loss=0.458, val_accuracy=0.899, lr=0.001] 93%|█████████▎| 140/150 [47:31<03:18, 19.87s/epoch, loss=0.26, accuracy=0.958, val_loss=0.485, val_accuracy=0.89, lr=0.001]   94%|█████████▍| 141/150 [47:51<02:58, 19.88s/epoch, loss=0.253, accuracy=0.958, val_loss=0.469, val_accuracy=0.892, lr=0.001] 95%|█████████▍| 142/150 [48:10<02:38, 19.85s/epoch, loss=0.248, accuracy=0.96, val_loss=0.454, val_accuracy=0.901, lr=0.001]  95%|█████████▌| 143/150 [48:30<02:18, 19.78s/epoch, loss=0.245, accuracy=0.96, val_loss=0.483, val_accuracy=0.888, lr=0.001] 96%|█████████▌| 144/150 [48:50<01:58, 19.80s/epoch, loss=0.242, accuracy=0.96, val_loss=0.491, val_accuracy=0.89, lr=0.001]  97%|█████████▋| 145/150 [49:10<01:38, 19.79s/epoch, loss=0.236, accuracy=0.961, val_loss=0.487, val_accuracy=0.889, lr=0.001] 97%|█████████▋| 146/150 [49:29<01:19, 19.77s/epoch, loss=0.235, accuracy=0.962, val_loss=0.478, val_accuracy=0.89, lr=0.001]  98%|█████████▊| 147/150 [49:49<00:59, 19.77s/epoch, loss=0.232, accuracy=0.96, val_loss=0.456, val_accuracy=0.892, lr=0.000316] 99%|█████████▊| 148/150 [50:09<00:39, 19.85s/epoch, loss=0.231, accuracy=0.961, val_loss=0.468, val_accuracy=0.894, lr=0.001]   99%|█████████▉| 149/150 [50:29<00:19, 19.89s/epoch, loss=0.226, accuracy=0.962, val_loss=0.5, val_accuracy=0.891, lr=0.001]  100%|██████████| 150/150 [50:49<00:00, 19.96s/epoch, loss=0.223, accuracy=0.963, val_loss=0.488, val_accuracy=0.887, lr=0.001]100%|██████████| 150/150 [50:49<00:00, 20.33s/epoch, loss=0.223, accuracy=0.963, val_loss=0.488, val_accuracy=0.887, lr=0.001]
Using real-time data augmentation.
Test score: 0.48800531029701233
Test accuracy: 0.8866999745368958


* * * Run SGD for ID = 10_7. * * *


2024-03-05 06:30:25.378011: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 06:30:27.970284: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 06:30:27.971379: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-05 06:30:28.009355: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-03-05 06:30:28.009402: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 06:30:28.012395: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 06:30:28.012434: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-05 06:30:28.014554: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-05 06:30:28.015219: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-05 06:30:28.017479: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-05 06:30:28.018878: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-05 06:30:28.023484: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 06:30:28.024097: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-05 06:30:28.024180: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 06:30:29.241113: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-05 06:30:29.242524: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 06:30:29.243275: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-03-05 06:30:29.243307: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 06:30:29.243348: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 06:30:29.243367: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-05 06:30:29.243392: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-05 06:30:29.243410: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-05 06:30:29.243425: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-05 06:30:29.243440: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-05 06:30:29.243456: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 06:30:29.243873: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-05 06:30:29.243911: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 06:30:29.891797: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-05 06:30:29.891853: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-05 06:30:29.891862: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-05 06:30:29.892789: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11227 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN X (Pascal), pci bus id: 0000:83:00.0, compute capability: 6.1)
{'id': '10_07', 'seed': 7, 'out_folder': 'results/epoch_budget', 'batch_size': 128, 'epochs': 150, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN X (Pascal)'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/150 [00:00<?, ?epoch/s]2024-03-05 06:30:30.750582: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-05 06:30:30.751180: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2600020000 Hz
2024-03-05 06:30:32.789101: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 06:30:33.019976: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 06:30:33.796136: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-05 06:30:33.852918: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/150 [00:58<2:25:34, 58.62s/epoch, loss=3.34, accuracy=0.281, val_loss=2.3, val_accuracy=0.292, lr=0.1]  1%|▏         | 2/150 [01:19<1:29:42, 36.36s/epoch, loss=1.69, accuracy=0.465, val_loss=2.43, val_accuracy=0.319, lr=0.1]  2%|▏         | 3/150 [01:39<1:10:59, 28.97s/epoch, loss=1.43, accuracy=0.587, val_loss=1.94, val_accuracy=0.464, lr=0.1]  3%|▎         | 4/150 [01:59<1:01:56, 25.45s/epoch, loss=1.32, accuracy=0.664, val_loss=1.76, val_accuracy=0.533, lr=0.1]  3%|▎         | 5/150 [02:19<56:44, 23.48s/epoch, loss=1.27, accuracy=0.69, val_loss=1.56, val_accuracy=0.607, lr=0.1]     4%|▍         | 6/150 [02:39<53:26, 22.27s/epoch, loss=1.25, accuracy=0.708, val_loss=1.92, val_accuracy=0.506, lr=0.1]  5%|▍         | 7/150 [02:59<51:26, 21.58s/epoch, loss=1.24, accuracy=0.715, val_loss=1.53, val_accuracy=0.618, lr=0.1]  5%|▌         | 8/150 [03:19<49:48, 21.05s/epoch, loss=1.22, accuracy=0.721, val_loss=1.89, val_accuracy=0.543, lr=0.1]  6%|▌         | 9/150 [03:39<48:34, 20.67s/epoch, loss=1.22, accuracy=0.725, val_loss=2.24, val_accuracy=0.442, lr=0.1]  7%|▋         | 10/150 [03:59<47:43, 20.46s/epoch, loss=1.21, accuracy=0.728, val_loss=2.96, val_accuracy=0.362, lr=0.1]  7%|▋         | 11/150 [04:19<47:02, 20.31s/epoch, loss=1.22, accuracy=0.73, val_loss=1.51, val_accuracy=0.64, lr=0.1]    8%|▊         | 12/150 [04:39<46:16, 20.12s/epoch, loss=1.22, accuracy=0.732, val_loss=1.62, val_accuracy=0.617, lr=0.1]  9%|▊         | 13/150 [04:58<45:44, 20.03s/epoch, loss=1.2, accuracy=0.736, val_loss=1.56, val_accuracy=0.616, lr=0.1]   9%|▉         | 14/150 [05:18<45:21, 20.01s/epoch, loss=1.2, accuracy=0.736, val_loss=1.69, val_accuracy=0.593, lr=0.1] 10%|█         | 15/150 [05:38<44:49, 19.93s/epoch, loss=1.2, accuracy=0.736, val_loss=2.05, val_accuracy=0.546, lr=0.1] 11%|█         | 16/150 [05:58<44:27, 19.91s/epoch, loss=1.2, accuracy=0.741, val_loss=2.09, val_accuracy=0.495, lr=0.0316] 11%|█▏        | 17/150 [06:18<43:57, 19.83s/epoch, loss=1.2, accuracy=0.74, val_loss=2.25, val_accuracy=0.477, lr=0.1]     12%|█▏        | 18/150 [06:38<43:47, 19.90s/epoch, loss=1.18, accuracy=0.744, val_loss=1.59, val_accuracy=0.596, lr=0.1] 13%|█▎        | 19/150 [06:57<43:21, 19.85s/epoch, loss=1.18, accuracy=0.745, val_loss=2.08, val_accuracy=0.439, lr=0.1] 13%|█▎        | 20/150 [07:17<43:01, 19.86s/epoch, loss=1.17, accuracy=0.745, val_loss=3.58, val_accuracy=0.321, lr=0.1] 14%|█▍        | 21/150 [07:37<42:42, 19.86s/epoch, loss=1.17, accuracy=0.744, val_loss=2.95, val_accuracy=0.36, lr=0.0316] 15%|█▍        | 22/150 [07:57<42:33, 19.95s/epoch, loss=1.17, accuracy=0.745, val_loss=2.5, val_accuracy=0.335, lr=0.1]    15%|█▌        | 23/150 [08:17<42:08, 19.91s/epoch, loss=1.18, accuracy=0.746, val_loss=1.59, val_accuracy=0.604, lr=0.1] 16%|█▌        | 24/150 [08:37<42:03, 20.03s/epoch, loss=1.17, accuracy=0.748, val_loss=1.49, val_accuracy=0.636, lr=0.1] 17%|█▋        | 25/150 [08:58<41:44, 20.03s/epoch, loss=1.17, accuracy=0.746, val_loss=1.54, val_accuracy=0.606, lr=0.1] 17%|█▋        | 26/150 [09:17<41:19, 20.00s/epoch, loss=1.17, accuracy=0.747, val_loss=1.54, val_accuracy=0.612, lr=0.1] 18%|█▊        | 27/150 [09:37<40:58, 19.98s/epoch, loss=1.17, accuracy=0.746, val_loss=1.94, val_accuracy=0.525, lr=0.1] 19%|█▊        | 28/150 [09:57<40:35, 19.96s/epoch, loss=1.16, accuracy=0.748, val_loss=1.79, val_accuracy=0.498, lr=0.1] 19%|█▉        | 29/150 [10:17<40:09, 19.91s/epoch, loss=1.16, accuracy=0.748, val_loss=1.54, val_accuracy=0.609, lr=0.0316] 20%|██        | 30/150 [10:37<39:50, 19.92s/epoch, loss=1.16, accuracy=0.748, val_loss=3.29, val_accuracy=0.39, lr=0.1]     21%|██        | 31/150 [10:57<39:21, 19.85s/epoch, loss=1.17, accuracy=0.748, val_loss=2.23, val_accuracy=0.45, lr=0.1] 21%|██▏       | 32/150 [11:16<38:59, 19.82s/epoch, loss=1.16, accuracy=0.748, val_loss=1.52, val_accuracy=0.617, lr=0.1] 22%|██▏       | 33/150 [11:36<38:34, 19.78s/epoch, loss=1.17, accuracy=0.748, val_loss=1.53, val_accuracy=0.609, lr=0.1] 23%|██▎       | 34/150 [11:56<38:08, 19.73s/epoch, loss=1.16, accuracy=0.75, val_loss=1.47, val_accuracy=0.652, lr=0.1]  23%|██▎       | 35/150 [12:16<37:54, 19.78s/epoch, loss=1.15, accuracy=0.751, val_loss=2.44, val_accuracy=0.438, lr=0.1] 24%|██▍       | 36/150 [12:35<37:34, 19.78s/epoch, loss=1.16, accuracy=0.749, val_loss=2.2, val_accuracy=0.397, lr=0.1]  25%|██▍       | 37/150 [12:55<37:13, 19.76s/epoch, loss=1.15, accuracy=0.752, val_loss=3.47, val_accuracy=0.19, lr=0.1] 25%|██▌       | 38/150 [13:15<36:52, 19.75s/epoch, loss=1.15, accuracy=0.752, val_loss=2.25, val_accuracy=0.485, lr=0.1] 26%|██▌       | 39/150 [13:35<36:32, 19.75s/epoch, loss=1.15, accuracy=0.753, val_loss=2.33, val_accuracy=0.458, lr=0.0316] 27%|██▋       | 40/150 [13:54<36:12, 19.75s/epoch, loss=1.15, accuracy=0.751, val_loss=1.46, val_accuracy=0.649, lr=0.1]    27%|██▋       | 41/150 [14:14<35:50, 19.73s/epoch, loss=1.15, accuracy=0.754, val_loss=1.93, val_accuracy=0.51, lr=0.1]  28%|██▊       | 42/150 [14:34<35:29, 19.72s/epoch, loss=1.15, accuracy=0.751, val_loss=1.95, val_accuracy=0.495, lr=0.1] 29%|██▊       | 43/150 [14:54<35:12, 19.75s/epoch, loss=1.15, accuracy=0.754, val_loss=2.54, val_accuracy=0.455, lr=0.1] 29%|██▉       | 44/150 [15:13<34:52, 19.75s/epoch, loss=1.15, accuracy=0.754, val_loss=1.42, val_accuracy=0.655, lr=0.1] 30%|███       | 45/150 [15:33<34:34, 19.76s/epoch, loss=1.15, accuracy=0.754, val_loss=2.6, val_accuracy=0.397, lr=0.1]  31%|███       | 46/150 [15:53<34:14, 19.75s/epoch, loss=1.15, accuracy=0.754, val_loss=2.08, val_accuracy=0.504, lr=0.1] 31%|███▏      | 47/150 [16:13<34:02, 19.83s/epoch, loss=1.15, accuracy=0.753, val_loss=2.71, val_accuracy=0.42, lr=0.1]  32%|███▏      | 48/150 [16:33<33:39, 19.80s/epoch, loss=1.14, accuracy=0.754, val_loss=2.03, val_accuracy=0.532, lr=0.1] 33%|███▎      | 49/150 [16:52<33:16, 19.77s/epoch, loss=1.14, accuracy=0.754, val_loss=2.02, val_accuracy=0.495, lr=0.0316] 33%|███▎      | 50/150 [17:12<32:59, 19.79s/epoch, loss=1.15, accuracy=0.753, val_loss=1.92, val_accuracy=0.476, lr=0.1]    34%|███▍      | 51/150 [17:32<32:44, 19.84s/epoch, loss=1.14, accuracy=0.754, val_loss=2.1, val_accuracy=0.519, lr=0.1]  35%|███▍      | 52/150 [17:52<32:24, 19.84s/epoch, loss=1.13, accuracy=0.757, val_loss=1.5, val_accuracy=0.617, lr=0.1] 35%|███▌      | 53/150 [18:12<32:06, 19.86s/epoch, loss=1.14, accuracy=0.755, val_loss=1.83, val_accuracy=0.511, lr=0.1] 36%|███▌      | 54/150 [18:32<31:42, 19.81s/epoch, loss=1.13, accuracy=0.757, val_loss=1.73, val_accuracy=0.58, lr=0.0316] 37%|███▋      | 55/150 [18:51<31:22, 19.81s/epoch, loss=1.14, accuracy=0.754, val_loss=1.72, val_accuracy=0.568, lr=0.1]   37%|███▋      | 56/150 [19:11<30:57, 19.76s/epoch, loss=1.14, accuracy=0.757, val_loss=1.59, val_accuracy=0.598, lr=0.1] 38%|███▊      | 57/150 [19:31<30:41, 19.80s/epoch, loss=1.13, accuracy=0.758, val_loss=1.63, val_accuracy=0.602, lr=0.1] 39%|███▊      | 58/150 [19:51<30:22, 19.80s/epoch, loss=1.14, accuracy=0.757, val_loss=1.74, val_accuracy=0.563, lr=0.1] 39%|███▉      | 59/150 [20:10<30:00, 19.79s/epoch, loss=1.14, accuracy=0.754, val_loss=2.69, val_accuracy=0.386, lr=0.0316] 40%|████      | 60/150 [20:30<29:40, 19.78s/epoch, loss=1.13, accuracy=0.758, val_loss=1.62, val_accuracy=0.562, lr=0.1]    41%|████      | 61/150 [20:50<29:16, 19.73s/epoch, loss=1.14, accuracy=0.754, val_loss=1.9, val_accuracy=0.587, lr=0.1]  41%|████▏     | 62/150 [21:09<28:54, 19.72s/epoch, loss=1.13, accuracy=0.757, val_loss=3, val_accuracy=0.388, lr=0.1]   42%|████▏     | 63/150 [21:29<28:32, 19.69s/epoch, loss=1.13, accuracy=0.757, val_loss=2.65, val_accuracy=0.417, lr=0.1] 43%|████▎     | 64/150 [21:49<28:13, 19.69s/epoch, loss=1.13, accuracy=0.756, val_loss=2.65, val_accuracy=0.415, lr=0.0316] 43%|████▎     | 65/150 [22:08<27:50, 19.66s/epoch, loss=1.13, accuracy=0.755, val_loss=3.06, val_accuracy=0.427, lr=0.1]    44%|████▍     | 66/150 [22:28<27:29, 19.64s/epoch, loss=1.12, accuracy=0.758, val_loss=2.97, val_accuracy=0.385, lr=0.1] 45%|████▍     | 67/150 [22:47<27:05, 19.58s/epoch, loss=1.14, accuracy=0.756, val_loss=1.68, val_accuracy=0.539, lr=0.1] 45%|████▌     | 68/150 [23:07<26:48, 19.61s/epoch, loss=1.13, accuracy=0.759, val_loss=2.28, val_accuracy=0.493, lr=0.1] 46%|████▌     | 69/150 [23:27<26:30, 19.64s/epoch, loss=1.13, accuracy=0.757, val_loss=3.77, val_accuracy=0.225, lr=0.0316] 47%|████▋     | 70/150 [23:46<26:10, 19.63s/epoch, loss=1.12, accuracy=0.76, val_loss=1.74, val_accuracy=0.599, lr=0.1]     47%|████▋     | 71/150 [24:06<25:56, 19.70s/epoch, loss=1.12, accuracy=0.757, val_loss=1.72, val_accuracy=0.583, lr=0.1] 48%|████▊     | 72/150 [24:26<25:37, 19.71s/epoch, loss=1.13, accuracy=0.757, val_loss=2.29, val_accuracy=0.463, lr=0.1] 49%|████▊     | 73/150 [24:46<25:14, 19.67s/epoch, loss=1.12, accuracy=0.758, val_loss=2.21, val_accuracy=0.519, lr=0.1] 49%|████▉     | 74/150 [25:05<24:54, 19.67s/epoch, loss=1.12, accuracy=0.757, val_loss=1.82, val_accuracy=0.554, lr=0.0316] 50%|█████     | 75/150 [25:25<24:32, 19.63s/epoch, loss=1.12, accuracy=0.757, val_loss=2.67, val_accuracy=0.267, lr=0.1]    51%|█████     | 76/150 [25:45<24:16, 19.68s/epoch, loss=1.12, accuracy=0.757, val_loss=1.35, val_accuracy=0.683, lr=0.1] 51%|█████▏    | 77/150 [26:04<23:59, 19.72s/epoch, loss=1.12, accuracy=0.758, val_loss=3.17, val_accuracy=0.323, lr=0.1] 52%|█████▏    | 78/150 [26:24<23:39, 19.71s/epoch, loss=1.13, accuracy=0.758, val_loss=2.2, val_accuracy=0.445, lr=0.1]  53%|█████▎    | 79/150 [26:44<23:18, 19.70s/epoch, loss=1.13, accuracy=0.758, val_loss=2.73, val_accuracy=0.382, lr=0.1] 53%|█████▎    | 80/150 [27:04<23:01, 19.73s/epoch, loss=1.12, accuracy=0.757, val_loss=2.52, val_accuracy=0.461, lr=0.1] 54%|█████▍    | 81/150 [27:23<22:45, 19.79s/epoch, loss=1.13, accuracy=0.755, val_loss=1.73, val_accuracy=0.552, lr=0.0316] 55%|█████▍    | 82/150 [27:43<22:25, 19.79s/epoch, loss=0.912, accuracy=0.817, val_loss=0.911, val_accuracy=0.805, lr=0.01] 55%|█████▌    | 83/150 [28:03<22:06, 19.80s/epoch, loss=0.732, accuracy=0.849, val_loss=0.831, val_accuracy=0.796, lr=0.01] 56%|█████▌    | 84/150 [28:23<21:50, 19.85s/epoch, loss=0.65, accuracy=0.856, val_loss=0.724, val_accuracy=0.827, lr=0.01]  57%|█████▋    | 85/150 [28:43<21:28, 19.83s/epoch, loss=0.604, accuracy=0.861, val_loss=0.771, val_accuracy=0.796, lr=0.01] 57%|█████▋    | 86/150 [29:03<21:07, 19.81s/epoch, loss=0.586, accuracy=0.862, val_loss=0.739, val_accuracy=0.809, lr=0.01] 58%|█████▊    | 87/150 [29:22<20:47, 19.80s/epoch, loss=0.573, accuracy=0.861, val_loss=0.817, val_accuracy=0.779, lr=0.01] 59%|█████▊    | 88/150 [29:42<20:27, 19.80s/epoch, loss=0.568, accuracy=0.863, val_loss=0.812, val_accuracy=0.783, lr=0.01] 59%|█████▉    | 89/150 [30:02<20:08, 19.82s/epoch, loss=0.562, accuracy=0.867, val_loss=0.813, val_accuracy=0.783, lr=0.00316] 60%|██████    | 90/150 [30:22<19:48, 19.82s/epoch, loss=0.558, accuracy=0.868, val_loss=0.832, val_accuracy=0.784, lr=0.01]    61%|██████    | 91/150 [30:42<19:27, 19.78s/epoch, loss=0.561, accuracy=0.868, val_loss=0.986, val_accuracy=0.733, lr=0.01] 61%|██████▏   | 92/150 [31:02<19:13, 19.89s/epoch, loss=0.556, accuracy=0.871, val_loss=0.815, val_accuracy=0.78, lr=0.01]  62%|██████▏   | 93/150 [31:21<18:51, 19.85s/epoch, loss=0.558, accuracy=0.871, val_loss=0.699, val_accuracy=0.823, lr=0.01] 63%|██████▎   | 94/150 [31:41<18:31, 19.84s/epoch, loss=0.556, accuracy=0.873, val_loss=0.925, val_accuracy=0.769, lr=0.01] 63%|██████▎   | 95/150 [32:01<18:05, 19.74s/epoch, loss=0.555, accuracy=0.873, val_loss=0.945, val_accuracy=0.756, lr=0.01] 64%|██████▍   | 96/150 [32:21<17:45, 19.74s/epoch, loss=0.552, accuracy=0.875, val_loss=0.839, val_accuracy=0.79, lr=0.01]  65%|██████▍   | 97/150 [32:40<17:24, 19.72s/epoch, loss=0.556, accuracy=0.875, val_loss=0.778, val_accuracy=0.799, lr=0.01] 65%|██████▌   | 98/150 [33:00<17:03, 19.68s/epoch, loss=0.554, accuracy=0.876, val_loss=0.826, val_accuracy=0.797, lr=0.00316] 66%|██████▌   | 99/150 [33:19<16:41, 19.65s/epoch, loss=0.55, accuracy=0.879, val_loss=0.945, val_accuracy=0.755, lr=0.01]     67%|██████▋   | 100/150 [33:39<16:21, 19.63s/epoch, loss=0.551, accuracy=0.879, val_loss=0.723, val_accuracy=0.817, lr=0.01] 67%|██████▋   | 101/150 [33:59<16:07, 19.75s/epoch, loss=0.552, accuracy=0.879, val_loss=0.89, val_accuracy=0.791, lr=0.01]  68%|██████▊   | 102/150 [34:19<15:46, 19.73s/epoch, loss=0.55, accuracy=0.879, val_loss=0.946, val_accuracy=0.757, lr=0.01] 69%|██████▊   | 103/150 [34:38<15:24, 19.68s/epoch, loss=0.554, accuracy=0.881, val_loss=0.811, val_accuracy=0.791, lr=0.00316] 69%|██████▉   | 104/150 [34:58<15:06, 19.70s/epoch, loss=0.546, accuracy=0.882, val_loss=0.716, val_accuracy=0.827, lr=0.01]    70%|███████   | 105/150 [35:18<14:48, 19.75s/epoch, loss=0.551, accuracy=0.881, val_loss=0.844, val_accuracy=0.79, lr=0.01]  71%|███████   | 106/150 [35:38<14:28, 19.74s/epoch, loss=0.553, accuracy=0.88, val_loss=0.949, val_accuracy=0.749, lr=0.01] 71%|███████▏  | 107/150 [35:57<14:06, 19.68s/epoch, loss=0.546, accuracy=0.884, val_loss=0.907, val_accuracy=0.775, lr=0.01] 72%|███████▏  | 108/150 [36:17<13:49, 19.76s/epoch, loss=0.552, accuracy=0.881, val_loss=0.958, val_accuracy=0.773, lr=0.00316] 73%|███████▎  | 109/150 [36:37<13:27, 19.69s/epoch, loss=0.549, accuracy=0.884, val_loss=0.701, val_accuracy=0.826, lr=0.01]    73%|███████▎  | 110/150 [36:56<13:09, 19.73s/epoch, loss=0.551, accuracy=0.882, val_loss=0.943, val_accuracy=0.77, lr=0.01]  74%|███████▍  | 111/150 [37:16<12:49, 19.73s/epoch, loss=0.551, accuracy=0.882, val_loss=0.741, val_accuracy=0.816, lr=0.01] 75%|███████▍  | 112/150 [37:36<12:31, 19.77s/epoch, loss=0.549, accuracy=0.884, val_loss=0.987, val_accuracy=0.754, lr=0.01] 75%|███████▌  | 113/150 [37:56<12:10, 19.75s/epoch, loss=0.548, accuracy=0.885, val_loss=0.891, val_accuracy=0.768, lr=0.00316] 76%|███████▌  | 114/150 [38:16<11:53, 19.82s/epoch, loss=0.548, accuracy=0.884, val_loss=0.756, val_accuracy=0.818, lr=0.01]    77%|███████▋  | 115/150 [38:35<11:32, 19.78s/epoch, loss=0.551, accuracy=0.884, val_loss=0.76, val_accuracy=0.814, lr=0.01]  77%|███████▋  | 116/150 [38:56<11:16, 19.89s/epoch, loss=0.547, accuracy=0.885, val_loss=0.747, val_accuracy=0.823, lr=0.01] 78%|███████▊  | 117/150 [39:15<10:55, 19.85s/epoch, loss=0.549, accuracy=0.885, val_loss=0.972, val_accuracy=0.773, lr=0.01] 79%|███████▊  | 118/150 [39:35<10:35, 19.85s/epoch, loss=0.551, accuracy=0.886, val_loss=1.07, val_accuracy=0.749, lr=0.00316] 79%|███████▉  | 119/150 [39:55<10:14, 19.82s/epoch, loss=0.55, accuracy=0.886, val_loss=1, val_accuracy=0.761, lr=0.01]        80%|████████  | 120/150 [40:15<09:54, 19.82s/epoch, loss=0.548, accuracy=0.887, val_loss=1.01, val_accuracy=0.75, lr=0.01] 81%|████████  | 121/150 [40:34<09:33, 19.78s/epoch, loss=0.553, accuracy=0.885, val_loss=1.42, val_accuracy=0.659, lr=0.01] 81%|████████▏ | 122/150 [40:54<09:13, 19.78s/epoch, loss=0.471, accuracy=0.914, val_loss=0.534, val_accuracy=0.89, lr=0.001] 82%|████████▏ | 123/150 [41:14<08:53, 19.77s/epoch, loss=0.419, accuracy=0.93, val_loss=0.52, val_accuracy=0.896, lr=0.001]  83%|████████▎ | 124/150 [41:34<08:33, 19.75s/epoch, loss=0.396, accuracy=0.935, val_loss=0.503, val_accuracy=0.902, lr=0.001] 83%|████████▎ | 125/150 [41:53<08:13, 19.73s/epoch, loss=0.379, accuracy=0.94, val_loss=0.497, val_accuracy=0.901, lr=0.001]  84%|████████▍ | 126/150 [42:13<07:54, 19.77s/epoch, loss=0.364, accuracy=0.943, val_loss=0.49, val_accuracy=0.903, lr=0.001] 85%|████████▍ | 127/150 [42:33<07:34, 19.75s/epoch, loss=0.355, accuracy=0.944, val_loss=0.496, val_accuracy=0.898, lr=0.001] 85%|████████▌ | 128/150 [42:53<07:16, 19.85s/epoch, loss=0.346, accuracy=0.945, val_loss=0.482, val_accuracy=0.901, lr=0.001] 86%|████████▌ | 129/150 [43:13<06:55, 19.77s/epoch, loss=0.332, accuracy=0.948, val_loss=0.474, val_accuracy=0.904, lr=0.001] 87%|████████▋ | 130/150 [43:32<06:34, 19.75s/epoch, loss=0.325, accuracy=0.949, val_loss=0.473, val_accuracy=0.901, lr=0.001] 87%|████████▋ | 131/150 [43:52<06:13, 19.67s/epoch, loss=0.315, accuracy=0.951, val_loss=0.471, val_accuracy=0.9, lr=0.001]   88%|████████▊ | 132/150 [44:12<05:55, 19.74s/epoch, loss=0.306, accuracy=0.953, val_loss=0.47, val_accuracy=0.901, lr=0.001] 89%|████████▊ | 133/150 [44:31<05:35, 19.71s/epoch, loss=0.301, accuracy=0.953, val_loss=0.481, val_accuracy=0.897, lr=0.001] 89%|████████▉ | 134/150 [44:51<05:15, 19.73s/epoch, loss=0.292, accuracy=0.956, val_loss=0.482, val_accuracy=0.896, lr=0.001] 90%|█████████ | 135/150 [45:11<04:56, 19.74s/epoch, loss=0.286, accuracy=0.956, val_loss=0.474, val_accuracy=0.897, lr=0.001] 91%|█████████ | 136/150 [45:30<04:35, 19.68s/epoch, loss=0.28, accuracy=0.957, val_loss=0.474, val_accuracy=0.899, lr=0.001]  91%|█████████▏| 137/150 [45:50<04:15, 19.62s/epoch, loss=0.274, accuracy=0.957, val_loss=0.454, val_accuracy=0.901, lr=0.001] 92%|█████████▏| 138/150 [46:10<03:56, 19.68s/epoch, loss=0.266, accuracy=0.958, val_loss=0.46, val_accuracy=0.901, lr=0.001]  93%|█████████▎| 139/150 [46:29<03:35, 19.61s/epoch, loss=0.261, accuracy=0.959, val_loss=0.455, val_accuracy=0.9, lr=0.001]  93%|█████████▎| 140/150 [46:49<03:16, 19.67s/epoch, loss=0.259, accuracy=0.959, val_loss=0.464, val_accuracy=0.902, lr=0.001] 94%|█████████▍| 141/150 [47:09<02:57, 19.67s/epoch, loss=0.253, accuracy=0.96, val_loss=0.46, val_accuracy=0.9, lr=0.001]     95%|█████████▍| 142/150 [47:28<02:37, 19.69s/epoch, loss=0.248, accuracy=0.962, val_loss=0.44, val_accuracy=0.902, lr=0.001] 95%|█████████▌| 143/150 [47:48<02:16, 19.55s/epoch, loss=0.245, accuracy=0.961, val_loss=0.474, val_accuracy=0.889, lr=0.001] 96%|█████████▌| 144/150 [48:07<01:57, 19.58s/epoch, loss=0.24, accuracy=0.962, val_loss=0.469, val_accuracy=0.893, lr=0.001]  97%|█████████▋| 145/150 [48:27<01:37, 19.59s/epoch, loss=0.238, accuracy=0.961, val_loss=0.464, val_accuracy=0.896, lr=0.001] 97%|█████████▋| 146/150 [48:46<01:18, 19.60s/epoch, loss=0.233, accuracy=0.963, val_loss=0.5, val_accuracy=0.887, lr=0.001]   98%|█████████▊| 147/150 [49:06<00:58, 19.61s/epoch, loss=0.231, accuracy=0.963, val_loss=0.449, val_accuracy=0.895, lr=0.000316] 99%|█████████▊| 148/150 [49:26<00:39, 19.63s/epoch, loss=0.231, accuracy=0.962, val_loss=0.475, val_accuracy=0.895, lr=0.001]    99%|█████████▉| 149/150 [49:45<00:19, 19.58s/epoch, loss=0.225, accuracy=0.964, val_loss=0.433, val_accuracy=0.898, lr=0.001]100%|██████████| 150/150 [50:05<00:00, 19.60s/epoch, loss=0.225, accuracy=0.963, val_loss=0.463, val_accuracy=0.895, lr=0.001]100%|██████████| 150/150 [50:05<00:00, 20.04s/epoch, loss=0.225, accuracy=0.963, val_loss=0.463, val_accuracy=0.895, lr=0.001]
Using real-time data augmentation.
Test score: 0.4628662168979645
Test accuracy: 0.894599974155426


* * * Run SGD for ID = 10_8. * * *


2024-03-05 07:20:39.754572: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 07:20:43.645112: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 07:20:43.646314: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-05 07:20:43.683272: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-03-05 07:20:43.683326: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 07:20:43.687512: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 07:20:43.687551: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-05 07:20:43.690863: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-05 07:20:43.692001: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-05 07:20:43.694826: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-05 07:20:43.696699: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-05 07:20:43.701899: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 07:20:43.702531: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-05 07:20:43.702617: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 07:20:44.924287: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-05 07:20:44.924843: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 07:20:44.925632: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-03-05 07:20:44.925662: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 07:20:44.925700: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 07:20:44.925717: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-05 07:20:44.925733: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-05 07:20:44.925749: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-05 07:20:44.925764: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-05 07:20:44.925779: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-05 07:20:44.925794: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 07:20:44.926253: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-05 07:20:44.926291: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 07:20:45.610754: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-05 07:20:45.610811: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-05 07:20:45.610820: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-05 07:20:45.611811: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11227 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN X (Pascal), pci bus id: 0000:83:00.0, compute capability: 6.1)
{'id': '10_08', 'seed': 8, 'out_folder': 'results/epoch_budget', 'batch_size': 128, 'epochs': 150, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN X (Pascal)'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/150 [00:00<?, ?epoch/s]2024-03-05 07:20:46.597951: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-05 07:20:46.610116: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2600020000 Hz
2024-03-05 07:20:48.672637: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 07:20:48.915877: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 07:20:49.796406: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-05 07:20:49.858908: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/150 [01:04<2:40:26, 64.61s/epoch, loss=2.79, accuracy=0.422, val_loss=1.92, val_accuracy=0.447, lr=0.1]  1%|▏         | 2/150 [01:24<1:34:40, 38.38s/epoch, loss=1.42, accuracy=0.611, val_loss=2.21, val_accuracy=0.456, lr=0.1]  2%|▏         | 3/150 [01:44<1:13:28, 29.99s/epoch, loss=1.27, accuracy=0.674, val_loss=1.93, val_accuracy=0.476, lr=0.1]  3%|▎         | 4/150 [02:04<1:03:21, 26.04s/epoch, loss=1.24, accuracy=0.699, val_loss=2.14, val_accuracy=0.423, lr=0.1]  3%|▎         | 5/150 [02:24<57:27, 23.77s/epoch, loss=1.21, accuracy=0.715, val_loss=1.8, val_accuracy=0.547, lr=0.1]     4%|▍         | 6/150 [02:44<53:50, 22.43s/epoch, loss=1.2, accuracy=0.721, val_loss=1.85, val_accuracy=0.532, lr=0.1]  5%|▍         | 7/150 [03:04<51:29, 21.60s/epoch, loss=1.18, accuracy=0.73, val_loss=2.2, val_accuracy=0.487, lr=0.1]   5%|▌         | 8/150 [03:23<49:43, 21.01s/epoch, loss=1.17, accuracy=0.734, val_loss=1.59, val_accuracy=0.587, lr=0.1]  6%|▌         | 9/150 [03:43<48:43, 20.74s/epoch, loss=1.17, accuracy=0.736, val_loss=1.71, val_accuracy=0.572, lr=0.1]  7%|▋         | 10/150 [04:03<47:39, 20.42s/epoch, loss=1.17, accuracy=0.739, val_loss=2.18, val_accuracy=0.49, lr=0.1]  7%|▋         | 11/150 [04:23<46:58, 20.28s/epoch, loss=1.16, accuracy=0.741, val_loss=2.13, val_accuracy=0.457, lr=0.1]  8%|▊         | 12/150 [04:43<46:25, 20.19s/epoch, loss=1.15, accuracy=0.748, val_loss=2.61, val_accuracy=0.369, lr=0.1]  9%|▊         | 13/150 [05:03<45:59, 20.15s/epoch, loss=1.15, accuracy=0.747, val_loss=2.48, val_accuracy=0.455, lr=0.0316]  9%|▉         | 14/150 [05:23<45:30, 20.07s/epoch, loss=1.15, accuracy=0.747, val_loss=2.87, val_accuracy=0.453, lr=0.1]    10%|█         | 15/150 [05:43<45:19, 20.15s/epoch, loss=1.14, accuracy=0.75, val_loss=2.06, val_accuracy=0.564, lr=0.1]  11%|█         | 16/150 [06:03<44:45, 20.04s/epoch, loss=1.14, accuracy=0.75, val_loss=2.07, val_accuracy=0.475, lr=0.1] 11%|█▏        | 17/150 [06:23<44:26, 20.05s/epoch, loss=1.14, accuracy=0.75, val_loss=2.38, val_accuracy=0.412, lr=0.1] 12%|█▏        | 18/150 [06:43<44:01, 20.01s/epoch, loss=1.14, accuracy=0.75, val_loss=2.41, val_accuracy=0.478, lr=0.0316] 13%|█▎        | 19/150 [07:03<43:44, 20.04s/epoch, loss=1.14, accuracy=0.754, val_loss=1.89, val_accuracy=0.514, lr=0.1]   13%|█▎        | 20/150 [07:23<43:17, 19.98s/epoch, loss=1.13, accuracy=0.755, val_loss=2.26, val_accuracy=0.491, lr=0.1] 14%|█▍        | 21/150 [07:43<42:52, 19.94s/epoch, loss=1.13, accuracy=0.753, val_loss=2.53, val_accuracy=0.408, lr=0.1] 15%|█▍        | 22/150 [08:03<42:37, 19.98s/epoch, loss=1.13, accuracy=0.754, val_loss=2.21, val_accuracy=0.473, lr=0.1] 15%|█▌        | 23/150 [08:23<42:12, 19.94s/epoch, loss=1.13, accuracy=0.75, val_loss=1.88, val_accuracy=0.54, lr=0.0316] 16%|█▌        | 24/150 [08:43<42:07, 20.06s/epoch, loss=1.13, accuracy=0.752, val_loss=1.83, val_accuracy=0.541, lr=0.1]  17%|█▋        | 25/150 [09:03<41:43, 20.03s/epoch, loss=1.13, accuracy=0.757, val_loss=1.46, val_accuracy=0.639, lr=0.1] 17%|█▋        | 26/150 [09:23<41:19, 20.00s/epoch, loss=1.12, accuracy=0.757, val_loss=2.33, val_accuracy=0.424, lr=0.1] 18%|█▊        | 27/150 [09:43<41:08, 20.07s/epoch, loss=1.13, accuracy=0.755, val_loss=2.07, val_accuracy=0.491, lr=0.1] 19%|█▊        | 28/150 [10:04<40:52, 20.10s/epoch, loss=1.12, accuracy=0.756, val_loss=1.97, val_accuracy=0.525, lr=0.1] 19%|█▉        | 29/150 [10:23<40:24, 20.04s/epoch, loss=1.12, accuracy=0.758, val_loss=1.51, val_accuracy=0.612, lr=0.1] 20%|██        | 30/150 [10:43<39:56, 19.97s/epoch, loss=1.12, accuracy=0.757, val_loss=2.13, val_accuracy=0.438, lr=0.0316] 21%|██        | 31/150 [11:03<39:31, 19.93s/epoch, loss=1.12, accuracy=0.757, val_loss=1.73, val_accuracy=0.563, lr=0.1]    21%|██▏       | 32/150 [11:23<39:10, 19.92s/epoch, loss=1.12, accuracy=0.758, val_loss=2.22, val_accuracy=0.464, lr=0.1] 22%|██▏       | 33/150 [11:43<38:41, 19.84s/epoch, loss=1.12, accuracy=0.757, val_loss=2.03, val_accuracy=0.449, lr=0.1] 23%|██▎       | 34/150 [12:03<38:26, 19.88s/epoch, loss=1.12, accuracy=0.76, val_loss=1.64, val_accuracy=0.579, lr=0.1]  23%|██▎       | 35/150 [12:22<38:02, 19.85s/epoch, loss=1.11, accuracy=0.759, val_loss=1.89, val_accuracy=0.509, lr=0.0316] 24%|██▍       | 36/150 [12:42<37:35, 19.78s/epoch, loss=1.12, accuracy=0.76, val_loss=1.69, val_accuracy=0.565, lr=0.1]     25%|██▍       | 37/150 [13:02<37:16, 19.79s/epoch, loss=1.12, accuracy=0.759, val_loss=2.11, val_accuracy=0.451, lr=0.1] 25%|██▌       | 38/150 [13:22<36:54, 19.77s/epoch, loss=1.11, accuracy=0.759, val_loss=2, val_accuracy=0.508, lr=0.1]    26%|██▌       | 39/150 [13:41<36:27, 19.71s/epoch, loss=1.11, accuracy=0.759, val_loss=2.69, val_accuracy=0.379, lr=0.1] 27%|██▋       | 40/150 [14:01<36:13, 19.76s/epoch, loss=1.11, accuracy=0.761, val_loss=3.21, val_accuracy=0.332, lr=0.0316] 27%|██▋       | 41/150 [14:21<35:54, 19.76s/epoch, loss=1.11, accuracy=0.761, val_loss=1.75, val_accuracy=0.571, lr=0.1]    28%|██▊       | 42/150 [14:40<35:22, 19.65s/epoch, loss=1.11, accuracy=0.759, val_loss=1.44, val_accuracy=0.653, lr=0.1] 29%|██▊       | 43/150 [15:00<35:11, 19.73s/epoch, loss=1.11, accuracy=0.76, val_loss=2.35, val_accuracy=0.454, lr=0.1]  29%|██▉       | 44/150 [15:20<34:44, 19.67s/epoch, loss=1.11, accuracy=0.758, val_loss=2.07, val_accuracy=0.467, lr=0.1] 30%|███       | 45/150 [15:39<34:31, 19.73s/epoch, loss=1.11, accuracy=0.76, val_loss=1.91, val_accuracy=0.538, lr=0.1]  31%|███       | 46/150 [15:59<34:05, 19.67s/epoch, loss=1.12, accuracy=0.759, val_loss=2.12, val_accuracy=0.49, lr=0.1] 31%|███▏      | 47/150 [16:19<33:42, 19.63s/epoch, loss=1.12, accuracy=0.758, val_loss=2.48, val_accuracy=0.449, lr=0.0316] 32%|███▏      | 48/150 [16:38<33:15, 19.56s/epoch, loss=1.11, accuracy=0.76, val_loss=1.73, val_accuracy=0.584, lr=0.1]     33%|███▎      | 49/150 [16:57<32:49, 19.50s/epoch, loss=1.11, accuracy=0.76, val_loss=3.82, val_accuracy=0.385, lr=0.1] 33%|███▎      | 50/150 [17:17<32:36, 19.57s/epoch, loss=1.11, accuracy=0.758, val_loss=1.85, val_accuracy=0.545, lr=0.1] 34%|███▍      | 51/150 [17:36<32:08, 19.48s/epoch, loss=1.11, accuracy=0.761, val_loss=1.48, val_accuracy=0.628, lr=0.1] 35%|███▍      | 52/150 [17:56<32:00, 19.60s/epoch, loss=1.11, accuracy=0.757, val_loss=2.1, val_accuracy=0.502, lr=0.0316] 35%|███▌      | 53/150 [18:16<31:40, 19.59s/epoch, loss=1.1, accuracy=0.764, val_loss=1.82, val_accuracy=0.561, lr=0.1]    36%|███▌      | 54/150 [18:36<31:26, 19.65s/epoch, loss=1.11, accuracy=0.759, val_loss=1.81, val_accuracy=0.533, lr=0.1] 37%|███▋      | 55/150 [18:55<31:10, 19.69s/epoch, loss=1.11, accuracy=0.757, val_loss=1.63, val_accuracy=0.59, lr=0.1]  37%|███▋      | 56/150 [19:15<30:47, 19.66s/epoch, loss=1.11, accuracy=0.761, val_loss=2.08, val_accuracy=0.504, lr=0.1] 38%|███▊      | 57/150 [19:34<30:25, 19.63s/epoch, loss=1.11, accuracy=0.761, val_loss=1.6, val_accuracy=0.603, lr=0.0316] 39%|███▊      | 58/150 [19:54<30:14, 19.72s/epoch, loss=1.1, accuracy=0.761, val_loss=2.2, val_accuracy=0.473, lr=0.1]     39%|███▉      | 59/150 [20:15<30:07, 19.86s/epoch, loss=1.11, accuracy=0.759, val_loss=3.06, val_accuracy=0.384, lr=0.1] 40%|████      | 60/150 [20:34<29:49, 19.88s/epoch, loss=1.11, accuracy=0.759, val_loss=1.84, val_accuracy=0.545, lr=0.1] 41%|████      | 61/150 [20:54<29:29, 19.88s/epoch, loss=1.11, accuracy=0.76, val_loss=2.09, val_accuracy=0.481, lr=0.1]  41%|████▏     | 62/150 [21:14<29:08, 19.87s/epoch, loss=1.11, accuracy=0.761, val_loss=1.89, val_accuracy=0.486, lr=0.0316] 42%|████▏     | 63/150 [21:34<28:46, 19.85s/epoch, loss=1.11, accuracy=0.761, val_loss=1.74, val_accuracy=0.57, lr=0.1]     43%|████▎     | 64/150 [21:54<28:27, 19.85s/epoch, loss=1.11, accuracy=0.762, val_loss=1.68, val_accuracy=0.554, lr=0.1] 43%|████▎     | 65/150 [22:14<28:06, 19.85s/epoch, loss=1.11, accuracy=0.759, val_loss=1.89, val_accuracy=0.566, lr=0.1] 44%|████▍     | 66/150 [22:33<27:43, 19.80s/epoch, loss=1.1, accuracy=0.761, val_loss=3.12, val_accuracy=0.263, lr=0.1]  45%|████▍     | 67/150 [22:53<27:21, 19.77s/epoch, loss=1.11, accuracy=0.759, val_loss=1.63, val_accuracy=0.601, lr=0.0316] 45%|████▌     | 68/150 [23:13<27:06, 19.84s/epoch, loss=1.1, accuracy=0.76, val_loss=1.96, val_accuracy=0.499, lr=0.1]      46%|████▌     | 69/150 [23:33<26:44, 19.81s/epoch, loss=1.11, accuracy=0.761, val_loss=1.64, val_accuracy=0.598, lr=0.1] 47%|████▋     | 70/150 [23:53<26:27, 19.84s/epoch, loss=1.1, accuracy=0.763, val_loss=2.62, val_accuracy=0.39, lr=0.1]   47%|████▋     | 71/150 [24:12<26:05, 19.81s/epoch, loss=1.1, accuracy=0.759, val_loss=1.77, val_accuracy=0.54, lr=0.1] 48%|████▊     | 72/150 [24:32<25:45, 19.82s/epoch, loss=1.11, accuracy=0.76, val_loss=1.52, val_accuracy=0.627, lr=0.0316] 49%|████▊     | 73/150 [24:52<25:23, 19.78s/epoch, loss=1.1, accuracy=0.761, val_loss=2.35, val_accuracy=0.342, lr=0.1]    49%|████▉     | 74/150 [25:12<25:02, 19.77s/epoch, loss=1.11, accuracy=0.76, val_loss=2.05, val_accuracy=0.429, lr=0.1] 50%|█████     | 75/150 [25:32<24:43, 19.78s/epoch, loss=1.11, accuracy=0.762, val_loss=2.17, val_accuracy=0.453, lr=0.1] 51%|█████     | 76/150 [25:52<24:28, 19.85s/epoch, loss=1.1, accuracy=0.76, val_loss=1.87, val_accuracy=0.572, lr=0.1]   51%|█████▏    | 77/150 [26:11<24:09, 19.86s/epoch, loss=1.11, accuracy=0.757, val_loss=1.95, val_accuracy=0.564, lr=0.0316] 52%|█████▏    | 78/150 [26:31<23:50, 19.86s/epoch, loss=1.1, accuracy=0.763, val_loss=1.93, val_accuracy=0.525, lr=0.1]     53%|█████▎    | 79/150 [26:51<23:34, 19.93s/epoch, loss=1.1, accuracy=0.763, val_loss=2.05, val_accuracy=0.505, lr=0.1] 53%|█████▎    | 80/150 [27:11<23:13, 19.91s/epoch, loss=1.1, accuracy=0.759, val_loss=1.96, val_accuracy=0.486, lr=0.1] 54%|█████▍    | 81/150 [27:31<22:52, 19.89s/epoch, loss=1.1, accuracy=0.763, val_loss=2, val_accuracy=0.522, lr=0.1]    55%|█████▍    | 82/150 [27:51<22:32, 19.90s/epoch, loss=0.884, accuracy=0.821, val_loss=0.871, val_accuracy=0.81, lr=0.01] 55%|█████▌    | 83/150 [28:11<22:07, 19.81s/epoch, loss=0.714, accuracy=0.849, val_loss=0.791, val_accuracy=0.814, lr=0.01] 56%|█████▌    | 84/150 [28:30<21:44, 19.76s/epoch, loss=0.636, accuracy=0.859, val_loss=0.798, val_accuracy=0.802, lr=0.01] 57%|█████▋    | 85/150 [28:50<21:31, 19.88s/epoch, loss=0.597, accuracy=0.861, val_loss=0.88, val_accuracy=0.767, lr=0.01]  57%|█████▋    | 86/150 [29:10<21:13, 19.90s/epoch, loss=0.577, accuracy=0.863, val_loss=1.09, val_accuracy=0.718, lr=0.01] 58%|█████▊    | 87/150 [29:30<20:54, 19.91s/epoch, loss=0.568, accuracy=0.863, val_loss=1.1, val_accuracy=0.695, lr=0.01]  59%|█████▊    | 88/150 [29:50<20:33, 19.90s/epoch, loss=0.559, accuracy=0.865, val_loss=0.801, val_accuracy=0.777, lr=0.00316] 59%|█████▉    | 89/150 [30:10<20:09, 19.84s/epoch, loss=0.555, accuracy=0.868, val_loss=0.966, val_accuracy=0.729, lr=0.01]    60%|██████    | 90/150 [30:30<19:54, 19.90s/epoch, loss=0.554, accuracy=0.867, val_loss=0.752, val_accuracy=0.799, lr=0.01] 61%|██████    | 91/150 [30:50<19:31, 19.85s/epoch, loss=0.552, accuracy=0.869, val_loss=0.842, val_accuracy=0.773, lr=0.01] 61%|██████▏   | 92/150 [31:10<19:13, 19.88s/epoch, loss=0.548, accuracy=0.87, val_loss=1.08, val_accuracy=0.736, lr=0.01]   62%|██████▏   | 93/150 [31:29<18:50, 19.84s/epoch, loss=0.549, accuracy=0.872, val_loss=0.83, val_accuracy=0.779, lr=0.01] 63%|██████▎   | 94/150 [31:49<18:30, 19.83s/epoch, loss=0.549, accuracy=0.874, val_loss=0.722, val_accuracy=0.819, lr=0.01] 63%|██████▎   | 95/150 [32:09<18:09, 19.82s/epoch, loss=0.548, accuracy=0.873, val_loss=0.759, val_accuracy=0.804, lr=0.01] 64%|██████▍   | 96/150 [32:29<17:48, 19.80s/epoch, loss=0.548, accuracy=0.875, val_loss=0.779, val_accuracy=0.803, lr=0.01] 65%|██████▍   | 97/150 [32:49<17:29, 19.80s/epoch, loss=0.546, accuracy=0.877, val_loss=0.725, val_accuracy=0.818, lr=0.01] 65%|██████▌   | 98/150 [33:08<17:07, 19.76s/epoch, loss=0.55, accuracy=0.877, val_loss=0.773, val_accuracy=0.807, lr=0.01]  66%|██████▌   | 99/150 [33:28<16:45, 19.71s/epoch, loss=0.546, accuracy=0.877, val_loss=0.684, val_accuracy=0.83, lr=0.01] 67%|██████▋   | 100/150 [33:48<16:28, 19.78s/epoch, loss=0.545, accuracy=0.877, val_loss=0.74, val_accuracy=0.817, lr=0.01] 67%|██████▋   | 101/150 [34:07<16:06, 19.72s/epoch, loss=0.544, accuracy=0.88, val_loss=0.836, val_accuracy=0.79, lr=0.01]  68%|██████▊   | 102/150 [34:27<15:48, 19.76s/epoch, loss=0.548, accuracy=0.88, val_loss=0.773, val_accuracy=0.804, lr=0.01] 69%|██████▊   | 103/150 [34:47<15:27, 19.74s/epoch, loss=0.548, accuracy=0.879, val_loss=0.883, val_accuracy=0.765, lr=0.01] 69%|██████▉   | 104/150 [35:07<15:10, 19.79s/epoch, loss=0.543, accuracy=0.88, val_loss=0.807, val_accuracy=0.79, lr=0.00316] 70%|███████   | 105/150 [35:26<14:49, 19.77s/epoch, loss=0.544, accuracy=0.879, val_loss=0.771, val_accuracy=0.812, lr=0.01]  71%|███████   | 106/150 [35:46<14:32, 19.83s/epoch, loss=0.544, accuracy=0.882, val_loss=1.29, val_accuracy=0.67, lr=0.01]   71%|███████▏  | 107/150 [36:06<14:12, 19.83s/epoch, loss=0.543, accuracy=0.884, val_loss=0.78, val_accuracy=0.813, lr=0.01] 72%|███████▏  | 108/150 [36:26<13:50, 19.77s/epoch, loss=0.547, accuracy=0.879, val_loss=1.2, val_accuracy=0.712, lr=0.01]  73%|███████▎  | 109/150 [36:46<13:29, 19.73s/epoch, loss=0.547, accuracy=0.881, val_loss=0.81, val_accuracy=0.795, lr=0.00316] 73%|███████▎  | 110/150 [37:05<13:09, 19.73s/epoch, loss=0.544, accuracy=0.884, val_loss=0.85, val_accuracy=0.789, lr=0.01]    74%|███████▍  | 111/150 [37:25<12:47, 19.67s/epoch, loss=0.546, accuracy=0.883, val_loss=0.862, val_accuracy=0.781, lr=0.01] 75%|███████▍  | 112/150 [37:44<12:27, 19.67s/epoch, loss=0.543, accuracy=0.884, val_loss=0.772, val_accuracy=0.815, lr=0.01] 75%|███████▌  | 113/150 [38:04<12:08, 19.68s/epoch, loss=0.543, accuracy=0.885, val_loss=0.945, val_accuracy=0.773, lr=0.01] 76%|███████▌  | 114/150 [38:24<11:48, 19.67s/epoch, loss=0.545, accuracy=0.884, val_loss=0.775, val_accuracy=0.821, lr=0.00316] 77%|███████▋  | 115/150 [38:44<11:28, 19.67s/epoch, loss=0.542, accuracy=0.886, val_loss=0.783, val_accuracy=0.824, lr=0.01]    77%|███████▋  | 116/150 [39:03<11:09, 19.68s/epoch, loss=0.544, accuracy=0.885, val_loss=0.853, val_accuracy=0.798, lr=0.01] 78%|███████▊  | 117/150 [39:23<10:49, 19.68s/epoch, loss=0.544, accuracy=0.885, val_loss=0.94, val_accuracy=0.769, lr=0.01]  79%|███████▊  | 118/150 [39:43<10:31, 19.73s/epoch, loss=0.548, accuracy=0.884, val_loss=0.733, val_accuracy=0.832, lr=0.01] 79%|███████▉  | 119/150 [40:02<10:11, 19.72s/epoch, loss=0.54, accuracy=0.887, val_loss=1.14, val_accuracy=0.718, lr=0.00316] 80%|████████  | 120/150 [40:22<09:50, 19.67s/epoch, loss=0.54, accuracy=0.887, val_loss=0.968, val_accuracy=0.769, lr=0.01]   81%|████████  | 121/150 [40:42<09:31, 19.69s/epoch, loss=0.547, accuracy=0.885, val_loss=0.772, val_accuracy=0.811, lr=0.01] 81%|████████▏ | 122/150 [41:01<09:10, 19.67s/epoch, loss=0.473, accuracy=0.912, val_loss=0.528, val_accuracy=0.891, lr=0.001] 82%|████████▏ | 123/150 [41:21<08:50, 19.63s/epoch, loss=0.423, accuracy=0.928, val_loss=0.507, val_accuracy=0.897, lr=0.001] 83%|████████▎ | 124/150 [41:40<08:30, 19.62s/epoch, loss=0.4, accuracy=0.934, val_loss=0.494, val_accuracy=0.899, lr=0.001]   83%|████████▎ | 125/150 [42:00<08:10, 19.63s/epoch, loss=0.384, accuracy=0.936, val_loss=0.483, val_accuracy=0.902, lr=0.001] 84%|████████▍ | 126/150 [42:20<07:51, 19.66s/epoch, loss=0.368, accuracy=0.94, val_loss=0.477, val_accuracy=0.902, lr=0.001]  85%|████████▍ | 127/150 [42:39<07:31, 19.63s/epoch, loss=0.356, accuracy=0.943, val_loss=0.479, val_accuracy=0.901, lr=0.001] 85%|████████▌ | 128/150 [42:59<07:13, 19.69s/epoch, loss=0.346, accuracy=0.944, val_loss=0.471, val_accuracy=0.901, lr=0.001] 86%|████████▌ | 129/150 [43:19<06:53, 19.69s/epoch, loss=0.336, accuracy=0.947, val_loss=0.458, val_accuracy=0.903, lr=0.001] 87%|████████▋ | 130/150 [43:39<06:33, 19.66s/epoch, loss=0.327, accuracy=0.947, val_loss=0.461, val_accuracy=0.904, lr=0.001] 87%|████████▋ | 131/150 [43:58<06:14, 19.73s/epoch, loss=0.318, accuracy=0.949, val_loss=0.468, val_accuracy=0.9, lr=0.001]   88%|████████▊ | 132/150 [44:18<05:55, 19.73s/epoch, loss=0.31, accuracy=0.951, val_loss=0.477, val_accuracy=0.898, lr=0.001] 89%|████████▊ | 133/150 [44:38<05:34, 19.69s/epoch, loss=0.301, accuracy=0.952, val_loss=0.459, val_accuracy=0.899, lr=0.001] 89%|████████▉ | 134/150 [44:58<05:15, 19.72s/epoch, loss=0.293, accuracy=0.953, val_loss=0.471, val_accuracy=0.895, lr=0.000316] 90%|█████████ | 135/150 [45:17<04:55, 19.71s/epoch, loss=0.29, accuracy=0.952, val_loss=0.457, val_accuracy=0.903, lr=0.001]     91%|█████████ | 136/150 [45:37<04:36, 19.74s/epoch, loss=0.281, accuracy=0.955, val_loss=0.462, val_accuracy=0.901, lr=0.001] 91%|█████████▏| 137/150 [45:57<04:15, 19.67s/epoch, loss=0.274, accuracy=0.957, val_loss=0.437, val_accuracy=0.904, lr=0.001] 92%|█████████▏| 138/150 [46:16<03:56, 19.70s/epoch, loss=0.271, accuracy=0.956, val_loss=0.45, val_accuracy=0.898, lr=0.001]  93%|█████████▎| 139/150 [46:36<03:36, 19.66s/epoch, loss=0.265, accuracy=0.957, val_loss=0.472, val_accuracy=0.894, lr=0.001] 93%|█████████▎| 140/150 [46:55<03:16, 19.65s/epoch, loss=0.26, accuracy=0.957, val_loss=0.45, val_accuracy=0.9, lr=0.001]     94%|█████████▍| 141/150 [47:15<02:57, 19.73s/epoch, loss=0.258, accuracy=0.957, val_loss=0.449, val_accuracy=0.893, lr=0.001] 95%|█████████▍| 142/150 [47:35<02:38, 19.76s/epoch, loss=0.253, accuracy=0.958, val_loss=0.463, val_accuracy=0.895, lr=0.000316] 95%|█████████▌| 143/150 [47:55<02:18, 19.80s/epoch, loss=0.249, accuracy=0.959, val_loss=0.451, val_accuracy=0.896, lr=0.001]    96%|█████████▌| 144/150 [48:15<01:58, 19.79s/epoch, loss=0.245, accuracy=0.959, val_loss=0.458, val_accuracy=0.897, lr=0.001] 97%|█████████▋| 145/150 [48:35<01:39, 19.80s/epoch, loss=0.242, accuracy=0.961, val_loss=0.454, val_accuracy=0.897, lr=0.001] 97%|█████████▋| 146/150 [48:54<01:19, 19.77s/epoch, loss=0.238, accuracy=0.96, val_loss=0.442, val_accuracy=0.895, lr=0.001]  98%|█████████▊| 147/150 [49:14<00:59, 19.79s/epoch, loss=0.236, accuracy=0.959, val_loss=0.459, val_accuracy=0.892, lr=0.000316] 99%|█████████▊| 148/150 [49:34<00:39, 19.81s/epoch, loss=0.231, accuracy=0.96, val_loss=0.465, val_accuracy=0.894, lr=0.001]     99%|█████████▉| 149/150 [49:54<00:19, 19.85s/epoch, loss=0.231, accuracy=0.96, val_loss=0.467, val_accuracy=0.891, lr=0.001]100%|██████████| 150/150 [50:14<00:00, 19.90s/epoch, loss=0.227, accuracy=0.961, val_loss=0.452, val_accuracy=0.896, lr=0.001]100%|██████████| 150/150 [50:14<00:00, 20.10s/epoch, loss=0.227, accuracy=0.961, val_loss=0.452, val_accuracy=0.896, lr=0.001]
Using real-time data augmentation.
Test score: 0.4521981477737427
Test accuracy: 0.8955000042915344


* * * Run SGD for ID = 10_9. * * *


2024-03-05 08:11:04.786289: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 08:11:07.656146: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 08:11:07.657330: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-05 08:11:07.694411: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-03-05 08:11:07.694457: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 08:11:07.697388: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 08:11:07.697427: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-05 08:11:07.699860: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-05 08:11:07.700628: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-05 08:11:07.703240: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-05 08:11:07.704905: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-05 08:11:07.709435: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 08:11:07.710044: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-05 08:11:07.710128: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 08:11:08.987064: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-05 08:11:08.988178: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 08:11:08.988929: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-03-05 08:11:08.988981: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 08:11:08.989019: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 08:11:08.989037: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-05 08:11:08.989052: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-05 08:11:08.989069: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-05 08:11:08.989084: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-05 08:11:08.989098: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-05 08:11:08.989113: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 08:11:08.989540: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-05 08:11:08.989578: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 08:11:09.641882: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-05 08:11:09.641933: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-05 08:11:09.641942: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-05 08:11:09.642847: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11227 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN X (Pascal), pci bus id: 0000:83:00.0, compute capability: 6.1)
{'id': '10_09', 'seed': 9, 'out_folder': 'results/epoch_budget', 'batch_size': 128, 'epochs': 150, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN X (Pascal)'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/150 [00:00<?, ?epoch/s]2024-03-05 08:11:10.526254: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-05 08:11:10.538126: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2600020000 Hz
2024-03-05 08:11:12.563948: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 08:11:12.796539: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 08:11:13.666753: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-05 08:11:13.721924: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/150 [01:02<2:36:23, 62.97s/epoch, loss=2.81, accuracy=0.412, val_loss=2.82, val_accuracy=0.255, lr=0.1]  1%|▏         | 2/150 [01:23<1:33:54, 38.07s/epoch, loss=1.43, accuracy=0.616, val_loss=2.6, val_accuracy=0.377, lr=0.1]   2%|▏         | 3/150 [01:44<1:13:41, 30.08s/epoch, loss=1.29, accuracy=0.679, val_loss=1.58, val_accuracy=0.568, lr=0.1]  3%|▎         | 4/150 [02:04<1:03:53, 26.26s/epoch, loss=1.25, accuracy=0.702, val_loss=3.34, val_accuracy=0.221, lr=0.1]  3%|▎         | 5/150 [02:24<58:15, 24.11s/epoch, loss=1.23, accuracy=0.716, val_loss=1.56, val_accuracy=0.597, lr=0.1]    4%|▍         | 6/150 [02:45<54:44, 22.81s/epoch, loss=1.22, accuracy=0.722, val_loss=2.06, val_accuracy=0.477, lr=0.1]  5%|▍         | 7/150 [03:05<52:28, 22.02s/epoch, loss=1.2, accuracy=0.726, val_loss=1.99, val_accuracy=0.503, lr=0.1]   5%|▌         | 8/150 [03:25<50:55, 21.52s/epoch, loss=1.19, accuracy=0.73, val_loss=1.68, val_accuracy=0.54, lr=0.1]   6%|▌         | 9/150 [03:46<49:40, 21.14s/epoch, loss=1.19, accuracy=0.735, val_loss=1.46, val_accuracy=0.638, lr=0.1]  7%|▋         | 10/150 [04:06<48:44, 20.89s/epoch, loss=1.17, accuracy=0.74, val_loss=2.41, val_accuracy=0.448, lr=0.1]  7%|▋         | 11/150 [04:27<48:10, 20.79s/epoch, loss=1.17, accuracy=0.738, val_loss=2.57, val_accuracy=0.407, lr=0.1]  8%|▊         | 12/150 [04:47<47:37, 20.70s/epoch, loss=1.16, accuracy=0.743, val_loss=1.98, val_accuracy=0.513, lr=0.1]  9%|▊         | 13/150 [05:08<47:10, 20.66s/epoch, loss=1.16, accuracy=0.744, val_loss=5.84, val_accuracy=0.104, lr=0.1]  9%|▉         | 14/150 [05:29<46:53, 20.69s/epoch, loss=1.15, accuracy=0.747, val_loss=2.26, val_accuracy=0.416, lr=0.0316] 10%|█         | 15/150 [05:49<46:16, 20.56s/epoch, loss=1.15, accuracy=0.747, val_loss=2.23, val_accuracy=0.495, lr=0.1]    11%|█         | 16/150 [06:09<45:51, 20.53s/epoch, loss=1.15, accuracy=0.748, val_loss=2.24, val_accuracy=0.473, lr=0.1] 11%|█▏        | 17/150 [06:30<45:34, 20.56s/epoch, loss=1.15, accuracy=0.749, val_loss=1.57, val_accuracy=0.59, lr=0.1]  12%|█▏        | 18/150 [06:50<45:05, 20.49s/epoch, loss=1.14, accuracy=0.75, val_loss=2.02, val_accuracy=0.493, lr=0.1] 13%|█▎        | 19/150 [07:11<44:44, 20.49s/epoch, loss=1.14, accuracy=0.748, val_loss=3.52, val_accuracy=0.324, lr=0.0316] 13%|█▎        | 20/150 [07:31<44:15, 20.43s/epoch, loss=1.15, accuracy=0.749, val_loss=2.19, val_accuracy=0.451, lr=0.1]    14%|█▍        | 21/150 [07:51<43:45, 20.36s/epoch, loss=1.13, accuracy=0.751, val_loss=1.75, val_accuracy=0.521, lr=0.1] 15%|█▍        | 22/150 [08:12<43:31, 20.40s/epoch, loss=1.14, accuracy=0.753, val_loss=1.86, val_accuracy=0.486, lr=0.1] 15%|█▌        | 23/150 [08:32<43:12, 20.41s/epoch, loss=1.13, accuracy=0.753, val_loss=2.01, val_accuracy=0.496, lr=0.1] 16%|█▌        | 24/150 [08:52<42:43, 20.34s/epoch, loss=1.13, accuracy=0.756, val_loss=2.32, val_accuracy=0.471, lr=0.0316] 17%|█▋        | 25/150 [09:13<42:21, 20.33s/epoch, loss=1.13, accuracy=0.752, val_loss=2.19, val_accuracy=0.451, lr=0.1]    17%|█▋        | 26/150 [09:33<42:01, 20.34s/epoch, loss=1.12, accuracy=0.753, val_loss=5.21, val_accuracy=0.246, lr=0.1] 18%|█▊        | 27/150 [09:53<41:34, 20.28s/epoch, loss=1.13, accuracy=0.753, val_loss=1.73, val_accuracy=0.549, lr=0.1] 19%|█▊        | 28/150 [10:13<41:17, 20.31s/epoch, loss=1.12, accuracy=0.755, val_loss=1.64, val_accuracy=0.608, lr=0.1] 19%|█▉        | 29/150 [10:33<40:46, 20.22s/epoch, loss=1.12, accuracy=0.756, val_loss=2.43, val_accuracy=0.474, lr=0.0316] 20%|██        | 30/150 [10:54<40:31, 20.27s/epoch, loss=1.12, accuracy=0.758, val_loss=1.54, val_accuracy=0.616, lr=0.1]    21%|██        | 31/150 [11:14<40:01, 20.18s/epoch, loss=1.12, accuracy=0.758, val_loss=1.7, val_accuracy=0.591, lr=0.1]  21%|██▏       | 32/150 [11:34<39:42, 20.19s/epoch, loss=1.12, accuracy=0.756, val_loss=3.39, val_accuracy=0.313, lr=0.1] 22%|██▏       | 33/150 [11:54<39:22, 20.19s/epoch, loss=1.11, accuracy=0.757, val_loss=3.34, val_accuracy=0.295, lr=0.1] 23%|██▎       | 34/150 [12:14<38:57, 20.15s/epoch, loss=1.12, accuracy=0.753, val_loss=1.98, val_accuracy=0.517, lr=0.0316] 23%|██▎       | 35/150 [12:34<38:33, 20.12s/epoch, loss=1.12, accuracy=0.756, val_loss=3.35, val_accuracy=0.444, lr=0.1]    24%|██▍       | 36/150 [12:54<38:13, 20.12s/epoch, loss=1.11, accuracy=0.757, val_loss=2.15, val_accuracy=0.493, lr=0.1] 25%|██▍       | 37/150 [13:15<37:51, 20.10s/epoch, loss=1.12, accuracy=0.757, val_loss=1.58, val_accuracy=0.602, lr=0.1] 25%|██▌       | 38/150 [13:35<37:32, 20.11s/epoch, loss=1.11, accuracy=0.756, val_loss=2.46, val_accuracy=0.398, lr=0.1] 26%|██▌       | 39/150 [13:55<37:09, 20.09s/epoch, loss=1.11, accuracy=0.759, val_loss=1.95, val_accuracy=0.489, lr=0.0316] 27%|██▋       | 40/150 [14:15<36:51, 20.11s/epoch, loss=1.11, accuracy=0.758, val_loss=3.29, val_accuracy=0.29, lr=0.1]     27%|██▋       | 41/150 [14:35<36:31, 20.10s/epoch, loss=1.12, accuracy=0.759, val_loss=3.08, val_accuracy=0.285, lr=0.1] 28%|██▊       | 42/150 [14:55<36:07, 20.07s/epoch, loss=1.11, accuracy=0.759, val_loss=2.3, val_accuracy=0.396, lr=0.1]  29%|██▊       | 43/150 [15:15<35:43, 20.04s/epoch, loss=1.11, accuracy=0.757, val_loss=2.18, val_accuracy=0.443, lr=0.1] 29%|██▉       | 44/150 [15:35<35:18, 19.99s/epoch, loss=1.11, accuracy=0.756, val_loss=3.41, val_accuracy=0.347, lr=0.0316] 30%|███       | 45/150 [15:55<35:08, 20.08s/epoch, loss=1.11, accuracy=0.76, val_loss=2.65, val_accuracy=0.362, lr=0.1]     31%|███       | 46/150 [16:15<34:45, 20.06s/epoch, loss=1.11, accuracy=0.759, val_loss=2.08, val_accuracy=0.508, lr=0.1] 31%|███▏      | 47/150 [16:35<34:36, 20.16s/epoch, loss=1.11, accuracy=0.759, val_loss=2.26, val_accuracy=0.446, lr=0.1] 32%|███▏      | 48/150 [16:56<34:20, 20.21s/epoch, loss=1.11, accuracy=0.762, val_loss=2.21, val_accuracy=0.453, lr=0.1] 33%|███▎      | 49/150 [17:16<34:04, 20.24s/epoch, loss=1.1, accuracy=0.759, val_loss=2.42, val_accuracy=0.366, lr=0.0316] 33%|███▎      | 50/150 [17:36<33:48, 20.28s/epoch, loss=1.11, accuracy=0.759, val_loss=2.02, val_accuracy=0.545, lr=0.1]   34%|███▍      | 51/150 [17:57<33:20, 20.21s/epoch, loss=1.1, accuracy=0.76, val_loss=2.14, val_accuracy=0.403, lr=0.1]   35%|███▍      | 52/150 [18:17<33:05, 20.27s/epoch, loss=1.1, accuracy=0.761, val_loss=2.49, val_accuracy=0.427, lr=0.1] 35%|███▌      | 53/150 [18:37<32:35, 20.16s/epoch, loss=1.11, accuracy=0.758, val_loss=1.63, val_accuracy=0.581, lr=0.1] 36%|███▌      | 54/150 [18:57<32:15, 20.16s/epoch, loss=1.11, accuracy=0.762, val_loss=1.88, val_accuracy=0.51, lr=0.0316] 37%|███▋      | 55/150 [19:17<31:51, 20.12s/epoch, loss=1.11, accuracy=0.759, val_loss=1.94, val_accuracy=0.475, lr=0.1]   37%|███▋      | 56/150 [19:37<31:31, 20.12s/epoch, loss=1.1, accuracy=0.76, val_loss=1.66, val_accuracy=0.575, lr=0.1]   38%|███▊      | 57/150 [19:58<31:22, 20.24s/epoch, loss=1.11, accuracy=0.76, val_loss=1.79, val_accuracy=0.532, lr=0.1] 39%|███▊      | 58/150 [20:18<31:04, 20.27s/epoch, loss=1.1, accuracy=0.762, val_loss=2.86, val_accuracy=0.35, lr=0.1]  39%|███▉      | 59/150 [20:38<30:39, 20.21s/epoch, loss=1.11, accuracy=0.759, val_loss=1.46, val_accuracy=0.644, lr=0.1] 40%|████      | 60/150 [20:58<30:10, 20.12s/epoch, loss=1.1, accuracy=0.76, val_loss=4.55, val_accuracy=0.242, lr=0.1]   41%|████      | 61/150 [21:18<29:55, 20.17s/epoch, loss=1.1, accuracy=0.762, val_loss=2.27, val_accuracy=0.469, lr=0.1] 41%|████▏     | 62/150 [21:38<29:32, 20.15s/epoch, loss=1.1, accuracy=0.76, val_loss=1.57, val_accuracy=0.617, lr=0.1]  42%|████▏     | 63/150 [21:58<29:12, 20.14s/epoch, loss=1.11, accuracy=0.761, val_loss=1.86, val_accuracy=0.491, lr=0.1] 43%|████▎     | 64/150 [22:19<28:54, 20.17s/epoch, loss=1.1, accuracy=0.759, val_loss=6.19, val_accuracy=0.231, lr=0.0316] 43%|████▎     | 65/150 [22:39<28:36, 20.19s/epoch, loss=1.1, accuracy=0.76, val_loss=10.6, val_accuracy=0.134, lr=0.1]     44%|████▍     | 66/150 [22:59<28:12, 20.15s/epoch, loss=1.11, accuracy=0.759, val_loss=2.42, val_accuracy=0.457, lr=0.1] 45%|████▍     | 67/150 [23:19<27:50, 20.12s/epoch, loss=1.11, accuracy=0.76, val_loss=3.01, val_accuracy=0.409, lr=0.1]  45%|████▌     | 68/150 [23:39<27:29, 20.12s/epoch, loss=1.11, accuracy=0.758, val_loss=1.98, val_accuracy=0.491, lr=0.1] 46%|████▌     | 69/150 [23:59<27:10, 20.13s/epoch, loss=1.1, accuracy=0.762, val_loss=2.49, val_accuracy=0.435, lr=0.0316] 47%|████▋     | 70/150 [24:20<26:54, 20.18s/epoch, loss=1.11, accuracy=0.76, val_loss=2.04, val_accuracy=0.537, lr=0.1]    47%|████▋     | 71/150 [24:40<26:32, 20.16s/epoch, loss=1.11, accuracy=0.759, val_loss=1.65, val_accuracy=0.562, lr=0.1] 48%|████▊     | 72/150 [25:00<26:08, 20.10s/epoch, loss=1.11, accuracy=0.761, val_loss=1.72, val_accuracy=0.548, lr=0.1] 49%|████▊     | 73/150 [25:20<25:50, 20.13s/epoch, loss=1.1, accuracy=0.761, val_loss=2.23, val_accuracy=0.457, lr=0.1]  49%|████▉     | 74/150 [25:40<25:32, 20.17s/epoch, loss=1.11, accuracy=0.758, val_loss=4.16, val_accuracy=0.247, lr=0.0316] 50%|█████     | 75/150 [26:00<25:10, 20.15s/epoch, loss=1.11, accuracy=0.759, val_loss=2.17, val_accuracy=0.447, lr=0.1]    51%|█████     | 76/150 [26:21<24:53, 20.18s/epoch, loss=1.1, accuracy=0.76, val_loss=2.66, val_accuracy=0.442, lr=0.1]   51%|█████▏    | 77/150 [26:41<24:33, 20.19s/epoch, loss=1.1, accuracy=0.759, val_loss=2.66, val_accuracy=0.411, lr=0.1] 52%|█████▏    | 78/150 [27:01<24:09, 20.14s/epoch, loss=1.1, accuracy=0.758, val_loss=1.67, val_accuracy=0.563, lr=0.1] 53%|█████▎    | 79/150 [27:21<23:47, 20.10s/epoch, loss=1.11, accuracy=0.759, val_loss=2.3, val_accuracy=0.419, lr=0.0316] 53%|█████▎    | 80/150 [27:41<23:29, 20.14s/epoch, loss=1.11, accuracy=0.761, val_loss=4.02, val_accuracy=0.252, lr=0.1]   54%|█████▍    | 81/150 [28:01<23:08, 20.13s/epoch, loss=1.1, accuracy=0.761, val_loss=1.45, val_accuracy=0.655, lr=0.1]  55%|█████▍    | 82/150 [28:21<22:46, 20.10s/epoch, loss=0.889, accuracy=0.82, val_loss=0.915, val_accuracy=0.793, lr=0.01] 55%|█████▌    | 83/150 [28:41<22:24, 20.07s/epoch, loss=0.721, accuracy=0.849, val_loss=0.972, val_accuracy=0.749, lr=0.01] 56%|█████▌    | 84/150 [29:01<22:09, 20.14s/epoch, loss=0.639, accuracy=0.857, val_loss=0.762, val_accuracy=0.808, lr=0.01] 57%|█████▋    | 85/150 [29:21<21:44, 20.07s/epoch, loss=0.598, accuracy=0.86, val_loss=0.8, val_accuracy=0.796, lr=0.01]    57%|█████▋    | 86/150 [29:41<21:23, 20.05s/epoch, loss=0.577, accuracy=0.863, val_loss=0.703, val_accuracy=0.817, lr=0.01] 58%|█████▊    | 87/150 [30:01<21:00, 20.01s/epoch, loss=0.568, accuracy=0.863, val_loss=0.775, val_accuracy=0.799, lr=0.01] 59%|█████▊    | 88/150 [30:21<20:40, 20.01s/epoch, loss=0.561, accuracy=0.863, val_loss=0.722, val_accuracy=0.815, lr=0.01] 59%|█████▉    | 89/150 [30:41<20:18, 19.97s/epoch, loss=0.561, accuracy=0.864, val_loss=0.727, val_accuracy=0.808, lr=0.01] 60%|██████    | 90/150 [31:01<19:58, 19.97s/epoch, loss=0.554, accuracy=0.867, val_loss=0.794, val_accuracy=0.794, lr=0.01] 61%|██████    | 91/150 [31:21<19:36, 19.94s/epoch, loss=0.552, accuracy=0.869, val_loss=0.795, val_accuracy=0.797, lr=0.00316] 61%|██████▏   | 92/150 [31:41<19:18, 19.98s/epoch, loss=0.552, accuracy=0.87, val_loss=0.838, val_accuracy=0.793, lr=0.01]     62%|██████▏   | 93/150 [32:01<19:02, 20.05s/epoch, loss=0.55, accuracy=0.872, val_loss=1.33, val_accuracy=0.694, lr=0.01]  63%|██████▎   | 94/150 [32:21<18:40, 20.01s/epoch, loss=0.55, accuracy=0.873, val_loss=0.916, val_accuracy=0.771, lr=0.01] 63%|██████▎   | 95/150 [32:41<18:17, 19.96s/epoch, loss=0.547, accuracy=0.874, val_loss=1.42, val_accuracy=0.681, lr=0.01] 64%|██████▍   | 96/150 [33:01<18:01, 20.03s/epoch, loss=0.551, accuracy=0.873, val_loss=0.778, val_accuracy=0.798, lr=0.00316] 65%|██████▍   | 97/150 [33:21<17:38, 19.97s/epoch, loss=0.543, accuracy=0.877, val_loss=0.863, val_accuracy=0.786, lr=0.01]    65%|██████▌   | 98/150 [33:41<17:19, 19.99s/epoch, loss=0.546, accuracy=0.876, val_loss=0.722, val_accuracy=0.818, lr=0.01] 66%|██████▌   | 99/150 [34:01<16:58, 19.97s/epoch, loss=0.55, accuracy=0.875, val_loss=0.81, val_accuracy=0.8, lr=0.01]     67%|██████▋   | 100/150 [34:21<16:35, 19.92s/epoch, loss=0.547, accuracy=0.877, val_loss=0.746, val_accuracy=0.811, lr=0.01] 67%|██████▋   | 101/150 [34:41<16:16, 19.94s/epoch, loss=0.548, accuracy=0.878, val_loss=0.96, val_accuracy=0.754, lr=0.00316] 68%|██████▊   | 102/150 [35:01<15:58, 19.97s/epoch, loss=0.548, accuracy=0.878, val_loss=0.781, val_accuracy=0.805, lr=0.01]   69%|██████▊   | 103/150 [35:21<15:37, 19.95s/epoch, loss=0.545, accuracy=0.878, val_loss=1.02, val_accuracy=0.752, lr=0.01]  69%|██████▉   | 104/150 [35:41<15:18, 19.97s/epoch, loss=0.546, accuracy=0.879, val_loss=0.917, val_accuracy=0.755, lr=0.01] 70%|███████   | 105/150 [36:01<14:59, 19.99s/epoch, loss=0.545, accuracy=0.88, val_loss=0.822, val_accuracy=0.803, lr=0.01]  71%|███████   | 106/150 [36:21<14:39, 19.99s/epoch, loss=0.546, accuracy=0.881, val_loss=0.742, val_accuracy=0.823, lr=0.00316] 71%|███████▏  | 107/150 [36:41<14:18, 19.97s/epoch, loss=0.543, accuracy=0.881, val_loss=0.759, val_accuracy=0.814, lr=0.01]    72%|███████▏  | 108/150 [37:01<13:58, 19.96s/epoch, loss=0.542, accuracy=0.88, val_loss=0.802, val_accuracy=0.808, lr=0.01]  73%|███████▎  | 109/150 [37:21<13:38, 19.96s/epoch, loss=0.546, accuracy=0.881, val_loss=1.11, val_accuracy=0.697, lr=0.01] 73%|███████▎  | 110/150 [37:41<13:18, 19.96s/epoch, loss=0.54, accuracy=0.883, val_loss=0.816, val_accuracy=0.8, lr=0.01]   74%|███████▍  | 111/150 [38:01<12:58, 19.97s/epoch, loss=0.544, accuracy=0.883, val_loss=0.854, val_accuracy=0.789, lr=0.00316] 75%|███████▍  | 112/150 [38:21<12:39, 19.98s/epoch, loss=0.544, accuracy=0.882, val_loss=0.725, val_accuracy=0.827, lr=0.01]    75%|███████▌  | 113/150 [38:41<12:20, 20.02s/epoch, loss=0.541, accuracy=0.884, val_loss=0.913, val_accuracy=0.778, lr=0.01] 76%|███████▌  | 114/150 [39:01<12:06, 20.18s/epoch, loss=0.548, accuracy=0.882, val_loss=0.834, val_accuracy=0.805, lr=0.01] 77%|███████▋  | 115/150 [39:21<11:45, 20.16s/epoch, loss=0.55, accuracy=0.88, val_loss=1.02, val_accuracy=0.743, lr=0.01]    77%|███████▋  | 116/150 [39:41<11:24, 20.13s/epoch, loss=0.542, accuracy=0.884, val_loss=0.905, val_accuracy=0.779, lr=0.00316] 78%|███████▊  | 117/150 [40:01<11:03, 20.09s/epoch, loss=0.547, accuracy=0.883, val_loss=0.849, val_accuracy=0.787, lr=0.01]    79%|███████▊  | 118/150 [40:21<10:40, 20.03s/epoch, loss=0.545, accuracy=0.883, val_loss=0.995, val_accuracy=0.751, lr=0.01] 79%|███████▉  | 119/150 [40:41<10:20, 20.03s/epoch, loss=0.543, accuracy=0.885, val_loss=0.783, val_accuracy=0.811, lr=0.01] 80%|████████  | 120/150 [41:02<10:04, 20.15s/epoch, loss=0.543, accuracy=0.883, val_loss=0.804, val_accuracy=0.805, lr=0.01] 81%|████████  | 121/150 [41:22<09:43, 20.11s/epoch, loss=0.545, accuracy=0.884, val_loss=1.04, val_accuracy=0.758, lr=0.00316] 81%|████████▏ | 122/150 [41:42<09:21, 20.06s/epoch, loss=0.466, accuracy=0.912, val_loss=0.529, val_accuracy=0.891, lr=0.001]  82%|████████▏ | 123/150 [42:02<09:00, 20.00s/epoch, loss=0.416, accuracy=0.928, val_loss=0.509, val_accuracy=0.896, lr=0.001] 83%|████████▎ | 124/150 [42:22<08:40, 20.03s/epoch, loss=0.395, accuracy=0.934, val_loss=0.495, val_accuracy=0.899, lr=0.001] 83%|████████▎ | 125/150 [42:42<08:20, 20.01s/epoch, loss=0.378, accuracy=0.936, val_loss=0.485, val_accuracy=0.9, lr=0.001]   84%|████████▍ | 126/150 [43:02<08:01, 20.08s/epoch, loss=0.364, accuracy=0.94, val_loss=0.484, val_accuracy=0.902, lr=0.001] 85%|████████▍ | 127/150 [43:22<07:41, 20.05s/epoch, loss=0.351, accuracy=0.942, val_loss=0.47, val_accuracy=0.902, lr=0.001] 85%|████████▌ | 128/150 [43:42<07:21, 20.08s/epoch, loss=0.338, accuracy=0.945, val_loss=0.465, val_accuracy=0.904, lr=0.001] 86%|████████▌ | 129/150 [44:02<07:00, 20.02s/epoch, loss=0.332, accuracy=0.946, val_loss=0.475, val_accuracy=0.898, lr=0.001] 87%|████████▋ | 130/150 [44:22<06:39, 19.97s/epoch, loss=0.322, accuracy=0.948, val_loss=0.468, val_accuracy=0.901, lr=0.001] 87%|████████▋ | 131/150 [44:42<06:19, 19.99s/epoch, loss=0.313, accuracy=0.95, val_loss=0.466, val_accuracy=0.9, lr=0.001]    88%|████████▊ | 132/150 [45:01<05:58, 19.89s/epoch, loss=0.304, accuracy=0.95, val_loss=0.463, val_accuracy=0.899, lr=0.001] 89%|████████▊ | 133/150 [45:21<05:37, 19.87s/epoch, loss=0.3, accuracy=0.951, val_loss=0.472, val_accuracy=0.897, lr=0.001]  89%|████████▉ | 134/150 [45:41<05:17, 19.83s/epoch, loss=0.292, accuracy=0.952, val_loss=0.46, val_accuracy=0.899, lr=0.001] 90%|█████████ | 135/150 [46:01<04:57, 19.81s/epoch, loss=0.286, accuracy=0.952, val_loss=0.478, val_accuracy=0.896, lr=0.001] 91%|█████████ | 136/150 [46:20<04:36, 19.77s/epoch, loss=0.279, accuracy=0.954, val_loss=0.468, val_accuracy=0.896, lr=0.001] 91%|█████████▏| 137/150 [46:40<04:16, 19.71s/epoch, loss=0.275, accuracy=0.954, val_loss=0.469, val_accuracy=0.893, lr=0.001] 92%|█████████▏| 138/150 [47:00<03:57, 19.76s/epoch, loss=0.267, accuracy=0.956, val_loss=0.447, val_accuracy=0.9, lr=0.001]   93%|█████████▎| 139/150 [47:20<03:37, 19.73s/epoch, loss=0.266, accuracy=0.955, val_loss=0.472, val_accuracy=0.893, lr=0.001] 93%|█████████▎| 140/150 [47:39<03:18, 19.80s/epoch, loss=0.257, accuracy=0.957, val_loss=0.457, val_accuracy=0.897, lr=0.001] 94%|█████████▍| 141/150 [48:00<02:58, 19.87s/epoch, loss=0.255, accuracy=0.956, val_loss=0.466, val_accuracy=0.892, lr=0.001] 95%|█████████▍| 142/150 [48:19<02:39, 19.88s/epoch, loss=0.248, accuracy=0.959, val_loss=0.463, val_accuracy=0.892, lr=0.001] 95%|█████████▌| 143/150 [48:39<02:19, 19.88s/epoch, loss=0.248, accuracy=0.957, val_loss=0.463, val_accuracy=0.89, lr=0.000316] 96%|█████████▌| 144/150 [48:59<01:59, 19.88s/epoch, loss=0.241, accuracy=0.96, val_loss=0.478, val_accuracy=0.889, lr=0.001]    97%|█████████▋| 145/150 [49:19<01:39, 19.86s/epoch, loss=0.238, accuracy=0.959, val_loss=0.516, val_accuracy=0.881, lr=0.001] 97%|█████████▋| 146/150 [49:39<01:20, 20.04s/epoch, loss=0.235, accuracy=0.96, val_loss=0.487, val_accuracy=0.891, lr=0.001]  98%|█████████▊| 147/150 [50:00<01:00, 20.06s/epoch, loss=0.235, accuracy=0.959, val_loss=0.483, val_accuracy=0.889, lr=0.001] 99%|█████████▊| 148/150 [50:20<00:40, 20.07s/epoch, loss=0.231, accuracy=0.959, val_loss=0.459, val_accuracy=0.893, lr=0.000316] 99%|█████████▉| 149/150 [50:40<00:20, 20.09s/epoch, loss=0.227, accuracy=0.961, val_loss=0.481, val_accuracy=0.888, lr=0.001]   100%|██████████| 150/150 [51:00<00:00, 20.15s/epoch, loss=0.228, accuracy=0.959, val_loss=0.473, val_accuracy=0.89, lr=0.001] 100%|██████████| 150/150 [51:00<00:00, 20.40s/epoch, loss=0.228, accuracy=0.959, val_loss=0.473, val_accuracy=0.89, lr=0.001]
Using real-time data augmentation.
Test score: 0.4730396568775177
Test accuracy: 0.8899000287055969


* * * Run SGD for ID = 10_10. * * *


2024-03-05 09:02:15.270423: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 09:02:22.445854: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 09:02:22.447031: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-05 09:02:22.484626: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-03-05 09:02:22.484668: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 09:02:22.490661: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 09:02:22.490707: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-05 09:02:22.494699: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-05 09:02:22.497001: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-05 09:02:22.500595: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-05 09:02:22.503356: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-05 09:02:22.509231: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 09:02:22.509885: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-05 09:02:22.510009: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 09:02:23.763476: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-05 09:02:23.764536: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 09:02:23.765949: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-03-05 09:02:23.765998: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 09:02:23.766047: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 09:02:23.766065: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-05 09:02:23.766080: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-05 09:02:23.766095: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-05 09:02:23.766109: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-05 09:02:23.766133: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-05 09:02:23.766149: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 09:02:23.766574: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-05 09:02:23.766606: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 09:02:24.474257: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-05 09:02:24.474315: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-05 09:02:24.474324: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-05 09:02:24.475232: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11227 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN X (Pascal), pci bus id: 0000:83:00.0, compute capability: 6.1)
{'id': '10_10', 'seed': 10, 'out_folder': 'results/epoch_budget', 'batch_size': 128, 'epochs': 150, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN X (Pascal)'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/150 [00:00<?, ?epoch/s]2024-03-05 09:02:25.544042: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-05 09:02:25.544489: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2600020000 Hz
2024-03-05 09:02:27.517600: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 09:02:27.751067: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 09:02:28.550285: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-05 09:02:28.604537: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/150 [01:03<2:38:19, 63.76s/epoch, loss=2.96, accuracy=0.346, val_loss=3.22, val_accuracy=0.236, lr=0.1]  1%|▏         | 2/150 [01:24<1:34:27, 38.29s/epoch, loss=1.52, accuracy=0.558, val_loss=1.67, val_accuracy=0.515, lr=0.1]  2%|▏         | 3/150 [01:44<1:13:53, 30.16s/epoch, loss=1.32, accuracy=0.661, val_loss=1.76, val_accuracy=0.561, lr=0.1]  3%|▎         | 4/150 [02:04<1:03:54, 26.26s/epoch, loss=1.27, accuracy=0.692, val_loss=1.62, val_accuracy=0.57, lr=0.1]   3%|▎         | 5/150 [02:25<58:08, 24.06s/epoch, loss=1.25, accuracy=0.705, val_loss=1.63, val_accuracy=0.554, lr=0.1]   4%|▍         | 6/150 [02:45<54:45, 22.82s/epoch, loss=1.24, accuracy=0.716, val_loss=1.75, val_accuracy=0.536, lr=0.1]  5%|▍         | 7/150 [03:05<52:18, 21.95s/epoch, loss=1.22, accuracy=0.722, val_loss=1.99, val_accuracy=0.497, lr=0.1]  5%|▌         | 8/150 [03:25<50:35, 21.38s/epoch, loss=1.2, accuracy=0.725, val_loss=1.68, val_accuracy=0.571, lr=0.1]   6%|▌         | 9/150 [03:46<49:25, 21.03s/epoch, loss=1.19, accuracy=0.731, val_loss=3.15, val_accuracy=0.35, lr=0.0316]  7%|▋         | 10/150 [04:06<48:24, 20.74s/epoch, loss=1.2, accuracy=0.731, val_loss=1.52, val_accuracy=0.623, lr=0.1]    7%|▋         | 11/150 [04:26<47:43, 20.60s/epoch, loss=1.19, accuracy=0.734, val_loss=1.85, val_accuracy=0.507, lr=0.1]  8%|▊         | 12/150 [04:46<47:06, 20.48s/epoch, loss=1.19, accuracy=0.739, val_loss=1.43, val_accuracy=0.648, lr=0.1]  9%|▊         | 13/150 [05:07<46:42, 20.45s/epoch, loss=1.19, accuracy=0.738, val_loss=1.56, val_accuracy=0.612, lr=0.1]  9%|▉         | 14/150 [05:27<46:07, 20.35s/epoch, loss=1.18, accuracy=0.74, val_loss=1.88, val_accuracy=0.562, lr=0.1]  10%|█         | 15/150 [05:47<45:34, 20.25s/epoch, loss=1.18, accuracy=0.739, val_loss=1.7, val_accuracy=0.537, lr=0.1] 11%|█         | 16/150 [06:07<45:07, 20.21s/epoch, loss=1.17, accuracy=0.744, val_loss=1.83, val_accuracy=0.509, lr=0.1] 11%|█▏        | 17/150 [06:27<44:40, 20.15s/epoch, loss=1.17, accuracy=0.744, val_loss=1.51, val_accuracy=0.639, lr=0.0316] 12%|█▏        | 18/150 [06:47<44:19, 20.15s/epoch, loss=1.17, accuracy=0.748, val_loss=2.6, val_accuracy=0.402, lr=0.1]     13%|█▎        | 19/150 [07:07<43:59, 20.15s/epoch, loss=1.16, accuracy=0.744, val_loss=3.05, val_accuracy=0.386, lr=0.1] 13%|█▎        | 20/150 [07:27<43:30, 20.08s/epoch, loss=1.17, accuracy=0.747, val_loss=1.92, val_accuracy=0.53, lr=0.1]  14%|█▍        | 21/150 [07:47<43:16, 20.13s/epoch, loss=1.16, accuracy=0.749, val_loss=1.51, val_accuracy=0.612, lr=0.1] 15%|█▍        | 22/150 [08:08<42:59, 20.15s/epoch, loss=1.16, accuracy=0.746, val_loss=1.56, val_accuracy=0.629, lr=0.0316] 15%|█▌        | 23/150 [08:28<42:39, 20.15s/epoch, loss=1.15, accuracy=0.752, val_loss=1.73, val_accuracy=0.542, lr=0.1]    16%|█▌        | 24/150 [08:48<42:24, 20.19s/epoch, loss=1.15, accuracy=0.75, val_loss=1.85, val_accuracy=0.532, lr=0.1]  17%|█▋        | 25/150 [09:08<42:10, 20.24s/epoch, loss=1.15, accuracy=0.752, val_loss=2.24, val_accuracy=0.457, lr=0.1] 17%|█▋        | 26/150 [09:29<41:51, 20.25s/epoch, loss=1.15, accuracy=0.752, val_loss=1.99, val_accuracy=0.502, lr=0.1] 18%|█▊        | 27/150 [09:48<41:16, 20.14s/epoch, loss=1.15, accuracy=0.753, val_loss=2.62, val_accuracy=0.433, lr=0.0316] 19%|█▊        | 28/150 [10:09<40:57, 20.15s/epoch, loss=1.14, accuracy=0.753, val_loss=2.49, val_accuracy=0.453, lr=0.1]    19%|█▉        | 29/150 [10:29<40:32, 20.10s/epoch, loss=1.14, accuracy=0.751, val_loss=1.47, val_accuracy=0.644, lr=0.1] 20%|██        | 30/150 [10:49<40:04, 20.04s/epoch, loss=1.14, accuracy=0.753, val_loss=1.66, val_accuracy=0.6, lr=0.1]   21%|██        | 31/150 [11:09<39:54, 20.12s/epoch, loss=1.14, accuracy=0.755, val_loss=1.5, val_accuracy=0.631, lr=0.1] 21%|██▏       | 32/150 [11:29<39:28, 20.07s/epoch, loss=1.14, accuracy=0.752, val_loss=1.9, val_accuracy=0.506, lr=0.0316] 22%|██▏       | 33/150 [11:49<39:06, 20.06s/epoch, loss=1.14, accuracy=0.755, val_loss=2.42, val_accuracy=0.421, lr=0.1]   23%|██▎       | 34/150 [12:09<38:41, 20.01s/epoch, loss=1.13, accuracy=0.755, val_loss=1.97, val_accuracy=0.545, lr=0.1] 23%|██▎       | 35/150 [12:29<38:19, 20.00s/epoch, loss=1.14, accuracy=0.753, val_loss=1.56, val_accuracy=0.618, lr=0.1] 24%|██▍       | 36/150 [12:49<37:53, 19.94s/epoch, loss=1.12, accuracy=0.757, val_loss=2.78, val_accuracy=0.229, lr=0.1] 25%|██▍       | 37/150 [13:09<37:36, 19.97s/epoch, loss=1.13, accuracy=0.753, val_loss=1.3, val_accuracy=0.689, lr=0.1]  25%|██▌       | 38/150 [13:29<37:16, 19.97s/epoch, loss=1.13, accuracy=0.754, val_loss=1.82, val_accuracy=0.543, lr=0.1] 26%|██▌       | 39/150 [13:48<36:52, 19.93s/epoch, loss=1.14, accuracy=0.756, val_loss=2.34, val_accuracy=0.466, lr=0.1] 27%|██▋       | 40/150 [14:08<36:31, 19.92s/epoch, loss=1.14, accuracy=0.754, val_loss=2.41, val_accuracy=0.421, lr=0.1] 27%|██▋       | 41/150 [14:28<36:14, 19.95s/epoch, loss=1.13, accuracy=0.755, val_loss=2.16, val_accuracy=0.422, lr=0.1] 28%|██▊       | 42/150 [14:49<36:10, 20.10s/epoch, loss=1.13, accuracy=0.755, val_loss=1.87, val_accuracy=0.566, lr=0.0316] 29%|██▊       | 43/150 [15:09<35:58, 20.17s/epoch, loss=1.13, accuracy=0.757, val_loss=1.49, val_accuracy=0.664, lr=0.1]    29%|██▉       | 44/150 [15:29<35:35, 20.15s/epoch, loss=1.13, accuracy=0.756, val_loss=3.86, val_accuracy=0.269, lr=0.1] 30%|███       | 45/150 [15:49<35:21, 20.20s/epoch, loss=1.12, accuracy=0.756, val_loss=1.95, val_accuracy=0.472, lr=0.1] 31%|███       | 46/150 [16:09<34:52, 20.12s/epoch, loss=1.13, accuracy=0.756, val_loss=2.13, val_accuracy=0.486, lr=0.1] 31%|███▏      | 47/150 [16:29<34:25, 20.05s/epoch, loss=1.12, accuracy=0.756, val_loss=2.64, val_accuracy=0.393, lr=0.0316] 32%|███▏      | 48/150 [16:49<34:02, 20.02s/epoch, loss=1.12, accuracy=0.756, val_loss=1.93, val_accuracy=0.51, lr=0.1]     33%|███▎      | 49/150 [17:09<33:36, 19.96s/epoch, loss=1.13, accuracy=0.756, val_loss=1.35, val_accuracy=0.678, lr=0.1] 33%|███▎      | 50/150 [17:29<33:13, 19.94s/epoch, loss=1.13, accuracy=0.757, val_loss=1.77, val_accuracy=0.553, lr=0.1] 34%|███▍      | 51/150 [17:49<32:49, 19.90s/epoch, loss=1.12, accuracy=0.755, val_loss=3.08, val_accuracy=0.348, lr=0.1] 35%|███▍      | 52/150 [18:09<32:46, 20.07s/epoch, loss=1.13, accuracy=0.755, val_loss=3.07, val_accuracy=0.355, lr=0.0316] 35%|███▌      | 53/150 [18:29<32:31, 20.12s/epoch, loss=1.12, accuracy=0.758, val_loss=2.59, val_accuracy=0.313, lr=0.1]    36%|███▌      | 54/150 [18:50<32:15, 20.16s/epoch, loss=1.12, accuracy=0.758, val_loss=1.92, val_accuracy=0.518, lr=0.1] 37%|███▋      | 55/150 [19:10<31:51, 20.12s/epoch, loss=1.12, accuracy=0.757, val_loss=2.69, val_accuracy=0.384, lr=0.1] 37%|███▋      | 56/150 [19:30<31:28, 20.09s/epoch, loss=1.12, accuracy=0.757, val_loss=2.86, val_accuracy=0.373, lr=0.1] 38%|███▊      | 57/150 [19:50<31:07, 20.08s/epoch, loss=1.12, accuracy=0.754, val_loss=3.36, val_accuracy=0.415, lr=0.0316] 39%|███▊      | 58/150 [20:10<30:48, 20.09s/epoch, loss=1.12, accuracy=0.753, val_loss=2, val_accuracy=0.51, lr=0.1]        39%|███▉      | 59/150 [20:30<30:26, 20.07s/epoch, loss=1.12, accuracy=0.759, val_loss=1.49, val_accuracy=0.626, lr=0.1] 40%|████      | 60/150 [20:50<30:09, 20.10s/epoch, loss=1.12, accuracy=0.757, val_loss=1.76, val_accuracy=0.531, lr=0.1] 41%|████      | 61/150 [21:10<29:49, 20.10s/epoch, loss=1.12, accuracy=0.757, val_loss=2, val_accuracy=0.546, lr=0.1]    41%|████▏     | 62/150 [21:30<29:29, 20.11s/epoch, loss=1.12, accuracy=0.756, val_loss=2.26, val_accuracy=0.45, lr=0.0316] 42%|████▏     | 63/150 [21:50<29:03, 20.04s/epoch, loss=1.12, accuracy=0.757, val_loss=3.49, val_accuracy=0.299, lr=0.1]   43%|████▎     | 64/150 [22:10<28:48, 20.09s/epoch, loss=1.12, accuracy=0.758, val_loss=2.87, val_accuracy=0.451, lr=0.1] 43%|████▎     | 65/150 [22:30<28:21, 20.01s/epoch, loss=1.12, accuracy=0.757, val_loss=2.92, val_accuracy=0.368, lr=0.1] 44%|████▍     | 66/150 [22:50<28:00, 20.01s/epoch, loss=1.12, accuracy=0.758, val_loss=1.78, val_accuracy=0.543, lr=0.1] 45%|████▍     | 67/150 [23:10<27:43, 20.04s/epoch, loss=1.12, accuracy=0.76, val_loss=1.95, val_accuracy=0.519, lr=0.0316] 45%|████▌     | 68/150 [23:30<27:20, 20.00s/epoch, loss=1.12, accuracy=0.757, val_loss=3.6, val_accuracy=0.25, lr=0.1]     46%|████▌     | 69/150 [23:50<26:57, 19.97s/epoch, loss=1.12, accuracy=0.757, val_loss=1.8, val_accuracy=0.511, lr=0.1] 47%|████▋     | 70/150 [24:10<26:33, 19.92s/epoch, loss=1.12, accuracy=0.757, val_loss=1.76, val_accuracy=0.54, lr=0.1] 47%|████▋     | 71/150 [24:30<26:15, 19.94s/epoch, loss=1.12, accuracy=0.756, val_loss=1.71, val_accuracy=0.561, lr=0.1] 48%|████▊     | 72/150 [24:50<25:55, 19.94s/epoch, loss=1.12, accuracy=0.757, val_loss=3.79, val_accuracy=0.345, lr=0.0316] 49%|████▊     | 73/150 [25:10<25:42, 20.03s/epoch, loss=1.12, accuracy=0.759, val_loss=2.08, val_accuracy=0.462, lr=0.1]    49%|████▉     | 74/150 [25:30<25:25, 20.07s/epoch, loss=1.12, accuracy=0.757, val_loss=2.63, val_accuracy=0.383, lr=0.1] 50%|█████     | 75/150 [25:50<25:04, 20.06s/epoch, loss=1.11, accuracy=0.758, val_loss=1.72, val_accuracy=0.573, lr=0.1] 51%|█████     | 76/150 [26:11<24:54, 20.20s/epoch, loss=1.11, accuracy=0.759, val_loss=2.35, val_accuracy=0.482, lr=0.1] 51%|█████▏    | 77/150 [26:30<24:17, 19.97s/epoch, loss=1.11, accuracy=0.76, val_loss=1.92, val_accuracy=0.508, lr=0.0316] 52%|█████▏    | 78/150 [26:50<23:52, 19.89s/epoch, loss=1.11, accuracy=0.757, val_loss=2.2, val_accuracy=0.483, lr=0.1]    53%|█████▎    | 79/150 [27:10<23:31, 19.87s/epoch, loss=1.11, accuracy=0.757, val_loss=1.84, val_accuracy=0.502, lr=0.1] 53%|█████▎    | 80/150 [27:29<23:03, 19.77s/epoch, loss=1.11, accuracy=0.757, val_loss=2.41, val_accuracy=0.481, lr=0.1] 54%|█████▍    | 81/150 [27:50<22:55, 19.93s/epoch, loss=1.11, accuracy=0.757, val_loss=2.15, val_accuracy=0.47, lr=0.1]  55%|█████▍    | 82/150 [28:10<22:36, 19.95s/epoch, loss=0.903, accuracy=0.815, val_loss=0.899, val_accuracy=0.802, lr=0.01] 55%|█████▌    | 83/150 [28:30<22:15, 19.94s/epoch, loss=0.726, accuracy=0.848, val_loss=0.843, val_accuracy=0.794, lr=0.01] 56%|█████▌    | 84/150 [28:49<21:51, 19.88s/epoch, loss=0.647, accuracy=0.857, val_loss=0.708, val_accuracy=0.827, lr=0.01] 57%|█████▋    | 85/150 [29:09<21:32, 19.88s/epoch, loss=0.604, accuracy=0.859, val_loss=0.875, val_accuracy=0.772, lr=0.01] 57%|█████▋    | 86/150 [29:29<21:11, 19.86s/epoch, loss=0.584, accuracy=0.86, val_loss=0.979, val_accuracy=0.737, lr=0.01]  58%|█████▊    | 87/150 [29:49<20:47, 19.81s/epoch, loss=0.573, accuracy=0.862, val_loss=0.733, val_accuracy=0.807, lr=0.01] 59%|█████▊    | 88/150 [30:09<20:27, 19.80s/epoch, loss=0.566, accuracy=0.865, val_loss=0.717, val_accuracy=0.814, lr=0.01] 59%|█████▉    | 89/150 [30:28<20:07, 19.79s/epoch, loss=0.563, accuracy=0.866, val_loss=0.769, val_accuracy=0.801, lr=0.00316] 60%|██████    | 90/150 [30:48<19:46, 19.77s/epoch, loss=0.557, accuracy=0.868, val_loss=0.766, val_accuracy=0.797, lr=0.01]    61%|██████    | 91/150 [31:08<19:27, 19.78s/epoch, loss=0.559, accuracy=0.868, val_loss=0.759, val_accuracy=0.806, lr=0.01] 61%|██████▏   | 92/150 [31:28<19:07, 19.78s/epoch, loss=0.559, accuracy=0.868, val_loss=0.68, val_accuracy=0.828, lr=0.01]  62%|██████▏   | 93/150 [31:47<18:48, 19.80s/epoch, loss=0.554, accuracy=0.871, val_loss=1.07, val_accuracy=0.732, lr=0.01] 63%|██████▎   | 94/150 [32:07<18:26, 19.76s/epoch, loss=0.556, accuracy=0.871, val_loss=0.931, val_accuracy=0.757, lr=0.01] 63%|██████▎   | 95/150 [32:27<18:08, 19.78s/epoch, loss=0.554, accuracy=0.872, val_loss=0.9, val_accuracy=0.766, lr=0.01]   64%|██████▍   | 96/150 [32:47<17:47, 19.76s/epoch, loss=0.557, accuracy=0.872, val_loss=0.86, val_accuracy=0.78, lr=0.01] 65%|██████▍   | 97/150 [33:06<17:21, 19.65s/epoch, loss=0.55, accuracy=0.877, val_loss=0.859, val_accuracy=0.785, lr=0.00316] 65%|██████▌   | 98/150 [33:26<17:00, 19.62s/epoch, loss=0.555, accuracy=0.874, val_loss=0.893, val_accuracy=0.786, lr=0.01]   66%|██████▌   | 99/150 [33:45<16:36, 19.54s/epoch, loss=0.552, accuracy=0.876, val_loss=0.861, val_accuracy=0.779, lr=0.01] 67%|██████▋   | 100/150 [34:04<16:14, 19.48s/epoch, loss=0.554, accuracy=0.877, val_loss=1.16, val_accuracy=0.72, lr=0.01]  67%|██████▋   | 101/150 [34:24<15:55, 19.49s/epoch, loss=0.554, accuracy=0.878, val_loss=0.751, val_accuracy=0.816, lr=0.01] 68%|██████▊   | 102/150 [34:44<15:41, 19.62s/epoch, loss=0.554, accuracy=0.876, val_loss=1.55, val_accuracy=0.604, lr=0.00316] 69%|██████▊   | 103/150 [35:04<15:24, 19.67s/epoch, loss=0.551, accuracy=0.878, val_loss=0.785, val_accuracy=0.809, lr=0.01]   69%|██████▉   | 104/150 [35:23<15:06, 19.70s/epoch, loss=0.551, accuracy=0.879, val_loss=0.875, val_accuracy=0.784, lr=0.01] 70%|███████   | 105/150 [35:43<14:48, 19.74s/epoch, loss=0.554, accuracy=0.878, val_loss=0.877, val_accuracy=0.779, lr=0.01] 71%|███████   | 106/150 [36:03<14:29, 19.75s/epoch, loss=0.55, accuracy=0.88, val_loss=0.813, val_accuracy=0.8, lr=0.01]     71%|███████▏  | 107/150 [36:23<14:08, 19.73s/epoch, loss=0.552, accuracy=0.88, val_loss=0.809, val_accuracy=0.799, lr=0.00316] 72%|███████▏  | 108/150 [36:43<13:55, 19.90s/epoch, loss=0.552, accuracy=0.881, val_loss=0.932, val_accuracy=0.764, lr=0.01]   73%|███████▎  | 109/150 [37:03<13:32, 19.81s/epoch, loss=0.552, accuracy=0.881, val_loss=0.854, val_accuracy=0.775, lr=0.01] 73%|███████▎  | 110/150 [37:22<13:12, 19.81s/epoch, loss=0.549, accuracy=0.881, val_loss=1.1, val_accuracy=0.738, lr=0.01]   74%|███████▍  | 111/150 [37:42<12:50, 19.76s/epoch, loss=0.556, accuracy=0.879, val_loss=0.766, val_accuracy=0.817, lr=0.01] 75%|███████▍  | 112/150 [38:02<12:29, 19.72s/epoch, loss=0.552, accuracy=0.881, val_loss=0.877, val_accuracy=0.775, lr=0.00316] 75%|███████▌  | 113/150 [38:21<12:08, 19.70s/epoch, loss=0.551, accuracy=0.881, val_loss=0.824, val_accuracy=0.797, lr=0.01]    76%|███████▌  | 114/150 [38:41<11:47, 19.64s/epoch, loss=0.556, accuracy=0.88, val_loss=1.53, val_accuracy=0.66, lr=0.01]    77%|███████▋  | 115/150 [39:00<11:27, 19.63s/epoch, loss=0.551, accuracy=0.883, val_loss=0.841, val_accuracy=0.786, lr=0.01] 77%|███████▋  | 116/150 [39:20<11:07, 19.63s/epoch, loss=0.548, accuracy=0.882, val_loss=1.06, val_accuracy=0.738, lr=0.01]  78%|███████▊  | 117/150 [39:40<10:47, 19.62s/epoch, loss=0.552, accuracy=0.882, val_loss=0.933, val_accuracy=0.777, lr=0.00316] 79%|███████▊  | 118/150 [39:59<10:28, 19.63s/epoch, loss=0.555, accuracy=0.883, val_loss=1.09, val_accuracy=0.734, lr=0.01]     79%|███████▉  | 119/150 [40:19<10:09, 19.66s/epoch, loss=0.551, accuracy=0.884, val_loss=0.822, val_accuracy=0.8, lr=0.01]  80%|████████  | 120/150 [40:39<09:53, 19.78s/epoch, loss=0.55, accuracy=0.882, val_loss=0.867, val_accuracy=0.795, lr=0.01] 81%|████████  | 121/150 [40:59<09:33, 19.76s/epoch, loss=0.555, accuracy=0.884, val_loss=0.87, val_accuracy=0.781, lr=0.01] 81%|████████▏ | 122/150 [41:19<09:14, 19.80s/epoch, loss=0.479, accuracy=0.909, val_loss=0.544, val_accuracy=0.886, lr=0.001] 82%|████████▏ | 123/150 [41:38<08:55, 19.82s/epoch, loss=0.425, accuracy=0.927, val_loss=0.522, val_accuracy=0.892, lr=0.001] 83%|████████▎ | 124/150 [41:58<08:34, 19.80s/epoch, loss=0.406, accuracy=0.932, val_loss=0.514, val_accuracy=0.894, lr=0.001] 83%|████████▎ | 125/150 [42:18<08:14, 19.79s/epoch, loss=0.386, accuracy=0.937, val_loss=0.509, val_accuracy=0.894, lr=0.001] 84%|████████▍ | 126/150 [42:38<07:55, 19.82s/epoch, loss=0.375, accuracy=0.938, val_loss=0.501, val_accuracy=0.896, lr=0.001] 85%|████████▍ | 127/150 [42:58<07:36, 19.85s/epoch, loss=0.361, accuracy=0.941, val_loss=0.49, val_accuracy=0.897, lr=0.001]  85%|████████▌ | 128/150 [43:18<07:17, 19.89s/epoch, loss=0.349, accuracy=0.943, val_loss=0.483, val_accuracy=0.899, lr=0.001] 86%|████████▌ | 129/150 [43:37<06:56, 19.83s/epoch, loss=0.338, accuracy=0.946, val_loss=0.475, val_accuracy=0.9, lr=0.001]   87%|████████▋ | 130/150 [43:57<06:36, 19.82s/epoch, loss=0.332, accuracy=0.946, val_loss=0.471, val_accuracy=0.897, lr=0.001] 87%|████████▋ | 131/150 [44:17<06:16, 19.79s/epoch, loss=0.322, accuracy=0.947, val_loss=0.48, val_accuracy=0.897, lr=0.001]  88%|████████▊ | 132/150 [44:37<05:55, 19.77s/epoch, loss=0.315, accuracy=0.949, val_loss=0.475, val_accuracy=0.897, lr=0.001] 89%|████████▊ | 133/150 [44:57<05:36, 19.79s/epoch, loss=0.307, accuracy=0.95, val_loss=0.482, val_accuracy=0.894, lr=0.001]  89%|████████▉ | 134/150 [45:16<05:16, 19.80s/epoch, loss=0.297, accuracy=0.952, val_loss=0.468, val_accuracy=0.9, lr=0.001]  90%|█████████ | 135/150 [45:36<04:56, 19.79s/epoch, loss=0.294, accuracy=0.951, val_loss=0.472, val_accuracy=0.896, lr=0.001] 91%|█████████ | 136/150 [45:56<04:36, 19.78s/epoch, loss=0.291, accuracy=0.951, val_loss=0.472, val_accuracy=0.897, lr=0.001] 91%|█████████▏| 137/150 [46:16<04:16, 19.76s/epoch, loss=0.28, accuracy=0.954, val_loss=0.476, val_accuracy=0.895, lr=0.001]  92%|█████████▏| 138/150 [46:35<03:57, 19.79s/epoch, loss=0.277, accuracy=0.954, val_loss=0.466, val_accuracy=0.896, lr=0.001] 93%|█████████▎| 139/150 [46:55<03:37, 19.78s/epoch, loss=0.269, accuracy=0.957, val_loss=0.45, val_accuracy=0.898, lr=0.001]  93%|█████████▎| 140/150 [47:15<03:17, 19.77s/epoch, loss=0.263, accuracy=0.957, val_loss=0.478, val_accuracy=0.894, lr=0.001] 94%|█████████▍| 141/150 [47:35<02:57, 19.78s/epoch, loss=0.26, accuracy=0.957, val_loss=0.5, val_accuracy=0.891, lr=0.001]    95%|█████████▍| 142/150 [47:55<02:38, 19.80s/epoch, loss=0.257, accuracy=0.958, val_loss=0.464, val_accuracy=0.9, lr=0.001] 95%|█████████▌| 143/150 [48:14<02:18, 19.76s/epoch, loss=0.256, accuracy=0.956, val_loss=0.459, val_accuracy=0.895, lr=0.001] 96%|█████████▌| 144/150 [48:34<01:58, 19.69s/epoch, loss=0.25, accuracy=0.959, val_loss=0.46, val_accuracy=0.894, lr=0.000316] 97%|█████████▋| 145/150 [48:54<01:38, 19.72s/epoch, loss=0.244, accuracy=0.959, val_loss=0.518, val_accuracy=0.883, lr=0.001]  97%|█████████▋| 146/150 [49:13<01:18, 19.74s/epoch, loss=0.244, accuracy=0.958, val_loss=0.465, val_accuracy=0.894, lr=0.001] 98%|█████████▊| 147/150 [49:33<00:59, 19.82s/epoch, loss=0.242, accuracy=0.957, val_loss=0.494, val_accuracy=0.889, lr=0.001] 99%|█████████▊| 148/150 [49:53<00:39, 19.83s/epoch, loss=0.238, accuracy=0.958, val_loss=0.46, val_accuracy=0.889, lr=0.001]  99%|█████████▉| 149/150 [50:13<00:19, 19.85s/epoch, loss=0.236, accuracy=0.958, val_loss=0.501, val_accuracy=0.884, lr=0.000316]100%|██████████| 150/150 [50:33<00:00, 19.87s/epoch, loss=0.232, accuracy=0.96, val_loss=0.487, val_accuracy=0.887, lr=0.001]    100%|██████████| 150/150 [50:33<00:00, 20.22s/epoch, loss=0.232, accuracy=0.96, val_loss=0.487, val_accuracy=0.887, lr=0.001]
Using real-time data augmentation.
Test score: 0.48740819096565247
Test accuracy: 0.8867999911308289

Tue Mar  5 04:09:12 2024       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 545.23.08              Driver Version: 545.23.08    CUDA Version: 12.3     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA TITAN Xp                Off | 00000000:3B:00.0 Off |                  N/A |
| 25%   44C    P8               9W / 250W |      0MiB / 12288MiB |      0%      Default |
|                                         |                      |                  N/A |
+-----------------------------------------+----------------------+----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
|  No running processes found                                                           |
+---------------------------------------------------------------------------------------+


* * * Run SGD for cluster size = 14. * * *


Budget: 107


* * * Run SGD for ID = 14_1. * * *


2024-03-05 04:09:13.198622: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 04:09:19.064305: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 04:09:19.066269: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-05 04:09:19.101680: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-05 04:09:19.101725: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 04:09:19.137739: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 04:09:19.137868: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-05 04:09:19.169980: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-05 04:09:19.228550: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-05 04:09:19.275150: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-05 04:09:19.307728: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-05 04:09:19.346185: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 04:09:19.347051: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-05 04:09:19.347163: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 04:09:20.722810: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-05 04:09:20.723546: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 04:09:20.724105: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-05 04:09:20.724143: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 04:09:20.724181: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 04:09:20.724196: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-05 04:09:20.724211: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-05 04:09:20.724225: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-05 04:09:20.724240: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-05 04:09:20.724255: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-05 04:09:20.724270: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 04:09:20.724873: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-05 04:09:20.724928: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 04:09:21.729046: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-05 04:09:21.729121: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-05 04:09:21.729132: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-05 04:09:21.730786: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:3b:00.0, compute capability: 6.1)
{'id': '14_01', 'seed': 1, 'out_folder': 'results/epoch_budget', 'batch_size': 128, 'epochs': 107, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/107 [00:00<?, ?epoch/s]2024-03-05 04:09:22.600639: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-05 04:09:22.613926: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-03-05 04:09:24.570960: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 04:09:24.905736: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 04:09:26.114520: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-05 04:09:26.168964: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/107 [01:05<1:55:31, 65.39s/epoch, loss=3.95, accuracy=0.322, val_loss=2.79, val_accuracy=0.26, lr=0.1]  2%|▏         | 2/107 [01:32<1:14:56, 42.82s/epoch, loss=1.63, accuracy=0.523, val_loss=3.48, val_accuracy=0.244, lr=0.1]  3%|▎         | 3/107 [01:59<1:01:39, 35.57s/epoch, loss=1.42, accuracy=0.613, val_loss=3.08, val_accuracy=0.297, lr=0.1]  4%|▎         | 4/107 [02:27<55:47, 32.50s/epoch, loss=1.35, accuracy=0.658, val_loss=2.15, val_accuracy=0.41, lr=0.1]     5%|▍         | 5/107 [02:54<52:16, 30.75s/epoch, loss=1.31, accuracy=0.683, val_loss=2.14, val_accuracy=0.434, lr=0.1]  6%|▌         | 6/107 [03:22<49:51, 29.62s/epoch, loss=1.27, accuracy=0.701, val_loss=1.99, val_accuracy=0.472, lr=0.1]  7%|▋         | 7/107 [03:49<47:49, 28.69s/epoch, loss=1.26, accuracy=0.708, val_loss=1.96, val_accuracy=0.501, lr=0.1]  7%|▋         | 8/107 [04:13<45:21, 27.49s/epoch, loss=1.24, accuracy=0.716, val_loss=2.49, val_accuracy=0.415, lr=0.1]  8%|▊         | 9/107 [04:38<43:28, 26.62s/epoch, loss=1.24, accuracy=0.722, val_loss=1.98, val_accuracy=0.533, lr=0.1]  9%|▉         | 10/107 [05:03<42:14, 26.13s/epoch, loss=1.23, accuracy=0.726, val_loss=2, val_accuracy=0.495, lr=0.1]   10%|█         | 11/107 [05:28<40:59, 25.62s/epoch, loss=1.23, accuracy=0.727, val_loss=1.67, val_accuracy=0.565, lr=0.1] 11%|█         | 12/107 [05:52<39:48, 25.14s/epoch, loss=1.22, accuracy=0.729, val_loss=1.91, val_accuracy=0.567, lr=0.1] 12%|█▏        | 13/107 [06:16<39:00, 24.90s/epoch, loss=1.21, accuracy=0.734, val_loss=1.71, val_accuracy=0.591, lr=0.1] 13%|█▎        | 14/107 [06:44<39:56, 25.77s/epoch, loss=1.21, accuracy=0.731, val_loss=2.45, val_accuracy=0.368, lr=0.1] 14%|█▍        | 15/107 [07:11<40:18, 26.28s/epoch, loss=1.2, accuracy=0.736, val_loss=1.96, val_accuracy=0.428, lr=0.1]  15%|█▍        | 16/107 [07:38<40:17, 26.57s/epoch, loss=1.2, accuracy=0.736, val_loss=2.51, val_accuracy=0.43, lr=0.0316] 16%|█▌        | 17/107 [08:06<40:25, 26.95s/epoch, loss=1.2, accuracy=0.738, val_loss=2.1, val_accuracy=0.425, lr=0.1]    17%|█▋        | 18/107 [08:34<40:11, 27.09s/epoch, loss=1.2, accuracy=0.739, val_loss=1.47, val_accuracy=0.647, lr=0.1] 18%|█▊        | 19/107 [09:01<40:00, 27.28s/epoch, loss=1.2, accuracy=0.739, val_loss=1.94, val_accuracy=0.54, lr=0.1]  19%|█▊        | 20/107 [09:29<39:50, 27.48s/epoch, loss=1.19, accuracy=0.74, val_loss=2.12, val_accuracy=0.464, lr=0.1] 20%|█▉        | 21/107 [09:57<39:26, 27.52s/epoch, loss=1.19, accuracy=0.738, val_loss=1.55, val_accuracy=0.613, lr=0.1] 21%|██        | 22/107 [10:24<38:44, 27.34s/epoch, loss=1.19, accuracy=0.743, val_loss=1.73, val_accuracy=0.546, lr=0.1] 21%|██▏       | 23/107 [10:51<38:20, 27.39s/epoch, loss=1.18, accuracy=0.743, val_loss=1.5, val_accuracy=0.637, lr=0.0316] 22%|██▏       | 24/107 [11:19<38:07, 27.56s/epoch, loss=1.18, accuracy=0.745, val_loss=2.06, val_accuracy=0.455, lr=0.1]   23%|██▎       | 25/107 [11:47<37:42, 27.59s/epoch, loss=1.18, accuracy=0.743, val_loss=2.42, val_accuracy=0.417, lr=0.1] 24%|██▍       | 26/107 [12:15<37:16, 27.61s/epoch, loss=1.18, accuracy=0.744, val_loss=1.69, val_accuracy=0.58, lr=0.1]  25%|██▌       | 27/107 [12:43<36:58, 27.73s/epoch, loss=1.18, accuracy=0.746, val_loss=4.13, val_accuracy=0.234, lr=0.1] 26%|██▌       | 28/107 [13:11<36:33, 27.76s/epoch, loss=1.18, accuracy=0.742, val_loss=2.11, val_accuracy=0.492, lr=0.0316] 27%|██▋       | 29/107 [13:38<36:09, 27.81s/epoch, loss=1.16, accuracy=0.748, val_loss=2.07, val_accuracy=0.526, lr=0.1]    28%|██▊       | 30/107 [14:06<35:39, 27.78s/epoch, loss=1.17, accuracy=0.745, val_loss=2.47, val_accuracy=0.392, lr=0.1] 29%|██▉       | 31/107 [14:34<35:13, 27.80s/epoch, loss=1.17, accuracy=0.747, val_loss=1.46, val_accuracy=0.639, lr=0.1] 30%|██▉       | 32/107 [15:02<34:44, 27.79s/epoch, loss=1.16, accuracy=0.747, val_loss=2, val_accuracy=0.5, lr=0.1]      31%|███       | 33/107 [15:30<34:22, 27.87s/epoch, loss=1.17, accuracy=0.747, val_loss=1.78, val_accuracy=0.524, lr=0.1] 32%|███▏      | 34/107 [15:58<33:53, 27.86s/epoch, loss=1.16, accuracy=0.748, val_loss=1.82, val_accuracy=0.527, lr=0.1] 33%|███▎      | 35/107 [16:26<33:25, 27.86s/epoch, loss=1.16, accuracy=0.747, val_loss=3.14, val_accuracy=0.304, lr=0.1] 34%|███▎      | 36/107 [16:53<32:59, 27.88s/epoch, loss=1.16, accuracy=0.747, val_loss=1.86, val_accuracy=0.539, lr=0.0316] 35%|███▍      | 37/107 [17:21<32:25, 27.79s/epoch, loss=1.17, accuracy=0.749, val_loss=2.34, val_accuracy=0.455, lr=0.1]    36%|███▌      | 38/107 [17:49<32:01, 27.85s/epoch, loss=1.16, accuracy=0.751, val_loss=1.92, val_accuracy=0.524, lr=0.1] 36%|███▋      | 39/107 [18:17<31:36, 27.89s/epoch, loss=1.16, accuracy=0.749, val_loss=1.84, val_accuracy=0.507, lr=0.1] 37%|███▋      | 40/107 [18:45<31:05, 27.84s/epoch, loss=1.16, accuracy=0.75, val_loss=1.66, val_accuracy=0.621, lr=0.1]  38%|███▊      | 41/107 [19:13<30:42, 27.92s/epoch, loss=1.16, accuracy=0.751, val_loss=1.96, val_accuracy=0.522, lr=0.0316] 39%|███▉      | 42/107 [19:40<30:05, 27.78s/epoch, loss=1.16, accuracy=0.749, val_loss=2.85, val_accuracy=0.39, lr=0.1]     40%|████      | 43/107 [20:06<28:59, 27.19s/epoch, loss=1.16, accuracy=0.752, val_loss=3.65, val_accuracy=0.295, lr=0.1] 41%|████      | 44/107 [20:33<28:26, 27.09s/epoch, loss=1.16, accuracy=0.75, val_loss=1.5, val_accuracy=0.634, lr=0.1]   42%|████▏     | 45/107 [21:00<28:00, 27.11s/epoch, loss=1.15, accuracy=0.751, val_loss=1.93, val_accuracy=0.488, lr=0.1] 43%|████▎     | 46/107 [21:27<27:37, 27.16s/epoch, loss=1.15, accuracy=0.751, val_loss=1.67, val_accuracy=0.605, lr=0.0316] 44%|████▍     | 47/107 [21:55<27:25, 27.42s/epoch, loss=1.15, accuracy=0.754, val_loss=1.54, val_accuracy=0.608, lr=0.1]    45%|████▍     | 48/107 [22:23<27:02, 27.51s/epoch, loss=1.15, accuracy=0.752, val_loss=1.89, val_accuracy=0.5, lr=0.1]   46%|████▌     | 49/107 [22:51<26:39, 27.57s/epoch, loss=1.15, accuracy=0.75, val_loss=3.51, val_accuracy=0.236, lr=0.1] 47%|████▋     | 50/107 [23:19<26:17, 27.68s/epoch, loss=1.15, accuracy=0.75, val_loss=2.5, val_accuracy=0.37, lr=0.1]   48%|████▊     | 51/107 [23:47<25:49, 27.67s/epoch, loss=1.15, accuracy=0.755, val_loss=2.63, val_accuracy=0.367, lr=0.0316] 49%|████▊     | 52/107 [24:14<25:24, 27.72s/epoch, loss=1.14, accuracy=0.753, val_loss=1.78, val_accuracy=0.543, lr=0.1]    50%|████▉     | 53/107 [24:42<25:00, 27.80s/epoch, loss=1.15, accuracy=0.751, val_loss=1.71, val_accuracy=0.587, lr=0.1] 50%|█████     | 54/107 [25:09<24:15, 27.46s/epoch, loss=1.14, accuracy=0.753, val_loss=1.75, val_accuracy=0.597, lr=0.1] 51%|█████▏    | 55/107 [25:37<23:58, 27.67s/epoch, loss=1.15, accuracy=0.752, val_loss=3.42, val_accuracy=0.362, lr=0.1] 52%|█████▏    | 56/107 [26:05<23:30, 27.66s/epoch, loss=1.15, accuracy=0.751, val_loss=1.81, val_accuracy=0.531, lr=0.0316] 53%|█████▎    | 57/107 [26:32<23:03, 27.67s/epoch, loss=1.14, accuracy=0.753, val_loss=3.54, val_accuracy=0.273, lr=0.1]    54%|█████▍    | 58/107 [27:00<22:38, 27.72s/epoch, loss=1.14, accuracy=0.752, val_loss=1.44, val_accuracy=0.676, lr=0.1] 55%|█████▌    | 59/107 [27:28<22:11, 27.74s/epoch, loss=1.13, accuracy=0.756, val_loss=2.19, val_accuracy=0.472, lr=0.1] 56%|█████▌    | 60/107 [27:56<21:45, 27.77s/epoch, loss=1.14, accuracy=0.752, val_loss=2.35, val_accuracy=0.496, lr=0.1] 57%|█████▋    | 61/107 [28:24<21:18, 27.79s/epoch, loss=1.14, accuracy=0.753, val_loss=2.11, val_accuracy=0.48, lr=0.1]  58%|█████▊    | 62/107 [28:52<20:55, 27.89s/epoch, loss=1.13, accuracy=0.755, val_loss=2.38, val_accuracy=0.442, lr=0.1] 59%|█████▉    | 63/107 [29:20<20:24, 27.83s/epoch, loss=1.13, accuracy=0.754, val_loss=1.76, val_accuracy=0.539, lr=0.0316] 60%|█████▉    | 64/107 [29:48<19:57, 27.85s/epoch, loss=1.14, accuracy=0.753, val_loss=1.89, val_accuracy=0.53, lr=0.1]     61%|██████    | 65/107 [30:14<19:16, 27.53s/epoch, loss=1.14, accuracy=0.751, val_loss=1.72, val_accuracy=0.554, lr=0.1] 62%|██████▏   | 66/107 [30:41<18:42, 27.37s/epoch, loss=1.13, accuracy=0.753, val_loss=2.35, val_accuracy=0.464, lr=0.1] 63%|██████▎   | 67/107 [31:09<18:16, 27.42s/epoch, loss=1.13, accuracy=0.754, val_loss=2.16, val_accuracy=0.465, lr=0.1] 64%|██████▎   | 68/107 [31:37<17:54, 27.55s/epoch, loss=1.14, accuracy=0.756, val_loss=3.65, val_accuracy=0.321, lr=0.0316] 64%|██████▍   | 69/107 [32:05<17:38, 27.85s/epoch, loss=1.13, accuracy=0.753, val_loss=2.15, val_accuracy=0.488, lr=0.1]    65%|██████▌   | 70/107 [32:33<17:09, 27.82s/epoch, loss=1.13, accuracy=0.754, val_loss=2.08, val_accuracy=0.524, lr=0.1] 66%|██████▋   | 71/107 [33:01<16:39, 27.75s/epoch, loss=1.14, accuracy=0.752, val_loss=1.82, val_accuracy=0.541, lr=0.1] 67%|██████▋   | 72/107 [33:28<16:04, 27.57s/epoch, loss=1.13, accuracy=0.755, val_loss=2.45, val_accuracy=0.332, lr=0.1] 68%|██████▊   | 73/107 [33:55<15:32, 27.42s/epoch, loss=1.13, accuracy=0.754, val_loss=1.9, val_accuracy=0.509, lr=0.0316] 69%|██████▉   | 74/107 [34:23<15:09, 27.57s/epoch, loss=1.13, accuracy=0.753, val_loss=2.12, val_accuracy=0.461, lr=0.1]   70%|███████   | 75/107 [34:50<14:44, 27.63s/epoch, loss=1.13, accuracy=0.756, val_loss=2.02, val_accuracy=0.544, lr=0.1] 71%|███████   | 76/107 [35:19<14:25, 27.93s/epoch, loss=1.13, accuracy=0.755, val_loss=1.92, val_accuracy=0.469, lr=0.1] 72%|███████▏  | 77/107 [35:47<13:58, 27.96s/epoch, loss=1.13, accuracy=0.754, val_loss=1.85, val_accuracy=0.517, lr=0.1] 73%|███████▎  | 78/107 [36:15<13:28, 27.90s/epoch, loss=1.14, accuracy=0.753, val_loss=1.81, val_accuracy=0.562, lr=0.0316] 74%|███████▍  | 79/107 [36:43<13:01, 27.91s/epoch, loss=1.13, accuracy=0.753, val_loss=2.23, val_accuracy=0.468, lr=0.1]    75%|███████▍  | 80/107 [37:11<12:32, 27.87s/epoch, loss=1.13, accuracy=0.756, val_loss=2.97, val_accuracy=0.436, lr=0.1] 76%|███████▌  | 81/107 [37:39<12:05, 27.90s/epoch, loss=1.14, accuracy=0.753, val_loss=2.51, val_accuracy=0.437, lr=0.1] 77%|███████▋  | 82/107 [38:06<11:34, 27.77s/epoch, loss=0.938, accuracy=0.812, val_loss=0.899, val_accuracy=0.806, lr=0.01] 78%|███████▊  | 83/107 [38:34<11:05, 27.73s/epoch, loss=0.754, accuracy=0.844, val_loss=0.79, val_accuracy=0.822, lr=0.01]  79%|███████▊  | 84/107 [39:01<10:36, 27.66s/epoch, loss=0.666, accuracy=0.854, val_loss=0.978, val_accuracy=0.751, lr=0.01] 79%|███████▉  | 85/107 [39:29<10:08, 27.65s/epoch, loss=0.616, accuracy=0.859, val_loss=0.823, val_accuracy=0.782, lr=0.01] 80%|████████  | 86/107 [39:57<09:45, 27.89s/epoch, loss=0.596, accuracy=0.859, val_loss=0.851, val_accuracy=0.771, lr=0.01] 81%|████████▏ | 87/107 [40:25<09:14, 27.72s/epoch, loss=0.582, accuracy=0.86, val_loss=0.787, val_accuracy=0.791, lr=0.01]  82%|████████▏ | 88/107 [40:53<08:50, 27.91s/epoch, loss=0.576, accuracy=0.86, val_loss=0.823, val_accuracy=0.784, lr=0.01] 83%|████████▎ | 89/107 [41:20<08:19, 27.77s/epoch, loss=0.576, accuracy=0.862, val_loss=0.857, val_accuracy=0.775, lr=0.01] 84%|████████▍ | 90/107 [41:48<07:50, 27.68s/epoch, loss=0.573, accuracy=0.864, val_loss=0.813, val_accuracy=0.792, lr=0.01] 85%|████████▌ | 91/107 [42:15<07:22, 27.63s/epoch, loss=0.568, accuracy=0.867, val_loss=0.802, val_accuracy=0.793, lr=0.01] 86%|████████▌ | 92/107 [42:42<06:52, 27.48s/epoch, loss=0.564, accuracy=0.869, val_loss=0.84, val_accuracy=0.787, lr=0.00316] 87%|████████▋ | 93/107 [43:10<06:26, 27.63s/epoch, loss=0.567, accuracy=0.867, val_loss=1.09, val_accuracy=0.712, lr=0.01]    88%|████████▊ | 94/107 [43:38<05:58, 27.58s/epoch, loss=0.566, accuracy=0.87, val_loss=1.32, val_accuracy=0.68, lr=0.01]   89%|████████▉ | 95/107 [44:05<05:30, 27.57s/epoch, loss=0.562, accuracy=0.871, val_loss=0.811, val_accuracy=0.794, lr=0.01] 90%|████████▉ | 96/107 [44:33<05:04, 27.68s/epoch, loss=0.567, accuracy=0.872, val_loss=0.821, val_accuracy=0.791, lr=0.01] 91%|█████████ | 97/107 [45:01<04:37, 27.75s/epoch, loss=0.561, accuracy=0.875, val_loss=0.882, val_accuracy=0.775, lr=0.00316] 92%|█████████▏| 98/107 [45:30<04:12, 28.07s/epoch, loss=0.56, accuracy=0.875, val_loss=1.04, val_accuracy=0.734, lr=0.01]      93%|█████████▎| 99/107 [45:59<03:45, 28.19s/epoch, loss=0.563, accuracy=0.874, val_loss=0.858, val_accuracy=0.8, lr=0.01] 93%|█████████▎| 100/107 [46:26<03:14, 27.81s/epoch, loss=0.562, accuracy=0.875, val_loss=1.19, val_accuracy=0.682, lr=0.01] 94%|█████████▍| 101/107 [46:53<02:46, 27.77s/epoch, loss=0.562, accuracy=0.876, val_loss=1.81, val_accuracy=0.571, lr=0.01] 95%|█████████▌| 102/107 [47:20<02:17, 27.59s/epoch, loss=0.562, accuracy=0.876, val_loss=0.976, val_accuracy=0.756, lr=0.00316] 96%|█████████▋| 103/107 [47:48<01:50, 27.55s/epoch, loss=0.561, accuracy=0.877, val_loss=0.89, val_accuracy=0.765, lr=0.01]     97%|█████████▋| 104/107 [48:13<01:20, 26.98s/epoch, loss=0.559, accuracy=0.878, val_loss=0.827, val_accuracy=0.794, lr=0.01] 98%|█████████▊| 105/107 [48:41<00:54, 27.11s/epoch, loss=0.56, accuracy=0.878, val_loss=0.805, val_accuracy=0.811, lr=0.01]  99%|█████████▉| 106/107 [49:07<00:26, 26.94s/epoch, loss=0.559, accuracy=0.881, val_loss=0.839, val_accuracy=0.8, lr=0.01] 100%|██████████| 107/107 [49:35<00:00, 27.16s/epoch, loss=0.563, accuracy=0.878, val_loss=0.857, val_accuracy=0.787, lr=0.00316]100%|██████████| 107/107 [49:35<00:00, 27.81s/epoch, loss=0.563, accuracy=0.878, val_loss=0.857, val_accuracy=0.787, lr=0.00316]
Using real-time data augmentation.
Test score: 0.8567410111427307
Test accuracy: 0.7865999937057495


* * * Run SGD for ID = 14_2. * * *


2024-03-05 04:59:02.160746: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 04:59:04.909089: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 04:59:04.910339: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-05 04:59:04.950822: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-05 04:59:04.950883: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 04:59:04.954416: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 04:59:04.954479: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-05 04:59:04.957333: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-05 04:59:04.958600: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-05 04:59:04.961737: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-05 04:59:04.963668: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-05 04:59:04.969457: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 04:59:04.970126: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-05 04:59:04.970210: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 04:59:06.191620: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-05 04:59:06.192700: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 04:59:06.193716: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-05 04:59:06.193750: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 04:59:06.193788: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 04:59:06.193802: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-05 04:59:06.193814: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-05 04:59:06.193832: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-05 04:59:06.193847: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-05 04:59:06.193861: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-05 04:59:06.193876: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 04:59:06.194395: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-05 04:59:06.194426: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 04:59:06.820882: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-05 04:59:06.820930: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-05 04:59:06.820940: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-05 04:59:06.821982: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:3b:00.0, compute capability: 6.1)
{'id': '14_02', 'seed': 2, 'out_folder': 'results/epoch_budget', 'batch_size': 128, 'epochs': 107, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/107 [00:00<?, ?epoch/s]2024-03-05 04:59:07.673993: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-05 04:59:07.674549: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-03-05 04:59:09.592101: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 04:59:09.847540: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 04:59:10.817264: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-05 04:59:10.874290: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/107 [01:05<1:55:10, 65.20s/epoch, loss=2.75, accuracy=0.442, val_loss=2.47, val_accuracy=0.316, lr=0.1]  2%|▏         | 2/107 [01:31<1:14:29, 42.57s/epoch, loss=1.42, accuracy=0.618, val_loss=2.56, val_accuracy=0.313, lr=0.1]  3%|▎         | 3/107 [01:56<59:53, 34.56s/epoch, loss=1.28, accuracy=0.676, val_loss=1.61, val_accuracy=0.589, lr=0.1]    4%|▎         | 4/107 [02:23<53:38, 31.25s/epoch, loss=1.25, accuracy=0.697, val_loss=1.88, val_accuracy=0.487, lr=0.1]  5%|▍         | 5/107 [02:49<50:04, 29.46s/epoch, loss=1.24, accuracy=0.707, val_loss=1.75, val_accuracy=0.557, lr=0.1]  6%|▌         | 6/107 [03:14<47:03, 27.95s/epoch, loss=1.23, accuracy=0.715, val_loss=1.7, val_accuracy=0.561, lr=0.1]   7%|▋         | 7/107 [03:42<46:31, 27.92s/epoch, loss=1.22, accuracy=0.723, val_loss=2, val_accuracy=0.506, lr=0.1]    7%|▋         | 8/107 [04:09<45:56, 27.85s/epoch, loss=1.21, accuracy=0.727, val_loss=2.02, val_accuracy=0.463, lr=0.0316]  8%|▊         | 9/107 [04:37<45:32, 27.88s/epoch, loss=1.21, accuracy=0.726, val_loss=2.92, val_accuracy=0.374, lr=0.1]     9%|▉         | 10/107 [05:04<44:17, 27.40s/epoch, loss=1.21, accuracy=0.728, val_loss=1.57, val_accuracy=0.608, lr=0.1] 10%|█         | 11/107 [05:28<42:25, 26.51s/epoch, loss=1.19, accuracy=0.734, val_loss=2.09, val_accuracy=0.444, lr=0.1] 11%|█         | 12/107 [05:54<41:39, 26.32s/epoch, loss=1.2, accuracy=0.731, val_loss=1.61, val_accuracy=0.606, lr=0.1]  12%|█▏        | 13/107 [06:22<42:00, 26.82s/epoch, loss=1.19, accuracy=0.737, val_loss=2.21, val_accuracy=0.453, lr=0.1] 13%|█▎        | 14/107 [06:49<41:40, 26.89s/epoch, loss=1.18, accuracy=0.737, val_loss=1.71, val_accuracy=0.577, lr=0.1] 14%|█▍        | 15/107 [07:16<41:17, 26.93s/epoch, loss=1.18, accuracy=0.739, val_loss=2.49, val_accuracy=0.443, lr=0.0316] 15%|█▍        | 16/107 [07:43<40:37, 26.79s/epoch, loss=1.18, accuracy=0.738, val_loss=1.64, val_accuracy=0.602, lr=0.1]    16%|█▌        | 17/107 [08:09<39:50, 26.56s/epoch, loss=1.17, accuracy=0.741, val_loss=2.15, val_accuracy=0.428, lr=0.1] 17%|█▋        | 18/107 [08:33<38:21, 25.86s/epoch, loss=1.17, accuracy=0.743, val_loss=2.68, val_accuracy=0.391, lr=0.1] 18%|█▊        | 19/107 [08:59<38:07, 25.99s/epoch, loss=1.16, accuracy=0.743, val_loss=2.28, val_accuracy=0.495, lr=0.1] 19%|█▊        | 20/107 [09:26<38:09, 26.32s/epoch, loss=1.17, accuracy=0.744, val_loss=1.91, val_accuracy=0.542, lr=0.0316] 20%|█▉        | 21/107 [09:53<37:44, 26.34s/epoch, loss=1.16, accuracy=0.741, val_loss=3.53, val_accuracy=0.367, lr=0.1]    21%|██        | 22/107 [10:20<37:55, 26.78s/epoch, loss=1.15, accuracy=0.745, val_loss=2.81, val_accuracy=0.436, lr=0.1] 21%|██▏       | 23/107 [10:48<37:56, 27.10s/epoch, loss=1.15, accuracy=0.75, val_loss=2.1, val_accuracy=0.435, lr=0.1]   22%|██▏       | 24/107 [11:16<37:49, 27.35s/epoch, loss=1.16, accuracy=0.747, val_loss=1.9, val_accuracy=0.534, lr=0.1] 23%|██▎       | 25/107 [11:44<37:32, 27.47s/epoch, loss=1.16, accuracy=0.748, val_loss=1.48, val_accuracy=0.648, lr=0.1] 24%|██▍       | 26/107 [12:12<37:15, 27.60s/epoch, loss=1.15, accuracy=0.75, val_loss=1.86, val_accuracy=0.527, lr=0.1]  25%|██▌       | 27/107 [12:40<36:55, 27.69s/epoch, loss=1.15, accuracy=0.748, val_loss=2.2, val_accuracy=0.492, lr=0.1] 26%|██▌       | 28/107 [13:08<36:30, 27.72s/epoch, loss=1.15, accuracy=0.747, val_loss=1.67, val_accuracy=0.584, lr=0.1] 27%|██▋       | 29/107 [13:35<36:05, 27.76s/epoch, loss=1.15, accuracy=0.749, val_loss=1.44, val_accuracy=0.635, lr=0.1] 28%|██▊       | 30/107 [14:03<35:42, 27.82s/epoch, loss=1.15, accuracy=0.748, val_loss=3.94, val_accuracy=0.316, lr=0.1] 29%|██▉       | 31/107 [14:31<35:18, 27.87s/epoch, loss=1.15, accuracy=0.748, val_loss=2.06, val_accuracy=0.477, lr=0.1] 30%|██▉       | 32/107 [14:59<34:50, 27.87s/epoch, loss=1.14, accuracy=0.749, val_loss=1.69, val_accuracy=0.578, lr=0.1] 31%|███       | 33/107 [15:27<34:21, 27.86s/epoch, loss=1.14, accuracy=0.75, val_loss=1.55, val_accuracy=0.611, lr=0.1]  32%|███▏      | 34/107 [15:54<33:35, 27.61s/epoch, loss=1.15, accuracy=0.747, val_loss=2.14, val_accuracy=0.493, lr=0.0316] 33%|███▎      | 35/107 [16:21<32:49, 27.35s/epoch, loss=1.14, accuracy=0.751, val_loss=2.44, val_accuracy=0.4, lr=0.1]      34%|███▎      | 36/107 [16:48<32:08, 27.16s/epoch, loss=1.14, accuracy=0.748, val_loss=2.21, val_accuracy=0.469, lr=0.1] 35%|███▍      | 37/107 [17:15<31:51, 27.31s/epoch, loss=1.14, accuracy=0.75, val_loss=2.58, val_accuracy=0.365, lr=0.1]  36%|███▌      | 38/107 [17:42<31:23, 27.30s/epoch, loss=1.14, accuracy=0.754, val_loss=3.31, val_accuracy=0.303, lr=0.1] 36%|███▋      | 39/107 [18:09<30:47, 27.17s/epoch, loss=1.13, accuracy=0.752, val_loss=2.12, val_accuracy=0.502, lr=0.0316] 37%|███▋      | 40/107 [18:37<30:24, 27.22s/epoch, loss=1.13, accuracy=0.752, val_loss=10.7, val_accuracy=0.149, lr=0.1]    38%|███▊      | 41/107 [19:04<30:05, 27.35s/epoch, loss=1.14, accuracy=0.753, val_loss=1.58, val_accuracy=0.64, lr=0.1]  39%|███▉      | 42/107 [19:32<29:38, 27.36s/epoch, loss=1.13, accuracy=0.755, val_loss=1.81, val_accuracy=0.55, lr=0.1] 40%|████      | 43/107 [19:59<29:12, 27.39s/epoch, loss=1.13, accuracy=0.755, val_loss=1.74, val_accuracy=0.541, lr=0.1] 41%|████      | 44/107 [20:27<28:54, 27.53s/epoch, loss=1.13, accuracy=0.753, val_loss=2.42, val_accuracy=0.447, lr=0.0316] 42%|████▏     | 45/107 [20:55<28:28, 27.56s/epoch, loss=1.13, accuracy=0.753, val_loss=2.01, val_accuracy=0.553, lr=0.1]    43%|████▎     | 46/107 [21:23<28:06, 27.65s/epoch, loss=1.13, accuracy=0.754, val_loss=2.25, val_accuracy=0.447, lr=0.1] 44%|████▍     | 47/107 [21:50<27:42, 27.71s/epoch, loss=1.13, accuracy=0.753, val_loss=1.83, val_accuracy=0.534, lr=0.1] 45%|████▍     | 48/107 [22:18<27:15, 27.72s/epoch, loss=1.13, accuracy=0.755, val_loss=2.23, val_accuracy=0.496, lr=0.1] 46%|████▌     | 49/107 [22:46<26:50, 27.77s/epoch, loss=1.12, accuracy=0.758, val_loss=1.93, val_accuracy=0.512, lr=0.0316] 47%|████▋     | 50/107 [23:14<26:19, 27.72s/epoch, loss=1.13, accuracy=0.751, val_loss=2.07, val_accuracy=0.48, lr=0.1]     48%|████▊     | 51/107 [23:42<25:55, 27.78s/epoch, loss=1.13, accuracy=0.754, val_loss=4.12, val_accuracy=0.389, lr=0.1] 49%|████▊     | 52/107 [24:09<25:29, 27.81s/epoch, loss=1.13, accuracy=0.753, val_loss=2.77, val_accuracy=0.402, lr=0.1] 50%|████▉     | 53/107 [24:36<24:42, 27.45s/epoch, loss=1.12, accuracy=0.757, val_loss=1.75, val_accuracy=0.546, lr=0.1] 50%|█████     | 54/107 [25:01<23:40, 26.80s/epoch, loss=1.12, accuracy=0.755, val_loss=1.32, val_accuracy=0.679, lr=0.1] 51%|█████▏    | 55/107 [25:25<22:28, 25.94s/epoch, loss=1.12, accuracy=0.754, val_loss=3.48, val_accuracy=0.363, lr=0.1] 52%|█████▏    | 56/107 [25:50<21:41, 25.53s/epoch, loss=1.12, accuracy=0.758, val_loss=2.42, val_accuracy=0.432, lr=0.1] 53%|█████▎    | 57/107 [26:17<21:46, 26.13s/epoch, loss=1.12, accuracy=0.757, val_loss=1.49, val_accuracy=0.622, lr=0.1] 54%|█████▍    | 58/107 [26:45<21:46, 26.65s/epoch, loss=1.13, accuracy=0.754, val_loss=2.59, val_accuracy=0.433, lr=0.1] 55%|█████▌    | 59/107 [27:13<21:38, 27.06s/epoch, loss=1.12, accuracy=0.759, val_loss=1.55, val_accuracy=0.635, lr=0.0316] 56%|█████▌    | 60/107 [27:41<21:20, 27.25s/epoch, loss=1.12, accuracy=0.753, val_loss=2.11, val_accuracy=0.477, lr=0.1]    57%|█████▋    | 61/107 [28:09<21:00, 27.40s/epoch, loss=1.12, accuracy=0.756, val_loss=1.86, val_accuracy=0.502, lr=0.1] 58%|█████▊    | 62/107 [28:37<20:38, 27.53s/epoch, loss=1.12, accuracy=0.758, val_loss=1.92, val_accuracy=0.555, lr=0.1] 59%|█████▉    | 63/107 [29:04<20:13, 27.57s/epoch, loss=1.12, accuracy=0.758, val_loss=1.41, val_accuracy=0.661, lr=0.1] 60%|█████▉    | 64/107 [29:31<19:38, 27.40s/epoch, loss=1.12, accuracy=0.755, val_loss=2.15, val_accuracy=0.489, lr=0.0316] 61%|██████    | 65/107 [29:57<18:47, 26.85s/epoch, loss=1.12, accuracy=0.756, val_loss=2.49, val_accuracy=0.415, lr=0.1]    62%|██████▏   | 66/107 [30:23<18:12, 26.65s/epoch, loss=1.12, accuracy=0.758, val_loss=1.71, val_accuracy=0.566, lr=0.1] 63%|██████▎   | 67/107 [30:49<17:42, 26.57s/epoch, loss=1.12, accuracy=0.759, val_loss=3.57, val_accuracy=0.277, lr=0.1] 64%|██████▎   | 68/107 [31:16<17:12, 26.48s/epoch, loss=1.12, accuracy=0.759, val_loss=2.11, val_accuracy=0.464, lr=0.1] 64%|██████▍   | 69/107 [31:44<17:02, 26.92s/epoch, loss=1.12, accuracy=0.757, val_loss=2.13, val_accuracy=0.48, lr=0.0316] 65%|██████▌   | 70/107 [32:12<16:47, 27.24s/epoch, loss=1.12, accuracy=0.757, val_loss=1.61, val_accuracy=0.576, lr=0.1]   66%|██████▋   | 71/107 [32:39<16:27, 27.42s/epoch, loss=1.11, accuracy=0.758, val_loss=2.53, val_accuracy=0.391, lr=0.1] 67%|██████▋   | 72/107 [33:07<16:05, 27.58s/epoch, loss=1.13, accuracy=0.756, val_loss=1.97, val_accuracy=0.528, lr=0.1] 68%|██████▊   | 73/107 [33:33<15:16, 26.95s/epoch, loss=1.11, accuracy=0.758, val_loss=3.02, val_accuracy=0.296, lr=0.1] 69%|██████▉   | 74/107 [33:57<14:19, 26.04s/epoch, loss=1.12, accuracy=0.757, val_loss=1.8, val_accuracy=0.558, lr=0.0316] 70%|███████   | 75/107 [34:20<13:31, 25.36s/epoch, loss=1.11, accuracy=0.759, val_loss=1.78, val_accuracy=0.513, lr=0.1]   71%|███████   | 76/107 [34:46<13:09, 25.48s/epoch, loss=1.12, accuracy=0.756, val_loss=2.31, val_accuracy=0.476, lr=0.1] 72%|███████▏  | 77/107 [35:12<12:43, 25.44s/epoch, loss=1.11, accuracy=0.758, val_loss=2.01, val_accuracy=0.477, lr=0.1] 73%|███████▎  | 78/107 [35:36<12:09, 25.16s/epoch, loss=1.12, accuracy=0.757, val_loss=1.8, val_accuracy=0.549, lr=0.1]  74%|███████▍  | 79/107 [36:02<11:50, 25.38s/epoch, loss=1.11, accuracy=0.759, val_loss=2.37, val_accuracy=0.486, lr=0.0316] 75%|███████▍  | 80/107 [36:29<11:39, 25.90s/epoch, loss=1.11, accuracy=0.758, val_loss=1.97, val_accuracy=0.54, lr=0.1]     76%|███████▌  | 81/107 [36:57<11:28, 26.50s/epoch, loss=1.11, accuracy=0.758, val_loss=5.89, val_accuracy=0.239, lr=0.1] 77%|███████▋  | 82/107 [37:25<11:15, 27.03s/epoch, loss=0.909, accuracy=0.814, val_loss=0.886, val_accuracy=0.81, lr=0.01] 78%|███████▊  | 83/107 [37:53<10:56, 27.37s/epoch, loss=0.727, accuracy=0.849, val_loss=0.815, val_accuracy=0.81, lr=0.01] 79%|███████▊  | 84/107 [38:22<10:35, 27.62s/epoch, loss=0.647, accuracy=0.856, val_loss=0.846, val_accuracy=0.793, lr=0.01] 79%|███████▉  | 85/107 [38:50<10:12, 27.83s/epoch, loss=0.601, accuracy=0.86, val_loss=0.975, val_accuracy=0.748, lr=0.01]  80%|████████  | 86/107 [39:17<09:41, 27.70s/epoch, loss=0.578, accuracy=0.863, val_loss=0.746, val_accuracy=0.808, lr=0.01] 81%|████████▏ | 87/107 [39:45<09:16, 27.80s/epoch, loss=0.567, accuracy=0.864, val_loss=0.845, val_accuracy=0.779, lr=0.01] 82%|████████▏ | 88/107 [40:14<08:50, 27.91s/epoch, loss=0.564, accuracy=0.865, val_loss=0.83, val_accuracy=0.77, lr=0.01]   83%|████████▎ | 89/107 [40:42<08:23, 27.94s/epoch, loss=0.561, accuracy=0.865, val_loss=0.809, val_accuracy=0.78, lr=0.01] 84%|████████▍ | 90/107 [41:10<07:57, 28.10s/epoch, loss=0.558, accuracy=0.867, val_loss=0.753, val_accuracy=0.811, lr=0.01] 85%|████████▌ | 91/107 [41:38<07:31, 28.19s/epoch, loss=0.558, accuracy=0.868, val_loss=0.858, val_accuracy=0.775, lr=0.00316] 86%|████████▌ | 92/107 [42:06<07:02, 28.15s/epoch, loss=0.555, accuracy=0.87, val_loss=0.741, val_accuracy=0.813, lr=0.01]     87%|████████▋ | 93/107 [42:34<06:31, 27.94s/epoch, loss=0.551, accuracy=0.871, val_loss=0.877, val_accuracy=0.777, lr=0.01] 88%|████████▊ | 94/107 [43:02<06:02, 27.85s/epoch, loss=0.553, accuracy=0.872, val_loss=0.909, val_accuracy=0.776, lr=0.01] 89%|████████▉ | 95/107 [43:29<05:32, 27.69s/epoch, loss=0.556, accuracy=0.872, val_loss=0.912, val_accuracy=0.757, lr=0.01] 90%|████████▉ | 96/107 [43:56<05:01, 27.37s/epoch, loss=0.551, accuracy=0.875, val_loss=0.822, val_accuracy=0.796, lr=0.01] 91%|█████████ | 97/107 [44:23<04:35, 27.53s/epoch, loss=0.554, accuracy=0.873, val_loss=0.697, val_accuracy=0.828, lr=0.01] 92%|█████████▏| 98/107 [44:51<04:07, 27.47s/epoch, loss=0.552, accuracy=0.874, val_loss=0.868, val_accuracy=0.777, lr=0.01] 93%|█████████▎| 99/107 [45:18<03:39, 27.44s/epoch, loss=0.548, accuracy=0.876, val_loss=0.829, val_accuracy=0.789, lr=0.01] 93%|█████████▎| 100/107 [45:46<03:13, 27.60s/epoch, loss=0.556, accuracy=0.875, val_loss=1.01, val_accuracy=0.747, lr=0.01] 94%|█████████▍| 101/107 [46:14<02:46, 27.69s/epoch, loss=0.545, accuracy=0.879, val_loss=0.991, val_accuracy=0.743, lr=0.01] 95%|█████████▌| 102/107 [46:42<02:19, 27.88s/epoch, loss=0.552, accuracy=0.879, val_loss=1.02, val_accuracy=0.743, lr=0.00316] 96%|█████████▋| 103/107 [47:10<01:51, 27.80s/epoch, loss=0.548, accuracy=0.881, val_loss=0.874, val_accuracy=0.783, lr=0.01]   97%|█████████▋| 104/107 [47:37<01:22, 27.48s/epoch, loss=0.552, accuracy=0.878, val_loss=0.733, val_accuracy=0.819, lr=0.01] 98%|█████████▊| 105/107 [48:03<00:54, 27.09s/epoch, loss=0.55, accuracy=0.88, val_loss=0.746, val_accuracy=0.824, lr=0.01]   99%|█████████▉| 106/107 [48:31<00:27, 27.35s/epoch, loss=0.548, accuracy=0.88, val_loss=0.956, val_accuracy=0.759, lr=0.01]100%|██████████| 107/107 [48:59<00:00, 27.54s/epoch, loss=0.551, accuracy=0.88, val_loss=0.819, val_accuracy=0.798, lr=0.00316]100%|██████████| 107/107 [48:59<00:00, 27.47s/epoch, loss=0.551, accuracy=0.88, val_loss=0.819, val_accuracy=0.798, lr=0.00316]
Using real-time data augmentation.
Test score: 0.8192737102508545
Test accuracy: 0.7976999878883362


* * * Run SGD for ID = 14_3. * * *


2024-03-05 05:48:11.006565: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 05:48:13.573659: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 05:48:13.574907: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-05 05:48:13.615658: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-05 05:48:13.615699: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 05:48:13.618961: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 05:48:13.619027: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-05 05:48:13.621611: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-05 05:48:13.622686: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-05 05:48:13.625565: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-05 05:48:13.627141: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-05 05:48:13.632605: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 05:48:13.633258: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-05 05:48:13.633340: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 05:48:14.826389: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-05 05:48:14.827470: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 05:48:14.828592: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-05 05:48:14.828628: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 05:48:14.828666: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 05:48:14.828683: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-05 05:48:14.828697: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-05 05:48:14.828712: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-05 05:48:14.828728: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-05 05:48:14.828744: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-05 05:48:14.828760: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 05:48:14.829343: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-05 05:48:14.829387: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 05:48:15.458288: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-05 05:48:15.458339: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-05 05:48:15.458349: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-05 05:48:15.459357: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:3b:00.0, compute capability: 6.1)
{'id': '14_03', 'seed': 3, 'out_folder': 'results/epoch_budget', 'batch_size': 128, 'epochs': 107, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/107 [00:00<?, ?epoch/s]2024-03-05 05:48:16.305612: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-05 05:48:16.318010: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-03-05 05:48:18.252712: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 05:48:18.593759: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 05:48:19.617020: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-05 05:48:19.669234: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/107 [01:02<1:49:51, 62.18s/epoch, loss=2.83, accuracy=0.412, val_loss=3.73, val_accuracy=0.186, lr=0.1]  2%|▏         | 2/107 [01:29<1:12:30, 41.43s/epoch, loss=1.47, accuracy=0.594, val_loss=2.71, val_accuracy=0.444, lr=0.1]  3%|▎         | 3/107 [01:55<1:00:07, 34.69s/epoch, loss=1.31, accuracy=0.667, val_loss=2.47, val_accuracy=0.337, lr=0.1]  4%|▎         | 4/107 [02:22<54:09, 31.55s/epoch, loss=1.26, accuracy=0.695, val_loss=1.58, val_accuracy=0.594, lr=0.1]    5%|▍         | 5/107 [02:49<50:39, 29.80s/epoch, loss=1.24, accuracy=0.711, val_loss=1.51, val_accuracy=0.626, lr=0.1]  6%|▌         | 6/107 [03:16<48:32, 28.83s/epoch, loss=1.23, accuracy=0.717, val_loss=2.05, val_accuracy=0.455, lr=0.1]  7%|▋         | 7/107 [03:42<46:51, 28.11s/epoch, loss=1.22, accuracy=0.722, val_loss=2.02, val_accuracy=0.507, lr=0.1]  7%|▋         | 8/107 [04:10<46:03, 27.91s/epoch, loss=1.2, accuracy=0.731, val_loss=3.73, val_accuracy=0.301, lr=0.1]   8%|▊         | 9/107 [04:38<45:36, 27.92s/epoch, loss=1.2, accuracy=0.732, val_loss=3.94, val_accuracy=0.319, lr=0.1]  9%|▉         | 10/107 [05:05<44:56, 27.79s/epoch, loss=1.2, accuracy=0.733, val_loss=2.67, val_accuracy=0.408, lr=0.0316] 10%|█         | 11/107 [05:33<44:23, 27.74s/epoch, loss=1.19, accuracy=0.737, val_loss=2.19, val_accuracy=0.511, lr=0.1]   11%|█         | 12/107 [06:01<44:08, 27.88s/epoch, loss=1.19, accuracy=0.739, val_loss=1.76, val_accuracy=0.526, lr=0.1] 12%|█▏        | 13/107 [06:29<43:49, 27.98s/epoch, loss=1.19, accuracy=0.74, val_loss=2.9, val_accuracy=0.434, lr=0.1]   13%|█▎        | 14/107 [06:57<43:15, 27.91s/epoch, loss=1.18, accuracy=0.74, val_loss=1.6, val_accuracy=0.599, lr=0.1] 14%|█▍        | 15/107 [07:25<42:51, 27.96s/epoch, loss=1.17, accuracy=0.744, val_loss=2.48, val_accuracy=0.441, lr=0.0316] 15%|█▍        | 16/107 [07:53<42:20, 27.92s/epoch, loss=1.17, accuracy=0.746, val_loss=1.97, val_accuracy=0.469, lr=0.1]    16%|█▌        | 17/107 [08:21<42:00, 28.00s/epoch, loss=1.17, accuracy=0.743, val_loss=1.58, val_accuracy=0.611, lr=0.1] 17%|█▋        | 18/107 [08:49<41:26, 27.94s/epoch, loss=1.17, accuracy=0.747, val_loss=3.11, val_accuracy=0.322, lr=0.1] 18%|█▊        | 19/107 [09:16<40:48, 27.82s/epoch, loss=1.17, accuracy=0.745, val_loss=2.03, val_accuracy=0.44, lr=0.1]  19%|█▊        | 20/107 [09:44<40:19, 27.81s/epoch, loss=1.16, accuracy=0.748, val_loss=3.07, val_accuracy=0.404, lr=0.0316] 20%|█▉        | 21/107 [10:13<40:06, 27.98s/epoch, loss=1.16, accuracy=0.748, val_loss=2.08, val_accuracy=0.471, lr=0.1]    21%|██        | 22/107 [10:40<39:34, 27.93s/epoch, loss=1.16, accuracy=0.749, val_loss=2.36, val_accuracy=0.356, lr=0.1] 21%|██▏       | 23/107 [11:09<39:13, 28.02s/epoch, loss=1.15, accuracy=0.749, val_loss=1.57, val_accuracy=0.624, lr=0.1] 22%|██▏       | 24/107 [11:36<38:34, 27.89s/epoch, loss=1.16, accuracy=0.748, val_loss=2.27, val_accuracy=0.386, lr=0.1] 23%|██▎       | 25/107 [12:04<37:59, 27.80s/epoch, loss=1.15, accuracy=0.75, val_loss=1.8, val_accuracy=0.554, lr=0.0316] 24%|██▍       | 26/107 [12:32<37:49, 28.02s/epoch, loss=1.15, accuracy=0.752, val_loss=4.09, val_accuracy=0.289, lr=0.1]  25%|██▌       | 27/107 [13:01<37:26, 28.09s/epoch, loss=1.15, accuracy=0.753, val_loss=2.34, val_accuracy=0.43, lr=0.1]  26%|██▌       | 28/107 [13:29<36:56, 28.06s/epoch, loss=1.14, accuracy=0.754, val_loss=2.27, val_accuracy=0.47, lr=0.1] 27%|██▋       | 29/107 [13:57<36:29, 28.07s/epoch, loss=1.14, accuracy=0.751, val_loss=1.87, val_accuracy=0.532, lr=0.1] 28%|██▊       | 30/107 [14:24<35:39, 27.78s/epoch, loss=1.14, accuracy=0.755, val_loss=1.62, val_accuracy=0.559, lr=0.0316] 29%|██▉       | 31/107 [14:51<35:02, 27.66s/epoch, loss=1.14, accuracy=0.754, val_loss=1.41, val_accuracy=0.665, lr=0.1]    30%|██▉       | 32/107 [15:18<34:20, 27.47s/epoch, loss=1.13, accuracy=0.756, val_loss=1.5, val_accuracy=0.624, lr=0.1]  31%|███       | 33/107 [15:46<33:57, 27.54s/epoch, loss=1.14, accuracy=0.752, val_loss=1.88, val_accuracy=0.491, lr=0.1] 32%|███▏      | 34/107 [16:14<33:33, 27.58s/epoch, loss=1.14, accuracy=0.753, val_loss=3.27, val_accuracy=0.376, lr=0.1] 33%|███▎      | 35/107 [16:41<33:00, 27.51s/epoch, loss=1.14, accuracy=0.755, val_loss=1.87, val_accuracy=0.541, lr=0.1] 34%|███▎      | 36/107 [17:09<32:36, 27.56s/epoch, loss=1.13, accuracy=0.757, val_loss=1.93, val_accuracy=0.542, lr=0.0316] 35%|███▍      | 37/107 [17:37<32:22, 27.75s/epoch, loss=1.13, accuracy=0.754, val_loss=2.34, val_accuracy=0.427, lr=0.1]    36%|███▌      | 38/107 [18:05<31:57, 27.80s/epoch, loss=1.13, accuracy=0.756, val_loss=2.28, val_accuracy=0.447, lr=0.1] 36%|███▋      | 39/107 [18:32<31:21, 27.66s/epoch, loss=1.13, accuracy=0.756, val_loss=1.65, val_accuracy=0.568, lr=0.1] 37%|███▋      | 40/107 [18:58<30:28, 27.29s/epoch, loss=1.13, accuracy=0.755, val_loss=1.45, val_accuracy=0.642, lr=0.1] 38%|███▊      | 41/107 [19:26<29:57, 27.23s/epoch, loss=1.12, accuracy=0.758, val_loss=2.09, val_accuracy=0.475, lr=0.0316] 39%|███▉      | 42/107 [19:53<29:29, 27.22s/epoch, loss=1.13, accuracy=0.756, val_loss=2.75, val_accuracy=0.432, lr=0.1]    40%|████      | 43/107 [20:20<29:02, 27.23s/epoch, loss=1.12, accuracy=0.759, val_loss=2.35, val_accuracy=0.435, lr=0.1] 41%|████      | 44/107 [20:48<28:53, 27.52s/epoch, loss=1.12, accuracy=0.757, val_loss=1.39, val_accuracy=0.668, lr=0.1] 42%|████▏     | 45/107 [21:17<28:42, 27.78s/epoch, loss=1.12, accuracy=0.759, val_loss=2.03, val_accuracy=0.464, lr=0.1] 43%|████▎     | 46/107 [21:45<28:21, 27.89s/epoch, loss=1.12, accuracy=0.76, val_loss=2.91, val_accuracy=0.45, lr=0.1]   44%|████▍     | 47/107 [22:13<27:56, 27.94s/epoch, loss=1.13, accuracy=0.756, val_loss=2.23, val_accuracy=0.46, lr=0.1] 45%|████▍     | 48/107 [22:41<27:37, 28.09s/epoch, loss=1.12, accuracy=0.758, val_loss=1.69, val_accuracy=0.597, lr=0.1] 46%|████▌     | 49/107 [23:09<27:12, 28.15s/epoch, loss=1.13, accuracy=0.756, val_loss=1.68, val_accuracy=0.557, lr=0.0316] 47%|████▋     | 50/107 [23:37<26:41, 28.09s/epoch, loss=1.12, accuracy=0.758, val_loss=2.43, val_accuracy=0.449, lr=0.1]    48%|████▊     | 51/107 [24:06<26:17, 28.17s/epoch, loss=1.12, accuracy=0.76, val_loss=2.09, val_accuracy=0.433, lr=0.1]  49%|████▊     | 52/107 [24:34<25:46, 28.13s/epoch, loss=1.12, accuracy=0.761, val_loss=2.28, val_accuracy=0.45, lr=0.1] 50%|████▉     | 53/107 [25:02<25:22, 28.20s/epoch, loss=1.12, accuracy=0.755, val_loss=2.81, val_accuracy=0.411, lr=0.1] 50%|█████     | 54/107 [25:30<24:52, 28.15s/epoch, loss=1.11, accuracy=0.759, val_loss=1.89, val_accuracy=0.537, lr=0.0316] 51%|█████▏    | 55/107 [25:58<24:22, 28.12s/epoch, loss=1.12, accuracy=0.755, val_loss=1.72, val_accuracy=0.562, lr=0.1]    52%|█████▏    | 56/107 [26:26<23:49, 28.02s/epoch, loss=1.12, accuracy=0.758, val_loss=3.54, val_accuracy=0.393, lr=0.1] 53%|█████▎    | 57/107 [26:54<23:18, 27.96s/epoch, loss=1.11, accuracy=0.759, val_loss=3.77, val_accuracy=0.31, lr=0.1]  54%|█████▍    | 58/107 [27:22<22:53, 28.03s/epoch, loss=1.11, accuracy=0.76, val_loss=1.87, val_accuracy=0.505, lr=0.1] 55%|█████▌    | 59/107 [27:51<22:31, 28.16s/epoch, loss=1.11, accuracy=0.76, val_loss=1.97, val_accuracy=0.565, lr=0.0316] 56%|█████▌    | 60/107 [28:19<22:03, 28.16s/epoch, loss=1.11, accuracy=0.759, val_loss=2.02, val_accuracy=0.412, lr=0.1]   57%|█████▋    | 61/107 [28:47<21:35, 28.16s/epoch, loss=1.11, accuracy=0.758, val_loss=1.83, val_accuracy=0.496, lr=0.1] 58%|█████▊    | 62/107 [29:15<21:01, 28.03s/epoch, loss=1.11, accuracy=0.761, val_loss=2.53, val_accuracy=0.379, lr=0.1] 59%|█████▉    | 63/107 [29:41<20:16, 27.66s/epoch, loss=1.11, accuracy=0.76, val_loss=2.13, val_accuracy=0.452, lr=0.1]  60%|█████▉    | 64/107 [30:09<19:50, 27.68s/epoch, loss=1.12, accuracy=0.759, val_loss=1.84, val_accuracy=0.554, lr=0.0316] 61%|██████    | 65/107 [30:37<19:29, 27.85s/epoch, loss=1.11, accuracy=0.758, val_loss=2.46, val_accuracy=0.465, lr=0.1]    62%|██████▏   | 66/107 [31:05<19:02, 27.87s/epoch, loss=1.11, accuracy=0.758, val_loss=6.31, val_accuracy=0.201, lr=0.1] 63%|██████▎   | 67/107 [31:33<18:34, 27.86s/epoch, loss=1.11, accuracy=0.758, val_loss=1.74, val_accuracy=0.567, lr=0.1] 64%|██████▎   | 68/107 [32:01<18:11, 27.98s/epoch, loss=1.11, accuracy=0.761, val_loss=2.31, val_accuracy=0.466, lr=0.1] 64%|██████▍   | 69/107 [32:29<17:42, 27.97s/epoch, loss=1.11, accuracy=0.758, val_loss=1.69, val_accuracy=0.564, lr=0.0316] 65%|██████▌   | 70/107 [32:57<17:08, 27.81s/epoch, loss=1.11, accuracy=0.76, val_loss=1.86, val_accuracy=0.501, lr=0.1]     66%|██████▋   | 71/107 [33:25<16:41, 27.82s/epoch, loss=1.11, accuracy=0.762, val_loss=2.02, val_accuracy=0.46, lr=0.1] 67%|██████▋   | 72/107 [33:52<16:06, 27.63s/epoch, loss=1.11, accuracy=0.761, val_loss=1.7, val_accuracy=0.588, lr=0.1] 68%|██████▊   | 73/107 [34:19<15:39, 27.63s/epoch, loss=1.11, accuracy=0.76, val_loss=1.49, val_accuracy=0.636, lr=0.1] 69%|██████▉   | 74/107 [34:48<15:16, 27.77s/epoch, loss=1.11, accuracy=0.761, val_loss=1.91, val_accuracy=0.542, lr=0.0316] 70%|███████   | 75/107 [35:16<14:52, 27.90s/epoch, loss=1.1, accuracy=0.76, val_loss=2.11, val_accuracy=0.475, lr=0.1]      71%|███████   | 76/107 [35:44<14:24, 27.90s/epoch, loss=1.1, accuracy=0.761, val_loss=1.59, val_accuracy=0.617, lr=0.1] 72%|███████▏  | 77/107 [36:11<13:56, 27.87s/epoch, loss=1.1, accuracy=0.762, val_loss=2.21, val_accuracy=0.491, lr=0.1] 73%|███████▎  | 78/107 [36:39<13:23, 27.70s/epoch, loss=1.11, accuracy=0.76, val_loss=2.11, val_accuracy=0.457, lr=0.1] 74%|███████▍  | 79/107 [37:05<12:43, 27.28s/epoch, loss=1.11, accuracy=0.761, val_loss=1.98, val_accuracy=0.488, lr=0.0316] 75%|███████▍  | 80/107 [37:33<12:18, 27.34s/epoch, loss=1.1, accuracy=0.761, val_loss=4.96, val_accuracy=0.234, lr=0.1]     76%|███████▌  | 81/107 [38:00<11:51, 27.35s/epoch, loss=1.1, accuracy=0.76, val_loss=1.77, val_accuracy=0.519, lr=0.1]  77%|███████▋  | 82/107 [38:27<11:23, 27.35s/epoch, loss=0.888, accuracy=0.82, val_loss=0.847, val_accuracy=0.819, lr=0.01] 78%|███████▊  | 83/107 [38:55<10:59, 27.49s/epoch, loss=0.715, accuracy=0.852, val_loss=0.855, val_accuracy=0.79, lr=0.01] 79%|███████▊  | 84/107 [39:22<10:31, 27.47s/epoch, loss=0.635, accuracy=0.859, val_loss=0.695, val_accuracy=0.836, lr=0.01] 79%|███████▉  | 85/107 [39:50<10:04, 27.48s/epoch, loss=0.596, accuracy=0.863, val_loss=0.739, val_accuracy=0.812, lr=0.01] 80%|████████  | 86/107 [40:18<09:38, 27.56s/epoch, loss=0.578, accuracy=0.864, val_loss=0.749, val_accuracy=0.807, lr=0.01] 81%|████████▏ | 87/107 [40:46<09:13, 27.67s/epoch, loss=0.564, accuracy=0.866, val_loss=0.747, val_accuracy=0.809, lr=0.01] 82%|████████▏ | 88/107 [41:13<08:41, 27.44s/epoch, loss=0.56, accuracy=0.867, val_loss=0.79, val_accuracy=0.789, lr=0.01]   83%|████████▎ | 89/107 [41:40<08:15, 27.52s/epoch, loss=0.554, accuracy=0.868, val_loss=0.804, val_accuracy=0.797, lr=0.00316] 84%|████████▍ | 90/107 [42:08<07:49, 27.59s/epoch, loss=0.552, accuracy=0.87, val_loss=0.793, val_accuracy=0.787, lr=0.01]     85%|████████▌ | 91/107 [42:36<07:23, 27.71s/epoch, loss=0.554, accuracy=0.869, val_loss=0.756, val_accuracy=0.806, lr=0.01] 86%|████████▌ | 92/107 [43:03<06:54, 27.64s/epoch, loss=0.551, accuracy=0.872, val_loss=0.788, val_accuracy=0.8, lr=0.01]   87%|████████▋ | 93/107 [43:31<06:27, 27.67s/epoch, loss=0.55, accuracy=0.874, val_loss=0.786, val_accuracy=0.805, lr=0.01] 88%|████████▊ | 94/107 [43:58<05:56, 27.46s/epoch, loss=0.547, accuracy=0.875, val_loss=0.7, val_accuracy=0.825, lr=0.00316] 89%|████████▉ | 95/107 [44:26<05:29, 27.45s/epoch, loss=0.549, accuracy=0.876, val_loss=0.792, val_accuracy=0.805, lr=0.01]  90%|████████▉ | 96/107 [44:53<05:00, 27.29s/epoch, loss=0.546, accuracy=0.878, val_loss=0.784, val_accuracy=0.801, lr=0.01] 91%|█████████ | 97/107 [45:20<04:34, 27.47s/epoch, loss=0.549, accuracy=0.877, val_loss=0.702, val_accuracy=0.825, lr=0.01] 92%|█████████▏| 98/107 [45:47<04:04, 27.22s/epoch, loss=0.543, accuracy=0.879, val_loss=0.923, val_accuracy=0.763, lr=0.01] 93%|█████████▎| 99/107 [46:15<03:38, 27.29s/epoch, loss=0.545, accuracy=0.879, val_loss=0.984, val_accuracy=0.737, lr=0.00316] 93%|█████████▎| 100/107 [46:41<03:09, 27.09s/epoch, loss=0.545, accuracy=0.88, val_loss=1.53, val_accuracy=0.621, lr=0.01]     94%|█████████▍| 101/107 [47:09<02:43, 27.31s/epoch, loss=0.542, accuracy=0.881, val_loss=0.904, val_accuracy=0.771, lr=0.01] 95%|█████████▌| 102/107 [47:36<02:15, 27.14s/epoch, loss=0.548, accuracy=0.879, val_loss=0.789, val_accuracy=0.803, lr=0.01] 96%|█████████▋| 103/107 [48:04<01:49, 27.43s/epoch, loss=0.546, accuracy=0.881, val_loss=0.775, val_accuracy=0.809, lr=0.01] 97%|█████████▋| 104/107 [48:32<01:22, 27.54s/epoch, loss=0.541, accuracy=0.882, val_loss=0.729, val_accuracy=0.826, lr=0.00316] 98%|█████████▊| 105/107 [49:00<00:55, 27.65s/epoch, loss=0.544, accuracy=0.882, val_loss=1.97, val_accuracy=0.498, lr=0.01]     99%|█████████▉| 106/107 [49:27<00:27, 27.65s/epoch, loss=0.546, accuracy=0.883, val_loss=0.782, val_accuracy=0.817, lr=0.01]100%|██████████| 107/107 [49:55<00:00, 27.61s/epoch, loss=0.544, accuracy=0.883, val_loss=0.828, val_accuracy=0.786, lr=0.01]100%|██████████| 107/107 [49:55<00:00, 27.99s/epoch, loss=0.544, accuracy=0.883, val_loss=0.828, val_accuracy=0.786, lr=0.01]
Using real-time data augmentation.
Test score: 0.8283733129501343
Test accuracy: 0.7857999801635742


* * * Run SGD for ID = 14_4. * * *


2024-03-05 06:38:15.330732: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 06:38:19.391013: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 06:38:19.392198: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-05 06:38:19.432110: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-05 06:38:19.432153: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 06:38:19.437259: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 06:38:19.437324: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-05 06:38:19.440810: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-05 06:38:19.442725: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-05 06:38:19.446044: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-05 06:38:19.448794: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-05 06:38:19.454573: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 06:38:19.455232: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-05 06:38:19.455331: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 06:38:20.627584: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-05 06:38:20.628774: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 06:38:20.629881: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-05 06:38:20.629918: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 06:38:20.629955: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 06:38:20.629970: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-05 06:38:20.629982: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-05 06:38:20.629994: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-05 06:38:20.630008: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-05 06:38:20.630022: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-05 06:38:20.630036: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 06:38:20.630561: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-05 06:38:20.630603: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 06:38:21.229197: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-05 06:38:21.229265: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-05 06:38:21.229276: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-05 06:38:21.230342: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:3b:00.0, compute capability: 6.1)
{'id': '14_04', 'seed': 4, 'out_folder': 'results/epoch_budget', 'batch_size': 128, 'epochs': 107, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/107 [00:00<?, ?epoch/s]2024-03-05 06:38:22.051699: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-05 06:38:22.063987: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-03-05 06:38:23.988819: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 06:38:24.258213: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 06:38:25.211121: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-05 06:38:25.274149: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/107 [01:07<1:59:41, 67.75s/epoch, loss=2.87, accuracy=0.386, val_loss=2.34, val_accuracy=0.327, lr=0.1]  2%|▏         | 2/107 [01:35<1:17:47, 44.46s/epoch, loss=1.44, accuracy=0.603, val_loss=1.89, val_accuracy=0.486, lr=0.1]  3%|▎         | 3/107 [02:04<1:04:14, 37.06s/epoch, loss=1.29, accuracy=0.67, val_loss=2.36, val_accuracy=0.386, lr=0.1]   4%|▎         | 4/107 [02:32<57:51, 33.71s/epoch, loss=1.24, accuracy=0.7, val_loss=1.98, val_accuracy=0.485, lr=0.1]     5%|▍         | 5/107 [03:01<54:01, 31.78s/epoch, loss=1.22, accuracy=0.713, val_loss=2.13, val_accuracy=0.487, lr=0.1]  6%|▌         | 6/107 [03:29<51:33, 30.63s/epoch, loss=1.21, accuracy=0.719, val_loss=1.5, val_accuracy=0.621, lr=0.1]   7%|▋         | 7/107 [03:57<49:43, 29.83s/epoch, loss=1.2, accuracy=0.726, val_loss=1.95, val_accuracy=0.48, lr=0.1]   7%|▋         | 8/107 [04:25<48:20, 29.30s/epoch, loss=1.2, accuracy=0.728, val_loss=1.67, val_accuracy=0.568, lr=0.1]  8%|▊         | 9/107 [04:54<47:28, 29.06s/epoch, loss=1.19, accuracy=0.733, val_loss=1.79, val_accuracy=0.534, lr=0.1]  9%|▉         | 10/107 [05:22<46:43, 28.90s/epoch, loss=1.19, accuracy=0.735, val_loss=3.72, val_accuracy=0.347, lr=0.1] 10%|█         | 11/107 [05:50<45:22, 28.35s/epoch, loss=1.18, accuracy=0.737, val_loss=1.61, val_accuracy=0.587, lr=0.0316] 11%|█         | 12/107 [06:17<44:36, 28.17s/epoch, loss=1.18, accuracy=0.739, val_loss=1.47, val_accuracy=0.638, lr=0.1]    12%|█▏        | 13/107 [06:45<43:55, 28.04s/epoch, loss=1.17, accuracy=0.745, val_loss=1.65, val_accuracy=0.583, lr=0.1] 13%|█▎        | 14/107 [07:13<43:34, 28.11s/epoch, loss=1.18, accuracy=0.74, val_loss=3.21, val_accuracy=0.315, lr=0.1]  14%|█▍        | 15/107 [07:41<43:00, 28.05s/epoch, loss=1.16, accuracy=0.744, val_loss=3.44, val_accuracy=0.315, lr=0.1] 15%|█▍        | 16/107 [08:10<42:39, 28.13s/epoch, loss=1.16, accuracy=0.744, val_loss=1.68, val_accuracy=0.617, lr=0.1] 16%|█▌        | 17/107 [08:37<42:06, 28.08s/epoch, loss=1.16, accuracy=0.745, val_loss=2.31, val_accuracy=0.494, lr=0.0316] 17%|█▋        | 18/107 [09:06<41:44, 28.14s/epoch, loss=1.16, accuracy=0.747, val_loss=2.05, val_accuracy=0.483, lr=0.1]    18%|█▊        | 19/107 [09:34<41:21, 28.20s/epoch, loss=1.15, accuracy=0.749, val_loss=1.8, val_accuracy=0.584, lr=0.1]  19%|█▊        | 20/107 [10:02<40:58, 28.26s/epoch, loss=1.16, accuracy=0.747, val_loss=2.06, val_accuracy=0.44, lr=0.1] 20%|█▉        | 21/107 [10:31<40:36, 28.33s/epoch, loss=1.16, accuracy=0.75, val_loss=1.6, val_accuracy=0.596, lr=0.1]  21%|██        | 22/107 [10:59<39:58, 28.21s/epoch, loss=1.15, accuracy=0.749, val_loss=2.02, val_accuracy=0.447, lr=0.0316] 21%|██▏       | 23/107 [11:27<39:25, 28.16s/epoch, loss=1.15, accuracy=0.749, val_loss=1.89, val_accuracy=0.518, lr=0.1]    22%|██▏       | 24/107 [11:54<38:30, 27.83s/epoch, loss=1.15, accuracy=0.751, val_loss=1.69, val_accuracy=0.6, lr=0.1]   23%|██▎       | 25/107 [12:21<37:42, 27.59s/epoch, loss=1.14, accuracy=0.749, val_loss=1.71, val_accuracy=0.56, lr=0.1] 24%|██▍       | 26/107 [12:49<37:21, 27.67s/epoch, loss=1.15, accuracy=0.753, val_loss=1.62, val_accuracy=0.592, lr=0.1] 25%|██▌       | 27/107 [13:17<37:04, 27.80s/epoch, loss=1.14, accuracy=0.75, val_loss=2.02, val_accuracy=0.483, lr=0.0316] 26%|██▌       | 28/107 [13:45<36:41, 27.87s/epoch, loss=1.14, accuracy=0.753, val_loss=1.76, val_accuracy=0.581, lr=0.1]   27%|██▋       | 29/107 [14:13<36:17, 27.92s/epoch, loss=1.14, accuracy=0.754, val_loss=1.48, val_accuracy=0.638, lr=0.1] 28%|██▊       | 30/107 [14:40<35:26, 27.61s/epoch, loss=1.14, accuracy=0.755, val_loss=2.54, val_accuracy=0.473, lr=0.1] 29%|██▉       | 31/107 [15:08<35:10, 27.77s/epoch, loss=1.13, accuracy=0.752, val_loss=2.11, val_accuracy=0.488, lr=0.1] 30%|██▉       | 32/107 [15:36<34:48, 27.84s/epoch, loss=1.14, accuracy=0.753, val_loss=2.34, val_accuracy=0.47, lr=0.0316] 31%|███       | 33/107 [16:04<34:22, 27.87s/epoch, loss=1.14, accuracy=0.755, val_loss=1.65, val_accuracy=0.584, lr=0.1]   32%|███▏      | 34/107 [16:32<34:01, 27.97s/epoch, loss=1.14, accuracy=0.753, val_loss=3.17, val_accuracy=0.333, lr=0.1] 33%|███▎      | 35/107 [17:00<33:38, 28.03s/epoch, loss=1.13, accuracy=0.754, val_loss=2.43, val_accuracy=0.406, lr=0.1] 34%|███▎      | 36/107 [17:28<33:06, 27.98s/epoch, loss=1.13, accuracy=0.755, val_loss=1.96, val_accuracy=0.474, lr=0.1] 35%|███▍      | 37/107 [17:56<32:40, 28.00s/epoch, loss=1.12, accuracy=0.756, val_loss=1.52, val_accuracy=0.626, lr=0.0316] 36%|███▌      | 38/107 [18:24<32:03, 27.88s/epoch, loss=1.13, accuracy=0.755, val_loss=2.53, val_accuracy=0.443, lr=0.1]    36%|███▋      | 39/107 [18:52<31:42, 27.97s/epoch, loss=1.13, accuracy=0.757, val_loss=1.89, val_accuracy=0.486, lr=0.1] 37%|███▋      | 40/107 [19:20<31:15, 27.99s/epoch, loss=1.14, accuracy=0.755, val_loss=1.64, val_accuracy=0.588, lr=0.1] 38%|███▊      | 41/107 [19:48<30:43, 27.93s/epoch, loss=1.13, accuracy=0.758, val_loss=1.65, val_accuracy=0.598, lr=0.1] 39%|███▉      | 42/107 [20:16<30:10, 27.86s/epoch, loss=1.13, accuracy=0.757, val_loss=2.17, val_accuracy=0.501, lr=0.0316] 40%|████      | 43/107 [20:44<29:47, 27.93s/epoch, loss=1.12, accuracy=0.757, val_loss=2.4, val_accuracy=0.402, lr=0.1]     41%|████      | 44/107 [21:12<29:21, 27.97s/epoch, loss=1.12, accuracy=0.757, val_loss=1.82, val_accuracy=0.504, lr=0.1] 42%|████▏     | 45/107 [21:40<28:54, 27.98s/epoch, loss=1.13, accuracy=0.756, val_loss=2.13, val_accuracy=0.515, lr=0.1] 43%|████▎     | 46/107 [22:08<28:28, 28.02s/epoch, loss=1.13, accuracy=0.754, val_loss=2.22, val_accuracy=0.428, lr=0.1] 44%|████▍     | 47/107 [22:33<27:15, 27.27s/epoch, loss=1.12, accuracy=0.76, val_loss=2.33, val_accuracy=0.436, lr=0.0316] 45%|████▍     | 48/107 [23:02<27:06, 27.57s/epoch, loss=1.13, accuracy=0.758, val_loss=3.39, val_accuracy=0.259, lr=0.1]   46%|████▌     | 49/107 [23:30<26:49, 27.76s/epoch, loss=1.12, accuracy=0.759, val_loss=1.8, val_accuracy=0.581, lr=0.1]  47%|████▋     | 50/107 [23:57<26:18, 27.69s/epoch, loss=1.12, accuracy=0.756, val_loss=2.06, val_accuracy=0.538, lr=0.1] 48%|████▊     | 51/107 [24:25<25:42, 27.55s/epoch, loss=1.12, accuracy=0.757, val_loss=1.95, val_accuracy=0.451, lr=0.1] 49%|████▊     | 52/107 [24:52<25:09, 27.45s/epoch, loss=1.12, accuracy=0.756, val_loss=1.67, val_accuracy=0.556, lr=0.0316] 50%|████▉     | 53/107 [25:20<24:46, 27.54s/epoch, loss=1.12, accuracy=0.762, val_loss=2.67, val_accuracy=0.445, lr=0.1]    50%|█████     | 54/107 [25:47<24:21, 27.58s/epoch, loss=1.12, accuracy=0.758, val_loss=2.53, val_accuracy=0.452, lr=0.1] 51%|█████▏    | 55/107 [26:16<24:04, 27.78s/epoch, loss=1.11, accuracy=0.757, val_loss=1.56, val_accuracy=0.603, lr=0.1] 52%|█████▏    | 56/107 [26:44<23:41, 27.87s/epoch, loss=1.12, accuracy=0.757, val_loss=1.55, val_accuracy=0.624, lr=0.1] 53%|█████▎    | 57/107 [27:12<23:16, 27.92s/epoch, loss=1.12, accuracy=0.76, val_loss=3, val_accuracy=0.405, lr=0.0316]  54%|█████▍    | 58/107 [27:40<22:47, 27.90s/epoch, loss=1.12, accuracy=0.759, val_loss=1.26, val_accuracy=0.705, lr=0.1] 55%|█████▌    | 59/107 [28:08<22:23, 28.00s/epoch, loss=1.12, accuracy=0.761, val_loss=1.4, val_accuracy=0.669, lr=0.1]  56%|█████▌    | 60/107 [28:35<21:48, 27.83s/epoch, loss=1.12, accuracy=0.759, val_loss=1.68, val_accuracy=0.607, lr=0.1] 57%|█████▋    | 61/107 [29:04<21:35, 28.17s/epoch, loss=1.11, accuracy=0.757, val_loss=2.12, val_accuracy=0.451, lr=0.1] 58%|█████▊    | 62/107 [29:32<20:56, 27.92s/epoch, loss=1.11, accuracy=0.76, val_loss=1.4, val_accuracy=0.653, lr=0.1]   59%|█████▉    | 63/107 [29:59<20:20, 27.75s/epoch, loss=1.12, accuracy=0.759, val_loss=1.67, val_accuracy=0.567, lr=0.0316] 60%|█████▉    | 64/107 [30:27<19:55, 27.81s/epoch, loss=1.12, accuracy=0.761, val_loss=3.31, val_accuracy=0.34, lr=0.1]     61%|██████    | 65/107 [30:54<19:22, 27.68s/epoch, loss=1.12, accuracy=0.763, val_loss=2.29, val_accuracy=0.433, lr=0.1] 62%|██████▏   | 66/107 [31:22<18:52, 27.62s/epoch, loss=1.12, accuracy=0.758, val_loss=2.13, val_accuracy=0.481, lr=0.1] 63%|██████▎   | 67/107 [31:50<18:32, 27.82s/epoch, loss=1.12, accuracy=0.76, val_loss=1.91, val_accuracy=0.475, lr=0.1]  64%|██████▎   | 68/107 [32:18<18:04, 27.80s/epoch, loss=1.12, accuracy=0.759, val_loss=2.14, val_accuracy=0.474, lr=0.0316] 64%|██████▍   | 69/107 [32:45<17:31, 27.66s/epoch, loss=1.12, accuracy=0.762, val_loss=2.05, val_accuracy=0.485, lr=0.1]    65%|██████▌   | 70/107 [33:12<16:59, 27.54s/epoch, loss=1.11, accuracy=0.762, val_loss=4.44, val_accuracy=0.179, lr=0.1] 66%|██████▋   | 71/107 [33:40<16:34, 27.64s/epoch, loss=1.12, accuracy=0.758, val_loss=2.92, val_accuracy=0.403, lr=0.1] 67%|██████▋   | 72/107 [34:07<16:03, 27.54s/epoch, loss=1.12, accuracy=0.761, val_loss=2.39, val_accuracy=0.379, lr=0.1] 68%|██████▊   | 73/107 [34:36<15:42, 27.71s/epoch, loss=1.11, accuracy=0.761, val_loss=3.58, val_accuracy=0.261, lr=0.0316] 69%|██████▉   | 74/107 [35:04<15:16, 27.77s/epoch, loss=1.11, accuracy=0.759, val_loss=1.63, val_accuracy=0.616, lr=0.1]    70%|███████   | 75/107 [35:31<14:48, 27.77s/epoch, loss=1.12, accuracy=0.756, val_loss=2.14, val_accuracy=0.425, lr=0.1] 71%|███████   | 76/107 [35:59<14:20, 27.77s/epoch, loss=1.11, accuracy=0.76, val_loss=2.05, val_accuracy=0.491, lr=0.1]  72%|███████▏  | 77/107 [36:27<13:52, 27.75s/epoch, loss=1.12, accuracy=0.76, val_loss=3.16, val_accuracy=0.316, lr=0.1] 73%|███████▎  | 78/107 [36:54<13:22, 27.69s/epoch, loss=1.11, accuracy=0.761, val_loss=3.82, val_accuracy=0.156, lr=0.0316] 74%|███████▍  | 79/107 [37:22<12:57, 27.76s/epoch, loss=1.12, accuracy=0.757, val_loss=1.87, val_accuracy=0.51, lr=0.1]     75%|███████▍  | 80/107 [37:51<12:36, 28.02s/epoch, loss=1.12, accuracy=0.759, val_loss=1.47, val_accuracy=0.652, lr=0.1] 76%|███████▌  | 81/107 [38:19<12:07, 27.97s/epoch, loss=1.11, accuracy=0.76, val_loss=3.62, val_accuracy=0.316, lr=0.1]  77%|███████▋  | 82/107 [38:46<11:36, 27.88s/epoch, loss=0.904, accuracy=0.819, val_loss=0.875, val_accuracy=0.814, lr=0.01] 78%|███████▊  | 83/107 [39:13<11:03, 27.63s/epoch, loss=0.723, accuracy=0.852, val_loss=0.777, val_accuracy=0.822, lr=0.01] 79%|███████▊  | 84/107 [39:42<10:41, 27.90s/epoch, loss=0.644, accuracy=0.86, val_loss=0.764, val_accuracy=0.811, lr=0.01]  79%|███████▉  | 85/107 [40:10<10:16, 28.04s/epoch, loss=0.603, accuracy=0.86, val_loss=0.787, val_accuracy=0.8, lr=0.01]   80%|████████  | 86/107 [40:38<09:49, 28.07s/epoch, loss=0.577, accuracy=0.864, val_loss=0.832, val_accuracy=0.78, lr=0.01] 81%|████████▏ | 87/107 [41:05<09:15, 27.76s/epoch, loss=0.561, accuracy=0.865, val_loss=0.96, val_accuracy=0.744, lr=0.01] 82%|████████▏ | 88/107 [41:33<08:47, 27.77s/epoch, loss=0.56, accuracy=0.864, val_loss=0.703, val_accuracy=0.814, lr=0.01] 83%|████████▎ | 89/107 [42:01<08:21, 27.86s/epoch, loss=0.552, accuracy=0.869, val_loss=0.703, val_accuracy=0.82, lr=0.01] 84%|████████▍ | 90/107 [42:29<07:54, 27.89s/epoch, loss=0.555, accuracy=0.871, val_loss=0.769, val_accuracy=0.806, lr=0.01] 85%|████████▌ | 91/107 [42:57<07:25, 27.87s/epoch, loss=0.55, accuracy=0.871, val_loss=0.881, val_accuracy=0.764, lr=0.01]  86%|████████▌ | 92/107 [43:25<06:59, 27.97s/epoch, loss=0.554, accuracy=0.869, val_loss=0.713, val_accuracy=0.817, lr=0.01] 87%|████████▋ | 93/107 [43:53<06:30, 27.86s/epoch, loss=0.547, accuracy=0.874, val_loss=0.974, val_accuracy=0.747, lr=0.01] 88%|████████▊ | 94/107 [44:21<06:02, 27.91s/epoch, loss=0.545, accuracy=0.875, val_loss=0.666, val_accuracy=0.83, lr=0.01]  89%|████████▉ | 95/107 [44:49<05:35, 27.92s/epoch, loss=0.547, accuracy=0.876, val_loss=0.91, val_accuracy=0.76, lr=0.01]  90%|████████▉ | 96/107 [45:17<05:06, 27.86s/epoch, loss=0.548, accuracy=0.875, val_loss=0.756, val_accuracy=0.807, lr=0.01] 91%|█████████ | 97/107 [45:44<04:37, 27.76s/epoch, loss=0.544, accuracy=0.877, val_loss=0.748, val_accuracy=0.815, lr=0.01] 92%|█████████▏| 98/107 [46:12<04:09, 27.74s/epoch, loss=0.543, accuracy=0.878, val_loss=0.974, val_accuracy=0.736, lr=0.01] 93%|█████████▎| 99/107 [46:40<03:42, 27.81s/epoch, loss=0.543, accuracy=0.881, val_loss=0.843, val_accuracy=0.788, lr=0.00316] 93%|█████████▎| 100/107 [47:08<03:15, 27.89s/epoch, loss=0.544, accuracy=0.879, val_loss=1.17, val_accuracy=0.679, lr=0.01]    94%|█████████▍| 101/107 [47:36<02:47, 27.92s/epoch, loss=0.545, accuracy=0.88, val_loss=1.02, val_accuracy=0.723, lr=0.01]  95%|█████████▌| 102/107 [48:03<02:18, 27.79s/epoch, loss=0.543, accuracy=0.882, val_loss=0.914, val_accuracy=0.762, lr=0.01] 96%|█████████▋| 103/107 [48:30<01:50, 27.54s/epoch, loss=0.545, accuracy=0.881, val_loss=2.78, val_accuracy=0.522, lr=0.01]  97%|█████████▋| 104/107 [48:58<01:22, 27.67s/epoch, loss=0.543, accuracy=0.882, val_loss=1.15, val_accuracy=0.732, lr=0.00316] 98%|█████████▊| 105/107 [49:26<00:55, 27.61s/epoch, loss=0.544, accuracy=0.882, val_loss=1.07, val_accuracy=0.741, lr=0.01]    99%|█████████▉| 106/107 [49:54<00:27, 27.71s/epoch, loss=0.547, accuracy=0.88, val_loss=0.71, val_accuracy=0.831, lr=0.01] 100%|██████████| 107/107 [50:22<00:00, 27.82s/epoch, loss=0.548, accuracy=0.882, val_loss=0.746, val_accuracy=0.827, lr=0.01]100%|██████████| 107/107 [50:22<00:00, 28.25s/epoch, loss=0.548, accuracy=0.882, val_loss=0.746, val_accuracy=0.827, lr=0.01]
Using real-time data augmentation.
Test score: 0.7463937997817993
Test accuracy: 0.8274999856948853


* * * Run SGD for ID = 14_5. * * *


2024-03-05 07:28:48.405685: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 07:28:51.133185: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 07:28:51.134368: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-05 07:28:51.174682: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-05 07:28:51.174725: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 07:28:51.178445: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 07:28:51.178515: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-05 07:28:51.181022: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-05 07:28:51.181818: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-05 07:28:51.184579: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-05 07:28:51.186287: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-05 07:28:51.191541: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 07:28:51.192224: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-05 07:28:51.192322: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 07:28:52.331348: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-05 07:28:52.332130: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 07:28:52.333195: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-05 07:28:52.333233: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 07:28:52.333271: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 07:28:52.333286: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-05 07:28:52.333298: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-05 07:28:52.333311: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-05 07:28:52.333333: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-05 07:28:52.333348: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-05 07:28:52.333363: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 07:28:52.333902: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-05 07:28:52.333950: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 07:28:52.941043: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-05 07:28:52.941106: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-05 07:28:52.941117: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-05 07:28:52.942147: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:3b:00.0, compute capability: 6.1)
{'id': '14_05', 'seed': 5, 'out_folder': 'results/epoch_budget', 'batch_size': 128, 'epochs': 107, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/107 [00:00<?, ?epoch/s]2024-03-05 07:28:53.770288: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-05 07:28:53.781992: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-03-05 07:28:55.653494: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 07:28:55.943745: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 07:28:56.847583: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-05 07:28:56.903511: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/107 [01:05<1:55:59, 65.65s/epoch, loss=3.13, accuracy=0.329, val_loss=3.2, val_accuracy=0.134, lr=0.1]  2%|▏         | 2/107 [01:32<1:14:36, 42.64s/epoch, loss=1.51, accuracy=0.565, val_loss=2.98, val_accuracy=0.354, lr=0.1]  3%|▎         | 3/107 [01:58<1:01:07, 35.27s/epoch, loss=1.33, accuracy=0.649, val_loss=2.66, val_accuracy=0.323, lr=0.1]  4%|▎         | 4/107 [02:26<55:18, 32.22s/epoch, loss=1.28, accuracy=0.681, val_loss=2.06, val_accuracy=0.47, lr=0.1]     5%|▍         | 5/107 [02:53<51:58, 30.57s/epoch, loss=1.26, accuracy=0.7, val_loss=1.89, val_accuracy=0.505, lr=0.1]   6%|▌         | 6/107 [03:22<50:08, 29.78s/epoch, loss=1.25, accuracy=0.709, val_loss=2.14, val_accuracy=0.463, lr=0.1]  7%|▋         | 7/107 [03:49<48:34, 29.15s/epoch, loss=1.23, accuracy=0.717, val_loss=1.72, val_accuracy=0.545, lr=0.1]  7%|▋         | 8/107 [04:17<47:26, 28.75s/epoch, loss=1.22, accuracy=0.723, val_loss=1.43, val_accuracy=0.649, lr=0.1]  8%|▊         | 9/107 [04:45<46:30, 28.48s/epoch, loss=1.2, accuracy=0.725, val_loss=1.97, val_accuracy=0.507, lr=0.1]   9%|▉         | 10/107 [05:13<45:49, 28.34s/epoch, loss=1.2, accuracy=0.73, val_loss=1.95, val_accuracy=0.458, lr=0.1] 10%|█         | 11/107 [05:41<44:53, 28.06s/epoch, loss=1.2, accuracy=0.735, val_loss=2.18, val_accuracy=0.439, lr=0.1] 11%|█         | 12/107 [06:08<44:16, 27.96s/epoch, loss=1.19, accuracy=0.736, val_loss=4.7, val_accuracy=0.292, lr=0.1] 12%|█▏        | 13/107 [06:35<43:07, 27.53s/epoch, loss=1.19, accuracy=0.738, val_loss=1.85, val_accuracy=0.513, lr=0.0316] 13%|█▎        | 14/107 [07:01<42:04, 27.15s/epoch, loss=1.18, accuracy=0.741, val_loss=1.93, val_accuracy=0.472, lr=0.1]    14%|█▍        | 15/107 [07:29<42:03, 27.43s/epoch, loss=1.18, accuracy=0.74, val_loss=2.51, val_accuracy=0.432, lr=0.1]  15%|█▍        | 16/107 [07:57<41:50, 27.59s/epoch, loss=1.18, accuracy=0.74, val_loss=2.01, val_accuracy=0.521, lr=0.1] 16%|█▌        | 17/107 [08:25<41:37, 27.75s/epoch, loss=1.17, accuracy=0.741, val_loss=1.41, val_accuracy=0.651, lr=0.1] 17%|█▋        | 18/107 [08:53<41:15, 27.81s/epoch, loss=1.17, accuracy=0.742, val_loss=3.05, val_accuracy=0.339, lr=0.1] 18%|█▊        | 19/107 [09:21<40:35, 27.68s/epoch, loss=1.17, accuracy=0.744, val_loss=1.59, val_accuracy=0.617, lr=0.1] 19%|█▊        | 20/107 [09:47<39:34, 27.30s/epoch, loss=1.17, accuracy=0.746, val_loss=3.4, val_accuracy=0.384, lr=0.1]  20%|█▉        | 21/107 [10:14<38:49, 27.08s/epoch, loss=1.17, accuracy=0.745, val_loss=1.79, val_accuracy=0.519, lr=0.1] 21%|██        | 22/107 [10:41<38:22, 27.08s/epoch, loss=1.16, accuracy=0.748, val_loss=1.62, val_accuracy=0.592, lr=0.0316] 21%|██▏       | 23/107 [11:08<37:52, 27.05s/epoch, loss=1.16, accuracy=0.747, val_loss=3.6, val_accuracy=0.328, lr=0.1]     22%|██▏       | 24/107 [11:34<37:06, 26.82s/epoch, loss=1.16, accuracy=0.744, val_loss=3.07, val_accuracy=0.398, lr=0.1] 23%|██▎       | 25/107 [12:01<36:41, 26.85s/epoch, loss=1.15, accuracy=0.748, val_loss=1.9, val_accuracy=0.534, lr=0.1]  24%|██▍       | 26/107 [12:27<36:05, 26.73s/epoch, loss=1.16, accuracy=0.748, val_loss=2.17, val_accuracy=0.439, lr=0.1] 25%|██▌       | 27/107 [12:54<35:28, 26.61s/epoch, loss=1.16, accuracy=0.75, val_loss=1.94, val_accuracy=0.522, lr=0.0316] 26%|██▌       | 28/107 [13:20<34:54, 26.51s/epoch, loss=1.15, accuracy=0.748, val_loss=1.87, val_accuracy=0.534, lr=0.1]   27%|██▋       | 29/107 [13:48<34:54, 26.85s/epoch, loss=1.15, accuracy=0.749, val_loss=2.31, val_accuracy=0.471, lr=0.1] 28%|██▊       | 30/107 [14:15<34:36, 26.97s/epoch, loss=1.15, accuracy=0.75, val_loss=1.84, val_accuracy=0.553, lr=0.1]  29%|██▉       | 31/107 [14:42<34:15, 27.04s/epoch, loss=1.14, accuracy=0.751, val_loss=2.05, val_accuracy=0.552, lr=0.1] 30%|██▉       | 32/107 [15:06<32:43, 26.18s/epoch, loss=1.15, accuracy=0.75, val_loss=4.9, val_accuracy=0.281, lr=0.0316] 31%|███       | 33/107 [15:33<32:17, 26.18s/epoch, loss=1.15, accuracy=0.749, val_loss=1.31, val_accuracy=0.694, lr=0.1]  32%|███▏      | 34/107 [15:59<32:04, 26.36s/epoch, loss=1.14, accuracy=0.752, val_loss=2.18, val_accuracy=0.372, lr=0.1] 33%|███▎      | 35/107 [16:26<31:41, 26.41s/epoch, loss=1.14, accuracy=0.753, val_loss=1.44, val_accuracy=0.645, lr=0.1] 34%|███▎      | 36/107 [16:53<31:34, 26.69s/epoch, loss=1.14, accuracy=0.751, val_loss=3.01, val_accuracy=0.428, lr=0.1] 35%|███▍      | 37/107 [17:21<31:29, 27.00s/epoch, loss=1.14, accuracy=0.754, val_loss=1.68, val_accuracy=0.542, lr=0.1] 36%|███▌      | 38/107 [17:49<31:21, 27.27s/epoch, loss=1.15, accuracy=0.751, val_loss=1.52, val_accuracy=0.626, lr=0.0316] 36%|███▋      | 39/107 [18:17<31:11, 27.52s/epoch, loss=1.15, accuracy=0.754, val_loss=1.79, val_accuracy=0.512, lr=0.1]    37%|███▋      | 40/107 [18:45<30:48, 27.59s/epoch, loss=1.14, accuracy=0.754, val_loss=2.28, val_accuracy=0.49, lr=0.1]  38%|███▊      | 41/107 [19:13<30:27, 27.69s/epoch, loss=1.14, accuracy=0.754, val_loss=1.86, val_accuracy=0.498, lr=0.1] 39%|███▉      | 42/107 [19:41<30:09, 27.83s/epoch, loss=1.15, accuracy=0.751, val_loss=1.82, val_accuracy=0.554, lr=0.1] 40%|████      | 43/107 [20:08<29:21, 27.52s/epoch, loss=1.14, accuracy=0.752, val_loss=2.4, val_accuracy=0.475, lr=0.0316] 41%|████      | 44/107 [20:35<28:59, 27.61s/epoch, loss=1.13, accuracy=0.754, val_loss=4.61, val_accuracy=0.318, lr=0.1]   42%|████▏     | 45/107 [21:02<28:21, 27.45s/epoch, loss=1.13, accuracy=0.754, val_loss=2.51, val_accuracy=0.372, lr=0.1] 43%|████▎     | 46/107 [21:30<27:57, 27.50s/epoch, loss=1.14, accuracy=0.753, val_loss=1.83, val_accuracy=0.57, lr=0.1]  44%|████▍     | 47/107 [21:58<27:35, 27.59s/epoch, loss=1.14, accuracy=0.753, val_loss=2.54, val_accuracy=0.421, lr=0.1] 45%|████▍     | 48/107 [22:26<27:14, 27.70s/epoch, loss=1.13, accuracy=0.753, val_loss=1.76, val_accuracy=0.535, lr=0.0316] 46%|████▌     | 49/107 [22:54<26:49, 27.76s/epoch, loss=1.14, accuracy=0.755, val_loss=2.6, val_accuracy=0.362, lr=0.1]     47%|████▋     | 50/107 [23:22<26:25, 27.82s/epoch, loss=1.13, accuracy=0.756, val_loss=3.19, val_accuracy=0.358, lr=0.1] 48%|████▊     | 51/107 [23:50<26:02, 27.90s/epoch, loss=1.14, accuracy=0.753, val_loss=1.92, val_accuracy=0.564, lr=0.1] 49%|████▊     | 52/107 [24:18<25:37, 27.96s/epoch, loss=1.13, accuracy=0.755, val_loss=2.96, val_accuracy=0.431, lr=0.1] 50%|████▉     | 53/107 [24:46<25:13, 28.03s/epoch, loss=1.13, accuracy=0.754, val_loss=1.79, val_accuracy=0.539, lr=0.0316] 50%|█████     | 54/107 [25:13<24:36, 27.85s/epoch, loss=1.13, accuracy=0.757, val_loss=2.3, val_accuracy=0.435, lr=0.1]     51%|█████▏    | 55/107 [25:41<24:06, 27.82s/epoch, loss=1.13, accuracy=0.757, val_loss=1.54, val_accuracy=0.638, lr=0.1] 52%|█████▏    | 56/107 [26:09<23:41, 27.88s/epoch, loss=1.13, accuracy=0.754, val_loss=1.46, val_accuracy=0.646, lr=0.1] 53%|█████▎    | 57/107 [26:37<23:13, 27.87s/epoch, loss=1.12, accuracy=0.758, val_loss=1.57, val_accuracy=0.602, lr=0.1] 54%|█████▍    | 58/107 [27:05<22:44, 27.86s/epoch, loss=1.13, accuracy=0.755, val_loss=1.8, val_accuracy=0.515, lr=0.0316] 55%|█████▌    | 59/107 [27:33<22:19, 27.90s/epoch, loss=1.13, accuracy=0.757, val_loss=1.84, val_accuracy=0.548, lr=0.1]   56%|█████▌    | 60/107 [28:01<21:49, 27.86s/epoch, loss=1.13, accuracy=0.757, val_loss=1.52, val_accuracy=0.609, lr=0.1] 57%|█████▋    | 61/107 [28:29<21:22, 27.89s/epoch, loss=1.12, accuracy=0.754, val_loss=2.14, val_accuracy=0.501, lr=0.1] 58%|█████▊    | 62/107 [28:57<20:56, 27.92s/epoch, loss=1.12, accuracy=0.758, val_loss=1.94, val_accuracy=0.568, lr=0.1] 59%|█████▉    | 63/107 [29:24<20:27, 27.90s/epoch, loss=1.11, accuracy=0.756, val_loss=2.2, val_accuracy=0.495, lr=0.0316] 60%|█████▉    | 64/107 [29:52<19:54, 27.77s/epoch, loss=1.12, accuracy=0.756, val_loss=2.03, val_accuracy=0.498, lr=0.1]   61%|██████    | 65/107 [30:20<19:29, 27.84s/epoch, loss=1.11, accuracy=0.758, val_loss=1.88, val_accuracy=0.509, lr=0.1] 62%|██████▏   | 66/107 [30:48<18:58, 27.78s/epoch, loss=1.12, accuracy=0.756, val_loss=1.85, val_accuracy=0.559, lr=0.1] 63%|██████▎   | 67/107 [31:15<18:28, 27.72s/epoch, loss=1.12, accuracy=0.758, val_loss=2.12, val_accuracy=0.436, lr=0.1] 64%|██████▎   | 68/107 [31:43<17:57, 27.62s/epoch, loss=1.12, accuracy=0.757, val_loss=2.01, val_accuracy=0.478, lr=0.0316] 64%|██████▍   | 69/107 [32:10<17:29, 27.63s/epoch, loss=1.12, accuracy=0.757, val_loss=2.31, val_accuracy=0.444, lr=0.1]    65%|██████▌   | 70/107 [32:38<17:02, 27.64s/epoch, loss=1.11, accuracy=0.758, val_loss=2.85, val_accuracy=0.399, lr=0.1] 66%|██████▋   | 71/107 [33:05<16:33, 27.61s/epoch, loss=1.12, accuracy=0.757, val_loss=1.67, val_accuracy=0.558, lr=0.1] 67%|██████▋   | 72/107 [33:33<16:07, 27.65s/epoch, loss=1.11, accuracy=0.76, val_loss=1.83, val_accuracy=0.555, lr=0.1]  68%|██████▊   | 73/107 [34:01<15:40, 27.66s/epoch, loss=1.12, accuracy=0.757, val_loss=1.66, val_accuracy=0.546, lr=0.0316] 69%|██████▉   | 74/107 [34:29<15:15, 27.74s/epoch, loss=1.12, accuracy=0.757, val_loss=2.44, val_accuracy=0.487, lr=0.1]    70%|███████   | 75/107 [34:57<14:47, 27.74s/epoch, loss=1.11, accuracy=0.758, val_loss=1.33, val_accuracy=0.702, lr=0.1] 71%|███████   | 76/107 [35:24<14:20, 27.77s/epoch, loss=1.11, accuracy=0.76, val_loss=2.88, val_accuracy=0.356, lr=0.1]  72%|███████▏  | 77/107 [35:52<13:54, 27.82s/epoch, loss=1.11, accuracy=0.758, val_loss=1.77, val_accuracy=0.525, lr=0.1] 73%|███████▎  | 78/107 [36:20<13:24, 27.73s/epoch, loss=1.11, accuracy=0.761, val_loss=1.79, val_accuracy=0.552, lr=0.0316] 74%|███████▍  | 79/107 [36:48<12:58, 27.81s/epoch, loss=1.11, accuracy=0.758, val_loss=1.47, val_accuracy=0.631, lr=0.1]    75%|███████▍  | 80/107 [37:16<12:30, 27.80s/epoch, loss=1.1, accuracy=0.759, val_loss=1.92, val_accuracy=0.505, lr=0.1]  76%|███████▌  | 81/107 [37:43<11:57, 27.60s/epoch, loss=1.11, accuracy=0.758, val_loss=1.7, val_accuracy=0.593, lr=0.1] 77%|███████▋  | 82/107 [38:11<11:32, 27.72s/epoch, loss=0.902, accuracy=0.818, val_loss=0.925, val_accuracy=0.791, lr=0.01] 78%|███████▊  | 83/107 [38:38<11:00, 27.54s/epoch, loss=0.725, accuracy=0.847, val_loss=0.831, val_accuracy=0.797, lr=0.01] 79%|███████▊  | 84/107 [39:06<10:34, 27.58s/epoch, loss=0.652, accuracy=0.855, val_loss=0.76, val_accuracy=0.808, lr=0.01]  79%|███████▉  | 85/107 [39:33<10:07, 27.61s/epoch, loss=0.604, accuracy=0.859, val_loss=0.739, val_accuracy=0.81, lr=0.01] 80%|████████  | 86/107 [40:01<09:39, 27.58s/epoch, loss=0.583, accuracy=0.861, val_loss=0.765, val_accuracy=0.797, lr=0.01] 81%|████████▏ | 87/107 [40:28<09:09, 27.48s/epoch, loss=0.573, accuracy=0.861, val_loss=0.838, val_accuracy=0.77, lr=0.01]  82%|████████▏ | 88/107 [40:56<08:45, 27.63s/epoch, loss=0.568, accuracy=0.862, val_loss=0.842, val_accuracy=0.781, lr=0.01] 83%|████████▎ | 89/107 [41:24<08:17, 27.67s/epoch, loss=0.564, accuracy=0.865, val_loss=1.13, val_accuracy=0.687, lr=0.01]  84%|████████▍ | 90/107 [41:52<07:51, 27.74s/epoch, loss=0.561, accuracy=0.866, val_loss=0.924, val_accuracy=0.764, lr=0.00316] 85%|████████▌ | 91/107 [42:19<07:22, 27.65s/epoch, loss=0.557, accuracy=0.868, val_loss=0.941, val_accuracy=0.75, lr=0.01]     86%|████████▌ | 92/107 [42:47<06:55, 27.72s/epoch, loss=0.555, accuracy=0.87, val_loss=1, val_accuracy=0.752, lr=0.01]     87%|████████▋ | 93/107 [43:15<06:27, 27.70s/epoch, loss=0.558, accuracy=0.867, val_loss=0.954, val_accuracy=0.746, lr=0.01] 88%|████████▊ | 94/107 [43:42<06:00, 27.76s/epoch, loss=0.554, accuracy=0.871, val_loss=1.11, val_accuracy=0.718, lr=0.01]  89%|████████▉ | 95/107 [44:10<05:32, 27.67s/epoch, loss=0.554, accuracy=0.871, val_loss=0.816, val_accuracy=0.788, lr=0.00316] 90%|████████▉ | 96/107 [44:38<05:04, 27.70s/epoch, loss=0.554, accuracy=0.873, val_loss=0.907, val_accuracy=0.77, lr=0.01]     91%|█████████ | 97/107 [45:05<04:36, 27.63s/epoch, loss=0.554, accuracy=0.873, val_loss=0.9, val_accuracy=0.766, lr=0.01]  92%|█████████▏| 98/107 [45:32<04:07, 27.46s/epoch, loss=0.551, accuracy=0.876, val_loss=0.82, val_accuracy=0.786, lr=0.01] 93%|█████████▎| 99/107 [45:59<03:38, 27.37s/epoch, loss=0.551, accuracy=0.875, val_loss=0.879, val_accuracy=0.772, lr=0.01] 93%|█████████▎| 100/107 [46:27<03:11, 27.43s/epoch, loss=0.546, accuracy=0.878, val_loss=1.07, val_accuracy=0.719, lr=0.00316] 94%|█████████▍| 101/107 [46:55<02:44, 27.50s/epoch, loss=0.554, accuracy=0.875, val_loss=0.832, val_accuracy=0.79, lr=0.01]    95%|█████████▌| 102/107 [47:23<02:18, 27.66s/epoch, loss=0.549, accuracy=0.879, val_loss=0.775, val_accuracy=0.813, lr=0.01] 96%|█████████▋| 103/107 [47:50<01:50, 27.67s/epoch, loss=0.548, accuracy=0.878, val_loss=0.816, val_accuracy=0.792, lr=0.01] 97%|█████████▋| 104/107 [48:18<01:23, 27.74s/epoch, loss=0.545, accuracy=0.879, val_loss=0.892, val_accuracy=0.783, lr=0.01] 98%|█████████▊| 105/107 [48:46<00:55, 27.75s/epoch, loss=0.551, accuracy=0.878, val_loss=0.948, val_accuracy=0.761, lr=0.00316] 99%|█████████▉| 106/107 [49:14<00:27, 27.72s/epoch, loss=0.547, accuracy=0.88, val_loss=0.845, val_accuracy=0.79, lr=0.01]     100%|██████████| 107/107 [49:41<00:00, 27.74s/epoch, loss=0.553, accuracy=0.879, val_loss=0.821, val_accuracy=0.804, lr=0.01]100%|██████████| 107/107 [49:41<00:00, 27.87s/epoch, loss=0.553, accuracy=0.879, val_loss=0.821, val_accuracy=0.804, lr=0.01]
Using real-time data augmentation.
Test score: 0.8208523392677307
Test accuracy: 0.8044999837875366


* * * Run SGD for ID = 14_6. * * *


2024-03-05 08:18:39.635895: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 08:18:42.061847: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 08:18:42.063065: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-05 08:18:42.104176: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-05 08:18:42.104217: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 08:18:42.107390: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 08:18:42.107457: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-05 08:18:42.110025: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-05 08:18:42.110696: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-05 08:18:42.113406: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-05 08:18:42.115035: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-05 08:18:42.120510: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 08:18:42.121182: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-05 08:18:42.121267: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 08:18:43.312028: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-05 08:18:43.313096: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 08:18:43.314216: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-05 08:18:43.314262: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 08:18:43.314301: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 08:18:43.314317: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-05 08:18:43.314331: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-05 08:18:43.314345: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-05 08:18:43.314362: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-05 08:18:43.314378: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-05 08:18:43.314394: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 08:18:43.314977: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-05 08:18:43.315017: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 08:18:43.943503: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-05 08:18:43.943553: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-05 08:18:43.943570: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-05 08:18:43.944581: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:3b:00.0, compute capability: 6.1)
{'id': '14_06', 'seed': 6, 'out_folder': 'results/epoch_budget', 'batch_size': 128, 'epochs': 107, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/107 [00:00<?, ?epoch/s]2024-03-05 08:18:44.791095: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-05 08:18:44.791818: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-03-05 08:18:46.741246: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 08:18:46.995506: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 08:18:48.017727: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-05 08:18:48.073817: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/107 [01:04<1:53:58, 64.52s/epoch, loss=3.02, accuracy=0.338, val_loss=2.45, val_accuracy=0.186, lr=0.1]  2%|▏         | 2/107 [01:31<1:13:52, 42.22s/epoch, loss=1.57, accuracy=0.534, val_loss=2.27, val_accuracy=0.439, lr=0.1]  3%|▎         | 3/107 [01:57<1:00:46, 35.06s/epoch, loss=1.36, accuracy=0.642, val_loss=1.67, val_accuracy=0.54, lr=0.1]   4%|▎         | 4/107 [02:25<54:59, 32.03s/epoch, loss=1.28, accuracy=0.684, val_loss=1.8, val_accuracy=0.529, lr=0.1]    5%|▍         | 5/107 [02:52<51:21, 30.21s/epoch, loss=1.25, accuracy=0.701, val_loss=1.93, val_accuracy=0.506, lr=0.1]  6%|▌         | 6/107 [03:19<49:29, 29.40s/epoch, loss=1.23, accuracy=0.714, val_loss=1.89, val_accuracy=0.534, lr=0.1]  7%|▋         | 7/107 [03:47<48:09, 28.90s/epoch, loss=1.21, accuracy=0.723, val_loss=1.58, val_accuracy=0.599, lr=0.1]  7%|▋         | 8/107 [04:15<47:14, 28.63s/epoch, loss=1.19, accuracy=0.727, val_loss=1.69, val_accuracy=0.552, lr=0.1]  8%|▊         | 9/107 [04:42<45:50, 28.06s/epoch, loss=1.2, accuracy=0.729, val_loss=1.98, val_accuracy=0.534, lr=0.1]   9%|▉         | 10/107 [05:10<45:15, 27.99s/epoch, loss=1.19, accuracy=0.735, val_loss=1.79, val_accuracy=0.558, lr=0.1] 10%|█         | 11/107 [05:38<44:55, 28.08s/epoch, loss=1.18, accuracy=0.737, val_loss=2.57, val_accuracy=0.439, lr=0.1] 11%|█         | 12/107 [06:06<44:23, 28.04s/epoch, loss=1.17, accuracy=0.741, val_loss=5.53, val_accuracy=0.219, lr=0.0316] 12%|█▏        | 13/107 [06:34<43:47, 27.95s/epoch, loss=1.17, accuracy=0.742, val_loss=1.85, val_accuracy=0.541, lr=0.1]    13%|█▎        | 14/107 [07:02<43:17, 27.92s/epoch, loss=1.16, accuracy=0.746, val_loss=2.38, val_accuracy=0.536, lr=0.1] 14%|█▍        | 15/107 [07:30<42:59, 28.04s/epoch, loss=1.16, accuracy=0.743, val_loss=1.65, val_accuracy=0.582, lr=0.1] 15%|█▍        | 16/107 [07:56<41:36, 27.43s/epoch, loss=1.17, accuracy=0.745, val_loss=3.17, val_accuracy=0.331, lr=0.1] 16%|█▌        | 17/107 [08:24<41:12, 27.47s/epoch, loss=1.16, accuracy=0.747, val_loss=1.56, val_accuracy=0.626, lr=0.1] 17%|█▋        | 18/107 [08:52<41:11, 27.77s/epoch, loss=1.16, accuracy=0.747, val_loss=2.58, val_accuracy=0.377, lr=0.1] 18%|█▊        | 19/107 [09:21<41:01, 27.97s/epoch, loss=1.15, accuracy=0.748, val_loss=1.5, val_accuracy=0.614, lr=0.1]  19%|█▊        | 20/107 [09:49<40:34, 27.98s/epoch, loss=1.14, accuracy=0.752, val_loss=6.47, val_accuracy=0.189, lr=0.1] 20%|█▉        | 21/107 [10:16<39:57, 27.88s/epoch, loss=1.14, accuracy=0.751, val_loss=1.53, val_accuracy=0.634, lr=0.1] 21%|██        | 22/107 [10:43<39:12, 27.68s/epoch, loss=1.15, accuracy=0.752, val_loss=2.2, val_accuracy=0.501, lr=0.1]  21%|██▏       | 23/107 [11:12<38:54, 27.80s/epoch, loss=1.15, accuracy=0.751, val_loss=1.7, val_accuracy=0.561, lr=0.1] 22%|██▏       | 24/107 [11:38<38:01, 27.49s/epoch, loss=1.14, accuracy=0.753, val_loss=1.5, val_accuracy=0.606, lr=0.0316] 23%|██▎       | 25/107 [12:06<37:41, 27.58s/epoch, loss=1.14, accuracy=0.754, val_loss=1.63, val_accuracy=0.596, lr=0.1]   24%|██▍       | 26/107 [12:34<37:21, 27.67s/epoch, loss=1.14, accuracy=0.751, val_loss=1.65, val_accuracy=0.588, lr=0.1] 25%|██▌       | 27/107 [13:02<37:02, 27.78s/epoch, loss=1.14, accuracy=0.751, val_loss=2.05, val_accuracy=0.522, lr=0.1] 26%|██▌       | 28/107 [13:30<36:35, 27.79s/epoch, loss=1.13, accuracy=0.752, val_loss=2.03, val_accuracy=0.503, lr=0.1] 27%|██▋       | 29/107 [13:57<36:00, 27.69s/epoch, loss=1.13, accuracy=0.754, val_loss=2.14, val_accuracy=0.397, lr=0.0316] 28%|██▊       | 30/107 [14:25<35:32, 27.70s/epoch, loss=1.14, accuracy=0.756, val_loss=1.87, val_accuracy=0.515, lr=0.1]    29%|██▉       | 31/107 [14:52<34:57, 27.60s/epoch, loss=1.13, accuracy=0.756, val_loss=2.21, val_accuracy=0.384, lr=0.1] 30%|██▉       | 32/107 [15:20<34:28, 27.57s/epoch, loss=1.13, accuracy=0.754, val_loss=2.59, val_accuracy=0.39, lr=0.1]  31%|███       | 33/107 [15:47<33:47, 27.40s/epoch, loss=1.13, accuracy=0.755, val_loss=1.7, val_accuracy=0.587, lr=0.1] 32%|███▏      | 34/107 [16:15<33:28, 27.51s/epoch, loss=1.13, accuracy=0.756, val_loss=3.71, val_accuracy=0.358, lr=0.0316] 33%|███▎      | 35/107 [16:41<32:36, 27.17s/epoch, loss=1.13, accuracy=0.757, val_loss=1.95, val_accuracy=0.501, lr=0.1]    34%|███▎      | 36/107 [17:08<32:14, 27.25s/epoch, loss=1.13, accuracy=0.755, val_loss=1.93, val_accuracy=0.471, lr=0.1] 35%|███▍      | 37/107 [17:36<31:51, 27.30s/epoch, loss=1.13, accuracy=0.755, val_loss=2.39, val_accuracy=0.394, lr=0.1] 36%|███▌      | 38/107 [18:03<31:27, 27.36s/epoch, loss=1.12, accuracy=0.757, val_loss=1.74, val_accuracy=0.57, lr=0.1]  36%|███▋      | 39/107 [18:30<30:48, 27.18s/epoch, loss=1.13, accuracy=0.756, val_loss=2.34, val_accuracy=0.391, lr=0.0316] 37%|███▋      | 40/107 [18:58<30:30, 27.32s/epoch, loss=1.12, accuracy=0.758, val_loss=5.46, val_accuracy=0.276, lr=0.1]    38%|███▊      | 41/107 [19:26<30:18, 27.55s/epoch, loss=1.12, accuracy=0.756, val_loss=2.21, val_accuracy=0.469, lr=0.1] 39%|███▉      | 42/107 [19:53<29:45, 27.47s/epoch, loss=1.12, accuracy=0.759, val_loss=2.99, val_accuracy=0.362, lr=0.1] 40%|████      | 43/107 [20:21<29:23, 27.55s/epoch, loss=1.13, accuracy=0.756, val_loss=2.49, val_accuracy=0.381, lr=0.1] 41%|████      | 44/107 [20:48<28:48, 27.43s/epoch, loss=1.12, accuracy=0.758, val_loss=2.04, val_accuracy=0.468, lr=0.0316] 42%|████▏     | 45/107 [21:16<28:29, 27.58s/epoch, loss=1.12, accuracy=0.76, val_loss=2.06, val_accuracy=0.49, lr=0.1]      43%|████▎     | 46/107 [21:44<28:10, 27.71s/epoch, loss=1.11, accuracy=0.757, val_loss=1.93, val_accuracy=0.452, lr=0.1] 44%|████▍     | 47/107 [22:12<27:49, 27.83s/epoch, loss=1.12, accuracy=0.759, val_loss=2.01, val_accuracy=0.504, lr=0.1] 45%|████▍     | 48/107 [22:40<27:24, 27.87s/epoch, loss=1.12, accuracy=0.76, val_loss=2.36, val_accuracy=0.422, lr=0.1]  46%|████▌     | 49/107 [23:08<26:59, 27.92s/epoch, loss=1.13, accuracy=0.754, val_loss=2.16, val_accuracy=0.499, lr=0.0316] 47%|████▋     | 50/107 [23:36<26:32, 27.93s/epoch, loss=1.11, accuracy=0.758, val_loss=2.03, val_accuracy=0.46, lr=0.1]     48%|████▊     | 51/107 [24:04<25:57, 27.82s/epoch, loss=1.11, accuracy=0.76, val_loss=2.5, val_accuracy=0.402, lr=0.1]  49%|████▊     | 52/107 [24:31<25:31, 27.85s/epoch, loss=1.12, accuracy=0.756, val_loss=1.5, val_accuracy=0.615, lr=0.1] 50%|████▉     | 53/107 [25:00<25:11, 27.98s/epoch, loss=1.11, accuracy=0.76, val_loss=2.38, val_accuracy=0.428, lr=0.1] 50%|█████     | 54/107 [25:28<24:48, 28.08s/epoch, loss=1.11, accuracy=0.757, val_loss=1.52, val_accuracy=0.617, lr=0.0316] 51%|█████▏    | 55/107 [25:56<24:23, 28.14s/epoch, loss=1.12, accuracy=0.759, val_loss=2.34, val_accuracy=0.407, lr=0.1]    52%|█████▏    | 56/107 [26:24<23:51, 28.06s/epoch, loss=1.11, accuracy=0.759, val_loss=2.19, val_accuracy=0.48, lr=0.1]  53%|█████▎    | 57/107 [26:52<23:18, 27.97s/epoch, loss=1.11, accuracy=0.759, val_loss=1.69, val_accuracy=0.593, lr=0.1] 54%|█████▍    | 58/107 [27:20<22:46, 27.88s/epoch, loss=1.12, accuracy=0.76, val_loss=2.46, val_accuracy=0.465, lr=0.1]  55%|█████▌    | 59/107 [27:47<22:15, 27.82s/epoch, loss=1.11, accuracy=0.759, val_loss=1.61, val_accuracy=0.594, lr=0.0316] 56%|█████▌    | 60/107 [28:15<21:49, 27.87s/epoch, loss=1.12, accuracy=0.759, val_loss=1.62, val_accuracy=0.606, lr=0.1]    57%|█████▋    | 61/107 [28:43<21:19, 27.82s/epoch, loss=1.11, accuracy=0.758, val_loss=1.4, val_accuracy=0.659, lr=0.1]  58%|█████▊    | 62/107 [29:11<20:52, 27.83s/epoch, loss=1.12, accuracy=0.758, val_loss=2.45, val_accuracy=0.423, lr=0.1] 59%|█████▉    | 63/107 [29:38<20:19, 27.71s/epoch, loss=1.11, accuracy=0.758, val_loss=3.85, val_accuracy=0.296, lr=0.1] 60%|█████▉    | 64/107 [30:05<19:41, 27.48s/epoch, loss=1.12, accuracy=0.758, val_loss=2.15, val_accuracy=0.444, lr=0.1] 61%|██████    | 65/107 [30:33<19:16, 27.53s/epoch, loss=1.12, accuracy=0.76, val_loss=2.22, val_accuracy=0.468, lr=0.1]  62%|██████▏   | 66/107 [31:01<18:55, 27.70s/epoch, loss=1.12, accuracy=0.755, val_loss=5.09, val_accuracy=0.167, lr=0.0316] 63%|██████▎   | 67/107 [31:29<18:30, 27.75s/epoch, loss=1.11, accuracy=0.758, val_loss=3.07, val_accuracy=0.384, lr=0.1]    64%|██████▎   | 68/107 [31:57<18:00, 27.71s/epoch, loss=1.11, accuracy=0.759, val_loss=2.53, val_accuracy=0.4, lr=0.1]   64%|██████▍   | 69/107 [32:24<17:30, 27.65s/epoch, loss=1.11, accuracy=0.757, val_loss=1.38, val_accuracy=0.666, lr=0.1] 65%|██████▌   | 70/107 [32:52<17:00, 27.59s/epoch, loss=1.12, accuracy=0.757, val_loss=1.79, val_accuracy=0.575, lr=0.1] 66%|██████▋   | 71/107 [33:19<16:30, 27.52s/epoch, loss=1.1, accuracy=0.759, val_loss=1.62, val_accuracy=0.59, lr=0.1]   67%|██████▋   | 72/107 [33:47<16:05, 27.57s/epoch, loss=1.11, accuracy=0.76, val_loss=1.69, val_accuracy=0.561, lr=0.1] 68%|██████▊   | 73/107 [34:14<15:38, 27.60s/epoch, loss=1.11, accuracy=0.76, val_loss=3.44, val_accuracy=0.434, lr=0.1] 69%|██████▉   | 74/107 [34:42<15:09, 27.56s/epoch, loss=1.11, accuracy=0.758, val_loss=1.51, val_accuracy=0.636, lr=0.0316] 70%|███████   | 75/107 [35:10<14:46, 27.71s/epoch, loss=1.11, accuracy=0.76, val_loss=8, val_accuracy=0.188, lr=0.1]        71%|███████   | 76/107 [35:38<14:20, 27.77s/epoch, loss=1.11, accuracy=0.756, val_loss=1.84, val_accuracy=0.52, lr=0.1] 72%|███████▏  | 77/107 [36:06<13:54, 27.82s/epoch, loss=1.11, accuracy=0.758, val_loss=3.41, val_accuracy=0.331, lr=0.1] 73%|███████▎  | 78/107 [36:33<13:26, 27.82s/epoch, loss=1.11, accuracy=0.758, val_loss=4.61, val_accuracy=0.228, lr=0.1] 74%|███████▍  | 79/107 [37:01<12:59, 27.83s/epoch, loss=1.11, accuracy=0.759, val_loss=2.16, val_accuracy=0.467, lr=0.0316] 75%|███████▍  | 80/107 [37:29<12:34, 27.94s/epoch, loss=1.11, accuracy=0.761, val_loss=2.21, val_accuracy=0.482, lr=0.1]    76%|███████▌  | 81/107 [37:57<12:05, 27.91s/epoch, loss=1.12, accuracy=0.756, val_loss=2.5, val_accuracy=0.309, lr=0.1]  77%|███████▋  | 82/107 [38:25<11:38, 27.94s/epoch, loss=0.912, accuracy=0.817, val_loss=1.02, val_accuracy=0.756, lr=0.01] 78%|███████▊  | 83/107 [38:53<11:07, 27.83s/epoch, loss=0.733, accuracy=0.848, val_loss=0.799, val_accuracy=0.814, lr=0.01] 79%|███████▊  | 84/107 [39:21<10:38, 27.77s/epoch, loss=0.65, accuracy=0.857, val_loss=0.736, val_accuracy=0.819, lr=0.01]  79%|███████▉  | 85/107 [39:48<10:11, 27.79s/epoch, loss=0.6, accuracy=0.86, val_loss=0.777, val_accuracy=0.793, lr=0.01]   80%|████████  | 86/107 [40:16<09:44, 27.81s/epoch, loss=0.581, accuracy=0.862, val_loss=1.04, val_accuracy=0.737, lr=0.01] 81%|████████▏ | 87/107 [40:44<09:15, 27.78s/epoch, loss=0.573, accuracy=0.86, val_loss=0.744, val_accuracy=0.8, lr=0.01]   82%|████████▏ | 88/107 [41:12<08:47, 27.74s/epoch, loss=0.567, accuracy=0.863, val_loss=0.743, val_accuracy=0.806, lr=0.01] 83%|████████▎ | 89/107 [41:38<08:13, 27.39s/epoch, loss=0.56, accuracy=0.865, val_loss=0.83, val_accuracy=0.78, lr=0.00316] 84%|████████▍ | 90/107 [42:05<07:40, 27.11s/epoch, loss=0.557, accuracy=0.866, val_loss=0.822, val_accuracy=0.785, lr=0.01] 85%|████████▌ | 91/107 [42:32<07:13, 27.11s/epoch, loss=0.553, accuracy=0.867, val_loss=0.791, val_accuracy=0.794, lr=0.01] 86%|████████▌ | 92/107 [42:58<06:43, 26.90s/epoch, loss=0.552, accuracy=0.871, val_loss=0.936, val_accuracy=0.759, lr=0.01] 87%|████████▋ | 93/107 [43:25<06:17, 26.95s/epoch, loss=0.555, accuracy=0.871, val_loss=0.705, val_accuracy=0.826, lr=0.01] 88%|████████▊ | 94/107 [43:53<05:53, 27.16s/epoch, loss=0.55, accuracy=0.871, val_loss=0.834, val_accuracy=0.79, lr=0.01]   89%|████████▉ | 95/107 [44:20<05:26, 27.20s/epoch, loss=0.549, accuracy=0.873, val_loss=0.728, val_accuracy=0.818, lr=0.01] 90%|████████▉ | 96/107 [44:47<04:58, 27.14s/epoch, loss=0.552, accuracy=0.873, val_loss=0.963, val_accuracy=0.751, lr=0.01] 91%|█████████ | 97/107 [45:13<04:28, 26.85s/epoch, loss=0.549, accuracy=0.876, val_loss=0.793, val_accuracy=0.797, lr=0.01] 92%|█████████▏| 98/107 [45:41<04:02, 26.99s/epoch, loss=0.548, accuracy=0.877, val_loss=0.906, val_accuracy=0.766, lr=0.00316] 93%|█████████▎| 99/107 [46:09<03:38, 27.28s/epoch, loss=0.548, accuracy=0.876, val_loss=1.04, val_accuracy=0.728, lr=0.01]     93%|█████████▎| 100/107 [46:37<03:12, 27.57s/epoch, loss=0.548, accuracy=0.879, val_loss=1.12, val_accuracy=0.703, lr=0.01] 94%|█████████▍| 101/107 [47:05<02:46, 27.76s/epoch, loss=0.55, accuracy=0.878, val_loss=0.813, val_accuracy=0.799, lr=0.01] 95%|█████████▌| 102/107 [47:33<02:18, 27.80s/epoch, loss=0.549, accuracy=0.877, val_loss=0.793, val_accuracy=0.807, lr=0.01] 96%|█████████▋| 103/107 [48:01<01:51, 27.84s/epoch, loss=0.55, accuracy=0.878, val_loss=0.763, val_accuracy=0.815, lr=0.00316] 97%|█████████▋| 104/107 [48:27<01:21, 27.30s/epoch, loss=0.548, accuracy=0.879, val_loss=1.06, val_accuracy=0.728, lr=0.01]    98%|█████████▊| 105/107 [48:53<00:53, 26.94s/epoch, loss=0.546, accuracy=0.878, val_loss=1, val_accuracy=0.755, lr=0.01]    99%|█████████▉| 106/107 [49:21<00:27, 27.13s/epoch, loss=0.548, accuracy=0.881, val_loss=0.816, val_accuracy=0.792, lr=0.01]100%|██████████| 107/107 [49:48<00:00, 27.25s/epoch, loss=0.549, accuracy=0.881, val_loss=0.932, val_accuracy=0.757, lr=0.01]100%|██████████| 107/107 [49:48<00:00, 27.93s/epoch, loss=0.549, accuracy=0.881, val_loss=0.932, val_accuracy=0.757, lr=0.01]
Using real-time data augmentation.
Test score: 0.931655764579773
Test accuracy: 0.7566999793052673


* * * Run SGD for ID = 14_7. * * *


2024-03-05 09:08:37.271588: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 09:08:40.064279: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 09:08:40.065532: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-05 09:08:40.106895: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-05 09:08:40.106950: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 09:08:40.110463: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 09:08:40.110532: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-05 09:08:40.113164: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-05 09:08:40.113979: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-05 09:08:40.116811: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-05 09:08:40.118543: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-05 09:08:40.124150: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 09:08:40.124796: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-05 09:08:40.124888: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 09:08:41.336564: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-05 09:08:41.337644: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 09:08:41.338785: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-05 09:08:41.338821: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 09:08:41.338869: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 09:08:41.338886: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-05 09:08:41.338899: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-05 09:08:41.338913: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-05 09:08:41.338929: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-05 09:08:41.338945: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-05 09:08:41.338961: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 09:08:41.339538: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-05 09:08:41.339579: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 09:08:41.966784: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-05 09:08:41.966838: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-05 09:08:41.966865: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-05 09:08:41.967975: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:3b:00.0, compute capability: 6.1)
{'id': '14_07', 'seed': 7, 'out_folder': 'results/epoch_budget', 'batch_size': 128, 'epochs': 107, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/107 [00:00<?, ?epoch/s]2024-03-05 09:08:42.846556: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-05 09:08:42.847160: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-03-05 09:08:44.826782: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 09:08:45.119360: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 09:08:46.182293: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-05 09:08:46.238843: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/107 [01:07<1:59:42, 67.75s/epoch, loss=3.16, accuracy=0.31, val_loss=2.92, val_accuracy=0.197, lr=0.1]  2%|▏         | 2/107 [01:35<1:17:51, 44.49s/epoch, loss=1.63, accuracy=0.505, val_loss=2.35, val_accuracy=0.326, lr=0.1]  3%|▎         | 3/107 [02:03<1:03:58, 36.91s/epoch, loss=1.46, accuracy=0.59, val_loss=2.41, val_accuracy=0.357, lr=0.1]   4%|▎         | 4/107 [02:32<57:30, 33.50s/epoch, loss=1.37, accuracy=0.645, val_loss=1.84, val_accuracy=0.521, lr=0.1]   5%|▍         | 5/107 [03:00<53:42, 31.59s/epoch, loss=1.31, accuracy=0.675, val_loss=2.78, val_accuracy=0.382, lr=0.1]  6%|▌         | 6/107 [03:28<51:21, 30.51s/epoch, loss=1.27, accuracy=0.694, val_loss=1.69, val_accuracy=0.556, lr=0.1]  7%|▋         | 7/107 [03:56<49:37, 29.78s/epoch, loss=1.26, accuracy=0.705, val_loss=1.68, val_accuracy=0.555, lr=0.1]  7%|▋         | 8/107 [04:25<48:19, 29.29s/epoch, loss=1.24, accuracy=0.714, val_loss=2.33, val_accuracy=0.481, lr=0.1]  8%|▊         | 9/107 [04:53<47:16, 28.95s/epoch, loss=1.24, accuracy=0.717, val_loss=1.8, val_accuracy=0.531, lr=0.1]   9%|▉         | 10/107 [05:21<46:27, 28.74s/epoch, loss=1.23, accuracy=0.724, val_loss=1.51, val_accuracy=0.612, lr=0.1] 10%|█         | 11/107 [05:49<45:37, 28.51s/epoch, loss=1.22, accuracy=0.726, val_loss=1.73, val_accuracy=0.561, lr=0.1] 11%|█         | 12/107 [06:17<44:51, 28.33s/epoch, loss=1.21, accuracy=0.728, val_loss=4.78, val_accuracy=0.244, lr=0.1] 12%|█▏        | 13/107 [06:45<44:00, 28.09s/epoch, loss=1.22, accuracy=0.73, val_loss=1.9, val_accuracy=0.511, lr=0.1]   13%|█▎        | 14/107 [07:12<43:12, 27.88s/epoch, loss=1.22, accuracy=0.73, val_loss=2.28, val_accuracy=0.502, lr=0.1] 14%|█▍        | 15/107 [07:40<42:44, 27.88s/epoch, loss=1.2, accuracy=0.736, val_loss=1.81, val_accuracy=0.521, lr=0.0316] 15%|█▍        | 16/107 [08:08<42:11, 27.82s/epoch, loss=1.2, accuracy=0.738, val_loss=1.43, val_accuracy=0.658, lr=0.1]    16%|█▌        | 17/107 [08:35<41:44, 27.83s/epoch, loss=1.2, accuracy=0.741, val_loss=2.38, val_accuracy=0.447, lr=0.1] 17%|█▋        | 18/107 [09:04<41:23, 27.90s/epoch, loss=1.2, accuracy=0.74, val_loss=1.7, val_accuracy=0.567, lr=0.1]   18%|█▊        | 19/107 [09:31<40:50, 27.85s/epoch, loss=1.19, accuracy=0.741, val_loss=1.64, val_accuracy=0.597, lr=0.1] 19%|█▊        | 20/107 [09:59<40:26, 27.90s/epoch, loss=1.2, accuracy=0.738, val_loss=1.4, val_accuracy=0.675, lr=0.1]   20%|█▉        | 21/107 [10:27<40:04, 27.96s/epoch, loss=1.19, accuracy=0.741, val_loss=2.54, val_accuracy=0.364, lr=0.1] 21%|██        | 22/107 [10:56<39:42, 28.02s/epoch, loss=1.19, accuracy=0.741, val_loss=1.49, val_accuracy=0.644, lr=0.1] 21%|██▏       | 23/107 [11:24<39:12, 28.01s/epoch, loss=1.19, accuracy=0.743, val_loss=2.23, val_accuracy=0.427, lr=0.1] 22%|██▏       | 24/107 [11:52<38:49, 28.07s/epoch, loss=1.19, accuracy=0.742, val_loss=2.02, val_accuracy=0.527, lr=0.1] 23%|██▎       | 25/107 [12:20<38:16, 28.00s/epoch, loss=1.19, accuracy=0.742, val_loss=1.9, val_accuracy=0.51, lr=0.0316] 24%|██▍       | 26/107 [12:47<37:34, 27.84s/epoch, loss=1.19, accuracy=0.744, val_loss=2.74, val_accuracy=0.41, lr=0.1]   25%|██▌       | 27/107 [13:15<37:04, 27.80s/epoch, loss=1.18, accuracy=0.744, val_loss=1.87, val_accuracy=0.532, lr=0.1] 26%|██▌       | 28/107 [13:43<36:37, 27.82s/epoch, loss=1.19, accuracy=0.746, val_loss=2.88, val_accuracy=0.449, lr=0.1] 27%|██▋       | 29/107 [14:12<36:36, 28.15s/epoch, loss=1.18, accuracy=0.745, val_loss=1.85, val_accuracy=0.527, lr=0.1] 28%|██▊       | 30/107 [14:39<35:55, 27.99s/epoch, loss=1.18, accuracy=0.745, val_loss=1.92, val_accuracy=0.534, lr=0.0316] 29%|██▉       | 31/107 [15:06<35:07, 27.73s/epoch, loss=1.17, accuracy=0.747, val_loss=4.64, val_accuracy=0.273, lr=0.1]    30%|██▉       | 32/107 [15:35<35:01, 28.02s/epoch, loss=1.17, accuracy=0.746, val_loss=1.57, val_accuracy=0.614, lr=0.1] 31%|███       | 33/107 [16:03<34:37, 28.08s/epoch, loss=1.17, accuracy=0.75, val_loss=2.18, val_accuracy=0.536, lr=0.1]  32%|███▏      | 34/107 [16:32<34:23, 28.26s/epoch, loss=1.17, accuracy=0.75, val_loss=1.81, val_accuracy=0.531, lr=0.1] 33%|███▎      | 35/107 [16:59<33:38, 28.03s/epoch, loss=1.17, accuracy=0.749, val_loss=1.72, val_accuracy=0.575, lr=0.0316] 34%|███▎      | 36/107 [17:27<32:56, 27.83s/epoch, loss=1.17, accuracy=0.746, val_loss=2.6, val_accuracy=0.354, lr=0.1]     35%|███▍      | 37/107 [17:54<32:24, 27.78s/epoch, loss=1.16, accuracy=0.75, val_loss=2.36, val_accuracy=0.457, lr=0.1] 36%|███▌      | 38/107 [18:23<32:09, 27.97s/epoch, loss=1.16, accuracy=0.75, val_loss=2, val_accuracy=0.505, lr=0.1]    36%|███▋      | 39/107 [18:51<31:38, 27.92s/epoch, loss=1.16, accuracy=0.751, val_loss=2.12, val_accuracy=0.431, lr=0.1] 37%|███▋      | 40/107 [19:18<31:07, 27.88s/epoch, loss=1.17, accuracy=0.75, val_loss=2.31, val_accuracy=0.498, lr=0.0316] 38%|███▊      | 41/107 [19:46<30:37, 27.85s/epoch, loss=1.17, accuracy=0.749, val_loss=1.64, val_accuracy=0.606, lr=0.1]   39%|███▉      | 42/107 [20:15<30:31, 28.17s/epoch, loss=1.16, accuracy=0.751, val_loss=1.58, val_accuracy=0.607, lr=0.1] 40%|████      | 43/107 [20:44<30:18, 28.41s/epoch, loss=1.16, accuracy=0.751, val_loss=2.33, val_accuracy=0.474, lr=0.1] 41%|████      | 44/107 [21:13<30:00, 28.58s/epoch, loss=1.15, accuracy=0.752, val_loss=1.31, val_accuracy=0.698, lr=0.1] 42%|████▏     | 45/107 [21:40<29:05, 28.16s/epoch, loss=1.15, accuracy=0.752, val_loss=1.96, val_accuracy=0.547, lr=0.1] 43%|████▎     | 46/107 [22:08<28:35, 28.13s/epoch, loss=1.16, accuracy=0.753, val_loss=2.4, val_accuracy=0.449, lr=0.1]  44%|████▍     | 47/107 [22:36<28:01, 28.02s/epoch, loss=1.16, accuracy=0.748, val_loss=2.77, val_accuracy=0.331, lr=0.1] 45%|████▍     | 48/107 [23:03<27:17, 27.75s/epoch, loss=1.16, accuracy=0.751, val_loss=2, val_accuracy=0.508, lr=0.1]    46%|████▌     | 49/107 [23:30<26:37, 27.55s/epoch, loss=1.14, accuracy=0.754, val_loss=3.25, val_accuracy=0.355, lr=0.0316] 47%|████▋     | 50/107 [23:57<26:03, 27.43s/epoch, loss=1.15, accuracy=0.753, val_loss=2.22, val_accuracy=0.459, lr=0.1]    48%|████▊     | 51/107 [24:24<25:27, 27.28s/epoch, loss=1.14, accuracy=0.754, val_loss=1.83, val_accuracy=0.56, lr=0.1]  49%|████▊     | 52/107 [24:53<25:20, 27.64s/epoch, loss=1.15, accuracy=0.75, val_loss=2.05, val_accuracy=0.508, lr=0.1] 50%|████▉     | 53/107 [25:20<24:44, 27.49s/epoch, loss=1.14, accuracy=0.752, val_loss=2.05, val_accuracy=0.521, lr=0.1] 50%|█████     | 54/107 [25:48<24:20, 27.55s/epoch, loss=1.15, accuracy=0.751, val_loss=2.35, val_accuracy=0.442, lr=0.0316] 51%|█████▏    | 55/107 [26:18<24:29, 28.25s/epoch, loss=1.15, accuracy=0.75, val_loss=2.48, val_accuracy=0.448, lr=0.1]     52%|█████▏    | 56/107 [26:47<24:15, 28.54s/epoch, loss=1.14, accuracy=0.753, val_loss=1.95, val_accuracy=0.518, lr=0.1] 53%|█████▎    | 57/107 [27:17<24:06, 28.94s/epoch, loss=1.15, accuracy=0.751, val_loss=2.89, val_accuracy=0.441, lr=0.1] 54%|█████▍    | 58/107 [27:47<23:53, 29.26s/epoch, loss=1.14, accuracy=0.753, val_loss=1.94, val_accuracy=0.465, lr=0.1] 55%|█████▌    | 59/107 [28:14<23:00, 28.76s/epoch, loss=1.14, accuracy=0.753, val_loss=2.61, val_accuracy=0.372, lr=0.0316] 56%|█████▌    | 60/107 [28:43<22:37, 28.89s/epoch, loss=1.14, accuracy=0.752, val_loss=1.58, val_accuracy=0.626, lr=0.1]    57%|█████▋    | 61/107 [29:11<21:49, 28.48s/epoch, loss=1.14, accuracy=0.752, val_loss=4.16, val_accuracy=0.283, lr=0.1] 58%|█████▊    | 62/107 [29:38<21:09, 28.20s/epoch, loss=1.14, accuracy=0.755, val_loss=1.75, val_accuracy=0.58, lr=0.1]  59%|█████▉    | 63/107 [30:06<20:25, 27.86s/epoch, loss=1.14, accuracy=0.754, val_loss=3.64, val_accuracy=0.231, lr=0.1] 60%|█████▉    | 64/107 [30:32<19:41, 27.48s/epoch, loss=1.14, accuracy=0.754, val_loss=2.04, val_accuracy=0.548, lr=0.0316] 61%|██████    | 65/107 [30:59<19:05, 27.27s/epoch, loss=1.14, accuracy=0.756, val_loss=2.72, val_accuracy=0.337, lr=0.1]    62%|██████▏   | 66/107 [31:27<18:45, 27.45s/epoch, loss=1.13, accuracy=0.754, val_loss=2.65, val_accuracy=0.44, lr=0.1]  63%|██████▎   | 67/107 [31:54<18:15, 27.39s/epoch, loss=1.14, accuracy=0.754, val_loss=2.9, val_accuracy=0.414, lr=0.1] 64%|██████▎   | 68/107 [32:22<17:49, 27.42s/epoch, loss=1.14, accuracy=0.751, val_loss=2.31, val_accuracy=0.467, lr=0.1] 64%|██████▍   | 69/107 [32:49<17:21, 27.42s/epoch, loss=1.13, accuracy=0.754, val_loss=2.6, val_accuracy=0.379, lr=0.0316] 65%|██████▌   | 70/107 [33:17<16:57, 27.51s/epoch, loss=1.14, accuracy=0.755, val_loss=2.01, val_accuracy=0.463, lr=0.1]   66%|██████▋   | 71/107 [33:44<16:25, 27.38s/epoch, loss=1.14, accuracy=0.755, val_loss=1.93, val_accuracy=0.502, lr=0.1] 67%|██████▋   | 72/107 [34:11<16:00, 27.45s/epoch, loss=1.14, accuracy=0.754, val_loss=1.82, val_accuracy=0.533, lr=0.1] 68%|██████▊   | 73/107 [34:38<15:23, 27.17s/epoch, loss=1.14, accuracy=0.754, val_loss=1.69, val_accuracy=0.581, lr=0.1] 69%|██████▉   | 74/107 [35:05<14:59, 27.26s/epoch, loss=1.14, accuracy=0.757, val_loss=1.61, val_accuracy=0.6, lr=0.0316] 70%|███████   | 75/107 [35:33<14:38, 27.46s/epoch, loss=1.14, accuracy=0.758, val_loss=5.18, val_accuracy=0.225, lr=0.1]  71%|███████   | 76/107 [36:01<14:10, 27.45s/epoch, loss=1.13, accuracy=0.76, val_loss=2.25, val_accuracy=0.481, lr=0.1]  72%|███████▏  | 77/107 [36:28<13:45, 27.50s/epoch, loss=1.13, accuracy=0.756, val_loss=1.67, val_accuracy=0.55, lr=0.1] 73%|███████▎  | 78/107 [36:56<13:23, 27.71s/epoch, loss=1.13, accuracy=0.755, val_loss=2.82, val_accuracy=0.403, lr=0.1] 74%|███████▍  | 79/107 [37:24<12:53, 27.64s/epoch, loss=1.13, accuracy=0.757, val_loss=1.92, val_accuracy=0.518, lr=0.0316] 75%|███████▍  | 80/107 [37:52<12:27, 27.70s/epoch, loss=1.14, accuracy=0.755, val_loss=2.88, val_accuracy=0.382, lr=0.1]    76%|███████▌  | 81/107 [38:19<11:55, 27.51s/epoch, loss=1.13, accuracy=0.754, val_loss=1.33, val_accuracy=0.684, lr=0.1] 77%|███████▋  | 82/107 [38:46<11:27, 27.49s/epoch, loss=0.912, accuracy=0.817, val_loss=0.891, val_accuracy=0.808, lr=0.01] 78%|███████▊  | 83/107 [39:13<10:55, 27.33s/epoch, loss=0.739, accuracy=0.846, val_loss=0.96, val_accuracy=0.754, lr=0.01]  79%|███████▊  | 84/107 [39:39<10:19, 26.92s/epoch, loss=0.656, accuracy=0.854, val_loss=0.777, val_accuracy=0.807, lr=0.01] 79%|███████▉  | 85/107 [40:07<09:58, 27.20s/epoch, loss=0.608, accuracy=0.86, val_loss=0.81, val_accuracy=0.797, lr=0.01]   80%|████████  | 86/107 [40:35<09:33, 27.30s/epoch, loss=0.592, accuracy=0.859, val_loss=0.99, val_accuracy=0.737, lr=0.01] 81%|████████▏ | 87/107 [41:02<09:08, 27.44s/epoch, loss=0.576, accuracy=0.862, val_loss=0.795, val_accuracy=0.79, lr=0.01] 82%|████████▏ | 88/107 [41:30<08:43, 27.55s/epoch, loss=0.571, accuracy=0.864, val_loss=0.95, val_accuracy=0.746, lr=0.01] 83%|████████▎ | 89/107 [41:58<08:14, 27.48s/epoch, loss=0.569, accuracy=0.865, val_loss=1.02, val_accuracy=0.725, lr=0.00316] 84%|████████▍ | 90/107 [42:26<07:50, 27.66s/epoch, loss=0.566, accuracy=0.867, val_loss=0.726, val_accuracy=0.817, lr=0.01]   85%|████████▌ | 91/107 [42:53<07:21, 27.59s/epoch, loss=0.565, accuracy=0.867, val_loss=0.699, val_accuracy=0.825, lr=0.01] 86%|████████▌ | 92/107 [43:20<06:50, 27.36s/epoch, loss=0.564, accuracy=0.869, val_loss=0.921, val_accuracy=0.764, lr=0.01] 87%|████████▋ | 93/107 [43:47<06:23, 27.40s/epoch, loss=0.559, accuracy=0.871, val_loss=0.884, val_accuracy=0.779, lr=0.01] 88%|████████▊ | 94/107 [44:15<05:55, 27.38s/epoch, loss=0.56, accuracy=0.873, val_loss=0.853, val_accuracy=0.779, lr=0.01]  89%|████████▉ | 95/107 [44:43<05:33, 27.80s/epoch, loss=0.559, accuracy=0.874, val_loss=0.912, val_accuracy=0.763, lr=0.01] 90%|████████▉ | 96/107 [45:12<05:07, 27.93s/epoch, loss=0.559, accuracy=0.875, val_loss=0.749, val_accuracy=0.812, lr=0.00316] 91%|█████████ | 97/107 [45:40<04:39, 27.91s/epoch, loss=0.554, accuracy=0.877, val_loss=0.927, val_accuracy=0.757, lr=0.01]    92%|█████████▏| 98/107 [46:07<04:10, 27.85s/epoch, loss=0.559, accuracy=0.876, val_loss=0.697, val_accuracy=0.832, lr=0.01] 93%|█████████▎| 99/107 [46:35<03:43, 27.89s/epoch, loss=0.556, accuracy=0.878, val_loss=0.754, val_accuracy=0.813, lr=0.01] 93%|█████████▎| 100/107 [47:03<03:14, 27.80s/epoch, loss=0.563, accuracy=0.876, val_loss=0.825, val_accuracy=0.794, lr=0.01] 94%|█████████▍| 101/107 [47:30<02:45, 27.58s/epoch, loss=0.557, accuracy=0.878, val_loss=1.13, val_accuracy=0.743, lr=0.01]  95%|█████████▌| 102/107 [47:56<02:16, 27.24s/epoch, loss=0.555, accuracy=0.88, val_loss=1, val_accuracy=0.766, lr=0.01]     96%|█████████▋| 103/107 [48:24<01:48, 27.24s/epoch, loss=0.555, accuracy=0.881, val_loss=0.962, val_accuracy=0.756, lr=0.00316] 97%|█████████▋| 104/107 [48:51<01:21, 27.21s/epoch, loss=0.553, accuracy=0.881, val_loss=0.752, val_accuracy=0.821, lr=0.01]    98%|█████████▊| 105/107 [49:17<00:53, 26.86s/epoch, loss=0.557, accuracy=0.881, val_loss=0.826, val_accuracy=0.79, lr=0.01]  99%|█████████▉| 106/107 [49:44<00:26, 26.98s/epoch, loss=0.555, accuracy=0.88, val_loss=0.755, val_accuracy=0.815, lr=0.01]100%|██████████| 107/107 [50:12<00:00, 27.17s/epoch, loss=0.556, accuracy=0.881, val_loss=1.03, val_accuracy=0.743, lr=0.01]100%|██████████| 107/107 [50:12<00:00, 28.15s/epoch, loss=0.556, accuracy=0.881, val_loss=1.03, val_accuracy=0.743, lr=0.01]
Using real-time data augmentation.
Test score: 1.0346626043319702
Test accuracy: 0.742900013923645


* * * Run SGD for ID = 14_8. * * *


2024-03-05 09:58:58.886206: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 09:59:01.644639: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 09:59:01.645791: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-05 09:59:01.688577: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-05 09:59:01.688614: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 09:59:01.692203: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 09:59:01.692276: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-05 09:59:01.695139: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-05 09:59:01.695925: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-05 09:59:01.699011: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-05 09:59:01.700760: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-05 09:59:01.706854: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 09:59:01.707567: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-05 09:59:01.707650: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 09:59:02.952555: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-05 09:59:02.953207: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 09:59:02.954352: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-05 09:59:02.954386: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 09:59:02.954423: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 09:59:02.954437: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-05 09:59:02.954449: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-05 09:59:02.954461: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-05 09:59:02.954475: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-05 09:59:02.954489: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-05 09:59:02.954503: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 09:59:02.955028: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-05 09:59:02.955063: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 09:59:03.589771: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-05 09:59:03.589820: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-05 09:59:03.589835: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-05 09:59:03.590854: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:3b:00.0, compute capability: 6.1)
{'id': '14_08', 'seed': 8, 'out_folder': 'results/epoch_budget', 'batch_size': 128, 'epochs': 107, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/107 [00:00<?, ?epoch/s]2024-03-05 09:59:04.436638: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-05 09:59:04.437238: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-03-05 09:59:06.395078: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 09:59:06.693901: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 09:59:07.505648: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-05 09:59:07.576681: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/107 [01:04<1:53:42, 64.37s/epoch, loss=2.92, accuracy=0.377, val_loss=2.4, val_accuracy=0.311, lr=0.1]  2%|▏         | 2/107 [01:30<1:13:45, 42.15s/epoch, loss=1.44, accuracy=0.603, val_loss=2.29, val_accuracy=0.338, lr=0.1]  3%|▎         | 3/107 [01:57<1:00:42, 35.02s/epoch, loss=1.29, accuracy=0.668, val_loss=1.53, val_accuracy=0.587, lr=0.1]  4%|▎         | 4/107 [02:24<54:57, 32.02s/epoch, loss=1.25, accuracy=0.697, val_loss=1.94, val_accuracy=0.474, lr=0.1]    5%|▍         | 5/107 [02:53<52:10, 30.69s/epoch, loss=1.22, accuracy=0.709, val_loss=7.01, val_accuracy=0.147, lr=0.1]  6%|▌         | 6/107 [03:21<50:22, 29.92s/epoch, loss=1.21, accuracy=0.719, val_loss=1.81, val_accuracy=0.502, lr=0.1]  7%|▋         | 7/107 [03:49<48:58, 29.39s/epoch, loss=1.19, accuracy=0.725, val_loss=1.68, val_accuracy=0.573, lr=0.1]  7%|▋         | 8/107 [04:17<47:25, 28.75s/epoch, loss=1.18, accuracy=0.731, val_loss=2.03, val_accuracy=0.493, lr=0.0316]  8%|▊         | 9/107 [04:45<46:40, 28.58s/epoch, loss=1.17, accuracy=0.732, val_loss=1.6, val_accuracy=0.6, lr=0.1]        9%|▉         | 10/107 [05:13<45:55, 28.41s/epoch, loss=1.17, accuracy=0.738, val_loss=1.93, val_accuracy=0.48, lr=0.1] 10%|█         | 11/107 [05:41<45:20, 28.34s/epoch, loss=1.17, accuracy=0.738, val_loss=1.63, val_accuracy=0.564, lr=0.1] 11%|█         | 12/107 [06:10<44:53, 28.35s/epoch, loss=1.16, accuracy=0.738, val_loss=1.74, val_accuracy=0.57, lr=0.1]  12%|█▏        | 13/107 [06:37<43:43, 27.91s/epoch, loss=1.16, accuracy=0.743, val_loss=2.07, val_accuracy=0.501, lr=0.0316] 13%|█▎        | 14/107 [07:03<42:38, 27.51s/epoch, loss=1.15, accuracy=0.745, val_loss=1.64, val_accuracy=0.582, lr=0.1]    14%|█▍        | 15/107 [07:31<42:12, 27.53s/epoch, loss=1.14, accuracy=0.747, val_loss=2.17, val_accuracy=0.478, lr=0.1] 15%|█▍        | 16/107 [07:59<42:02, 27.72s/epoch, loss=1.14, accuracy=0.747, val_loss=1.7, val_accuracy=0.567, lr=0.1]  16%|█▌        | 17/107 [08:26<41:32, 27.69s/epoch, loss=1.14, accuracy=0.748, val_loss=1.81, val_accuracy=0.528, lr=0.1] 17%|█▋        | 18/107 [08:55<41:16, 27.82s/epoch, loss=1.14, accuracy=0.747, val_loss=2.22, val_accuracy=0.455, lr=0.0316] 18%|█▊        | 19/107 [09:22<40:48, 27.82s/epoch, loss=1.13, accuracy=0.75, val_loss=1.91, val_accuracy=0.564, lr=0.1]     19%|█▊        | 20/107 [09:50<40:26, 27.89s/epoch, loss=1.13, accuracy=0.751, val_loss=1.82, val_accuracy=0.538, lr=0.1] 20%|█▉        | 21/107 [10:19<40:15, 28.09s/epoch, loss=1.12, accuracy=0.752, val_loss=2.11, val_accuracy=0.528, lr=0.1] 21%|██        | 22/107 [10:47<39:42, 28.03s/epoch, loss=1.13, accuracy=0.751, val_loss=1.47, val_accuracy=0.622, lr=0.1] 21%|██▏       | 23/107 [11:15<39:15, 28.04s/epoch, loss=1.12, accuracy=0.754, val_loss=1.8, val_accuracy=0.532, lr=0.1]  22%|██▏       | 24/107 [11:41<38:06, 27.55s/epoch, loss=1.12, accuracy=0.754, val_loss=1.46, val_accuracy=0.644, lr=0.1] 23%|██▎       | 25/107 [12:09<37:48, 27.66s/epoch, loss=1.12, accuracy=0.754, val_loss=2.07, val_accuracy=0.515, lr=0.1] 24%|██▍       | 26/107 [12:36<37:04, 27.47s/epoch, loss=1.11, accuracy=0.754, val_loss=1.66, val_accuracy=0.585, lr=0.1] 25%|██▌       | 27/107 [13:04<36:50, 27.63s/epoch, loss=1.12, accuracy=0.755, val_loss=4.9, val_accuracy=0.34, lr=0.1]   26%|██▌       | 28/107 [13:33<36:37, 27.81s/epoch, loss=1.11, accuracy=0.759, val_loss=3.02, val_accuracy=0.329, lr=0.1] 27%|██▋       | 29/107 [14:00<36:07, 27.79s/epoch, loss=1.12, accuracy=0.755, val_loss=5.63, val_accuracy=0.228, lr=0.0316] 28%|██▊       | 30/107 [14:28<35:45, 27.87s/epoch, loss=1.12, accuracy=0.758, val_loss=3.02, val_accuracy=0.391, lr=0.1]    29%|██▉       | 31/107 [14:56<35:16, 27.85s/epoch, loss=1.11, accuracy=0.757, val_loss=1.53, val_accuracy=0.619, lr=0.1] 30%|██▉       | 32/107 [15:24<34:53, 27.92s/epoch, loss=1.11, accuracy=0.758, val_loss=3.02, val_accuracy=0.246, lr=0.1] 31%|███       | 33/107 [15:53<34:36, 28.06s/epoch, loss=1.11, accuracy=0.756, val_loss=3.52, val_accuracy=0.247, lr=0.1] 32%|███▏      | 34/107 [16:21<34:16, 28.17s/epoch, loss=1.11, accuracy=0.758, val_loss=2.05, val_accuracy=0.528, lr=0.0316] 33%|███▎      | 35/107 [16:50<33:57, 28.30s/epoch, loss=1.11, accuracy=0.758, val_loss=2.36, val_accuracy=0.44, lr=0.1]     34%|███▎      | 36/107 [17:17<33:15, 28.11s/epoch, loss=1.11, accuracy=0.757, val_loss=1.73, val_accuracy=0.565, lr=0.1] 35%|███▍      | 37/107 [17:45<32:47, 28.10s/epoch, loss=1.11, accuracy=0.757, val_loss=3.25, val_accuracy=0.194, lr=0.1] 36%|███▌      | 38/107 [18:13<32:13, 28.02s/epoch, loss=1.1, accuracy=0.76, val_loss=2.2, val_accuracy=0.523, lr=0.1]    36%|███▋      | 39/107 [18:42<31:51, 28.11s/epoch, loss=1.11, accuracy=0.757, val_loss=2.43, val_accuracy=0.456, lr=0.0316] 37%|███▋      | 40/107 [19:10<31:22, 28.09s/epoch, loss=1.1, accuracy=0.758, val_loss=2.73, val_accuracy=0.377, lr=0.1]     38%|███▊      | 41/107 [19:37<30:32, 27.76s/epoch, loss=1.11, accuracy=0.759, val_loss=1.75, val_accuracy=0.585, lr=0.1] 39%|███▉      | 42/107 [20:04<29:56, 27.65s/epoch, loss=1.1, accuracy=0.759, val_loss=1.74, val_accuracy=0.547, lr=0.1]  40%|████      | 43/107 [20:32<29:36, 27.76s/epoch, loss=1.11, accuracy=0.757, val_loss=2, val_accuracy=0.537, lr=0.1]   41%|████      | 44/107 [21:00<29:07, 27.73s/epoch, loss=1.1, accuracy=0.76, val_loss=1.6, val_accuracy=0.606, lr=0.0316] 42%|████▏     | 45/107 [21:28<28:48, 27.88s/epoch, loss=1.1, accuracy=0.759, val_loss=3.04, val_accuracy=0.416, lr=0.1]  43%|████▎     | 46/107 [21:56<28:23, 27.92s/epoch, loss=1.11, accuracy=0.758, val_loss=2.76, val_accuracy=0.438, lr=0.1] 44%|████▍     | 47/107 [22:24<27:58, 27.98s/epoch, loss=1.1, accuracy=0.759, val_loss=1.85, val_accuracy=0.524, lr=0.1]  45%|████▍     | 48/107 [22:52<27:36, 28.08s/epoch, loss=1.1, accuracy=0.76, val_loss=1.69, val_accuracy=0.544, lr=0.1]  46%|████▌     | 49/107 [23:21<27:11, 28.12s/epoch, loss=1.11, accuracy=0.759, val_loss=1.76, val_accuracy=0.552, lr=0.0316] 47%|████▋     | 50/107 [23:49<26:41, 28.09s/epoch, loss=1.1, accuracy=0.757, val_loss=1.6, val_accuracy=0.603, lr=0.1]      48%|████▊     | 51/107 [24:17<26:19, 28.20s/epoch, loss=1.09, accuracy=0.761, val_loss=1.86, val_accuracy=0.528, lr=0.1] 49%|████▊     | 52/107 [24:44<25:32, 27.86s/epoch, loss=1.1, accuracy=0.759, val_loss=2.12, val_accuracy=0.451, lr=0.1]  50%|████▉     | 53/107 [25:12<25:08, 27.94s/epoch, loss=1.1, accuracy=0.759, val_loss=1.65, val_accuracy=0.586, lr=0.1] 50%|█████     | 54/107 [25:40<24:40, 27.94s/epoch, loss=1.1, accuracy=0.76, val_loss=1.68, val_accuracy=0.54, lr=0.0316] 51%|█████▏    | 55/107 [26:08<24:05, 27.81s/epoch, loss=1.11, accuracy=0.756, val_loss=2.15, val_accuracy=0.41, lr=0.1]  52%|█████▏    | 56/107 [26:36<23:40, 27.86s/epoch, loss=1.11, accuracy=0.76, val_loss=2.71, val_accuracy=0.414, lr=0.1] 53%|█████▎    | 57/107 [27:04<23:17, 27.95s/epoch, loss=1.1, accuracy=0.759, val_loss=2.04, val_accuracy=0.488, lr=0.1] 54%|█████▍    | 58/107 [27:32<22:49, 27.96s/epoch, loss=1.1, accuracy=0.757, val_loss=1.5, val_accuracy=0.641, lr=0.1]  55%|█████▌    | 59/107 [28:00<22:21, 27.95s/epoch, loss=1.11, accuracy=0.76, val_loss=1.59, val_accuracy=0.583, lr=0.0316] 56%|█████▌    | 60/107 [28:27<21:44, 27.76s/epoch, loss=1.1, accuracy=0.759, val_loss=1.97, val_accuracy=0.485, lr=0.1]    57%|█████▋    | 61/107 [28:55<21:14, 27.71s/epoch, loss=1.1, accuracy=0.76, val_loss=1.95, val_accuracy=0.447, lr=0.1]  58%|█████▊    | 62/107 [29:23<20:53, 27.86s/epoch, loss=1.1, accuracy=0.76, val_loss=2.62, val_accuracy=0.373, lr=0.1] 59%|█████▉    | 63/107 [29:51<20:24, 27.83s/epoch, loss=1.1, accuracy=0.76, val_loss=2.24, val_accuracy=0.505, lr=0.1] 60%|█████▉    | 64/107 [30:18<19:54, 27.77s/epoch, loss=1.1, accuracy=0.759, val_loss=1.71, val_accuracy=0.53, lr=0.0316] 61%|██████    | 65/107 [30:46<19:28, 27.82s/epoch, loss=1.1, accuracy=0.759, val_loss=1.62, val_accuracy=0.603, lr=0.1]   62%|██████▏   | 66/107 [31:14<18:59, 27.78s/epoch, loss=1.1, accuracy=0.76, val_loss=4.26, val_accuracy=0.176, lr=0.1]  63%|██████▎   | 67/107 [31:41<18:27, 27.69s/epoch, loss=1.09, accuracy=0.758, val_loss=2.91, val_accuracy=0.368, lr=0.1] 64%|██████▎   | 68/107 [32:09<17:56, 27.61s/epoch, loss=1.1, accuracy=0.758, val_loss=1.51, val_accuracy=0.646, lr=0.1]  64%|██████▍   | 69/107 [32:37<17:34, 27.75s/epoch, loss=1.1, accuracy=0.759, val_loss=1.92, val_accuracy=0.504, lr=0.0316] 65%|██████▌   | 70/107 [33:05<17:06, 27.73s/epoch, loss=1.1, accuracy=0.758, val_loss=2.33, val_accuracy=0.42, lr=0.1]     66%|██████▋   | 71/107 [33:33<16:43, 27.88s/epoch, loss=1.1, accuracy=0.758, val_loss=2.03, val_accuracy=0.544, lr=0.1] 67%|██████▋   | 72/107 [34:00<16:07, 27.65s/epoch, loss=1.1, accuracy=0.76, val_loss=1.87, val_accuracy=0.486, lr=0.1]  68%|██████▊   | 73/107 [34:28<15:43, 27.76s/epoch, loss=1.1, accuracy=0.759, val_loss=1.97, val_accuracy=0.505, lr=0.1] 69%|██████▉   | 74/107 [34:55<15:08, 27.53s/epoch, loss=1.1, accuracy=0.759, val_loss=2.57, val_accuracy=0.418, lr=0.0316] 70%|███████   | 75/107 [35:23<14:46, 27.69s/epoch, loss=1.1, accuracy=0.761, val_loss=2.14, val_accuracy=0.517, lr=0.1]    71%|███████   | 76/107 [35:51<14:21, 27.78s/epoch, loss=1.1, accuracy=0.758, val_loss=1.45, val_accuracy=0.643, lr=0.1] 72%|███████▏  | 77/107 [36:19<13:57, 27.93s/epoch, loss=1.1, accuracy=0.757, val_loss=1.45, val_accuracy=0.623, lr=0.1] 73%|███████▎  | 78/107 [36:47<13:31, 27.99s/epoch, loss=1.1, accuracy=0.759, val_loss=2.07, val_accuracy=0.468, lr=0.1] 74%|███████▍  | 79/107 [37:15<13:03, 27.98s/epoch, loss=1.09, accuracy=0.758, val_loss=5.9, val_accuracy=0.294, lr=0.1] 75%|███████▍  | 80/107 [37:42<12:26, 27.63s/epoch, loss=1.1, accuracy=0.76, val_loss=2, val_accuracy=0.518, lr=0.1]     76%|███████▌  | 81/107 [38:10<12:00, 27.69s/epoch, loss=1.09, accuracy=0.759, val_loss=2.17, val_accuracy=0.489, lr=0.1] 77%|███████▋  | 82/107 [38:38<11:36, 27.86s/epoch, loss=0.88, accuracy=0.821, val_loss=0.864, val_accuracy=0.807, lr=0.01] 78%|███████▊  | 83/107 [39:06<11:08, 27.83s/epoch, loss=0.714, accuracy=0.849, val_loss=0.848, val_accuracy=0.784, lr=0.01] 79%|███████▊  | 84/107 [39:33<10:35, 27.65s/epoch, loss=0.637, accuracy=0.857, val_loss=0.751, val_accuracy=0.814, lr=0.01] 79%|███████▉  | 85/107 [40:01<10:07, 27.61s/epoch, loss=0.596, accuracy=0.859, val_loss=0.987, val_accuracy=0.721, lr=0.01] 80%|████████  | 86/107 [40:28<09:39, 27.60s/epoch, loss=0.575, accuracy=0.863, val_loss=0.703, val_accuracy=0.813, lr=0.01] 81%|████████▏ | 87/107 [40:56<09:14, 27.72s/epoch, loss=0.563, accuracy=0.863, val_loss=0.788, val_accuracy=0.793, lr=0.01] 82%|████████▏ | 88/107 [41:24<08:44, 27.59s/epoch, loss=0.561, accuracy=0.863, val_loss=0.73, val_accuracy=0.806, lr=0.01]  83%|████████▎ | 89/107 [41:51<08:18, 27.67s/epoch, loss=0.557, accuracy=0.864, val_loss=0.703, val_accuracy=0.817, lr=0.01] 84%|████████▍ | 90/107 [42:19<07:49, 27.64s/epoch, loss=0.555, accuracy=0.866, val_loss=0.818, val_accuracy=0.783, lr=0.01] 85%|████████▌ | 91/107 [42:47<07:22, 27.66s/epoch, loss=0.553, accuracy=0.867, val_loss=0.719, val_accuracy=0.812, lr=0.00316] 86%|████████▌ | 92/107 [43:15<06:55, 27.71s/epoch, loss=0.553, accuracy=0.868, val_loss=0.983, val_accuracy=0.743, lr=0.01]    87%|████████▋ | 93/107 [43:43<06:29, 27.80s/epoch, loss=0.548, accuracy=0.87, val_loss=1.01, val_accuracy=0.725, lr=0.01]   88%|████████▊ | 94/107 [44:11<06:02, 27.87s/epoch, loss=0.547, accuracy=0.872, val_loss=0.808, val_accuracy=0.794, lr=0.01] 89%|████████▉ | 95/107 [44:38<05:31, 27.61s/epoch, loss=0.548, accuracy=0.872, val_loss=0.863, val_accuracy=0.772, lr=0.01] 90%|████████▉ | 96/107 [45:04<05:00, 27.36s/epoch, loss=0.545, accuracy=0.873, val_loss=0.953, val_accuracy=0.764, lr=0.00316] 91%|█████████ | 97/107 [45:31<04:32, 27.24s/epoch, loss=0.551, accuracy=0.873, val_loss=0.734, val_accuracy=0.812, lr=0.01]    92%|█████████▏| 98/107 [45:59<04:05, 27.25s/epoch, loss=0.546, accuracy=0.876, val_loss=0.743, val_accuracy=0.814, lr=0.01] 93%|█████████▎| 99/107 [46:26<03:37, 27.14s/epoch, loss=0.545, accuracy=0.876, val_loss=0.979, val_accuracy=0.754, lr=0.01] 93%|█████████▎| 100/107 [46:53<03:10, 27.26s/epoch, loss=0.544, accuracy=0.878, val_loss=0.759, val_accuracy=0.817, lr=0.01] 94%|█████████▍| 101/107 [47:20<02:43, 27.25s/epoch, loss=0.545, accuracy=0.876, val_loss=0.796, val_accuracy=0.8, lr=0.00316] 95%|█████████▌| 102/107 [47:48<02:16, 27.33s/epoch, loss=0.542, accuracy=0.879, val_loss=1.07, val_accuracy=0.722, lr=0.01]   96%|█████████▋| 103/107 [48:15<01:49, 27.36s/epoch, loss=0.542, accuracy=0.88, val_loss=0.839, val_accuracy=0.788, lr=0.01] 97%|█████████▋| 104/107 [48:43<01:22, 27.52s/epoch, loss=0.541, accuracy=0.882, val_loss=0.752, val_accuracy=0.808, lr=0.01] 98%|█████████▊| 105/107 [49:10<00:54, 27.45s/epoch, loss=0.543, accuracy=0.881, val_loss=0.886, val_accuracy=0.786, lr=0.01] 99%|█████████▉| 106/107 [49:38<00:27, 27.46s/epoch, loss=0.544, accuracy=0.881, val_loss=0.778, val_accuracy=0.802, lr=0.00316]100%|██████████| 107/107 [50:05<00:00, 27.39s/epoch, loss=0.543, accuracy=0.882, val_loss=1.2, val_accuracy=0.701, lr=0.01]     100%|██████████| 107/107 [50:05<00:00, 28.09s/epoch, loss=0.543, accuracy=0.882, val_loss=1.2, val_accuracy=0.701, lr=0.01]
Using real-time data augmentation.
Test score: 1.1964675188064575
Test accuracy: 0.7009999752044678


* * * Run SGD for ID = 14_9. * * *


2024-03-05 10:49:13.841006: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 10:49:16.333160: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 10:49:16.334517: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-05 10:49:16.376095: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-05 10:49:16.376141: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 10:49:16.379616: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 10:49:16.379682: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-05 10:49:16.382128: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-05 10:49:16.382882: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-05 10:49:16.385766: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-05 10:49:16.387631: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-05 10:49:16.393028: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 10:49:16.393701: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-05 10:49:16.393796: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 10:49:17.601795: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-05 10:49:17.602556: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 10:49:17.603694: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-05 10:49:17.603733: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 10:49:17.603772: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 10:49:17.603787: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-05 10:49:17.603800: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-05 10:49:17.603813: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-05 10:49:17.603836: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-05 10:49:17.603853: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-05 10:49:17.603869: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 10:49:17.604415: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-05 10:49:17.604450: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 10:49:18.240589: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-05 10:49:18.240650: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-05 10:49:18.240671: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-05 10:49:18.241747: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:3b:00.0, compute capability: 6.1)
{'id': '14_09', 'seed': 9, 'out_folder': 'results/epoch_budget', 'batch_size': 128, 'epochs': 107, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/107 [00:00<?, ?epoch/s]2024-03-05 10:49:19.089580: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-05 10:49:19.101998: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-03-05 10:49:21.066118: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 10:49:21.393236: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 10:49:22.325290: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-05 10:49:22.392757: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/107 [01:08<2:00:09, 68.01s/epoch, loss=2.74, accuracy=0.451, val_loss=2.7, val_accuracy=0.352, lr=0.1]  2%|▏         | 2/107 [01:35<1:17:19, 44.18s/epoch, loss=1.42, accuracy=0.633, val_loss=2.25, val_accuracy=0.384, lr=0.1]  3%|▎         | 3/107 [02:02<1:02:35, 36.11s/epoch, loss=1.29, accuracy=0.684, val_loss=1.66, val_accuracy=0.531, lr=0.1]  4%|▎         | 4/107 [02:28<55:47, 32.50s/epoch, loss=1.24, accuracy=0.707, val_loss=1.36, val_accuracy=0.668, lr=0.1]    5%|▍         | 5/107 [02:55<51:40, 30.39s/epoch, loss=1.22, accuracy=0.716, val_loss=1.73, val_accuracy=0.525, lr=0.1]  6%|▌         | 6/107 [03:22<49:06, 29.17s/epoch, loss=1.21, accuracy=0.725, val_loss=1.89, val_accuracy=0.539, lr=0.1]  7%|▋         | 7/107 [03:50<48:02, 28.82s/epoch, loss=1.19, accuracy=0.73, val_loss=2.66, val_accuracy=0.465, lr=0.1]   7%|▋         | 8/107 [04:18<46:59, 28.48s/epoch, loss=1.2, accuracy=0.732, val_loss=2.76, val_accuracy=0.347, lr=0.1]  8%|▊         | 9/107 [04:46<46:21, 28.38s/epoch, loss=1.18, accuracy=0.737, val_loss=2.17, val_accuracy=0.493, lr=0.0316]  9%|▉         | 10/107 [05:14<45:42, 28.27s/epoch, loss=1.18, accuracy=0.74, val_loss=2.04, val_accuracy=0.515, lr=0.1]    10%|█         | 11/107 [05:41<44:49, 28.01s/epoch, loss=1.18, accuracy=0.738, val_loss=2.24, val_accuracy=0.483, lr=0.1] 11%|█         | 12/107 [06:09<44:18, 27.99s/epoch, loss=1.17, accuracy=0.744, val_loss=3.48, val_accuracy=0.358, lr=0.1] 12%|█▏        | 13/107 [06:38<44:03, 28.13s/epoch, loss=1.17, accuracy=0.742, val_loss=1.63, val_accuracy=0.58, lr=0.1]  13%|█▎        | 14/107 [07:06<43:26, 28.03s/epoch, loss=1.17, accuracy=0.747, val_loss=1.92, val_accuracy=0.52, lr=0.0316] 14%|█▍        | 15/107 [07:34<43:02, 28.07s/epoch, loss=1.16, accuracy=0.748, val_loss=2.07, val_accuracy=0.461, lr=0.1]   15%|█▍        | 16/107 [08:02<42:42, 28.16s/epoch, loss=1.15, accuracy=0.749, val_loss=1.49, val_accuracy=0.637, lr=0.1] 16%|█▌        | 17/107 [08:31<42:21, 28.24s/epoch, loss=1.15, accuracy=0.748, val_loss=1.68, val_accuracy=0.573, lr=0.1] 17%|█▋        | 18/107 [08:58<41:29, 27.97s/epoch, loss=1.16, accuracy=0.748, val_loss=2.38, val_accuracy=0.49, lr=0.1]  18%|█▊        | 19/107 [09:25<40:45, 27.79s/epoch, loss=1.15, accuracy=0.749, val_loss=1.91, val_accuracy=0.5, lr=0.0316] 19%|█▊        | 20/107 [09:53<40:26, 27.89s/epoch, loss=1.14, accuracy=0.752, val_loss=1.89, val_accuracy=0.498, lr=0.1]  20%|█▉        | 21/107 [10:21<40:02, 27.93s/epoch, loss=1.14, accuracy=0.753, val_loss=3.44, val_accuracy=0.31, lr=0.1]  21%|██        | 22/107 [10:49<39:36, 27.96s/epoch, loss=1.14, accuracy=0.75, val_loss=1.61, val_accuracy=0.613, lr=0.1] 21%|██▏       | 23/107 [11:17<39:08, 27.96s/epoch, loss=1.14, accuracy=0.753, val_loss=3.99, val_accuracy=0.375, lr=0.1] 22%|██▏       | 24/107 [11:45<38:26, 27.78s/epoch, loss=1.13, accuracy=0.754, val_loss=2.65, val_accuracy=0.383, lr=0.0316] 23%|██▎       | 25/107 [12:13<38:03, 27.84s/epoch, loss=1.14, accuracy=0.75, val_loss=1.68, val_accuracy=0.527, lr=0.1]     24%|██▍       | 26/107 [12:41<37:47, 28.00s/epoch, loss=1.13, accuracy=0.753, val_loss=1.66, val_accuracy=0.577, lr=0.1] 25%|██▌       | 27/107 [13:09<37:25, 28.07s/epoch, loss=1.12, accuracy=0.756, val_loss=2.15, val_accuracy=0.465, lr=0.1] 26%|██▌       | 28/107 [13:37<36:52, 28.00s/epoch, loss=1.13, accuracy=0.755, val_loss=2.02, val_accuracy=0.518, lr=0.1] 27%|██▋       | 29/107 [14:05<36:16, 27.90s/epoch, loss=1.13, accuracy=0.752, val_loss=1.54, val_accuracy=0.612, lr=0.0316] 28%|██▊       | 30/107 [14:32<35:34, 27.72s/epoch, loss=1.13, accuracy=0.757, val_loss=2.34, val_accuracy=0.475, lr=0.1]    29%|██▉       | 31/107 [15:00<35:11, 27.78s/epoch, loss=1.12, accuracy=0.756, val_loss=1.58, val_accuracy=0.584, lr=0.1] 30%|██▉       | 32/107 [15:28<34:46, 27.82s/epoch, loss=1.12, accuracy=0.758, val_loss=2.76, val_accuracy=0.233, lr=0.1] 31%|███       | 33/107 [15:56<34:25, 27.91s/epoch, loss=1.12, accuracy=0.756, val_loss=2.56, val_accuracy=0.309, lr=0.1] 32%|███▏      | 34/107 [16:24<34:06, 28.03s/epoch, loss=1.12, accuracy=0.752, val_loss=2.07, val_accuracy=0.473, lr=0.0316] 33%|███▎      | 35/107 [16:53<33:40, 28.06s/epoch, loss=1.12, accuracy=0.758, val_loss=1.7, val_accuracy=0.554, lr=0.1]     34%|███▎      | 36/107 [17:20<33:02, 27.92s/epoch, loss=1.13, accuracy=0.755, val_loss=2.45, val_accuracy=0.494, lr=0.1] 35%|███▍      | 37/107 [17:47<32:13, 27.63s/epoch, loss=1.12, accuracy=0.756, val_loss=2.6, val_accuracy=0.421, lr=0.1]  36%|███▌      | 38/107 [18:15<31:49, 27.67s/epoch, loss=1.12, accuracy=0.757, val_loss=1.61, val_accuracy=0.583, lr=0.1] 36%|███▋      | 39/107 [18:43<31:32, 27.83s/epoch, loss=1.12, accuracy=0.76, val_loss=2.06, val_accuracy=0.484, lr=0.0316] 37%|███▋      | 40/107 [19:11<31:02, 27.80s/epoch, loss=1.12, accuracy=0.756, val_loss=1.48, val_accuracy=0.633, lr=0.1]   38%|███▊      | 41/107 [19:38<30:31, 27.74s/epoch, loss=1.12, accuracy=0.759, val_loss=1.32, val_accuracy=0.688, lr=0.1] 39%|███▉      | 42/107 [20:06<29:57, 27.65s/epoch, loss=1.12, accuracy=0.759, val_loss=4.13, val_accuracy=0.281, lr=0.1] 40%|████      | 43/107 [20:34<29:37, 27.78s/epoch, loss=1.12, accuracy=0.756, val_loss=2.11, val_accuracy=0.472, lr=0.1] 41%|████      | 44/107 [21:02<29:12, 27.82s/epoch, loss=1.12, accuracy=0.756, val_loss=3.67, val_accuracy=0.326, lr=0.1] 42%|████▏     | 45/107 [21:30<28:47, 27.87s/epoch, loss=1.12, accuracy=0.758, val_loss=2.52, val_accuracy=0.419, lr=0.1] 43%|████▎     | 46/107 [21:57<28:12, 27.74s/epoch, loss=1.11, accuracy=0.76, val_loss=2.95, val_accuracy=0.389, lr=0.0316] 44%|████▍     | 47/107 [22:26<27:56, 27.94s/epoch, loss=1.11, accuracy=0.76, val_loss=1.74, val_accuracy=0.553, lr=0.1]    45%|████▍     | 48/107 [22:53<27:22, 27.83s/epoch, loss=1.12, accuracy=0.758, val_loss=1.99, val_accuracy=0.493, lr=0.1] 46%|████▌     | 49/107 [23:21<26:49, 27.75s/epoch, loss=1.12, accuracy=0.759, val_loss=1.89, val_accuracy=0.465, lr=0.1] 47%|████▋     | 50/107 [23:49<26:26, 27.84s/epoch, loss=1.11, accuracy=0.758, val_loss=3.1, val_accuracy=0.367, lr=0.1]  48%|████▊     | 51/107 [24:17<26:05, 27.95s/epoch, loss=1.11, accuracy=0.761, val_loss=3.27, val_accuracy=0.323, lr=0.0316] 49%|████▊     | 52/107 [24:45<25:33, 27.89s/epoch, loss=1.11, accuracy=0.761, val_loss=1.88, val_accuracy=0.566, lr=0.1]    50%|████▉     | 53/107 [25:12<24:59, 27.76s/epoch, loss=1.11, accuracy=0.759, val_loss=1.64, val_accuracy=0.57, lr=0.1]  50%|█████     | 54/107 [25:40<24:32, 27.79s/epoch, loss=1.12, accuracy=0.758, val_loss=2.35, val_accuracy=0.441, lr=0.1] 51%|█████▏    | 55/107 [26:08<24:12, 27.93s/epoch, loss=1.11, accuracy=0.759, val_loss=2.32, val_accuracy=0.419, lr=0.1] 52%|█████▏    | 56/107 [26:36<23:45, 27.96s/epoch, loss=1.11, accuracy=0.761, val_loss=1.86, val_accuracy=0.511, lr=0.0316] 53%|█████▎    | 57/107 [27:04<23:09, 27.80s/epoch, loss=1.12, accuracy=0.758, val_loss=2.5, val_accuracy=0.36, lr=0.1]      54%|█████▍    | 58/107 [27:30<22:21, 27.37s/epoch, loss=1.11, accuracy=0.76, val_loss=3, val_accuracy=0.354, lr=0.1]   55%|█████▌    | 59/107 [27:57<21:52, 27.34s/epoch, loss=1.11, accuracy=0.758, val_loss=1.32, val_accuracy=0.691, lr=0.1] 56%|█████▌    | 60/107 [28:26<21:38, 27.62s/epoch, loss=1.11, accuracy=0.761, val_loss=2.97, val_accuracy=0.308, lr=0.1] 57%|█████▋    | 61/107 [28:54<21:17, 27.77s/epoch, loss=1.12, accuracy=0.756, val_loss=1.86, val_accuracy=0.534, lr=0.1] 58%|█████▊    | 62/107 [29:22<20:49, 27.76s/epoch, loss=1.11, accuracy=0.76, val_loss=1.62, val_accuracy=0.563, lr=0.1]  59%|█████▉    | 63/107 [29:48<19:57, 27.21s/epoch, loss=1.11, accuracy=0.76, val_loss=3.47, val_accuracy=0.352, lr=0.1] 60%|█████▉    | 64/107 [30:15<19:37, 27.38s/epoch, loss=1.11, accuracy=0.761, val_loss=2.9, val_accuracy=0.373, lr=0.0316] 61%|██████    | 65/107 [30:42<19:02, 27.20s/epoch, loss=1.11, accuracy=0.76, val_loss=1.94, val_accuracy=0.503, lr=0.1]    62%|██████▏   | 66/107 [31:10<18:44, 27.42s/epoch, loss=1.11, accuracy=0.758, val_loss=2.11, val_accuracy=0.414, lr=0.1] 63%|██████▎   | 67/107 [31:38<18:25, 27.63s/epoch, loss=1.12, accuracy=0.76, val_loss=4.21, val_accuracy=0.289, lr=0.1]  64%|██████▎   | 68/107 [32:05<17:54, 27.55s/epoch, loss=1.11, accuracy=0.76, val_loss=1.73, val_accuracy=0.569, lr=0.1] 64%|██████▍   | 69/107 [32:33<17:23, 27.45s/epoch, loss=1.11, accuracy=0.757, val_loss=4.92, val_accuracy=0.293, lr=0.0316] 65%|██████▌   | 70/107 [33:00<16:58, 27.54s/epoch, loss=1.11, accuracy=0.761, val_loss=2.59, val_accuracy=0.48, lr=0.1]     66%|██████▋   | 71/107 [33:28<16:33, 27.59s/epoch, loss=1.11, accuracy=0.761, val_loss=2.21, val_accuracy=0.449, lr=0.1] 67%|██████▋   | 72/107 [33:56<16:06, 27.61s/epoch, loss=1.12, accuracy=0.759, val_loss=2.15, val_accuracy=0.41, lr=0.1]  68%|██████▊   | 73/107 [34:24<15:42, 27.72s/epoch, loss=1.12, accuracy=0.759, val_loss=1.45, val_accuracy=0.662, lr=0.1] 69%|██████▉   | 74/107 [34:50<15:04, 27.40s/epoch, loss=1.11, accuracy=0.762, val_loss=1.69, val_accuracy=0.561, lr=0.0316] 70%|███████   | 75/107 [35:17<14:27, 27.10s/epoch, loss=1.11, accuracy=0.762, val_loss=6.64, val_accuracy=0.162, lr=0.1]    71%|███████   | 76/107 [35:44<13:59, 27.07s/epoch, loss=1.11, accuracy=0.761, val_loss=2.48, val_accuracy=0.384, lr=0.1] 72%|███████▏  | 77/107 [36:12<13:42, 27.42s/epoch, loss=1.11, accuracy=0.761, val_loss=4.78, val_accuracy=0.252, lr=0.1] 73%|███████▎  | 78/107 [36:40<13:20, 27.60s/epoch, loss=1.11, accuracy=0.76, val_loss=1.64, val_accuracy=0.614, lr=0.1]  74%|███████▍  | 79/107 [37:08<12:51, 27.56s/epoch, loss=1.11, accuracy=0.762, val_loss=3, val_accuracy=0.392, lr=0.0316] 75%|███████▍  | 80/107 [37:34<12:13, 27.15s/epoch, loss=1.11, accuracy=0.761, val_loss=4, val_accuracy=0.32, lr=0.1]     76%|███████▌  | 81/107 [38:01<11:43, 27.05s/epoch, loss=1.11, accuracy=0.76, val_loss=2.19, val_accuracy=0.443, lr=0.1] 77%|███████▋  | 82/107 [38:27<11:12, 26.89s/epoch, loss=0.898, accuracy=0.822, val_loss=0.854, val_accuracy=0.82, lr=0.01] 78%|███████▊  | 83/107 [38:55<10:50, 27.08s/epoch, loss=0.723, accuracy=0.851, val_loss=0.834, val_accuracy=0.8, lr=0.01]  79%|███████▊  | 84/107 [39:22<10:24, 27.15s/epoch, loss=0.641, accuracy=0.858, val_loss=0.691, val_accuracy=0.838, lr=0.01] 79%|███████▉  | 85/107 [39:50<10:01, 27.33s/epoch, loss=0.597, accuracy=0.864, val_loss=0.753, val_accuracy=0.808, lr=0.01] 80%|████████  | 86/107 [40:18<09:37, 27.50s/epoch, loss=0.573, accuracy=0.865, val_loss=0.744, val_accuracy=0.804, lr=0.01] 81%|████████▏ | 87/107 [40:45<09:09, 27.45s/epoch, loss=0.562, accuracy=0.867, val_loss=1.58, val_accuracy=0.595, lr=0.01]  82%|████████▏ | 88/107 [41:13<08:44, 27.59s/epoch, loss=0.558, accuracy=0.866, val_loss=1.44, val_accuracy=0.653, lr=0.01] 83%|████████▎ | 89/107 [41:40<08:15, 27.52s/epoch, loss=0.557, accuracy=0.868, val_loss=0.703, val_accuracy=0.819, lr=0.00316] 84%|████████▍ | 90/107 [42:08<07:49, 27.63s/epoch, loss=0.552, accuracy=0.869, val_loss=0.824, val_accuracy=0.778, lr=0.01]    85%|████████▌ | 91/107 [42:36<07:22, 27.65s/epoch, loss=0.549, accuracy=0.871, val_loss=0.783, val_accuracy=0.798, lr=0.01] 86%|████████▌ | 92/107 [43:04<06:55, 27.69s/epoch, loss=0.549, accuracy=0.872, val_loss=1.28, val_accuracy=0.648, lr=0.01]  87%|████████▋ | 93/107 [43:31<06:25, 27.54s/epoch, loss=0.548, accuracy=0.874, val_loss=1.37, val_accuracy=0.649, lr=0.01] 88%|████████▊ | 94/107 [43:59<05:59, 27.62s/epoch, loss=0.548, accuracy=0.876, val_loss=0.716, val_accuracy=0.825, lr=0.00316] 89%|████████▉ | 95/107 [44:26<05:31, 27.65s/epoch, loss=0.545, accuracy=0.877, val_loss=1.04, val_accuracy=0.732, lr=0.01]     90%|████████▉ | 96/107 [44:53<05:00, 27.28s/epoch, loss=0.546, accuracy=0.878, val_loss=0.897, val_accuracy=0.767, lr=0.01] 91%|█████████ | 97/107 [45:20<04:33, 27.34s/epoch, loss=0.539, accuracy=0.88, val_loss=0.794, val_accuracy=0.795, lr=0.01]  92%|█████████▏| 98/107 [45:47<04:05, 27.28s/epoch, loss=0.542, accuracy=0.88, val_loss=1.06, val_accuracy=0.75, lr=0.01]   93%|█████████▎| 99/107 [46:14<03:36, 27.09s/epoch, loss=0.54, accuracy=0.882, val_loss=0.856, val_accuracy=0.779, lr=0.00316] 93%|█████████▎| 100/107 [46:41<03:08, 26.96s/epoch, loss=0.543, accuracy=0.88, val_loss=0.996, val_accuracy=0.753, lr=0.01]   94%|█████████▍| 101/107 [47:08<02:42, 27.02s/epoch, loss=0.541, accuracy=0.882, val_loss=0.968, val_accuracy=0.75, lr=0.01] 95%|█████████▌| 102/107 [47:36<02:16, 27.27s/epoch, loss=0.541, accuracy=0.882, val_loss=0.74, val_accuracy=0.829, lr=0.01] 96%|█████████▋| 103/107 [48:03<01:49, 27.28s/epoch, loss=0.545, accuracy=0.881, val_loss=0.782, val_accuracy=0.806, lr=0.01] 97%|█████████▋| 104/107 [48:31<01:22, 27.44s/epoch, loss=0.542, accuracy=0.884, val_loss=0.755, val_accuracy=0.816, lr=0.00316] 98%|█████████▊| 105/107 [48:57<00:54, 27.20s/epoch, loss=0.546, accuracy=0.883, val_loss=0.916, val_accuracy=0.77, lr=0.01]     99%|█████████▉| 106/107 [49:25<00:27, 27.35s/epoch, loss=0.543, accuracy=0.883, val_loss=0.914, val_accuracy=0.774, lr=0.01]100%|██████████| 107/107 [49:53<00:00, 27.45s/epoch, loss=0.539, accuracy=0.884, val_loss=0.838, val_accuracy=0.802, lr=0.01]100%|██████████| 107/107 [49:53<00:00, 27.97s/epoch, loss=0.539, accuracy=0.884, val_loss=0.838, val_accuracy=0.802, lr=0.01]
Using real-time data augmentation.
Test score: 0.8383481502532959
Test accuracy: 0.8019999861717224


* * * Run SGD for ID = 14_10. * * *


2024-03-05 11:39:16.407848: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 11:39:19.048895: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 11:39:19.050072: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-05 11:39:19.092315: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-05 11:39:19.092358: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 11:39:19.095960: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 11:39:19.096027: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-05 11:39:19.098850: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-05 11:39:19.100473: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-05 11:39:19.103450: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-05 11:39:19.105066: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-05 11:39:19.110546: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 11:39:19.111209: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-05 11:39:19.111292: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 11:39:20.297296: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-05 11:39:20.298370: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 11:39:20.299570: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-05 11:39:20.299608: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 11:39:20.299646: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 11:39:20.299662: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-05 11:39:20.299676: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-05 11:39:20.299690: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-05 11:39:20.299706: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-05 11:39:20.299722: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-05 11:39:20.299738: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 11:39:20.300324: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-05 11:39:20.300386: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 11:39:20.920073: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-05 11:39:20.920127: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-05 11:39:20.920138: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-05 11:39:20.921405: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:3b:00.0, compute capability: 6.1)
{'id': '14_10', 'seed': 10, 'out_folder': 'results/epoch_budget', 'batch_size': 128, 'epochs': 107, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/107 [00:00<?, ?epoch/s]2024-03-05 11:39:21.762912: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-05 11:39:21.775004: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-03-05 11:39:23.710724: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 11:39:24.018677: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 11:39:24.914891: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-05 11:39:24.959353: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/107 [01:01<1:49:24, 61.93s/epoch, loss=2.99, accuracy=0.337, val_loss=2.23, val_accuracy=0.291, lr=0.1]  2%|▏         | 2/107 [01:29<1:13:18, 41.89s/epoch, loss=1.53, accuracy=0.548, val_loss=2.06, val_accuracy=0.384, lr=0.1]  3%|▎         | 3/107 [01:57<1:01:32, 35.51s/epoch, loss=1.34, accuracy=0.649, val_loss=1.85, val_accuracy=0.478, lr=0.1]  4%|▎         | 4/107 [02:25<55:38, 32.41s/epoch, loss=1.28, accuracy=0.685, val_loss=2.14, val_accuracy=0.431, lr=0.1]    5%|▍         | 5/107 [02:53<52:14, 30.73s/epoch, loss=1.25, accuracy=0.703, val_loss=2.69, val_accuracy=0.322, lr=0.1]  6%|▌         | 6/107 [03:20<49:47, 29.58s/epoch, loss=1.24, accuracy=0.713, val_loss=1.64, val_accuracy=0.581, lr=0.1]  7%|▋         | 7/107 [03:48<48:28, 29.09s/epoch, loss=1.22, accuracy=0.721, val_loss=1.91, val_accuracy=0.489, lr=0.1]  7%|▋         | 8/107 [04:16<47:35, 28.84s/epoch, loss=1.21, accuracy=0.726, val_loss=3.96, val_accuracy=0.303, lr=0.1]  8%|▊         | 9/107 [04:45<46:57, 28.75s/epoch, loss=1.2, accuracy=0.733, val_loss=1.58, val_accuracy=0.599, lr=0.1]   9%|▉         | 10/107 [05:13<46:21, 28.68s/epoch, loss=1.2, accuracy=0.734, val_loss=1.85, val_accuracy=0.562, lr=0.1] 10%|█         | 11/107 [05:41<45:28, 28.42s/epoch, loss=1.19, accuracy=0.737, val_loss=1.76, val_accuracy=0.524, lr=0.1] 11%|█         | 12/107 [06:09<44:33, 28.14s/epoch, loss=1.18, accuracy=0.74, val_loss=1.35, val_accuracy=0.668, lr=0.1]  12%|█▏        | 13/107 [06:36<43:40, 27.88s/epoch, loss=1.18, accuracy=0.739, val_loss=1.65, val_accuracy=0.58, lr=0.1] 13%|█▎        | 14/107 [07:03<42:53, 27.67s/epoch, loss=1.18, accuracy=0.74, val_loss=1.6, val_accuracy=0.601, lr=0.1]  14%|█▍        | 15/107 [07:31<42:34, 27.77s/epoch, loss=1.17, accuracy=0.742, val_loss=1.65, val_accuracy=0.589, lr=0.1] 15%|█▍        | 16/107 [07:59<42:05, 27.76s/epoch, loss=1.16, accuracy=0.742, val_loss=2.24, val_accuracy=0.421, lr=0.1] 16%|█▌        | 17/107 [08:28<41:59, 28.00s/epoch, loss=1.16, accuracy=0.744, val_loss=2.15, val_accuracy=0.538, lr=0.0316] 17%|█▋        | 18/107 [08:56<41:44, 28.14s/epoch, loss=1.16, accuracy=0.747, val_loss=1.66, val_accuracy=0.556, lr=0.1]    18%|█▊        | 19/107 [09:23<40:53, 27.89s/epoch, loss=1.16, accuracy=0.746, val_loss=3.42, val_accuracy=0.393, lr=0.1] 19%|█▊        | 20/107 [09:51<40:15, 27.76s/epoch, loss=1.16, accuracy=0.747, val_loss=4.73, val_accuracy=0.278, lr=0.1] 20%|█▉        | 21/107 [10:18<39:44, 27.73s/epoch, loss=1.16, accuracy=0.748, val_loss=1.6, val_accuracy=0.598, lr=0.1]  21%|██        | 22/107 [10:46<39:05, 27.60s/epoch, loss=1.15, accuracy=0.749, val_loss=2.54, val_accuracy=0.464, lr=0.0316] 21%|██▏       | 23/107 [11:13<38:33, 27.54s/epoch, loss=1.15, accuracy=0.75, val_loss=1.64, val_accuracy=0.578, lr=0.1]     22%|██▏       | 24/107 [11:40<38:02, 27.50s/epoch, loss=1.14, accuracy=0.752, val_loss=1.68, val_accuracy=0.578, lr=0.1] 23%|██▎       | 25/107 [12:08<37:30, 27.44s/epoch, loss=1.15, accuracy=0.751, val_loss=2.97, val_accuracy=0.386, lr=0.1] 24%|██▍       | 26/107 [12:35<37:05, 27.47s/epoch, loss=1.14, accuracy=0.752, val_loss=1.81, val_accuracy=0.561, lr=0.1] 25%|██▌       | 27/107 [13:03<36:38, 27.48s/epoch, loss=1.14, accuracy=0.755, val_loss=2.39, val_accuracy=0.493, lr=0.0316] 26%|██▌       | 28/107 [13:31<36:15, 27.54s/epoch, loss=1.14, accuracy=0.75, val_loss=3.55, val_accuracy=0.299, lr=0.1]     27%|██▋       | 29/107 [13:58<35:53, 27.61s/epoch, loss=1.14, accuracy=0.752, val_loss=2.15, val_accuracy=0.466, lr=0.1] 28%|██▊       | 30/107 [14:26<35:26, 27.62s/epoch, loss=1.14, accuracy=0.751, val_loss=2.35, val_accuracy=0.472, lr=0.1] 29%|██▉       | 31/107 [14:53<34:56, 27.59s/epoch, loss=1.14, accuracy=0.752, val_loss=1.67, val_accuracy=0.567, lr=0.1] 30%|██▉       | 32/107 [15:21<34:30, 27.60s/epoch, loss=1.14, accuracy=0.752, val_loss=2.16, val_accuracy=0.499, lr=0.0316] 31%|███       | 33/107 [15:49<34:03, 27.62s/epoch, loss=1.14, accuracy=0.756, val_loss=2.08, val_accuracy=0.544, lr=0.1]    32%|███▏      | 34/107 [16:16<33:31, 27.55s/epoch, loss=1.14, accuracy=0.756, val_loss=1.56, val_accuracy=0.599, lr=0.1] 33%|███▎      | 35/107 [16:44<33:07, 27.61s/epoch, loss=1.14, accuracy=0.753, val_loss=1.98, val_accuracy=0.499, lr=0.1] 34%|███▎      | 36/107 [17:11<32:35, 27.55s/epoch, loss=1.14, accuracy=0.754, val_loss=1.49, val_accuracy=0.636, lr=0.1] 35%|███▍      | 37/107 [17:39<32:20, 27.72s/epoch, loss=1.13, accuracy=0.754, val_loss=1.66, val_accuracy=0.564, lr=0.0316] 36%|███▌      | 38/107 [18:07<31:47, 27.64s/epoch, loss=1.13, accuracy=0.754, val_loss=1.89, val_accuracy=0.529, lr=0.1]    36%|███▋      | 39/107 [18:34<31:11, 27.52s/epoch, loss=1.14, accuracy=0.755, val_loss=1.52, val_accuracy=0.622, lr=0.1] 37%|███▋      | 40/107 [19:02<31:00, 27.78s/epoch, loss=1.12, accuracy=0.754, val_loss=2.48, val_accuracy=0.308, lr=0.1] 38%|███▊      | 41/107 [19:31<30:44, 27.94s/epoch, loss=1.13, accuracy=0.755, val_loss=2.01, val_accuracy=0.438, lr=0.1] 39%|███▉      | 42/107 [19:59<30:25, 28.09s/epoch, loss=1.13, accuracy=0.756, val_loss=1.91, val_accuracy=0.502, lr=0.0316] 40%|████      | 43/107 [20:27<29:50, 27.98s/epoch, loss=1.13, accuracy=0.754, val_loss=1.66, val_accuracy=0.576, lr=0.1]    41%|████      | 44/107 [20:55<29:28, 28.07s/epoch, loss=1.13, accuracy=0.755, val_loss=2.24, val_accuracy=0.458, lr=0.1] 42%|████▏     | 45/107 [21:23<28:56, 28.02s/epoch, loss=1.13, accuracy=0.757, val_loss=1.99, val_accuracy=0.543, lr=0.1] 43%|████▎     | 46/107 [21:51<28:29, 28.02s/epoch, loss=1.13, accuracy=0.753, val_loss=1.64, val_accuracy=0.6, lr=0.1]   44%|████▍     | 47/107 [22:20<28:09, 28.16s/epoch, loss=1.13, accuracy=0.758, val_loss=2.29, val_accuracy=0.451, lr=0.0316] 45%|████▍     | 48/107 [22:48<27:37, 28.10s/epoch, loss=1.12, accuracy=0.756, val_loss=1.5, val_accuracy=0.628, lr=0.1]     46%|████▌     | 49/107 [23:16<27:06, 28.04s/epoch, loss=1.13, accuracy=0.756, val_loss=1.61, val_accuracy=0.593, lr=0.1] 47%|████▋     | 50/107 [23:42<26:13, 27.61s/epoch, loss=1.13, accuracy=0.758, val_loss=2.88, val_accuracy=0.312, lr=0.1] 48%|████▊     | 51/107 [24:09<25:26, 27.26s/epoch, loss=1.13, accuracy=0.758, val_loss=2.04, val_accuracy=0.547, lr=0.1] 49%|████▊     | 52/107 [24:37<25:12, 27.50s/epoch, loss=1.13, accuracy=0.757, val_loss=1.7, val_accuracy=0.581, lr=0.0316] 50%|████▉     | 53/107 [25:05<24:55, 27.70s/epoch, loss=1.13, accuracy=0.758, val_loss=1.92, val_accuracy=0.552, lr=0.1]   50%|█████     | 54/107 [25:32<24:25, 27.64s/epoch, loss=1.12, accuracy=0.757, val_loss=1.73, val_accuracy=0.599, lr=0.1] 51%|█████▏    | 55/107 [26:00<24:04, 27.77s/epoch, loss=1.13, accuracy=0.755, val_loss=1.96, val_accuracy=0.578, lr=0.1] 52%|█████▏    | 56/107 [26:28<23:37, 27.80s/epoch, loss=1.12, accuracy=0.759, val_loss=1.48, val_accuracy=0.645, lr=0.1] 53%|█████▎    | 57/107 [26:56<23:09, 27.79s/epoch, loss=1.12, accuracy=0.755, val_loss=2.16, val_accuracy=0.474, lr=0.0316] 54%|█████▍    | 58/107 [27:24<22:41, 27.79s/epoch, loss=1.13, accuracy=0.757, val_loss=2.45, val_accuracy=0.431, lr=0.1]    55%|█████▌    | 59/107 [27:52<22:15, 27.81s/epoch, loss=1.13, accuracy=0.757, val_loss=2.87, val_accuracy=0.339, lr=0.1] 56%|█████▌    | 60/107 [28:20<21:51, 27.90s/epoch, loss=1.13, accuracy=0.756, val_loss=2.07, val_accuracy=0.539, lr=0.1] 57%|█████▋    | 61/107 [28:47<21:16, 27.76s/epoch, loss=1.12, accuracy=0.758, val_loss=2.53, val_accuracy=0.448, lr=0.1] 58%|█████▊    | 62/107 [29:14<20:36, 27.48s/epoch, loss=1.12, accuracy=0.758, val_loss=4.04, val_accuracy=0.317, lr=0.0316] 59%|█████▉    | 63/107 [29:41<20:06, 27.42s/epoch, loss=1.13, accuracy=0.757, val_loss=1.82, val_accuracy=0.523, lr=0.1]    60%|█████▉    | 64/107 [30:09<19:47, 27.62s/epoch, loss=1.12, accuracy=0.758, val_loss=2.25, val_accuracy=0.413, lr=0.1] 61%|██████    | 65/107 [30:37<19:18, 27.58s/epoch, loss=1.13, accuracy=0.757, val_loss=2.37, val_accuracy=0.424, lr=0.1] 62%|██████▏   | 66/107 [31:04<18:49, 27.54s/epoch, loss=1.13, accuracy=0.756, val_loss=1.98, val_accuracy=0.435, lr=0.1] 63%|██████▎   | 67/107 [31:32<18:25, 27.64s/epoch, loss=1.12, accuracy=0.759, val_loss=3.78, val_accuracy=0.405, lr=0.0316] 64%|██████▎   | 68/107 [32:00<18:01, 27.74s/epoch, loss=1.12, accuracy=0.758, val_loss=2.46, val_accuracy=0.397, lr=0.1]    64%|██████▍   | 69/107 [32:27<17:27, 27.57s/epoch, loss=1.12, accuracy=0.76, val_loss=2.49, val_accuracy=0.443, lr=0.1]  65%|██████▌   | 70/107 [32:55<17:05, 27.72s/epoch, loss=1.12, accuracy=0.757, val_loss=1.51, val_accuracy=0.636, lr=0.1] 66%|██████▋   | 71/107 [33:22<16:30, 27.53s/epoch, loss=1.12, accuracy=0.757, val_loss=1.86, val_accuracy=0.521, lr=0.1] 67%|██████▋   | 72/107 [33:50<16:06, 27.62s/epoch, loss=1.12, accuracy=0.759, val_loss=4.19, val_accuracy=0.284, lr=0.0316] 68%|██████▊   | 73/107 [34:18<15:39, 27.65s/epoch, loss=1.12, accuracy=0.76, val_loss=1.73, val_accuracy=0.562, lr=0.1]     69%|██████▉   | 74/107 [34:45<15:09, 27.56s/epoch, loss=1.12, accuracy=0.758, val_loss=2.31, val_accuracy=0.482, lr=0.1] 70%|███████   | 75/107 [35:13<14:41, 27.56s/epoch, loss=1.11, accuracy=0.759, val_loss=1.96, val_accuracy=0.509, lr=0.1] 71%|███████   | 76/107 [35:41<14:15, 27.61s/epoch, loss=1.11, accuracy=0.759, val_loss=2.62, val_accuracy=0.315, lr=0.1] 72%|███████▏  | 77/107 [36:08<13:49, 27.65s/epoch, loss=1.12, accuracy=0.759, val_loss=4.6, val_accuracy=0.233, lr=0.0316] 73%|███████▎  | 78/107 [36:36<13:18, 27.52s/epoch, loss=1.12, accuracy=0.758, val_loss=3.75, val_accuracy=0.323, lr=0.1]   74%|███████▍  | 79/107 [37:03<12:51, 27.55s/epoch, loss=1.12, accuracy=0.758, val_loss=1.54, val_accuracy=0.59, lr=0.1]  75%|███████▍  | 80/107 [37:31<12:25, 27.62s/epoch, loss=1.12, accuracy=0.758, val_loss=2.79, val_accuracy=0.47, lr=0.1] 76%|███████▌  | 81/107 [37:58<11:56, 27.56s/epoch, loss=1.12, accuracy=0.757, val_loss=1.65, val_accuracy=0.574, lr=0.1] 77%|███████▋  | 82/107 [38:26<11:32, 27.70s/epoch, loss=0.912, accuracy=0.817, val_loss=0.939, val_accuracy=0.789, lr=0.01] 78%|███████▊  | 83/107 [38:54<11:05, 27.75s/epoch, loss=0.73, accuracy=0.85, val_loss=0.78, val_accuracy=0.821, lr=0.01]    79%|███████▊  | 84/107 [39:22<10:37, 27.70s/epoch, loss=0.649, accuracy=0.859, val_loss=0.748, val_accuracy=0.817, lr=0.01] 79%|███████▉  | 85/107 [39:50<10:11, 27.78s/epoch, loss=0.601, accuracy=0.863, val_loss=0.826, val_accuracy=0.788, lr=0.01] 80%|████████  | 86/107 [40:17<09:40, 27.66s/epoch, loss=0.583, accuracy=0.862, val_loss=0.757, val_accuracy=0.798, lr=0.01] 81%|████████▏ | 87/107 [40:45<09:13, 27.66s/epoch, loss=0.568, accuracy=0.863, val_loss=0.754, val_accuracy=0.802, lr=0.01] 82%|████████▏ | 88/107 [41:13<08:45, 27.68s/epoch, loss=0.567, accuracy=0.863, val_loss=0.691, val_accuracy=0.82, lr=0.01]  83%|████████▎ | 89/107 [41:39<08:11, 27.28s/epoch, loss=0.564, accuracy=0.865, val_loss=0.83, val_accuracy=0.782, lr=0.01] 84%|████████▍ | 90/107 [42:06<07:44, 27.30s/epoch, loss=0.559, accuracy=0.869, val_loss=0.688, val_accuracy=0.827, lr=0.01] 85%|████████▌ | 91/107 [42:34<07:17, 27.34s/epoch, loss=0.557, accuracy=0.869, val_loss=0.867, val_accuracy=0.787, lr=0.01] 86%|████████▌ | 92/107 [43:01<06:50, 27.39s/epoch, loss=0.551, accuracy=0.871, val_loss=0.754, val_accuracy=0.803, lr=0.01] 87%|████████▋ | 93/107 [43:29<06:24, 27.46s/epoch, loss=0.555, accuracy=0.871, val_loss=0.815, val_accuracy=0.802, lr=0.01] 88%|████████▊ | 94/107 [43:57<05:58, 27.59s/epoch, loss=0.552, accuracy=0.874, val_loss=0.882, val_accuracy=0.783, lr=0.01] 89%|████████▉ | 95/107 [44:24<05:31, 27.62s/epoch, loss=0.552, accuracy=0.873, val_loss=0.794, val_accuracy=0.803, lr=0.00316] 90%|████████▉ | 96/107 [44:51<04:59, 27.25s/epoch, loss=0.554, accuracy=0.874, val_loss=0.85, val_accuracy=0.778, lr=0.01]     91%|█████████ | 97/107 [45:18<04:33, 27.31s/epoch, loss=0.552, accuracy=0.874, val_loss=0.926, val_accuracy=0.78, lr=0.01] 92%|█████████▏| 98/107 [45:46<04:06, 27.38s/epoch, loss=0.55, accuracy=0.877, val_loss=0.862, val_accuracy=0.778, lr=0.01] 93%|█████████▎| 99/107 [46:14<03:39, 27.47s/epoch, loss=0.55, accuracy=0.877, val_loss=0.877, val_accuracy=0.784, lr=0.01] 93%|█████████▎| 100/107 [46:41<03:11, 27.39s/epoch, loss=0.554, accuracy=0.876, val_loss=0.937, val_accuracy=0.766, lr=0.00316] 94%|█████████▍| 101/107 [47:07<02:42, 27.13s/epoch, loss=0.55, accuracy=0.877, val_loss=0.722, val_accuracy=0.827, lr=0.01]     95%|█████████▌| 102/107 [47:35<02:16, 27.20s/epoch, loss=0.55, accuracy=0.878, val_loss=0.914, val_accuracy=0.77, lr=0.01]  96%|█████████▋| 103/107 [48:02<01:48, 27.11s/epoch, loss=0.55, accuracy=0.879, val_loss=0.831, val_accuracy=0.788, lr=0.01] 97%|█████████▋| 104/107 [48:29<01:21, 27.18s/epoch, loss=0.551, accuracy=0.88, val_loss=2.31, val_accuracy=0.545, lr=0.01]  98%|█████████▊| 105/107 [48:56<00:54, 27.12s/epoch, loss=0.548, accuracy=0.882, val_loss=0.869, val_accuracy=0.791, lr=0.00316] 99%|█████████▉| 106/107 [49:23<00:27, 27.24s/epoch, loss=0.546, accuracy=0.882, val_loss=0.703, val_accuracy=0.83, lr=0.01]    100%|██████████| 107/107 [49:51<00:00, 27.25s/epoch, loss=0.552, accuracy=0.881, val_loss=1.1, val_accuracy=0.731, lr=0.01] 100%|██████████| 107/107 [49:51<00:00, 27.95s/epoch, loss=0.552, accuracy=0.881, val_loss=1.1, val_accuracy=0.731, lr=0.01]
Using real-time data augmentation.
Test score: 1.1006040573120117
Test accuracy: 0.7311999797821045


* * * Run SGD for ID = 14_11. * * *


2024-03-05 12:29:16.632365: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 12:29:19.399125: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 12:29:19.400406: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-05 12:29:19.440612: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-05 12:29:19.440655: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 12:29:19.444283: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 12:29:19.444354: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-05 12:29:19.447065: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-05 12:29:19.448219: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-05 12:29:19.451272: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-05 12:29:19.453068: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-05 12:29:19.458818: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 12:29:19.459492: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-05 12:29:19.459573: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 12:29:20.676499: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-05 12:29:20.677208: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 12:29:20.678337: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-05 12:29:20.678372: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 12:29:20.678411: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 12:29:20.678427: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-05 12:29:20.678440: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-05 12:29:20.678462: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-05 12:29:20.678478: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-05 12:29:20.678494: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-05 12:29:20.678510: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 12:29:20.679097: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-05 12:29:20.679137: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 12:29:21.312425: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-05 12:29:21.312476: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-05 12:29:21.312487: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-05 12:29:21.313586: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:3b:00.0, compute capability: 6.1)
{'id': '14_11', 'seed': 11, 'out_folder': 'results/epoch_budget', 'batch_size': 128, 'epochs': 107, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/107 [00:00<?, ?epoch/s]2024-03-05 12:29:22.155308: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-05 12:29:22.168005: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-03-05 12:29:24.092435: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 12:29:24.354244: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 12:29:25.312124: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-05 12:29:25.356870: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/107 [01:02<1:51:07, 62.90s/epoch, loss=2.7, accuracy=0.449, val_loss=3.35, val_accuracy=0.249, lr=0.1]  2%|▏         | 2/107 [01:29<1:12:48, 41.60s/epoch, loss=1.43, accuracy=0.627, val_loss=1.94, val_accuracy=0.512, lr=0.1]  3%|▎         | 3/107 [01:56<1:00:21, 34.82s/epoch, loss=1.3, accuracy=0.678, val_loss=1.92, val_accuracy=0.544, lr=0.1]   4%|▎         | 4/107 [02:22<54:09, 31.55s/epoch, loss=1.27, accuracy=0.698, val_loss=1.7, val_accuracy=0.528, lr=0.1]    5%|▍         | 5/107 [02:49<50:37, 29.78s/epoch, loss=1.25, accuracy=0.709, val_loss=1.82, val_accuracy=0.518, lr=0.1]  6%|▌         | 6/107 [03:16<48:30, 28.81s/epoch, loss=1.22, accuracy=0.718, val_loss=3.02, val_accuracy=0.337, lr=0.1]  7%|▋         | 7/107 [03:42<46:36, 27.97s/epoch, loss=1.22, accuracy=0.72, val_loss=2.05, val_accuracy=0.557, lr=0.1]   7%|▋         | 8/107 [04:09<45:42, 27.71s/epoch, loss=1.21, accuracy=0.726, val_loss=1.84, val_accuracy=0.559, lr=0.1]  8%|▊         | 9/107 [04:36<44:34, 27.29s/epoch, loss=1.2, accuracy=0.731, val_loss=2.28, val_accuracy=0.498, lr=0.0316]  9%|▉         | 10/107 [05:02<43:46, 27.08s/epoch, loss=1.19, accuracy=0.737, val_loss=1.41, val_accuracy=0.644, lr=0.1]  10%|█         | 11/107 [05:29<42:54, 26.82s/epoch, loss=1.19, accuracy=0.732, val_loss=1.99, val_accuracy=0.518, lr=0.1] 11%|█         | 12/107 [05:56<42:35, 26.90s/epoch, loss=1.19, accuracy=0.735, val_loss=1.77, val_accuracy=0.564, lr=0.1] 12%|█▏        | 13/107 [06:23<42:09, 26.91s/epoch, loss=1.18, accuracy=0.738, val_loss=8.67, val_accuracy=0.174, lr=0.1] 13%|█▎        | 14/107 [06:49<41:32, 26.80s/epoch, loss=1.18, accuracy=0.739, val_loss=1.82, val_accuracy=0.528, lr=0.1] 14%|█▍        | 15/107 [07:17<41:24, 27.01s/epoch, loss=1.18, accuracy=0.74, val_loss=2.1, val_accuracy=0.462, lr=0.0316] 15%|█▍        | 16/107 [07:43<40:44, 26.86s/epoch, loss=1.18, accuracy=0.743, val_loss=2.07, val_accuracy=0.47, lr=0.1]   16%|█▌        | 17/107 [08:10<40:08, 26.76s/epoch, loss=1.17, accuracy=0.743, val_loss=2.31, val_accuracy=0.481, lr=0.1] 17%|█▋        | 18/107 [08:37<39:48, 26.83s/epoch, loss=1.18, accuracy=0.743, val_loss=2.27, val_accuracy=0.38, lr=0.1]  18%|█▊        | 19/107 [09:03<39:09, 26.70s/epoch, loss=1.17, accuracy=0.743, val_loss=1.55, val_accuracy=0.625, lr=0.1] 19%|█▊        | 20/107 [09:30<38:52, 26.82s/epoch, loss=1.17, accuracy=0.744, val_loss=2.56, val_accuracy=0.426, lr=0.0316] 20%|█▉        | 21/107 [09:57<38:20, 26.75s/epoch, loss=1.17, accuracy=0.747, val_loss=1.65, val_accuracy=0.567, lr=0.1]    21%|██        | 22/107 [10:24<38:08, 26.93s/epoch, loss=1.17, accuracy=0.745, val_loss=2.15, val_accuracy=0.494, lr=0.1] 21%|██▏       | 23/107 [10:51<37:40, 26.91s/epoch, loss=1.18, accuracy=0.744, val_loss=1.58, val_accuracy=0.61, lr=0.1]  22%|██▏       | 24/107 [11:19<37:51, 27.37s/epoch, loss=1.16, accuracy=0.747, val_loss=1.61, val_accuracy=0.6, lr=0.1]  23%|██▎       | 25/107 [11:47<37:40, 27.57s/epoch, loss=1.16, accuracy=0.748, val_loss=1.67, val_accuracy=0.618, lr=0.0316] 24%|██▍       | 26/107 [12:15<37:21, 27.67s/epoch, loss=1.16, accuracy=0.747, val_loss=1.91, val_accuracy=0.552, lr=0.1]    25%|██▌       | 27/107 [12:43<37:03, 27.80s/epoch, loss=1.16, accuracy=0.749, val_loss=1.61, val_accuracy=0.581, lr=0.1] 26%|██▌       | 28/107 [13:12<36:45, 27.92s/epoch, loss=1.16, accuracy=0.75, val_loss=1.54, val_accuracy=0.596, lr=0.1]  27%|██▋       | 29/107 [13:39<36:05, 27.76s/epoch, loss=1.16, accuracy=0.749, val_loss=1.92, val_accuracy=0.581, lr=0.1] 28%|██▊       | 30/107 [14:07<35:45, 27.87s/epoch, loss=1.16, accuracy=0.751, val_loss=1.56, val_accuracy=0.616, lr=0.0316] 29%|██▉       | 31/107 [14:35<35:19, 27.89s/epoch, loss=1.16, accuracy=0.751, val_loss=1.72, val_accuracy=0.571, lr=0.1]    30%|██▉       | 32/107 [15:03<34:54, 27.93s/epoch, loss=1.16, accuracy=0.749, val_loss=2.96, val_accuracy=0.373, lr=0.1] 31%|███       | 33/107 [15:30<34:13, 27.75s/epoch, loss=1.14, accuracy=0.753, val_loss=2.38, val_accuracy=0.463, lr=0.1] 32%|███▏      | 34/107 [15:58<33:42, 27.70s/epoch, loss=1.15, accuracy=0.75, val_loss=2.29, val_accuracy=0.52, lr=0.1]   33%|███▎      | 35/107 [16:26<33:26, 27.86s/epoch, loss=1.15, accuracy=0.75, val_loss=1.63, val_accuracy=0.588, lr=0.0316] 34%|███▎      | 36/107 [16:55<33:10, 28.04s/epoch, loss=1.15, accuracy=0.751, val_loss=2.68, val_accuracy=0.423, lr=0.1]   35%|███▍      | 37/107 [17:23<32:56, 28.24s/epoch, loss=1.15, accuracy=0.752, val_loss=2.61, val_accuracy=0.407, lr=0.1] 36%|███▌      | 38/107 [17:50<32:02, 27.86s/epoch, loss=1.15, accuracy=0.749, val_loss=1.54, val_accuracy=0.603, lr=0.1] 36%|███▋      | 39/107 [18:18<31:38, 27.91s/epoch, loss=1.15, accuracy=0.751, val_loss=2.16, val_accuracy=0.487, lr=0.1] 37%|███▋      | 40/107 [18:46<31:11, 27.93s/epoch, loss=1.14, accuracy=0.752, val_loss=1.81, val_accuracy=0.508, lr=0.0316] 38%|███▊      | 41/107 [19:14<30:37, 27.84s/epoch, loss=1.15, accuracy=0.752, val_loss=2.6, val_accuracy=0.37, lr=0.1]      39%|███▉      | 42/107 [19:42<30:17, 27.96s/epoch, loss=1.14, accuracy=0.753, val_loss=3.11, val_accuracy=0.236, lr=0.1] 40%|████      | 43/107 [20:09<29:30, 27.66s/epoch, loss=1.15, accuracy=0.75, val_loss=3.52, val_accuracy=0.332, lr=0.1]  41%|████      | 44/107 [20:37<29:10, 27.78s/epoch, loss=1.15, accuracy=0.752, val_loss=3.28, val_accuracy=0.408, lr=0.1] 42%|████▏     | 45/107 [21:04<28:20, 27.43s/epoch, loss=1.14, accuracy=0.753, val_loss=1.63, val_accuracy=0.564, lr=0.0316] 43%|████▎     | 46/107 [21:32<28:07, 27.66s/epoch, loss=1.14, accuracy=0.751, val_loss=1.29, val_accuracy=0.703, lr=0.1]    44%|████▍     | 47/107 [22:01<27:53, 27.90s/epoch, loss=1.14, accuracy=0.756, val_loss=2.88, val_accuracy=0.376, lr=0.1] 45%|████▍     | 48/107 [22:29<27:33, 28.03s/epoch, loss=1.15, accuracy=0.754, val_loss=1.48, val_accuracy=0.659, lr=0.1] 46%|████▌     | 49/107 [22:57<27:09, 28.10s/epoch, loss=1.14, accuracy=0.756, val_loss=1.71, val_accuracy=0.593, lr=0.1] 47%|████▋     | 50/107 [23:25<26:42, 28.12s/epoch, loss=1.14, accuracy=0.752, val_loss=1.56, val_accuracy=0.607, lr=0.1] 48%|████▊     | 51/107 [23:53<26:00, 27.87s/epoch, loss=1.14, accuracy=0.752, val_loss=5.13, val_accuracy=0.339, lr=0.0316] 49%|████▊     | 52/107 [24:20<25:22, 27.68s/epoch, loss=1.15, accuracy=0.753, val_loss=2.26, val_accuracy=0.373, lr=0.1]    50%|████▉     | 53/107 [24:47<24:52, 27.64s/epoch, loss=1.14, accuracy=0.752, val_loss=3.89, val_accuracy=0.25, lr=0.1]  50%|█████     | 54/107 [25:15<24:31, 27.76s/epoch, loss=1.14, accuracy=0.755, val_loss=1.66, val_accuracy=0.578, lr=0.1] 51%|█████▏    | 55/107 [25:43<24:07, 27.84s/epoch, loss=1.15, accuracy=0.753, val_loss=1.83, val_accuracy=0.497, lr=0.1] 52%|█████▏    | 56/107 [26:12<23:46, 27.98s/epoch, loss=1.14, accuracy=0.754, val_loss=2.25, val_accuracy=0.442, lr=0.0316] 53%|█████▎    | 57/107 [26:40<23:22, 28.05s/epoch, loss=1.13, accuracy=0.756, val_loss=2.38, val_accuracy=0.387, lr=0.1]    54%|█████▍    | 58/107 [27:08<22:51, 27.99s/epoch, loss=1.14, accuracy=0.752, val_loss=2.72, val_accuracy=0.389, lr=0.1] 55%|█████▌    | 59/107 [27:35<22:17, 27.86s/epoch, loss=1.13, accuracy=0.757, val_loss=1.75, val_accuracy=0.581, lr=0.1] 56%|█████▌    | 60/107 [28:02<21:32, 27.49s/epoch, loss=1.15, accuracy=0.751, val_loss=1.7, val_accuracy=0.574, lr=0.1]  57%|█████▋    | 61/107 [28:28<20:48, 27.14s/epoch, loss=1.14, accuracy=0.755, val_loss=2.74, val_accuracy=0.426, lr=0.0316] 58%|█████▊    | 62/107 [28:55<20:18, 27.08s/epoch, loss=1.14, accuracy=0.755, val_loss=1.57, val_accuracy=0.606, lr=0.1]    59%|█████▉    | 63/107 [29:24<20:07, 27.45s/epoch, loss=1.13, accuracy=0.756, val_loss=2.64, val_accuracy=0.452, lr=0.1] 60%|█████▉    | 64/107 [29:51<19:46, 27.59s/epoch, loss=1.15, accuracy=0.751, val_loss=2.39, val_accuracy=0.444, lr=0.1] 61%|██████    | 65/107 [30:20<19:25, 27.74s/epoch, loss=1.14, accuracy=0.755, val_loss=2.16, val_accuracy=0.518, lr=0.1] 62%|██████▏   | 66/107 [30:48<19:01, 27.85s/epoch, loss=1.13, accuracy=0.755, val_loss=2.18, val_accuracy=0.421, lr=0.0316] 63%|██████▎   | 67/107 [31:15<18:29, 27.74s/epoch, loss=1.14, accuracy=0.753, val_loss=1.6, val_accuracy=0.618, lr=0.1]     64%|██████▎   | 68/107 [31:43<18:00, 27.70s/epoch, loss=1.14, accuracy=0.754, val_loss=1.58, val_accuracy=0.593, lr=0.1] 64%|██████▍   | 69/107 [32:11<17:34, 27.76s/epoch, loss=1.14, accuracy=0.754, val_loss=1.65, val_accuracy=0.599, lr=0.1] 65%|██████▌   | 70/107 [32:38<17:07, 27.78s/epoch, loss=1.13, accuracy=0.758, val_loss=2.4, val_accuracy=0.456, lr=0.1]  66%|██████▋   | 71/107 [33:06<16:39, 27.77s/epoch, loss=1.13, accuracy=0.757, val_loss=2.52, val_accuracy=0.422, lr=0.0316] 67%|██████▋   | 72/107 [33:34<16:10, 27.73s/epoch, loss=1.13, accuracy=0.755, val_loss=2.77, val_accuracy=0.445, lr=0.1]    68%|██████▊   | 73/107 [34:01<15:31, 27.41s/epoch, loss=1.13, accuracy=0.756, val_loss=2.02, val_accuracy=0.508, lr=0.1] 69%|██████▉   | 74/107 [34:27<14:56, 27.18s/epoch, loss=1.14, accuracy=0.754, val_loss=2.42, val_accuracy=0.481, lr=0.1] 70%|███████   | 75/107 [34:54<14:24, 27.02s/epoch, loss=1.13, accuracy=0.753, val_loss=1.51, val_accuracy=0.621, lr=0.1] 71%|███████   | 76/107 [35:22<14:03, 27.22s/epoch, loss=1.13, accuracy=0.756, val_loss=2.12, val_accuracy=0.525, lr=0.0316] 72%|███████▏  | 77/107 [35:49<13:43, 27.44s/epoch, loss=1.14, accuracy=0.756, val_loss=1.66, val_accuracy=0.59, lr=0.1]     73%|███████▎  | 78/107 [36:17<13:17, 27.49s/epoch, loss=1.14, accuracy=0.755, val_loss=2.2, val_accuracy=0.539, lr=0.1] 74%|███████▍  | 79/107 [36:45<12:52, 27.61s/epoch, loss=1.13, accuracy=0.758, val_loss=1.95, val_accuracy=0.551, lr=0.1] 75%|███████▍  | 80/107 [37:13<12:26, 27.63s/epoch, loss=1.14, accuracy=0.754, val_loss=2.42, val_accuracy=0.373, lr=0.1] 76%|███████▌  | 81/107 [37:40<11:59, 27.69s/epoch, loss=1.13, accuracy=0.755, val_loss=1.52, val_accuracy=0.615, lr=0.0316] 77%|███████▋  | 82/107 [38:08<11:33, 27.75s/epoch, loss=0.903, accuracy=0.819, val_loss=0.862, val_accuracy=0.82, lr=0.01]  78%|███████▊  | 83/107 [38:36<11:04, 27.70s/epoch, loss=0.731, accuracy=0.85, val_loss=0.765, val_accuracy=0.826, lr=0.01] 79%|███████▊  | 84/107 [39:03<10:33, 27.54s/epoch, loss=0.652, accuracy=0.857, val_loss=0.77, val_accuracy=0.806, lr=0.01] 79%|███████▉  | 85/107 [39:31<10:08, 27.67s/epoch, loss=0.609, accuracy=0.858, val_loss=0.727, val_accuracy=0.816, lr=0.01] 80%|████████  | 86/107 [39:59<09:42, 27.72s/epoch, loss=0.592, accuracy=0.859, val_loss=0.764, val_accuracy=0.8, lr=0.01]   81%|████████▏ | 87/107 [40:27<09:14, 27.70s/epoch, loss=0.579, accuracy=0.861, val_loss=0.719, val_accuracy=0.817, lr=0.01] 82%|████████▏ | 88/107 [40:54<08:45, 27.68s/epoch, loss=0.574, accuracy=0.862, val_loss=1.11, val_accuracy=0.709, lr=0.01]  83%|████████▎ | 89/107 [41:22<08:16, 27.61s/epoch, loss=0.565, accuracy=0.866, val_loss=0.704, val_accuracy=0.818, lr=0.01] 84%|████████▍ | 90/107 [41:50<07:51, 27.75s/epoch, loss=0.569, accuracy=0.865, val_loss=0.768, val_accuracy=0.804, lr=0.01] 85%|████████▌ | 91/107 [42:17<07:19, 27.46s/epoch, loss=0.568, accuracy=0.866, val_loss=0.744, val_accuracy=0.809, lr=0.01] 86%|████████▌ | 92/107 [42:43<06:46, 27.07s/epoch, loss=0.561, accuracy=0.87, val_loss=0.68, val_accuracy=0.833, lr=0.01]   87%|████████▋ | 93/107 [43:09<06:15, 26.84s/epoch, loss=0.561, accuracy=0.871, val_loss=0.813, val_accuracy=0.794, lr=0.01] 88%|████████▊ | 94/107 [43:35<05:46, 26.63s/epoch, loss=0.56, accuracy=0.872, val_loss=0.755, val_accuracy=0.808, lr=0.01]  89%|████████▉ | 95/107 [44:02<05:19, 26.66s/epoch, loss=0.56, accuracy=0.872, val_loss=0.762, val_accuracy=0.81, lr=0.01]  90%|████████▉ | 96/107 [44:29<04:53, 26.69s/epoch, loss=0.561, accuracy=0.874, val_loss=0.878, val_accuracy=0.771, lr=0.01] 91%|█████████ | 97/107 [44:55<04:26, 26.61s/epoch, loss=0.558, accuracy=0.874, val_loss=0.766, val_accuracy=0.818, lr=0.00316] 92%|█████████▏| 98/107 [45:21<03:58, 26.51s/epoch, loss=0.563, accuracy=0.874, val_loss=0.688, val_accuracy=0.834, lr=0.01]    93%|█████████▎| 99/107 [45:48<03:32, 26.59s/epoch, loss=0.557, accuracy=0.876, val_loss=0.744, val_accuracy=0.819, lr=0.01] 93%|█████████▎| 100/107 [46:16<03:08, 26.91s/epoch, loss=0.558, accuracy=0.875, val_loss=0.804, val_accuracy=0.801, lr=0.01] 94%|█████████▍| 101/107 [46:44<02:43, 27.24s/epoch, loss=0.558, accuracy=0.878, val_loss=0.905, val_accuracy=0.764, lr=0.01] 95%|█████████▌| 102/107 [47:11<02:16, 27.31s/epoch, loss=0.555, accuracy=0.879, val_loss=0.774, val_accuracy=0.809, lr=0.00316] 96%|█████████▋| 103/107 [47:38<01:48, 27.13s/epoch, loss=0.558, accuracy=0.879, val_loss=0.741, val_accuracy=0.822, lr=0.01]    97%|█████████▋| 104/107 [48:04<01:20, 26.92s/epoch, loss=0.552, accuracy=0.881, val_loss=0.78, val_accuracy=0.807, lr=0.01]  98%|█████████▊| 105/107 [48:32<00:54, 27.15s/epoch, loss=0.553, accuracy=0.879, val_loss=0.843, val_accuracy=0.797, lr=0.01] 99%|█████████▉| 106/107 [49:00<00:27, 27.43s/epoch, loss=0.558, accuracy=0.878, val_loss=0.738, val_accuracy=0.822, lr=0.01]100%|██████████| 107/107 [49:28<00:00, 27.42s/epoch, loss=0.557, accuracy=0.879, val_loss=1.06, val_accuracy=0.745, lr=0.00316]100%|██████████| 107/107 [49:28<00:00, 27.74s/epoch, loss=0.557, accuracy=0.879, val_loss=1.06, val_accuracy=0.745, lr=0.00316]
Using real-time data augmentation.
Test score: 1.0643950700759888
Test accuracy: 0.7445999979972839


* * * Run SGD for ID = 14_12. * * *


2024-03-05 13:18:53.718733: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 13:18:56.291360: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 13:18:56.292635: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-05 13:18:56.332971: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-05 13:18:56.333012: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 13:18:56.336380: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 13:18:56.336449: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-05 13:18:56.339024: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-05 13:18:56.339702: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-05 13:18:56.342530: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-05 13:18:56.344138: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-05 13:18:56.349667: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 13:18:56.358807: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-05 13:18:56.358899: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 13:18:57.557442: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-05 13:18:57.558483: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 13:18:57.559632: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-05 13:18:57.559676: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 13:18:57.559715: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 13:18:57.559732: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-05 13:18:57.559745: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-05 13:18:57.559759: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-05 13:18:57.559775: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-05 13:18:57.559790: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-05 13:18:57.559807: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 13:18:57.560408: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-05 13:18:57.560451: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 13:18:58.210879: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-05 13:18:58.210928: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-05 13:18:58.210939: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-05 13:18:58.212053: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:3b:00.0, compute capability: 6.1)
{'id': '14_12', 'seed': 12, 'out_folder': 'results/epoch_budget', 'batch_size': 128, 'epochs': 107, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/107 [00:00<?, ?epoch/s]2024-03-05 13:18:59.063394: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-05 13:18:59.075993: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-03-05 13:19:01.033332: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 13:19:01.320385: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 13:19:02.127316: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-05 13:19:02.184856: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/107 [01:06<1:57:14, 66.36s/epoch, loss=3.11, accuracy=0.331, val_loss=3.76, val_accuracy=0.144, lr=0.1]  2%|▏         | 2/107 [01:33<1:15:38, 43.23s/epoch, loss=1.6, accuracy=0.51, val_loss=2.29, val_accuracy=0.381, lr=0.1]    3%|▎         | 3/107 [01:59<1:01:41, 35.59s/epoch, loss=1.35, accuracy=0.628, val_loss=3.49, val_accuracy=0.254, lr=0.1]  4%|▎         | 4/107 [02:26<55:04, 32.09s/epoch, loss=1.27, accuracy=0.681, val_loss=2.13, val_accuracy=0.496, lr=0.1]    5%|▍         | 5/107 [02:54<52:01, 30.60s/epoch, loss=1.25, accuracy=0.702, val_loss=2.9, val_accuracy=0.383, lr=0.1]   6%|▌         | 6/107 [03:22<50:08, 29.78s/epoch, loss=1.23, accuracy=0.711, val_loss=2.01, val_accuracy=0.512, lr=0.1]  7%|▋         | 7/107 [03:50<48:29, 29.09s/epoch, loss=1.22, accuracy=0.718, val_loss=1.68, val_accuracy=0.569, lr=0.1]  7%|▋         | 8/107 [04:18<47:27, 28.76s/epoch, loss=1.2, accuracy=0.725, val_loss=2.41, val_accuracy=0.386, lr=0.1]   8%|▊         | 9/107 [04:46<46:36, 28.53s/epoch, loss=1.21, accuracy=0.728, val_loss=1.64, val_accuracy=0.584, lr=0.1]  9%|▉         | 10/107 [05:14<46:00, 28.45s/epoch, loss=1.2, accuracy=0.732, val_loss=1.98, val_accuracy=0.49, lr=0.1]  10%|█         | 11/107 [05:42<44:57, 28.10s/epoch, loss=1.19, accuracy=0.734, val_loss=2.6, val_accuracy=0.404, lr=0.1] 11%|█         | 12/107 [06:09<44:03, 27.83s/epoch, loss=1.2, accuracy=0.733, val_loss=2.58, val_accuracy=0.383, lr=0.1] 12%|█▏        | 13/107 [06:37<43:36, 27.84s/epoch, loss=1.19, accuracy=0.738, val_loss=1.71, val_accuracy=0.591, lr=0.1] 13%|█▎        | 14/107 [07:05<43:21, 27.97s/epoch, loss=1.19, accuracy=0.738, val_loss=3.08, val_accuracy=0.391, lr=0.0316] 14%|█▍        | 15/107 [07:34<43:16, 28.22s/epoch, loss=1.18, accuracy=0.742, val_loss=3.16, val_accuracy=0.359, lr=0.1]    15%|█▍        | 16/107 [08:00<42:01, 27.71s/epoch, loss=1.18, accuracy=0.744, val_loss=1.73, val_accuracy=0.557, lr=0.1] 16%|█▌        | 17/107 [08:28<41:30, 27.67s/epoch, loss=1.18, accuracy=0.744, val_loss=1.86, val_accuracy=0.512, lr=0.1] 17%|█▋        | 18/107 [08:56<41:13, 27.79s/epoch, loss=1.18, accuracy=0.743, val_loss=2.71, val_accuracy=0.417, lr=0.1] 18%|█▊        | 19/107 [09:24<40:55, 27.91s/epoch, loss=1.17, accuracy=0.744, val_loss=1.32, val_accuracy=0.694, lr=0.1] 19%|█▊        | 20/107 [09:51<40:07, 27.67s/epoch, loss=1.16, accuracy=0.745, val_loss=2.2, val_accuracy=0.496, lr=0.1]  20%|█▉        | 21/107 [10:19<39:50, 27.80s/epoch, loss=1.16, accuracy=0.747, val_loss=3.38, val_accuracy=0.348, lr=0.1] 21%|██        | 22/107 [10:48<39:46, 28.07s/epoch, loss=1.17, accuracy=0.748, val_loss=2.36, val_accuracy=0.386, lr=0.1] 21%|██▏       | 23/107 [11:17<39:30, 28.22s/epoch, loss=1.17, accuracy=0.748, val_loss=1.76, val_accuracy=0.556, lr=0.1] 22%|██▏       | 24/107 [11:45<39:10, 28.32s/epoch, loss=1.16, accuracy=0.748, val_loss=2.79, val_accuracy=0.344, lr=0.0316] 23%|██▎       | 25/107 [12:13<38:42, 28.33s/epoch, loss=1.16, accuracy=0.75, val_loss=1.5, val_accuracy=0.635, lr=0.1]      24%|██▍       | 26/107 [12:41<38:05, 28.22s/epoch, loss=1.16, accuracy=0.75, val_loss=1.46, val_accuracy=0.646, lr=0.1] 25%|██▌       | 27/107 [13:10<37:38, 28.23s/epoch, loss=1.15, accuracy=0.75, val_loss=1.59, val_accuracy=0.609, lr=0.1] 26%|██▌       | 28/107 [13:38<37:01, 28.12s/epoch, loss=1.15, accuracy=0.752, val_loss=2.51, val_accuracy=0.488, lr=0.1] 27%|██▋       | 29/107 [14:06<36:30, 28.08s/epoch, loss=1.15, accuracy=0.752, val_loss=4.11, val_accuracy=0.259, lr=0.0316] 28%|██▊       | 30/107 [14:32<35:31, 27.69s/epoch, loss=1.15, accuracy=0.754, val_loss=2.06, val_accuracy=0.453, lr=0.1]    29%|██▉       | 31/107 [14:59<34:47, 27.46s/epoch, loss=1.15, accuracy=0.751, val_loss=1.88, val_accuracy=0.506, lr=0.1] 30%|██▉       | 32/107 [15:26<34:14, 27.39s/epoch, loss=1.14, accuracy=0.751, val_loss=1.96, val_accuracy=0.533, lr=0.1] 31%|███       | 33/107 [15:55<34:01, 27.59s/epoch, loss=1.14, accuracy=0.752, val_loss=1.8, val_accuracy=0.56, lr=0.1]   32%|███▏      | 34/107 [16:23<33:45, 27.74s/epoch, loss=1.15, accuracy=0.754, val_loss=1.5, val_accuracy=0.658, lr=0.0316] 33%|███▎      | 35/107 [16:51<33:25, 27.85s/epoch, loss=1.14, accuracy=0.754, val_loss=1.81, val_accuracy=0.515, lr=0.1]   34%|███▎      | 36/107 [17:19<33:05, 27.97s/epoch, loss=1.15, accuracy=0.751, val_loss=3.1, val_accuracy=0.377, lr=0.1]  35%|███▍      | 37/107 [17:47<32:33, 27.91s/epoch, loss=1.13, accuracy=0.754, val_loss=1.58, val_accuracy=0.59, lr=0.1] 36%|███▌      | 38/107 [18:15<32:09, 27.96s/epoch, loss=1.14, accuracy=0.753, val_loss=1.53, val_accuracy=0.614, lr=0.1] 36%|███▋      | 39/107 [18:43<31:43, 28.00s/epoch, loss=1.14, accuracy=0.757, val_loss=2.81, val_accuracy=0.391, lr=0.0316] 37%|███▋      | 40/107 [19:11<31:17, 28.02s/epoch, loss=1.14, accuracy=0.754, val_loss=1.72, val_accuracy=0.587, lr=0.1]    38%|███▊      | 41/107 [19:39<30:42, 27.91s/epoch, loss=1.14, accuracy=0.752, val_loss=1.41, val_accuracy=0.66, lr=0.1]  39%|███▉      | 42/107 [20:07<30:16, 27.95s/epoch, loss=1.14, accuracy=0.752, val_loss=1.77, val_accuracy=0.541, lr=0.1] 40%|████      | 43/107 [20:35<29:56, 28.06s/epoch, loss=1.14, accuracy=0.755, val_loss=3.93, val_accuracy=0.333, lr=0.1] 41%|████      | 44/107 [21:03<29:30, 28.10s/epoch, loss=1.14, accuracy=0.755, val_loss=1.55, val_accuracy=0.605, lr=0.0316] 42%|████▏     | 45/107 [21:31<28:55, 27.99s/epoch, loss=1.13, accuracy=0.756, val_loss=2.35, val_accuracy=0.371, lr=0.1]    43%|████▎     | 46/107 [21:59<28:20, 27.87s/epoch, loss=1.13, accuracy=0.755, val_loss=2.04, val_accuracy=0.487, lr=0.1] 44%|████▍     | 47/107 [22:26<27:51, 27.86s/epoch, loss=1.14, accuracy=0.755, val_loss=1.76, val_accuracy=0.597, lr=0.1] 45%|████▍     | 48/107 [22:55<27:30, 27.97s/epoch, loss=1.13, accuracy=0.756, val_loss=2.03, val_accuracy=0.538, lr=0.1] 46%|████▌     | 49/107 [23:22<26:57, 27.89s/epoch, loss=1.14, accuracy=0.754, val_loss=2.23, val_accuracy=0.435, lr=0.0316] 47%|████▋     | 50/107 [23:50<26:30, 27.90s/epoch, loss=1.13, accuracy=0.756, val_loss=2.32, val_accuracy=0.453, lr=0.1]    48%|████▊     | 51/107 [24:19<26:13, 28.09s/epoch, loss=1.13, accuracy=0.755, val_loss=5.65, val_accuracy=0.245, lr=0.1] 49%|████▊     | 52/107 [24:47<25:42, 28.05s/epoch, loss=1.12, accuracy=0.759, val_loss=2.2, val_accuracy=0.521, lr=0.1]  50%|████▉     | 53/107 [25:15<25:10, 27.96s/epoch, loss=1.13, accuracy=0.757, val_loss=1.32, val_accuracy=0.692, lr=0.1] 50%|█████     | 54/107 [25:43<24:44, 28.00s/epoch, loss=1.13, accuracy=0.755, val_loss=2.16, val_accuracy=0.467, lr=0.1] 51%|█████▏    | 55/107 [26:11<24:17, 28.04s/epoch, loss=1.13, accuracy=0.757, val_loss=1.93, val_accuracy=0.569, lr=0.1] 52%|█████▏    | 56/107 [26:39<23:53, 28.10s/epoch, loss=1.12, accuracy=0.757, val_loss=1.83, val_accuracy=0.545, lr=0.1] 53%|█████▎    | 57/107 [27:07<23:27, 28.15s/epoch, loss=1.13, accuracy=0.758, val_loss=2.12, val_accuracy=0.447, lr=0.1] 54%|█████▍    | 58/107 [27:35<22:59, 28.16s/epoch, loss=1.13, accuracy=0.759, val_loss=1.94, val_accuracy=0.526, lr=0.0316] 55%|█████▌    | 59/107 [28:04<22:34, 28.21s/epoch, loss=1.13, accuracy=0.757, val_loss=2.49, val_accuracy=0.288, lr=0.1]    56%|█████▌    | 60/107 [28:32<22:04, 28.18s/epoch, loss=1.13, accuracy=0.757, val_loss=1.91, val_accuracy=0.561, lr=0.1] 57%|█████▋    | 61/107 [28:59<21:20, 27.84s/epoch, loss=1.12, accuracy=0.758, val_loss=2.2, val_accuracy=0.496, lr=0.1]  58%|█████▊    | 62/107 [29:26<20:49, 27.76s/epoch, loss=1.13, accuracy=0.757, val_loss=2.37, val_accuracy=0.44, lr=0.1] 59%|█████▉    | 63/107 [29:54<20:14, 27.59s/epoch, loss=1.12, accuracy=0.757, val_loss=2.08, val_accuracy=0.515, lr=0.0316] 60%|█████▉    | 64/107 [30:20<19:35, 27.33s/epoch, loss=1.12, accuracy=0.756, val_loss=1.48, val_accuracy=0.634, lr=0.1]    61%|██████    | 65/107 [30:48<19:09, 27.38s/epoch, loss=1.13, accuracy=0.754, val_loss=1.51, val_accuracy=0.617, lr=0.1] 62%|██████▏   | 66/107 [31:16<18:50, 27.57s/epoch, loss=1.12, accuracy=0.757, val_loss=1.65, val_accuracy=0.592, lr=0.1] 63%|██████▎   | 67/107 [31:44<18:25, 27.65s/epoch, loss=1.12, accuracy=0.761, val_loss=6.38, val_accuracy=0.283, lr=0.1] 64%|██████▎   | 68/107 [32:12<18:02, 27.76s/epoch, loss=1.12, accuracy=0.758, val_loss=2.02, val_accuracy=0.56, lr=0.0316] 64%|██████▍   | 69/107 [32:40<17:38, 27.84s/epoch, loss=1.12, accuracy=0.759, val_loss=1.74, val_accuracy=0.544, lr=0.1]   65%|██████▌   | 70/107 [33:07<17:08, 27.80s/epoch, loss=1.12, accuracy=0.757, val_loss=1.63, val_accuracy=0.599, lr=0.1] 66%|██████▋   | 71/107 [33:35<16:39, 27.76s/epoch, loss=1.13, accuracy=0.758, val_loss=1.84, val_accuracy=0.552, lr=0.1] 67%|██████▋   | 72/107 [34:03<16:12, 27.77s/epoch, loss=1.13, accuracy=0.757, val_loss=2.24, val_accuracy=0.385, lr=0.1] 68%|██████▊   | 73/107 [34:30<15:38, 27.61s/epoch, loss=1.12, accuracy=0.757, val_loss=2.11, val_accuracy=0.483, lr=0.0316] 69%|██████▉   | 74/107 [34:58<15:10, 27.58s/epoch, loss=1.12, accuracy=0.759, val_loss=2.29, val_accuracy=0.385, lr=0.1]    70%|███████   | 75/107 [35:26<14:49, 27.81s/epoch, loss=1.12, accuracy=0.759, val_loss=1.99, val_accuracy=0.428, lr=0.1] 71%|███████   | 76/107 [35:54<14:25, 27.92s/epoch, loss=1.12, accuracy=0.759, val_loss=1.89, val_accuracy=0.517, lr=0.1] 72%|███████▏  | 77/107 [36:22<13:59, 27.97s/epoch, loss=1.12, accuracy=0.76, val_loss=2.05, val_accuracy=0.483, lr=0.1]  73%|███████▎  | 78/107 [36:51<13:33, 28.05s/epoch, loss=1.12, accuracy=0.757, val_loss=2.08, val_accuracy=0.457, lr=0.0316] 74%|███████▍  | 79/107 [37:17<12:56, 27.72s/epoch, loss=1.12, accuracy=0.76, val_loss=2.03, val_accuracy=0.495, lr=0.1]     75%|███████▍  | 80/107 [37:44<12:21, 27.48s/epoch, loss=1.12, accuracy=0.76, val_loss=2.23, val_accuracy=0.514, lr=0.1] 76%|███████▌  | 81/107 [38:11<11:45, 27.13s/epoch, loss=1.12, accuracy=0.758, val_loss=5.33, val_accuracy=0.315, lr=0.1] 77%|███████▋  | 82/107 [38:37<11:12, 26.92s/epoch, loss=0.914, accuracy=0.816, val_loss=0.982, val_accuracy=0.775, lr=0.01] 78%|███████▊  | 83/107 [39:05<10:51, 27.13s/epoch, loss=0.737, accuracy=0.848, val_loss=0.856, val_accuracy=0.798, lr=0.01] 79%|███████▊  | 84/107 [39:33<10:29, 27.37s/epoch, loss=0.649, accuracy=0.857, val_loss=0.726, val_accuracy=0.825, lr=0.01] 79%|███████▉  | 85/107 [40:00<10:03, 27.44s/epoch, loss=0.607, accuracy=0.86, val_loss=0.735, val_accuracy=0.813, lr=0.01]  80%|████████  | 86/107 [40:28<09:38, 27.57s/epoch, loss=0.581, accuracy=0.864, val_loss=0.75, val_accuracy=0.802, lr=0.01] 81%|████████▏ | 87/107 [40:56<09:12, 27.62s/epoch, loss=0.573, accuracy=0.863, val_loss=1.06, val_accuracy=0.706, lr=0.01] 82%|████████▏ | 88/107 [41:23<08:39, 27.34s/epoch, loss=0.565, accuracy=0.865, val_loss=0.699, val_accuracy=0.821, lr=0.01] 83%|████████▎ | 89/107 [41:51<08:17, 27.64s/epoch, loss=0.56, accuracy=0.868, val_loss=0.827, val_accuracy=0.79, lr=0.01]   84%|████████▍ | 90/107 [42:19<07:51, 27.76s/epoch, loss=0.56, accuracy=0.869, val_loss=1.04, val_accuracy=0.712, lr=0.01] 85%|████████▌ | 91/107 [42:47<07:25, 27.87s/epoch, loss=0.561, accuracy=0.867, val_loss=0.963, val_accuracy=0.747, lr=0.01] 86%|████████▌ | 92/107 [43:15<06:56, 27.78s/epoch, loss=0.558, accuracy=0.87, val_loss=0.896, val_accuracy=0.762, lr=0.01]  87%|████████▋ | 93/107 [43:43<06:30, 27.86s/epoch, loss=0.56, accuracy=0.87, val_loss=0.925, val_accuracy=0.772, lr=0.00316] 88%|████████▊ | 94/107 [44:11<06:03, 27.93s/epoch, loss=0.554, accuracy=0.873, val_loss=0.945, val_accuracy=0.748, lr=0.01]  89%|████████▉ | 95/107 [44:39<05:35, 27.99s/epoch, loss=0.553, accuracy=0.875, val_loss=0.777, val_accuracy=0.802, lr=0.01] 90%|████████▉ | 96/107 [45:07<05:08, 28.02s/epoch, loss=0.555, accuracy=0.875, val_loss=0.749, val_accuracy=0.807, lr=0.01] 91%|█████████ | 97/107 [45:35<04:39, 28.00s/epoch, loss=0.553, accuracy=0.875, val_loss=0.776, val_accuracy=0.816, lr=0.01] 92%|█████████▏| 98/107 [46:03<04:12, 28.07s/epoch, loss=0.552, accuracy=0.877, val_loss=0.784, val_accuracy=0.802, lr=0.00316] 93%|█████████▎| 99/107 [46:31<03:44, 28.10s/epoch, loss=0.552, accuracy=0.877, val_loss=0.84, val_accuracy=0.788, lr=0.01]     93%|█████████▎| 100/107 [47:01<03:19, 28.54s/epoch, loss=0.55, accuracy=0.878, val_loss=3.2, val_accuracy=0.464, lr=0.01]  94%|█████████▍| 101/107 [47:29<02:49, 28.33s/epoch, loss=0.552, accuracy=0.88, val_loss=0.955, val_accuracy=0.759, lr=0.01] 95%|█████████▌| 102/107 [47:56<02:20, 28.11s/epoch, loss=0.552, accuracy=0.879, val_loss=1.09, val_accuracy=0.698, lr=0.01] 96%|█████████▋| 103/107 [48:24<01:52, 28.10s/epoch, loss=0.555, accuracy=0.881, val_loss=1.1, val_accuracy=0.721, lr=0.00316] 97%|█████████▋| 104/107 [48:52<01:23, 27.93s/epoch, loss=0.553, accuracy=0.881, val_loss=0.774, val_accuracy=0.807, lr=0.01]  98%|█████████▊| 105/107 [49:19<00:55, 27.78s/epoch, loss=0.547, accuracy=0.881, val_loss=0.78, val_accuracy=0.81, lr=0.01]   99%|█████████▉| 106/107 [49:47<00:27, 27.87s/epoch, loss=0.551, accuracy=0.882, val_loss=0.75, val_accuracy=0.825, lr=0.01]100%|██████████| 107/107 [50:15<00:00, 27.84s/epoch, loss=0.549, accuracy=0.882, val_loss=0.836, val_accuracy=0.791, lr=0.01]100%|██████████| 107/107 [50:15<00:00, 28.18s/epoch, loss=0.549, accuracy=0.882, val_loss=0.836, val_accuracy=0.791, lr=0.01]
Using real-time data augmentation.
Test score: 0.8362821340560913
Test accuracy: 0.7910000085830688


* * * Run SGD for ID = 14_13. * * *


2024-03-05 14:09:18.938249: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 14:09:21.724230: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 14:09:21.725622: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-05 14:09:21.769435: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-05 14:09:21.769480: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 14:09:21.773139: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 14:09:21.773213: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-05 14:09:21.775957: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-05 14:09:21.776731: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-05 14:09:21.779836: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-05 14:09:21.781558: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-05 14:09:21.787605: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 14:09:21.788358: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-05 14:09:21.788452: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 14:09:23.086876: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-05 14:09:23.087933: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 14:09:23.088462: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-05 14:09:23.088495: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 14:09:23.088532: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 14:09:23.088547: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-05 14:09:23.088561: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-05 14:09:23.088575: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-05 14:09:23.088589: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-05 14:09:23.088603: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-05 14:09:23.088618: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 14:09:23.089200: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-05 14:09:23.089242: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 14:09:23.792891: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-05 14:09:23.792964: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-05 14:09:23.792976: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-05 14:09:23.794794: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:3b:00.0, compute capability: 6.1)
{'id': '14_13', 'seed': 13, 'out_folder': 'results/epoch_budget', 'batch_size': 128, 'epochs': 107, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/107 [00:00<?, ?epoch/s]2024-03-05 14:09:24.726552: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-05 14:09:24.739072: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-03-05 14:09:27.025954: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 14:09:27.376241: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 14:09:28.411996: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-05 14:09:28.453592: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/107 [00:59<1:45:18, 59.61s/epoch, loss=2.82, accuracy=0.425, val_loss=1.89, val_accuracy=0.475, lr=0.1]  2%|▏         | 2/107 [01:27<1:11:46, 41.02s/epoch, loss=1.43, accuracy=0.619, val_loss=2.19, val_accuracy=0.382, lr=0.1]  3%|▎         | 3/107 [01:55<1:00:32, 34.93s/epoch, loss=1.28, accuracy=0.674, val_loss=2.12, val_accuracy=0.409, lr=0.1]  4%|▎         | 4/107 [02:22<55:01, 32.05s/epoch, loss=1.25, accuracy=0.698, val_loss=2.16, val_accuracy=0.411, lr=0.1]    5%|▍         | 5/107 [02:50<51:52, 30.52s/epoch, loss=1.24, accuracy=0.711, val_loss=1.8, val_accuracy=0.521, lr=0.1]   6%|▌         | 6/107 [03:18<49:53, 29.64s/epoch, loss=1.22, accuracy=0.718, val_loss=2.15, val_accuracy=0.444, lr=0.1]  7%|▋         | 7/107 [03:46<48:30, 29.11s/epoch, loss=1.21, accuracy=0.723, val_loss=1.8, val_accuracy=0.541, lr=0.1]   7%|▋         | 8/107 [04:14<47:20, 28.70s/epoch, loss=1.2, accuracy=0.731, val_loss=2.02, val_accuracy=0.444, lr=0.1]  8%|▊         | 9/107 [04:42<46:18, 28.35s/epoch, loss=1.19, accuracy=0.731, val_loss=2.95, val_accuracy=0.401, lr=0.1]  9%|▉         | 10/107 [05:09<45:26, 28.11s/epoch, loss=1.18, accuracy=0.736, val_loss=1.6, val_accuracy=0.594, lr=0.1] 10%|█         | 11/107 [05:38<45:22, 28.36s/epoch, loss=1.18, accuracy=0.738, val_loss=1.59, val_accuracy=0.643, lr=0.1] 11%|█         | 12/107 [06:09<45:57, 29.02s/epoch, loss=1.18, accuracy=0.74, val_loss=1.63, val_accuracy=0.586, lr=0.1]  12%|█▏        | 13/107 [06:37<45:01, 28.74s/epoch, loss=1.17, accuracy=0.742, val_loss=2.9, val_accuracy=0.405, lr=0.1] 13%|█▎        | 14/107 [07:06<44:58, 29.02s/epoch, loss=1.17, accuracy=0.743, val_loss=1.58, val_accuracy=0.615, lr=0.1] 14%|█▍        | 15/107 [07:36<44:33, 29.06s/epoch, loss=1.17, accuracy=0.742, val_loss=2.28, val_accuracy=0.469, lr=0.1] 15%|█▍        | 16/107 [08:03<43:23, 28.61s/epoch, loss=1.16, accuracy=0.746, val_loss=2.53, val_accuracy=0.454, lr=0.1] 16%|█▌        | 17/107 [08:30<42:21, 28.24s/epoch, loss=1.17, accuracy=0.744, val_loss=2.08, val_accuracy=0.516, lr=0.1] 17%|█▋        | 18/107 [08:58<41:23, 27.91s/epoch, loss=1.15, accuracy=0.748, val_loss=2.29, val_accuracy=0.495, lr=0.1] 18%|█▊        | 19/107 [09:27<41:23, 28.22s/epoch, loss=1.15, accuracy=0.75, val_loss=2.42, val_accuracy=0.447, lr=0.0316] 19%|█▊        | 20/107 [09:55<41:12, 28.42s/epoch, loss=1.15, accuracy=0.748, val_loss=1.88, val_accuracy=0.52, lr=0.1]    20%|█▉        | 21/107 [10:24<40:42, 28.40s/epoch, loss=1.15, accuracy=0.749, val_loss=1.62, val_accuracy=0.559, lr=0.1] 21%|██        | 22/107 [10:52<39:58, 28.22s/epoch, loss=1.15, accuracy=0.751, val_loss=1.92, val_accuracy=0.531, lr=0.1] 21%|██▏       | 23/107 [11:20<39:40, 28.33s/epoch, loss=1.14, accuracy=0.751, val_loss=1.72, val_accuracy=0.511, lr=0.1] 22%|██▏       | 24/107 [11:48<38:52, 28.10s/epoch, loss=1.14, accuracy=0.755, val_loss=2.35, val_accuracy=0.462, lr=0.0316] 23%|██▎       | 25/107 [12:15<37:58, 27.79s/epoch, loss=1.15, accuracy=0.752, val_loss=3.59, val_accuracy=0.285, lr=0.1]    24%|██▍       | 26/107 [12:42<37:14, 27.59s/epoch, loss=1.14, accuracy=0.751, val_loss=1.77, val_accuracy=0.61, lr=0.1]  25%|██▌       | 27/107 [13:10<36:57, 27.71s/epoch, loss=1.13, accuracy=0.753, val_loss=2, val_accuracy=0.442, lr=0.1]   26%|██▌       | 28/107 [13:38<36:41, 27.87s/epoch, loss=1.14, accuracy=0.753, val_loss=5.84, val_accuracy=0.292, lr=0.1] 27%|██▋       | 29/107 [14:06<36:16, 27.90s/epoch, loss=1.14, accuracy=0.751, val_loss=1.58, val_accuracy=0.605, lr=0.0316] 28%|██▊       | 30/107 [14:34<35:37, 27.76s/epoch, loss=1.14, accuracy=0.751, val_loss=1.93, val_accuracy=0.491, lr=0.1]    29%|██▉       | 31/107 [15:01<35:12, 27.79s/epoch, loss=1.13, accuracy=0.753, val_loss=1.95, val_accuracy=0.512, lr=0.1] 30%|██▉       | 32/107 [15:29<34:44, 27.79s/epoch, loss=1.13, accuracy=0.752, val_loss=2.17, val_accuracy=0.431, lr=0.1] 31%|███       | 33/107 [15:57<34:13, 27.75s/epoch, loss=1.12, accuracy=0.755, val_loss=2.12, val_accuracy=0.522, lr=0.1] 32%|███▏      | 34/107 [16:25<33:52, 27.84s/epoch, loss=1.13, accuracy=0.751, val_loss=1.4, val_accuracy=0.647, lr=0.1]  33%|███▎      | 35/107 [16:53<33:25, 27.86s/epoch, loss=1.12, accuracy=0.754, val_loss=2.05, val_accuracy=0.474, lr=0.1] 34%|███▎      | 36/107 [17:21<33:03, 27.93s/epoch, loss=1.13, accuracy=0.755, val_loss=1.92, val_accuracy=0.5, lr=0.1]   35%|███▍      | 37/107 [17:49<32:35, 27.94s/epoch, loss=1.12, accuracy=0.755, val_loss=2.17, val_accuracy=0.493, lr=0.1] 36%|███▌      | 38/107 [18:17<32:05, 27.91s/epoch, loss=1.12, accuracy=0.755, val_loss=2.16, val_accuracy=0.454, lr=0.1] 36%|███▋      | 39/107 [18:44<31:33, 27.85s/epoch, loss=1.12, accuracy=0.756, val_loss=3.44, val_accuracy=0.359, lr=0.0316] 37%|███▋      | 40/107 [19:12<31:08, 27.89s/epoch, loss=1.12, accuracy=0.756, val_loss=2.73, val_accuracy=0.408, lr=0.1]    38%|███▊      | 41/107 [19:41<30:45, 27.96s/epoch, loss=1.12, accuracy=0.755, val_loss=2.26, val_accuracy=0.499, lr=0.1] 39%|███▉      | 42/107 [20:09<30:19, 28.00s/epoch, loss=1.12, accuracy=0.756, val_loss=1.9, val_accuracy=0.575, lr=0.1]  40%|████      | 43/107 [20:36<29:43, 27.87s/epoch, loss=1.12, accuracy=0.757, val_loss=6.57, val_accuracy=0.169, lr=0.1] 41%|████      | 44/107 [21:04<29:14, 27.85s/epoch, loss=1.12, accuracy=0.759, val_loss=1.9, val_accuracy=0.465, lr=0.0316] 42%|████▏     | 45/107 [21:32<28:48, 27.88s/epoch, loss=1.12, accuracy=0.755, val_loss=3.61, val_accuracy=0.324, lr=0.1]   43%|████▎     | 46/107 [22:00<28:18, 27.85s/epoch, loss=1.12, accuracy=0.759, val_loss=2.85, val_accuracy=0.408, lr=0.1] 44%|████▍     | 47/107 [22:28<27:54, 27.91s/epoch, loss=1.12, accuracy=0.757, val_loss=1.8, val_accuracy=0.516, lr=0.1]  45%|████▍     | 48/107 [22:56<27:25, 27.88s/epoch, loss=1.12, accuracy=0.757, val_loss=2.01, val_accuracy=0.481, lr=0.1] 46%|████▌     | 49/107 [23:23<26:52, 27.79s/epoch, loss=1.12, accuracy=0.756, val_loss=1.53, val_accuracy=0.596, lr=0.0316] 47%|████▋     | 50/107 [23:51<26:25, 27.81s/epoch, loss=1.11, accuracy=0.758, val_loss=1.65, val_accuracy=0.558, lr=0.1]    48%|████▊     | 51/107 [24:19<25:51, 27.71s/epoch, loss=1.11, accuracy=0.757, val_loss=2.07, val_accuracy=0.429, lr=0.1] 49%|████▊     | 52/107 [24:45<25:03, 27.33s/epoch, loss=1.12, accuracy=0.758, val_loss=2.84, val_accuracy=0.47, lr=0.1]  50%|████▉     | 53/107 [25:12<24:29, 27.22s/epoch, loss=1.12, accuracy=0.758, val_loss=1.59, val_accuracy=0.606, lr=0.1] 50%|█████     | 54/107 [25:40<24:14, 27.44s/epoch, loss=1.12, accuracy=0.758, val_loss=1.39, val_accuracy=0.649, lr=0.1] 51%|█████▏    | 55/107 [26:08<23:51, 27.54s/epoch, loss=1.12, accuracy=0.756, val_loss=1.82, val_accuracy=0.506, lr=0.1] 52%|█████▏    | 56/107 [26:36<23:29, 27.63s/epoch, loss=1.11, accuracy=0.758, val_loss=1.46, val_accuracy=0.63, lr=0.1]  53%|█████▎    | 57/107 [27:03<23:01, 27.62s/epoch, loss=1.11, accuracy=0.757, val_loss=1.73, val_accuracy=0.538, lr=0.1] 54%|█████▍    | 58/107 [27:30<22:26, 27.47s/epoch, loss=1.12, accuracy=0.759, val_loss=2.06, val_accuracy=0.492, lr=0.1] 55%|█████▌    | 59/107 [27:58<21:56, 27.42s/epoch, loss=1.12, accuracy=0.755, val_loss=1.81, val_accuracy=0.541, lr=0.0316] 56%|█████▌    | 60/107 [28:25<21:33, 27.52s/epoch, loss=1.11, accuracy=0.758, val_loss=2.7, val_accuracy=0.455, lr=0.1]     57%|█████▋    | 61/107 [28:52<21:00, 27.39s/epoch, loss=1.12, accuracy=0.757, val_loss=1.98, val_accuracy=0.54, lr=0.1] 58%|█████▊    | 62/107 [29:21<20:42, 27.61s/epoch, loss=1.11, accuracy=0.757, val_loss=2.78, val_accuracy=0.346, lr=0.1] 59%|█████▉    | 63/107 [29:48<20:14, 27.60s/epoch, loss=1.12, accuracy=0.756, val_loss=1.94, val_accuracy=0.462, lr=0.1] 60%|█████▉    | 64/107 [30:16<19:53, 27.77s/epoch, loss=1.11, accuracy=0.758, val_loss=3.33, val_accuracy=0.365, lr=0.0316] 61%|██████    | 65/107 [30:44<19:25, 27.74s/epoch, loss=1.11, accuracy=0.756, val_loss=3.46, val_accuracy=0.316, lr=0.1]    62%|██████▏   | 66/107 [31:11<18:50, 27.56s/epoch, loss=1.11, accuracy=0.756, val_loss=2.49, val_accuracy=0.396, lr=0.1] 63%|██████▎   | 67/107 [31:38<18:18, 27.45s/epoch, loss=1.11, accuracy=0.757, val_loss=1.69, val_accuracy=0.57, lr=0.1]  64%|██████▎   | 68/107 [32:06<17:57, 27.63s/epoch, loss=1.11, accuracy=0.756, val_loss=1.8, val_accuracy=0.554, lr=0.1] 64%|██████▍   | 69/107 [32:33<17:18, 27.32s/epoch, loss=1.12, accuracy=0.757, val_loss=2.19, val_accuracy=0.506, lr=0.0316] 65%|██████▌   | 70/107 [33:00<16:48, 27.26s/epoch, loss=1.11, accuracy=0.757, val_loss=3.54, val_accuracy=0.355, lr=0.1]    66%|██████▋   | 71/107 [33:28<16:28, 27.45s/epoch, loss=1.12, accuracy=0.755, val_loss=1.62, val_accuracy=0.601, lr=0.1] 67%|██████▋   | 72/107 [33:55<16:01, 27.47s/epoch, loss=1.11, accuracy=0.759, val_loss=2.42, val_accuracy=0.451, lr=0.1] 68%|██████▊   | 73/107 [34:23<15:35, 27.52s/epoch, loss=1.11, accuracy=0.757, val_loss=1.37, val_accuracy=0.659, lr=0.1] 69%|██████▉   | 74/107 [34:51<15:08, 27.53s/epoch, loss=1.11, accuracy=0.758, val_loss=2.63, val_accuracy=0.434, lr=0.1] 70%|███████   | 75/107 [35:18<14:40, 27.50s/epoch, loss=1.12, accuracy=0.756, val_loss=2.19, val_accuracy=0.477, lr=0.1] 71%|███████   | 76/107 [35:46<14:14, 27.57s/epoch, loss=1.11, accuracy=0.758, val_loss=1.92, val_accuracy=0.494, lr=0.1] 72%|███████▏  | 77/107 [36:13<13:40, 27.34s/epoch, loss=1.11, accuracy=0.759, val_loss=2.3, val_accuracy=0.518, lr=0.1]  73%|███████▎  | 78/107 [36:40<13:15, 27.44s/epoch, loss=1.12, accuracy=0.758, val_loss=2.63, val_accuracy=0.282, lr=0.0316] 74%|███████▍  | 79/107 [37:08<12:51, 27.56s/epoch, loss=1.11, accuracy=0.756, val_loss=2.08, val_accuracy=0.502, lr=0.1]    75%|███████▍  | 80/107 [37:36<12:23, 27.52s/epoch, loss=1.11, accuracy=0.76, val_loss=2.36, val_accuracy=0.392, lr=0.1]  76%|███████▌  | 81/107 [38:03<11:57, 27.61s/epoch, loss=1.12, accuracy=0.757, val_loss=3.32, val_accuracy=0.306, lr=0.1] 77%|███████▋  | 82/107 [38:31<11:32, 27.72s/epoch, loss=0.905, accuracy=0.815, val_loss=0.858, val_accuracy=0.817, lr=0.01] 78%|███████▊  | 83/107 [38:59<11:07, 27.79s/epoch, loss=0.731, accuracy=0.847, val_loss=0.775, val_accuracy=0.817, lr=0.01] 79%|███████▊  | 84/107 [39:27<10:41, 27.89s/epoch, loss=0.647, accuracy=0.857, val_loss=0.895, val_accuracy=0.766, lr=0.01] 79%|███████▉  | 85/107 [39:55<10:11, 27.78s/epoch, loss=0.607, accuracy=0.858, val_loss=0.756, val_accuracy=0.803, lr=0.01] 80%|████████  | 86/107 [40:23<09:42, 27.76s/epoch, loss=0.582, accuracy=0.862, val_loss=0.759, val_accuracy=0.807, lr=0.01] 81%|████████▏ | 87/107 [40:50<09:11, 27.56s/epoch, loss=0.574, accuracy=0.861, val_loss=0.79, val_accuracy=0.787, lr=0.01]  82%|████████▏ | 88/107 [41:18<08:45, 27.64s/epoch, loss=0.568, accuracy=0.863, val_loss=0.74, val_accuracy=0.808, lr=0.01] 83%|████████▎ | 89/107 [41:45<08:14, 27.47s/epoch, loss=0.562, accuracy=0.864, val_loss=0.781, val_accuracy=0.8, lr=0.01]  84%|████████▍ | 90/107 [42:12<07:44, 27.31s/epoch, loss=0.557, accuracy=0.866, val_loss=0.732, val_accuracy=0.814, lr=0.01] 85%|████████▌ | 91/107 [42:39<07:15, 27.20s/epoch, loss=0.558, accuracy=0.867, val_loss=0.772, val_accuracy=0.805, lr=0.01] 86%|████████▌ | 92/107 [43:06<06:49, 27.31s/epoch, loss=0.558, accuracy=0.869, val_loss=0.733, val_accuracy=0.814, lr=0.01] 87%|████████▋ | 93/107 [43:33<06:21, 27.29s/epoch, loss=0.56, accuracy=0.87, val_loss=0.784, val_accuracy=0.804, lr=0.01]   88%|████████▊ | 94/107 [44:01<05:54, 27.30s/epoch, loss=0.555, accuracy=0.871, val_loss=0.929, val_accuracy=0.755, lr=0.01] 89%|████████▉ | 95/107 [44:28<05:28, 27.35s/epoch, loss=0.557, accuracy=0.873, val_loss=0.782, val_accuracy=0.804, lr=0.00316] 90%|████████▉ | 96/107 [44:56<05:02, 27.50s/epoch, loss=0.556, accuracy=0.874, val_loss=0.791, val_accuracy=0.794, lr=0.01]    91%|█████████ | 97/107 [45:23<04:34, 27.47s/epoch, loss=0.551, accuracy=0.876, val_loss=0.792, val_accuracy=0.792, lr=0.01] 92%|█████████▏| 98/107 [45:49<04:03, 27.07s/epoch, loss=0.553, accuracy=0.876, val_loss=0.801, val_accuracy=0.806, lr=0.01] 93%|█████████▎| 99/107 [46:18<03:40, 27.57s/epoch, loss=0.551, accuracy=0.878, val_loss=0.814, val_accuracy=0.795, lr=0.01] 93%|█████████▎| 100/107 [46:47<03:14, 27.84s/epoch, loss=0.55, accuracy=0.877, val_loss=0.788, val_accuracy=0.801, lr=0.00316] 94%|█████████▍| 101/107 [47:15<02:46, 27.83s/epoch, loss=0.554, accuracy=0.878, val_loss=0.734, val_accuracy=0.819, lr=0.01]   95%|█████████▌| 102/107 [47:43<02:19, 27.93s/epoch, loss=0.555, accuracy=0.877, val_loss=0.861, val_accuracy=0.789, lr=0.01] 96%|█████████▋| 103/107 [48:11<01:51, 27.98s/epoch, loss=0.55, accuracy=0.879, val_loss=0.807, val_accuracy=0.795, lr=0.01]  97%|█████████▋| 104/107 [48:39<01:23, 27.92s/epoch, loss=0.549, accuracy=0.879, val_loss=0.804, val_accuracy=0.801, lr=0.01] 98%|█████████▊| 105/107 [49:06<00:55, 27.76s/epoch, loss=0.553, accuracy=0.879, val_loss=0.998, val_accuracy=0.734, lr=0.00316] 99%|█████████▉| 106/107 [49:33<00:27, 27.57s/epoch, loss=0.55, accuracy=0.882, val_loss=0.756, val_accuracy=0.813, lr=0.01]    100%|██████████| 107/107 [50:00<00:00, 27.44s/epoch, loss=0.551, accuracy=0.882, val_loss=0.763, val_accuracy=0.81, lr=0.01]100%|██████████| 107/107 [50:00<00:00, 28.04s/epoch, loss=0.551, accuracy=0.882, val_loss=0.763, val_accuracy=0.81, lr=0.01]
Using real-time data augmentation.
Test score: 0.7634241580963135
Test accuracy: 0.8104000091552734


* * * Run SGD for ID = 14_14. * * *


2024-03-05 14:59:29.473153: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 14:59:32.033697: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 14:59:32.034922: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-05 14:59:32.074955: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-05 14:59:32.074999: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 14:59:32.078342: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 14:59:32.078407: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-05 14:59:32.080806: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-05 14:59:32.082056: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-05 14:59:32.084819: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-05 14:59:32.086566: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-05 14:59:32.091652: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 14:59:32.092312: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-05 14:59:32.092407: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 14:59:33.228442: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-05 14:59:33.229628: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-05 14:59:33.230233: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-05 14:59:33.230274: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 14:59:33.230324: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 14:59:33.230338: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-05 14:59:33.230352: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-05 14:59:33.230366: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-05 14:59:33.230380: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-05 14:59:33.230394: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-05 14:59:33.230409: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 14:59:33.231015: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-05 14:59:33.231059: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-05 14:59:33.893338: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-05 14:59:33.893448: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-05 14:59:33.893458: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-05 14:59:33.896604: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:3b:00.0, compute capability: 6.1)
{'id': '14_14', 'seed': 14, 'out_folder': 'results/epoch_budget', 'batch_size': 128, 'epochs': 107, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/107 [00:00<?, ?epoch/s]2024-03-05 14:59:34.918097: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-05 14:59:34.929988: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-03-05 14:59:36.916415: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-05 14:59:37.188097: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-05 14:59:37.967767: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-05 14:59:38.023729: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/107 [01:04<1:53:47, 64.41s/epoch, loss=3.3, accuracy=0.247, val_loss=2, val_accuracy=0.331, lr=0.1]  2%|▏         | 2/107 [01:31<1:14:04, 42.33s/epoch, loss=1.61, accuracy=0.502, val_loss=3.05, val_accuracy=0.343, lr=0.1]  3%|▎         | 3/107 [01:57<1:00:49, 35.09s/epoch, loss=1.35, accuracy=0.626, val_loss=2.23, val_accuracy=0.384, lr=0.1]  4%|▎         | 4/107 [02:24<54:28, 31.73s/epoch, loss=1.28, accuracy=0.678, val_loss=3.75, val_accuracy=0.307, lr=0.1]    5%|▍         | 5/107 [02:52<51:42, 30.41s/epoch, loss=1.26, accuracy=0.695, val_loss=1.54, val_accuracy=0.596, lr=0.1]  6%|▌         | 6/107 [03:20<49:52, 29.63s/epoch, loss=1.24, accuracy=0.706, val_loss=1.65, val_accuracy=0.585, lr=0.1]  7%|▋         | 7/107 [03:47<48:07, 28.88s/epoch, loss=1.23, accuracy=0.715, val_loss=3.22, val_accuracy=0.414, lr=0.1]  7%|▋         | 8/107 [04:16<47:27, 28.76s/epoch, loss=1.22, accuracy=0.718, val_loss=4.85, val_accuracy=0.178, lr=0.1]  8%|▊         | 9/107 [04:43<46:17, 28.34s/epoch, loss=1.22, accuracy=0.723, val_loss=5.26, val_accuracy=0.228, lr=0.1]  9%|▉         | 10/107 [05:11<45:31, 28.16s/epoch, loss=1.21, accuracy=0.727, val_loss=2.81, val_accuracy=0.343, lr=0.0316] 10%|█         | 11/107 [05:39<45:00, 28.13s/epoch, loss=1.21, accuracy=0.727, val_loss=1.96, val_accuracy=0.517, lr=0.1]    11%|█         | 12/107 [06:07<44:33, 28.14s/epoch, loss=1.21, accuracy=0.729, val_loss=3.63, val_accuracy=0.176, lr=0.1] 12%|█▏        | 13/107 [06:35<43:50, 27.98s/epoch, loss=1.2, accuracy=0.732, val_loss=2.03, val_accuracy=0.534, lr=0.1]  13%|█▎        | 14/107 [07:03<43:20, 27.97s/epoch, loss=1.2, accuracy=0.734, val_loss=2.08, val_accuracy=0.468, lr=0.1] 14%|█▍        | 15/107 [07:31<42:49, 27.93s/epoch, loss=1.2, accuracy=0.734, val_loss=1.65, val_accuracy=0.592, lr=0.0316] 15%|█▍        | 16/107 [07:59<42:25, 27.97s/epoch, loss=1.19, accuracy=0.737, val_loss=2.01, val_accuracy=0.479, lr=0.1]   16%|█▌        | 17/107 [08:27<42:10, 28.12s/epoch, loss=1.19, accuracy=0.738, val_loss=2.79, val_accuracy=0.384, lr=0.1] 17%|█▋        | 18/107 [08:55<41:21, 27.88s/epoch, loss=1.19, accuracy=0.741, val_loss=1.82, val_accuracy=0.563, lr=0.1] 18%|█▊        | 19/107 [09:23<41:01, 27.98s/epoch, loss=1.19, accuracy=0.741, val_loss=2.85, val_accuracy=0.409, lr=0.1] 19%|█▊        | 20/107 [09:51<40:33, 27.97s/epoch, loss=1.19, accuracy=0.74, val_loss=1.92, val_accuracy=0.488, lr=0.0316] 20%|█▉        | 21/107 [10:19<40:04, 27.96s/epoch, loss=1.18, accuracy=0.741, val_loss=2.61, val_accuracy=0.444, lr=0.1]   21%|██        | 22/107 [10:47<39:38, 27.98s/epoch, loss=1.18, accuracy=0.745, val_loss=2.24, val_accuracy=0.463, lr=0.1] 21%|██▏       | 23/107 [11:14<39:03, 27.90s/epoch, loss=1.18, accuracy=0.746, val_loss=1.78, val_accuracy=0.581, lr=0.1] 22%|██▏       | 24/107 [11:42<38:20, 27.72s/epoch, loss=1.18, accuracy=0.743, val_loss=1.71, val_accuracy=0.575, lr=0.1] 23%|██▎       | 25/107 [12:10<38:07, 27.90s/epoch, loss=1.18, accuracy=0.745, val_loss=1.7, val_accuracy=0.553, lr=0.0316] 24%|██▍       | 26/107 [12:38<37:35, 27.85s/epoch, loss=1.18, accuracy=0.743, val_loss=1.9, val_accuracy=0.487, lr=0.1]    25%|██▌       | 27/107 [13:06<37:11, 27.90s/epoch, loss=1.17, accuracy=0.746, val_loss=2.66, val_accuracy=0.483, lr=0.1] 26%|██▌       | 28/107 [13:34<36:51, 27.99s/epoch, loss=1.17, accuracy=0.748, val_loss=1.97, val_accuracy=0.485, lr=0.1] 27%|██▋       | 29/107 [14:02<36:14, 27.88s/epoch, loss=1.17, accuracy=0.746, val_loss=1.92, val_accuracy=0.525, lr=0.1] 28%|██▊       | 30/107 [14:28<35:24, 27.59s/epoch, loss=1.17, accuracy=0.748, val_loss=1.68, val_accuracy=0.541, lr=0.0316] 29%|██▉       | 31/107 [14:55<34:30, 27.24s/epoch, loss=1.17, accuracy=0.747, val_loss=2.05, val_accuracy=0.508, lr=0.1]    30%|██▉       | 32/107 [15:21<33:46, 27.02s/epoch, loss=1.17, accuracy=0.749, val_loss=1.66, val_accuracy=0.611, lr=0.1] 31%|███       | 33/107 [15:48<33:18, 27.00s/epoch, loss=1.17, accuracy=0.748, val_loss=2.97, val_accuracy=0.407, lr=0.1] 32%|███▏      | 34/107 [16:15<32:39, 26.84s/epoch, loss=1.16, accuracy=0.748, val_loss=1.67, val_accuracy=0.574, lr=0.1] 33%|███▎      | 35/107 [16:42<32:26, 27.04s/epoch, loss=1.17, accuracy=0.747, val_loss=1.63, val_accuracy=0.591, lr=0.0316] 34%|███▎      | 36/107 [17:11<32:29, 27.46s/epoch, loss=1.17, accuracy=0.748, val_loss=2.02, val_accuracy=0.538, lr=0.1]    35%|███▍      | 37/107 [17:39<32:18, 27.70s/epoch, loss=1.17, accuracy=0.747, val_loss=1.64, val_accuracy=0.573, lr=0.1] 36%|███▌      | 38/107 [18:07<32:02, 27.86s/epoch, loss=1.17, accuracy=0.749, val_loss=2.34, val_accuracy=0.388, lr=0.1] 36%|███▋      | 39/107 [18:36<31:46, 28.04s/epoch, loss=1.16, accuracy=0.749, val_loss=1.65, val_accuracy=0.571, lr=0.1] 37%|███▋      | 40/107 [19:03<31:13, 27.96s/epoch, loss=1.16, accuracy=0.75, val_loss=2.47, val_accuracy=0.422, lr=0.0316] 38%|███▊      | 41/107 [19:32<30:47, 27.99s/epoch, loss=1.16, accuracy=0.748, val_loss=1.68, val_accuracy=0.58, lr=0.1]    39%|███▉      | 42/107 [20:00<30:24, 28.07s/epoch, loss=1.16, accuracy=0.751, val_loss=1.54, val_accuracy=0.634, lr=0.1] 40%|████      | 43/107 [20:28<30:00, 28.13s/epoch, loss=1.15, accuracy=0.751, val_loss=2.35, val_accuracy=0.45, lr=0.1]  41%|████      | 44/107 [20:56<29:30, 28.11s/epoch, loss=1.16, accuracy=0.753, val_loss=1.49, val_accuracy=0.666, lr=0.1] 42%|████▏     | 45/107 [21:25<29:08, 28.20s/epoch, loss=1.15, accuracy=0.751, val_loss=1.86, val_accuracy=0.581, lr=0.1] 43%|████▎     | 46/107 [21:53<28:42, 28.23s/epoch, loss=1.16, accuracy=0.75, val_loss=1.96, val_accuracy=0.507, lr=0.1]  44%|████▍     | 47/107 [22:21<28:13, 28.22s/epoch, loss=1.15, accuracy=0.75, val_loss=3.54, val_accuracy=0.291, lr=0.1] 45%|████▍     | 48/107 [22:49<27:48, 28.28s/epoch, loss=1.15, accuracy=0.752, val_loss=2.19, val_accuracy=0.519, lr=0.1] 46%|████▌     | 49/107 [23:17<27:16, 28.21s/epoch, loss=1.15, accuracy=0.75, val_loss=1.65, val_accuracy=0.59, lr=0.0316] 47%|████▋     | 50/107 [23:45<26:44, 28.15s/epoch, loss=1.16, accuracy=0.749, val_loss=1.35, val_accuracy=0.682, lr=0.1]  48%|████▊     | 51/107 [24:14<26:22, 28.25s/epoch, loss=1.15, accuracy=0.751, val_loss=4.05, val_accuracy=0.266, lr=0.1] 49%|████▊     | 52/107 [24:42<25:55, 28.28s/epoch, loss=1.14, accuracy=0.753, val_loss=2.78, val_accuracy=0.413, lr=0.1] 50%|████▉     | 53/107 [25:10<25:22, 28.20s/epoch, loss=1.15, accuracy=0.753, val_loss=2.45, val_accuracy=0.438, lr=0.1] 50%|█████     | 54/107 [25:38<24:51, 28.14s/epoch, loss=1.15, accuracy=0.751, val_loss=3.11, val_accuracy=0.301, lr=0.1] 51%|█████▏    | 55/107 [26:07<24:27, 28.21s/epoch, loss=1.15, accuracy=0.752, val_loss=2.25, val_accuracy=0.495, lr=0.0316] 52%|█████▏    | 56/107 [26:35<24:02, 28.29s/epoch, loss=1.15, accuracy=0.754, val_loss=2.26, val_accuracy=0.451, lr=0.1]    53%|█████▎    | 57/107 [27:04<23:37, 28.34s/epoch, loss=1.15, accuracy=0.753, val_loss=1.5, val_accuracy=0.648, lr=0.1]  54%|█████▍    | 58/107 [27:32<23:07, 28.32s/epoch, loss=1.15, accuracy=0.755, val_loss=1.94, val_accuracy=0.54, lr=0.1] 55%|█████▌    | 59/107 [28:00<22:40, 28.35s/epoch, loss=1.15, accuracy=0.751, val_loss=2.38, val_accuracy=0.444, lr=0.1] 56%|█████▌    | 60/107 [28:28<22:06, 28.23s/epoch, loss=1.14, accuracy=0.755, val_loss=1.84, val_accuracy=0.512, lr=0.0316] 57%|█████▋    | 61/107 [28:57<21:39, 28.24s/epoch, loss=1.15, accuracy=0.75, val_loss=1.86, val_accuracy=0.528, lr=0.1]     58%|█████▊    | 62/107 [29:24<21:03, 28.09s/epoch, loss=1.15, accuracy=0.753, val_loss=2.14, val_accuracy=0.434, lr=0.1] 59%|█████▉    | 63/107 [29:52<20:35, 28.09s/epoch, loss=1.14, accuracy=0.756, val_loss=1.6, val_accuracy=0.602, lr=0.1]  60%|█████▉    | 64/107 [30:20<20:06, 28.06s/epoch, loss=1.14, accuracy=0.755, val_loss=1.6, val_accuracy=0.58, lr=0.1]  61%|██████    | 65/107 [30:48<19:34, 27.97s/epoch, loss=1.14, accuracy=0.755, val_loss=2.11, val_accuracy=0.464, lr=0.0316] 62%|██████▏   | 66/107 [31:16<19:09, 28.03s/epoch, loss=1.14, accuracy=0.755, val_loss=1.9, val_accuracy=0.534, lr=0.1]     63%|██████▎   | 67/107 [31:44<18:40, 28.01s/epoch, loss=1.14, accuracy=0.754, val_loss=1.67, val_accuracy=0.57, lr=0.1] 64%|██████▎   | 68/107 [32:12<18:13, 28.04s/epoch, loss=1.14, accuracy=0.756, val_loss=1.96, val_accuracy=0.547, lr=0.1] 64%|██████▍   | 69/107 [32:40<17:44, 28.01s/epoch, loss=1.14, accuracy=0.754, val_loss=1.52, val_accuracy=0.625, lr=0.1] 65%|██████▌   | 70/107 [33:08<17:13, 27.93s/epoch, loss=1.14, accuracy=0.756, val_loss=2.01, val_accuracy=0.476, lr=0.0316] 66%|██████▋   | 71/107 [33:36<16:42, 27.86s/epoch, loss=1.14, accuracy=0.756, val_loss=2.39, val_accuracy=0.405, lr=0.1]    67%|██████▋   | 72/107 [34:04<16:16, 27.91s/epoch, loss=1.13, accuracy=0.756, val_loss=1.9, val_accuracy=0.581, lr=0.1]  68%|██████▊   | 73/107 [34:32<15:51, 27.98s/epoch, loss=1.13, accuracy=0.755, val_loss=2.04, val_accuracy=0.482, lr=0.1] 69%|██████▉   | 74/107 [35:00<15:24, 28.02s/epoch, loss=1.14, accuracy=0.754, val_loss=2.56, val_accuracy=0.383, lr=0.1] 70%|███████   | 75/107 [35:28<14:54, 27.96s/epoch, loss=1.13, accuracy=0.754, val_loss=2.6, val_accuracy=0.476, lr=0.0316] 71%|███████   | 76/107 [35:56<14:28, 28.02s/epoch, loss=1.14, accuracy=0.753, val_loss=2.99, val_accuracy=0.364, lr=0.1]   72%|███████▏  | 77/107 [36:24<14:01, 28.04s/epoch, loss=1.14, accuracy=0.752, val_loss=2.96, val_accuracy=0.344, lr=0.1] 73%|███████▎  | 78/107 [36:52<13:29, 27.92s/epoch, loss=1.13, accuracy=0.757, val_loss=1.7, val_accuracy=0.587, lr=0.1]  74%|███████▍  | 79/107 [37:20<13:06, 28.10s/epoch, loss=1.14, accuracy=0.755, val_loss=1.87, val_accuracy=0.501, lr=0.1] 75%|███████▍  | 80/107 [37:48<12:38, 28.10s/epoch, loss=1.13, accuracy=0.753, val_loss=1.76, val_accuracy=0.533, lr=0.0316] 76%|███████▌  | 81/107 [38:17<12:12, 28.15s/epoch, loss=1.14, accuracy=0.755, val_loss=5.59, val_accuracy=0.201, lr=0.1]    77%|███████▋  | 82/107 [38:45<11:48, 28.33s/epoch, loss=0.939, accuracy=0.809, val_loss=0.939, val_accuracy=0.788, lr=0.01] 78%|███████▊  | 83/107 [39:14<11:23, 28.48s/epoch, loss=0.745, accuracy=0.848, val_loss=0.847, val_accuracy=0.797, lr=0.01] 79%|███████▊  | 84/107 [39:42<10:49, 28.24s/epoch, loss=0.665, accuracy=0.854, val_loss=0.794, val_accuracy=0.802, lr=0.01] 79%|███████▉  | 85/107 [40:10<10:21, 28.24s/epoch, loss=0.618, accuracy=0.857, val_loss=0.755, val_accuracy=0.81, lr=0.01]  80%|████████  | 86/107 [40:37<09:46, 27.93s/epoch, loss=0.599, accuracy=0.859, val_loss=0.701, val_accuracy=0.82, lr=0.01] 81%|████████▏ | 87/107 [41:06<09:20, 28.01s/epoch, loss=0.587, accuracy=0.858, val_loss=0.811, val_accuracy=0.788, lr=0.01] 82%|████████▏ | 88/107 [41:33<08:51, 27.99s/epoch, loss=0.579, accuracy=0.861, val_loss=0.861, val_accuracy=0.772, lr=0.01] 83%|████████▎ | 89/107 [42:01<08:19, 27.76s/epoch, loss=0.576, accuracy=0.862, val_loss=1.02, val_accuracy=0.731, lr=0.01]  84%|████████▍ | 90/107 [42:29<07:55, 27.95s/epoch, loss=0.57, accuracy=0.866, val_loss=0.836, val_accuracy=0.787, lr=0.01] 85%|████████▌ | 91/107 [42:57<07:28, 28.03s/epoch, loss=0.57, accuracy=0.865, val_loss=0.914, val_accuracy=0.771, lr=0.00316] 86%|████████▌ | 92/107 [43:25<07:00, 28.01s/epoch, loss=0.566, accuracy=0.868, val_loss=1.04, val_accuracy=0.715, lr=0.01]    87%|████████▋ | 93/107 [43:54<06:33, 28.13s/epoch, loss=0.567, accuracy=0.869, val_loss=0.891, val_accuracy=0.762, lr=0.01] 88%|████████▊ | 94/107 [44:21<06:02, 27.90s/epoch, loss=0.569, accuracy=0.869, val_loss=0.929, val_accuracy=0.76, lr=0.01]  89%|████████▉ | 95/107 [44:48<05:29, 27.48s/epoch, loss=0.565, accuracy=0.872, val_loss=1.12, val_accuracy=0.707, lr=0.01] 90%|████████▉ | 96/107 [45:14<05:00, 27.32s/epoch, loss=0.567, accuracy=0.871, val_loss=0.76, val_accuracy=0.809, lr=0.00316] 91%|█████████ | 97/107 [45:42<04:34, 27.50s/epoch, loss=0.563, accuracy=0.873, val_loss=0.821, val_accuracy=0.798, lr=0.01]   92%|█████████▏| 98/107 [46:10<04:06, 27.39s/epoch, loss=0.563, accuracy=0.874, val_loss=0.756, val_accuracy=0.815, lr=0.01] 93%|█████████▎| 99/107 [46:38<03:40, 27.56s/epoch, loss=0.562, accuracy=0.873, val_loss=0.806, val_accuracy=0.794, lr=0.01] 93%|█████████▎| 100/107 [47:05<03:13, 27.65s/epoch, loss=0.562, accuracy=0.874, val_loss=0.772, val_accuracy=0.802, lr=0.01] 94%|█████████▍| 101/107 [47:34<02:47, 27.84s/epoch, loss=0.562, accuracy=0.875, val_loss=0.854, val_accuracy=0.791, lr=0.00316] 95%|█████████▌| 102/107 [48:00<02:17, 27.49s/epoch, loss=0.565, accuracy=0.875, val_loss=0.962, val_accuracy=0.755, lr=0.01]    96%|█████████▋| 103/107 [48:29<01:50, 27.73s/epoch, loss=0.562, accuracy=0.877, val_loss=0.722, val_accuracy=0.825, lr=0.01] 97%|█████████▋| 104/107 [48:57<01:23, 27.89s/epoch, loss=0.563, accuracy=0.878, val_loss=1.05, val_accuracy=0.743, lr=0.01]  98%|█████████▊| 105/107 [49:25<00:55, 27.85s/epoch, loss=0.562, accuracy=0.876, val_loss=1.03, val_accuracy=0.714, lr=0.01] 99%|█████████▉| 106/107 [49:52<00:27, 27.69s/epoch, loss=0.564, accuracy=0.877, val_loss=0.764, val_accuracy=0.81, lr=0.00316]100%|██████████| 107/107 [50:20<00:00, 27.65s/epoch, loss=0.561, accuracy=0.879, val_loss=1.16, val_accuracy=0.706, lr=0.01]   100%|██████████| 107/107 [50:20<00:00, 28.22s/epoch, loss=0.561, accuracy=0.879, val_loss=1.16, val_accuracy=0.706, lr=0.01]
Using real-time data augmentation.
Test score: 1.1574665307998657
Test accuracy: 0.7056999802589417

Mon Feb 19 15:57:42 2024       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 545.23.08              Driver Version: 545.23.08    CUDA Version: 12.3     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA TITAN X (Pascal)        Off | 00000000:83:00.0 Off |                  N/A |
| 23%   37C    P8              10W / 250W |      0MiB / 12288MiB |      0%      Default |
|                                         |                      |                  N/A |
+-----------------------------------------+----------------------+----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
|  No running processes found                                                           |
+---------------------------------------------------------------------------------------+


* * * Run SGD for cluster size = 10. * * *


Budget: 150


* * * Run SGD for ID = 10_1. * * *


2024-02-19 15:57:43.130190: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 15:57:46.360432: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-19 15:57:46.361331: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-19 15:57:46.393063: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-02-19 15:57:46.393093: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 15:57:46.396201: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-19 15:57:46.396238: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-19 15:57:46.398573: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-19 15:57:46.399447: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-19 15:57:46.401932: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-19 15:57:46.403610: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-19 15:57:46.408042: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-19 15:57:46.408542: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-19 15:57:46.408616: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-19 15:57:47.775008: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-19 15:57:47.776333: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-19 15:57:47.777742: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-02-19 15:57:47.777775: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 15:57:47.777811: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-19 15:57:47.777828: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-19 15:57:47.777842: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-19 15:57:47.777857: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-19 15:57:47.777872: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-19 15:57:47.777886: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-19 15:57:47.777901: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-19 15:57:47.778355: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-19 15:57:47.778384: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 15:57:48.376946: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-19 15:57:48.377004: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-19 15:57:48.377012: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-19 15:57:48.377858: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11227 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN X (Pascal), pci bus id: 0000:83:00.0, compute capability: 6.1)
{'id': '10_01', 'batch_size': 128, 'epochs': 150, 'validation_split': 0.1, 'checkpointing': True, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN X (Pascal)'}
x_train shape: (45000, 32, 32, 3)
45000 train samples
5000 validation samples
10000 test samples
y_train shape: (45000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/150 [00:00<?, ?epoch/s]2024-02-19 15:57:49.132684: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-19 15:57:49.145092: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2600020000 Hz
2024-02-19 15:57:50.905029: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-19 15:57:51.089448: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-19 15:57:51.682505: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-19 15:57:51.727482: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/150 [00:48<2:01:14, 48.82s/epoch, loss=3.24, accuracy=0.316, val_loss=3.48, val_accuracy=0.133, lr=0.1]  1%|▏         | 2/150 [01:05<1:13:50, 29.93s/epoch, loss=1.61, accuracy=0.526, val_loss=2.17, val_accuracy=0.386, lr=0.1]  2%|▏         | 3/150 [01:21<57:30, 23.47s/epoch, loss=1.41, accuracy=0.616, val_loss=4.98, val_accuracy=0.216, lr=0.1]    3%|▎         | 4/150 [01:37<50:21, 20.70s/epoch, loss=1.33, accuracy=0.663, val_loss=2.14, val_accuracy=0.434, lr=0.1]  3%|▎         | 5/150 [01:53<45:50, 18.97s/epoch, loss=1.28, accuracy=0.692, val_loss=2.4, val_accuracy=0.403, lr=0.1]   4%|▍         | 6/150 [02:12<45:25, 18.93s/epoch, loss=1.25, accuracy=0.706, val_loss=1.86, val_accuracy=0.561, lr=0.1]  5%|▍         | 7/150 [02:28<42:56, 18.02s/epoch, loss=1.24, accuracy=0.714, val_loss=2.31, val_accuracy=0.439, lr=0.1]  5%|▌         | 8/150 [02:45<41:46, 17.65s/epoch, loss=1.23, accuracy=0.72, val_loss=1.33, val_accuracy=0.683, lr=0.1]   6%|▌         | 9/150 [03:01<40:25, 17.20s/epoch, loss=1.23, accuracy=0.726, val_loss=2.45, val_accuracy=0.445, lr=0.1]  7%|▋         | 10/150 [03:17<39:23, 16.88s/epoch, loss=1.22, accuracy=0.726, val_loss=2.16, val_accuracy=0.384, lr=0.1]  7%|▋         | 11/150 [03:33<38:26, 16.59s/epoch, loss=1.21, accuracy=0.729, val_loss=2.4, val_accuracy=0.457, lr=0.1]   8%|▊         | 12/150 [03:51<39:11, 17.04s/epoch, loss=1.21, accuracy=0.733, val_loss=1.96, val_accuracy=0.515, lr=0.1]  9%|▊         | 13/150 [04:08<38:42, 16.95s/epoch, loss=1.19, accuracy=0.735, val_loss=1.72, val_accuracy=0.53, lr=0.0316]  9%|▉         | 14/150 [04:25<38:30, 16.99s/epoch, loss=1.2, accuracy=0.735, val_loss=1.6, val_accuracy=0.586, lr=0.1]     10%|█         | 15/150 [04:42<37:47, 16.79s/epoch, loss=1.2, accuracy=0.734, val_loss=2.63, val_accuracy=0.405, lr=0.1] 11%|█         | 16/150 [04:58<37:13, 16.67s/epoch, loss=1.19, accuracy=0.738, val_loss=1.34, val_accuracy=0.686, lr=0.1] 11%|█▏        | 17/150 [05:15<36:54, 16.65s/epoch, loss=1.19, accuracy=0.74, val_loss=2.53, val_accuracy=0.375, lr=0.1]  12%|█▏        | 18/150 [05:32<37:20, 16.98s/epoch, loss=1.19, accuracy=0.74, val_loss=2.74, val_accuracy=0.429, lr=0.0316] 13%|█▎        | 19/150 [05:49<36:46, 16.85s/epoch, loss=1.19, accuracy=0.741, val_loss=1.59, val_accuracy=0.61, lr=0.1]    13%|█▎        | 20/150 [06:05<36:20, 16.77s/epoch, loss=1.19, accuracy=0.741, val_loss=2.93, val_accuracy=0.257, lr=0.1] 14%|█▍        | 21/150 [06:22<35:42, 16.61s/epoch, loss=1.18, accuracy=0.745, val_loss=2.92, val_accuracy=0.417, lr=0.1] 15%|█▍        | 22/150 [06:39<36:06, 16.93s/epoch, loss=1.18, accuracy=0.746, val_loss=1.55, val_accuracy=0.625, lr=0.1] 15%|█▌        | 23/150 [06:58<36:41, 17.33s/epoch, loss=1.18, accuracy=0.745, val_loss=1.49, val_accuracy=0.627, lr=0.0316] 16%|█▌        | 24/150 [07:15<36:12, 17.25s/epoch, loss=1.17, accuracy=0.748, val_loss=1.83, val_accuracy=0.544, lr=0.1]    17%|█▋        | 25/150 [07:32<36:06, 17.33s/epoch, loss=1.17, accuracy=0.747, val_loss=3.08, val_accuracy=0.299, lr=0.1] 17%|█▋        | 26/150 [07:49<35:18, 17.08s/epoch, loss=1.17, accuracy=0.745, val_loss=2.98, val_accuracy=0.347, lr=0.1] 18%|█▊        | 27/150 [08:06<35:24, 17.27s/epoch, loss=1.16, accuracy=0.747, val_loss=1.8, val_accuracy=0.529, lr=0.1]  19%|█▊        | 28/150 [08:23<34:52, 17.16s/epoch, loss=1.17, accuracy=0.746, val_loss=2.84, val_accuracy=0.429, lr=0.0316] 19%|█▉        | 29/150 [08:41<34:57, 17.33s/epoch, loss=1.16, accuracy=0.749, val_loss=2.45, val_accuracy=0.465, lr=0.1]    20%|██        | 30/150 [08:58<34:09, 17.08s/epoch, loss=1.16, accuracy=0.749, val_loss=1.69, val_accuracy=0.59, lr=0.1]  21%|██        | 31/150 [09:14<33:19, 16.80s/epoch, loss=1.15, accuracy=0.751, val_loss=1.53, val_accuracy=0.613, lr=0.1] 21%|██▏       | 32/150 [09:32<33:52, 17.23s/epoch, loss=1.15, accuracy=0.75, val_loss=2.5, val_accuracy=0.392, lr=0.1]   22%|██▏       | 33/150 [09:48<33:12, 17.03s/epoch, loss=1.15, accuracy=0.749, val_loss=2.45, val_accuracy=0.488, lr=0.0316] 23%|██▎       | 34/150 [10:06<33:12, 17.18s/epoch, loss=1.16, accuracy=0.75, val_loss=2.33, val_accuracy=0.441, lr=0.1]     23%|██▎       | 35/150 [10:23<33:05, 17.27s/epoch, loss=1.16, accuracy=0.75, val_loss=2.14, val_accuracy=0.493, lr=0.1] 24%|██▍       | 36/150 [10:40<32:29, 17.10s/epoch, loss=1.15, accuracy=0.752, val_loss=2.41, val_accuracy=0.403, lr=0.1] 25%|██▍       | 37/150 [10:58<32:42, 17.37s/epoch, loss=1.14, accuracy=0.754, val_loss=1.87, val_accuracy=0.559, lr=0.1] 25%|██▌       | 38/150 [11:16<32:33, 17.44s/epoch, loss=1.14, accuracy=0.756, val_loss=1.49, val_accuracy=0.64, lr=0.0316] 26%|██▌       | 39/150 [11:34<32:54, 17.78s/epoch, loss=1.15, accuracy=0.754, val_loss=1.3, val_accuracy=0.691, lr=0.1]    27%|██▋       | 40/150 [11:52<32:17, 17.61s/epoch, loss=1.14, accuracy=0.755, val_loss=1.91, val_accuracy=0.521, lr=0.1] 27%|██▋       | 41/150 [12:08<31:20, 17.25s/epoch, loss=1.14, accuracy=0.754, val_loss=1.37, val_accuracy=0.677, lr=0.1] 28%|██▊       | 42/150 [12:24<30:39, 17.03s/epoch, loss=1.14, accuracy=0.754, val_loss=1.6, val_accuracy=0.596, lr=0.1]  29%|██▊       | 43/150 [12:41<30:15, 16.96s/epoch, loss=1.14, accuracy=0.756, val_loss=1.83, val_accuracy=0.525, lr=0.1] 29%|██▉       | 44/150 [12:58<29:43, 16.82s/epoch, loss=1.14, accuracy=0.755, val_loss=2.14, val_accuracy=0.488, lr=0.0316] 30%|███       | 45/150 [13:14<29:09, 16.66s/epoch, loss=1.14, accuracy=0.755, val_loss=1.96, val_accuracy=0.507, lr=0.1]    31%|███       | 46/150 [13:30<28:43, 16.57s/epoch, loss=1.14, accuracy=0.754, val_loss=1.42, val_accuracy=0.657, lr=0.1] 31%|███▏      | 47/150 [13:48<28:45, 16.76s/epoch, loss=1.14, accuracy=0.755, val_loss=1.73, val_accuracy=0.588, lr=0.1] 32%|███▏      | 48/150 [14:04<28:20, 16.67s/epoch, loss=1.14, accuracy=0.756, val_loss=2.27, val_accuracy=0.486, lr=0.1] 33%|███▎      | 49/150 [14:20<27:53, 16.57s/epoch, loss=1.13, accuracy=0.757, val_loss=2.64, val_accuracy=0.345, lr=0.0316] 33%|███▎      | 50/150 [14:37<27:29, 16.50s/epoch, loss=1.13, accuracy=0.753, val_loss=3.51, val_accuracy=0.286, lr=0.1]    34%|███▍      | 51/150 [14:53<27:06, 16.43s/epoch, loss=1.13, accuracy=0.758, val_loss=1.78, val_accuracy=0.542, lr=0.1] 35%|███▍      | 52/150 [15:10<26:59, 16.52s/epoch, loss=1.12, accuracy=0.758, val_loss=2.01, val_accuracy=0.491, lr=0.1] 35%|███▌      | 53/150 [15:26<26:35, 16.45s/epoch, loss=1.13, accuracy=0.756, val_loss=6.25, val_accuracy=0.199, lr=0.1] 36%|███▌      | 54/150 [15:42<25:57, 16.22s/epoch, loss=1.13, accuracy=0.757, val_loss=1.87, val_accuracy=0.518, lr=0.0316] 37%|███▋      | 55/150 [15:58<25:36, 16.17s/epoch, loss=1.12, accuracy=0.757, val_loss=1.8, val_accuracy=0.562, lr=0.1]     37%|███▋      | 56/150 [16:14<25:18, 16.16s/epoch, loss=1.12, accuracy=0.76, val_loss=2.42, val_accuracy=0.447, lr=0.1] 38%|███▊      | 57/150 [16:30<24:58, 16.11s/epoch, loss=1.13, accuracy=0.755, val_loss=1.7, val_accuracy=0.585, lr=0.1] 39%|███▊      | 58/150 [16:48<25:24, 16.57s/epoch, loss=1.12, accuracy=0.759, val_loss=1.53, val_accuracy=0.625, lr=0.1] 39%|███▉      | 59/150 [17:04<24:56, 16.44s/epoch, loss=1.12, accuracy=0.757, val_loss=1.63, val_accuracy=0.599, lr=0.0316] 40%|████      | 60/150 [17:20<24:35, 16.39s/epoch, loss=1.12, accuracy=0.757, val_loss=3.55, val_accuracy=0.267, lr=0.1]    41%|████      | 61/150 [17:37<24:24, 16.46s/epoch, loss=1.12, accuracy=0.758, val_loss=1.53, val_accuracy=0.623, lr=0.1] 41%|████▏     | 62/150 [17:53<23:56, 16.32s/epoch, loss=1.13, accuracy=0.757, val_loss=1.47, val_accuracy=0.64, lr=0.1]  42%|████▏     | 63/150 [18:09<23:36, 16.28s/epoch, loss=1.13, accuracy=0.758, val_loss=1.53, val_accuracy=0.632, lr=0.1] 43%|████▎     | 64/150 [18:25<23:08, 16.15s/epoch, loss=1.12, accuracy=0.76, val_loss=1.96, val_accuracy=0.509, lr=0.0316] 43%|████▎     | 65/150 [18:41<22:54, 16.17s/epoch, loss=1.13, accuracy=0.757, val_loss=2.82, val_accuracy=0.374, lr=0.1]   44%|████▍     | 66/150 [18:57<22:32, 16.11s/epoch, loss=1.12, accuracy=0.759, val_loss=1.4, val_accuracy=0.657, lr=0.1]  45%|████▍     | 67/150 [19:13<22:12, 16.05s/epoch, loss=1.12, accuracy=0.759, val_loss=2.32, val_accuracy=0.408, lr=0.1] 45%|████▌     | 68/150 [19:29<21:56, 16.05s/epoch, loss=1.11, accuracy=0.76, val_loss=2.48, val_accuracy=0.404, lr=0.1]  46%|████▌     | 69/150 [19:45<21:41, 16.06s/epoch, loss=1.12, accuracy=0.759, val_loss=2.19, val_accuracy=0.403, lr=0.0316] 47%|████▋     | 70/150 [20:00<21:13, 15.92s/epoch, loss=1.12, accuracy=0.755, val_loss=1.42, val_accuracy=0.637, lr=0.1]    47%|████▋     | 71/150 [20:16<20:54, 15.88s/epoch, loss=1.11, accuracy=0.76, val_loss=1.63, val_accuracy=0.559, lr=0.1]  48%|████▊     | 72/150 [20:32<20:38, 15.88s/epoch, loss=1.11, accuracy=0.757, val_loss=4.61, val_accuracy=0.256, lr=0.1] 49%|████▊     | 73/150 [20:48<20:22, 15.87s/epoch, loss=1.12, accuracy=0.76, val_loss=3.6, val_accuracy=0.222, lr=0.1]   49%|████▉     | 74/150 [21:04<20:01, 15.81s/epoch, loss=1.11, accuracy=0.758, val_loss=1.74, val_accuracy=0.565, lr=0.0316] 50%|█████     | 75/150 [21:20<19:48, 15.84s/epoch, loss=1.12, accuracy=0.759, val_loss=2.14, val_accuracy=0.422, lr=0.1]    51%|█████     | 76/150 [21:36<19:40, 15.95s/epoch, loss=1.11, accuracy=0.761, val_loss=2.18, val_accuracy=0.487, lr=0.1] 51%|█████▏    | 77/150 [21:52<19:26, 15.98s/epoch, loss=1.11, accuracy=0.758, val_loss=2.16, val_accuracy=0.505, lr=0.1] 52%|█████▏    | 78/150 [22:08<19:23, 16.16s/epoch, loss=1.11, accuracy=0.757, val_loss=3.06, val_accuracy=0.415, lr=0.1] 53%|█████▎    | 79/150 [22:26<19:41, 16.64s/epoch, loss=1.11, accuracy=0.758, val_loss=1.99, val_accuracy=0.47, lr=0.0316] 53%|█████▎    | 80/150 [22:42<19:13, 16.48s/epoch, loss=1.11, accuracy=0.759, val_loss=2.27, val_accuracy=0.474, lr=0.1]   54%|█████▍    | 81/150 [22:59<19:12, 16.70s/epoch, loss=1.12, accuracy=0.757, val_loss=1.43, val_accuracy=0.644, lr=0.1] 55%|█████▍    | 82/150 [23:17<19:06, 16.87s/epoch, loss=0.923, accuracy=0.816, val_loss=0.919, val_accuracy=0.8, lr=0.01] 55%|█████▌    | 83/150 [23:33<18:42, 16.76s/epoch, loss=0.743, accuracy=0.849, val_loss=0.914, val_accuracy=0.773, lr=0.01] 56%|█████▌    | 84/150 [23:52<18:57, 17.24s/epoch, loss=0.659, accuracy=0.858, val_loss=0.752, val_accuracy=0.821, lr=0.01] 57%|█████▋    | 85/150 [24:07<18:08, 16.74s/epoch, loss=0.61, accuracy=0.862, val_loss=0.736, val_accuracy=0.812, lr=0.01]  57%|█████▋    | 86/150 [24:23<17:32, 16.44s/epoch, loss=0.583, accuracy=0.865, val_loss=0.687, val_accuracy=0.824, lr=0.01] 58%|█████▊    | 87/150 [24:39<17:03, 16.25s/epoch, loss=0.572, accuracy=0.865, val_loss=0.927, val_accuracy=0.758, lr=0.01] 59%|█████▊    | 88/150 [24:55<16:42, 16.18s/epoch, loss=0.558, accuracy=0.866, val_loss=0.795, val_accuracy=0.798, lr=0.01] 59%|█████▉    | 89/150 [25:11<16:36, 16.34s/epoch, loss=0.556, accuracy=0.868, val_loss=0.649, val_accuracy=0.836, lr=0.01] 60%|██████    | 90/150 [25:29<16:34, 16.57s/epoch, loss=0.558, accuracy=0.868, val_loss=0.762, val_accuracy=0.802, lr=0.01] 61%|██████    | 91/150 [25:45<16:15, 16.53s/epoch, loss=0.552, accuracy=0.869, val_loss=0.67, val_accuracy=0.83, lr=0.01]   61%|██████▏   | 92/150 [26:01<15:45, 16.31s/epoch, loss=0.549, accuracy=0.873, val_loss=0.906, val_accuracy=0.768, lr=0.01] 62%|██████▏   | 93/150 [26:18<15:38, 16.46s/epoch, loss=0.549, accuracy=0.872, val_loss=0.784, val_accuracy=0.793, lr=0.01] 63%|██████▎   | 94/150 [26:33<15:08, 16.22s/epoch, loss=0.55, accuracy=0.872, val_loss=1.25, val_accuracy=0.676, lr=0.00316] 63%|██████▎   | 95/150 [26:49<14:42, 16.04s/epoch, loss=0.552, accuracy=0.874, val_loss=1.02, val_accuracy=0.74, lr=0.01]    64%|██████▍   | 96/150 [27:05<14:23, 15.99s/epoch, loss=0.553, accuracy=0.876, val_loss=0.742, val_accuracy=0.814, lr=0.01] 65%|██████▍   | 97/150 [27:21<14:18, 16.20s/epoch, loss=0.547, accuracy=0.877, val_loss=0.931, val_accuracy=0.764, lr=0.01] 65%|██████▌   | 98/150 [27:38<14:06, 16.28s/epoch, loss=0.546, accuracy=0.878, val_loss=0.801, val_accuracy=0.805, lr=0.01] 66%|██████▌   | 99/150 [27:54<13:40, 16.09s/epoch, loss=0.549, accuracy=0.877, val_loss=0.743, val_accuracy=0.814, lr=0.00316] 67%|██████▋   | 100/150 [28:10<13:23, 16.06s/epoch, loss=0.549, accuracy=0.879, val_loss=0.687, val_accuracy=0.828, lr=0.01]   67%|██████▋   | 101/150 [28:26<13:09, 16.11s/epoch, loss=0.547, accuracy=0.88, val_loss=0.964, val_accuracy=0.757, lr=0.01]  68%|██████▊   | 102/150 [28:42<12:51, 16.08s/epoch, loss=0.547, accuracy=0.88, val_loss=0.912, val_accuracy=0.765, lr=0.01] 69%|██████▊   | 103/150 [28:57<12:29, 15.95s/epoch, loss=0.547, accuracy=0.88, val_loss=0.878, val_accuracy=0.789, lr=0.01] 69%|██████▉   | 104/150 [29:13<12:12, 15.92s/epoch, loss=0.547, accuracy=0.881, val_loss=0.997, val_accuracy=0.74, lr=0.00316] 70%|███████   | 105/150 [29:30<12:05, 16.12s/epoch, loss=0.542, accuracy=0.883, val_loss=0.738, val_accuracy=0.819, lr=0.01]   71%|███████   | 106/150 [29:46<11:49, 16.13s/epoch, loss=0.547, accuracy=0.884, val_loss=1.13, val_accuracy=0.76, lr=0.01]   71%|███████▏  | 107/150 [30:02<11:28, 16.01s/epoch, loss=0.543, accuracy=0.883, val_loss=0.907, val_accuracy=0.764, lr=0.01] 72%|███████▏  | 108/150 [30:17<11:06, 15.86s/epoch, loss=0.548, accuracy=0.883, val_loss=0.896, val_accuracy=0.795, lr=0.01] 73%|███████▎  | 109/150 [30:33<10:44, 15.72s/epoch, loss=0.544, accuracy=0.884, val_loss=0.88, val_accuracy=0.788, lr=0.00316] 73%|███████▎  | 110/150 [30:49<10:31, 15.80s/epoch, loss=0.548, accuracy=0.883, val_loss=0.785, val_accuracy=0.81, lr=0.01]    74%|███████▍  | 111/150 [31:06<10:30, 16.16s/epoch, loss=0.542, accuracy=0.887, val_loss=0.826, val_accuracy=0.794, lr=0.01] 75%|███████▍  | 112/150 [31:22<10:12, 16.13s/epoch, loss=0.541, accuracy=0.887, val_loss=1.04, val_accuracy=0.76, lr=0.01]   75%|███████▌  | 113/150 [31:38<10:03, 16.31s/epoch, loss=0.55, accuracy=0.883, val_loss=0.88, val_accuracy=0.778, lr=0.01] 76%|███████▌  | 114/150 [31:55<09:45, 16.26s/epoch, loss=0.542, accuracy=0.887, val_loss=0.828, val_accuracy=0.797, lr=0.00316] 77%|███████▋  | 115/150 [32:10<09:24, 16.14s/epoch, loss=0.546, accuracy=0.885, val_loss=0.798, val_accuracy=0.813, lr=0.01]    77%|███████▋  | 116/150 [32:27<09:11, 16.21s/epoch, loss=0.552, accuracy=0.883, val_loss=1.08, val_accuracy=0.737, lr=0.01]  78%|███████▊  | 117/150 [32:43<08:56, 16.25s/epoch, loss=0.547, accuracy=0.886, val_loss=0.882, val_accuracy=0.763, lr=0.01] 79%|███████▊  | 118/150 [33:00<08:48, 16.52s/epoch, loss=0.543, accuracy=0.887, val_loss=1.36, val_accuracy=0.673, lr=0.01]  79%|███████▉  | 119/150 [33:16<08:27, 16.36s/epoch, loss=0.547, accuracy=0.885, val_loss=1.04, val_accuracy=0.749, lr=0.00316] 80%|████████  | 120/150 [33:33<08:15, 16.53s/epoch, loss=0.547, accuracy=0.887, val_loss=0.99, val_accuracy=0.734, lr=0.01]    81%|████████  | 121/150 [33:49<07:56, 16.44s/epoch, loss=0.544, accuracy=0.888, val_loss=0.828, val_accuracy=0.8, lr=0.01]  81%|████████▏ | 122/150 [34:06<07:41, 16.47s/epoch, loss=0.472, accuracy=0.914, val_loss=0.521, val_accuracy=0.896, lr=0.001] 82%|████████▏ | 123/150 [34:22<07:23, 16.42s/epoch, loss=0.415, accuracy=0.932, val_loss=0.509, val_accuracy=0.899, lr=0.001] 83%|████████▎ | 124/150 [34:39<07:10, 16.56s/epoch, loss=0.395, accuracy=0.938, val_loss=0.499, val_accuracy=0.9, lr=0.001]   83%|████████▎ | 125/150 [34:57<07:05, 17.00s/epoch, loss=0.378, accuracy=0.941, val_loss=0.494, val_accuracy=0.9, lr=0.001] 84%|████████▍ | 126/150 [35:13<06:41, 16.72s/epoch, loss=0.366, accuracy=0.943, val_loss=0.48, val_accuracy=0.905, lr=0.001] 85%|████████▍ | 127/150 [35:30<06:22, 16.64s/epoch, loss=0.355, accuracy=0.946, val_loss=0.481, val_accuracy=0.902, lr=0.001] 85%|████████▌ | 128/150 [35:46<06:03, 16.52s/epoch, loss=0.343, accuracy=0.949, val_loss=0.489, val_accuracy=0.903, lr=0.001] 86%|████████▌ | 129/150 [36:02<05:47, 16.52s/epoch, loss=0.334, accuracy=0.949, val_loss=0.48, val_accuracy=0.903, lr=0.001]  87%|████████▋ | 130/150 [36:19<05:30, 16.54s/epoch, loss=0.322, accuracy=0.952, val_loss=0.473, val_accuracy=0.904, lr=0.001] 87%|████████▋ | 131/150 [36:35<05:12, 16.47s/epoch, loss=0.318, accuracy=0.951, val_loss=0.474, val_accuracy=0.906, lr=0.001] 88%|████████▊ | 132/150 [36:52<04:58, 16.58s/epoch, loss=0.309, accuracy=0.954, val_loss=0.456, val_accuracy=0.91, lr=0.001]  89%|████████▊ | 133/150 [37:08<04:39, 16.47s/epoch, loss=0.301, accuracy=0.955, val_loss=0.469, val_accuracy=0.904, lr=0.001] 89%|████████▉ | 134/150 [37:25<04:22, 16.40s/epoch, loss=0.294, accuracy=0.956, val_loss=0.471, val_accuracy=0.904, lr=0.001] 90%|█████████ | 135/150 [37:41<04:05, 16.39s/epoch, loss=0.285, accuracy=0.959, val_loss=0.456, val_accuracy=0.904, lr=0.001] 91%|█████████ | 136/150 [37:57<03:49, 16.39s/epoch, loss=0.281, accuracy=0.959, val_loss=0.458, val_accuracy=0.904, lr=0.001] 91%|█████████▏| 137/150 [38:13<03:31, 16.23s/epoch, loss=0.274, accuracy=0.96, val_loss=0.462, val_accuracy=0.906, lr=0.001]  92%|█████████▏| 138/150 [38:29<03:14, 16.17s/epoch, loss=0.268, accuracy=0.961, val_loss=0.468, val_accuracy=0.899, lr=0.001] 93%|█████████▎| 139/150 [38:48<03:04, 16.81s/epoch, loss=0.262, accuracy=0.962, val_loss=0.461, val_accuracy=0.899, lr=0.001] 93%|█████████▎| 140/150 [39:04<02:46, 16.66s/epoch, loss=0.256, accuracy=0.962, val_loss=0.49, val_accuracy=0.898, lr=0.000316] 94%|█████████▍| 141/150 [39:22<02:34, 17.19s/epoch, loss=0.255, accuracy=0.962, val_loss=0.453, val_accuracy=0.901, lr=0.001]   95%|█████████▍| 142/150 [39:39<02:16, 17.09s/epoch, loss=0.251, accuracy=0.962, val_loss=0.472, val_accuracy=0.899, lr=0.001] 95%|█████████▌| 143/150 [39:57<02:01, 17.34s/epoch, loss=0.247, accuracy=0.962, val_loss=0.46, val_accuracy=0.902, lr=0.001]  96%|█████████▌| 144/150 [40:14<01:42, 17.15s/epoch, loss=0.241, accuracy=0.964, val_loss=0.471, val_accuracy=0.903, lr=0.001] 97%|█████████▋| 145/150 [40:30<01:24, 16.92s/epoch, loss=0.237, accuracy=0.965, val_loss=0.475, val_accuracy=0.899, lr=0.001] 97%|█████████▋| 146/150 [40:47<01:07, 16.88s/epoch, loss=0.232, accuracy=0.965, val_loss=0.452, val_accuracy=0.904, lr=0.001] 98%|█████████▊| 147/150 [41:03<00:50, 16.75s/epoch, loss=0.228, accuracy=0.965, val_loss=0.468, val_accuracy=0.895, lr=0.001] 99%|█████████▊| 148/150 [41:19<00:32, 16.38s/epoch, loss=0.228, accuracy=0.965, val_loss=0.489, val_accuracy=0.892, lr=0.001] 99%|█████████▉| 149/150 [41:35<00:16, 16.24s/epoch, loss=0.223, accuracy=0.966, val_loss=0.475, val_accuracy=0.898, lr=0.001]100%|██████████| 150/150 [41:51<00:00, 16.27s/epoch, loss=0.219, accuracy=0.968, val_loss=0.49, val_accuracy=0.891, lr=0.001] 100%|██████████| 150/150 [41:51<00:00, 16.74s/epoch, loss=0.219, accuracy=0.968, val_loss=0.49, val_accuracy=0.891, lr=0.001]
Using real-time data augmentation.
Test score: 0.4729832410812378
Test accuracy: 0.897599995136261


* * * Run SGD for ID = 10_2. * * *


2024-02-19 16:39:45.956331: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 16:39:48.651763: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-19 16:39:48.652689: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-19 16:39:48.688305: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-02-19 16:39:48.688332: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 16:39:48.690833: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-19 16:39:48.690868: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-19 16:39:48.692830: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-19 16:39:48.693482: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-19 16:39:48.695669: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-19 16:39:48.697046: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-19 16:39:48.701234: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-19 16:39:48.701708: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-19 16:39:48.701781: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-19 16:39:50.075027: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-19 16:39:50.076037: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-19 16:39:50.076736: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-02-19 16:39:50.076767: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 16:39:50.076802: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-19 16:39:50.076819: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-19 16:39:50.076833: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-19 16:39:50.076849: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-19 16:39:50.076864: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-19 16:39:50.076878: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-19 16:39:50.076902: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-19 16:39:50.077349: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-19 16:39:50.077383: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 16:39:50.679223: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-19 16:39:50.679275: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-19 16:39:50.679282: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-19 16:39:50.680122: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11227 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN X (Pascal), pci bus id: 0000:83:00.0, compute capability: 6.1)
{'id': '10_02', 'batch_size': 128, 'epochs': 150, 'validation_split': 0.1, 'checkpointing': True, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN X (Pascal)'}
x_train shape: (45000, 32, 32, 3)
45000 train samples
5000 validation samples
10000 test samples
y_train shape: (45000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/150 [00:00<?, ?epoch/s]2024-02-19 16:39:51.452789: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-19 16:39:51.465073: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2600020000 Hz
2024-02-19 16:39:53.289284: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-19 16:39:53.463291: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-19 16:39:54.134304: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-19 16:39:54.169110: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/150 [00:43<1:46:48, 43.01s/epoch, loss=3.62, accuracy=0.28, val_loss=2.31, val_accuracy=0.26, lr=0.1]  1%|▏         | 2/150 [00:59<1:07:49, 27.50s/epoch, loss=1.77, accuracy=0.443, val_loss=1.95, val_accuracy=0.419, lr=0.1]  2%|▏         | 3/150 [01:16<54:54, 22.41s/epoch, loss=1.48, accuracy=0.564, val_loss=1.69, val_accuracy=0.512, lr=0.1]    3%|▎         | 4/150 [01:32<48:41, 20.01s/epoch, loss=1.32, accuracy=0.648, val_loss=1.91, val_accuracy=0.438, lr=0.1]  3%|▎         | 5/150 [01:50<46:23, 19.20s/epoch, loss=1.27, accuracy=0.686, val_loss=1.89, val_accuracy=0.523, lr=0.1]  4%|▍         | 6/150 [02:07<44:32, 18.56s/epoch, loss=1.26, accuracy=0.7, val_loss=2.57, val_accuracy=0.359, lr=0.1]    5%|▍         | 7/150 [02:25<43:29, 18.25s/epoch, loss=1.24, accuracy=0.708, val_loss=2.31, val_accuracy=0.431, lr=0.1]  5%|▌         | 8/150 [02:41<41:53, 17.70s/epoch, loss=1.24, accuracy=0.716, val_loss=3.48, val_accuracy=0.398, lr=0.0316]  6%|▌         | 9/150 [02:58<41:24, 17.62s/epoch, loss=1.22, accuracy=0.72, val_loss=1.59, val_accuracy=0.584, lr=0.1]      7%|▋         | 10/150 [03:16<40:53, 17.52s/epoch, loss=1.22, accuracy=0.726, val_loss=2.52, val_accuracy=0.431, lr=0.1]  7%|▋         | 11/150 [03:33<40:33, 17.51s/epoch, loss=1.21, accuracy=0.728, val_loss=1.51, val_accuracy=0.623, lr=0.1]  8%|▊         | 12/150 [03:50<39:50, 17.32s/epoch, loss=1.21, accuracy=0.73, val_loss=2.08, val_accuracy=0.51, lr=0.1]    9%|▊         | 13/150 [04:06<38:47, 16.99s/epoch, loss=1.2, accuracy=0.731, val_loss=1.99, val_accuracy=0.502, lr=0.1]  9%|▉         | 14/150 [04:23<38:22, 16.93s/epoch, loss=1.2, accuracy=0.737, val_loss=1.78, val_accuracy=0.527, lr=0.1] 10%|█         | 15/150 [04:41<38:45, 17.23s/epoch, loss=1.2, accuracy=0.739, val_loss=2.35, val_accuracy=0.492, lr=0.1] 11%|█         | 16/150 [04:58<38:26, 17.21s/epoch, loss=1.2, accuracy=0.74, val_loss=1.73, val_accuracy=0.592, lr=0.0316] 11%|█▏        | 17/150 [05:16<38:33, 17.40s/epoch, loss=1.19, accuracy=0.739, val_loss=2.59, val_accuracy=0.397, lr=0.1]  12%|█▏        | 18/150 [05:34<38:18, 17.41s/epoch, loss=1.19, accuracy=0.742, val_loss=1.79, val_accuracy=0.573, lr=0.1] 13%|█▎        | 19/150 [05:50<37:37, 17.23s/epoch, loss=1.19, accuracy=0.743, val_loss=1.88, val_accuracy=0.511, lr=0.1] 13%|█▎        | 20/150 [06:09<37:57, 17.52s/epoch, loss=1.18, accuracy=0.744, val_loss=2.43, val_accuracy=0.462, lr=0.1] 14%|█▍        | 21/150 [06:26<37:32, 17.46s/epoch, loss=1.18, accuracy=0.744, val_loss=1.75, val_accuracy=0.566, lr=0.0316] 15%|█▍        | 22/150 [06:43<36:51, 17.28s/epoch, loss=1.18, accuracy=0.743, val_loss=1.73, val_accuracy=0.53, lr=0.1]     15%|█▌        | 23/150 [06:59<36:07, 17.07s/epoch, loss=1.18, accuracy=0.748, val_loss=1.78, val_accuracy=0.543, lr=0.1] 16%|█▌        | 24/150 [07:17<35:58, 17.13s/epoch, loss=1.18, accuracy=0.746, val_loss=2.93, val_accuracy=0.372, lr=0.1] 17%|█▋        | 25/150 [07:34<35:45, 17.16s/epoch, loss=1.17, accuracy=0.747, val_loss=1.37, val_accuracy=0.671, lr=0.1] 17%|█▋        | 26/150 [07:50<35:04, 16.97s/epoch, loss=1.18, accuracy=0.747, val_loss=2.56, val_accuracy=0.47, lr=0.1]  18%|█▊        | 27/150 [08:07<34:33, 16.86s/epoch, loss=1.18, accuracy=0.746, val_loss=1.61, val_accuracy=0.578, lr=0.1] 19%|█▊        | 28/150 [08:24<34:06, 16.77s/epoch, loss=1.18, accuracy=0.748, val_loss=1.98, val_accuracy=0.513, lr=0.1] 19%|█▉        | 29/150 [08:40<33:43, 16.72s/epoch, loss=1.18, accuracy=0.745, val_loss=1.58, val_accuracy=0.595, lr=0.1] 20%|██        | 30/150 [08:57<33:28, 16.74s/epoch, loss=1.17, accuracy=0.747, val_loss=2.07, val_accuracy=0.503, lr=0.0316] 21%|██        | 31/150 [09:13<32:49, 16.55s/epoch, loss=1.17, accuracy=0.75, val_loss=2.9, val_accuracy=0.308, lr=0.1]      21%|██▏       | 32/150 [09:29<32:17, 16.42s/epoch, loss=1.17, accuracy=0.748, val_loss=2.35, val_accuracy=0.386, lr=0.1] 22%|██▏       | 33/150 [09:46<32:02, 16.43s/epoch, loss=1.16, accuracy=0.75, val_loss=1.87, val_accuracy=0.576, lr=0.1]  23%|██▎       | 34/150 [10:02<31:39, 16.38s/epoch, loss=1.17, accuracy=0.748, val_loss=3.36, val_accuracy=0.278, lr=0.1] 23%|██▎       | 35/150 [10:18<31:27, 16.41s/epoch, loss=1.17, accuracy=0.748, val_loss=2.01, val_accuracy=0.483, lr=0.0316] 24%|██▍       | 36/150 [10:36<32:03, 16.88s/epoch, loss=1.17, accuracy=0.751, val_loss=1.54, val_accuracy=0.604, lr=0.1]    25%|██▍       | 37/150 [10:53<31:32, 16.75s/epoch, loss=1.16, accuracy=0.752, val_loss=2.08, val_accuracy=0.423, lr=0.1] 25%|██▌       | 38/150 [11:09<31:10, 16.70s/epoch, loss=1.16, accuracy=0.753, val_loss=2.41, val_accuracy=0.408, lr=0.1] 26%|██▌       | 39/150 [11:27<31:24, 16.98s/epoch, loss=1.17, accuracy=0.75, val_loss=2.16, val_accuracy=0.518, lr=0.1]  27%|██▋       | 40/150 [11:45<31:44, 17.31s/epoch, loss=1.16, accuracy=0.751, val_loss=2.33, val_accuracy=0.396, lr=0.0316] 27%|██▋       | 41/150 [12:02<31:21, 17.26s/epoch, loss=1.16, accuracy=0.754, val_loss=4.52, val_accuracy=0.262, lr=0.1]    28%|██▊       | 42/150 [12:19<31:00, 17.23s/epoch, loss=1.16, accuracy=0.753, val_loss=1.62, val_accuracy=0.6, lr=0.1]   29%|██▊       | 43/150 [12:36<30:33, 17.14s/epoch, loss=1.15, accuracy=0.754, val_loss=1.61, val_accuracy=0.61, lr=0.1] 29%|██▉       | 44/150 [12:53<29:55, 16.94s/epoch, loss=1.15, accuracy=0.752, val_loss=3.03, val_accuracy=0.385, lr=0.1] 30%|███       | 45/150 [13:10<29:38, 16.94s/epoch, loss=1.16, accuracy=0.753, val_loss=1.39, val_accuracy=0.657, lr=0.0316] 31%|███       | 46/150 [13:26<28:57, 16.71s/epoch, loss=1.16, accuracy=0.753, val_loss=1.78, val_accuracy=0.565, lr=0.1]    31%|███▏      | 47/150 [13:42<28:24, 16.55s/epoch, loss=1.15, accuracy=0.754, val_loss=1.42, val_accuracy=0.645, lr=0.1] 32%|███▏      | 48/150 [13:58<27:58, 16.45s/epoch, loss=1.15, accuracy=0.756, val_loss=2.13, val_accuracy=0.53, lr=0.1]  33%|███▎      | 49/150 [14:14<27:34, 16.38s/epoch, loss=1.15, accuracy=0.756, val_loss=1.55, val_accuracy=0.615, lr=0.1] 33%|███▎      | 50/150 [14:32<27:50, 16.70s/epoch, loss=1.15, accuracy=0.755, val_loss=2, val_accuracy=0.492, lr=0.0316] 34%|███▍      | 51/150 [14:49<27:30, 16.67s/epoch, loss=1.14, accuracy=0.756, val_loss=1.73, val_accuracy=0.577, lr=0.1] 35%|███▍      | 52/150 [15:05<26:59, 16.53s/epoch, loss=1.15, accuracy=0.754, val_loss=1.64, val_accuracy=0.611, lr=0.1] 35%|███▌      | 53/150 [15:21<26:48, 16.58s/epoch, loss=1.15, accuracy=0.753, val_loss=1.44, val_accuracy=0.645, lr=0.1] 36%|███▌      | 54/150 [15:38<26:30, 16.57s/epoch, loss=1.14, accuracy=0.754, val_loss=1.44, val_accuracy=0.648, lr=0.1] 37%|███▋      | 55/150 [15:54<25:57, 16.40s/epoch, loss=1.14, accuracy=0.757, val_loss=1.7, val_accuracy=0.583, lr=0.0316] 37%|███▋      | 56/150 [16:10<25:33, 16.32s/epoch, loss=1.14, accuracy=0.755, val_loss=2.23, val_accuracy=0.496, lr=0.1]   38%|███▊      | 57/150 [16:27<25:35, 16.51s/epoch, loss=1.14, accuracy=0.756, val_loss=2.38, val_accuracy=0.404, lr=0.1] 39%|███▊      | 58/150 [16:45<25:54, 16.90s/epoch, loss=1.14, accuracy=0.757, val_loss=2.29, val_accuracy=0.404, lr=0.1] 39%|███▉      | 59/150 [17:03<26:15, 17.31s/epoch, loss=1.15, accuracy=0.754, val_loss=2.45, val_accuracy=0.369, lr=0.1] 40%|████      | 60/150 [17:20<25:50, 17.23s/epoch, loss=1.14, accuracy=0.757, val_loss=3.1, val_accuracy=0.348, lr=0.0316] 41%|████      | 61/150 [17:38<25:38, 17.29s/epoch, loss=1.14, accuracy=0.755, val_loss=4.04, val_accuracy=0.272, lr=0.1]   41%|████▏     | 62/150 [17:54<25:06, 17.12s/epoch, loss=1.15, accuracy=0.755, val_loss=2.92, val_accuracy=0.313, lr=0.1] 42%|████▏     | 63/150 [18:12<25:04, 17.30s/epoch, loss=1.14, accuracy=0.757, val_loss=2.08, val_accuracy=0.512, lr=0.1] 43%|████▎     | 64/150 [18:29<24:33, 17.13s/epoch, loss=1.14, accuracy=0.758, val_loss=1.85, val_accuracy=0.481, lr=0.1] 43%|████▎     | 65/150 [18:47<24:32, 17.33s/epoch, loss=1.14, accuracy=0.758, val_loss=2.13, val_accuracy=0.491, lr=0.0316] 44%|████▍     | 66/150 [19:03<23:53, 17.06s/epoch, loss=1.14, accuracy=0.756, val_loss=1.92, val_accuracy=0.554, lr=0.1]    45%|████▍     | 67/150 [19:21<23:50, 17.23s/epoch, loss=1.14, accuracy=0.756, val_loss=1.62, val_accuracy=0.586, lr=0.1] 45%|████▌     | 68/150 [19:37<23:22, 17.10s/epoch, loss=1.14, accuracy=0.759, val_loss=4.53, val_accuracy=0.316, lr=0.1] 46%|████▌     | 69/150 [19:55<23:24, 17.33s/epoch, loss=1.14, accuracy=0.755, val_loss=3.04, val_accuracy=0.36, lr=0.1]  47%|████▋     | 70/150 [20:12<22:58, 17.23s/epoch, loss=1.13, accuracy=0.757, val_loss=3.15, val_accuracy=0.391, lr=0.0316] 47%|████▋     | 71/150 [20:31<23:07, 17.57s/epoch, loss=1.13, accuracy=0.759, val_loss=2.76, val_accuracy=0.403, lr=0.1]    48%|████▊     | 72/150 [20:49<23:03, 17.74s/epoch, loss=1.13, accuracy=0.756, val_loss=3.04, val_accuracy=0.324, lr=0.1] 49%|████▊     | 73/150 [21:06<22:32, 17.56s/epoch, loss=1.14, accuracy=0.755, val_loss=1.83, val_accuracy=0.511, lr=0.1] 49%|████▉     | 74/150 [21:23<21:56, 17.32s/epoch, loss=1.13, accuracy=0.756, val_loss=2.54, val_accuracy=0.402, lr=0.1] 50%|█████     | 75/150 [21:41<22:03, 17.64s/epoch, loss=1.13, accuracy=0.756, val_loss=3.35, val_accuracy=0.389, lr=0.0316] 51%|█████     | 76/150 [21:58<21:22, 17.33s/epoch, loss=1.13, accuracy=0.756, val_loss=1.49, val_accuracy=0.626, lr=0.1]    51%|█████▏    | 77/150 [22:15<21:03, 17.31s/epoch, loss=1.13, accuracy=0.756, val_loss=1.83, val_accuracy=0.536, lr=0.1] 52%|█████▏    | 78/150 [22:32<20:36, 17.18s/epoch, loss=1.13, accuracy=0.76, val_loss=1.46, val_accuracy=0.646, lr=0.1]  53%|█████▎    | 79/150 [22:49<20:18, 17.17s/epoch, loss=1.13, accuracy=0.757, val_loss=2.31, val_accuracy=0.351, lr=0.1] 53%|█████▎    | 80/150 [23:06<19:49, 16.99s/epoch, loss=1.13, accuracy=0.757, val_loss=1.71, val_accuracy=0.568, lr=0.0316] 54%|█████▍    | 81/150 [23:24<19:58, 17.37s/epoch, loss=1.13, accuracy=0.757, val_loss=2.88, val_accuracy=0.417, lr=0.1]    55%|█████▍    | 82/150 [23:43<20:13, 17.85s/epoch, loss=0.93, accuracy=0.815, val_loss=1.01, val_accuracy=0.771, lr=0.01] 55%|█████▌    | 83/150 [23:59<19:32, 17.49s/epoch, loss=0.747, accuracy=0.849, val_loss=0.82, val_accuracy=0.809, lr=0.01] 56%|█████▌    | 84/150 [24:16<19:01, 17.30s/epoch, loss=0.666, accuracy=0.856, val_loss=0.831, val_accuracy=0.792, lr=0.01] 57%|█████▋    | 85/150 [24:35<19:09, 17.68s/epoch, loss=0.617, accuracy=0.861, val_loss=0.723, val_accuracy=0.819, lr=0.01] 57%|█████▋    | 86/150 [24:51<18:25, 17.28s/epoch, loss=0.59, accuracy=0.863, val_loss=0.771, val_accuracy=0.798, lr=0.01]  58%|█████▊    | 87/150 [25:09<18:13, 17.36s/epoch, loss=0.577, accuracy=0.863, val_loss=0.736, val_accuracy=0.811, lr=0.01] 59%|█████▊    | 88/150 [25:25<17:39, 17.09s/epoch, loss=0.57, accuracy=0.863, val_loss=0.78, val_accuracy=0.794, lr=0.01]   59%|█████▉    | 89/150 [25:43<17:31, 17.24s/epoch, loss=0.565, accuracy=0.866, val_loss=0.755, val_accuracy=0.8, lr=0.01] 60%|██████    | 90/150 [26:00<17:07, 17.12s/epoch, loss=0.558, accuracy=0.869, val_loss=0.751, val_accuracy=0.808, lr=0.00316] 61%|██████    | 91/150 [26:18<17:10, 17.46s/epoch, loss=0.563, accuracy=0.87, val_loss=0.683, val_accuracy=0.824, lr=0.01]     61%|██████▏   | 92/150 [26:35<16:52, 17.45s/epoch, loss=0.555, accuracy=0.871, val_loss=0.872, val_accuracy=0.768, lr=0.01] 62%|██████▏   | 93/150 [26:52<16:19, 17.18s/epoch, loss=0.554, accuracy=0.871, val_loss=0.741, val_accuracy=0.81, lr=0.01]  63%|██████▎   | 94/150 [27:10<16:13, 17.39s/epoch, loss=0.556, accuracy=0.875, val_loss=0.791, val_accuracy=0.804, lr=0.01] 63%|██████▎   | 95/150 [27:28<16:11, 17.67s/epoch, loss=0.555, accuracy=0.874, val_loss=0.765, val_accuracy=0.809, lr=0.01] 64%|██████▍   | 96/150 [27:45<15:44, 17.48s/epoch, loss=0.555, accuracy=0.875, val_loss=0.912, val_accuracy=0.761, lr=0.00316] 65%|██████▍   | 97/150 [28:01<15:08, 17.15s/epoch, loss=0.553, accuracy=0.877, val_loss=0.759, val_accuracy=0.808, lr=0.01]    65%|██████▌   | 98/150 [28:20<15:09, 17.50s/epoch, loss=0.552, accuracy=0.879, val_loss=0.783, val_accuracy=0.806, lr=0.01] 66%|██████▌   | 99/150 [28:36<14:37, 17.20s/epoch, loss=0.552, accuracy=0.878, val_loss=0.997, val_accuracy=0.746, lr=0.01] 67%|██████▋   | 100/150 [28:54<14:27, 17.35s/epoch, loss=0.552, accuracy=0.88, val_loss=0.833, val_accuracy=0.793, lr=0.01] 67%|██████▋   | 101/150 [29:10<13:54, 17.04s/epoch, loss=0.549, accuracy=0.881, val_loss=0.794, val_accuracy=0.803, lr=0.00316] 68%|██████▊   | 102/150 [29:27<13:36, 17.01s/epoch, loss=0.55, accuracy=0.882, val_loss=0.962, val_accuracy=0.76, lr=0.01]      69%|██████▊   | 103/150 [29:44<13:21, 17.06s/epoch, loss=0.555, accuracy=0.88, val_loss=0.757, val_accuracy=0.816, lr=0.01] 69%|██████▉   | 104/150 [30:02<13:06, 17.10s/epoch, loss=0.548, accuracy=0.882, val_loss=0.956, val_accuracy=0.758, lr=0.01] 70%|███████   | 105/150 [30:18<12:40, 16.91s/epoch, loss=0.55, accuracy=0.882, val_loss=0.758, val_accuracy=0.809, lr=0.01]  71%|███████   | 106/150 [30:35<12:18, 16.79s/epoch, loss=0.553, accuracy=0.882, val_loss=0.84, val_accuracy=0.796, lr=0.00316] 71%|███████▏  | 107/150 [30:53<12:20, 17.22s/epoch, loss=0.547, accuracy=0.885, val_loss=0.832, val_accuracy=0.805, lr=0.01]   72%|███████▏  | 108/150 [31:10<12:08, 17.34s/epoch, loss=0.548, accuracy=0.886, val_loss=0.799, val_accuracy=0.804, lr=0.01] 73%|███████▎  | 109/150 [31:27<11:39, 17.06s/epoch, loss=0.555, accuracy=0.883, val_loss=0.698, val_accuracy=0.831, lr=0.01] 73%|███████▎  | 110/150 [31:43<11:15, 16.90s/epoch, loss=0.551, accuracy=0.883, val_loss=0.983, val_accuracy=0.76, lr=0.01]  74%|███████▍  | 111/150 [32:00<10:56, 16.84s/epoch, loss=0.547, accuracy=0.886, val_loss=0.729, val_accuracy=0.827, lr=0.00316] 75%|███████▍  | 112/150 [32:16<10:33, 16.68s/epoch, loss=0.544, accuracy=0.887, val_loss=0.851, val_accuracy=0.792, lr=0.01]    75%|███████▌  | 113/150 [32:34<10:31, 17.07s/epoch, loss=0.551, accuracy=0.886, val_loss=0.848, val_accuracy=0.779, lr=0.01] 76%|███████▌  | 114/150 [32:53<10:27, 17.44s/epoch, loss=0.553, accuracy=0.887, val_loss=0.845, val_accuracy=0.79, lr=0.01]  77%|███████▋  | 115/150 [33:11<10:19, 17.71s/epoch, loss=0.548, accuracy=0.889, val_loss=0.946, val_accuracy=0.773, lr=0.01] 77%|███████▋  | 116/150 [33:29<10:05, 17.82s/epoch, loss=0.547, accuracy=0.888, val_loss=0.949, val_accuracy=0.747, lr=0.00316] 78%|███████▊  | 117/150 [33:46<09:36, 17.48s/epoch, loss=0.553, accuracy=0.886, val_loss=0.812, val_accuracy=0.809, lr=0.01]    79%|███████▊  | 118/150 [34:03<09:14, 17.33s/epoch, loss=0.548, accuracy=0.888, val_loss=0.792, val_accuracy=0.816, lr=0.01] 79%|███████▉  | 119/150 [34:20<08:56, 17.30s/epoch, loss=0.552, accuracy=0.887, val_loss=0.8, val_accuracy=0.812, lr=0.01]   80%|████████  | 120/150 [34:36<08:31, 17.05s/epoch, loss=0.55, accuracy=0.889, val_loss=0.819, val_accuracy=0.808, lr=0.01] 81%|████████  | 121/150 [34:53<08:07, 16.82s/epoch, loss=0.553, accuracy=0.889, val_loss=0.731, val_accuracy=0.825, lr=0.00316] 81%|████████▏ | 122/150 [35:10<07:52, 16.89s/epoch, loss=0.474, accuracy=0.915, val_loss=0.527, val_accuracy=0.895, lr=0.001]   82%|████████▏ | 123/150 [35:27<07:41, 17.10s/epoch, loss=0.421, accuracy=0.932, val_loss=0.515, val_accuracy=0.901, lr=0.001] 83%|████████▎ | 124/150 [35:44<07:24, 17.10s/epoch, loss=0.399, accuracy=0.939, val_loss=0.499, val_accuracy=0.901, lr=0.001] 83%|████████▎ | 125/150 [36:02<07:12, 17.30s/epoch, loss=0.383, accuracy=0.942, val_loss=0.495, val_accuracy=0.902, lr=0.001] 84%|████████▍ | 126/150 [36:18<06:47, 16.98s/epoch, loss=0.368, accuracy=0.946, val_loss=0.501, val_accuracy=0.899, lr=0.001] 85%|████████▍ | 127/150 [36:35<06:27, 16.84s/epoch, loss=0.356, accuracy=0.949, val_loss=0.482, val_accuracy=0.901, lr=0.001] 85%|████████▌ | 128/150 [36:53<06:17, 17.17s/epoch, loss=0.346, accuracy=0.95, val_loss=0.485, val_accuracy=0.9, lr=0.001]    86%|████████▌ | 129/150 [37:10<05:58, 17.09s/epoch, loss=0.336, accuracy=0.952, val_loss=0.475, val_accuracy=0.904, lr=0.001] 87%|████████▋ | 130/150 [37:28<05:47, 17.39s/epoch, loss=0.324, accuracy=0.955, val_loss=0.494, val_accuracy=0.897, lr=0.001] 87%|████████▋ | 131/150 [37:45<05:31, 17.44s/epoch, loss=0.317, accuracy=0.954, val_loss=0.487, val_accuracy=0.899, lr=0.001] 88%|████████▊ | 132/150 [38:03<05:13, 17.40s/epoch, loss=0.307, accuracy=0.956, val_loss=0.478, val_accuracy=0.899, lr=0.001] 89%|████████▊ | 133/150 [38:20<04:56, 17.47s/epoch, loss=0.301, accuracy=0.958, val_loss=0.473, val_accuracy=0.901, lr=0.001] 89%|████████▉ | 134/150 [38:39<04:44, 17.76s/epoch, loss=0.291, accuracy=0.959, val_loss=0.47, val_accuracy=0.899, lr=0.001]  90%|█████████ | 135/150 [38:57<04:28, 17.93s/epoch, loss=0.287, accuracy=0.959, val_loss=0.472, val_accuracy=0.9, lr=0.001]  91%|█████████ | 136/150 [39:14<04:08, 17.74s/epoch, loss=0.278, accuracy=0.962, val_loss=0.476, val_accuracy=0.899, lr=0.001] 91%|█████████▏| 137/150 [39:33<03:52, 17.89s/epoch, loss=0.273, accuracy=0.96, val_loss=0.473, val_accuracy=0.899, lr=0.001]  92%|█████████▏| 138/150 [39:51<03:36, 18.06s/epoch, loss=0.268, accuracy=0.963, val_loss=0.469, val_accuracy=0.898, lr=0.001] 93%|█████████▎| 139/150 [40:08<03:15, 17.80s/epoch, loss=0.264, accuracy=0.962, val_loss=0.471, val_accuracy=0.896, lr=0.001] 93%|█████████▎| 140/150 [40:25<02:54, 17.46s/epoch, loss=0.258, accuracy=0.964, val_loss=0.461, val_accuracy=0.901, lr=0.001] 94%|█████████▍| 141/150 [40:42<02:35, 17.29s/epoch, loss=0.251, accuracy=0.965, val_loss=0.467, val_accuracy=0.899, lr=0.001] 95%|█████████▍| 142/150 [40:59<02:16, 17.11s/epoch, loss=0.245, accuracy=0.966, val_loss=0.491, val_accuracy=0.894, lr=0.001] 95%|█████████▌| 143/150 [41:15<01:58, 16.98s/epoch, loss=0.243, accuracy=0.966, val_loss=0.457, val_accuracy=0.896, lr=0.001] 96%|█████████▌| 144/150 [41:32<01:40, 16.82s/epoch, loss=0.238, accuracy=0.966, val_loss=0.471, val_accuracy=0.891, lr=0.001] 97%|█████████▋| 145/150 [41:48<01:23, 16.73s/epoch, loss=0.237, accuracy=0.965, val_loss=0.462, val_accuracy=0.897, lr=0.001] 97%|█████████▋| 146/150 [42:05<01:07, 16.81s/epoch, loss=0.23, accuracy=0.967, val_loss=0.488, val_accuracy=0.89, lr=0.001]   98%|█████████▊| 147/150 [42:22<00:50, 16.84s/epoch, loss=0.229, accuracy=0.967, val_loss=0.518, val_accuracy=0.887, lr=0.001] 99%|█████████▊| 148/150 [42:39<00:33, 16.86s/epoch, loss=0.225, accuracy=0.967, val_loss=0.468, val_accuracy=0.892, lr=0.000316] 99%|█████████▉| 149/150 [42:55<00:16, 16.67s/epoch, loss=0.22, accuracy=0.969, val_loss=0.476, val_accuracy=0.889, lr=0.001]    100%|██████████| 150/150 [43:13<00:00, 16.95s/epoch, loss=0.221, accuracy=0.967, val_loss=0.518, val_accuracy=0.881, lr=0.001]100%|██████████| 150/150 [43:13<00:00, 17.29s/epoch, loss=0.221, accuracy=0.967, val_loss=0.518, val_accuracy=0.881, lr=0.001]
Using real-time data augmentation.
Test score: 0.478106290102005
Test accuracy: 0.9060999751091003


* * * Run SGD for ID = 10_3. * * *


2024-02-19 17:23:11.259018: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 17:23:13.905009: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-19 17:23:13.905905: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-19 17:23:13.941949: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-02-19 17:23:13.941999: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 17:23:13.944542: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-19 17:23:13.944578: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-19 17:23:13.946563: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-19 17:23:13.947642: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-19 17:23:13.949768: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-19 17:23:13.951117: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-19 17:23:13.955089: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-19 17:23:13.955572: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-19 17:23:13.955646: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-19 17:23:15.354506: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-19 17:23:15.355942: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-19 17:23:15.356716: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-02-19 17:23:15.356747: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 17:23:15.356781: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-19 17:23:15.356797: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-19 17:23:15.356811: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-19 17:23:15.356827: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-19 17:23:15.356842: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-19 17:23:15.356856: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-19 17:23:15.356870: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-19 17:23:15.357290: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-19 17:23:15.357320: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 17:23:15.952126: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-19 17:23:15.952186: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-19 17:23:15.952194: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-19 17:23:15.953027: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11227 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN X (Pascal), pci bus id: 0000:83:00.0, compute capability: 6.1)
{'id': '10_03', 'batch_size': 128, 'epochs': 150, 'validation_split': 0.1, 'checkpointing': True, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN X (Pascal)'}
x_train shape: (45000, 32, 32, 3)
45000 train samples
5000 validation samples
10000 test samples
y_train shape: (45000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/150 [00:00<?, ?epoch/s]2024-02-19 17:23:16.732616: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-19 17:23:16.745082: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2600020000 Hz
2024-02-19 17:23:18.589209: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-19 17:23:18.785748: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-19 17:23:19.422035: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-19 17:23:19.462328: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/150 [00:48<2:00:24, 48.49s/epoch, loss=3.65, accuracy=0.282, val_loss=2.7, val_accuracy=0.214, lr=0.1]  1%|▏         | 2/150 [01:06<1:14:45, 30.31s/epoch, loss=1.69, accuracy=0.48, val_loss=1.98, val_accuracy=0.428, lr=0.1]  2%|▏         | 3/150 [01:22<59:02, 24.10s/epoch, loss=1.38, accuracy=0.616, val_loss=2.1, val_accuracy=0.457, lr=0.1]    3%|▎         | 4/150 [01:39<51:34, 21.19s/epoch, loss=1.29, accuracy=0.672, val_loss=1.93, val_accuracy=0.479, lr=0.1]  3%|▎         | 5/150 [01:56<47:35, 19.69s/epoch, loss=1.26, accuracy=0.693, val_loss=2.1, val_accuracy=0.438, lr=0.1]   4%|▍         | 6/150 [02:13<45:23, 18.91s/epoch, loss=1.23, accuracy=0.709, val_loss=1.8, val_accuracy=0.526, lr=0.1]  5%|▍         | 7/150 [02:30<43:30, 18.25s/epoch, loss=1.23, accuracy=0.714, val_loss=5.15, val_accuracy=0.235, lr=0.1]  5%|▌         | 8/150 [02:47<42:12, 17.84s/epoch, loss=1.22, accuracy=0.72, val_loss=4.21, val_accuracy=0.217, lr=0.1]   6%|▌         | 9/150 [03:04<40:55, 17.42s/epoch, loss=1.21, accuracy=0.726, val_loss=2.61, val_accuracy=0.372, lr=0.1]  7%|▋         | 10/150 [03:22<40:59, 17.57s/epoch, loss=1.21, accuracy=0.727, val_loss=1.72, val_accuracy=0.529, lr=0.1]  7%|▋         | 11/150 [03:40<41:23, 17.87s/epoch, loss=1.2, accuracy=0.732, val_loss=2.15, val_accuracy=0.463, lr=0.1]   8%|▊         | 12/150 [03:59<41:32, 18.06s/epoch, loss=1.2, accuracy=0.732, val_loss=2.36, val_accuracy=0.373, lr=0.1]  9%|▊         | 13/150 [04:16<40:41, 17.82s/epoch, loss=1.2, accuracy=0.733, val_loss=3.27, val_accuracy=0.343, lr=0.1]  9%|▉         | 14/150 [04:33<40:07, 17.70s/epoch, loss=1.19, accuracy=0.736, val_loss=1.85, val_accuracy=0.504, lr=0.1] 10%|█         | 15/150 [04:50<39:16, 17.46s/epoch, loss=1.19, accuracy=0.739, val_loss=2.17, val_accuracy=0.436, lr=0.0316] 11%|█         | 16/150 [05:07<38:30, 17.24s/epoch, loss=1.17, accuracy=0.744, val_loss=2.1, val_accuracy=0.503, lr=0.1]     11%|█▏        | 17/150 [05:25<38:28, 17.36s/epoch, loss=1.18, accuracy=0.741, val_loss=1.65, val_accuracy=0.587, lr=0.1] 12%|█▏        | 18/150 [05:42<38:19, 17.42s/epoch, loss=1.18, accuracy=0.743, val_loss=1.48, val_accuracy=0.638, lr=0.1] 13%|█▎        | 19/150 [06:00<38:23, 17.58s/epoch, loss=1.18, accuracy=0.743, val_loss=2.26, val_accuracy=0.421, lr=0.1] 13%|█▎        | 20/150 [06:17<37:36, 17.36s/epoch, loss=1.18, accuracy=0.744, val_loss=1.81, val_accuracy=0.56, lr=0.1]  14%|█▍        | 21/150 [06:35<37:32, 17.46s/epoch, loss=1.17, accuracy=0.744, val_loss=1.82, val_accuracy=0.541, lr=0.1] 15%|█▍        | 22/150 [06:53<37:39, 17.65s/epoch, loss=1.17, accuracy=0.742, val_loss=2.11, val_accuracy=0.441, lr=0.1] 15%|█▌        | 23/150 [07:11<37:25, 17.68s/epoch, loss=1.16, accuracy=0.748, val_loss=2.17, val_accuracy=0.417, lr=0.0316] 16%|█▌        | 24/150 [07:28<36:45, 17.50s/epoch, loss=1.17, accuracy=0.748, val_loss=2.01, val_accuracy=0.5, lr=0.1]      17%|█▋        | 25/150 [07:45<36:36, 17.57s/epoch, loss=1.17, accuracy=0.746, val_loss=1.46, val_accuracy=0.646, lr=0.1] 17%|█▋        | 26/150 [08:02<35:51, 17.35s/epoch, loss=1.17, accuracy=0.749, val_loss=1.57, val_accuracy=0.616, lr=0.1] 18%|█▊        | 27/150 [08:19<35:20, 17.24s/epoch, loss=1.16, accuracy=0.748, val_loss=1.66, val_accuracy=0.572, lr=0.1] 19%|█▊        | 28/150 [08:37<35:38, 17.53s/epoch, loss=1.17, accuracy=0.746, val_loss=2.01, val_accuracy=0.537, lr=0.1] 19%|█▉        | 29/150 [08:56<35:48, 17.75s/epoch, loss=1.16, accuracy=0.749, val_loss=1.72, val_accuracy=0.586, lr=0.1] 20%|██        | 30/150 [09:14<35:43, 17.86s/epoch, loss=1.16, accuracy=0.75, val_loss=1.79, val_accuracy=0.543, lr=0.0316] 21%|██        | 31/150 [09:32<35:30, 17.90s/epoch, loss=1.15, accuracy=0.751, val_loss=2.77, val_accuracy=0.28, lr=0.1]    21%|██▏       | 32/150 [09:48<34:20, 17.46s/epoch, loss=1.15, accuracy=0.751, val_loss=2.15, val_accuracy=0.42, lr=0.1] 22%|██▏       | 33/150 [10:06<34:22, 17.62s/epoch, loss=1.15, accuracy=0.751, val_loss=3.29, val_accuracy=0.286, lr=0.1] 23%|██▎       | 34/150 [10:23<33:20, 17.25s/epoch, loss=1.16, accuracy=0.748, val_loss=1.68, val_accuracy=0.564, lr=0.1] 23%|██▎       | 35/150 [10:41<33:35, 17.52s/epoch, loss=1.16, accuracy=0.75, val_loss=1.73, val_accuracy=0.542, lr=0.0316] 24%|██▍       | 36/150 [10:57<32:39, 17.19s/epoch, loss=1.15, accuracy=0.751, val_loss=2.13, val_accuracy=0.489, lr=0.1]   25%|██▍       | 37/150 [11:16<33:00, 17.53s/epoch, loss=1.16, accuracy=0.751, val_loss=2.59, val_accuracy=0.287, lr=0.1] 25%|██▌       | 38/150 [11:34<33:16, 17.83s/epoch, loss=1.15, accuracy=0.753, val_loss=1.8, val_accuracy=0.513, lr=0.1]  26%|██▌       | 39/150 [11:52<33:04, 17.88s/epoch, loss=1.15, accuracy=0.753, val_loss=1.63, val_accuracy=0.574, lr=0.1] 27%|██▋       | 40/150 [12:09<32:04, 17.49s/epoch, loss=1.14, accuracy=0.755, val_loss=2.02, val_accuracy=0.5, lr=0.0316] 27%|██▋       | 41/150 [12:26<31:27, 17.32s/epoch, loss=1.14, accuracy=0.754, val_loss=2.05, val_accuracy=0.521, lr=0.1]  28%|██▊       | 42/150 [12:42<30:38, 17.02s/epoch, loss=1.14, accuracy=0.754, val_loss=3.05, val_accuracy=0.211, lr=0.1] 29%|██▊       | 43/150 [12:58<29:56, 16.79s/epoch, loss=1.15, accuracy=0.749, val_loss=3.72, val_accuracy=0.319, lr=0.1] 29%|██▉       | 44/150 [13:15<29:46, 16.85s/epoch, loss=1.15, accuracy=0.753, val_loss=1.73, val_accuracy=0.596, lr=0.1] 30%|███       | 45/150 [13:32<29:27, 16.84s/epoch, loss=1.15, accuracy=0.754, val_loss=1.88, val_accuracy=0.524, lr=0.0316] 31%|███       | 46/150 [13:49<29:06, 16.79s/epoch, loss=1.13, accuracy=0.755, val_loss=2.02, val_accuracy=0.465, lr=0.1]    31%|███▏      | 47/150 [14:06<28:55, 16.85s/epoch, loss=1.14, accuracy=0.755, val_loss=1.69, val_accuracy=0.588, lr=0.1] 32%|███▏      | 48/150 [14:22<28:34, 16.81s/epoch, loss=1.14, accuracy=0.756, val_loss=1.74, val_accuracy=0.548, lr=0.1] 33%|███▎      | 49/150 [14:39<28:00, 16.63s/epoch, loss=1.13, accuracy=0.757, val_loss=2.09, val_accuracy=0.465, lr=0.1] 33%|███▎      | 50/150 [14:55<27:51, 16.72s/epoch, loss=1.14, accuracy=0.753, val_loss=1.71, val_accuracy=0.55, lr=0.0316] 34%|███▍      | 51/150 [15:13<28:04, 17.02s/epoch, loss=1.14, accuracy=0.755, val_loss=1.71, val_accuracy=0.565, lr=0.1]   35%|███▍      | 52/150 [15:31<28:03, 17.18s/epoch, loss=1.14, accuracy=0.755, val_loss=1.7, val_accuracy=0.631, lr=0.1]  35%|███▌      | 53/150 [15:48<27:40, 17.12s/epoch, loss=1.14, accuracy=0.756, val_loss=1.71, val_accuracy=0.583, lr=0.1] 36%|███▌      | 54/150 [16:04<27:08, 16.96s/epoch, loss=1.13, accuracy=0.756, val_loss=2.22, val_accuracy=0.379, lr=0.1] 37%|███▋      | 55/150 [16:23<27:32, 17.39s/epoch, loss=1.13, accuracy=0.757, val_loss=1.84, val_accuracy=0.523, lr=0.0316] 37%|███▋      | 56/150 [16:41<27:43, 17.70s/epoch, loss=1.13, accuracy=0.758, val_loss=2.24, val_accuracy=0.453, lr=0.1]    38%|███▊      | 57/150 [16:57<26:48, 17.29s/epoch, loss=1.13, accuracy=0.756, val_loss=1.51, val_accuracy=0.625, lr=0.1] 39%|███▊      | 58/150 [17:14<26:23, 17.21s/epoch, loss=1.13, accuracy=0.756, val_loss=2.83, val_accuracy=0.429, lr=0.1] 39%|███▉      | 59/150 [17:31<25:47, 17.01s/epoch, loss=1.12, accuracy=0.76, val_loss=1.9, val_accuracy=0.534, lr=0.1]   40%|████      | 60/150 [17:48<25:34, 17.05s/epoch, loss=1.12, accuracy=0.757, val_loss=1.6, val_accuracy=0.603, lr=0.0316] 41%|████      | 61/150 [18:06<25:29, 17.18s/epoch, loss=1.12, accuracy=0.758, val_loss=1.68, val_accuracy=0.56, lr=0.1]    41%|████▏     | 62/150 [18:22<24:50, 16.94s/epoch, loss=1.12, accuracy=0.761, val_loss=1.86, val_accuracy=0.518, lr=0.1] 42%|████▏     | 63/150 [18:38<24:21, 16.79s/epoch, loss=1.13, accuracy=0.759, val_loss=1.69, val_accuracy=0.553, lr=0.1] 43%|████▎     | 64/150 [18:55<24:02, 16.77s/epoch, loss=1.12, accuracy=0.758, val_loss=1.88, val_accuracy=0.522, lr=0.1] 43%|████▎     | 65/150 [19:12<23:36, 16.66s/epoch, loss=1.12, accuracy=0.758, val_loss=2.09, val_accuracy=0.454, lr=0.0316] 44%|████▍     | 66/150 [19:28<23:20, 16.67s/epoch, loss=1.12, accuracy=0.758, val_loss=2.87, val_accuracy=0.439, lr=0.1]    45%|████▍     | 67/150 [19:45<23:05, 16.69s/epoch, loss=1.11, accuracy=0.757, val_loss=1.89, val_accuracy=0.601, lr=0.1] 45%|████▌     | 68/150 [20:01<22:37, 16.56s/epoch, loss=1.12, accuracy=0.758, val_loss=3.39, val_accuracy=0.35, lr=0.1]  46%|████▌     | 69/150 [20:18<22:15, 16.49s/epoch, loss=1.11, accuracy=0.758, val_loss=2.15, val_accuracy=0.514, lr=0.1] 47%|████▋     | 70/150 [20:35<22:09, 16.62s/epoch, loss=1.12, accuracy=0.757, val_loss=3.01, val_accuracy=0.331, lr=0.0316] 47%|████▋     | 71/150 [20:51<21:45, 16.53s/epoch, loss=1.12, accuracy=0.755, val_loss=2.61, val_accuracy=0.408, lr=0.1]    48%|████▊     | 72/150 [21:07<21:30, 16.55s/epoch, loss=1.12, accuracy=0.759, val_loss=1.58, val_accuracy=0.628, lr=0.1] 49%|████▊     | 73/150 [21:25<21:34, 16.82s/epoch, loss=1.12, accuracy=0.76, val_loss=2.34, val_accuracy=0.384, lr=0.1]  49%|████▉     | 74/150 [21:41<21:09, 16.70s/epoch, loss=1.12, accuracy=0.757, val_loss=1.58, val_accuracy=0.599, lr=0.1] 50%|█████     | 75/150 [21:58<20:54, 16.72s/epoch, loss=1.11, accuracy=0.759, val_loss=2.19, val_accuracy=0.479, lr=0.0316] 51%|█████     | 76/150 [22:15<20:46, 16.85s/epoch, loss=1.11, accuracy=0.757, val_loss=3.05, val_accuracy=0.386, lr=0.1]    51%|█████▏    | 77/150 [22:32<20:24, 16.77s/epoch, loss=1.12, accuracy=0.756, val_loss=2.31, val_accuracy=0.449, lr=0.1] 52%|█████▏    | 78/150 [22:48<19:58, 16.65s/epoch, loss=1.11, accuracy=0.758, val_loss=1.84, val_accuracy=0.507, lr=0.1] 53%|█████▎    | 79/150 [23:06<20:04, 16.97s/epoch, loss=1.11, accuracy=0.758, val_loss=2.08, val_accuracy=0.435, lr=0.1] 53%|█████▎    | 80/150 [23:23<19:51, 17.02s/epoch, loss=1.11, accuracy=0.759, val_loss=1.44, val_accuracy=0.642, lr=0.1] 54%|█████▍    | 81/150 [23:40<19:35, 17.04s/epoch, loss=1.11, accuracy=0.762, val_loss=1.76, val_accuracy=0.543, lr=0.1] 55%|█████▍    | 82/150 [23:57<19:11, 16.93s/epoch, loss=0.902, accuracy=0.819, val_loss=0.884, val_accuracy=0.809, lr=0.01] 55%|█████▌    | 83/150 [24:14<18:58, 16.99s/epoch, loss=0.732, accuracy=0.851, val_loss=0.845, val_accuracy=0.802, lr=0.01] 56%|█████▌    | 84/150 [24:32<19:00, 17.28s/epoch, loss=0.65, accuracy=0.859, val_loss=0.763, val_accuracy=0.815, lr=0.01]  57%|█████▋    | 85/150 [24:49<18:40, 17.24s/epoch, loss=0.603, accuracy=0.864, val_loss=0.699, val_accuracy=0.826, lr=0.01] 57%|█████▋    | 86/150 [25:06<18:23, 17.24s/epoch, loss=0.582, accuracy=0.862, val_loss=0.814, val_accuracy=0.792, lr=0.01] 58%|█████▊    | 87/150 [25:24<18:08, 17.28s/epoch, loss=0.569, accuracy=0.864, val_loss=0.685, val_accuracy=0.824, lr=0.01] 59%|█████▊    | 88/150 [25:40<17:37, 17.06s/epoch, loss=0.56, accuracy=0.867, val_loss=0.723, val_accuracy=0.81, lr=0.01]   59%|█████▉    | 89/150 [25:58<17:29, 17.20s/epoch, loss=0.557, accuracy=0.867, val_loss=0.758, val_accuracy=0.81, lr=0.01] 60%|██████    | 90/150 [26:14<17:01, 17.02s/epoch, loss=0.555, accuracy=0.869, val_loss=0.728, val_accuracy=0.802, lr=0.01] 61%|██████    | 91/150 [26:31<16:33, 16.85s/epoch, loss=0.546, accuracy=0.873, val_loss=1, val_accuracy=0.721, lr=0.01]     61%|██████▏   | 92/150 [26:49<16:33, 17.13s/epoch, loss=0.548, accuracy=0.872, val_loss=0.795, val_accuracy=0.79, lr=0.00316] 62%|██████▏   | 93/150 [27:05<16:00, 16.86s/epoch, loss=0.546, accuracy=0.874, val_loss=0.796, val_accuracy=0.79, lr=0.01]    63%|██████▎   | 94/150 [27:22<15:45, 16.88s/epoch, loss=0.54, accuracy=0.877, val_loss=0.969, val_accuracy=0.762, lr=0.01] 63%|██████▎   | 95/150 [27:40<15:50, 17.28s/epoch, loss=0.548, accuracy=0.874, val_loss=0.835, val_accuracy=0.784, lr=0.01] 64%|██████▍   | 96/150 [27:57<15:23, 17.10s/epoch, loss=0.547, accuracy=0.876, val_loss=0.893, val_accuracy=0.755, lr=0.01] 65%|██████▍   | 97/150 [28:15<15:27, 17.50s/epoch, loss=0.553, accuracy=0.875, val_loss=0.901, val_accuracy=0.764, lr=0.00316] 65%|██████▌   | 98/150 [28:33<15:23, 17.75s/epoch, loss=0.544, accuracy=0.879, val_loss=0.753, val_accuracy=0.804, lr=0.01]    66%|██████▌   | 99/150 [28:50<14:52, 17.50s/epoch, loss=0.544, accuracy=0.879, val_loss=0.883, val_accuracy=0.777, lr=0.01] 67%|██████▋   | 100/150 [29:08<14:39, 17.59s/epoch, loss=0.542, accuracy=0.879, val_loss=0.811, val_accuracy=0.809, lr=0.01] 67%|██████▋   | 101/150 [29:26<14:21, 17.59s/epoch, loss=0.542, accuracy=0.879, val_loss=0.767, val_accuracy=0.802, lr=0.01] 68%|██████▊   | 102/150 [29:42<13:46, 17.22s/epoch, loss=0.543, accuracy=0.882, val_loss=0.782, val_accuracy=0.809, lr=0.00316] 69%|██████▊   | 103/150 [30:00<13:40, 17.45s/epoch, loss=0.543, accuracy=0.88, val_loss=0.753, val_accuracy=0.817, lr=0.01]     69%|██████▉   | 104/150 [30:17<13:20, 17.40s/epoch, loss=0.547, accuracy=0.881, val_loss=0.728, val_accuracy=0.819, lr=0.01] 70%|███████   | 105/150 [30:34<12:50, 17.11s/epoch, loss=0.54, accuracy=0.883, val_loss=0.907, val_accuracy=0.762, lr=0.01]  71%|███████   | 106/150 [30:51<12:31, 17.07s/epoch, loss=0.544, accuracy=0.884, val_loss=1.08, val_accuracy=0.736, lr=0.01] 71%|███████▏  | 107/150 [31:08<12:16, 17.14s/epoch, loss=0.544, accuracy=0.883, val_loss=0.725, val_accuracy=0.831, lr=0.00316] 72%|███████▏  | 108/150 [31:25<11:51, 16.95s/epoch, loss=0.543, accuracy=0.884, val_loss=0.839, val_accuracy=0.8, lr=0.01]      73%|███████▎  | 109/150 [31:41<11:32, 16.88s/epoch, loss=0.534, accuracy=0.887, val_loss=0.694, val_accuracy=0.831, lr=0.01] 73%|███████▎  | 110/150 [31:59<11:20, 17.01s/epoch, loss=0.535, accuracy=0.887, val_loss=0.906, val_accuracy=0.769, lr=0.01] 74%|███████▍  | 111/150 [32:15<10:58, 16.87s/epoch, loss=0.54, accuracy=0.885, val_loss=1.1, val_accuracy=0.729, lr=0.01]    75%|███████▍  | 112/150 [32:32<10:38, 16.81s/epoch, loss=0.54, accuracy=0.886, val_loss=0.801, val_accuracy=0.801, lr=0.00316] 75%|███████▌  | 113/150 [32:49<10:21, 16.80s/epoch, loss=0.54, accuracy=0.885, val_loss=0.9, val_accuracy=0.778, lr=0.01]      76%|███████▌  | 114/150 [33:05<10:03, 16.77s/epoch, loss=0.541, accuracy=0.886, val_loss=1.02, val_accuracy=0.761, lr=0.01] 77%|███████▋  | 115/150 [33:22<09:43, 16.68s/epoch, loss=0.542, accuracy=0.886, val_loss=1.62, val_accuracy=0.6, lr=0.01]   77%|███████▋  | 116/150 [33:40<09:39, 17.05s/epoch, loss=0.541, accuracy=0.887, val_loss=0.702, val_accuracy=0.831, lr=0.01] 78%|███████▊  | 117/150 [33:56<09:16, 16.86s/epoch, loss=0.538, accuracy=0.887, val_loss=1.09, val_accuracy=0.735, lr=0.00316] 79%|███████▊  | 118/150 [34:13<09:01, 16.92s/epoch, loss=0.538, accuracy=0.888, val_loss=1.1, val_accuracy=0.718, lr=0.01]     79%|███████▉  | 119/150 [34:32<08:59, 17.39s/epoch, loss=0.54, accuracy=0.887, val_loss=0.9, val_accuracy=0.772, lr=0.01]  80%|████████  | 120/150 [34:50<08:51, 17.70s/epoch, loss=0.537, accuracy=0.891, val_loss=0.846, val_accuracy=0.797, lr=0.01] 81%|████████  | 121/150 [35:07<08:26, 17.47s/epoch, loss=0.541, accuracy=0.887, val_loss=0.774, val_accuracy=0.82, lr=0.01]  81%|████████▏ | 122/150 [35:24<08:06, 17.37s/epoch, loss=0.464, accuracy=0.915, val_loss=0.529, val_accuracy=0.894, lr=0.001] 82%|████████▏ | 123/150 [35:41<07:43, 17.17s/epoch, loss=0.415, accuracy=0.932, val_loss=0.515, val_accuracy=0.895, lr=0.001] 83%|████████▎ | 124/150 [35:58<07:27, 17.22s/epoch, loss=0.395, accuracy=0.937, val_loss=0.508, val_accuracy=0.899, lr=0.001] 83%|████████▎ | 125/150 [36:16<07:11, 17.27s/epoch, loss=0.378, accuracy=0.94, val_loss=0.502, val_accuracy=0.901, lr=0.001]  84%|████████▍ | 126/150 [36:32<06:47, 16.99s/epoch, loss=0.367, accuracy=0.943, val_loss=0.508, val_accuracy=0.892, lr=0.001] 85%|████████▍ | 127/150 [36:48<06:27, 16.84s/epoch, loss=0.353, accuracy=0.945, val_loss=0.485, val_accuracy=0.901, lr=0.001] 85%|████████▌ | 128/150 [37:06<06:13, 17.00s/epoch, loss=0.343, accuracy=0.948, val_loss=0.477, val_accuracy=0.904, lr=0.001] 86%|████████▌ | 129/150 [37:22<05:52, 16.79s/epoch, loss=0.334, accuracy=0.949, val_loss=0.481, val_accuracy=0.899, lr=0.001] 87%|████████▋ | 130/150 [37:39<05:38, 16.92s/epoch, loss=0.324, accuracy=0.952, val_loss=0.488, val_accuracy=0.895, lr=0.001] 87%|████████▋ | 131/150 [37:56<05:19, 16.79s/epoch, loss=0.318, accuracy=0.952, val_loss=0.486, val_accuracy=0.898, lr=0.001] 88%|████████▊ | 132/150 [38:14<05:11, 17.31s/epoch, loss=0.307, accuracy=0.953, val_loss=0.482, val_accuracy=0.899, lr=0.001] 89%|████████▊ | 133/150 [38:31<04:50, 17.06s/epoch, loss=0.299, accuracy=0.955, val_loss=0.47, val_accuracy=0.899, lr=0.001]  89%|████████▉ | 134/150 [38:47<04:29, 16.85s/epoch, loss=0.295, accuracy=0.955, val_loss=0.459, val_accuracy=0.903, lr=0.001] 90%|█████████ | 135/150 [39:04<04:14, 16.94s/epoch, loss=0.288, accuracy=0.956, val_loss=0.463, val_accuracy=0.9, lr=0.001]   91%|█████████ | 136/150 [39:22<04:00, 17.18s/epoch, loss=0.279, accuracy=0.959, val_loss=0.457, val_accuracy=0.902, lr=0.001] 91%|█████████▏| 137/150 [39:38<03:40, 16.97s/epoch, loss=0.273, accuracy=0.96, val_loss=0.459, val_accuracy=0.904, lr=0.001]  92%|█████████▏| 138/150 [39:56<03:26, 17.22s/epoch, loss=0.271, accuracy=0.959, val_loss=0.463, val_accuracy=0.9, lr=0.001]  93%|█████████▎| 139/150 [40:14<03:12, 17.49s/epoch, loss=0.265, accuracy=0.96, val_loss=0.467, val_accuracy=0.897, lr=0.001] 93%|█████████▎| 140/150 [40:31<02:52, 17.28s/epoch, loss=0.26, accuracy=0.961, val_loss=0.491, val_accuracy=0.893, lr=0.001] 94%|█████████▍| 141/150 [40:50<02:38, 17.60s/epoch, loss=0.257, accuracy=0.96, val_loss=0.463, val_accuracy=0.899, lr=0.000316] 95%|█████████▍| 142/150 [41:06<02:18, 17.30s/epoch, loss=0.249, accuracy=0.962, val_loss=0.461, val_accuracy=0.898, lr=0.001]   95%|█████████▌| 143/150 [41:24<02:02, 17.55s/epoch, loss=0.246, accuracy=0.962, val_loss=0.463, val_accuracy=0.9, lr=0.001]   96%|█████████▌| 144/150 [41:41<01:43, 17.20s/epoch, loss=0.243, accuracy=0.962, val_loss=0.45, val_accuracy=0.9, lr=0.001]  97%|█████████▋| 145/150 [41:59<01:27, 17.53s/epoch, loss=0.239, accuracy=0.963, val_loss=0.471, val_accuracy=0.894, lr=0.001] 97%|█████████▋| 146/150 [42:16<01:09, 17.47s/epoch, loss=0.237, accuracy=0.962, val_loss=0.452, val_accuracy=0.899, lr=0.001] 98%|█████████▊| 147/150 [42:33<00:51, 17.22s/epoch, loss=0.23, accuracy=0.965, val_loss=0.444, val_accuracy=0.902, lr=0.001]  99%|█████████▊| 148/150 [42:50<00:34, 17.07s/epoch, loss=0.232, accuracy=0.963, val_loss=0.445, val_accuracy=0.897, lr=0.001] 99%|█████████▉| 149/150 [43:06<00:16, 16.98s/epoch, loss=0.226, accuracy=0.965, val_loss=0.471, val_accuracy=0.893, lr=0.001]100%|██████████| 150/150 [43:23<00:00, 16.87s/epoch, loss=0.223, accuracy=0.965, val_loss=0.441, val_accuracy=0.892, lr=0.001]100%|██████████| 150/150 [43:23<00:00, 17.36s/epoch, loss=0.223, accuracy=0.965, val_loss=0.441, val_accuracy=0.892, lr=0.001]
Using real-time data augmentation.
Test score: 0.48772525787353516
Test accuracy: 0.9002000093460083


* * * Run SGD for ID = 10_4. * * *


2024-02-19 18:06:46.793378: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 18:06:51.921872: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-19 18:06:51.922856: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-19 18:06:51.959785: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-02-19 18:06:51.959813: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 18:06:51.962933: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-19 18:06:51.962992: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-19 18:06:51.965429: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-19 18:06:51.966301: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-19 18:06:51.968788: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-19 18:06:51.970480: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-19 18:06:51.974619: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-19 18:06:51.975106: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-19 18:06:51.975174: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-19 18:06:53.419914: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-19 18:06:53.420891: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-19 18:06:53.421623: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-02-19 18:06:53.421656: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 18:06:53.421692: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-19 18:06:53.421718: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-19 18:06:53.421733: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-19 18:06:53.421750: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-19 18:06:53.421766: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-19 18:06:53.421780: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-19 18:06:53.421795: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-19 18:06:53.422251: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-19 18:06:53.422282: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 18:06:53.998706: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-19 18:06:53.998760: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-19 18:06:53.998768: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-19 18:06:53.999624: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11227 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN X (Pascal), pci bus id: 0000:83:00.0, compute capability: 6.1)
{'id': '10_04', 'batch_size': 128, 'epochs': 150, 'validation_split': 0.1, 'checkpointing': True, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN X (Pascal)'}
x_train shape: (45000, 32, 32, 3)
45000 train samples
5000 validation samples
10000 test samples
y_train shape: (45000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/150 [00:00<?, ?epoch/s]2024-02-19 18:06:54.751314: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-19 18:06:54.763073: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2600020000 Hz
2024-02-19 18:06:56.569658: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-19 18:06:56.799805: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-19 18:06:57.449461: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-19 18:06:57.504488: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/150 [00:46<1:55:54, 46.68s/epoch, loss=3.39, accuracy=0.265, val_loss=2.96, val_accuracy=0.185, lr=0.1]  1%|▏         | 2/150 [01:03<1:11:17, 28.90s/epoch, loss=1.65, accuracy=0.495, val_loss=2.32, val_accuracy=0.364, lr=0.1]  2%|▏         | 3/150 [01:19<57:14, 23.37s/epoch, loss=1.35, accuracy=0.626, val_loss=1.95, val_accuracy=0.488, lr=0.1]    3%|▎         | 4/150 [01:37<51:24, 21.13s/epoch, loss=1.28, accuracy=0.675, val_loss=1.64, val_accuracy=0.534, lr=0.1]  3%|▎         | 5/150 [01:54<47:39, 19.72s/epoch, loss=1.25, accuracy=0.697, val_loss=3.18, val_accuracy=0.346, lr=0.1]  4%|▍         | 6/150 [02:12<45:59, 19.16s/epoch, loss=1.23, accuracy=0.709, val_loss=2.5, val_accuracy=0.445, lr=0.1]   5%|▍         | 7/150 [02:29<43:42, 18.34s/epoch, loss=1.22, accuracy=0.718, val_loss=2.35, val_accuracy=0.412, lr=0.1]  5%|▌         | 8/150 [02:48<43:28, 18.37s/epoch, loss=1.21, accuracy=0.722, val_loss=1.87, val_accuracy=0.49, lr=0.1]   6%|▌         | 9/150 [03:04<41:57, 17.85s/epoch, loss=1.2, accuracy=0.727, val_loss=1.52, val_accuracy=0.603, lr=0.1]  7%|▋         | 10/150 [03:22<41:43, 17.88s/epoch, loss=1.19, accuracy=0.73, val_loss=1.58, val_accuracy=0.612, lr=0.1]  7%|▋         | 11/150 [03:39<40:28, 17.47s/epoch, loss=1.19, accuracy=0.733, val_loss=1.43, val_accuracy=0.651, lr=0.1]  8%|▊         | 12/150 [03:55<39:24, 17.14s/epoch, loss=1.18, accuracy=0.734, val_loss=2.48, val_accuracy=0.423, lr=0.1]  9%|▊         | 13/150 [04:12<39:19, 17.22s/epoch, loss=1.18, accuracy=0.736, val_loss=1.83, val_accuracy=0.534, lr=0.1]  9%|▉         | 14/150 [04:30<39:15, 17.32s/epoch, loss=1.18, accuracy=0.736, val_loss=3.13, val_accuracy=0.343, lr=0.1] 10%|█         | 15/150 [04:48<39:12, 17.43s/epoch, loss=1.18, accuracy=0.737, val_loss=3.4, val_accuracy=0.359, lr=0.1]  11%|█         | 16/150 [05:05<38:55, 17.43s/epoch, loss=1.16, accuracy=0.74, val_loss=1.66, val_accuracy=0.587, lr=0.0316] 11%|█▏        | 17/150 [05:22<38:05, 17.19s/epoch, loss=1.17, accuracy=0.741, val_loss=1.87, val_accuracy=0.502, lr=0.1]   12%|█▏        | 18/150 [05:40<38:38, 17.56s/epoch, loss=1.17, accuracy=0.745, val_loss=1.7, val_accuracy=0.532, lr=0.1]  13%|█▎        | 19/150 [05:59<38:55, 17.83s/epoch, loss=1.17, accuracy=0.744, val_loss=1.56, val_accuracy=0.614, lr=0.1] 13%|█▎        | 20/150 [06:15<37:57, 17.52s/epoch, loss=1.16, accuracy=0.744, val_loss=4.28, val_accuracy=0.276, lr=0.1] 14%|█▍        | 21/150 [06:33<37:31, 17.45s/epoch, loss=1.15, accuracy=0.745, val_loss=2.18, val_accuracy=0.48, lr=0.0316] 15%|█▍        | 22/150 [06:49<36:40, 17.19s/epoch, loss=1.15, accuracy=0.747, val_loss=1.67, val_accuracy=0.586, lr=0.1]   15%|█▌        | 23/150 [07:06<35:58, 16.99s/epoch, loss=1.15, accuracy=0.745, val_loss=2.05, val_accuracy=0.513, lr=0.1] 16%|█▌        | 24/150 [07:22<35:09, 16.74s/epoch, loss=1.15, accuracy=0.749, val_loss=3.27, val_accuracy=0.311, lr=0.1] 17%|█▋        | 25/150 [07:39<34:47, 16.70s/epoch, loss=1.14, accuracy=0.747, val_loss=2.14, val_accuracy=0.468, lr=0.1] 17%|█▋        | 26/150 [07:57<35:16, 17.07s/epoch, loss=1.15, accuracy=0.747, val_loss=1.81, val_accuracy=0.543, lr=0.0316] 18%|█▊        | 27/150 [08:14<35:16, 17.21s/epoch, loss=1.15, accuracy=0.749, val_loss=1.67, val_accuracy=0.585, lr=0.1]    19%|█▊        | 28/150 [08:32<35:35, 17.50s/epoch, loss=1.15, accuracy=0.75, val_loss=2.52, val_accuracy=0.379, lr=0.1]  19%|█▉        | 29/150 [08:49<34:49, 17.27s/epoch, loss=1.14, accuracy=0.749, val_loss=1.78, val_accuracy=0.534, lr=0.1] 20%|██        | 30/150 [09:06<34:11, 17.10s/epoch, loss=1.13, accuracy=0.752, val_loss=1.57, val_accuracy=0.591, lr=0.1] 21%|██        | 31/150 [09:23<33:48, 17.05s/epoch, loss=1.15, accuracy=0.747, val_loss=2.25, val_accuracy=0.487, lr=0.0316] 21%|██▏       | 32/150 [09:41<34:12, 17.39s/epoch, loss=1.13, accuracy=0.752, val_loss=3.92, val_accuracy=0.358, lr=0.1]    22%|██▏       | 33/150 [09:58<33:50, 17.36s/epoch, loss=1.13, accuracy=0.749, val_loss=1.78, val_accuracy=0.554, lr=0.1] 23%|██▎       | 34/150 [10:15<33:10, 17.16s/epoch, loss=1.14, accuracy=0.753, val_loss=2.51, val_accuracy=0.399, lr=0.1] 23%|██▎       | 35/150 [10:31<32:33, 16.98s/epoch, loss=1.13, accuracy=0.753, val_loss=2.28, val_accuracy=0.426, lr=0.1] 24%|██▍       | 36/150 [10:48<32:04, 16.88s/epoch, loss=1.13, accuracy=0.754, val_loss=1.95, val_accuracy=0.467, lr=0.0316] 25%|██▍       | 37/150 [11:06<32:26, 17.23s/epoch, loss=1.13, accuracy=0.754, val_loss=1.95, val_accuracy=0.508, lr=0.1]    25%|██▌       | 38/150 [11:23<31:45, 17.01s/epoch, loss=1.12, accuracy=0.757, val_loss=1.86, val_accuracy=0.507, lr=0.1] 26%|██▌       | 39/150 [11:40<31:34, 17.07s/epoch, loss=1.13, accuracy=0.751, val_loss=2.77, val_accuracy=0.4, lr=0.1]   27%|██▋       | 40/150 [11:56<30:46, 16.78s/epoch, loss=1.13, accuracy=0.753, val_loss=1.88, val_accuracy=0.482, lr=0.1] 27%|██▋       | 41/150 [12:14<31:07, 17.13s/epoch, loss=1.13, accuracy=0.752, val_loss=3.39, val_accuracy=0.366, lr=0.0316] 28%|██▊       | 42/150 [12:31<31:05, 17.27s/epoch, loss=1.12, accuracy=0.752, val_loss=2.6, val_accuracy=0.468, lr=0.1]     29%|██▊       | 43/150 [12:50<31:24, 17.61s/epoch, loss=1.13, accuracy=0.753, val_loss=1.93, val_accuracy=0.508, lr=0.1] 29%|██▉       | 44/150 [13:07<30:39, 17.36s/epoch, loss=1.12, accuracy=0.756, val_loss=2, val_accuracy=0.572, lr=0.1]    30%|███       | 45/150 [13:23<29:55, 17.10s/epoch, loss=1.12, accuracy=0.754, val_loss=2.55, val_accuracy=0.324, lr=0.1] 31%|███       | 46/150 [13:40<29:23, 16.96s/epoch, loss=1.12, accuracy=0.756, val_loss=2.26, val_accuracy=0.413, lr=0.0316] 31%|███▏      | 47/150 [13:57<29:30, 17.19s/epoch, loss=1.12, accuracy=0.756, val_loss=1.61, val_accuracy=0.581, lr=0.1]    32%|███▏      | 48/150 [14:16<29:55, 17.60s/epoch, loss=1.12, accuracy=0.757, val_loss=1.65, val_accuracy=0.585, lr=0.1] 33%|███▎      | 49/150 [14:33<29:27, 17.50s/epoch, loss=1.11, accuracy=0.758, val_loss=2.4, val_accuracy=0.485, lr=0.1]  33%|███▎      | 50/150 [14:51<29:23, 17.63s/epoch, loss=1.12, accuracy=0.757, val_loss=2.77, val_accuracy=0.364, lr=0.1] 34%|███▍      | 51/150 [15:08<28:26, 17.24s/epoch, loss=1.12, accuracy=0.755, val_loss=3.14, val_accuracy=0.405, lr=0.0316] 35%|███▍      | 52/150 [15:25<28:12, 17.27s/epoch, loss=1.12, accuracy=0.754, val_loss=1.41, val_accuracy=0.656, lr=0.1]    35%|███▌      | 53/150 [15:42<27:36, 17.08s/epoch, loss=1.12, accuracy=0.752, val_loss=1.53, val_accuracy=0.594, lr=0.1] 36%|███▌      | 54/150 [16:00<27:52, 17.42s/epoch, loss=1.1, accuracy=0.758, val_loss=3.02, val_accuracy=0.324, lr=0.1]  37%|███▋      | 55/150 [16:16<27:05, 17.11s/epoch, loss=1.12, accuracy=0.755, val_loss=2.46, val_accuracy=0.445, lr=0.1] 37%|███▋      | 56/150 [16:33<26:38, 17.01s/epoch, loss=1.11, accuracy=0.755, val_loss=3.41, val_accuracy=0.366, lr=0.1] 38%|███▊      | 57/150 [16:49<26:06, 16.84s/epoch, loss=1.11, accuracy=0.756, val_loss=2.33, val_accuracy=0.435, lr=0.0316] 39%|███▊      | 58/150 [17:06<25:47, 16.82s/epoch, loss=1.1, accuracy=0.759, val_loss=1.9, val_accuracy=0.495, lr=0.1]      39%|███▉      | 59/150 [17:24<25:53, 17.08s/epoch, loss=1.11, accuracy=0.757, val_loss=1.76, val_accuracy=0.556, lr=0.1] 40%|████      | 60/150 [17:41<25:46, 17.18s/epoch, loss=1.12, accuracy=0.752, val_loss=1.46, val_accuracy=0.656, lr=0.1] 41%|████      | 61/150 [17:59<25:51, 17.43s/epoch, loss=1.11, accuracy=0.755, val_loss=4.78, val_accuracy=0.222, lr=0.1] 41%|████▏     | 62/150 [18:16<25:15, 17.22s/epoch, loss=1.11, accuracy=0.753, val_loss=1.73, val_accuracy=0.559, lr=0.0316] 42%|████▏     | 63/150 [18:33<24:57, 17.22s/epoch, loss=1.11, accuracy=0.756, val_loss=1.92, val_accuracy=0.558, lr=0.1]    43%|████▎     | 64/150 [18:50<24:30, 17.10s/epoch, loss=1.11, accuracy=0.757, val_loss=2.12, val_accuracy=0.509, lr=0.1] 43%|████▎     | 65/150 [19:08<24:45, 17.47s/epoch, loss=1.11, accuracy=0.754, val_loss=2.48, val_accuracy=0.455, lr=0.1] 44%|████▍     | 66/150 [19:25<24:20, 17.39s/epoch, loss=1.11, accuracy=0.756, val_loss=1.97, val_accuracy=0.535, lr=0.1] 45%|████▍     | 67/150 [19:42<23:46, 17.18s/epoch, loss=1.11, accuracy=0.756, val_loss=1.62, val_accuracy=0.598, lr=0.0316] 45%|████▌     | 68/150 [20:00<23:48, 17.42s/epoch, loss=1.1, accuracy=0.756, val_loss=2.92, val_accuracy=0.401, lr=0.1]     46%|████▌     | 69/150 [20:18<23:51, 17.67s/epoch, loss=1.1, accuracy=0.758, val_loss=3.52, val_accuracy=0.337, lr=0.1] 47%|████▋     | 70/150 [20:36<23:34, 17.68s/epoch, loss=1.11, accuracy=0.756, val_loss=4.51, val_accuracy=0.241, lr=0.1] 47%|████▋     | 71/150 [20:53<23:00, 17.47s/epoch, loss=1.12, accuracy=0.757, val_loss=2.6, val_accuracy=0.339, lr=0.1]  48%|████▊     | 72/150 [21:10<22:39, 17.42s/epoch, loss=1.11, accuracy=0.757, val_loss=2.07, val_accuracy=0.43, lr=0.0316] 49%|████▊     | 73/150 [21:27<21:55, 17.09s/epoch, loss=1.1, accuracy=0.759, val_loss=1.69, val_accuracy=0.581, lr=0.1]    49%|████▉     | 74/150 [21:43<21:19, 16.84s/epoch, loss=1.1, accuracy=0.759, val_loss=1.99, val_accuracy=0.529, lr=0.1] 50%|█████     | 75/150 [22:00<21:01, 16.81s/epoch, loss=1.11, accuracy=0.758, val_loss=1.9, val_accuracy=0.535, lr=0.1] 51%|█████     | 76/150 [22:17<21:00, 17.03s/epoch, loss=1.11, accuracy=0.757, val_loss=2.41, val_accuracy=0.49, lr=0.1] 51%|█████▏    | 77/150 [22:36<21:14, 17.45s/epoch, loss=1.1, accuracy=0.759, val_loss=2.27, val_accuracy=0.491, lr=0.0316] 52%|█████▏    | 78/150 [22:54<21:09, 17.63s/epoch, loss=1.11, accuracy=0.757, val_loss=2.89, val_accuracy=0.267, lr=0.1]   53%|█████▎    | 79/150 [23:11<20:35, 17.41s/epoch, loss=1.11, accuracy=0.755, val_loss=1.61, val_accuracy=0.573, lr=0.1] 53%|█████▎    | 80/150 [23:28<20:17, 17.39s/epoch, loss=1.11, accuracy=0.755, val_loss=1.58, val_accuracy=0.602, lr=0.1] 54%|█████▍    | 81/150 [23:44<19:39, 17.10s/epoch, loss=1.12, accuracy=0.756, val_loss=2.59, val_accuracy=0.356, lr=0.1] 55%|█████▍    | 82/150 [24:01<19:14, 16.98s/epoch, loss=0.923, accuracy=0.813, val_loss=0.885, val_accuracy=0.817, lr=0.01] 55%|█████▌    | 83/150 [24:19<19:10, 17.17s/epoch, loss=0.748, accuracy=0.847, val_loss=0.851, val_accuracy=0.797, lr=0.01] 56%|█████▌    | 84/150 [24:35<18:40, 16.98s/epoch, loss=0.667, accuracy=0.855, val_loss=0.839, val_accuracy=0.784, lr=0.01] 57%|█████▋    | 85/150 [24:52<18:20, 16.93s/epoch, loss=0.618, accuracy=0.859, val_loss=0.744, val_accuracy=0.812, lr=0.01] 57%|█████▋    | 86/150 [25:09<17:55, 16.80s/epoch, loss=0.589, accuracy=0.861, val_loss=0.74, val_accuracy=0.809, lr=0.01]  58%|█████▊    | 87/150 [25:25<17:36, 16.77s/epoch, loss=0.575, accuracy=0.862, val_loss=0.761, val_accuracy=0.803, lr=0.01] 59%|█████▊    | 88/150 [25:43<17:37, 17.05s/epoch, loss=0.568, accuracy=0.863, val_loss=0.781, val_accuracy=0.792, lr=0.01] 59%|█████▉    | 89/150 [26:01<17:38, 17.35s/epoch, loss=0.561, accuracy=0.866, val_loss=0.801, val_accuracy=0.796, lr=0.01] 60%|██████    | 90/150 [26:18<17:15, 17.26s/epoch, loss=0.56, accuracy=0.865, val_loss=0.927, val_accuracy=0.752, lr=0.01]  61%|██████    | 91/150 [26:35<16:53, 17.17s/epoch, loss=0.558, accuracy=0.867, val_loss=1.14, val_accuracy=0.72, lr=0.00316] 61%|██████▏   | 92/150 [26:51<16:20, 16.90s/epoch, loss=0.562, accuracy=0.866, val_loss=0.751, val_accuracy=0.801, lr=0.01]  62%|██████▏   | 93/150 [27:08<15:51, 16.70s/epoch, loss=0.556, accuracy=0.867, val_loss=1.05, val_accuracy=0.729, lr=0.01]  63%|██████▎   | 94/150 [27:24<15:35, 16.70s/epoch, loss=0.559, accuracy=0.868, val_loss=0.815, val_accuracy=0.792, lr=0.01] 63%|██████▎   | 95/150 [27:43<15:48, 17.25s/epoch, loss=0.554, accuracy=0.872, val_loss=0.715, val_accuracy=0.817, lr=0.01] 64%|██████▍   | 96/150 [28:01<15:39, 17.40s/epoch, loss=0.553, accuracy=0.872, val_loss=0.935, val_accuracy=0.771, lr=0.01] 65%|██████▍   | 97/150 [28:18<15:28, 17.52s/epoch, loss=0.555, accuracy=0.874, val_loss=0.799, val_accuracy=0.802, lr=0.01] 65%|██████▌   | 98/150 [28:37<15:28, 17.86s/epoch, loss=0.55, accuracy=0.876, val_loss=1.19, val_accuracy=0.682, lr=0.01]   66%|██████▌   | 99/150 [28:54<14:51, 17.49s/epoch, loss=0.558, accuracy=0.872, val_loss=0.769, val_accuracy=0.81, lr=0.01] 67%|██████▋   | 100/150 [29:11<14:26, 17.32s/epoch, loss=0.554, accuracy=0.876, val_loss=1.1, val_accuracy=0.741, lr=0.00316] 67%|██████▋   | 101/150 [29:29<14:20, 17.57s/epoch, loss=0.55, accuracy=0.878, val_loss=0.758, val_accuracy=0.816, lr=0.01]   68%|██████▊   | 102/150 [29:46<14:04, 17.59s/epoch, loss=0.555, accuracy=0.877, val_loss=0.785, val_accuracy=0.808, lr=0.01] 69%|██████▊   | 103/150 [30:03<13:31, 17.27s/epoch, loss=0.553, accuracy=0.877, val_loss=1.03, val_accuracy=0.747, lr=0.01]  69%|██████▉   | 104/150 [30:21<13:27, 17.56s/epoch, loss=0.552, accuracy=0.878, val_loss=0.839, val_accuracy=0.774, lr=0.01] 70%|███████   | 105/150 [30:39<13:12, 17.61s/epoch, loss=0.55, accuracy=0.879, val_loss=0.66, val_accuracy=0.841, lr=0.01]   71%|███████   | 106/150 [30:57<13:05, 17.84s/epoch, loss=0.551, accuracy=0.879, val_loss=1.04, val_accuracy=0.744, lr=0.01] 71%|███████▏  | 107/150 [31:15<12:42, 17.74s/epoch, loss=0.55, accuracy=0.881, val_loss=0.978, val_accuracy=0.746, lr=0.01] 72%|███████▏  | 108/150 [31:32<12:18, 17.59s/epoch, loss=0.548, accuracy=0.881, val_loss=0.769, val_accuracy=0.81, lr=0.01] 73%|███████▎  | 109/150 [31:50<12:04, 17.68s/epoch, loss=0.55, accuracy=0.882, val_loss=0.739, val_accuracy=0.825, lr=0.01] 73%|███████▎  | 110/150 [32:07<11:45, 17.63s/epoch, loss=0.552, accuracy=0.882, val_loss=0.838, val_accuracy=0.791, lr=0.00316] 74%|███████▍  | 111/150 [32:24<11:17, 17.37s/epoch, loss=0.544, accuracy=0.883, val_loss=1.09, val_accuracy=0.743, lr=0.01]     75%|███████▍  | 112/150 [32:42<11:01, 17.42s/epoch, loss=0.55, accuracy=0.881, val_loss=0.828, val_accuracy=0.801, lr=0.01] 75%|███████▌  | 113/150 [32:58<10:37, 17.23s/epoch, loss=0.551, accuracy=0.883, val_loss=0.742, val_accuracy=0.82, lr=0.01] 76%|███████▌  | 114/150 [33:15<10:11, 17.00s/epoch, loss=0.55, accuracy=0.882, val_loss=0.783, val_accuracy=0.817, lr=0.01] 77%|███████▋  | 115/150 [33:31<09:47, 16.79s/epoch, loss=0.552, accuracy=0.882, val_loss=0.918, val_accuracy=0.755, lr=0.00316] 77%|███████▋  | 116/150 [33:48<09:28, 16.71s/epoch, loss=0.551, accuracy=0.884, val_loss=0.832, val_accuracy=0.8, lr=0.01]      78%|███████▊  | 117/150 [34:05<09:14, 16.79s/epoch, loss=0.546, accuracy=0.884, val_loss=0.81, val_accuracy=0.803, lr=0.01] 79%|███████▊  | 118/150 [34:21<08:48, 16.53s/epoch, loss=0.549, accuracy=0.885, val_loss=1.1, val_accuracy=0.719, lr=0.01]  79%|███████▉  | 119/150 [34:38<08:35, 16.64s/epoch, loss=0.547, accuracy=0.885, val_loss=0.804, val_accuracy=0.798, lr=0.01] 80%|████████  | 120/150 [34:54<08:16, 16.56s/epoch, loss=0.551, accuracy=0.884, val_loss=0.719, val_accuracy=0.825, lr=0.00316] 81%|████████  | 121/150 [35:12<08:12, 17.00s/epoch, loss=0.548, accuracy=0.885, val_loss=0.814, val_accuracy=0.802, lr=0.01]    81%|████████▏ | 122/150 [35:29<07:53, 16.93s/epoch, loss=0.474, accuracy=0.911, val_loss=0.519, val_accuracy=0.896, lr=0.001] 82%|████████▏ | 123/150 [35:47<07:49, 17.39s/epoch, loss=0.419, accuracy=0.928, val_loss=0.511, val_accuracy=0.9, lr=0.001]   83%|████████▎ | 124/150 [36:05<07:37, 17.59s/epoch, loss=0.398, accuracy=0.934, val_loss=0.501, val_accuracy=0.903, lr=0.001] 83%|████████▎ | 125/150 [36:22<07:12, 17.28s/epoch, loss=0.384, accuracy=0.938, val_loss=0.492, val_accuracy=0.905, lr=0.001] 84%|████████▍ | 126/150 [36:39<06:55, 17.32s/epoch, loss=0.367, accuracy=0.942, val_loss=0.494, val_accuracy=0.903, lr=0.001] 85%|████████▍ | 127/150 [36:56<06:36, 17.23s/epoch, loss=0.358, accuracy=0.943, val_loss=0.485, val_accuracy=0.901, lr=0.001] 85%|████████▌ | 128/150 [37:14<06:26, 17.55s/epoch, loss=0.344, accuracy=0.945, val_loss=0.482, val_accuracy=0.9, lr=0.001]   86%|████████▌ | 129/150 [37:32<06:08, 17.56s/epoch, loss=0.335, accuracy=0.948, val_loss=0.475, val_accuracy=0.902, lr=0.001] 87%|████████▋ | 130/150 [37:49<05:44, 17.24s/epoch, loss=0.328, accuracy=0.948, val_loss=0.49, val_accuracy=0.896, lr=0.001]  87%|████████▋ | 131/150 [38:06<05:30, 17.41s/epoch, loss=0.317, accuracy=0.951, val_loss=0.472, val_accuracy=0.901, lr=0.001] 88%|████████▊ | 132/150 [38:24<05:13, 17.44s/epoch, loss=0.312, accuracy=0.95, val_loss=0.47, val_accuracy=0.899, lr=0.001]   89%|████████▊ | 133/150 [38:42<04:59, 17.60s/epoch, loss=0.306, accuracy=0.95, val_loss=0.467, val_accuracy=0.902, lr=0.001] 89%|████████▉ | 134/150 [38:58<04:36, 17.26s/epoch, loss=0.296, accuracy=0.954, val_loss=0.49, val_accuracy=0.897, lr=0.001] 90%|█████████ | 135/150 [39:15<04:15, 17.02s/epoch, loss=0.29, accuracy=0.954, val_loss=0.465, val_accuracy=0.903, lr=0.001] 91%|█████████ | 136/150 [39:31<03:56, 16.89s/epoch, loss=0.283, accuracy=0.956, val_loss=0.469, val_accuracy=0.9, lr=0.001]  91%|█████████▏| 137/150 [39:49<03:40, 16.99s/epoch, loss=0.278, accuracy=0.954, val_loss=0.483, val_accuracy=0.898, lr=0.001] 92%|█████████▏| 138/150 [40:05<03:23, 16.96s/epoch, loss=0.274, accuracy=0.957, val_loss=0.459, val_accuracy=0.9, lr=0.001]   93%|█████████▎| 139/150 [40:22<03:04, 16.77s/epoch, loss=0.264, accuracy=0.96, val_loss=0.463, val_accuracy=0.898, lr=0.001] 93%|█████████▎| 140/150 [40:40<02:51, 17.16s/epoch, loss=0.262, accuracy=0.959, val_loss=0.496, val_accuracy=0.896, lr=0.001] 94%|█████████▍| 141/150 [40:57<02:35, 17.26s/epoch, loss=0.259, accuracy=0.958, val_loss=0.511, val_accuracy=0.895, lr=0.001] 95%|█████████▍| 142/150 [41:16<02:20, 17.57s/epoch, loss=0.256, accuracy=0.959, val_loss=0.46, val_accuracy=0.898, lr=0.001]  95%|█████████▌| 143/150 [41:32<02:00, 17.25s/epoch, loss=0.252, accuracy=0.96, val_loss=0.461, val_accuracy=0.895, lr=0.000316] 96%|█████████▌| 144/150 [41:48<01:41, 16.96s/epoch, loss=0.246, accuracy=0.96, val_loss=0.486, val_accuracy=0.888, lr=0.001]    97%|█████████▋| 145/150 [42:05<01:23, 16.77s/epoch, loss=0.242, accuracy=0.962, val_loss=0.51, val_accuracy=0.885, lr=0.001] 97%|█████████▋| 146/150 [42:22<01:07, 16.79s/epoch, loss=0.243, accuracy=0.96, val_loss=0.468, val_accuracy=0.894, lr=0.001] 98%|█████████▊| 147/150 [42:39<00:50, 17.00s/epoch, loss=0.241, accuracy=0.959, val_loss=0.496, val_accuracy=0.888, lr=0.001] 99%|█████████▊| 148/150 [42:55<00:33, 16.78s/epoch, loss=0.233, accuracy=0.963, val_loss=0.504, val_accuracy=0.891, lr=0.000316] 99%|█████████▉| 149/150 [43:12<00:16, 16.82s/epoch, loss=0.233, accuracy=0.962, val_loss=0.488, val_accuracy=0.893, lr=0.001]   100%|██████████| 150/150 [43:29<00:00, 16.76s/epoch, loss=0.229, accuracy=0.963, val_loss=0.48, val_accuracy=0.889, lr=0.001] 100%|██████████| 150/150 [43:29<00:00, 17.40s/epoch, loss=0.229, accuracy=0.963, val_loss=0.48, val_accuracy=0.889, lr=0.001]
Using real-time data augmentation.
Test score: 0.5132099390029907
Test accuracy: 0.8945000171661377


* * * Run SGD for ID = 10_5. * * *


2024-02-19 18:50:33.010815: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 18:50:47.071890: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-19 18:50:47.072844: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-19 18:50:47.109025: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-02-19 18:50:47.109057: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 18:50:47.115103: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-19 18:50:47.115141: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-19 18:50:47.119462: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-19 18:50:47.121733: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-19 18:50:47.125460: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-19 18:50:47.128687: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-19 18:50:47.135160: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-19 18:50:47.135695: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-19 18:50:47.135772: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-19 18:50:48.507701: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-19 18:50:48.508226: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-19 18:50:48.508953: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-02-19 18:50:48.509030: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 18:50:48.509067: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-19 18:50:48.509083: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-19 18:50:48.509097: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-19 18:50:48.509113: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-19 18:50:48.509128: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-19 18:50:48.509143: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-19 18:50:48.509157: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-19 18:50:48.509578: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-19 18:50:48.509607: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 18:50:49.096945: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-19 18:50:49.097015: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-19 18:50:49.097023: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-19 18:50:49.097879: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11227 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN X (Pascal), pci bus id: 0000:83:00.0, compute capability: 6.1)
{'id': '10_05', 'batch_size': 128, 'epochs': 150, 'validation_split': 0.1, 'checkpointing': True, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN X (Pascal)'}
x_train shape: (45000, 32, 32, 3)
45000 train samples
5000 validation samples
10000 test samples
y_train shape: (45000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/150 [00:00<?, ?epoch/s]2024-02-19 18:50:49.855313: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-19 18:50:49.867074: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2600020000 Hz
2024-02-19 18:50:51.609775: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-19 18:50:51.808032: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-19 18:50:52.522052: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-19 18:50:52.565992: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/150 [00:48<2:00:57, 48.71s/epoch, loss=3.4, accuracy=0.256, val_loss=3.65, val_accuracy=0.153, lr=0.1]  1%|▏         | 2/150 [01:05<1:13:55, 29.97s/epoch, loss=1.66, accuracy=0.486, val_loss=3.44, val_accuracy=0.287, lr=0.1]  2%|▏         | 3/150 [01:21<58:16, 23.78s/epoch, loss=1.41, accuracy=0.61, val_loss=1.92, val_accuracy=0.441, lr=0.1]     3%|▎         | 4/150 [01:38<51:05, 21.00s/epoch, loss=1.31, accuracy=0.669, val_loss=2.21, val_accuracy=0.405, lr=0.1]  3%|▎         | 5/150 [01:55<47:20, 19.59s/epoch, loss=1.27, accuracy=0.692, val_loss=2.02, val_accuracy=0.481, lr=0.1]  4%|▍         | 6/150 [02:12<44:25, 18.51s/epoch, loss=1.25, accuracy=0.701, val_loss=1.96, val_accuracy=0.479, lr=0.1]  5%|▍         | 7/150 [02:28<42:36, 17.88s/epoch, loss=1.23, accuracy=0.713, val_loss=1.58, val_accuracy=0.592, lr=0.1]  5%|▌         | 8/150 [02:46<42:27, 17.94s/epoch, loss=1.23, accuracy=0.717, val_loss=2.4, val_accuracy=0.464, lr=0.1]   6%|▌         | 9/150 [03:05<42:33, 18.11s/epoch, loss=1.22, accuracy=0.722, val_loss=2.38, val_accuracy=0.392, lr=0.1]  7%|▋         | 10/150 [03:24<42:40, 18.29s/epoch, loss=1.22, accuracy=0.724, val_loss=1.61, val_accuracy=0.569, lr=0.1]  7%|▋         | 11/150 [03:41<41:57, 18.11s/epoch, loss=1.21, accuracy=0.729, val_loss=1.92, val_accuracy=0.484, lr=0.1]  8%|▊         | 12/150 [04:00<42:00, 18.26s/epoch, loss=1.21, accuracy=0.732, val_loss=1.78, val_accuracy=0.525, lr=0.0316]  9%|▊         | 13/150 [04:17<41:13, 18.06s/epoch, loss=1.21, accuracy=0.732, val_loss=2.01, val_accuracy=0.474, lr=0.1]     9%|▉         | 14/150 [04:36<41:30, 18.32s/epoch, loss=1.2, accuracy=0.735, val_loss=1.44, val_accuracy=0.664, lr=0.1]  10%|█         | 15/150 [04:54<40:42, 18.10s/epoch, loss=1.2, accuracy=0.734, val_loss=3.13, val_accuracy=0.291, lr=0.1] 11%|█         | 16/150 [05:11<39:32, 17.71s/epoch, loss=1.19, accuracy=0.741, val_loss=1.62, val_accuracy=0.601, lr=0.1] 11%|█▏        | 17/150 [05:27<38:25, 17.33s/epoch, loss=1.18, accuracy=0.74, val_loss=1.66, val_accuracy=0.569, lr=0.1]  12%|█▏        | 18/150 [05:44<37:57, 17.25s/epoch, loss=1.19, accuracy=0.74, val_loss=1.97, val_accuracy=0.516, lr=0.1] 13%|█▎        | 19/150 [06:01<37:31, 17.18s/epoch, loss=1.18, accuracy=0.743, val_loss=1.68, val_accuracy=0.599, lr=0.0316] 13%|█▎        | 20/150 [06:19<37:20, 17.23s/epoch, loss=1.18, accuracy=0.744, val_loss=1.89, val_accuracy=0.534, lr=0.1]    14%|█▍        | 21/150 [06:37<37:34, 17.48s/epoch, loss=1.17, accuracy=0.745, val_loss=1.56, val_accuracy=0.629, lr=0.1] 15%|█▍        | 22/150 [06:55<37:58, 17.80s/epoch, loss=1.17, accuracy=0.746, val_loss=2.5, val_accuracy=0.458, lr=0.1]  15%|█▌        | 23/150 [07:13<37:33, 17.74s/epoch, loss=1.18, accuracy=0.746, val_loss=2.47, val_accuracy=0.436, lr=0.1] 16%|█▌        | 24/150 [07:32<37:51, 18.03s/epoch, loss=1.16, accuracy=0.747, val_loss=1.62, val_accuracy=0.597, lr=0.0316] 17%|█▋        | 25/150 [07:50<37:49, 18.16s/epoch, loss=1.16, accuracy=0.747, val_loss=1.99, val_accuracy=0.544, lr=0.1]    17%|█▋        | 26/150 [08:08<37:36, 18.20s/epoch, loss=1.16, accuracy=0.75, val_loss=2.96, val_accuracy=0.4, lr=0.1]    18%|█▊        | 27/150 [08:25<36:31, 17.81s/epoch, loss=1.16, accuracy=0.751, val_loss=1.72, val_accuracy=0.587, lr=0.1] 19%|█▊        | 28/150 [08:44<36:40, 18.03s/epoch, loss=1.16, accuracy=0.752, val_loss=1.54, val_accuracy=0.606, lr=0.1] 19%|█▉        | 29/150 [09:02<36:38, 18.17s/epoch, loss=1.16, accuracy=0.752, val_loss=1.75, val_accuracy=0.579, lr=0.0316] 20%|██        | 30/150 [09:19<35:37, 17.81s/epoch, loss=1.16, accuracy=0.751, val_loss=1.52, val_accuracy=0.645, lr=0.1]    21%|██        | 31/150 [09:37<35:21, 17.83s/epoch, loss=1.15, accuracy=0.751, val_loss=2.49, val_accuracy=0.442, lr=0.1] 21%|██▏       | 32/150 [09:55<34:50, 17.71s/epoch, loss=1.16, accuracy=0.753, val_loss=1.82, val_accuracy=0.526, lr=0.1] 22%|██▏       | 33/150 [10:13<35:00, 17.95s/epoch, loss=1.15, accuracy=0.755, val_loss=1.81, val_accuracy=0.554, lr=0.1] 23%|██▎       | 34/150 [10:31<34:53, 18.04s/epoch, loss=1.16, accuracy=0.752, val_loss=2.27, val_accuracy=0.46, lr=0.0316] 23%|██▎       | 35/150 [10:50<34:44, 18.13s/epoch, loss=1.15, accuracy=0.752, val_loss=1.75, val_accuracy=0.558, lr=0.1]   24%|██▍       | 36/150 [11:08<34:31, 18.18s/epoch, loss=1.15, accuracy=0.753, val_loss=1.52, val_accuracy=0.639, lr=0.1] 25%|██▍       | 37/150 [11:27<34:28, 18.31s/epoch, loss=1.15, accuracy=0.753, val_loss=2.24, val_accuracy=0.45, lr=0.1]  25%|██▌       | 38/150 [11:43<33:25, 17.91s/epoch, loss=1.15, accuracy=0.754, val_loss=3.24, val_accuracy=0.325, lr=0.1] 26%|██▌       | 39/150 [12:00<32:35, 17.62s/epoch, loss=1.16, accuracy=0.754, val_loss=1.91, val_accuracy=0.566, lr=0.0316] 27%|██▋       | 40/150 [12:19<32:59, 17.99s/epoch, loss=1.16, accuracy=0.753, val_loss=1.6, val_accuracy=0.626, lr=0.1]     27%|██▋       | 41/150 [12:38<33:07, 18.24s/epoch, loss=1.15, accuracy=0.756, val_loss=1.93, val_accuracy=0.592, lr=0.1] 28%|██▊       | 42/150 [12:55<32:07, 17.85s/epoch, loss=1.15, accuracy=0.756, val_loss=1.83, val_accuracy=0.557, lr=0.1] 29%|██▊       | 43/150 [13:12<31:23, 17.60s/epoch, loss=1.15, accuracy=0.753, val_loss=2.05, val_accuracy=0.505, lr=0.1] 29%|██▉       | 44/150 [13:31<31:38, 17.91s/epoch, loss=1.14, accuracy=0.755, val_loss=2.25, val_accuracy=0.455, lr=0.0316] 30%|███       | 45/150 [13:48<31:05, 17.77s/epoch, loss=1.15, accuracy=0.754, val_loss=1.86, val_accuracy=0.554, lr=0.1]    31%|███       | 46/150 [14:05<30:33, 17.63s/epoch, loss=1.15, accuracy=0.754, val_loss=2.33, val_accuracy=0.455, lr=0.1] 31%|███▏      | 47/150 [14:23<30:18, 17.66s/epoch, loss=1.15, accuracy=0.752, val_loss=2.58, val_accuracy=0.49, lr=0.1]  32%|███▏      | 48/150 [14:41<30:11, 17.76s/epoch, loss=1.15, accuracy=0.752, val_loss=1.63, val_accuracy=0.581, lr=0.1] 33%|███▎      | 49/150 [14:59<30:06, 17.89s/epoch, loss=1.15, accuracy=0.754, val_loss=1.44, val_accuracy=0.637, lr=0.0316] 33%|███▎      | 50/150 [15:17<29:29, 17.70s/epoch, loss=1.15, accuracy=0.755, val_loss=1.99, val_accuracy=0.535, lr=0.1]    34%|███▍      | 51/150 [15:34<28:48, 17.46s/epoch, loss=1.14, accuracy=0.759, val_loss=1.83, val_accuracy=0.548, lr=0.1] 35%|███▍      | 52/150 [15:50<28:08, 17.23s/epoch, loss=1.15, accuracy=0.754, val_loss=2.16, val_accuracy=0.498, lr=0.1] 35%|███▌      | 53/150 [16:08<27:59, 17.31s/epoch, loss=1.14, accuracy=0.755, val_loss=3.25, val_accuracy=0.371, lr=0.1] 36%|███▌      | 54/150 [16:25<27:41, 17.31s/epoch, loss=1.15, accuracy=0.757, val_loss=1.5, val_accuracy=0.62, lr=0.0316] 37%|███▋      | 55/150 [16:42<27:09, 17.16s/epoch, loss=1.15, accuracy=0.755, val_loss=2.05, val_accuracy=0.486, lr=0.1]  37%|███▋      | 56/150 [17:00<27:27, 17.53s/epoch, loss=1.15, accuracy=0.754, val_loss=1.71, val_accuracy=0.586, lr=0.1] 38%|███▊      | 57/150 [17:17<26:56, 17.38s/epoch, loss=1.14, accuracy=0.756, val_loss=1.59, val_accuracy=0.624, lr=0.1] 39%|███▊      | 58/150 [17:35<26:36, 17.36s/epoch, loss=1.14, accuracy=0.756, val_loss=1.89, val_accuracy=0.55, lr=0.1]  39%|███▉      | 59/150 [17:53<26:52, 17.72s/epoch, loss=1.14, accuracy=0.756, val_loss=2.04, val_accuracy=0.446, lr=0.0316] 40%|████      | 60/150 [18:12<27:03, 18.04s/epoch, loss=1.14, accuracy=0.758, val_loss=1.85, val_accuracy=0.544, lr=0.1]    41%|████      | 61/150 [18:29<26:16, 17.71s/epoch, loss=1.15, accuracy=0.756, val_loss=3.05, val_accuracy=0.294, lr=0.1] 41%|████▏     | 62/150 [18:46<25:55, 17.67s/epoch, loss=1.14, accuracy=0.756, val_loss=2.26, val_accuracy=0.429, lr=0.1] 42%|████▏     | 63/150 [19:05<25:48, 17.80s/epoch, loss=1.14, accuracy=0.755, val_loss=2.13, val_accuracy=0.43, lr=0.1]  43%|████▎     | 64/150 [19:21<25:04, 17.49s/epoch, loss=1.14, accuracy=0.757, val_loss=2.37, val_accuracy=0.508, lr=0.0316] 43%|████▎     | 65/150 [19:39<25:03, 17.69s/epoch, loss=1.15, accuracy=0.755, val_loss=4.57, val_accuracy=0.354, lr=0.1]    44%|████▍     | 66/150 [19:57<24:54, 17.79s/epoch, loss=1.14, accuracy=0.756, val_loss=1.94, val_accuracy=0.523, lr=0.1] 45%|████▍     | 67/150 [20:15<24:22, 17.62s/epoch, loss=1.14, accuracy=0.756, val_loss=3.91, val_accuracy=0.327, lr=0.1] 45%|████▌     | 68/150 [20:33<24:19, 17.80s/epoch, loss=1.14, accuracy=0.758, val_loss=3.03, val_accuracy=0.393, lr=0.1] 46%|████▌     | 69/150 [20:50<23:45, 17.60s/epoch, loss=1.13, accuracy=0.758, val_loss=2.24, val_accuracy=0.467, lr=0.0316] 47%|████▋     | 70/150 [21:08<23:38, 17.73s/epoch, loss=1.14, accuracy=0.756, val_loss=1.69, val_accuracy=0.589, lr=0.1]    47%|████▋     | 71/150 [21:25<22:56, 17.43s/epoch, loss=1.14, accuracy=0.758, val_loss=1.86, val_accuracy=0.534, lr=0.1] 48%|████▊     | 72/150 [21:43<23:06, 17.78s/epoch, loss=1.14, accuracy=0.757, val_loss=1.51, val_accuracy=0.626, lr=0.1] 49%|████▊     | 73/150 [22:01<22:43, 17.71s/epoch, loss=1.14, accuracy=0.755, val_loss=1.98, val_accuracy=0.526, lr=0.1] 49%|████▉     | 74/150 [22:19<22:30, 17.78s/epoch, loss=1.14, accuracy=0.758, val_loss=1.87, val_accuracy=0.541, lr=0.0316] 50%|█████     | 75/150 [22:37<22:24, 17.92s/epoch, loss=1.14, accuracy=0.756, val_loss=1.51, val_accuracy=0.623, lr=0.1]    51%|█████     | 76/150 [22:54<21:41, 17.59s/epoch, loss=1.14, accuracy=0.757, val_loss=1.88, val_accuracy=0.521, lr=0.1] 51%|█████▏    | 77/150 [23:11<21:13, 17.44s/epoch, loss=1.14, accuracy=0.758, val_loss=2.7, val_accuracy=0.386, lr=0.1]  52%|█████▏    | 78/150 [23:28<20:43, 17.27s/epoch, loss=1.15, accuracy=0.755, val_loss=3.23, val_accuracy=0.338, lr=0.1] 53%|█████▎    | 79/150 [23:46<20:42, 17.51s/epoch, loss=1.13, accuracy=0.758, val_loss=2.01, val_accuracy=0.511, lr=0.0316] 53%|█████▎    | 80/150 [24:05<20:52, 17.90s/epoch, loss=1.13, accuracy=0.756, val_loss=2.06, val_accuracy=0.481, lr=0.1]    54%|█████▍    | 81/150 [24:22<20:14, 17.60s/epoch, loss=1.13, accuracy=0.758, val_loss=2.26, val_accuracy=0.492, lr=0.1] 55%|█████▍    | 82/150 [24:40<20:05, 17.72s/epoch, loss=0.926, accuracy=0.814, val_loss=0.872, val_accuracy=0.818, lr=0.01] 55%|█████▌    | 83/150 [24:57<19:28, 17.45s/epoch, loss=0.749, accuracy=0.849, val_loss=0.864, val_accuracy=0.798, lr=0.01] 56%|█████▌    | 84/150 [25:14<19:03, 17.33s/epoch, loss=0.666, accuracy=0.857, val_loss=0.747, val_accuracy=0.826, lr=0.01] 57%|█████▋    | 85/150 [25:31<18:39, 17.22s/epoch, loss=0.613, accuracy=0.864, val_loss=0.795, val_accuracy=0.789, lr=0.01] 57%|█████▋    | 86/150 [25:49<18:42, 17.53s/epoch, loss=0.59, accuracy=0.863, val_loss=0.833, val_accuracy=0.78, lr=0.01]   58%|█████▊    | 87/150 [26:06<18:09, 17.29s/epoch, loss=0.575, accuracy=0.865, val_loss=0.707, val_accuracy=0.821, lr=0.01] 59%|█████▊    | 88/150 [26:23<18:02, 17.46s/epoch, loss=0.567, accuracy=0.865, val_loss=0.949, val_accuracy=0.74, lr=0.01]  59%|█████▉    | 89/150 [26:41<17:52, 17.58s/epoch, loss=0.56, accuracy=0.87, val_loss=0.69, val_accuracy=0.824, lr=0.01]   60%|██████    | 90/150 [26:58<17:25, 17.42s/epoch, loss=0.558, accuracy=0.869, val_loss=0.769, val_accuracy=0.814, lr=0.01] 61%|██████    | 91/150 [27:17<17:30, 17.80s/epoch, loss=0.556, accuracy=0.872, val_loss=0.933, val_accuracy=0.768, lr=0.01] 61%|██████▏   | 92/150 [27:34<16:58, 17.56s/epoch, loss=0.555, accuracy=0.873, val_loss=1.08, val_accuracy=0.727, lr=0.01]  62%|██████▏   | 93/150 [27:51<16:31, 17.40s/epoch, loss=0.551, accuracy=0.874, val_loss=0.868, val_accuracy=0.783, lr=0.01] 63%|██████▎   | 94/150 [28:08<16:04, 17.23s/epoch, loss=0.552, accuracy=0.876, val_loss=0.782, val_accuracy=0.799, lr=0.00316] 63%|██████▎   | 95/150 [28:26<16:06, 17.58s/epoch, loss=0.549, accuracy=0.878, val_loss=0.975, val_accuracy=0.76, lr=0.01]     64%|██████▍   | 96/150 [28:43<15:35, 17.32s/epoch, loss=0.553, accuracy=0.876, val_loss=0.879, val_accuracy=0.78, lr=0.01] 65%|██████▍   | 97/150 [29:00<15:09, 17.17s/epoch, loss=0.553, accuracy=0.877, val_loss=0.846, val_accuracy=0.795, lr=0.01] 65%|██████▌   | 98/150 [29:17<14:47, 17.07s/epoch, loss=0.546, accuracy=0.881, val_loss=0.812, val_accuracy=0.803, lr=0.01] 66%|██████▌   | 99/150 [29:35<14:43, 17.33s/epoch, loss=0.55, accuracy=0.88, val_loss=0.92, val_accuracy=0.759, lr=0.00316] 67%|██████▋   | 100/150 [29:52<14:27, 17.34s/epoch, loss=0.551, accuracy=0.88, val_loss=0.854, val_accuracy=0.785, lr=0.01] 67%|██████▋   | 101/150 [30:09<14:03, 17.21s/epoch, loss=0.546, accuracy=0.882, val_loss=0.865, val_accuracy=0.779, lr=0.01] 68%|██████▊   | 102/150 [30:26<13:51, 17.32s/epoch, loss=0.547, accuracy=0.883, val_loss=0.915, val_accuracy=0.76, lr=0.01]  69%|██████▊   | 103/150 [30:44<13:33, 17.31s/epoch, loss=0.548, accuracy=0.883, val_loss=0.833, val_accuracy=0.791, lr=0.01] 69%|██████▉   | 104/150 [31:01<13:10, 17.19s/epoch, loss=0.547, accuracy=0.883, val_loss=0.891, val_accuracy=0.777, lr=0.00316] 70%|███████   | 105/150 [31:18<12:58, 17.29s/epoch, loss=0.546, accuracy=0.885, val_loss=0.765, val_accuracy=0.807, lr=0.01]    71%|███████   | 106/150 [31:36<12:54, 17.61s/epoch, loss=0.548, accuracy=0.884, val_loss=0.847, val_accuracy=0.796, lr=0.01] 71%|███████▏  | 107/150 [31:54<12:37, 17.61s/epoch, loss=0.543, accuracy=0.884, val_loss=0.812, val_accuracy=0.802, lr=0.01] 72%|███████▏  | 108/150 [32:11<12:11, 17.42s/epoch, loss=0.547, accuracy=0.886, val_loss=1.03, val_accuracy=0.75, lr=0.01]   73%|███████▎  | 109/150 [32:28<11:49, 17.30s/epoch, loss=0.549, accuracy=0.886, val_loss=0.844, val_accuracy=0.792, lr=0.00316] 73%|███████▎  | 110/150 [32:45<11:27, 17.19s/epoch, loss=0.547, accuracy=0.886, val_loss=1.36, val_accuracy=0.688, lr=0.01]     74%|███████▍  | 111/150 [33:03<11:16, 17.34s/epoch, loss=0.548, accuracy=0.886, val_loss=0.843, val_accuracy=0.8, lr=0.01]  75%|███████▍  | 112/150 [33:20<10:53, 17.21s/epoch, loss=0.549, accuracy=0.885, val_loss=0.896, val_accuracy=0.787, lr=0.01] 75%|███████▌  | 113/150 [33:37<10:36, 17.20s/epoch, loss=0.549, accuracy=0.886, val_loss=0.781, val_accuracy=0.81, lr=0.01]  76%|███████▌  | 114/150 [33:54<10:20, 17.24s/epoch, loss=0.548, accuracy=0.887, val_loss=0.912, val_accuracy=0.779, lr=0.00316] 77%|███████▋  | 115/150 [34:12<10:11, 17.46s/epoch, loss=0.544, accuracy=0.887, val_loss=0.826, val_accuracy=0.815, lr=0.01]    77%|███████▋  | 116/150 [34:29<09:52, 17.42s/epoch, loss=0.547, accuracy=0.888, val_loss=0.821, val_accuracy=0.794, lr=0.01] 78%|███████▊  | 117/150 [34:48<09:44, 17.70s/epoch, loss=0.545, accuracy=0.889, val_loss=0.93, val_accuracy=0.775, lr=0.01]  79%|███████▊  | 118/150 [35:06<09:34, 17.95s/epoch, loss=0.546, accuracy=0.889, val_loss=0.761, val_accuracy=0.82, lr=0.01] 79%|███████▉  | 119/150 [35:23<09:06, 17.62s/epoch, loss=0.546, accuracy=0.888, val_loss=0.814, val_accuracy=0.805, lr=0.00316] 80%|████████  | 120/150 [35:41<08:46, 17.56s/epoch, loss=0.55, accuracy=0.888, val_loss=0.877, val_accuracy=0.774, lr=0.01]     81%|████████  | 121/150 [35:58<08:27, 17.49s/epoch, loss=0.547, accuracy=0.89, val_loss=0.786, val_accuracy=0.804, lr=0.01] 81%|████████▏ | 122/150 [36:16<08:14, 17.66s/epoch, loss=0.474, accuracy=0.915, val_loss=0.541, val_accuracy=0.895, lr=0.001] 82%|████████▏ | 123/150 [36:33<07:53, 17.54s/epoch, loss=0.417, accuracy=0.934, val_loss=0.514, val_accuracy=0.899, lr=0.001] 83%|████████▎ | 124/150 [36:50<07:30, 17.34s/epoch, loss=0.397, accuracy=0.938, val_loss=0.508, val_accuracy=0.901, lr=0.001] 83%|████████▎ | 125/150 [37:07<07:10, 17.23s/epoch, loss=0.384, accuracy=0.942, val_loss=0.497, val_accuracy=0.903, lr=0.001] 84%|████████▍ | 126/150 [37:25<06:56, 17.36s/epoch, loss=0.368, accuracy=0.946, val_loss=0.488, val_accuracy=0.904, lr=0.001] 85%|████████▍ | 127/150 [37:42<06:37, 17.29s/epoch, loss=0.355, accuracy=0.947, val_loss=0.488, val_accuracy=0.905, lr=0.001] 85%|████████▌ | 128/150 [37:59<06:17, 17.18s/epoch, loss=0.348, accuracy=0.947, val_loss=0.489, val_accuracy=0.902, lr=0.001] 86%|████████▌ | 129/150 [38:16<06:03, 17.31s/epoch, loss=0.337, accuracy=0.952, val_loss=0.476, val_accuracy=0.905, lr=0.001] 87%|████████▋ | 130/150 [38:35<05:56, 17.80s/epoch, loss=0.327, accuracy=0.953, val_loss=0.473, val_accuracy=0.905, lr=0.001] 87%|████████▋ | 131/150 [38:52<05:33, 17.54s/epoch, loss=0.32, accuracy=0.953, val_loss=0.469, val_accuracy=0.906, lr=0.001]  88%|████████▊ | 132/150 [39:10<05:17, 17.62s/epoch, loss=0.308, accuracy=0.957, val_loss=0.47, val_accuracy=0.903, lr=0.001] 89%|████████▊ | 133/150 [39:28<05:02, 17.79s/epoch, loss=0.302, accuracy=0.956, val_loss=0.474, val_accuracy=0.903, lr=0.001] 89%|████████▉ | 134/150 [39:45<04:39, 17.48s/epoch, loss=0.293, accuracy=0.958, val_loss=0.47, val_accuracy=0.902, lr=0.001]  90%|█████████ | 135/150 [40:02<04:20, 17.39s/epoch, loss=0.286, accuracy=0.96, val_loss=0.471, val_accuracy=0.9, lr=0.001]   91%|█████████ | 136/150 [40:20<04:03, 17.43s/epoch, loss=0.282, accuracy=0.959, val_loss=0.465, val_accuracy=0.902, lr=0.001] 91%|█████████▏| 137/150 [40:38<03:48, 17.55s/epoch, loss=0.275, accuracy=0.961, val_loss=0.483, val_accuracy=0.9, lr=0.001]   92%|█████████▏| 138/150 [40:55<03:29, 17.42s/epoch, loss=0.269, accuracy=0.962, val_loss=0.47, val_accuracy=0.899, lr=0.001] 93%|█████████▎| 139/150 [41:11<03:09, 17.22s/epoch, loss=0.266, accuracy=0.961, val_loss=0.473, val_accuracy=0.902, lr=0.001] 93%|█████████▎| 140/150 [41:29<02:54, 17.48s/epoch, loss=0.258, accuracy=0.963, val_loss=0.461, val_accuracy=0.903, lr=0.001] 94%|█████████▍| 141/150 [41:46<02:34, 17.22s/epoch, loss=0.256, accuracy=0.963, val_loss=0.481, val_accuracy=0.897, lr=0.001] 95%|█████████▍| 142/150 [42:04<02:20, 17.56s/epoch, loss=0.25, accuracy=0.964, val_loss=0.473, val_accuracy=0.898, lr=0.001]  95%|█████████▌| 143/150 [42:22<02:03, 17.59s/epoch, loss=0.245, accuracy=0.965, val_loss=0.451, val_accuracy=0.905, lr=0.001] 96%|█████████▌| 144/150 [42:41<01:46, 17.83s/epoch, loss=0.24, accuracy=0.966, val_loss=0.475, val_accuracy=0.9, lr=0.001]    97%|█████████▋| 145/150 [42:58<01:28, 17.78s/epoch, loss=0.234, accuracy=0.967, val_loss=0.501, val_accuracy=0.892, lr=0.001] 97%|█████████▋| 146/150 [43:15<01:10, 17.53s/epoch, loss=0.234, accuracy=0.966, val_loss=0.468, val_accuracy=0.9, lr=0.001]   98%|█████████▊| 147/150 [43:33<00:52, 17.51s/epoch, loss=0.231, accuracy=0.966, val_loss=0.483, val_accuracy=0.894, lr=0.001] 99%|█████████▊| 148/150 [43:51<00:35, 17.68s/epoch, loss=0.225, accuracy=0.968, val_loss=0.476, val_accuracy=0.897, lr=0.000316] 99%|█████████▉| 149/150 [44:08<00:17, 17.43s/epoch, loss=0.225, accuracy=0.967, val_loss=0.475, val_accuracy=0.894, lr=0.001]   100%|██████████| 150/150 [44:25<00:00, 17.33s/epoch, loss=0.224, accuracy=0.966, val_loss=0.509, val_accuracy=0.889, lr=0.001]100%|██████████| 150/150 [44:25<00:00, 17.77s/epoch, loss=0.224, accuracy=0.966, val_loss=0.509, val_accuracy=0.889, lr=0.001]
Using real-time data augmentation.
Test score: 0.4804416596889496
Test accuracy: 0.9017999768257141


* * * Run SGD for ID = 10_6. * * *


2024-02-19 19:35:19.931114: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 19:35:21.849552: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-19 19:35:21.850467: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-19 19:35:21.886514: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-02-19 19:35:21.886539: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 19:35:21.889136: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-19 19:35:21.889173: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-19 19:35:21.891174: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-19 19:35:21.891846: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-19 19:35:21.893867: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-19 19:35:21.895210: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-19 19:35:21.899880: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-19 19:35:21.900395: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-19 19:35:21.900463: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-19 19:35:23.294314: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-19 19:35:23.295216: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-19 19:35:23.295648: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-02-19 19:35:23.295677: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 19:35:23.295707: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-19 19:35:23.295722: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-19 19:35:23.295735: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-19 19:35:23.295749: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-19 19:35:23.295762: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-19 19:35:23.295776: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-19 19:35:23.295789: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-19 19:35:23.296214: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-19 19:35:23.296245: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 19:35:23.894092: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-19 19:35:23.894142: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-19 19:35:23.894150: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-19 19:35:23.895346: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11227 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN X (Pascal), pci bus id: 0000:83:00.0, compute capability: 6.1)
{'id': '10_06', 'batch_size': 128, 'epochs': 150, 'validation_split': 0.1, 'checkpointing': True, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN X (Pascal)'}
x_train shape: (45000, 32, 32, 3)
45000 train samples
5000 validation samples
10000 test samples
y_train shape: (45000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/150 [00:00<?, ?epoch/s]2024-02-19 19:35:24.663305: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-19 19:35:24.675084: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2600020000 Hz
2024-02-19 19:35:26.463011: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-19 19:35:26.656545: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-19 19:35:27.334470: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-19 19:35:27.372869: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/150 [00:49<2:01:44, 49.02s/epoch, loss=4.53, accuracy=0.304, val_loss=2.88, val_accuracy=0.241, lr=0.1]  1%|▏         | 2/150 [01:07<1:16:37, 31.06s/epoch, loss=1.79, accuracy=0.463, val_loss=1.8, val_accuracy=0.422, lr=0.1]   2%|▏         | 3/150 [01:24<1:00:30, 24.70s/epoch, loss=1.51, accuracy=0.55, val_loss=2.11, val_accuracy=0.435, lr=0.1]  3%|▎         | 4/150 [01:41<52:29, 21.57s/epoch, loss=1.35, accuracy=0.638, val_loss=2.07, val_accuracy=0.426, lr=0.1]   3%|▎         | 5/150 [01:58<48:13, 19.96s/epoch, loss=1.28, accuracy=0.68, val_loss=1.92, val_accuracy=0.494, lr=0.1]   4%|▍         | 6/150 [02:15<45:16, 18.86s/epoch, loss=1.26, accuracy=0.696, val_loss=2.45, val_accuracy=0.462, lr=0.1]  5%|▍         | 7/150 [02:33<44:29, 18.67s/epoch, loss=1.25, accuracy=0.708, val_loss=1.62, val_accuracy=0.581, lr=0.1]  5%|▌         | 8/150 [02:50<43:07, 18.22s/epoch, loss=1.24, accuracy=0.711, val_loss=1.44, val_accuracy=0.641, lr=0.1]  6%|▌         | 9/150 [03:09<42:50, 18.23s/epoch, loss=1.24, accuracy=0.719, val_loss=1.71, val_accuracy=0.567, lr=0.1]  7%|▋         | 10/150 [03:26<42:15, 18.11s/epoch, loss=1.22, accuracy=0.727, val_loss=2.59, val_accuracy=0.412, lr=0.1]  7%|▋         | 11/150 [03:43<41:04, 17.73s/epoch, loss=1.22, accuracy=0.727, val_loss=1.66, val_accuracy=0.569, lr=0.1]  8%|▊         | 12/150 [04:01<40:48, 17.75s/epoch, loss=1.22, accuracy=0.73, val_loss=3.04, val_accuracy=0.365, lr=0.1]   9%|▊         | 13/150 [04:18<40:18, 17.65s/epoch, loss=1.21, accuracy=0.733, val_loss=1.82, val_accuracy=0.565, lr=0.0316]  9%|▉         | 14/150 [04:37<40:30, 17.87s/epoch, loss=1.21, accuracy=0.734, val_loss=2.33, val_accuracy=0.463, lr=0.1]    10%|█         | 15/150 [04:53<39:21, 17.49s/epoch, loss=1.21, accuracy=0.733, val_loss=2.17, val_accuracy=0.484, lr=0.1] 11%|█         | 16/150 [05:12<39:51, 17.84s/epoch, loss=1.21, accuracy=0.735, val_loss=1.43, val_accuracy=0.651, lr=0.1] 11%|█▏        | 17/150 [05:29<38:45, 17.49s/epoch, loss=1.2, accuracy=0.739, val_loss=1.83, val_accuracy=0.585, lr=0.1]  12%|█▏        | 18/150 [05:46<37:58, 17.26s/epoch, loss=1.2, accuracy=0.737, val_loss=1.97, val_accuracy=0.546, lr=0.1] 13%|█▎        | 19/150 [06:03<37:52, 17.35s/epoch, loss=1.19, accuracy=0.742, val_loss=1.6, val_accuracy=0.592, lr=0.1] 13%|█▎        | 20/150 [06:20<37:13, 17.18s/epoch, loss=1.2, accuracy=0.74, val_loss=1.6, val_accuracy=0.603, lr=0.1]   14%|█▍        | 21/150 [06:38<37:37, 17.50s/epoch, loss=1.19, accuracy=0.739, val_loss=2.13, val_accuracy=0.519, lr=0.0316] 15%|█▍        | 22/150 [06:56<37:41, 17.67s/epoch, loss=1.18, accuracy=0.742, val_loss=1.68, val_accuracy=0.611, lr=0.1]    15%|█▌        | 23/150 [07:13<37:02, 17.50s/epoch, loss=1.18, accuracy=0.744, val_loss=1.79, val_accuracy=0.542, lr=0.1] 16%|█▌        | 24/150 [07:30<36:15, 17.27s/epoch, loss=1.18, accuracy=0.745, val_loss=2.51, val_accuracy=0.364, lr=0.1] 17%|█▋        | 25/150 [07:48<36:15, 17.40s/epoch, loss=1.18, accuracy=0.743, val_loss=2.07, val_accuracy=0.458, lr=0.1] 17%|█▋        | 26/150 [08:04<35:32, 17.20s/epoch, loss=1.17, accuracy=0.745, val_loss=2.06, val_accuracy=0.501, lr=0.0316] 18%|█▊        | 27/150 [08:21<35:08, 17.14s/epoch, loss=1.18, accuracy=0.747, val_loss=2.02, val_accuracy=0.493, lr=0.1]    19%|█▊        | 28/150 [08:40<35:27, 17.44s/epoch, loss=1.17, accuracy=0.747, val_loss=1.5, val_accuracy=0.633, lr=0.1]  19%|█▉        | 29/150 [08:58<35:56, 17.83s/epoch, loss=1.18, accuracy=0.745, val_loss=2.35, val_accuracy=0.458, lr=0.1] 20%|██        | 30/150 [09:17<36:14, 18.12s/epoch, loss=1.17, accuracy=0.746, val_loss=1.79, val_accuracy=0.55, lr=0.1]  21%|██        | 31/150 [09:34<35:29, 17.89s/epoch, loss=1.17, accuracy=0.747, val_loss=3.21, val_accuracy=0.305, lr=0.0316] 21%|██▏       | 32/150 [09:52<35:02, 17.82s/epoch, loss=1.17, accuracy=0.75, val_loss=1.64, val_accuracy=0.579, lr=0.1]     22%|██▏       | 33/150 [10:09<34:21, 17.62s/epoch, loss=1.16, accuracy=0.752, val_loss=1.8, val_accuracy=0.568, lr=0.1] 23%|██▎       | 34/150 [10:26<33:28, 17.32s/epoch, loss=1.16, accuracy=0.752, val_loss=1.4, val_accuracy=0.67, lr=0.1]  23%|██▎       | 35/150 [10:42<32:41, 17.06s/epoch, loss=1.17, accuracy=0.75, val_loss=1.72, val_accuracy=0.529, lr=0.1] 24%|██▍       | 36/150 [10:59<32:18, 17.01s/epoch, loss=1.17, accuracy=0.751, val_loss=2.95, val_accuracy=0.32, lr=0.1] 25%|██▍       | 37/150 [11:16<32:10, 17.08s/epoch, loss=1.17, accuracy=0.751, val_loss=1.62, val_accuracy=0.597, lr=0.1] 25%|██▌       | 38/150 [11:34<32:03, 17.18s/epoch, loss=1.17, accuracy=0.748, val_loss=1.96, val_accuracy=0.483, lr=0.1] 26%|██▌       | 39/150 [11:51<31:53, 17.24s/epoch, loss=1.16, accuracy=0.749, val_loss=1.85, val_accuracy=0.552, lr=0.0316] 27%|██▋       | 40/150 [12:08<31:20, 17.09s/epoch, loss=1.16, accuracy=0.748, val_loss=1.89, val_accuracy=0.556, lr=0.1]    27%|██▋       | 41/150 [12:26<31:24, 17.29s/epoch, loss=1.15, accuracy=0.752, val_loss=3.51, val_accuracy=0.39, lr=0.1]  28%|██▊       | 42/150 [12:44<31:33, 17.53s/epoch, loss=1.15, accuracy=0.752, val_loss=2.44, val_accuracy=0.419, lr=0.1] 29%|██▊       | 43/150 [13:03<31:52, 17.87s/epoch, loss=1.16, accuracy=0.751, val_loss=1.56, val_accuracy=0.626, lr=0.1] 29%|██▉       | 44/150 [13:21<32:02, 18.14s/epoch, loss=1.15, accuracy=0.752, val_loss=2, val_accuracy=0.496, lr=0.0316] 30%|███       | 45/150 [13:39<31:37, 18.07s/epoch, loss=1.15, accuracy=0.753, val_loss=1.35, val_accuracy=0.685, lr=0.1] 31%|███       | 46/150 [13:56<30:38, 17.68s/epoch, loss=1.16, accuracy=0.754, val_loss=1.5, val_accuracy=0.63, lr=0.1]   31%|███▏      | 47/150 [14:14<30:16, 17.64s/epoch, loss=1.15, accuracy=0.753, val_loss=2.03, val_accuracy=0.513, lr=0.1] 32%|███▏      | 48/150 [14:31<29:59, 17.64s/epoch, loss=1.15, accuracy=0.75, val_loss=2.26, val_accuracy=0.477, lr=0.1]  33%|███▎      | 49/150 [14:48<29:24, 17.47s/epoch, loss=1.16, accuracy=0.754, val_loss=1.71, val_accuracy=0.569, lr=0.1] 33%|███▎      | 50/150 [15:05<28:45, 17.25s/epoch, loss=1.15, accuracy=0.754, val_loss=1.45, val_accuracy=0.649, lr=0.0316] 34%|███▍      | 51/150 [15:21<28:04, 17.02s/epoch, loss=1.15, accuracy=0.753, val_loss=1.75, val_accuracy=0.603, lr=0.1]    35%|███▍      | 52/150 [15:39<27:49, 17.03s/epoch, loss=1.15, accuracy=0.752, val_loss=2.33, val_accuracy=0.395, lr=0.1] 35%|███▌      | 53/150 [15:56<27:31, 17.02s/epoch, loss=1.15, accuracy=0.751, val_loss=1.61, val_accuracy=0.586, lr=0.1] 36%|███▌      | 54/150 [16:12<27:07, 16.95s/epoch, loss=1.14, accuracy=0.754, val_loss=1.7, val_accuracy=0.603, lr=0.1]  37%|███▋      | 55/150 [16:29<26:50, 16.95s/epoch, loss=1.15, accuracy=0.755, val_loss=1.44, val_accuracy=0.643, lr=0.0316] 37%|███▋      | 56/150 [16:48<27:22, 17.47s/epoch, loss=1.15, accuracy=0.754, val_loss=3.69, val_accuracy=0.386, lr=0.1]    38%|███▊      | 57/150 [17:05<26:50, 17.31s/epoch, loss=1.15, accuracy=0.752, val_loss=1.75, val_accuracy=0.523, lr=0.1] 39%|███▊      | 58/150 [17:22<26:31, 17.30s/epoch, loss=1.15, accuracy=0.754, val_loss=2.38, val_accuracy=0.406, lr=0.1] 39%|███▉      | 59/150 [17:40<26:36, 17.55s/epoch, loss=1.15, accuracy=0.753, val_loss=1.63, val_accuracy=0.576, lr=0.1] 40%|████      | 60/150 [17:57<26:07, 17.42s/epoch, loss=1.14, accuracy=0.756, val_loss=2.63, val_accuracy=0.404, lr=0.0316] 41%|████      | 61/150 [18:14<25:32, 17.22s/epoch, loss=1.13, accuracy=0.754, val_loss=1.77, val_accuracy=0.561, lr=0.1]    41%|████▏     | 62/150 [18:33<25:51, 17.63s/epoch, loss=1.14, accuracy=0.754, val_loss=2.13, val_accuracy=0.489, lr=0.1] 42%|████▏     | 63/150 [18:51<26:00, 17.94s/epoch, loss=1.14, accuracy=0.755, val_loss=2.47, val_accuracy=0.356, lr=0.1] 43%|████▎     | 64/150 [19:10<25:55, 18.09s/epoch, loss=1.15, accuracy=0.752, val_loss=1.58, val_accuracy=0.617, lr=0.1] 43%|████▎     | 65/150 [19:28<25:39, 18.11s/epoch, loss=1.14, accuracy=0.753, val_loss=2.67, val_accuracy=0.41, lr=0.0316] 44%|████▍     | 66/150 [19:45<24:46, 17.70s/epoch, loss=1.14, accuracy=0.754, val_loss=1.59, val_accuracy=0.595, lr=0.1]   45%|████▍     | 67/150 [20:01<24:02, 17.37s/epoch, loss=1.15, accuracy=0.752, val_loss=1.53, val_accuracy=0.63, lr=0.1]  45%|████▌     | 68/150 [20:19<23:57, 17.53s/epoch, loss=1.15, accuracy=0.751, val_loss=1.83, val_accuracy=0.555, lr=0.1] 46%|████▌     | 69/150 [20:36<23:21, 17.30s/epoch, loss=1.14, accuracy=0.754, val_loss=1.51, val_accuracy=0.628, lr=0.1] 47%|████▋     | 70/150 [20:53<22:50, 17.13s/epoch, loss=1.14, accuracy=0.753, val_loss=1.66, val_accuracy=0.598, lr=0.0316] 47%|████▋     | 71/150 [21:11<22:49, 17.34s/epoch, loss=1.15, accuracy=0.755, val_loss=1.72, val_accuracy=0.591, lr=0.1]    48%|████▊     | 72/150 [21:28<22:38, 17.42s/epoch, loss=1.14, accuracy=0.756, val_loss=2.18, val_accuracy=0.451, lr=0.1] 49%|████▊     | 73/150 [21:45<22:03, 17.19s/epoch, loss=1.14, accuracy=0.756, val_loss=2.21, val_accuracy=0.531, lr=0.1] 49%|████▉     | 74/150 [22:02<21:39, 17.09s/epoch, loss=1.14, accuracy=0.755, val_loss=1.72, val_accuracy=0.553, lr=0.1] 50%|█████     | 75/150 [22:18<21:06, 16.88s/epoch, loss=1.14, accuracy=0.754, val_loss=2.26, val_accuracy=0.465, lr=0.0316] 51%|█████     | 76/150 [22:35<20:56, 16.99s/epoch, loss=1.14, accuracy=0.757, val_loss=3.12, val_accuracy=0.348, lr=0.1]    51%|█████▏    | 77/150 [22:52<20:37, 16.96s/epoch, loss=1.14, accuracy=0.755, val_loss=1.56, val_accuracy=0.592, lr=0.1] 52%|█████▏    | 78/150 [23:09<20:18, 16.93s/epoch, loss=1.15, accuracy=0.753, val_loss=2.22, val_accuracy=0.486, lr=0.1] 53%|█████▎    | 79/150 [23:26<20:05, 16.99s/epoch, loss=1.14, accuracy=0.755, val_loss=1.7, val_accuracy=0.569, lr=0.1]  53%|█████▎    | 80/150 [23:43<19:41, 16.88s/epoch, loss=1.15, accuracy=0.755, val_loss=1.95, val_accuracy=0.485, lr=0.0316] 54%|█████▍    | 81/150 [24:00<19:22, 16.84s/epoch, loss=1.14, accuracy=0.759, val_loss=1.67, val_accuracy=0.579, lr=0.1]    55%|█████▍    | 82/150 [24:18<19:42, 17.38s/epoch, loss=0.935, accuracy=0.814, val_loss=0.877, val_accuracy=0.82, lr=0.01] 55%|█████▌    | 83/150 [24:36<19:29, 17.46s/epoch, loss=0.756, accuracy=0.845, val_loss=0.835, val_accuracy=0.801, lr=0.01] 56%|█████▌    | 84/150 [24:53<19:12, 17.46s/epoch, loss=0.675, accuracy=0.854, val_loss=0.765, val_accuracy=0.817, lr=0.01] 57%|█████▋    | 85/150 [25:10<18:42, 17.27s/epoch, loss=0.622, accuracy=0.86, val_loss=0.687, val_accuracy=0.835, lr=0.01]  57%|█████▋    | 86/150 [25:28<18:42, 17.54s/epoch, loss=0.596, accuracy=0.861, val_loss=0.658, val_accuracy=0.838, lr=0.01] 58%|█████▊    | 87/150 [25:45<18:11, 17.33s/epoch, loss=0.583, accuracy=0.86, val_loss=0.89, val_accuracy=0.764, lr=0.01]   59%|█████▊    | 88/150 [26:02<17:41, 17.12s/epoch, loss=0.578, accuracy=0.863, val_loss=1.47, val_accuracy=0.65, lr=0.01] 59%|█████▉    | 89/150 [26:19<17:18, 17.03s/epoch, loss=0.574, accuracy=0.865, val_loss=0.785, val_accuracy=0.8, lr=0.01] 60%|██████    | 90/150 [26:35<16:59, 16.99s/epoch, loss=0.568, accuracy=0.864, val_loss=0.754, val_accuracy=0.805, lr=0.01] 61%|██████    | 91/150 [26:52<16:38, 16.92s/epoch, loss=0.572, accuracy=0.864, val_loss=0.686, val_accuracy=0.832, lr=0.00316] 61%|██████▏   | 92/150 [27:09<16:17, 16.85s/epoch, loss=0.57, accuracy=0.865, val_loss=0.786, val_accuracy=0.8, lr=0.01]       62%|██████▏   | 93/150 [27:26<16:05, 16.93s/epoch, loss=0.565, accuracy=0.869, val_loss=0.763, val_accuracy=0.81, lr=0.01] 63%|██████▎   | 94/150 [27:43<15:45, 16.88s/epoch, loss=0.562, accuracy=0.871, val_loss=0.768, val_accuracy=0.81, lr=0.01] 63%|██████▎   | 95/150 [28:00<15:31, 16.94s/epoch, loss=0.565, accuracy=0.872, val_loss=0.856, val_accuracy=0.792, lr=0.01] 64%|██████▍   | 96/150 [28:18<15:34, 17.31s/epoch, loss=0.563, accuracy=0.873, val_loss=0.661, val_accuracy=0.846, lr=0.00316] 65%|██████▍   | 97/150 [28:35<15:11, 17.19s/epoch, loss=0.561, accuracy=0.873, val_loss=0.715, val_accuracy=0.83, lr=0.01]     65%|██████▌   | 98/150 [28:52<14:46, 17.04s/epoch, loss=0.556, accuracy=0.876, val_loss=0.722, val_accuracy=0.819, lr=0.01] 66%|██████▌   | 99/150 [29:09<14:32, 17.11s/epoch, loss=0.557, accuracy=0.875, val_loss=0.818, val_accuracy=0.789, lr=0.01] 67%|██████▋   | 100/150 [29:26<14:12, 17.05s/epoch, loss=0.561, accuracy=0.876, val_loss=0.704, val_accuracy=0.831, lr=0.01] 67%|██████▋   | 101/150 [29:44<14:12, 17.39s/epoch, loss=0.563, accuracy=0.877, val_loss=0.822, val_accuracy=0.793, lr=0.00316] 68%|██████▊   | 102/150 [30:03<14:12, 17.76s/epoch, loss=0.56, accuracy=0.877, val_loss=0.697, val_accuracy=0.839, lr=0.01]     69%|██████▊   | 103/150 [30:19<13:38, 17.42s/epoch, loss=0.556, accuracy=0.879, val_loss=0.807, val_accuracy=0.795, lr=0.01] 69%|██████▉   | 104/150 [30:38<13:35, 17.74s/epoch, loss=0.565, accuracy=0.876, val_loss=0.748, val_accuracy=0.816, lr=0.01] 70%|███████   | 105/150 [30:55<13:07, 17.50s/epoch, loss=0.558, accuracy=0.88, val_loss=0.747, val_accuracy=0.821, lr=0.01]  71%|███████   | 106/150 [31:13<13:03, 17.80s/epoch, loss=0.563, accuracy=0.878, val_loss=0.764, val_accuracy=0.813, lr=0.00316] 71%|███████▏  | 107/150 [31:32<12:58, 18.11s/epoch, loss=0.558, accuracy=0.881, val_loss=0.927, val_accuracy=0.79, lr=0.01]     72%|███████▏  | 108/150 [31:49<12:23, 17.70s/epoch, loss=0.562, accuracy=0.881, val_loss=0.839, val_accuracy=0.795, lr=0.01] 73%|███████▎  | 109/150 [32:06<11:56, 17.46s/epoch, loss=0.557, accuracy=0.881, val_loss=0.815, val_accuracy=0.796, lr=0.01] 73%|███████▎  | 110/150 [32:23<11:42, 17.56s/epoch, loss=0.56, accuracy=0.88, val_loss=0.906, val_accuracy=0.78, lr=0.01]    74%|███████▍  | 111/150 [32:40<11:16, 17.36s/epoch, loss=0.562, accuracy=0.88, val_loss=0.835, val_accuracy=0.804, lr=0.00316] 75%|███████▍  | 112/150 [32:57<10:52, 17.17s/epoch, loss=0.561, accuracy=0.882, val_loss=0.832, val_accuracy=0.802, lr=0.01]   75%|███████▌  | 113/150 [33:14<10:32, 17.10s/epoch, loss=0.556, accuracy=0.883, val_loss=0.817, val_accuracy=0.812, lr=0.01] 76%|███████▌  | 114/150 [33:31<10:11, 16.98s/epoch, loss=0.562, accuracy=0.88, val_loss=0.738, val_accuracy=0.828, lr=0.01]  77%|███████▋  | 115/150 [33:48<09:57, 17.08s/epoch, loss=0.558, accuracy=0.883, val_loss=1.12, val_accuracy=0.73, lr=0.01]  77%|███████▋  | 116/150 [34:06<09:54, 17.47s/epoch, loss=0.565, accuracy=0.881, val_loss=0.791, val_accuracy=0.809, lr=0.00316] 78%|███████▊  | 117/150 [34:24<09:41, 17.64s/epoch, loss=0.56, accuracy=0.884, val_loss=0.879, val_accuracy=0.779, lr=0.01]     79%|███████▊  | 118/150 [34:43<09:34, 17.95s/epoch, loss=0.562, accuracy=0.882, val_loss=0.924, val_accuracy=0.772, lr=0.01] 79%|███████▉  | 119/150 [35:01<09:16, 17.95s/epoch, loss=0.556, accuracy=0.885, val_loss=1.24, val_accuracy=0.711, lr=0.01]  80%|████████  | 120/150 [35:20<09:04, 18.14s/epoch, loss=0.557, accuracy=0.885, val_loss=0.818, val_accuracy=0.807, lr=0.01] 81%|████████  | 121/150 [35:37<08:34, 17.76s/epoch, loss=0.557, accuracy=0.885, val_loss=0.714, val_accuracy=0.833, lr=0.00316] 81%|████████▏ | 122/150 [35:54<08:12, 17.58s/epoch, loss=0.492, accuracy=0.908, val_loss=0.526, val_accuracy=0.896, lr=0.001]   82%|████████▏ | 123/150 [36:10<07:48, 17.33s/epoch, loss=0.434, accuracy=0.926, val_loss=0.509, val_accuracy=0.899, lr=0.001] 83%|████████▎ | 124/150 [36:28<07:31, 17.35s/epoch, loss=0.409, accuracy=0.933, val_loss=0.495, val_accuracy=0.908, lr=0.001] 83%|████████▎ | 125/150 [36:45<07:12, 17.29s/epoch, loss=0.391, accuracy=0.939, val_loss=0.489, val_accuracy=0.904, lr=0.001] 84%|████████▍ | 126/150 [37:02<06:55, 17.32s/epoch, loss=0.378, accuracy=0.941, val_loss=0.483, val_accuracy=0.908, lr=0.001] 85%|████████▍ | 127/150 [37:19<06:33, 17.12s/epoch, loss=0.365, accuracy=0.945, val_loss=0.482, val_accuracy=0.906, lr=0.001] 85%|████████▌ | 128/150 [37:37<06:18, 17.23s/epoch, loss=0.354, accuracy=0.945, val_loss=0.471, val_accuracy=0.908, lr=0.001] 86%|████████▌ | 129/150 [37:53<05:57, 17.01s/epoch, loss=0.344, accuracy=0.948, val_loss=0.471, val_accuracy=0.905, lr=0.001] 87%|████████▋ | 130/150 [38:10<05:40, 17.02s/epoch, loss=0.337, accuracy=0.948, val_loss=0.479, val_accuracy=0.904, lr=0.001] 87%|████████▋ | 131/150 [38:27<05:22, 16.97s/epoch, loss=0.329, accuracy=0.95, val_loss=0.463, val_accuracy=0.902, lr=0.001]  88%|████████▊ | 132/150 [38:44<05:04, 16.92s/epoch, loss=0.321, accuracy=0.951, val_loss=0.472, val_accuracy=0.903, lr=0.001] 89%|████████▊ | 133/150 [39:00<04:46, 16.87s/epoch, loss=0.312, accuracy=0.952, val_loss=0.461, val_accuracy=0.909, lr=0.001] 89%|████████▉ | 134/150 [39:17<04:28, 16.79s/epoch, loss=0.306, accuracy=0.953, val_loss=0.458, val_accuracy=0.906, lr=0.001] 90%|█████████ | 135/150 [39:34<04:11, 16.74s/epoch, loss=0.297, accuracy=0.955, val_loss=0.451, val_accuracy=0.905, lr=0.001] 91%|█████████ | 136/150 [39:50<03:53, 16.65s/epoch, loss=0.293, accuracy=0.955, val_loss=0.473, val_accuracy=0.899, lr=0.001] 91%|█████████▏| 137/150 [40:07<03:37, 16.74s/epoch, loss=0.287, accuracy=0.956, val_loss=0.458, val_accuracy=0.899, lr=0.001] 92%|█████████▏| 138/150 [40:25<03:24, 17.08s/epoch, loss=0.28, accuracy=0.957, val_loss=0.461, val_accuracy=0.897, lr=0.001]  93%|█████████▎| 139/150 [40:42<03:06, 16.92s/epoch, loss=0.275, accuracy=0.957, val_loss=0.452, val_accuracy=0.898, lr=0.001] 93%|█████████▎| 140/150 [40:58<02:49, 16.94s/epoch, loss=0.268, accuracy=0.96, val_loss=0.462, val_accuracy=0.898, lr=0.000316] 94%|█████████▍| 141/150 [41:15<02:31, 16.89s/epoch, loss=0.265, accuracy=0.959, val_loss=0.45, val_accuracy=0.904, lr=0.001]    95%|█████████▍| 142/150 [41:32<02:15, 16.98s/epoch, loss=0.257, accuracy=0.961, val_loss=0.453, val_accuracy=0.899, lr=0.001] 95%|█████████▌| 143/150 [41:51<02:01, 17.41s/epoch, loss=0.256, accuracy=0.96, val_loss=0.455, val_accuracy=0.903, lr=0.001]  96%|█████████▌| 144/150 [42:09<01:45, 17.63s/epoch, loss=0.25, accuracy=0.961, val_loss=0.481, val_accuracy=0.895, lr=0.001] 97%|█████████▋| 145/150 [42:26<01:27, 17.52s/epoch, loss=0.248, accuracy=0.962, val_loss=0.477, val_accuracy=0.897, lr=0.001] 97%|█████████▋| 146/150 [42:44<01:10, 17.72s/epoch, loss=0.247, accuracy=0.961, val_loss=0.473, val_accuracy=0.89, lr=0.000316] 98%|█████████▊| 147/150 [43:02<00:52, 17.55s/epoch, loss=0.241, accuracy=0.962, val_loss=0.464, val_accuracy=0.891, lr=0.001]   99%|█████████▊| 148/150 [43:18<00:34, 17.28s/epoch, loss=0.235, accuracy=0.964, val_loss=0.463, val_accuracy=0.898, lr=0.001] 99%|█████████▉| 149/150 [43:35<00:17, 17.05s/epoch, loss=0.235, accuracy=0.963, val_loss=0.47, val_accuracy=0.89, lr=0.001]  100%|██████████| 150/150 [43:52<00:00, 17.05s/epoch, loss=0.232, accuracy=0.964, val_loss=0.456, val_accuracy=0.895, lr=0.001]100%|██████████| 150/150 [43:52<00:00, 17.55s/epoch, loss=0.232, accuracy=0.964, val_loss=0.456, val_accuracy=0.895, lr=0.001]
Using real-time data augmentation.
Test score: 0.4855419993400574
Test accuracy: 0.8960999846458435


* * * Run SGD for ID = 10_7. * * *


2024-02-19 20:19:22.001826: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 20:19:24.478064: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-19 20:19:24.478942: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-19 20:19:24.515717: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-02-19 20:19:24.515752: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 20:19:24.518299: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-19 20:19:24.518337: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-19 20:19:24.520454: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-19 20:19:24.521082: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-19 20:19:24.523193: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-19 20:19:24.524516: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-19 20:19:24.528750: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-19 20:19:24.529256: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-19 20:19:24.529327: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-19 20:19:25.907062: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-19 20:19:25.908140: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-19 20:19:25.909186: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-02-19 20:19:25.909215: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 20:19:25.909249: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-19 20:19:25.909266: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-19 20:19:25.909282: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-19 20:19:25.909297: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-19 20:19:25.909311: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-19 20:19:25.909325: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-19 20:19:25.909349: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-19 20:19:25.909758: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-19 20:19:25.909797: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 20:19:26.506533: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-19 20:19:26.506589: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-19 20:19:26.506598: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-19 20:19:26.507455: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11227 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN X (Pascal), pci bus id: 0000:83:00.0, compute capability: 6.1)
{'id': '10_07', 'batch_size': 128, 'epochs': 150, 'validation_split': 0.1, 'checkpointing': True, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN X (Pascal)'}
x_train shape: (45000, 32, 32, 3)
45000 train samples
5000 validation samples
10000 test samples
y_train shape: (45000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/150 [00:00<?, ?epoch/s]2024-02-19 20:19:27.276131: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-19 20:19:27.276644: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2600020000 Hz
2024-02-19 20:19:29.135178: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-19 20:19:29.371224: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-19 20:19:29.973119: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-19 20:19:30.023550: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/150 [00:50<2:06:24, 50.91s/epoch, loss=3.36, accuracy=0.249, val_loss=2.75, val_accuracy=0.181, lr=0.1]  1%|▏         | 2/150 [01:07<1:16:22, 30.96s/epoch, loss=1.7, accuracy=0.466, val_loss=2.82, val_accuracy=0.262, lr=0.1]   2%|▏         | 3/150 [01:25<1:00:39, 24.76s/epoch, loss=1.43, accuracy=0.598, val_loss=1.84, val_accuracy=0.462, lr=0.1]  3%|▎         | 4/150 [01:41<52:29, 21.58s/epoch, loss=1.3, accuracy=0.664, val_loss=2.33, val_accuracy=0.361, lr=0.1]     3%|▎         | 5/150 [01:59<48:18, 19.99s/epoch, loss=1.26, accuracy=0.691, val_loss=2.42, val_accuracy=0.364, lr=0.1]  4%|▍         | 6/150 [02:16<45:42, 19.04s/epoch, loss=1.24, accuracy=0.705, val_loss=2.96, val_accuracy=0.372, lr=0.1]  5%|▍         | 7/150 [02:33<43:54, 18.42s/epoch, loss=1.23, accuracy=0.715, val_loss=2.27, val_accuracy=0.452, lr=0.1]  5%|▌         | 8/150 [02:51<43:02, 18.19s/epoch, loss=1.22, accuracy=0.717, val_loss=1.48, val_accuracy=0.62, lr=0.1]   6%|▌         | 9/150 [03:08<41:56, 17.85s/epoch, loss=1.21, accuracy=0.723, val_loss=1.73, val_accuracy=0.585, lr=0.1]  7%|▋         | 10/150 [03:27<42:24, 18.17s/epoch, loss=1.2, accuracy=0.725, val_loss=2.02, val_accuracy=0.548, lr=0.1]  7%|▋         | 11/150 [03:45<42:15, 18.24s/epoch, loss=1.19, accuracy=0.731, val_loss=1.5, val_accuracy=0.663, lr=0.1]  8%|▊         | 12/150 [04:03<41:51, 18.20s/epoch, loss=1.19, accuracy=0.733, val_loss=1.66, val_accuracy=0.569, lr=0.1]  9%|▊         | 13/150 [04:20<40:44, 17.84s/epoch, loss=1.18, accuracy=0.733, val_loss=2.73, val_accuracy=0.387, lr=0.0316]  9%|▉         | 14/150 [04:37<39:54, 17.61s/epoch, loss=1.19, accuracy=0.736, val_loss=1.59, val_accuracy=0.597, lr=0.1]    10%|█         | 15/150 [04:55<39:47, 17.69s/epoch, loss=1.18, accuracy=0.736, val_loss=1.68, val_accuracy=0.594, lr=0.1] 11%|█         | 16/150 [05:14<40:11, 18.00s/epoch, loss=1.18, accuracy=0.735, val_loss=1.77, val_accuracy=0.575, lr=0.1] 11%|█▏        | 17/150 [05:31<39:29, 17.81s/epoch, loss=1.18, accuracy=0.736, val_loss=1.6, val_accuracy=0.595, lr=0.1]  12%|█▏        | 18/150 [05:49<39:00, 17.73s/epoch, loss=1.17, accuracy=0.739, val_loss=2.11, val_accuracy=0.427, lr=0.0316] 13%|█▎        | 19/150 [06:08<39:41, 18.18s/epoch, loss=1.18, accuracy=0.74, val_loss=1.37, val_accuracy=0.671, lr=0.1]     13%|█▎        | 20/150 [06:27<39:46, 18.36s/epoch, loss=1.16, accuracy=0.743, val_loss=2.45, val_accuracy=0.426, lr=0.1] 14%|█▍        | 21/150 [06:46<39:52, 18.54s/epoch, loss=1.18, accuracy=0.741, val_loss=1.92, val_accuracy=0.515, lr=0.1] 15%|█▍        | 22/150 [07:03<38:35, 18.09s/epoch, loss=1.17, accuracy=0.742, val_loss=2.11, val_accuracy=0.52, lr=0.1]  15%|█▌        | 23/150 [07:21<38:07, 18.01s/epoch, loss=1.16, accuracy=0.746, val_loss=1.97, val_accuracy=0.5, lr=0.1]  16%|█▌        | 24/150 [07:39<37:57, 18.08s/epoch, loss=1.16, accuracy=0.745, val_loss=2.55, val_accuracy=0.432, lr=0.0316] 17%|█▋        | 25/150 [07:56<37:01, 17.77s/epoch, loss=1.16, accuracy=0.746, val_loss=1.68, val_accuracy=0.596, lr=0.1]    17%|█▋        | 26/150 [08:13<36:23, 17.61s/epoch, loss=1.17, accuracy=0.743, val_loss=1.49, val_accuracy=0.635, lr=0.1] 18%|█▊        | 27/150 [08:30<35:46, 17.45s/epoch, loss=1.16, accuracy=0.748, val_loss=1.83, val_accuracy=0.528, lr=0.1] 19%|█▊        | 28/150 [08:47<35:18, 17.36s/epoch, loss=1.16, accuracy=0.747, val_loss=2.44, val_accuracy=0.456, lr=0.1] 19%|█▉        | 29/150 [09:06<35:52, 17.79s/epoch, loss=1.16, accuracy=0.748, val_loss=1.53, val_accuracy=0.607, lr=0.0316] 20%|██        | 30/150 [09:23<35:07, 17.56s/epoch, loss=1.16, accuracy=0.748, val_loss=1.53, val_accuracy=0.622, lr=0.1]    21%|██        | 31/150 [09:40<34:31, 17.40s/epoch, loss=1.16, accuracy=0.745, val_loss=2.44, val_accuracy=0.433, lr=0.1] 21%|██▏       | 32/150 [09:57<34:05, 17.33s/epoch, loss=1.16, accuracy=0.748, val_loss=2.65, val_accuracy=0.366, lr=0.1] 22%|██▏       | 33/150 [10:15<33:41, 17.28s/epoch, loss=1.16, accuracy=0.746, val_loss=3.13, val_accuracy=0.36, lr=0.1]  23%|██▎       | 34/150 [10:32<33:18, 17.22s/epoch, loss=1.16, accuracy=0.75, val_loss=1.58, val_accuracy=0.607, lr=0.0316] 23%|██▎       | 35/150 [10:49<33:16, 17.36s/epoch, loss=1.15, accuracy=0.748, val_loss=1.78, val_accuracy=0.54, lr=0.1]    24%|██▍       | 36/150 [11:08<33:37, 17.70s/epoch, loss=1.15, accuracy=0.749, val_loss=5.06, val_accuracy=0.268, lr=0.1] 25%|██▍       | 37/150 [11:26<33:26, 17.75s/epoch, loss=1.15, accuracy=0.751, val_loss=1.87, val_accuracy=0.513, lr=0.1] 25%|██▌       | 38/150 [11:43<32:42, 17.52s/epoch, loss=1.16, accuracy=0.749, val_loss=2.16, val_accuracy=0.507, lr=0.1] 26%|██▌       | 39/150 [12:00<32:32, 17.59s/epoch, loss=1.15, accuracy=0.751, val_loss=4.42, val_accuracy=0.355, lr=0.0316] 27%|██▋       | 40/150 [12:18<32:01, 17.47s/epoch, loss=1.14, accuracy=0.752, val_loss=2.68, val_accuracy=0.371, lr=0.1]    27%|██▋       | 41/150 [12:36<32:25, 17.85s/epoch, loss=1.15, accuracy=0.754, val_loss=2.31, val_accuracy=0.431, lr=0.1] 28%|██▊       | 42/150 [12:55<32:37, 18.12s/epoch, loss=1.15, accuracy=0.751, val_loss=1.8, val_accuracy=0.537, lr=0.1]  29%|██▊       | 43/150 [13:14<32:31, 18.24s/epoch, loss=1.15, accuracy=0.751, val_loss=1.86, val_accuracy=0.558, lr=0.1] 29%|██▉       | 44/150 [13:31<31:39, 17.92s/epoch, loss=1.14, accuracy=0.754, val_loss=2.84, val_accuracy=0.41, lr=0.0316] 30%|███       | 45/150 [13:48<30:59, 17.71s/epoch, loss=1.14, accuracy=0.755, val_loss=1.96, val_accuracy=0.481, lr=0.1]   31%|███       | 46/150 [14:06<30:48, 17.77s/epoch, loss=1.15, accuracy=0.753, val_loss=1.36, val_accuracy=0.677, lr=0.1] 31%|███▏      | 47/150 [14:23<30:11, 17.59s/epoch, loss=1.14, accuracy=0.754, val_loss=1.5, val_accuracy=0.621, lr=0.1]  32%|███▏      | 48/150 [14:41<30:12, 17.77s/epoch, loss=1.15, accuracy=0.751, val_loss=1.57, val_accuracy=0.599, lr=0.1] 33%|███▎      | 49/150 [15:00<30:23, 18.06s/epoch, loss=1.14, accuracy=0.754, val_loss=2.18, val_accuracy=0.454, lr=0.1] 33%|███▎      | 50/150 [15:19<30:24, 18.24s/epoch, loss=1.15, accuracy=0.752, val_loss=2.05, val_accuracy=0.47, lr=0.1]  34%|███▍      | 51/150 [15:37<30:12, 18.31s/epoch, loss=1.13, accuracy=0.753, val_loss=1.76, val_accuracy=0.58, lr=0.0316] 35%|███▍      | 52/150 [15:56<30:11, 18.48s/epoch, loss=1.14, accuracy=0.751, val_loss=4, val_accuracy=0.264, lr=0.1]      35%|███▌      | 53/150 [16:14<29:42, 18.37s/epoch, loss=1.14, accuracy=0.754, val_loss=2.77, val_accuracy=0.442, lr=0.1] 36%|███▌      | 54/150 [16:32<28:55, 18.08s/epoch, loss=1.15, accuracy=0.755, val_loss=2.27, val_accuracy=0.467, lr=0.1] 37%|███▋      | 55/150 [16:49<28:18, 17.88s/epoch, loss=1.14, accuracy=0.757, val_loss=1.87, val_accuracy=0.516, lr=0.1] 37%|███▋      | 56/150 [17:06<27:49, 17.76s/epoch, loss=1.14, accuracy=0.754, val_loss=1.4, val_accuracy=0.687, lr=0.0316] 38%|███▊      | 57/150 [17:24<27:17, 17.61s/epoch, loss=1.13, accuracy=0.754, val_loss=1.43, val_accuracy=0.654, lr=0.1]   39%|███▊      | 58/150 [17:42<27:15, 17.78s/epoch, loss=1.14, accuracy=0.753, val_loss=1.75, val_accuracy=0.62, lr=0.1]  39%|███▉      | 59/150 [18:01<27:31, 18.14s/epoch, loss=1.13, accuracy=0.755, val_loss=1.91, val_accuracy=0.563, lr=0.1] 40%|████      | 60/150 [18:18<26:50, 17.90s/epoch, loss=1.14, accuracy=0.754, val_loss=2.59, val_accuracy=0.408, lr=0.1] 41%|████      | 61/150 [18:36<26:36, 17.93s/epoch, loss=1.13, accuracy=0.757, val_loss=2.08, val_accuracy=0.432, lr=0.0316] 41%|████▏     | 62/150 [18:54<26:10, 17.84s/epoch, loss=1.13, accuracy=0.759, val_loss=2.14, val_accuracy=0.474, lr=0.1]    42%|████▏     | 63/150 [19:12<25:52, 17.85s/epoch, loss=1.13, accuracy=0.756, val_loss=2.9, val_accuracy=0.346, lr=0.1]  43%|████▎     | 64/150 [19:31<26:00, 18.15s/epoch, loss=1.13, accuracy=0.754, val_loss=2.05, val_accuracy=0.491, lr=0.1] 43%|████▎     | 65/150 [19:48<25:19, 17.87s/epoch, loss=1.14, accuracy=0.755, val_loss=1.98, val_accuracy=0.471, lr=0.1] 44%|████▍     | 66/150 [20:05<24:44, 17.67s/epoch, loss=1.15, accuracy=0.752, val_loss=3.32, val_accuracy=0.337, lr=0.0316] 45%|████▍     | 67/150 [20:24<24:48, 17.93s/epoch, loss=1.14, accuracy=0.753, val_loss=1.95, val_accuracy=0.551, lr=0.1]    45%|████▌     | 68/150 [20:41<24:21, 17.82s/epoch, loss=1.14, accuracy=0.755, val_loss=2.4, val_accuracy=0.366, lr=0.1]  46%|████▌     | 69/150 [20:59<24:10, 17.91s/epoch, loss=1.13, accuracy=0.756, val_loss=2.71, val_accuracy=0.312, lr=0.1] 47%|████▋     | 70/150 [21:18<24:12, 18.16s/epoch, loss=1.13, accuracy=0.756, val_loss=1.95, val_accuracy=0.55, lr=0.1]  47%|████▋     | 71/150 [21:36<24:01, 18.24s/epoch, loss=1.14, accuracy=0.755, val_loss=1.73, val_accuracy=0.566, lr=0.0316] 48%|████▊     | 72/150 [21:55<23:54, 18.39s/epoch, loss=1.14, accuracy=0.753, val_loss=1.83, val_accuracy=0.518, lr=0.1]    49%|████▊     | 73/150 [22:12<23:01, 17.95s/epoch, loss=1.13, accuracy=0.757, val_loss=1.44, val_accuracy=0.653, lr=0.1] 49%|████▉     | 74/150 [22:29<22:25, 17.70s/epoch, loss=1.13, accuracy=0.756, val_loss=1.56, val_accuracy=0.611, lr=0.1] 50%|█████     | 75/150 [22:47<22:20, 17.88s/epoch, loss=1.13, accuracy=0.759, val_loss=2.12, val_accuracy=0.476, lr=0.1] 51%|█████     | 76/150 [23:06<22:22, 18.15s/epoch, loss=1.13, accuracy=0.755, val_loss=2.78, val_accuracy=0.325, lr=0.0316] 51%|█████▏    | 77/150 [23:25<22:11, 18.24s/epoch, loss=1.13, accuracy=0.754, val_loss=1.92, val_accuracy=0.506, lr=0.1]    52%|█████▏    | 78/150 [23:42<21:36, 18.00s/epoch, loss=1.13, accuracy=0.754, val_loss=2.34, val_accuracy=0.456, lr=0.1] 53%|█████▎    | 79/150 [24:00<21:19, 18.02s/epoch, loss=1.13, accuracy=0.756, val_loss=2.12, val_accuracy=0.431, lr=0.1] 53%|█████▎    | 80/150 [24:19<21:16, 18.23s/epoch, loss=1.13, accuracy=0.758, val_loss=1.95, val_accuracy=0.538, lr=0.1] 54%|█████▍    | 81/150 [24:37<20:53, 18.17s/epoch, loss=1.13, accuracy=0.754, val_loss=2.6, val_accuracy=0.445, lr=0.0316] 55%|█████▍    | 82/150 [24:56<20:46, 18.34s/epoch, loss=0.94, accuracy=0.813, val_loss=0.944, val_accuracy=0.796, lr=0.01] 55%|█████▌    | 83/150 [25:14<20:23, 18.26s/epoch, loss=0.756, accuracy=0.847, val_loss=0.835, val_accuracy=0.807, lr=0.01] 56%|█████▌    | 84/150 [25:32<20:12, 18.37s/epoch, loss=0.673, accuracy=0.854, val_loss=0.785, val_accuracy=0.816, lr=0.01] 57%|█████▋    | 85/150 [25:50<19:40, 18.16s/epoch, loss=0.622, accuracy=0.858, val_loss=0.701, val_accuracy=0.825, lr=0.01] 57%|█████▋    | 86/150 [26:09<19:29, 18.27s/epoch, loss=0.598, accuracy=0.86, val_loss=0.767, val_accuracy=0.804, lr=0.01]  58%|█████▊    | 87/150 [26:27<19:17, 18.37s/epoch, loss=0.578, accuracy=0.862, val_loss=0.959, val_accuracy=0.747, lr=0.01] 59%|█████▊    | 88/150 [26:45<18:40, 18.07s/epoch, loss=0.571, accuracy=0.864, val_loss=0.709, val_accuracy=0.822, lr=0.01] 59%|█████▉    | 89/150 [27:02<18:14, 17.94s/epoch, loss=0.57, accuracy=0.865, val_loss=0.79, val_accuracy=0.789, lr=0.01]   60%|██████    | 90/150 [27:20<18:01, 18.03s/epoch, loss=0.563, accuracy=0.868, val_loss=0.788, val_accuracy=0.791, lr=0.00316] 61%|██████    | 91/150 [27:38<17:27, 17.76s/epoch, loss=0.561, accuracy=0.869, val_loss=0.934, val_accuracy=0.75, lr=0.01]     61%|██████▏   | 92/150 [27:55<17:07, 17.72s/epoch, loss=0.562, accuracy=0.869, val_loss=1.42, val_accuracy=0.685, lr=0.01] 62%|██████▏   | 93/150 [28:13<16:54, 17.79s/epoch, loss=0.559, accuracy=0.87, val_loss=0.798, val_accuracy=0.789, lr=0.01] 63%|██████▎   | 94/150 [28:30<16:27, 17.63s/epoch, loss=0.561, accuracy=0.872, val_loss=0.759, val_accuracy=0.809, lr=0.01] 63%|██████▎   | 95/150 [28:48<16:16, 17.75s/epoch, loss=0.556, accuracy=0.873, val_loss=0.704, val_accuracy=0.822, lr=0.00316] 64%|██████▍   | 96/150 [29:06<15:48, 17.56s/epoch, loss=0.559, accuracy=0.872, val_loss=0.79, val_accuracy=0.798, lr=0.01]     65%|██████▍   | 97/150 [29:23<15:26, 17.47s/epoch, loss=0.558, accuracy=0.873, val_loss=0.817, val_accuracy=0.79, lr=0.01] 65%|██████▌   | 98/150 [29:40<15:01, 17.34s/epoch, loss=0.555, accuracy=0.876, val_loss=0.906, val_accuracy=0.771, lr=0.01] 66%|██████▌   | 99/150 [29:59<15:08, 17.82s/epoch, loss=0.554, accuracy=0.877, val_loss=0.729, val_accuracy=0.827, lr=0.01] 67%|██████▋   | 100/150 [30:17<14:52, 17.84s/epoch, loss=0.556, accuracy=0.878, val_loss=1.06, val_accuracy=0.74, lr=0.00316] 67%|██████▋   | 101/150 [30:34<14:29, 17.74s/epoch, loss=0.555, accuracy=0.876, val_loss=0.841, val_accuracy=0.784, lr=0.01]  68%|██████▊   | 102/150 [30:52<14:06, 17.64s/epoch, loss=0.556, accuracy=0.877, val_loss=0.807, val_accuracy=0.81, lr=0.01]  69%|██████▊   | 103/150 [31:08<13:38, 17.42s/epoch, loss=0.55, accuracy=0.879, val_loss=1.08, val_accuracy=0.747, lr=0.01]  69%|██████▉   | 104/150 [31:26<13:20, 17.39s/epoch, loss=0.553, accuracy=0.88, val_loss=0.769, val_accuracy=0.805, lr=0.01] 70%|███████   | 105/150 [31:43<12:56, 17.26s/epoch, loss=0.551, accuracy=0.879, val_loss=0.825, val_accuracy=0.791, lr=0.00316] 71%|███████   | 106/150 [32:00<12:39, 17.26s/epoch, loss=0.556, accuracy=0.88, val_loss=0.953, val_accuracy=0.76, lr=0.01]      71%|███████▏  | 107/150 [32:18<12:34, 17.54s/epoch, loss=0.55, accuracy=0.881, val_loss=0.884, val_accuracy=0.783, lr=0.01] 72%|███████▏  | 108/150 [32:37<12:33, 17.94s/epoch, loss=0.547, accuracy=0.882, val_loss=0.858, val_accuracy=0.786, lr=0.01] 73%|███████▎  | 109/150 [32:56<12:24, 18.16s/epoch, loss=0.556, accuracy=0.881, val_loss=0.85, val_accuracy=0.795, lr=0.01]  73%|███████▎  | 110/150 [33:14<12:04, 18.12s/epoch, loss=0.551, accuracy=0.883, val_loss=0.839, val_accuracy=0.792, lr=0.00316] 74%|███████▍  | 111/150 [33:31<11:35, 17.83s/epoch, loss=0.552, accuracy=0.883, val_loss=0.729, val_accuracy=0.821, lr=0.01]    75%|███████▍  | 112/150 [33:49<11:24, 18.00s/epoch, loss=0.551, accuracy=0.883, val_loss=0.812, val_accuracy=0.797, lr=0.01] 75%|███████▌  | 113/150 [34:06<10:53, 17.66s/epoch, loss=0.558, accuracy=0.881, val_loss=0.925, val_accuracy=0.767, lr=0.01] 76%|███████▌  | 114/150 [34:23<10:30, 17.50s/epoch, loss=0.545, accuracy=0.884, val_loss=0.726, val_accuracy=0.827, lr=0.01] 77%|███████▋  | 115/150 [34:41<10:10, 17.44s/epoch, loss=0.556, accuracy=0.881, val_loss=0.822, val_accuracy=0.806, lr=0.00316] 77%|███████▋  | 116/150 [34:58<09:48, 17.30s/epoch, loss=0.552, accuracy=0.884, val_loss=1.09, val_accuracy=0.733, lr=0.01]     78%|███████▊  | 117/150 [35:15<09:30, 17.29s/epoch, loss=0.551, accuracy=0.885, val_loss=0.881, val_accuracy=0.787, lr=0.01] 79%|███████▊  | 118/150 [35:32<09:14, 17.32s/epoch, loss=0.55, accuracy=0.886, val_loss=0.829, val_accuracy=0.794, lr=0.01]  79%|███████▉  | 119/150 [35:50<08:56, 17.30s/epoch, loss=0.549, accuracy=0.885, val_loss=0.789, val_accuracy=0.817, lr=0.01] 80%|████████  | 120/150 [36:08<08:51, 17.70s/epoch, loss=0.554, accuracy=0.884, val_loss=0.939, val_accuracy=0.778, lr=0.00316] 81%|████████  | 121/150 [36:26<08:38, 17.89s/epoch, loss=0.556, accuracy=0.884, val_loss=0.951, val_accuracy=0.766, lr=0.01]    81%|████████▏ | 122/150 [36:44<08:19, 17.84s/epoch, loss=0.478, accuracy=0.913, val_loss=0.516, val_accuracy=0.893, lr=0.001] 82%|████████▏ | 123/150 [37:02<07:59, 17.77s/epoch, loss=0.423, accuracy=0.929, val_loss=0.503, val_accuracy=0.9, lr=0.001]   83%|████████▎ | 124/150 [37:18<07:32, 17.41s/epoch, loss=0.402, accuracy=0.935, val_loss=0.489, val_accuracy=0.899, lr=0.001] 83%|████████▎ | 125/150 [37:36<07:14, 17.37s/epoch, loss=0.384, accuracy=0.94, val_loss=0.489, val_accuracy=0.899, lr=0.001]  84%|████████▍ | 126/150 [37:53<06:59, 17.46s/epoch, loss=0.372, accuracy=0.941, val_loss=0.484, val_accuracy=0.902, lr=0.001] 85%|████████▍ | 127/150 [38:10<06:37, 17.26s/epoch, loss=0.36, accuracy=0.944, val_loss=0.477, val_accuracy=0.901, lr=0.001]  85%|████████▌ | 128/150 [38:29<06:29, 17.70s/epoch, loss=0.351, accuracy=0.945, val_loss=0.475, val_accuracy=0.901, lr=0.001] 86%|████████▌ | 129/150 [38:46<06:05, 17.39s/epoch, loss=0.341, accuracy=0.947, val_loss=0.466, val_accuracy=0.901, lr=0.001] 87%|████████▋ | 130/150 [39:03<05:45, 17.28s/epoch, loss=0.331, accuracy=0.949, val_loss=0.457, val_accuracy=0.903, lr=0.001] 87%|████████▋ | 131/150 [39:19<05:24, 17.10s/epoch, loss=0.322, accuracy=0.951, val_loss=0.467, val_accuracy=0.901, lr=0.001] 88%|████████▊ | 132/150 [39:36<05:07, 17.06s/epoch, loss=0.316, accuracy=0.951, val_loss=0.467, val_accuracy=0.9, lr=0.001]   89%|████████▊ | 133/150 [39:53<04:50, 17.11s/epoch, loss=0.304, accuracy=0.953, val_loss=0.453, val_accuracy=0.905, lr=0.001] 89%|████████▉ | 134/150 [40:11<04:35, 17.19s/epoch, loss=0.296, accuracy=0.956, val_loss=0.458, val_accuracy=0.907, lr=0.001] 90%|█████████ | 135/150 [40:27<04:15, 17.02s/epoch, loss=0.296, accuracy=0.955, val_loss=0.443, val_accuracy=0.907, lr=0.001] 91%|█████████ | 136/150 [40:44<03:58, 17.01s/epoch, loss=0.285, accuracy=0.956, val_loss=0.459, val_accuracy=0.903, lr=0.001] 91%|█████████▏| 137/150 [41:01<03:41, 17.04s/epoch, loss=0.281, accuracy=0.956, val_loss=0.451, val_accuracy=0.905, lr=0.001] 92%|█████████▏| 138/150 [41:18<03:23, 16.92s/epoch, loss=0.273, accuracy=0.959, val_loss=0.445, val_accuracy=0.904, lr=0.001] 93%|█████████▎| 139/150 [41:35<03:06, 16.97s/epoch, loss=0.27, accuracy=0.958, val_loss=0.46, val_accuracy=0.9, lr=0.001]     93%|█████████▎| 140/150 [41:54<02:55, 17.53s/epoch, loss=0.264, accuracy=0.96, val_loss=0.471, val_accuracy=0.894, lr=0.000316] 94%|█████████▍| 141/150 [42:13<02:41, 17.93s/epoch, loss=0.259, accuracy=0.96, val_loss=0.444, val_accuracy=0.905, lr=0.001]    95%|█████████▍| 142/150 [42:30<02:20, 17.57s/epoch, loss=0.255, accuracy=0.961, val_loss=0.432, val_accuracy=0.905, lr=0.001] 95%|█████████▌| 143/150 [42:48<02:04, 17.75s/epoch, loss=0.25, accuracy=0.961, val_loss=0.47, val_accuracy=0.893, lr=0.001]   96%|█████████▌| 144/150 [43:05<01:44, 17.45s/epoch, loss=0.243, accuracy=0.964, val_loss=0.451, val_accuracy=0.899, lr=0.001] 97%|█████████▋| 145/150 [43:22<01:27, 17.55s/epoch, loss=0.242, accuracy=0.962, val_loss=0.475, val_accuracy=0.895, lr=0.001] 97%|█████████▋| 146/150 [43:40<01:10, 17.58s/epoch, loss=0.239, accuracy=0.962, val_loss=0.499, val_accuracy=0.887, lr=0.001] 98%|█████████▊| 147/150 [43:57<00:52, 17.35s/epoch, loss=0.237, accuracy=0.962, val_loss=0.469, val_accuracy=0.896, lr=0.000316] 99%|█████████▊| 148/150 [44:13<00:34, 17.14s/epoch, loss=0.233, accuracy=0.962, val_loss=0.498, val_accuracy=0.887, lr=0.001]    99%|█████████▉| 149/150 [44:31<00:17, 17.19s/epoch, loss=0.23, accuracy=0.964, val_loss=0.471, val_accuracy=0.896, lr=0.001] 100%|██████████| 150/150 [44:50<00:00, 17.69s/epoch, loss=0.229, accuracy=0.963, val_loss=0.456, val_accuracy=0.899, lr=0.001]100%|██████████| 150/150 [44:50<00:00, 17.93s/epoch, loss=0.229, accuracy=0.963, val_loss=0.456, val_accuracy=0.899, lr=0.001]
Using real-time data augmentation.
Test score: 0.48571377992630005
Test accuracy: 0.8970999717712402


* * * Run SGD for ID = 10_8. * * *


2024-02-19 21:04:22.790231: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 21:04:25.292103: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-19 21:04:25.293112: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-19 21:04:25.329361: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-02-19 21:04:25.329398: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 21:04:25.332045: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-19 21:04:25.332083: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-19 21:04:25.334285: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-19 21:04:25.335393: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-19 21:04:25.337563: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-19 21:04:25.338871: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-19 21:04:25.343066: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-19 21:04:25.343539: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-19 21:04:25.343614: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-19 21:04:26.722332: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-19 21:04:26.723733: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-19 21:04:26.724456: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-02-19 21:04:26.724485: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 21:04:26.724520: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-19 21:04:26.724537: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-19 21:04:26.724552: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-19 21:04:26.724568: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-19 21:04:26.724583: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-19 21:04:26.724597: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-19 21:04:26.724612: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-19 21:04:26.725036: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-19 21:04:26.725068: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 21:04:27.320894: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-19 21:04:27.320953: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-19 21:04:27.320969: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-19 21:04:27.321802: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11227 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN X (Pascal), pci bus id: 0000:83:00.0, compute capability: 6.1)
{'id': '10_08', 'batch_size': 128, 'epochs': 150, 'validation_split': 0.1, 'checkpointing': True, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN X (Pascal)'}
x_train shape: (45000, 32, 32, 3)
45000 train samples
5000 validation samples
10000 test samples
y_train shape: (45000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/150 [00:00<?, ?epoch/s]2024-02-19 21:04:28.093989: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-19 21:04:28.106097: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2600020000 Hz
2024-02-19 21:04:29.942629: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-19 21:04:30.147300: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-19 21:04:30.826675: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-19 21:04:30.867242: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/150 [00:50<2:04:19, 50.06s/epoch, loss=3.47, accuracy=0.297, val_loss=2.76, val_accuracy=0.204, lr=0.1]  1%|▏         | 2/150 [01:07<1:16:00, 30.81s/epoch, loss=1.64, accuracy=0.497, val_loss=3.2, val_accuracy=0.276, lr=0.1]   2%|▏         | 3/150 [01:24<1:00:06, 24.53s/epoch, loss=1.37, accuracy=0.622, val_loss=4.58, val_accuracy=0.201, lr=0.1]  3%|▎         | 4/150 [01:42<53:03, 21.80s/epoch, loss=1.28, accuracy=0.673, val_loss=1.61, val_accuracy=0.574, lr=0.1]    3%|▎         | 5/150 [02:00<49:53, 20.64s/epoch, loss=1.25, accuracy=0.693, val_loss=1.68, val_accuracy=0.572, lr=0.1]  4%|▍         | 6/150 [02:18<46:55, 19.55s/epoch, loss=1.24, accuracy=0.705, val_loss=2.7, val_accuracy=0.424, lr=0.1]   5%|▍         | 7/150 [02:36<45:26, 19.07s/epoch, loss=1.22, accuracy=0.714, val_loss=1.92, val_accuracy=0.502, lr=0.1]  5%|▌         | 8/150 [02:53<43:48, 18.51s/epoch, loss=1.21, accuracy=0.721, val_loss=2.72, val_accuracy=0.461, lr=0.1]  6%|▌         | 9/150 [03:11<43:16, 18.42s/epoch, loss=1.21, accuracy=0.724, val_loss=1.72, val_accuracy=0.538, lr=0.0316]  7%|▋         | 10/150 [03:29<42:27, 18.20s/epoch, loss=1.2, accuracy=0.73, val_loss=2.37, val_accuracy=0.403, lr=0.1]      7%|▋         | 11/150 [03:46<41:31, 17.93s/epoch, loss=1.19, accuracy=0.731, val_loss=2.53, val_accuracy=0.43, lr=0.1]  8%|▊         | 12/150 [04:04<40:56, 17.80s/epoch, loss=1.19, accuracy=0.734, val_loss=1.33, val_accuracy=0.694, lr=0.1]  9%|▊         | 13/150 [04:21<40:08, 17.58s/epoch, loss=1.19, accuracy=0.739, val_loss=1.73, val_accuracy=0.557, lr=0.1]  9%|▉         | 14/150 [04:38<39:30, 17.43s/epoch, loss=1.19, accuracy=0.736, val_loss=1.4, val_accuracy=0.649, lr=0.1]  10%|█         | 15/150 [04:55<39:13, 17.44s/epoch, loss=1.18, accuracy=0.738, val_loss=1.76, val_accuracy=0.548, lr=0.1] 11%|█         | 16/150 [05:14<40:03, 17.93s/epoch, loss=1.17, accuracy=0.743, val_loss=1.82, val_accuracy=0.539, lr=0.1] 11%|█▏        | 17/150 [05:32<39:27, 17.80s/epoch, loss=1.18, accuracy=0.742, val_loss=1.63, val_accuracy=0.574, lr=0.0316] 12%|█▏        | 18/150 [05:51<40:08, 18.25s/epoch, loss=1.18, accuracy=0.742, val_loss=2.68, val_accuracy=0.338, lr=0.1]    13%|█▎        | 19/150 [06:10<40:18, 18.46s/epoch, loss=1.17, accuracy=0.745, val_loss=1.65, val_accuracy=0.588, lr=0.1] 13%|█▎        | 20/150 [06:28<39:25, 18.19s/epoch, loss=1.17, accuracy=0.745, val_loss=2.44, val_accuracy=0.447, lr=0.1] 14%|█▍        | 21/150 [06:45<38:33, 17.93s/epoch, loss=1.17, accuracy=0.746, val_loss=1.65, val_accuracy=0.592, lr=0.1] 15%|█▍        | 22/150 [07:04<39:06, 18.33s/epoch, loss=1.17, accuracy=0.745, val_loss=1.59, val_accuracy=0.594, lr=0.0316] 15%|█▌        | 23/150 [07:22<38:13, 18.06s/epoch, loss=1.16, accuracy=0.748, val_loss=2.67, val_accuracy=0.402, lr=0.1]    16%|█▌        | 24/150 [07:39<37:24, 17.82s/epoch, loss=1.16, accuracy=0.746, val_loss=1.7, val_accuracy=0.547, lr=0.1]  17%|█▋        | 25/150 [07:56<36:48, 17.67s/epoch, loss=1.16, accuracy=0.748, val_loss=2.58, val_accuracy=0.357, lr=0.1] 17%|█▋        | 26/150 [08:14<36:26, 17.63s/epoch, loss=1.16, accuracy=0.748, val_loss=2.19, val_accuracy=0.513, lr=0.1] 18%|█▊        | 27/150 [08:32<36:17, 17.70s/epoch, loss=1.17, accuracy=0.747, val_loss=3.24, val_accuracy=0.362, lr=0.0316] 19%|█▊        | 28/150 [08:49<35:56, 17.68s/epoch, loss=1.16, accuracy=0.746, val_loss=1.72, val_accuracy=0.59, lr=0.1]     19%|█▉        | 29/150 [09:07<35:28, 17.59s/epoch, loss=1.16, accuracy=0.75, val_loss=2.08, val_accuracy=0.462, lr=0.1] 20%|██        | 30/150 [09:24<35:05, 17.55s/epoch, loss=1.15, accuracy=0.751, val_loss=3.22, val_accuracy=0.372, lr=0.1] 21%|██        | 31/150 [09:42<34:42, 17.50s/epoch, loss=1.15, accuracy=0.753, val_loss=2.43, val_accuracy=0.424, lr=0.1] 21%|██▏       | 32/150 [09:59<34:13, 17.40s/epoch, loss=1.15, accuracy=0.751, val_loss=1.55, val_accuracy=0.613, lr=0.0316] 22%|██▏       | 33/150 [10:16<33:59, 17.43s/epoch, loss=1.16, accuracy=0.749, val_loss=2.21, val_accuracy=0.447, lr=0.1]    23%|██▎       | 34/150 [10:34<33:36, 17.39s/epoch, loss=1.14, accuracy=0.75, val_loss=3.37, val_accuracy=0.336, lr=0.1]  23%|██▎       | 35/150 [10:52<33:54, 17.69s/epoch, loss=1.15, accuracy=0.751, val_loss=1.38, val_accuracy=0.658, lr=0.1] 24%|██▍       | 36/150 [11:11<34:25, 18.12s/epoch, loss=1.14, accuracy=0.754, val_loss=1.76, val_accuracy=0.593, lr=0.1] 25%|██▍       | 37/150 [11:30<34:31, 18.33s/epoch, loss=1.15, accuracy=0.754, val_loss=2.36, val_accuracy=0.489, lr=0.0316] 25%|██▌       | 38/150 [11:48<33:52, 18.14s/epoch, loss=1.15, accuracy=0.754, val_loss=1.59, val_accuracy=0.601, lr=0.1]    26%|██▌       | 39/150 [12:05<33:03, 17.87s/epoch, loss=1.14, accuracy=0.752, val_loss=2.5, val_accuracy=0.337, lr=0.1]  27%|██▋       | 40/150 [12:22<32:28, 17.71s/epoch, loss=1.14, accuracy=0.756, val_loss=1.93, val_accuracy=0.507, lr=0.1] 27%|██▋       | 41/150 [12:40<32:26, 17.85s/epoch, loss=1.15, accuracy=0.751, val_loss=4.12, val_accuracy=0.256, lr=0.1] 28%|██▊       | 42/150 [12:58<31:54, 17.73s/epoch, loss=1.14, accuracy=0.753, val_loss=1.99, val_accuracy=0.543, lr=0.0316] 29%|██▊       | 43/150 [13:15<31:30, 17.67s/epoch, loss=1.14, accuracy=0.755, val_loss=2.67, val_accuracy=0.347, lr=0.1]    29%|██▉       | 44/150 [13:32<30:53, 17.48s/epoch, loss=1.14, accuracy=0.753, val_loss=1.88, val_accuracy=0.58, lr=0.1]  30%|███       | 45/150 [13:50<30:46, 17.59s/epoch, loss=1.13, accuracy=0.756, val_loss=2.75, val_accuracy=0.366, lr=0.1] 31%|███       | 46/150 [14:08<30:28, 17.59s/epoch, loss=1.14, accuracy=0.753, val_loss=1.55, val_accuracy=0.597, lr=0.1] 31%|███▏      | 47/150 [14:25<30:05, 17.53s/epoch, loss=1.14, accuracy=0.752, val_loss=3.63, val_accuracy=0.209, lr=0.0316] 32%|███▏      | 48/150 [14:43<29:46, 17.52s/epoch, loss=1.13, accuracy=0.752, val_loss=1.77, val_accuracy=0.593, lr=0.1]    33%|███▎      | 49/150 [15:01<29:52, 17.75s/epoch, loss=1.13, accuracy=0.755, val_loss=1.93, val_accuracy=0.477, lr=0.1] 33%|███▎      | 50/150 [15:20<30:08, 18.09s/epoch, loss=1.13, accuracy=0.755, val_loss=1.4, val_accuracy=0.663, lr=0.1]  34%|███▍      | 51/150 [15:39<30:10, 18.29s/epoch, loss=1.14, accuracy=0.755, val_loss=3.59, val_accuracy=0.304, lr=0.1] 35%|███▍      | 52/150 [15:56<29:33, 18.10s/epoch, loss=1.13, accuracy=0.756, val_loss=2.33, val_accuracy=0.465, lr=0.0316] 35%|███▌      | 53/150 [16:14<28:57, 17.91s/epoch, loss=1.13, accuracy=0.757, val_loss=2.38, val_accuracy=0.502, lr=0.1]    36%|███▌      | 54/150 [16:31<28:24, 17.76s/epoch, loss=1.14, accuracy=0.755, val_loss=2.64, val_accuracy=0.384, lr=0.1] 37%|███▋      | 55/150 [16:50<28:38, 18.09s/epoch, loss=1.13, accuracy=0.755, val_loss=1.72, val_accuracy=0.575, lr=0.1] 37%|███▋      | 56/150 [17:08<28:21, 18.11s/epoch, loss=1.14, accuracy=0.755, val_loss=2.39, val_accuracy=0.406, lr=0.1] 38%|███▊      | 57/150 [17:25<27:34, 17.79s/epoch, loss=1.12, accuracy=0.759, val_loss=2.06, val_accuracy=0.541, lr=0.0316] 39%|███▊      | 58/150 [17:44<27:47, 18.12s/epoch, loss=1.13, accuracy=0.756, val_loss=2.13, val_accuracy=0.376, lr=0.1]    39%|███▉      | 59/150 [18:02<27:11, 17.93s/epoch, loss=1.13, accuracy=0.754, val_loss=2.34, val_accuracy=0.425, lr=0.1] 40%|████      | 60/150 [18:19<26:50, 17.89s/epoch, loss=1.12, accuracy=0.757, val_loss=1.88, val_accuracy=0.581, lr=0.1] 41%|████      | 61/150 [18:37<26:19, 17.74s/epoch, loss=1.13, accuracy=0.754, val_loss=1.61, val_accuracy=0.629, lr=0.1] 41%|████▏     | 62/150 [18:54<25:59, 17.72s/epoch, loss=1.12, accuracy=0.759, val_loss=2.44, val_accuracy=0.476, lr=0.0316] 42%|████▏     | 63/150 [19:12<25:41, 17.72s/epoch, loss=1.12, accuracy=0.758, val_loss=1.81, val_accuracy=0.57, lr=0.1]     43%|████▎     | 64/150 [19:31<25:50, 18.03s/epoch, loss=1.13, accuracy=0.756, val_loss=2.36, val_accuracy=0.462, lr=0.1] 43%|████▎     | 65/150 [19:48<25:21, 17.90s/epoch, loss=1.13, accuracy=0.754, val_loss=1.52, val_accuracy=0.613, lr=0.1] 44%|████▍     | 66/150 [20:06<24:47, 17.71s/epoch, loss=1.11, accuracy=0.759, val_loss=3.07, val_accuracy=0.372, lr=0.1] 45%|████▍     | 67/150 [20:24<24:53, 17.99s/epoch, loss=1.12, accuracy=0.757, val_loss=3.14, val_accuracy=0.306, lr=0.0316] 45%|████▌     | 68/150 [20:42<24:19, 17.80s/epoch, loss=1.12, accuracy=0.759, val_loss=1.68, val_accuracy=0.561, lr=0.1]    46%|████▌     | 69/150 [20:59<23:53, 17.70s/epoch, loss=1.13, accuracy=0.756, val_loss=2.54, val_accuracy=0.408, lr=0.1] 47%|████▋     | 70/150 [21:17<23:38, 17.73s/epoch, loss=1.13, accuracy=0.753, val_loss=3.53, val_accuracy=0.356, lr=0.1] 47%|████▋     | 71/150 [21:35<23:26, 17.81s/epoch, loss=1.12, accuracy=0.758, val_loss=2.37, val_accuracy=0.399, lr=0.1] 48%|████▊     | 72/150 [21:54<23:33, 18.13s/epoch, loss=1.11, accuracy=0.762, val_loss=1.8, val_accuracy=0.554, lr=0.0316] 49%|████▊     | 73/150 [22:11<22:58, 17.90s/epoch, loss=1.12, accuracy=0.756, val_loss=4.01, val_accuracy=0.293, lr=0.1]   49%|████▉     | 74/150 [22:30<23:09, 18.29s/epoch, loss=1.12, accuracy=0.76, val_loss=1.93, val_accuracy=0.558, lr=0.1]  50%|█████     | 75/150 [22:49<23:01, 18.41s/epoch, loss=1.12, accuracy=0.757, val_loss=2.38, val_accuracy=0.401, lr=0.1] 51%|█████     | 76/150 [23:06<22:13, 18.02s/epoch, loss=1.12, accuracy=0.758, val_loss=2.09, val_accuracy=0.458, lr=0.1] 51%|█████▏    | 77/150 [23:24<21:40, 17.81s/epoch, loss=1.13, accuracy=0.757, val_loss=1.7, val_accuracy=0.57, lr=0.0316] 52%|█████▏    | 78/150 [23:41<21:12, 17.67s/epoch, loss=1.13, accuracy=0.759, val_loss=1.43, val_accuracy=0.649, lr=0.1]  53%|█████▎    | 79/150 [24:00<21:24, 18.09s/epoch, loss=1.12, accuracy=0.757, val_loss=2.01, val_accuracy=0.498, lr=0.1] 53%|█████▎    | 80/150 [24:17<20:50, 17.86s/epoch, loss=1.12, accuracy=0.759, val_loss=2.06, val_accuracy=0.494, lr=0.1] 54%|█████▍    | 81/150 [24:35<20:24, 17.75s/epoch, loss=1.12, accuracy=0.758, val_loss=2.35, val_accuracy=0.504, lr=0.1] 55%|█████▍    | 82/150 [24:53<20:17, 17.91s/epoch, loss=0.918, accuracy=0.815, val_loss=0.932, val_accuracy=0.795, lr=0.01] 55%|█████▌    | 83/150 [25:12<20:28, 18.34s/epoch, loss=0.739, accuracy=0.849, val_loss=0.795, val_accuracy=0.826, lr=0.01] 56%|█████▌    | 84/150 [25:30<19:52, 18.06s/epoch, loss=0.661, accuracy=0.856, val_loss=0.726, val_accuracy=0.827, lr=0.01] 57%|█████▋    | 85/150 [25:47<19:19, 17.85s/epoch, loss=0.609, accuracy=0.862, val_loss=0.7, val_accuracy=0.824, lr=0.01]   57%|█████▋    | 86/150 [26:04<18:48, 17.63s/epoch, loss=0.584, accuracy=0.863, val_loss=0.936, val_accuracy=0.743, lr=0.01] 58%|█████▊    | 87/150 [26:22<18:26, 17.57s/epoch, loss=0.571, accuracy=0.867, val_loss=0.771, val_accuracy=0.789, lr=0.01] 59%|█████▊    | 88/150 [26:39<18:07, 17.54s/epoch, loss=0.565, accuracy=0.864, val_loss=0.654, val_accuracy=0.836, lr=0.01] 59%|█████▉    | 89/150 [26:57<17:48, 17.52s/epoch, loss=0.561, accuracy=0.867, val_loss=0.834, val_accuracy=0.784, lr=0.01] 60%|██████    | 90/150 [27:14<17:29, 17.49s/epoch, loss=0.559, accuracy=0.866, val_loss=0.749, val_accuracy=0.808, lr=0.01] 61%|██████    | 91/150 [27:32<17:14, 17.53s/epoch, loss=0.556, accuracy=0.868, val_loss=1.33, val_accuracy=0.638, lr=0.01]  61%|██████▏   | 92/150 [27:49<16:53, 17.48s/epoch, loss=0.553, accuracy=0.871, val_loss=0.761, val_accuracy=0.793, lr=0.01] 62%|██████▏   | 93/150 [28:08<16:55, 17.82s/epoch, loss=0.552, accuracy=0.87, val_loss=0.753, val_accuracy=0.812, lr=0.00316] 63%|██████▎   | 94/150 [28:25<16:37, 17.80s/epoch, loss=0.55, accuracy=0.872, val_loss=0.818, val_accuracy=0.784, lr=0.01]    63%|██████▎   | 95/150 [28:43<16:19, 17.81s/epoch, loss=0.552, accuracy=0.873, val_loss=0.797, val_accuracy=0.803, lr=0.01] 64%|██████▍   | 96/150 [29:00<15:47, 17.55s/epoch, loss=0.551, accuracy=0.875, val_loss=1.35, val_accuracy=0.675, lr=0.01]  65%|██████▍   | 97/150 [29:17<15:25, 17.46s/epoch, loss=0.55, accuracy=0.877, val_loss=0.7, val_accuracy=0.823, lr=0.01]   65%|██████▌   | 98/150 [29:35<15:02, 17.36s/epoch, loss=0.55, accuracy=0.877, val_loss=0.853, val_accuracy=0.771, lr=0.00316] 66%|██████▌   | 99/150 [29:51<14:36, 17.18s/epoch, loss=0.546, accuracy=0.879, val_loss=0.794, val_accuracy=0.801, lr=0.01]   67%|██████▋   | 100/150 [30:08<14:15, 17.10s/epoch, loss=0.544, accuracy=0.88, val_loss=0.833, val_accuracy=0.782, lr=0.01] 67%|██████▋   | 101/150 [30:27<14:18, 17.52s/epoch, loss=0.552, accuracy=0.878, val_loss=0.841, val_accuracy=0.785, lr=0.01] 68%|██████▊   | 102/150 [30:44<14:02, 17.55s/epoch, loss=0.553, accuracy=0.88, val_loss=0.816, val_accuracy=0.807, lr=0.01]  69%|██████▊   | 103/150 [31:02<13:43, 17.52s/epoch, loss=0.547, accuracy=0.881, val_loss=0.937, val_accuracy=0.757, lr=0.00316] 69%|██████▉   | 104/150 [31:19<13:22, 17.45s/epoch, loss=0.549, accuracy=0.881, val_loss=0.905, val_accuracy=0.776, lr=0.01]    70%|███████   | 105/150 [31:36<13:01, 17.36s/epoch, loss=0.551, accuracy=0.88, val_loss=0.948, val_accuracy=0.767, lr=0.01]  71%|███████   | 106/150 [31:55<13:05, 17.86s/epoch, loss=0.545, accuracy=0.882, val_loss=0.928, val_accuracy=0.768, lr=0.01] 71%|███████▏  | 107/150 [32:12<12:35, 17.58s/epoch, loss=0.545, accuracy=0.884, val_loss=1.12, val_accuracy=0.695, lr=0.01]  72%|███████▏  | 108/150 [32:31<12:28, 17.83s/epoch, loss=0.55, accuracy=0.882, val_loss=0.915, val_accuracy=0.775, lr=0.00316] 73%|███████▎  | 109/150 [32:48<12:01, 17.60s/epoch, loss=0.546, accuracy=0.884, val_loss=0.935, val_accuracy=0.776, lr=0.01]   73%|███████▎  | 110/150 [33:06<11:58, 17.96s/epoch, loss=0.546, accuracy=0.884, val_loss=0.879, val_accuracy=0.789, lr=0.01] 74%|███████▍  | 111/150 [33:23<11:29, 17.68s/epoch, loss=0.551, accuracy=0.882, val_loss=0.72, val_accuracy=0.831, lr=0.01]  75%|███████▍  | 112/150 [33:43<11:27, 18.08s/epoch, loss=0.549, accuracy=0.884, val_loss=0.74, val_accuracy=0.826, lr=0.01] 75%|███████▌  | 113/150 [34:00<11:04, 17.97s/epoch, loss=0.547, accuracy=0.885, val_loss=0.845, val_accuracy=0.794, lr=0.00316] 76%|███████▌  | 114/150 [34:17<10:38, 17.74s/epoch, loss=0.544, accuracy=0.886, val_loss=0.962, val_accuracy=0.767, lr=0.01]    77%|███████▋  | 115/150 [34:36<10:31, 18.04s/epoch, loss=0.551, accuracy=0.882, val_loss=0.838, val_accuracy=0.801, lr=0.01] 77%|███████▋  | 116/150 [34:55<10:19, 18.23s/epoch, loss=0.547, accuracy=0.885, val_loss=1.18, val_accuracy=0.725, lr=0.01]  78%|███████▊  | 117/150 [35:12<09:50, 17.90s/epoch, loss=0.542, accuracy=0.888, val_loss=0.88, val_accuracy=0.773, lr=0.01] 79%|███████▊  | 118/150 [35:29<09:24, 17.65s/epoch, loss=0.543, accuracy=0.888, val_loss=0.9, val_accuracy=0.781, lr=0.00316] 79%|███████▉  | 119/150 [35:47<09:13, 17.87s/epoch, loss=0.548, accuracy=0.887, val_loss=0.93, val_accuracy=0.771, lr=0.01]   80%|████████  | 120/150 [36:06<09:03, 18.13s/epoch, loss=0.548, accuracy=0.886, val_loss=0.753, val_accuracy=0.821, lr=0.01] 81%|████████  | 121/150 [36:23<08:37, 17.85s/epoch, loss=0.55, accuracy=0.887, val_loss=1.14, val_accuracy=0.71, lr=0.01]    81%|████████▏ | 122/150 [36:42<08:28, 18.16s/epoch, loss=0.47, accuracy=0.915, val_loss=0.526, val_accuracy=0.894, lr=0.001] 82%|████████▏ | 123/150 [37:01<08:13, 18.29s/epoch, loss=0.421, accuracy=0.931, val_loss=0.507, val_accuracy=0.899, lr=0.001] 83%|████████▎ | 124/150 [37:19<07:55, 18.28s/epoch, loss=0.397, accuracy=0.936, val_loss=0.502, val_accuracy=0.899, lr=0.001] 83%|████████▎ | 125/150 [37:36<07:27, 17.88s/epoch, loss=0.383, accuracy=0.94, val_loss=0.485, val_accuracy=0.904, lr=0.001]  84%|████████▍ | 126/150 [37:54<07:11, 17.97s/epoch, loss=0.368, accuracy=0.942, val_loss=0.48, val_accuracy=0.904, lr=0.001] 85%|████████▍ | 127/150 [38:12<06:48, 17.78s/epoch, loss=0.356, accuracy=0.945, val_loss=0.493, val_accuracy=0.9, lr=0.001]  85%|████████▌ | 128/150 [38:30<06:37, 18.05s/epoch, loss=0.346, accuracy=0.947, val_loss=0.487, val_accuracy=0.902, lr=0.001] 86%|████████▌ | 129/150 [38:48<06:19, 18.08s/epoch, loss=0.338, accuracy=0.949, val_loss=0.468, val_accuracy=0.905, lr=0.001] 87%|████████▋ | 130/150 [39:05<05:52, 17.65s/epoch, loss=0.327, accuracy=0.95, val_loss=0.48, val_accuracy=0.902, lr=0.001]   87%|████████▋ | 131/150 [39:22<05:33, 17.56s/epoch, loss=0.317, accuracy=0.953, val_loss=0.472, val_accuracy=0.907, lr=0.001] 88%|████████▊ | 132/150 [39:39<05:10, 17.27s/epoch, loss=0.308, accuracy=0.954, val_loss=0.456, val_accuracy=0.906, lr=0.001] 89%|████████▊ | 133/150 [39:57<04:56, 17.46s/epoch, loss=0.303, accuracy=0.955, val_loss=0.471, val_accuracy=0.9, lr=0.001]   89%|████████▉ | 134/150 [40:14<04:38, 17.39s/epoch, loss=0.296, accuracy=0.955, val_loss=0.466, val_accuracy=0.904, lr=0.001] 90%|█████████ | 135/150 [40:33<04:26, 17.78s/epoch, loss=0.289, accuracy=0.957, val_loss=0.461, val_accuracy=0.899, lr=0.001] 91%|█████████ | 136/150 [40:50<04:05, 17.55s/epoch, loss=0.282, accuracy=0.958, val_loss=0.45, val_accuracy=0.905, lr=0.001]  91%|█████████▏| 137/150 [41:07<03:47, 17.48s/epoch, loss=0.275, accuracy=0.959, val_loss=0.438, val_accuracy=0.91, lr=0.001] 92%|█████████▏| 138/150 [41:24<03:26, 17.18s/epoch, loss=0.27, accuracy=0.96, val_loss=0.457, val_accuracy=0.899, lr=0.001]  93%|█████████▎| 139/150 [41:42<03:11, 17.40s/epoch, loss=0.266, accuracy=0.96, val_loss=0.453, val_accuracy=0.901, lr=0.001] 93%|█████████▎| 140/150 [41:58<02:52, 17.23s/epoch, loss=0.262, accuracy=0.961, val_loss=0.473, val_accuracy=0.895, lr=0.001] 94%|█████████▍| 141/150 [42:16<02:35, 17.29s/epoch, loss=0.256, accuracy=0.961, val_loss=0.488, val_accuracy=0.89, lr=0.001]  95%|█████████▍| 142/150 [42:32<02:16, 17.09s/epoch, loss=0.252, accuracy=0.962, val_loss=0.457, val_accuracy=0.901, lr=0.000316] 95%|█████████▌| 143/150 [42:51<02:03, 17.62s/epoch, loss=0.248, accuracy=0.964, val_loss=0.48, val_accuracy=0.895, lr=0.001]     96%|█████████▌| 144/150 [43:09<01:46, 17.74s/epoch, loss=0.242, accuracy=0.965, val_loss=0.472, val_accuracy=0.893, lr=0.001] 97%|█████████▋| 145/150 [43:27<01:29, 17.82s/epoch, loss=0.239, accuracy=0.963, val_loss=0.504, val_accuracy=0.885, lr=0.001] 97%|█████████▋| 146/150 [43:46<01:12, 18.18s/epoch, loss=0.236, accuracy=0.964, val_loss=0.479, val_accuracy=0.893, lr=0.001] 98%|█████████▊| 147/150 [44:05<00:55, 18.39s/epoch, loss=0.233, accuracy=0.964, val_loss=0.449, val_accuracy=0.9, lr=0.000316] 99%|█████████▊| 148/150 [44:22<00:35, 17.90s/epoch, loss=0.23, accuracy=0.965, val_loss=0.481, val_accuracy=0.894, lr=0.001]   99%|█████████▉| 149/150 [44:41<00:18, 18.18s/epoch, loss=0.228, accuracy=0.964, val_loss=0.466, val_accuracy=0.894, lr=0.001]100%|██████████| 150/150 [44:58<00:00, 17.94s/epoch, loss=0.226, accuracy=0.966, val_loss=0.457, val_accuracy=0.897, lr=0.001]100%|██████████| 150/150 [44:58<00:00, 17.99s/epoch, loss=0.226, accuracy=0.966, val_loss=0.457, val_accuracy=0.897, lr=0.001]
Using real-time data augmentation.
Test score: 0.465648353099823
Test accuracy: 0.8981000185012817


* * * Run SGD for ID = 10_9. * * *


2024-02-19 21:49:31.618165: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 21:49:34.043527: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-19 21:49:34.044560: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-19 21:49:34.080372: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-02-19 21:49:34.080404: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 21:49:34.082949: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-19 21:49:34.082994: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-19 21:49:34.085049: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-19 21:49:34.085682: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-19 21:49:34.087999: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-19 21:49:34.089335: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-19 21:49:34.093675: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-19 21:49:34.094192: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-19 21:49:34.094267: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-19 21:49:35.453287: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-19 21:49:35.454385: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-19 21:49:35.455832: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-02-19 21:49:35.455862: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 21:49:35.455904: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-19 21:49:35.455922: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-19 21:49:35.455939: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-19 21:49:35.455962: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-19 21:49:35.455987: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-19 21:49:35.456002: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-19 21:49:35.456018: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-19 21:49:35.456433: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-19 21:49:35.456464: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 21:49:36.050467: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-19 21:49:36.050519: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-19 21:49:36.050527: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-19 21:49:36.051396: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11227 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN X (Pascal), pci bus id: 0000:83:00.0, compute capability: 6.1)
{'id': '10_09', 'batch_size': 128, 'epochs': 150, 'validation_split': 0.1, 'checkpointing': True, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN X (Pascal)'}
x_train shape: (45000, 32, 32, 3)
45000 train samples
5000 validation samples
10000 test samples
y_train shape: (45000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/150 [00:00<?, ?epoch/s]2024-02-19 21:49:36.831560: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-19 21:49:36.843079: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2600020000 Hz
2024-02-19 21:49:38.660092: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-19 21:49:38.842365: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-19 21:49:39.474460: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-19 21:49:39.517158: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/150 [00:44<1:49:33, 44.11s/epoch, loss=3.31, accuracy=0.277, val_loss=2.22, val_accuracy=0.3, lr=0.1]  1%|▏         | 2/150 [01:00<1:08:47, 27.89s/epoch, loss=1.65, accuracy=0.493, val_loss=2.1, val_accuracy=0.418, lr=0.1]  2%|▏         | 3/150 [01:17<55:32, 22.67s/epoch, loss=1.38, accuracy=0.62, val_loss=3.83, val_accuracy=0.301, lr=0.1]    3%|▎         | 4/150 [01:33<49:31, 20.35s/epoch, loss=1.28, accuracy=0.675, val_loss=1.49, val_accuracy=0.598, lr=0.1]  3%|▎         | 5/150 [01:50<45:37, 18.88s/epoch, loss=1.25, accuracy=0.701, val_loss=1.92, val_accuracy=0.493, lr=0.1]  4%|▍         | 6/150 [02:07<44:00, 18.34s/epoch, loss=1.23, accuracy=0.707, val_loss=2.03, val_accuracy=0.421, lr=0.1]  5%|▍         | 7/150 [02:24<42:21, 17.77s/epoch, loss=1.22, accuracy=0.715, val_loss=1.62, val_accuracy=0.565, lr=0.1]  5%|▌         | 8/150 [02:40<41:13, 17.42s/epoch, loss=1.2, accuracy=0.72, val_loss=1.76, val_accuracy=0.558, lr=0.1]    6%|▌         | 9/150 [02:57<40:25, 17.20s/epoch, loss=1.2, accuracy=0.727, val_loss=1.83, val_accuracy=0.529, lr=0.0316]  7%|▋         | 10/150 [03:14<40:06, 17.19s/epoch, loss=1.19, accuracy=0.731, val_loss=2.36, val_accuracy=0.443, lr=0.1]   7%|▋         | 11/150 [03:31<39:30, 17.06s/epoch, loss=1.18, accuracy=0.735, val_loss=1.96, val_accuracy=0.469, lr=0.1]  8%|▊         | 12/150 [03:48<39:24, 17.13s/epoch, loss=1.17, accuracy=0.738, val_loss=1.99, val_accuracy=0.452, lr=0.1]  9%|▊         | 13/150 [04:05<38:55, 17.05s/epoch, loss=1.17, accuracy=0.74, val_loss=3.65, val_accuracy=0.245, lr=0.1]   9%|▉         | 14/150 [04:22<38:24, 16.94s/epoch, loss=1.17, accuracy=0.739, val_loss=1.91, val_accuracy=0.497, lr=0.0316] 10%|█         | 15/150 [04:41<39:21, 17.49s/epoch, loss=1.17, accuracy=0.741, val_loss=1.94, val_accuracy=0.497, lr=0.1]    11%|█         | 16/150 [04:57<38:37, 17.30s/epoch, loss=1.17, accuracy=0.74, val_loss=2.05, val_accuracy=0.415, lr=0.1]  11%|█▏        | 17/150 [05:15<38:44, 17.48s/epoch, loss=1.16, accuracy=0.743, val_loss=2.35, val_accuracy=0.466, lr=0.1] 12%|█▏        | 18/150 [05:34<39:07, 17.78s/epoch, loss=1.16, accuracy=0.746, val_loss=2.22, val_accuracy=0.527, lr=0.1] 13%|█▎        | 19/150 [05:51<38:21, 17.57s/epoch, loss=1.15, accuracy=0.746, val_loss=2.09, val_accuracy=0.408, lr=0.0316] 13%|█▎        | 20/150 [06:08<37:37, 17.36s/epoch, loss=1.15, accuracy=0.749, val_loss=2.34, val_accuracy=0.4, lr=0.1]      14%|█▍        | 21/150 [06:24<36:55, 17.17s/epoch, loss=1.15, accuracy=0.747, val_loss=1.79, val_accuracy=0.564, lr=0.1] 15%|█▍        | 22/150 [06:43<37:30, 17.58s/epoch, loss=1.14, accuracy=0.752, val_loss=3.24, val_accuracy=0.406, lr=0.1] 15%|█▌        | 23/150 [07:00<36:41, 17.33s/epoch, loss=1.14, accuracy=0.748, val_loss=3.11, val_accuracy=0.357, lr=0.1] 16%|█▌        | 24/150 [07:17<36:38, 17.45s/epoch, loss=1.14, accuracy=0.753, val_loss=1.51, val_accuracy=0.621, lr=0.0316] 17%|█▋        | 25/150 [07:34<35:53, 17.23s/epoch, loss=1.15, accuracy=0.75, val_loss=1.8, val_accuracy=0.518, lr=0.1]      17%|█▋        | 26/150 [07:51<35:24, 17.14s/epoch, loss=1.14, accuracy=0.749, val_loss=1.53, val_accuracy=0.629, lr=0.1] 18%|█▊        | 27/150 [08:08<34:55, 17.03s/epoch, loss=1.14, accuracy=0.75, val_loss=2.31, val_accuracy=0.464, lr=0.1]  19%|█▊        | 28/150 [08:25<34:41, 17.06s/epoch, loss=1.14, accuracy=0.75, val_loss=1.43, val_accuracy=0.651, lr=0.1] 19%|█▉        | 29/150 [08:43<34:56, 17.33s/epoch, loss=1.14, accuracy=0.752, val_loss=1.82, val_accuracy=0.526, lr=0.1] 20%|██        | 30/150 [09:00<34:39, 17.33s/epoch, loss=1.14, accuracy=0.753, val_loss=1.87, val_accuracy=0.566, lr=0.1] 21%|██        | 31/150 [09:18<34:45, 17.53s/epoch, loss=1.13, accuracy=0.755, val_loss=2.13, val_accuracy=0.407, lr=0.1] 21%|██▏       | 32/150 [09:37<34:58, 17.78s/epoch, loss=1.14, accuracy=0.753, val_loss=2.5, val_accuracy=0.439, lr=0.1]  22%|██▏       | 33/150 [09:54<34:22, 17.63s/epoch, loss=1.14, accuracy=0.752, val_loss=1.45, val_accuracy=0.632, lr=0.0316] 23%|██▎       | 34/150 [10:11<33:40, 17.42s/epoch, loss=1.13, accuracy=0.754, val_loss=1.64, val_accuracy=0.609, lr=0.1]    23%|██▎       | 35/150 [10:29<34:02, 17.76s/epoch, loss=1.13, accuracy=0.755, val_loss=2.5, val_accuracy=0.408, lr=0.1]  24%|██▍       | 36/150 [10:48<34:06, 17.95s/epoch, loss=1.13, accuracy=0.753, val_loss=2.52, val_accuracy=0.412, lr=0.1] 25%|██▍       | 37/150 [11:04<33:04, 17.57s/epoch, loss=1.13, accuracy=0.756, val_loss=1.95, val_accuracy=0.465, lr=0.1] 25%|██▌       | 38/150 [11:21<32:29, 17.41s/epoch, loss=1.13, accuracy=0.753, val_loss=2.32, val_accuracy=0.483, lr=0.0316] 26%|██▌       | 39/150 [11:39<32:17, 17.46s/epoch, loss=1.13, accuracy=0.755, val_loss=3.08, val_accuracy=0.366, lr=0.1]    27%|██▋       | 40/150 [11:56<31:38, 17.26s/epoch, loss=1.13, accuracy=0.755, val_loss=1.87, val_accuracy=0.496, lr=0.1] 27%|██▋       | 41/150 [12:13<31:28, 17.32s/epoch, loss=1.12, accuracy=0.755, val_loss=1.75, val_accuracy=0.549, lr=0.1] 28%|██▊       | 42/150 [12:32<31:51, 17.70s/epoch, loss=1.13, accuracy=0.756, val_loss=1.9, val_accuracy=0.493, lr=0.1]  29%|██▊       | 43/150 [12:49<30:59, 17.38s/epoch, loss=1.12, accuracy=0.757, val_loss=1.88, val_accuracy=0.532, lr=0.0316] 29%|██▉       | 44/150 [13:06<30:33, 17.30s/epoch, loss=1.13, accuracy=0.753, val_loss=2.53, val_accuracy=0.437, lr=0.1]    30%|███       | 45/150 [13:24<30:42, 17.55s/epoch, loss=1.13, accuracy=0.756, val_loss=2.24, val_accuracy=0.462, lr=0.1] 31%|███       | 46/150 [13:42<30:39, 17.69s/epoch, loss=1.12, accuracy=0.757, val_loss=1.93, val_accuracy=0.489, lr=0.1] 31%|███▏      | 47/150 [14:00<30:45, 17.92s/epoch, loss=1.13, accuracy=0.756, val_loss=1.61, val_accuracy=0.585, lr=0.1] 32%|███▏      | 48/150 [14:19<30:38, 18.02s/epoch, loss=1.13, accuracy=0.757, val_loss=1.6, val_accuracy=0.588, lr=0.0316] 33%|███▎      | 49/150 [14:37<30:31, 18.13s/epoch, loss=1.12, accuracy=0.755, val_loss=2.83, val_accuracy=0.378, lr=0.1]   33%|███▎      | 50/150 [14:55<30:02, 18.02s/epoch, loss=1.12, accuracy=0.756, val_loss=1.77, val_accuracy=0.578, lr=0.1] 34%|███▍      | 51/150 [15:12<29:15, 17.74s/epoch, loss=1.12, accuracy=0.755, val_loss=1.65, val_accuracy=0.586, lr=0.1] 35%|███▍      | 52/150 [15:30<29:20, 17.97s/epoch, loss=1.12, accuracy=0.757, val_loss=1.76, val_accuracy=0.599, lr=0.1] 35%|███▌      | 53/150 [15:49<29:15, 18.10s/epoch, loss=1.12, accuracy=0.756, val_loss=2.6, val_accuracy=0.428, lr=0.0316] 36%|███▌      | 54/150 [16:05<28:15, 17.66s/epoch, loss=1.12, accuracy=0.756, val_loss=1.63, val_accuracy=0.584, lr=0.1]   37%|███▋      | 55/150 [16:22<27:27, 17.34s/epoch, loss=1.12, accuracy=0.756, val_loss=1.76, val_accuracy=0.538, lr=0.1] 37%|███▋      | 56/150 [16:40<27:29, 17.55s/epoch, loss=1.12, accuracy=0.756, val_loss=1.46, val_accuracy=0.637, lr=0.1] 38%|███▊      | 57/150 [16:58<27:23, 17.68s/epoch, loss=1.12, accuracy=0.76, val_loss=1.63, val_accuracy=0.582, lr=0.1]  39%|███▊      | 58/150 [17:16<27:15, 17.78s/epoch, loss=1.12, accuracy=0.757, val_loss=1.94, val_accuracy=0.485, lr=0.0316] 39%|███▉      | 59/150 [17:34<27:12, 17.94s/epoch, loss=1.12, accuracy=0.758, val_loss=2.69, val_accuracy=0.284, lr=0.1]    40%|████      | 60/150 [17:52<26:37, 17.74s/epoch, loss=1.12, accuracy=0.757, val_loss=3.94, val_accuracy=0.25, lr=0.1]  41%|████      | 61/150 [18:08<25:53, 17.45s/epoch, loss=1.11, accuracy=0.758, val_loss=1.83, val_accuracy=0.564, lr=0.1] 41%|████▏     | 62/150 [18:25<25:27, 17.36s/epoch, loss=1.11, accuracy=0.758, val_loss=2.13, val_accuracy=0.431, lr=0.1] 42%|████▏     | 63/150 [18:42<24:53, 17.17s/epoch, loss=1.12, accuracy=0.757, val_loss=3.05, val_accuracy=0.383, lr=0.0316] 43%|████▎     | 64/150 [18:59<24:40, 17.21s/epoch, loss=1.11, accuracy=0.758, val_loss=3.14, val_accuracy=0.348, lr=0.1]    43%|████▎     | 65/150 [19:16<24:13, 17.10s/epoch, loss=1.11, accuracy=0.758, val_loss=2.67, val_accuracy=0.386, lr=0.1] 44%|████▍     | 66/150 [19:34<24:03, 17.18s/epoch, loss=1.11, accuracy=0.758, val_loss=2.89, val_accuracy=0.341, lr=0.1] 45%|████▍     | 67/150 [19:50<23:36, 17.06s/epoch, loss=1.12, accuracy=0.759, val_loss=1.92, val_accuracy=0.484, lr=0.1] 45%|████▌     | 68/150 [20:08<23:23, 17.12s/epoch, loss=1.12, accuracy=0.756, val_loss=2.59, val_accuracy=0.355, lr=0.0316] 46%|████▌     | 69/150 [20:26<23:42, 17.57s/epoch, loss=1.11, accuracy=0.76, val_loss=1.97, val_accuracy=0.477, lr=0.1]     47%|████▋     | 70/150 [20:43<23:01, 17.27s/epoch, loss=1.11, accuracy=0.756, val_loss=2.48, val_accuracy=0.448, lr=0.1] 47%|████▋     | 71/150 [21:01<23:03, 17.51s/epoch, loss=1.11, accuracy=0.759, val_loss=1.97, val_accuracy=0.517, lr=0.1] 48%|████▊     | 72/150 [21:18<22:38, 17.41s/epoch, loss=1.11, accuracy=0.756, val_loss=1.79, val_accuracy=0.537, lr=0.1] 49%|████▊     | 73/150 [21:35<22:02, 17.18s/epoch, loss=1.1, accuracy=0.76, val_loss=1.77, val_accuracy=0.524, lr=0.0316] 49%|████▉     | 74/150 [21:52<21:53, 17.28s/epoch, loss=1.12, accuracy=0.756, val_loss=1.97, val_accuracy=0.486, lr=0.1]  50%|█████     | 75/150 [22:11<21:58, 17.58s/epoch, loss=1.11, accuracy=0.758, val_loss=1.6, val_accuracy=0.583, lr=0.1]  51%|█████     | 76/150 [22:28<21:48, 17.69s/epoch, loss=1.11, accuracy=0.758, val_loss=1.52, val_accuracy=0.598, lr=0.1] 51%|█████▏    | 77/150 [22:46<21:24, 17.59s/epoch, loss=1.11, accuracy=0.757, val_loss=1.64, val_accuracy=0.598, lr=0.1] 52%|█████▏    | 78/150 [23:03<20:51, 17.38s/epoch, loss=1.11, accuracy=0.757, val_loss=2.25, val_accuracy=0.44, lr=0.0316] 53%|█████▎    | 79/150 [23:21<20:46, 17.56s/epoch, loss=1.11, accuracy=0.757, val_loss=2.97, val_accuracy=0.456, lr=0.1]   53%|█████▎    | 80/150 [23:38<20:33, 17.62s/epoch, loss=1.11, accuracy=0.759, val_loss=2.56, val_accuracy=0.382, lr=0.1] 54%|█████▍    | 81/150 [23:56<20:04, 17.46s/epoch, loss=1.11, accuracy=0.756, val_loss=1.72, val_accuracy=0.581, lr=0.1] 55%|█████▍    | 82/150 [24:13<19:50, 17.51s/epoch, loss=0.919, accuracy=0.812, val_loss=0.951, val_accuracy=0.786, lr=0.01] 55%|█████▌    | 83/150 [24:32<20:00, 17.92s/epoch, loss=0.74, accuracy=0.847, val_loss=0.817, val_accuracy=0.809, lr=0.01]  56%|█████▌    | 84/150 [24:50<19:36, 17.83s/epoch, loss=0.661, accuracy=0.856, val_loss=0.888, val_accuracy=0.773, lr=0.01] 57%|█████▋    | 85/150 [25:08<19:36, 18.10s/epoch, loss=0.614, accuracy=0.861, val_loss=0.738, val_accuracy=0.811, lr=0.01] 57%|█████▋    | 86/150 [25:27<19:32, 18.32s/epoch, loss=0.589, accuracy=0.861, val_loss=0.708, val_accuracy=0.818, lr=0.01] 58%|█████▊    | 87/150 [25:44<18:48, 17.91s/epoch, loss=0.574, accuracy=0.863, val_loss=1.82, val_accuracy=0.597, lr=0.01]  59%|█████▊    | 88/150 [26:01<18:08, 17.55s/epoch, loss=0.565, accuracy=0.865, val_loss=0.842, val_accuracy=0.781, lr=0.01] 59%|█████▉    | 89/150 [26:19<17:55, 17.63s/epoch, loss=0.56, accuracy=0.865, val_loss=0.703, val_accuracy=0.815, lr=0.01]  60%|██████    | 90/150 [26:37<17:48, 17.80s/epoch, loss=0.562, accuracy=0.865, val_loss=0.844, val_accuracy=0.771, lr=0.01] 61%|██████    | 91/150 [26:55<17:26, 17.73s/epoch, loss=0.555, accuracy=0.867, val_loss=0.811, val_accuracy=0.789, lr=0.01] 61%|██████▏   | 92/150 [27:11<16:51, 17.43s/epoch, loss=0.554, accuracy=0.869, val_loss=0.811, val_accuracy=0.793, lr=0.01] 62%|██████▏   | 93/150 [27:30<16:50, 17.73s/epoch, loss=0.551, accuracy=0.872, val_loss=0.781, val_accuracy=0.795, lr=0.01] 63%|██████▎   | 94/150 [27:47<16:28, 17.65s/epoch, loss=0.555, accuracy=0.871, val_loss=0.722, val_accuracy=0.825, lr=0.00316] 63%|██████▎   | 95/150 [28:04<15:51, 17.31s/epoch, loss=0.555, accuracy=0.873, val_loss=0.72, val_accuracy=0.823, lr=0.01]     64%|██████▍   | 96/150 [28:21<15:30, 17.22s/epoch, loss=0.554, accuracy=0.872, val_loss=0.918, val_accuracy=0.764, lr=0.01] 65%|██████▍   | 97/150 [28:37<15:05, 17.08s/epoch, loss=0.556, accuracy=0.873, val_loss=0.762, val_accuracy=0.804, lr=0.01] 65%|██████▌   | 98/150 [28:54<14:40, 16.93s/epoch, loss=0.551, accuracy=0.875, val_loss=0.817, val_accuracy=0.794, lr=0.01] 66%|██████▌   | 99/150 [29:11<14:19, 16.86s/epoch, loss=0.546, accuracy=0.876, val_loss=0.762, val_accuracy=0.817, lr=0.00316] 67%|██████▋   | 100/150 [29:28<14:16, 17.13s/epoch, loss=0.551, accuracy=0.876, val_loss=0.782, val_accuracy=0.803, lr=0.01]   67%|██████▋   | 101/150 [29:45<13:52, 17.00s/epoch, loss=0.555, accuracy=0.875, val_loss=1, val_accuracy=0.726, lr=0.01]     68%|██████▊   | 102/150 [30:02<13:31, 16.90s/epoch, loss=0.551, accuracy=0.875, val_loss=0.803, val_accuracy=0.801, lr=0.01] 69%|██████▊   | 103/150 [30:18<13:07, 16.75s/epoch, loss=0.55, accuracy=0.876, val_loss=0.858, val_accuracy=0.793, lr=0.01]  69%|██████▉   | 104/150 [30:39<13:52, 18.10s/epoch, loss=0.551, accuracy=0.878, val_loss=0.689, val_accuracy=0.834, lr=0.01] 70%|███████   | 105/150 [30:56<13:15, 17.69s/epoch, loss=0.549, accuracy=0.879, val_loss=0.791, val_accuracy=0.798, lr=0.01] 71%|███████   | 106/150 [31:14<13:01, 17.77s/epoch, loss=0.551, accuracy=0.879, val_loss=1.06, val_accuracy=0.757, lr=0.01]  71%|███████▏  | 107/150 [31:32<12:45, 17.81s/epoch, loss=0.558, accuracy=0.875, val_loss=0.883, val_accuracy=0.797, lr=0.01] 72%|███████▏  | 108/150 [31:49<12:12, 17.44s/epoch, loss=0.552, accuracy=0.879, val_loss=0.823, val_accuracy=0.795, lr=0.01] 73%|███████▎  | 109/150 [32:07<12:04, 17.67s/epoch, loss=0.555, accuracy=0.878, val_loss=0.867, val_accuracy=0.77, lr=0.00316] 73%|███████▎  | 110/150 [32:25<11:56, 17.92s/epoch, loss=0.548, accuracy=0.882, val_loss=0.9, val_accuracy=0.764, lr=0.01]     74%|███████▍  | 111/150 [32:42<11:25, 17.57s/epoch, loss=0.545, accuracy=0.883, val_loss=0.935, val_accuracy=0.77, lr=0.01] 75%|███████▍  | 112/150 [33:00<11:06, 17.53s/epoch, loss=0.552, accuracy=0.881, val_loss=0.898, val_accuracy=0.775, lr=0.01] 75%|███████▌  | 113/150 [33:16<10:39, 17.28s/epoch, loss=0.549, accuracy=0.882, val_loss=0.803, val_accuracy=0.801, lr=0.01] 76%|███████▌  | 114/150 [33:33<10:16, 17.14s/epoch, loss=0.55, accuracy=0.881, val_loss=0.846, val_accuracy=0.792, lr=0.00316] 77%|███████▋  | 115/150 [33:50<09:56, 17.05s/epoch, loss=0.55, accuracy=0.881, val_loss=1.63, val_accuracy=0.598, lr=0.01]     77%|███████▋  | 116/150 [34:06<09:32, 16.83s/epoch, loss=0.549, accuracy=0.882, val_loss=0.972, val_accuracy=0.747, lr=0.01] 78%|███████▊  | 117/150 [34:23<09:12, 16.73s/epoch, loss=0.55, accuracy=0.882, val_loss=0.829, val_accuracy=0.801, lr=0.01]  79%|███████▊  | 118/150 [34:39<08:53, 16.67s/epoch, loss=0.548, accuracy=0.883, val_loss=1.04, val_accuracy=0.736, lr=0.01] 79%|███████▉  | 119/150 [34:57<08:44, 16.92s/epoch, loss=0.547, accuracy=0.884, val_loss=0.891, val_accuracy=0.777, lr=0.00316] 80%|████████  | 120/150 [35:14<08:27, 16.92s/epoch, loss=0.544, accuracy=0.887, val_loss=0.807, val_accuracy=0.798, lr=0.01]    81%|████████  | 121/150 [35:32<08:22, 17.32s/epoch, loss=0.544, accuracy=0.884, val_loss=1.16, val_accuracy=0.72, lr=0.01]   81%|████████▏ | 122/150 [35:49<08:04, 17.29s/epoch, loss=0.471, accuracy=0.911, val_loss=0.536, val_accuracy=0.888, lr=0.001] 82%|████████▏ | 123/150 [36:06<07:42, 17.13s/epoch, loss=0.417, accuracy=0.929, val_loss=0.517, val_accuracy=0.898, lr=0.001] 83%|████████▎ | 124/150 [36:23<07:25, 17.14s/epoch, loss=0.397, accuracy=0.935, val_loss=0.507, val_accuracy=0.897, lr=0.001] 83%|████████▎ | 125/150 [36:40<07:08, 17.12s/epoch, loss=0.38, accuracy=0.938, val_loss=0.504, val_accuracy=0.896, lr=0.001]  84%|████████▍ | 126/150 [36:57<06:49, 17.05s/epoch, loss=0.367, accuracy=0.94, val_loss=0.495, val_accuracy=0.9, lr=0.001]   85%|████████▍ | 127/150 [37:14<06:30, 16.98s/epoch, loss=0.355, accuracy=0.943, val_loss=0.497, val_accuracy=0.9, lr=0.001] 85%|████████▌ | 128/150 [37:32<06:18, 17.22s/epoch, loss=0.345, accuracy=0.946, val_loss=0.503, val_accuracy=0.896, lr=0.001] 86%|████████▌ | 129/150 [37:48<05:56, 16.99s/epoch, loss=0.334, accuracy=0.947, val_loss=0.502, val_accuracy=0.894, lr=0.001] 87%|████████▋ | 130/150 [38:05<05:42, 17.10s/epoch, loss=0.325, accuracy=0.948, val_loss=0.491, val_accuracy=0.9, lr=0.001]   87%|████████▋ | 131/150 [38:22<05:22, 16.99s/epoch, loss=0.318, accuracy=0.95, val_loss=0.49, val_accuracy=0.893, lr=0.001] 88%|████████▊ | 132/150 [38:40<05:10, 17.28s/epoch, loss=0.31, accuracy=0.952, val_loss=0.492, val_accuracy=0.897, lr=0.001] 89%|████████▊ | 133/150 [38:57<04:50, 17.07s/epoch, loss=0.303, accuracy=0.952, val_loss=0.49, val_accuracy=0.893, lr=0.001] 89%|████████▉ | 134/150 [39:14<04:32, 17.02s/epoch, loss=0.296, accuracy=0.953, val_loss=0.518, val_accuracy=0.89, lr=0.001] 90%|█████████ | 135/150 [39:30<04:12, 16.85s/epoch, loss=0.29, accuracy=0.954, val_loss=0.497, val_accuracy=0.898, lr=0.001] 91%|█████████ | 136/150 [39:48<03:59, 17.08s/epoch, loss=0.283, accuracy=0.956, val_loss=0.495, val_accuracy=0.9, lr=0.000316] 91%|█████████▏| 137/150 [40:04<03:39, 16.88s/epoch, loss=0.277, accuracy=0.956, val_loss=0.487, val_accuracy=0.896, lr=0.001]  92%|█████████▏| 138/150 [40:21<03:22, 16.87s/epoch, loss=0.274, accuracy=0.956, val_loss=0.507, val_accuracy=0.893, lr=0.001] 93%|█████████▎| 139/150 [40:38<03:05, 16.84s/epoch, loss=0.267, accuracy=0.959, val_loss=0.487, val_accuracy=0.896, lr=0.001] 93%|█████████▎| 140/150 [40:55<02:49, 16.95s/epoch, loss=0.263, accuracy=0.958, val_loss=0.492, val_accuracy=0.896, lr=0.001] 94%|█████████▍| 141/150 [41:12<02:31, 16.84s/epoch, loss=0.257, accuracy=0.96, val_loss=0.49, val_accuracy=0.892, lr=0.001]   95%|█████████▍| 142/150 [41:28<02:13, 16.74s/epoch, loss=0.251, accuracy=0.961, val_loss=0.487, val_accuracy=0.892, lr=0.000316] 95%|█████████▌| 143/150 [41:45<01:56, 16.69s/epoch, loss=0.252, accuracy=0.959, val_loss=0.546, val_accuracy=0.883, lr=0.001]    96%|█████████▌| 144/150 [42:03<01:43, 17.24s/epoch, loss=0.245, accuracy=0.962, val_loss=0.495, val_accuracy=0.895, lr=0.001] 97%|█████████▋| 145/150 [42:20<01:25, 17.05s/epoch, loss=0.244, accuracy=0.959, val_loss=0.509, val_accuracy=0.889, lr=0.001] 97%|█████████▋| 146/150 [42:37<01:09, 17.26s/epoch, loss=0.239, accuracy=0.961, val_loss=0.531, val_accuracy=0.883, lr=0.001] 98%|█████████▊| 147/150 [42:55<00:52, 17.39s/epoch, loss=0.237, accuracy=0.962, val_loss=0.49, val_accuracy=0.889, lr=0.000316] 99%|█████████▊| 148/150 [43:12<00:34, 17.13s/epoch, loss=0.235, accuracy=0.962, val_loss=0.514, val_accuracy=0.888, lr=0.001]   99%|█████████▉| 149/150 [43:29<00:17, 17.24s/epoch, loss=0.229, accuracy=0.964, val_loss=0.477, val_accuracy=0.896, lr=0.001]100%|██████████| 150/150 [43:46<00:00, 17.20s/epoch, loss=0.228, accuracy=0.963, val_loss=0.514, val_accuracy=0.89, lr=0.001] 100%|██████████| 150/150 [43:46<00:00, 17.51s/epoch, loss=0.228, accuracy=0.963, val_loss=0.514, val_accuracy=0.89, lr=0.001]
Using real-time data augmentation.
Test score: 0.4850541651248932
Test accuracy: 0.9014999866485596


* * * Run SGD for ID = 10_10. * * *


2024-02-19 22:33:32.139579: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 22:33:42.617479: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-19 22:33:42.618487: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-19 22:33:42.655308: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-02-19 22:33:42.655349: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 22:33:42.667261: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-19 22:33:42.667299: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-19 22:33:42.672766: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-19 22:33:42.675575: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-19 22:33:42.678938: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-19 22:33:42.682896: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-19 22:33:42.688913: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-19 22:33:42.689482: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-19 22:33:42.689553: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-19 22:33:44.113597: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-19 22:33:44.114637: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-19 22:33:44.115345: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-02-19 22:33:44.115377: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 22:33:44.115412: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-19 22:33:44.115428: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-19 22:33:44.115444: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-19 22:33:44.115460: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-19 22:33:44.115475: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-19 22:33:44.115489: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-19 22:33:44.115504: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-19 22:33:44.115912: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-19 22:33:44.115943: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 22:33:44.719598: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-19 22:33:44.719648: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-19 22:33:44.719656: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-19 22:33:44.720526: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11227 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN X (Pascal), pci bus id: 0000:83:00.0, compute capability: 6.1)
{'id': '10_10', 'batch_size': 128, 'epochs': 150, 'validation_split': 0.1, 'checkpointing': True, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN X (Pascal)'}
x_train shape: (45000, 32, 32, 3)
45000 train samples
5000 validation samples
10000 test samples
y_train shape: (45000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/150 [00:00<?, ?epoch/s]2024-02-19 22:33:45.502891: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-19 22:33:45.515080: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2600020000 Hz
2024-02-19 22:33:47.358221: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-19 22:33:47.527620: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-19 22:33:48.192499: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-19 22:33:48.230785: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/150 [00:50<2:04:58, 50.33s/epoch, loss=3.35, accuracy=0.288, val_loss=2.75, val_accuracy=0.198, lr=0.1]  1%|▏         | 2/150 [01:09<1:18:12, 31.71s/epoch, loss=1.64, accuracy=0.506, val_loss=1.87, val_accuracy=0.456, lr=0.1]  2%|▏         | 3/150 [01:27<1:02:44, 25.61s/epoch, loss=1.41, accuracy=0.615, val_loss=1.78, val_accuracy=0.484, lr=0.1]  3%|▎         | 4/150 [01:44<53:51, 22.13s/epoch, loss=1.32, accuracy=0.662, val_loss=2.06, val_accuracy=0.436, lr=0.1]    3%|▎         | 5/150 [02:01<49:33, 20.51s/epoch, loss=1.28, accuracy=0.689, val_loss=1.68, val_accuracy=0.547, lr=0.1]  4%|▍         | 6/150 [02:19<46:37, 19.43s/epoch, loss=1.25, accuracy=0.703, val_loss=1.77, val_accuracy=0.533, lr=0.1]  5%|▍         | 7/150 [02:36<44:47, 18.80s/epoch, loss=1.23, accuracy=0.713, val_loss=1.73, val_accuracy=0.567, lr=0.1]  5%|▌         | 8/150 [02:53<42:59, 18.16s/epoch, loss=1.23, accuracy=0.713, val_loss=1.93, val_accuracy=0.515, lr=0.1]  6%|▌         | 9/150 [03:10<41:45, 17.77s/epoch, loss=1.21, accuracy=0.722, val_loss=1.71, val_accuracy=0.575, lr=0.1]  7%|▋         | 10/150 [03:26<40:32, 17.37s/epoch, loss=1.21, accuracy=0.722, val_loss=2.75, val_accuracy=0.355, lr=0.0316]  7%|▋         | 11/150 [03:43<39:52, 17.21s/epoch, loss=1.2, accuracy=0.729, val_loss=2.28, val_accuracy=0.47, lr=0.1]       8%|▊         | 12/150 [04:00<39:19, 17.10s/epoch, loss=1.19, accuracy=0.732, val_loss=2.64, val_accuracy=0.326, lr=0.1]  9%|▊         | 13/150 [04:17<39:00, 17.08s/epoch, loss=1.2, accuracy=0.73, val_loss=2.29, val_accuracy=0.491, lr=0.1]    9%|▉         | 14/150 [04:36<39:42, 17.52s/epoch, loss=1.18, accuracy=0.734, val_loss=1.87, val_accuracy=0.534, lr=0.1] 10%|█         | 15/150 [04:53<39:06, 17.38s/epoch, loss=1.18, accuracy=0.737, val_loss=1.71, val_accuracy=0.54, lr=0.0316] 11%|█         | 16/150 [05:11<39:37, 17.75s/epoch, loss=1.18, accuracy=0.737, val_loss=1.89, val_accuracy=0.532, lr=0.1]   11%|█▏        | 17/150 [05:30<40:09, 18.11s/epoch, loss=1.17, accuracy=0.743, val_loss=1.57, val_accuracy=0.622, lr=0.1] 12%|█▏        | 18/150 [05:48<39:35, 17.99s/epoch, loss=1.18, accuracy=0.74, val_loss=1.82, val_accuracy=0.505, lr=0.1]  13%|█▎        | 19/150 [06:07<39:46, 18.21s/epoch, loss=1.17, accuracy=0.744, val_loss=1.65, val_accuracy=0.58, lr=0.1] 13%|█▎        | 20/150 [06:24<38:39, 17.84s/epoch, loss=1.17, accuracy=0.744, val_loss=2.28, val_accuracy=0.472, lr=0.1] 14%|█▍        | 21/150 [06:42<38:31, 17.92s/epoch, loss=1.17, accuracy=0.74, val_loss=2.42, val_accuracy=0.399, lr=0.1]  15%|█▍        | 22/150 [06:59<37:58, 17.80s/epoch, loss=1.17, accuracy=0.743, val_loss=2.37, val_accuracy=0.461, lr=0.0316] 15%|█▌        | 23/150 [07:16<37:13, 17.59s/epoch, loss=1.17, accuracy=0.742, val_loss=1.53, val_accuracy=0.584, lr=0.1]    16%|█▌        | 24/150 [07:35<37:26, 17.83s/epoch, loss=1.16, accuracy=0.746, val_loss=2.19, val_accuracy=0.486, lr=0.1] 17%|█▋        | 25/150 [07:53<37:38, 18.07s/epoch, loss=1.17, accuracy=0.742, val_loss=1.46, val_accuracy=0.651, lr=0.1] 17%|█▋        | 26/150 [08:12<37:41, 18.23s/epoch, loss=1.16, accuracy=0.746, val_loss=2.05, val_accuracy=0.522, lr=0.1] 18%|█▊        | 27/150 [08:29<36:31, 17.82s/epoch, loss=1.16, accuracy=0.746, val_loss=1.7, val_accuracy=0.576, lr=0.1]  19%|█▊        | 28/150 [08:47<36:24, 17.91s/epoch, loss=1.16, accuracy=0.746, val_loss=1.84, val_accuracy=0.52, lr=0.1] 19%|█▉        | 29/150 [09:04<35:43, 17.72s/epoch, loss=1.15, accuracy=0.747, val_loss=1.93, val_accuracy=0.513, lr=0.1] 20%|██        | 30/150 [09:22<35:19, 17.66s/epoch, loss=1.16, accuracy=0.746, val_loss=2.83, val_accuracy=0.406, lr=0.0316] 21%|██        | 31/150 [09:39<34:30, 17.40s/epoch, loss=1.16, accuracy=0.745, val_loss=2.46, val_accuracy=0.403, lr=0.1]    21%|██▏       | 32/150 [09:56<34:06, 17.34s/epoch, loss=1.16, accuracy=0.746, val_loss=2.05, val_accuracy=0.486, lr=0.1] 22%|██▏       | 33/150 [10:12<33:28, 17.16s/epoch, loss=1.15, accuracy=0.749, val_loss=1.64, val_accuracy=0.615, lr=0.1] 23%|██▎       | 34/150 [10:30<33:08, 17.15s/epoch, loss=1.15, accuracy=0.752, val_loss=2.24, val_accuracy=0.482, lr=0.1] 23%|██▎       | 35/150 [10:48<33:48, 17.64s/epoch, loss=1.15, accuracy=0.75, val_loss=3.74, val_accuracy=0.346, lr=0.0316] 24%|██▍       | 36/150 [11:06<33:20, 17.55s/epoch, loss=1.15, accuracy=0.75, val_loss=1.88, val_accuracy=0.515, lr=0.1]    25%|██▍       | 37/150 [11:24<33:38, 17.86s/epoch, loss=1.15, accuracy=0.745, val_loss=1.96, val_accuracy=0.548, lr=0.1] 25%|██▌       | 38/150 [11:42<33:02, 17.70s/epoch, loss=1.14, accuracy=0.751, val_loss=1.41, val_accuracy=0.665, lr=0.1] 26%|██▌       | 39/150 [11:59<32:46, 17.71s/epoch, loss=1.14, accuracy=0.751, val_loss=2.47, val_accuracy=0.497, lr=0.1] 27%|██▋       | 40/150 [12:17<32:25, 17.68s/epoch, loss=1.14, accuracy=0.748, val_loss=2.08, val_accuracy=0.509, lr=0.1] 27%|██▋       | 41/150 [12:36<32:50, 18.07s/epoch, loss=1.15, accuracy=0.75, val_loss=1.82, val_accuracy=0.54, lr=0.1]   28%|██▊       | 42/150 [12:53<32:13, 17.90s/epoch, loss=1.14, accuracy=0.752, val_loss=2.66, val_accuracy=0.51, lr=0.1] 29%|██▊       | 43/150 [13:11<31:28, 17.65s/epoch, loss=1.14, accuracy=0.751, val_loss=1.65, val_accuracy=0.573, lr=0.0316] 29%|██▉       | 44/150 [13:28<30:56, 17.51s/epoch, loss=1.14, accuracy=0.754, val_loss=1.53, val_accuracy=0.627, lr=0.1]    30%|███       | 45/150 [13:46<31:15, 17.86s/epoch, loss=1.14, accuracy=0.751, val_loss=1.89, val_accuracy=0.493, lr=0.1] 31%|███       | 46/150 [14:05<31:13, 18.01s/epoch, loss=1.14, accuracy=0.752, val_loss=1.57, val_accuracy=0.603, lr=0.1] 31%|███▏      | 47/150 [14:22<30:26, 17.74s/epoch, loss=1.14, accuracy=0.755, val_loss=2.82, val_accuracy=0.471, lr=0.1] 32%|███▏      | 48/150 [14:40<30:13, 17.78s/epoch, loss=1.14, accuracy=0.752, val_loss=2.35, val_accuracy=0.408, lr=0.0316] 33%|███▎      | 49/150 [14:58<30:07, 17.89s/epoch, loss=1.14, accuracy=0.753, val_loss=1.56, val_accuracy=0.631, lr=0.1]    33%|███▎      | 50/150 [15:15<29:28, 17.69s/epoch, loss=1.14, accuracy=0.753, val_loss=1.63, val_accuracy=0.553, lr=0.1] 34%|███▍      | 51/150 [15:34<29:34, 17.92s/epoch, loss=1.13, accuracy=0.755, val_loss=1.56, val_accuracy=0.616, lr=0.1] 35%|███▍      | 52/150 [15:51<28:49, 17.65s/epoch, loss=1.13, accuracy=0.754, val_loss=1.73, val_accuracy=0.573, lr=0.1] 35%|███▌      | 53/150 [16:08<28:21, 17.55s/epoch, loss=1.13, accuracy=0.754, val_loss=1.34, val_accuracy=0.689, lr=0.1] 36%|███▌      | 54/150 [16:25<27:43, 17.33s/epoch, loss=1.13, accuracy=0.755, val_loss=1.7, val_accuracy=0.6, lr=0.1]    37%|███▋      | 55/150 [16:42<27:32, 17.40s/epoch, loss=1.12, accuracy=0.756, val_loss=3.87, val_accuracy=0.312, lr=0.1] 37%|███▋      | 56/150 [16:59<26:57, 17.20s/epoch, loss=1.13, accuracy=0.754, val_loss=2.26, val_accuracy=0.421, lr=0.1] 38%|███▊      | 57/150 [17:16<26:33, 17.14s/epoch, loss=1.13, accuracy=0.754, val_loss=2.71, val_accuracy=0.362, lr=0.1] 39%|███▊      | 58/150 [17:33<26:18, 17.16s/epoch, loss=1.13, accuracy=0.756, val_loss=1.46, val_accuracy=0.637, lr=0.0316] 39%|███▉      | 59/150 [17:51<26:12, 17.28s/epoch, loss=1.13, accuracy=0.756, val_loss=1.82, val_accuracy=0.541, lr=0.1]    40%|████      | 60/150 [18:08<25:46, 17.18s/epoch, loss=1.12, accuracy=0.758, val_loss=1.87, val_accuracy=0.536, lr=0.1] 41%|████      | 61/150 [18:25<25:34, 17.24s/epoch, loss=1.13, accuracy=0.756, val_loss=2.07, val_accuracy=0.464, lr=0.1] 41%|████▏     | 62/150 [18:42<25:15, 17.22s/epoch, loss=1.13, accuracy=0.756, val_loss=2.97, val_accuracy=0.441, lr=0.1] 42%|████▏     | 63/150 [19:00<25:16, 17.43s/epoch, loss=1.13, accuracy=0.753, val_loss=1.91, val_accuracy=0.493, lr=0.0316] 43%|████▎     | 64/150 [19:17<24:45, 17.27s/epoch, loss=1.12, accuracy=0.757, val_loss=2.1, val_accuracy=0.499, lr=0.1]     43%|████▎     | 65/150 [19:34<24:19, 17.17s/epoch, loss=1.12, accuracy=0.758, val_loss=1.44, val_accuracy=0.657, lr=0.1] 44%|████▍     | 66/150 [19:51<23:59, 17.13s/epoch, loss=1.13, accuracy=0.756, val_loss=1.52, val_accuracy=0.629, lr=0.1] 45%|████▍     | 67/150 [20:08<23:46, 17.19s/epoch, loss=1.13, accuracy=0.754, val_loss=1.65, val_accuracy=0.607, lr=0.1] 45%|████▌     | 68/150 [20:26<23:31, 17.21s/epoch, loss=1.13, accuracy=0.759, val_loss=1.58, val_accuracy=0.624, lr=0.0316] 46%|████▌     | 69/150 [20:42<22:59, 17.04s/epoch, loss=1.13, accuracy=0.756, val_loss=1.91, val_accuracy=0.579, lr=0.1]    47%|████▋     | 70/150 [21:00<23:01, 17.27s/epoch, loss=1.12, accuracy=0.756, val_loss=2.16, val_accuracy=0.42, lr=0.1]  47%|████▋     | 71/150 [21:17<22:38, 17.19s/epoch, loss=1.12, accuracy=0.754, val_loss=2.06, val_accuracy=0.521, lr=0.1] 48%|████▊     | 72/150 [21:35<22:36, 17.40s/epoch, loss=1.12, accuracy=0.757, val_loss=2.43, val_accuracy=0.411, lr=0.1] 49%|████▊     | 73/150 [21:53<22:39, 17.66s/epoch, loss=1.12, accuracy=0.756, val_loss=1.74, val_accuracy=0.556, lr=0.0316] 49%|████▉     | 74/150 [22:12<22:47, 17.99s/epoch, loss=1.13, accuracy=0.757, val_loss=1.9, val_accuracy=0.584, lr=0.1]     50%|█████     | 75/150 [22:31<22:43, 18.19s/epoch, loss=1.12, accuracy=0.758, val_loss=2.27, val_accuracy=0.504, lr=0.1] 51%|█████     | 76/150 [22:48<22:05, 17.91s/epoch, loss=1.12, accuracy=0.755, val_loss=1.73, val_accuracy=0.559, lr=0.1] 51%|█████▏    | 77/150 [23:05<21:34, 17.73s/epoch, loss=1.12, accuracy=0.757, val_loss=2.5, val_accuracy=0.456, lr=0.1]  52%|█████▏    | 78/150 [23:23<21:13, 17.69s/epoch, loss=1.12, accuracy=0.758, val_loss=2.03, val_accuracy=0.472, lr=0.0316] 53%|█████▎    | 79/150 [23:40<20:54, 17.67s/epoch, loss=1.12, accuracy=0.756, val_loss=1.33, val_accuracy=0.684, lr=0.1]    53%|█████▎    | 80/150 [23:58<20:24, 17.49s/epoch, loss=1.12, accuracy=0.756, val_loss=3.28, val_accuracy=0.392, lr=0.1] 54%|█████▍    | 81/150 [24:15<20:00, 17.40s/epoch, loss=1.12, accuracy=0.755, val_loss=1.93, val_accuracy=0.546, lr=0.1] 55%|█████▍    | 82/150 [24:33<20:07, 17.76s/epoch, loss=0.923, accuracy=0.815, val_loss=0.869, val_accuracy=0.823, lr=0.01] 55%|█████▌    | 83/150 [24:51<19:46, 17.70s/epoch, loss=0.749, accuracy=0.846, val_loss=0.755, val_accuracy=0.83, lr=0.01]  56%|█████▌    | 84/150 [25:08<19:09, 17.41s/epoch, loss=0.668, accuracy=0.854, val_loss=0.82, val_accuracy=0.792, lr=0.01] 57%|█████▋    | 85/150 [25:25<18:42, 17.27s/epoch, loss=0.617, accuracy=0.859, val_loss=0.845, val_accuracy=0.779, lr=0.01] 57%|█████▋    | 86/150 [25:42<18:21, 17.22s/epoch, loss=0.591, accuracy=0.862, val_loss=0.677, val_accuracy=0.829, lr=0.01] 58%|█████▊    | 87/150 [25:58<17:56, 17.09s/epoch, loss=0.579, accuracy=0.863, val_loss=0.833, val_accuracy=0.786, lr=0.01] 59%|█████▊    | 88/150 [26:15<17:38, 17.08s/epoch, loss=0.571, accuracy=0.864, val_loss=0.76, val_accuracy=0.802, lr=0.01]  59%|█████▉    | 89/150 [26:33<17:23, 17.10s/epoch, loss=0.565, accuracy=0.865, val_loss=0.801, val_accuracy=0.793, lr=0.01] 60%|██████    | 90/150 [26:50<17:02, 17.05s/epoch, loss=0.563, accuracy=0.867, val_loss=0.658, val_accuracy=0.834, lr=0.01] 61%|██████    | 91/150 [27:07<16:55, 17.21s/epoch, loss=0.561, accuracy=0.867, val_loss=0.867, val_accuracy=0.762, lr=0.01] 61%|██████▏   | 92/150 [27:24<16:32, 17.11s/epoch, loss=0.564, accuracy=0.868, val_loss=0.733, val_accuracy=0.809, lr=0.01] 62%|██████▏   | 93/150 [27:42<16:23, 17.26s/epoch, loss=0.56, accuracy=0.869, val_loss=0.693, val_accuracy=0.818, lr=0.01]  63%|██████▎   | 94/150 [27:59<16:06, 17.27s/epoch, loss=0.558, accuracy=0.871, val_loss=0.802, val_accuracy=0.793, lr=0.01] 63%|██████▎   | 95/150 [28:16<15:46, 17.21s/epoch, loss=0.557, accuracy=0.87, val_loss=0.716, val_accuracy=0.822, lr=0.00316] 64%|██████▍   | 96/150 [28:33<15:27, 17.18s/epoch, loss=0.556, accuracy=0.871, val_loss=0.823, val_accuracy=0.802, lr=0.01]   65%|██████▍   | 97/150 [28:50<15:11, 17.20s/epoch, loss=0.552, accuracy=0.876, val_loss=0.79, val_accuracy=0.804, lr=0.01]  65%|██████▌   | 98/150 [29:09<15:16, 17.63s/epoch, loss=0.554, accuracy=0.874, val_loss=0.851, val_accuracy=0.789, lr=0.01] 66%|██████▌   | 99/150 [29:27<15:06, 17.77s/epoch, loss=0.551, accuracy=0.879, val_loss=0.693, val_accuracy=0.831, lr=0.01] 67%|██████▋   | 100/150 [29:45<14:53, 17.87s/epoch, loss=0.553, accuracy=0.877, val_loss=0.757, val_accuracy=0.811, lr=0.00316] 67%|██████▋   | 101/150 [30:02<14:24, 17.64s/epoch, loss=0.547, accuracy=0.88, val_loss=0.788, val_accuracy=0.804, lr=0.01]     68%|██████▊   | 102/150 [30:21<14:18, 17.88s/epoch, loss=0.551, accuracy=0.876, val_loss=0.78, val_accuracy=0.805, lr=0.01] 69%|██████▊   | 103/150 [30:38<13:50, 17.68s/epoch, loss=0.552, accuracy=0.878, val_loss=0.789, val_accuracy=0.806, lr=0.01] 69%|██████▉   | 104/150 [30:55<13:30, 17.62s/epoch, loss=0.554, accuracy=0.878, val_loss=0.848, val_accuracy=0.784, lr=0.01] 70%|███████   | 105/150 [31:14<13:20, 17.80s/epoch, loss=0.547, accuracy=0.88, val_loss=0.812, val_accuracy=0.803, lr=0.00316] 71%|███████   | 106/150 [31:32<13:05, 17.86s/epoch, loss=0.551, accuracy=0.88, val_loss=0.932, val_accuracy=0.758, lr=0.01]    71%|███████▏  | 107/150 [31:50<12:54, 18.02s/epoch, loss=0.549, accuracy=0.882, val_loss=0.746, val_accuracy=0.819, lr=0.01] 72%|███████▏  | 108/150 [32:08<12:39, 18.09s/epoch, loss=0.552, accuracy=0.88, val_loss=0.873, val_accuracy=0.786, lr=0.01]  73%|███████▎  | 109/150 [32:25<12:07, 17.75s/epoch, loss=0.549, accuracy=0.882, val_loss=0.814, val_accuracy=0.807, lr=0.01] 73%|███████▎  | 110/150 [32:44<11:55, 17.90s/epoch, loss=0.545, accuracy=0.883, val_loss=0.735, val_accuracy=0.816, lr=0.00316] 74%|███████▍  | 111/150 [33:02<11:39, 17.94s/epoch, loss=0.546, accuracy=0.883, val_loss=0.728, val_accuracy=0.823, lr=0.01]    75%|███████▍  | 112/150 [33:19<11:13, 17.72s/epoch, loss=0.552, accuracy=0.882, val_loss=0.776, val_accuracy=0.816, lr=0.01] 75%|███████▌  | 113/150 [33:36<10:47, 17.50s/epoch, loss=0.543, accuracy=0.886, val_loss=0.815, val_accuracy=0.797, lr=0.01] 76%|███████▌  | 114/150 [33:54<10:42, 17.84s/epoch, loss=0.547, accuracy=0.884, val_loss=0.942, val_accuracy=0.754, lr=0.01] 77%|███████▋  | 115/150 [34:11<10:15, 17.58s/epoch, loss=0.551, accuracy=0.885, val_loss=0.853, val_accuracy=0.79, lr=0.00316] 77%|███████▋  | 116/150 [34:28<09:52, 17.42s/epoch, loss=0.55, accuracy=0.884, val_loss=0.865, val_accuracy=0.785, lr=0.01]    78%|███████▊  | 117/150 [34:47<09:45, 17.73s/epoch, loss=0.55, accuracy=0.885, val_loss=0.781, val_accuracy=0.811, lr=0.01] 79%|███████▊  | 118/150 [35:05<09:34, 17.95s/epoch, loss=0.549, accuracy=0.885, val_loss=0.668, val_accuracy=0.849, lr=0.01] 79%|███████▉  | 119/150 [35:22<09:04, 17.56s/epoch, loss=0.545, accuracy=0.886, val_loss=0.698, val_accuracy=0.845, lr=0.01] 80%|████████  | 120/150 [35:40<08:48, 17.63s/epoch, loss=0.547, accuracy=0.886, val_loss=0.842, val_accuracy=0.791, lr=0.00316] 81%|████████  | 121/150 [35:57<08:30, 17.59s/epoch, loss=0.549, accuracy=0.887, val_loss=0.778, val_accuracy=0.82, lr=0.01]     81%|████████▏ | 122/150 [36:16<08:22, 17.96s/epoch, loss=0.474, accuracy=0.911, val_loss=0.51, val_accuracy=0.901, lr=0.001] 82%|████████▏ | 123/150 [36:34<08:02, 17.87s/epoch, loss=0.422, accuracy=0.93, val_loss=0.498, val_accuracy=0.906, lr=0.001] 83%|████████▎ | 124/150 [36:51<07:42, 17.79s/epoch, loss=0.399, accuracy=0.934, val_loss=0.494, val_accuracy=0.904, lr=0.001] 83%|████████▎ | 125/150 [37:10<07:31, 18.05s/epoch, loss=0.383, accuracy=0.94, val_loss=0.479, val_accuracy=0.908, lr=0.001]  84%|████████▍ | 126/150 [37:28<07:10, 17.95s/epoch, loss=0.37, accuracy=0.94, val_loss=0.481, val_accuracy=0.907, lr=0.001]  85%|████████▍ | 127/150 [37:45<06:50, 17.86s/epoch, loss=0.359, accuracy=0.945, val_loss=0.474, val_accuracy=0.907, lr=0.001] 85%|████████▌ | 128/150 [38:04<06:38, 18.13s/epoch, loss=0.346, accuracy=0.946, val_loss=0.468, val_accuracy=0.909, lr=0.001] 86%|████████▌ | 129/150 [38:22<06:21, 18.18s/epoch, loss=0.338, accuracy=0.948, val_loss=0.457, val_accuracy=0.912, lr=0.001] 87%|████████▋ | 130/150 [38:40<06:02, 18.11s/epoch, loss=0.33, accuracy=0.949, val_loss=0.46, val_accuracy=0.906, lr=0.001]   87%|████████▋ | 131/150 [38:57<05:37, 17.79s/epoch, loss=0.322, accuracy=0.949, val_loss=0.455, val_accuracy=0.911, lr=0.001] 88%|████████▊ | 132/150 [39:14<05:16, 17.57s/epoch, loss=0.312, accuracy=0.953, val_loss=0.459, val_accuracy=0.906, lr=0.001] 89%|████████▊ | 133/150 [39:33<05:02, 17.81s/epoch, loss=0.306, accuracy=0.953, val_loss=0.463, val_accuracy=0.902, lr=0.001] 89%|████████▉ | 134/150 [39:51<04:44, 17.79s/epoch, loss=0.297, accuracy=0.955, val_loss=0.455, val_accuracy=0.906, lr=0.001] 90%|█████████ | 135/150 [40:09<04:29, 17.95s/epoch, loss=0.291, accuracy=0.956, val_loss=0.44, val_accuracy=0.907, lr=0.001]  91%|█████████ | 136/150 [40:27<04:10, 17.91s/epoch, loss=0.284, accuracy=0.957, val_loss=0.457, val_accuracy=0.902, lr=0.001] 91%|█████████▏| 137/150 [40:45<03:53, 17.98s/epoch, loss=0.28, accuracy=0.957, val_loss=0.478, val_accuracy=0.899, lr=0.001]  92%|█████████▏| 138/150 [41:02<03:33, 17.80s/epoch, loss=0.271, accuracy=0.959, val_loss=0.442, val_accuracy=0.905, lr=0.001] 93%|█████████▎| 139/150 [41:21<03:18, 18.02s/epoch, loss=0.268, accuracy=0.959, val_loss=0.459, val_accuracy=0.906, lr=0.001] 93%|█████████▎| 140/150 [41:39<03:01, 18.12s/epoch, loss=0.261, accuracy=0.96, val_loss=0.491, val_accuracy=0.888, lr=0.000316] 94%|█████████▍| 141/150 [41:56<02:39, 17.77s/epoch, loss=0.256, accuracy=0.962, val_loss=0.458, val_accuracy=0.901, lr=0.001]   95%|█████████▍| 142/150 [42:13<02:20, 17.54s/epoch, loss=0.252, accuracy=0.961, val_loss=0.456, val_accuracy=0.898, lr=0.001] 95%|█████████▌| 143/150 [42:30<02:02, 17.45s/epoch, loss=0.247, accuracy=0.961, val_loss=0.452, val_accuracy=0.901, lr=0.001] 96%|█████████▌| 144/150 [42:47<01:43, 17.27s/epoch, loss=0.242, accuracy=0.963, val_loss=0.471, val_accuracy=0.894, lr=0.001] 97%|█████████▋| 145/150 [43:05<01:26, 17.35s/epoch, loss=0.243, accuracy=0.961, val_loss=0.523, val_accuracy=0.881, lr=0.000316] 97%|█████████▋| 146/150 [43:22<01:09, 17.32s/epoch, loss=0.239, accuracy=0.962, val_loss=0.451, val_accuracy=0.9, lr=0.001]      98%|█████████▊| 147/150 [43:39<00:51, 17.16s/epoch, loss=0.232, accuracy=0.964, val_loss=0.462, val_accuracy=0.899, lr=0.001] 99%|█████████▊| 148/150 [43:56<00:34, 17.13s/epoch, loss=0.235, accuracy=0.962, val_loss=0.458, val_accuracy=0.898, lr=0.001] 99%|█████████▉| 149/150 [44:14<00:17, 17.55s/epoch, loss=0.231, accuracy=0.964, val_loss=0.474, val_accuracy=0.893, lr=0.001]100%|██████████| 150/150 [44:31<00:00, 17.43s/epoch, loss=0.228, accuracy=0.964, val_loss=0.464, val_accuracy=0.895, lr=0.000316]100%|██████████| 150/150 [44:31<00:00, 17.81s/epoch, loss=0.228, accuracy=0.964, val_loss=0.464, val_accuracy=0.895, lr=0.000316]
Using real-time data augmentation.
Test score: 0.48184508085250854
Test accuracy: 0.9017000198364258

Mon Feb 19 22:04:39 2024       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 545.23.08              Driver Version: 545.23.08    CUDA Version: 12.3     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA TITAN Xp                Off | 00000000:18:00.0 Off |                  N/A |
| 50%   73C    P2              67W / 250W |      0MiB / 12288MiB |      0%      Default |
|                                         |                      |                  N/A |
+-----------------------------------------+----------------------+----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
|  No running processes found                                                           |
+---------------------------------------------------------------------------------------+


* * * Run SGD for cluster size = 16. * * *


Budget: 93


* * * Run SGD for ID = 16_1. * * *


2024-02-19 22:04:39.982761: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 22:04:48.836206: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-19 22:04:48.838180: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-19 22:04:48.883910: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-19 22:04:48.883956: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 22:04:48.925403: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-19 22:04:48.925506: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-19 22:04:48.958125: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-19 22:04:49.020010: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-19 22:04:49.067981: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-19 22:04:49.103659: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-19 22:04:49.148354: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-19 22:04:49.149170: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-19 22:04:49.149268: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-19 22:04:50.764130: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-19 22:04:50.765543: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-19 22:04:50.766094: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-19 22:04:50.766129: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 22:04:50.766163: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-19 22:04:50.766178: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-19 22:04:50.766193: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-19 22:04:50.766207: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-19 22:04:50.766221: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-19 22:04:50.766235: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-19 22:04:50.766250: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-19 22:04:50.766858: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-19 22:04:50.766898: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 22:04:51.758137: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-19 22:04:51.758192: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-19 22:04:51.758203: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-19 22:04:51.759344: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:18:00.0, compute capability: 6.1)
{'id': '16_01', 'batch_size': 128, 'epochs': 93, 'validation_split': 0.1, 'checkpointing': True, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
x_train shape: (45000, 32, 32, 3)
45000 train samples
5000 validation samples
10000 test samples
y_train shape: (45000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/93 [00:00<?, ?epoch/s]2024-02-19 22:04:52.643236: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-19 22:04:52.656064: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-02-19 22:04:54.772997: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-19 22:04:55.133627: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-19 22:04:56.438786: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-19 22:04:56.477125: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/93 [01:01<1:34:45, 61.80s/epoch, loss=3.54, accuracy=0.295, val_loss=2.36, val_accuracy=0.308, lr=0.1]  2%|▏         | 2/93 [01:29<1:03:18, 41.75s/epoch, loss=1.69, accuracy=0.479, val_loss=2.74, val_accuracy=0.321, lr=0.1]  3%|▎         | 3/93 [01:57<52:53, 35.26s/epoch, loss=1.48, accuracy=0.571, val_loss=1.52, val_accuracy=0.554, lr=0.1]    4%|▍         | 4/93 [02:24<47:46, 32.21s/epoch, loss=1.39, accuracy=0.625, val_loss=1.8, val_accuracy=0.482, lr=0.1]   5%|▌         | 5/93 [02:52<44:43, 30.50s/epoch, loss=1.32, accuracy=0.665, val_loss=1.85, val_accuracy=0.52, lr=0.1]  6%|▋         | 6/93 [03:19<42:43, 29.46s/epoch, loss=1.28, accuracy=0.688, val_loss=2.04, val_accuracy=0.459, lr=0.1]  8%|▊         | 7/93 [03:47<41:20, 28.84s/epoch, loss=1.27, accuracy=0.698, val_loss=4.5, val_accuracy=0.254, lr=0.1]   9%|▊         | 8/93 [04:14<40:13, 28.39s/epoch, loss=1.25, accuracy=0.708, val_loss=2.45, val_accuracy=0.404, lr=0.0316] 10%|▉         | 9/93 [04:41<39:19, 28.09s/epoch, loss=1.23, accuracy=0.713, val_loss=1.85, val_accuracy=0.527, lr=0.1]    11%|█         | 10/93 [05:09<38:47, 28.04s/epoch, loss=1.22, accuracy=0.72, val_loss=1.57, val_accuracy=0.601, lr=0.1] 12%|█▏        | 11/93 [05:37<37:57, 27.77s/epoch, loss=1.22, accuracy=0.722, val_loss=1.67, val_accuracy=0.551, lr=0.1] 13%|█▎        | 12/93 [06:04<37:21, 27.68s/epoch, loss=1.22, accuracy=0.727, val_loss=6.85, val_accuracy=0.149, lr=0.1] 14%|█▍        | 13/93 [06:32<36:53, 27.66s/epoch, loss=1.21, accuracy=0.727, val_loss=1.63, val_accuracy=0.609, lr=0.0316] 15%|█▌        | 14/93 [06:59<36:17, 27.57s/epoch, loss=1.21, accuracy=0.728, val_loss=1.77, val_accuracy=0.566, lr=0.1]    16%|█▌        | 15/93 [07:26<35:47, 27.53s/epoch, loss=1.2, accuracy=0.734, val_loss=1.99, val_accuracy=0.484, lr=0.1]  17%|█▋        | 16/93 [07:54<35:19, 27.52s/epoch, loss=1.2, accuracy=0.735, val_loss=1.89, val_accuracy=0.482, lr=0.1] 18%|█▊        | 17/93 [08:21<34:52, 27.53s/epoch, loss=1.19, accuracy=0.736, val_loss=1.68, val_accuracy=0.59, lr=0.1] 19%|█▉        | 18/93 [08:49<34:26, 27.55s/epoch, loss=1.19, accuracy=0.734, val_loss=1.74, val_accuracy=0.54, lr=0.0316] 20%|██        | 19/93 [09:17<33:59, 27.56s/epoch, loss=1.19, accuracy=0.737, val_loss=1.64, val_accuracy=0.59, lr=0.1]    22%|██▏       | 20/93 [09:44<33:31, 27.56s/epoch, loss=1.19, accuracy=0.739, val_loss=1.9, val_accuracy=0.49, lr=0.1]  23%|██▎       | 21/93 [10:12<32:59, 27.49s/epoch, loss=1.19, accuracy=0.739, val_loss=1.99, val_accuracy=0.521, lr=0.1] 24%|██▎       | 22/93 [10:39<32:29, 27.46s/epoch, loss=1.18, accuracy=0.743, val_loss=4.93, val_accuracy=0.276, lr=0.1] 25%|██▍       | 23/93 [11:06<32:00, 27.43s/epoch, loss=1.19, accuracy=0.741, val_loss=1.65, val_accuracy=0.579, lr=0.0316] 26%|██▌       | 24/93 [11:34<31:29, 27.39s/epoch, loss=1.19, accuracy=0.74, val_loss=1.98, val_accuracy=0.5, lr=0.1]       27%|██▋       | 25/93 [12:01<31:09, 27.50s/epoch, loss=1.18, accuracy=0.742, val_loss=1.34, val_accuracy=0.686, lr=0.1] 28%|██▊       | 26/93 [12:28<30:33, 27.36s/epoch, loss=1.18, accuracy=0.743, val_loss=2, val_accuracy=0.511, lr=0.1]    29%|██▉       | 27/93 [12:56<30:05, 27.35s/epoch, loss=1.19, accuracy=0.742, val_loss=2.04, val_accuracy=0.461, lr=0.1] 30%|███       | 28/93 [13:23<29:32, 27.26s/epoch, loss=1.18, accuracy=0.745, val_loss=1.69, val_accuracy=0.62, lr=0.1]  31%|███       | 29/93 [13:50<29:06, 27.29s/epoch, loss=1.18, accuracy=0.743, val_loss=2.28, val_accuracy=0.441, lr=0.1] 32%|███▏      | 30/93 [14:17<28:40, 27.31s/epoch, loss=1.18, accuracy=0.744, val_loss=2.29, val_accuracy=0.507, lr=0.0316] 33%|███▎      | 31/93 [14:45<28:10, 27.27s/epoch, loss=1.18, accuracy=0.746, val_loss=1.56, val_accuracy=0.614, lr=0.1]    34%|███▍      | 32/93 [15:12<27:44, 27.28s/epoch, loss=1.18, accuracy=0.744, val_loss=3.42, val_accuracy=0.36, lr=0.1]  35%|███▌      | 33/93 [15:39<27:17, 27.29s/epoch, loss=1.17, accuracy=0.745, val_loss=1.93, val_accuracy=0.524, lr=0.1] 37%|███▋      | 34/93 [16:07<26:49, 27.28s/epoch, loss=1.17, accuracy=0.744, val_loss=2.24, val_accuracy=0.429, lr=0.1] 38%|███▊      | 35/93 [16:34<26:26, 27.36s/epoch, loss=1.17, accuracy=0.747, val_loss=2.41, val_accuracy=0.419, lr=0.0316] 39%|███▊      | 36/93 [17:01<25:56, 27.30s/epoch, loss=1.17, accuracy=0.745, val_loss=10.1, val_accuracy=0.147, lr=0.1]    40%|███▉      | 37/93 [17:29<25:33, 27.38s/epoch, loss=1.16, accuracy=0.75, val_loss=1.81, val_accuracy=0.565, lr=0.1]  41%|████      | 38/93 [17:56<25:06, 27.40s/epoch, loss=1.17, accuracy=0.748, val_loss=1.9, val_accuracy=0.499, lr=0.1] 42%|████▏     | 39/93 [18:24<24:38, 27.39s/epoch, loss=1.17, accuracy=0.747, val_loss=2.85, val_accuracy=0.319, lr=0.1] 43%|████▎     | 40/93 [18:51<24:10, 27.36s/epoch, loss=1.17, accuracy=0.746, val_loss=1.55, val_accuracy=0.606, lr=0.0316] 44%|████▍     | 41/93 [19:18<23:40, 27.31s/epoch, loss=1.16, accuracy=0.75, val_loss=1.65, val_accuracy=0.617, lr=0.1]     45%|████▌     | 42/93 [19:45<23:09, 27.25s/epoch, loss=1.17, accuracy=0.749, val_loss=1.54, val_accuracy=0.624, lr=0.1] 46%|████▌     | 43/93 [20:13<22:45, 27.31s/epoch, loss=1.16, accuracy=0.75, val_loss=2.91, val_accuracy=0.353, lr=0.1]  47%|████▋     | 44/93 [20:40<22:14, 27.24s/epoch, loss=1.17, accuracy=0.749, val_loss=2.11, val_accuracy=0.47, lr=0.1] 48%|████▊     | 45/93 [21:07<21:48, 27.26s/epoch, loss=1.17, accuracy=0.748, val_loss=1.44, val_accuracy=0.664, lr=0.0316] 49%|████▉     | 46/93 [21:34<21:20, 27.25s/epoch, loss=1.17, accuracy=0.747, val_loss=1.58, val_accuracy=0.613, lr=0.1]    51%|█████     | 47/93 [22:01<20:52, 27.23s/epoch, loss=1.17, accuracy=0.748, val_loss=1.61, val_accuracy=0.604, lr=0.1] 52%|█████▏    | 48/93 [22:29<20:25, 27.24s/epoch, loss=1.16, accuracy=0.75, val_loss=1.61, val_accuracy=0.592, lr=0.1]  53%|█████▎    | 49/93 [22:56<19:55, 27.16s/epoch, loss=1.17, accuracy=0.747, val_loss=2.33, val_accuracy=0.372, lr=0.1] 54%|█████▍    | 50/93 [23:23<19:29, 27.19s/epoch, loss=1.16, accuracy=0.746, val_loss=1.89, val_accuracy=0.488, lr=0.0316] 55%|█████▍    | 51/93 [23:50<19:00, 27.15s/epoch, loss=1.16, accuracy=0.75, val_loss=2.13, val_accuracy=0.465, lr=0.1]     56%|█████▌    | 52/93 [24:17<18:34, 27.17s/epoch, loss=1.15, accuracy=0.752, val_loss=2.09, val_accuracy=0.538, lr=0.1] 57%|█████▋    | 53/93 [24:44<18:06, 27.17s/epoch, loss=1.16, accuracy=0.751, val_loss=3.61, val_accuracy=0.262, lr=0.1] 58%|█████▊    | 54/93 [25:12<17:40, 27.18s/epoch, loss=1.15, accuracy=0.753, val_loss=1.92, val_accuracy=0.51, lr=0.1]  59%|█████▉    | 55/93 [25:39<17:13, 27.20s/epoch, loss=1.16, accuracy=0.75, val_loss=2.65, val_accuracy=0.454, lr=0.0316] 60%|██████    | 56/93 [26:06<16:43, 27.12s/epoch, loss=1.15, accuracy=0.752, val_loss=1.76, val_accuracy=0.545, lr=0.1]   61%|██████▏   | 57/93 [26:33<16:15, 27.10s/epoch, loss=1.15, accuracy=0.751, val_loss=2.49, val_accuracy=0.406, lr=0.1] 62%|██████▏   | 58/93 [27:00<15:48, 27.09s/epoch, loss=1.16, accuracy=0.748, val_loss=2.27, val_accuracy=0.455, lr=0.1] 63%|██████▎   | 59/93 [27:27<15:18, 27.00s/epoch, loss=1.16, accuracy=0.749, val_loss=1.59, val_accuracy=0.591, lr=0.1] 65%|██████▍   | 60/93 [27:54<14:53, 27.08s/epoch, loss=1.15, accuracy=0.75, val_loss=1.63, val_accuracy=0.611, lr=0.0316] 66%|██████▌   | 61/93 [28:21<14:27, 27.10s/epoch, loss=1.16, accuracy=0.752, val_loss=2.35, val_accuracy=0.416, lr=0.1]   67%|██████▋   | 62/93 [28:48<14:01, 27.14s/epoch, loss=1.16, accuracy=0.751, val_loss=1.74, val_accuracy=0.568, lr=0.1] 68%|██████▊   | 63/93 [29:15<13:34, 27.14s/epoch, loss=1.15, accuracy=0.754, val_loss=2.14, val_accuracy=0.506, lr=0.1] 69%|██████▉   | 64/93 [29:43<13:07, 27.16s/epoch, loss=1.15, accuracy=0.752, val_loss=2.4, val_accuracy=0.397, lr=0.1]  70%|██████▉   | 65/93 [30:10<12:40, 27.16s/epoch, loss=1.16, accuracy=0.751, val_loss=2.51, val_accuracy=0.43, lr=0.0316] 71%|███████   | 66/93 [30:37<12:13, 27.15s/epoch, loss=1.15, accuracy=0.753, val_loss=3.59, val_accuracy=0.318, lr=0.1]   72%|███████▏  | 67/93 [31:04<11:46, 27.18s/epoch, loss=1.14, accuracy=0.756, val_loss=2.28, val_accuracy=0.487, lr=0.1] 73%|███████▎  | 68/93 [31:31<11:19, 27.17s/epoch, loss=1.15, accuracy=0.752, val_loss=2.47, val_accuracy=0.379, lr=0.1] 74%|███████▍  | 69/93 [31:58<10:51, 27.13s/epoch, loss=1.14, accuracy=0.752, val_loss=1.92, val_accuracy=0.515, lr=0.1] 75%|███████▌  | 70/93 [32:26<10:24, 27.17s/epoch, loss=1.15, accuracy=0.752, val_loss=1.94, val_accuracy=0.502, lr=0.0316] 76%|███████▋  | 71/93 [32:53<09:57, 27.17s/epoch, loss=1.14, accuracy=0.754, val_loss=1.76, val_accuracy=0.571, lr=0.1]    77%|███████▋  | 72/93 [33:20<09:29, 27.13s/epoch, loss=1.15, accuracy=0.752, val_loss=2.68, val_accuracy=0.421, lr=0.1] 78%|███████▊  | 73/93 [33:47<09:03, 27.19s/epoch, loss=1.15, accuracy=0.752, val_loss=2.43, val_accuracy=0.385, lr=0.1] 80%|███████▉  | 74/93 [34:14<08:35, 27.15s/epoch, loss=1.15, accuracy=0.751, val_loss=2.44, val_accuracy=0.432, lr=0.1] 81%|████████  | 75/93 [34:42<08:09, 27.20s/epoch, loss=1.15, accuracy=0.752, val_loss=2.74, val_accuracy=0.371, lr=0.0316] 82%|████████▏ | 76/93 [35:09<07:41, 27.14s/epoch, loss=1.14, accuracy=0.753, val_loss=1.98, val_accuracy=0.488, lr=0.1]    83%|████████▎ | 77/93 [35:36<07:14, 27.17s/epoch, loss=1.14, accuracy=0.754, val_loss=2.54, val_accuracy=0.351, lr=0.1] 84%|████████▍ | 78/93 [36:03<06:47, 27.17s/epoch, loss=1.14, accuracy=0.754, val_loss=2.01, val_accuracy=0.556, lr=0.1] 85%|████████▍ | 79/93 [36:30<06:19, 27.12s/epoch, loss=1.14, accuracy=0.754, val_loss=2.01, val_accuracy=0.536, lr=0.1] 86%|████████▌ | 80/93 [36:57<05:52, 27.14s/epoch, loss=1.15, accuracy=0.754, val_loss=1.89, val_accuracy=0.527, lr=0.0316] 87%|████████▋ | 81/93 [37:24<05:25, 27.13s/epoch, loss=1.14, accuracy=0.754, val_loss=2.11, val_accuracy=0.522, lr=0.1]    88%|████████▊ | 82/93 [37:52<04:59, 27.20s/epoch, loss=0.935, accuracy=0.811, val_loss=1.02, val_accuracy=0.763, lr=0.01] 89%|████████▉ | 83/93 [38:19<04:32, 27.20s/epoch, loss=0.755, accuracy=0.844, val_loss=0.793, val_accuracy=0.825, lr=0.01] 90%|█████████ | 84/93 [38:46<04:04, 27.14s/epoch, loss=0.675, accuracy=0.854, val_loss=0.763, val_accuracy=0.813, lr=0.01] 91%|█████████▏| 85/93 [39:13<03:37, 27.20s/epoch, loss=0.625, accuracy=0.856, val_loss=0.72, val_accuracy=0.828, lr=0.01]  92%|█████████▏| 86/93 [39:40<03:09, 27.13s/epoch, loss=0.599, accuracy=0.859, val_loss=0.848, val_accuracy=0.776, lr=0.01] 94%|█████████▎| 87/93 [40:07<02:42, 27.11s/epoch, loss=0.589, accuracy=0.861, val_loss=1, val_accuracy=0.72, lr=0.01]      95%|█████████▍| 88/93 [40:34<02:15, 27.11s/epoch, loss=0.575, accuracy=0.862, val_loss=0.812, val_accuracy=0.784, lr=0.01] 96%|█████████▌| 89/93 [41:01<01:48, 27.11s/epoch, loss=0.573, accuracy=0.864, val_loss=0.853, val_accuracy=0.772, lr=0.01] 97%|█████████▋| 90/93 [41:29<01:21, 27.12s/epoch, loss=0.571, accuracy=0.865, val_loss=1.47, val_accuracy=0.616, lr=0.00316] 98%|█████████▊| 91/93 [41:55<00:54, 27.06s/epoch, loss=0.565, accuracy=0.869, val_loss=0.788, val_accuracy=0.797, lr=0.01]   99%|█████████▉| 92/93 [42:22<00:27, 27.04s/epoch, loss=0.569, accuracy=0.866, val_loss=0.809, val_accuracy=0.797, lr=0.01]100%|██████████| 93/93 [42:50<00:00, 27.07s/epoch, loss=0.565, accuracy=0.869, val_loss=0.811, val_accuracy=0.791, lr=0.01]100%|██████████| 93/93 [42:50<00:00, 27.64s/epoch, loss=0.565, accuracy=0.869, val_loss=0.811, val_accuracy=0.791, lr=0.01]
Using real-time data augmentation.
Test score: 0.7348365783691406
Test accuracy: 0.8238999843597412


* * * Run SGD for ID = 16_2. * * *


2024-02-19 22:47:48.864978: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 22:47:51.743315: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-19 22:47:51.744469: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-19 22:47:51.785467: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-19 22:47:51.785524: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 22:47:51.788810: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-19 22:47:51.788879: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-19 22:47:51.791343: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-19 22:47:51.792287: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-19 22:47:51.794979: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-19 22:47:51.796911: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-19 22:47:51.802503: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-19 22:47:51.803270: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-19 22:47:51.803363: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-19 22:47:53.263214: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-19 22:47:53.264332: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-19 22:47:53.264942: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-19 22:47:53.264988: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 22:47:53.265028: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-19 22:47:53.265044: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-19 22:47:53.265059: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-19 22:47:53.265073: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-19 22:47:53.265087: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-19 22:47:53.265112: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-19 22:47:53.265127: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-19 22:47:53.265727: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-19 22:47:53.265775: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 22:47:53.940874: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-19 22:47:53.940933: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-19 22:47:53.940944: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-19 22:47:53.943259: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:18:00.0, compute capability: 6.1)
{'id': '16_02', 'batch_size': 128, 'epochs': 93, 'validation_split': 0.1, 'checkpointing': True, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
x_train shape: (45000, 32, 32, 3)
45000 train samples
5000 validation samples
10000 test samples
y_train shape: (45000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/93 [00:00<?, ?epoch/s]2024-02-19 22:47:54.813134: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-19 22:47:54.825933: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-02-19 22:47:56.897459: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-19 22:47:57.250806: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-19 22:47:58.260339: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-19 22:47:58.299033: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/93 [00:57<1:28:09, 57.50s/epoch, loss=3.41, accuracy=0.296, val_loss=2.66, val_accuracy=0.212, lr=0.1]  2%|▏         | 2/93 [01:25<1:00:33, 39.93s/epoch, loss=1.7, accuracy=0.47, val_loss=2.27, val_accuracy=0.334, lr=0.1]    3%|▎         | 3/93 [01:52<51:27, 34.31s/epoch, loss=1.46, accuracy=0.579, val_loss=1.73, val_accuracy=0.522, lr=0.1]  4%|▍         | 4/93 [02:20<46:53, 31.61s/epoch, loss=1.32, accuracy=0.658, val_loss=1.67, val_accuracy=0.57, lr=0.1]   5%|▌         | 5/93 [02:47<44:03, 30.04s/epoch, loss=1.27, accuracy=0.688, val_loss=2.11, val_accuracy=0.433, lr=0.1]  6%|▋         | 6/93 [03:14<42:13, 29.12s/epoch, loss=1.24, accuracy=0.706, val_loss=1.71, val_accuracy=0.552, lr=0.1]  8%|▊         | 7/93 [03:42<40:55, 28.55s/epoch, loss=1.22, accuracy=0.719, val_loss=1.77, val_accuracy=0.507, lr=0.1]  9%|▊         | 8/93 [04:09<39:54, 28.17s/epoch, loss=1.21, accuracy=0.724, val_loss=3.44, val_accuracy=0.243, lr=0.1] 10%|▉         | 9/93 [04:36<39:03, 27.90s/epoch, loss=1.2, accuracy=0.73, val_loss=2.7, val_accuracy=0.387, lr=0.0316] 11%|█         | 10/93 [05:04<38:20, 27.72s/epoch, loss=1.2, accuracy=0.729, val_loss=1.88, val_accuracy=0.536, lr=0.1] 12%|█▏        | 11/93 [05:31<37:40, 27.57s/epoch, loss=1.19, accuracy=0.736, val_loss=1.98, val_accuracy=0.497, lr=0.1] 13%|█▎        | 12/93 [05:58<37:07, 27.51s/epoch, loss=1.19, accuracy=0.738, val_loss=2.96, val_accuracy=0.298, lr=0.1] 14%|█▍        | 13/93 [06:26<36:38, 27.48s/epoch, loss=1.19, accuracy=0.736, val_loss=2.61, val_accuracy=0.453, lr=0.1] 15%|█▌        | 14/93 [06:53<36:16, 27.56s/epoch, loss=1.18, accuracy=0.742, val_loss=1.52, val_accuracy=0.626, lr=0.1] 16%|█▌        | 15/93 [07:21<35:41, 27.46s/epoch, loss=1.18, accuracy=0.744, val_loss=1.79, val_accuracy=0.525, lr=0.1] 17%|█▋        | 16/93 [07:48<35:04, 27.33s/epoch, loss=1.18, accuracy=0.744, val_loss=2.41, val_accuracy=0.457, lr=0.1] 18%|█▊        | 17/93 [08:15<34:34, 27.30s/epoch, loss=1.18, accuracy=0.745, val_loss=2.03, val_accuracy=0.451, lr=0.1] 19%|█▉        | 18/93 [08:42<34:10, 27.34s/epoch, loss=1.17, accuracy=0.748, val_loss=2.26, val_accuracy=0.512, lr=0.1] 20%|██        | 19/93 [09:10<33:43, 27.35s/epoch, loss=1.17, accuracy=0.747, val_loss=2.01, val_accuracy=0.479, lr=0.0316] 22%|██▏       | 20/93 [09:37<33:21, 27.42s/epoch, loss=1.16, accuracy=0.75, val_loss=1.34, val_accuracy=0.672, lr=0.1]     23%|██▎       | 21/93 [10:05<32:49, 27.36s/epoch, loss=1.16, accuracy=0.744, val_loss=1.72, val_accuracy=0.556, lr=0.1] 24%|██▎       | 22/93 [10:32<32:16, 27.28s/epoch, loss=1.16, accuracy=0.749, val_loss=1.44, val_accuracy=0.65, lr=0.1]  25%|██▍       | 23/93 [10:59<31:56, 27.38s/epoch, loss=1.16, accuracy=0.748, val_loss=2.2, val_accuracy=0.409, lr=0.1] 26%|██▌       | 24/93 [11:25<30:48, 26.79s/epoch, loss=1.15, accuracy=0.752, val_loss=2.46, val_accuracy=0.386, lr=0.1] 27%|██▋       | 25/93 [11:52<30:35, 26.99s/epoch, loss=1.16, accuracy=0.751, val_loss=1.49, val_accuracy=0.655, lr=0.0316] 28%|██▊       | 26/93 [12:19<30:16, 27.11s/epoch, loss=1.15, accuracy=0.752, val_loss=1.46, val_accuracy=0.657, lr=0.1]    29%|██▉       | 27/93 [12:47<29:54, 27.19s/epoch, loss=1.15, accuracy=0.751, val_loss=1.75, val_accuracy=0.56, lr=0.1]  30%|███       | 28/93 [13:14<29:27, 27.20s/epoch, loss=1.15, accuracy=0.754, val_loss=2.73, val_accuracy=0.351, lr=0.1] 31%|███       | 29/93 [13:42<29:06, 27.29s/epoch, loss=1.16, accuracy=0.75, val_loss=2.31, val_accuracy=0.353, lr=0.1]  32%|███▏      | 30/93 [14:09<28:40, 27.31s/epoch, loss=1.15, accuracy=0.753, val_loss=2.19, val_accuracy=0.423, lr=0.0316] 33%|███▎      | 31/93 [14:37<28:17, 27.38s/epoch, loss=1.16, accuracy=0.752, val_loss=2.1, val_accuracy=0.449, lr=0.1]     34%|███▍      | 32/93 [15:04<27:50, 27.39s/epoch, loss=1.15, accuracy=0.753, val_loss=3.46, val_accuracy=0.282, lr=0.1] 35%|███▌      | 33/93 [15:31<27:22, 27.38s/epoch, loss=1.15, accuracy=0.75, val_loss=2.69, val_accuracy=0.249, lr=0.1]  37%|███▋      | 34/93 [15:59<26:53, 27.36s/epoch, loss=1.16, accuracy=0.75, val_loss=1.56, val_accuracy=0.61, lr=0.1]  38%|███▊      | 35/93 [16:26<26:24, 27.32s/epoch, loss=1.14, accuracy=0.754, val_loss=1.62, val_accuracy=0.595, lr=0.0316] 39%|███▊      | 36/93 [16:53<26:02, 27.40s/epoch, loss=1.14, accuracy=0.755, val_loss=1.75, val_accuracy=0.57, lr=0.1]     40%|███▉      | 37/93 [17:21<25:33, 27.38s/epoch, loss=1.14, accuracy=0.754, val_loss=1.75, val_accuracy=0.543, lr=0.1] 41%|████      | 38/93 [17:48<25:01, 27.30s/epoch, loss=1.15, accuracy=0.75, val_loss=2, val_accuracy=0.456, lr=0.1]     42%|████▏     | 39/93 [18:15<24:36, 27.34s/epoch, loss=1.15, accuracy=0.755, val_loss=2.09, val_accuracy=0.534, lr=0.1] 43%|████▎     | 40/93 [18:43<24:07, 27.31s/epoch, loss=1.14, accuracy=0.754, val_loss=2.18, val_accuracy=0.416, lr=0.0316] 44%|████▍     | 41/93 [19:10<23:41, 27.33s/epoch, loss=1.14, accuracy=0.753, val_loss=2.73, val_accuracy=0.379, lr=0.1]    45%|████▌     | 42/93 [19:37<23:11, 27.27s/epoch, loss=1.14, accuracy=0.757, val_loss=1.66, val_accuracy=0.583, lr=0.1] 46%|████▌     | 43/93 [20:04<22:42, 27.25s/epoch, loss=1.15, accuracy=0.753, val_loss=2.36, val_accuracy=0.41, lr=0.1]  47%|████▋     | 44/93 [20:31<22:12, 27.19s/epoch, loss=1.14, accuracy=0.755, val_loss=1.96, val_accuracy=0.495, lr=0.1] 48%|████▊     | 45/93 [20:59<21:46, 27.21s/epoch, loss=1.14, accuracy=0.755, val_loss=1.87, val_accuracy=0.547, lr=0.0316] 49%|████▉     | 46/93 [21:26<21:17, 27.18s/epoch, loss=1.14, accuracy=0.754, val_loss=2.87, val_accuracy=0.398, lr=0.1]    51%|█████     | 47/93 [21:53<20:52, 27.24s/epoch, loss=1.14, accuracy=0.757, val_loss=1.69, val_accuracy=0.577, lr=0.1] 52%|█████▏    | 48/93 [22:20<20:24, 27.21s/epoch, loss=1.14, accuracy=0.76, val_loss=1.79, val_accuracy=0.522, lr=0.1]  53%|█████▎    | 49/93 [22:47<19:58, 27.24s/epoch, loss=1.13, accuracy=0.757, val_loss=1.99, val_accuracy=0.531, lr=0.1] 54%|█████▍    | 50/93 [23:15<19:31, 27.24s/epoch, loss=1.14, accuracy=0.756, val_loss=2.67, val_accuracy=0.401, lr=0.0316] 55%|█████▍    | 51/93 [23:42<19:03, 27.22s/epoch, loss=1.13, accuracy=0.757, val_loss=3.44, val_accuracy=0.156, lr=0.1]    56%|█████▌    | 52/93 [24:09<18:35, 27.20s/epoch, loss=1.13, accuracy=0.758, val_loss=2.83, val_accuracy=0.417, lr=0.1] 57%|█████▋    | 53/93 [24:36<18:09, 27.23s/epoch, loss=1.13, accuracy=0.757, val_loss=2.53, val_accuracy=0.426, lr=0.1] 58%|█████▊    | 54/93 [25:04<17:42, 27.25s/epoch, loss=1.13, accuracy=0.758, val_loss=2.32, val_accuracy=0.524, lr=0.1] 59%|█████▉    | 55/93 [25:31<17:14, 27.23s/epoch, loss=1.14, accuracy=0.755, val_loss=2.31, val_accuracy=0.39, lr=0.0316] 60%|██████    | 56/93 [25:58<16:46, 27.19s/epoch, loss=1.13, accuracy=0.758, val_loss=2.63, val_accuracy=0.463, lr=0.1]   61%|██████▏   | 57/93 [26:25<16:19, 27.21s/epoch, loss=1.13, accuracy=0.758, val_loss=2.07, val_accuracy=0.502, lr=0.1] 62%|██████▏   | 58/93 [26:52<15:51, 27.18s/epoch, loss=1.13, accuracy=0.757, val_loss=1.57, val_accuracy=0.64, lr=0.1]  63%|██████▎   | 59/93 [27:19<15:23, 27.15s/epoch, loss=1.13, accuracy=0.757, val_loss=1.73, val_accuracy=0.554, lr=0.1] 65%|██████▍   | 60/93 [27:46<14:55, 27.13s/epoch, loss=1.12, accuracy=0.758, val_loss=1.96, val_accuracy=0.507, lr=0.0316] 66%|██████▌   | 61/93 [28:14<14:27, 27.11s/epoch, loss=1.13, accuracy=0.759, val_loss=2.16, val_accuracy=0.525, lr=0.1]    67%|██████▋   | 62/93 [28:41<14:01, 27.15s/epoch, loss=1.13, accuracy=0.756, val_loss=2.65, val_accuracy=0.441, lr=0.1] 68%|██████▊   | 63/93 [29:08<13:33, 27.11s/epoch, loss=1.13, accuracy=0.758, val_loss=1.69, val_accuracy=0.579, lr=0.1] 69%|██████▉   | 64/93 [29:35<13:06, 27.11s/epoch, loss=1.13, accuracy=0.758, val_loss=1.94, val_accuracy=0.536, lr=0.1] 70%|██████▉   | 65/93 [30:02<12:38, 27.10s/epoch, loss=1.13, accuracy=0.759, val_loss=1.58, val_accuracy=0.621, lr=0.0316] 71%|███████   | 66/93 [30:28<12:05, 26.88s/epoch, loss=1.12, accuracy=0.758, val_loss=3.38, val_accuracy=0.379, lr=0.1]    72%|███████▏  | 67/93 [30:55<11:38, 26.87s/epoch, loss=1.12, accuracy=0.758, val_loss=1.43, val_accuracy=0.659, lr=0.1] 73%|███████▎  | 68/93 [31:22<11:14, 26.98s/epoch, loss=1.12, accuracy=0.761, val_loss=1.43, val_accuracy=0.664, lr=0.1] 74%|███████▍  | 69/93 [31:49<10:48, 27.00s/epoch, loss=1.12, accuracy=0.758, val_loss=2.76, val_accuracy=0.279, lr=0.1] 75%|███████▌  | 70/93 [32:17<10:22, 27.06s/epoch, loss=1.13, accuracy=0.758, val_loss=1.66, val_accuracy=0.604, lr=0.0316] 76%|███████▋  | 71/93 [32:44<09:54, 27.03s/epoch, loss=1.13, accuracy=0.758, val_loss=2.21, val_accuracy=0.489, lr=0.1]    77%|███████▋  | 72/93 [33:11<09:28, 27.07s/epoch, loss=1.13, accuracy=0.76, val_loss=3.12, val_accuracy=0.32, lr=0.1]   78%|███████▊  | 73/93 [33:38<09:01, 27.08s/epoch, loss=1.13, accuracy=0.76, val_loss=3.88, val_accuracy=0.329, lr=0.1] 80%|███████▉  | 74/93 [34:05<08:34, 27.07s/epoch, loss=1.13, accuracy=0.76, val_loss=2.6, val_accuracy=0.403, lr=0.1]  81%|████████  | 75/93 [34:32<08:07, 27.07s/epoch, loss=1.13, accuracy=0.756, val_loss=2.84, val_accuracy=0.438, lr=0.0316] 82%|████████▏ | 76/93 [34:59<07:39, 27.04s/epoch, loss=1.12, accuracy=0.76, val_loss=2.06, val_accuracy=0.497, lr=0.1]     83%|████████▎ | 77/93 [35:26<07:12, 27.05s/epoch, loss=1.13, accuracy=0.76, val_loss=2.28, val_accuracy=0.525, lr=0.1] 84%|████████▍ | 78/93 [35:53<06:44, 26.99s/epoch, loss=1.13, accuracy=0.758, val_loss=2.2, val_accuracy=0.39, lr=0.1]  85%|████████▍ | 79/93 [36:20<06:17, 26.99s/epoch, loss=1.13, accuracy=0.758, val_loss=1.66, val_accuracy=0.613, lr=0.1] 86%|████████▌ | 80/93 [36:47<05:50, 26.97s/epoch, loss=1.13, accuracy=0.762, val_loss=4.49, val_accuracy=0.21, lr=0.0316] 87%|████████▋ | 81/93 [37:14<05:24, 27.00s/epoch, loss=1.13, accuracy=0.759, val_loss=2.22, val_accuracy=0.485, lr=0.1]   88%|████████▊ | 82/93 [37:42<04:59, 27.25s/epoch, loss=0.925, accuracy=0.818, val_loss=0.911, val_accuracy=0.805, lr=0.01] 89%|████████▉ | 83/93 [38:09<04:32, 27.26s/epoch, loss=0.741, accuracy=0.852, val_loss=0.819, val_accuracy=0.81, lr=0.01]  90%|█████████ | 84/93 [38:36<04:05, 27.23s/epoch, loss=0.659, accuracy=0.86, val_loss=0.76, val_accuracy=0.817, lr=0.01]  91%|█████████▏| 85/93 [39:03<03:37, 27.13s/epoch, loss=0.61, accuracy=0.865, val_loss=0.771, val_accuracy=0.809, lr=0.01] 92%|█████████▏| 86/93 [39:30<03:09, 27.10s/epoch, loss=0.582, accuracy=0.866, val_loss=0.745, val_accuracy=0.804, lr=0.01] 94%|█████████▎| 87/93 [39:57<02:42, 27.11s/epoch, loss=0.571, accuracy=0.865, val_loss=0.762, val_accuracy=0.8, lr=0.01]   95%|█████████▍| 88/93 [40:24<02:15, 27.09s/epoch, loss=0.565, accuracy=0.867, val_loss=0.936, val_accuracy=0.749, lr=0.01] 96%|█████████▌| 89/93 [40:51<01:48, 27.09s/epoch, loss=0.558, accuracy=0.868, val_loss=0.78, val_accuracy=0.799, lr=0.01]  97%|█████████▋| 90/93 [41:18<01:21, 27.07s/epoch, loss=0.55, accuracy=0.87, val_loss=1.13, val_accuracy=0.713, lr=0.01]   98%|█████████▊| 91/93 [41:46<00:54, 27.09s/epoch, loss=0.554, accuracy=0.872, val_loss=0.916, val_accuracy=0.752, lr=0.00316] 99%|█████████▉| 92/93 [42:13<00:27, 27.11s/epoch, loss=0.55, accuracy=0.874, val_loss=0.866, val_accuracy=0.779, lr=0.01]    100%|██████████| 93/93 [42:40<00:00, 27.10s/epoch, loss=0.551, accuracy=0.874, val_loss=0.778, val_accuracy=0.798, lr=0.01]100%|██████████| 93/93 [42:40<00:00, 27.53s/epoch, loss=0.551, accuracy=0.874, val_loss=0.778, val_accuracy=0.798, lr=0.01]
Using real-time data augmentation.
Test score: 0.7472914457321167
Test accuracy: 0.8191999793052673


* * * Run SGD for ID = 16_3. * * *


2024-02-19 23:30:41.552412: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 23:30:44.370526: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-19 23:30:44.371895: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-19 23:30:44.413670: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-19 23:30:44.413723: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 23:30:44.417062: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-19 23:30:44.417172: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-19 23:30:44.419736: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-19 23:30:44.420509: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-19 23:30:44.423079: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-19 23:30:44.424785: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-19 23:30:44.430064: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-19 23:30:44.430789: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-19 23:30:44.430893: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-19 23:30:45.869777: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-19 23:30:45.870426: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-19 23:30:45.871539: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-19 23:30:45.871578: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 23:30:45.871630: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-19 23:30:45.871651: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-19 23:30:45.871672: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-19 23:30:45.871692: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-19 23:30:45.871715: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-19 23:30:45.871738: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-19 23:30:45.871761: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-19 23:30:45.872348: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-19 23:30:45.872385: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 23:30:46.526345: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-19 23:30:46.526400: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-19 23:30:46.526410: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-19 23:30:46.527532: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:18:00.0, compute capability: 6.1)
{'id': '16_03', 'batch_size': 128, 'epochs': 93, 'validation_split': 0.1, 'checkpointing': True, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
x_train shape: (45000, 32, 32, 3)
45000 train samples
5000 validation samples
10000 test samples
y_train shape: (45000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/93 [00:00<?, ?epoch/s]2024-02-19 23:30:47.437724: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-19 23:30:47.449932: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-02-19 23:30:49.540078: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-19 23:30:49.857495: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-19 23:30:50.777825: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-19 23:30:50.816569: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/93 [00:54<1:23:38, 54.55s/epoch, loss=3.39, accuracy=0.241, val_loss=2.43, val_accuracy=0.21, lr=0.1]  2%|▏         | 2/93 [01:21<58:09, 38.34s/epoch, loss=1.65, accuracy=0.489, val_loss=2.57, val_accuracy=0.32, lr=0.1]    3%|▎         | 3/93 [01:47<49:04, 32.72s/epoch, loss=1.43, accuracy=0.59, val_loss=1.82, val_accuracy=0.488, lr=0.1]  4%|▍         | 4/93 [02:12<44:01, 29.68s/epoch, loss=1.34, accuracy=0.646, val_loss=3.24, val_accuracy=0.322, lr=0.1]  5%|▌         | 5/93 [02:38<41:17, 28.16s/epoch, loss=1.3, accuracy=0.672, val_loss=1.88, val_accuracy=0.49, lr=0.1]    6%|▋         | 6/93 [03:03<39:15, 27.07s/epoch, loss=1.29, accuracy=0.684, val_loss=2.28, val_accuracy=0.412, lr=0.1]  8%|▊         | 7/93 [03:28<37:57, 26.49s/epoch, loss=1.26, accuracy=0.7, val_loss=1.84, val_accuracy=0.515, lr=0.1]    9%|▊         | 8/93 [03:52<36:38, 25.87s/epoch, loss=1.24, accuracy=0.709, val_loss=2.69, val_accuracy=0.397, lr=0.0316] 10%|▉         | 9/93 [04:17<35:47, 25.56s/epoch, loss=1.22, accuracy=0.714, val_loss=2.72, val_accuracy=0.433, lr=0.1]    11%|█         | 10/93 [04:42<35:11, 25.44s/epoch, loss=1.22, accuracy=0.719, val_loss=1.66, val_accuracy=0.568, lr=0.1] 12%|█▏        | 11/93 [05:07<34:28, 25.23s/epoch, loss=1.21, accuracy=0.725, val_loss=1.67, val_accuracy=0.56, lr=0.1]  13%|█▎        | 12/93 [05:33<34:10, 25.32s/epoch, loss=1.2, accuracy=0.73, val_loss=1.71, val_accuracy=0.583, lr=0.1]  14%|█▍        | 13/93 [05:59<34:14, 25.68s/epoch, loss=1.2, accuracy=0.731, val_loss=1.75, val_accuracy=0.533, lr=0.1] 15%|█▌        | 14/93 [06:25<33:54, 25.75s/epoch, loss=1.19, accuracy=0.737, val_loss=3.82, val_accuracy=0.192, lr=0.1] 16%|█▌        | 15/93 [06:50<33:12, 25.55s/epoch, loss=1.18, accuracy=0.737, val_loss=2.43, val_accuracy=0.466, lr=0.0316] 17%|█▋        | 16/93 [07:15<32:33, 25.37s/epoch, loss=1.18, accuracy=0.737, val_loss=1.41, val_accuracy=0.67, lr=0.1]     18%|█▊        | 17/93 [07:40<32:00, 25.28s/epoch, loss=1.18, accuracy=0.741, val_loss=2.44, val_accuracy=0.421, lr=0.1] 19%|█▉        | 18/93 [08:05<31:23, 25.12s/epoch, loss=1.17, accuracy=0.742, val_loss=3.25, val_accuracy=0.306, lr=0.1] 20%|██        | 19/93 [08:30<30:51, 25.02s/epoch, loss=1.16, accuracy=0.746, val_loss=2.03, val_accuracy=0.532, lr=0.1] 22%|██▏       | 20/93 [08:55<30:28, 25.04s/epoch, loss=1.16, accuracy=0.744, val_loss=1.69, val_accuracy=0.595, lr=0.1] 23%|██▎       | 21/93 [09:20<29:59, 24.99s/epoch, loss=1.17, accuracy=0.743, val_loss=3.25, val_accuracy=0.373, lr=0.0316] 24%|██▎       | 22/93 [09:45<29:36, 25.02s/epoch, loss=1.16, accuracy=0.746, val_loss=2.33, val_accuracy=0.326, lr=0.1]    25%|██▍       | 23/93 [10:10<29:12, 25.04s/epoch, loss=1.16, accuracy=0.747, val_loss=2.93, val_accuracy=0.318, lr=0.1] 26%|██▌       | 24/93 [10:35<28:53, 25.12s/epoch, loss=1.15, accuracy=0.749, val_loss=1.88, val_accuracy=0.593, lr=0.1] 27%|██▋       | 25/93 [11:00<28:21, 25.02s/epoch, loss=1.15, accuracy=0.748, val_loss=5.31, val_accuracy=0.257, lr=0.1] 28%|██▊       | 26/93 [11:26<28:06, 25.18s/epoch, loss=1.15, accuracy=0.748, val_loss=3.24, val_accuracy=0.388, lr=0.0316] 29%|██▉       | 27/93 [11:51<27:49, 25.29s/epoch, loss=1.15, accuracy=0.748, val_loss=1.91, val_accuracy=0.542, lr=0.1]    30%|███       | 28/93 [12:16<27:17, 25.20s/epoch, loss=1.14, accuracy=0.749, val_loss=1.53, val_accuracy=0.613, lr=0.1] 31%|███       | 29/93 [12:41<26:52, 25.19s/epoch, loss=1.14, accuracy=0.749, val_loss=5.47, val_accuracy=0.275, lr=0.1] 32%|███▏      | 30/93 [13:06<26:18, 25.05s/epoch, loss=1.15, accuracy=0.747, val_loss=2.11, val_accuracy=0.461, lr=0.1] 33%|███▎      | 31/93 [13:31<25:56, 25.10s/epoch, loss=1.15, accuracy=0.75, val_loss=2.95, val_accuracy=0.412, lr=0.0316] 34%|███▍      | 32/93 [13:56<25:30, 25.09s/epoch, loss=1.14, accuracy=0.751, val_loss=1.5, val_accuracy=0.632, lr=0.1]    35%|███▌      | 33/93 [14:21<24:58, 24.98s/epoch, loss=1.13, accuracy=0.753, val_loss=1.85, val_accuracy=0.515, lr=0.1] 37%|███▋      | 34/93 [14:47<24:44, 25.16s/epoch, loss=1.14, accuracy=0.752, val_loss=2.14, val_accuracy=0.521, lr=0.1] 38%|███▊      | 35/93 [15:12<24:18, 25.14s/epoch, loss=1.14, accuracy=0.75, val_loss=2.64, val_accuracy=0.381, lr=0.1]  39%|███▊      | 36/93 [15:37<23:57, 25.22s/epoch, loss=1.14, accuracy=0.749, val_loss=2.02, val_accuracy=0.457, lr=0.0316] 40%|███▉      | 37/93 [16:04<23:58, 25.68s/epoch, loss=1.14, accuracy=0.753, val_loss=1.51, val_accuracy=0.62, lr=0.1]     41%|████      | 38/93 [16:29<23:25, 25.56s/epoch, loss=1.14, accuracy=0.752, val_loss=2.08, val_accuracy=0.464, lr=0.1] 42%|████▏     | 39/93 [16:54<22:51, 25.40s/epoch, loss=1.13, accuracy=0.754, val_loss=3.25, val_accuracy=0.377, lr=0.1] 43%|████▎     | 40/93 [17:19<22:20, 25.30s/epoch, loss=1.14, accuracy=0.751, val_loss=1.7, val_accuracy=0.576, lr=0.1]  44%|████▍     | 41/93 [17:44<21:50, 25.21s/epoch, loss=1.13, accuracy=0.754, val_loss=1.41, val_accuracy=0.664, lr=0.0316] 45%|████▌     | 42/93 [18:09<21:16, 25.04s/epoch, loss=1.13, accuracy=0.755, val_loss=2.71, val_accuracy=0.4, lr=0.1]      46%|████▌     | 43/93 [18:34<20:49, 24.99s/epoch, loss=1.12, accuracy=0.757, val_loss=1.69, val_accuracy=0.567, lr=0.1] 47%|████▋     | 44/93 [18:59<20:26, 25.02s/epoch, loss=1.12, accuracy=0.756, val_loss=1.76, val_accuracy=0.558, lr=0.1] 48%|████▊     | 45/93 [19:24<20:00, 25.01s/epoch, loss=1.12, accuracy=0.755, val_loss=2.76, val_accuracy=0.347, lr=0.1] 49%|████▉     | 46/93 [19:48<19:30, 24.90s/epoch, loss=1.12, accuracy=0.755, val_loss=5.65, val_accuracy=0.167, lr=0.0316] 51%|█████     | 47/93 [20:13<19:03, 24.86s/epoch, loss=1.12, accuracy=0.758, val_loss=1.78, val_accuracy=0.523, lr=0.1]    52%|█████▏    | 48/93 [20:38<18:39, 24.88s/epoch, loss=1.13, accuracy=0.753, val_loss=1.92, val_accuracy=0.479, lr=0.1] 53%|█████▎    | 49/93 [21:03<18:14, 24.88s/epoch, loss=1.13, accuracy=0.755, val_loss=2.05, val_accuracy=0.547, lr=0.1] 54%|█████▍    | 50/93 [21:28<17:48, 24.86s/epoch, loss=1.12, accuracy=0.756, val_loss=2.73, val_accuracy=0.383, lr=0.1] 55%|█████▍    | 51/93 [21:52<17:20, 24.79s/epoch, loss=1.12, accuracy=0.756, val_loss=2.49, val_accuracy=0.462, lr=0.0316] 56%|█████▌    | 52/93 [22:17<16:55, 24.76s/epoch, loss=1.12, accuracy=0.757, val_loss=1.61, val_accuracy=0.602, lr=0.1]    57%|█████▋    | 53/93 [22:43<16:48, 25.22s/epoch, loss=1.12, accuracy=0.755, val_loss=1.97, val_accuracy=0.552, lr=0.1] 58%|█████▊    | 54/93 [23:08<16:16, 25.05s/epoch, loss=1.12, accuracy=0.757, val_loss=2.08, val_accuracy=0.407, lr=0.1] 59%|█████▉    | 55/93 [23:35<16:18, 25.75s/epoch, loss=1.12, accuracy=0.757, val_loss=1.76, val_accuracy=0.565, lr=0.1] 60%|██████    | 56/93 [24:02<15:57, 25.87s/epoch, loss=1.12, accuracy=0.755, val_loss=1.48, val_accuracy=0.637, lr=0.0316] 61%|██████▏   | 57/93 [24:27<15:30, 25.85s/epoch, loss=1.12, accuracy=0.757, val_loss=2.14, val_accuracy=0.422, lr=0.1]    62%|██████▏   | 58/93 [24:52<14:54, 25.57s/epoch, loss=1.11, accuracy=0.757, val_loss=2.55, val_accuracy=0.387, lr=0.1] 63%|██████▎   | 59/93 [25:18<14:32, 25.67s/epoch, loss=1.12, accuracy=0.756, val_loss=1.56, val_accuracy=0.578, lr=0.1] 65%|██████▍   | 60/93 [25:43<14:01, 25.49s/epoch, loss=1.12, accuracy=0.759, val_loss=2.6, val_accuracy=0.314, lr=0.1]  66%|██████▌   | 61/93 [26:08<13:31, 25.35s/epoch, loss=1.11, accuracy=0.759, val_loss=1.79, val_accuracy=0.544, lr=0.0316] 67%|██████▋   | 62/93 [26:33<12:58, 25.12s/epoch, loss=1.11, accuracy=0.758, val_loss=1.66, val_accuracy=0.604, lr=0.1]    68%|██████▊   | 63/93 [26:58<12:33, 25.13s/epoch, loss=1.11, accuracy=0.758, val_loss=1.77, val_accuracy=0.564, lr=0.1] 69%|██████▉   | 64/93 [27:23<12:08, 25.13s/epoch, loss=1.11, accuracy=0.758, val_loss=1.78, val_accuracy=0.571, lr=0.1] 70%|██████▉   | 65/93 [27:48<11:41, 25.05s/epoch, loss=1.11, accuracy=0.757, val_loss=1.52, val_accuracy=0.598, lr=0.1] 71%|███████   | 66/93 [28:13<11:17, 25.09s/epoch, loss=1.12, accuracy=0.757, val_loss=1.91, val_accuracy=0.548, lr=0.0316] 72%|███████▏  | 67/93 [28:38<10:49, 24.99s/epoch, loss=1.11, accuracy=0.76, val_loss=1.86, val_accuracy=0.536, lr=0.1]     73%|███████▎  | 68/93 [29:03<10:23, 24.92s/epoch, loss=1.11, accuracy=0.758, val_loss=1.67, val_accuracy=0.537, lr=0.1] 74%|███████▍  | 69/93 [29:28<09:59, 25.00s/epoch, loss=1.11, accuracy=0.757, val_loss=2.44, val_accuracy=0.459, lr=0.1] 75%|███████▌  | 70/93 [29:53<09:33, 24.94s/epoch, loss=1.11, accuracy=0.756, val_loss=1.9, val_accuracy=0.495, lr=0.1]  76%|███████▋  | 71/93 [30:18<09:08, 24.93s/epoch, loss=1.11, accuracy=0.758, val_loss=1.75, val_accuracy=0.532, lr=0.0316] 77%|███████▋  | 72/93 [30:43<08:43, 24.93s/epoch, loss=1.11, accuracy=0.76, val_loss=1.75, val_accuracy=0.597, lr=0.1]     78%|███████▊  | 73/93 [31:07<08:17, 24.90s/epoch, loss=1.11, accuracy=0.759, val_loss=4.46, val_accuracy=0.334, lr=0.1] 80%|███████▉  | 74/93 [31:32<07:53, 24.93s/epoch, loss=1.11, accuracy=0.755, val_loss=3.61, val_accuracy=0.305, lr=0.1] 81%|████████  | 75/93 [31:58<07:31, 25.09s/epoch, loss=1.12, accuracy=0.757, val_loss=2.4, val_accuracy=0.464, lr=0.1]  82%|████████▏ | 76/93 [32:23<07:06, 25.07s/epoch, loss=1.11, accuracy=0.757, val_loss=3.51, val_accuracy=0.349, lr=0.0316] 83%|████████▎ | 77/93 [32:48<06:40, 25.02s/epoch, loss=1.12, accuracy=0.756, val_loss=1.63, val_accuracy=0.567, lr=0.1]    84%|████████▍ | 78/93 [33:13<06:16, 25.09s/epoch, loss=1.12, accuracy=0.757, val_loss=1.6, val_accuracy=0.593, lr=0.1]  85%|████████▍ | 79/93 [33:39<05:53, 25.27s/epoch, loss=1.11, accuracy=0.758, val_loss=1.89, val_accuracy=0.566, lr=0.1] 86%|████████▌ | 80/93 [34:04<05:28, 25.27s/epoch, loss=1.11, accuracy=0.759, val_loss=2.4, val_accuracy=0.452, lr=0.1]  87%|████████▋ | 81/93 [34:29<05:03, 25.30s/epoch, loss=1.12, accuracy=0.757, val_loss=2.42, val_accuracy=0.442, lr=0.0316] 88%|████████▊ | 82/93 [34:55<04:38, 25.30s/epoch, loss=0.925, accuracy=0.812, val_loss=0.921, val_accuracy=0.799, lr=0.01] 89%|████████▉ | 83/93 [35:20<04:12, 25.21s/epoch, loss=0.743, accuracy=0.847, val_loss=0.866, val_accuracy=0.797, lr=0.01] 90%|█████████ | 84/93 [35:45<03:47, 25.31s/epoch, loss=0.663, accuracy=0.854, val_loss=0.733, val_accuracy=0.825, lr=0.01] 91%|█████████▏| 85/93 [36:10<03:20, 25.06s/epoch, loss=0.616, accuracy=0.859, val_loss=0.771, val_accuracy=0.816, lr=0.01] 92%|█████████▏| 86/93 [36:35<02:55, 25.07s/epoch, loss=0.589, accuracy=0.862, val_loss=0.785, val_accuracy=0.789, lr=0.01] 94%|█████████▎| 87/93 [36:59<02:29, 24.92s/epoch, loss=0.571, accuracy=0.864, val_loss=0.775, val_accuracy=0.8, lr=0.01]   95%|█████████▍| 88/93 [37:24<02:04, 24.81s/epoch, loss=0.563, accuracy=0.865, val_loss=0.733, val_accuracy=0.814, lr=0.01] 96%|█████████▌| 89/93 [37:49<01:39, 24.78s/epoch, loss=0.561, accuracy=0.866, val_loss=0.79, val_accuracy=0.796, lr=0.01]  97%|█████████▋| 90/93 [38:13<01:14, 24.76s/epoch, loss=0.56, accuracy=0.866, val_loss=0.968, val_accuracy=0.731, lr=0.01] 98%|█████████▊| 91/93 [38:38<00:49, 24.75s/epoch, loss=0.552, accuracy=0.87, val_loss=1.1, val_accuracy=0.733, lr=0.01]   99%|█████████▉| 92/93 [39:03<00:24, 24.76s/epoch, loss=0.553, accuracy=0.869, val_loss=0.872, val_accuracy=0.776, lr=0.01]100%|██████████| 93/93 [39:27<00:00, 24.75s/epoch, loss=0.547, accuracy=0.872, val_loss=0.802, val_accuracy=0.794, lr=0.00316]100%|██████████| 93/93 [39:27<00:00, 25.46s/epoch, loss=0.547, accuracy=0.872, val_loss=0.802, val_accuracy=0.794, lr=0.00316]
Using real-time data augmentation.
Test score: 0.7654872536659241
Test accuracy: 0.8131999969482422


* * * Run SGD for ID = 16_4. * * *


2024-02-20 00:10:23.131368: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 00:10:25.787914: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 00:10:25.789424: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-20 00:10:25.832073: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-20 00:10:25.832122: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 00:10:25.835790: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 00:10:25.835886: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-20 00:10:25.838782: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-20 00:10:25.839667: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-20 00:10:25.842523: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-20 00:10:25.844531: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-20 00:10:25.850776: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 00:10:25.851672: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-20 00:10:25.851775: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 00:10:27.259974: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-20 00:10:27.260647: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 00:10:27.261206: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-20 00:10:27.261242: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 00:10:27.261280: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 00:10:27.261295: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-20 00:10:27.261309: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-20 00:10:27.261323: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-20 00:10:27.261337: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-20 00:10:27.261352: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-20 00:10:27.261367: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 00:10:27.261952: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-20 00:10:27.261992: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 00:10:27.913152: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-20 00:10:27.913225: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-20 00:10:27.913235: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-20 00:10:27.914878: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:18:00.0, compute capability: 6.1)
{'id': '16_04', 'batch_size': 128, 'epochs': 93, 'validation_split': 0.1, 'checkpointing': True, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
x_train shape: (45000, 32, 32, 3)
45000 train samples
5000 validation samples
10000 test samples
y_train shape: (45000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/93 [00:00<?, ?epoch/s]2024-02-20 00:10:28.757440: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-20 00:10:28.770040: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-02-20 00:10:30.744239: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 00:10:31.102595: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 00:10:32.122443: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-20 00:10:32.169319: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/93 [00:55<1:25:36, 55.83s/epoch, loss=3.65, accuracy=0.298, val_loss=2.85, val_accuracy=0.191, lr=0.1]  2%|▏         | 2/93 [01:21<57:27, 37.89s/epoch, loss=1.74, accuracy=0.455, val_loss=1.92, val_accuracy=0.397, lr=0.1]    3%|▎         | 3/93 [01:46<48:09, 32.11s/epoch, loss=1.5, accuracy=0.556, val_loss=1.77, val_accuracy=0.495, lr=0.1]   4%|▍         | 4/93 [02:10<43:09, 29.09s/epoch, loss=1.35, accuracy=0.642, val_loss=1.82, val_accuracy=0.48, lr=0.1]  5%|▌         | 5/93 [02:35<40:30, 27.62s/epoch, loss=1.28, accuracy=0.682, val_loss=2.12, val_accuracy=0.455, lr=0.1]  6%|▋         | 6/93 [03:00<38:45, 26.73s/epoch, loss=1.25, accuracy=0.702, val_loss=2.76, val_accuracy=0.438, lr=0.1]  8%|▊         | 7/93 [03:26<37:36, 26.24s/epoch, loss=1.25, accuracy=0.711, val_loss=2.4, val_accuracy=0.405, lr=0.1]   9%|▊         | 8/93 [03:51<36:47, 25.97s/epoch, loss=1.23, accuracy=0.716, val_loss=1.83, val_accuracy=0.524, lr=0.0316] 10%|▉         | 9/93 [04:16<36:03, 25.75s/epoch, loss=1.22, accuracy=0.726, val_loss=1.47, val_accuracy=0.64, lr=0.1]     11%|█         | 10/93 [04:41<35:01, 25.32s/epoch, loss=1.22, accuracy=0.726, val_loss=2.81, val_accuracy=0.328, lr=0.1] 12%|█▏        | 11/93 [05:05<34:16, 25.07s/epoch, loss=1.21, accuracy=0.73, val_loss=2.04, val_accuracy=0.449, lr=0.1]  13%|█▎        | 12/93 [05:30<33:43, 24.99s/epoch, loss=1.21, accuracy=0.73, val_loss=3.95, val_accuracy=0.292, lr=0.1] 14%|█▍        | 13/93 [05:55<33:17, 24.97s/epoch, loss=1.21, accuracy=0.733, val_loss=2.29, val_accuracy=0.434, lr=0.1] 15%|█▌        | 14/93 [06:20<32:49, 24.93s/epoch, loss=1.2, accuracy=0.736, val_loss=2.3, val_accuracy=0.514, lr=0.0316] 16%|█▌        | 15/93 [06:44<32:11, 24.77s/epoch, loss=1.19, accuracy=0.741, val_loss=1.81, val_accuracy=0.548, lr=0.1]  17%|█▋        | 16/93 [07:09<31:46, 24.76s/epoch, loss=1.19, accuracy=0.74, val_loss=1.97, val_accuracy=0.474, lr=0.1]  18%|█▊        | 17/93 [07:34<31:30, 24.87s/epoch, loss=1.19, accuracy=0.739, val_loss=2.89, val_accuracy=0.349, lr=0.1] 19%|█▉        | 18/93 [07:59<30:58, 24.79s/epoch, loss=1.19, accuracy=0.741, val_loss=2.07, val_accuracy=0.434, lr=0.1] 20%|██        | 19/93 [08:23<30:30, 24.74s/epoch, loss=1.18, accuracy=0.745, val_loss=1.73, val_accuracy=0.563, lr=0.0316] 22%|██▏       | 20/93 [08:48<30:06, 24.75s/epoch, loss=1.18, accuracy=0.745, val_loss=2.18, val_accuracy=0.452, lr=0.1]    23%|██▎       | 21/93 [09:14<30:09, 25.13s/epoch, loss=1.18, accuracy=0.743, val_loss=2.41, val_accuracy=0.501, lr=0.1] 24%|██▎       | 22/93 [09:39<29:48, 25.19s/epoch, loss=1.18, accuracy=0.744, val_loss=1.55, val_accuracy=0.619, lr=0.1] 25%|██▍       | 23/93 [10:04<29:14, 25.07s/epoch, loss=1.17, accuracy=0.749, val_loss=2.44, val_accuracy=0.486, lr=0.1] 26%|██▌       | 24/93 [10:30<29:00, 25.23s/epoch, loss=1.17, accuracy=0.747, val_loss=1.48, val_accuracy=0.66, lr=0.0316] 27%|██▋       | 25/93 [10:54<28:19, 24.99s/epoch, loss=1.17, accuracy=0.747, val_loss=2.34, val_accuracy=0.471, lr=0.1]   28%|██▊       | 26/93 [11:19<27:47, 24.89s/epoch, loss=1.18, accuracy=0.748, val_loss=1.85, val_accuracy=0.564, lr=0.1] 29%|██▉       | 27/93 [11:44<27:26, 24.95s/epoch, loss=1.17, accuracy=0.748, val_loss=2.3, val_accuracy=0.467, lr=0.1]  30%|███       | 28/93 [12:09<27:06, 25.03s/epoch, loss=1.16, accuracy=0.747, val_loss=2.11, val_accuracy=0.535, lr=0.1] 31%|███       | 29/93 [12:34<26:40, 25.00s/epoch, loss=1.16, accuracy=0.75, val_loss=1.93, val_accuracy=0.504, lr=0.0316] 32%|███▏      | 30/93 [13:02<27:04, 25.78s/epoch, loss=1.16, accuracy=0.749, val_loss=2.03, val_accuracy=0.469, lr=0.1]   33%|███▎      | 31/93 [13:29<27:05, 26.22s/epoch, loss=1.16, accuracy=0.751, val_loss=2.92, val_accuracy=0.381, lr=0.1] 34%|███▍      | 32/93 [13:56<26:57, 26.51s/epoch, loss=1.16, accuracy=0.749, val_loss=4.42, val_accuracy=0.272, lr=0.1] 35%|███▌      | 33/93 [14:23<26:46, 26.77s/epoch, loss=1.15, accuracy=0.752, val_loss=1.86, val_accuracy=0.465, lr=0.1] 37%|███▋      | 34/93 [14:51<26:31, 26.98s/epoch, loss=1.16, accuracy=0.752, val_loss=1.86, val_accuracy=0.551, lr=0.0316] 38%|███▊      | 35/93 [15:18<26:12, 27.11s/epoch, loss=1.15, accuracy=0.753, val_loss=2.55, val_accuracy=0.397, lr=0.1]    39%|███▊      | 36/93 [15:46<25:51, 27.23s/epoch, loss=1.16, accuracy=0.752, val_loss=2.15, val_accuracy=0.417, lr=0.1] 40%|███▉      | 37/93 [16:13<25:16, 27.08s/epoch, loss=1.15, accuracy=0.754, val_loss=1.55, val_accuracy=0.617, lr=0.1] 41%|████      | 38/93 [16:40<24:56, 27.21s/epoch, loss=1.15, accuracy=0.753, val_loss=2.75, val_accuracy=0.327, lr=0.1] 42%|████▏     | 39/93 [17:07<24:27, 27.18s/epoch, loss=1.15, accuracy=0.751, val_loss=1.76, val_accuracy=0.55, lr=0.0316] 43%|████▎     | 40/93 [17:35<24:05, 27.27s/epoch, loss=1.15, accuracy=0.753, val_loss=1.43, val_accuracy=0.648, lr=0.1]   44%|████▍     | 41/93 [18:02<23:44, 27.40s/epoch, loss=1.15, accuracy=0.752, val_loss=1.53, val_accuracy=0.627, lr=0.1] 45%|████▌     | 42/93 [18:30<23:21, 27.48s/epoch, loss=1.15, accuracy=0.752, val_loss=1.37, val_accuracy=0.671, lr=0.1] 46%|████▌     | 43/93 [18:55<22:22, 26.85s/epoch, loss=1.15, accuracy=0.751, val_loss=1.97, val_accuracy=0.521, lr=0.1] 47%|████▋     | 44/93 [19:23<22:03, 27.00s/epoch, loss=1.14, accuracy=0.754, val_loss=1.67, val_accuracy=0.587, lr=0.1] 48%|████▊     | 45/93 [19:50<21:41, 27.11s/epoch, loss=1.14, accuracy=0.754, val_loss=2.4, val_accuracy=0.466, lr=0.1]  49%|████▉     | 46/93 [20:17<21:13, 27.11s/epoch, loss=1.15, accuracy=0.752, val_loss=1.93, val_accuracy=0.506, lr=0.1] 51%|█████     | 47/93 [20:44<20:47, 27.13s/epoch, loss=1.14, accuracy=0.756, val_loss=1.72, val_accuracy=0.591, lr=0.0316] 52%|█████▏    | 48/93 [21:12<20:22, 27.17s/epoch, loss=1.15, accuracy=0.754, val_loss=2.08, val_accuracy=0.521, lr=0.1]    53%|█████▎    | 49/93 [21:39<19:55, 27.16s/epoch, loss=1.15, accuracy=0.755, val_loss=2, val_accuracy=0.483, lr=0.1]    54%|█████▍    | 50/93 [22:06<19:30, 27.22s/epoch, loss=1.14, accuracy=0.755, val_loss=1.76, val_accuracy=0.527, lr=0.1] 55%|█████▍    | 51/93 [22:33<18:59, 27.13s/epoch, loss=1.14, accuracy=0.756, val_loss=1.69, val_accuracy=0.579, lr=0.1] 56%|█████▌    | 52/93 [23:00<18:34, 27.19s/epoch, loss=1.14, accuracy=0.756, val_loss=1.5, val_accuracy=0.635, lr=0.0316] 57%|█████▋    | 53/93 [23:28<18:09, 27.23s/epoch, loss=1.14, accuracy=0.754, val_loss=1.75, val_accuracy=0.564, lr=0.1]   58%|█████▊    | 54/93 [23:55<17:40, 27.19s/epoch, loss=1.14, accuracy=0.757, val_loss=2.1, val_accuracy=0.52, lr=0.1]   59%|█████▉    | 55/93 [24:22<17:12, 27.18s/epoch, loss=1.14, accuracy=0.755, val_loss=2.82, val_accuracy=0.471, lr=0.1] 60%|██████    | 56/93 [24:49<16:48, 27.25s/epoch, loss=1.15, accuracy=0.752, val_loss=2.57, val_accuracy=0.328, lr=0.1] 61%|██████▏   | 57/93 [25:17<16:21, 27.26s/epoch, loss=1.14, accuracy=0.756, val_loss=7.5, val_accuracy=0.161, lr=0.0316] 62%|██████▏   | 58/93 [25:43<15:46, 27.05s/epoch, loss=1.14, accuracy=0.757, val_loss=1.87, val_accuracy=0.482, lr=0.1]   63%|██████▎   | 59/93 [26:10<15:19, 27.05s/epoch, loss=1.14, accuracy=0.755, val_loss=3, val_accuracy=0.379, lr=0.1]    65%|██████▍   | 60/93 [26:38<14:55, 27.14s/epoch, loss=1.14, accuracy=0.757, val_loss=1.59, val_accuracy=0.595, lr=0.1] 66%|██████▌   | 61/93 [27:05<14:28, 27.16s/epoch, loss=1.14, accuracy=0.755, val_loss=1.55, val_accuracy=0.638, lr=0.1] 67%|██████▋   | 62/93 [27:32<14:00, 27.11s/epoch, loss=1.13, accuracy=0.756, val_loss=1.64, val_accuracy=0.599, lr=0.0316] 68%|██████▊   | 63/93 [27:59<13:34, 27.14s/epoch, loss=1.14, accuracy=0.758, val_loss=3.14, val_accuracy=0.388, lr=0.1]    69%|██████▉   | 64/93 [28:26<13:07, 27.14s/epoch, loss=1.13, accuracy=0.757, val_loss=1.72, val_accuracy=0.599, lr=0.1] 70%|██████▉   | 65/93 [28:53<12:39, 27.14s/epoch, loss=1.13, accuracy=0.759, val_loss=1.63, val_accuracy=0.597, lr=0.1] 71%|███████   | 66/93 [29:20<12:12, 27.12s/epoch, loss=1.13, accuracy=0.757, val_loss=2.7, val_accuracy=0.313, lr=0.1]  72%|███████▏  | 67/93 [29:48<11:45, 27.14s/epoch, loss=1.14, accuracy=0.757, val_loss=1.63, val_accuracy=0.556, lr=0.0316] 73%|███████▎  | 68/93 [30:15<11:18, 27.12s/epoch, loss=1.13, accuracy=0.757, val_loss=4.01, val_accuracy=0.172, lr=0.1]    74%|███████▍  | 69/93 [30:42<10:49, 27.07s/epoch, loss=1.13, accuracy=0.757, val_loss=2.41, val_accuracy=0.5, lr=0.1]   75%|███████▌  | 70/93 [31:09<10:23, 27.11s/epoch, loss=1.13, accuracy=0.76, val_loss=6.04, val_accuracy=0.164, lr=0.1] 76%|███████▋  | 71/93 [31:36<09:55, 27.07s/epoch, loss=1.13, accuracy=0.757, val_loss=1.95, val_accuracy=0.498, lr=0.1] 77%|███████▋  | 72/93 [32:03<09:29, 27.12s/epoch, loss=1.13, accuracy=0.757, val_loss=2.82, val_accuracy=0.418, lr=0.0316] 78%|███████▊  | 73/93 [32:30<09:02, 27.13s/epoch, loss=1.13, accuracy=0.757, val_loss=1.98, val_accuracy=0.58, lr=0.1]     80%|███████▉  | 74/93 [32:57<08:36, 27.16s/epoch, loss=1.13, accuracy=0.758, val_loss=2.67, val_accuracy=0.395, lr=0.1] 81%|████████  | 75/93 [33:25<08:09, 27.18s/epoch, loss=1.13, accuracy=0.758, val_loss=2.51, val_accuracy=0.413, lr=0.1] 82%|████████▏ | 76/93 [33:52<07:41, 27.14s/epoch, loss=1.13, accuracy=0.76, val_loss=3.16, val_accuracy=0.3, lr=0.1]    83%|████████▎ | 77/93 [34:19<07:14, 27.16s/epoch, loss=1.13, accuracy=0.757, val_loss=3.88, val_accuracy=0.271, lr=0.0316] 84%|████████▍ | 78/93 [34:46<06:47, 27.19s/epoch, loss=1.13, accuracy=0.758, val_loss=2.29, val_accuracy=0.437, lr=0.1]    85%|████████▍ | 79/93 [35:13<06:20, 27.16s/epoch, loss=1.13, accuracy=0.757, val_loss=1.47, val_accuracy=0.639, lr=0.1] 86%|████████▌ | 80/93 [35:40<05:53, 27.17s/epoch, loss=1.13, accuracy=0.758, val_loss=1.76, val_accuracy=0.535, lr=0.1] 87%|████████▋ | 81/93 [36:07<05:25, 27.09s/epoch, loss=1.13, accuracy=0.757, val_loss=2.33, val_accuracy=0.438, lr=0.1] 88%|████████▊ | 82/93 [36:35<04:59, 27.24s/epoch, loss=0.93, accuracy=0.815, val_loss=0.905, val_accuracy=0.807, lr=0.01] 89%|████████▉ | 83/93 [37:02<04:32, 27.27s/epoch, loss=0.749, accuracy=0.847, val_loss=0.793, val_accuracy=0.822, lr=0.01] 90%|█████████ | 84/93 [37:29<04:04, 27.15s/epoch, loss=0.667, accuracy=0.856, val_loss=0.765, val_accuracy=0.812, lr=0.01] 91%|█████████▏| 85/93 [37:56<03:37, 27.16s/epoch, loss=0.62, accuracy=0.861, val_loss=0.755, val_accuracy=0.814, lr=0.01]  92%|█████████▏| 86/93 [38:24<03:10, 27.25s/epoch, loss=0.591, accuracy=0.862, val_loss=0.698, val_accuracy=0.822, lr=0.01] 94%|█████████▎| 87/93 [38:51<02:43, 27.29s/epoch, loss=0.582, accuracy=0.863, val_loss=0.693, val_accuracy=0.828, lr=0.01] 95%|█████████▍| 88/93 [39:18<02:15, 27.19s/epoch, loss=0.571, accuracy=0.864, val_loss=0.884, val_accuracy=0.755, lr=0.01] 96%|█████████▌| 89/93 [39:45<01:48, 27.12s/epoch, loss=0.564, accuracy=0.865, val_loss=0.952, val_accuracy=0.737, lr=0.01] 97%|█████████▋| 90/93 [40:12<01:21, 27.17s/epoch, loss=0.565, accuracy=0.868, val_loss=1.07, val_accuracy=0.726, lr=0.01]  98%|█████████▊| 91/93 [40:39<00:54, 27.16s/epoch, loss=0.562, accuracy=0.868, val_loss=0.747, val_accuracy=0.811, lr=0.01] 99%|█████████▉| 92/93 [41:06<00:27, 27.07s/epoch, loss=0.559, accuracy=0.87, val_loss=1.44, val_accuracy=0.626, lr=0.00316]100%|██████████| 93/93 [41:34<00:00, 27.11s/epoch, loss=0.556, accuracy=0.873, val_loss=0.819, val_accuracy=0.79, lr=0.01]  100%|██████████| 93/93 [41:34<00:00, 26.82s/epoch, loss=0.556, accuracy=0.873, val_loss=0.819, val_accuracy=0.79, lr=0.01]
Using real-time data augmentation.
Test score: 0.7195241451263428
Test accuracy: 0.8154000043869019


* * * Run SGD for ID = 16_5. * * *


2024-02-20 00:52:09.807236: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 00:52:14.505344: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 00:52:14.506742: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-20 00:52:14.549970: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-20 00:52:14.550017: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 00:52:14.554340: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 00:52:14.554419: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-20 00:52:14.558260: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-20 00:52:14.559944: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-20 00:52:14.564123: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-20 00:52:14.566667: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-20 00:52:14.573332: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 00:52:14.574071: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-20 00:52:14.574182: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 00:52:16.042230: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-20 00:52:16.043386: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 00:52:16.045848: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-20 00:52:16.045897: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 00:52:16.045976: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 00:52:16.045992: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-20 00:52:16.046006: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-20 00:52:16.046020: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-20 00:52:16.046036: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-20 00:52:16.046051: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-20 00:52:16.046075: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 00:52:16.046682: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-20 00:52:16.046726: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 00:52:16.711048: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-20 00:52:16.711103: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-20 00:52:16.711113: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-20 00:52:16.712181: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:18:00.0, compute capability: 6.1)
{'id': '16_05', 'batch_size': 128, 'epochs': 93, 'validation_split': 0.1, 'checkpointing': True, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
x_train shape: (45000, 32, 32, 3)
45000 train samples
5000 validation samples
10000 test samples
y_train shape: (45000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/93 [00:00<?, ?epoch/s]2024-02-20 00:52:17.750230: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-20 00:52:17.762941: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-02-20 00:52:19.883452: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 00:52:20.239354: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 00:52:21.209877: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-20 00:52:21.252902: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/93 [01:00<1:32:16, 60.18s/epoch, loss=3.38, accuracy=0.259, val_loss=2.84, val_accuracy=0.151, lr=0.1]  2%|▏         | 2/93 [01:27<1:02:19, 41.09s/epoch, loss=1.67, accuracy=0.48, val_loss=2.28, val_accuracy=0.358, lr=0.1]   3%|▎         | 3/93 [01:55<52:10, 34.78s/epoch, loss=1.47, accuracy=0.575, val_loss=3.75, val_accuracy=0.27, lr=0.1]    4%|▍         | 4/93 [02:22<47:25, 31.97s/epoch, loss=1.39, accuracy=0.625, val_loss=1.88, val_accuracy=0.469, lr=0.1]  5%|▌         | 5/93 [02:49<44:19, 30.22s/epoch, loss=1.32, accuracy=0.661, val_loss=2.12, val_accuracy=0.463, lr=0.1]  6%|▋         | 6/93 [03:17<42:27, 29.28s/epoch, loss=1.29, accuracy=0.686, val_loss=2.66, val_accuracy=0.401, lr=0.1]  8%|▊         | 7/93 [03:44<41:04, 28.65s/epoch, loss=1.27, accuracy=0.699, val_loss=2.6, val_accuracy=0.424, lr=0.1]   9%|▊         | 8/93 [04:12<40:05, 28.30s/epoch, loss=1.25, accuracy=0.706, val_loss=1.48, val_accuracy=0.617, lr=0.1] 10%|▉         | 9/93 [04:39<39:07, 27.94s/epoch, loss=1.24, accuracy=0.714, val_loss=1.6, val_accuracy=0.592, lr=0.1]  11%|█         | 10/93 [05:06<38:12, 27.61s/epoch, loss=1.23, accuracy=0.722, val_loss=2.11, val_accuracy=0.415, lr=0.1] 12%|█▏        | 11/93 [05:34<37:48, 27.67s/epoch, loss=1.23, accuracy=0.722, val_loss=1.51, val_accuracy=0.626, lr=0.1] 13%|█▎        | 12/93 [06:01<37:10, 27.54s/epoch, loss=1.21, accuracy=0.727, val_loss=2.46, val_accuracy=0.385, lr=0.1] 14%|█▍        | 13/93 [06:28<36:38, 27.49s/epoch, loss=1.21, accuracy=0.73, val_loss=5.04, val_accuracy=0.273, lr=0.0316] 15%|█▌        | 14/93 [06:56<36:09, 27.46s/epoch, loss=1.21, accuracy=0.733, val_loss=2.55, val_accuracy=0.422, lr=0.1]   16%|█▌        | 15/93 [07:23<35:37, 27.40s/epoch, loss=1.2, accuracy=0.737, val_loss=1.71, val_accuracy=0.544, lr=0.1]  17%|█▋        | 16/93 [07:50<35:07, 27.37s/epoch, loss=1.19, accuracy=0.738, val_loss=1.84, val_accuracy=0.561, lr=0.1] 18%|█▊        | 17/93 [08:18<34:44, 27.43s/epoch, loss=1.19, accuracy=0.739, val_loss=1.86, val_accuracy=0.534, lr=0.1] 19%|█▉        | 18/93 [08:45<34:17, 27.44s/epoch, loss=1.19, accuracy=0.74, val_loss=1.93, val_accuracy=0.517, lr=0.0316] 20%|██        | 19/93 [09:13<33:53, 27.47s/epoch, loss=1.19, accuracy=0.742, val_loss=1.63, val_accuracy=0.59, lr=0.1]    22%|██▏       | 20/93 [09:40<33:25, 27.47s/epoch, loss=1.18, accuracy=0.742, val_loss=3.44, val_accuracy=0.394, lr=0.1] 23%|██▎       | 21/93 [10:08<32:55, 27.44s/epoch, loss=1.17, accuracy=0.742, val_loss=1.65, val_accuracy=0.57, lr=0.1]  24%|██▎       | 22/93 [10:35<32:26, 27.42s/epoch, loss=1.18, accuracy=0.743, val_loss=1.88, val_accuracy=0.469, lr=0.1] 25%|██▍       | 23/93 [11:02<31:53, 27.34s/epoch, loss=1.18, accuracy=0.746, val_loss=1.81, val_accuracy=0.585, lr=0.0316] 26%|██▌       | 24/93 [11:29<31:24, 27.31s/epoch, loss=1.17, accuracy=0.746, val_loss=2.12, val_accuracy=0.462, lr=0.1]    27%|██▋       | 25/93 [11:57<30:56, 27.30s/epoch, loss=1.18, accuracy=0.746, val_loss=3.33, val_accuracy=0.322, lr=0.1] 28%|██▊       | 26/93 [12:24<30:28, 27.29s/epoch, loss=1.18, accuracy=0.745, val_loss=1.74, val_accuracy=0.582, lr=0.1] 29%|██▉       | 27/93 [12:51<30:00, 27.28s/epoch, loss=1.17, accuracy=0.748, val_loss=3.07, val_accuracy=0.398, lr=0.1] 30%|███       | 28/93 [13:19<29:34, 27.30s/epoch, loss=1.17, accuracy=0.749, val_loss=2.76, val_accuracy=0.389, lr=0.0316] 31%|███       | 29/93 [13:46<29:05, 27.28s/epoch, loss=1.17, accuracy=0.744, val_loss=2.28, val_accuracy=0.397, lr=0.1]    32%|███▏      | 30/93 [14:13<28:34, 27.22s/epoch, loss=1.17, accuracy=0.749, val_loss=1.65, val_accuracy=0.596, lr=0.1] 33%|███▎      | 31/93 [14:40<28:06, 27.21s/epoch, loss=1.17, accuracy=0.748, val_loss=2.43, val_accuracy=0.459, lr=0.1] 34%|███▍      | 32/93 [15:08<27:46, 27.33s/epoch, loss=1.15, accuracy=0.753, val_loss=1.55, val_accuracy=0.64, lr=0.1]  35%|███▌      | 33/93 [15:35<27:14, 27.25s/epoch, loss=1.16, accuracy=0.751, val_loss=1.62, val_accuracy=0.573, lr=0.0316] 37%|███▋      | 34/93 [16:02<26:48, 27.26s/epoch, loss=1.17, accuracy=0.748, val_loss=1.78, val_accuracy=0.576, lr=0.1]    38%|███▊      | 35/93 [16:29<26:21, 27.26s/epoch, loss=1.16, accuracy=0.748, val_loss=1.97, val_accuracy=0.487, lr=0.1] 39%|███▊      | 36/93 [16:56<25:52, 27.23s/epoch, loss=1.16, accuracy=0.75, val_loss=1.74, val_accuracy=0.535, lr=0.1]  40%|███▉      | 37/93 [17:23<25:20, 27.16s/epoch, loss=1.16, accuracy=0.75, val_loss=2.36, val_accuracy=0.353, lr=0.1] 41%|████      | 38/93 [17:51<24:52, 27.14s/epoch, loss=1.16, accuracy=0.753, val_loss=2.53, val_accuracy=0.417, lr=0.0316] 42%|████▏     | 39/93 [18:18<24:23, 27.10s/epoch, loss=1.16, accuracy=0.75, val_loss=2.44, val_accuracy=0.454, lr=0.1]     43%|████▎     | 40/93 [18:45<23:59, 27.16s/epoch, loss=1.16, accuracy=0.75, val_loss=2, val_accuracy=0.493, lr=0.1]    44%|████▍     | 41/93 [19:12<23:33, 27.18s/epoch, loss=1.16, accuracy=0.753, val_loss=1.89, val_accuracy=0.506, lr=0.1] 45%|████▌     | 42/93 [19:39<23:08, 27.22s/epoch, loss=1.16, accuracy=0.751, val_loss=1.43, val_accuracy=0.672, lr=0.1] 46%|████▌     | 43/93 [20:06<22:35, 27.12s/epoch, loss=1.16, accuracy=0.75, val_loss=5.09, val_accuracy=0.318, lr=0.1]  47%|████▋     | 44/93 [20:33<22:08, 27.12s/epoch, loss=1.15, accuracy=0.75, val_loss=1.92, val_accuracy=0.494, lr=0.1] 48%|████▊     | 45/93 [21:00<21:41, 27.12s/epoch, loss=1.15, accuracy=0.751, val_loss=2.13, val_accuracy=0.473, lr=0.1] 49%|████▉     | 46/93 [21:28<21:15, 27.13s/epoch, loss=1.15, accuracy=0.752, val_loss=1.79, val_accuracy=0.515, lr=0.1] 51%|█████     | 47/93 [21:55<20:48, 27.15s/epoch, loss=1.15, accuracy=0.754, val_loss=1.67, val_accuracy=0.569, lr=0.0316] 52%|█████▏    | 48/93 [22:22<20:18, 27.09s/epoch, loss=1.15, accuracy=0.751, val_loss=3.27, val_accuracy=0.366, lr=0.1]    53%|█████▎    | 49/93 [22:49<19:53, 27.13s/epoch, loss=1.14, accuracy=0.752, val_loss=3.71, val_accuracy=0.277, lr=0.1] 54%|█████▍    | 50/93 [23:16<19:27, 27.15s/epoch, loss=1.14, accuracy=0.755, val_loss=2.82, val_accuracy=0.427, lr=0.1] 55%|█████▍    | 51/93 [23:43<19:01, 27.17s/epoch, loss=1.15, accuracy=0.749, val_loss=1.78, val_accuracy=0.55, lr=0.1]  56%|█████▌    | 52/93 [24:10<18:32, 27.13s/epoch, loss=1.15, accuracy=0.753, val_loss=2.06, val_accuracy=0.466, lr=0.0316] 57%|█████▋    | 53/93 [24:38<18:06, 27.16s/epoch, loss=1.14, accuracy=0.752, val_loss=1.66, val_accuracy=0.56, lr=0.1]     58%|█████▊    | 54/93 [25:05<17:39, 27.17s/epoch, loss=1.14, accuracy=0.753, val_loss=2.76, val_accuracy=0.273, lr=0.1] 59%|█████▉    | 55/93 [25:32<17:13, 27.19s/epoch, loss=1.15, accuracy=0.753, val_loss=1.96, val_accuracy=0.511, lr=0.1] 60%|██████    | 56/93 [25:59<16:44, 27.15s/epoch, loss=1.14, accuracy=0.753, val_loss=3.05, val_accuracy=0.438, lr=0.1] 61%|██████▏   | 57/93 [26:26<16:15, 27.11s/epoch, loss=1.14, accuracy=0.753, val_loss=1.84, val_accuracy=0.538, lr=0.0316] 62%|██████▏   | 58/93 [26:53<15:50, 27.16s/epoch, loss=1.14, accuracy=0.754, val_loss=1.46, val_accuracy=0.648, lr=0.1]    63%|██████▎   | 59/93 [27:21<15:23, 27.16s/epoch, loss=1.14, accuracy=0.752, val_loss=1.97, val_accuracy=0.535, lr=0.1] 65%|██████▍   | 60/93 [27:48<14:55, 27.13s/epoch, loss=1.15, accuracy=0.754, val_loss=1.66, val_accuracy=0.611, lr=0.1] 66%|██████▌   | 61/93 [28:15<14:28, 27.14s/epoch, loss=1.15, accuracy=0.75, val_loss=1.35, val_accuracy=0.684, lr=0.1]  67%|██████▋   | 62/93 [28:42<13:58, 27.05s/epoch, loss=1.15, accuracy=0.753, val_loss=2.42, val_accuracy=0.405, lr=0.1] 68%|██████▊   | 63/93 [29:09<13:30, 27.03s/epoch, loss=1.15, accuracy=0.756, val_loss=1.97, val_accuracy=0.501, lr=0.1] 69%|██████▉   | 64/93 [29:36<13:05, 27.07s/epoch, loss=1.15, accuracy=0.754, val_loss=1.72, val_accuracy=0.548, lr=0.1] 70%|██████▉   | 65/93 [30:03<12:37, 27.06s/epoch, loss=1.14, accuracy=0.754, val_loss=1.91, val_accuracy=0.536, lr=0.1] 71%|███████   | 66/93 [30:30<12:10, 27.04s/epoch, loss=1.14, accuracy=0.752, val_loss=3.21, val_accuracy=0.353, lr=0.0316] 72%|███████▏  | 67/93 [30:57<11:42, 27.03s/epoch, loss=1.15, accuracy=0.753, val_loss=1.71, val_accuracy=0.6, lr=0.1]      73%|███████▎  | 68/93 [31:24<11:16, 27.05s/epoch, loss=1.14, accuracy=0.753, val_loss=2.63, val_accuracy=0.361, lr=0.1] 74%|███████▍  | 69/93 [31:51<10:48, 27.04s/epoch, loss=1.14, accuracy=0.753, val_loss=3.15, val_accuracy=0.397, lr=0.1] 75%|███████▌  | 70/93 [32:18<10:22, 27.04s/epoch, loss=1.15, accuracy=0.756, val_loss=3.94, val_accuracy=0.264, lr=0.1] 76%|███████▋  | 71/93 [32:45<09:53, 27.00s/epoch, loss=1.14, accuracy=0.755, val_loss=3.37, val_accuracy=0.356, lr=0.0316] 77%|███████▋  | 72/93 [33:12<09:26, 26.98s/epoch, loss=1.14, accuracy=0.757, val_loss=2.34, val_accuracy=0.495, lr=0.1]    78%|███████▊  | 73/93 [33:39<08:58, 26.95s/epoch, loss=1.15, accuracy=0.755, val_loss=2.77, val_accuracy=0.373, lr=0.1] 80%|███████▉  | 74/93 [34:06<08:31, 26.93s/epoch, loss=1.14, accuracy=0.756, val_loss=1.69, val_accuracy=0.582, lr=0.1] 81%|████████  | 75/93 [34:33<08:04, 26.94s/epoch, loss=1.14, accuracy=0.753, val_loss=2.27, val_accuracy=0.463, lr=0.1] 82%|████████▏ | 76/93 [35:00<07:37, 26.93s/epoch, loss=1.14, accuracy=0.757, val_loss=3.39, val_accuracy=0.351, lr=0.0316] 83%|████████▎ | 77/93 [35:27<07:11, 26.95s/epoch, loss=1.14, accuracy=0.756, val_loss=2.06, val_accuracy=0.471, lr=0.1]    84%|████████▍ | 78/93 [35:53<06:40, 26.70s/epoch, loss=1.15, accuracy=0.755, val_loss=1.55, val_accuracy=0.604, lr=0.1] 85%|████████▍ | 79/93 [36:20<06:15, 26.82s/epoch, loss=1.14, accuracy=0.755, val_loss=1.75, val_accuracy=0.588, lr=0.1] 86%|████████▌ | 80/93 [36:47<05:48, 26.84s/epoch, loss=1.13, accuracy=0.76, val_loss=2.24, val_accuracy=0.46, lr=0.1]   87%|████████▋ | 81/93 [37:14<05:22, 26.86s/epoch, loss=1.14, accuracy=0.756, val_loss=2.37, val_accuracy=0.42, lr=0.0316] 88%|████████▊ | 82/93 [37:41<04:57, 27.00s/epoch, loss=0.935, accuracy=0.814, val_loss=0.948, val_accuracy=0.792, lr=0.01] 89%|████████▉ | 83/93 [38:08<04:30, 27.04s/epoch, loss=0.753, accuracy=0.847, val_loss=0.799, val_accuracy=0.83, lr=0.01]  90%|█████████ | 84/93 [38:35<04:03, 27.01s/epoch, loss=0.667, accuracy=0.858, val_loss=0.76, val_accuracy=0.818, lr=0.01] 91%|█████████▏| 85/93 [39:02<03:35, 26.91s/epoch, loss=0.62, accuracy=0.862, val_loss=0.802, val_accuracy=0.795, lr=0.01] 92%|█████████▏| 86/93 [39:29<03:08, 26.94s/epoch, loss=0.595, accuracy=0.863, val_loss=0.736, val_accuracy=0.814, lr=0.01] 94%|█████████▎| 87/93 [39:55<02:41, 26.91s/epoch, loss=0.576, accuracy=0.866, val_loss=0.709, val_accuracy=0.818, lr=0.01] 95%|█████████▍| 88/93 [40:23<02:14, 26.96s/epoch, loss=0.576, accuracy=0.864, val_loss=0.778, val_accuracy=0.8, lr=0.01]   96%|█████████▌| 89/93 [40:50<01:48, 27.03s/epoch, loss=0.567, accuracy=0.868, val_loss=0.812, val_accuracy=0.779, lr=0.01] 97%|█████████▋| 90/93 [41:17<01:21, 27.08s/epoch, loss=0.567, accuracy=0.869, val_loss=0.884, val_accuracy=0.776, lr=0.01] 98%|█████████▊| 91/93 [41:44<00:54, 27.11s/epoch, loss=0.564, accuracy=0.869, val_loss=0.806, val_accuracy=0.8, lr=0.01]   99%|█████████▉| 92/93 [42:11<00:27, 27.10s/epoch, loss=0.564, accuracy=0.87, val_loss=0.783, val_accuracy=0.797, lr=0.00316]100%|██████████| 93/93 [42:38<00:00, 27.11s/epoch, loss=0.558, accuracy=0.873, val_loss=0.942, val_accuracy=0.755, lr=0.01]  100%|██████████| 93/93 [42:38<00:00, 27.51s/epoch, loss=0.558, accuracy=0.873, val_loss=0.942, val_accuracy=0.755, lr=0.01]
Using real-time data augmentation.
Test score: 0.7940673828125
Test accuracy: 0.8296999931335449


* * * Run SGD for ID = 16_6. * * *


2024-02-20 01:35:02.982776: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 01:35:05.691718: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 01:35:05.692996: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-20 01:35:05.736732: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-20 01:35:05.736785: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 01:35:05.740781: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 01:35:05.740882: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-20 01:35:05.743475: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-20 01:35:05.744425: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-20 01:35:05.747422: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-20 01:35:05.749444: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-20 01:35:05.755642: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 01:35:05.756543: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-20 01:35:05.756646: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 01:35:07.228111: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-20 01:35:07.229598: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 01:35:07.230117: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-20 01:35:07.230151: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 01:35:07.230185: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 01:35:07.230198: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-20 01:35:07.230210: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-20 01:35:07.230222: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-20 01:35:07.230235: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-20 01:35:07.230247: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-20 01:35:07.230260: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 01:35:07.230779: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-20 01:35:07.230817: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 01:35:07.890814: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-20 01:35:07.890885: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-20 01:35:07.890895: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-20 01:35:07.892550: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:18:00.0, compute capability: 6.1)
{'id': '16_06', 'batch_size': 128, 'epochs': 93, 'validation_split': 0.1, 'checkpointing': True, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
x_train shape: (45000, 32, 32, 3)
45000 train samples
5000 validation samples
10000 test samples
y_train shape: (45000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/93 [00:00<?, ?epoch/s]2024-02-20 01:35:08.800856: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-20 01:35:08.801615: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-02-20 01:35:10.893526: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 01:35:11.249448: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 01:35:12.284030: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-20 01:35:12.324687: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/93 [01:03<1:37:00, 63.27s/epoch, loss=3.59, accuracy=0.259, val_loss=2.68, val_accuracy=0.186, lr=0.1]  2%|▏         | 2/93 [01:30<1:04:07, 42.28s/epoch, loss=1.8, accuracy=0.426, val_loss=2.72, val_accuracy=0.257, lr=0.1]   3%|▎         | 3/93 [01:58<53:26, 35.63s/epoch, loss=1.53, accuracy=0.531, val_loss=1.8, val_accuracy=0.46, lr=0.1]     4%|▍         | 4/93 [02:26<48:02, 32.39s/epoch, loss=1.34, accuracy=0.637, val_loss=2.01, val_accuracy=0.479, lr=0.1]  5%|▌         | 5/93 [02:53<44:57, 30.66s/epoch, loss=1.28, accuracy=0.677, val_loss=1.95, val_accuracy=0.49, lr=0.1]   6%|▋         | 6/93 [03:20<42:48, 29.53s/epoch, loss=1.25, accuracy=0.698, val_loss=1.95, val_accuracy=0.452, lr=0.1]  8%|▊         | 7/93 [03:48<41:18, 28.81s/epoch, loss=1.24, accuracy=0.708, val_loss=2.11, val_accuracy=0.439, lr=0.1]  9%|▊         | 8/93 [04:15<40:12, 28.38s/epoch, loss=1.23, accuracy=0.713, val_loss=2.14, val_accuracy=0.527, lr=0.0316] 10%|▉         | 9/93 [04:43<39:20, 28.10s/epoch, loss=1.22, accuracy=0.724, val_loss=1.48, val_accuracy=0.641, lr=0.1]    11%|█         | 10/93 [05:10<38:24, 27.76s/epoch, loss=1.22, accuracy=0.728, val_loss=1.82, val_accuracy=0.558, lr=0.1] 12%|█▏        | 11/93 [05:37<37:43, 27.60s/epoch, loss=1.21, accuracy=0.729, val_loss=2.09, val_accuracy=0.52, lr=0.1]  13%|█▎        | 12/93 [06:04<37:10, 27.54s/epoch, loss=1.21, accuracy=0.733, val_loss=1.51, val_accuracy=0.634, lr=0.1] 14%|█▍        | 13/93 [06:32<36:40, 27.50s/epoch, loss=1.2, accuracy=0.735, val_loss=1.39, val_accuracy=0.661, lr=0.1]  15%|█▌        | 14/93 [06:59<36:07, 27.43s/epoch, loss=1.2, accuracy=0.735, val_loss=1.63, val_accuracy=0.588, lr=0.1] 16%|█▌        | 15/93 [07:26<35:36, 27.40s/epoch, loss=1.2, accuracy=0.736, val_loss=1.77, val_accuracy=0.562, lr=0.1] 17%|█▋        | 16/93 [07:54<35:06, 27.36s/epoch, loss=1.19, accuracy=0.739, val_loss=1.53, val_accuracy=0.622, lr=0.1] 18%|█▊        | 17/93 [08:21<34:32, 27.26s/epoch, loss=1.19, accuracy=0.741, val_loss=1.73, val_accuracy=0.554, lr=0.1] 19%|█▉        | 18/93 [08:48<34:00, 27.20s/epoch, loss=1.19, accuracy=0.74, val_loss=2.17, val_accuracy=0.433, lr=0.0316] 20%|██        | 19/93 [09:15<33:35, 27.24s/epoch, loss=1.18, accuracy=0.743, val_loss=3.96, val_accuracy=0.351, lr=0.1]   22%|██▏       | 20/93 [09:43<33:15, 27.33s/epoch, loss=1.18, accuracy=0.74, val_loss=1.51, val_accuracy=0.613, lr=0.1]  23%|██▎       | 21/93 [10:10<32:49, 27.35s/epoch, loss=1.18, accuracy=0.743, val_loss=1.84, val_accuracy=0.553, lr=0.1] 24%|██▎       | 22/93 [10:37<32:20, 27.34s/epoch, loss=1.18, accuracy=0.744, val_loss=1.8, val_accuracy=0.556, lr=0.1]  25%|██▍       | 23/93 [11:05<31:56, 27.38s/epoch, loss=1.19, accuracy=0.744, val_loss=1.94, val_accuracy=0.529, lr=0.0316] 26%|██▌       | 24/93 [11:32<31:25, 27.33s/epoch, loss=1.19, accuracy=0.746, val_loss=1.6, val_accuracy=0.602, lr=0.1]     27%|██▋       | 25/93 [11:59<30:55, 27.28s/epoch, loss=1.18, accuracy=0.747, val_loss=1.96, val_accuracy=0.565, lr=0.1] 28%|██▊       | 26/93 [12:27<30:29, 27.31s/epoch, loss=1.17, accuracy=0.747, val_loss=2.4, val_accuracy=0.38, lr=0.1]   29%|██▉       | 27/93 [12:54<30:02, 27.31s/epoch, loss=1.18, accuracy=0.748, val_loss=2.32, val_accuracy=0.477, lr=0.1] 30%|███       | 28/93 [13:21<29:35, 27.32s/epoch, loss=1.18, accuracy=0.746, val_loss=1.52, val_accuracy=0.617, lr=0.0316] 31%|███       | 29/93 [13:48<29:07, 27.30s/epoch, loss=1.17, accuracy=0.747, val_loss=1.91, val_accuracy=0.525, lr=0.1]    32%|███▏      | 30/93 [14:16<28:39, 27.29s/epoch, loss=1.18, accuracy=0.749, val_loss=2.56, val_accuracy=0.387, lr=0.1] 33%|███▎      | 31/93 [14:43<28:16, 27.36s/epoch, loss=1.18, accuracy=0.749, val_loss=1.96, val_accuracy=0.46, lr=0.1]  34%|███▍      | 32/93 [15:10<27:45, 27.31s/epoch, loss=1.17, accuracy=0.751, val_loss=1.67, val_accuracy=0.575, lr=0.1] 35%|███▌      | 33/93 [15:38<27:19, 27.33s/epoch, loss=1.17, accuracy=0.749, val_loss=2.75, val_accuracy=0.403, lr=0.0316] 37%|███▋      | 34/93 [16:05<26:52, 27.33s/epoch, loss=1.18, accuracy=0.748, val_loss=3.24, val_accuracy=0.27, lr=0.1]     38%|███▊      | 35/93 [16:33<26:26, 27.36s/epoch, loss=1.17, accuracy=0.752, val_loss=2.59, val_accuracy=0.472, lr=0.1] 39%|███▊      | 36/93 [17:00<25:59, 27.36s/epoch, loss=1.16, accuracy=0.754, val_loss=2.32, val_accuracy=0.477, lr=0.1] 40%|███▉      | 37/93 [17:27<25:30, 27.32s/epoch, loss=1.17, accuracy=0.749, val_loss=2.65, val_accuracy=0.3, lr=0.1]   41%|████      | 38/93 [17:54<25:00, 27.28s/epoch, loss=1.16, accuracy=0.75, val_loss=1.5, val_accuracy=0.639, lr=0.0316] 42%|████▏     | 39/93 [18:22<24:32, 27.27s/epoch, loss=1.15, accuracy=0.751, val_loss=1.95, val_accuracy=0.582, lr=0.1]  43%|████▎     | 40/93 [18:49<24:07, 27.30s/epoch, loss=1.16, accuracy=0.749, val_loss=2.92, val_accuracy=0.34, lr=0.1]  44%|████▍     | 41/93 [19:16<23:38, 27.28s/epoch, loss=1.16, accuracy=0.752, val_loss=3.02, val_accuracy=0.246, lr=0.1] 45%|████▌     | 42/93 [19:43<23:09, 27.24s/epoch, loss=1.16, accuracy=0.752, val_loss=1.47, val_accuracy=0.637, lr=0.1] 46%|████▌     | 43/93 [20:11<22:45, 27.30s/epoch, loss=1.16, accuracy=0.751, val_loss=1.89, val_accuracy=0.487, lr=0.0316] 47%|████▋     | 44/93 [20:38<22:20, 27.35s/epoch, loss=1.16, accuracy=0.751, val_loss=1.87, val_accuracy=0.561, lr=0.1]    48%|████▊     | 45/93 [21:05<21:49, 27.28s/epoch, loss=1.16, accuracy=0.754, val_loss=1.74, val_accuracy=0.535, lr=0.1] 49%|████▉     | 46/93 [21:33<21:22, 27.29s/epoch, loss=1.16, accuracy=0.753, val_loss=2.94, val_accuracy=0.49, lr=0.1]  51%|█████     | 47/93 [22:00<20:56, 27.32s/epoch, loss=1.15, accuracy=0.752, val_loss=2, val_accuracy=0.458, lr=0.1]   52%|█████▏    | 48/93 [22:27<20:29, 27.32s/epoch, loss=1.16, accuracy=0.753, val_loss=2.26, val_accuracy=0.48, lr=0.0316] 53%|█████▎    | 49/93 [22:55<20:01, 27.31s/epoch, loss=1.15, accuracy=0.754, val_loss=1.53, val_accuracy=0.632, lr=0.1]   54%|█████▍    | 50/93 [23:22<19:35, 27.33s/epoch, loss=1.15, accuracy=0.756, val_loss=1.85, val_accuracy=0.54, lr=0.1]  55%|█████▍    | 51/93 [23:49<19:08, 27.35s/epoch, loss=1.15, accuracy=0.753, val_loss=2.04, val_accuracy=0.511, lr=0.1] 56%|█████▌    | 52/93 [24:17<18:40, 27.34s/epoch, loss=1.15, accuracy=0.758, val_loss=1.64, val_accuracy=0.584, lr=0.1] 57%|█████▋    | 53/93 [24:44<18:15, 27.38s/epoch, loss=1.15, accuracy=0.753, val_loss=1.85, val_accuracy=0.518, lr=0.0316] 58%|█████▊    | 54/93 [25:12<17:47, 27.38s/epoch, loss=1.15, accuracy=0.755, val_loss=2.2, val_accuracy=0.508, lr=0.1]     59%|█████▉    | 55/93 [25:39<17:20, 27.37s/epoch, loss=1.16, accuracy=0.753, val_loss=1.72, val_accuracy=0.566, lr=0.1] 60%|██████    | 56/93 [26:06<16:52, 27.37s/epoch, loss=1.14, accuracy=0.756, val_loss=4.9, val_accuracy=0.274, lr=0.1]  61%|██████▏   | 57/93 [26:34<16:24, 27.35s/epoch, loss=1.15, accuracy=0.756, val_loss=2.04, val_accuracy=0.484, lr=0.1] 62%|██████▏   | 58/93 [27:01<15:56, 27.34s/epoch, loss=1.15, accuracy=0.753, val_loss=1.65, val_accuracy=0.619, lr=0.0316] 63%|██████▎   | 59/93 [27:28<15:28, 27.30s/epoch, loss=1.14, accuracy=0.757, val_loss=1.8, val_accuracy=0.53, lr=0.1]      65%|██████▍   | 60/93 [27:56<15:01, 27.32s/epoch, loss=1.14, accuracy=0.756, val_loss=2.07, val_accuracy=0.561, lr=0.1] 66%|██████▌   | 61/93 [28:23<14:34, 27.34s/epoch, loss=1.15, accuracy=0.755, val_loss=2.28, val_accuracy=0.457, lr=0.1] 67%|██████▋   | 62/93 [28:50<14:07, 27.34s/epoch, loss=1.14, accuracy=0.759, val_loss=2.7, val_accuracy=0.464, lr=0.1]  68%|██████▊   | 63/93 [29:17<13:38, 27.27s/epoch, loss=1.15, accuracy=0.756, val_loss=1.87, val_accuracy=0.531, lr=0.0316] 69%|██████▉   | 64/93 [29:45<13:13, 27.35s/epoch, loss=1.15, accuracy=0.756, val_loss=2.03, val_accuracy=0.453, lr=0.1]    70%|██████▉   | 65/93 [30:12<12:47, 27.41s/epoch, loss=1.15, accuracy=0.755, val_loss=2.91, val_accuracy=0.303, lr=0.1] 71%|███████   | 66/93 [30:39<12:16, 27.28s/epoch, loss=1.14, accuracy=0.759, val_loss=1.87, val_accuracy=0.54, lr=0.1]  72%|███████▏  | 67/93 [31:07<11:52, 27.38s/epoch, loss=1.15, accuracy=0.758, val_loss=3.06, val_accuracy=0.376, lr=0.1] 73%|███████▎  | 68/93 [31:34<11:24, 27.38s/epoch, loss=1.15, accuracy=0.753, val_loss=1.79, val_accuracy=0.516, lr=0.0316] 74%|███████▍  | 69/93 [32:02<10:56, 27.37s/epoch, loss=1.15, accuracy=0.755, val_loss=1.8, val_accuracy=0.51, lr=0.1]      75%|███████▌  | 70/93 [32:29<10:30, 27.40s/epoch, loss=1.14, accuracy=0.755, val_loss=2.11, val_accuracy=0.486, lr=0.1] 76%|███████▋  | 71/93 [32:56<10:00, 27.31s/epoch, loss=1.14, accuracy=0.758, val_loss=3.36, val_accuracy=0.288, lr=0.1] 77%|███████▋  | 72/93 [33:24<09:33, 27.32s/epoch, loss=1.14, accuracy=0.757, val_loss=2.79, val_accuracy=0.387, lr=0.1] 78%|███████▊  | 73/93 [33:51<09:05, 27.28s/epoch, loss=1.14, accuracy=0.757, val_loss=1.7, val_accuracy=0.568, lr=0.0316] 80%|███████▉  | 74/93 [34:18<08:37, 27.26s/epoch, loss=1.14, accuracy=0.755, val_loss=2.01, val_accuracy=0.487, lr=0.1]   81%|████████  | 75/93 [34:45<08:11, 27.29s/epoch, loss=1.14, accuracy=0.755, val_loss=3.8, val_accuracy=0.265, lr=0.1]  82%|████████▏ | 76/93 [35:13<07:44, 27.31s/epoch, loss=1.15, accuracy=0.756, val_loss=1.84, val_accuracy=0.577, lr=0.1] 83%|████████▎ | 77/93 [35:40<07:17, 27.32s/epoch, loss=1.14, accuracy=0.758, val_loss=1.49, val_accuracy=0.654, lr=0.1] 84%|████████▍ | 78/93 [36:07<06:49, 27.31s/epoch, loss=1.14, accuracy=0.759, val_loss=3.12, val_accuracy=0.4, lr=0.0316] 85%|████████▍ | 79/93 [36:35<06:21, 27.28s/epoch, loss=1.14, accuracy=0.758, val_loss=2.22, val_accuracy=0.428, lr=0.1]  86%|████████▌ | 80/93 [37:02<05:55, 27.31s/epoch, loss=1.15, accuracy=0.757, val_loss=2.64, val_accuracy=0.455, lr=0.1] 87%|████████▋ | 81/93 [37:29<05:27, 27.32s/epoch, loss=1.14, accuracy=0.755, val_loss=6.31, val_accuracy=0.22, lr=0.1]  88%|████████▊ | 82/93 [37:57<05:01, 27.42s/epoch, loss=0.942, accuracy=0.814, val_loss=0.906, val_accuracy=0.807, lr=0.01] 89%|████████▉ | 83/93 [38:24<04:33, 27.39s/epoch, loss=0.754, accuracy=0.849, val_loss=0.795, val_accuracy=0.818, lr=0.01] 90%|█████████ | 84/93 [38:52<04:05, 27.32s/epoch, loss=0.671, accuracy=0.856, val_loss=0.779, val_accuracy=0.808, lr=0.01] 91%|█████████▏| 85/93 [39:19<03:38, 27.29s/epoch, loss=0.622, accuracy=0.86, val_loss=0.758, val_accuracy=0.809, lr=0.01]  92%|█████████▏| 86/93 [39:46<03:11, 27.29s/epoch, loss=0.591, accuracy=0.864, val_loss=0.918, val_accuracy=0.757, lr=0.01] 94%|█████████▎| 87/93 [40:13<02:43, 27.30s/epoch, loss=0.577, accuracy=0.866, val_loss=0.713, val_accuracy=0.812, lr=0.01] 95%|█████████▍| 88/93 [40:41<02:16, 27.39s/epoch, loss=0.572, accuracy=0.865, val_loss=0.698, val_accuracy=0.819, lr=0.01] 96%|█████████▌| 89/93 [41:08<01:49, 27.30s/epoch, loss=0.566, accuracy=0.869, val_loss=0.695, val_accuracy=0.819, lr=0.01] 97%|█████████▋| 90/93 [41:36<01:22, 27.42s/epoch, loss=0.559, accuracy=0.87, val_loss=0.636, val_accuracy=0.843, lr=0.01]  98%|█████████▊| 91/93 [42:03<00:54, 27.29s/epoch, loss=0.558, accuracy=0.871, val_loss=0.68, val_accuracy=0.829, lr=0.01] 99%|█████████▉| 92/93 [42:30<00:27, 27.27s/epoch, loss=0.556, accuracy=0.873, val_loss=0.896, val_accuracy=0.777, lr=0.01]100%|██████████| 93/93 [42:57<00:00, 27.20s/epoch, loss=0.555, accuracy=0.872, val_loss=0.772, val_accuracy=0.8, lr=0.01]  100%|██████████| 93/93 [42:57<00:00, 27.71s/epoch, loss=0.555, accuracy=0.872, val_loss=0.772, val_accuracy=0.8, lr=0.01]
Using real-time data augmentation.
Test score: 0.6548042893409729
Test accuracy: 0.8375999927520752


* * * Run SGD for ID = 16_7. * * *


2024-02-20 02:18:13.874144: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 02:18:16.636340: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 02:18:16.637564: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-20 02:18:16.679910: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-20 02:18:16.679954: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 02:18:16.683391: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 02:18:16.683465: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-20 02:18:16.686006: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-20 02:18:16.687207: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-20 02:18:16.690038: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-20 02:18:16.691856: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-20 02:18:16.697358: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 02:18:16.698114: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-20 02:18:16.698211: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 02:18:18.151140: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-20 02:18:18.152248: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 02:18:18.152775: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-20 02:18:18.152808: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 02:18:18.152854: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 02:18:18.152869: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-20 02:18:18.152884: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-20 02:18:18.152898: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-20 02:18:18.152912: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-20 02:18:18.152926: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-20 02:18:18.152941: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 02:18:18.153524: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-20 02:18:18.153569: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 02:18:18.829564: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-20 02:18:18.829626: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-20 02:18:18.829637: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-20 02:18:18.831521: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:18:00.0, compute capability: 6.1)
{'id': '16_07', 'batch_size': 128, 'epochs': 93, 'validation_split': 0.1, 'checkpointing': True, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
x_train shape: (45000, 32, 32, 3)
45000 train samples
5000 validation samples
10000 test samples
y_train shape: (45000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/93 [00:00<?, ?epoch/s]2024-02-20 02:18:19.749992: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-20 02:18:19.750682: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-02-20 02:18:21.878951: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 02:18:22.212312: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 02:18:23.003072: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-20 02:18:23.050236: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/93 [00:59<1:31:26, 59.64s/epoch, loss=3.93, accuracy=0.271, val_loss=2.63, val_accuracy=0.212, lr=0.1]  2%|▏         | 2/93 [01:27<1:01:47, 40.74s/epoch, loss=1.71, accuracy=0.474, val_loss=1.89, val_accuracy=0.415, lr=0.1]  3%|▎         | 3/93 [01:54<51:52, 34.58s/epoch, loss=1.43, accuracy=0.586, val_loss=4.78, val_accuracy=0.252, lr=0.1]    4%|▍         | 4/93 [02:21<47:03, 31.73s/epoch, loss=1.31, accuracy=0.651, val_loss=2.97, val_accuracy=0.324, lr=0.1]  5%|▌         | 5/93 [02:49<44:16, 30.19s/epoch, loss=1.26, accuracy=0.684, val_loss=2, val_accuracy=0.519, lr=0.1]     6%|▋         | 6/93 [03:16<42:16, 29.16s/epoch, loss=1.23, accuracy=0.699, val_loss=1.7, val_accuracy=0.539, lr=0.1]  8%|▊         | 7/93 [03:43<40:41, 28.39s/epoch, loss=1.22, accuracy=0.709, val_loss=1.72, val_accuracy=0.538, lr=0.1]  9%|▊         | 8/93 [04:10<39:51, 28.13s/epoch, loss=1.21, accuracy=0.72, val_loss=1.51, val_accuracy=0.623, lr=0.1]  10%|▉         | 9/93 [04:37<38:55, 27.80s/epoch, loss=1.2, accuracy=0.726, val_loss=1.69, val_accuracy=0.538, lr=0.1] 11%|█         | 10/93 [05:05<38:12, 27.62s/epoch, loss=1.2, accuracy=0.728, val_loss=1.93, val_accuracy=0.522, lr=0.1] 12%|█▏        | 11/93 [05:32<37:39, 27.55s/epoch, loss=1.19, accuracy=0.735, val_loss=1.95, val_accuracy=0.449, lr=0.1] 13%|█▎        | 12/93 [05:59<37:08, 27.51s/epoch, loss=1.19, accuracy=0.735, val_loss=1.99, val_accuracy=0.494, lr=0.1] 14%|█▍        | 13/93 [06:27<36:32, 27.40s/epoch, loss=1.19, accuracy=0.739, val_loss=2.1, val_accuracy=0.49, lr=0.0316] 15%|█▌        | 14/93 [06:54<36:03, 27.38s/epoch, loss=1.19, accuracy=0.737, val_loss=2.06, val_accuracy=0.418, lr=0.1]  16%|█▌        | 15/93 [07:21<35:30, 27.32s/epoch, loss=1.17, accuracy=0.741, val_loss=1.89, val_accuracy=0.531, lr=0.1] 17%|█▋        | 16/93 [07:48<35:03, 27.31s/epoch, loss=1.17, accuracy=0.742, val_loss=1.99, val_accuracy=0.499, lr=0.1] 18%|█▊        | 17/93 [08:16<34:43, 27.42s/epoch, loss=1.17, accuracy=0.743, val_loss=1.49, val_accuracy=0.635, lr=0.1] 19%|█▉        | 18/93 [08:43<34:09, 27.33s/epoch, loss=1.16, accuracy=0.747, val_loss=2.1, val_accuracy=0.443, lr=0.1]  20%|██        | 19/93 [09:10<33:39, 27.28s/epoch, loss=1.16, accuracy=0.747, val_loss=1.71, val_accuracy=0.551, lr=0.1] 22%|██▏       | 20/93 [09:38<33:19, 27.39s/epoch, loss=1.16, accuracy=0.745, val_loss=1.32, val_accuracy=0.694, lr=0.1] 23%|██▎       | 21/93 [10:05<32:44, 27.29s/epoch, loss=1.15, accuracy=0.75, val_loss=2.98, val_accuracy=0.252, lr=0.1]  24%|██▎       | 22/93 [10:32<32:17, 27.29s/epoch, loss=1.15, accuracy=0.749, val_loss=1.86, val_accuracy=0.511, lr=0.1] 25%|██▍       | 23/93 [11:00<31:52, 27.32s/epoch, loss=1.15, accuracy=0.748, val_loss=10.2, val_accuracy=0.111, lr=0.1] 26%|██▌       | 24/93 [11:27<31:22, 27.28s/epoch, loss=1.14, accuracy=0.753, val_loss=2.35, val_accuracy=0.378, lr=0.1] 27%|██▋       | 25/93 [11:54<30:53, 27.26s/epoch, loss=1.15, accuracy=0.75, val_loss=2.08, val_accuracy=0.486, lr=0.0316] 28%|██▊       | 26/93 [12:21<30:23, 27.22s/epoch, loss=1.15, accuracy=0.751, val_loss=1.81, val_accuracy=0.542, lr=0.1]   29%|██▉       | 27/93 [12:48<29:54, 27.19s/epoch, loss=1.16, accuracy=0.748, val_loss=5.13, val_accuracy=0.288, lr=0.1] 30%|███       | 28/93 [13:15<29:27, 27.19s/epoch, loss=1.14, accuracy=0.748, val_loss=3.55, val_accuracy=0.353, lr=0.1] 31%|███       | 29/93 [13:43<28:58, 27.17s/epoch, loss=1.14, accuracy=0.75, val_loss=2.32, val_accuracy=0.499, lr=0.1]  32%|███▏      | 30/93 [14:10<28:34, 27.21s/epoch, loss=1.14, accuracy=0.753, val_loss=1.62, val_accuracy=0.57, lr=0.0316] 33%|███▎      | 31/93 [14:37<28:10, 27.26s/epoch, loss=1.15, accuracy=0.753, val_loss=1.88, val_accuracy=0.536, lr=0.1]   34%|███▍      | 32/93 [15:05<27:44, 27.28s/epoch, loss=1.14, accuracy=0.752, val_loss=2.13, val_accuracy=0.456, lr=0.1] 35%|███▌      | 33/93 [15:32<27:20, 27.34s/epoch, loss=1.13, accuracy=0.755, val_loss=3.74, val_accuracy=0.241, lr=0.1] 37%|███▋      | 34/93 [15:59<26:51, 27.32s/epoch, loss=1.13, accuracy=0.757, val_loss=1.86, val_accuracy=0.507, lr=0.1] 38%|███▊      | 35/93 [16:27<26:21, 27.26s/epoch, loss=1.14, accuracy=0.754, val_loss=1.72, val_accuracy=0.561, lr=0.0316] 39%|███▊      | 36/93 [16:54<25:52, 27.25s/epoch, loss=1.14, accuracy=0.754, val_loss=5.24, val_accuracy=0.265, lr=0.1]    40%|███▉      | 37/93 [17:21<25:26, 27.26s/epoch, loss=1.14, accuracy=0.754, val_loss=1.81, val_accuracy=0.55, lr=0.1]  41%|████      | 38/93 [17:48<25:01, 27.29s/epoch, loss=1.14, accuracy=0.753, val_loss=1.76, val_accuracy=0.593, lr=0.1] 42%|████▏     | 39/93 [18:16<24:34, 27.31s/epoch, loss=1.13, accuracy=0.757, val_loss=1.89, val_accuracy=0.505, lr=0.1] 43%|████▎     | 40/93 [18:43<24:08, 27.32s/epoch, loss=1.14, accuracy=0.757, val_loss=1.67, val_accuracy=0.578, lr=0.0316] 44%|████▍     | 41/93 [19:10<23:39, 27.31s/epoch, loss=1.14, accuracy=0.756, val_loss=2.01, val_accuracy=0.481, lr=0.1]    45%|████▌     | 42/93 [19:37<23:04, 27.16s/epoch, loss=1.13, accuracy=0.756, val_loss=2.46, val_accuracy=0.3, lr=0.1]   46%|████▌     | 43/93 [20:05<22:40, 27.22s/epoch, loss=1.13, accuracy=0.757, val_loss=1.72, val_accuracy=0.541, lr=0.1] 47%|████▋     | 44/93 [20:32<22:13, 27.21s/epoch, loss=1.14, accuracy=0.756, val_loss=1.93, val_accuracy=0.533, lr=0.1] 48%|████▊     | 45/93 [20:59<21:45, 27.19s/epoch, loss=1.13, accuracy=0.754, val_loss=2.53, val_accuracy=0.428, lr=0.0316] 49%|████▉     | 46/93 [21:26<21:13, 27.09s/epoch, loss=1.13, accuracy=0.756, val_loss=2.05, val_accuracy=0.533, lr=0.1]    51%|█████     | 47/93 [21:53<20:48, 27.15s/epoch, loss=1.13, accuracy=0.755, val_loss=2.79, val_accuracy=0.419, lr=0.1] 52%|█████▏    | 48/93 [22:20<20:21, 27.15s/epoch, loss=1.14, accuracy=0.755, val_loss=4.51, val_accuracy=0.203, lr=0.1] 53%|█████▎    | 49/93 [22:47<19:54, 27.14s/epoch, loss=1.13, accuracy=0.757, val_loss=1.71, val_accuracy=0.585, lr=0.1] 54%|█████▍    | 50/93 [23:15<19:29, 27.20s/epoch, loss=1.13, accuracy=0.76, val_loss=1.67, val_accuracy=0.575, lr=0.0316] 55%|█████▍    | 51/93 [23:41<18:58, 27.10s/epoch, loss=1.13, accuracy=0.757, val_loss=2.86, val_accuracy=0.363, lr=0.1]   56%|█████▌    | 52/93 [24:09<18:30, 27.09s/epoch, loss=1.13, accuracy=0.755, val_loss=1.85, val_accuracy=0.56, lr=0.1]  57%|█████▋    | 53/93 [24:36<18:03, 27.09s/epoch, loss=1.12, accuracy=0.759, val_loss=1.56, val_accuracy=0.587, lr=0.1] 58%|█████▊    | 54/93 [25:03<17:35, 27.08s/epoch, loss=1.13, accuracy=0.759, val_loss=1.71, val_accuracy=0.555, lr=0.1] 59%|█████▉    | 55/93 [25:30<17:10, 27.11s/epoch, loss=1.13, accuracy=0.758, val_loss=2.36, val_accuracy=0.481, lr=0.0316] 60%|██████    | 56/93 [25:57<16:42, 27.09s/epoch, loss=1.13, accuracy=0.757, val_loss=1.94, val_accuracy=0.547, lr=0.1]    61%|██████▏   | 57/93 [26:24<16:14, 27.06s/epoch, loss=1.13, accuracy=0.755, val_loss=1.64, val_accuracy=0.611, lr=0.1] 62%|██████▏   | 58/93 [26:51<15:45, 27.02s/epoch, loss=1.13, accuracy=0.756, val_loss=1.91, val_accuracy=0.578, lr=0.1] 63%|██████▎   | 59/93 [27:18<15:20, 27.08s/epoch, loss=1.12, accuracy=0.758, val_loss=1.74, val_accuracy=0.572, lr=0.1] 65%|██████▍   | 60/93 [27:45<14:52, 27.04s/epoch, loss=1.12, accuracy=0.757, val_loss=4.2, val_accuracy=0.284, lr=0.0316] 66%|██████▌   | 61/93 [28:12<14:26, 27.07s/epoch, loss=1.12, accuracy=0.759, val_loss=1.63, val_accuracy=0.607, lr=0.1]   67%|██████▋   | 62/93 [28:39<13:59, 27.07s/epoch, loss=1.13, accuracy=0.754, val_loss=2.08, val_accuracy=0.532, lr=0.1] 68%|██████▊   | 63/93 [29:06<13:31, 27.05s/epoch, loss=1.12, accuracy=0.761, val_loss=1.75, val_accuracy=0.576, lr=0.1] 69%|██████▉   | 64/93 [29:33<13:03, 27.03s/epoch, loss=1.12, accuracy=0.759, val_loss=1.84, val_accuracy=0.511, lr=0.1] 70%|██████▉   | 65/93 [30:00<12:36, 27.03s/epoch, loss=1.13, accuracy=0.759, val_loss=3.01, val_accuracy=0.361, lr=0.0316] 71%|███████   | 66/93 [30:27<12:11, 27.08s/epoch, loss=1.13, accuracy=0.756, val_loss=1.91, val_accuracy=0.561, lr=0.1]    72%|███████▏  | 67/93 [30:54<11:43, 27.05s/epoch, loss=1.12, accuracy=0.758, val_loss=2.47, val_accuracy=0.397, lr=0.1] 73%|███████▎  | 68/93 [31:21<11:16, 27.06s/epoch, loss=1.13, accuracy=0.76, val_loss=2.04, val_accuracy=0.555, lr=0.1]  74%|███████▍  | 69/93 [31:49<10:49, 27.06s/epoch, loss=1.12, accuracy=0.758, val_loss=2.05, val_accuracy=0.514, lr=0.1] 75%|███████▌  | 70/93 [32:15<10:21, 27.01s/epoch, loss=1.12, accuracy=0.759, val_loss=2.02, val_accuracy=0.439, lr=0.0316] 76%|███████▋  | 71/93 [32:43<09:55, 27.05s/epoch, loss=1.12, accuracy=0.757, val_loss=1.45, val_accuracy=0.648, lr=0.1]    77%|███████▋  | 72/93 [33:10<09:27, 27.05s/epoch, loss=1.11, accuracy=0.759, val_loss=3.83, val_accuracy=0.301, lr=0.1] 78%|███████▊  | 73/93 [33:36<08:59, 26.99s/epoch, loss=1.11, accuracy=0.76, val_loss=2.98, val_accuracy=0.332, lr=0.1]  80%|███████▉  | 74/93 [34:04<08:33, 27.00s/epoch, loss=1.12, accuracy=0.76, val_loss=2.19, val_accuracy=0.523, lr=0.1] 81%|████████  | 75/93 [34:31<08:06, 27.00s/epoch, loss=1.12, accuracy=0.757, val_loss=1.58, val_accuracy=0.621, lr=0.0316] 82%|████████▏ | 76/93 [34:57<07:38, 26.98s/epoch, loss=1.12, accuracy=0.758, val_loss=2.57, val_accuracy=0.376, lr=0.1]    83%|████████▎ | 77/93 [35:24<07:11, 26.99s/epoch, loss=1.12, accuracy=0.759, val_loss=1.41, val_accuracy=0.666, lr=0.1] 84%|████████▍ | 78/93 [35:51<06:45, 27.00s/epoch, loss=1.12, accuracy=0.76, val_loss=1.83, val_accuracy=0.581, lr=0.1]  85%|████████▍ | 79/93 [36:19<06:18, 27.02s/epoch, loss=1.11, accuracy=0.76, val_loss=2.69, val_accuracy=0.283, lr=0.1] 86%|████████▌ | 80/93 [36:46<05:51, 27.05s/epoch, loss=1.12, accuracy=0.759, val_loss=1.6, val_accuracy=0.583, lr=0.0316] 87%|████████▋ | 81/93 [37:13<05:24, 27.04s/epoch, loss=1.11, accuracy=0.758, val_loss=3.36, val_accuracy=0.304, lr=0.1]   88%|████████▊ | 82/93 [37:40<04:58, 27.11s/epoch, loss=0.915, accuracy=0.814, val_loss=0.902, val_accuracy=0.812, lr=0.01] 89%|████████▉ | 83/93 [38:07<04:31, 27.13s/epoch, loss=0.739, accuracy=0.849, val_loss=0.801, val_accuracy=0.82, lr=0.01]  90%|█████████ | 84/93 [38:34<04:04, 27.14s/epoch, loss=0.661, accuracy=0.857, val_loss=0.746, val_accuracy=0.823, lr=0.01] 91%|█████████▏| 85/93 [39:01<03:36, 27.09s/epoch, loss=0.613, accuracy=0.86, val_loss=0.747, val_accuracy=0.815, lr=0.01]  92%|█████████▏| 86/93 [39:28<03:09, 27.10s/epoch, loss=0.586, accuracy=0.862, val_loss=0.869, val_accuracy=0.783, lr=0.01] 94%|█████████▎| 87/93 [39:55<02:42, 27.09s/epoch, loss=0.572, accuracy=0.863, val_loss=0.78, val_accuracy=0.796, lr=0.01]  95%|█████████▍| 88/93 [40:22<02:15, 27.07s/epoch, loss=0.568, accuracy=0.863, val_loss=0.784, val_accuracy=0.799, lr=0.01] 96%|█████████▌| 89/93 [40:50<01:48, 27.11s/epoch, loss=0.561, accuracy=0.867, val_loss=1.88, val_accuracy=0.58, lr=0.00316] 97%|█████████▋| 90/93 [41:17<01:21, 27.09s/epoch, loss=0.557, accuracy=0.866, val_loss=0.773, val_accuracy=0.802, lr=0.01]  98%|█████████▊| 91/93 [41:44<00:54, 27.07s/epoch, loss=0.557, accuracy=0.869, val_loss=0.703, val_accuracy=0.817, lr=0.01] 99%|█████████▉| 92/93 [42:11<00:27, 27.11s/epoch, loss=0.553, accuracy=0.871, val_loss=0.909, val_accuracy=0.78, lr=0.01] 100%|██████████| 93/93 [42:38<00:00, 27.11s/epoch, loss=0.556, accuracy=0.871, val_loss=0.88, val_accuracy=0.769, lr=0.01]100%|██████████| 93/93 [42:38<00:00, 27.51s/epoch, loss=0.556, accuracy=0.871, val_loss=0.88, val_accuracy=0.769, lr=0.01]
Using real-time data augmentation.
Test score: 0.7599315047264099
Test accuracy: 0.8147000074386597


* * * Run SGD for ID = 16_8. * * *


2024-02-20 03:01:05.154582: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 03:01:09.696521: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 03:01:09.697823: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-20 03:01:09.738362: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-20 03:01:09.738407: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 03:01:09.742346: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 03:01:09.742415: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-20 03:01:09.745595: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-20 03:01:09.747140: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-20 03:01:09.751203: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-20 03:01:09.753612: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-20 03:01:09.758967: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 03:01:09.759680: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-20 03:01:09.759774: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 03:01:11.202610: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-20 03:01:11.203251: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 03:01:11.203777: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-20 03:01:11.203812: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 03:01:11.203860: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 03:01:11.203876: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-20 03:01:11.203890: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-20 03:01:11.203904: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-20 03:01:11.203929: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-20 03:01:11.203955: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-20 03:01:11.203978: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 03:01:11.204579: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-20 03:01:11.204628: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 03:01:11.911684: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-20 03:01:11.911752: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-20 03:01:11.911764: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-20 03:01:11.913650: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:18:00.0, compute capability: 6.1)
{'id': '16_08', 'batch_size': 128, 'epochs': 93, 'validation_split': 0.1, 'checkpointing': True, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
x_train shape: (45000, 32, 32, 3)
45000 train samples
5000 validation samples
10000 test samples
y_train shape: (45000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/93 [00:00<?, ?epoch/s]2024-02-20 03:01:12.945819: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-20 03:01:12.946444: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-02-20 03:01:15.081917: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 03:01:15.419964: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 03:01:16.500658: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-20 03:01:16.551368: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/93 [01:00<1:33:22, 60.90s/epoch, loss=3.34, accuracy=0.277, val_loss=4.46, val_accuracy=0.102, lr=0.1]  2%|▏         | 2/93 [01:28<1:02:50, 41.43s/epoch, loss=1.61, accuracy=0.52, val_loss=2.74, val_accuracy=0.294, lr=0.1]   3%|▎         | 3/93 [01:56<52:40, 35.11s/epoch, loss=1.45, accuracy=0.592, val_loss=2.66, val_accuracy=0.372, lr=0.1]   4%|▍         | 4/93 [02:23<47:35, 32.09s/epoch, loss=1.38, accuracy=0.636, val_loss=1.72, val_accuracy=0.517, lr=0.1]  5%|▌         | 5/93 [02:51<44:35, 30.40s/epoch, loss=1.33, accuracy=0.665, val_loss=2.45, val_accuracy=0.429, lr=0.1]  6%|▋         | 6/93 [03:18<42:32, 29.34s/epoch, loss=1.29, accuracy=0.687, val_loss=2.37, val_accuracy=0.46, lr=0.1]   8%|▊         | 7/93 [03:46<41:19, 28.83s/epoch, loss=1.27, accuracy=0.698, val_loss=1.56, val_accuracy=0.586, lr=0.1]  9%|▊         | 8/93 [04:13<40:08, 28.33s/epoch, loss=1.25, accuracy=0.705, val_loss=2.29, val_accuracy=0.485, lr=0.1] 10%|▉         | 9/93 [04:40<39:16, 28.05s/epoch, loss=1.24, accuracy=0.713, val_loss=3.03, val_accuracy=0.328, lr=0.1] 11%|█         | 10/93 [05:08<38:26, 27.79s/epoch, loss=1.23, accuracy=0.719, val_loss=2.05, val_accuracy=0.437, lr=0.1] 12%|█▏        | 11/93 [05:35<37:44, 27.62s/epoch, loss=1.22, accuracy=0.723, val_loss=1.7, val_accuracy=0.574, lr=0.1]  13%|█▎        | 12/93 [06:03<37:23, 27.70s/epoch, loss=1.22, accuracy=0.726, val_loss=1.45, val_accuracy=0.648, lr=0.1] 14%|█▍        | 13/93 [06:30<36:37, 27.47s/epoch, loss=1.21, accuracy=0.731, val_loss=1.97, val_accuracy=0.501, lr=0.1] 15%|█▌        | 14/93 [06:57<36:10, 27.47s/epoch, loss=1.21, accuracy=0.73, val_loss=2.2, val_accuracy=0.473, lr=0.1]   16%|█▌        | 15/93 [07:25<35:41, 27.46s/epoch, loss=1.2, accuracy=0.734, val_loss=1.68, val_accuracy=0.606, lr=0.1] 17%|█▋        | 16/93 [07:52<35:13, 27.45s/epoch, loss=1.2, accuracy=0.734, val_loss=1.6, val_accuracy=0.593, lr=0.1]  18%|█▊        | 17/93 [08:20<34:48, 27.47s/epoch, loss=1.19, accuracy=0.733, val_loss=2.14, val_accuracy=0.503, lr=0.0316] 19%|█▉        | 18/93 [08:47<34:18, 27.45s/epoch, loss=1.19, accuracy=0.738, val_loss=2.14, val_accuracy=0.526, lr=0.1]    20%|██        | 19/93 [09:15<33:54, 27.49s/epoch, loss=1.19, accuracy=0.734, val_loss=1.53, val_accuracy=0.62, lr=0.1]  22%|██▏       | 20/93 [09:42<33:19, 27.38s/epoch, loss=1.18, accuracy=0.738, val_loss=2.8, val_accuracy=0.28, lr=0.1]  23%|██▎       | 21/93 [10:09<32:50, 27.37s/epoch, loss=1.18, accuracy=0.739, val_loss=1.76, val_accuracy=0.571, lr=0.1] 24%|██▎       | 22/93 [10:36<32:18, 27.30s/epoch, loss=1.18, accuracy=0.74, val_loss=1.93, val_accuracy=0.516, lr=0.0316] 25%|██▍       | 23/93 [11:03<31:51, 27.31s/epoch, loss=1.18, accuracy=0.74, val_loss=1.6, val_accuracy=0.608, lr=0.1]     26%|██▌       | 24/93 [11:31<31:21, 27.26s/epoch, loss=1.18, accuracy=0.74, val_loss=2.01, val_accuracy=0.445, lr=0.1] 27%|██▋       | 25/93 [11:58<30:55, 27.28s/epoch, loss=1.17, accuracy=0.741, val_loss=1.93, val_accuracy=0.502, lr=0.1] 28%|██▊       | 26/93 [12:25<30:25, 27.24s/epoch, loss=1.18, accuracy=0.74, val_loss=1.96, val_accuracy=0.452, lr=0.1]  29%|██▉       | 27/93 [12:52<29:57, 27.24s/epoch, loss=1.17, accuracy=0.741, val_loss=1.54, val_accuracy=0.625, lr=0.0316] 30%|███       | 28/93 [13:20<29:30, 27.24s/epoch, loss=1.17, accuracy=0.743, val_loss=2.3, val_accuracy=0.459, lr=0.1]     31%|███       | 29/93 [13:47<29:05, 27.27s/epoch, loss=1.18, accuracy=0.74, val_loss=2.02, val_accuracy=0.513, lr=0.1] 32%|███▏      | 30/93 [14:14<28:36, 27.25s/epoch, loss=1.17, accuracy=0.746, val_loss=3.91, val_accuracy=0.32, lr=0.1] 33%|███▎      | 31/93 [14:41<28:09, 27.25s/epoch, loss=1.18, accuracy=0.744, val_loss=3.43, val_accuracy=0.396, lr=0.1] 34%|███▍      | 32/93 [15:09<27:43, 27.26s/epoch, loss=1.18, accuracy=0.744, val_loss=3.37, val_accuracy=0.399, lr=0.0316] 35%|███▌      | 33/93 [15:36<27:13, 27.23s/epoch, loss=1.17, accuracy=0.746, val_loss=1.63, val_accuracy=0.596, lr=0.1]    37%|███▋      | 34/93 [16:03<26:45, 27.22s/epoch, loss=1.17, accuracy=0.744, val_loss=1.96, val_accuracy=0.536, lr=0.1] 38%|███▊      | 35/93 [16:30<26:18, 27.21s/epoch, loss=1.17, accuracy=0.746, val_loss=1.94, val_accuracy=0.596, lr=0.1] 39%|███▊      | 36/93 [16:57<25:52, 27.23s/epoch, loss=1.16, accuracy=0.746, val_loss=2.03, val_accuracy=0.571, lr=0.1] 40%|███▉      | 37/93 [17:25<25:23, 27.21s/epoch, loss=1.16, accuracy=0.744, val_loss=1.52, val_accuracy=0.634, lr=0.0316] 41%|████      | 38/93 [17:52<25:04, 27.35s/epoch, loss=1.16, accuracy=0.746, val_loss=1.41, val_accuracy=0.657, lr=0.1]    42%|████▏     | 39/93 [18:20<24:35, 27.33s/epoch, loss=1.17, accuracy=0.746, val_loss=1.83, val_accuracy=0.577, lr=0.1] 43%|████▎     | 40/93 [18:47<24:10, 27.37s/epoch, loss=1.17, accuracy=0.748, val_loss=3.47, val_accuracy=0.353, lr=0.1] 44%|████▍     | 41/93 [19:15<23:45, 27.41s/epoch, loss=1.16, accuracy=0.745, val_loss=2.5, val_accuracy=0.448, lr=0.1]  45%|████▌     | 42/93 [19:42<23:17, 27.41s/epoch, loss=1.16, accuracy=0.746, val_loss=1.77, val_accuracy=0.555, lr=0.1] 46%|████▌     | 43/93 [20:09<22:49, 27.39s/epoch, loss=1.16, accuracy=0.747, val_loss=2.92, val_accuracy=0.371, lr=0.0316] 47%|████▋     | 44/93 [20:37<22:21, 27.38s/epoch, loss=1.15, accuracy=0.748, val_loss=2.2, val_accuracy=0.48, lr=0.1]      48%|████▊     | 45/93 [21:04<21:53, 27.37s/epoch, loss=1.16, accuracy=0.748, val_loss=2.33, val_accuracy=0.466, lr=0.1] 49%|████▉     | 46/93 [21:31<21:24, 27.33s/epoch, loss=1.15, accuracy=0.749, val_loss=2.66, val_accuracy=0.341, lr=0.1] 51%|█████     | 47/93 [21:58<20:53, 27.25s/epoch, loss=1.16, accuracy=0.745, val_loss=1.67, val_accuracy=0.589, lr=0.1] 52%|█████▏    | 48/93 [22:25<20:23, 27.18s/epoch, loss=1.15, accuracy=0.751, val_loss=1.94, val_accuracy=0.523, lr=0.0316] 53%|█████▎    | 49/93 [22:53<19:57, 27.21s/epoch, loss=1.15, accuracy=0.751, val_loss=2.29, val_accuracy=0.535, lr=0.1]    54%|█████▍    | 50/93 [23:20<19:28, 27.17s/epoch, loss=1.15, accuracy=0.753, val_loss=1.67, val_accuracy=0.566, lr=0.1] 55%|█████▍    | 51/93 [23:47<19:01, 27.18s/epoch, loss=1.15, accuracy=0.751, val_loss=1.57, val_accuracy=0.627, lr=0.1] 56%|█████▌    | 52/93 [24:14<18:34, 27.17s/epoch, loss=1.15, accuracy=0.752, val_loss=1.63, val_accuracy=0.616, lr=0.1] 57%|█████▋    | 53/93 [24:41<18:07, 27.18s/epoch, loss=1.15, accuracy=0.749, val_loss=1.91, val_accuracy=0.523, lr=0.0316] 58%|█████▊    | 54/93 [25:08<17:40, 27.19s/epoch, loss=1.15, accuracy=0.75, val_loss=1.94, val_accuracy=0.463, lr=0.1]     59%|█████▉    | 55/93 [25:35<17:07, 27.04s/epoch, loss=1.15, accuracy=0.748, val_loss=1.47, val_accuracy=0.649, lr=0.1] 60%|██████    | 56/93 [26:03<16:44, 27.15s/epoch, loss=1.15, accuracy=0.749, val_loss=1.41, val_accuracy=0.66, lr=0.1]  61%|██████▏   | 57/93 [26:30<16:15, 27.10s/epoch, loss=1.14, accuracy=0.752, val_loss=1.68, val_accuracy=0.613, lr=0.1] 62%|██████▏   | 58/93 [26:56<15:47, 27.07s/epoch, loss=1.15, accuracy=0.752, val_loss=4.04, val_accuracy=0.352, lr=0.1] 63%|██████▎   | 59/93 [27:24<15:20, 27.06s/epoch, loss=1.15, accuracy=0.751, val_loss=1.87, val_accuracy=0.535, lr=0.1] 65%|██████▍   | 60/93 [27:51<14:53, 27.08s/epoch, loss=1.15, accuracy=0.751, val_loss=1.56, val_accuracy=0.629, lr=0.1] 66%|██████▌   | 61/93 [28:18<14:29, 27.17s/epoch, loss=1.14, accuracy=0.753, val_loss=1.67, val_accuracy=0.576, lr=0.0316] 67%|██████▋   | 62/93 [28:45<14:02, 27.18s/epoch, loss=1.14, accuracy=0.754, val_loss=1.62, val_accuracy=0.612, lr=0.1]    68%|██████▊   | 63/93 [29:12<13:34, 27.15s/epoch, loss=1.14, accuracy=0.754, val_loss=4.03, val_accuracy=0.328, lr=0.1] 69%|██████▉   | 64/93 [29:40<13:08, 27.19s/epoch, loss=1.14, accuracy=0.752, val_loss=1.73, val_accuracy=0.579, lr=0.1] 70%|██████▉   | 65/93 [30:07<12:40, 27.16s/epoch, loss=1.13, accuracy=0.753, val_loss=1.7, val_accuracy=0.571, lr=0.1]  71%|███████   | 66/93 [30:34<12:13, 27.18s/epoch, loss=1.14, accuracy=0.755, val_loss=1.64, val_accuracy=0.561, lr=0.0316] 72%|███████▏  | 67/93 [31:01<11:46, 27.18s/epoch, loss=1.14, accuracy=0.753, val_loss=1.77, val_accuracy=0.568, lr=0.1]    73%|███████▎  | 68/93 [31:28<11:18, 27.13s/epoch, loss=1.14, accuracy=0.752, val_loss=1.47, val_accuracy=0.645, lr=0.1] 74%|███████▍  | 69/93 [31:55<10:50, 27.08s/epoch, loss=1.14, accuracy=0.752, val_loss=1.83, val_accuracy=0.527, lr=0.1] 75%|███████▌  | 70/93 [32:22<10:22, 27.08s/epoch, loss=1.15, accuracy=0.752, val_loss=1.8, val_accuracy=0.572, lr=0.1]  76%|███████▋  | 71/93 [32:49<09:55, 27.06s/epoch, loss=1.14, accuracy=0.755, val_loss=2.75, val_accuracy=0.458, lr=0.0316] 77%|███████▋  | 72/93 [33:16<09:27, 27.02s/epoch, loss=1.14, accuracy=0.753, val_loss=1.58, val_accuracy=0.624, lr=0.1]    78%|███████▊  | 73/93 [33:43<09:01, 27.07s/epoch, loss=1.13, accuracy=0.757, val_loss=1.93, val_accuracy=0.557, lr=0.1] 80%|███████▉  | 74/93 [34:11<08:35, 27.12s/epoch, loss=1.13, accuracy=0.755, val_loss=2.12, val_accuracy=0.505, lr=0.1] 81%|████████  | 75/93 [34:38<08:07, 27.10s/epoch, loss=1.13, accuracy=0.753, val_loss=2.53, val_accuracy=0.442, lr=0.1] 82%|████████▏ | 76/93 [35:05<07:40, 27.11s/epoch, loss=1.13, accuracy=0.753, val_loss=2.16, val_accuracy=0.454, lr=0.0316] 83%|████████▎ | 77/93 [35:32<07:13, 27.11s/epoch, loss=1.14, accuracy=0.753, val_loss=1.86, val_accuracy=0.526, lr=0.1]    84%|████████▍ | 78/93 [35:59<06:46, 27.08s/epoch, loss=1.13, accuracy=0.755, val_loss=3.52, val_accuracy=0.358, lr=0.1] 85%|████████▍ | 79/93 [36:26<06:18, 27.07s/epoch, loss=1.13, accuracy=0.757, val_loss=2.69, val_accuracy=0.454, lr=0.1] 86%|████████▌ | 80/93 [36:53<05:52, 27.09s/epoch, loss=1.13, accuracy=0.755, val_loss=5.06, val_accuracy=0.17, lr=0.1]  87%|████████▋ | 81/93 [37:20<05:24, 27.08s/epoch, loss=1.13, accuracy=0.754, val_loss=1.85, val_accuracy=0.501, lr=0.0316] 88%|████████▊ | 82/93 [37:47<04:58, 27.16s/epoch, loss=0.926, accuracy=0.813, val_loss=0.896, val_accuracy=0.814, lr=0.01] 89%|████████▉ | 83/93 [38:15<04:31, 27.16s/epoch, loss=0.747, accuracy=0.846, val_loss=0.769, val_accuracy=0.83, lr=0.01]  90%|█████████ | 84/93 [38:42<04:05, 27.27s/epoch, loss=0.666, accuracy=0.855, val_loss=0.688, val_accuracy=0.838, lr=0.01] 91%|█████████▏| 85/93 [39:09<03:37, 27.15s/epoch, loss=0.621, accuracy=0.858, val_loss=0.745, val_accuracy=0.809, lr=0.01] 92%|█████████▏| 86/93 [39:36<03:09, 27.12s/epoch, loss=0.597, accuracy=0.86, val_loss=0.789, val_accuracy=0.798, lr=0.01]  94%|█████████▎| 87/93 [40:03<02:42, 27.13s/epoch, loss=0.584, accuracy=0.861, val_loss=0.73, val_accuracy=0.817, lr=0.01] 95%|█████████▍| 88/93 [40:31<02:15, 27.19s/epoch, loss=0.578, accuracy=0.861, val_loss=0.742, val_accuracy=0.804, lr=0.01] 96%|█████████▌| 89/93 [40:58<01:49, 27.30s/epoch, loss=0.57, accuracy=0.863, val_loss=0.959, val_accuracy=0.752, lr=0.00316] 97%|█████████▋| 90/93 [41:26<01:22, 27.45s/epoch, loss=0.569, accuracy=0.865, val_loss=0.824, val_accuracy=0.795, lr=0.01]   98%|█████████▊| 91/93 [41:53<00:54, 27.31s/epoch, loss=0.566, accuracy=0.866, val_loss=0.821, val_accuracy=0.787, lr=0.01] 99%|█████████▉| 92/93 [42:20<00:27, 27.28s/epoch, loss=0.564, accuracy=0.866, val_loss=0.867, val_accuracy=0.78, lr=0.01] 100%|██████████| 93/93 [42:47<00:00, 27.27s/epoch, loss=0.56, accuracy=0.87, val_loss=0.743, val_accuracy=0.801, lr=0.01] 100%|██████████| 93/93 [42:47<00:00, 27.61s/epoch, loss=0.56, accuracy=0.87, val_loss=0.743, val_accuracy=0.801, lr=0.01]
Using real-time data augmentation.
Test score: 0.714169979095459
Test accuracy: 0.8306999802589417


* * * Run SGD for ID = 16_9. * * *


2024-02-20 03:44:06.998026: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 03:44:09.728899: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 03:44:09.730051: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-20 03:44:09.771108: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-20 03:44:09.771152: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 03:44:09.774335: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 03:44:09.774397: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-20 03:44:09.776806: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-20 03:44:09.777527: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-20 03:44:09.780236: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-20 03:44:09.781944: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-20 03:44:09.787385: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 03:44:09.788135: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-20 03:44:09.788244: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 03:44:11.234725: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-20 03:44:11.235799: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 03:44:11.236343: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-20 03:44:11.236378: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 03:44:11.236412: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 03:44:11.236426: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-20 03:44:11.236440: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-20 03:44:11.236454: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-20 03:44:11.236468: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-20 03:44:11.236482: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-20 03:44:11.236496: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 03:44:11.237084: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-20 03:44:11.237127: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 03:44:11.903364: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-20 03:44:11.903422: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-20 03:44:11.903432: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-20 03:44:11.905096: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:18:00.0, compute capability: 6.1)
{'id': '16_09', 'batch_size': 128, 'epochs': 93, 'validation_split': 0.1, 'checkpointing': True, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
x_train shape: (45000, 32, 32, 3)
45000 train samples
5000 validation samples
10000 test samples
y_train shape: (45000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/93 [00:00<?, ?epoch/s]2024-02-20 03:44:12.800317: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-20 03:44:12.801005: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-02-20 03:44:14.946528: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 03:44:15.233753: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 03:44:16.194813: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-20 03:44:16.239351: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/93 [00:59<1:31:15, 59.51s/epoch, loss=3.24, accuracy=0.299, val_loss=3.03, val_accuracy=0.18, lr=0.1]  2%|▏         | 2/93 [01:26<1:01:35, 40.61s/epoch, loss=1.64, accuracy=0.508, val_loss=2.24, val_accuracy=0.401, lr=0.1]  3%|▎         | 3/93 [01:54<51:52, 34.58s/epoch, loss=1.44, accuracy=0.593, val_loss=1.72, val_accuracy=0.49, lr=0.1]     4%|▍         | 4/93 [02:20<46:37, 31.43s/epoch, loss=1.35, accuracy=0.65, val_loss=2.66, val_accuracy=0.359, lr=0.1]  5%|▌         | 5/93 [02:46<43:03, 29.36s/epoch, loss=1.3, accuracy=0.678, val_loss=2.11, val_accuracy=0.469, lr=0.1]  6%|▋         | 6/93 [03:11<40:35, 27.99s/epoch, loss=1.27, accuracy=0.694, val_loss=2, val_accuracy=0.434, lr=0.1]    8%|▊         | 7/93 [03:37<39:00, 27.21s/epoch, loss=1.26, accuracy=0.702, val_loss=1.74, val_accuracy=0.554, lr=0.1]  9%|▊         | 8/93 [04:02<37:31, 26.48s/epoch, loss=1.25, accuracy=0.712, val_loss=2.36, val_accuracy=0.512, lr=0.0316] 10%|▉         | 9/93 [04:27<36:29, 26.06s/epoch, loss=1.24, accuracy=0.718, val_loss=3.52, val_accuracy=0.243, lr=0.1]    11%|█         | 10/93 [04:53<35:54, 25.95s/epoch, loss=1.22, accuracy=0.723, val_loss=1.64, val_accuracy=0.582, lr=0.1] 12%|█▏        | 11/93 [05:18<35:06, 25.69s/epoch, loss=1.22, accuracy=0.725, val_loss=1.78, val_accuracy=0.506, lr=0.1] 13%|█▎        | 12/93 [05:43<34:24, 25.48s/epoch, loss=1.21, accuracy=0.728, val_loss=2.15, val_accuracy=0.478, lr=0.1] 14%|█▍        | 13/93 [06:08<33:53, 25.41s/epoch, loss=1.22, accuracy=0.728, val_loss=1.68, val_accuracy=0.607, lr=0.1] 15%|█▌        | 14/93 [06:34<33:30, 25.45s/epoch, loss=1.2, accuracy=0.732, val_loss=2.81, val_accuracy=0.407, lr=0.1]  16%|█▌        | 15/93 [06:59<33:05, 25.46s/epoch, loss=1.2, accuracy=0.734, val_loss=1.55, val_accuracy=0.624, lr=0.1] 17%|█▋        | 16/93 [07:24<32:26, 25.28s/epoch, loss=1.2, accuracy=0.734, val_loss=1.91, val_accuracy=0.501, lr=0.1] 18%|█▊        | 17/93 [07:49<31:49, 25.13s/epoch, loss=1.19, accuracy=0.741, val_loss=1.96, val_accuracy=0.542, lr=0.1] 19%|█▉        | 18/93 [08:14<31:32, 25.24s/epoch, loss=1.18, accuracy=0.737, val_loss=2.15, val_accuracy=0.444, lr=0.1] 20%|██        | 19/93 [08:40<31:08, 25.25s/epoch, loss=1.18, accuracy=0.741, val_loss=2.24, val_accuracy=0.37, lr=0.1]  22%|██▏       | 20/93 [09:05<30:53, 25.39s/epoch, loss=1.18, accuracy=0.744, val_loss=4.06, val_accuracy=0.388, lr=0.0316] 23%|██▎       | 21/93 [09:31<30:26, 25.37s/epoch, loss=1.17, accuracy=0.744, val_loss=1.73, val_accuracy=0.589, lr=0.1]    24%|██▎       | 22/93 [09:57<30:17, 25.61s/epoch, loss=1.18, accuracy=0.741, val_loss=2.08, val_accuracy=0.427, lr=0.1] 25%|██▍       | 23/93 [10:22<29:49, 25.57s/epoch, loss=1.17, accuracy=0.746, val_loss=2.01, val_accuracy=0.5, lr=0.1]   26%|██▌       | 24/93 [10:48<29:19, 25.50s/epoch, loss=1.17, accuracy=0.748, val_loss=2, val_accuracy=0.549, lr=0.1]  27%|██▋       | 25/93 [11:13<28:43, 25.34s/epoch, loss=1.16, accuracy=0.746, val_loss=4.62, val_accuracy=0.315, lr=0.0316] 28%|██▊       | 26/93 [11:38<28:20, 25.38s/epoch, loss=1.16, accuracy=0.744, val_loss=2.95, val_accuracy=0.392, lr=0.1]    29%|██▉       | 27/93 [12:03<27:53, 25.36s/epoch, loss=1.16, accuracy=0.748, val_loss=2.1, val_accuracy=0.501, lr=0.1]  30%|███       | 28/93 [12:29<27:33, 25.44s/epoch, loss=1.16, accuracy=0.747, val_loss=1.62, val_accuracy=0.602, lr=0.1] 31%|███       | 29/93 [12:55<27:12, 25.51s/epoch, loss=1.16, accuracy=0.748, val_loss=1.84, val_accuracy=0.536, lr=0.1] 32%|███▏      | 30/93 [13:20<26:45, 25.49s/epoch, loss=1.16, accuracy=0.747, val_loss=2.23, val_accuracy=0.465, lr=0.0316] 33%|███▎      | 31/93 [13:45<26:10, 25.32s/epoch, loss=1.16, accuracy=0.747, val_loss=1.56, val_accuracy=0.603, lr=0.1]    34%|███▍      | 32/93 [14:10<25:43, 25.30s/epoch, loss=1.16, accuracy=0.749, val_loss=2.14, val_accuracy=0.441, lr=0.1] 35%|███▌      | 33/93 [14:35<25:14, 25.24s/epoch, loss=1.15, accuracy=0.75, val_loss=2.21, val_accuracy=0.481, lr=0.1]  37%|███▋      | 34/93 [15:01<24:47, 25.21s/epoch, loss=1.15, accuracy=0.749, val_loss=1.96, val_accuracy=0.548, lr=0.1] 38%|███▊      | 35/93 [15:26<24:20, 25.18s/epoch, loss=1.15, accuracy=0.748, val_loss=1.88, val_accuracy=0.552, lr=0.0316] 39%|███▊      | 36/93 [15:50<23:45, 25.00s/epoch, loss=1.15, accuracy=0.75, val_loss=1.58, val_accuracy=0.613, lr=0.1]     40%|███▉      | 37/93 [16:17<23:56, 25.65s/epoch, loss=1.16, accuracy=0.751, val_loss=1.64, val_accuracy=0.588, lr=0.1] 41%|████      | 38/93 [16:43<23:31, 25.66s/epoch, loss=1.14, accuracy=0.754, val_loss=1.99, val_accuracy=0.464, lr=0.1] 42%|████▏     | 39/93 [17:08<22:54, 25.45s/epoch, loss=1.14, accuracy=0.752, val_loss=1.94, val_accuracy=0.502, lr=0.1] 43%|████▎     | 40/93 [17:33<22:15, 25.19s/epoch, loss=1.15, accuracy=0.75, val_loss=1.64, val_accuracy=0.605, lr=0.0316] 44%|████▍     | 41/93 [17:58<21:53, 25.26s/epoch, loss=1.14, accuracy=0.751, val_loss=2.16, val_accuracy=0.521, lr=0.1]   45%|████▌     | 42/93 [18:23<21:27, 25.25s/epoch, loss=1.15, accuracy=0.748, val_loss=3.16, val_accuracy=0.371, lr=0.1] 46%|████▌     | 43/93 [18:49<21:07, 25.34s/epoch, loss=1.14, accuracy=0.754, val_loss=1.86, val_accuracy=0.539, lr=0.1] 47%|████▋     | 44/93 [19:14<20:38, 25.27s/epoch, loss=1.14, accuracy=0.751, val_loss=2.17, val_accuracy=0.503, lr=0.1] 48%|████▊     | 45/93 [19:39<20:09, 25.21s/epoch, loss=1.15, accuracy=0.751, val_loss=1.94, val_accuracy=0.46, lr=0.0316] 49%|████▉     | 46/93 [20:04<19:47, 25.26s/epoch, loss=1.14, accuracy=0.754, val_loss=2.18, val_accuracy=0.463, lr=0.1]   51%|█████     | 47/93 [20:29<19:18, 25.19s/epoch, loss=1.14, accuracy=0.755, val_loss=2.45, val_accuracy=0.448, lr=0.1] 52%|█████▏    | 48/93 [20:54<18:52, 25.17s/epoch, loss=1.14, accuracy=0.753, val_loss=1.58, val_accuracy=0.608, lr=0.1] 53%|█████▎    | 49/93 [21:20<18:29, 25.21s/epoch, loss=1.13, accuracy=0.756, val_loss=1.44, val_accuracy=0.649, lr=0.1] 54%|█████▍    | 50/93 [21:45<18:05, 25.25s/epoch, loss=1.13, accuracy=0.755, val_loss=1.62, val_accuracy=0.572, lr=0.1] 55%|█████▍    | 51/93 [22:11<17:44, 25.34s/epoch, loss=1.14, accuracy=0.756, val_loss=1.95, val_accuracy=0.505, lr=0.1] 56%|█████▌    | 52/93 [22:37<17:35, 25.74s/epoch, loss=1.14, accuracy=0.754, val_loss=1.84, val_accuracy=0.54, lr=0.1]  57%|█████▋    | 53/93 [23:05<17:33, 26.34s/epoch, loss=1.13, accuracy=0.757, val_loss=1.95, val_accuracy=0.473, lr=0.1] 58%|█████▊    | 54/93 [23:33<17:22, 26.74s/epoch, loss=1.14, accuracy=0.751, val_loss=2.03, val_accuracy=0.494, lr=0.0316] 59%|█████▉    | 55/93 [24:00<17:06, 27.02s/epoch, loss=1.14, accuracy=0.755, val_loss=2.65, val_accuracy=0.495, lr=0.1]    60%|██████    | 56/93 [24:28<16:47, 27.24s/epoch, loss=1.14, accuracy=0.756, val_loss=1.85, val_accuracy=0.545, lr=0.1] 61%|██████▏   | 57/93 [24:56<16:26, 27.42s/epoch, loss=1.14, accuracy=0.756, val_loss=2.83, val_accuracy=0.333, lr=0.1] 62%|██████▏   | 58/93 [25:24<16:01, 27.47s/epoch, loss=1.14, accuracy=0.754, val_loss=2.3, val_accuracy=0.454, lr=0.1]  63%|██████▎   | 59/93 [25:51<15:36, 27.55s/epoch, loss=1.14, accuracy=0.754, val_loss=2.62, val_accuracy=0.386, lr=0.0316] 65%|██████▍   | 60/93 [26:19<15:12, 27.64s/epoch, loss=1.14, accuracy=0.755, val_loss=2.03, val_accuracy=0.515, lr=0.1]    66%|██████▌   | 61/93 [26:47<14:44, 27.63s/epoch, loss=1.14, accuracy=0.755, val_loss=1.54, val_accuracy=0.634, lr=0.1] 67%|██████▋   | 62/93 [27:14<14:16, 27.62s/epoch, loss=1.14, accuracy=0.755, val_loss=1.9, val_accuracy=0.53, lr=0.1]   68%|██████▊   | 63/93 [27:42<13:49, 27.64s/epoch, loss=1.13, accuracy=0.755, val_loss=1.79, val_accuracy=0.543, lr=0.1] 69%|██████▉   | 64/93 [28:10<13:21, 27.65s/epoch, loss=1.12, accuracy=0.757, val_loss=2.37, val_accuracy=0.421, lr=0.0316] 70%|██████▉   | 65/93 [28:38<12:55, 27.70s/epoch, loss=1.13, accuracy=0.756, val_loss=2.15, val_accuracy=0.529, lr=0.1]    71%|███████   | 66/93 [29:05<12:27, 27.69s/epoch, loss=1.13, accuracy=0.754, val_loss=2.08, val_accuracy=0.522, lr=0.1] 72%|███████▏  | 67/93 [29:33<11:59, 27.68s/epoch, loss=1.14, accuracy=0.755, val_loss=2.39, val_accuracy=0.43, lr=0.1]  73%|███████▎  | 68/93 [30:01<11:32, 27.70s/epoch, loss=1.12, accuracy=0.757, val_loss=1.62, val_accuracy=0.597, lr=0.1] 74%|███████▍  | 69/93 [30:28<11:04, 27.67s/epoch, loss=1.13, accuracy=0.755, val_loss=2.17, val_accuracy=0.537, lr=0.0316] 75%|███████▌  | 70/93 [30:56<10:35, 27.64s/epoch, loss=1.12, accuracy=0.758, val_loss=1.9, val_accuracy=0.508, lr=0.1]     76%|███████▋  | 71/93 [31:24<10:08, 27.65s/epoch, loss=1.14, accuracy=0.756, val_loss=1.99, val_accuracy=0.51, lr=0.1] 77%|███████▋  | 72/93 [31:52<09:42, 27.75s/epoch, loss=1.13, accuracy=0.756, val_loss=1.96, val_accuracy=0.514, lr=0.1] 78%|███████▊  | 73/93 [32:20<09:16, 27.83s/epoch, loss=1.14, accuracy=0.75, val_loss=1.56, val_accuracy=0.625, lr=0.1]  80%|███████▉  | 74/93 [32:47<08:47, 27.78s/epoch, loss=1.14, accuracy=0.754, val_loss=1.9, val_accuracy=0.472, lr=0.0316] 81%|████████  | 75/93 [33:15<08:19, 27.76s/epoch, loss=1.13, accuracy=0.756, val_loss=2.53, val_accuracy=0.412, lr=0.1]   82%|████████▏ | 76/93 [33:42<07:50, 27.69s/epoch, loss=1.14, accuracy=0.754, val_loss=5.07, val_accuracy=0.272, lr=0.1] 83%|████████▎ | 77/93 [34:10<07:23, 27.70s/epoch, loss=1.13, accuracy=0.756, val_loss=2, val_accuracy=0.538, lr=0.1]    84%|████████▍ | 78/93 [34:38<06:55, 27.71s/epoch, loss=1.13, accuracy=0.752, val_loss=1.58, val_accuracy=0.603, lr=0.1] 85%|████████▍ | 79/93 [35:06<06:28, 27.75s/epoch, loss=1.13, accuracy=0.755, val_loss=2.01, val_accuracy=0.458, lr=0.0316] 86%|████████▌ | 80/93 [35:33<06:00, 27.74s/epoch, loss=1.13, accuracy=0.756, val_loss=2.07, val_accuracy=0.442, lr=0.1]    87%|████████▋ | 81/93 [36:01<05:32, 27.72s/epoch, loss=1.13, accuracy=0.752, val_loss=2.23, val_accuracy=0.418, lr=0.1] 88%|████████▊ | 82/93 [36:29<05:06, 27.86s/epoch, loss=0.918, accuracy=0.814, val_loss=0.934, val_accuracy=0.791, lr=0.01] 89%|████████▉ | 83/93 [36:57<04:38, 27.85s/epoch, loss=0.752, accuracy=0.844, val_loss=0.789, val_accuracy=0.818, lr=0.01] 90%|█████████ | 84/93 [37:25<04:09, 27.76s/epoch, loss=0.668, accuracy=0.853, val_loss=0.776, val_accuracy=0.811, lr=0.01] 91%|█████████▏| 85/93 [37:52<03:42, 27.77s/epoch, loss=0.621, accuracy=0.858, val_loss=0.912, val_accuracy=0.76, lr=0.01]  92%|█████████▏| 86/93 [38:21<03:15, 27.92s/epoch, loss=0.595, accuracy=0.859, val_loss=0.685, val_accuracy=0.832, lr=0.01] 94%|█████████▎| 87/93 [38:48<02:46, 27.80s/epoch, loss=0.583, accuracy=0.862, val_loss=0.727, val_accuracy=0.814, lr=0.01] 95%|█████████▍| 88/93 [39:16<02:18, 27.74s/epoch, loss=0.574, accuracy=0.862, val_loss=0.754, val_accuracy=0.803, lr=0.01] 96%|█████████▌| 89/93 [39:43<01:50, 27.68s/epoch, loss=0.571, accuracy=0.864, val_loss=0.792, val_accuracy=0.789, lr=0.01] 97%|█████████▋| 90/93 [40:11<01:22, 27.65s/epoch, loss=0.568, accuracy=0.865, val_loss=0.754, val_accuracy=0.804, lr=0.01] 98%|█████████▊| 91/93 [40:39<00:55, 27.70s/epoch, loss=0.563, accuracy=0.868, val_loss=0.835, val_accuracy=0.77, lr=0.00316] 99%|█████████▉| 92/93 [41:06<00:27, 27.70s/epoch, loss=0.561, accuracy=0.867, val_loss=0.734, val_accuracy=0.815, lr=0.01]  100%|██████████| 93/93 [41:34<00:00, 27.70s/epoch, loss=0.561, accuracy=0.869, val_loss=0.884, val_accuracy=0.761, lr=0.01]100%|██████████| 93/93 [41:34<00:00, 26.82s/epoch, loss=0.561, accuracy=0.869, val_loss=0.884, val_accuracy=0.761, lr=0.01]
Using real-time data augmentation.
Test score: 0.7005195021629333
Test accuracy: 0.8212000131607056


* * * Run SGD for ID = 16_10. * * *


2024-02-20 04:25:55.273715: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 04:25:58.182592: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 04:25:58.183942: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-20 04:25:58.227019: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-20 04:25:58.227071: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 04:25:58.230749: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 04:25:58.230848: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-20 04:25:58.233674: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-20 04:25:58.235017: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-20 04:25:58.238176: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-20 04:25:58.240135: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-20 04:25:58.246248: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 04:25:58.247109: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-20 04:25:58.247240: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 04:25:59.757550: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-20 04:25:59.758618: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 04:25:59.759203: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-20 04:25:59.759252: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 04:25:59.759299: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 04:25:59.759313: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-20 04:25:59.759327: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-20 04:25:59.759341: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-20 04:25:59.759355: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-20 04:25:59.759370: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-20 04:25:59.759384: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 04:25:59.759977: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-20 04:25:59.760023: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 04:26:00.413199: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-20 04:26:00.413257: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-20 04:26:00.413269: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-20 04:26:00.414453: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:18:00.0, compute capability: 6.1)
{'id': '16_10', 'batch_size': 128, 'epochs': 93, 'validation_split': 0.1, 'checkpointing': True, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
x_train shape: (45000, 32, 32, 3)
45000 train samples
5000 validation samples
10000 test samples
y_train shape: (45000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/93 [00:00<?, ?epoch/s]2024-02-20 04:26:01.363868: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-20 04:26:01.364604: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-02-20 04:26:03.624786: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 04:26:03.959095: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 04:26:04.951914: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-20 04:26:05.004330: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/93 [01:00<1:33:26, 60.93s/epoch, loss=3.55, accuracy=0.24, val_loss=2.35, val_accuracy=0.264, lr=0.1]  2%|▏         | 2/93 [01:28<1:02:34, 41.25s/epoch, loss=1.66, accuracy=0.482, val_loss=2.06, val_accuracy=0.363, lr=0.1]  3%|▎         | 3/93 [01:55<52:27, 34.98s/epoch, loss=1.39, accuracy=0.597, val_loss=2.05, val_accuracy=0.428, lr=0.1]    4%|▍         | 4/93 [02:23<47:23, 31.95s/epoch, loss=1.3, accuracy=0.653, val_loss=1.78, val_accuracy=0.54, lr=0.1]    5%|▌         | 5/93 [02:50<44:22, 30.25s/epoch, loss=1.22, accuracy=0.691, val_loss=1.96, val_accuracy=0.486, lr=0.1]  6%|▋         | 6/93 [03:17<42:27, 29.28s/epoch, loss=1.2, accuracy=0.709, val_loss=2.21, val_accuracy=0.457, lr=0.1]   8%|▊         | 7/93 [03:45<41:04, 28.66s/epoch, loss=1.19, accuracy=0.718, val_loss=2.32, val_accuracy=0.438, lr=0.1]  9%|▊         | 8/93 [04:12<39:59, 28.23s/epoch, loss=1.19, accuracy=0.723, val_loss=2.15, val_accuracy=0.451, lr=0.1] 10%|▉         | 9/93 [04:39<39:06, 27.93s/epoch, loss=1.18, accuracy=0.727, val_loss=3.23, val_accuracy=0.267, lr=0.0316] 11%|█         | 10/93 [05:07<38:23, 27.75s/epoch, loss=1.18, accuracy=0.73, val_loss=2.33, val_accuracy=0.461, lr=0.1]    12%|█▏        | 11/93 [05:34<37:50, 27.68s/epoch, loss=1.18, accuracy=0.734, val_loss=1.92, val_accuracy=0.489, lr=0.1] 13%|█▎        | 12/93 [06:02<37:13, 27.57s/epoch, loss=1.17, accuracy=0.733, val_loss=2.5, val_accuracy=0.258, lr=0.1]  14%|█▍        | 13/93 [06:29<36:40, 27.50s/epoch, loss=1.16, accuracy=0.738, val_loss=3.02, val_accuracy=0.381, lr=0.1] 15%|█▌        | 14/93 [06:56<36:08, 27.45s/epoch, loss=1.17, accuracy=0.738, val_loss=2.05, val_accuracy=0.531, lr=0.0316] 16%|█▌        | 15/93 [07:24<35:45, 27.50s/epoch, loss=1.17, accuracy=0.74, val_loss=1.59, val_accuracy=0.614, lr=0.1]     17%|█▋        | 16/93 [07:51<35:11, 27.42s/epoch, loss=1.16, accuracy=0.742, val_loss=1.64, val_accuracy=0.565, lr=0.1] 18%|█▊        | 17/93 [08:18<34:40, 27.37s/epoch, loss=1.15, accuracy=0.745, val_loss=2.07, val_accuracy=0.52, lr=0.1]  19%|█▉        | 18/93 [08:46<34:13, 27.38s/epoch, loss=1.16, accuracy=0.743, val_loss=2.69, val_accuracy=0.481, lr=0.1] 20%|██        | 19/93 [09:13<33:43, 27.35s/epoch, loss=1.15, accuracy=0.746, val_loss=1.64, val_accuracy=0.593, lr=0.1] 22%|██▏       | 20/93 [09:40<33:11, 27.29s/epoch, loss=1.15, accuracy=0.746, val_loss=2.07, val_accuracy=0.506, lr=0.0316] 23%|██▎       | 21/93 [10:07<32:42, 27.25s/epoch, loss=1.15, accuracy=0.745, val_loss=1.59, val_accuracy=0.598, lr=0.1]    24%|██▎       | 22/93 [10:35<32:17, 27.29s/epoch, loss=1.15, accuracy=0.746, val_loss=2.05, val_accuracy=0.489, lr=0.1] 25%|██▍       | 23/93 [11:02<31:48, 27.27s/epoch, loss=1.14, accuracy=0.747, val_loss=1.96, val_accuracy=0.52, lr=0.1]  26%|██▌       | 24/93 [11:29<31:22, 27.28s/epoch, loss=1.14, accuracy=0.75, val_loss=2.54, val_accuracy=0.423, lr=0.1] 27%|██▋       | 25/93 [11:57<30:56, 27.30s/epoch, loss=1.13, accuracy=0.752, val_loss=2.19, val_accuracy=0.504, lr=0.0316] 28%|██▊       | 26/93 [12:24<30:32, 27.35s/epoch, loss=1.14, accuracy=0.75, val_loss=5.46, val_accuracy=0.258, lr=0.1]     29%|██▉       | 27/93 [12:52<30:10, 27.43s/epoch, loss=1.14, accuracy=0.747, val_loss=1.5, val_accuracy=0.642, lr=0.1] 30%|███       | 28/93 [13:19<29:38, 27.35s/epoch, loss=1.14, accuracy=0.751, val_loss=1.8, val_accuracy=0.514, lr=0.1] 31%|███       | 29/93 [13:47<29:20, 27.51s/epoch, loss=1.13, accuracy=0.749, val_loss=1.4, val_accuracy=0.662, lr=0.1] 32%|███▏      | 30/93 [14:14<28:46, 27.41s/epoch, loss=1.13, accuracy=0.753, val_loss=1.96, val_accuracy=0.479, lr=0.1] 33%|███▎      | 31/93 [14:41<28:18, 27.39s/epoch, loss=1.13, accuracy=0.753, val_loss=1.76, val_accuracy=0.513, lr=0.1] 34%|███▍      | 32/93 [15:08<27:48, 27.35s/epoch, loss=1.12, accuracy=0.754, val_loss=2.33, val_accuracy=0.44, lr=0.1]  35%|███▌      | 33/93 [15:35<27:13, 27.23s/epoch, loss=1.12, accuracy=0.751, val_loss=3.49, val_accuracy=0.326, lr=0.1] 37%|███▋      | 34/93 [16:03<26:46, 27.22s/epoch, loss=1.13, accuracy=0.752, val_loss=2.46, val_accuracy=0.455, lr=0.0316] 38%|███▊      | 35/93 [16:30<26:20, 27.25s/epoch, loss=1.12, accuracy=0.753, val_loss=2.84, val_accuracy=0.318, lr=0.1]    39%|███▊      | 36/93 [16:57<25:55, 27.29s/epoch, loss=1.13, accuracy=0.754, val_loss=2.47, val_accuracy=0.368, lr=0.1] 40%|███▉      | 37/93 [17:25<25:30, 27.33s/epoch, loss=1.12, accuracy=0.757, val_loss=1.63, val_accuracy=0.593, lr=0.1] 41%|████      | 38/93 [17:52<25:03, 27.34s/epoch, loss=1.12, accuracy=0.754, val_loss=1.85, val_accuracy=0.512, lr=0.1] 42%|████▏     | 39/93 [18:20<24:37, 27.37s/epoch, loss=1.12, accuracy=0.754, val_loss=2.36, val_accuracy=0.484, lr=0.0316] 43%|████▎     | 40/93 [18:47<24:12, 27.41s/epoch, loss=1.13, accuracy=0.755, val_loss=2.07, val_accuracy=0.506, lr=0.1]    44%|████▍     | 41/93 [19:14<23:45, 27.40s/epoch, loss=1.12, accuracy=0.757, val_loss=2.04, val_accuracy=0.504, lr=0.1] 45%|████▌     | 42/93 [19:42<23:19, 27.45s/epoch, loss=1.12, accuracy=0.756, val_loss=1.85, val_accuracy=0.528, lr=0.1] 46%|████▌     | 43/93 [20:09<22:44, 27.30s/epoch, loss=1.12, accuracy=0.755, val_loss=4.33, val_accuracy=0.293, lr=0.1] 47%|████▋     | 44/93 [20:36<22:18, 27.32s/epoch, loss=1.12, accuracy=0.753, val_loss=2.23, val_accuracy=0.472, lr=0.0316] 48%|████▊     | 45/93 [21:04<21:50, 27.30s/epoch, loss=1.12, accuracy=0.754, val_loss=2.14, val_accuracy=0.513, lr=0.1]    49%|████▉     | 46/93 [21:31<21:24, 27.34s/epoch, loss=1.12, accuracy=0.757, val_loss=1.72, val_accuracy=0.574, lr=0.1] 51%|█████     | 47/93 [21:59<21:00, 27.40s/epoch, loss=1.12, accuracy=0.756, val_loss=4.47, val_accuracy=0.16, lr=0.1]  52%|█████▏    | 48/93 [22:26<20:30, 27.34s/epoch, loss=1.12, accuracy=0.756, val_loss=1.81, val_accuracy=0.56, lr=0.1] 53%|█████▎    | 49/93 [22:53<20:03, 27.36s/epoch, loss=1.11, accuracy=0.76, val_loss=2.05, val_accuracy=0.448, lr=0.0316] 54%|█████▍    | 50/93 [23:20<19:35, 27.34s/epoch, loss=1.12, accuracy=0.755, val_loss=5.1, val_accuracy=0.239, lr=0.1]    55%|█████▍    | 51/93 [23:48<19:06, 27.30s/epoch, loss=1.11, accuracy=0.758, val_loss=1.66, val_accuracy=0.588, lr=0.1] 56%|█████▌    | 52/93 [24:15<18:37, 27.26s/epoch, loss=1.11, accuracy=0.758, val_loss=3.97, val_accuracy=0.234, lr=0.1] 57%|█████▋    | 53/93 [24:42<18:12, 27.31s/epoch, loss=1.12, accuracy=0.756, val_loss=1.37, val_accuracy=0.681, lr=0.1] 58%|█████▊    | 54/93 [25:09<17:43, 27.27s/epoch, loss=1.12, accuracy=0.755, val_loss=1.78, val_accuracy=0.549, lr=0.1] 59%|█████▉    | 55/93 [25:37<17:15, 27.24s/epoch, loss=1.11, accuracy=0.757, val_loss=2.32, val_accuracy=0.488, lr=0.1] 60%|██████    | 56/93 [26:04<16:48, 27.25s/epoch, loss=1.11, accuracy=0.759, val_loss=2.35, val_accuracy=0.421, lr=0.1] 61%|██████▏   | 57/93 [26:31<16:19, 27.22s/epoch, loss=1.11, accuracy=0.76, val_loss=2.07, val_accuracy=0.453, lr=0.1]  62%|██████▏   | 58/93 [26:58<15:53, 27.23s/epoch, loss=1.11, accuracy=0.757, val_loss=2.26, val_accuracy=0.443, lr=0.0316] 63%|██████▎   | 59/93 [27:26<15:26, 27.24s/epoch, loss=1.12, accuracy=0.758, val_loss=2.89, val_accuracy=0.427, lr=0.1]    65%|██████▍   | 60/93 [27:53<14:58, 27.23s/epoch, loss=1.11, accuracy=0.761, val_loss=1.71, val_accuracy=0.616, lr=0.1] 66%|██████▌   | 61/93 [28:20<14:29, 27.16s/epoch, loss=1.11, accuracy=0.759, val_loss=3.74, val_accuracy=0.24, lr=0.1]  67%|██████▋   | 62/93 [28:47<14:01, 27.15s/epoch, loss=1.11, accuracy=0.761, val_loss=1.85, val_accuracy=0.522, lr=0.1] 68%|██████▊   | 63/93 [29:14<13:34, 27.16s/epoch, loss=1.11, accuracy=0.757, val_loss=2.85, val_accuracy=0.452, lr=0.0316] 69%|██████▉   | 64/93 [29:41<13:06, 27.13s/epoch, loss=1.11, accuracy=0.759, val_loss=2.02, val_accuracy=0.544, lr=0.1]    70%|██████▉   | 65/93 [30:08<12:40, 27.16s/epoch, loss=1.11, accuracy=0.759, val_loss=1.74, val_accuracy=0.526, lr=0.1] 71%|███████   | 66/93 [30:35<12:13, 27.16s/epoch, loss=1.1, accuracy=0.763, val_loss=1.99, val_accuracy=0.473, lr=0.1]  72%|███████▏  | 67/93 [31:03<11:45, 27.13s/epoch, loss=1.11, accuracy=0.759, val_loss=2.49, val_accuracy=0.425, lr=0.1] 73%|███████▎  | 68/93 [31:30<11:19, 27.18s/epoch, loss=1.11, accuracy=0.759, val_loss=1.94, val_accuracy=0.509, lr=0.0316] 74%|███████▍  | 69/93 [31:57<10:52, 27.20s/epoch, loss=1.11, accuracy=0.763, val_loss=2.71, val_accuracy=0.384, lr=0.1]    75%|███████▌  | 70/93 [32:24<10:25, 27.18s/epoch, loss=1.12, accuracy=0.758, val_loss=1.46, val_accuracy=0.633, lr=0.1] 76%|███████▋  | 71/93 [32:51<09:56, 27.13s/epoch, loss=1.11, accuracy=0.761, val_loss=2.01, val_accuracy=0.452, lr=0.1] 77%|███████▋  | 72/93 [33:18<09:29, 27.10s/epoch, loss=1.12, accuracy=0.758, val_loss=1.53, val_accuracy=0.609, lr=0.1] 78%|███████▊  | 73/93 [33:45<09:02, 27.11s/epoch, loss=1.12, accuracy=0.759, val_loss=2.42, val_accuracy=0.439, lr=0.0316] 80%|███████▉  | 74/93 [34:12<08:35, 27.11s/epoch, loss=1.11, accuracy=0.759, val_loss=2.29, val_accuracy=0.419, lr=0.1]    81%|████████  | 75/93 [34:40<08:08, 27.12s/epoch, loss=1.11, accuracy=0.759, val_loss=1.96, val_accuracy=0.494, lr=0.1] 82%|████████▏ | 76/93 [35:07<07:40, 27.06s/epoch, loss=1.11, accuracy=0.758, val_loss=2.37, val_accuracy=0.451, lr=0.1] 83%|████████▎ | 77/93 [35:34<07:13, 27.07s/epoch, loss=1.11, accuracy=0.76, val_loss=2.87, val_accuracy=0.394, lr=0.1]  84%|████████▍ | 78/93 [36:01<06:46, 27.07s/epoch, loss=1.11, accuracy=0.76, val_loss=2.35, val_accuracy=0.41, lr=0.0316] 85%|████████▍ | 79/93 [36:28<06:20, 27.14s/epoch, loss=1.11, accuracy=0.756, val_loss=1.76, val_accuracy=0.541, lr=0.1]  86%|████████▌ | 80/93 [36:55<05:52, 27.14s/epoch, loss=1.11, accuracy=0.759, val_loss=1.54, val_accuracy=0.603, lr=0.1] 87%|████████▋ | 81/93 [37:22<05:25, 27.11s/epoch, loss=1.1, accuracy=0.76, val_loss=2.7, val_accuracy=0.392, lr=0.1]    88%|████████▊ | 82/93 [37:50<04:59, 27.20s/epoch, loss=0.916, accuracy=0.813, val_loss=1.02, val_accuracy=0.762, lr=0.01] 89%|████████▉ | 83/93 [38:17<04:32, 27.27s/epoch, loss=0.735, accuracy=0.85, val_loss=0.834, val_accuracy=0.801, lr=0.01] 90%|█████████ | 84/93 [38:44<04:04, 27.12s/epoch, loss=0.656, accuracy=0.859, val_loss=0.848, val_accuracy=0.782, lr=0.01] 91%|█████████▏| 85/93 [39:11<03:37, 27.18s/epoch, loss=0.611, accuracy=0.86, val_loss=0.776, val_accuracy=0.807, lr=0.01]  92%|█████████▏| 86/93 [39:38<03:09, 27.13s/epoch, loss=0.585, accuracy=0.862, val_loss=0.765, val_accuracy=0.802, lr=0.01] 94%|█████████▎| 87/93 [40:05<02:42, 27.09s/epoch, loss=0.569, accuracy=0.864, val_loss=0.748, val_accuracy=0.803, lr=0.01] 95%|█████████▍| 88/93 [40:33<02:16, 27.21s/epoch, loss=0.565, accuracy=0.865, val_loss=0.726, val_accuracy=0.81, lr=0.01]  96%|█████████▌| 89/93 [41:00<01:48, 27.11s/epoch, loss=0.559, accuracy=0.866, val_loss=0.895, val_accuracy=0.775, lr=0.01] 97%|█████████▋| 90/93 [41:27<01:21, 27.13s/epoch, loss=0.555, accuracy=0.868, val_loss=0.932, val_accuracy=0.77, lr=0.01]  98%|█████████▊| 91/93 [41:54<00:54, 27.13s/epoch, loss=0.553, accuracy=0.868, val_loss=1.17, val_accuracy=0.695, lr=0.01] 99%|█████████▉| 92/93 [42:21<00:27, 27.06s/epoch, loss=0.557, accuracy=0.868, val_loss=0.786, val_accuracy=0.789, lr=0.01]100%|██████████| 93/93 [42:48<00:00, 27.11s/epoch, loss=0.555, accuracy=0.871, val_loss=0.801, val_accuracy=0.78, lr=0.00316]100%|██████████| 93/93 [42:48<00:00, 27.62s/epoch, loss=0.555, accuracy=0.871, val_loss=0.801, val_accuracy=0.78, lr=0.00316]
Using real-time data augmentation.
Test score: 0.7333579063415527
Test accuracy: 0.8140000104904175


* * * Run SGD for ID = 16_11. * * *


2024-02-20 05:08:56.178860: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 05:08:59.102657: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 05:08:59.103974: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-20 05:08:59.146872: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-20 05:08:59.146928: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 05:08:59.150605: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 05:08:59.150680: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-20 05:08:59.153262: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-20 05:08:59.154023: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-20 05:08:59.156659: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-20 05:08:59.158427: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-20 05:08:59.163675: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 05:08:59.164427: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-20 05:08:59.164523: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 05:09:00.624906: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-20 05:09:00.625631: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 05:09:00.626445: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-20 05:09:00.626484: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 05:09:00.626531: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 05:09:00.626546: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-20 05:09:00.626560: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-20 05:09:00.626574: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-20 05:09:00.626589: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-20 05:09:00.626603: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-20 05:09:00.626617: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 05:09:00.627195: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-20 05:09:00.627244: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 05:09:01.275508: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-20 05:09:01.275561: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-20 05:09:01.275573: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-20 05:09:01.276706: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:18:00.0, compute capability: 6.1)
{'id': '16_11', 'batch_size': 128, 'epochs': 93, 'validation_split': 0.1, 'checkpointing': True, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
x_train shape: (45000, 32, 32, 3)
45000 train samples
5000 validation samples
10000 test samples
y_train shape: (45000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/93 [00:00<?, ?epoch/s]2024-02-20 05:09:02.180523: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-20 05:09:02.192997: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-02-20 05:09:04.324957: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 05:09:04.676436: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 05:09:05.704396: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-20 05:09:05.757532: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/93 [01:02<1:35:51, 62.52s/epoch, loss=3.34, accuracy=0.274, val_loss=2.7, val_accuracy=0.186, lr=0.1]  2%|▏         | 2/93 [01:30<1:03:44, 42.03s/epoch, loss=1.6, accuracy=0.516, val_loss=2.5, val_accuracy=0.373, lr=0.1]   3%|▎         | 3/93 [01:57<53:05, 35.40s/epoch, loss=1.37, accuracy=0.625, val_loss=2.15, val_accuracy=0.393, lr=0.1]  4%|▍         | 4/93 [02:25<47:54, 32.30s/epoch, loss=1.3, accuracy=0.665, val_loss=2.19, val_accuracy=0.463, lr=0.1]   5%|▌         | 5/93 [02:52<44:40, 30.46s/epoch, loss=1.26, accuracy=0.691, val_loss=2.4, val_accuracy=0.4, lr=0.1]    6%|▋         | 6/93 [03:19<42:37, 29.39s/epoch, loss=1.24, accuracy=0.703, val_loss=1.97, val_accuracy=0.439, lr=0.1]  8%|▊         | 7/93 [03:47<41:17, 28.80s/epoch, loss=1.22, accuracy=0.711, val_loss=2.31, val_accuracy=0.495, lr=0.1]  9%|▊         | 8/93 [04:14<40:11, 28.37s/epoch, loss=1.22, accuracy=0.713, val_loss=1.67, val_accuracy=0.57, lr=0.1]  10%|▉         | 9/93 [04:42<39:12, 28.01s/epoch, loss=1.21, accuracy=0.721, val_loss=2.75, val_accuracy=0.405, lr=0.1] 11%|█         | 10/93 [05:09<38:30, 27.84s/epoch, loss=1.2, accuracy=0.726, val_loss=2.13, val_accuracy=0.489, lr=0.1] 12%|█▏        | 11/93 [05:36<37:53, 27.73s/epoch, loss=1.2, accuracy=0.725, val_loss=2.18, val_accuracy=0.462, lr=0.1] 13%|█▎        | 12/93 [06:04<37:16, 27.61s/epoch, loss=1.2, accuracy=0.728, val_loss=2.6, val_accuracy=0.373, lr=0.1]  14%|█▍        | 13/93 [06:31<36:50, 27.63s/epoch, loss=1.19, accuracy=0.731, val_loss=1.46, val_accuracy=0.636, lr=0.1] 15%|█▌        | 14/93 [06:59<36:13, 27.52s/epoch, loss=1.18, accuracy=0.735, val_loss=4.03, val_accuracy=0.299, lr=0.1] 16%|█▌        | 15/93 [07:26<35:44, 27.50s/epoch, loss=1.18, accuracy=0.735, val_loss=3.2, val_accuracy=0.35, lr=0.1]   17%|█▋        | 16/93 [07:54<35:14, 27.46s/epoch, loss=1.18, accuracy=0.738, val_loss=2.21, val_accuracy=0.461, lr=0.1] 18%|█▊        | 17/93 [08:21<34:44, 27.43s/epoch, loss=1.18, accuracy=0.74, val_loss=2.65, val_accuracy=0.377, lr=0.1]  19%|█▉        | 18/93 [08:48<34:15, 27.41s/epoch, loss=1.18, accuracy=0.74, val_loss=1.52, val_accuracy=0.618, lr=0.0316] 20%|██        | 19/93 [09:16<33:47, 27.40s/epoch, loss=1.17, accuracy=0.739, val_loss=1.67, val_accuracy=0.597, lr=0.1]   22%|██▏       | 20/93 [09:43<33:19, 27.39s/epoch, loss=1.17, accuracy=0.743, val_loss=2.32, val_accuracy=0.427, lr=0.1] 23%|██▎       | 21/93 [10:10<32:51, 27.38s/epoch, loss=1.17, accuracy=0.741, val_loss=1.83, val_accuracy=0.589, lr=0.1] 24%|██▎       | 22/93 [10:38<32:24, 27.38s/epoch, loss=1.17, accuracy=0.741, val_loss=3.28, val_accuracy=0.321, lr=0.1] 25%|██▍       | 23/93 [11:05<31:53, 27.34s/epoch, loss=1.17, accuracy=0.743, val_loss=2, val_accuracy=0.469, lr=0.0316] 26%|██▌       | 24/93 [11:32<31:23, 27.30s/epoch, loss=1.16, accuracy=0.746, val_loss=2.62, val_accuracy=0.458, lr=0.1] 27%|██▋       | 25/93 [11:58<30:23, 26.82s/epoch, loss=1.17, accuracy=0.743, val_loss=2.41, val_accuracy=0.395, lr=0.1] 28%|██▊       | 26/93 [12:24<29:33, 26.46s/epoch, loss=1.16, accuracy=0.742, val_loss=1.73, val_accuracy=0.568, lr=0.1] 29%|██▉       | 27/93 [12:49<28:47, 26.18s/epoch, loss=1.17, accuracy=0.744, val_loss=1.58, val_accuracy=0.618, lr=0.1] 30%|███       | 28/93 [13:14<27:53, 25.74s/epoch, loss=1.16, accuracy=0.748, val_loss=2.52, val_accuracy=0.435, lr=0.0316] 31%|███       | 29/93 [13:39<27:09, 25.46s/epoch, loss=1.16, accuracy=0.745, val_loss=3.07, val_accuracy=0.298, lr=0.1]    32%|███▏      | 30/93 [14:04<26:34, 25.31s/epoch, loss=1.15, accuracy=0.748, val_loss=4.28, val_accuracy=0.304, lr=0.1] 33%|███▎      | 31/93 [14:29<26:13, 25.37s/epoch, loss=1.15, accuracy=0.749, val_loss=1.89, val_accuracy=0.5, lr=0.1]   34%|███▍      | 32/93 [14:54<25:45, 25.34s/epoch, loss=1.15, accuracy=0.747, val_loss=1.59, val_accuracy=0.594, lr=0.1] 35%|███▌      | 33/93 [15:19<25:11, 25.19s/epoch, loss=1.15, accuracy=0.748, val_loss=1.69, val_accuracy=0.572, lr=0.0316] 37%|███▋      | 34/93 [15:44<24:38, 25.06s/epoch, loss=1.16, accuracy=0.747, val_loss=1.79, val_accuracy=0.53, lr=0.1]     38%|███▊      | 35/93 [16:10<24:23, 25.23s/epoch, loss=1.15, accuracy=0.751, val_loss=1.4, val_accuracy=0.661, lr=0.1] 39%|███▊      | 36/93 [16:34<23:52, 25.13s/epoch, loss=1.15, accuracy=0.751, val_loss=2.22, val_accuracy=0.47, lr=0.1] 40%|███▉      | 37/93 [16:59<23:19, 24.99s/epoch, loss=1.14, accuracy=0.752, val_loss=4.57, val_accuracy=0.243, lr=0.1] 41%|████      | 38/93 [17:24<22:52, 24.96s/epoch, loss=1.15, accuracy=0.752, val_loss=1.59, val_accuracy=0.614, lr=0.1] 42%|████▏     | 39/93 [17:49<22:31, 25.02s/epoch, loss=1.15, accuracy=0.753, val_loss=1.98, val_accuracy=0.474, lr=0.1] 43%|████▎     | 40/93 [18:14<22:09, 25.09s/epoch, loss=1.14, accuracy=0.752, val_loss=2.16, val_accuracy=0.38, lr=0.0316] 44%|████▍     | 41/93 [18:39<21:41, 25.03s/epoch, loss=1.15, accuracy=0.751, val_loss=1.7, val_accuracy=0.545, lr=0.1]    45%|████▌     | 42/93 [19:04<21:10, 24.90s/epoch, loss=1.14, accuracy=0.753, val_loss=1.95, val_accuracy=0.449, lr=0.1] 46%|████▌     | 43/93 [19:29<20:47, 24.95s/epoch, loss=1.14, accuracy=0.75, val_loss=3.76, val_accuracy=0.283, lr=0.1]  47%|████▋     | 44/93 [19:54<20:17, 24.85s/epoch, loss=1.15, accuracy=0.751, val_loss=1.91, val_accuracy=0.488, lr=0.1] 48%|████▊     | 45/93 [20:19<20:07, 25.15s/epoch, loss=1.15, accuracy=0.751, val_loss=3.16, val_accuracy=0.428, lr=0.0316] 49%|████▉     | 46/93 [20:45<19:43, 25.19s/epoch, loss=1.14, accuracy=0.752, val_loss=2.1, val_accuracy=0.454, lr=0.1]     51%|█████     | 47/93 [21:09<19:09, 24.99s/epoch, loss=1.14, accuracy=0.749, val_loss=1.83, val_accuracy=0.52, lr=0.1] 52%|█████▏    | 48/93 [21:34<18:44, 24.98s/epoch, loss=1.14, accuracy=0.753, val_loss=1.48, val_accuracy=0.628, lr=0.1] 53%|█████▎    | 49/93 [21:59<18:16, 24.91s/epoch, loss=1.14, accuracy=0.751, val_loss=2.18, val_accuracy=0.476, lr=0.1] 54%|█████▍    | 50/93 [22:24<17:52, 24.95s/epoch, loss=1.13, accuracy=0.754, val_loss=2.28, val_accuracy=0.495, lr=0.0316] 55%|█████▍    | 51/93 [22:49<17:27, 24.94s/epoch, loss=1.14, accuracy=0.753, val_loss=4.9, val_accuracy=0.183, lr=0.1]     56%|█████▌    | 52/93 [23:14<17:00, 24.90s/epoch, loss=1.14, accuracy=0.75, val_loss=3.82, val_accuracy=0.226, lr=0.1] 57%|█████▋    | 53/93 [23:38<16:32, 24.82s/epoch, loss=1.13, accuracy=0.755, val_loss=1.77, val_accuracy=0.54, lr=0.1] 58%|█████▊    | 54/93 [24:03<16:04, 24.73s/epoch, loss=1.13, accuracy=0.753, val_loss=2.5, val_accuracy=0.349, lr=0.1] 59%|█████▉    | 55/93 [24:28<15:41, 24.78s/epoch, loss=1.13, accuracy=0.753, val_loss=2.36, val_accuracy=0.43, lr=0.0316] 60%|██████    | 56/93 [24:53<15:25, 25.02s/epoch, loss=1.13, accuracy=0.754, val_loss=1.63, val_accuracy=0.594, lr=0.1]   61%|██████▏   | 57/93 [25:18<14:56, 24.91s/epoch, loss=1.14, accuracy=0.751, val_loss=3.23, val_accuracy=0.301, lr=0.1] 62%|██████▏   | 58/93 [25:42<14:25, 24.72s/epoch, loss=1.14, accuracy=0.754, val_loss=2.42, val_accuracy=0.439, lr=0.1] 63%|██████▎   | 59/93 [26:07<13:59, 24.68s/epoch, loss=1.13, accuracy=0.754, val_loss=1.79, val_accuracy=0.546, lr=0.1] 65%|██████▍   | 60/93 [26:32<13:35, 24.70s/epoch, loss=1.14, accuracy=0.752, val_loss=2.12, val_accuracy=0.541, lr=0.0316] 66%|██████▌   | 61/93 [26:56<13:10, 24.71s/epoch, loss=1.14, accuracy=0.755, val_loss=2.39, val_accuracy=0.39, lr=0.1]     67%|██████▋   | 62/93 [27:21<12:43, 24.64s/epoch, loss=1.14, accuracy=0.755, val_loss=2.12, val_accuracy=0.458, lr=0.1] 68%|██████▊   | 63/93 [27:46<12:19, 24.65s/epoch, loss=1.14, accuracy=0.754, val_loss=1.98, val_accuracy=0.496, lr=0.1] 69%|██████▉   | 64/93 [28:10<11:55, 24.67s/epoch, loss=1.14, accuracy=0.753, val_loss=1.73, val_accuracy=0.563, lr=0.1] 70%|██████▉   | 65/93 [28:35<11:31, 24.69s/epoch, loss=1.14, accuracy=0.754, val_loss=3.61, val_accuracy=0.289, lr=0.0316] 71%|███████   | 66/93 [29:00<11:09, 24.80s/epoch, loss=1.13, accuracy=0.756, val_loss=4.22, val_accuracy=0.306, lr=0.1]    72%|███████▏  | 67/93 [29:25<10:48, 24.94s/epoch, loss=1.13, accuracy=0.755, val_loss=1.96, val_accuracy=0.526, lr=0.1] 73%|███████▎  | 68/93 [29:50<10:23, 24.96s/epoch, loss=1.14, accuracy=0.753, val_loss=2.38, val_accuracy=0.399, lr=0.1] 74%|███████▍  | 69/93 [30:15<09:59, 25.00s/epoch, loss=1.14, accuracy=0.753, val_loss=1.88, val_accuracy=0.521, lr=0.1] 75%|███████▌  | 70/93 [30:40<09:32, 24.88s/epoch, loss=1.13, accuracy=0.756, val_loss=3.12, val_accuracy=0.386, lr=0.0316] 76%|███████▋  | 71/93 [31:05<09:10, 25.00s/epoch, loss=1.13, accuracy=0.754, val_loss=1.54, val_accuracy=0.598, lr=0.1]    77%|███████▋  | 72/93 [31:30<08:42, 24.87s/epoch, loss=1.13, accuracy=0.756, val_loss=1.64, val_accuracy=0.612, lr=0.1] 78%|███████▊  | 73/93 [31:54<08:15, 24.78s/epoch, loss=1.13, accuracy=0.755, val_loss=1.98, val_accuracy=0.536, lr=0.1] 80%|███████▉  | 74/93 [32:19<07:51, 24.81s/epoch, loss=1.13, accuracy=0.757, val_loss=2.59, val_accuracy=0.359, lr=0.1] 81%|████████  | 75/93 [32:44<07:26, 24.82s/epoch, loss=1.14, accuracy=0.754, val_loss=1.95, val_accuracy=0.526, lr=0.0316] 82%|████████▏ | 76/93 [33:09<07:03, 24.92s/epoch, loss=1.13, accuracy=0.755, val_loss=3.91, val_accuracy=0.33, lr=0.1]     83%|████████▎ | 77/93 [33:34<06:37, 24.86s/epoch, loss=1.13, accuracy=0.756, val_loss=2.54, val_accuracy=0.364, lr=0.1] 84%|████████▍ | 78/93 [34:00<06:18, 25.25s/epoch, loss=1.13, accuracy=0.755, val_loss=1.68, val_accuracy=0.618, lr=0.1] 85%|████████▍ | 79/93 [34:26<05:55, 25.39s/epoch, loss=1.14, accuracy=0.752, val_loss=2.43, val_accuracy=0.432, lr=0.1] 86%|████████▌ | 80/93 [34:51<05:27, 25.20s/epoch, loss=1.13, accuracy=0.756, val_loss=1.84, val_accuracy=0.514, lr=0.0316] 87%|████████▋ | 81/93 [35:15<04:59, 24.96s/epoch, loss=1.13, accuracy=0.754, val_loss=3.03, val_accuracy=0.401, lr=0.1]    88%|████████▊ | 82/93 [35:40<04:34, 24.93s/epoch, loss=0.95, accuracy=0.808, val_loss=0.895, val_accuracy=0.809, lr=0.01] 89%|████████▉ | 83/93 [36:04<04:08, 24.81s/epoch, loss=0.764, accuracy=0.844, val_loss=0.927, val_accuracy=0.77, lr=0.01] 90%|█████████ | 84/93 [36:29<03:43, 24.86s/epoch, loss=0.678, accuracy=0.853, val_loss=0.768, val_accuracy=0.804, lr=0.01] 91%|█████████▏| 85/93 [36:55<03:19, 24.95s/epoch, loss=0.625, accuracy=0.86, val_loss=0.714, val_accuracy=0.823, lr=0.01]  92%|█████████▏| 86/93 [37:21<02:57, 25.29s/epoch, loss=0.601, accuracy=0.859, val_loss=0.691, val_accuracy=0.827, lr=0.01] 94%|█████████▎| 87/93 [37:45<02:30, 25.08s/epoch, loss=0.588, accuracy=0.859, val_loss=0.9, val_accuracy=0.759, lr=0.01]   95%|█████████▍| 88/93 [38:10<02:05, 25.02s/epoch, loss=0.576, accuracy=0.862, val_loss=0.766, val_accuracy=0.793, lr=0.01] 96%|█████████▌| 89/93 [38:35<01:39, 24.84s/epoch, loss=0.576, accuracy=0.861, val_loss=0.75, val_accuracy=0.807, lr=0.01]  97%|█████████▋| 90/93 [39:00<01:14, 24.93s/epoch, loss=0.569, accuracy=0.864, val_loss=2.12, val_accuracy=0.565, lr=0.01] 98%|█████████▊| 91/93 [39:24<00:49, 24.81s/epoch, loss=0.567, accuracy=0.863, val_loss=0.854, val_accuracy=0.773, lr=0.00316] 99%|█████████▉| 92/93 [39:49<00:24, 24.94s/epoch, loss=0.568, accuracy=0.867, val_loss=0.682, val_accuracy=0.829, lr=0.01]   100%|██████████| 93/93 [40:14<00:00, 24.81s/epoch, loss=0.569, accuracy=0.868, val_loss=0.86, val_accuracy=0.774, lr=0.01] 100%|██████████| 93/93 [40:14<00:00, 25.96s/epoch, loss=0.569, accuracy=0.868, val_loss=0.86, val_accuracy=0.774, lr=0.01]
Using real-time data augmentation.
Test score: 0.6800230741500854
Test accuracy: 0.8288999795913696


* * * Run SGD for ID = 16_12. * * *


2024-02-20 05:49:23.237077: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 05:49:26.107643: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 05:49:26.109064: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-20 05:49:26.152625: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-20 05:49:26.152677: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 05:49:26.156275: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 05:49:26.156352: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-20 05:49:26.158909: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-20 05:49:26.160126: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-20 05:49:26.162920: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-20 05:49:26.164737: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-20 05:49:26.170476: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 05:49:26.171236: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-20 05:49:26.171327: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 05:49:27.694003: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-20 05:49:27.695098: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 05:49:27.695663: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-20 05:49:27.695716: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 05:49:27.695760: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 05:49:27.695784: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-20 05:49:27.695807: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-20 05:49:27.695842: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-20 05:49:27.695861: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-20 05:49:27.695876: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-20 05:49:27.695892: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 05:49:27.696540: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-20 05:49:27.696594: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 05:49:28.405560: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-20 05:49:28.405652: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-20 05:49:28.405665: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-20 05:49:28.407547: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:18:00.0, compute capability: 6.1)
{'id': '16_12', 'batch_size': 128, 'epochs': 93, 'validation_split': 0.1, 'checkpointing': True, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
x_train shape: (45000, 32, 32, 3)
45000 train samples
5000 validation samples
10000 test samples
y_train shape: (45000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/93 [00:00<?, ?epoch/s]2024-02-20 05:49:29.363734: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-20 05:49:29.364444: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-02-20 05:49:31.517148: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 05:49:31.802203: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 05:49:32.806489: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-20 05:49:32.858239: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/93 [01:01<1:34:23, 61.56s/epoch, loss=3.36, accuracy=0.278, val_loss=2.25, val_accuracy=0.276, lr=0.1]  2%|▏         | 2/93 [01:26<1:00:53, 40.14s/epoch, loss=1.64, accuracy=0.492, val_loss=1.79, val_accuracy=0.462, lr=0.1]  3%|▎         | 3/93 [01:51<49:36, 33.07s/epoch, loss=1.39, accuracy=0.608, val_loss=1.91, val_accuracy=0.438, lr=0.1]    4%|▍         | 4/93 [02:16<44:31, 30.01s/epoch, loss=1.32, accuracy=0.657, val_loss=1.76, val_accuracy=0.527, lr=0.1]  5%|▌         | 5/93 [02:41<41:05, 28.02s/epoch, loss=1.27, accuracy=0.688, val_loss=1.93, val_accuracy=0.471, lr=0.1]  6%|▋         | 6/93 [03:06<39:15, 27.08s/epoch, loss=1.25, accuracy=0.7, val_loss=3.01, val_accuracy=0.397, lr=0.1]    8%|▊         | 7/93 [03:31<37:55, 26.45s/epoch, loss=1.24, accuracy=0.71, val_loss=2.2, val_accuracy=0.477, lr=0.1]  9%|▊         | 8/93 [03:56<36:48, 25.99s/epoch, loss=1.22, accuracy=0.719, val_loss=1.56, val_accuracy=0.609, lr=0.1] 10%|▉         | 9/93 [04:21<35:54, 25.64s/epoch, loss=1.21, accuracy=0.722, val_loss=2.26, val_accuracy=0.423, lr=0.1] 11%|█         | 10/93 [04:46<35:04, 25.36s/epoch, loss=1.2, accuracy=0.725, val_loss=1.87, val_accuracy=0.558, lr=0.1] 12%|█▏        | 11/93 [05:11<34:36, 25.32s/epoch, loss=1.2, accuracy=0.726, val_loss=1.54, val_accuracy=0.615, lr=0.1] 13%|█▎        | 12/93 [05:36<33:55, 25.13s/epoch, loss=1.2, accuracy=0.731, val_loss=1.76, val_accuracy=0.559, lr=0.1] 14%|█▍        | 13/93 [06:01<33:38, 25.23s/epoch, loss=1.19, accuracy=0.733, val_loss=4.82, val_accuracy=0.232, lr=0.1] 15%|█▌        | 14/93 [06:28<34:01, 25.85s/epoch, loss=1.19, accuracy=0.733, val_loss=1.68, val_accuracy=0.569, lr=0.1] 16%|█▌        | 15/93 [06:55<33:46, 25.98s/epoch, loss=1.19, accuracy=0.733, val_loss=1.81, val_accuracy=0.551, lr=0.1] 17%|█▋        | 16/93 [07:22<33:42, 26.27s/epoch, loss=1.18, accuracy=0.739, val_loss=2.33, val_accuracy=0.368, lr=0.0316] 18%|█▊        | 17/93 [07:47<33:03, 26.10s/epoch, loss=1.18, accuracy=0.738, val_loss=1.89, val_accuracy=0.543, lr=0.1]    19%|█▉        | 18/93 [08:12<32:11, 25.76s/epoch, loss=1.19, accuracy=0.737, val_loss=1.4, val_accuracy=0.666, lr=0.1]  20%|██        | 19/93 [08:37<31:31, 25.56s/epoch, loss=1.18, accuracy=0.738, val_loss=2.19, val_accuracy=0.442, lr=0.1] 22%|██▏       | 20/93 [09:02<30:46, 25.29s/epoch, loss=1.18, accuracy=0.738, val_loss=1.75, val_accuracy=0.563, lr=0.1] 23%|██▎       | 21/93 [09:27<30:11, 25.16s/epoch, loss=1.17, accuracy=0.739, val_loss=1.79, val_accuracy=0.552, lr=0.1] 24%|██▎       | 22/93 [09:52<29:42, 25.11s/epoch, loss=1.17, accuracy=0.741, val_loss=1.61, val_accuracy=0.583, lr=0.1] 25%|██▍       | 23/93 [10:17<29:21, 25.16s/epoch, loss=1.18, accuracy=0.741, val_loss=3.03, val_accuracy=0.351, lr=0.0316] 26%|██▌       | 24/93 [10:43<29:07, 25.33s/epoch, loss=1.18, accuracy=0.74, val_loss=2.15, val_accuracy=0.375, lr=0.1]     27%|██▋       | 25/93 [11:08<28:32, 25.19s/epoch, loss=1.17, accuracy=0.741, val_loss=1.85, val_accuracy=0.534, lr=0.1] 28%|██▊       | 26/93 [11:33<28:04, 25.14s/epoch, loss=1.18, accuracy=0.741, val_loss=2.48, val_accuracy=0.472, lr=0.1] 29%|██▉       | 27/93 [12:00<28:24, 25.83s/epoch, loss=1.16, accuracy=0.742, val_loss=2.12, val_accuracy=0.494, lr=0.1] 30%|███       | 28/93 [12:28<28:28, 26.29s/epoch, loss=1.16, accuracy=0.745, val_loss=5.02, val_accuracy=0.2, lr=0.0316] 31%|███       | 29/93 [12:55<28:20, 26.57s/epoch, loss=1.16, accuracy=0.745, val_loss=1.53, val_accuracy=0.606, lr=0.1]  32%|███▏      | 30/93 [13:22<28:08, 26.79s/epoch, loss=1.16, accuracy=0.743, val_loss=1.97, val_accuracy=0.504, lr=0.1] 33%|███▎      | 31/93 [13:49<27:48, 26.92s/epoch, loss=1.16, accuracy=0.748, val_loss=1.48, val_accuracy=0.651, lr=0.1] 34%|███▍      | 32/93 [14:17<27:30, 27.06s/epoch, loss=1.16, accuracy=0.747, val_loss=1.87, val_accuracy=0.502, lr=0.1] 35%|███▌      | 33/93 [14:44<27:05, 27.10s/epoch, loss=1.16, accuracy=0.748, val_loss=1.72, val_accuracy=0.524, lr=0.0316] 37%|███▋      | 34/93 [15:11<26:45, 27.21s/epoch, loss=1.16, accuracy=0.744, val_loss=2, val_accuracy=0.536, lr=0.1]       38%|███▊      | 35/93 [15:39<26:20, 27.26s/epoch, loss=1.16, accuracy=0.745, val_loss=2.11, val_accuracy=0.476, lr=0.1] 39%|███▊      | 36/93 [16:06<25:53, 27.26s/epoch, loss=1.16, accuracy=0.745, val_loss=2.19, val_accuracy=0.493, lr=0.1] 40%|███▉      | 37/93 [16:33<25:27, 27.28s/epoch, loss=1.15, accuracy=0.749, val_loss=1.98, val_accuracy=0.515, lr=0.1] 41%|████      | 38/93 [17:01<24:59, 27.26s/epoch, loss=1.15, accuracy=0.748, val_loss=2.08, val_accuracy=0.433, lr=0.0316] 42%|████▏     | 39/93 [17:28<24:31, 27.25s/epoch, loss=1.14, accuracy=0.75, val_loss=2.04, val_accuracy=0.497, lr=0.1]     43%|████▎     | 40/93 [17:55<24:05, 27.27s/epoch, loss=1.15, accuracy=0.747, val_loss=2.31, val_accuracy=0.399, lr=0.1] 44%|████▍     | 41/93 [18:22<23:34, 27.19s/epoch, loss=1.15, accuracy=0.748, val_loss=1.85, val_accuracy=0.557, lr=0.1] 45%|████▌     | 42/93 [18:49<23:05, 27.17s/epoch, loss=1.14, accuracy=0.749, val_loss=1.75, val_accuracy=0.572, lr=0.1] 46%|████▌     | 43/93 [19:16<22:38, 27.17s/epoch, loss=1.15, accuracy=0.748, val_loss=2.21, val_accuracy=0.431, lr=0.0316] 47%|████▋     | 44/93 [19:43<22:10, 27.15s/epoch, loss=1.14, accuracy=0.748, val_loss=1.92, val_accuracy=0.49, lr=0.1]     48%|████▊     | 45/93 [20:11<21:43, 27.15s/epoch, loss=1.14, accuracy=0.75, val_loss=2.29, val_accuracy=0.414, lr=0.1] 49%|████▉     | 46/93 [20:38<21:16, 27.15s/epoch, loss=1.14, accuracy=0.75, val_loss=1.94, val_accuracy=0.466, lr=0.1] 51%|█████     | 47/93 [21:05<20:47, 27.12s/epoch, loss=1.14, accuracy=0.752, val_loss=2.17, val_accuracy=0.461, lr=0.1] 52%|█████▏    | 48/93 [21:32<20:23, 27.19s/epoch, loss=1.15, accuracy=0.752, val_loss=1.9, val_accuracy=0.502, lr=0.0316] 53%|█████▎    | 49/93 [21:59<19:52, 27.09s/epoch, loss=1.14, accuracy=0.75, val_loss=1.77, val_accuracy=0.57, lr=0.1]     54%|█████▍    | 50/93 [22:26<19:23, 27.06s/epoch, loss=1.14, accuracy=0.75, val_loss=9.39, val_accuracy=0.161, lr=0.1] 55%|█████▍    | 51/93 [22:53<18:56, 27.06s/epoch, loss=1.14, accuracy=0.75, val_loss=1.9, val_accuracy=0.503, lr=0.1]  56%|█████▌    | 52/93 [23:20<18:27, 27.02s/epoch, loss=1.15, accuracy=0.75, val_loss=3.17, val_accuracy=0.326, lr=0.1] 57%|█████▋    | 53/93 [23:47<18:01, 27.03s/epoch, loss=1.14, accuracy=0.752, val_loss=1.76, val_accuracy=0.552, lr=0.0316] 58%|█████▊    | 54/93 [24:14<17:35, 27.06s/epoch, loss=1.14, accuracy=0.75, val_loss=3, val_accuracy=0.373, lr=0.1]        59%|█████▉    | 55/93 [24:42<17:13, 27.19s/epoch, loss=1.14, accuracy=0.749, val_loss=1.4, val_accuracy=0.673, lr=0.1] 60%|██████    | 56/93 [25:08<16:42, 27.08s/epoch, loss=1.14, accuracy=0.751, val_loss=1.98, val_accuracy=0.52, lr=0.1] 61%|██████▏   | 57/93 [25:35<16:13, 27.04s/epoch, loss=1.14, accuracy=0.753, val_loss=2.01, val_accuracy=0.5, lr=0.1]  62%|██████▏   | 58/93 [26:02<15:46, 27.05s/epoch, loss=1.13, accuracy=0.75, val_loss=1.51, val_accuracy=0.621, lr=0.1] 63%|██████▎   | 59/93 [26:30<15:19, 27.05s/epoch, loss=1.14, accuracy=0.755, val_loss=4.07, val_accuracy=0.307, lr=0.1] 65%|██████▍   | 60/93 [26:56<14:51, 27.01s/epoch, loss=1.13, accuracy=0.755, val_loss=1.58, val_accuracy=0.614, lr=0.0316] 66%|██████▌   | 61/93 [27:24<14:26, 27.07s/epoch, loss=1.14, accuracy=0.752, val_loss=1.63, val_accuracy=0.598, lr=0.1]    67%|██████▋   | 62/93 [27:51<13:59, 27.07s/epoch, loss=1.14, accuracy=0.751, val_loss=2.23, val_accuracy=0.454, lr=0.1] 68%|██████▊   | 63/93 [28:18<13:31, 27.05s/epoch, loss=1.14, accuracy=0.752, val_loss=2.38, val_accuracy=0.385, lr=0.1] 69%|██████▉   | 64/93 [28:45<13:05, 27.09s/epoch, loss=1.13, accuracy=0.754, val_loss=1.67, val_accuracy=0.571, lr=0.1] 70%|██████▉   | 65/93 [29:12<12:39, 27.11s/epoch, loss=1.14, accuracy=0.752, val_loss=3.13, val_accuracy=0.344, lr=0.0316] 71%|███████   | 66/93 [29:39<12:11, 27.10s/epoch, loss=1.13, accuracy=0.753, val_loss=1.86, val_accuracy=0.554, lr=0.1]    72%|███████▏  | 67/93 [30:06<11:43, 27.08s/epoch, loss=1.13, accuracy=0.751, val_loss=1.67, val_accuracy=0.583, lr=0.1] 73%|███████▎  | 68/93 [30:33<11:17, 27.10s/epoch, loss=1.13, accuracy=0.753, val_loss=1.64, val_accuracy=0.577, lr=0.1] 74%|███████▍  | 69/93 [31:01<10:51, 27.13s/epoch, loss=1.13, accuracy=0.753, val_loss=2.13, val_accuracy=0.468, lr=0.1] 75%|███████▌  | 70/93 [31:28<10:24, 27.13s/epoch, loss=1.13, accuracy=0.753, val_loss=2.23, val_accuracy=0.47, lr=0.0316] 76%|███████▋  | 71/93 [31:55<09:56, 27.12s/epoch, loss=1.13, accuracy=0.752, val_loss=1.88, val_accuracy=0.528, lr=0.1]   77%|███████▋  | 72/93 [32:22<09:28, 27.09s/epoch, loss=1.13, accuracy=0.755, val_loss=1.53, val_accuracy=0.625, lr=0.1] 78%|███████▊  | 73/93 [32:49<09:02, 27.10s/epoch, loss=1.14, accuracy=0.753, val_loss=1.78, val_accuracy=0.561, lr=0.1] 80%|███████▉  | 74/93 [33:16<08:35, 27.11s/epoch, loss=1.13, accuracy=0.755, val_loss=1.81, val_accuracy=0.519, lr=0.1] 81%|████████  | 75/93 [33:43<08:07, 27.07s/epoch, loss=1.13, accuracy=0.755, val_loss=10.6, val_accuracy=0.159, lr=0.0316] 82%|████████▏ | 76/93 [34:10<07:40, 27.10s/epoch, loss=1.13, accuracy=0.753, val_loss=3.04, val_accuracy=0.348, lr=0.1]    83%|████████▎ | 77/93 [34:37<07:13, 27.11s/epoch, loss=1.13, accuracy=0.752, val_loss=1.72, val_accuracy=0.543, lr=0.1] 84%|████████▍ | 78/93 [35:04<06:46, 27.08s/epoch, loss=1.13, accuracy=0.753, val_loss=3.37, val_accuracy=0.361, lr=0.1] 85%|████████▍ | 79/93 [35:31<06:18, 27.00s/epoch, loss=1.12, accuracy=0.755, val_loss=1.98, val_accuracy=0.485, lr=0.1] 86%|████████▌ | 80/93 [35:58<05:52, 27.09s/epoch, loss=1.12, accuracy=0.756, val_loss=2.75, val_accuracy=0.436, lr=0.0316] 87%|████████▋ | 81/93 [36:26<05:25, 27.12s/epoch, loss=1.12, accuracy=0.755, val_loss=1.53, val_accuracy=0.637, lr=0.1]    88%|████████▊ | 82/93 [36:53<04:59, 27.23s/epoch, loss=0.93, accuracy=0.812, val_loss=0.906, val_accuracy=0.8, lr=0.01] 89%|████████▉ | 83/93 [37:21<04:33, 27.32s/epoch, loss=0.754, accuracy=0.845, val_loss=0.74, val_accuracy=0.839, lr=0.01] 90%|█████████ | 84/93 [37:48<04:05, 27.26s/epoch, loss=0.672, accuracy=0.853, val_loss=0.859, val_accuracy=0.794, lr=0.01] 91%|█████████▏| 85/93 [38:15<03:37, 27.23s/epoch, loss=0.626, accuracy=0.857, val_loss=0.803, val_accuracy=0.787, lr=0.01] 92%|█████████▏| 86/93 [38:42<03:10, 27.23s/epoch, loss=0.599, accuracy=0.858, val_loss=0.662, val_accuracy=0.834, lr=0.01] 94%|█████████▎| 87/93 [39:09<02:43, 27.19s/epoch, loss=0.582, accuracy=0.86, val_loss=0.691, val_accuracy=0.824, lr=0.01]  95%|█████████▍| 88/93 [39:36<02:16, 27.20s/epoch, loss=0.58, accuracy=0.859, val_loss=0.85, val_accuracy=0.773, lr=0.01]  96%|█████████▌| 89/93 [40:03<01:48, 27.07s/epoch, loss=0.572, accuracy=0.862, val_loss=0.678, val_accuracy=0.833, lr=0.01] 97%|█████████▋| 90/93 [40:30<01:21, 27.06s/epoch, loss=0.572, accuracy=0.862, val_loss=0.85, val_accuracy=0.786, lr=0.01]  98%|█████████▊| 91/93 [40:57<00:54, 27.10s/epoch, loss=0.569, accuracy=0.863, val_loss=0.71, val_accuracy=0.812, lr=0.00316] 99%|█████████▉| 92/93 [41:25<00:27, 27.13s/epoch, loss=0.563, accuracy=0.867, val_loss=0.814, val_accuracy=0.792, lr=0.01]  100%|██████████| 93/93 [41:52<00:00, 27.15s/epoch, loss=0.562, accuracy=0.869, val_loss=1.05, val_accuracy=0.712, lr=0.01] 100%|██████████| 93/93 [41:52<00:00, 27.01s/epoch, loss=0.562, accuracy=0.869, val_loss=1.05, val_accuracy=0.712, lr=0.01]
Using real-time data augmentation.
Test score: 0.7673510313034058
Test accuracy: 0.8295000195503235


* * * Run SGD for ID = 16_13. * * *


2024-02-20 06:31:28.691078: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 06:31:31.479699: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 06:31:31.480974: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-20 06:31:31.524115: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-20 06:31:31.524166: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 06:31:31.528012: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 06:31:31.528110: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-20 06:31:31.530943: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-20 06:31:31.532282: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-20 06:31:31.535311: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-20 06:31:31.537284: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-20 06:31:31.543510: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 06:31:31.544358: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-20 06:31:31.544456: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 06:31:33.050002: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-20 06:31:33.051268: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 06:31:33.053915: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-20 06:31:33.053977: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 06:31:33.054056: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 06:31:33.054072: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-20 06:31:33.054086: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-20 06:31:33.054101: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-20 06:31:33.054123: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-20 06:31:33.054144: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-20 06:31:33.054165: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 06:31:33.054760: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-20 06:31:33.054799: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 06:31:33.711671: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-20 06:31:33.711728: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-20 06:31:33.711739: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-20 06:31:33.712945: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:18:00.0, compute capability: 6.1)
{'id': '16_13', 'batch_size': 128, 'epochs': 93, 'validation_split': 0.1, 'checkpointing': True, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
x_train shape: (45000, 32, 32, 3)
45000 train samples
5000 validation samples
10000 test samples
y_train shape: (45000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/93 [00:00<?, ?epoch/s]2024-02-20 06:31:34.702496: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-20 06:31:34.703079: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-02-20 06:31:36.860783: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 06:31:37.169377: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 06:31:38.252421: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-20 06:31:38.306056: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/93 [01:02<1:36:05, 62.67s/epoch, loss=3.46, accuracy=0.261, val_loss=3.28, val_accuracy=0.12, lr=0.1]  2%|▏         | 2/93 [01:30<1:03:52, 42.12s/epoch, loss=1.62, accuracy=0.504, val_loss=2.38, val_accuracy=0.346, lr=0.1]  3%|▎         | 3/93 [01:58<53:14, 35.49s/epoch, loss=1.34, accuracy=0.634, val_loss=1.72, val_accuracy=0.537, lr=0.1]    4%|▍         | 4/93 [02:25<47:53, 32.28s/epoch, loss=1.27, accuracy=0.683, val_loss=1.97, val_accuracy=0.489, lr=0.1]  5%|▌         | 5/93 [02:52<44:49, 30.56s/epoch, loss=1.23, accuracy=0.701, val_loss=1.88, val_accuracy=0.488, lr=0.1]  6%|▋         | 6/93 [03:20<42:48, 29.53s/epoch, loss=1.21, accuracy=0.718, val_loss=2.73, val_accuracy=0.34, lr=0.1]   8%|▊         | 7/93 [03:47<41:12, 28.75s/epoch, loss=1.21, accuracy=0.721, val_loss=1.77, val_accuracy=0.521, lr=0.1]  9%|▊         | 8/93 [04:14<40:03, 28.28s/epoch, loss=1.19, accuracy=0.729, val_loss=2.31, val_accuracy=0.39, lr=0.0316] 10%|▉         | 9/93 [04:42<39:13, 28.01s/epoch, loss=1.19, accuracy=0.729, val_loss=2.08, val_accuracy=0.445, lr=0.1]   11%|█         | 10/93 [05:09<38:33, 27.88s/epoch, loss=1.18, accuracy=0.735, val_loss=2.84, val_accuracy=0.432, lr=0.1] 12%|█▏        | 11/93 [05:37<37:54, 27.74s/epoch, loss=1.17, accuracy=0.739, val_loss=1.82, val_accuracy=0.535, lr=0.1] 13%|█▎        | 12/93 [06:04<37:24, 27.70s/epoch, loss=1.17, accuracy=0.737, val_loss=1.71, val_accuracy=0.557, lr=0.1] 14%|█▍        | 13/93 [06:32<36:46, 27.58s/epoch, loss=1.16, accuracy=0.742, val_loss=2.65, val_accuracy=0.45, lr=0.1]  15%|█▌        | 14/93 [06:59<36:24, 27.65s/epoch, loss=1.16, accuracy=0.742, val_loss=1.61, val_accuracy=0.59, lr=0.1] 16%|█▌        | 15/93 [07:27<35:47, 27.54s/epoch, loss=1.16, accuracy=0.745, val_loss=2.45, val_accuracy=0.429, lr=0.1] 17%|█▋        | 16/93 [07:54<35:16, 27.49s/epoch, loss=1.16, accuracy=0.746, val_loss=2.09, val_accuracy=0.556, lr=0.1] 18%|█▊        | 17/93 [08:21<34:45, 27.43s/epoch, loss=1.15, accuracy=0.747, val_loss=1.72, val_accuracy=0.558, lr=0.1] 19%|█▉        | 18/93 [08:49<34:19, 27.46s/epoch, loss=1.15, accuracy=0.749, val_loss=2.02, val_accuracy=0.449, lr=0.1] 20%|██        | 19/93 [09:16<33:50, 27.44s/epoch, loss=1.15, accuracy=0.745, val_loss=1.89, val_accuracy=0.53, lr=0.0316] 22%|██▏       | 20/93 [09:44<33:21, 27.42s/epoch, loss=1.15, accuracy=0.749, val_loss=3.94, val_accuracy=0.254, lr=0.1]   23%|██▎       | 21/93 [10:11<32:53, 27.41s/epoch, loss=1.16, accuracy=0.747, val_loss=2.15, val_accuracy=0.48, lr=0.1]  24%|██▎       | 22/93 [10:39<32:29, 27.45s/epoch, loss=1.14, accuracy=0.749, val_loss=1.73, val_accuracy=0.579, lr=0.1] 25%|██▍       | 23/93 [11:06<31:59, 27.42s/epoch, loss=1.14, accuracy=0.752, val_loss=2.34, val_accuracy=0.315, lr=0.1] 26%|██▌       | 24/93 [11:34<31:36, 27.49s/epoch, loss=1.14, accuracy=0.749, val_loss=1.58, val_accuracy=0.637, lr=0.1] 27%|██▋       | 25/93 [12:01<31:04, 27.42s/epoch, loss=1.14, accuracy=0.751, val_loss=1.98, val_accuracy=0.48, lr=0.1]  28%|██▊       | 26/93 [12:28<30:31, 27.34s/epoch, loss=1.14, accuracy=0.752, val_loss=2.18, val_accuracy=0.486, lr=0.1] 29%|██▉       | 27/93 [12:55<30:05, 27.36s/epoch, loss=1.14, accuracy=0.75, val_loss=1.92, val_accuracy=0.496, lr=0.1]  30%|███       | 28/93 [13:23<29:40, 27.39s/epoch, loss=1.14, accuracy=0.753, val_loss=4.71, val_accuracy=0.306, lr=0.1] 31%|███       | 29/93 [13:50<29:11, 27.36s/epoch, loss=1.14, accuracy=0.753, val_loss=1.52, val_accuracy=0.626, lr=0.1] 32%|███▏      | 30/93 [14:18<28:47, 27.42s/epoch, loss=1.13, accuracy=0.756, val_loss=2, val_accuracy=0.5, lr=0.1]      33%|███▎      | 31/93 [14:45<28:22, 27.46s/epoch, loss=1.13, accuracy=0.755, val_loss=1.82, val_accuracy=0.533, lr=0.1] 34%|███▍      | 32/93 [15:13<27:55, 27.47s/epoch, loss=1.14, accuracy=0.752, val_loss=1.45, val_accuracy=0.636, lr=0.1] 35%|███▌      | 33/93 [15:40<27:29, 27.49s/epoch, loss=1.13, accuracy=0.753, val_loss=1.92, val_accuracy=0.487, lr=0.1] 37%|███▋      | 34/93 [16:08<26:57, 27.41s/epoch, loss=1.13, accuracy=0.753, val_loss=1.95, val_accuracy=0.487, lr=0.1] 38%|███▊      | 35/93 [16:35<26:33, 27.48s/epoch, loss=1.13, accuracy=0.756, val_loss=2.39, val_accuracy=0.451, lr=0.1] 39%|███▊      | 36/93 [17:03<26:07, 27.50s/epoch, loss=1.13, accuracy=0.754, val_loss=3.37, val_accuracy=0.346, lr=0.1] 40%|███▉      | 37/93 [17:30<25:36, 27.44s/epoch, loss=1.13, accuracy=0.753, val_loss=1.87, val_accuracy=0.523, lr=0.0316] 41%|████      | 38/93 [17:57<25:08, 27.43s/epoch, loss=1.13, accuracy=0.754, val_loss=1.6, val_accuracy=0.599, lr=0.1]     42%|████▏     | 39/93 [18:25<24:43, 27.47s/epoch, loss=1.13, accuracy=0.754, val_loss=2.03, val_accuracy=0.466, lr=0.1] 43%|████▎     | 40/93 [18:52<24:14, 27.44s/epoch, loss=1.13, accuracy=0.753, val_loss=2.42, val_accuracy=0.375, lr=0.1] 44%|████▍     | 41/93 [19:20<23:48, 27.47s/epoch, loss=1.14, accuracy=0.754, val_loss=2.51, val_accuracy=0.447, lr=0.1] 45%|████▌     | 42/93 [19:47<23:19, 27.43s/epoch, loss=1.12, accuracy=0.757, val_loss=2.04, val_accuracy=0.459, lr=0.0316] 46%|████▌     | 43/93 [20:15<22:53, 27.48s/epoch, loss=1.12, accuracy=0.756, val_loss=1.57, val_accuracy=0.592, lr=0.1]    47%|████▋     | 44/93 [20:42<22:23, 27.41s/epoch, loss=1.12, accuracy=0.755, val_loss=2.08, val_accuracy=0.479, lr=0.1] 48%|████▊     | 45/93 [21:10<21:57, 27.44s/epoch, loss=1.12, accuracy=0.756, val_loss=1.69, val_accuracy=0.553, lr=0.1] 49%|████▉     | 46/93 [21:37<21:30, 27.46s/epoch, loss=1.12, accuracy=0.759, val_loss=3.08, val_accuracy=0.345, lr=0.1] 51%|█████     | 47/93 [22:05<21:03, 27.47s/epoch, loss=1.13, accuracy=0.755, val_loss=3.34, val_accuracy=0.229, lr=0.0316] 52%|█████▏    | 48/93 [22:32<20:36, 27.47s/epoch, loss=1.11, accuracy=0.758, val_loss=1.8, val_accuracy=0.51, lr=0.1]      53%|█████▎    | 49/93 [23:00<20:09, 27.50s/epoch, loss=1.11, accuracy=0.757, val_loss=2.29, val_accuracy=0.369, lr=0.1] 54%|█████▍    | 50/93 [23:27<19:41, 27.48s/epoch, loss=1.12, accuracy=0.759, val_loss=2.03, val_accuracy=0.484, lr=0.1] 55%|█████▍    | 51/93 [23:55<19:14, 27.49s/epoch, loss=1.12, accuracy=0.754, val_loss=2.23, val_accuracy=0.436, lr=0.1] 56%|█████▌    | 52/93 [24:22<18:47, 27.50s/epoch, loss=1.12, accuracy=0.759, val_loss=1.87, val_accuracy=0.56, lr=0.0316] 57%|█████▋    | 53/93 [24:50<18:18, 27.47s/epoch, loss=1.11, accuracy=0.756, val_loss=2.03, val_accuracy=0.52, lr=0.1]    58%|█████▊    | 54/93 [25:17<17:52, 27.51s/epoch, loss=1.11, accuracy=0.761, val_loss=2.1, val_accuracy=0.399, lr=0.1] 59%|█████▉    | 55/93 [25:45<17:24, 27.50s/epoch, loss=1.12, accuracy=0.76, val_loss=2.89, val_accuracy=0.348, lr=0.1] 60%|██████    | 56/93 [26:12<16:54, 27.42s/epoch, loss=1.11, accuracy=0.759, val_loss=3.28, val_accuracy=0.391, lr=0.1] 61%|██████▏   | 57/93 [26:39<16:25, 27.38s/epoch, loss=1.11, accuracy=0.758, val_loss=2.24, val_accuracy=0.423, lr=0.0316] 62%|██████▏   | 58/93 [27:07<15:59, 27.41s/epoch, loss=1.1, accuracy=0.759, val_loss=2.84, val_accuracy=0.352, lr=0.1]     63%|██████▎   | 59/93 [27:34<15:30, 27.37s/epoch, loss=1.11, accuracy=0.757, val_loss=1.81, val_accuracy=0.561, lr=0.1] 65%|██████▍   | 60/93 [28:01<15:04, 27.42s/epoch, loss=1.11, accuracy=0.758, val_loss=2.23, val_accuracy=0.376, lr=0.1] 66%|██████▌   | 61/93 [28:29<14:37, 27.41s/epoch, loss=1.11, accuracy=0.759, val_loss=1.67, val_accuracy=0.605, lr=0.1] 67%|██████▋   | 62/93 [28:56<14:07, 27.35s/epoch, loss=1.1, accuracy=0.76, val_loss=1.8, val_accuracy=0.512, lr=0.0316] 68%|██████▊   | 63/93 [29:23<13:38, 27.30s/epoch, loss=1.11, accuracy=0.757, val_loss=3.5, val_accuracy=0.243, lr=0.1]  69%|██████▉   | 64/93 [29:51<13:14, 27.41s/epoch, loss=1.11, accuracy=0.76, val_loss=2.15, val_accuracy=0.492, lr=0.1] 70%|██████▉   | 65/93 [30:18<12:46, 27.38s/epoch, loss=1.11, accuracy=0.759, val_loss=1.73, val_accuracy=0.524, lr=0.1] 71%|███████   | 66/93 [30:46<12:22, 27.51s/epoch, loss=1.11, accuracy=0.759, val_loss=1.46, val_accuracy=0.642, lr=0.1] 72%|███████▏  | 67/93 [31:13<11:53, 27.45s/epoch, loss=1.11, accuracy=0.759, val_loss=3.65, val_accuracy=0.208, lr=0.0316] 73%|███████▎  | 68/93 [31:41<11:25, 27.41s/epoch, loss=1.11, accuracy=0.76, val_loss=1.86, val_accuracy=0.486, lr=0.1]     74%|███████▍  | 69/93 [32:08<10:58, 27.42s/epoch, loss=1.1, accuracy=0.759, val_loss=5.25, val_accuracy=0.256, lr=0.1] 75%|███████▌  | 70/93 [32:36<10:31, 27.47s/epoch, loss=1.11, accuracy=0.761, val_loss=2.48, val_accuracy=0.376, lr=0.1] 76%|███████▋  | 71/93 [33:03<10:02, 27.39s/epoch, loss=1.11, accuracy=0.759, val_loss=3.3, val_accuracy=0.335, lr=0.1]  77%|███████▋  | 72/93 [33:30<09:36, 27.43s/epoch, loss=1.11, accuracy=0.758, val_loss=2.88, val_accuracy=0.429, lr=0.0316] 78%|███████▊  | 73/93 [33:58<09:09, 27.45s/epoch, loss=1.1, accuracy=0.76, val_loss=3, val_accuracy=0.317, lr=0.1]         80%|███████▉  | 74/93 [34:25<08:40, 27.40s/epoch, loss=1.11, accuracy=0.759, val_loss=2.16, val_accuracy=0.47, lr=0.1] 81%|████████  | 75/93 [34:53<08:13, 27.44s/epoch, loss=1.1, accuracy=0.762, val_loss=2.33, val_accuracy=0.422, lr=0.1] 82%|████████▏ | 76/93 [35:20<07:46, 27.43s/epoch, loss=1.1, accuracy=0.761, val_loss=2.09, val_accuracy=0.434, lr=0.1] 83%|████████▎ | 77/93 [35:48<07:18, 27.42s/epoch, loss=1.1, accuracy=0.758, val_loss=2.4, val_accuracy=0.403, lr=0.0316] 84%|████████▍ | 78/93 [36:15<06:51, 27.42s/epoch, loss=1.11, accuracy=0.758, val_loss=2.71, val_accuracy=0.421, lr=0.1]  85%|████████▍ | 79/93 [36:42<06:24, 27.44s/epoch, loss=1.1, accuracy=0.759, val_loss=1.7, val_accuracy=0.573, lr=0.1]   86%|████████▌ | 80/93 [37:10<05:56, 27.44s/epoch, loss=1.11, accuracy=0.759, val_loss=4.51, val_accuracy=0.283, lr=0.1] 87%|████████▋ | 81/93 [37:37<05:29, 27.50s/epoch, loss=1.1, accuracy=0.76, val_loss=2.03, val_accuracy=0.448, lr=0.1]   88%|████████▊ | 82/93 [38:05<05:03, 27.59s/epoch, loss=0.892, accuracy=0.82, val_loss=0.892, val_accuracy=0.805, lr=0.01] 89%|████████▉ | 83/93 [38:33<04:35, 27.54s/epoch, loss=0.728, accuracy=0.848, val_loss=0.774, val_accuracy=0.826, lr=0.01] 90%|█████████ | 84/93 [39:00<04:07, 27.50s/epoch, loss=0.653, accuracy=0.855, val_loss=0.822, val_accuracy=0.791, lr=0.01] 91%|█████████▏| 85/93 [39:27<03:39, 27.46s/epoch, loss=0.604, accuracy=0.861, val_loss=0.708, val_accuracy=0.823, lr=0.01] 92%|█████████▏| 86/93 [39:55<03:12, 27.45s/epoch, loss=0.581, accuracy=0.862, val_loss=1.15, val_accuracy=0.67, lr=0.01]   94%|█████████▎| 87/93 [40:22<02:44, 27.42s/epoch, loss=0.57, accuracy=0.864, val_loss=0.917, val_accuracy=0.755, lr=0.01] 95%|█████████▍| 88/93 [40:50<02:16, 27.39s/epoch, loss=0.559, accuracy=0.864, val_loss=0.945, val_accuracy=0.745, lr=0.01] 96%|█████████▌| 89/93 [41:17<01:49, 27.39s/epoch, loss=0.557, accuracy=0.865, val_loss=0.738, val_accuracy=0.821, lr=0.01] 97%|█████████▋| 90/93 [41:44<01:22, 27.36s/epoch, loss=0.552, accuracy=0.867, val_loss=1.38, val_accuracy=0.656, lr=0.00316] 98%|█████████▊| 91/93 [42:12<00:54, 27.33s/epoch, loss=0.548, accuracy=0.868, val_loss=0.998, val_accuracy=0.744, lr=0.01]   99%|█████████▉| 92/93 [42:39<00:27, 27.37s/epoch, loss=0.554, accuracy=0.867, val_loss=1.04, val_accuracy=0.716, lr=0.01] 100%|██████████| 93/93 [43:06<00:00, 27.30s/epoch, loss=0.548, accuracy=0.872, val_loss=0.736, val_accuracy=0.819, lr=0.01]100%|██████████| 93/93 [43:06<00:00, 27.81s/epoch, loss=0.548, accuracy=0.872, val_loss=0.736, val_accuracy=0.819, lr=0.01]
Using real-time data augmentation.
Test score: 0.7710859775543213
Test accuracy: 0.8252999782562256


* * * Run SGD for ID = 16_14. * * *


2024-02-20 07:14:49.387355: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 07:14:52.307834: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 07:14:52.309237: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-20 07:14:52.350229: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-20 07:14:52.350284: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 07:14:52.354403: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 07:14:52.354498: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-20 07:14:52.357551: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-20 07:14:52.358376: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-20 07:14:52.361086: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-20 07:14:52.362899: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-20 07:14:52.369421: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 07:14:52.370292: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-20 07:14:52.370429: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 07:14:53.808690: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-20 07:14:53.809717: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 07:14:53.810278: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-20 07:14:53.810314: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 07:14:53.810349: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 07:14:53.810363: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-20 07:14:53.810377: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-20 07:14:53.810391: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-20 07:14:53.810405: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-20 07:14:53.810418: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-20 07:14:53.810433: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 07:14:53.811031: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-20 07:14:53.811076: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 07:14:54.475041: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-20 07:14:54.475102: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-20 07:14:54.475113: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-20 07:14:54.476251: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:18:00.0, compute capability: 6.1)
{'id': '16_14', 'batch_size': 128, 'epochs': 93, 'validation_split': 0.1, 'checkpointing': True, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
x_train shape: (45000, 32, 32, 3)
45000 train samples
5000 validation samples
10000 test samples
y_train shape: (45000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/93 [00:00<?, ?epoch/s]2024-02-20 07:14:55.368883: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-20 07:14:55.381046: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-02-20 07:14:57.509757: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 07:14:57.853812: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 07:14:58.700664: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-20 07:14:58.750266: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/93 [01:01<1:34:27, 61.60s/epoch, loss=3.38, accuracy=0.316, val_loss=2.2, val_accuracy=0.345, lr=0.1]  2%|▏         | 2/93 [01:26<1:01:01, 40.23s/epoch, loss=1.69, accuracy=0.482, val_loss=1.88, val_accuracy=0.394, lr=0.1]  3%|▎         | 3/93 [01:51<49:58, 33.32s/epoch, loss=1.5, accuracy=0.562, val_loss=1.75, val_accuracy=0.512, lr=0.1]     4%|▍         | 4/93 [02:17<44:38, 30.09s/epoch, loss=1.39, accuracy=0.632, val_loss=2.19, val_accuracy=0.384, lr=0.1]  5%|▌         | 5/93 [02:41<41:20, 28.19s/epoch, loss=1.32, accuracy=0.672, val_loss=2.29, val_accuracy=0.431, lr=0.1]  6%|▋         | 6/93 [03:07<39:21, 27.14s/epoch, loss=1.28, accuracy=0.691, val_loss=1.6, val_accuracy=0.575, lr=0.1]   8%|▊         | 7/93 [03:32<37:59, 26.50s/epoch, loss=1.26, accuracy=0.706, val_loss=1.75, val_accuracy=0.531, lr=0.1]  9%|▊         | 8/93 [03:57<36:57, 26.09s/epoch, loss=1.25, accuracy=0.715, val_loss=1.99, val_accuracy=0.515, lr=0.1] 10%|▉         | 9/93 [04:22<35:51, 25.62s/epoch, loss=1.24, accuracy=0.72, val_loss=3.75, val_accuracy=0.179, lr=0.1]  11%|█         | 10/93 [04:46<35:09, 25.42s/epoch, loss=1.23, accuracy=0.727, val_loss=1.86, val_accuracy=0.537, lr=0.1] 12%|█▏        | 11/93 [05:11<34:32, 25.27s/epoch, loss=1.22, accuracy=0.729, val_loss=1.44, val_accuracy=0.643, lr=0.1] 13%|█▎        | 12/93 [05:36<33:45, 25.01s/epoch, loss=1.22, accuracy=0.73, val_loss=1.62, val_accuracy=0.585, lr=0.1]  14%|█▍        | 13/93 [06:01<33:15, 24.94s/epoch, loss=1.21, accuracy=0.736, val_loss=1.81, val_accuracy=0.522, lr=0.1] 15%|█▌        | 14/93 [06:25<32:37, 24.78s/epoch, loss=1.21, accuracy=0.737, val_loss=1.71, val_accuracy=0.555, lr=0.1] 16%|█▌        | 15/93 [06:50<32:09, 24.74s/epoch, loss=1.2, accuracy=0.738, val_loss=2.57, val_accuracy=0.404, lr=0.1]  17%|█▋        | 16/93 [07:14<31:44, 24.74s/epoch, loss=1.19, accuracy=0.74, val_loss=2.01, val_accuracy=0.451, lr=0.0316] 18%|█▊        | 17/93 [07:39<31:16, 24.69s/epoch, loss=1.19, accuracy=0.741, val_loss=1.82, val_accuracy=0.53, lr=0.1]    19%|█▉        | 18/93 [08:04<31:06, 24.88s/epoch, loss=1.19, accuracy=0.741, val_loss=2.13, val_accuracy=0.513, lr=0.1] 20%|██        | 19/93 [08:29<30:35, 24.80s/epoch, loss=1.18, accuracy=0.742, val_loss=1.63, val_accuracy=0.624, lr=0.1] 22%|██▏       | 20/93 [08:54<30:15, 24.87s/epoch, loss=1.19, accuracy=0.742, val_loss=1.5, val_accuracy=0.647, lr=0.1]  23%|██▎       | 21/93 [09:19<29:57, 24.97s/epoch, loss=1.17, accuracy=0.745, val_loss=2.25, val_accuracy=0.411, lr=0.0316] 24%|██▎       | 22/93 [09:44<29:20, 24.80s/epoch, loss=1.17, accuracy=0.743, val_loss=1.69, val_accuracy=0.584, lr=0.1]    25%|██▍       | 23/93 [10:09<29:11, 25.02s/epoch, loss=1.17, accuracy=0.746, val_loss=1.97, val_accuracy=0.505, lr=0.1] 26%|██▌       | 24/93 [10:34<28:43, 24.98s/epoch, loss=1.17, accuracy=0.748, val_loss=2.09, val_accuracy=0.485, lr=0.1] 27%|██▋       | 25/93 [10:59<28:13, 24.90s/epoch, loss=1.17, accuracy=0.747, val_loss=2.47, val_accuracy=0.487, lr=0.1] 28%|██▊       | 26/93 [11:24<27:57, 25.03s/epoch, loss=1.16, accuracy=0.75, val_loss=2.66, val_accuracy=0.459, lr=0.0316] 29%|██▉       | 27/93 [11:49<27:30, 25.00s/epoch, loss=1.16, accuracy=0.749, val_loss=1.76, val_accuracy=0.6, lr=0.1]     30%|███       | 28/93 [12:14<27:02, 24.97s/epoch, loss=1.16, accuracy=0.747, val_loss=1.84, val_accuracy=0.514, lr=0.1] 31%|███       | 29/93 [12:38<26:31, 24.86s/epoch, loss=1.16, accuracy=0.751, val_loss=2.5, val_accuracy=0.408, lr=0.1]  32%|███▏      | 30/93 [13:03<26:05, 24.85s/epoch, loss=1.16, accuracy=0.75, val_loss=2.24, val_accuracy=0.42, lr=0.1]  33%|███▎      | 31/93 [13:28<25:33, 24.74s/epoch, loss=1.15, accuracy=0.752, val_loss=1.85, val_accuracy=0.567, lr=0.0316] 34%|███▍      | 32/93 [13:52<25:06, 24.69s/epoch, loss=1.15, accuracy=0.751, val_loss=3.3, val_accuracy=0.314, lr=0.1]     35%|███▌      | 33/93 [14:17<24:49, 24.83s/epoch, loss=1.16, accuracy=0.752, val_loss=1.62, val_accuracy=0.59, lr=0.1] 37%|███▋      | 34/93 [14:43<24:34, 25.00s/epoch, loss=1.15, accuracy=0.753, val_loss=2.09, val_accuracy=0.436, lr=0.1] 38%|███▊      | 35/93 [15:08<24:08, 24.97s/epoch, loss=1.15, accuracy=0.754, val_loss=2.3, val_accuracy=0.487, lr=0.1]  39%|███▊      | 36/93 [15:32<23:36, 24.86s/epoch, loss=1.15, accuracy=0.755, val_loss=1.83, val_accuracy=0.544, lr=0.0316] 40%|███▉      | 37/93 [15:57<23:09, 24.82s/epoch, loss=1.14, accuracy=0.755, val_loss=2.86, val_accuracy=0.272, lr=0.1]    41%|████      | 38/93 [16:22<22:44, 24.80s/epoch, loss=1.15, accuracy=0.749, val_loss=1.48, val_accuracy=0.644, lr=0.1] 42%|████▏     | 39/93 [16:47<22:24, 24.91s/epoch, loss=1.14, accuracy=0.755, val_loss=2.22, val_accuracy=0.505, lr=0.1] 43%|████▎     | 40/93 [17:12<22:06, 25.03s/epoch, loss=1.15, accuracy=0.754, val_loss=1.74, val_accuracy=0.572, lr=0.1] 44%|████▍     | 41/93 [17:37<21:34, 24.89s/epoch, loss=1.15, accuracy=0.754, val_loss=2.66, val_accuracy=0.352, lr=0.0316] 45%|████▌     | 42/93 [18:02<21:05, 24.81s/epoch, loss=1.14, accuracy=0.753, val_loss=1.89, val_accuracy=0.54, lr=0.1]     46%|████▌     | 43/93 [18:26<20:36, 24.74s/epoch, loss=1.14, accuracy=0.754, val_loss=1.88, val_accuracy=0.533, lr=0.1] 47%|████▋     | 44/93 [18:51<20:11, 24.72s/epoch, loss=1.14, accuracy=0.756, val_loss=1.97, val_accuracy=0.536, lr=0.1] 48%|████▊     | 45/93 [19:16<19:50, 24.80s/epoch, loss=1.14, accuracy=0.753, val_loss=1.57, val_accuracy=0.618, lr=0.1] 49%|████▉     | 46/93 [19:43<20:04, 25.63s/epoch, loss=1.14, accuracy=0.752, val_loss=1.75, val_accuracy=0.593, lr=0.0316] 51%|█████     | 47/93 [20:11<20:04, 26.18s/epoch, loss=1.14, accuracy=0.758, val_loss=1.51, val_accuracy=0.624, lr=0.1]    52%|█████▏    | 48/93 [20:39<20:00, 26.68s/epoch, loss=1.14, accuracy=0.756, val_loss=2.08, val_accuracy=0.511, lr=0.1] 53%|█████▎    | 49/93 [21:06<19:39, 26.81s/epoch, loss=1.14, accuracy=0.756, val_loss=1.76, val_accuracy=0.615, lr=0.1] 54%|█████▍    | 50/93 [21:33<19:16, 26.89s/epoch, loss=1.13, accuracy=0.754, val_loss=2.07, val_accuracy=0.467, lr=0.1] 55%|█████▍    | 51/93 [21:59<18:42, 26.72s/epoch, loss=1.13, accuracy=0.757, val_loss=1.78, val_accuracy=0.533, lr=0.0316] 56%|█████▌    | 52/93 [22:25<18:03, 26.42s/epoch, loss=1.14, accuracy=0.753, val_loss=2.12, val_accuracy=0.395, lr=0.1]    57%|█████▋    | 53/93 [22:50<17:20, 26.01s/epoch, loss=1.13, accuracy=0.757, val_loss=1.82, val_accuracy=0.566, lr=0.1] 58%|█████▊    | 54/93 [23:15<16:44, 25.76s/epoch, loss=1.14, accuracy=0.756, val_loss=2.11, val_accuracy=0.438, lr=0.1] 59%|█████▉    | 55/93 [23:40<16:06, 25.44s/epoch, loss=1.13, accuracy=0.756, val_loss=4.03, val_accuracy=0.302, lr=0.1] 60%|██████    | 56/93 [24:05<15:40, 25.43s/epoch, loss=1.14, accuracy=0.754, val_loss=1.67, val_accuracy=0.579, lr=0.0316] 61%|██████▏   | 57/93 [24:30<15:10, 25.28s/epoch, loss=1.14, accuracy=0.757, val_loss=3, val_accuracy=0.267, lr=0.1]       62%|██████▏   | 58/93 [24:55<14:41, 25.20s/epoch, loss=1.14, accuracy=0.755, val_loss=1.95, val_accuracy=0.484, lr=0.1] 63%|██████▎   | 59/93 [25:20<14:14, 25.13s/epoch, loss=1.13, accuracy=0.755, val_loss=5.13, val_accuracy=0.326, lr=0.1] 65%|██████▍   | 60/93 [25:45<13:43, 24.95s/epoch, loss=1.13, accuracy=0.756, val_loss=2.98, val_accuracy=0.429, lr=0.1] 66%|██████▌   | 61/93 [26:09<13:14, 24.81s/epoch, loss=1.13, accuracy=0.756, val_loss=1.57, val_accuracy=0.6, lr=0.0316] 67%|██████▋   | 62/93 [26:34<12:51, 24.88s/epoch, loss=1.12, accuracy=0.76, val_loss=1.86, val_accuracy=0.514, lr=0.1]   68%|██████▊   | 63/93 [27:01<12:41, 25.40s/epoch, loss=1.13, accuracy=0.756, val_loss=1.88, val_accuracy=0.516, lr=0.1] 69%|██████▉   | 64/93 [27:26<12:14, 25.31s/epoch, loss=1.13, accuracy=0.756, val_loss=2.55, val_accuracy=0.423, lr=0.1] 70%|██████▉   | 65/93 [27:51<11:48, 25.31s/epoch, loss=1.13, accuracy=0.755, val_loss=1.38, val_accuracy=0.666, lr=0.1] 71%|███████   | 66/93 [28:17<11:25, 25.38s/epoch, loss=1.13, accuracy=0.759, val_loss=2.27, val_accuracy=0.467, lr=0.1] 72%|███████▏  | 67/93 [28:42<10:58, 25.31s/epoch, loss=1.13, accuracy=0.756, val_loss=1.54, val_accuracy=0.603, lr=0.1] 73%|███████▎  | 68/93 [29:07<10:29, 25.19s/epoch, loss=1.13, accuracy=0.756, val_loss=1.63, val_accuracy=0.589, lr=0.1] 74%|███████▍  | 69/93 [29:32<10:04, 25.20s/epoch, loss=1.12, accuracy=0.755, val_loss=5.55, val_accuracy=0.265, lr=0.1] 75%|███████▌  | 70/93 [29:57<09:36, 25.05s/epoch, loss=1.13, accuracy=0.757, val_loss=1.75, val_accuracy=0.563, lr=0.0316] 76%|███████▋  | 71/93 [30:21<09:09, 24.96s/epoch, loss=1.13, accuracy=0.756, val_loss=2.66, val_accuracy=0.364, lr=0.1]    77%|███████▋  | 72/93 [30:45<08:38, 24.69s/epoch, loss=1.13, accuracy=0.758, val_loss=1.85, val_accuracy=0.484, lr=0.1] 78%|███████▊  | 73/93 [31:10<08:13, 24.70s/epoch, loss=1.12, accuracy=0.762, val_loss=3.41, val_accuracy=0.338, lr=0.1] 80%|███████▉  | 74/93 [31:35<07:49, 24.70s/epoch, loss=1.13, accuracy=0.757, val_loss=2, val_accuracy=0.52, lr=0.1]     81%|████████  | 75/93 [32:00<07:26, 24.83s/epoch, loss=1.12, accuracy=0.757, val_loss=1.62, val_accuracy=0.603, lr=0.0316] 82%|████████▏ | 76/93 [32:25<07:02, 24.83s/epoch, loss=1.12, accuracy=0.761, val_loss=1.79, val_accuracy=0.567, lr=0.1]    83%|████████▎ | 77/93 [32:50<06:38, 24.88s/epoch, loss=1.12, accuracy=0.76, val_loss=2.77, val_accuracy=0.375, lr=0.1]  84%|████████▍ | 78/93 [33:15<06:13, 24.87s/epoch, loss=1.14, accuracy=0.758, val_loss=1.74, val_accuracy=0.589, lr=0.1] 85%|████████▍ | 79/93 [33:40<05:49, 24.97s/epoch, loss=1.12, accuracy=0.758, val_loss=3.51, val_accuracy=0.338, lr=0.1] 86%|████████▌ | 80/93 [34:05<05:23, 24.92s/epoch, loss=1.13, accuracy=0.759, val_loss=1.78, val_accuracy=0.584, lr=0.0316] 87%|████████▋ | 81/93 [34:30<04:58, 24.90s/epoch, loss=1.12, accuracy=0.759, val_loss=2.72, val_accuracy=0.369, lr=0.1]    88%|████████▊ | 82/93 [34:55<04:36, 25.10s/epoch, loss=0.935, accuracy=0.816, val_loss=0.953, val_accuracy=0.791, lr=0.01] 89%|████████▉ | 83/93 [35:20<04:09, 24.98s/epoch, loss=0.747, accuracy=0.852, val_loss=0.781, val_accuracy=0.833, lr=0.01] 90%|█████████ | 84/93 [35:45<03:44, 24.95s/epoch, loss=0.658, accuracy=0.862, val_loss=0.818, val_accuracy=0.8, lr=0.01]   91%|█████████▏| 85/93 [36:10<03:19, 24.90s/epoch, loss=0.61, accuracy=0.864, val_loss=0.779, val_accuracy=0.803, lr=0.01] 92%|█████████▏| 86/93 [36:34<02:53, 24.80s/epoch, loss=0.583, accuracy=0.867, val_loss=0.724, val_accuracy=0.819, lr=0.01] 94%|█████████▎| 87/93 [37:00<02:29, 25.00s/epoch, loss=0.571, accuracy=0.866, val_loss=0.824, val_accuracy=0.789, lr=0.01] 95%|█████████▍| 88/93 [37:24<02:04, 24.81s/epoch, loss=0.564, accuracy=0.867, val_loss=0.74, val_accuracy=0.813, lr=0.01]  96%|█████████▌| 89/93 [37:48<01:38, 24.72s/epoch, loss=0.556, accuracy=0.87, val_loss=1.21, val_accuracy=0.704, lr=0.01]  97%|█████████▋| 90/93 [38:14<01:14, 24.83s/epoch, loss=0.559, accuracy=0.87, val_loss=0.757, val_accuracy=0.803, lr=0.01] 98%|█████████▊| 91/93 [38:38<00:49, 24.86s/epoch, loss=0.553, accuracy=0.87, val_loss=0.775, val_accuracy=0.804, lr=0.00316] 99%|█████████▉| 92/93 [39:03<00:24, 24.88s/epoch, loss=0.551, accuracy=0.874, val_loss=0.967, val_accuracy=0.768, lr=0.01]  100%|██████████| 93/93 [39:28<00:00, 24.83s/epoch, loss=0.549, accuracy=0.875, val_loss=0.757, val_accuracy=0.804, lr=0.01]100%|██████████| 93/93 [39:28<00:00, 25.47s/epoch, loss=0.549, accuracy=0.875, val_loss=0.757, val_accuracy=0.804, lr=0.01]
Using real-time data augmentation.
Test score: 0.7727423906326294
Test accuracy: 0.8342999815940857


* * * Run SGD for ID = 16_15. * * *


2024-02-20 07:54:30.693047: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 07:54:33.549594: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 07:54:33.550907: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-20 07:54:33.594041: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-20 07:54:33.594086: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 07:54:33.597445: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 07:54:33.597516: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-20 07:54:33.600003: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-20 07:54:33.600799: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-20 07:54:33.603608: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-20 07:54:33.605406: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-20 07:54:33.611162: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 07:54:33.611944: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-20 07:54:33.612035: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 07:54:35.141041: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-20 07:54:35.142136: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 07:54:35.142679: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-20 07:54:35.142729: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 07:54:35.142772: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 07:54:35.142795: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-20 07:54:35.142818: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-20 07:54:35.142853: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-20 07:54:35.142876: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-20 07:54:35.142899: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-20 07:54:35.142922: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 07:54:35.144967: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-20 07:54:35.145010: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 07:54:35.842524: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-20 07:54:35.842599: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-20 07:54:35.842612: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-20 07:54:35.844558: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:18:00.0, compute capability: 6.1)
{'id': '16_15', 'batch_size': 128, 'epochs': 93, 'validation_split': 0.1, 'checkpointing': True, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
x_train shape: (45000, 32, 32, 3)
45000 train samples
5000 validation samples
10000 test samples
y_train shape: (45000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/93 [00:00<?, ?epoch/s]2024-02-20 07:54:36.785728: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-20 07:54:36.786332: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-02-20 07:54:38.989623: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 07:54:39.288814: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 07:54:40.296376: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-20 07:54:40.347318: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/93 [01:01<1:33:57, 61.28s/epoch, loss=3.38, accuracy=0.262, val_loss=2.5, val_accuracy=0.24, lr=0.1]  2%|▏         | 2/93 [01:26<1:00:42, 40.03s/epoch, loss=1.66, accuracy=0.49, val_loss=2.38, val_accuracy=0.329, lr=0.1]  3%|▎         | 3/93 [01:51<50:04, 33.38s/epoch, loss=1.47, accuracy=0.576, val_loss=2.62, val_accuracy=0.43, lr=0.1]    4%|▍         | 4/93 [02:16<44:34, 30.05s/epoch, loss=1.37, accuracy=0.635, val_loss=2.57, val_accuracy=0.349, lr=0.1]  5%|▌         | 5/93 [02:42<41:41, 28.42s/epoch, loss=1.32, accuracy=0.667, val_loss=1.85, val_accuracy=0.5, lr=0.1]    6%|▋         | 6/93 [03:07<39:22, 27.16s/epoch, loss=1.29, accuracy=0.686, val_loss=1.6, val_accuracy=0.579, lr=0.1]  8%|▊         | 7/93 [03:32<38:04, 26.56s/epoch, loss=1.27, accuracy=0.696, val_loss=1.75, val_accuracy=0.541, lr=0.1]  9%|▊         | 8/93 [03:57<37:04, 26.17s/epoch, loss=1.25, accuracy=0.707, val_loss=1.74, val_accuracy=0.573, lr=0.1] 10%|▉         | 9/93 [04:23<36:17, 25.93s/epoch, loss=1.24, accuracy=0.713, val_loss=3.52, val_accuracy=0.317, lr=0.1] 11%|█         | 10/93 [04:48<35:36, 25.74s/epoch, loss=1.24, accuracy=0.718, val_loss=1.48, val_accuracy=0.636, lr=0.1] 12%|█▏        | 11/93 [05:13<34:52, 25.52s/epoch, loss=1.24, accuracy=0.722, val_loss=1.87, val_accuracy=0.548, lr=0.1] 13%|█▎        | 12/93 [05:38<34:16, 25.39s/epoch, loss=1.22, accuracy=0.724, val_loss=2.51, val_accuracy=0.378, lr=0.1] 14%|█▍        | 13/93 [06:04<33:54, 25.43s/epoch, loss=1.22, accuracy=0.724, val_loss=3.17, val_accuracy=0.308, lr=0.1] 15%|█▌        | 14/93 [06:29<33:33, 25.49s/epoch, loss=1.21, accuracy=0.731, val_loss=1.81, val_accuracy=0.566, lr=0.1] 16%|█▌        | 15/93 [06:55<33:05, 25.45s/epoch, loss=1.21, accuracy=0.73, val_loss=1.71, val_accuracy=0.603, lr=0.0316] 17%|█▋        | 16/93 [07:20<32:31, 25.34s/epoch, loss=1.2, accuracy=0.733, val_loss=1.91, val_accuracy=0.536, lr=0.1]    18%|█▊        | 17/93 [07:45<32:02, 25.30s/epoch, loss=1.19, accuracy=0.734, val_loss=3.21, val_accuracy=0.334, lr=0.1] 19%|█▉        | 18/93 [08:10<31:39, 25.33s/epoch, loss=1.2, accuracy=0.732, val_loss=1.91, val_accuracy=0.551, lr=0.1]  20%|██        | 19/93 [08:35<31:08, 25.25s/epoch, loss=1.19, accuracy=0.736, val_loss=1.97, val_accuracy=0.545, lr=0.1] 22%|██▏       | 20/93 [09:01<30:41, 25.22s/epoch, loss=1.19, accuracy=0.735, val_loss=1.82, val_accuracy=0.554, lr=0.0316] 23%|██▎       | 21/93 [09:26<30:18, 25.26s/epoch, loss=1.18, accuracy=0.739, val_loss=2.04, val_accuracy=0.525, lr=0.1]    24%|██▎       | 22/93 [09:51<29:46, 25.16s/epoch, loss=1.18, accuracy=0.736, val_loss=1.94, val_accuracy=0.526, lr=0.1] 25%|██▍       | 23/93 [10:16<29:24, 25.21s/epoch, loss=1.18, accuracy=0.739, val_loss=1.72, val_accuracy=0.576, lr=0.1] 26%|██▌       | 24/93 [10:41<29:01, 25.24s/epoch, loss=1.17, accuracy=0.742, val_loss=1.45, val_accuracy=0.642, lr=0.1] 27%|██▋       | 25/93 [11:07<28:37, 25.25s/epoch, loss=1.18, accuracy=0.74, val_loss=1.69, val_accuracy=0.6, lr=0.1]    28%|██▊       | 26/93 [11:33<28:23, 25.43s/epoch, loss=1.17, accuracy=0.743, val_loss=1.6, val_accuracy=0.622, lr=0.1] 29%|██▉       | 27/93 [11:58<27:59, 25.44s/epoch, loss=1.17, accuracy=0.742, val_loss=1.49, val_accuracy=0.614, lr=0.1] 30%|███       | 28/93 [12:23<27:20, 25.24s/epoch, loss=1.16, accuracy=0.745, val_loss=2.32, val_accuracy=0.487, lr=0.1] 31%|███       | 29/93 [12:48<26:47, 25.11s/epoch, loss=1.17, accuracy=0.744, val_loss=1.81, val_accuracy=0.55, lr=0.0316] 32%|███▏      | 30/93 [13:13<26:28, 25.21s/epoch, loss=1.16, accuracy=0.742, val_loss=1.93, val_accuracy=0.55, lr=0.1]    33%|███▎      | 31/93 [13:39<26:09, 25.31s/epoch, loss=1.16, accuracy=0.744, val_loss=2.35, val_accuracy=0.459, lr=0.1] 34%|███▍      | 32/93 [14:04<25:48, 25.39s/epoch, loss=1.16, accuracy=0.745, val_loss=3.87, val_accuracy=0.331, lr=0.1] 35%|███▌      | 33/93 [14:30<25:23, 25.40s/epoch, loss=1.16, accuracy=0.746, val_loss=1.9, val_accuracy=0.512, lr=0.1]  37%|███▋      | 34/93 [14:55<24:53, 25.31s/epoch, loss=1.16, accuracy=0.746, val_loss=2.27, val_accuracy=0.49, lr=0.0316] 38%|███▊      | 35/93 [15:22<25:04, 25.94s/epoch, loss=1.16, accuracy=0.747, val_loss=1.89, val_accuracy=0.513, lr=0.1]   39%|███▊      | 36/93 [15:49<24:47, 26.10s/epoch, loss=1.16, accuracy=0.747, val_loss=1.57, val_accuracy=0.604, lr=0.1] 40%|███▉      | 37/93 [16:15<24:34, 26.33s/epoch, loss=1.15, accuracy=0.746, val_loss=2.81, val_accuracy=0.333, lr=0.1] 41%|████      | 38/93 [16:41<23:56, 26.12s/epoch, loss=1.15, accuracy=0.745, val_loss=3.73, val_accuracy=0.356, lr=0.1] 42%|████▏     | 39/93 [17:06<23:07, 25.70s/epoch, loss=1.16, accuracy=0.746, val_loss=2.17, val_accuracy=0.538, lr=0.0316] 43%|████▎     | 40/93 [17:32<22:42, 25.71s/epoch, loss=1.15, accuracy=0.751, val_loss=3.41, val_accuracy=0.388, lr=0.1]    44%|████▍     | 41/93 [17:57<22:09, 25.58s/epoch, loss=1.15, accuracy=0.747, val_loss=2.05, val_accuracy=0.482, lr=0.1] 45%|████▌     | 42/93 [18:22<21:34, 25.39s/epoch, loss=1.16, accuracy=0.747, val_loss=2.51, val_accuracy=0.468, lr=0.1] 46%|████▌     | 43/93 [18:47<21:03, 25.27s/epoch, loss=1.15, accuracy=0.751, val_loss=1.97, val_accuracy=0.535, lr=0.1] 47%|████▋     | 44/93 [19:13<20:47, 25.45s/epoch, loss=1.15, accuracy=0.747, val_loss=1.63, val_accuracy=0.588, lr=0.0316] 48%|████▊     | 45/93 [19:38<20:23, 25.48s/epoch, loss=1.15, accuracy=0.749, val_loss=2.16, val_accuracy=0.423, lr=0.1]    49%|████▉     | 46/93 [20:03<19:50, 25.34s/epoch, loss=1.14, accuracy=0.749, val_loss=3.21, val_accuracy=0.311, lr=0.1] 51%|█████     | 47/93 [20:28<19:24, 25.32s/epoch, loss=1.15, accuracy=0.75, val_loss=1.56, val_accuracy=0.617, lr=0.1]  52%|█████▏    | 48/93 [20:54<18:59, 25.32s/epoch, loss=1.15, accuracy=0.751, val_loss=2.09, val_accuracy=0.517, lr=0.1] 53%|█████▎    | 49/93 [21:19<18:30, 25.23s/epoch, loss=1.15, accuracy=0.75, val_loss=1.68, val_accuracy=0.58, lr=0.0316] 54%|█████▍    | 50/93 [21:44<18:02, 25.16s/epoch, loss=1.14, accuracy=0.748, val_loss=2.13, val_accuracy=0.452, lr=0.1]  55%|█████▍    | 51/93 [22:09<17:34, 25.11s/epoch, loss=1.14, accuracy=0.752, val_loss=1.56, val_accuracy=0.605, lr=0.1] 56%|█████▌    | 52/93 [22:33<17:02, 24.94s/epoch, loss=1.14, accuracy=0.75, val_loss=2.94, val_accuracy=0.341, lr=0.1]  57%|█████▋    | 53/93 [22:58<16:36, 24.90s/epoch, loss=1.14, accuracy=0.751, val_loss=2.19, val_accuracy=0.491, lr=0.1] 58%|█████▊    | 54/93 [23:23<16:09, 24.87s/epoch, loss=1.14, accuracy=0.75, val_loss=2.02, val_accuracy=0.541, lr=0.0316] 59%|█████▉    | 55/93 [23:48<15:47, 24.94s/epoch, loss=1.14, accuracy=0.749, val_loss=3.36, val_accuracy=0.354, lr=0.1]   60%|██████    | 56/93 [24:13<15:19, 24.86s/epoch, loss=1.15, accuracy=0.75, val_loss=2.53, val_accuracy=0.453, lr=0.1]  61%|██████▏   | 57/93 [24:38<15:00, 25.00s/epoch, loss=1.13, accuracy=0.753, val_loss=2.27, val_accuracy=0.436, lr=0.1] 62%|██████▏   | 58/93 [25:03<14:38, 25.09s/epoch, loss=1.13, accuracy=0.753, val_loss=2.01, val_accuracy=0.489, lr=0.1] 63%|██████▎   | 59/93 [25:28<14:12, 25.08s/epoch, loss=1.14, accuracy=0.754, val_loss=1.71, val_accuracy=0.552, lr=0.0316] 65%|██████▍   | 60/93 [25:53<13:46, 25.04s/epoch, loss=1.14, accuracy=0.753, val_loss=1.66, val_accuracy=0.584, lr=0.1]    66%|██████▌   | 61/93 [26:19<13:25, 25.16s/epoch, loss=1.14, accuracy=0.753, val_loss=1.54, val_accuracy=0.644, lr=0.1] 67%|██████▋   | 62/93 [26:43<12:55, 25.02s/epoch, loss=1.13, accuracy=0.753, val_loss=3.29, val_accuracy=0.315, lr=0.1] 68%|██████▊   | 63/93 [27:09<12:35, 25.17s/epoch, loss=1.14, accuracy=0.75, val_loss=1.82, val_accuracy=0.567, lr=0.1]  69%|██████▉   | 64/93 [27:34<12:09, 25.16s/epoch, loss=1.14, accuracy=0.751, val_loss=1.85, val_accuracy=0.536, lr=0.0316] 70%|██████▉   | 65/93 [27:59<11:41, 25.05s/epoch, loss=1.14, accuracy=0.748, val_loss=1.66, val_accuracy=0.561, lr=0.1]    71%|███████   | 66/93 [28:24<11:13, 24.95s/epoch, loss=1.13, accuracy=0.752, val_loss=1.57, val_accuracy=0.598, lr=0.1] 72%|███████▏  | 67/93 [28:49<10:50, 25.03s/epoch, loss=1.14, accuracy=0.751, val_loss=1.95, val_accuracy=0.514, lr=0.1] 73%|███████▎  | 68/93 [29:14<10:23, 24.94s/epoch, loss=1.13, accuracy=0.755, val_loss=1.64, val_accuracy=0.571, lr=0.1] 74%|███████▍  | 69/93 [29:38<09:57, 24.91s/epoch, loss=1.14, accuracy=0.75, val_loss=1.83, val_accuracy=0.539, lr=0.0316] 75%|███████▌  | 70/93 [30:03<09:34, 24.96s/epoch, loss=1.14, accuracy=0.752, val_loss=1.74, val_accuracy=0.586, lr=0.1]   76%|███████▋  | 71/93 [30:28<09:07, 24.87s/epoch, loss=1.13, accuracy=0.752, val_loss=2.42, val_accuracy=0.425, lr=0.1] 77%|███████▋  | 72/93 [30:53<08:41, 24.84s/epoch, loss=1.13, accuracy=0.754, val_loss=2.09, val_accuracy=0.547, lr=0.1] 78%|███████▊  | 73/93 [31:18<08:16, 24.82s/epoch, loss=1.13, accuracy=0.754, val_loss=1.74, val_accuracy=0.557, lr=0.1] 80%|███████▉  | 74/93 [31:43<07:56, 25.07s/epoch, loss=1.13, accuracy=0.753, val_loss=1.74, val_accuracy=0.572, lr=0.0316] 81%|████████  | 75/93 [32:09<07:34, 25.25s/epoch, loss=1.12, accuracy=0.756, val_loss=3.74, val_accuracy=0.333, lr=0.1]    82%|████████▏ | 76/93 [32:34<07:08, 25.19s/epoch, loss=1.12, accuracy=0.755, val_loss=3.64, val_accuracy=0.293, lr=0.1] 83%|████████▎ | 77/93 [33:00<06:46, 25.42s/epoch, loss=1.13, accuracy=0.754, val_loss=3.47, val_accuracy=0.314, lr=0.1] 84%|████████▍ | 78/93 [33:25<06:19, 25.32s/epoch, loss=1.13, accuracy=0.753, val_loss=1.63, val_accuracy=0.612, lr=0.1] 85%|████████▍ | 79/93 [33:51<05:56, 25.46s/epoch, loss=1.12, accuracy=0.755, val_loss=1.41, val_accuracy=0.667, lr=0.1] 86%|████████▌ | 80/93 [34:16<05:27, 25.23s/epoch, loss=1.13, accuracy=0.755, val_loss=1.82, val_accuracy=0.525, lr=0.1] 87%|████████▋ | 81/93 [34:41<05:03, 25.31s/epoch, loss=1.13, accuracy=0.753, val_loss=1.67, val_accuracy=0.59, lr=0.1]  88%|████████▊ | 82/93 [35:07<04:40, 25.52s/epoch, loss=0.925, accuracy=0.81, val_loss=0.944, val_accuracy=0.788, lr=0.01] 89%|████████▉ | 83/93 [35:32<04:14, 25.48s/epoch, loss=0.751, accuracy=0.844, val_loss=0.767, val_accuracy=0.837, lr=0.01] 90%|█████████ | 84/93 [35:57<03:46, 25.19s/epoch, loss=0.669, accuracy=0.854, val_loss=0.77, val_accuracy=0.817, lr=0.01]  91%|█████████▏| 85/93 [36:22<03:20, 25.05s/epoch, loss=0.62, accuracy=0.858, val_loss=0.782, val_accuracy=0.802, lr=0.01] 92%|█████████▏| 86/93 [36:47<02:55, 25.02s/epoch, loss=0.595, accuracy=0.859, val_loss=0.69, val_accuracy=0.832, lr=0.01] 94%|█████████▎| 87/93 [37:12<02:29, 25.00s/epoch, loss=0.584, accuracy=0.86, val_loss=0.78, val_accuracy=0.802, lr=0.01]  95%|█████████▍| 88/93 [37:37<02:04, 24.99s/epoch, loss=0.576, accuracy=0.861, val_loss=0.803, val_accuracy=0.796, lr=0.01] 96%|█████████▌| 89/93 [38:01<01:39, 24.85s/epoch, loss=0.573, accuracy=0.864, val_loss=0.827, val_accuracy=0.783, lr=0.01] 97%|█████████▋| 90/93 [38:27<01:15, 25.07s/epoch, loss=0.57, accuracy=0.861, val_loss=0.8, val_accuracy=0.787, lr=0.01]    98%|█████████▊| 91/93 [38:52<00:50, 25.09s/epoch, loss=0.564, accuracy=0.865, val_loss=1.03, val_accuracy=0.729, lr=0.00316] 99%|█████████▉| 92/93 [39:17<00:25, 25.09s/epoch, loss=0.569, accuracy=0.868, val_loss=0.929, val_accuracy=0.76, lr=0.01]   100%|██████████| 93/93 [39:42<00:00, 25.16s/epoch, loss=0.558, accuracy=0.87, val_loss=0.743, val_accuracy=0.812, lr=0.01]100%|██████████| 93/93 [39:42<00:00, 25.62s/epoch, loss=0.558, accuracy=0.87, val_loss=0.743, val_accuracy=0.812, lr=0.01]
Using real-time data augmentation.
Test score: 0.7852551937103271
Test accuracy: 0.8281999826431274


* * * Run SGD for ID = 16_16. * * *


2024-02-20 08:34:26.165154: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 08:34:28.980177: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 08:34:28.981500: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-20 08:34:29.023688: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-20 08:34:29.023738: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 08:34:29.027381: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 08:34:29.027455: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-20 08:34:29.030220: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-20 08:34:29.031021: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-20 08:34:29.034021: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-20 08:34:29.036029: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-20 08:34:29.041652: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 08:34:29.042380: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-20 08:34:29.042477: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 08:34:30.515651: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-20 08:34:30.516759: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 08:34:30.517307: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-20 08:34:30.517346: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 08:34:30.517387: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 08:34:30.517412: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-20 08:34:30.517427: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-20 08:34:30.517440: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-20 08:34:30.517455: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-20 08:34:30.517469: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-20 08:34:30.517484: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 08:34:30.518078: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-20 08:34:30.518127: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 08:34:31.201897: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-20 08:34:31.201960: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-20 08:34:31.201972: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-20 08:34:31.203743: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:18:00.0, compute capability: 6.1)
{'id': '16_16', 'batch_size': 128, 'epochs': 93, 'validation_split': 0.1, 'checkpointing': True, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
x_train shape: (45000, 32, 32, 3)
45000 train samples
5000 validation samples
10000 test samples
y_train shape: (45000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/93 [00:00<?, ?epoch/s]2024-02-20 08:34:32.057704: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-20 08:34:32.058217: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-02-20 08:34:34.089839: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 08:34:34.409141: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 08:34:35.272517: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-20 08:34:35.323631: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/93 [01:00<1:33:02, 60.67s/epoch, loss=3.54, accuracy=0.32, val_loss=2.59, val_accuracy=0.206, lr=0.1]  2%|▏         | 2/93 [01:25<1:00:25, 39.84s/epoch, loss=1.69, accuracy=0.488, val_loss=2.5, val_accuracy=0.24, lr=0.1]   3%|▎         | 3/93 [01:51<49:44, 33.16s/epoch, loss=1.48, accuracy=0.576, val_loss=3.12, val_accuracy=0.267, lr=0.1]  4%|▍         | 4/93 [02:16<44:37, 30.09s/epoch, loss=1.38, accuracy=0.637, val_loss=1.78, val_accuracy=0.528, lr=0.1]  5%|▌         | 5/93 [02:41<41:23, 28.23s/epoch, loss=1.31, accuracy=0.678, val_loss=1.76, val_accuracy=0.546, lr=0.1]  6%|▋         | 6/93 [03:06<39:32, 27.27s/epoch, loss=1.27, accuracy=0.701, val_loss=1.54, val_accuracy=0.617, lr=0.1]  8%|▊         | 7/93 [03:32<38:05, 26.58s/epoch, loss=1.25, accuracy=0.716, val_loss=1.72, val_accuracy=0.552, lr=0.1]  9%|▊         | 8/93 [03:56<36:53, 26.05s/epoch, loss=1.24, accuracy=0.718, val_loss=3.01, val_accuracy=0.282, lr=0.1] 10%|▉         | 9/93 [04:22<36:02, 25.75s/epoch, loss=1.23, accuracy=0.725, val_loss=2.17, val_accuracy=0.472, lr=0.1] 11%|█         | 10/93 [04:47<35:17, 25.51s/epoch, loss=1.22, accuracy=0.727, val_loss=2.84, val_accuracy=0.347, lr=0.1] 12%|█▏        | 11/93 [05:12<34:43, 25.41s/epoch, loss=1.21, accuracy=0.729, val_loss=1.68, val_accuracy=0.571, lr=0.0316] 13%|█▎        | 12/93 [05:37<34:19, 25.43s/epoch, loss=1.2, accuracy=0.734, val_loss=1.59, val_accuracy=0.609, lr=0.1]     14%|█▍        | 13/93 [06:02<33:51, 25.39s/epoch, loss=1.21, accuracy=0.734, val_loss=1.86, val_accuracy=0.512, lr=0.1] 15%|█▌        | 14/93 [06:28<33:19, 25.31s/epoch, loss=1.2, accuracy=0.738, val_loss=1.79, val_accuracy=0.554, lr=0.1]  16%|█▌        | 15/93 [06:53<32:46, 25.21s/epoch, loss=1.19, accuracy=0.741, val_loss=1.8, val_accuracy=0.537, lr=0.1] 17%|█▋        | 16/93 [07:17<32:12, 25.10s/epoch, loss=1.2, accuracy=0.736, val_loss=2.2, val_accuracy=0.48, lr=0.0316] 18%|█▊        | 17/93 [07:42<31:44, 25.06s/epoch, loss=1.19, accuracy=0.741, val_loss=2.05, val_accuracy=0.501, lr=0.1] 19%|█▉        | 18/93 [08:07<31:20, 25.08s/epoch, loss=1.19, accuracy=0.74, val_loss=1.74, val_accuracy=0.562, lr=0.1]  20%|██        | 19/93 [08:33<31:16, 25.35s/epoch, loss=1.19, accuracy=0.742, val_loss=2, val_accuracy=0.531, lr=0.1]   22%|██▏       | 20/93 [08:59<30:46, 25.30s/epoch, loss=1.18, accuracy=0.74, val_loss=2.26, val_accuracy=0.413, lr=0.1] 23%|██▎       | 21/93 [09:24<30:13, 25.19s/epoch, loss=1.19, accuracy=0.744, val_loss=1.68, val_accuracy=0.577, lr=0.0316] 24%|██▎       | 22/93 [09:49<29:43, 25.12s/epoch, loss=1.18, accuracy=0.745, val_loss=1.95, val_accuracy=0.475, lr=0.1]    25%|██▍       | 23/93 [10:14<29:25, 25.22s/epoch, loss=1.17, accuracy=0.745, val_loss=2.7, val_accuracy=0.403, lr=0.1]  26%|██▌       | 24/93 [10:40<29:15, 25.44s/epoch, loss=1.18, accuracy=0.742, val_loss=1.98, val_accuracy=0.469, lr=0.1] 27%|██▋       | 25/93 [11:07<29:19, 25.88s/epoch, loss=1.18, accuracy=0.746, val_loss=2.86, val_accuracy=0.371, lr=0.1] 28%|██▊       | 26/93 [11:33<29:08, 26.10s/epoch, loss=1.18, accuracy=0.746, val_loss=4.12, val_accuracy=0.281, lr=0.0316] 29%|██▉       | 27/93 [12:00<28:51, 26.24s/epoch, loss=1.17, accuracy=0.747, val_loss=2.95, val_accuracy=0.444, lr=0.1]    30%|███       | 28/93 [12:25<27:58, 25.82s/epoch, loss=1.17, accuracy=0.745, val_loss=1.77, val_accuracy=0.547, lr=0.1] 31%|███       | 29/93 [12:50<27:15, 25.56s/epoch, loss=1.16, accuracy=0.748, val_loss=1.83, val_accuracy=0.522, lr=0.1] 32%|███▏      | 30/93 [13:15<26:33, 25.30s/epoch, loss=1.17, accuracy=0.749, val_loss=1.8, val_accuracy=0.526, lr=0.1]  33%|███▎      | 31/93 [13:39<26:00, 25.16s/epoch, loss=1.16, accuracy=0.747, val_loss=3.1, val_accuracy=0.379, lr=0.0316] 34%|███▍      | 32/93 [14:04<25:26, 25.03s/epoch, loss=1.17, accuracy=0.748, val_loss=3.65, val_accuracy=0.3, lr=0.1]     35%|███▌      | 33/93 [14:29<25:05, 25.09s/epoch, loss=1.15, accuracy=0.75, val_loss=2.23, val_accuracy=0.536, lr=0.1] 37%|███▋      | 34/93 [14:55<24:46, 25.20s/epoch, loss=1.16, accuracy=0.748, val_loss=1.79, val_accuracy=0.576, lr=0.1] 38%|███▊      | 35/93 [15:20<24:26, 25.29s/epoch, loss=1.17, accuracy=0.75, val_loss=1.63, val_accuracy=0.596, lr=0.1]  39%|███▊      | 36/93 [15:46<24:00, 25.28s/epoch, loss=1.16, accuracy=0.749, val_loss=2.71, val_accuracy=0.435, lr=0.0316] 40%|███▉      | 37/93 [16:10<23:27, 25.13s/epoch, loss=1.16, accuracy=0.75, val_loss=1.91, val_accuracy=0.508, lr=0.1]     41%|████      | 38/93 [16:35<23:02, 25.14s/epoch, loss=1.16, accuracy=0.748, val_loss=1.46, val_accuracy=0.635, lr=0.1] 42%|████▏     | 39/93 [17:00<22:35, 25.10s/epoch, loss=1.15, accuracy=0.749, val_loss=1.38, val_accuracy=0.664, lr=0.1] 43%|████▎     | 40/93 [17:26<22:11, 25.12s/epoch, loss=1.16, accuracy=0.749, val_loss=1.63, val_accuracy=0.627, lr=0.1] 44%|████▍     | 41/93 [17:50<21:38, 24.96s/epoch, loss=1.16, accuracy=0.75, val_loss=1.75, val_accuracy=0.589, lr=0.1]  45%|████▌     | 42/93 [18:15<21:13, 24.97s/epoch, loss=1.16, accuracy=0.749, val_loss=2.46, val_accuracy=0.466, lr=0.1] 46%|████▌     | 43/93 [18:40<20:49, 24.98s/epoch, loss=1.15, accuracy=0.753, val_loss=1.86, val_accuracy=0.518, lr=0.1] 47%|████▋     | 44/93 [19:05<20:20, 24.90s/epoch, loss=1.16, accuracy=0.748, val_loss=1.61, val_accuracy=0.604, lr=0.0316] 48%|████▊     | 45/93 [19:30<20:00, 25.01s/epoch, loss=1.15, accuracy=0.752, val_loss=1.66, val_accuracy=0.556, lr=0.1]    49%|████▉     | 46/93 [19:55<19:29, 24.88s/epoch, loss=1.15, accuracy=0.751, val_loss=3.64, val_accuracy=0.336, lr=0.1] 51%|█████     | 47/93 [20:20<19:03, 24.86s/epoch, loss=1.15, accuracy=0.752, val_loss=2.31, val_accuracy=0.415, lr=0.1] 52%|█████▏    | 48/93 [20:45<18:43, 24.96s/epoch, loss=1.15, accuracy=0.753, val_loss=1.68, val_accuracy=0.564, lr=0.1] 53%|█████▎    | 49/93 [21:10<18:18, 24.97s/epoch, loss=1.14, accuracy=0.753, val_loss=2.12, val_accuracy=0.489, lr=0.0316] 54%|█████▍    | 50/93 [21:35<17:51, 24.91s/epoch, loss=1.15, accuracy=0.753, val_loss=1.71, val_accuracy=0.604, lr=0.1]    55%|█████▍    | 51/93 [22:00<17:28, 24.96s/epoch, loss=1.15, accuracy=0.754, val_loss=2.21, val_accuracy=0.52, lr=0.1]  56%|█████▌    | 52/93 [22:25<17:05, 25.01s/epoch, loss=1.14, accuracy=0.751, val_loss=1.39, val_accuracy=0.665, lr=0.1] 57%|█████▋    | 53/93 [22:49<16:34, 24.86s/epoch, loss=1.15, accuracy=0.751, val_loss=1.58, val_accuracy=0.601, lr=0.1] 58%|█████▊    | 54/93 [23:14<16:09, 24.87s/epoch, loss=1.14, accuracy=0.753, val_loss=2.07, val_accuracy=0.531, lr=0.0316] 59%|█████▉    | 55/93 [23:39<15:47, 24.93s/epoch, loss=1.15, accuracy=0.753, val_loss=1.57, val_accuracy=0.588, lr=0.1]    60%|██████    | 56/93 [24:05<15:29, 25.13s/epoch, loss=1.14, accuracy=0.754, val_loss=1.37, val_accuracy=0.679, lr=0.1] 61%|██████▏   | 57/93 [24:30<15:03, 25.09s/epoch, loss=1.15, accuracy=0.753, val_loss=1.94, val_accuracy=0.537, lr=0.1] 62%|██████▏   | 58/93 [24:55<14:36, 25.05s/epoch, loss=1.14, accuracy=0.754, val_loss=1.89, val_accuracy=0.584, lr=0.1] 63%|██████▎   | 59/93 [25:20<14:11, 25.04s/epoch, loss=1.15, accuracy=0.753, val_loss=1.84, val_accuracy=0.508, lr=0.1] 65%|██████▍   | 60/93 [25:45<13:44, 24.99s/epoch, loss=1.15, accuracy=0.752, val_loss=1.9, val_accuracy=0.508, lr=0.1]  66%|██████▌   | 61/93 [26:09<13:15, 24.87s/epoch, loss=1.15, accuracy=0.75, val_loss=2.03, val_accuracy=0.512, lr=0.0316] 67%|██████▋   | 62/93 [26:34<12:47, 24.77s/epoch, loss=1.15, accuracy=0.751, val_loss=1.4, val_accuracy=0.677, lr=0.1]    68%|██████▊   | 63/93 [26:59<12:26, 24.89s/epoch, loss=1.14, accuracy=0.753, val_loss=1.8, val_accuracy=0.551, lr=0.1] 69%|██████▉   | 64/93 [27:24<12:05, 25.01s/epoch, loss=1.15, accuracy=0.753, val_loss=2.07, val_accuracy=0.505, lr=0.1] 70%|██████▉   | 65/93 [27:49<11:39, 24.99s/epoch, loss=1.14, accuracy=0.752, val_loss=2.75, val_accuracy=0.405, lr=0.1] 71%|███████   | 66/93 [28:14<11:16, 25.06s/epoch, loss=1.14, accuracy=0.754, val_loss=2.07, val_accuracy=0.492, lr=0.0316] 72%|███████▏  | 67/93 [28:39<10:49, 24.96s/epoch, loss=1.15, accuracy=0.755, val_loss=1.93, val_accuracy=0.551, lr=0.1]    73%|███████▎  | 68/93 [29:04<10:23, 24.93s/epoch, loss=1.15, accuracy=0.751, val_loss=2.52, val_accuracy=0.424, lr=0.1] 74%|███████▍  | 69/93 [29:29<10:00, 25.02s/epoch, loss=1.14, accuracy=0.754, val_loss=1.37, val_accuracy=0.663, lr=0.1] 75%|███████▌  | 70/93 [29:54<09:36, 25.05s/epoch, loss=1.15, accuracy=0.752, val_loss=1.53, val_accuracy=0.634, lr=0.1] 76%|███████▋  | 71/93 [30:19<09:08, 24.94s/epoch, loss=1.14, accuracy=0.756, val_loss=1.54, val_accuracy=0.612, lr=0.0316] 77%|███████▋  | 72/93 [30:44<08:42, 24.88s/epoch, loss=1.13, accuracy=0.755, val_loss=2, val_accuracy=0.524, lr=0.1]       78%|███████▊  | 73/93 [31:08<08:16, 24.82s/epoch, loss=1.13, accuracy=0.756, val_loss=1.54, val_accuracy=0.623, lr=0.1] 80%|███████▉  | 74/93 [31:33<07:52, 24.85s/epoch, loss=1.14, accuracy=0.754, val_loss=2.02, val_accuracy=0.558, lr=0.1] 81%|████████  | 75/93 [31:58<07:26, 24.83s/epoch, loss=1.14, accuracy=0.752, val_loss=2.75, val_accuracy=0.375, lr=0.1] 82%|████████▏ | 76/93 [32:23<07:03, 24.90s/epoch, loss=1.13, accuracy=0.755, val_loss=1.99, val_accuracy=0.541, lr=0.0316] 83%|████████▎ | 77/93 [32:49<06:40, 25.06s/epoch, loss=1.13, accuracy=0.755, val_loss=1.6, val_accuracy=0.588, lr=0.1]     84%|████████▍ | 78/93 [33:13<06:13, 24.92s/epoch, loss=1.14, accuracy=0.755, val_loss=1.89, val_accuracy=0.547, lr=0.1] 85%|████████▍ | 79/93 [33:38<05:50, 25.01s/epoch, loss=1.13, accuracy=0.755, val_loss=2.32, val_accuracy=0.513, lr=0.1] 86%|████████▌ | 80/93 [34:04<05:25, 25.03s/epoch, loss=1.14, accuracy=0.753, val_loss=2.19, val_accuracy=0.507, lr=0.1] 87%|████████▋ | 81/93 [34:28<04:58, 24.89s/epoch, loss=1.13, accuracy=0.755, val_loss=1.49, val_accuracy=0.652, lr=0.0316] 88%|████████▊ | 82/93 [34:53<04:33, 24.91s/epoch, loss=0.931, accuracy=0.812, val_loss=0.972, val_accuracy=0.781, lr=0.01] 89%|████████▉ | 83/93 [35:18<04:10, 25.00s/epoch, loss=0.755, accuracy=0.844, val_loss=0.794, val_accuracy=0.817, lr=0.01] 90%|█████████ | 84/93 [35:44<03:45, 25.08s/epoch, loss=0.673, accuracy=0.854, val_loss=0.802, val_accuracy=0.805, lr=0.01] 91%|█████████▏| 85/93 [36:09<03:20, 25.10s/epoch, loss=0.62, accuracy=0.86, val_loss=0.73, val_accuracy=0.82, lr=0.01]     92%|█████████▏| 86/93 [36:33<02:54, 24.86s/epoch, loss=0.602, accuracy=0.858, val_loss=0.727, val_accuracy=0.812, lr=0.01] 94%|█████████▎| 87/93 [36:58<02:29, 24.84s/epoch, loss=0.586, accuracy=0.861, val_loss=0.781, val_accuracy=0.8, lr=0.01]   95%|█████████▍| 88/93 [37:23<02:04, 24.94s/epoch, loss=0.577, accuracy=0.862, val_loss=0.865, val_accuracy=0.766, lr=0.01] 96%|█████████▌| 89/93 [37:48<01:40, 25.09s/epoch, loss=0.572, accuracy=0.862, val_loss=0.667, val_accuracy=0.832, lr=0.01] 97%|█████████▋| 90/93 [38:13<01:14, 24.89s/epoch, loss=0.569, accuracy=0.864, val_loss=0.735, val_accuracy=0.819, lr=0.01] 98%|█████████▊| 91/93 [38:38<00:49, 24.93s/epoch, loss=0.574, accuracy=0.864, val_loss=0.931, val_accuracy=0.778, lr=0.01] 99%|█████████▉| 92/93 [39:03<00:24, 24.91s/epoch, loss=0.567, accuracy=0.865, val_loss=0.81, val_accuracy=0.789, lr=0.01] 100%|██████████| 93/93 [39:28<00:00, 24.90s/epoch, loss=0.571, accuracy=0.866, val_loss=0.784, val_accuracy=0.801, lr=0.01]100%|██████████| 93/93 [39:28<00:00, 25.46s/epoch, loss=0.571, accuracy=0.866, val_loss=0.784, val_accuracy=0.801, lr=0.01]
Using real-time data augmentation.
Test score: 0.6850249767303467
Test accuracy: 0.8271999955177307

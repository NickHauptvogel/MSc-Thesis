Mon Feb 19 19:10:53 2024       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 545.23.08              Driver Version: 545.23.08    CUDA Version: 12.3     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA TITAN Xp                Off | 00000000:83:00.0 Off |                  N/A |
| 23%   30C    P8              10W / 250W |      0MiB / 12288MiB |      0%      Default |
|                                         |                      |                  N/A |
+-----------------------------------------+----------------------+----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
|  No running processes found                                                           |
+---------------------------------------------------------------------------------------+


* * * Run SGD for cluster size = 13. * * *


Budget: 115


* * * Run SGD for ID = 13_1. * * *


2024-02-19 19:10:54.902782: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 19:11:06.971030: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-19 19:11:06.972790: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-19 19:11:07.014558: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-19 19:11:07.014602: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 19:11:07.060656: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-19 19:11:07.060754: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-19 19:11:07.260627: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-19 19:11:07.291985: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-19 19:11:07.336233: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-19 19:11:07.376634: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-19 19:11:07.424862: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-19 19:11:07.425560: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-19 19:11:07.425651: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-19 19:11:09.128967: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-19 19:11:09.130295: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-19 19:11:09.130764: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-19 19:11:09.130798: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 19:11:09.130832: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-19 19:11:09.130850: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-19 19:11:09.130867: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-19 19:11:09.130884: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-19 19:11:09.130902: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-19 19:11:09.130918: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-19 19:11:09.130936: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-19 19:11:09.131427: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-19 19:11:09.131490: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 19:11:10.176757: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-19 19:11:10.176818: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-19 19:11:10.176829: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-19 19:11:10.177764: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:83:00.0, compute capability: 6.1)
{'id': '13_01', 'batch_size': 128, 'epochs': 115, 'validation_split': 0.1, 'checkpointing': True, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
x_train shape: (45000, 32, 32, 3)
45000 train samples
5000 validation samples
10000 test samples
y_train shape: (45000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/115 [00:00<?, ?epoch/s]2024-02-19 19:11:11.035650: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-19 19:11:11.048178: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199825000 Hz
2024-02-19 19:11:13.174146: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-19 19:11:13.439284: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-19 19:11:14.627258: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-19 19:11:14.660561: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/115 [00:47<1:29:59, 47.36s/epoch, loss=3.48, accuracy=0.286, val_loss=2.75, val_accuracy=0.229, lr=0.1]  2%|▏         | 2/115 [01:08<1:00:28, 32.11s/epoch, loss=1.66, accuracy=0.49, val_loss=2.72, val_accuracy=0.256, lr=0.1]   3%|▎         | 3/115 [01:30<50:54, 27.27s/epoch, loss=1.38, accuracy=0.611, val_loss=1.55, val_accuracy=0.579, lr=0.1]   3%|▎         | 4/115 [01:51<46:21, 25.06s/epoch, loss=1.27, accuracy=0.676, val_loss=1.66, val_accuracy=0.537, lr=0.1]  4%|▍         | 5/115 [02:14<43:56, 23.97s/epoch, loss=1.24, accuracy=0.697, val_loss=1.65, val_accuracy=0.548, lr=0.1]  5%|▌         | 6/115 [02:35<42:00, 23.13s/epoch, loss=1.22, accuracy=0.709, val_loss=1.8, val_accuracy=0.505, lr=0.1]   6%|▌         | 7/115 [02:54<39:17, 21.83s/epoch, loss=1.22, accuracy=0.717, val_loss=2.24, val_accuracy=0.377, lr=0.1]  7%|▋         | 8/115 [03:14<38:01, 21.32s/epoch, loss=1.21, accuracy=0.725, val_loss=1.75, val_accuracy=0.572, lr=0.0316]  8%|▊         | 9/115 [03:35<37:23, 21.16s/epoch, loss=1.2, accuracy=0.728, val_loss=2.5, val_accuracy=0.375, lr=0.1]       9%|▊         | 10/115 [03:56<37:04, 21.19s/epoch, loss=1.19, accuracy=0.731, val_loss=2.1, val_accuracy=0.507, lr=0.1] 10%|▉         | 11/115 [04:18<36:56, 21.31s/epoch, loss=1.2, accuracy=0.732, val_loss=1.84, val_accuracy=0.482, lr=0.1] 10%|█         | 12/115 [04:40<36:58, 21.53s/epoch, loss=1.19, accuracy=0.733, val_loss=1.45, val_accuracy=0.651, lr=0.1] 11%|█▏        | 13/115 [05:01<36:23, 21.41s/epoch, loss=1.18, accuracy=0.737, val_loss=4.11, val_accuracy=0.269, lr=0.1] 12%|█▏        | 14/115 [05:21<35:12, 20.92s/epoch, loss=1.19, accuracy=0.735, val_loss=5.44, val_accuracy=0.194, lr=0.1] 13%|█▎        | 15/115 [05:40<34:01, 20.41s/epoch, loss=1.18, accuracy=0.741, val_loss=1.86, val_accuracy=0.554, lr=0.1] 14%|█▍        | 16/115 [06:02<34:10, 20.71s/epoch, loss=1.17, accuracy=0.741, val_loss=3.03, val_accuracy=0.331, lr=0.1] 15%|█▍        | 17/115 [06:23<34:12, 20.94s/epoch, loss=1.17, accuracy=0.742, val_loss=3.53, val_accuracy=0.362, lr=0.0316] 16%|█▌        | 18/115 [06:43<33:14, 20.56s/epoch, loss=1.17, accuracy=0.74, val_loss=1.8, val_accuracy=0.53, lr=0.1]       17%|█▋        | 19/115 [07:04<33:10, 20.73s/epoch, loss=1.17, accuracy=0.744, val_loss=1.71, val_accuracy=0.547, lr=0.1] 17%|█▋        | 20/115 [07:26<33:18, 21.03s/epoch, loss=1.16, accuracy=0.746, val_loss=2.18, val_accuracy=0.419, lr=0.1] 18%|█▊        | 21/115 [07:46<32:49, 20.95s/epoch, loss=1.17, accuracy=0.744, val_loss=2.34, val_accuracy=0.48, lr=0.1]  19%|█▉        | 22/115 [08:09<33:01, 21.31s/epoch, loss=1.16, accuracy=0.745, val_loss=2.31, val_accuracy=0.431, lr=0.0316] 20%|██        | 23/115 [08:29<32:16, 21.05s/epoch, loss=1.16, accuracy=0.743, val_loss=1.76, val_accuracy=0.556, lr=0.1]    21%|██        | 24/115 [08:50<32:01, 21.11s/epoch, loss=1.17, accuracy=0.743, val_loss=2.63, val_accuracy=0.401, lr=0.1] 22%|██▏       | 25/115 [09:10<30:56, 20.62s/epoch, loss=1.16, accuracy=0.747, val_loss=2.8, val_accuracy=0.375, lr=0.1]  23%|██▎       | 26/115 [09:31<30:57, 20.87s/epoch, loss=1.16, accuracy=0.745, val_loss=1.83, val_accuracy=0.549, lr=0.1] 23%|██▎       | 27/115 [09:52<30:35, 20.86s/epoch, loss=1.16, accuracy=0.747, val_loss=2.3, val_accuracy=0.41, lr=0.0316] 24%|██▍       | 28/115 [10:13<30:18, 20.90s/epoch, loss=1.16, accuracy=0.745, val_loss=3.35, val_accuracy=0.158, lr=0.1]  25%|██▌       | 29/115 [10:34<29:56, 20.89s/epoch, loss=1.16, accuracy=0.747, val_loss=2.67, val_accuracy=0.404, lr=0.1] 26%|██▌       | 30/115 [10:55<29:47, 21.03s/epoch, loss=1.17, accuracy=0.748, val_loss=1.87, val_accuracy=0.511, lr=0.1] 27%|██▋       | 31/115 [11:16<29:26, 21.03s/epoch, loss=1.16, accuracy=0.746, val_loss=2.21, val_accuracy=0.387, lr=0.1] 28%|██▊       | 32/115 [11:37<29:05, 21.03s/epoch, loss=1.16, accuracy=0.746, val_loss=2.21, val_accuracy=0.441, lr=0.0316] 29%|██▊       | 33/115 [11:58<28:48, 21.08s/epoch, loss=1.16, accuracy=0.749, val_loss=2, val_accuracy=0.523, lr=0.1]       30%|██▉       | 34/115 [12:20<28:31, 21.13s/epoch, loss=1.16, accuracy=0.749, val_loss=1.62, val_accuracy=0.598, lr=0.1] 30%|███       | 35/115 [12:41<28:13, 21.17s/epoch, loss=1.15, accuracy=0.753, val_loss=1.6, val_accuracy=0.611, lr=0.1]  31%|███▏      | 36/115 [13:02<27:53, 21.19s/epoch, loss=1.15, accuracy=0.747, val_loss=1.65, val_accuracy=0.579, lr=0.1] 32%|███▏      | 37/115 [13:23<27:33, 21.20s/epoch, loss=1.15, accuracy=0.749, val_loss=1.82, val_accuracy=0.531, lr=0.0316] 33%|███▎      | 38/115 [13:43<26:39, 20.77s/epoch, loss=1.15, accuracy=0.749, val_loss=3.22, val_accuracy=0.249, lr=0.1]    34%|███▍      | 39/115 [14:03<25:56, 20.48s/epoch, loss=1.15, accuracy=0.752, val_loss=4.25, val_accuracy=0.275, lr=0.1] 35%|███▍      | 40/115 [14:24<25:55, 20.73s/epoch, loss=1.15, accuracy=0.75, val_loss=1.92, val_accuracy=0.511, lr=0.1]  36%|███▌      | 41/115 [14:44<25:00, 20.28s/epoch, loss=1.15, accuracy=0.749, val_loss=1.8, val_accuracy=0.562, lr=0.1] 37%|███▋      | 42/115 [15:05<25:02, 20.58s/epoch, loss=1.15, accuracy=0.748, val_loss=2.1, val_accuracy=0.44, lr=0.0316] 37%|███▋      | 43/115 [15:25<24:30, 20.43s/epoch, loss=1.15, accuracy=0.751, val_loss=1.74, val_accuracy=0.558, lr=0.1]  38%|███▊      | 44/115 [15:45<23:55, 20.21s/epoch, loss=1.15, accuracy=0.75, val_loss=1.5, val_accuracy=0.642, lr=0.1]   39%|███▉      | 45/115 [16:03<23:05, 19.79s/epoch, loss=1.15, accuracy=0.748, val_loss=5.62, val_accuracy=0.196, lr=0.1] 40%|████      | 46/115 [16:23<22:41, 19.72s/epoch, loss=1.15, accuracy=0.751, val_loss=1.4, val_accuracy=0.672, lr=0.1]  41%|████      | 47/115 [16:43<22:22, 19.74s/epoch, loss=1.14, accuracy=0.753, val_loss=1.47, val_accuracy=0.655, lr=0.1] 42%|████▏     | 48/115 [17:04<22:33, 20.20s/epoch, loss=1.15, accuracy=0.752, val_loss=2.2, val_accuracy=0.406, lr=0.1]  43%|████▎     | 49/115 [17:25<22:32, 20.49s/epoch, loss=1.14, accuracy=0.75, val_loss=2.11, val_accuracy=0.423, lr=0.1] 43%|████▎     | 50/115 [17:46<22:24, 20.69s/epoch, loss=1.14, accuracy=0.751, val_loss=2.19, val_accuracy=0.507, lr=0.1] 44%|████▍     | 51/115 [18:06<21:40, 20.32s/epoch, loss=1.14, accuracy=0.753, val_loss=1.34, val_accuracy=0.673, lr=0.1] 45%|████▌     | 52/115 [18:27<21:33, 20.52s/epoch, loss=1.13, accuracy=0.755, val_loss=1.81, val_accuracy=0.529, lr=0.1] 46%|████▌     | 53/115 [18:46<20:45, 20.09s/epoch, loss=1.14, accuracy=0.753, val_loss=1.98, val_accuracy=0.488, lr=0.1] 47%|████▋     | 54/115 [19:07<20:41, 20.34s/epoch, loss=1.14, accuracy=0.753, val_loss=2.06, val_accuracy=0.477, lr=0.1] 48%|████▊     | 55/115 [19:28<20:39, 20.66s/epoch, loss=1.14, accuracy=0.752, val_loss=1.42, val_accuracy=0.667, lr=0.1] 49%|████▊     | 56/115 [19:49<20:23, 20.74s/epoch, loss=1.14, accuracy=0.752, val_loss=1.89, val_accuracy=0.517, lr=0.0316] 50%|████▉     | 57/115 [20:09<19:54, 20.60s/epoch, loss=1.14, accuracy=0.753, val_loss=1.37, val_accuracy=0.68, lr=0.1]     50%|█████     | 58/115 [20:31<19:46, 20.82s/epoch, loss=1.13, accuracy=0.754, val_loss=2.66, val_accuracy=0.422, lr=0.1] 51%|█████▏    | 59/115 [20:50<18:53, 20.25s/epoch, loss=1.14, accuracy=0.75, val_loss=1.51, val_accuracy=0.639, lr=0.1]  52%|█████▏    | 60/115 [21:11<18:43, 20.43s/epoch, loss=1.13, accuracy=0.754, val_loss=2.3, val_accuracy=0.392, lr=0.1] 53%|█████▎    | 61/115 [21:30<18:05, 20.10s/epoch, loss=1.14, accuracy=0.753, val_loss=1.67, val_accuracy=0.576, lr=0.0316] 54%|█████▍    | 62/115 [21:51<18:03, 20.45s/epoch, loss=1.14, accuracy=0.751, val_loss=1.85, val_accuracy=0.516, lr=0.1]    55%|█████▍    | 63/115 [22:10<17:22, 20.05s/epoch, loss=1.14, accuracy=0.751, val_loss=2.67, val_accuracy=0.357, lr=0.1] 56%|█████▌    | 64/115 [22:32<17:21, 20.42s/epoch, loss=1.14, accuracy=0.755, val_loss=2.66, val_accuracy=0.33, lr=0.1]  57%|█████▋    | 65/115 [22:51<16:44, 20.08s/epoch, loss=1.14, accuracy=0.751, val_loss=2.87, val_accuracy=0.395, lr=0.1] 57%|█████▋    | 66/115 [23:12<16:38, 20.38s/epoch, loss=1.13, accuracy=0.757, val_loss=2.79, val_accuracy=0.425, lr=0.0316] 58%|█████▊    | 67/115 [23:32<16:08, 20.17s/epoch, loss=1.13, accuracy=0.754, val_loss=2.03, val_accuracy=0.461, lr=0.1]    59%|█████▉    | 68/115 [23:52<15:51, 20.25s/epoch, loss=1.13, accuracy=0.754, val_loss=2.55, val_accuracy=0.395, lr=0.1] 60%|██████    | 69/115 [24:12<15:24, 20.10s/epoch, loss=1.13, accuracy=0.754, val_loss=1.82, val_accuracy=0.528, lr=0.1] 61%|██████    | 70/115 [24:33<15:15, 20.35s/epoch, loss=1.13, accuracy=0.754, val_loss=2.21, val_accuracy=0.459, lr=0.1] 62%|██████▏   | 71/115 [24:54<15:05, 20.57s/epoch, loss=1.13, accuracy=0.752, val_loss=2.62, val_accuracy=0.38, lr=0.0316] 63%|██████▎   | 72/115 [25:15<14:51, 20.74s/epoch, loss=1.12, accuracy=0.755, val_loss=2.51, val_accuracy=0.402, lr=0.1]   63%|██████▎   | 73/115 [25:36<14:37, 20.90s/epoch, loss=1.13, accuracy=0.755, val_loss=2.94, val_accuracy=0.386, lr=0.1] 64%|██████▍   | 74/115 [25:58<14:24, 21.08s/epoch, loss=1.13, accuracy=0.753, val_loss=2.48, val_accuracy=0.403, lr=0.1] 65%|██████▌   | 75/115 [26:18<13:55, 20.88s/epoch, loss=1.13, accuracy=0.753, val_loss=2.82, val_accuracy=0.387, lr=0.1] 66%|██████▌   | 76/115 [26:39<13:36, 20.94s/epoch, loss=1.12, accuracy=0.757, val_loss=1.87, val_accuracy=0.587, lr=0.0316] 67%|██████▋   | 77/115 [26:59<13:06, 20.70s/epoch, loss=1.12, accuracy=0.757, val_loss=1.64, val_accuracy=0.569, lr=0.1]    68%|██████▊   | 78/115 [27:21<12:52, 20.87s/epoch, loss=1.13, accuracy=0.757, val_loss=2.14, val_accuracy=0.498, lr=0.1] 69%|██████▊   | 79/115 [27:42<12:33, 20.94s/epoch, loss=1.13, accuracy=0.756, val_loss=3.57, val_accuracy=0.424, lr=0.1] 70%|██████▉   | 80/115 [28:03<12:15, 21.01s/epoch, loss=1.13, accuracy=0.752, val_loss=1.64, val_accuracy=0.591, lr=0.1] 70%|███████   | 81/115 [28:22<11:37, 20.50s/epoch, loss=1.13, accuracy=0.756, val_loss=2.41, val_accuracy=0.388, lr=0.0316] 71%|███████▏  | 82/115 [28:44<11:29, 20.88s/epoch, loss=0.936, accuracy=0.811, val_loss=0.978, val_accuracy=0.778, lr=0.01] 72%|███████▏  | 83/115 [29:05<11:08, 20.89s/epoch, loss=0.754, accuracy=0.847, val_loss=0.787, val_accuracy=0.823, lr=0.01] 73%|███████▎  | 84/115 [29:27<10:59, 21.28s/epoch, loss=0.667, accuracy=0.857, val_loss=0.742, val_accuracy=0.825, lr=0.01] 74%|███████▍  | 85/115 [29:48<10:33, 21.11s/epoch, loss=0.618, accuracy=0.861, val_loss=0.762, val_accuracy=0.807, lr=0.01] 75%|███████▍  | 86/115 [30:07<09:55, 20.52s/epoch, loss=0.595, accuracy=0.861, val_loss=0.849, val_accuracy=0.773, lr=0.01] 76%|███████▌  | 87/115 [30:27<09:28, 20.31s/epoch, loss=0.577, accuracy=0.864, val_loss=0.67, val_accuracy=0.836, lr=0.01]  77%|███████▋  | 88/115 [30:46<09:03, 20.11s/epoch, loss=0.575, accuracy=0.861, val_loss=0.652, val_accuracy=0.84, lr=0.01] 77%|███████▋  | 89/115 [31:07<08:45, 20.22s/epoch, loss=0.568, accuracy=0.863, val_loss=0.841, val_accuracy=0.79, lr=0.01] 78%|███████▊  | 90/115 [31:28<08:29, 20.40s/epoch, loss=0.564, accuracy=0.867, val_loss=0.697, val_accuracy=0.827, lr=0.01] 79%|███████▉  | 91/115 [31:48<08:10, 20.44s/epoch, loss=0.563, accuracy=0.869, val_loss=0.859, val_accuracy=0.753, lr=0.01] 80%|████████  | 92/115 [32:09<07:53, 20.58s/epoch, loss=0.564, accuracy=0.867, val_loss=0.808, val_accuracy=0.789, lr=0.01] 81%|████████  | 93/115 [32:31<07:38, 20.85s/epoch, loss=0.559, accuracy=0.87, val_loss=0.828, val_accuracy=0.786, lr=0.00316] 82%|████████▏ | 94/115 [32:52<07:20, 20.99s/epoch, loss=0.553, accuracy=0.872, val_loss=0.719, val_accuracy=0.823, lr=0.01]   83%|████████▎ | 95/115 [33:11<06:48, 20.42s/epoch, loss=0.563, accuracy=0.871, val_loss=1.07, val_accuracy=0.742, lr=0.01]  83%|████████▎ | 96/115 [33:32<06:33, 20.69s/epoch, loss=0.559, accuracy=0.873, val_loss=0.784, val_accuracy=0.803, lr=0.01] 84%|████████▍ | 97/115 [33:53<06:13, 20.76s/epoch, loss=0.555, accuracy=0.874, val_loss=0.753, val_accuracy=0.812, lr=0.01] 85%|████████▌ | 98/115 [34:14<05:54, 20.85s/epoch, loss=0.554, accuracy=0.876, val_loss=0.849, val_accuracy=0.785, lr=0.00316] 86%|████████▌ | 99/115 [34:36<05:35, 20.98s/epoch, loss=0.553, accuracy=0.877, val_loss=0.808, val_accuracy=0.803, lr=0.01]    87%|████████▋ | 100/115 [34:57<05:16, 21.11s/epoch, loss=0.557, accuracy=0.877, val_loss=0.963, val_accuracy=0.761, lr=0.01] 88%|████████▊ | 101/115 [35:18<04:55, 21.13s/epoch, loss=0.556, accuracy=0.878, val_loss=0.838, val_accuracy=0.801, lr=0.01] 89%|████████▊ | 102/115 [35:39<04:33, 21.02s/epoch, loss=0.559, accuracy=0.877, val_loss=0.71, val_accuracy=0.824, lr=0.01]  90%|████████▉ | 103/115 [36:00<04:13, 21.14s/epoch, loss=0.554, accuracy=0.88, val_loss=0.719, val_accuracy=0.824, lr=0.00316] 90%|█████████ | 104/115 [36:20<03:48, 20.74s/epoch, loss=0.553, accuracy=0.879, val_loss=0.721, val_accuracy=0.832, lr=0.01]   91%|█████████▏| 105/115 [36:42<03:29, 20.94s/epoch, loss=0.553, accuracy=0.879, val_loss=0.808, val_accuracy=0.8, lr=0.01]   92%|█████████▏| 106/115 [37:03<03:09, 21.08s/epoch, loss=0.557, accuracy=0.88, val_loss=1.2, val_accuracy=0.715, lr=0.01]  93%|█████████▎| 107/115 [37:22<02:43, 20.45s/epoch, loss=0.553, accuracy=0.883, val_loss=0.772, val_accuracy=0.818, lr=0.01] 94%|█████████▍| 108/115 [37:43<02:24, 20.67s/epoch, loss=0.555, accuracy=0.881, val_loss=1.02, val_accuracy=0.748, lr=0.00316] 95%|█████████▍| 109/115 [38:02<02:01, 20.19s/epoch, loss=0.555, accuracy=0.882, val_loss=0.935, val_accuracy=0.775, lr=0.01]   96%|█████████▌| 110/115 [38:23<01:41, 20.35s/epoch, loss=0.553, accuracy=0.882, val_loss=0.915, val_accuracy=0.779, lr=0.01] 97%|█████████▋| 111/115 [38:42<01:19, 19.94s/epoch, loss=0.553, accuracy=0.882, val_loss=0.972, val_accuracy=0.761, lr=0.01] 97%|█████████▋| 112/115 [39:01<00:58, 19.65s/epoch, loss=0.557, accuracy=0.881, val_loss=0.782, val_accuracy=0.809, lr=0.01] 98%|█████████▊| 113/115 [39:22<00:39, 19.98s/epoch, loss=0.554, accuracy=0.882, val_loss=0.783, val_accuracy=0.809, lr=0.00316] 99%|█████████▉| 114/115 [39:43<00:20, 20.39s/epoch, loss=0.552, accuracy=0.884, val_loss=0.875, val_accuracy=0.785, lr=0.01]   100%|██████████| 115/115 [40:04<00:00, 20.62s/epoch, loss=0.554, accuracy=0.885, val_loss=0.911, val_accuracy=0.779, lr=0.01]100%|██████████| 115/115 [40:04<00:00, 20.91s/epoch, loss=0.554, accuracy=0.885, val_loss=0.911, val_accuracy=0.779, lr=0.01]
Using real-time data augmentation.
Test score: 0.6866957545280457
Test accuracy: 0.8248000144958496


* * * Run SGD for ID = 13_2. * * *


2024-02-19 19:51:28.157245: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 19:51:31.001375: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-19 19:51:31.002438: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-19 19:51:31.039976: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-19 19:51:31.040015: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 19:51:31.043313: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-19 19:51:31.043389: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-19 19:51:31.045712: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-19 19:51:31.046471: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-19 19:51:31.049027: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-19 19:51:31.050623: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-19 19:51:31.055770: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-19 19:51:31.056286: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-19 19:51:31.056368: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-19 19:51:32.499005: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-19 19:51:32.499976: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-19 19:51:32.500801: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-19 19:51:32.500837: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 19:51:32.500872: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-19 19:51:32.500891: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-19 19:51:32.500909: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-19 19:51:32.500926: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-19 19:51:32.500943: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-19 19:51:32.500960: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-19 19:51:32.500978: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-19 19:51:32.501439: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-19 19:51:32.501474: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 19:51:33.129833: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-19 19:51:33.129900: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-19 19:51:33.129911: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-19 19:51:33.130940: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:83:00.0, compute capability: 6.1)
{'id': '13_02', 'batch_size': 128, 'epochs': 115, 'validation_split': 0.1, 'checkpointing': True, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
x_train shape: (45000, 32, 32, 3)
45000 train samples
5000 validation samples
10000 test samples
y_train shape: (45000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/115 [00:00<?, ?epoch/s]2024-02-19 19:51:33.968981: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-19 19:51:33.981197: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199825000 Hz
2024-02-19 19:51:36.199491: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-19 19:51:36.462433: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-19 19:51:37.278123: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-19 19:51:37.323691: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/115 [01:03<2:01:32, 63.97s/epoch, loss=3.28, accuracy=0.282, val_loss=2.33, val_accuracy=0.236, lr=0.1]  2%|▏         | 2/115 [01:24<1:12:48, 38.66s/epoch, loss=1.61, accuracy=0.516, val_loss=1.8, val_accuracy=0.442, lr=0.1]   3%|▎         | 3/115 [01:46<57:23, 30.74s/epoch, loss=1.39, accuracy=0.619, val_loss=2.03, val_accuracy=0.431, lr=0.1]   3%|▎         | 4/115 [02:08<50:41, 27.40s/epoch, loss=1.31, accuracy=0.669, val_loss=1.88, val_accuracy=0.466, lr=0.1]  4%|▍         | 5/115 [02:29<46:13, 25.21s/epoch, loss=1.27, accuracy=0.693, val_loss=2.42, val_accuracy=0.444, lr=0.1]  5%|▌         | 6/115 [02:51<43:49, 24.13s/epoch, loss=1.25, accuracy=0.708, val_loss=1.54, val_accuracy=0.584, lr=0.1]  6%|▌         | 7/115 [03:13<41:40, 23.15s/epoch, loss=1.24, accuracy=0.715, val_loss=2.01, val_accuracy=0.493, lr=0.1]  7%|▋         | 8/115 [03:34<40:31, 22.73s/epoch, loss=1.22, accuracy=0.719, val_loss=2.19, val_accuracy=0.472, lr=0.1]  8%|▊         | 9/115 [03:54<38:30, 21.80s/epoch, loss=1.21, accuracy=0.725, val_loss=2.06, val_accuracy=0.479, lr=0.1]  9%|▊         | 10/115 [04:16<38:17, 21.88s/epoch, loss=1.2, accuracy=0.731, val_loss=2.22, val_accuracy=0.493, lr=0.1] 10%|▉         | 11/115 [04:37<37:20, 21.54s/epoch, loss=1.2, accuracy=0.732, val_loss=1.7, val_accuracy=0.562, lr=0.0316] 10%|█         | 12/115 [04:58<36:40, 21.36s/epoch, loss=1.2, accuracy=0.731, val_loss=1.86, val_accuracy=0.487, lr=0.1]   11%|█▏        | 13/115 [05:20<36:45, 21.62s/epoch, loss=1.19, accuracy=0.735, val_loss=2.29, val_accuracy=0.492, lr=0.1] 12%|█▏        | 14/115 [05:40<35:31, 21.11s/epoch, loss=1.18, accuracy=0.739, val_loss=2.14, val_accuracy=0.494, lr=0.1] 13%|█▎        | 15/115 [06:01<35:18, 21.18s/epoch, loss=1.17, accuracy=0.743, val_loss=1.49, val_accuracy=0.627, lr=0.1] 14%|█▍        | 16/115 [06:22<34:27, 20.88s/epoch, loss=1.17, accuracy=0.741, val_loss=2.53, val_accuracy=0.465, lr=0.1] 15%|█▍        | 17/115 [06:42<34:05, 20.88s/epoch, loss=1.17, accuracy=0.743, val_loss=2.12, val_accuracy=0.479, lr=0.1] 16%|█▌        | 18/115 [07:03<33:26, 20.68s/epoch, loss=1.17, accuracy=0.744, val_loss=2.5, val_accuracy=0.468, lr=0.1]  17%|█▋        | 19/115 [07:24<33:29, 20.93s/epoch, loss=1.17, accuracy=0.743, val_loss=1.71, val_accuracy=0.55, lr=0.1] 17%|█▋        | 20/115 [07:45<33:19, 21.05s/epoch, loss=1.16, accuracy=0.746, val_loss=1.58, val_accuracy=0.605, lr=0.0316] 18%|█▊        | 21/115 [08:08<33:31, 21.40s/epoch, loss=1.17, accuracy=0.745, val_loss=2.46, val_accuracy=0.403, lr=0.1]    19%|█▉        | 22/115 [08:30<33:30, 21.62s/epoch, loss=1.17, accuracy=0.747, val_loss=2.94, val_accuracy=0.258, lr=0.1] 20%|██        | 23/115 [08:52<33:10, 21.64s/epoch, loss=1.16, accuracy=0.748, val_loss=1.76, val_accuracy=0.581, lr=0.1] 21%|██        | 24/115 [09:14<32:59, 21.75s/epoch, loss=1.16, accuracy=0.751, val_loss=3.17, val_accuracy=0.307, lr=0.1] 22%|██▏       | 25/115 [09:35<32:41, 21.79s/epoch, loss=1.15, accuracy=0.747, val_loss=1.49, val_accuracy=0.657, lr=0.1] 23%|██▎       | 26/115 [09:55<31:20, 21.13s/epoch, loss=1.15, accuracy=0.749, val_loss=1.54, val_accuracy=0.6, lr=0.1]   23%|██▎       | 27/115 [10:15<30:32, 20.82s/epoch, loss=1.15, accuracy=0.748, val_loss=1.35, val_accuracy=0.683, lr=0.1] 24%|██▍       | 28/115 [10:37<30:31, 21.05s/epoch, loss=1.15, accuracy=0.749, val_loss=3.36, val_accuracy=0.363, lr=0.1] 25%|██▌       | 29/115 [10:59<30:35, 21.34s/epoch, loss=1.14, accuracy=0.752, val_loss=1.56, val_accuracy=0.596, lr=0.1] 26%|██▌       | 30/115 [11:21<30:28, 21.52s/epoch, loss=1.14, accuracy=0.751, val_loss=2.56, val_accuracy=0.404, lr=0.1] 27%|██▋       | 31/115 [11:43<30:21, 21.69s/epoch, loss=1.14, accuracy=0.752, val_loss=2.7, val_accuracy=0.422, lr=0.1]  28%|██▊       | 32/115 [12:04<29:49, 21.56s/epoch, loss=1.14, accuracy=0.75, val_loss=1.77, val_accuracy=0.567, lr=0.0316] 29%|██▊       | 33/115 [12:25<29:22, 21.50s/epoch, loss=1.14, accuracy=0.75, val_loss=1.93, val_accuracy=0.548, lr=0.1]    30%|██▉       | 34/115 [12:47<29:12, 21.64s/epoch, loss=1.14, accuracy=0.751, val_loss=1.72, val_accuracy=0.582, lr=0.1] 30%|███       | 35/115 [13:09<28:57, 21.72s/epoch, loss=1.14, accuracy=0.752, val_loss=1.43, val_accuracy=0.641, lr=0.1] 31%|███▏      | 36/115 [13:31<28:42, 21.80s/epoch, loss=1.13, accuracy=0.753, val_loss=2.59, val_accuracy=0.476, lr=0.1] 32%|███▏      | 37/115 [13:53<28:27, 21.89s/epoch, loss=1.13, accuracy=0.756, val_loss=3.49, val_accuracy=0.27, lr=0.0316] 33%|███▎      | 38/115 [14:16<28:16, 22.03s/epoch, loss=1.13, accuracy=0.754, val_loss=3.29, val_accuracy=0.393, lr=0.1]   34%|███▍      | 39/115 [14:38<28:02, 22.13s/epoch, loss=1.13, accuracy=0.752, val_loss=2.08, val_accuracy=0.477, lr=0.1] 35%|███▍      | 40/115 [14:59<27:10, 21.74s/epoch, loss=1.13, accuracy=0.754, val_loss=3.54, val_accuracy=0.256, lr=0.1] 36%|███▌      | 41/115 [15:20<26:31, 21.51s/epoch, loss=1.13, accuracy=0.753, val_loss=4.06, val_accuracy=0.348, lr=0.1] 37%|███▋      | 42/115 [15:42<26:20, 21.65s/epoch, loss=1.12, accuracy=0.757, val_loss=2.09, val_accuracy=0.429, lr=0.0316] 37%|███▋      | 43/115 [16:02<25:35, 21.32s/epoch, loss=1.13, accuracy=0.756, val_loss=2.43, val_accuracy=0.447, lr=0.1]    38%|███▊      | 44/115 [16:25<25:31, 21.58s/epoch, loss=1.13, accuracy=0.755, val_loss=1.77, val_accuracy=0.534, lr=0.1] 39%|███▉      | 45/115 [16:46<25:02, 21.47s/epoch, loss=1.13, accuracy=0.756, val_loss=1.59, val_accuracy=0.583, lr=0.1] 40%|████      | 46/115 [17:08<24:48, 21.57s/epoch, loss=1.12, accuracy=0.757, val_loss=1.81, val_accuracy=0.511, lr=0.1] 41%|████      | 47/115 [17:28<24:08, 21.30s/epoch, loss=1.12, accuracy=0.755, val_loss=3.29, val_accuracy=0.376, lr=0.0316] 42%|████▏     | 48/115 [17:50<24:02, 21.53s/epoch, loss=1.13, accuracy=0.753, val_loss=1.58, val_accuracy=0.584, lr=0.1]    43%|████▎     | 49/115 [18:12<23:44, 21.58s/epoch, loss=1.12, accuracy=0.757, val_loss=1.28, val_accuracy=0.701, lr=0.1] 43%|████▎     | 50/115 [18:33<23:08, 21.37s/epoch, loss=1.12, accuracy=0.757, val_loss=2.74, val_accuracy=0.424, lr=0.1] 44%|████▍     | 51/115 [18:55<22:58, 21.53s/epoch, loss=1.12, accuracy=0.755, val_loss=3.25, val_accuracy=0.307, lr=0.1] 45%|████▌     | 52/115 [19:17<22:46, 21.68s/epoch, loss=1.12, accuracy=0.755, val_loss=2.34, val_accuracy=0.367, lr=0.1] 46%|████▌     | 53/115 [19:38<22:17, 21.57s/epoch, loss=1.12, accuracy=0.757, val_loss=2.3, val_accuracy=0.503, lr=0.1]  47%|████▋     | 54/115 [20:00<22:00, 21.64s/epoch, loss=1.12, accuracy=0.757, val_loss=2.1, val_accuracy=0.518, lr=0.0316] 48%|████▊     | 55/115 [20:20<21:11, 21.19s/epoch, loss=1.12, accuracy=0.758, val_loss=2.93, val_accuracy=0.382, lr=0.1]   49%|████▊     | 56/115 [20:42<21:04, 21.42s/epoch, loss=1.12, accuracy=0.758, val_loss=1.52, val_accuracy=0.623, lr=0.1] 50%|████▉     | 57/115 [21:03<20:37, 21.34s/epoch, loss=1.11, accuracy=0.76, val_loss=2.56, val_accuracy=0.357, lr=0.1]  50%|█████     | 58/115 [21:23<19:45, 20.80s/epoch, loss=1.12, accuracy=0.756, val_loss=2.04, val_accuracy=0.503, lr=0.1] 51%|█████▏    | 59/115 [21:42<19:05, 20.45s/epoch, loss=1.11, accuracy=0.761, val_loss=1.67, val_accuracy=0.574, lr=0.0316] 52%|█████▏    | 60/115 [22:04<19:07, 20.87s/epoch, loss=1.11, accuracy=0.754, val_loss=5.01, val_accuracy=0.272, lr=0.1]    53%|█████▎    | 61/115 [22:25<18:44, 20.83s/epoch, loss=1.12, accuracy=0.757, val_loss=1.85, val_accuracy=0.525, lr=0.1] 54%|█████▍    | 62/115 [22:45<18:17, 20.70s/epoch, loss=1.11, accuracy=0.759, val_loss=1.82, val_accuracy=0.475, lr=0.1] 55%|█████▍    | 63/115 [23:06<17:52, 20.62s/epoch, loss=1.11, accuracy=0.757, val_loss=1.92, val_accuracy=0.467, lr=0.1] 56%|█████▌    | 64/115 [23:26<17:28, 20.57s/epoch, loss=1.11, accuracy=0.758, val_loss=2.18, val_accuracy=0.511, lr=0.0316] 57%|█████▋    | 65/115 [23:46<17:00, 20.42s/epoch, loss=1.11, accuracy=0.758, val_loss=8.59, val_accuracy=0.163, lr=0.1]    57%|█████▋    | 66/115 [24:08<17:01, 20.85s/epoch, loss=1.11, accuracy=0.758, val_loss=3.12, val_accuracy=0.344, lr=0.1] 58%|█████▊    | 67/115 [24:28<16:19, 20.40s/epoch, loss=1.12, accuracy=0.758, val_loss=4.07, val_accuracy=0.221, lr=0.1] 59%|█████▉    | 68/115 [24:48<15:55, 20.33s/epoch, loss=1.12, accuracy=0.759, val_loss=2.15, val_accuracy=0.454, lr=0.1] 60%|██████    | 69/115 [25:09<15:54, 20.74s/epoch, loss=1.11, accuracy=0.758, val_loss=2.12, val_accuracy=0.466, lr=0.0316] 61%|██████    | 70/115 [25:31<15:48, 21.07s/epoch, loss=1.11, accuracy=0.757, val_loss=3.03, val_accuracy=0.401, lr=0.1]    62%|██████▏   | 71/115 [25:54<15:44, 21.46s/epoch, loss=1.11, accuracy=0.758, val_loss=1.89, val_accuracy=0.542, lr=0.1] 63%|██████▎   | 72/115 [26:13<14:57, 20.88s/epoch, loss=1.11, accuracy=0.757, val_loss=1.96, val_accuracy=0.519, lr=0.1] 63%|██████▎   | 73/115 [26:35<14:50, 21.20s/epoch, loss=1.11, accuracy=0.759, val_loss=1.68, val_accuracy=0.61, lr=0.1]  64%|██████▍   | 74/115 [26:56<14:29, 21.20s/epoch, loss=1.11, accuracy=0.759, val_loss=3.44, val_accuracy=0.369, lr=0.0316] 65%|██████▌   | 75/115 [27:17<14:03, 21.08s/epoch, loss=1.12, accuracy=0.757, val_loss=2.11, val_accuracy=0.487, lr=0.1]    66%|██████▌   | 76/115 [27:36<13:22, 20.58s/epoch, loss=1.12, accuracy=0.758, val_loss=1.87, val_accuracy=0.476, lr=0.1] 67%|██████▋   | 77/115 [27:58<13:12, 20.85s/epoch, loss=1.12, accuracy=0.757, val_loss=1.95, val_accuracy=0.54, lr=0.1]  68%|██████▊   | 78/115 [28:17<12:36, 20.45s/epoch, loss=1.12, accuracy=0.757, val_loss=1.85, val_accuracy=0.551, lr=0.1] 69%|██████▊   | 79/115 [28:38<12:15, 20.44s/epoch, loss=1.1, accuracy=0.76, val_loss=2.39, val_accuracy=0.455, lr=0.0316] 70%|██████▉   | 80/115 [29:00<12:11, 20.90s/epoch, loss=1.11, accuracy=0.758, val_loss=1.44, val_accuracy=0.658, lr=0.1]  70%|███████   | 81/115 [29:22<11:58, 21.12s/epoch, loss=1.11, accuracy=0.76, val_loss=1.77, val_accuracy=0.561, lr=0.1]  71%|███████▏  | 82/115 [29:43<11:44, 21.34s/epoch, loss=0.91, accuracy=0.816, val_loss=0.946, val_accuracy=0.785, lr=0.01] 72%|███████▏  | 83/115 [30:05<11:25, 21.44s/epoch, loss=0.735, accuracy=0.847, val_loss=0.752, val_accuracy=0.836, lr=0.01] 73%|███████▎  | 84/115 [30:26<11:03, 21.41s/epoch, loss=0.657, accuracy=0.857, val_loss=0.876, val_accuracy=0.767, lr=0.01] 74%|███████▍  | 85/115 [30:48<10:48, 21.61s/epoch, loss=0.615, accuracy=0.858, val_loss=0.747, val_accuracy=0.806, lr=0.01] 75%|███████▍  | 86/115 [31:10<10:27, 21.65s/epoch, loss=0.585, accuracy=0.861, val_loss=0.762, val_accuracy=0.795, lr=0.01] 76%|███████▌  | 87/115 [31:32<10:04, 21.59s/epoch, loss=0.57, accuracy=0.864, val_loss=0.84, val_accuracy=0.779, lr=0.01]   77%|███████▋  | 88/115 [31:52<09:30, 21.13s/epoch, loss=0.566, accuracy=0.864, val_loss=0.747, val_accuracy=0.802, lr=0.01] 77%|███████▋  | 89/115 [32:14<09:14, 21.34s/epoch, loss=0.556, accuracy=0.866, val_loss=0.704, val_accuracy=0.818, lr=0.01] 78%|███████▊  | 90/115 [32:36<08:59, 21.57s/epoch, loss=0.562, accuracy=0.863, val_loss=0.943, val_accuracy=0.751, lr=0.01] 79%|███████▉  | 91/115 [32:58<08:40, 21.67s/epoch, loss=0.556, accuracy=0.867, val_loss=0.774, val_accuracy=0.796, lr=0.01] 80%|████████  | 92/115 [33:17<08:04, 21.06s/epoch, loss=0.554, accuracy=0.87, val_loss=0.71, val_accuracy=0.82, lr=0.01]    81%|████████  | 93/115 [33:39<07:45, 21.17s/epoch, loss=0.551, accuracy=0.871, val_loss=0.672, val_accuracy=0.829, lr=0.01] 82%|████████▏ | 94/115 [33:59<07:17, 20.84s/epoch, loss=0.551, accuracy=0.871, val_loss=0.762, val_accuracy=0.804, lr=0.01] 83%|████████▎ | 95/115 [34:20<07:02, 21.12s/epoch, loss=0.551, accuracy=0.871, val_loss=0.861, val_accuracy=0.759, lr=0.01] 83%|████████▎ | 96/115 [34:40<06:33, 20.72s/epoch, loss=0.55, accuracy=0.874, val_loss=0.848, val_accuracy=0.782, lr=0.01]  84%|████████▍ | 97/115 [35:01<06:15, 20.85s/epoch, loss=0.546, accuracy=0.877, val_loss=0.718, val_accuracy=0.822, lr=0.01] 85%|████████▌ | 98/115 [35:22<05:54, 20.87s/epoch, loss=0.549, accuracy=0.875, val_loss=0.722, val_accuracy=0.821, lr=0.00316] 86%|████████▌ | 99/115 [35:44<05:38, 21.18s/epoch, loss=0.548, accuracy=0.876, val_loss=1.04, val_accuracy=0.75, lr=0.01]      87%|████████▋ | 100/115 [36:05<05:16, 21.10s/epoch, loss=0.549, accuracy=0.877, val_loss=0.821, val_accuracy=0.793, lr=0.01] 88%|████████▊ | 101/115 [36:26<04:52, 20.90s/epoch, loss=0.544, accuracy=0.878, val_loss=0.908, val_accuracy=0.774, lr=0.01] 89%|████████▊ | 102/115 [36:47<04:35, 21.19s/epoch, loss=0.545, accuracy=0.879, val_loss=0.884, val_accuracy=0.79, lr=0.01]  90%|████████▉ | 103/115 [37:08<04:11, 20.92s/epoch, loss=0.545, accuracy=0.879, val_loss=0.824, val_accuracy=0.804, lr=0.00316] 90%|█████████ | 104/115 [37:29<03:52, 21.16s/epoch, loss=0.543, accuracy=0.881, val_loss=0.893, val_accuracy=0.771, lr=0.01]    91%|█████████▏| 105/115 [37:51<03:32, 21.26s/epoch, loss=0.547, accuracy=0.879, val_loss=1.07, val_accuracy=0.736, lr=0.01]  92%|█████████▏| 106/115 [38:13<03:12, 21.37s/epoch, loss=0.548, accuracy=0.878, val_loss=0.791, val_accuracy=0.807, lr=0.01] 93%|█████████▎| 107/115 [38:34<02:51, 21.42s/epoch, loss=0.544, accuracy=0.884, val_loss=0.752, val_accuracy=0.816, lr=0.01] 94%|█████████▍| 108/115 [38:56<02:30, 21.49s/epoch, loss=0.538, accuracy=0.885, val_loss=0.867, val_accuracy=0.788, lr=0.00316] 95%|█████████▍| 109/115 [39:17<02:08, 21.50s/epoch, loss=0.547, accuracy=0.88, val_loss=0.976, val_accuracy=0.741, lr=0.01]     96%|█████████▌| 110/115 [39:38<01:46, 21.23s/epoch, loss=0.542, accuracy=0.884, val_loss=0.973, val_accuracy=0.752, lr=0.01] 97%|█████████▋| 111/115 [39:59<01:24, 21.12s/epoch, loss=0.543, accuracy=0.884, val_loss=0.888, val_accuracy=0.779, lr=0.01] 97%|█████████▋| 112/115 [40:20<01:03, 21.28s/epoch, loss=0.543, accuracy=0.882, val_loss=1.21, val_accuracy=0.701, lr=0.01]  98%|█████████▊| 113/115 [40:42<00:42, 21.37s/epoch, loss=0.543, accuracy=0.885, val_loss=0.767, val_accuracy=0.81, lr=0.00316] 99%|█████████▉| 114/115 [41:04<00:21, 21.48s/epoch, loss=0.542, accuracy=0.885, val_loss=0.79, val_accuracy=0.807, lr=0.01]   100%|██████████| 115/115 [41:25<00:00, 21.55s/epoch, loss=0.54, accuracy=0.885, val_loss=1.31, val_accuracy=0.738, lr=0.01] 100%|██████████| 115/115 [41:25<00:00, 21.62s/epoch, loss=0.54, accuracy=0.885, val_loss=1.31, val_accuracy=0.738, lr=0.01]
Using real-time data augmentation.
Test score: 0.7677562832832336
Test accuracy: 0.8264999985694885


* * * Run SGD for ID = 13_3. * * *


2024-02-19 20:33:06.261551: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 20:33:13.870838: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-19 20:33:13.871873: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-19 20:33:13.910556: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-19 20:33:13.910639: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 20:33:13.917174: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-19 20:33:13.917220: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-19 20:33:13.921085: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-19 20:33:13.926813: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-19 20:33:13.930612: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-19 20:33:13.934266: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-19 20:33:13.940849: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-19 20:33:13.941369: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-19 20:33:13.941452: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-19 20:33:15.401091: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-19 20:33:15.402540: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-19 20:33:15.403003: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-19 20:33:15.403036: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 20:33:15.403086: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-19 20:33:15.403106: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-19 20:33:15.403123: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-19 20:33:15.403141: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-19 20:33:15.403158: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-19 20:33:15.403174: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-19 20:33:15.403192: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-19 20:33:15.403641: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-19 20:33:15.403681: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 20:33:16.027204: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-19 20:33:16.027263: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-19 20:33:16.027274: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-19 20:33:16.028541: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:83:00.0, compute capability: 6.1)
{'id': '13_03', 'batch_size': 128, 'epochs': 115, 'validation_split': 0.1, 'checkpointing': True, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
x_train shape: (45000, 32, 32, 3)
45000 train samples
5000 validation samples
10000 test samples
y_train shape: (45000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/115 [00:00<?, ?epoch/s]2024-02-19 20:33:16.856078: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-19 20:33:16.868167: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199825000 Hz
2024-02-19 20:33:18.953642: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-19 20:33:19.201246: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-19 20:33:19.914164: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-19 20:33:19.960504: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/115 [00:53<1:41:17, 53.31s/epoch, loss=3.27, accuracy=0.31, val_loss=2.75, val_accuracy=0.198, lr=0.1]  2%|▏         | 2/115 [01:13<1:04:02, 34.01s/epoch, loss=1.67, accuracy=0.483, val_loss=2.43, val_accuracy=0.28, lr=0.1]  3%|▎         | 3/115 [01:35<52:33, 28.16s/epoch, loss=1.4, accuracy=0.601, val_loss=2.16, val_accuracy=0.37, lr=0.1]     3%|▎         | 4/115 [01:56<47:05, 25.45s/epoch, loss=1.29, accuracy=0.668, val_loss=1.62, val_accuracy=0.567, lr=0.1]  4%|▍         | 5/115 [02:17<43:57, 23.98s/epoch, loss=1.25, accuracy=0.695, val_loss=1.65, val_accuracy=0.581, lr=0.1]  5%|▌         | 6/115 [02:38<41:46, 22.99s/epoch, loss=1.23, accuracy=0.705, val_loss=1.69, val_accuracy=0.553, lr=0.1]  6%|▌         | 7/115 [03:00<40:23, 22.44s/epoch, loss=1.22, accuracy=0.717, val_loss=1.63, val_accuracy=0.557, lr=0.1]  7%|▋         | 8/115 [03:21<39:17, 22.03s/epoch, loss=1.22, accuracy=0.719, val_loss=1.96, val_accuracy=0.539, lr=0.1]  8%|▊         | 9/115 [03:42<38:20, 21.71s/epoch, loss=1.21, accuracy=0.727, val_loss=1.69, val_accuracy=0.56, lr=0.0316]  9%|▊         | 10/115 [04:03<37:40, 21.53s/epoch, loss=1.21, accuracy=0.73, val_loss=1.81, val_accuracy=0.554, lr=0.1]   10%|▉         | 11/115 [04:24<37:10, 21.44s/epoch, loss=1.2, accuracy=0.733, val_loss=1.94, val_accuracy=0.525, lr=0.1] 10%|█         | 12/115 [04:46<36:48, 21.44s/epoch, loss=1.21, accuracy=0.732, val_loss=2.47, val_accuracy=0.409, lr=0.1] 11%|█▏        | 13/115 [05:07<36:14, 21.32s/epoch, loss=1.2, accuracy=0.736, val_loss=1.98, val_accuracy=0.505, lr=0.1]  12%|█▏        | 14/115 [05:27<35:32, 21.11s/epoch, loss=1.2, accuracy=0.738, val_loss=1.85, val_accuracy=0.513, lr=0.0316] 13%|█▎        | 15/115 [05:49<35:20, 21.21s/epoch, loss=1.2, accuracy=0.739, val_loss=2.51, val_accuracy=0.298, lr=0.1]    14%|█▍        | 16/115 [06:08<34:14, 20.75s/epoch, loss=1.19, accuracy=0.737, val_loss=2.09, val_accuracy=0.465, lr=0.1] 15%|█▍        | 17/115 [06:30<34:07, 20.89s/epoch, loss=1.18, accuracy=0.742, val_loss=1.49, val_accuracy=0.619, lr=0.1] 16%|█▌        | 18/115 [06:51<33:51, 20.94s/epoch, loss=1.18, accuracy=0.743, val_loss=1.59, val_accuracy=0.63, lr=0.1]  17%|█▋        | 19/115 [07:11<33:18, 20.81s/epoch, loss=1.19, accuracy=0.74, val_loss=3.14, val_accuracy=0.399, lr=0.1] 17%|█▋        | 20/115 [07:32<33:07, 20.92s/epoch, loss=1.18, accuracy=0.743, val_loss=1.72, val_accuracy=0.565, lr=0.1] 18%|█▊        | 21/115 [07:54<33:02, 21.09s/epoch, loss=1.18, accuracy=0.745, val_loss=2, val_accuracy=0.474, lr=0.1]    19%|█▉        | 22/115 [08:14<32:23, 20.89s/epoch, loss=1.18, accuracy=0.745, val_loss=2.62, val_accuracy=0.355, lr=0.0316] 20%|██        | 23/115 [08:34<31:30, 20.55s/epoch, loss=1.18, accuracy=0.746, val_loss=1.81, val_accuracy=0.564, lr=0.1]    21%|██        | 24/115 [08:55<31:22, 20.69s/epoch, loss=1.18, accuracy=0.745, val_loss=2.02, val_accuracy=0.534, lr=0.1] 22%|██▏       | 25/115 [09:14<30:22, 20.25s/epoch, loss=1.18, accuracy=0.746, val_loss=1.72, val_accuracy=0.57, lr=0.1]  23%|██▎       | 26/115 [09:35<30:30, 20.57s/epoch, loss=1.18, accuracy=0.746, val_loss=2.02, val_accuracy=0.51, lr=0.1] 23%|██▎       | 27/115 [09:57<30:41, 20.93s/epoch, loss=1.18, accuracy=0.748, val_loss=1.38, val_accuracy=0.672, lr=0.1] 24%|██▍       | 28/115 [10:18<30:26, 20.99s/epoch, loss=1.17, accuracy=0.746, val_loss=3.01, val_accuracy=0.331, lr=0.1] 25%|██▌       | 29/115 [10:40<30:11, 21.06s/epoch, loss=1.17, accuracy=0.749, val_loss=1.88, val_accuracy=0.505, lr=0.1] 26%|██▌       | 30/115 [10:59<28:58, 20.45s/epoch, loss=1.18, accuracy=0.744, val_loss=2.02, val_accuracy=0.518, lr=0.1] 27%|██▋       | 31/115 [11:19<28:48, 20.57s/epoch, loss=1.17, accuracy=0.747, val_loss=2.12, val_accuracy=0.495, lr=0.1] 28%|██▊       | 32/115 [11:40<28:18, 20.46s/epoch, loss=1.16, accuracy=0.752, val_loss=3.97, val_accuracy=0.228, lr=0.0316] 29%|██▊       | 33/115 [11:59<27:41, 20.26s/epoch, loss=1.17, accuracy=0.749, val_loss=1.85, val_accuracy=0.58, lr=0.1]     30%|██▉       | 34/115 [12:21<27:44, 20.55s/epoch, loss=1.16, accuracy=0.752, val_loss=2.1, val_accuracy=0.517, lr=0.1] 30%|███       | 35/115 [12:41<27:25, 20.57s/epoch, loss=1.17, accuracy=0.749, val_loss=3.94, val_accuracy=0.299, lr=0.1] 31%|███▏      | 36/115 [13:02<27:09, 20.62s/epoch, loss=1.16, accuracy=0.75, val_loss=4.17, val_accuracy=0.317, lr=0.1]  32%|███▏      | 37/115 [13:23<27:02, 20.80s/epoch, loss=1.17, accuracy=0.748, val_loss=2.36, val_accuracy=0.458, lr=0.0316] 33%|███▎      | 38/115 [13:42<26:04, 20.31s/epoch, loss=1.15, accuracy=0.753, val_loss=1.41, val_accuracy=0.663, lr=0.1]    34%|███▍      | 39/115 [14:04<26:01, 20.55s/epoch, loss=1.16, accuracy=0.752, val_loss=1.57, val_accuracy=0.613, lr=0.1] 35%|███▍      | 40/115 [14:25<26:00, 20.81s/epoch, loss=1.16, accuracy=0.751, val_loss=1.45, val_accuracy=0.655, lr=0.1] 36%|███▌      | 41/115 [14:45<25:23, 20.59s/epoch, loss=1.16, accuracy=0.752, val_loss=2.55, val_accuracy=0.384, lr=0.1] 37%|███▋      | 42/115 [15:06<25:10, 20.69s/epoch, loss=1.16, accuracy=0.752, val_loss=1.75, val_accuracy=0.55, lr=0.0316] 37%|███▋      | 43/115 [15:27<25:02, 20.86s/epoch, loss=1.16, accuracy=0.751, val_loss=2.73, val_accuracy=0.463, lr=0.1]   38%|███▊      | 44/115 [15:49<24:50, 21.00s/epoch, loss=1.15, accuracy=0.754, val_loss=1.82, val_accuracy=0.562, lr=0.1] 39%|███▉      | 45/115 [16:08<23:51, 20.45s/epoch, loss=1.16, accuracy=0.753, val_loss=1.48, val_accuracy=0.646, lr=0.1] 40%|████      | 46/115 [16:29<23:51, 20.75s/epoch, loss=1.15, accuracy=0.753, val_loss=1.92, val_accuracy=0.527, lr=0.1] 41%|████      | 47/115 [16:50<23:31, 20.76s/epoch, loss=1.16, accuracy=0.752, val_loss=1.92, val_accuracy=0.536, lr=0.0316] 42%|████▏     | 48/115 [17:11<23:20, 20.90s/epoch, loss=1.16, accuracy=0.754, val_loss=2.31, val_accuracy=0.483, lr=0.1]    43%|████▎     | 49/115 [17:31<22:28, 20.43s/epoch, loss=1.16, accuracy=0.751, val_loss=1.66, val_accuracy=0.559, lr=0.1] 43%|████▎     | 50/115 [17:50<21:53, 20.21s/epoch, loss=1.15, accuracy=0.754, val_loss=1.7, val_accuracy=0.549, lr=0.1]  44%|████▍     | 51/115 [18:10<21:30, 20.17s/epoch, loss=1.15, accuracy=0.755, val_loss=1.74, val_accuracy=0.564, lr=0.1] 45%|████▌     | 52/115 [18:31<21:29, 20.47s/epoch, loss=1.15, accuracy=0.754, val_loss=2.37, val_accuracy=0.447, lr=0.0316] 46%|████▌     | 53/115 [18:51<20:52, 20.20s/epoch, loss=1.15, accuracy=0.755, val_loss=2.94, val_accuracy=0.327, lr=0.1]    47%|████▋     | 54/115 [19:12<20:52, 20.53s/epoch, loss=1.16, accuracy=0.752, val_loss=1.69, val_accuracy=0.596, lr=0.1] 48%|████▊     | 55/115 [19:32<20:07, 20.13s/epoch, loss=1.15, accuracy=0.752, val_loss=1.89, val_accuracy=0.491, lr=0.1] 49%|████▊     | 56/115 [19:51<19:30, 19.84s/epoch, loss=1.14, accuracy=0.755, val_loss=2.01, val_accuracy=0.481, lr=0.1] 50%|████▉     | 57/115 [20:11<19:14, 19.91s/epoch, loss=1.14, accuracy=0.756, val_loss=11.1, val_accuracy=0.176, lr=0.0316] 50%|█████     | 58/115 [20:31<19:02, 20.05s/epoch, loss=1.14, accuracy=0.754, val_loss=1.78, val_accuracy=0.556, lr=0.1]    51%|█████▏    | 59/115 [20:53<19:09, 20.53s/epoch, loss=1.14, accuracy=0.754, val_loss=1.71, val_accuracy=0.535, lr=0.1] 52%|█████▏    | 60/115 [21:14<19:02, 20.77s/epoch, loss=1.14, accuracy=0.753, val_loss=2.13, val_accuracy=0.529, lr=0.1] 53%|█████▎    | 61/115 [21:35<18:50, 20.93s/epoch, loss=1.15, accuracy=0.755, val_loss=1.67, val_accuracy=0.594, lr=0.1] 54%|█████▍    | 62/115 [21:56<18:19, 20.74s/epoch, loss=1.14, accuracy=0.754, val_loss=2.77, val_accuracy=0.363, lr=0.0316] 55%|█████▍    | 63/115 [22:17<18:02, 20.83s/epoch, loss=1.14, accuracy=0.755, val_loss=2.84, val_accuracy=0.382, lr=0.1]    56%|█████▌    | 64/115 [22:38<17:50, 20.99s/epoch, loss=1.15, accuracy=0.754, val_loss=1.69, val_accuracy=0.588, lr=0.1] 57%|█████▋    | 65/115 [23:00<17:35, 21.12s/epoch, loss=1.14, accuracy=0.754, val_loss=2.81, val_accuracy=0.406, lr=0.1] 57%|█████▋    | 66/115 [23:20<17:11, 21.05s/epoch, loss=1.14, accuracy=0.758, val_loss=1.78, val_accuracy=0.558, lr=0.1] 58%|█████▊    | 67/115 [23:42<16:53, 21.12s/epoch, loss=1.14, accuracy=0.756, val_loss=2.61, val_accuracy=0.436, lr=0.0316] 59%|█████▉    | 68/115 [24:01<16:02, 20.47s/epoch, loss=1.14, accuracy=0.755, val_loss=2.55, val_accuracy=0.372, lr=0.1]    60%|██████    | 69/115 [24:22<15:55, 20.77s/epoch, loss=1.14, accuracy=0.759, val_loss=2.65, val_accuracy=0.356, lr=0.1] 61%|██████    | 70/115 [24:41<15:15, 20.33s/epoch, loss=1.14, accuracy=0.755, val_loss=1.36, val_accuracy=0.674, lr=0.1] 62%|██████▏   | 71/115 [25:00<14:36, 19.93s/epoch, loss=1.14, accuracy=0.758, val_loss=4.05, val_accuracy=0.309, lr=0.1] 63%|██████▎   | 72/115 [25:19<14:05, 19.66s/epoch, loss=1.14, accuracy=0.754, val_loss=2.02, val_accuracy=0.436, lr=0.1] 63%|██████▎   | 73/115 [25:41<14:05, 20.14s/epoch, loss=1.14, accuracy=0.756, val_loss=1.91, val_accuracy=0.471, lr=0.1] 64%|██████▍   | 74/115 [26:02<13:57, 20.43s/epoch, loss=1.14, accuracy=0.756, val_loss=2.01, val_accuracy=0.47, lr=0.1]  65%|██████▌   | 75/115 [26:23<13:48, 20.71s/epoch, loss=1.14, accuracy=0.755, val_loss=2.55, val_accuracy=0.43, lr=0.0316] 66%|██████▌   | 76/115 [26:45<13:36, 20.94s/epoch, loss=1.14, accuracy=0.754, val_loss=1.56, val_accuracy=0.61, lr=0.1]    67%|██████▋   | 77/115 [27:06<13:15, 20.93s/epoch, loss=1.14, accuracy=0.756, val_loss=1.51, val_accuracy=0.636, lr=0.1] 68%|██████▊   | 78/115 [27:26<12:52, 20.88s/epoch, loss=1.14, accuracy=0.756, val_loss=1.61, val_accuracy=0.616, lr=0.1] 69%|██████▊   | 79/115 [27:47<12:33, 20.92s/epoch, loss=1.13, accuracy=0.756, val_loss=2.91, val_accuracy=0.34, lr=0.1]  70%|██████▉   | 80/115 [28:08<12:09, 20.85s/epoch, loss=1.14, accuracy=0.754, val_loss=2.06, val_accuracy=0.467, lr=0.0316] 70%|███████   | 81/115 [28:29<11:52, 20.96s/epoch, loss=1.13, accuracy=0.759, val_loss=2.71, val_accuracy=0.362, lr=0.1]    71%|███████▏  | 82/115 [28:51<11:38, 21.16s/epoch, loss=0.936, accuracy=0.814, val_loss=0.931, val_accuracy=0.803, lr=0.01] 72%|███████▏  | 83/115 [29:12<11:18, 21.20s/epoch, loss=0.755, accuracy=0.849, val_loss=0.805, val_accuracy=0.815, lr=0.01] 73%|███████▎  | 84/115 [29:34<10:59, 21.29s/epoch, loss=0.672, accuracy=0.855, val_loss=0.778, val_accuracy=0.805, lr=0.01] 74%|███████▍  | 85/115 [29:55<10:41, 21.38s/epoch, loss=0.622, accuracy=0.862, val_loss=0.7, val_accuracy=0.827, lr=0.01]   75%|███████▍  | 86/115 [30:15<10:03, 20.83s/epoch, loss=0.595, accuracy=0.861, val_loss=0.774, val_accuracy=0.799, lr=0.01] 76%|███████▌  | 87/115 [30:36<09:48, 21.00s/epoch, loss=0.581, accuracy=0.863, val_loss=0.818, val_accuracy=0.782, lr=0.01] 77%|███████▋  | 88/115 [30:57<09:23, 20.88s/epoch, loss=0.574, accuracy=0.864, val_loss=0.786, val_accuracy=0.793, lr=0.01] 77%|███████▋  | 89/115 [31:17<08:57, 20.67s/epoch, loss=0.571, accuracy=0.865, val_loss=0.832, val_accuracy=0.76, lr=0.01]  78%|███████▊  | 90/115 [31:38<08:40, 20.84s/epoch, loss=0.564, accuracy=0.869, val_loss=0.86, val_accuracy=0.774, lr=0.00316] 79%|███████▉  | 91/115 [31:59<08:17, 20.73s/epoch, loss=0.561, accuracy=0.869, val_loss=0.834, val_accuracy=0.776, lr=0.01]   80%|████████  | 92/115 [32:20<08:02, 20.97s/epoch, loss=0.564, accuracy=0.871, val_loss=0.789, val_accuracy=0.799, lr=0.01] 81%|████████  | 93/115 [32:42<07:45, 21.16s/epoch, loss=0.563, accuracy=0.872, val_loss=0.78, val_accuracy=0.799, lr=0.01]  82%|████████▏ | 94/115 [33:03<07:26, 21.29s/epoch, loss=0.561, accuracy=0.873, val_loss=0.775, val_accuracy=0.805, lr=0.01] 83%|████████▎ | 95/115 [33:23<06:55, 20.77s/epoch, loss=0.561, accuracy=0.874, val_loss=0.692, val_accuracy=0.831, lr=0.01] 83%|████████▎ | 96/115 [33:43<06:32, 20.67s/epoch, loss=0.56, accuracy=0.876, val_loss=0.791, val_accuracy=0.802, lr=0.01]  84%|████████▍ | 97/115 [34:03<06:07, 20.44s/epoch, loss=0.556, accuracy=0.877, val_loss=0.76, val_accuracy=0.815, lr=0.01] 85%|████████▌ | 98/115 [34:22<05:40, 20.04s/epoch, loss=0.554, accuracy=0.877, val_loss=0.733, val_accuracy=0.816, lr=0.01] 86%|████████▌ | 99/115 [34:44<05:27, 20.47s/epoch, loss=0.559, accuracy=0.876, val_loss=0.795, val_accuracy=0.801, lr=0.01] 87%|████████▋ | 100/115 [35:05<05:08, 20.60s/epoch, loss=0.553, accuracy=0.879, val_loss=0.702, val_accuracy=0.831, lr=0.00316] 88%|████████▊ | 101/115 [35:26<04:51, 20.84s/epoch, loss=0.555, accuracy=0.877, val_loss=0.886, val_accuracy=0.774, lr=0.01]    89%|████████▊ | 102/115 [35:45<04:24, 20.32s/epoch, loss=0.557, accuracy=0.88, val_loss=1.14, val_accuracy=0.705, lr=0.01]   90%|████████▉ | 103/115 [36:06<04:04, 20.39s/epoch, loss=0.551, accuracy=0.882, val_loss=0.786, val_accuracy=0.8, lr=0.01] 90%|█████████ | 104/115 [36:25<03:40, 20.02s/epoch, loss=0.556, accuracy=0.881, val_loss=1.06, val_accuracy=0.721, lr=0.01] 91%|█████████▏| 105/115 [36:46<03:24, 20.45s/epoch, loss=0.557, accuracy=0.88, val_loss=0.88, val_accuracy=0.766, lr=0.00316] 92%|█████████▏| 106/115 [37:06<03:00, 20.08s/epoch, loss=0.556, accuracy=0.883, val_loss=1.17, val_accuracy=0.697, lr=0.01]   93%|█████████▎| 107/115 [37:27<02:43, 20.47s/epoch, loss=0.557, accuracy=0.881, val_loss=1.09, val_accuracy=0.726, lr=0.01] 94%|█████████▍| 108/115 [37:48<02:25, 20.73s/epoch, loss=0.553, accuracy=0.883, val_loss=0.743, val_accuracy=0.827, lr=0.01] 95%|█████████▍| 109/115 [38:10<02:05, 20.98s/epoch, loss=0.555, accuracy=0.883, val_loss=0.748, val_accuracy=0.824, lr=0.01] 96%|█████████▌| 110/115 [38:32<01:45, 21.15s/epoch, loss=0.559, accuracy=0.882, val_loss=0.892, val_accuracy=0.798, lr=0.00316] 97%|█████████▋| 111/115 [38:51<01:22, 20.62s/epoch, loss=0.555, accuracy=0.884, val_loss=0.815, val_accuracy=0.81, lr=0.01]     97%|█████████▋| 112/115 [39:11<01:01, 20.53s/epoch, loss=0.554, accuracy=0.884, val_loss=0.894, val_accuracy=0.789, lr=0.01] 98%|█████████▊| 113/115 [39:33<00:41, 20.79s/epoch, loss=0.558, accuracy=0.884, val_loss=1.03, val_accuracy=0.751, lr=0.01]  99%|█████████▉| 114/115 [39:54<00:20, 20.99s/epoch, loss=0.556, accuracy=0.883, val_loss=0.923, val_accuracy=0.778, lr=0.01]100%|██████████| 115/115 [40:15<00:00, 20.98s/epoch, loss=0.556, accuracy=0.884, val_loss=0.808, val_accuracy=0.812, lr=0.00316]100%|██████████| 115/115 [40:15<00:00, 21.00s/epoch, loss=0.556, accuracy=0.884, val_loss=0.808, val_accuracy=0.812, lr=0.00316]
Using real-time data augmentation.
Test score: 0.719785749912262
Test accuracy: 0.8264999985694885


* * * Run SGD for ID = 13_4. * * *


2024-02-19 21:13:40.526615: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 21:13:43.383651: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-19 21:13:43.384716: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-19 21:13:43.424542: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-19 21:13:43.424578: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 21:13:43.427435: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-19 21:13:43.427480: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-19 21:13:43.429700: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-19 21:13:43.430438: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-19 21:13:43.432852: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-19 21:13:43.434358: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-19 21:13:43.439336: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-19 21:13:43.441176: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-19 21:13:43.441282: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-19 21:13:44.952334: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-19 21:13:44.953364: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-19 21:13:44.954206: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-19 21:13:44.954245: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 21:13:44.954283: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-19 21:13:44.954303: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-19 21:13:44.954323: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-19 21:13:44.954342: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-19 21:13:44.954361: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-19 21:13:44.954395: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-19 21:13:44.954415: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-19 21:13:44.954880: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-19 21:13:44.954922: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 21:13:45.618862: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-19 21:13:45.618920: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-19 21:13:45.618933: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-19 21:13:45.619907: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:83:00.0, compute capability: 6.1)
{'id': '13_04', 'batch_size': 128, 'epochs': 115, 'validation_split': 0.1, 'checkpointing': True, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
x_train shape: (45000, 32, 32, 3)
45000 train samples
5000 validation samples
10000 test samples
y_train shape: (45000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/115 [00:00<?, ?epoch/s]2024-02-19 21:13:46.459702: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-19 21:13:46.472167: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199825000 Hz
2024-02-19 21:13:48.550088: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-19 21:13:48.783367: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-19 21:13:49.455445: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-19 21:13:49.488943: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/115 [00:47<1:30:34, 47.67s/epoch, loss=3.39, accuracy=0.314, val_loss=3.22, val_accuracy=0.159, lr=0.1]  2%|▏         | 2/115 [01:07<59:23, 31.54s/epoch, loss=1.63, accuracy=0.513, val_loss=2.38, val_accuracy=0.308, lr=0.1]    3%|▎         | 3/115 [01:29<50:28, 27.04s/epoch, loss=1.35, accuracy=0.636, val_loss=2.08, val_accuracy=0.43, lr=0.1]   3%|▎         | 4/115 [01:50<45:52, 24.80s/epoch, loss=1.28, accuracy=0.676, val_loss=2.28, val_accuracy=0.418, lr=0.1]  4%|▍         | 5/115 [02:13<43:41, 23.83s/epoch, loss=1.25, accuracy=0.7, val_loss=1.74, val_accuracy=0.547, lr=0.1]    5%|▌         | 6/115 [02:33<40:57, 22.54s/epoch, loss=1.23, accuracy=0.711, val_loss=2.07, val_accuracy=0.448, lr=0.1]  6%|▌         | 7/115 [02:54<40:04, 22.26s/epoch, loss=1.22, accuracy=0.718, val_loss=1.96, val_accuracy=0.529, lr=0.1]  7%|▋         | 8/115 [03:14<38:23, 21.52s/epoch, loss=1.22, accuracy=0.723, val_loss=2.62, val_accuracy=0.395, lr=0.1]  8%|▊         | 9/115 [03:35<37:31, 21.24s/epoch, loss=1.21, accuracy=0.728, val_loss=4.88, val_accuracy=0.321, lr=0.1]  9%|▊         | 10/115 [03:56<37:17, 21.31s/epoch, loss=1.2, accuracy=0.735, val_loss=2.26, val_accuracy=0.454, lr=0.0316] 10%|▉         | 11/115 [04:18<36:57, 21.32s/epoch, loss=1.2, accuracy=0.732, val_loss=3.82, val_accuracy=0.39, lr=0.1]     10%|█         | 12/115 [04:39<36:39, 21.36s/epoch, loss=1.2, accuracy=0.736, val_loss=4.38, val_accuracy=0.319, lr=0.1] 11%|█▏        | 13/115 [05:01<36:31, 21.48s/epoch, loss=1.18, accuracy=0.74, val_loss=1.56, val_accuracy=0.613, lr=0.1] 12%|█▏        | 14/115 [05:22<36:03, 21.42s/epoch, loss=1.19, accuracy=0.738, val_loss=1.74, val_accuracy=0.555, lr=0.1] 13%|█▎        | 15/115 [05:44<35:55, 21.55s/epoch, loss=1.18, accuracy=0.739, val_loss=1.42, val_accuracy=0.661, lr=0.1] 14%|█▍        | 16/115 [06:05<35:02, 21.24s/epoch, loss=1.18, accuracy=0.74, val_loss=2.01, val_accuracy=0.5, lr=0.1]    15%|█▍        | 17/115 [06:24<33:43, 20.65s/epoch, loss=1.18, accuracy=0.743, val_loss=1.96, val_accuracy=0.469, lr=0.1] 16%|█▌        | 18/115 [06:43<32:43, 20.24s/epoch, loss=1.17, accuracy=0.747, val_loss=5.52, val_accuracy=0.178, lr=0.1] 17%|█▋        | 19/115 [07:04<32:39, 20.41s/epoch, loss=1.17, accuracy=0.746, val_loss=1.65, val_accuracy=0.567, lr=0.1] 17%|█▋        | 20/115 [07:25<32:51, 20.76s/epoch, loss=1.18, accuracy=0.744, val_loss=1.95, val_accuracy=0.514, lr=0.0316] 18%|█▊        | 21/115 [07:47<32:59, 21.06s/epoch, loss=1.17, accuracy=0.748, val_loss=1.89, val_accuracy=0.549, lr=0.1]    19%|█▉        | 22/115 [08:08<32:34, 21.02s/epoch, loss=1.16, accuracy=0.749, val_loss=2.04, val_accuracy=0.502, lr=0.1] 20%|██        | 23/115 [08:30<32:35, 21.25s/epoch, loss=1.15, accuracy=0.751, val_loss=1.76, val_accuracy=0.549, lr=0.1] 21%|██        | 24/115 [08:51<32:19, 21.31s/epoch, loss=1.15, accuracy=0.752, val_loss=1.94, val_accuracy=0.494, lr=0.1] 22%|██▏       | 25/115 [09:12<31:41, 21.13s/epoch, loss=1.15, accuracy=0.752, val_loss=1.86, val_accuracy=0.549, lr=0.0316] 23%|██▎       | 26/115 [09:34<31:31, 21.25s/epoch, loss=1.15, accuracy=0.751, val_loss=2.44, val_accuracy=0.435, lr=0.1]    23%|██▎       | 27/115 [09:55<31:25, 21.43s/epoch, loss=1.15, accuracy=0.75, val_loss=3.87, val_accuracy=0.284, lr=0.1]  24%|██▍       | 28/115 [10:17<30:59, 21.37s/epoch, loss=1.15, accuracy=0.753, val_loss=1.97, val_accuracy=0.501, lr=0.1] 25%|██▌       | 29/115 [10:38<30:40, 21.41s/epoch, loss=1.15, accuracy=0.752, val_loss=6.46, val_accuracy=0.194, lr=0.1] 26%|██▌       | 30/115 [11:00<30:21, 21.43s/epoch, loss=1.14, accuracy=0.757, val_loss=1.55, val_accuracy=0.612, lr=0.0316] 27%|██▋       | 31/115 [11:20<29:20, 20.96s/epoch, loss=1.14, accuracy=0.754, val_loss=1.81, val_accuracy=0.526, lr=0.1]    28%|██▊       | 32/115 [11:39<28:19, 20.48s/epoch, loss=1.14, accuracy=0.754, val_loss=2.06, val_accuracy=0.535, lr=0.1] 29%|██▊       | 33/115 [12:00<28:11, 20.63s/epoch, loss=1.14, accuracy=0.756, val_loss=2.76, val_accuracy=0.405, lr=0.1] 30%|██▉       | 34/115 [12:21<28:06, 20.82s/epoch, loss=1.14, accuracy=0.754, val_loss=2.03, val_accuracy=0.488, lr=0.1] 30%|███       | 35/115 [12:42<27:37, 20.72s/epoch, loss=1.13, accuracy=0.751, val_loss=2.98, val_accuracy=0.433, lr=0.0316] 31%|███▏      | 36/115 [13:01<26:39, 20.24s/epoch, loss=1.14, accuracy=0.753, val_loss=1.8, val_accuracy=0.521, lr=0.1]     32%|███▏      | 37/115 [13:21<26:29, 20.38s/epoch, loss=1.13, accuracy=0.757, val_loss=1.42, val_accuracy=0.643, lr=0.1] 33%|███▎      | 38/115 [13:42<26:13, 20.44s/epoch, loss=1.13, accuracy=0.757, val_loss=1.93, val_accuracy=0.502, lr=0.1] 34%|███▍      | 39/115 [14:04<26:24, 20.85s/epoch, loss=1.14, accuracy=0.757, val_loss=2.43, val_accuracy=0.439, lr=0.1] 35%|███▍      | 40/115 [14:26<26:23, 21.12s/epoch, loss=1.13, accuracy=0.756, val_loss=2.18, val_accuracy=0.399, lr=0.1] 36%|███▌      | 41/115 [14:47<26:05, 21.16s/epoch, loss=1.13, accuracy=0.757, val_loss=1.88, val_accuracy=0.57, lr=0.1]  37%|███▋      | 42/115 [15:08<25:51, 21.25s/epoch, loss=1.13, accuracy=0.755, val_loss=2.67, val_accuracy=0.407, lr=0.0316] 37%|███▋      | 43/115 [15:28<24:48, 20.67s/epoch, loss=1.13, accuracy=0.756, val_loss=1.8, val_accuracy=0.537, lr=0.1]     38%|███▊      | 44/115 [15:48<24:26, 20.66s/epoch, loss=1.13, accuracy=0.756, val_loss=1.78, val_accuracy=0.59, lr=0.1] 39%|███▉      | 45/115 [16:08<23:36, 20.24s/epoch, loss=1.13, accuracy=0.755, val_loss=2.78, val_accuracy=0.381, lr=0.1] 40%|████      | 46/115 [16:29<23:36, 20.52s/epoch, loss=1.13, accuracy=0.757, val_loss=1.9, val_accuracy=0.569, lr=0.1]  41%|████      | 47/115 [16:48<22:59, 20.29s/epoch, loss=1.12, accuracy=0.758, val_loss=2.9, val_accuracy=0.375, lr=0.0316] 42%|████▏     | 48/115 [17:10<23:06, 20.70s/epoch, loss=1.13, accuracy=0.756, val_loss=2.62, val_accuracy=0.416, lr=0.1]   43%|████▎     | 49/115 [17:31<22:43, 20.65s/epoch, loss=1.13, accuracy=0.756, val_loss=2.21, val_accuracy=0.506, lr=0.1] 43%|████▎     | 50/115 [17:51<22:17, 20.58s/epoch, loss=1.12, accuracy=0.76, val_loss=2.34, val_accuracy=0.388, lr=0.1]  44%|████▍     | 51/115 [18:12<22:13, 20.83s/epoch, loss=1.13, accuracy=0.757, val_loss=2.21, val_accuracy=0.459, lr=0.1] 45%|████▌     | 52/115 [18:33<21:45, 20.73s/epoch, loss=1.12, accuracy=0.759, val_loss=3.54, val_accuracy=0.377, lr=0.0316] 46%|████▌     | 53/115 [18:53<21:18, 20.62s/epoch, loss=1.12, accuracy=0.758, val_loss=1.49, val_accuracy=0.633, lr=0.1]    47%|████▋     | 54/115 [19:15<21:15, 20.91s/epoch, loss=1.13, accuracy=0.756, val_loss=1.77, val_accuracy=0.576, lr=0.1] 48%|████▊     | 55/115 [19:34<20:24, 20.41s/epoch, loss=1.13, accuracy=0.758, val_loss=2.02, val_accuracy=0.49, lr=0.1]  49%|████▊     | 56/115 [19:56<20:23, 20.74s/epoch, loss=1.12, accuracy=0.758, val_loss=2.45, val_accuracy=0.298, lr=0.1] 50%|████▉     | 57/115 [20:17<20:08, 20.84s/epoch, loss=1.11, accuracy=0.758, val_loss=2.38, val_accuracy=0.471, lr=0.0316] 50%|█████     | 58/115 [20:38<20:00, 21.06s/epoch, loss=1.12, accuracy=0.759, val_loss=1.86, val_accuracy=0.533, lr=0.1]    51%|█████▏    | 59/115 [21:00<19:49, 21.24s/epoch, loss=1.12, accuracy=0.759, val_loss=2.1, val_accuracy=0.497, lr=0.1]  52%|█████▏    | 60/115 [21:22<19:37, 21.41s/epoch, loss=1.13, accuracy=0.756, val_loss=1.93, val_accuracy=0.537, lr=0.1] 53%|█████▎    | 61/115 [21:43<19:14, 21.38s/epoch, loss=1.12, accuracy=0.759, val_loss=1.66, val_accuracy=0.583, lr=0.1] 54%|█████▍    | 62/115 [22:02<18:20, 20.76s/epoch, loss=1.12, accuracy=0.759, val_loss=2.34, val_accuracy=0.424, lr=0.0316] 55%|█████▍    | 63/115 [22:24<18:12, 21.00s/epoch, loss=1.12, accuracy=0.756, val_loss=3.06, val_accuracy=0.424, lr=0.1]    56%|█████▌    | 64/115 [22:45<17:57, 21.12s/epoch, loss=1.11, accuracy=0.761, val_loss=1.99, val_accuracy=0.534, lr=0.1] 57%|█████▋    | 65/115 [23:07<17:40, 21.22s/epoch, loss=1.11, accuracy=0.758, val_loss=2.05, val_accuracy=0.544, lr=0.1] 57%|█████▋    | 66/115 [23:26<16:51, 20.65s/epoch, loss=1.12, accuracy=0.758, val_loss=1.51, val_accuracy=0.607, lr=0.1] 58%|█████▊    | 67/115 [23:47<16:28, 20.59s/epoch, loss=1.12, accuracy=0.757, val_loss=1.76, val_accuracy=0.556, lr=0.0316] 59%|█████▉    | 68/115 [24:08<16:22, 20.90s/epoch, loss=1.11, accuracy=0.759, val_loss=2.22, val_accuracy=0.461, lr=0.1]    60%|██████    | 69/115 [24:27<15:38, 20.40s/epoch, loss=1.12, accuracy=0.757, val_loss=3.88, val_accuracy=0.352, lr=0.1] 61%|██████    | 70/115 [24:49<15:26, 20.59s/epoch, loss=1.12, accuracy=0.757, val_loss=1.78, val_accuracy=0.559, lr=0.1] 62%|██████▏   | 71/115 [25:09<15:10, 20.70s/epoch, loss=1.12, accuracy=0.76, val_loss=4.5, val_accuracy=0.226, lr=0.1]   63%|██████▎   | 72/115 [25:31<15:03, 21.00s/epoch, loss=1.11, accuracy=0.76, val_loss=1.66, val_accuracy=0.553, lr=0.0316] 63%|██████▎   | 73/115 [25:53<14:49, 21.18s/epoch, loss=1.11, accuracy=0.759, val_loss=2.07, val_accuracy=0.485, lr=0.1]   64%|██████▍   | 74/115 [26:14<14:25, 21.12s/epoch, loss=1.12, accuracy=0.758, val_loss=2.64, val_accuracy=0.346, lr=0.1] 65%|██████▌   | 75/115 [26:33<13:43, 20.59s/epoch, loss=1.11, accuracy=0.759, val_loss=2.16, val_accuracy=0.466, lr=0.1] 66%|██████▌   | 76/115 [26:53<13:16, 20.41s/epoch, loss=1.11, accuracy=0.757, val_loss=2.08, val_accuracy=0.538, lr=0.1] 67%|██████▋   | 77/115 [27:15<13:11, 20.82s/epoch, loss=1.11, accuracy=0.762, val_loss=1.92, val_accuracy=0.547, lr=0.0316] 68%|██████▊   | 78/115 [27:34<12:31, 20.32s/epoch, loss=1.11, accuracy=0.757, val_loss=5.27, val_accuracy=0.245, lr=0.1]    69%|██████▊   | 79/115 [27:54<12:12, 20.34s/epoch, loss=1.1, accuracy=0.762, val_loss=2.58, val_accuracy=0.397, lr=0.1]  70%|██████▉   | 80/115 [28:16<12:02, 20.65s/epoch, loss=1.11, accuracy=0.757, val_loss=2.77, val_accuracy=0.444, lr=0.1] 70%|███████   | 81/115 [28:37<11:48, 20.84s/epoch, loss=1.11, accuracy=0.761, val_loss=1.9, val_accuracy=0.534, lr=0.1]  71%|███████▏  | 82/115 [28:59<11:36, 21.12s/epoch, loss=0.913, accuracy=0.818, val_loss=0.967, val_accuracy=0.791, lr=0.01] 72%|███████▏  | 83/115 [29:18<10:57, 20.54s/epoch, loss=0.735, accuracy=0.849, val_loss=0.787, val_accuracy=0.825, lr=0.01] 73%|███████▎  | 84/115 [29:39<10:37, 20.57s/epoch, loss=0.656, accuracy=0.856, val_loss=0.771, val_accuracy=0.803, lr=0.01] 74%|███████▍  | 85/115 [29:59<10:17, 20.57s/epoch, loss=0.607, accuracy=0.863, val_loss=0.773, val_accuracy=0.801, lr=0.01] 75%|███████▍  | 86/115 [30:20<09:59, 20.66s/epoch, loss=0.583, accuracy=0.864, val_loss=0.836, val_accuracy=0.785, lr=0.01] 76%|███████▌  | 87/115 [30:42<09:45, 20.91s/epoch, loss=0.569, accuracy=0.865, val_loss=0.693, val_accuracy=0.824, lr=0.01] 77%|███████▋  | 88/115 [31:03<09:27, 21.02s/epoch, loss=0.561, accuracy=0.865, val_loss=0.994, val_accuracy=0.745, lr=0.01] 77%|███████▋  | 89/115 [31:24<09:06, 21.02s/epoch, loss=0.553, accuracy=0.868, val_loss=0.683, val_accuracy=0.828, lr=0.01] 78%|███████▊  | 90/115 [31:43<08:30, 20.42s/epoch, loss=0.556, accuracy=0.867, val_loss=0.822, val_accuracy=0.779, lr=0.01] 79%|███████▉  | 91/115 [32:04<08:16, 20.70s/epoch, loss=0.551, accuracy=0.869, val_loss=0.809, val_accuracy=0.778, lr=0.01] 80%|████████  | 92/115 [32:26<08:01, 20.95s/epoch, loss=0.552, accuracy=0.871, val_loss=0.87, val_accuracy=0.772, lr=0.01]  81%|████████  | 93/115 [32:46<07:33, 20.60s/epoch, loss=0.55, accuracy=0.872, val_loss=0.842, val_accuracy=0.782, lr=0.01] 82%|████████▏ | 94/115 [33:05<07:02, 20.11s/epoch, loss=0.551, accuracy=0.872, val_loss=0.784, val_accuracy=0.801, lr=0.00316] 83%|████████▎ | 95/115 [33:26<06:51, 20.59s/epoch, loss=0.546, accuracy=0.874, val_loss=0.785, val_accuracy=0.803, lr=0.01]    83%|████████▎ | 96/115 [33:48<06:36, 20.86s/epoch, loss=0.544, accuracy=0.877, val_loss=0.933, val_accuracy=0.756, lr=0.01] 84%|████████▍ | 97/115 [34:09<06:18, 21.03s/epoch, loss=0.552, accuracy=0.875, val_loss=0.998, val_accuracy=0.762, lr=0.01] 85%|████████▌ | 98/115 [34:30<05:57, 21.00s/epoch, loss=0.546, accuracy=0.878, val_loss=0.986, val_accuracy=0.747, lr=0.01] 86%|████████▌ | 99/115 [34:51<05:34, 20.93s/epoch, loss=0.549, accuracy=0.879, val_loss=0.712, val_accuracy=0.825, lr=0.00316] 87%|████████▋ | 100/115 [35:13<05:16, 21.13s/epoch, loss=0.547, accuracy=0.881, val_loss=0.727, val_accuracy=0.824, lr=0.01]   88%|████████▊ | 101/115 [35:34<04:57, 21.25s/epoch, loss=0.547, accuracy=0.88, val_loss=0.721, val_accuracy=0.82, lr=0.01]   89%|████████▊ | 102/115 [35:54<04:32, 20.94s/epoch, loss=0.543, accuracy=0.882, val_loss=1.04, val_accuracy=0.744, lr=0.01] 90%|████████▉ | 103/115 [36:16<04:12, 21.06s/epoch, loss=0.54, accuracy=0.883, val_loss=0.743, val_accuracy=0.813, lr=0.01] 90%|█████████ | 104/115 [36:37<03:52, 21.14s/epoch, loss=0.55, accuracy=0.88, val_loss=0.776, val_accuracy=0.805, lr=0.00316] 91%|█████████▏| 105/115 [36:59<03:32, 21.28s/epoch, loss=0.543, accuracy=0.884, val_loss=0.9, val_accuracy=0.774, lr=0.01]    92%|█████████▏| 106/115 [37:18<03:06, 20.69s/epoch, loss=0.542, accuracy=0.885, val_loss=0.846, val_accuracy=0.796, lr=0.01] 93%|█████████▎| 107/115 [37:37<02:41, 20.25s/epoch, loss=0.549, accuracy=0.882, val_loss=1.06, val_accuracy=0.723, lr=0.01]  94%|█████████▍| 108/115 [37:58<02:22, 20.40s/epoch, loss=0.545, accuracy=0.885, val_loss=1.11, val_accuracy=0.711, lr=0.01] 95%|█████████▍| 109/115 [38:19<02:04, 20.73s/epoch, loss=0.543, accuracy=0.884, val_loss=1.29, val_accuracy=0.671, lr=0.00316] 96%|█████████▌| 110/115 [38:40<01:44, 20.82s/epoch, loss=0.546, accuracy=0.885, val_loss=1.07, val_accuracy=0.715, lr=0.01]    97%|█████████▋| 111/115 [39:02<01:23, 20.99s/epoch, loss=0.544, accuracy=0.886, val_loss=1.01, val_accuracy=0.764, lr=0.01] 97%|█████████▋| 112/115 [39:21<01:01, 20.45s/epoch, loss=0.55, accuracy=0.884, val_loss=0.83, val_accuracy=0.793, lr=0.01]  98%|█████████▊| 113/115 [39:42<00:41, 20.78s/epoch, loss=0.543, accuracy=0.886, val_loss=0.82, val_accuracy=0.808, lr=0.01] 99%|█████████▉| 114/115 [40:04<00:20, 20.89s/epoch, loss=0.54, accuracy=0.887, val_loss=0.777, val_accuracy=0.813, lr=0.00316]100%|██████████| 115/115 [40:23<00:00, 20.44s/epoch, loss=0.548, accuracy=0.886, val_loss=0.795, val_accuracy=0.816, lr=0.01]  100%|██████████| 115/115 [40:23<00:00, 21.07s/epoch, loss=0.548, accuracy=0.886, val_loss=0.795, val_accuracy=0.816, lr=0.01]
Using real-time data augmentation.
Test score: 0.6906731128692627
Test accuracy: 0.823199987411499


* * * Run SGD for ID = 13_5. * * *


2024-02-19 21:54:16.337625: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 21:54:19.335014: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-19 21:54:19.336219: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-19 21:54:19.376002: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-19 21:54:19.376042: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 21:54:19.379076: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-19 21:54:19.379121: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-19 21:54:19.381759: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-19 21:54:19.382516: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-19 21:54:19.384970: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-19 21:54:19.386499: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-19 21:54:19.391421: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-19 21:54:19.391997: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-19 21:54:19.392103: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-19 21:54:20.968372: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-19 21:54:20.969839: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-19 21:54:20.970454: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-19 21:54:20.970488: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 21:54:20.970523: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-19 21:54:20.970541: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-19 21:54:20.970558: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-19 21:54:20.970574: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-19 21:54:20.970590: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-19 21:54:20.970615: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-19 21:54:20.970632: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-19 21:54:20.971133: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-19 21:54:20.971167: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 21:54:21.656784: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-19 21:54:21.656837: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-19 21:54:21.656847: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-19 21:54:21.657791: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:83:00.0, compute capability: 6.1)
{'id': '13_05', 'batch_size': 128, 'epochs': 115, 'validation_split': 0.1, 'checkpointing': True, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
x_train shape: (45000, 32, 32, 3)
45000 train samples
5000 validation samples
10000 test samples
y_train shape: (45000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/115 [00:00<?, ?epoch/s]2024-02-19 21:54:22.531806: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-19 21:54:22.544191: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199825000 Hz
2024-02-19 21:54:24.738809: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-19 21:54:24.959035: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-19 21:54:25.730233: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-19 21:54:25.781761: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/115 [00:59<1:52:56, 59.45s/epoch, loss=3.4, accuracy=0.295, val_loss=2.38, val_accuracy=0.265, lr=0.1]  2%|▏         | 2/115 [01:21<1:10:13, 37.28s/epoch, loss=1.64, accuracy=0.502, val_loss=1.77, val_accuracy=0.482, lr=0.1]  3%|▎         | 3/115 [01:43<56:24, 30.22s/epoch, loss=1.44, accuracy=0.584, val_loss=2.16, val_accuracy=0.454, lr=0.1]    3%|▎         | 4/115 [02:04<49:50, 26.94s/epoch, loss=1.35, accuracy=0.643, val_loss=2.09, val_accuracy=0.397, lr=0.1]  4%|▍         | 5/115 [02:25<45:11, 24.65s/epoch, loss=1.3, accuracy=0.672, val_loss=2.3, val_accuracy=0.4, lr=0.1]      5%|▌         | 6/115 [02:47<43:05, 23.72s/epoch, loss=1.26, accuracy=0.691, val_loss=1.69, val_accuracy=0.569, lr=0.1]  6%|▌         | 7/115 [03:08<41:18, 22.95s/epoch, loss=1.25, accuracy=0.703, val_loss=2.15, val_accuracy=0.444, lr=0.1]  7%|▋         | 8/115 [03:30<40:16, 22.59s/epoch, loss=1.23, accuracy=0.714, val_loss=2.38, val_accuracy=0.454, lr=0.1]  8%|▊         | 9/115 [03:52<39:42, 22.48s/epoch, loss=1.22, accuracy=0.715, val_loss=3.96, val_accuracy=0.299, lr=0.1]  9%|▊         | 10/115 [04:14<38:54, 22.23s/epoch, loss=1.21, accuracy=0.72, val_loss=2.06, val_accuracy=0.498, lr=0.1] 10%|▉         | 11/115 [04:36<38:22, 22.14s/epoch, loss=1.2, accuracy=0.724, val_loss=1.95, val_accuracy=0.495, lr=0.0316] 10%|█         | 12/115 [04:58<37:42, 21.96s/epoch, loss=1.21, accuracy=0.726, val_loss=2.87, val_accuracy=0.354, lr=0.1]   11%|█▏        | 13/115 [05:19<37:09, 21.85s/epoch, loss=1.2, accuracy=0.728, val_loss=1.89, val_accuracy=0.492, lr=0.1]  12%|█▏        | 14/115 [05:40<36:07, 21.46s/epoch, loss=1.19, accuracy=0.731, val_loss=1.88, val_accuracy=0.489, lr=0.1] 13%|█▎        | 15/115 [06:01<35:31, 21.32s/epoch, loss=1.19, accuracy=0.732, val_loss=2.45, val_accuracy=0.439, lr=0.1] 14%|█▍        | 16/115 [06:22<35:06, 21.27s/epoch, loss=1.19, accuracy=0.734, val_loss=3.22, val_accuracy=0.417, lr=0.0316] 15%|█▍        | 17/115 [06:41<33:55, 20.77s/epoch, loss=1.19, accuracy=0.736, val_loss=1.9, val_accuracy=0.529, lr=0.1]     16%|█▌        | 18/115 [07:03<34:10, 21.13s/epoch, loss=1.18, accuracy=0.739, val_loss=1.97, val_accuracy=0.53, lr=0.1] 17%|█▋        | 19/115 [07:26<34:23, 21.49s/epoch, loss=1.19, accuracy=0.735, val_loss=1.66, val_accuracy=0.599, lr=0.1] 17%|█▋        | 20/115 [07:47<33:49, 21.36s/epoch, loss=1.18, accuracy=0.735, val_loss=2.11, val_accuracy=0.517, lr=0.1] 18%|█▊        | 21/115 [08:08<33:08, 21.16s/epoch, loss=1.18, accuracy=0.737, val_loss=3.11, val_accuracy=0.334, lr=0.1] 19%|█▉        | 22/115 [08:30<33:11, 21.41s/epoch, loss=1.17, accuracy=0.738, val_loss=3.57, val_accuracy=0.331, lr=0.1] 20%|██        | 23/115 [08:51<32:57, 21.49s/epoch, loss=1.16, accuracy=0.741, val_loss=2.67, val_accuracy=0.337, lr=0.1] 21%|██        | 24/115 [09:11<31:50, 20.99s/epoch, loss=1.17, accuracy=0.739, val_loss=2.84, val_accuracy=0.379, lr=0.0316] 22%|██▏       | 25/115 [09:33<32:03, 21.37s/epoch, loss=1.17, accuracy=0.74, val_loss=1.43, val_accuracy=0.659, lr=0.1]     23%|██▎       | 26/115 [09:55<31:50, 21.46s/epoch, loss=1.17, accuracy=0.74, val_loss=1.59, val_accuracy=0.574, lr=0.1] 23%|██▎       | 27/115 [10:17<31:36, 21.55s/epoch, loss=1.17, accuracy=0.743, val_loss=2.09, val_accuracy=0.523, lr=0.1] 24%|██▍       | 28/115 [10:39<31:23, 21.65s/epoch, loss=1.17, accuracy=0.739, val_loss=1.5, val_accuracy=0.637, lr=0.1]  25%|██▌       | 29/115 [10:58<30:12, 21.08s/epoch, loss=1.17, accuracy=0.74, val_loss=2.47, val_accuracy=0.387, lr=0.1] 26%|██▌       | 30/115 [11:20<30:15, 21.36s/epoch, loss=1.16, accuracy=0.742, val_loss=1.72, val_accuracy=0.55, lr=0.0316] 27%|██▋       | 31/115 [11:42<30:00, 21.43s/epoch, loss=1.16, accuracy=0.745, val_loss=2.23, val_accuracy=0.48, lr=0.1]    28%|██▊       | 32/115 [12:04<29:53, 21.61s/epoch, loss=1.15, accuracy=0.745, val_loss=2.19, val_accuracy=0.484, lr=0.1] 29%|██▊       | 33/115 [12:26<29:42, 21.73s/epoch, loss=1.16, accuracy=0.745, val_loss=2.31, val_accuracy=0.449, lr=0.1] 30%|██▉       | 34/115 [12:46<28:28, 21.09s/epoch, loss=1.16, accuracy=0.745, val_loss=1.49, val_accuracy=0.644, lr=0.1] 30%|███       | 35/115 [13:05<27:30, 20.63s/epoch, loss=1.17, accuracy=0.744, val_loss=2.85, val_accuracy=0.43, lr=0.0316] 31%|███▏      | 36/115 [13:27<27:39, 21.01s/epoch, loss=1.16, accuracy=0.745, val_loss=2.22, val_accuracy=0.483, lr=0.1]   32%|███▏      | 37/115 [13:48<27:17, 20.99s/epoch, loss=1.16, accuracy=0.744, val_loss=1.71, val_accuracy=0.564, lr=0.1] 33%|███▎      | 38/115 [14:10<27:20, 21.30s/epoch, loss=1.15, accuracy=0.747, val_loss=2.55, val_accuracy=0.401, lr=0.1] 34%|███▍      | 39/115 [14:32<27:10, 21.45s/epoch, loss=1.16, accuracy=0.746, val_loss=2.09, val_accuracy=0.503, lr=0.1] 35%|███▍      | 40/115 [14:53<26:48, 21.44s/epoch, loss=1.15, accuracy=0.749, val_loss=1.8, val_accuracy=0.54, lr=0.0316] 36%|███▌      | 41/115 [15:14<26:02, 21.11s/epoch, loss=1.15, accuracy=0.746, val_loss=2.2, val_accuracy=0.383, lr=0.1]   37%|███▋      | 42/115 [15:35<25:38, 21.08s/epoch, loss=1.15, accuracy=0.745, val_loss=2.08, val_accuracy=0.515, lr=0.1] 37%|███▋      | 43/115 [15:57<25:38, 21.36s/epoch, loss=1.15, accuracy=0.747, val_loss=1.88, val_accuracy=0.535, lr=0.1] 38%|███▊      | 44/115 [16:19<25:37, 21.65s/epoch, loss=1.15, accuracy=0.746, val_loss=1.72, val_accuracy=0.556, lr=0.1] 39%|███▉      | 45/115 [16:41<25:21, 21.74s/epoch, loss=1.15, accuracy=0.746, val_loss=4.23, val_accuracy=0.345, lr=0.0316] 40%|████      | 46/115 [17:03<24:59, 21.73s/epoch, loss=1.15, accuracy=0.751, val_loss=2.01, val_accuracy=0.516, lr=0.1]    41%|████      | 47/115 [17:24<24:39, 21.76s/epoch, loss=1.15, accuracy=0.749, val_loss=1.81, val_accuracy=0.538, lr=0.1] 42%|████▏     | 48/115 [17:45<24:03, 21.55s/epoch, loss=1.16, accuracy=0.748, val_loss=1.74, val_accuracy=0.567, lr=0.1] 43%|████▎     | 49/115 [18:07<23:47, 21.63s/epoch, loss=1.14, accuracy=0.749, val_loss=3.4, val_accuracy=0.249, lr=0.1]  43%|████▎     | 50/115 [18:29<23:35, 21.78s/epoch, loss=1.15, accuracy=0.748, val_loss=1.53, val_accuracy=0.612, lr=0.0316] 44%|████▍     | 51/115 [18:49<22:40, 21.25s/epoch, loss=1.14, accuracy=0.748, val_loss=1.69, val_accuracy=0.565, lr=0.1]    45%|████▌     | 52/115 [19:11<22:24, 21.34s/epoch, loss=1.15, accuracy=0.751, val_loss=1.79, val_accuracy=0.563, lr=0.1] 46%|████▌     | 53/115 [19:32<21:56, 21.23s/epoch, loss=1.15, accuracy=0.748, val_loss=2.22, val_accuracy=0.481, lr=0.1] 47%|████▋     | 54/115 [19:54<21:46, 21.42s/epoch, loss=1.15, accuracy=0.747, val_loss=1.97, val_accuracy=0.507, lr=0.1] 48%|████▊     | 55/115 [20:15<21:27, 21.45s/epoch, loss=1.14, accuracy=0.752, val_loss=2.3, val_accuracy=0.444, lr=0.0316] 49%|████▊     | 56/115 [20:37<21:08, 21.50s/epoch, loss=1.14, accuracy=0.753, val_loss=1.55, val_accuracy=0.639, lr=0.1]   50%|████▉     | 57/115 [20:59<20:58, 21.70s/epoch, loss=1.14, accuracy=0.751, val_loss=1.92, val_accuracy=0.518, lr=0.1] 50%|█████     | 58/115 [21:21<20:34, 21.66s/epoch, loss=1.15, accuracy=0.751, val_loss=2.09, val_accuracy=0.478, lr=0.1] 51%|█████▏    | 59/115 [21:40<19:37, 21.03s/epoch, loss=1.14, accuracy=0.753, val_loss=1.73, val_accuracy=0.558, lr=0.1] 52%|█████▏    | 60/115 [22:02<19:26, 21.22s/epoch, loss=1.14, accuracy=0.752, val_loss=1.95, val_accuracy=0.53, lr=0.0316] 53%|█████▎    | 61/115 [22:24<19:18, 21.46s/epoch, loss=1.14, accuracy=0.75, val_loss=2.15, val_accuracy=0.442, lr=0.1]    54%|█████▍    | 62/115 [22:46<19:02, 21.56s/epoch, loss=1.14, accuracy=0.754, val_loss=1.55, val_accuracy=0.609, lr=0.1] 55%|█████▍    | 63/115 [23:07<18:44, 21.62s/epoch, loss=1.14, accuracy=0.753, val_loss=2.14, val_accuracy=0.512, lr=0.1] 56%|█████▌    | 64/115 [23:28<18:11, 21.41s/epoch, loss=1.15, accuracy=0.751, val_loss=1.54, val_accuracy=0.633, lr=0.1] 57%|█████▋    | 65/115 [23:51<18:03, 21.66s/epoch, loss=1.14, accuracy=0.749, val_loss=2.21, val_accuracy=0.448, lr=0.0316] 57%|█████▋    | 66/115 [24:13<17:45, 21.75s/epoch, loss=1.14, accuracy=0.75, val_loss=1.76, val_accuracy=0.525, lr=0.1]     58%|█████▊    | 67/115 [24:32<16:53, 21.11s/epoch, loss=1.14, accuracy=0.754, val_loss=2.86, val_accuracy=0.31, lr=0.1] 59%|█████▉    | 68/115 [24:54<16:38, 21.24s/epoch, loss=1.14, accuracy=0.753, val_loss=2.24, val_accuracy=0.411, lr=0.1] 60%|██████    | 69/115 [25:13<15:55, 20.78s/epoch, loss=1.14, accuracy=0.754, val_loss=2, val_accuracy=0.506, lr=0.1]    61%|██████    | 70/115 [25:35<15:43, 20.96s/epoch, loss=1.14, accuracy=0.751, val_loss=1.43, val_accuracy=0.639, lr=0.0316] 62%|██████▏   | 71/115 [25:56<15:30, 21.15s/epoch, loss=1.14, accuracy=0.748, val_loss=2.18, val_accuracy=0.403, lr=0.1]    63%|██████▎   | 72/115 [26:18<15:13, 21.23s/epoch, loss=1.13, accuracy=0.755, val_loss=3.37, val_accuracy=0.324, lr=0.1] 63%|██████▎   | 73/115 [26:38<14:44, 21.05s/epoch, loss=1.13, accuracy=0.753, val_loss=2.29, val_accuracy=0.376, lr=0.1] 64%|██████▍   | 74/115 [27:00<14:30, 21.23s/epoch, loss=1.14, accuracy=0.755, val_loss=1.59, val_accuracy=0.602, lr=0.1] 65%|██████▌   | 75/115 [27:22<14:15, 21.40s/epoch, loss=1.13, accuracy=0.757, val_loss=2.66, val_accuracy=0.393, lr=0.0316] 66%|██████▌   | 76/115 [27:44<14:00, 21.55s/epoch, loss=1.14, accuracy=0.753, val_loss=1.85, val_accuracy=0.526, lr=0.1]    67%|██████▋   | 77/115 [28:06<13:43, 21.68s/epoch, loss=1.13, accuracy=0.754, val_loss=2.16, val_accuracy=0.483, lr=0.1] 68%|██████▊   | 78/115 [28:28<13:24, 21.73s/epoch, loss=1.14, accuracy=0.756, val_loss=3.97, val_accuracy=0.355, lr=0.1] 69%|██████▊   | 79/115 [28:50<13:06, 21.84s/epoch, loss=1.13, accuracy=0.757, val_loss=3.26, val_accuracy=0.416, lr=0.1] 70%|██████▉   | 80/115 [29:11<12:38, 21.68s/epoch, loss=1.14, accuracy=0.749, val_loss=1.71, val_accuracy=0.528, lr=0.0316] 70%|███████   | 81/115 [29:31<11:57, 21.10s/epoch, loss=1.14, accuracy=0.754, val_loss=2.16, val_accuracy=0.476, lr=0.1]    71%|███████▏  | 82/115 [29:53<11:50, 21.53s/epoch, loss=0.934, accuracy=0.81, val_loss=0.972, val_accuracy=0.789, lr=0.01] 72%|███████▏  | 83/115 [30:13<11:13, 21.05s/epoch, loss=0.758, accuracy=0.845, val_loss=0.814, val_accuracy=0.809, lr=0.01] 73%|███████▎  | 84/115 [30:36<11:03, 21.41s/epoch, loss=0.677, accuracy=0.852, val_loss=0.755, val_accuracy=0.815, lr=0.01] 74%|███████▍  | 85/115 [30:55<10:29, 20.97s/epoch, loss=0.628, accuracy=0.855, val_loss=0.727, val_accuracy=0.818, lr=0.01] 75%|███████▍  | 86/115 [31:17<10:13, 21.16s/epoch, loss=0.601, accuracy=0.859, val_loss=0.869, val_accuracy=0.759, lr=0.01] 76%|███████▌  | 87/115 [31:37<09:39, 20.71s/epoch, loss=0.585, accuracy=0.859, val_loss=0.799, val_accuracy=0.793, lr=0.01] 77%|███████▋  | 88/115 [31:59<09:32, 21.19s/epoch, loss=0.58, accuracy=0.862, val_loss=0.804, val_accuracy=0.792, lr=0.01]  77%|███████▋  | 89/115 [32:21<09:15, 21.38s/epoch, loss=0.578, accuracy=0.862, val_loss=0.788, val_accuracy=0.787, lr=0.01] 78%|███████▊  | 90/115 [32:43<09:02, 21.68s/epoch, loss=0.572, accuracy=0.863, val_loss=1.06, val_accuracy=0.729, lr=0.00316] 79%|███████▉  | 91/115 [33:05<08:39, 21.66s/epoch, loss=0.57, accuracy=0.863, val_loss=1.11, val_accuracy=0.718, lr=0.01]     80%|████████  | 92/115 [33:27<08:18, 21.67s/epoch, loss=0.569, accuracy=0.868, val_loss=0.771, val_accuracy=0.801, lr=0.01] 81%|████████  | 93/115 [33:48<07:57, 21.70s/epoch, loss=0.566, accuracy=0.867, val_loss=0.836, val_accuracy=0.796, lr=0.01] 82%|████████▏ | 94/115 [34:10<07:37, 21.76s/epoch, loss=0.562, accuracy=0.87, val_loss=0.83, val_accuracy=0.799, lr=0.01]   83%|████████▎ | 95/115 [34:32<07:12, 21.62s/epoch, loss=0.566, accuracy=0.869, val_loss=0.979, val_accuracy=0.742, lr=0.00316] 83%|████████▎ | 96/115 [34:53<06:50, 21.60s/epoch, loss=0.568, accuracy=0.87, val_loss=0.868, val_accuracy=0.784, lr=0.01]     84%|████████▍ | 97/115 [35:15<06:31, 21.72s/epoch, loss=0.561, accuracy=0.873, val_loss=0.88, val_accuracy=0.774, lr=0.01] 85%|████████▌ | 98/115 [35:37<06:09, 21.73s/epoch, loss=0.562, accuracy=0.874, val_loss=1.06, val_accuracy=0.738, lr=0.01] 86%|████████▌ | 99/115 [35:59<05:47, 21.73s/epoch, loss=0.565, accuracy=0.872, val_loss=0.883, val_accuracy=0.775, lr=0.01] 87%|████████▋ | 100/115 [36:19<05:17, 21.20s/epoch, loss=0.56, accuracy=0.875, val_loss=1.01, val_accuracy=0.737, lr=0.00316] 88%|████████▊ | 101/115 [36:40<04:57, 21.23s/epoch, loss=0.56, accuracy=0.876, val_loss=0.778, val_accuracy=0.813, lr=0.01]   89%|████████▊ | 102/115 [37:01<04:35, 21.20s/epoch, loss=0.56, accuracy=0.876, val_loss=0.861, val_accuracy=0.796, lr=0.01] 90%|████████▉ | 103/115 [37:23<04:16, 21.36s/epoch, loss=0.566, accuracy=0.876, val_loss=0.885, val_accuracy=0.789, lr=0.01] 90%|█████████ | 104/115 [37:44<03:55, 21.41s/epoch, loss=0.56, accuracy=0.878, val_loss=0.766, val_accuracy=0.815, lr=0.01]  91%|█████████▏| 105/115 [38:06<03:35, 21.50s/epoch, loss=0.558, accuracy=0.877, val_loss=0.779, val_accuracy=0.805, lr=0.00316] 92%|█████████▏| 106/115 [38:28<03:14, 21.61s/epoch, loss=0.559, accuracy=0.879, val_loss=0.768, val_accuracy=0.812, lr=0.01]    93%|█████████▎| 107/115 [38:49<02:51, 21.47s/epoch, loss=0.558, accuracy=0.879, val_loss=0.744, val_accuracy=0.821, lr=0.01] 94%|█████████▍| 108/115 [39:08<02:25, 20.84s/epoch, loss=0.559, accuracy=0.881, val_loss=0.927, val_accuracy=0.769, lr=0.01] 95%|█████████▍| 109/115 [39:29<02:04, 20.79s/epoch, loss=0.558, accuracy=0.881, val_loss=0.813, val_accuracy=0.807, lr=0.01] 96%|█████████▌| 110/115 [39:51<01:45, 21.09s/epoch, loss=0.56, accuracy=0.881, val_loss=0.938, val_accuracy=0.779, lr=0.00316] 97%|█████████▋| 111/115 [40:13<01:25, 21.28s/epoch, loss=0.557, accuracy=0.879, val_loss=0.965, val_accuracy=0.76, lr=0.01]    97%|█████████▋| 112/115 [40:32<01:02, 20.77s/epoch, loss=0.561, accuracy=0.881, val_loss=0.85, val_accuracy=0.789, lr=0.01] 98%|█████████▊| 113/115 [40:54<00:42, 21.07s/epoch, loss=0.557, accuracy=0.884, val_loss=0.878, val_accuracy=0.788, lr=0.01] 99%|█████████▉| 114/115 [41:16<00:21, 21.28s/epoch, loss=0.553, accuracy=0.885, val_loss=0.914, val_accuracy=0.79, lr=0.01] 100%|██████████| 115/115 [41:36<00:00, 21.10s/epoch, loss=0.557, accuracy=0.882, val_loss=0.875, val_accuracy=0.789, lr=0.00316]100%|██████████| 115/115 [41:36<00:00, 21.71s/epoch, loss=0.557, accuracy=0.882, val_loss=0.875, val_accuracy=0.789, lr=0.00316]
Using real-time data augmentation.
Test score: 0.7465412616729736
Test accuracy: 0.8190000057220459


* * * Run SGD for ID = 13_6. * * *


2024-02-19 22:36:06.416093: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 22:36:09.176696: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-19 22:36:09.177656: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-19 22:36:09.216204: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-19 22:36:09.216239: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 22:36:09.219161: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-19 22:36:09.219209: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-19 22:36:09.221494: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-19 22:36:09.222202: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-19 22:36:09.224585: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-19 22:36:09.226101: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-19 22:36:09.230904: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-19 22:36:09.231424: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-19 22:36:09.231520: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-19 22:36:10.679735: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-19 22:36:10.680826: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-19 22:36:10.681814: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-19 22:36:10.681851: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 22:36:10.681886: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-19 22:36:10.681905: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-19 22:36:10.681924: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-19 22:36:10.681941: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-19 22:36:10.681959: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-19 22:36:10.681976: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-19 22:36:10.681994: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-19 22:36:10.682462: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-19 22:36:10.682498: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 22:36:11.333335: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-19 22:36:11.333404: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-19 22:36:11.333420: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-19 22:36:11.334488: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:83:00.0, compute capability: 6.1)
{'id': '13_06', 'batch_size': 128, 'epochs': 115, 'validation_split': 0.1, 'checkpointing': True, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
x_train shape: (45000, 32, 32, 3)
45000 train samples
5000 validation samples
10000 test samples
y_train shape: (45000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/115 [00:00<?, ?epoch/s]2024-02-19 22:36:12.189925: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-19 22:36:12.202296: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199825000 Hz
2024-02-19 22:36:14.364824: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-19 22:36:14.605579: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-19 22:36:15.366542: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-19 22:36:15.420197: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/115 [00:57<1:49:41, 57.73s/epoch, loss=3.91, accuracy=0.252, val_loss=2.63, val_accuracy=0.182, lr=0.1]  2%|▏         | 2/115 [01:19<1:08:36, 36.43s/epoch, loss=1.78, accuracy=0.431, val_loss=2.55, val_accuracy=0.235, lr=0.1]  3%|▎         | 3/115 [01:41<55:43, 29.85s/epoch, loss=1.55, accuracy=0.523, val_loss=2.06, val_accuracy=0.391, lr=0.1]    3%|▎         | 4/115 [02:02<48:39, 26.30s/epoch, loss=1.42, accuracy=0.599, val_loss=2.49, val_accuracy=0.317, lr=0.1]  4%|▍         | 5/115 [02:24<45:31, 24.83s/epoch, loss=1.34, accuracy=0.655, val_loss=1.98, val_accuracy=0.506, lr=0.1]  5%|▌         | 6/115 [02:46<43:08, 23.75s/epoch, loss=1.27, accuracy=0.692, val_loss=1.92, val_accuracy=0.523, lr=0.1]  6%|▌         | 7/115 [03:07<41:33, 23.08s/epoch, loss=1.26, accuracy=0.705, val_loss=1.61, val_accuracy=0.59, lr=0.1]   7%|▋         | 8/115 [03:29<40:09, 22.52s/epoch, loss=1.25, accuracy=0.716, val_loss=1.99, val_accuracy=0.493, lr=0.1]  8%|▊         | 9/115 [03:50<39:16, 22.23s/epoch, loss=1.24, accuracy=0.717, val_loss=1.91, val_accuracy=0.499, lr=0.1]  9%|▊         | 10/115 [04:12<38:29, 21.99s/epoch, loss=1.23, accuracy=0.726, val_loss=2.07, val_accuracy=0.55, lr=0.1] 10%|▉         | 11/115 [04:33<37:52, 21.86s/epoch, loss=1.22, accuracy=0.729, val_loss=2.54, val_accuracy=0.349, lr=0.1] 10%|█         | 12/115 [04:53<36:43, 21.39s/epoch, loss=1.23, accuracy=0.728, val_loss=2.27, val_accuracy=0.429, lr=0.0316] 11%|█▏        | 13/115 [05:13<35:21, 20.80s/epoch, loss=1.22, accuracy=0.732, val_loss=2.16, val_accuracy=0.449, lr=0.1]    12%|█▏        | 14/115 [05:34<35:23, 21.03s/epoch, loss=1.21, accuracy=0.736, val_loss=2.21, val_accuracy=0.458, lr=0.1] 13%|█▎        | 15/115 [05:56<35:31, 21.31s/epoch, loss=1.21, accuracy=0.734, val_loss=1.52, val_accuracy=0.638, lr=0.1] 14%|█▍        | 16/115 [06:18<35:05, 21.26s/epoch, loss=1.2, accuracy=0.736, val_loss=2.47, val_accuracy=0.454, lr=0.1]  15%|█▍        | 17/115 [06:39<34:58, 21.41s/epoch, loss=1.21, accuracy=0.736, val_loss=1.88, val_accuracy=0.536, lr=0.1] 16%|█▌        | 18/115 [07:01<34:41, 21.46s/epoch, loss=1.21, accuracy=0.738, val_loss=1.97, val_accuracy=0.522, lr=0.1] 17%|█▋        | 19/115 [07:21<33:49, 21.14s/epoch, loss=1.19, accuracy=0.739, val_loss=1.54, val_accuracy=0.608, lr=0.1] 17%|█▋        | 20/115 [07:42<33:22, 21.08s/epoch, loss=1.2, accuracy=0.74, val_loss=1.49, val_accuracy=0.655, lr=0.1]   18%|█▊        | 21/115 [08:04<33:10, 21.17s/epoch, loss=1.19, accuracy=0.741, val_loss=2.2, val_accuracy=0.503, lr=0.1] 19%|█▉        | 22/115 [08:24<32:21, 20.87s/epoch, loss=1.2, accuracy=0.742, val_loss=2.46, val_accuracy=0.499, lr=0.1] 20%|██        | 23/115 [08:45<32:18, 21.07s/epoch, loss=1.19, accuracy=0.743, val_loss=1.75, val_accuracy=0.562, lr=0.1] 21%|██        | 24/115 [09:06<31:53, 21.03s/epoch, loss=1.19, accuracy=0.746, val_loss=2.64, val_accuracy=0.391, lr=0.1] 22%|██▏       | 25/115 [09:28<31:41, 21.13s/epoch, loss=1.19, accuracy=0.745, val_loss=1.88, val_accuracy=0.487, lr=0.0316] 23%|██▎       | 26/115 [09:47<30:34, 20.61s/epoch, loss=1.18, accuracy=0.746, val_loss=2.6, val_accuracy=0.363, lr=0.1]     23%|██▎       | 27/115 [10:08<30:29, 20.79s/epoch, loss=1.18, accuracy=0.745, val_loss=2.54, val_accuracy=0.438, lr=0.1] 24%|██▍       | 28/115 [10:30<30:30, 21.04s/epoch, loss=1.19, accuracy=0.747, val_loss=2.48, val_accuracy=0.432, lr=0.1] 25%|██▌       | 29/115 [10:50<29:40, 20.71s/epoch, loss=1.17, accuracy=0.747, val_loss=1.98, val_accuracy=0.507, lr=0.1] 26%|██▌       | 30/115 [11:11<29:45, 21.01s/epoch, loss=1.18, accuracy=0.747, val_loss=1.67, val_accuracy=0.627, lr=0.0316] 27%|██▋       | 31/115 [11:33<29:43, 21.23s/epoch, loss=1.17, accuracy=0.748, val_loss=1.6, val_accuracy=0.602, lr=0.1]     28%|██▊       | 32/115 [11:53<28:36, 20.68s/epoch, loss=1.17, accuracy=0.748, val_loss=2.36, val_accuracy=0.459, lr=0.1] 29%|██▊       | 33/115 [12:14<28:32, 20.89s/epoch, loss=1.16, accuracy=0.749, val_loss=2.08, val_accuracy=0.453, lr=0.1] 30%|██▉       | 34/115 [12:36<28:29, 21.11s/epoch, loss=1.16, accuracy=0.751, val_loss=1.89, val_accuracy=0.484, lr=0.1] 30%|███       | 35/115 [12:55<27:26, 20.58s/epoch, loss=1.16, accuracy=0.751, val_loss=2.09, val_accuracy=0.46, lr=0.0316] 31%|███▏      | 36/115 [13:15<26:51, 20.40s/epoch, loss=1.17, accuracy=0.749, val_loss=1.99, val_accuracy=0.465, lr=0.1]   32%|███▏      | 37/115 [13:36<26:56, 20.73s/epoch, loss=1.17, accuracy=0.751, val_loss=2.3, val_accuracy=0.424, lr=0.1]  33%|███▎      | 38/115 [13:58<27:01, 21.06s/epoch, loss=1.16, accuracy=0.752, val_loss=2.14, val_accuracy=0.496, lr=0.1] 34%|███▍      | 39/115 [14:19<26:42, 21.08s/epoch, loss=1.16, accuracy=0.75, val_loss=1.78, val_accuracy=0.56, lr=0.1]   35%|███▍      | 40/115 [14:41<26:33, 21.24s/epoch, loss=1.16, accuracy=0.749, val_loss=1.62, val_accuracy=0.627, lr=0.0316] 36%|███▌      | 41/115 [15:02<26:12, 21.26s/epoch, loss=1.16, accuracy=0.751, val_loss=3.12, val_accuracy=0.383, lr=0.1]    37%|███▋      | 42/115 [15:23<25:44, 21.16s/epoch, loss=1.16, accuracy=0.753, val_loss=3.01, val_accuracy=0.389, lr=0.1] 37%|███▋      | 43/115 [15:45<25:34, 21.32s/epoch, loss=1.16, accuracy=0.75, val_loss=2.24, val_accuracy=0.454, lr=0.1]  38%|███▊      | 44/115 [16:06<25:17, 21.37s/epoch, loss=1.16, accuracy=0.75, val_loss=2.08, val_accuracy=0.477, lr=0.1] 39%|███▉      | 45/115 [16:28<25:00, 21.43s/epoch, loss=1.16, accuracy=0.752, val_loss=1.83, val_accuracy=0.555, lr=0.0316] 40%|████      | 46/115 [16:50<24:46, 21.55s/epoch, loss=1.17, accuracy=0.75, val_loss=1.69, val_accuracy=0.587, lr=0.1]     41%|████      | 47/115 [17:12<24:30, 21.62s/epoch, loss=1.16, accuracy=0.748, val_loss=1.87, val_accuracy=0.541, lr=0.1] 42%|████▏     | 48/115 [17:33<24:07, 21.61s/epoch, loss=1.15, accuracy=0.751, val_loss=2.88, val_accuracy=0.413, lr=0.1] 43%|████▎     | 49/115 [17:54<23:39, 21.51s/epoch, loss=1.16, accuracy=0.754, val_loss=1.55, val_accuracy=0.617, lr=0.1] 43%|████▎     | 50/115 [18:16<23:23, 21.60s/epoch, loss=1.15, accuracy=0.754, val_loss=2.82, val_accuracy=0.345, lr=0.0316] 44%|████▍     | 51/115 [18:38<22:59, 21.55s/epoch, loss=1.16, accuracy=0.754, val_loss=1.68, val_accuracy=0.581, lr=0.1]    45%|████▌     | 52/115 [18:59<22:41, 21.60s/epoch, loss=1.16, accuracy=0.753, val_loss=2.3, val_accuracy=0.44, lr=0.1]   46%|████▌     | 53/115 [19:21<22:19, 21.60s/epoch, loss=1.15, accuracy=0.754, val_loss=2.44, val_accuracy=0.365, lr=0.1] 47%|████▋     | 54/115 [19:42<21:45, 21.40s/epoch, loss=1.16, accuracy=0.751, val_loss=1.77, val_accuracy=0.554, lr=0.1] 48%|████▊     | 55/115 [20:04<21:28, 21.48s/epoch, loss=1.15, accuracy=0.752, val_loss=1.56, val_accuracy=0.619, lr=0.0316] 49%|████▊     | 56/115 [20:25<21:08, 21.50s/epoch, loss=1.15, accuracy=0.753, val_loss=1.81, val_accuracy=0.551, lr=0.1]    50%|████▉     | 57/115 [20:47<20:57, 21.68s/epoch, loss=1.14, accuracy=0.757, val_loss=1.75, val_accuracy=0.578, lr=0.1] 50%|█████     | 58/115 [21:09<20:39, 21.75s/epoch, loss=1.15, accuracy=0.754, val_loss=1.92, val_accuracy=0.522, lr=0.1] 51%|█████▏    | 59/115 [21:31<20:15, 21.71s/epoch, loss=1.15, accuracy=0.754, val_loss=2.2, val_accuracy=0.435, lr=0.1]  52%|█████▏    | 60/115 [21:50<19:19, 21.08s/epoch, loss=1.16, accuracy=0.752, val_loss=1.89, val_accuracy=0.516, lr=0.0316] 53%|█████▎    | 61/115 [22:12<19:07, 21.25s/epoch, loss=1.15, accuracy=0.754, val_loss=1.66, val_accuracy=0.597, lr=0.1]    54%|█████▍    | 62/115 [22:33<18:45, 21.24s/epoch, loss=1.15, accuracy=0.754, val_loss=5.25, val_accuracy=0.301, lr=0.1] 55%|█████▍    | 63/115 [22:55<18:29, 21.33s/epoch, loss=1.14, accuracy=0.755, val_loss=1.54, val_accuracy=0.611, lr=0.1] 56%|█████▌    | 64/115 [23:16<18:03, 21.24s/epoch, loss=1.15, accuracy=0.753, val_loss=1.44, val_accuracy=0.654, lr=0.1] 57%|█████▋    | 65/115 [23:38<17:50, 21.42s/epoch, loss=1.15, accuracy=0.755, val_loss=1.7, val_accuracy=0.593, lr=0.1]  57%|█████▋    | 66/115 [23:58<17:17, 21.17s/epoch, loss=1.15, accuracy=0.754, val_loss=1.75, val_accuracy=0.554, lr=0.1] 58%|█████▊    | 67/115 [24:19<16:44, 20.93s/epoch, loss=1.14, accuracy=0.754, val_loss=1.86, val_accuracy=0.514, lr=0.1] 59%|█████▉    | 68/115 [24:40<16:33, 21.15s/epoch, loss=1.14, accuracy=0.754, val_loss=1.51, val_accuracy=0.639, lr=0.1] 60%|██████    | 69/115 [25:02<16:21, 21.33s/epoch, loss=1.14, accuracy=0.754, val_loss=1.88, val_accuracy=0.533, lr=0.0316] 61%|██████    | 70/115 [25:24<16:04, 21.43s/epoch, loss=1.14, accuracy=0.755, val_loss=2.59, val_accuracy=0.481, lr=0.1]    62%|██████▏   | 71/115 [25:43<15:17, 20.85s/epoch, loss=1.14, accuracy=0.753, val_loss=1.82, val_accuracy=0.547, lr=0.1] 63%|██████▎   | 72/115 [26:04<15:00, 20.95s/epoch, loss=1.14, accuracy=0.759, val_loss=1.92, val_accuracy=0.564, lr=0.1] 63%|██████▎   | 73/115 [26:25<14:39, 20.94s/epoch, loss=1.14, accuracy=0.757, val_loss=1.8, val_accuracy=0.553, lr=0.1]  64%|██████▍   | 74/115 [26:46<14:11, 20.77s/epoch, loss=1.14, accuracy=0.757, val_loss=2.3, val_accuracy=0.451, lr=0.0316] 65%|██████▌   | 75/115 [27:07<13:57, 20.95s/epoch, loss=1.13, accuracy=0.757, val_loss=2.52, val_accuracy=0.467, lr=0.1]   66%|██████▌   | 76/115 [27:27<13:28, 20.73s/epoch, loss=1.13, accuracy=0.758, val_loss=2.93, val_accuracy=0.414, lr=0.1] 67%|██████▋   | 77/115 [27:49<13:15, 20.93s/epoch, loss=1.14, accuracy=0.756, val_loss=1.8, val_accuracy=0.546, lr=0.1]  68%|██████▊   | 78/115 [28:10<13:03, 21.18s/epoch, loss=1.14, accuracy=0.755, val_loss=1.48, val_accuracy=0.632, lr=0.1] 69%|██████▊   | 79/115 [28:30<12:26, 20.74s/epoch, loss=1.14, accuracy=0.756, val_loss=2.29, val_accuracy=0.455, lr=0.0316] 70%|██████▉   | 80/115 [28:51<12:03, 20.68s/epoch, loss=1.14, accuracy=0.759, val_loss=1.88, val_accuracy=0.502, lr=0.1]    70%|███████   | 81/115 [29:12<11:46, 20.77s/epoch, loss=1.15, accuracy=0.754, val_loss=1.97, val_accuracy=0.494, lr=0.1] 71%|███████▏  | 82/115 [29:34<11:38, 21.16s/epoch, loss=0.933, accuracy=0.816, val_loss=1.03, val_accuracy=0.755, lr=0.01] 72%|███████▏  | 83/115 [29:56<11:23, 21.35s/epoch, loss=0.761, accuracy=0.847, val_loss=0.811, val_accuracy=0.815, lr=0.01] 73%|███████▎  | 84/115 [30:16<10:49, 20.96s/epoch, loss=0.677, accuracy=0.855, val_loss=0.78, val_accuracy=0.806, lr=0.01]  74%|███████▍  | 85/115 [30:37<10:34, 21.16s/epoch, loss=0.62, accuracy=0.863, val_loss=0.818, val_accuracy=0.786, lr=0.01] 75%|███████▍  | 86/115 [30:59<10:16, 21.27s/epoch, loss=0.595, accuracy=0.861, val_loss=0.909, val_accuracy=0.756, lr=0.01] 76%|███████▌  | 87/115 [31:21<09:59, 21.43s/epoch, loss=0.578, accuracy=0.864, val_loss=0.679, val_accuracy=0.833, lr=0.01] 77%|███████▋  | 88/115 [31:42<09:35, 21.30s/epoch, loss=0.574, accuracy=0.864, val_loss=0.698, val_accuracy=0.828, lr=0.01] 77%|███████▋  | 89/115 [32:03<09:16, 21.41s/epoch, loss=0.57, accuracy=0.865, val_loss=0.849, val_accuracy=0.778, lr=0.01]  78%|███████▊  | 90/115 [32:23<08:40, 20.82s/epoch, loss=0.564, accuracy=0.869, val_loss=0.756, val_accuracy=0.803, lr=0.01] 79%|███████▉  | 91/115 [32:44<08:24, 21.03s/epoch, loss=0.566, accuracy=0.868, val_loss=0.709, val_accuracy=0.813, lr=0.01] 80%|████████  | 92/115 [33:06<08:06, 21.17s/epoch, loss=0.56, accuracy=0.87, val_loss=1.1, val_accuracy=0.694, lr=0.00316]  81%|████████  | 93/115 [33:27<07:48, 21.31s/epoch, loss=0.56, accuracy=0.871, val_loss=0.896, val_accuracy=0.765, lr=0.01] 82%|████████▏ | 94/115 [33:48<07:20, 20.99s/epoch, loss=0.558, accuracy=0.873, val_loss=0.79, val_accuracy=0.802, lr=0.01] 83%|████████▎ | 95/115 [34:08<06:56, 20.85s/epoch, loss=0.562, accuracy=0.871, val_loss=0.864, val_accuracy=0.778, lr=0.01] 83%|████████▎ | 96/115 [34:30<06:41, 21.12s/epoch, loss=0.555, accuracy=0.877, val_loss=0.821, val_accuracy=0.797, lr=0.01] 84%|████████▍ | 97/115 [34:50<06:14, 20.82s/epoch, loss=0.558, accuracy=0.875, val_loss=0.798, val_accuracy=0.796, lr=0.00316] 85%|████████▌ | 98/115 [35:11<05:54, 20.87s/epoch, loss=0.554, accuracy=0.876, val_loss=0.863, val_accuracy=0.777, lr=0.01]    86%|████████▌ | 99/115 [35:33<05:39, 21.19s/epoch, loss=0.557, accuracy=0.879, val_loss=0.915, val_accuracy=0.759, lr=0.01] 87%|████████▋ | 100/115 [35:55<05:20, 21.37s/epoch, loss=0.555, accuracy=0.879, val_loss=0.914, val_accuracy=0.763, lr=0.01] 88%|████████▊ | 101/115 [36:14<04:51, 20.80s/epoch, loss=0.557, accuracy=0.877, val_loss=0.75, val_accuracy=0.81, lr=0.01]   89%|████████▊ | 102/115 [36:35<04:30, 20.82s/epoch, loss=0.551, accuracy=0.882, val_loss=0.778, val_accuracy=0.814, lr=0.00316] 90%|████████▉ | 103/115 [36:57<04:13, 21.09s/epoch, loss=0.554, accuracy=0.882, val_loss=0.943, val_accuracy=0.759, lr=0.01]    90%|█████████ | 104/115 [37:17<03:50, 20.92s/epoch, loss=0.553, accuracy=0.88, val_loss=0.998, val_accuracy=0.757, lr=0.01]  91%|█████████▏| 105/115 [37:39<03:32, 21.29s/epoch, loss=0.554, accuracy=0.882, val_loss=0.706, val_accuracy=0.83, lr=0.01] 92%|█████████▏| 106/115 [38:02<03:13, 21.55s/epoch, loss=0.553, accuracy=0.882, val_loss=0.844, val_accuracy=0.786, lr=0.01] 93%|█████████▎| 107/115 [38:23<02:52, 21.51s/epoch, loss=0.556, accuracy=0.881, val_loss=0.823, val_accuracy=0.809, lr=0.00316] 94%|█████████▍| 108/115 [38:45<02:30, 21.56s/epoch, loss=0.556, accuracy=0.882, val_loss=0.799, val_accuracy=0.808, lr=0.01]    95%|█████████▍| 109/115 [39:06<02:09, 21.59s/epoch, loss=0.556, accuracy=0.882, val_loss=1.09, val_accuracy=0.733, lr=0.01]  96%|█████████▌| 110/115 [39:28<01:48, 21.65s/epoch, loss=0.559, accuracy=0.882, val_loss=0.802, val_accuracy=0.802, lr=0.01] 97%|█████████▋| 111/115 [39:49<01:25, 21.28s/epoch, loss=0.556, accuracy=0.881, val_loss=0.858, val_accuracy=0.795, lr=0.01] 97%|█████████▋| 112/115 [40:08<01:02, 20.87s/epoch, loss=0.552, accuracy=0.885, val_loss=0.698, val_accuracy=0.832, lr=0.00316] 98%|█████████▊| 113/115 [40:30<00:41, 20.99s/epoch, loss=0.556, accuracy=0.884, val_loss=0.734, val_accuracy=0.826, lr=0.01]    99%|█████████▉| 114/115 [40:51<00:21, 21.20s/epoch, loss=0.55, accuracy=0.887, val_loss=0.898, val_accuracy=0.783, lr=0.01] 100%|██████████| 115/115 [41:13<00:00, 21.39s/epoch, loss=0.555, accuracy=0.883, val_loss=0.785, val_accuracy=0.817, lr=0.01]100%|██████████| 115/115 [41:13<00:00, 21.51s/epoch, loss=0.555, accuracy=0.883, val_loss=0.785, val_accuracy=0.817, lr=0.01]
Using real-time data augmentation.
Test score: 0.6852937936782837
Test accuracy: 0.8306000232696533


* * * Run SGD for ID = 13_7. * * *


2024-02-19 23:17:33.058532: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 23:17:35.944002: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-19 23:17:35.944996: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-19 23:17:35.984737: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-19 23:17:35.984774: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 23:17:35.987825: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-19 23:17:35.987870: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-19 23:17:35.990296: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-19 23:17:35.990962: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-19 23:17:35.993526: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-19 23:17:35.995123: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-19 23:17:36.000101: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-19 23:17:36.000673: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-19 23:17:36.000751: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-19 23:17:37.601720: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-19 23:17:37.603215: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-19 23:17:37.603833: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-19 23:17:37.603874: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 23:17:37.603911: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-19 23:17:37.603929: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-19 23:17:37.603946: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-19 23:17:37.603961: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-19 23:17:37.603978: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-19 23:17:37.603994: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-19 23:17:37.604010: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-19 23:17:37.604534: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-19 23:17:37.604568: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 23:17:38.285699: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-19 23:17:38.285770: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-19 23:17:38.285781: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-19 23:17:38.286801: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:83:00.0, compute capability: 6.1)
{'id': '13_07', 'batch_size': 128, 'epochs': 115, 'validation_split': 0.1, 'checkpointing': True, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
x_train shape: (45000, 32, 32, 3)
45000 train samples
5000 validation samples
10000 test samples
y_train shape: (45000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/115 [00:00<?, ?epoch/s]2024-02-19 23:17:39.184997: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-19 23:17:39.197185: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199825000 Hz
2024-02-19 23:17:41.391315: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-19 23:17:41.621311: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-19 23:17:42.362134: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-19 23:17:42.414281: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/115 [01:00<1:54:54, 60.48s/epoch, loss=3.64, accuracy=0.269, val_loss=2.5, val_accuracy=0.201, lr=0.1]  2%|▏         | 2/115 [01:21<1:10:23, 37.37s/epoch, loss=1.75, accuracy=0.445, val_loss=1.94, val_accuracy=0.38, lr=0.1]  3%|▎         | 3/115 [01:43<56:19, 30.17s/epoch, loss=1.5, accuracy=0.55, val_loss=2.59, val_accuracy=0.394, lr=0.1]     3%|▎         | 4/115 [02:02<47:54, 25.89s/epoch, loss=1.35, accuracy=0.642, val_loss=2.95, val_accuracy=0.318, lr=0.1]  4%|▍         | 5/115 [02:22<43:21, 23.65s/epoch, loss=1.29, accuracy=0.674, val_loss=2.49, val_accuracy=0.345, lr=0.1]  5%|▌         | 6/115 [02:42<41:00, 22.58s/epoch, loss=1.27, accuracy=0.693, val_loss=1.99, val_accuracy=0.501, lr=0.1]  6%|▌         | 7/115 [03:03<39:29, 21.94s/epoch, loss=1.26, accuracy=0.705, val_loss=1.52, val_accuracy=0.622, lr=0.1]  7%|▋         | 8/115 [03:24<38:37, 21.66s/epoch, loss=1.25, accuracy=0.707, val_loss=2.46, val_accuracy=0.499, lr=0.1]  8%|▊         | 9/115 [03:45<38:04, 21.55s/epoch, loss=1.24, accuracy=0.711, val_loss=1.78, val_accuracy=0.513, lr=0.1]  9%|▊         | 10/115 [04:06<37:31, 21.44s/epoch, loss=1.22, accuracy=0.72, val_loss=2.79, val_accuracy=0.369, lr=0.1] 10%|▉         | 11/115 [04:27<36:41, 21.17s/epoch, loss=1.23, accuracy=0.72, val_loss=3.09, val_accuracy=0.398, lr=0.1] 10%|█         | 12/115 [04:48<36:15, 21.12s/epoch, loss=1.21, accuracy=0.726, val_loss=1.71, val_accuracy=0.587, lr=0.0316] 11%|█▏        | 13/115 [05:10<36:15, 21.33s/epoch, loss=1.21, accuracy=0.729, val_loss=1.47, val_accuracy=0.623, lr=0.1]    12%|█▏        | 14/115 [05:31<35:42, 21.21s/epoch, loss=1.21, accuracy=0.728, val_loss=2.48, val_accuracy=0.404, lr=0.1] 13%|█▎        | 15/115 [05:51<34:54, 20.95s/epoch, loss=1.21, accuracy=0.733, val_loss=1.65, val_accuracy=0.553, lr=0.1] 14%|█▍        | 16/115 [06:12<34:39, 21.00s/epoch, loss=1.21, accuracy=0.734, val_loss=1.73, val_accuracy=0.59, lr=0.1]  15%|█▍        | 17/115 [06:33<34:17, 21.00s/epoch, loss=1.2, accuracy=0.735, val_loss=1.96, val_accuracy=0.581, lr=0.1] 16%|█▌        | 18/115 [06:54<34:03, 21.06s/epoch, loss=1.21, accuracy=0.734, val_loss=1.57, val_accuracy=0.619, lr=0.0316] 17%|█▋        | 19/115 [07:14<32:45, 20.48s/epoch, loss=1.21, accuracy=0.734, val_loss=1.83, val_accuracy=0.522, lr=0.1]    17%|█▋        | 20/115 [07:34<32:33, 20.56s/epoch, loss=1.2, accuracy=0.739, val_loss=1.45, val_accuracy=0.653, lr=0.1]  18%|█▊        | 21/115 [07:53<31:28, 20.09s/epoch, loss=1.2, accuracy=0.737, val_loss=2.43, val_accuracy=0.315, lr=0.1] 19%|█▉        | 22/115 [08:14<31:37, 20.40s/epoch, loss=1.19, accuracy=0.739, val_loss=1.97, val_accuracy=0.444, lr=0.1] 20%|██        | 23/115 [08:36<31:42, 20.67s/epoch, loss=1.19, accuracy=0.738, val_loss=1.71, val_accuracy=0.534, lr=0.1] 21%|██        | 24/115 [08:57<31:28, 20.75s/epoch, loss=1.19, accuracy=0.739, val_loss=1.5, val_accuracy=0.645, lr=0.1]  22%|██▏       | 25/115 [09:17<30:55, 20.62s/epoch, loss=1.19, accuracy=0.742, val_loss=1.78, val_accuracy=0.527, lr=0.0316] 23%|██▎       | 26/115 [09:37<30:12, 20.36s/epoch, loss=1.19, accuracy=0.742, val_loss=2.31, val_accuracy=0.38, lr=0.1]     23%|██▎       | 27/115 [09:58<30:06, 20.53s/epoch, loss=1.19, accuracy=0.742, val_loss=3.9, val_accuracy=0.256, lr=0.1] 24%|██▍       | 28/115 [10:19<30:17, 20.89s/epoch, loss=1.18, accuracy=0.742, val_loss=2.61, val_accuracy=0.37, lr=0.1] 25%|██▌       | 29/115 [10:40<29:45, 20.76s/epoch, loss=1.18, accuracy=0.744, val_loss=1.74, val_accuracy=0.619, lr=0.1] 26%|██▌       | 30/115 [11:01<29:28, 20.81s/epoch, loss=1.18, accuracy=0.745, val_loss=2, val_accuracy=0.49, lr=0.0316]  27%|██▋       | 31/115 [11:21<28:57, 20.69s/epoch, loss=1.18, accuracy=0.743, val_loss=1.77, val_accuracy=0.572, lr=0.1] 28%|██▊       | 32/115 [11:41<28:12, 20.39s/epoch, loss=1.19, accuracy=0.744, val_loss=1.96, val_accuracy=0.511, lr=0.1] 29%|██▊       | 33/115 [12:03<28:22, 20.76s/epoch, loss=1.19, accuracy=0.742, val_loss=1.6, val_accuracy=0.607, lr=0.1]  30%|██▉       | 34/115 [12:22<27:36, 20.45s/epoch, loss=1.17, accuracy=0.743, val_loss=1.62, val_accuracy=0.596, lr=0.1] 30%|███       | 35/115 [12:43<27:34, 20.68s/epoch, loss=1.18, accuracy=0.744, val_loss=1.81, val_accuracy=0.525, lr=0.0316] 31%|███▏      | 36/115 [13:05<27:31, 20.91s/epoch, loss=1.17, accuracy=0.748, val_loss=2.08, val_accuracy=0.544, lr=0.1]    32%|███▏      | 37/115 [13:26<27:23, 21.07s/epoch, loss=1.17, accuracy=0.744, val_loss=1.72, val_accuracy=0.552, lr=0.1] 33%|███▎      | 38/115 [13:47<26:45, 20.86s/epoch, loss=1.17, accuracy=0.748, val_loss=1.56, val_accuracy=0.621, lr=0.1] 34%|███▍      | 39/115 [14:07<26:23, 20.84s/epoch, loss=1.17, accuracy=0.745, val_loss=2, val_accuracy=0.515, lr=0.1]    35%|███▍      | 40/115 [14:29<26:12, 20.97s/epoch, loss=1.16, accuracy=0.746, val_loss=2.36, val_accuracy=0.463, lr=0.0316] 36%|███▌      | 41/115 [14:48<25:10, 20.42s/epoch, loss=1.17, accuracy=0.745, val_loss=1.54, val_accuracy=0.628, lr=0.1]    37%|███▋      | 42/115 [15:09<25:10, 20.69s/epoch, loss=1.16, accuracy=0.748, val_loss=1.91, val_accuracy=0.538, lr=0.1] 37%|███▋      | 43/115 [15:31<25:02, 20.87s/epoch, loss=1.16, accuracy=0.749, val_loss=2.49, val_accuracy=0.437, lr=0.1] 38%|███▊      | 44/115 [15:52<24:57, 21.09s/epoch, loss=1.16, accuracy=0.748, val_loss=1.88, val_accuracy=0.55, lr=0.1]  39%|███▉      | 45/115 [16:13<24:27, 20.97s/epoch, loss=1.17, accuracy=0.75, val_loss=2.06, val_accuracy=0.44, lr=0.0316] 40%|████      | 46/115 [16:32<23:37, 20.54s/epoch, loss=1.16, accuracy=0.752, val_loss=2.92, val_accuracy=0.318, lr=0.1]  41%|████      | 47/115 [16:53<23:21, 20.61s/epoch, loss=1.16, accuracy=0.747, val_loss=1.82, val_accuracy=0.502, lr=0.1] 42%|████▏     | 48/115 [17:15<23:22, 20.93s/epoch, loss=1.15, accuracy=0.751, val_loss=1.57, val_accuracy=0.637, lr=0.1] 43%|████▎     | 49/115 [17:34<22:25, 20.38s/epoch, loss=1.15, accuracy=0.75, val_loss=1.66, val_accuracy=0.574, lr=0.1]  43%|████▎     | 50/115 [17:55<22:16, 20.56s/epoch, loss=1.15, accuracy=0.751, val_loss=4.1, val_accuracy=0.241, lr=0.0316] 44%|████▍     | 51/115 [18:16<22:12, 20.82s/epoch, loss=1.15, accuracy=0.75, val_loss=1.51, val_accuracy=0.619, lr=0.1]    45%|████▌     | 52/115 [18:38<22:02, 20.99s/epoch, loss=1.15, accuracy=0.751, val_loss=1.64, val_accuracy=0.556, lr=0.1] 46%|████▌     | 53/115 [18:57<21:17, 20.60s/epoch, loss=1.16, accuracy=0.752, val_loss=2.05, val_accuracy=0.538, lr=0.1] 47%|████▋     | 54/115 [19:19<21:12, 20.85s/epoch, loss=1.16, accuracy=0.752, val_loss=4.81, val_accuracy=0.192, lr=0.1] 48%|████▊     | 55/115 [19:40<21:00, 21.02s/epoch, loss=1.16, accuracy=0.751, val_loss=3.08, val_accuracy=0.361, lr=0.0316] 49%|████▊     | 56/115 [20:01<20:31, 20.87s/epoch, loss=1.15, accuracy=0.754, val_loss=1.97, val_accuracy=0.505, lr=0.1]    50%|████▉     | 57/115 [20:21<20:00, 20.69s/epoch, loss=1.16, accuracy=0.75, val_loss=2.34, val_accuracy=0.452, lr=0.1]  50%|█████     | 58/115 [20:42<19:49, 20.87s/epoch, loss=1.15, accuracy=0.755, val_loss=1.6, val_accuracy=0.583, lr=0.1] 51%|█████▏    | 59/115 [21:04<19:36, 21.01s/epoch, loss=1.16, accuracy=0.75, val_loss=2.14, val_accuracy=0.483, lr=0.1] 52%|█████▏    | 60/115 [21:24<19:12, 20.96s/epoch, loss=1.16, accuracy=0.75, val_loss=1.57, val_accuracy=0.617, lr=0.0316] 53%|█████▎    | 61/115 [21:45<18:39, 20.73s/epoch, loss=1.15, accuracy=0.752, val_loss=2.89, val_accuracy=0.352, lr=0.1]   54%|█████▍    | 62/115 [22:05<18:05, 20.49s/epoch, loss=1.16, accuracy=0.753, val_loss=2.68, val_accuracy=0.401, lr=0.1] 55%|█████▍    | 63/115 [22:26<17:56, 20.71s/epoch, loss=1.16, accuracy=0.751, val_loss=1.75, val_accuracy=0.544, lr=0.1] 56%|█████▌    | 64/115 [22:45<17:12, 20.25s/epoch, loss=1.15, accuracy=0.751, val_loss=1.83, val_accuracy=0.556, lr=0.1] 57%|█████▋    | 65/115 [23:06<17:02, 20.45s/epoch, loss=1.15, accuracy=0.749, val_loss=1.55, val_accuracy=0.624, lr=0.0316] 57%|█████▋    | 66/115 [23:27<16:58, 20.79s/epoch, loss=1.15, accuracy=0.751, val_loss=1.84, val_accuracy=0.506, lr=0.1]    58%|█████▊    | 67/115 [23:48<16:28, 20.60s/epoch, loss=1.15, accuracy=0.751, val_loss=2.32, val_accuracy=0.377, lr=0.1] 59%|█████▉    | 68/115 [24:07<15:53, 20.30s/epoch, loss=1.15, accuracy=0.754, val_loss=2.59, val_accuracy=0.452, lr=0.1] 60%|██████    | 69/115 [24:29<15:50, 20.66s/epoch, loss=1.15, accuracy=0.754, val_loss=1.77, val_accuracy=0.585, lr=0.1] 61%|██████    | 70/115 [24:49<15:30, 20.67s/epoch, loss=1.14, accuracy=0.754, val_loss=2.02, val_accuracy=0.505, lr=0.0316] 62%|██████▏   | 71/115 [25:10<15:04, 20.56s/epoch, loss=1.15, accuracy=0.753, val_loss=3.46, val_accuracy=0.293, lr=0.1]    63%|██████▎   | 72/115 [25:31<14:51, 20.73s/epoch, loss=1.15, accuracy=0.752, val_loss=1.75, val_accuracy=0.557, lr=0.1] 63%|██████▎   | 73/115 [25:52<14:38, 20.91s/epoch, loss=1.15, accuracy=0.749, val_loss=2.59, val_accuracy=0.439, lr=0.1] 64%|██████▍   | 74/115 [26:13<14:11, 20.78s/epoch, loss=1.15, accuracy=0.754, val_loss=2.52, val_accuracy=0.456, lr=0.1] 65%|██████▌   | 75/115 [26:34<13:56, 20.91s/epoch, loss=1.14, accuracy=0.752, val_loss=2.37, val_accuracy=0.481, lr=0.0316] 66%|██████▌   | 76/115 [26:55<13:40, 21.04s/epoch, loss=1.14, accuracy=0.754, val_loss=2, val_accuracy=0.5, lr=0.1]         67%|██████▋   | 77/115 [27:16<13:20, 21.06s/epoch, loss=1.14, accuracy=0.753, val_loss=1.63, val_accuracy=0.592, lr=0.1] 68%|██████▊   | 78/115 [27:36<12:48, 20.76s/epoch, loss=1.14, accuracy=0.752, val_loss=1.34, val_accuracy=0.681, lr=0.1] 69%|██████▊   | 79/115 [27:57<12:25, 20.71s/epoch, loss=1.14, accuracy=0.753, val_loss=2.21, val_accuracy=0.458, lr=0.1] 70%|██████▉   | 80/115 [28:18<12:04, 20.71s/epoch, loss=1.14, accuracy=0.754, val_loss=1.46, val_accuracy=0.655, lr=0.1] 70%|███████   | 81/115 [28:39<11:49, 20.86s/epoch, loss=1.14, accuracy=0.754, val_loss=2.73, val_accuracy=0.341, lr=0.1] 71%|███████▏  | 82/115 [29:00<11:33, 21.02s/epoch, loss=0.937, accuracy=0.811, val_loss=0.948, val_accuracy=0.788, lr=0.01] 72%|███████▏  | 83/115 [29:22<11:14, 21.09s/epoch, loss=0.758, accuracy=0.843, val_loss=0.783, val_accuracy=0.827, lr=0.01] 73%|███████▎  | 84/115 [29:41<10:40, 20.66s/epoch, loss=0.676, accuracy=0.854, val_loss=0.812, val_accuracy=0.793, lr=0.01] 74%|███████▍  | 85/115 [30:00<10:05, 20.18s/epoch, loss=0.624, accuracy=0.858, val_loss=0.749, val_accuracy=0.82, lr=0.01]  75%|███████▍  | 86/115 [30:21<09:47, 20.27s/epoch, loss=0.603, accuracy=0.858, val_loss=0.76, val_accuracy=0.806, lr=0.01] 76%|███████▌  | 87/115 [30:42<09:36, 20.58s/epoch, loss=0.589, accuracy=0.862, val_loss=0.708, val_accuracy=0.821, lr=0.01] 77%|███████▋  | 88/115 [31:03<09:22, 20.82s/epoch, loss=0.581, accuracy=0.861, val_loss=0.748, val_accuracy=0.812, lr=0.01] 77%|███████▋  | 89/115 [31:25<09:06, 21.04s/epoch, loss=0.574, accuracy=0.862, val_loss=0.885, val_accuracy=0.772, lr=0.01] 78%|███████▊  | 90/115 [31:46<08:42, 20.92s/epoch, loss=0.572, accuracy=0.866, val_loss=0.829, val_accuracy=0.781, lr=0.01] 79%|███████▉  | 91/115 [32:07<08:25, 21.08s/epoch, loss=0.57, accuracy=0.865, val_loss=0.988, val_accuracy=0.738, lr=0.01]  80%|████████  | 92/115 [32:28<08:05, 21.11s/epoch, loss=0.568, accuracy=0.868, val_loss=0.72, val_accuracy=0.817, lr=0.00316] 81%|████████  | 93/115 [32:49<07:44, 21.10s/epoch, loss=0.571, accuracy=0.866, val_loss=1.01, val_accuracy=0.742, lr=0.01]    82%|████████▏ | 94/115 [33:10<07:20, 20.97s/epoch, loss=0.563, accuracy=0.87, val_loss=0.746, val_accuracy=0.816, lr=0.01] 83%|████████▎ | 95/115 [33:32<07:03, 21.18s/epoch, loss=0.572, accuracy=0.868, val_loss=0.71, val_accuracy=0.832, lr=0.01] 83%|████████▎ | 96/115 [33:52<06:38, 20.96s/epoch, loss=0.567, accuracy=0.872, val_loss=0.789, val_accuracy=0.812, lr=0.01] 84%|████████▍ | 97/115 [34:14<06:20, 21.13s/epoch, loss=0.569, accuracy=0.873, val_loss=1.07, val_accuracy=0.732, lr=0.00316] 85%|████████▌ | 98/115 [34:35<06:01, 21.26s/epoch, loss=0.569, accuracy=0.873, val_loss=0.861, val_accuracy=0.791, lr=0.01]   86%|████████▌ | 99/115 [34:56<05:39, 21.23s/epoch, loss=0.562, accuracy=0.876, val_loss=0.809, val_accuracy=0.796, lr=0.01] 87%|████████▋ | 100/115 [35:18<05:19, 21.27s/epoch, loss=0.558, accuracy=0.878, val_loss=0.685, val_accuracy=0.834, lr=0.01] 88%|████████▊ | 101/115 [35:38<04:55, 21.10s/epoch, loss=0.562, accuracy=0.877, val_loss=1.17, val_accuracy=0.721, lr=0.01]  89%|████████▊ | 102/115 [35:59<04:31, 20.91s/epoch, loss=0.565, accuracy=0.876, val_loss=0.96, val_accuracy=0.77, lr=0.01]  90%|████████▉ | 103/115 [36:20<04:11, 21.00s/epoch, loss=0.565, accuracy=0.877, val_loss=0.937, val_accuracy=0.778, lr=0.01] 90%|█████████ | 104/115 [36:41<03:51, 21.05s/epoch, loss=0.57, accuracy=0.875, val_loss=0.924, val_accuracy=0.771, lr=0.01]  91%|█████████▏| 105/115 [37:01<03:26, 20.64s/epoch, loss=0.566, accuracy=0.878, val_loss=0.878, val_accuracy=0.779, lr=0.00316] 92%|█████████▏| 106/115 [37:22<03:05, 20.63s/epoch, loss=0.558, accuracy=0.881, val_loss=1.02, val_accuracy=0.738, lr=0.01]     93%|█████████▎| 107/115 [37:41<02:41, 20.17s/epoch, loss=0.561, accuracy=0.881, val_loss=0.876, val_accuracy=0.775, lr=0.01] 94%|█████████▍| 108/115 [38:01<02:22, 20.35s/epoch, loss=0.563, accuracy=0.88, val_loss=0.756, val_accuracy=0.822, lr=0.01]  95%|█████████▍| 109/115 [38:23<02:03, 20.59s/epoch, loss=0.564, accuracy=0.879, val_loss=0.836, val_accuracy=0.806, lr=0.01] 96%|█████████▌| 110/115 [38:44<01:43, 20.69s/epoch, loss=0.565, accuracy=0.881, val_loss=0.761, val_accuracy=0.809, lr=0.00316] 97%|█████████▋| 111/115 [39:05<01:23, 20.78s/epoch, loss=0.564, accuracy=0.88, val_loss=0.938, val_accuracy=0.781, lr=0.01]     97%|█████████▋| 112/115 [39:24<01:01, 20.46s/epoch, loss=0.564, accuracy=0.881, val_loss=0.952, val_accuracy=0.763, lr=0.01] 98%|█████████▊| 113/115 [39:45<00:40, 20.41s/epoch, loss=0.564, accuracy=0.88, val_loss=0.776, val_accuracy=0.82, lr=0.01]   99%|█████████▉| 114/115 [40:05<00:20, 20.35s/epoch, loss=0.561, accuracy=0.882, val_loss=1.47, val_accuracy=0.615, lr=0.01]100%|██████████| 115/115 [40:24<00:00, 20.16s/epoch, loss=0.564, accuracy=0.883, val_loss=1.01, val_accuracy=0.77, lr=0.00316]100%|██████████| 115/115 [40:24<00:00, 21.09s/epoch, loss=0.564, accuracy=0.883, val_loss=1.01, val_accuracy=0.77, lr=0.00316]
Using real-time data augmentation.
Test score: 0.7130051255226135
Test accuracy: 0.8263000249862671


* * * Run SGD for ID = 13_8. * * *


2024-02-19 23:58:11.862485: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 23:58:15.896097: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-19 23:58:15.897137: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-19 23:58:15.935227: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-19 23:58:15.935260: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 23:58:15.939304: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-19 23:58:15.939375: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-19 23:58:15.942589: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-19 23:58:15.944327: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-19 23:58:15.947561: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-19 23:58:15.949466: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-19 23:58:15.955329: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-19 23:58:15.955841: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-19 23:58:15.955971: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-19 23:58:17.407963: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-19 23:58:17.409666: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-19 23:58:17.410191: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-19 23:58:17.410246: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 23:58:17.410282: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-19 23:58:17.410301: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-19 23:58:17.410319: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-19 23:58:17.410337: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-19 23:58:17.410370: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-19 23:58:17.410388: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-19 23:58:17.410405: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-19 23:58:17.410861: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-19 23:58:17.410897: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 23:58:18.045321: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-19 23:58:18.045381: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-19 23:58:18.045400: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-19 23:58:18.046492: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:83:00.0, compute capability: 6.1)
{'id': '13_08', 'batch_size': 128, 'epochs': 115, 'validation_split': 0.1, 'checkpointing': True, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
x_train shape: (45000, 32, 32, 3)
45000 train samples
5000 validation samples
10000 test samples
y_train shape: (45000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/115 [00:00<?, ?epoch/s]2024-02-19 23:58:18.935956: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-19 23:58:18.948167: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199825000 Hz
2024-02-19 23:58:21.047306: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-19 23:58:21.297579: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-19 23:58:22.019419: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-19 23:58:22.063159: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/115 [00:56<1:46:59, 56.31s/epoch, loss=3.25, accuracy=0.293, val_loss=2.86, val_accuracy=0.195, lr=0.1]  2%|▏         | 2/115 [01:18<1:08:09, 36.19s/epoch, loss=1.6, accuracy=0.516, val_loss=1.98, val_accuracy=0.421, lr=0.1]   3%|▎         | 3/115 [01:37<53:08, 28.47s/epoch, loss=1.35, accuracy=0.631, val_loss=1.77, val_accuracy=0.469, lr=0.1]   3%|▎         | 4/115 [02:00<48:35, 26.27s/epoch, loss=1.27, accuracy=0.678, val_loss=1.51, val_accuracy=0.604, lr=0.1]  4%|▍         | 5/115 [02:20<44:16, 24.15s/epoch, loss=1.24, accuracy=0.698, val_loss=1.83, val_accuracy=0.49, lr=0.1]   5%|▌         | 6/115 [02:42<42:08, 23.20s/epoch, loss=1.23, accuracy=0.708, val_loss=2, val_accuracy=0.512, lr=0.1]    6%|▌         | 7/115 [03:03<40:28, 22.49s/epoch, loss=1.21, accuracy=0.716, val_loss=1.92, val_accuracy=0.483, lr=0.1]  7%|▋         | 8/115 [03:25<39:57, 22.41s/epoch, loss=1.22, accuracy=0.717, val_loss=1.57, val_accuracy=0.619, lr=0.1]  8%|▊         | 9/115 [03:47<39:08, 22.16s/epoch, loss=1.2, accuracy=0.726, val_loss=3.82, val_accuracy=0.283, lr=0.0316]  9%|▊         | 10/115 [04:08<38:27, 21.97s/epoch, loss=1.19, accuracy=0.728, val_loss=1.99, val_accuracy=0.472, lr=0.1]  10%|▉         | 11/115 [04:30<37:49, 21.82s/epoch, loss=1.2, accuracy=0.731, val_loss=1.59, val_accuracy=0.588, lr=0.1]  10%|█         | 12/115 [04:50<36:47, 21.43s/epoch, loss=1.19, accuracy=0.732, val_loss=1.56, val_accuracy=0.618, lr=0.1] 11%|█▏        | 13/115 [05:10<35:21, 20.80s/epoch, loss=1.18, accuracy=0.737, val_loss=3.14, val_accuracy=0.409, lr=0.1] 12%|█▏        | 14/115 [05:31<35:10, 20.90s/epoch, loss=1.18, accuracy=0.737, val_loss=3.71, val_accuracy=0.309, lr=0.0316] 13%|█▎        | 15/115 [05:52<34:53, 20.94s/epoch, loss=1.18, accuracy=0.737, val_loss=1.8, val_accuracy=0.54, lr=0.1]      14%|█▍        | 16/115 [06:12<34:17, 20.79s/epoch, loss=1.17, accuracy=0.739, val_loss=1.82, val_accuracy=0.595, lr=0.1] 15%|█▍        | 17/115 [06:33<34:09, 20.91s/epoch, loss=1.17, accuracy=0.743, val_loss=1.85, val_accuracy=0.516, lr=0.1] 16%|█▌        | 18/115 [06:54<33:25, 20.68s/epoch, loss=1.17, accuracy=0.74, val_loss=1.56, val_accuracy=0.611, lr=0.1]  17%|█▋        | 19/115 [07:14<32:56, 20.59s/epoch, loss=1.18, accuracy=0.741, val_loss=1.94, val_accuracy=0.551, lr=0.0316] 17%|█▋        | 20/115 [07:35<32:47, 20.71s/epoch, loss=1.17, accuracy=0.744, val_loss=4.67, val_accuracy=0.249, lr=0.1]    18%|█▊        | 21/115 [07:54<31:44, 20.26s/epoch, loss=1.16, accuracy=0.745, val_loss=4.78, val_accuracy=0.306, lr=0.1] 19%|█▉        | 22/115 [08:15<31:48, 20.52s/epoch, loss=1.17, accuracy=0.744, val_loss=2.54, val_accuracy=0.429, lr=0.1] 20%|██        | 23/115 [08:35<30:57, 20.19s/epoch, loss=1.16, accuracy=0.746, val_loss=1.91, val_accuracy=0.516, lr=0.1] 21%|██        | 24/115 [08:56<31:03, 20.48s/epoch, loss=1.17, accuracy=0.745, val_loss=2.64, val_accuracy=0.39, lr=0.0316] 22%|██▏       | 25/115 [09:17<31:08, 20.76s/epoch, loss=1.15, accuracy=0.746, val_loss=1.92, val_accuracy=0.489, lr=0.1]   23%|██▎       | 26/115 [09:39<31:00, 20.90s/epoch, loss=1.15, accuracy=0.746, val_loss=2.78, val_accuracy=0.436, lr=0.1] 23%|██▎       | 27/115 [10:00<30:48, 21.01s/epoch, loss=1.17, accuracy=0.745, val_loss=2.1, val_accuracy=0.484, lr=0.1]  24%|██▍       | 28/115 [10:19<29:39, 20.45s/epoch, loss=1.16, accuracy=0.746, val_loss=2.78, val_accuracy=0.271, lr=0.1] 25%|██▌       | 29/115 [10:40<29:39, 20.69s/epoch, loss=1.15, accuracy=0.75, val_loss=1.84, val_accuracy=0.543, lr=0.0316] 26%|██▌       | 30/115 [11:01<29:28, 20.80s/epoch, loss=1.15, accuracy=0.747, val_loss=2.74, val_accuracy=0.398, lr=0.1]   27%|██▋       | 31/115 [11:22<29:05, 20.79s/epoch, loss=1.15, accuracy=0.75, val_loss=1.42, val_accuracy=0.656, lr=0.1]  28%|██▊       | 32/115 [11:42<28:19, 20.48s/epoch, loss=1.15, accuracy=0.749, val_loss=1.68, val_accuracy=0.582, lr=0.1] 29%|██▊       | 33/115 [12:03<28:11, 20.63s/epoch, loss=1.15, accuracy=0.749, val_loss=3.02, val_accuracy=0.389, lr=0.1] 30%|██▉       | 34/115 [12:23<27:44, 20.55s/epoch, loss=1.15, accuracy=0.75, val_loss=1.99, val_accuracy=0.49, lr=0.1]   30%|███       | 35/115 [12:42<26:54, 20.18s/epoch, loss=1.14, accuracy=0.752, val_loss=2.31, val_accuracy=0.343, lr=0.1] 31%|███▏      | 36/115 [13:03<26:44, 20.31s/epoch, loss=1.15, accuracy=0.752, val_loss=1.84, val_accuracy=0.551, lr=0.0316] 32%|███▏      | 37/115 [13:24<26:49, 20.64s/epoch, loss=1.15, accuracy=0.752, val_loss=1.66, val_accuracy=0.571, lr=0.1]    33%|███▎      | 38/115 [13:45<26:20, 20.53s/epoch, loss=1.15, accuracy=0.753, val_loss=1.96, val_accuracy=0.537, lr=0.1] 34%|███▍      | 39/115 [14:06<26:22, 20.82s/epoch, loss=1.14, accuracy=0.752, val_loss=1.8, val_accuracy=0.563, lr=0.1]  35%|███▍      | 40/115 [14:26<25:35, 20.47s/epoch, loss=1.16, accuracy=0.75, val_loss=2.3, val_accuracy=0.481, lr=0.1]  36%|███▌      | 41/115 [14:47<25:35, 20.75s/epoch, loss=1.14, accuracy=0.754, val_loss=2.32, val_accuracy=0.416, lr=0.0316] 37%|███▋      | 42/115 [15:06<24:39, 20.27s/epoch, loss=1.14, accuracy=0.753, val_loss=1.95, val_accuracy=0.504, lr=0.1]    37%|███▋      | 43/115 [15:25<23:52, 19.89s/epoch, loss=1.14, accuracy=0.752, val_loss=1.73, val_accuracy=0.557, lr=0.1] 38%|███▊      | 44/115 [15:45<23:27, 19.82s/epoch, loss=1.13, accuracy=0.755, val_loss=1.48, val_accuracy=0.626, lr=0.1] 39%|███▉      | 45/115 [16:05<23:13, 19.91s/epoch, loss=1.14, accuracy=0.754, val_loss=2.03, val_accuracy=0.452, lr=0.1] 40%|████      | 46/115 [16:26<23:04, 20.07s/epoch, loss=1.14, accuracy=0.756, val_loss=2.06, val_accuracy=0.482, lr=0.0316] 41%|████      | 47/115 [16:47<23:11, 20.46s/epoch, loss=1.13, accuracy=0.754, val_loss=1.61, val_accuracy=0.586, lr=0.1]    42%|████▏     | 48/115 [17:08<23:09, 20.73s/epoch, loss=1.14, accuracy=0.754, val_loss=2.03, val_accuracy=0.483, lr=0.1] 43%|████▎     | 49/115 [17:30<22:56, 20.86s/epoch, loss=1.13, accuracy=0.757, val_loss=2.48, val_accuracy=0.419, lr=0.1] 43%|████▎     | 50/115 [17:50<22:29, 20.77s/epoch, loss=1.14, accuracy=0.753, val_loss=1.6, val_accuracy=0.591, lr=0.1]  44%|████▍     | 51/115 [18:11<22:18, 20.92s/epoch, loss=1.13, accuracy=0.755, val_loss=2.36, val_accuracy=0.517, lr=0.0316] 45%|████▌     | 52/115 [18:33<22:03, 21.01s/epoch, loss=1.14, accuracy=0.754, val_loss=1.44, val_accuracy=0.647, lr=0.1]    46%|████▌     | 53/115 [18:54<21:47, 21.09s/epoch, loss=1.14, accuracy=0.752, val_loss=2.3, val_accuracy=0.491, lr=0.1]  47%|████▋     | 54/115 [19:15<21:24, 21.06s/epoch, loss=1.13, accuracy=0.756, val_loss=2.25, val_accuracy=0.433, lr=0.1] 48%|████▊     | 55/115 [19:36<20:56, 20.95s/epoch, loss=1.13, accuracy=0.755, val_loss=1.98, val_accuracy=0.509, lr=0.1] 49%|████▊     | 56/115 [19:56<20:35, 20.95s/epoch, loss=1.13, accuracy=0.755, val_loss=1.68, val_accuracy=0.599, lr=0.0316] 50%|████▉     | 57/115 [20:17<20:04, 20.77s/epoch, loss=1.14, accuracy=0.755, val_loss=2.38, val_accuracy=0.326, lr=0.1]    50%|█████     | 58/115 [20:38<19:48, 20.86s/epoch, loss=1.13, accuracy=0.753, val_loss=2.03, val_accuracy=0.513, lr=0.1] 51%|█████▏    | 59/115 [20:59<19:35, 20.99s/epoch, loss=1.12, accuracy=0.757, val_loss=2.59, val_accuracy=0.278, lr=0.1] 52%|█████▏    | 60/115 [21:21<19:19, 21.08s/epoch, loss=1.13, accuracy=0.757, val_loss=1.62, val_accuracy=0.587, lr=0.1] 53%|█████▎    | 61/115 [21:42<19:04, 21.20s/epoch, loss=1.13, accuracy=0.757, val_loss=1.45, val_accuracy=0.669, lr=0.0316] 54%|█████▍    | 62/115 [22:03<18:39, 21.12s/epoch, loss=1.13, accuracy=0.756, val_loss=1.69, val_accuracy=0.581, lr=0.1]    55%|█████▍    | 63/115 [22:24<18:24, 21.23s/epoch, loss=1.13, accuracy=0.752, val_loss=3.7, val_accuracy=0.3, lr=0.1]    56%|█████▌    | 64/115 [22:46<18:05, 21.29s/epoch, loss=1.13, accuracy=0.757, val_loss=1.8, val_accuracy=0.513, lr=0.1] 57%|█████▋    | 65/115 [23:06<17:28, 20.97s/epoch, loss=1.12, accuracy=0.757, val_loss=2.3, val_accuracy=0.459, lr=0.1] 57%|█████▋    | 66/115 [23:27<17:13, 21.09s/epoch, loss=1.13, accuracy=0.757, val_loss=1.64, val_accuracy=0.604, lr=0.0316] 58%|█████▊    | 67/115 [23:49<17:01, 21.28s/epoch, loss=1.13, accuracy=0.754, val_loss=1.8, val_accuracy=0.586, lr=0.1]     59%|█████▉    | 68/115 [24:10<16:35, 21.19s/epoch, loss=1.13, accuracy=0.756, val_loss=2.12, val_accuracy=0.443, lr=0.1] 60%|██████    | 69/115 [24:32<16:19, 21.29s/epoch, loss=1.13, accuracy=0.755, val_loss=1.89, val_accuracy=0.526, lr=0.1] 61%|██████    | 70/115 [24:53<15:59, 21.32s/epoch, loss=1.12, accuracy=0.759, val_loss=1.46, val_accuracy=0.641, lr=0.1] 62%|██████▏   | 71/115 [25:14<15:38, 21.34s/epoch, loss=1.13, accuracy=0.757, val_loss=2.42, val_accuracy=0.46, lr=0.0316] 63%|██████▎   | 72/115 [25:35<15:13, 21.24s/epoch, loss=1.13, accuracy=0.757, val_loss=1.49, val_accuracy=0.623, lr=0.1]   63%|██████▎   | 73/115 [25:56<14:49, 21.19s/epoch, loss=1.13, accuracy=0.756, val_loss=2, val_accuracy=0.562, lr=0.1]    64%|██████▍   | 74/115 [26:18<14:30, 21.24s/epoch, loss=1.12, accuracy=0.759, val_loss=2.27, val_accuracy=0.491, lr=0.1] 65%|██████▌   | 75/115 [26:39<14:07, 21.18s/epoch, loss=1.13, accuracy=0.754, val_loss=1.49, val_accuracy=0.616, lr=0.1] 66%|██████▌   | 76/115 [27:00<13:46, 21.19s/epoch, loss=1.12, accuracy=0.756, val_loss=3.92, val_accuracy=0.307, lr=0.0316] 67%|██████▋   | 77/115 [27:21<13:24, 21.16s/epoch, loss=1.12, accuracy=0.757, val_loss=1.61, val_accuracy=0.582, lr=0.1]    68%|██████▊   | 78/115 [27:40<12:41, 20.58s/epoch, loss=1.12, accuracy=0.756, val_loss=1.59, val_accuracy=0.577, lr=0.1] 69%|██████▊   | 79/115 [28:02<12:26, 20.75s/epoch, loss=1.13, accuracy=0.754, val_loss=2.24, val_accuracy=0.527, lr=0.1] 70%|██████▉   | 80/115 [28:21<11:48, 20.23s/epoch, loss=1.13, accuracy=0.754, val_loss=6.48, val_accuracy=0.236, lr=0.1] 70%|███████   | 81/115 [28:42<11:40, 20.61s/epoch, loss=1.11, accuracy=0.76, val_loss=2.23, val_accuracy=0.482, lr=0.0316] 71%|███████▏  | 82/115 [29:02<11:08, 20.26s/epoch, loss=0.931, accuracy=0.812, val_loss=0.929, val_accuracy=0.8, lr=0.01]  72%|███████▏  | 83/115 [29:23<11:00, 20.65s/epoch, loss=0.751, accuracy=0.845, val_loss=0.78, val_accuracy=0.824, lr=0.01] 73%|███████▎  | 84/115 [29:43<10:35, 20.49s/epoch, loss=0.665, accuracy=0.857, val_loss=0.74, val_accuracy=0.824, lr=0.01] 74%|███████▍  | 85/115 [30:05<10:22, 20.76s/epoch, loss=0.62, accuracy=0.86, val_loss=0.764, val_accuracy=0.801, lr=0.01]  75%|███████▍  | 86/115 [30:26<10:05, 20.87s/epoch, loss=0.591, accuracy=0.861, val_loss=0.726, val_accuracy=0.811, lr=0.01] 76%|███████▌  | 87/115 [30:46<09:43, 20.83s/epoch, loss=0.576, accuracy=0.863, val_loss=0.846, val_accuracy=0.78, lr=0.01]  77%|███████▋  | 88/115 [31:07<09:22, 20.84s/epoch, loss=0.569, accuracy=0.862, val_loss=0.75, val_accuracy=0.798, lr=0.01] 77%|███████▋  | 89/115 [31:28<09:03, 20.92s/epoch, loss=0.563, accuracy=0.867, val_loss=0.914, val_accuracy=0.754, lr=0.01] 78%|███████▊  | 90/115 [31:49<08:43, 20.93s/epoch, loss=0.563, accuracy=0.867, val_loss=0.728, val_accuracy=0.81, lr=0.01]  79%|███████▉  | 91/115 [32:11<08:26, 21.12s/epoch, loss=0.562, accuracy=0.866, val_loss=0.878, val_accuracy=0.771, lr=0.00316] 80%|████████  | 92/115 [32:31<08:01, 20.95s/epoch, loss=0.555, accuracy=0.869, val_loss=0.836, val_accuracy=0.779, lr=0.01]    81%|████████  | 93/115 [32:53<07:44, 21.10s/epoch, loss=0.555, accuracy=0.871, val_loss=0.765, val_accuracy=0.808, lr=0.01] 82%|████████▏ | 94/115 [33:12<07:11, 20.52s/epoch, loss=0.555, accuracy=0.871, val_loss=0.78, val_accuracy=0.799, lr=0.01]  83%|████████▎ | 95/115 [33:34<06:59, 20.97s/epoch, loss=0.554, accuracy=0.872, val_loss=0.791, val_accuracy=0.787, lr=0.01] 83%|████████▎ | 96/115 [33:53<06:27, 20.42s/epoch, loss=0.554, accuracy=0.872, val_loss=0.76, val_accuracy=0.817, lr=0.00316] 84%|████████▍ | 97/115 [34:14<06:07, 20.44s/epoch, loss=0.555, accuracy=0.873, val_loss=0.726, val_accuracy=0.819, lr=0.01]   85%|████████▌ | 98/115 [34:35<05:52, 20.73s/epoch, loss=0.552, accuracy=0.875, val_loss=0.757, val_accuracy=0.806, lr=0.01] 86%|████████▌ | 99/115 [34:57<05:36, 21.03s/epoch, loss=0.554, accuracy=0.875, val_loss=0.72, val_accuracy=0.826, lr=0.01]  87%|████████▋ | 100/115 [35:17<05:11, 20.75s/epoch, loss=0.551, accuracy=0.876, val_loss=1.1, val_accuracy=0.73, lr=0.01]  88%|████████▊ | 101/115 [35:36<04:44, 20.30s/epoch, loss=0.557, accuracy=0.875, val_loss=0.708, val_accuracy=0.828, lr=0.01] 89%|████████▊ | 102/115 [35:57<04:26, 20.48s/epoch, loss=0.553, accuracy=0.877, val_loss=0.818, val_accuracy=0.789, lr=0.01] 90%|████████▉ | 103/115 [36:18<04:06, 20.54s/epoch, loss=0.552, accuracy=0.878, val_loss=0.925, val_accuracy=0.768, lr=0.01] 90%|█████████ | 104/115 [36:40<03:49, 20.89s/epoch, loss=0.553, accuracy=0.878, val_loss=0.692, val_accuracy=0.835, lr=0.01] 91%|█████████▏| 105/115 [37:01<03:29, 20.93s/epoch, loss=0.548, accuracy=0.88, val_loss=0.95, val_accuracy=0.753, lr=0.01]   92%|█████████▏| 106/115 [37:22<03:08, 20.95s/epoch, loss=0.553, accuracy=0.88, val_loss=0.898, val_accuracy=0.785, lr=0.01] 93%|█████████▎| 107/115 [37:43<02:49, 21.16s/epoch, loss=0.548, accuracy=0.883, val_loss=0.781, val_accuracy=0.817, lr=0.01] 94%|█████████▍| 108/115 [38:04<02:26, 20.97s/epoch, loss=0.551, accuracy=0.881, val_loss=0.765, val_accuracy=0.807, lr=0.01] 95%|█████████▍| 109/115 [38:25<02:06, 21.15s/epoch, loss=0.549, accuracy=0.883, val_loss=0.857, val_accuracy=0.784, lr=0.00316] 96%|█████████▌| 110/115 [38:46<01:45, 21.11s/epoch, loss=0.554, accuracy=0.88, val_loss=0.905, val_accuracy=0.768, lr=0.01]     97%|█████████▋| 111/115 [39:07<01:23, 20.95s/epoch, loss=0.551, accuracy=0.884, val_loss=1.47, val_accuracy=0.652, lr=0.01] 97%|█████████▋| 112/115 [39:28<01:03, 21.02s/epoch, loss=0.551, accuracy=0.883, val_loss=0.936, val_accuracy=0.773, lr=0.01] 98%|█████████▊| 113/115 [39:48<00:41, 20.79s/epoch, loss=0.553, accuracy=0.881, val_loss=0.821, val_accuracy=0.799, lr=0.01] 99%|█████████▉| 114/115 [40:09<00:20, 20.89s/epoch, loss=0.549, accuracy=0.884, val_loss=0.833, val_accuracy=0.798, lr=0.00316]100%|██████████| 115/115 [40:30<00:00, 20.91s/epoch, loss=0.55, accuracy=0.883, val_loss=0.761, val_accuracy=0.817, lr=0.01]    100%|██████████| 115/115 [40:30<00:00, 21.14s/epoch, loss=0.55, accuracy=0.883, val_loss=0.761, val_accuracy=0.817, lr=0.01]
Using real-time data augmentation.
Test score: 0.6916567087173462
Test accuracy: 0.8356999754905701


* * * Run SGD for ID = 13_9. * * *


2024-02-20 00:38:55.178511: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 00:38:57.852204: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 00:38:57.853103: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-20 00:38:57.892473: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-20 00:38:57.892503: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 00:38:57.895387: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 00:38:57.895428: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-20 00:38:57.897580: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-20 00:38:57.898289: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-20 00:38:57.900824: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-20 00:38:57.902420: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-20 00:38:57.907325: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 00:38:57.907842: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-20 00:38:57.907924: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 00:38:59.347631: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-20 00:38:59.348618: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 00:38:59.349377: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-20 00:38:59.349413: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 00:38:59.349449: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 00:38:59.349468: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-20 00:38:59.349486: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-20 00:38:59.349504: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-20 00:38:59.349521: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-20 00:38:59.349538: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-20 00:38:59.349556: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 00:38:59.350001: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-20 00:38:59.350037: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 00:38:59.965322: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-20 00:38:59.965385: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-20 00:38:59.965397: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-20 00:38:59.966299: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:83:00.0, compute capability: 6.1)
{'id': '13_09', 'batch_size': 128, 'epochs': 115, 'validation_split': 0.1, 'checkpointing': True, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
x_train shape: (45000, 32, 32, 3)
45000 train samples
5000 validation samples
10000 test samples
y_train shape: (45000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/115 [00:00<?, ?epoch/s]2024-02-20 00:39:00.796954: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-20 00:39:00.809281: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199825000 Hz
2024-02-20 00:39:02.976590: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 00:39:03.230563: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 00:39:03.855537: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-20 00:39:03.927263: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/115 [00:52<1:39:12, 52.21s/epoch, loss=3.41, accuracy=0.267, val_loss=2.55, val_accuracy=0.212, lr=0.1]  2%|▏         | 2/115 [01:12<1:03:11, 33.55s/epoch, loss=1.73, accuracy=0.449, val_loss=2.37, val_accuracy=0.293, lr=0.1]  3%|▎         | 3/115 [01:33<51:45, 27.73s/epoch, loss=1.48, accuracy=0.562, val_loss=1.79, val_accuracy=0.49, lr=0.1]     3%|▎         | 4/115 [01:55<46:50, 25.32s/epoch, loss=1.32, accuracy=0.651, val_loss=1.96, val_accuracy=0.478, lr=0.1]  4%|▍         | 5/115 [02:16<43:44, 23.86s/epoch, loss=1.27, accuracy=0.682, val_loss=1.65, val_accuracy=0.556, lr=0.1]  5%|▌         | 6/115 [02:38<41:59, 23.12s/epoch, loss=1.24, accuracy=0.704, val_loss=2.19, val_accuracy=0.421, lr=0.1]  6%|▌         | 7/115 [02:58<40:11, 22.33s/epoch, loss=1.23, accuracy=0.713, val_loss=2.63, val_accuracy=0.369, lr=0.1]  7%|▋         | 8/115 [03:20<39:29, 22.15s/epoch, loss=1.22, accuracy=0.721, val_loss=2.2, val_accuracy=0.506, lr=0.1]   8%|▊         | 9/115 [03:42<38:57, 22.05s/epoch, loss=1.21, accuracy=0.726, val_loss=2.37, val_accuracy=0.463, lr=0.1]  9%|▊         | 10/115 [04:04<38:28, 21.99s/epoch, loss=1.21, accuracy=0.725, val_loss=2.07, val_accuracy=0.484, lr=0.0316] 10%|▉         | 11/115 [04:25<37:58, 21.91s/epoch, loss=1.19, accuracy=0.733, val_loss=2.2, val_accuracy=0.455, lr=0.1]     10%|█         | 12/115 [04:48<37:43, 21.98s/epoch, loss=1.19, accuracy=0.736, val_loss=1.56, val_accuracy=0.607, lr=0.1] 11%|█▏        | 13/115 [05:09<37:07, 21.84s/epoch, loss=1.19, accuracy=0.736, val_loss=1.89, val_accuracy=0.487, lr=0.1] 12%|█▏        | 14/115 [05:31<36:44, 21.82s/epoch, loss=1.18, accuracy=0.739, val_loss=1.92, val_accuracy=0.505, lr=0.1] 13%|█▎        | 15/115 [05:53<36:21, 21.82s/epoch, loss=1.18, accuracy=0.739, val_loss=2.92, val_accuracy=0.393, lr=0.1] 14%|█▍        | 16/115 [06:15<36:12, 21.94s/epoch, loss=1.17, accuracy=0.742, val_loss=1.57, val_accuracy=0.611, lr=0.1] 15%|█▍        | 17/115 [06:34<34:38, 21.21s/epoch, loss=1.18, accuracy=0.743, val_loss=2.28, val_accuracy=0.384, lr=0.0316] 16%|█▌        | 18/115 [06:56<34:32, 21.37s/epoch, loss=1.17, accuracy=0.744, val_loss=4.3, val_accuracy=0.254, lr=0.1]     17%|█▋        | 19/115 [07:18<34:13, 21.39s/epoch, loss=1.16, accuracy=0.745, val_loss=2.05, val_accuracy=0.484, lr=0.1] 17%|█▋        | 20/115 [07:39<33:44, 21.31s/epoch, loss=1.16, accuracy=0.749, val_loss=1.64, val_accuracy=0.61, lr=0.1]  18%|█▊        | 21/115 [08:01<33:37, 21.46s/epoch, loss=1.16, accuracy=0.748, val_loss=1.71, val_accuracy=0.529, lr=0.1] 19%|█▉        | 22/115 [08:22<33:11, 21.41s/epoch, loss=1.16, accuracy=0.747, val_loss=2.97, val_accuracy=0.399, lr=0.0316] 20%|██        | 23/115 [08:44<32:57, 21.49s/epoch, loss=1.15, accuracy=0.749, val_loss=2.02, val_accuracy=0.518, lr=0.1]    21%|██        | 24/115 [09:04<32:17, 21.29s/epoch, loss=1.16, accuracy=0.747, val_loss=2.93, val_accuracy=0.335, lr=0.1] 22%|██▏       | 25/115 [09:26<31:55, 21.28s/epoch, loss=1.14, accuracy=0.752, val_loss=2.65, val_accuracy=0.343, lr=0.1] 23%|██▎       | 26/115 [09:48<31:56, 21.54s/epoch, loss=1.16, accuracy=0.745, val_loss=2.22, val_accuracy=0.4, lr=0.1]   23%|██▎       | 27/115 [10:10<31:59, 21.81s/epoch, loss=1.15, accuracy=0.752, val_loss=1.78, val_accuracy=0.547, lr=0.0316] 24%|██▍       | 28/115 [10:32<31:40, 21.85s/epoch, loss=1.14, accuracy=0.753, val_loss=1.73, val_accuracy=0.578, lr=0.1]    25%|██▌       | 29/115 [10:54<31:19, 21.86s/epoch, loss=1.14, accuracy=0.75, val_loss=2.26, val_accuracy=0.469, lr=0.1]  26%|██▌       | 30/115 [11:14<30:00, 21.18s/epoch, loss=1.14, accuracy=0.752, val_loss=1.79, val_accuracy=0.561, lr=0.1] 27%|██▋       | 31/115 [11:35<29:35, 21.14s/epoch, loss=1.14, accuracy=0.751, val_loss=1.93, val_accuracy=0.482, lr=0.1] 28%|██▊       | 32/115 [11:56<29:32, 21.36s/epoch, loss=1.13, accuracy=0.755, val_loss=1.95, val_accuracy=0.553, lr=0.0316] 29%|██▊       | 33/115 [12:17<28:56, 21.18s/epoch, loss=1.13, accuracy=0.755, val_loss=2.23, val_accuracy=0.387, lr=0.1]    30%|██▉       | 34/115 [12:39<28:58, 21.46s/epoch, loss=1.13, accuracy=0.755, val_loss=1.5, val_accuracy=0.634, lr=0.1]  30%|███       | 35/115 [13:00<28:18, 21.24s/epoch, loss=1.13, accuracy=0.754, val_loss=2.42, val_accuracy=0.517, lr=0.1] 31%|███▏      | 36/115 [13:21<28:00, 21.27s/epoch, loss=1.14, accuracy=0.755, val_loss=1.9, val_accuracy=0.496, lr=0.1]  32%|███▏      | 37/115 [13:41<26:57, 20.74s/epoch, loss=1.14, accuracy=0.754, val_loss=2.72, val_accuracy=0.37, lr=0.1] 33%|███▎      | 38/115 [14:01<26:10, 20.39s/epoch, loss=1.13, accuracy=0.753, val_loss=1.99, val_accuracy=0.485, lr=0.1] 34%|███▍      | 39/115 [14:22<26:03, 20.57s/epoch, loss=1.13, accuracy=0.754, val_loss=1.48, val_accuracy=0.634, lr=0.1] 35%|███▍      | 40/115 [14:43<25:59, 20.79s/epoch, loss=1.13, accuracy=0.752, val_loss=1.75, val_accuracy=0.546, lr=0.1] 36%|███▌      | 41/115 [15:03<25:35, 20.76s/epoch, loss=1.12, accuracy=0.755, val_loss=1.88, val_accuracy=0.538, lr=0.1] 37%|███▋      | 42/115 [15:25<25:40, 21.10s/epoch, loss=1.12, accuracy=0.757, val_loss=1.59, val_accuracy=0.564, lr=0.1] 37%|███▋      | 43/115 [15:47<25:26, 21.21s/epoch, loss=1.13, accuracy=0.757, val_loss=1.72, val_accuracy=0.577, lr=0.1] 38%|███▊      | 44/115 [16:08<25:09, 21.26s/epoch, loss=1.13, accuracy=0.756, val_loss=1.37, val_accuracy=0.664, lr=0.1] 39%|███▉      | 45/115 [16:28<24:20, 20.87s/epoch, loss=1.13, accuracy=0.753, val_loss=1.62, val_accuracy=0.598, lr=0.1] 40%|████      | 46/115 [16:49<24:05, 20.95s/epoch, loss=1.12, accuracy=0.756, val_loss=3.3, val_accuracy=0.362, lr=0.1]  41%|████      | 47/115 [17:11<24:03, 21.23s/epoch, loss=1.13, accuracy=0.756, val_loss=2.14, val_accuracy=0.526, lr=0.1] 42%|████▏     | 48/115 [17:33<23:55, 21.43s/epoch, loss=1.12, accuracy=0.759, val_loss=1.45, val_accuracy=0.647, lr=0.1] 43%|████▎     | 49/115 [17:55<23:40, 21.52s/epoch, loss=1.13, accuracy=0.756, val_loss=2.78, val_accuracy=0.382, lr=0.0316] 43%|████▎     | 50/115 [18:14<22:40, 20.93s/epoch, loss=1.13, accuracy=0.756, val_loss=1.55, val_accuracy=0.622, lr=0.1]    44%|████▍     | 51/115 [18:36<22:29, 21.08s/epoch, loss=1.12, accuracy=0.754, val_loss=2.89, val_accuracy=0.348, lr=0.1] 45%|████▌     | 52/115 [18:55<21:39, 20.63s/epoch, loss=1.12, accuracy=0.753, val_loss=2.19, val_accuracy=0.482, lr=0.1] 46%|████▌     | 53/115 [19:15<20:57, 20.28s/epoch, loss=1.12, accuracy=0.754, val_loss=2.96, val_accuracy=0.359, lr=0.1] 47%|████▋     | 54/115 [19:36<20:58, 20.63s/epoch, loss=1.12, accuracy=0.757, val_loss=1.65, val_accuracy=0.556, lr=0.0316] 48%|████▊     | 55/115 [19:57<20:31, 20.53s/epoch, loss=1.11, accuracy=0.755, val_loss=3.66, val_accuracy=0.412, lr=0.1]    49%|████▊     | 56/115 [20:17<20:12, 20.56s/epoch, loss=1.12, accuracy=0.754, val_loss=1.66, val_accuracy=0.581, lr=0.1] 50%|████▉     | 57/115 [20:37<19:37, 20.31s/epoch, loss=1.12, accuracy=0.756, val_loss=1.83, val_accuracy=0.543, lr=0.1] 50%|█████     | 58/115 [20:59<19:42, 20.75s/epoch, loss=1.11, accuracy=0.759, val_loss=4.79, val_accuracy=0.266, lr=0.1] 51%|█████▏    | 59/115 [21:21<19:42, 21.12s/epoch, loss=1.12, accuracy=0.755, val_loss=2.58, val_accuracy=0.426, lr=0.0316] 52%|█████▏    | 60/115 [21:42<19:20, 21.09s/epoch, loss=1.12, accuracy=0.756, val_loss=2.05, val_accuracy=0.442, lr=0.1]    53%|█████▎    | 61/115 [22:03<19:09, 21.28s/epoch, loss=1.12, accuracy=0.755, val_loss=1.7, val_accuracy=0.6, lr=0.1]    54%|█████▍    | 62/115 [22:25<18:58, 21.48s/epoch, loss=1.12, accuracy=0.757, val_loss=3.44, val_accuracy=0.385, lr=0.1] 55%|█████▍    | 63/115 [22:47<18:41, 21.57s/epoch, loss=1.11, accuracy=0.756, val_loss=2.57, val_accuracy=0.404, lr=0.1] 56%|█████▌    | 64/115 [23:07<17:58, 21.15s/epoch, loss=1.12, accuracy=0.755, val_loss=2.7, val_accuracy=0.464, lr=0.0316] 57%|█████▋    | 65/115 [23:30<17:56, 21.54s/epoch, loss=1.11, accuracy=0.757, val_loss=2.26, val_accuracy=0.506, lr=0.1]   57%|█████▋    | 66/115 [23:52<17:40, 21.64s/epoch, loss=1.11, accuracy=0.757, val_loss=1.88, val_accuracy=0.554, lr=0.1] 58%|█████▊    | 67/115 [24:14<17:25, 21.77s/epoch, loss=1.12, accuracy=0.756, val_loss=3.54, val_accuracy=0.364, lr=0.1] 59%|█████▉    | 68/115 [24:36<17:02, 21.76s/epoch, loss=1.11, accuracy=0.758, val_loss=2.65, val_accuracy=0.406, lr=0.1] 60%|██████    | 69/115 [24:57<16:33, 21.60s/epoch, loss=1.11, accuracy=0.759, val_loss=2.56, val_accuracy=0.353, lr=0.0316] 61%|██████    | 70/115 [25:19<16:14, 21.66s/epoch, loss=1.12, accuracy=0.758, val_loss=2.09, val_accuracy=0.493, lr=0.1]    62%|██████▏   | 71/115 [25:40<15:55, 21.71s/epoch, loss=1.11, accuracy=0.758, val_loss=1.67, val_accuracy=0.56, lr=0.1]  63%|██████▎   | 72/115 [26:02<15:34, 21.72s/epoch, loss=1.11, accuracy=0.756, val_loss=1.57, val_accuracy=0.598, lr=0.1] 63%|██████▎   | 73/115 [26:22<14:49, 21.18s/epoch, loss=1.11, accuracy=0.76, val_loss=1.46, val_accuracy=0.632, lr=0.1]  64%|██████▍   | 74/115 [26:42<14:14, 20.84s/epoch, loss=1.11, accuracy=0.756, val_loss=2.55, val_accuracy=0.401, lr=0.0316] 65%|██████▌   | 75/115 [27:04<14:04, 21.11s/epoch, loss=1.1, accuracy=0.76, val_loss=3.58, val_accuracy=0.299, lr=0.1]      66%|██████▌   | 76/115 [27:26<13:53, 21.37s/epoch, loss=1.1, accuracy=0.76, val_loss=1.64, val_accuracy=0.579, lr=0.1] 67%|██████▋   | 77/115 [27:48<13:38, 21.55s/epoch, loss=1.11, accuracy=0.759, val_loss=2.28, val_accuracy=0.382, lr=0.1] 68%|██████▊   | 78/115 [28:09<13:08, 21.31s/epoch, loss=1.11, accuracy=0.755, val_loss=4.18, val_accuracy=0.365, lr=0.1] 69%|██████▊   | 79/115 [28:30<12:51, 21.42s/epoch, loss=1.1, accuracy=0.759, val_loss=2.14, val_accuracy=0.396, lr=0.0316] 70%|██████▉   | 80/115 [28:52<12:30, 21.45s/epoch, loss=1.1, accuracy=0.761, val_loss=3.13, val_accuracy=0.363, lr=0.1]    70%|███████   | 81/115 [29:13<12:09, 21.46s/epoch, loss=1.11, accuracy=0.759, val_loss=1.59, val_accuracy=0.628, lr=0.1] 71%|███████▏  | 82/115 [29:34<11:40, 21.23s/epoch, loss=0.917, accuracy=0.812, val_loss=0.875, val_accuracy=0.813, lr=0.01] 72%|███████▏  | 83/115 [29:54<11:11, 20.99s/epoch, loss=0.739, accuracy=0.848, val_loss=0.742, val_accuracy=0.836, lr=0.01] 73%|███████▎  | 84/115 [30:15<10:51, 21.01s/epoch, loss=0.657, accuracy=0.856, val_loss=0.746, val_accuracy=0.819, lr=0.01] 74%|███████▍  | 85/115 [30:36<10:28, 20.94s/epoch, loss=0.609, accuracy=0.859, val_loss=0.731, val_accuracy=0.814, lr=0.01] 75%|███████▍  | 86/115 [30:57<10:10, 21.04s/epoch, loss=0.586, accuracy=0.862, val_loss=0.853, val_accuracy=0.769, lr=0.01] 76%|███████▌  | 87/115 [31:19<09:54, 21.24s/epoch, loss=0.569, accuracy=0.864, val_loss=0.765, val_accuracy=0.801, lr=0.01] 77%|███████▋  | 88/115 [31:41<09:37, 21.40s/epoch, loss=0.562, accuracy=0.863, val_loss=1.14, val_accuracy=0.713, lr=0.01]  77%|███████▋  | 89/115 [32:02<09:17, 21.44s/epoch, loss=0.561, accuracy=0.865, val_loss=0.923, val_accuracy=0.773, lr=0.01] 78%|███████▊  | 90/115 [32:24<08:54, 21.39s/epoch, loss=0.556, accuracy=0.865, val_loss=0.834, val_accuracy=0.782, lr=0.00316] 79%|███████▉  | 91/115 [32:45<08:36, 21.51s/epoch, loss=0.556, accuracy=0.868, val_loss=0.703, val_accuracy=0.821, lr=0.01]    80%|████████  | 92/115 [33:07<08:15, 21.53s/epoch, loss=0.555, accuracy=0.868, val_loss=0.972, val_accuracy=0.746, lr=0.01] 81%|████████  | 93/115 [33:29<07:54, 21.58s/epoch, loss=0.551, accuracy=0.871, val_loss=0.889, val_accuracy=0.763, lr=0.01] 82%|████████▏ | 94/115 [33:51<07:35, 21.67s/epoch, loss=0.552, accuracy=0.872, val_loss=0.824, val_accuracy=0.781, lr=0.01] 83%|████████▎ | 95/115 [34:12<07:13, 21.66s/epoch, loss=0.551, accuracy=0.872, val_loss=0.779, val_accuracy=0.803, lr=0.01] 83%|████████▎ | 96/115 [34:33<06:45, 21.36s/epoch, loss=0.548, accuracy=0.875, val_loss=1.21, val_accuracy=0.713, lr=0.00316] 84%|████████▍ | 97/115 [34:55<06:25, 21.44s/epoch, loss=0.549, accuracy=0.876, val_loss=0.731, val_accuracy=0.813, lr=0.01]   85%|████████▌ | 98/115 [35:14<05:54, 20.87s/epoch, loss=0.549, accuracy=0.875, val_loss=0.841, val_accuracy=0.78, lr=0.01]  86%|████████▌ | 99/115 [35:34<05:26, 20.43s/epoch, loss=0.548, accuracy=0.876, val_loss=0.724, val_accuracy=0.813, lr=0.01] 87%|████████▋ | 100/115 [35:55<05:12, 20.80s/epoch, loss=0.547, accuracy=0.879, val_loss=0.785, val_accuracy=0.797, lr=0.01] 88%|████████▊ | 101/115 [36:15<04:45, 20.40s/epoch, loss=0.548, accuracy=0.877, val_loss=1.22, val_accuracy=0.691, lr=0.00316] 89%|████████▊ | 102/115 [36:35<04:23, 20.26s/epoch, loss=0.545, accuracy=0.879, val_loss=0.915, val_accuracy=0.751, lr=0.01]   90%|████████▉ | 103/115 [36:55<04:03, 20.31s/epoch, loss=0.544, accuracy=0.88, val_loss=0.868, val_accuracy=0.779, lr=0.01]  90%|█████████ | 104/115 [37:16<03:46, 20.60s/epoch, loss=0.544, accuracy=0.883, val_loss=0.812, val_accuracy=0.807, lr=0.01] 91%|█████████▏| 105/115 [37:38<03:28, 20.82s/epoch, loss=0.543, accuracy=0.882, val_loss=0.886, val_accuracy=0.77, lr=0.01]  92%|█████████▏| 106/115 [37:59<03:09, 21.06s/epoch, loss=0.545, accuracy=0.88, val_loss=0.795, val_accuracy=0.801, lr=0.00316] 93%|█████████▎| 107/115 [38:20<02:48, 21.02s/epoch, loss=0.546, accuracy=0.882, val_loss=1.18, val_accuracy=0.744, lr=0.01]    94%|█████████▍| 108/115 [38:41<02:27, 21.01s/epoch, loss=0.54, accuracy=0.885, val_loss=0.714, val_accuracy=0.828, lr=0.01] 95%|█████████▍| 109/115 [39:01<02:03, 20.55s/epoch, loss=0.546, accuracy=0.882, val_loss=1.21, val_accuracy=0.73, lr=0.01]  96%|█████████▌| 110/115 [39:22<01:44, 20.82s/epoch, loss=0.544, accuracy=0.883, val_loss=0.881, val_accuracy=0.769, lr=0.01] 97%|█████████▋| 111/115 [39:44<01:24, 21.09s/epoch, loss=0.545, accuracy=0.885, val_loss=0.955, val_accuracy=0.775, lr=0.00316] 97%|█████████▋| 112/115 [40:05<01:03, 21.23s/epoch, loss=0.548, accuracy=0.883, val_loss=0.705, val_accuracy=0.84, lr=0.01]     98%|█████████▊| 113/115 [40:26<00:41, 21.00s/epoch, loss=0.54, accuracy=0.886, val_loss=0.698, val_accuracy=0.836, lr=0.01] 99%|█████████▉| 114/115 [40:45<00:20, 20.54s/epoch, loss=0.542, accuracy=0.885, val_loss=0.85, val_accuracy=0.789, lr=0.01]100%|██████████| 115/115 [41:06<00:00, 20.71s/epoch, loss=0.543, accuracy=0.883, val_loss=1.21, val_accuracy=0.705, lr=0.01]100%|██████████| 115/115 [41:06<00:00, 21.45s/epoch, loss=0.543, accuracy=0.883, val_loss=1.21, val_accuracy=0.705, lr=0.01]
Using real-time data augmentation.
Test score: 0.7189173698425293
Test accuracy: 0.8342000246047974


* * * Run SGD for ID = 13_10. * * *


2024-02-20 01:20:14.118599: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 01:20:16.892588: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 01:20:16.893603: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-20 01:20:16.932107: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-20 01:20:16.932143: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 01:20:16.935185: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 01:20:16.935230: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-20 01:20:16.937504: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-20 01:20:16.938710: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-20 01:20:16.941238: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-20 01:20:16.942825: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-20 01:20:16.947801: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 01:20:16.948346: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-20 01:20:16.948434: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 01:20:18.453815: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-20 01:20:18.455025: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 01:20:18.455885: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-20 01:20:18.455921: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 01:20:18.455957: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 01:20:18.455977: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-20 01:20:18.455996: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-20 01:20:18.456023: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-20 01:20:18.456041: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-20 01:20:18.456072: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-20 01:20:18.456093: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 01:20:18.456541: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-20 01:20:18.456580: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 01:20:19.117881: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-20 01:20:19.117951: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-20 01:20:19.117969: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-20 01:20:19.118932: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:83:00.0, compute capability: 6.1)
{'id': '13_10', 'batch_size': 128, 'epochs': 115, 'validation_split': 0.1, 'checkpointing': True, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
x_train shape: (45000, 32, 32, 3)
45000 train samples
5000 validation samples
10000 test samples
y_train shape: (45000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/115 [00:00<?, ?epoch/s]2024-02-20 01:20:19.964264: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-20 01:20:19.964761: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199825000 Hz
2024-02-20 01:20:22.174156: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 01:20:22.424593: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 01:20:23.206801: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-20 01:20:23.269339: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/115 [00:56<1:47:19, 56.49s/epoch, loss=4.32, accuracy=0.307, val_loss=2.58, val_accuracy=0.258, lr=0.1]  2%|▏         | 2/115 [01:18<1:07:44, 35.97s/epoch, loss=1.71, accuracy=0.502, val_loss=2.89, val_accuracy=0.332, lr=0.1]  3%|▎         | 3/115 [01:39<54:37, 29.27s/epoch, loss=1.48, accuracy=0.582, val_loss=3.82, val_accuracy=0.329, lr=0.1]    3%|▎         | 4/115 [02:01<48:54, 26.43s/epoch, loss=1.39, accuracy=0.634, val_loss=2.17, val_accuracy=0.377, lr=0.1]  4%|▍         | 5/115 [02:23<45:50, 25.00s/epoch, loss=1.34, accuracy=0.663, val_loss=2.22, val_accuracy=0.417, lr=0.1]  5%|▌         | 6/115 [02:46<43:43, 24.07s/epoch, loss=1.31, accuracy=0.681, val_loss=2.3, val_accuracy=0.456, lr=0.1]   6%|▌         | 7/115 [03:06<40:50, 22.69s/epoch, loss=1.28, accuracy=0.696, val_loss=2.15, val_accuracy=0.482, lr=0.1]  7%|▋         | 8/115 [03:27<39:45, 22.30s/epoch, loss=1.27, accuracy=0.704, val_loss=2.37, val_accuracy=0.382, lr=0.1]  8%|▊         | 9/115 [03:48<38:46, 21.94s/epoch, loss=1.26, accuracy=0.712, val_loss=1.6, val_accuracy=0.58, lr=0.1]    9%|▊         | 10/115 [04:10<38:26, 21.97s/epoch, loss=1.25, accuracy=0.716, val_loss=1.6, val_accuracy=0.6, lr=0.1] 10%|▉         | 11/115 [04:32<37:53, 21.86s/epoch, loss=1.24, accuracy=0.721, val_loss=2.35, val_accuracy=0.467, lr=0.1] 10%|█         | 12/115 [04:54<37:39, 21.94s/epoch, loss=1.25, accuracy=0.721, val_loss=2.19, val_accuracy=0.435, lr=0.1] 11%|█▏        | 13/115 [05:16<37:14, 21.91s/epoch, loss=1.24, accuracy=0.728, val_loss=2.17, val_accuracy=0.5, lr=0.1]   12%|█▏        | 14/115 [05:35<35:44, 21.24s/epoch, loss=1.22, accuracy=0.73, val_loss=2.59, val_accuracy=0.432, lr=0.0316] 13%|█▎        | 15/115 [05:57<35:29, 21.29s/epoch, loss=1.22, accuracy=0.732, val_loss=1.55, val_accuracy=0.611, lr=0.1]   14%|█▍        | 16/115 [06:18<35:13, 21.35s/epoch, loss=1.23, accuracy=0.731, val_loss=1.71, val_accuracy=0.577, lr=0.1] 15%|█▍        | 17/115 [06:38<34:12, 20.94s/epoch, loss=1.22, accuracy=0.734, val_loss=1.53, val_accuracy=0.605, lr=0.1] 16%|█▌        | 18/115 [07:00<34:22, 21.27s/epoch, loss=1.2, accuracy=0.738, val_loss=2.1, val_accuracy=0.524, lr=0.1]   17%|█▋        | 19/115 [07:22<34:16, 21.42s/epoch, loss=1.22, accuracy=0.734, val_loss=1.73, val_accuracy=0.569, lr=0.1] 17%|█▋        | 20/115 [07:44<34:10, 21.59s/epoch, loss=1.21, accuracy=0.739, val_loss=2.23, val_accuracy=0.504, lr=0.1] 18%|█▊        | 21/115 [08:04<32:52, 20.98s/epoch, loss=1.21, accuracy=0.741, val_loss=2.01, val_accuracy=0.477, lr=0.1] 19%|█▉        | 22/115 [08:26<32:58, 21.28s/epoch, loss=1.21, accuracy=0.741, val_loss=2.27, val_accuracy=0.452, lr=0.0316] 20%|██        | 23/115 [08:47<32:52, 21.44s/epoch, loss=1.2, accuracy=0.742, val_loss=2.07, val_accuracy=0.479, lr=0.1]     21%|██        | 24/115 [09:09<32:38, 21.53s/epoch, loss=1.19, accuracy=0.743, val_loss=2.99, val_accuracy=0.355, lr=0.1] 22%|██▏       | 25/115 [09:29<31:27, 20.98s/epoch, loss=1.19, accuracy=0.741, val_loss=1.85, val_accuracy=0.519, lr=0.1] 23%|██▎       | 26/115 [09:51<31:40, 21.35s/epoch, loss=1.19, accuracy=0.742, val_loss=2.05, val_accuracy=0.531, lr=0.1] 23%|██▎       | 27/115 [10:13<31:36, 21.55s/epoch, loss=1.19, accuracy=0.743, val_loss=1.6, val_accuracy=0.606, lr=0.0316] 24%|██▍       | 28/115 [10:35<31:19, 21.60s/epoch, loss=1.18, accuracy=0.744, val_loss=2.48, val_accuracy=0.466, lr=0.1]   25%|██▌       | 29/115 [10:57<31:08, 21.73s/epoch, loss=1.18, accuracy=0.744, val_loss=2.76, val_accuracy=0.343, lr=0.1] 26%|██▌       | 30/115 [11:19<30:47, 21.73s/epoch, loss=1.18, accuracy=0.748, val_loss=2.29, val_accuracy=0.48, lr=0.1]  27%|██▋       | 31/115 [11:39<30:01, 21.45s/epoch, loss=1.18, accuracy=0.744, val_loss=1.81, val_accuracy=0.531, lr=0.1] 28%|██▊       | 32/115 [12:02<29:56, 21.65s/epoch, loss=1.18, accuracy=0.744, val_loss=2.2, val_accuracy=0.491, lr=0.0316] 29%|██▊       | 33/115 [12:23<29:26, 21.54s/epoch, loss=1.18, accuracy=0.746, val_loss=3.14, val_accuracy=0.411, lr=0.1]   30%|██▉       | 34/115 [12:44<28:48, 21.33s/epoch, loss=1.18, accuracy=0.747, val_loss=1.77, val_accuracy=0.538, lr=0.1] 30%|███       | 35/115 [13:05<28:35, 21.45s/epoch, loss=1.18, accuracy=0.746, val_loss=1.54, val_accuracy=0.631, lr=0.1] 31%|███▏      | 36/115 [13:27<28:23, 21.57s/epoch, loss=1.18, accuracy=0.747, val_loss=6, val_accuracy=0.218, lr=0.1]    32%|███▏      | 37/115 [13:47<27:18, 21.00s/epoch, loss=1.17, accuracy=0.748, val_loss=2.28, val_accuracy=0.468, lr=0.0316] 33%|███▎      | 38/115 [14:09<27:22, 21.33s/epoch, loss=1.17, accuracy=0.748, val_loss=1.41, val_accuracy=0.661, lr=0.1]    34%|███▍      | 39/115 [14:30<26:42, 21.09s/epoch, loss=1.17, accuracy=0.749, val_loss=3.51, val_accuracy=0.304, lr=0.1] 35%|███▍      | 40/115 [14:52<26:51, 21.48s/epoch, loss=1.17, accuracy=0.748, val_loss=1.66, val_accuracy=0.565, lr=0.1] 36%|███▌      | 41/115 [15:13<26:28, 21.46s/epoch, loss=1.17, accuracy=0.744, val_loss=1.79, val_accuracy=0.553, lr=0.1] 37%|███▋      | 42/115 [15:36<26:24, 21.70s/epoch, loss=1.17, accuracy=0.75, val_loss=2.58, val_accuracy=0.32, lr=0.1]   37%|███▋      | 43/115 [15:58<26:08, 21.79s/epoch, loss=1.16, accuracy=0.75, val_loss=1.73, val_accuracy=0.555, lr=0.0316] 38%|███▊      | 44/115 [16:18<25:11, 21.29s/epoch, loss=1.17, accuracy=0.747, val_loss=2.44, val_accuracy=0.448, lr=0.1]   39%|███▉      | 45/115 [16:39<24:45, 21.22s/epoch, loss=1.17, accuracy=0.746, val_loss=2.37, val_accuracy=0.498, lr=0.1] 40%|████      | 46/115 [17:01<24:35, 21.38s/epoch, loss=1.17, accuracy=0.75, val_loss=2.16, val_accuracy=0.49, lr=0.1]   41%|████      | 47/115 [17:22<24:20, 21.48s/epoch, loss=1.16, accuracy=0.748, val_loss=1.66, val_accuracy=0.558, lr=0.1] 42%|████▏     | 48/115 [17:44<24:11, 21.66s/epoch, loss=1.16, accuracy=0.751, val_loss=2.24, val_accuracy=0.496, lr=0.0316] 43%|████▎     | 49/115 [18:05<23:35, 21.44s/epoch, loss=1.16, accuracy=0.749, val_loss=1.53, val_accuracy=0.63, lr=0.1]     43%|████▎     | 50/115 [18:27<23:25, 21.63s/epoch, loss=1.16, accuracy=0.748, val_loss=1.73, val_accuracy=0.548, lr=0.1] 44%|████▍     | 51/115 [18:49<23:11, 21.75s/epoch, loss=1.16, accuracy=0.751, val_loss=2.25, val_accuracy=0.479, lr=0.1] 45%|████▌     | 52/115 [19:11<22:51, 21.78s/epoch, loss=1.16, accuracy=0.749, val_loss=2.22, val_accuracy=0.412, lr=0.1] 46%|████▌     | 53/115 [19:33<22:27, 21.73s/epoch, loss=1.16, accuracy=0.751, val_loss=1.62, val_accuracy=0.608, lr=0.0316] 47%|████▋     | 54/115 [19:54<22:03, 21.70s/epoch, loss=1.16, accuracy=0.75, val_loss=2.86, val_accuracy=0.299, lr=0.1]     48%|████▊     | 55/115 [20:16<21:39, 21.66s/epoch, loss=1.15, accuracy=0.75, val_loss=2.16, val_accuracy=0.432, lr=0.1] 49%|████▊     | 56/115 [20:37<21:02, 21.40s/epoch, loss=1.15, accuracy=0.75, val_loss=1.55, val_accuracy=0.604, lr=0.1] 50%|████▉     | 57/115 [20:59<20:48, 21.52s/epoch, loss=1.16, accuracy=0.749, val_loss=2.51, val_accuracy=0.411, lr=0.1] 50%|█████     | 58/115 [21:21<20:33, 21.64s/epoch, loss=1.15, accuracy=0.753, val_loss=1.7, val_accuracy=0.551, lr=0.0316] 51%|█████▏    | 59/115 [21:42<20:10, 21.62s/epoch, loss=1.16, accuracy=0.75, val_loss=2.68, val_accuracy=0.474, lr=0.1]    52%|█████▏    | 60/115 [22:02<19:15, 21.01s/epoch, loss=1.16, accuracy=0.75, val_loss=2.36, val_accuracy=0.421, lr=0.1] 53%|█████▎    | 61/115 [22:22<18:41, 20.77s/epoch, loss=1.16, accuracy=0.753, val_loss=2.29, val_accuracy=0.459, lr=0.1] 54%|█████▍    | 62/115 [22:42<18:08, 20.53s/epoch, loss=1.16, accuracy=0.752, val_loss=1.89, val_accuracy=0.484, lr=0.1] 55%|█████▍    | 63/115 [23:04<18:06, 20.90s/epoch, loss=1.15, accuracy=0.752, val_loss=3.13, val_accuracy=0.389, lr=0.0316] 56%|█████▌    | 64/115 [23:25<17:49, 20.96s/epoch, loss=1.14, accuracy=0.752, val_loss=1.98, val_accuracy=0.501, lr=0.1]    57%|█████▋    | 65/115 [23:44<17:06, 20.53s/epoch, loss=1.15, accuracy=0.755, val_loss=1.67, val_accuracy=0.611, lr=0.1] 57%|█████▋    | 66/115 [24:05<16:50, 20.63s/epoch, loss=1.15, accuracy=0.753, val_loss=2.87, val_accuracy=0.343, lr=0.1] 58%|█████▊    | 67/115 [24:26<16:40, 20.84s/epoch, loss=1.15, accuracy=0.752, val_loss=1.75, val_accuracy=0.588, lr=0.1] 59%|█████▉    | 68/115 [24:48<16:32, 21.11s/epoch, loss=1.14, accuracy=0.755, val_loss=1.62, val_accuracy=0.621, lr=0.0316] 60%|██████    | 69/115 [25:10<16:19, 21.30s/epoch, loss=1.15, accuracy=0.753, val_loss=1.81, val_accuracy=0.602, lr=0.1]    61%|██████    | 70/115 [25:32<16:07, 21.50s/epoch, loss=1.15, accuracy=0.754, val_loss=1.36, val_accuracy=0.671, lr=0.1] 62%|██████▏   | 71/115 [25:53<15:45, 21.50s/epoch, loss=1.14, accuracy=0.756, val_loss=2.49, val_accuracy=0.387, lr=0.1] 63%|██████▎   | 72/115 [26:13<14:58, 20.89s/epoch, loss=1.14, accuracy=0.754, val_loss=2.32, val_accuracy=0.473, lr=0.1] 63%|██████▎   | 73/115 [26:34<14:43, 21.02s/epoch, loss=1.14, accuracy=0.753, val_loss=2.42, val_accuracy=0.486, lr=0.1] 64%|██████▍   | 74/115 [26:56<14:29, 21.22s/epoch, loss=1.15, accuracy=0.751, val_loss=2.18, val_accuracy=0.405, lr=0.1] 65%|██████▌   | 75/115 [27:17<14:10, 21.27s/epoch, loss=1.15, accuracy=0.752, val_loss=1.67, val_accuracy=0.595, lr=0.0316] 66%|██████▌   | 76/115 [27:39<13:56, 21.46s/epoch, loss=1.14, accuracy=0.755, val_loss=1.58, val_accuracy=0.601, lr=0.1]    67%|██████▋   | 77/115 [28:01<13:34, 21.44s/epoch, loss=1.15, accuracy=0.753, val_loss=1.91, val_accuracy=0.488, lr=0.1] 68%|██████▊   | 78/115 [28:22<13:17, 21.54s/epoch, loss=1.14, accuracy=0.756, val_loss=1.82, val_accuracy=0.504, lr=0.1] 69%|██████▊   | 79/115 [28:44<12:52, 21.45s/epoch, loss=1.14, accuracy=0.756, val_loss=2.22, val_accuracy=0.506, lr=0.1] 70%|██████▉   | 80/115 [29:05<12:33, 21.53s/epoch, loss=1.14, accuracy=0.754, val_loss=1.65, val_accuracy=0.58, lr=0.0316] 70%|███████   | 81/115 [29:27<12:14, 21.59s/epoch, loss=1.15, accuracy=0.752, val_loss=3.11, val_accuracy=0.392, lr=0.1]   71%|███████▏  | 82/115 [29:49<11:57, 21.74s/epoch, loss=0.937, accuracy=0.813, val_loss=0.905, val_accuracy=0.812, lr=0.01] 72%|███████▏  | 83/115 [30:09<11:13, 21.04s/epoch, loss=0.762, accuracy=0.843, val_loss=0.854, val_accuracy=0.805, lr=0.01] 73%|███████▎  | 84/115 [30:30<10:54, 21.10s/epoch, loss=0.676, accuracy=0.854, val_loss=0.715, val_accuracy=0.834, lr=0.01] 74%|███████▍  | 85/115 [30:51<10:33, 21.11s/epoch, loss=0.63, accuracy=0.857, val_loss=0.696, val_accuracy=0.831, lr=0.01]  75%|███████▍  | 86/115 [31:10<09:58, 20.63s/epoch, loss=0.598, accuracy=0.861, val_loss=0.696, val_accuracy=0.823, lr=0.01] 76%|███████▌  | 87/115 [31:32<09:44, 20.86s/epoch, loss=0.584, accuracy=0.863, val_loss=0.933, val_accuracy=0.751, lr=0.01] 77%|███████▋  | 88/115 [31:54<09:30, 21.13s/epoch, loss=0.577, accuracy=0.863, val_loss=0.74, val_accuracy=0.805, lr=0.01]  77%|███████▋  | 89/115 [32:14<09:03, 20.90s/epoch, loss=0.572, accuracy=0.863, val_loss=0.829, val_accuracy=0.798, lr=0.01] 78%|███████▊  | 90/115 [32:35<08:46, 21.04s/epoch, loss=0.57, accuracy=0.864, val_loss=0.802, val_accuracy=0.805, lr=0.00316] 79%|███████▉  | 91/115 [32:57<08:30, 21.27s/epoch, loss=0.569, accuracy=0.866, val_loss=0.854, val_accuracy=0.784, lr=0.01]   80%|████████  | 92/115 [33:18<08:04, 21.06s/epoch, loss=0.568, accuracy=0.868, val_loss=0.854, val_accuracy=0.789, lr=0.01] 81%|████████  | 93/115 [33:37<07:33, 20.59s/epoch, loss=0.564, accuracy=0.868, val_loss=0.856, val_accuracy=0.784, lr=0.01] 82%|████████▏ | 94/115 [33:58<07:16, 20.79s/epoch, loss=0.564, accuracy=0.871, val_loss=0.786, val_accuracy=0.803, lr=0.01] 83%|████████▎ | 95/115 [34:20<07:00, 21.01s/epoch, loss=0.566, accuracy=0.871, val_loss=1.22, val_accuracy=0.685, lr=0.00316] 83%|████████▎ | 96/115 [34:39<06:30, 20.55s/epoch, loss=0.564, accuracy=0.871, val_loss=0.864, val_accuracy=0.789, lr=0.01]   84%|████████▍ | 97/115 [35:01<06:15, 20.87s/epoch, loss=0.562, accuracy=0.873, val_loss=0.768, val_accuracy=0.819, lr=0.01] 85%|████████▌ | 98/115 [35:20<05:46, 20.40s/epoch, loss=0.56, accuracy=0.873, val_loss=0.776, val_accuracy=0.807, lr=0.01]  86%|████████▌ | 99/115 [35:41<05:25, 20.37s/epoch, loss=0.561, accuracy=0.876, val_loss=0.872, val_accuracy=0.795, lr=0.01] 87%|████████▋ | 100/115 [36:02<05:09, 20.61s/epoch, loss=0.56, accuracy=0.877, val_loss=0.836, val_accuracy=0.801, lr=0.00316] 88%|████████▊ | 101/115 [36:23<04:51, 20.84s/epoch, loss=0.557, accuracy=0.878, val_loss=0.757, val_accuracy=0.82, lr=0.01]    89%|████████▊ | 102/115 [36:45<04:34, 21.11s/epoch, loss=0.563, accuracy=0.877, val_loss=0.888, val_accuracy=0.782, lr=0.01] 90%|████████▉ | 103/115 [37:07<04:14, 21.25s/epoch, loss=0.555, accuracy=0.879, val_loss=1.09, val_accuracy=0.719, lr=0.01]  90%|█████████ | 104/115 [37:28<03:53, 21.19s/epoch, loss=0.556, accuracy=0.879, val_loss=1.33, val_accuracy=0.668, lr=0.01] 91%|█████████▏| 105/115 [37:49<03:33, 21.40s/epoch, loss=0.559, accuracy=0.88, val_loss=0.696, val_accuracy=0.835, lr=0.00316] 92%|█████████▏| 106/115 [38:12<03:14, 21.59s/epoch, loss=0.556, accuracy=0.882, val_loss=0.707, val_accuracy=0.836, lr=0.01]   93%|█████████▎| 107/115 [38:32<02:48, 21.12s/epoch, loss=0.558, accuracy=0.878, val_loss=0.739, val_accuracy=0.825, lr=0.01] 94%|█████████▍| 108/115 [38:53<02:28, 21.24s/epoch, loss=0.558, accuracy=0.882, val_loss=1.04, val_accuracy=0.736, lr=0.01]  95%|█████████▍| 109/115 [39:12<02:04, 20.67s/epoch, loss=0.554, accuracy=0.882, val_loss=0.939, val_accuracy=0.773, lr=0.01] 96%|█████████▌| 110/115 [39:33<01:43, 20.72s/epoch, loss=0.559, accuracy=0.881, val_loss=0.885, val_accuracy=0.784, lr=0.00316] 97%|█████████▋| 111/115 [39:54<01:23, 20.80s/epoch, loss=0.556, accuracy=0.884, val_loss=0.817, val_accuracy=0.808, lr=0.01]    97%|█████████▋| 112/115 [40:16<01:03, 21.02s/epoch, loss=0.557, accuracy=0.883, val_loss=0.738, val_accuracy=0.828, lr=0.01] 98%|█████████▊| 113/115 [40:37<00:42, 21.24s/epoch, loss=0.559, accuracy=0.882, val_loss=1.19, val_accuracy=0.711, lr=0.01]  99%|█████████▉| 114/115 [40:59<00:21, 21.21s/epoch, loss=0.557, accuracy=0.884, val_loss=0.825, val_accuracy=0.808, lr=0.01]100%|██████████| 115/115 [41:20<00:00, 21.27s/epoch, loss=0.552, accuracy=0.885, val_loss=1.27, val_accuracy=0.682, lr=0.00316]100%|██████████| 115/115 [41:20<00:00, 21.57s/epoch, loss=0.552, accuracy=0.885, val_loss=1.27, val_accuracy=0.682, lr=0.00316]
Using real-time data augmentation.
Test score: 0.7348616719245911
Test accuracy: 0.8205999732017517


* * * Run SGD for ID = 13_11. * * *


2024-02-20 02:01:46.612997: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 02:01:49.324304: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 02:01:49.325284: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-20 02:01:49.364223: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-20 02:01:49.364261: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 02:01:49.367394: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 02:01:49.367435: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-20 02:01:49.369706: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-20 02:01:49.370498: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-20 02:01:49.373118: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-20 02:01:49.374807: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-20 02:01:49.379776: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 02:01:49.380320: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-20 02:01:49.380403: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 02:01:50.820851: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-20 02:01:50.821433: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 02:01:50.822240: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-20 02:01:50.822277: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 02:01:50.822313: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 02:01:50.822332: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-20 02:01:50.822365: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-20 02:01:50.822384: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-20 02:01:50.822401: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-20 02:01:50.822417: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-20 02:01:50.822434: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 02:01:50.822877: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-20 02:01:50.822913: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 02:01:51.455962: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-20 02:01:51.456025: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-20 02:01:51.456037: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-20 02:01:51.456975: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:83:00.0, compute capability: 6.1)
{'id': '13_11', 'batch_size': 128, 'epochs': 115, 'validation_split': 0.1, 'checkpointing': True, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
x_train shape: (45000, 32, 32, 3)
45000 train samples
5000 validation samples
10000 test samples
y_train shape: (45000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/115 [00:00<?, ?epoch/s]2024-02-20 02:01:52.281509: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-20 02:01:52.293178: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199825000 Hz
2024-02-20 02:01:54.386672: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 02:01:54.673672: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 02:01:55.459763: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-20 02:01:55.524295: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/115 [00:56<1:46:36, 56.11s/epoch, loss=3.35, accuracy=0.281, val_loss=2.21, val_accuracy=0.297, lr=0.1]  2%|▏         | 2/115 [01:16<1:06:12, 35.15s/epoch, loss=1.69, accuracy=0.47, val_loss=1.93, val_accuracy=0.404, lr=0.1]   3%|▎         | 3/115 [01:37<53:43, 28.78s/epoch, loss=1.46, accuracy=0.576, val_loss=1.97, val_accuracy=0.474, lr=0.1]   3%|▎         | 4/115 [01:59<47:51, 25.87s/epoch, loss=1.35, accuracy=0.648, val_loss=2.02, val_accuracy=0.441, lr=0.1]  4%|▍         | 5/115 [02:20<44:35, 24.32s/epoch, loss=1.29, accuracy=0.686, val_loss=1.61, val_accuracy=0.592, lr=0.1]  5%|▌         | 6/115 [02:40<41:36, 22.91s/epoch, loss=1.26, accuracy=0.701, val_loss=1.93, val_accuracy=0.46, lr=0.1]   6%|▌         | 7/115 [03:02<40:43, 22.62s/epoch, loss=1.25, accuracy=0.709, val_loss=2.08, val_accuracy=0.515, lr=0.1]  7%|▋         | 8/115 [03:24<39:57, 22.41s/epoch, loss=1.24, accuracy=0.716, val_loss=1.96, val_accuracy=0.452, lr=0.1]  8%|▊         | 9/115 [03:47<39:36, 22.42s/epoch, loss=1.24, accuracy=0.722, val_loss=1.65, val_accuracy=0.602, lr=0.1]  9%|▊         | 10/115 [04:07<37:50, 21.63s/epoch, loss=1.22, accuracy=0.728, val_loss=2.08, val_accuracy=0.498, lr=0.0316] 10%|▉         | 11/115 [04:26<36:24, 21.00s/epoch, loss=1.23, accuracy=0.728, val_loss=1.59, val_accuracy=0.59, lr=0.1]     10%|█         | 12/115 [04:48<36:19, 21.16s/epoch, loss=1.22, accuracy=0.73, val_loss=1.85, val_accuracy=0.549, lr=0.1] 11%|█▏        | 13/115 [05:07<35:00, 20.59s/epoch, loss=1.22, accuracy=0.731, val_loss=2.42, val_accuracy=0.494, lr=0.1] 12%|█▏        | 14/115 [05:29<35:10, 20.90s/epoch, loss=1.21, accuracy=0.733, val_loss=1.82, val_accuracy=0.497, lr=0.1] 13%|█▎        | 15/115 [05:50<35:12, 21.12s/epoch, loss=1.21, accuracy=0.736, val_loss=1.54, val_accuracy=0.637, lr=0.1] 14%|█▍        | 16/115 [06:11<34:24, 20.85s/epoch, loss=1.21, accuracy=0.737, val_loss=1.49, val_accuracy=0.641, lr=0.1] 15%|█▍        | 17/115 [06:32<34:23, 21.06s/epoch, loss=1.2, accuracy=0.74, val_loss=1.8, val_accuracy=0.589, lr=0.1]    16%|█▌        | 18/115 [06:54<34:24, 21.29s/epoch, loss=1.2, accuracy=0.737, val_loss=1.79, val_accuracy=0.534, lr=0.1] 17%|█▋        | 19/115 [07:13<33:12, 20.75s/epoch, loss=1.2, accuracy=0.74, val_loss=1.92, val_accuracy=0.468, lr=0.1]  17%|█▋        | 20/115 [07:34<32:42, 20.66s/epoch, loss=1.21, accuracy=0.739, val_loss=5.26, val_accuracy=0.252, lr=0.1] 18%|█▊        | 21/115 [07:55<32:41, 20.86s/epoch, loss=1.2, accuracy=0.74, val_loss=3.35, val_accuracy=0.352, lr=0.0316] 19%|█▉        | 22/115 [08:17<32:44, 21.12s/epoch, loss=1.19, accuracy=0.744, val_loss=2.02, val_accuracy=0.53, lr=0.1]   20%|██        | 23/115 [08:38<32:27, 21.17s/epoch, loss=1.19, accuracy=0.744, val_loss=2.08, val_accuracy=0.536, lr=0.1] 21%|██        | 24/115 [09:00<32:16, 21.28s/epoch, loss=1.19, accuracy=0.742, val_loss=1.61, val_accuracy=0.606, lr=0.1] 22%|██▏       | 25/115 [09:20<31:37, 21.09s/epoch, loss=1.19, accuracy=0.743, val_loss=2.23, val_accuracy=0.476, lr=0.1] 23%|██▎       | 26/115 [09:41<31:16, 21.09s/epoch, loss=1.18, accuracy=0.746, val_loss=1.77, val_accuracy=0.569, lr=0.0316] 23%|██▎       | 27/115 [10:02<30:44, 20.96s/epoch, loss=1.18, accuracy=0.746, val_loss=1.86, val_accuracy=0.575, lr=0.1]    24%|██▍       | 28/115 [10:23<30:15, 20.87s/epoch, loss=1.19, accuracy=0.743, val_loss=1.42, val_accuracy=0.663, lr=0.1] 25%|██▌       | 29/115 [10:42<29:16, 20.42s/epoch, loss=1.18, accuracy=0.745, val_loss=1.6, val_accuracy=0.593, lr=0.1]  26%|██▌       | 30/115 [11:03<29:12, 20.62s/epoch, loss=1.17, accuracy=0.749, val_loss=2.48, val_accuracy=0.454, lr=0.1] 27%|██▋       | 31/115 [11:25<29:16, 20.92s/epoch, loss=1.17, accuracy=0.747, val_loss=2.1, val_accuracy=0.476, lr=0.1]  28%|██▊       | 32/115 [11:46<29:11, 21.10s/epoch, loss=1.17, accuracy=0.749, val_loss=1.88, val_accuracy=0.484, lr=0.1] 29%|██▊       | 33/115 [12:06<28:16, 20.69s/epoch, loss=1.16, accuracy=0.75, val_loss=2.08, val_accuracy=0.484, lr=0.0316] 30%|██▉       | 34/115 [12:27<28:01, 20.75s/epoch, loss=1.17, accuracy=0.748, val_loss=2.02, val_accuracy=0.539, lr=0.1]   30%|███       | 35/115 [12:48<27:56, 20.95s/epoch, loss=1.17, accuracy=0.747, val_loss=2.41, val_accuracy=0.44, lr=0.1]  31%|███▏      | 36/115 [13:10<27:42, 21.05s/epoch, loss=1.16, accuracy=0.749, val_loss=2.07, val_accuracy=0.481, lr=0.1] 32%|███▏      | 37/115 [13:29<26:48, 20.62s/epoch, loss=1.17, accuracy=0.75, val_loss=6.71, val_accuracy=0.216, lr=0.1]  33%|███▎      | 38/115 [13:49<26:04, 20.32s/epoch, loss=1.17, accuracy=0.747, val_loss=2.5, val_accuracy=0.43, lr=0.0316] 34%|███▍      | 39/115 [14:11<26:15, 20.73s/epoch, loss=1.17, accuracy=0.748, val_loss=3.13, val_accuracy=0.329, lr=0.1]  35%|███▍      | 40/115 [14:32<26:12, 20.97s/epoch, loss=1.16, accuracy=0.751, val_loss=2.43, val_accuracy=0.472, lr=0.1] 36%|███▌      | 41/115 [14:52<25:19, 20.54s/epoch, loss=1.16, accuracy=0.751, val_loss=1.69, val_accuracy=0.546, lr=0.1] 37%|███▋      | 42/115 [15:13<25:25, 20.90s/epoch, loss=1.15, accuracy=0.751, val_loss=1.54, val_accuracy=0.607, lr=0.1] 37%|███▋      | 43/115 [15:33<24:39, 20.55s/epoch, loss=1.16, accuracy=0.752, val_loss=1.63, val_accuracy=0.605, lr=0.0316] 38%|███▊      | 44/115 [15:54<24:29, 20.70s/epoch, loss=1.16, accuracy=0.752, val_loss=3.71, val_accuracy=0.359, lr=0.1]    39%|███▉      | 45/115 [16:16<24:26, 20.95s/epoch, loss=1.16, accuracy=0.75, val_loss=2.04, val_accuracy=0.461, lr=0.1]  40%|████      | 46/115 [16:37<24:18, 21.14s/epoch, loss=1.16, accuracy=0.753, val_loss=1.35, val_accuracy=0.672, lr=0.1] 41%|████      | 47/115 [16:57<23:21, 20.61s/epoch, loss=1.15, accuracy=0.754, val_loss=3.02, val_accuracy=0.408, lr=0.1] 42%|████▏     | 48/115 [17:18<23:21, 20.92s/epoch, loss=1.14, accuracy=0.752, val_loss=2.54, val_accuracy=0.401, lr=0.1] 43%|████▎     | 49/115 [17:40<23:11, 21.09s/epoch, loss=1.15, accuracy=0.756, val_loss=1.59, val_accuracy=0.6, lr=0.1]   43%|████▎     | 50/115 [18:02<23:02, 21.26s/epoch, loss=1.15, accuracy=0.753, val_loss=1.9, val_accuracy=0.531, lr=0.1] 44%|████▍     | 51/115 [18:22<22:29, 21.09s/epoch, loss=1.15, accuracy=0.753, val_loss=3.12, val_accuracy=0.473, lr=0.0316] 45%|████▌     | 52/115 [18:44<22:20, 21.28s/epoch, loss=1.15, accuracy=0.756, val_loss=1.84, val_accuracy=0.529, lr=0.1]    46%|████▌     | 53/115 [19:03<21:22, 20.69s/epoch, loss=1.14, accuracy=0.756, val_loss=2.6, val_accuracy=0.396, lr=0.1]  47%|████▋     | 54/115 [19:25<21:15, 20.91s/epoch, loss=1.14, accuracy=0.755, val_loss=1.99, val_accuracy=0.515, lr=0.1] 48%|████▊     | 55/115 [19:46<21:05, 21.10s/epoch, loss=1.15, accuracy=0.753, val_loss=4.63, val_accuracy=0.234, lr=0.1] 49%|████▊     | 56/115 [20:08<20:50, 21.20s/epoch, loss=1.14, accuracy=0.755, val_loss=2.3, val_accuracy=0.401, lr=0.0316] 50%|████▉     | 57/115 [20:29<20:37, 21.34s/epoch, loss=1.15, accuracy=0.752, val_loss=1.78, val_accuracy=0.538, lr=0.1]   50%|█████     | 58/115 [20:49<19:46, 20.81s/epoch, loss=1.14, accuracy=0.756, val_loss=1.61, val_accuracy=0.611, lr=0.1] 51%|█████▏    | 59/115 [21:09<19:13, 20.60s/epoch, loss=1.14, accuracy=0.756, val_loss=3.74, val_accuracy=0.235, lr=0.1] 52%|█████▏    | 60/115 [21:31<19:17, 21.05s/epoch, loss=1.15, accuracy=0.754, val_loss=3, val_accuracy=0.383, lr=0.1]    53%|█████▎    | 61/115 [21:51<18:37, 20.69s/epoch, loss=1.14, accuracy=0.755, val_loss=2.94, val_accuracy=0.261, lr=0.0316] 54%|█████▍    | 62/115 [22:12<18:21, 20.78s/epoch, loss=1.14, accuracy=0.753, val_loss=1.78, val_accuracy=0.55, lr=0.1]     55%|█████▍    | 63/115 [22:33<18:11, 20.98s/epoch, loss=1.13, accuracy=0.755, val_loss=2.68, val_accuracy=0.378, lr=0.1] 56%|█████▌    | 64/115 [22:54<17:38, 20.75s/epoch, loss=1.14, accuracy=0.757, val_loss=2.17, val_accuracy=0.444, lr=0.1] 57%|█████▋    | 65/115 [23:15<17:20, 20.81s/epoch, loss=1.14, accuracy=0.754, val_loss=2.34, val_accuracy=0.418, lr=0.1] 57%|█████▋    | 66/115 [23:36<17:07, 20.98s/epoch, loss=1.13, accuracy=0.757, val_loss=2.21, val_accuracy=0.432, lr=0.0316] 58%|█████▊    | 67/115 [23:57<16:50, 21.05s/epoch, loss=1.13, accuracy=0.755, val_loss=1.53, val_accuracy=0.636, lr=0.1]    59%|█████▉    | 68/115 [24:16<15:56, 20.35s/epoch, loss=1.13, accuracy=0.756, val_loss=2.09, val_accuracy=0.444, lr=0.1] 60%|██████    | 69/115 [24:36<15:34, 20.32s/epoch, loss=1.14, accuracy=0.755, val_loss=3.3, val_accuracy=0.336, lr=0.1]  61%|██████    | 70/115 [24:58<15:30, 20.69s/epoch, loss=1.13, accuracy=0.756, val_loss=1.67, val_accuracy=0.56, lr=0.1] 62%|██████▏   | 71/115 [25:18<15:10, 20.69s/epoch, loss=1.13, accuracy=0.756, val_loss=2.89, val_accuracy=0.4, lr=0.0316] 63%|██████▎   | 72/115 [25:40<15:00, 20.93s/epoch, loss=1.14, accuracy=0.754, val_loss=6.49, val_accuracy=0.138, lr=0.1]  63%|██████▎   | 73/115 [26:01<14:45, 21.09s/epoch, loss=1.13, accuracy=0.757, val_loss=1.85, val_accuracy=0.507, lr=0.1] 64%|██████▍   | 74/115 [26:21<14:09, 20.72s/epoch, loss=1.14, accuracy=0.754, val_loss=2.73, val_accuracy=0.342, lr=0.1] 65%|██████▌   | 75/115 [26:42<13:53, 20.84s/epoch, loss=1.12, accuracy=0.76, val_loss=2.47, val_accuracy=0.319, lr=0.1]  66%|██████▌   | 76/115 [27:03<13:29, 20.74s/epoch, loss=1.12, accuracy=0.759, val_loss=2.25, val_accuracy=0.388, lr=0.0316] 67%|██████▋   | 77/115 [27:24<13:13, 20.88s/epoch, loss=1.13, accuracy=0.757, val_loss=2.6, val_accuracy=0.468, lr=0.1]     68%|██████▊   | 78/115 [27:45<12:54, 20.93s/epoch, loss=1.13, accuracy=0.758, val_loss=1.77, val_accuracy=0.592, lr=0.1] 69%|██████▊   | 79/115 [28:07<12:39, 21.10s/epoch, loss=1.13, accuracy=0.758, val_loss=2.26, val_accuracy=0.469, lr=0.1] 70%|██████▉   | 80/115 [28:28<12:18, 21.11s/epoch, loss=1.13, accuracy=0.759, val_loss=2.43, val_accuracy=0.468, lr=0.1] 70%|███████   | 81/115 [28:49<11:58, 21.12s/epoch, loss=1.13, accuracy=0.759, val_loss=2.58, val_accuracy=0.419, lr=0.0316] 71%|███████▏  | 82/115 [29:10<11:34, 21.05s/epoch, loss=0.931, accuracy=0.81, val_loss=0.918, val_accuracy=0.792, lr=0.01]  72%|███████▏  | 83/115 [29:30<11:09, 20.91s/epoch, loss=0.752, accuracy=0.845, val_loss=0.859, val_accuracy=0.797, lr=0.01] 73%|███████▎  | 84/115 [29:52<10:52, 21.05s/epoch, loss=0.667, accuracy=0.854, val_loss=0.842, val_accuracy=0.776, lr=0.01] 74%|███████▍  | 85/115 [30:12<10:26, 20.88s/epoch, loss=0.619, accuracy=0.859, val_loss=0.683, val_accuracy=0.833, lr=0.01] 75%|███████▍  | 86/115 [30:33<10:02, 20.78s/epoch, loss=0.596, accuracy=0.86, val_loss=0.806, val_accuracy=0.797, lr=0.01]  76%|███████▌  | 87/115 [30:54<09:46, 20.96s/epoch, loss=0.579, accuracy=0.862, val_loss=0.679, val_accuracy=0.828, lr=0.01] 77%|███████▋  | 88/115 [31:16<09:31, 21.15s/epoch, loss=0.571, accuracy=0.864, val_loss=0.789, val_accuracy=0.792, lr=0.01] 77%|███████▋  | 89/115 [31:37<09:12, 21.23s/epoch, loss=0.569, accuracy=0.864, val_loss=0.737, val_accuracy=0.811, lr=0.01] 78%|███████▊  | 90/115 [31:58<08:52, 21.28s/epoch, loss=0.566, accuracy=0.865, val_loss=0.961, val_accuracy=0.739, lr=0.01] 79%|███████▉  | 91/115 [32:18<08:16, 20.67s/epoch, loss=0.562, accuracy=0.867, val_loss=0.784, val_accuracy=0.8, lr=0.01]   80%|████████  | 92/115 [32:39<07:59, 20.86s/epoch, loss=0.564, accuracy=0.868, val_loss=0.775, val_accuracy=0.793, lr=0.00316] 81%|████████  | 93/115 [33:01<07:43, 21.07s/epoch, loss=0.558, accuracy=0.871, val_loss=0.877, val_accuracy=0.769, lr=0.01]    82%|████████▏ | 94/115 [33:22<07:26, 21.26s/epoch, loss=0.561, accuracy=0.871, val_loss=0.814, val_accuracy=0.799, lr=0.01] 83%|████████▎ | 95/115 [33:44<07:04, 21.25s/epoch, loss=0.554, accuracy=0.873, val_loss=1.18, val_accuracy=0.692, lr=0.01]  83%|████████▎ | 96/115 [34:05<06:45, 21.35s/epoch, loss=0.558, accuracy=0.873, val_loss=1.79, val_accuracy=0.576, lr=0.01] 84%|████████▍ | 97/115 [34:26<06:20, 21.13s/epoch, loss=0.561, accuracy=0.872, val_loss=0.765, val_accuracy=0.807, lr=0.00316] 85%|████████▌ | 98/115 [34:47<05:58, 21.10s/epoch, loss=0.559, accuracy=0.875, val_loss=0.91, val_accuracy=0.782, lr=0.01]     86%|████████▌ | 99/115 [35:08<05:36, 21.06s/epoch, loss=0.558, accuracy=0.877, val_loss=1.61, val_accuracy=0.628, lr=0.01] 87%|████████▋ | 100/115 [35:28<05:14, 20.97s/epoch, loss=0.548, accuracy=0.879, val_loss=0.788, val_accuracy=0.794, lr=0.01] 88%|████████▊ | 101/115 [35:48<04:48, 20.60s/epoch, loss=0.559, accuracy=0.875, val_loss=0.769, val_accuracy=0.812, lr=0.01] 89%|████████▊ | 102/115 [36:09<04:30, 20.80s/epoch, loss=0.553, accuracy=0.879, val_loss=0.868, val_accuracy=0.78, lr=0.00316] 90%|████████▉ | 103/115 [36:29<04:05, 20.44s/epoch, loss=0.552, accuracy=0.88, val_loss=0.808, val_accuracy=0.802, lr=0.01]    90%|█████████ | 104/115 [36:50<03:46, 20.58s/epoch, loss=0.553, accuracy=0.879, val_loss=0.825, val_accuracy=0.797, lr=0.01] 91%|█████████▏| 105/115 [37:10<03:24, 20.49s/epoch, loss=0.549, accuracy=0.882, val_loss=1.18, val_accuracy=0.726, lr=0.01]  92%|█████████▏| 106/115 [37:32<03:06, 20.76s/epoch, loss=0.55, accuracy=0.88, val_loss=1.06, val_accuracy=0.752, lr=0.01]   93%|█████████▎| 107/115 [37:51<02:43, 20.44s/epoch, loss=0.556, accuracy=0.88, val_loss=1, val_accuracy=0.754, lr=0.00316] 94%|█████████▍| 108/115 [38:13<02:25, 20.76s/epoch, loss=0.554, accuracy=0.88, val_loss=0.769, val_accuracy=0.81, lr=0.01] 95%|█████████▍| 109/115 [38:33<02:03, 20.59s/epoch, loss=0.547, accuracy=0.884, val_loss=0.888, val_accuracy=0.775, lr=0.01] 96%|█████████▌| 110/115 [38:53<01:42, 20.52s/epoch, loss=0.552, accuracy=0.883, val_loss=0.842, val_accuracy=0.789, lr=0.01] 97%|█████████▋| 111/115 [39:14<01:22, 20.66s/epoch, loss=0.553, accuracy=0.884, val_loss=0.944, val_accuracy=0.75, lr=0.01]  97%|█████████▋| 112/115 [39:34<01:00, 20.24s/epoch, loss=0.553, accuracy=0.882, val_loss=1.01, val_accuracy=0.756, lr=0.00316] 98%|█████████▊| 113/115 [39:55<00:41, 20.60s/epoch, loss=0.549, accuracy=0.885, val_loss=0.794, val_accuracy=0.81, lr=0.01]    99%|█████████▉| 114/115 [40:14<00:20, 20.16s/epoch, loss=0.551, accuracy=0.883, val_loss=0.773, val_accuracy=0.816, lr=0.01]100%|██████████| 115/115 [40:35<00:00, 20.28s/epoch, loss=0.551, accuracy=0.883, val_loss=0.818, val_accuracy=0.803, lr=0.01]100%|██████████| 115/115 [40:35<00:00, 21.18s/epoch, loss=0.551, accuracy=0.883, val_loss=0.818, val_accuracy=0.803, lr=0.01]
Using real-time data augmentation.
Test score: 0.7171791791915894
Test accuracy: 0.8274000287055969


* * * Run SGD for ID = 13_12. * * *


2024-02-20 02:42:33.034699: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 02:42:35.931591: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 02:42:35.932583: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-20 02:42:35.970751: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-20 02:42:35.970782: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 02:42:35.973676: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 02:42:35.973718: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-20 02:42:35.975846: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-20 02:42:35.976646: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-20 02:42:35.978987: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-20 02:42:35.980525: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-20 02:42:35.985319: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 02:42:35.985838: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-20 02:42:35.985920: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 02:42:37.424970: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-20 02:42:37.426025: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 02:42:37.426859: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-20 02:42:37.426895: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 02:42:37.426930: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 02:42:37.426949: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-20 02:42:37.426974: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-20 02:42:37.426991: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-20 02:42:37.427008: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-20 02:42:37.427024: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-20 02:42:37.427041: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 02:42:37.427548: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-20 02:42:37.427593: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 02:42:38.057669: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-20 02:42:38.057730: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-20 02:42:38.057741: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-20 02:42:38.058697: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:83:00.0, compute capability: 6.1)
{'id': '13_12', 'batch_size': 128, 'epochs': 115, 'validation_split': 0.1, 'checkpointing': True, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
x_train shape: (45000, 32, 32, 3)
45000 train samples
5000 validation samples
10000 test samples
y_train shape: (45000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/115 [00:00<?, ?epoch/s]2024-02-20 02:42:38.880249: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-20 02:42:38.892192: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199825000 Hz
2024-02-20 02:42:40.993542: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 02:42:41.225068: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 02:42:41.841859: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-20 02:42:41.876969: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/115 [00:50<1:35:24, 50.21s/epoch, loss=3.52, accuracy=0.177, val_loss=2.65, val_accuracy=0.14, lr=0.1]  2%|▏         | 2/115 [01:10<1:01:37, 32.72s/epoch, loss=1.76, accuracy=0.423, val_loss=2.46, val_accuracy=0.32, lr=0.1]  3%|▎         | 3/115 [01:32<51:21, 27.52s/epoch, loss=1.46, accuracy=0.572, val_loss=1.82, val_accuracy=0.501, lr=0.1]   3%|▎         | 4/115 [01:53<46:14, 25.00s/epoch, loss=1.32, accuracy=0.65, val_loss=2.51, val_accuracy=0.405, lr=0.1]   4%|▍         | 5/115 [02:14<43:33, 23.76s/epoch, loss=1.27, accuracy=0.684, val_loss=2.3, val_accuracy=0.472, lr=0.1]  5%|▌         | 6/115 [02:36<42:04, 23.16s/epoch, loss=1.24, accuracy=0.698, val_loss=1.83, val_accuracy=0.513, lr=0.1]  6%|▌         | 7/115 [02:58<40:44, 22.64s/epoch, loss=1.23, accuracy=0.711, val_loss=1.39, val_accuracy=0.635, lr=0.1]  7%|▋         | 8/115 [03:19<39:35, 22.20s/epoch, loss=1.22, accuracy=0.719, val_loss=1.95, val_accuracy=0.504, lr=0.1]  8%|▊         | 9/115 [03:41<38:56, 22.04s/epoch, loss=1.21, accuracy=0.723, val_loss=1.85, val_accuracy=0.492, lr=0.1]  9%|▊         | 10/115 [04:01<37:49, 21.61s/epoch, loss=1.21, accuracy=0.726, val_loss=2.48, val_accuracy=0.42, lr=0.1] 10%|▉         | 11/115 [04:23<37:14, 21.48s/epoch, loss=1.21, accuracy=0.727, val_loss=1.85, val_accuracy=0.527, lr=0.1] 10%|█         | 12/115 [04:44<37:01, 21.56s/epoch, loss=1.2, accuracy=0.729, val_loss=1.4, val_accuracy=0.665, lr=0.0316] 11%|█▏        | 13/115 [05:05<36:14, 21.32s/epoch, loss=1.2, accuracy=0.73, val_loss=1.88, val_accuracy=0.523, lr=0.1]    12%|█▏        | 14/115 [05:24<34:48, 20.68s/epoch, loss=1.2, accuracy=0.731, val_loss=3.01, val_accuracy=0.373, lr=0.1] 13%|█▎        | 15/115 [05:43<33:42, 20.22s/epoch, loss=1.19, accuracy=0.734, val_loss=1.6, val_accuracy=0.61, lr=0.1]  14%|█▍        | 16/115 [06:05<33:46, 20.47s/epoch, loss=1.19, accuracy=0.734, val_loss=1.86, val_accuracy=0.548, lr=0.1] 15%|█▍        | 17/115 [06:26<33:43, 20.65s/epoch, loss=1.18, accuracy=0.737, val_loss=2.73, val_accuracy=0.285, lr=0.0316] 16%|█▌        | 18/115 [06:47<33:52, 20.95s/epoch, loss=1.18, accuracy=0.739, val_loss=1.95, val_accuracy=0.521, lr=0.1]    17%|█▋        | 19/115 [07:06<32:42, 20.45s/epoch, loss=1.18, accuracy=0.737, val_loss=1.7, val_accuracy=0.587, lr=0.1]  17%|█▋        | 20/115 [07:27<32:25, 20.47s/epoch, loss=1.18, accuracy=0.74, val_loss=1.64, val_accuracy=0.602, lr=0.1] 18%|█▊        | 21/115 [07:47<32:00, 20.43s/epoch, loss=1.18, accuracy=0.739, val_loss=2.46, val_accuracy=0.446, lr=0.1] 19%|█▉        | 22/115 [08:08<31:52, 20.56s/epoch, loss=1.16, accuracy=0.746, val_loss=1.72, val_accuracy=0.552, lr=0.0316] 20%|██        | 23/115 [08:29<31:36, 20.61s/epoch, loss=1.17, accuracy=0.742, val_loss=2.08, val_accuracy=0.485, lr=0.1]    21%|██        | 24/115 [08:50<31:17, 20.63s/epoch, loss=1.17, accuracy=0.743, val_loss=2.3, val_accuracy=0.452, lr=0.1]  22%|██▏       | 25/115 [09:10<30:53, 20.59s/epoch, loss=1.17, accuracy=0.744, val_loss=1.95, val_accuracy=0.548, lr=0.1] 23%|██▎       | 26/115 [09:31<30:51, 20.80s/epoch, loss=1.17, accuracy=0.742, val_loss=1.53, val_accuracy=0.612, lr=0.1] 23%|██▎       | 27/115 [09:53<30:52, 21.05s/epoch, loss=1.16, accuracy=0.745, val_loss=1.69, val_accuracy=0.558, lr=0.0316] 24%|██▍       | 28/115 [10:14<30:16, 20.88s/epoch, loss=1.16, accuracy=0.745, val_loss=1.76, val_accuracy=0.586, lr=0.1]    25%|██▌       | 29/115 [10:35<30:14, 21.10s/epoch, loss=1.16, accuracy=0.747, val_loss=2.44, val_accuracy=0.454, lr=0.1] 26%|██▌       | 30/115 [10:57<30:01, 21.19s/epoch, loss=1.15, accuracy=0.747, val_loss=1.92, val_accuracy=0.513, lr=0.1] 27%|██▋       | 31/115 [11:16<28:58, 20.69s/epoch, loss=1.15, accuracy=0.747, val_loss=4.61, val_accuracy=0.234, lr=0.1] 28%|██▊       | 32/115 [11:37<28:42, 20.76s/epoch, loss=1.15, accuracy=0.746, val_loss=1.98, val_accuracy=0.52, lr=0.0316] 29%|██▊       | 33/115 [11:58<28:34, 20.91s/epoch, loss=1.15, accuracy=0.748, val_loss=1.59, val_accuracy=0.62, lr=0.1]    30%|██▉       | 34/115 [12:20<28:29, 21.10s/epoch, loss=1.15, accuracy=0.749, val_loss=2.23, val_accuracy=0.481, lr=0.1] 30%|███       | 35/115 [12:41<28:07, 21.09s/epoch, loss=1.15, accuracy=0.747, val_loss=2.16, val_accuracy=0.446, lr=0.1] 31%|███▏      | 36/115 [13:02<27:36, 20.97s/epoch, loss=1.14, accuracy=0.752, val_loss=3.01, val_accuracy=0.28, lr=0.1]  32%|███▏      | 37/115 [13:23<27:27, 21.12s/epoch, loss=1.15, accuracy=0.75, val_loss=1.92, val_accuracy=0.474, lr=0.0316] 33%|███▎      | 38/115 [13:44<27:12, 21.20s/epoch, loss=1.14, accuracy=0.749, val_loss=1.53, val_accuracy=0.651, lr=0.1]   34%|███▍      | 39/115 [14:06<27:01, 21.34s/epoch, loss=1.14, accuracy=0.751, val_loss=1.54, val_accuracy=0.639, lr=0.1] 35%|███▍      | 40/115 [14:28<26:47, 21.44s/epoch, loss=1.15, accuracy=0.75, val_loss=2.66, val_accuracy=0.428, lr=0.1]  36%|███▌      | 41/115 [14:49<26:17, 21.32s/epoch, loss=1.15, accuracy=0.752, val_loss=2.01, val_accuracy=0.535, lr=0.1] 37%|███▋      | 42/115 [15:10<26:04, 21.43s/epoch, loss=1.14, accuracy=0.752, val_loss=1.84, val_accuracy=0.548, lr=0.0316] 37%|███▋      | 43/115 [15:32<25:35, 21.32s/epoch, loss=1.14, accuracy=0.75, val_loss=1.76, val_accuracy=0.587, lr=0.1]     38%|███▊      | 44/115 [15:51<24:30, 20.72s/epoch, loss=1.13, accuracy=0.752, val_loss=2.02, val_accuracy=0.458, lr=0.1] 39%|███▉      | 45/115 [16:12<24:19, 20.84s/epoch, loss=1.14, accuracy=0.752, val_loss=4.73, val_accuracy=0.285, lr=0.1] 40%|████      | 46/115 [16:33<24:06, 20.96s/epoch, loss=1.14, accuracy=0.752, val_loss=2.54, val_accuracy=0.394, lr=0.1] 41%|████      | 47/115 [16:54<23:38, 20.86s/epoch, loss=1.13, accuracy=0.754, val_loss=2.02, val_accuracy=0.461, lr=0.0316] 42%|████▏     | 48/115 [17:15<23:30, 21.05s/epoch, loss=1.14, accuracy=0.752, val_loss=2.27, val_accuracy=0.443, lr=0.1]    43%|████▎     | 49/115 [17:37<23:20, 21.22s/epoch, loss=1.13, accuracy=0.751, val_loss=2.98, val_accuracy=0.394, lr=0.1] 43%|████▎     | 50/115 [17:58<23:01, 21.26s/epoch, loss=1.13, accuracy=0.752, val_loss=1.72, val_accuracy=0.571, lr=0.1] 44%|████▍     | 51/115 [18:20<22:47, 21.37s/epoch, loss=1.13, accuracy=0.753, val_loss=1.61, val_accuracy=0.598, lr=0.1] 45%|████▌     | 52/115 [18:41<22:21, 21.29s/epoch, loss=1.12, accuracy=0.756, val_loss=1.72, val_accuracy=0.544, lr=0.0316] 46%|████▌     | 53/115 [19:02<21:57, 21.26s/epoch, loss=1.12, accuracy=0.755, val_loss=2.64, val_accuracy=0.305, lr=0.1]    47%|████▋     | 54/115 [19:22<21:07, 20.78s/epoch, loss=1.13, accuracy=0.753, val_loss=2.53, val_accuracy=0.36, lr=0.1]  48%|████▊     | 55/115 [19:43<20:53, 20.89s/epoch, loss=1.11, accuracy=0.757, val_loss=2.43, val_accuracy=0.479, lr=0.1] 49%|████▊     | 56/115 [20:02<20:01, 20.36s/epoch, loss=1.12, accuracy=0.755, val_loss=1.99, val_accuracy=0.555, lr=0.1] 50%|████▉     | 57/115 [20:23<19:41, 20.37s/epoch, loss=1.12, accuracy=0.753, val_loss=1.76, val_accuracy=0.557, lr=0.0316] 50%|█████     | 58/115 [20:42<19:03, 20.06s/epoch, loss=1.12, accuracy=0.756, val_loss=1.58, val_accuracy=0.6, lr=0.1]      51%|█████▏    | 59/115 [21:03<19:06, 20.48s/epoch, loss=1.12, accuracy=0.756, val_loss=2.8, val_accuracy=0.36, lr=0.1] 52%|█████▏    | 60/115 [21:24<18:47, 20.51s/epoch, loss=1.11, accuracy=0.758, val_loss=2.11, val_accuracy=0.502, lr=0.1] 53%|█████▎    | 61/115 [21:43<18:07, 20.13s/epoch, loss=1.12, accuracy=0.755, val_loss=2.09, val_accuracy=0.407, lr=0.1] 54%|█████▍    | 62/115 [22:05<18:08, 20.54s/epoch, loss=1.12, accuracy=0.755, val_loss=1.87, val_accuracy=0.552, lr=0.0316] 55%|█████▍    | 63/115 [22:24<17:25, 20.10s/epoch, loss=1.12, accuracy=0.757, val_loss=2.09, val_accuracy=0.472, lr=0.1]    56%|█████▌    | 64/115 [22:45<17:21, 20.42s/epoch, loss=1.12, accuracy=0.756, val_loss=2.71, val_accuracy=0.422, lr=0.1] 57%|█████▋    | 65/115 [23:06<17:16, 20.73s/epoch, loss=1.11, accuracy=0.757, val_loss=1.54, val_accuracy=0.624, lr=0.1] 57%|█████▋    | 66/115 [23:27<17:01, 20.85s/epoch, loss=1.11, accuracy=0.758, val_loss=1.88, val_accuracy=0.472, lr=0.1] 58%|█████▊    | 67/115 [23:49<16:52, 21.09s/epoch, loss=1.11, accuracy=0.757, val_loss=3.6, val_accuracy=0.241, lr=0.0316] 59%|█████▉    | 68/115 [24:10<16:34, 21.16s/epoch, loss=1.11, accuracy=0.758, val_loss=1.69, val_accuracy=0.594, lr=0.1]   60%|██████    | 69/115 [24:32<16:19, 21.28s/epoch, loss=1.11, accuracy=0.757, val_loss=1.62, val_accuracy=0.566, lr=0.1] 61%|██████    | 70/115 [24:53<15:57, 21.27s/epoch, loss=1.11, accuracy=0.757, val_loss=1.87, val_accuracy=0.528, lr=0.1] 62%|██████▏   | 71/115 [25:14<15:33, 21.21s/epoch, loss=1.12, accuracy=0.759, val_loss=2.19, val_accuracy=0.432, lr=0.1] 63%|██████▎   | 72/115 [25:33<14:43, 20.55s/epoch, loss=1.11, accuracy=0.759, val_loss=7.44, val_accuracy=0.144, lr=0.0316] 63%|██████▎   | 73/115 [25:54<14:30, 20.72s/epoch, loss=1.11, accuracy=0.759, val_loss=3.06, val_accuracy=0.371, lr=0.1]    64%|██████▍   | 74/115 [26:16<14:19, 20.97s/epoch, loss=1.11, accuracy=0.759, val_loss=2.55, val_accuracy=0.373, lr=0.1] 65%|██████▌   | 75/115 [26:38<14:05, 21.14s/epoch, loss=1.1, accuracy=0.761, val_loss=2.84, val_accuracy=0.299, lr=0.1]  66%|██████▌   | 76/115 [26:59<13:47, 21.22s/epoch, loss=1.12, accuracy=0.756, val_loss=2.09, val_accuracy=0.482, lr=0.1] 67%|██████▋   | 77/115 [27:21<13:32, 21.39s/epoch, loss=1.12, accuracy=0.757, val_loss=2.16, val_accuracy=0.395, lr=0.0316] 68%|██████▊   | 78/115 [27:42<13:11, 21.39s/epoch, loss=1.11, accuracy=0.76, val_loss=1.65, val_accuracy=0.616, lr=0.1]     69%|██████▊   | 79/115 [28:01<12:23, 20.65s/epoch, loss=1.11, accuracy=0.76, val_loss=1.49, val_accuracy=0.64, lr=0.1]  70%|██████▉   | 80/115 [28:23<12:12, 20.92s/epoch, loss=1.11, accuracy=0.759, val_loss=2.59, val_accuracy=0.332, lr=0.1] 70%|███████   | 81/115 [28:44<11:56, 21.09s/epoch, loss=1.1, accuracy=0.761, val_loss=3.94, val_accuracy=0.249, lr=0.1]  71%|███████▏  | 82/115 [29:06<11:41, 21.26s/epoch, loss=0.903, accuracy=0.818, val_loss=0.878, val_accuracy=0.806, lr=0.01] 72%|███████▏  | 83/115 [29:27<11:22, 21.33s/epoch, loss=0.734, accuracy=0.849, val_loss=0.773, val_accuracy=0.826, lr=0.01] 73%|███████▎  | 84/115 [29:48<11:00, 21.29s/epoch, loss=0.652, accuracy=0.857, val_loss=0.747, val_accuracy=0.82, lr=0.01]  74%|███████▍  | 85/115 [30:10<10:42, 21.42s/epoch, loss=0.607, accuracy=0.861, val_loss=0.816, val_accuracy=0.785, lr=0.01] 75%|███████▍  | 86/115 [30:32<10:21, 21.44s/epoch, loss=0.584, accuracy=0.86, val_loss=0.661, val_accuracy=0.831, lr=0.01]  76%|███████▌  | 87/115 [30:52<09:52, 21.16s/epoch, loss=0.574, accuracy=0.862, val_loss=0.777, val_accuracy=0.798, lr=0.01] 77%|███████▋  | 88/115 [31:14<09:35, 21.31s/epoch, loss=0.563, accuracy=0.865, val_loss=0.78, val_accuracy=0.791, lr=0.01]  77%|███████▋  | 89/115 [31:36<09:17, 21.46s/epoch, loss=0.563, accuracy=0.864, val_loss=0.663, val_accuracy=0.837, lr=0.01] 78%|███████▊  | 90/115 [31:57<08:56, 21.45s/epoch, loss=0.559, accuracy=0.866, val_loss=0.669, val_accuracy=0.83, lr=0.01]  79%|███████▉  | 91/115 [32:19<08:36, 21.50s/epoch, loss=0.559, accuracy=0.866, val_loss=1.49, val_accuracy=0.643, lr=0.00316] 80%|████████  | 92/115 [32:39<08:04, 21.07s/epoch, loss=0.554, accuracy=0.872, val_loss=0.798, val_accuracy=0.793, lr=0.01]   81%|████████  | 93/115 [32:58<07:31, 20.53s/epoch, loss=0.554, accuracy=0.871, val_loss=0.905, val_accuracy=0.79, lr=0.01]  82%|████████▏ | 94/115 [33:17<07:02, 20.12s/epoch, loss=0.556, accuracy=0.871, val_loss=0.716, val_accuracy=0.817, lr=0.01] 83%|████████▎ | 95/115 [33:39<06:51, 20.57s/epoch, loss=0.552, accuracy=0.873, val_loss=0.834, val_accuracy=0.789, lr=0.01] 83%|████████▎ | 96/115 [34:00<06:36, 20.88s/epoch, loss=0.546, accuracy=0.877, val_loss=0.81, val_accuracy=0.8, lr=0.00316] 84%|████████▍ | 97/115 [34:22<06:19, 21.06s/epoch, loss=0.554, accuracy=0.874, val_loss=0.848, val_accuracy=0.785, lr=0.01] 85%|████████▌ | 98/115 [34:42<05:51, 20.65s/epoch, loss=0.552, accuracy=0.876, val_loss=0.832, val_accuracy=0.795, lr=0.01] 86%|████████▌ | 99/115 [35:03<05:34, 20.92s/epoch, loss=0.55, accuracy=0.876, val_loss=0.918, val_accuracy=0.773, lr=0.01]  87%|████████▋ | 100/115 [35:23<05:09, 20.63s/epoch, loss=0.551, accuracy=0.877, val_loss=0.873, val_accuracy=0.786, lr=0.01] 88%|████████▊ | 101/115 [35:44<04:51, 20.83s/epoch, loss=0.555, accuracy=0.876, val_loss=0.952, val_accuracy=0.749, lr=0.00316] 89%|████████▊ | 102/115 [36:05<04:30, 20.81s/epoch, loss=0.547, accuracy=0.878, val_loss=0.809, val_accuracy=0.803, lr=0.01]    90%|████████▉ | 103/115 [36:25<04:06, 20.58s/epoch, loss=0.547, accuracy=0.879, val_loss=0.831, val_accuracy=0.797, lr=0.01] 90%|█████████ | 104/115 [36:46<03:48, 20.75s/epoch, loss=0.551, accuracy=0.879, val_loss=1.45, val_accuracy=0.629, lr=0.01]  91%|█████████▏| 105/115 [37:06<03:24, 20.44s/epoch, loss=0.542, accuracy=0.882, val_loss=0.994, val_accuracy=0.753, lr=0.01] 92%|█████████▏| 106/115 [37:27<03:05, 20.65s/epoch, loss=0.548, accuracy=0.88, val_loss=0.948, val_accuracy=0.762, lr=0.00316] 93%|█████████▎| 107/115 [37:49<02:47, 20.89s/epoch, loss=0.546, accuracy=0.883, val_loss=0.938, val_accuracy=0.763, lr=0.01]   94%|█████████▍| 108/115 [38:09<02:25, 20.82s/epoch, loss=0.544, accuracy=0.882, val_loss=1.05, val_accuracy=0.739, lr=0.01]  95%|█████████▍| 109/115 [38:28<02:01, 20.33s/epoch, loss=0.551, accuracy=0.881, val_loss=0.86, val_accuracy=0.79, lr=0.01]  96%|█████████▌| 110/115 [38:50<01:43, 20.67s/epoch, loss=0.553, accuracy=0.88, val_loss=1.24, val_accuracy=0.715, lr=0.01] 97%|█████████▋| 111/115 [39:11<01:23, 20.86s/epoch, loss=0.547, accuracy=0.883, val_loss=0.918, val_accuracy=0.772, lr=0.00316] 97%|█████████▋| 112/115 [39:33<01:03, 21.01s/epoch, loss=0.549, accuracy=0.883, val_loss=0.701, val_accuracy=0.832, lr=0.01]    98%|█████████▊| 113/115 [39:53<00:41, 20.88s/epoch, loss=0.545, accuracy=0.884, val_loss=0.854, val_accuracy=0.795, lr=0.01] 99%|█████████▉| 114/115 [40:15<00:21, 21.10s/epoch, loss=0.551, accuracy=0.884, val_loss=0.924, val_accuracy=0.768, lr=0.01]100%|██████████| 115/115 [40:36<00:00, 21.18s/epoch, loss=0.544, accuracy=0.884, val_loss=0.767, val_accuracy=0.815, lr=0.01]100%|██████████| 115/115 [40:36<00:00, 21.19s/epoch, loss=0.544, accuracy=0.884, val_loss=0.767, val_accuracy=0.815, lr=0.01]
Using real-time data augmentation.
Test score: 0.6886757016181946
Test accuracy: 0.8234999775886536


* * * Run SGD for ID = 13_13. * * *


2024-02-20 03:23:22.453938: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 03:23:27.246736: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 03:23:27.247765: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-20 03:23:27.285581: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-20 03:23:27.285614: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 03:23:27.288914: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 03:23:27.288955: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-20 03:23:27.291250: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-20 03:23:27.299554: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-20 03:23:27.318187: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-20 03:23:27.320138: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-20 03:23:27.337196: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 03:23:27.337837: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-20 03:23:27.337922: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 03:23:28.852174: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-20 03:23:28.853636: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 03:23:28.854122: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-20 03:23:28.854155: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 03:23:28.854188: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 03:23:28.854207: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-20 03:23:28.854224: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-20 03:23:28.854241: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-20 03:23:28.854265: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-20 03:23:28.854282: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-20 03:23:28.854299: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 03:23:28.854762: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-20 03:23:28.854799: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 03:23:29.625555: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-20 03:23:29.625619: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-20 03:23:29.625631: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-20 03:23:29.626634: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:83:00.0, compute capability: 6.1)
{'id': '13_13', 'batch_size': 128, 'epochs': 115, 'validation_split': 0.1, 'checkpointing': True, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
x_train shape: (45000, 32, 32, 3)
45000 train samples
5000 validation samples
10000 test samples
y_train shape: (45000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/115 [00:00<?, ?epoch/s]2024-02-20 03:23:30.448080: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-20 03:23:30.460181: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199825000 Hz
2024-02-20 03:23:32.553469: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 03:23:32.803653: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 03:23:33.570828: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-20 03:23:33.629346: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/115 [00:53<1:41:15, 53.29s/epoch, loss=3.31, accuracy=0.277, val_loss=3.38, val_accuracy=0.126, lr=0.1]  2%|▏         | 2/115 [01:13<1:04:06, 34.04s/epoch, loss=1.67, accuracy=0.478, val_loss=3.16, val_accuracy=0.258, lr=0.1]  3%|▎         | 3/115 [01:34<52:25, 28.08s/epoch, loss=1.39, accuracy=0.614, val_loss=2.45, val_accuracy=0.376, lr=0.1]    3%|▎         | 4/115 [01:55<46:28, 25.12s/epoch, loss=1.27, accuracy=0.677, val_loss=2.13, val_accuracy=0.409, lr=0.1]  4%|▍         | 5/115 [02:16<43:22, 23.66s/epoch, loss=1.25, accuracy=0.694, val_loss=2.5, val_accuracy=0.403, lr=0.1]   5%|▌         | 6/115 [02:37<41:28, 22.83s/epoch, loss=1.24, accuracy=0.706, val_loss=1.54, val_accuracy=0.604, lr=0.1]  6%|▌         | 7/115 [02:57<39:15, 21.81s/epoch, loss=1.22, accuracy=0.716, val_loss=2.19, val_accuracy=0.461, lr=0.1]  7%|▋         | 8/115 [03:17<38:04, 21.35s/epoch, loss=1.22, accuracy=0.724, val_loss=1.82, val_accuracy=0.575, lr=0.1]  8%|▊         | 9/115 [03:38<37:06, 21.01s/epoch, loss=1.21, accuracy=0.728, val_loss=2.17, val_accuracy=0.47, lr=0.1]   9%|▊         | 10/115 [03:59<37:07, 21.21s/epoch, loss=1.21, accuracy=0.729, val_loss=1.46, val_accuracy=0.653, lr=0.1] 10%|▉         | 11/115 [04:20<36:37, 21.13s/epoch, loss=1.21, accuracy=0.732, val_loss=2.04, val_accuracy=0.461, lr=0.1] 10%|█         | 12/115 [04:42<36:30, 21.27s/epoch, loss=1.21, accuracy=0.735, val_loss=2.28, val_accuracy=0.443, lr=0.1] 11%|█▏        | 13/115 [05:02<35:24, 20.83s/epoch, loss=1.2, accuracy=0.737, val_loss=2.21, val_accuracy=0.511, lr=0.1]  12%|█▏        | 14/115 [05:21<34:24, 20.44s/epoch, loss=1.2, accuracy=0.737, val_loss=1.51, val_accuracy=0.621, lr=0.1] 13%|█▎        | 15/115 [05:42<34:24, 20.64s/epoch, loss=1.2, accuracy=0.739, val_loss=1.57, val_accuracy=0.634, lr=0.0316] 14%|█▍        | 16/115 [06:02<33:27, 20.28s/epoch, loss=1.19, accuracy=0.738, val_loss=1.54, val_accuracy=0.604, lr=0.1]   15%|█▍        | 17/115 [06:22<33:09, 20.30s/epoch, loss=1.19, accuracy=0.739, val_loss=1.99, val_accuracy=0.515, lr=0.1] 16%|█▌        | 18/115 [06:42<32:40, 20.21s/epoch, loss=1.18, accuracy=0.743, val_loss=1.93, val_accuracy=0.491, lr=0.1] 17%|█▋        | 19/115 [07:02<32:14, 20.16s/epoch, loss=1.21, accuracy=0.738, val_loss=2.42, val_accuracy=0.44, lr=0.1]  17%|█▋        | 20/115 [07:24<32:45, 20.69s/epoch, loss=1.19, accuracy=0.738, val_loss=1.41, val_accuracy=0.66, lr=0.1] 18%|█▊        | 21/115 [07:43<31:37, 20.18s/epoch, loss=1.18, accuracy=0.745, val_loss=1.92, val_accuracy=0.503, lr=0.1] 19%|█▉        | 22/115 [08:05<31:58, 20.63s/epoch, loss=1.18, accuracy=0.743, val_loss=1.69, val_accuracy=0.559, lr=0.1] 20%|██        | 23/115 [08:26<32:07, 20.95s/epoch, loss=1.18, accuracy=0.743, val_loss=2.39, val_accuracy=0.477, lr=0.1] 21%|██        | 24/115 [08:47<31:51, 21.01s/epoch, loss=1.18, accuracy=0.746, val_loss=2.61, val_accuracy=0.467, lr=0.1] 22%|██▏       | 25/115 [09:08<31:21, 20.91s/epoch, loss=1.19, accuracy=0.744, val_loss=2.58, val_accuracy=0.364, lr=0.0316] 23%|██▎       | 26/115 [09:30<31:23, 21.16s/epoch, loss=1.18, accuracy=0.748, val_loss=2.23, val_accuracy=0.432, lr=0.1]    23%|██▎       | 27/115 [09:52<31:14, 21.30s/epoch, loss=1.18, accuracy=0.743, val_loss=2.5, val_accuracy=0.424, lr=0.1]  24%|██▍       | 28/115 [10:13<30:55, 21.32s/epoch, loss=1.17, accuracy=0.746, val_loss=1.65, val_accuracy=0.582, lr=0.1] 25%|██▌       | 29/115 [10:34<30:18, 21.14s/epoch, loss=1.18, accuracy=0.748, val_loss=2.23, val_accuracy=0.51, lr=0.1]  26%|██▌       | 30/115 [10:55<30:05, 21.24s/epoch, loss=1.18, accuracy=0.745, val_loss=4.75, val_accuracy=0.259, lr=0.0316] 27%|██▋       | 31/115 [11:17<29:53, 21.36s/epoch, loss=1.17, accuracy=0.749, val_loss=1.5, val_accuracy=0.642, lr=0.1]     28%|██▊       | 32/115 [11:38<29:41, 21.46s/epoch, loss=1.17, accuracy=0.75, val_loss=2.04, val_accuracy=0.482, lr=0.1] 29%|██▊       | 33/115 [12:01<29:35, 21.65s/epoch, loss=1.17, accuracy=0.75, val_loss=1.38, val_accuracy=0.682, lr=0.1] 30%|██▉       | 34/115 [12:20<28:16, 20.94s/epoch, loss=1.16, accuracy=0.749, val_loss=1.59, val_accuracy=0.601, lr=0.1] 30%|███       | 35/115 [12:39<27:20, 20.50s/epoch, loss=1.16, accuracy=0.748, val_loss=1.44, val_accuracy=0.657, lr=0.1] 31%|███▏      | 36/115 [13:01<27:19, 20.75s/epoch, loss=1.16, accuracy=0.75, val_loss=2.09, val_accuracy=0.456, lr=0.1]  32%|███▏      | 37/115 [13:20<26:22, 20.29s/epoch, loss=1.16, accuracy=0.749, val_loss=1.79, val_accuracy=0.587, lr=0.1] 33%|███▎      | 38/115 [13:41<26:26, 20.61s/epoch, loss=1.16, accuracy=0.75, val_loss=1.56, val_accuracy=0.605, lr=0.0316] 34%|███▍      | 39/115 [14:03<26:32, 20.96s/epoch, loss=1.16, accuracy=0.75, val_loss=1.99, val_accuracy=0.456, lr=0.1]    35%|███▍      | 40/115 [14:25<26:42, 21.37s/epoch, loss=1.17, accuracy=0.75, val_loss=2.14, val_accuracy=0.486, lr=0.1] 36%|███▌      | 41/115 [14:46<26:17, 21.32s/epoch, loss=1.16, accuracy=0.749, val_loss=2.02, val_accuracy=0.535, lr=0.1] 37%|███▋      | 42/115 [15:08<25:51, 21.26s/epoch, loss=1.15, accuracy=0.755, val_loss=2.24, val_accuracy=0.488, lr=0.1] 37%|███▋      | 43/115 [15:28<25:09, 20.96s/epoch, loss=1.15, accuracy=0.75, val_loss=2.5, val_accuracy=0.427, lr=0.0316] 38%|███▊      | 44/115 [15:49<24:53, 21.03s/epoch, loss=1.15, accuracy=0.752, val_loss=1.73, val_accuracy=0.567, lr=0.1]  39%|███▉      | 45/115 [16:10<24:35, 21.07s/epoch, loss=1.15, accuracy=0.753, val_loss=1.43, val_accuracy=0.642, lr=0.1] 40%|████      | 46/115 [16:32<24:27, 21.27s/epoch, loss=1.14, accuracy=0.755, val_loss=1.69, val_accuracy=0.611, lr=0.1] 41%|████      | 47/115 [16:52<23:50, 21.03s/epoch, loss=1.15, accuracy=0.751, val_loss=1.86, val_accuracy=0.505, lr=0.1] 42%|████▏     | 48/115 [17:14<23:38, 21.17s/epoch, loss=1.15, accuracy=0.753, val_loss=1.87, val_accuracy=0.55, lr=0.0316] 43%|████▎     | 49/115 [17:35<23:20, 21.22s/epoch, loss=1.14, accuracy=0.755, val_loss=1.42, val_accuracy=0.662, lr=0.1]   43%|████▎     | 50/115 [17:57<23:05, 21.32s/epoch, loss=1.15, accuracy=0.754, val_loss=1.93, val_accuracy=0.501, lr=0.1] 44%|████▍     | 51/115 [18:18<22:50, 21.41s/epoch, loss=1.14, accuracy=0.752, val_loss=1.85, val_accuracy=0.572, lr=0.1] 45%|████▌     | 52/115 [18:40<22:31, 21.45s/epoch, loss=1.14, accuracy=0.754, val_loss=2.01, val_accuracy=0.436, lr=0.1] 46%|████▌     | 53/115 [19:00<21:36, 20.91s/epoch, loss=1.14, accuracy=0.753, val_loss=2.01, val_accuracy=0.502, lr=0.0316] 47%|████▋     | 54/115 [19:21<21:24, 21.06s/epoch, loss=1.13, accuracy=0.756, val_loss=1.74, val_accuracy=0.553, lr=0.1]    48%|████▊     | 55/115 [19:43<21:14, 21.25s/epoch, loss=1.14, accuracy=0.753, val_loss=2, val_accuracy=0.506, lr=0.1]    49%|████▊     | 56/115 [20:04<20:57, 21.31s/epoch, loss=1.14, accuracy=0.756, val_loss=2.29, val_accuracy=0.392, lr=0.1] 50%|████▉     | 57/115 [20:24<20:10, 20.87s/epoch, loss=1.14, accuracy=0.752, val_loss=3.48, val_accuracy=0.292, lr=0.1] 50%|█████     | 58/115 [20:43<19:17, 20.30s/epoch, loss=1.14, accuracy=0.755, val_loss=1.93, val_accuracy=0.557, lr=0.0316] 51%|█████▏    | 59/115 [21:04<19:06, 20.48s/epoch, loss=1.14, accuracy=0.753, val_loss=2.4, val_accuracy=0.495, lr=0.1]     52%|█████▏    | 60/115 [21:25<19:02, 20.77s/epoch, loss=1.14, accuracy=0.757, val_loss=2.38, val_accuracy=0.395, lr=0.1] 53%|█████▎    | 61/115 [21:47<18:52, 20.98s/epoch, loss=1.14, accuracy=0.755, val_loss=1.92, val_accuracy=0.488, lr=0.1] 54%|█████▍    | 62/115 [22:08<18:41, 21.15s/epoch, loss=1.14, accuracy=0.752, val_loss=1.93, val_accuracy=0.526, lr=0.1] 55%|█████▍    | 63/115 [22:30<18:26, 21.29s/epoch, loss=1.13, accuracy=0.753, val_loss=1.92, val_accuracy=0.519, lr=0.0316] 56%|█████▌    | 64/115 [22:50<17:44, 20.87s/epoch, loss=1.14, accuracy=0.753, val_loss=1.66, val_accuracy=0.586, lr=0.1]    57%|█████▋    | 65/115 [23:11<17:21, 20.82s/epoch, loss=1.13, accuracy=0.754, val_loss=2.02, val_accuracy=0.489, lr=0.1] 57%|█████▋    | 66/115 [23:31<16:58, 20.79s/epoch, loss=1.13, accuracy=0.755, val_loss=1.79, val_accuracy=0.577, lr=0.1] 58%|█████▊    | 67/115 [23:51<16:19, 20.41s/epoch, loss=1.13, accuracy=0.757, val_loss=1.82, val_accuracy=0.587, lr=0.1] 59%|█████▉    | 68/115 [24:10<15:41, 20.03s/epoch, loss=1.13, accuracy=0.755, val_loss=2.47, val_accuracy=0.374, lr=0.0316] 60%|██████    | 69/115 [24:30<15:23, 20.07s/epoch, loss=1.13, accuracy=0.754, val_loss=3.41, val_accuracy=0.284, lr=0.1]    61%|██████    | 70/115 [24:51<15:18, 20.42s/epoch, loss=1.12, accuracy=0.758, val_loss=3.85, val_accuracy=0.409, lr=0.1] 62%|██████▏   | 71/115 [25:12<14:57, 20.40s/epoch, loss=1.13, accuracy=0.755, val_loss=2.07, val_accuracy=0.416, lr=0.1] 63%|██████▎   | 72/115 [25:33<14:53, 20.78s/epoch, loss=1.13, accuracy=0.756, val_loss=1.7, val_accuracy=0.554, lr=0.1]  63%|██████▎   | 73/115 [25:54<14:34, 20.83s/epoch, loss=1.13, accuracy=0.755, val_loss=1.86, val_accuracy=0.541, lr=0.0316] 64%|██████▍   | 74/115 [26:13<13:52, 20.30s/epoch, loss=1.13, accuracy=0.757, val_loss=3.63, val_accuracy=0.295, lr=0.1]    65%|██████▌   | 75/115 [26:34<13:33, 20.33s/epoch, loss=1.13, accuracy=0.753, val_loss=2.89, val_accuracy=0.318, lr=0.1] 66%|██████▌   | 76/115 [26:55<13:21, 20.55s/epoch, loss=1.12, accuracy=0.755, val_loss=1.96, val_accuracy=0.534, lr=0.1] 67%|██████▋   | 77/115 [27:16<13:11, 20.82s/epoch, loss=1.13, accuracy=0.758, val_loss=2.15, val_accuracy=0.444, lr=0.1] 68%|██████▊   | 78/115 [27:37<12:48, 20.78s/epoch, loss=1.13, accuracy=0.757, val_loss=3.41, val_accuracy=0.334, lr=0.0316] 69%|██████▊   | 79/115 [27:58<12:34, 20.95s/epoch, loss=1.13, accuracy=0.757, val_loss=1.89, val_accuracy=0.551, lr=0.1]    70%|██████▉   | 80/115 [28:17<11:53, 20.40s/epoch, loss=1.14, accuracy=0.755, val_loss=2.6, val_accuracy=0.408, lr=0.1]  70%|███████   | 81/115 [28:39<11:40, 20.61s/epoch, loss=1.13, accuracy=0.756, val_loss=2.8, val_accuracy=0.392, lr=0.1] 71%|███████▏  | 82/115 [28:58<11:10, 20.31s/epoch, loss=0.916, accuracy=0.817, val_loss=0.94, val_accuracy=0.802, lr=0.01] 72%|███████▏  | 83/115 [29:17<10:37, 19.93s/epoch, loss=0.751, accuracy=0.846, val_loss=0.875, val_accuracy=0.796, lr=0.01] 73%|███████▎  | 84/115 [29:37<10:20, 20.01s/epoch, loss=0.665, accuracy=0.856, val_loss=0.783, val_accuracy=0.808, lr=0.01] 74%|███████▍  | 85/115 [29:57<09:58, 19.96s/epoch, loss=0.62, accuracy=0.86, val_loss=0.801, val_accuracy=0.801, lr=0.01]   75%|███████▍  | 86/115 [30:19<09:53, 20.47s/epoch, loss=0.59, accuracy=0.864, val_loss=0.674, val_accuracy=0.84, lr=0.01] 76%|███████▌  | 87/115 [30:40<09:36, 20.59s/epoch, loss=0.579, accuracy=0.862, val_loss=0.769, val_accuracy=0.806, lr=0.01] 77%|███████▋  | 88/115 [31:01<09:19, 20.72s/epoch, loss=0.567, accuracy=0.865, val_loss=0.802, val_accuracy=0.798, lr=0.01] 77%|███████▋  | 89/115 [31:21<08:55, 20.61s/epoch, loss=0.563, accuracy=0.867, val_loss=0.891, val_accuracy=0.78, lr=0.01]  78%|███████▊  | 90/115 [31:41<08:28, 20.33s/epoch, loss=0.565, accuracy=0.869, val_loss=1.01, val_accuracy=0.757, lr=0.01] 79%|███████▉  | 91/115 [32:02<08:15, 20.64s/epoch, loss=0.557, accuracy=0.872, val_loss=0.828, val_accuracy=0.791, lr=0.00316] 80%|████████  | 92/115 [32:23<07:52, 20.55s/epoch, loss=0.557, accuracy=0.871, val_loss=0.981, val_accuracy=0.741, lr=0.01]    81%|████████  | 93/115 [32:43<07:33, 20.61s/epoch, loss=0.554, accuracy=0.874, val_loss=0.75, val_accuracy=0.817, lr=0.01]  82%|████████▏ | 94/115 [33:05<07:17, 20.85s/epoch, loss=0.554, accuracy=0.873, val_loss=0.963, val_accuracy=0.762, lr=0.01] 83%|████████▎ | 95/115 [33:24<06:47, 20.36s/epoch, loss=0.554, accuracy=0.874, val_loss=0.904, val_accuracy=0.765, lr=0.01] 83%|████████▎ | 96/115 [33:45<06:32, 20.67s/epoch, loss=0.551, accuracy=0.875, val_loss=0.7, val_accuracy=0.829, lr=0.00316] 84%|████████▍ | 97/115 [34:07<06:15, 20.89s/epoch, loss=0.557, accuracy=0.876, val_loss=0.733, val_accuracy=0.825, lr=0.01]  85%|████████▌ | 98/115 [34:28<05:57, 21.05s/epoch, loss=0.55, accuracy=0.879, val_loss=0.82, val_accuracy=0.799, lr=0.01]   86%|████████▌ | 99/115 [34:50<05:39, 21.24s/epoch, loss=0.555, accuracy=0.875, val_loss=0.663, val_accuracy=0.845, lr=0.01] 87%|████████▋ | 100/115 [35:10<05:12, 20.80s/epoch, loss=0.555, accuracy=0.878, val_loss=1.32, val_accuracy=0.701, lr=0.01] 88%|████████▊ | 101/115 [35:29<04:46, 20.44s/epoch, loss=0.554, accuracy=0.879, val_loss=0.881, val_accuracy=0.792, lr=0.01] 89%|████████▊ | 102/115 [35:51<04:29, 20.73s/epoch, loss=0.55, accuracy=0.881, val_loss=0.992, val_accuracy=0.757, lr=0.01]  90%|████████▉ | 103/115 [36:11<04:06, 20.51s/epoch, loss=0.55, accuracy=0.881, val_loss=0.698, val_accuracy=0.839, lr=0.01] 90%|█████████ | 104/115 [36:31<03:46, 20.60s/epoch, loss=0.547, accuracy=0.882, val_loss=0.993, val_accuracy=0.773, lr=0.00316] 91%|█████████▏| 105/115 [36:51<03:24, 20.43s/epoch, loss=0.551, accuracy=0.884, val_loss=1.04, val_accuracy=0.761, lr=0.01]     92%|█████████▏| 106/115 [37:11<03:01, 20.12s/epoch, loss=0.551, accuracy=0.88, val_loss=0.786, val_accuracy=0.818, lr=0.01] 93%|█████████▎| 107/115 [37:32<02:42, 20.33s/epoch, loss=0.55, accuracy=0.883, val_loss=0.78, val_accuracy=0.81, lr=0.01]   94%|█████████▍| 108/115 [37:53<02:24, 20.65s/epoch, loss=0.549, accuracy=0.883, val_loss=0.803, val_accuracy=0.816, lr=0.01] 95%|█████████▍| 109/115 [38:15<02:05, 20.96s/epoch, loss=0.556, accuracy=0.881, val_loss=0.817, val_accuracy=0.805, lr=0.00316] 96%|█████████▌| 110/115 [38:36<01:45, 21.17s/epoch, loss=0.551, accuracy=0.884, val_loss=0.785, val_accuracy=0.819, lr=0.01]    97%|█████████▋| 111/115 [38:58<01:24, 21.21s/epoch, loss=0.549, accuracy=0.884, val_loss=0.756, val_accuracy=0.828, lr=0.01] 97%|█████████▋| 112/115 [39:19<01:04, 21.36s/epoch, loss=0.549, accuracy=0.886, val_loss=1.04, val_accuracy=0.763, lr=0.01]  98%|█████████▊| 113/115 [39:39<00:41, 20.69s/epoch, loss=0.551, accuracy=0.886, val_loss=0.922, val_accuracy=0.786, lr=0.01] 99%|█████████▉| 114/115 [39:59<00:20, 20.74s/epoch, loss=0.549, accuracy=0.885, val_loss=0.794, val_accuracy=0.809, lr=0.00316]100%|██████████| 115/115 [40:19<00:00, 20.25s/epoch, loss=0.546, accuracy=0.887, val_loss=1.21, val_accuracy=0.702, lr=0.01]    100%|██████████| 115/115 [40:19<00:00, 21.03s/epoch, loss=0.546, accuracy=0.887, val_loss=1.21, val_accuracy=0.702, lr=0.01]
Using real-time data augmentation.
Test score: 0.6856180429458618
Test accuracy: 0.8374999761581421

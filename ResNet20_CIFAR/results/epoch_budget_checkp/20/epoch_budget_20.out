Mon Feb 19 23:53:45 2024       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 545.23.08              Driver Version: 545.23.08    CUDA Version: 12.3     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA TITAN Xp                Off | 00000000:86:00.0 Off |                  N/A |
| 46%   72C    P0              89W / 250W |      0MiB / 12288MiB |      0%      Default |
|                                         |                      |                  N/A |
+-----------------------------------------+----------------------+----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
|  No running processes found                                                           |
+---------------------------------------------------------------------------------------+


* * * Run SGD for cluster size = 20. * * *


Budget: 75


* * * Run SGD for ID = 20_1. * * *


2024-02-19 23:53:45.845753: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 23:53:49.239204: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-19 23:53:49.240573: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-19 23:53:49.282391: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:86:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-19 23:53:49.282440: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 23:53:49.286205: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-19 23:53:49.286298: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-19 23:53:49.289080: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-19 23:53:49.290029: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-19 23:53:49.292620: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-19 23:53:49.294470: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-19 23:53:49.300004: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-19 23:53:49.300817: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-19 23:53:49.300924: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-19 23:53:50.709793: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-19 23:53:50.711208: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-19 23:53:50.711729: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:86:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-19 23:53:50.711765: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 23:53:50.711801: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-19 23:53:50.711817: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-19 23:53:50.711842: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-19 23:53:50.711857: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-19 23:53:50.711872: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-19 23:53:50.711886: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-19 23:53:50.711901: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-19 23:53:50.712469: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-19 23:53:50.712506: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-19 23:53:51.375855: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-19 23:53:51.375915: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-19 23:53:51.375926: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-19 23:53:51.377778: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:86:00.0, compute capability: 6.1)
{'id': '20_01', 'batch_size': 128, 'epochs': 75, 'validation_split': 0.1, 'checkpointing': True, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
x_train shape: (45000, 32, 32, 3)
45000 train samples
5000 validation samples
10000 test samples
y_train shape: (45000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/75 [00:00<?, ?epoch/s]2024-02-19 23:53:52.277968: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-19 23:53:52.278636: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-02-19 23:53:54.463888: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-19 23:53:54.813278: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-19 23:53:55.642625: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-19 23:53:55.681029: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|▏         | 1/75 [00:56<1:09:28, 56.34s/epoch, loss=3.56, accuracy=0.296, val_loss=2.51, val_accuracy=0.263, lr=0.1]  3%|▎         | 2/75 [01:24<48:13, 39.64s/epoch, loss=1.69, accuracy=0.484, val_loss=2.9, val_accuracy=0.307, lr=0.1]     4%|▍         | 3/75 [01:52<41:04, 34.23s/epoch, loss=1.48, accuracy=0.566, val_loss=2.06, val_accuracy=0.419, lr=0.1]  5%|▌         | 4/75 [02:19<37:21, 31.57s/epoch, loss=1.4, accuracy=0.626, val_loss=1.85, val_accuracy=0.47, lr=0.1]    7%|▋         | 5/75 [02:47<35:09, 30.14s/epoch, loss=1.33, accuracy=0.667, val_loss=2.87, val_accuracy=0.366, lr=0.1]  8%|▊         | 6/75 [03:14<33:42, 29.31s/epoch, loss=1.29, accuracy=0.69, val_loss=1.93, val_accuracy=0.45, lr=0.1]    9%|▉         | 7/75 [03:42<32:46, 28.92s/epoch, loss=1.26, accuracy=0.706, val_loss=1.38, val_accuracy=0.654, lr=0.1] 11%|█         | 8/75 [04:10<31:45, 28.44s/epoch, loss=1.24, accuracy=0.714, val_loss=2.56, val_accuracy=0.395, lr=0.1] 12%|█▏        | 9/75 [04:38<31:04, 28.24s/epoch, loss=1.24, accuracy=0.721, val_loss=1.87, val_accuracy=0.538, lr=0.1] 13%|█▎        | 10/75 [05:05<30:25, 28.08s/epoch, loss=1.22, accuracy=0.725, val_loss=1.82, val_accuracy=0.534, lr=0.1] 15%|█▍        | 11/75 [05:33<29:48, 27.94s/epoch, loss=1.22, accuracy=0.727, val_loss=1.69, val_accuracy=0.563, lr=0.1] 16%|█▌        | 12/75 [06:01<29:20, 27.94s/epoch, loss=1.21, accuracy=0.728, val_loss=3.29, val_accuracy=0.293, lr=0.0316] 17%|█▋        | 13/75 [06:29<28:47, 27.86s/epoch, loss=1.21, accuracy=0.73, val_loss=2.68, val_accuracy=0.386, lr=0.1]     19%|█▊        | 14/75 [06:56<28:16, 27.82s/epoch, loss=1.21, accuracy=0.731, val_loss=1.6, val_accuracy=0.592, lr=0.1] 20%|██        | 15/75 [07:24<27:45, 27.76s/epoch, loss=1.2, accuracy=0.735, val_loss=1.84, val_accuracy=0.514, lr=0.1] 21%|██▏       | 16/75 [07:52<27:18, 27.76s/epoch, loss=1.2, accuracy=0.739, val_loss=3.04, val_accuracy=0.407, lr=0.1] 23%|██▎       | 17/75 [08:20<26:50, 27.77s/epoch, loss=1.2, accuracy=0.739, val_loss=1.9, val_accuracy=0.536, lr=0.0316] 24%|██▍       | 18/75 [08:47<26:21, 27.74s/epoch, loss=1.19, accuracy=0.736, val_loss=1.67, val_accuracy=0.575, lr=0.1]  25%|██▌       | 19/75 [09:15<25:55, 27.78s/epoch, loss=1.19, accuracy=0.739, val_loss=1.61, val_accuracy=0.603, lr=0.1] 27%|██▋       | 20/75 [09:43<25:24, 27.72s/epoch, loss=1.18, accuracy=0.743, val_loss=2.39, val_accuracy=0.478, lr=0.1] 28%|██▊       | 21/75 [10:10<24:55, 27.70s/epoch, loss=1.18, accuracy=0.745, val_loss=1.69, val_accuracy=0.561, lr=0.1] 29%|██▉       | 22/75 [10:38<24:22, 27.59s/epoch, loss=1.18, accuracy=0.744, val_loss=1.71, val_accuracy=0.584, lr=0.0316] 31%|███       | 23/75 [11:05<23:54, 27.60s/epoch, loss=1.18, accuracy=0.743, val_loss=2.65, val_accuracy=0.366, lr=0.1]    32%|███▏      | 24/75 [11:34<23:38, 27.81s/epoch, loss=1.18, accuracy=0.744, val_loss=1.44, val_accuracy=0.661, lr=0.1] 33%|███▎      | 25/75 [12:01<23:09, 27.80s/epoch, loss=1.18, accuracy=0.748, val_loss=2.09, val_accuracy=0.534, lr=0.1] 35%|███▍      | 26/75 [12:29<22:41, 27.78s/epoch, loss=1.18, accuracy=0.748, val_loss=2.62, val_accuracy=0.401, lr=0.1] 36%|███▌      | 27/75 [12:57<22:11, 27.75s/epoch, loss=1.18, accuracy=0.749, val_loss=2.46, val_accuracy=0.395, lr=0.0316] 37%|███▋      | 28/75 [13:25<21:45, 27.77s/epoch, loss=1.17, accuracy=0.748, val_loss=1.7, val_accuracy=0.558, lr=0.1]     39%|███▊      | 29/75 [13:52<21:15, 27.74s/epoch, loss=1.16, accuracy=0.751, val_loss=1.66, val_accuracy=0.59, lr=0.1] 40%|████      | 30/75 [14:20<20:48, 27.75s/epoch, loss=1.17, accuracy=0.748, val_loss=4.12, val_accuracy=0.348, lr=0.1] 41%|████▏     | 31/75 [14:48<20:20, 27.73s/epoch, loss=1.17, accuracy=0.748, val_loss=1.87, val_accuracy=0.497, lr=0.1] 43%|████▎     | 32/75 [15:16<19:53, 27.75s/epoch, loss=1.16, accuracy=0.751, val_loss=2.5, val_accuracy=0.501, lr=0.0316] 44%|████▍     | 33/75 [15:43<19:25, 27.74s/epoch, loss=1.15, accuracy=0.75, val_loss=1.79, val_accuracy=0.539, lr=0.1]    45%|████▌     | 34/75 [16:11<18:55, 27.71s/epoch, loss=1.16, accuracy=0.75, val_loss=1.73, val_accuracy=0.548, lr=0.1] 47%|████▋     | 35/75 [16:39<18:30, 27.75s/epoch, loss=1.16, accuracy=0.749, val_loss=2.15, val_accuracy=0.445, lr=0.1] 48%|████▊     | 36/75 [17:07<18:05, 27.83s/epoch, loss=1.16, accuracy=0.752, val_loss=1.58, val_accuracy=0.606, lr=0.1] 49%|████▉     | 37/75 [17:35<17:37, 27.84s/epoch, loss=1.16, accuracy=0.75, val_loss=3.31, val_accuracy=0.33, lr=0.0316] 51%|█████     | 38/75 [18:02<17:07, 27.76s/epoch, loss=1.15, accuracy=0.754, val_loss=2.4, val_accuracy=0.432, lr=0.1]   52%|█████▏    | 39/75 [18:30<16:39, 27.76s/epoch, loss=1.15, accuracy=0.752, val_loss=3.25, val_accuracy=0.36, lr=0.1] 53%|█████▎    | 40/75 [18:58<16:11, 27.76s/epoch, loss=1.15, accuracy=0.755, val_loss=3.16, val_accuracy=0.257, lr=0.1] 55%|█████▍    | 41/75 [19:25<15:44, 27.77s/epoch, loss=1.15, accuracy=0.753, val_loss=1.95, val_accuracy=0.478, lr=0.1] 56%|█████▌    | 42/75 [19:53<15:16, 27.76s/epoch, loss=1.15, accuracy=0.753, val_loss=2.26, val_accuracy=0.396, lr=0.0316] 57%|█████▋    | 43/75 [20:21<14:47, 27.73s/epoch, loss=1.14, accuracy=0.753, val_loss=3.05, val_accuracy=0.264, lr=0.1]    59%|█████▊    | 44/75 [20:49<14:18, 27.70s/epoch, loss=1.15, accuracy=0.754, val_loss=3.38, val_accuracy=0.308, lr=0.1] 60%|██████    | 45/75 [21:16<13:51, 27.71s/epoch, loss=1.15, accuracy=0.755, val_loss=4.8, val_accuracy=0.326, lr=0.1]  61%|██████▏   | 46/75 [21:44<13:21, 27.65s/epoch, loss=1.14, accuracy=0.758, val_loss=1.68, val_accuracy=0.572, lr=0.1] 63%|██████▎   | 47/75 [22:12<12:54, 27.67s/epoch, loss=1.14, accuracy=0.754, val_loss=3.51, val_accuracy=0.264, lr=0.0316] 64%|██████▍   | 48/75 [22:39<12:27, 27.68s/epoch, loss=1.14, accuracy=0.752, val_loss=3.98, val_accuracy=0.266, lr=0.1]    65%|██████▌   | 49/75 [23:07<11:58, 27.65s/epoch, loss=1.13, accuracy=0.756, val_loss=1.98, val_accuracy=0.511, lr=0.1] 67%|██████▋   | 50/75 [23:34<11:31, 27.67s/epoch, loss=1.14, accuracy=0.757, val_loss=3.24, val_accuracy=0.328, lr=0.1] 68%|██████▊   | 51/75 [24:02<11:03, 27.65s/epoch, loss=1.14, accuracy=0.754, val_loss=1.59, val_accuracy=0.612, lr=0.1] 69%|██████▉   | 52/75 [24:29<10:33, 27.55s/epoch, loss=1.14, accuracy=0.753, val_loss=3.28, val_accuracy=0.277, lr=0.0316] 71%|███████   | 53/75 [24:57<10:06, 27.56s/epoch, loss=1.14, accuracy=0.755, val_loss=1.98, val_accuracy=0.462, lr=0.1]    72%|███████▏  | 54/75 [25:25<09:38, 27.55s/epoch, loss=1.13, accuracy=0.754, val_loss=2.66, val_accuracy=0.451, lr=0.1] 73%|███████▎  | 55/75 [25:52<09:08, 27.42s/epoch, loss=1.13, accuracy=0.755, val_loss=1.58, val_accuracy=0.608, lr=0.1] 75%|███████▍  | 56/75 [26:19<08:41, 27.45s/epoch, loss=1.13, accuracy=0.755, val_loss=2.03, val_accuracy=0.444, lr=0.1] 76%|███████▌  | 57/75 [26:47<08:14, 27.48s/epoch, loss=1.13, accuracy=0.756, val_loss=2.52, val_accuracy=0.366, lr=0.0316] 77%|███████▋  | 58/75 [27:14<07:47, 27.51s/epoch, loss=1.13, accuracy=0.758, val_loss=2.06, val_accuracy=0.506, lr=0.1]    79%|███████▊  | 59/75 [27:42<07:20, 27.55s/epoch, loss=1.14, accuracy=0.754, val_loss=1.85, val_accuracy=0.533, lr=0.1] 80%|████████  | 60/75 [28:09<06:52, 27.52s/epoch, loss=1.12, accuracy=0.758, val_loss=2.39, val_accuracy=0.486, lr=0.1] 81%|████████▏ | 61/75 [28:37<06:25, 27.53s/epoch, loss=1.13, accuracy=0.758, val_loss=2.84, val_accuracy=0.308, lr=0.1] 83%|████████▎ | 62/75 [29:05<05:58, 27.59s/epoch, loss=1.13, accuracy=0.755, val_loss=1.36, val_accuracy=0.681, lr=0.1] 84%|████████▍ | 63/75 [29:30<05:24, 27.05s/epoch, loss=1.12, accuracy=0.759, val_loss=1.71, val_accuracy=0.568, lr=0.1] 85%|████████▌ | 64/75 [29:56<04:53, 26.67s/epoch, loss=1.13, accuracy=0.757, val_loss=2.46, val_accuracy=0.393, lr=0.1] 87%|████████▋ | 65/75 [30:22<04:23, 26.30s/epoch, loss=1.13, accuracy=0.757, val_loss=1.68, val_accuracy=0.574, lr=0.1] 88%|████████▊ | 66/75 [30:47<03:53, 25.94s/epoch, loss=1.13, accuracy=0.756, val_loss=3.85, val_accuracy=0.192, lr=0.1] 89%|████████▉ | 67/75 [31:12<03:25, 25.63s/epoch, loss=1.13, accuracy=0.757, val_loss=1.88, val_accuracy=0.546, lr=0.0316] 91%|█████████ | 68/75 [31:37<02:59, 25.63s/epoch, loss=1.12, accuracy=0.759, val_loss=3.6, val_accuracy=0.37, lr=0.1]      92%|█████████▏| 69/75 [32:02<02:31, 25.32s/epoch, loss=1.13, accuracy=0.758, val_loss=1.94, val_accuracy=0.504, lr=0.1] 93%|█████████▎| 70/75 [32:27<02:06, 25.31s/epoch, loss=1.13, accuracy=0.758, val_loss=1.59, val_accuracy=0.581, lr=0.1] 95%|█████████▍| 71/75 [32:53<01:42, 25.57s/epoch, loss=1.12, accuracy=0.758, val_loss=1.75, val_accuracy=0.592, lr=0.1] 96%|█████████▌| 72/75 [33:18<01:16, 25.34s/epoch, loss=1.12, accuracy=0.756, val_loss=1.69, val_accuracy=0.578, lr=0.0316] 97%|█████████▋| 73/75 [33:43<00:50, 25.24s/epoch, loss=1.11, accuracy=0.761, val_loss=2.03, val_accuracy=0.471, lr=0.1]    99%|█████████▊| 74/75 [34:08<00:25, 25.09s/epoch, loss=1.12, accuracy=0.758, val_loss=2.08, val_accuracy=0.406, lr=0.1]100%|██████████| 75/75 [34:33<00:00, 25.18s/epoch, loss=1.12, accuracy=0.758, val_loss=1.66, val_accuracy=0.579, lr=0.1]100%|██████████| 75/75 [34:33<00:00, 27.65s/epoch, loss=1.12, accuracy=0.758, val_loss=1.66, val_accuracy=0.579, lr=0.1]
Using real-time data augmentation.
Test score: 1.3715553283691406
Test accuracy: 0.6733999848365784


* * * Run SGD for ID = 20_2. * * *


2024-02-20 00:28:32.706453: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 00:28:35.433674: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 00:28:35.434892: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-20 00:28:35.476522: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:86:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-20 00:28:35.476580: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 00:28:35.479906: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 00:28:35.479970: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-20 00:28:35.482526: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-20 00:28:35.483224: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-20 00:28:35.485918: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-20 00:28:35.487497: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-20 00:28:35.492766: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 00:28:35.493458: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-20 00:28:35.493551: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 00:28:36.933844: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-20 00:28:36.935010: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 00:28:36.935560: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:86:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-20 00:28:36.935608: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 00:28:36.935649: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 00:28:36.935673: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-20 00:28:36.935696: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-20 00:28:36.935719: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-20 00:28:36.935742: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-20 00:28:36.935764: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-20 00:28:36.935787: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 00:28:36.936415: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-20 00:28:36.936466: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 00:28:37.574991: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-20 00:28:37.575058: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-20 00:28:37.575070: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-20 00:28:37.576891: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:86:00.0, compute capability: 6.1)
{'id': '20_02', 'batch_size': 128, 'epochs': 75, 'validation_split': 0.1, 'checkpointing': True, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
x_train shape: (45000, 32, 32, 3)
45000 train samples
5000 validation samples
10000 test samples
y_train shape: (45000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/75 [00:00<?, ?epoch/s]2024-02-20 00:28:38.422472: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-20 00:28:38.435013: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-02-20 00:28:40.447344: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 00:28:40.803954: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 00:28:41.690496: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-20 00:28:41.734669: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|▏         | 1/75 [00:56<1:09:45, 56.56s/epoch, loss=3.53, accuracy=0.277, val_loss=2.78, val_accuracy=0.201, lr=0.1]  3%|▎         | 2/75 [01:22<46:47, 38.45s/epoch, loss=1.73, accuracy=0.455, val_loss=1.85, val_accuracy=0.401, lr=0.1]    4%|▍         | 3/75 [01:47<38:54, 32.42s/epoch, loss=1.48, accuracy=0.562, val_loss=2.32, val_accuracy=0.384, lr=0.1]  5%|▌         | 4/75 [02:12<34:51, 29.46s/epoch, loss=1.34, accuracy=0.642, val_loss=2.93, val_accuracy=0.307, lr=0.1]  7%|▋         | 5/75 [02:37<32:35, 27.94s/epoch, loss=1.27, accuracy=0.679, val_loss=1.86, val_accuracy=0.55, lr=0.1]   8%|▊         | 6/75 [03:02<30:47, 26.78s/epoch, loss=1.25, accuracy=0.695, val_loss=1.78, val_accuracy=0.515, lr=0.1]  9%|▉         | 7/75 [03:27<29:41, 26.20s/epoch, loss=1.24, accuracy=0.703, val_loss=1.92, val_accuracy=0.482, lr=0.1] 11%|█         | 8/75 [03:52<28:50, 25.82s/epoch, loss=1.22, accuracy=0.713, val_loss=2.36, val_accuracy=0.368, lr=0.1] 12%|█▏        | 9/75 [04:18<28:29, 25.90s/epoch, loss=1.22, accuracy=0.717, val_loss=2.66, val_accuracy=0.34, lr=0.1]  13%|█▎        | 10/75 [04:43<27:41, 25.56s/epoch, loss=1.2, accuracy=0.724, val_loss=3.2, val_accuracy=0.372, lr=0.1] 15%|█▍        | 11/75 [05:07<26:59, 25.30s/epoch, loss=1.21, accuracy=0.724, val_loss=2.02, val_accuracy=0.538, lr=0.0316] 16%|█▌        | 12/75 [05:32<26:28, 25.21s/epoch, loss=1.2, accuracy=0.728, val_loss=1.76, val_accuracy=0.538, lr=0.1]     17%|█▋        | 13/75 [05:57<25:59, 25.15s/epoch, loss=1.2, accuracy=0.73, val_loss=2.1, val_accuracy=0.438, lr=0.1]   19%|█▊        | 14/75 [06:22<25:22, 24.97s/epoch, loss=1.19, accuracy=0.731, val_loss=2.01, val_accuracy=0.482, lr=0.1] 20%|██        | 15/75 [06:47<25:00, 25.01s/epoch, loss=1.18, accuracy=0.735, val_loss=2.86, val_accuracy=0.335, lr=0.1] 21%|██▏       | 16/75 [07:12<24:38, 25.06s/epoch, loss=1.19, accuracy=0.733, val_loss=1.83, val_accuracy=0.521, lr=0.1] 23%|██▎       | 17/75 [07:38<24:20, 25.18s/epoch, loss=1.19, accuracy=0.738, val_loss=2.11, val_accuracy=0.498, lr=0.0316] 24%|██▍       | 18/75 [08:03<23:49, 25.08s/epoch, loss=1.2, accuracy=0.732, val_loss=2.32, val_accuracy=0.369, lr=0.1]     25%|██▌       | 19/75 [08:27<23:19, 25.00s/epoch, loss=1.19, accuracy=0.733, val_loss=3.29, val_accuracy=0.317, lr=0.1] 27%|██▋       | 20/75 [08:52<22:54, 24.99s/epoch, loss=1.18, accuracy=0.737, val_loss=1.98, val_accuracy=0.485, lr=0.1] 28%|██▊       | 21/75 [09:18<22:39, 25.17s/epoch, loss=1.19, accuracy=0.738, val_loss=1.7, val_accuracy=0.561, lr=0.1]  29%|██▉       | 22/75 [09:42<22:03, 24.98s/epoch, loss=1.19, accuracy=0.737, val_loss=1.79, val_accuracy=0.516, lr=0.1] 31%|███       | 23/75 [10:07<21:39, 25.00s/epoch, loss=1.18, accuracy=0.742, val_loss=1.88, val_accuracy=0.547, lr=0.1] 32%|███▏      | 24/75 [10:33<21:17, 25.04s/epoch, loss=1.19, accuracy=0.74, val_loss=1.66, val_accuracy=0.573, lr=0.1]  33%|███▎      | 25/75 [10:58<20:51, 25.03s/epoch, loss=1.18, accuracy=0.741, val_loss=1.77, val_accuracy=0.569, lr=0.1] 35%|███▍      | 26/75 [11:22<20:23, 24.97s/epoch, loss=1.17, accuracy=0.744, val_loss=1.67, val_accuracy=0.545, lr=0.1] 36%|███▌      | 27/75 [11:47<19:55, 24.90s/epoch, loss=1.17, accuracy=0.745, val_loss=2.96, val_accuracy=0.389, lr=0.1] 37%|███▋      | 28/75 [12:12<19:28, 24.85s/epoch, loss=1.18, accuracy=0.742, val_loss=3.08, val_accuracy=0.278, lr=0.1] 39%|███▊      | 29/75 [12:37<19:03, 24.86s/epoch, loss=1.18, accuracy=0.744, val_loss=1.91, val_accuracy=0.514, lr=0.0316] 40%|████      | 30/75 [13:02<18:41, 24.92s/epoch, loss=1.17, accuracy=0.745, val_loss=3.86, val_accuracy=0.273, lr=0.1]    41%|████▏     | 31/75 [13:27<18:20, 25.00s/epoch, loss=1.16, accuracy=0.743, val_loss=2, val_accuracy=0.535, lr=0.1]    43%|████▎     | 32/75 [13:52<17:53, 24.96s/epoch, loss=1.17, accuracy=0.745, val_loss=2.53, val_accuracy=0.4, lr=0.1] 44%|████▍     | 33/75 [14:17<17:29, 24.98s/epoch, loss=1.17, accuracy=0.743, val_loss=2.32, val_accuracy=0.537, lr=0.1] 45%|████▌     | 34/75 [14:43<17:14, 25.23s/epoch, loss=1.16, accuracy=0.749, val_loss=1.64, val_accuracy=0.578, lr=0.1] 47%|████▋     | 35/75 [15:08<16:45, 25.14s/epoch, loss=1.16, accuracy=0.748, val_loss=2.21, val_accuracy=0.453, lr=0.1] 48%|████▊     | 36/75 [15:33<16:21, 25.16s/epoch, loss=1.16, accuracy=0.746, val_loss=4.19, val_accuracy=0.303, lr=0.1] 49%|████▉     | 37/75 [15:59<16:08, 25.50s/epoch, loss=1.17, accuracy=0.746, val_loss=1.7, val_accuracy=0.549, lr=0.1]  51%|█████     | 38/75 [16:24<15:37, 25.34s/epoch, loss=1.16, accuracy=0.746, val_loss=2.26, val_accuracy=0.473, lr=0.1] 52%|█████▏    | 39/75 [16:50<15:14, 25.41s/epoch, loss=1.16, accuracy=0.748, val_loss=1.62, val_accuracy=0.585, lr=0.1] 53%|█████▎    | 40/75 [17:14<14:41, 25.20s/epoch, loss=1.16, accuracy=0.748, val_loss=2.65, val_accuracy=0.302, lr=0.1] 55%|█████▍    | 41/75 [17:39<14:13, 25.11s/epoch, loss=1.15, accuracy=0.749, val_loss=2.49, val_accuracy=0.463, lr=0.1] 56%|█████▌    | 42/75 [18:04<13:46, 25.04s/epoch, loss=1.16, accuracy=0.748, val_loss=3.42, val_accuracy=0.333, lr=0.1] 57%|█████▋    | 43/75 [18:29<13:23, 25.10s/epoch, loss=1.16, accuracy=0.75, val_loss=1.59, val_accuracy=0.597, lr=0.1]  59%|█████▊    | 44/75 [18:54<12:54, 24.98s/epoch, loss=1.15, accuracy=0.748, val_loss=2.33, val_accuracy=0.481, lr=0.1] 60%|██████    | 45/75 [19:19<12:26, 24.89s/epoch, loss=1.16, accuracy=0.751, val_loss=2.27, val_accuracy=0.474, lr=0.1] 61%|██████▏   | 46/75 [19:44<12:01, 24.89s/epoch, loss=1.15, accuracy=0.749, val_loss=2.69, val_accuracy=0.343, lr=0.1] 63%|██████▎   | 47/75 [20:09<11:36, 24.89s/epoch, loss=1.15, accuracy=0.749, val_loss=1.93, val_accuracy=0.557, lr=0.1] 64%|██████▍   | 48/75 [20:34<11:13, 24.95s/epoch, loss=1.15, accuracy=0.751, val_loss=2.25, val_accuracy=0.397, lr=0.0316] 65%|██████▌   | 49/75 [20:59<10:52, 25.11s/epoch, loss=1.15, accuracy=0.75, val_loss=2.99, val_accuracy=0.368, lr=0.1]     67%|██████▋   | 50/75 [21:24<10:28, 25.12s/epoch, loss=1.15, accuracy=0.75, val_loss=2.63, val_accuracy=0.379, lr=0.1] 68%|██████▊   | 51/75 [21:49<10:03, 25.14s/epoch, loss=1.15, accuracy=0.749, val_loss=1.73, val_accuracy=0.569, lr=0.1] 69%|██████▉   | 52/75 [22:15<09:38, 25.16s/epoch, loss=1.15, accuracy=0.748, val_loss=2.04, val_accuracy=0.471, lr=0.1] 71%|███████   | 53/75 [22:40<09:11, 25.09s/epoch, loss=1.14, accuracy=0.755, val_loss=3.93, val_accuracy=0.195, lr=0.0316] 72%|███████▏  | 54/75 [23:05<08:47, 25.10s/epoch, loss=1.14, accuracy=0.749, val_loss=2.24, val_accuracy=0.465, lr=0.1]    73%|███████▎  | 55/75 [23:31<08:26, 25.30s/epoch, loss=1.15, accuracy=0.75, val_loss=1.54, val_accuracy=0.598, lr=0.1]  75%|███████▍  | 56/75 [23:57<08:07, 25.65s/epoch, loss=1.15, accuracy=0.751, val_loss=1.64, val_accuracy=0.565, lr=0.1] 76%|███████▌  | 57/75 [24:23<07:43, 25.77s/epoch, loss=1.15, accuracy=0.752, val_loss=2.6, val_accuracy=0.273, lr=0.1]  77%|███████▋  | 58/75 [24:50<07:22, 26.02s/epoch, loss=1.14, accuracy=0.752, val_loss=1.57, val_accuracy=0.627, lr=0.1] 79%|███████▊  | 59/75 [25:14<06:48, 25.56s/epoch, loss=1.15, accuracy=0.752, val_loss=2.23, val_accuracy=0.428, lr=0.1] 80%|████████  | 60/75 [25:39<06:20, 25.34s/epoch, loss=1.16, accuracy=0.748, val_loss=1.81, val_accuracy=0.561, lr=0.0316] 81%|████████▏ | 61/75 [26:04<05:51, 25.14s/epoch, loss=1.15, accuracy=0.753, val_loss=1.52, val_accuracy=0.625, lr=0.1]    83%|████████▎ | 62/75 [26:29<05:27, 25.21s/epoch, loss=1.14, accuracy=0.752, val_loss=1.51, val_accuracy=0.632, lr=0.1] 84%|████████▍ | 63/75 [26:54<05:01, 25.12s/epoch, loss=1.14, accuracy=0.752, val_loss=2.54, val_accuracy=0.328, lr=0.1] 85%|████████▌ | 64/75 [27:19<04:35, 25.09s/epoch, loss=1.14, accuracy=0.754, val_loss=2.11, val_accuracy=0.414, lr=0.1] 87%|████████▋ | 65/75 [27:44<04:09, 24.96s/epoch, loss=1.14, accuracy=0.753, val_loss=1.66, val_accuracy=0.57, lr=0.1]  88%|████████▊ | 66/75 [28:08<03:44, 24.93s/epoch, loss=1.14, accuracy=0.752, val_loss=2.92, val_accuracy=0.317, lr=0.1] 89%|████████▉ | 67/75 [28:33<03:19, 24.91s/epoch, loss=1.14, accuracy=0.752, val_loss=1.65, val_accuracy=0.574, lr=0.0316] 91%|█████████ | 68/75 [28:59<02:56, 25.17s/epoch, loss=1.14, accuracy=0.751, val_loss=1.78, val_accuracy=0.522, lr=0.1]    92%|█████████▏| 69/75 [29:24<02:30, 25.03s/epoch, loss=1.14, accuracy=0.753, val_loss=2.86, val_accuracy=0.342, lr=0.1] 93%|█████████▎| 70/75 [29:49<02:04, 24.96s/epoch, loss=1.13, accuracy=0.757, val_loss=2.15, val_accuracy=0.442, lr=0.1] 95%|█████████▍| 71/75 [30:14<01:40, 25.05s/epoch, loss=1.13, accuracy=0.755, val_loss=1.46, val_accuracy=0.646, lr=0.1] 96%|█████████▌| 72/75 [30:39<01:15, 25.04s/epoch, loss=1.14, accuracy=0.753, val_loss=1.6, val_accuracy=0.596, lr=0.1]  97%|█████████▋| 73/75 [31:03<00:49, 24.91s/epoch, loss=1.14, accuracy=0.755, val_loss=2.11, val_accuracy=0.478, lr=0.1] 99%|█████████▊| 74/75 [31:28<00:24, 24.88s/epoch, loss=1.14, accuracy=0.753, val_loss=2.19, val_accuracy=0.464, lr=0.1]100%|██████████| 75/75 [31:53<00:00, 24.94s/epoch, loss=1.13, accuracy=0.754, val_loss=1.64, val_accuracy=0.599, lr=0.1]100%|██████████| 75/75 [31:53<00:00, 25.52s/epoch, loss=1.13, accuracy=0.754, val_loss=1.64, val_accuracy=0.599, lr=0.1]
Using real-time data augmentation.
Test score: 1.4857834577560425
Test accuracy: 0.6430000066757202


* * * Run SGD for ID = 20_3. * * *


2024-02-20 01:00:38.802173: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 01:00:41.648057: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 01:00:41.649405: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-20 01:00:41.691338: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:86:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-20 01:00:41.691383: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 01:00:41.694753: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 01:00:41.694848: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-20 01:00:41.697434: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-20 01:00:41.698195: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-20 01:00:41.700962: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-20 01:00:41.702816: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-20 01:00:41.708294: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 01:00:41.709011: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-20 01:00:41.709101: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 01:00:43.110744: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-20 01:00:43.111816: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 01:00:43.112384: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:86:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-20 01:00:43.112424: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 01:00:43.112464: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 01:00:43.112486: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-20 01:00:43.112506: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-20 01:00:43.112527: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-20 01:00:43.112547: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-20 01:00:43.112568: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-20 01:00:43.112589: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 01:00:43.113179: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-20 01:00:43.113218: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 01:00:43.760061: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-20 01:00:43.760125: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-20 01:00:43.760137: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-20 01:00:43.761954: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:86:00.0, compute capability: 6.1)
{'id': '20_03', 'batch_size': 128, 'epochs': 75, 'validation_split': 0.1, 'checkpointing': True, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
x_train shape: (45000, 32, 32, 3)
45000 train samples
5000 validation samples
10000 test samples
y_train shape: (45000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/75 [00:00<?, ?epoch/s]2024-02-20 01:00:44.616327: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-20 01:00:44.628015: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-02-20 01:00:46.658045: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 01:00:46.995812: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 01:00:48.031020: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-20 01:00:48.078116: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|▏         | 1/75 [01:00<1:14:02, 60.03s/epoch, loss=3.25, accuracy=0.306, val_loss=2.36, val_accuracy=0.232, lr=0.1]  3%|▎         | 2/75 [01:24<47:51, 39.33s/epoch, loss=1.68, accuracy=0.474, val_loss=3.45, val_accuracy=0.231, lr=0.1]    4%|▍         | 3/75 [01:50<39:29, 32.91s/epoch, loss=1.46, accuracy=0.578, val_loss=2.18, val_accuracy=0.426, lr=0.1]  5%|▌         | 4/75 [02:15<35:28, 29.98s/epoch, loss=1.34, accuracy=0.652, val_loss=2.01, val_accuracy=0.473, lr=0.1]  7%|▋         | 5/75 [02:40<32:48, 28.12s/epoch, loss=1.29, accuracy=0.684, val_loss=1.8, val_accuracy=0.531, lr=0.1]   8%|▊         | 6/75 [03:04<30:55, 26.90s/epoch, loss=1.26, accuracy=0.699, val_loss=2.46, val_accuracy=0.322, lr=0.1]  9%|▉         | 7/75 [03:29<29:43, 26.23s/epoch, loss=1.24, accuracy=0.71, val_loss=1.38, val_accuracy=0.654, lr=0.1]  11%|█         | 8/75 [03:54<28:39, 25.66s/epoch, loss=1.24, accuracy=0.713, val_loss=4.19, val_accuracy=0.297, lr=0.1] 12%|█▏        | 9/75 [04:19<27:54, 25.38s/epoch, loss=1.23, accuracy=0.718, val_loss=1.63, val_accuracy=0.566, lr=0.1] 13%|█▎        | 10/75 [04:43<27:20, 25.23s/epoch, loss=1.23, accuracy=0.723, val_loss=2.71, val_accuracy=0.434, lr=0.1] 15%|█▍        | 11/75 [05:09<26:53, 25.22s/epoch, loss=1.21, accuracy=0.727, val_loss=2, val_accuracy=0.5, lr=0.1]      16%|█▌        | 12/75 [05:33<26:19, 25.07s/epoch, loss=1.22, accuracy=0.726, val_loss=1.64, val_accuracy=0.615, lr=0.0316] 17%|█▋        | 13/75 [05:58<25:46, 24.94s/epoch, loss=1.22, accuracy=0.728, val_loss=3.37, val_accuracy=0.265, lr=0.1]    19%|█▊        | 14/75 [06:23<25:20, 24.92s/epoch, loss=1.2, accuracy=0.735, val_loss=3.29, val_accuracy=0.313, lr=0.1]  20%|██        | 15/75 [06:48<24:55, 24.92s/epoch, loss=1.21, accuracy=0.733, val_loss=1.42, val_accuracy=0.664, lr=0.1] 21%|██▏       | 16/75 [07:13<24:32, 24.96s/epoch, loss=1.21, accuracy=0.735, val_loss=1.91, val_accuracy=0.504, lr=0.1] 23%|██▎       | 17/75 [07:38<24:09, 24.99s/epoch, loss=1.21, accuracy=0.735, val_loss=1.77, val_accuracy=0.559, lr=0.0316] 24%|██▍       | 18/75 [08:02<23:36, 24.85s/epoch, loss=1.2, accuracy=0.738, val_loss=2.15, val_accuracy=0.472, lr=0.1]     25%|██▌       | 19/75 [08:28<23:17, 24.95s/epoch, loss=1.19, accuracy=0.741, val_loss=1.56, val_accuracy=0.64, lr=0.1] 27%|██▋       | 20/75 [08:52<22:46, 24.85s/epoch, loss=1.18, accuracy=0.743, val_loss=1.54, val_accuracy=0.614, lr=0.1] 28%|██▊       | 21/75 [09:17<22:19, 24.81s/epoch, loss=1.19, accuracy=0.738, val_loss=2.17, val_accuracy=0.444, lr=0.1] 29%|██▉       | 22/75 [09:42<21:59, 24.90s/epoch, loss=1.18, accuracy=0.743, val_loss=1.77, val_accuracy=0.528, lr=0.0316] 31%|███       | 23/75 [10:07<21:37, 24.95s/epoch, loss=1.19, accuracy=0.743, val_loss=2.35, val_accuracy=0.404, lr=0.1]    32%|███▏      | 24/75 [10:33<21:23, 25.16s/epoch, loss=1.19, accuracy=0.742, val_loss=1.84, val_accuracy=0.529, lr=0.1] 33%|███▎      | 25/75 [10:58<20:56, 25.14s/epoch, loss=1.18, accuracy=0.741, val_loss=2.51, val_accuracy=0.437, lr=0.1] 35%|███▍      | 26/75 [11:23<20:26, 25.03s/epoch, loss=1.17, accuracy=0.744, val_loss=2.38, val_accuracy=0.516, lr=0.1] 36%|███▌      | 27/75 [11:48<19:59, 24.98s/epoch, loss=1.17, accuracy=0.745, val_loss=1.66, val_accuracy=0.604, lr=0.0316] 37%|███▋      | 28/75 [12:12<19:33, 24.96s/epoch, loss=1.18, accuracy=0.743, val_loss=2.55, val_accuracy=0.412, lr=0.1]    39%|███▊      | 29/75 [12:37<19:07, 24.95s/epoch, loss=1.18, accuracy=0.744, val_loss=2.88, val_accuracy=0.3, lr=0.1]   40%|████      | 30/75 [13:02<18:35, 24.80s/epoch, loss=1.18, accuracy=0.745, val_loss=1.71, val_accuracy=0.556, lr=0.1] 41%|████▏     | 31/75 [13:27<18:13, 24.85s/epoch, loss=1.18, accuracy=0.745, val_loss=2.25, val_accuracy=0.513, lr=0.1] 43%|████▎     | 32/75 [13:53<18:02, 25.17s/epoch, loss=1.18, accuracy=0.743, val_loss=4.6, val_accuracy=0.208, lr=0.0316] 44%|████▍     | 33/75 [14:18<17:35, 25.13s/epoch, loss=1.17, accuracy=0.747, val_loss=2.11, val_accuracy=0.492, lr=0.1]   45%|████▌     | 34/75 [14:43<17:07, 25.06s/epoch, loss=1.17, accuracy=0.746, val_loss=1.99, val_accuracy=0.552, lr=0.1] 47%|████▋     | 35/75 [15:08<16:46, 25.17s/epoch, loss=1.17, accuracy=0.746, val_loss=1.39, val_accuracy=0.668, lr=0.1] 48%|████▊     | 36/75 [15:34<16:31, 25.42s/epoch, loss=1.17, accuracy=0.745, val_loss=2.64, val_accuracy=0.421, lr=0.1] 49%|████▉     | 37/75 [15:59<15:59, 25.25s/epoch, loss=1.17, accuracy=0.746, val_loss=2.07, val_accuracy=0.448, lr=0.0316] 51%|█████     | 38/75 [16:24<15:31, 25.18s/epoch, loss=1.17, accuracy=0.747, val_loss=2.33, val_accuracy=0.473, lr=0.1]    52%|█████▏    | 39/75 [16:49<15:03, 25.09s/epoch, loss=1.16, accuracy=0.75, val_loss=2.03, val_accuracy=0.51, lr=0.1]   53%|█████▎    | 40/75 [17:14<14:40, 25.15s/epoch, loss=1.17, accuracy=0.748, val_loss=3.37, val_accuracy=0.369, lr=0.1] 55%|█████▍    | 41/75 [17:39<14:11, 25.06s/epoch, loss=1.17, accuracy=0.746, val_loss=2.54, val_accuracy=0.461, lr=0.1] 56%|█████▌    | 42/75 [18:04<13:44, 24.98s/epoch, loss=1.17, accuracy=0.747, val_loss=2.06, val_accuracy=0.509, lr=0.0316] 57%|█████▋    | 43/75 [18:28<13:15, 24.87s/epoch, loss=1.15, accuracy=0.749, val_loss=2.12, val_accuracy=0.456, lr=0.1]    59%|█████▊    | 44/75 [18:53<12:52, 24.92s/epoch, loss=1.16, accuracy=0.751, val_loss=3.28, val_accuracy=0.271, lr=0.1] 60%|██████    | 45/75 [19:18<12:26, 24.88s/epoch, loss=1.16, accuracy=0.749, val_loss=1.71, val_accuracy=0.535, lr=0.1] 61%|██████▏   | 46/75 [19:43<12:02, 24.91s/epoch, loss=1.16, accuracy=0.751, val_loss=1.64, val_accuracy=0.626, lr=0.1] 63%|██████▎   | 47/75 [20:08<11:36, 24.89s/epoch, loss=1.16, accuracy=0.75, val_loss=1.61, val_accuracy=0.61, lr=0.0316] 64%|██████▍   | 48/75 [20:33<11:13, 24.93s/epoch, loss=1.17, accuracy=0.746, val_loss=2.13, val_accuracy=0.472, lr=0.1]  65%|██████▌   | 49/75 [20:58<10:47, 24.91s/epoch, loss=1.16, accuracy=0.75, val_loss=1.51, val_accuracy=0.614, lr=0.1]  67%|██████▋   | 50/75 [21:23<10:26, 25.05s/epoch, loss=1.16, accuracy=0.75, val_loss=2.3, val_accuracy=0.429, lr=0.1]  68%|██████▊   | 51/75 [21:48<09:58, 24.93s/epoch, loss=1.16, accuracy=0.749, val_loss=1.63, val_accuracy=0.591, lr=0.1] 69%|██████▉   | 52/75 [22:13<09:36, 25.07s/epoch, loss=1.16, accuracy=0.749, val_loss=2.05, val_accuracy=0.442, lr=0.0316] 71%|███████   | 53/75 [22:38<09:10, 25.02s/epoch, loss=1.17, accuracy=0.749, val_loss=4.52, val_accuracy=0.282, lr=0.1]    72%|███████▏  | 54/75 [23:04<08:48, 25.17s/epoch, loss=1.16, accuracy=0.751, val_loss=1.82, val_accuracy=0.511, lr=0.1] 73%|███████▎  | 55/75 [23:29<08:22, 25.15s/epoch, loss=1.16, accuracy=0.749, val_loss=1.93, val_accuracy=0.436, lr=0.1] 75%|███████▍  | 56/75 [23:54<07:59, 25.26s/epoch, loss=1.16, accuracy=0.749, val_loss=1.7, val_accuracy=0.582, lr=0.1]  76%|███████▌  | 57/75 [24:19<07:32, 25.16s/epoch, loss=1.16, accuracy=0.75, val_loss=2.41, val_accuracy=0.433, lr=0.0316] 77%|███████▋  | 58/75 [24:44<07:05, 25.05s/epoch, loss=1.15, accuracy=0.753, val_loss=2.05, val_accuracy=0.443, lr=0.1]   79%|███████▊  | 59/75 [25:10<06:43, 25.19s/epoch, loss=1.16, accuracy=0.75, val_loss=2.05, val_accuracy=0.476, lr=0.1]  80%|████████  | 60/75 [25:35<06:17, 25.19s/epoch, loss=1.16, accuracy=0.749, val_loss=1.67, val_accuracy=0.592, lr=0.1] 81%|████████▏ | 61/75 [26:00<05:52, 25.20s/epoch, loss=1.15, accuracy=0.751, val_loss=3.55, val_accuracy=0.31, lr=0.1]  83%|████████▎ | 62/75 [26:25<05:28, 25.24s/epoch, loss=1.15, accuracy=0.755, val_loss=2.65, val_accuracy=0.447, lr=0.0316] 84%|████████▍ | 63/75 [26:50<05:02, 25.18s/epoch, loss=1.15, accuracy=0.753, val_loss=1.69, val_accuracy=0.594, lr=0.1]    85%|████████▌ | 64/75 [27:16<04:40, 25.46s/epoch, loss=1.15, accuracy=0.753, val_loss=3.06, val_accuracy=0.374, lr=0.1] 87%|████████▋ | 65/75 [27:42<04:15, 25.52s/epoch, loss=1.15, accuracy=0.751, val_loss=2.01, val_accuracy=0.541, lr=0.1] 88%|████████▊ | 66/75 [28:07<03:47, 25.25s/epoch, loss=1.16, accuracy=0.751, val_loss=1.95, val_accuracy=0.501, lr=0.1] 89%|████████▉ | 67/75 [28:32<03:21, 25.18s/epoch, loss=1.15, accuracy=0.752, val_loss=3.33, val_accuracy=0.359, lr=0.0316] 91%|█████████ | 68/75 [28:57<02:55, 25.12s/epoch, loss=1.15, accuracy=0.753, val_loss=2.05, val_accuracy=0.498, lr=0.1]    92%|█████████▏| 69/75 [29:21<02:29, 24.95s/epoch, loss=1.14, accuracy=0.753, val_loss=2.24, val_accuracy=0.405, lr=0.1] 93%|█████████▎| 70/75 [29:47<02:05, 25.09s/epoch, loss=1.15, accuracy=0.751, val_loss=1.98, val_accuracy=0.519, lr=0.1] 95%|█████████▍| 71/75 [30:11<01:39, 24.98s/epoch, loss=1.14, accuracy=0.751, val_loss=1.71, val_accuracy=0.544, lr=0.1] 96%|█████████▌| 72/75 [30:37<01:15, 25.03s/epoch, loss=1.15, accuracy=0.75, val_loss=3.14, val_accuracy=0.363, lr=0.0316] 97%|█████████▋| 73/75 [31:01<00:49, 24.91s/epoch, loss=1.15, accuracy=0.753, val_loss=1.92, val_accuracy=0.566, lr=0.1]   99%|█████████▊| 74/75 [31:26<00:25, 25.02s/epoch, loss=1.14, accuracy=0.755, val_loss=2.34, val_accuracy=0.459, lr=0.1]100%|██████████| 75/75 [31:52<00:00, 25.12s/epoch, loss=1.15, accuracy=0.752, val_loss=2.41, val_accuracy=0.466, lr=0.1]100%|██████████| 75/75 [31:52<00:00, 25.50s/epoch, loss=1.15, accuracy=0.752, val_loss=2.41, val_accuracy=0.466, lr=0.1]
Using real-time data augmentation.
Test score: 1.4000327587127686
Test accuracy: 0.6736000180244446


* * * Run SGD for ID = 20_4. * * *


2024-02-20 01:32:44.586045: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 01:32:47.269569: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 01:32:47.270690: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-20 01:32:47.315140: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:86:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-20 01:32:47.315185: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 01:32:47.318439: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 01:32:47.318507: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-20 01:32:47.321118: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-20 01:32:47.321925: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-20 01:32:47.324605: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-20 01:32:47.326327: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-20 01:32:47.331765: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 01:32:47.332498: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-20 01:32:47.332591: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 01:32:48.757706: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-20 01:32:48.758438: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 01:32:48.758996: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:86:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-20 01:32:48.759031: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 01:32:48.759065: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 01:32:48.759080: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-20 01:32:48.759094: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-20 01:32:48.759108: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-20 01:32:48.759122: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-20 01:32:48.759136: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-20 01:32:48.759150: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 01:32:48.759720: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-20 01:32:48.759754: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 01:32:49.410212: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-20 01:32:49.410278: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-20 01:32:49.410290: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-20 01:32:49.412078: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:86:00.0, compute capability: 6.1)
{'id': '20_04', 'batch_size': 128, 'epochs': 75, 'validation_split': 0.1, 'checkpointing': True, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
x_train shape: (45000, 32, 32, 3)
45000 train samples
5000 validation samples
10000 test samples
y_train shape: (45000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/75 [00:00<?, ?epoch/s]2024-02-20 01:32:50.257750: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-20 01:32:50.270005: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-02-20 01:32:52.327950: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 01:32:52.645077: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 01:32:53.585090: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-20 01:32:53.631359: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|▏         | 1/75 [00:59<1:12:58, 59.16s/epoch, loss=3.68, accuracy=0.285, val_loss=2.78, val_accuracy=0.2, lr=0.1]  3%|▎         | 2/75 [01:24<47:32, 39.07s/epoch, loss=1.72, accuracy=0.469, val_loss=2.47, val_accuracy=0.272, lr=0.1]  4%|▍         | 3/75 [01:49<39:09, 32.63s/epoch, loss=1.51, accuracy=0.555, val_loss=2.27, val_accuracy=0.436, lr=0.1]  5%|▌         | 4/75 [02:14<35:21, 29.88s/epoch, loss=1.46, accuracy=0.601, val_loss=2.02, val_accuracy=0.451, lr=0.1]  7%|▋         | 5/75 [02:40<33:08, 28.41s/epoch, loss=1.41, accuracy=0.63, val_loss=2.46, val_accuracy=0.351, lr=0.1]   8%|▊         | 6/75 [03:06<31:45, 27.61s/epoch, loss=1.36, accuracy=0.656, val_loss=3.16, val_accuracy=0.309, lr=0.1]  9%|▉         | 7/75 [03:32<30:48, 27.18s/epoch, loss=1.33, accuracy=0.676, val_loss=2.61, val_accuracy=0.343, lr=0.1] 11%|█         | 8/75 [03:57<29:31, 26.44s/epoch, loss=1.29, accuracy=0.694, val_loss=1.61, val_accuracy=0.589, lr=0.1] 12%|█▏        | 9/75 [04:22<28:31, 25.93s/epoch, loss=1.28, accuracy=0.701, val_loss=2.23, val_accuracy=0.383, lr=0.1] 13%|█▎        | 10/75 [04:47<27:51, 25.71s/epoch, loss=1.25, accuracy=0.711, val_loss=2.12, val_accuracy=0.47, lr=0.1] 15%|█▍        | 11/75 [05:12<27:06, 25.42s/epoch, loss=1.24, accuracy=0.718, val_loss=1.96, val_accuracy=0.489, lr=0.1] 16%|█▌        | 12/75 [05:37<26:34, 25.30s/epoch, loss=1.23, accuracy=0.722, val_loss=1.7, val_accuracy=0.57, lr=0.1]   17%|█▋        | 13/75 [06:02<26:01, 25.18s/epoch, loss=1.23, accuracy=0.724, val_loss=2.31, val_accuracy=0.425, lr=0.0316] 19%|█▊        | 14/75 [06:27<25:34, 25.16s/epoch, loss=1.23, accuracy=0.726, val_loss=1.77, val_accuracy=0.55, lr=0.1]     20%|██        | 15/75 [06:52<25:04, 25.07s/epoch, loss=1.22, accuracy=0.732, val_loss=1.87, val_accuracy=0.553, lr=0.1] 21%|██▏       | 16/75 [07:17<24:40, 25.09s/epoch, loss=1.21, accuracy=0.732, val_loss=1.66, val_accuracy=0.588, lr=0.1] 23%|██▎       | 17/75 [07:43<24:29, 25.34s/epoch, loss=1.2, accuracy=0.736, val_loss=1.74, val_accuracy=0.578, lr=0.1]  24%|██▍       | 18/75 [08:09<24:13, 25.51s/epoch, loss=1.2, accuracy=0.736, val_loss=1.61, val_accuracy=0.613, lr=0.0316] 25%|██▌       | 19/75 [08:34<23:33, 25.24s/epoch, loss=1.2, accuracy=0.738, val_loss=2.51, val_accuracy=0.414, lr=0.1]    27%|██▋       | 20/75 [08:59<23:11, 25.30s/epoch, loss=1.19, accuracy=0.739, val_loss=1.79, val_accuracy=0.577, lr=0.1] 28%|██▊       | 21/75 [09:24<22:37, 25.14s/epoch, loss=1.19, accuracy=0.739, val_loss=2.07, val_accuracy=0.443, lr=0.1] 29%|██▉       | 22/75 [09:49<22:07, 25.04s/epoch, loss=1.19, accuracy=0.74, val_loss=2.26, val_accuracy=0.479, lr=0.1]  31%|███       | 23/75 [10:14<21:49, 25.18s/epoch, loss=1.18, accuracy=0.742, val_loss=1.87, val_accuracy=0.484, lr=0.0316] 32%|███▏      | 24/75 [10:39<21:21, 25.13s/epoch, loss=1.18, accuracy=0.742, val_loss=1.68, val_accuracy=0.594, lr=0.1]    33%|███▎      | 25/75 [11:05<21:02, 25.24s/epoch, loss=1.18, accuracy=0.742, val_loss=1.4, val_accuracy=0.654, lr=0.1]  35%|███▍      | 26/75 [11:29<20:29, 25.09s/epoch, loss=1.18, accuracy=0.742, val_loss=2.32, val_accuracy=0.367, lr=0.1] 36%|███▌      | 27/75 [11:54<19:58, 24.97s/epoch, loss=1.18, accuracy=0.742, val_loss=1.78, val_accuracy=0.58, lr=0.1]  37%|███▋      | 28/75 [12:19<19:30, 24.91s/epoch, loss=1.18, accuracy=0.744, val_loss=1.61, val_accuracy=0.593, lr=0.1] 39%|███▊      | 29/75 [12:43<19:01, 24.81s/epoch, loss=1.18, accuracy=0.743, val_loss=2.22, val_accuracy=0.455, lr=0.1] 40%|████      | 30/75 [13:09<18:47, 25.05s/epoch, loss=1.18, accuracy=0.743, val_loss=1.75, val_accuracy=0.566, lr=0.0316] 41%|████▏     | 31/75 [13:34<18:20, 25.01s/epoch, loss=1.18, accuracy=0.745, val_loss=1.95, val_accuracy=0.54, lr=0.1]     43%|████▎     | 32/75 [13:59<17:59, 25.11s/epoch, loss=1.18, accuracy=0.743, val_loss=1.74, val_accuracy=0.576, lr=0.1] 44%|████▍     | 33/75 [14:24<17:34, 25.11s/epoch, loss=1.17, accuracy=0.744, val_loss=2.31, val_accuracy=0.461, lr=0.1] 45%|████▌     | 34/75 [14:50<17:10, 25.13s/epoch, loss=1.17, accuracy=0.745, val_loss=2.06, val_accuracy=0.435, lr=0.1] 47%|████▋     | 35/75 [15:15<16:44, 25.12s/epoch, loss=1.17, accuracy=0.744, val_loss=1.88, val_accuracy=0.511, lr=0.0316] 48%|████▊     | 36/75 [15:40<16:19, 25.10s/epoch, loss=1.17, accuracy=0.747, val_loss=1.78, val_accuracy=0.532, lr=0.1]    49%|████▉     | 37/75 [16:05<15:56, 25.16s/epoch, loss=1.17, accuracy=0.745, val_loss=1.85, val_accuracy=0.544, lr=0.1] 51%|█████     | 38/75 [16:30<15:33, 25.23s/epoch, loss=1.17, accuracy=0.749, val_loss=1.58, val_accuracy=0.608, lr=0.1] 52%|█████▏    | 39/75 [16:56<15:08, 25.23s/epoch, loss=1.16, accuracy=0.749, val_loss=2.8, val_accuracy=0.438, lr=0.1]  53%|█████▎    | 40/75 [17:21<14:43, 25.26s/epoch, loss=1.17, accuracy=0.747, val_loss=1.68, val_accuracy=0.558, lr=0.0316] 55%|█████▍    | 41/75 [17:46<14:14, 25.14s/epoch, loss=1.16, accuracy=0.746, val_loss=2.16, val_accuracy=0.464, lr=0.1]    56%|█████▌    | 42/75 [18:10<13:44, 24.99s/epoch, loss=1.15, accuracy=0.75, val_loss=2.05, val_accuracy=0.5, lr=0.1]    57%|█████▋    | 43/75 [18:35<13:15, 24.87s/epoch, loss=1.15, accuracy=0.747, val_loss=1.88, val_accuracy=0.514, lr=0.1] 59%|█████▊    | 44/75 [19:00<12:50, 24.87s/epoch, loss=1.16, accuracy=0.75, val_loss=1.6, val_accuracy=0.61, lr=0.1]    60%|██████    | 45/75 [19:25<12:29, 24.99s/epoch, loss=1.16, accuracy=0.746, val_loss=1.72, val_accuracy=0.614, lr=0.0316] 61%|██████▏   | 46/75 [19:51<12:09, 25.15s/epoch, loss=1.16, accuracy=0.749, val_loss=2.7, val_accuracy=0.425, lr=0.1]     63%|██████▎   | 47/75 [20:16<11:44, 25.15s/epoch, loss=1.17, accuracy=0.748, val_loss=1.77, val_accuracy=0.55, lr=0.1] 64%|██████▍   | 48/75 [20:42<11:25, 25.37s/epoch, loss=1.16, accuracy=0.749, val_loss=1.47, val_accuracy=0.655, lr=0.1] 65%|██████▌   | 49/75 [21:07<10:56, 25.26s/epoch, loss=1.15, accuracy=0.751, val_loss=1.39, val_accuracy=0.662, lr=0.1] 67%|██████▋   | 50/75 [21:32<10:30, 25.20s/epoch, loss=1.16, accuracy=0.748, val_loss=1.99, val_accuracy=0.57, lr=0.1]  68%|██████▊   | 51/75 [21:57<10:04, 25.20s/epoch, loss=1.15, accuracy=0.75, val_loss=1.52, val_accuracy=0.639, lr=0.1] 69%|██████▉   | 52/75 [22:22<09:37, 25.13s/epoch, loss=1.15, accuracy=0.748, val_loss=2.52, val_accuracy=0.453, lr=0.1] 71%|███████   | 53/75 [22:47<09:13, 25.15s/epoch, loss=1.16, accuracy=0.747, val_loss=2.15, val_accuracy=0.475, lr=0.1] 72%|███████▏  | 54/75 [23:12<08:44, 24.99s/epoch, loss=1.15, accuracy=0.751, val_loss=3.16, val_accuracy=0.396, lr=0.0316] 73%|███████▎  | 55/75 [23:36<08:17, 24.89s/epoch, loss=1.14, accuracy=0.753, val_loss=1.51, val_accuracy=0.631, lr=0.1]    75%|███████▍  | 56/75 [24:01<07:53, 24.93s/epoch, loss=1.16, accuracy=0.751, val_loss=1.9, val_accuracy=0.511, lr=0.1]  76%|███████▌  | 57/75 [24:26<07:27, 24.84s/epoch, loss=1.16, accuracy=0.749, val_loss=1.96, val_accuracy=0.519, lr=0.1] 77%|███████▋  | 58/75 [24:51<07:02, 24.84s/epoch, loss=1.15, accuracy=0.75, val_loss=1.9, val_accuracy=0.551, lr=0.1]   79%|███████▊  | 59/75 [25:16<06:38, 24.88s/epoch, loss=1.15, accuracy=0.749, val_loss=3.95, val_accuracy=0.317, lr=0.0316] 80%|████████  | 60/75 [25:40<06:11, 24.80s/epoch, loss=1.15, accuracy=0.751, val_loss=3.99, val_accuracy=0.38, lr=0.1]     81%|████████▏ | 61/75 [26:05<05:47, 24.82s/epoch, loss=1.15, accuracy=0.749, val_loss=2.05, val_accuracy=0.531, lr=0.1] 83%|████████▎ | 62/75 [26:31<05:23, 24.92s/epoch, loss=1.15, accuracy=0.753, val_loss=1.62, val_accuracy=0.577, lr=0.1] 84%|████████▍ | 63/75 [26:55<04:59, 24.92s/epoch, loss=1.15, accuracy=0.75, val_loss=1.59, val_accuracy=0.609, lr=0.1]  85%|████████▌ | 64/75 [27:21<04:35, 25.03s/epoch, loss=1.15, accuracy=0.75, val_loss=1.39, val_accuracy=0.658, lr=0.0316] 87%|████████▋ | 65/75 [27:46<04:11, 25.17s/epoch, loss=1.14, accuracy=0.752, val_loss=2.35, val_accuracy=0.469, lr=0.1]   88%|████████▊ | 66/75 [28:12<03:47, 25.30s/epoch, loss=1.15, accuracy=0.752, val_loss=2.34, val_accuracy=0.457, lr=0.1] 89%|████████▉ | 67/75 [28:37<03:21, 25.20s/epoch, loss=1.15, accuracy=0.748, val_loss=2.34, val_accuracy=0.466, lr=0.1] 91%|█████████ | 68/75 [29:02<02:55, 25.09s/epoch, loss=1.14, accuracy=0.751, val_loss=2.39, val_accuracy=0.377, lr=0.1] 92%|█████████▏| 69/75 [29:27<02:30, 25.06s/epoch, loss=1.15, accuracy=0.753, val_loss=1.99, val_accuracy=0.496, lr=0.0316] 93%|█████████▎| 70/75 [29:52<02:05, 25.06s/epoch, loss=1.14, accuracy=0.753, val_loss=2.74, val_accuracy=0.387, lr=0.1]    95%|█████████▍| 71/75 [30:17<01:40, 25.03s/epoch, loss=1.15, accuracy=0.748, val_loss=1.79, val_accuracy=0.538, lr=0.1] 96%|█████████▌| 72/75 [30:41<01:14, 24.90s/epoch, loss=1.15, accuracy=0.751, val_loss=1.77, val_accuracy=0.557, lr=0.1] 97%|█████████▋| 73/75 [31:06<00:49, 24.95s/epoch, loss=1.14, accuracy=0.753, val_loss=2.76, val_accuracy=0.425, lr=0.1] 99%|█████████▊| 74/75 [31:32<00:25, 25.03s/epoch, loss=1.15, accuracy=0.752, val_loss=2.26, val_accuracy=0.494, lr=0.0316]100%|██████████| 75/75 [31:57<00:00, 25.21s/epoch, loss=1.14, accuracy=0.751, val_loss=4, val_accuracy=0.31, lr=0.1]       100%|██████████| 75/75 [31:57<00:00, 25.57s/epoch, loss=1.14, accuracy=0.751, val_loss=4, val_accuracy=0.31, lr=0.1]
Using real-time data augmentation.
Test score: 1.3911190032958984
Test accuracy: 0.659600019454956


* * * Run SGD for ID = 20_5. * * *


2024-02-20 02:04:56.777429: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 02:05:02.370782: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 02:05:02.372119: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-20 02:05:02.414525: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:86:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-20 02:05:02.414568: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 02:05:02.420598: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 02:05:02.420672: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-20 02:05:02.424894: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-20 02:05:02.426534: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-20 02:05:02.430373: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-20 02:05:02.433515: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-20 02:05:02.440298: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 02:05:02.441047: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-20 02:05:02.441133: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 02:05:03.879880: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-20 02:05:03.880992: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 02:05:03.881618: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:86:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-20 02:05:03.881658: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 02:05:03.881702: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 02:05:03.881716: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-20 02:05:03.881730: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-20 02:05:03.881745: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-20 02:05:03.881759: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-20 02:05:03.881773: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-20 02:05:03.881788: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 02:05:03.882359: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-20 02:05:03.882403: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 02:05:04.536840: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-20 02:05:04.536933: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-20 02:05:04.536946: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-20 02:05:04.540269: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:86:00.0, compute capability: 6.1)
{'id': '20_05', 'batch_size': 128, 'epochs': 75, 'validation_split': 0.1, 'checkpointing': True, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
x_train shape: (45000, 32, 32, 3)
45000 train samples
5000 validation samples
10000 test samples
y_train shape: (45000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/75 [00:00<?, ?epoch/s]2024-02-20 02:05:05.490067: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-20 02:05:05.490671: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-02-20 02:05:07.621729: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 02:05:07.944154: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 02:05:08.902862: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-20 02:05:08.955643: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|▏         | 1/75 [01:01<1:16:20, 61.89s/epoch, loss=3.47, accuracy=0.272, val_loss=2.5, val_accuracy=0.264, lr=0.1]  3%|▎         | 2/75 [01:26<48:54, 40.20s/epoch, loss=1.62, accuracy=0.508, val_loss=1.74, val_accuracy=0.474, lr=0.1]   4%|▍         | 3/75 [01:51<39:52, 33.23s/epoch, loss=1.36, accuracy=0.618, val_loss=1.56, val_accuracy=0.568, lr=0.1]  5%|▌         | 4/75 [02:16<35:30, 30.01s/epoch, loss=1.27, accuracy=0.674, val_loss=2.53, val_accuracy=0.362, lr=0.1]  7%|▋         | 5/75 [02:42<33:04, 28.34s/epoch, loss=1.23, accuracy=0.695, val_loss=2.69, val_accuracy=0.378, lr=0.1]  8%|▊         | 6/75 [03:07<31:11, 27.13s/epoch, loss=1.22, accuracy=0.707, val_loss=3.56, val_accuracy=0.238, lr=0.1]  9%|▉         | 7/75 [03:32<29:59, 26.47s/epoch, loss=1.21, accuracy=0.714, val_loss=1.97, val_accuracy=0.523, lr=0.1] 11%|█         | 8/75 [03:57<28:58, 25.95s/epoch, loss=1.2, accuracy=0.72, val_loss=2.54, val_accuracy=0.436, lr=0.0316] 12%|█▏        | 9/75 [04:22<28:12, 25.65s/epoch, loss=1.2, accuracy=0.724, val_loss=1.7, val_accuracy=0.574, lr=0.1]    13%|█▎        | 10/75 [04:46<27:27, 25.35s/epoch, loss=1.19, accuracy=0.728, val_loss=1.65, val_accuracy=0.588, lr=0.1] 15%|█▍        | 11/75 [05:11<26:58, 25.28s/epoch, loss=1.19, accuracy=0.732, val_loss=1.57, val_accuracy=0.613, lr=0.1] 16%|█▌        | 12/75 [05:37<26:32, 25.27s/epoch, loss=1.19, accuracy=0.73, val_loss=2.55, val_accuracy=0.424, lr=0.1]  17%|█▋        | 13/75 [06:02<26:03, 25.22s/epoch, loss=1.18, accuracy=0.735, val_loss=1.62, val_accuracy=0.592, lr=0.0316] 19%|█▊        | 14/75 [06:27<25:37, 25.20s/epoch, loss=1.18, accuracy=0.737, val_loss=1.87, val_accuracy=0.495, lr=0.1]    20%|██        | 15/75 [06:52<25:04, 25.07s/epoch, loss=1.17, accuracy=0.737, val_loss=2.52, val_accuracy=0.363, lr=0.1] 21%|██▏       | 16/75 [07:16<24:35, 25.01s/epoch, loss=1.17, accuracy=0.738, val_loss=1.89, val_accuracy=0.531, lr=0.1] 23%|██▎       | 17/75 [07:41<24:09, 24.99s/epoch, loss=1.17, accuracy=0.741, val_loss=1.82, val_accuracy=0.574, lr=0.1] 24%|██▍       | 18/75 [08:06<23:36, 24.85s/epoch, loss=1.17, accuracy=0.738, val_loss=4.06, val_accuracy=0.278, lr=0.0316] 25%|██▌       | 19/75 [08:31<23:15, 24.92s/epoch, loss=1.17, accuracy=0.742, val_loss=1.62, val_accuracy=0.588, lr=0.1]    27%|██▋       | 20/75 [08:56<22:47, 24.85s/epoch, loss=1.16, accuracy=0.74, val_loss=2.29, val_accuracy=0.48, lr=0.1]   28%|██▊       | 21/75 [09:21<22:33, 25.06s/epoch, loss=1.16, accuracy=0.745, val_loss=2.03, val_accuracy=0.45, lr=0.1] 29%|██▉       | 22/75 [09:47<22:17, 25.23s/epoch, loss=1.16, accuracy=0.745, val_loss=1.58, val_accuracy=0.615, lr=0.1] 31%|███       | 23/75 [10:12<21:45, 25.10s/epoch, loss=1.16, accuracy=0.747, val_loss=1.95, val_accuracy=0.518, lr=0.0316] 32%|███▏      | 24/75 [10:37<21:20, 25.10s/epoch, loss=1.16, accuracy=0.744, val_loss=2.07, val_accuracy=0.516, lr=0.1]    33%|███▎      | 25/75 [11:02<20:50, 25.02s/epoch, loss=1.15, accuracy=0.748, val_loss=1.96, val_accuracy=0.553, lr=0.1] 35%|███▍      | 26/75 [11:26<20:20, 24.92s/epoch, loss=1.15, accuracy=0.747, val_loss=4.38, val_accuracy=0.323, lr=0.1] 36%|███▌      | 27/75 [11:51<19:53, 24.85s/epoch, loss=1.16, accuracy=0.746, val_loss=1.99, val_accuracy=0.465, lr=0.1] 37%|███▋      | 28/75 [12:16<19:30, 24.91s/epoch, loss=1.14, accuracy=0.75, val_loss=1.75, val_accuracy=0.564, lr=0.0316] 39%|███▊      | 29/75 [12:41<19:08, 24.98s/epoch, loss=1.15, accuracy=0.749, val_loss=2.73, val_accuracy=0.416, lr=0.1]   40%|████      | 30/75 [13:07<18:54, 25.22s/epoch, loss=1.14, accuracy=0.749, val_loss=1.84, val_accuracy=0.543, lr=0.1] 41%|████▏     | 31/75 [13:34<18:49, 25.67s/epoch, loss=1.15, accuracy=0.748, val_loss=1.52, val_accuracy=0.598, lr=0.1] 43%|████▎     | 32/75 [14:01<18:45, 26.18s/epoch, loss=1.14, accuracy=0.749, val_loss=3.58, val_accuracy=0.307, lr=0.1] 44%|████▍     | 33/75 [14:28<18:26, 26.34s/epoch, loss=1.15, accuracy=0.748, val_loss=2.6, val_accuracy=0.314, lr=0.1]  45%|████▌     | 34/75 [14:52<17:35, 25.75s/epoch, loss=1.14, accuracy=0.75, val_loss=2.49, val_accuracy=0.364, lr=0.1] 47%|████▋     | 35/75 [15:17<16:55, 25.38s/epoch, loss=1.15, accuracy=0.75, val_loss=2.37, val_accuracy=0.435, lr=0.1] 48%|████▊     | 36/75 [15:42<16:24, 25.23s/epoch, loss=1.14, accuracy=0.752, val_loss=2.02, val_accuracy=0.521, lr=0.0316] 49%|████▉     | 37/75 [16:06<15:54, 25.12s/epoch, loss=1.14, accuracy=0.751, val_loss=2.21, val_accuracy=0.485, lr=0.1]    51%|█████     | 38/75 [16:32<15:36, 25.30s/epoch, loss=1.14, accuracy=0.752, val_loss=1.52, val_accuracy=0.632, lr=0.1] 52%|█████▏    | 39/75 [16:58<15:20, 25.58s/epoch, loss=1.14, accuracy=0.749, val_loss=2.05, val_accuracy=0.446, lr=0.1] 53%|█████▎    | 40/75 [17:23<14:47, 25.36s/epoch, loss=1.13, accuracy=0.751, val_loss=2.61, val_accuracy=0.397, lr=0.1] 55%|█████▍    | 41/75 [17:48<14:20, 25.30s/epoch, loss=1.13, accuracy=0.753, val_loss=1.8, val_accuracy=0.553, lr=0.1]  56%|█████▌    | 42/75 [18:13<13:52, 25.24s/epoch, loss=1.14, accuracy=0.751, val_loss=3.6, val_accuracy=0.19, lr=0.1]  57%|█████▋    | 43/75 [18:39<13:26, 25.21s/epoch, loss=1.13, accuracy=0.752, val_loss=2.59, val_accuracy=0.437, lr=0.0316] 59%|█████▊    | 44/75 [19:04<13:01, 25.19s/epoch, loss=1.13, accuracy=0.755, val_loss=2.17, val_accuracy=0.509, lr=0.1]    60%|██████    | 45/75 [19:29<12:32, 25.08s/epoch, loss=1.13, accuracy=0.754, val_loss=2.6, val_accuracy=0.409, lr=0.1]  61%|██████▏   | 46/75 [19:53<12:01, 24.88s/epoch, loss=1.13, accuracy=0.754, val_loss=2.51, val_accuracy=0.405, lr=0.1] 63%|██████▎   | 47/75 [20:18<11:36, 24.88s/epoch, loss=1.12, accuracy=0.755, val_loss=2.87, val_accuracy=0.417, lr=0.1] 64%|██████▍   | 48/75 [20:43<11:11, 24.85s/epoch, loss=1.13, accuracy=0.753, val_loss=2.29, val_accuracy=0.467, lr=0.0316] 65%|██████▌   | 49/75 [21:08<10:46, 24.88s/epoch, loss=1.13, accuracy=0.753, val_loss=2.87, val_accuracy=0.358, lr=0.1]    67%|██████▋   | 50/75 [21:32<10:20, 24.83s/epoch, loss=1.12, accuracy=0.756, val_loss=2.91, val_accuracy=0.388, lr=0.1] 68%|██████▊   | 51/75 [21:57<09:55, 24.80s/epoch, loss=1.13, accuracy=0.753, val_loss=2.19, val_accuracy=0.5, lr=0.1]   69%|██████▉   | 52/75 [22:22<09:32, 24.89s/epoch, loss=1.13, accuracy=0.754, val_loss=2.39, val_accuracy=0.488, lr=0.1] 71%|███████   | 53/75 [22:47<09:10, 25.02s/epoch, loss=1.13, accuracy=0.755, val_loss=1.62, val_accuracy=0.612, lr=0.0316] 72%|███████▏  | 54/75 [23:12<08:42, 24.89s/epoch, loss=1.13, accuracy=0.755, val_loss=2.12, val_accuracy=0.458, lr=0.1]    73%|███████▎  | 55/75 [23:36<08:14, 24.75s/epoch, loss=1.13, accuracy=0.756, val_loss=2.85, val_accuracy=0.388, lr=0.1] 75%|███████▍  | 56/75 [24:01<07:50, 24.76s/epoch, loss=1.12, accuracy=0.758, val_loss=2.14, val_accuracy=0.476, lr=0.1] 76%|███████▌  | 57/75 [24:26<07:26, 24.82s/epoch, loss=1.13, accuracy=0.753, val_loss=3.14, val_accuracy=0.411, lr=0.1] 77%|███████▋  | 58/75 [24:51<07:02, 24.83s/epoch, loss=1.13, accuracy=0.755, val_loss=2.48, val_accuracy=0.422, lr=0.0316] 79%|███████▊  | 59/75 [25:16<06:39, 25.00s/epoch, loss=1.13, accuracy=0.753, val_loss=1.78, val_accuracy=0.562, lr=0.1]    80%|████████  | 60/75 [25:42<06:15, 25.05s/epoch, loss=1.12, accuracy=0.757, val_loss=1.94, val_accuracy=0.491, lr=0.1] 81%|████████▏ | 61/75 [26:07<05:50, 25.07s/epoch, loss=1.12, accuracy=0.756, val_loss=2.59, val_accuracy=0.383, lr=0.1] 83%|████████▎ | 62/75 [26:32<05:25, 25.07s/epoch, loss=1.13, accuracy=0.753, val_loss=5.08, val_accuracy=0.331, lr=0.1] 84%|████████▍ | 63/75 [26:57<04:59, 24.96s/epoch, loss=1.13, accuracy=0.754, val_loss=2.03, val_accuracy=0.527, lr=0.0316] 85%|████████▌ | 64/75 [27:21<04:33, 24.90s/epoch, loss=1.12, accuracy=0.756, val_loss=2.06, val_accuracy=0.451, lr=0.1]    87%|████████▋ | 65/75 [27:46<04:08, 24.87s/epoch, loss=1.13, accuracy=0.756, val_loss=2.55, val_accuracy=0.463, lr=0.1] 88%|████████▊ | 66/75 [28:11<03:44, 24.95s/epoch, loss=1.12, accuracy=0.757, val_loss=1.81, val_accuracy=0.547, lr=0.1] 89%|████████▉ | 67/75 [28:36<03:19, 24.94s/epoch, loss=1.12, accuracy=0.756, val_loss=1.89, val_accuracy=0.543, lr=0.1] 91%|█████████ | 68/75 [29:01<02:54, 24.99s/epoch, loss=1.12, accuracy=0.755, val_loss=2.15, val_accuracy=0.413, lr=0.0316] 92%|█████████▏| 69/75 [29:26<02:29, 24.95s/epoch, loss=1.12, accuracy=0.756, val_loss=1.65, val_accuracy=0.591, lr=0.1]    93%|█████████▎| 70/75 [29:51<02:04, 24.86s/epoch, loss=1.12, accuracy=0.757, val_loss=2.19, val_accuracy=0.462, lr=0.1] 95%|█████████▍| 71/75 [30:15<01:39, 24.81s/epoch, loss=1.12, accuracy=0.756, val_loss=2.23, val_accuracy=0.493, lr=0.1] 96%|█████████▌| 72/75 [30:40<01:14, 24.74s/epoch, loss=1.11, accuracy=0.761, val_loss=2.84, val_accuracy=0.407, lr=0.1] 97%|█████████▋| 73/75 [31:05<00:49, 24.76s/epoch, loss=1.12, accuracy=0.756, val_loss=2.54, val_accuracy=0.338, lr=0.0316] 99%|█████████▊| 74/75 [31:29<00:24, 24.67s/epoch, loss=1.11, accuracy=0.757, val_loss=2.6, val_accuracy=0.431, lr=0.1]    100%|██████████| 75/75 [31:54<00:00, 24.78s/epoch, loss=1.11, accuracy=0.757, val_loss=3.73, val_accuracy=0.356, lr=0.1]100%|██████████| 75/75 [31:54<00:00, 25.53s/epoch, loss=1.11, accuracy=0.757, val_loss=3.73, val_accuracy=0.356, lr=0.1]
Using real-time data augmentation.
Test score: 1.5304105281829834
Test accuracy: 0.6291000247001648


* * * Run SGD for ID = 20_6. * * *


2024-02-20 02:37:07.055810: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 02:37:10.013193: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 02:37:10.014585: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-20 02:37:10.054890: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:86:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-20 02:37:10.054936: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 02:37:10.058881: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 02:37:10.058956: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-20 02:37:10.061748: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-20 02:37:10.062553: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-20 02:37:10.065408: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-20 02:37:10.067244: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-20 02:37:10.073389: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 02:37:10.074144: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-20 02:37:10.074235: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 02:37:11.484917: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-20 02:37:11.485609: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 02:37:11.486156: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:86:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-20 02:37:11.486194: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 02:37:11.486233: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 02:37:11.486248: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-20 02:37:11.486260: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-20 02:37:11.486273: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-20 02:37:11.486285: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-20 02:37:11.486297: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-20 02:37:11.486310: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 02:37:11.486863: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-20 02:37:11.486906: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 02:37:12.134021: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-20 02:37:12.134089: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-20 02:37:12.134109: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-20 02:37:12.135892: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:86:00.0, compute capability: 6.1)
{'id': '20_06', 'batch_size': 128, 'epochs': 75, 'validation_split': 0.1, 'checkpointing': True, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
x_train shape: (45000, 32, 32, 3)
45000 train samples
5000 validation samples
10000 test samples
y_train shape: (45000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/75 [00:00<?, ?epoch/s]2024-02-20 02:37:12.993329: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-20 02:37:12.993868: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-02-20 02:37:15.017860: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 02:37:15.346571: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 02:37:16.139817: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-20 02:37:16.182666: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|▏         | 1/75 [00:59<1:13:35, 59.66s/epoch, loss=3.32, accuracy=0.292, val_loss=2.17, val_accuracy=0.328, lr=0.1]  3%|▎         | 2/75 [01:24<47:54, 39.37s/epoch, loss=1.7, accuracy=0.47, val_loss=2.1, val_accuracy=0.349, lr=0.1]       4%|▍         | 3/75 [01:50<39:35, 32.99s/epoch, loss=1.5, accuracy=0.562, val_loss=2.23, val_accuracy=0.373, lr=0.1]  5%|▌         | 4/75 [02:15<35:38, 30.13s/epoch, loss=1.36, accuracy=0.638, val_loss=2.29, val_accuracy=0.401, lr=0.1]  7%|▋         | 5/75 [02:41<33:12, 28.46s/epoch, loss=1.29, accuracy=0.679, val_loss=2.24, val_accuracy=0.443, lr=0.1]  8%|▊         | 6/75 [03:06<31:19, 27.24s/epoch, loss=1.26, accuracy=0.698, val_loss=2.05, val_accuracy=0.499, lr=0.1]  9%|▉         | 7/75 [03:31<29:58, 26.45s/epoch, loss=1.23, accuracy=0.712, val_loss=2.52, val_accuracy=0.383, lr=0.1] 11%|█         | 8/75 [03:56<29:04, 26.04s/epoch, loss=1.23, accuracy=0.716, val_loss=1.53, val_accuracy=0.608, lr=0.1] 12%|█▏        | 9/75 [04:21<28:17, 25.71s/epoch, loss=1.21, accuracy=0.724, val_loss=1.54, val_accuracy=0.632, lr=0.1] 13%|█▎        | 10/75 [04:46<27:42, 25.58s/epoch, loss=1.22, accuracy=0.726, val_loss=1.57, val_accuracy=0.609, lr=0.1] 15%|█▍        | 11/75 [05:11<27:13, 25.52s/epoch, loss=1.21, accuracy=0.731, val_loss=2.15, val_accuracy=0.499, lr=0.1] 16%|█▌        | 12/75 [05:37<26:48, 25.53s/epoch, loss=1.2, accuracy=0.732, val_loss=3.95, val_accuracy=0.292, lr=0.1]  17%|█▋        | 13/75 [06:02<26:12, 25.36s/epoch, loss=1.2, accuracy=0.736, val_loss=1.74, val_accuracy=0.532, lr=0.0316] 19%|█▊        | 14/75 [06:27<25:34, 25.16s/epoch, loss=1.19, accuracy=0.741, val_loss=1.82, val_accuracy=0.561, lr=0.1]   20%|██        | 15/75 [06:52<25:12, 25.21s/epoch, loss=1.19, accuracy=0.74, val_loss=1.81, val_accuracy=0.567, lr=0.1]  21%|██▏       | 16/75 [07:17<24:34, 24.99s/epoch, loss=1.19, accuracy=0.739, val_loss=1.64, val_accuracy=0.563, lr=0.1] 23%|██▎       | 17/75 [07:42<24:10, 25.00s/epoch, loss=1.18, accuracy=0.743, val_loss=1.73, val_accuracy=0.592, lr=0.1] 24%|██▍       | 18/75 [08:06<23:36, 24.86s/epoch, loss=1.18, accuracy=0.743, val_loss=1.72, val_accuracy=0.554, lr=0.0316] 25%|██▌       | 19/75 [08:31<23:19, 25.00s/epoch, loss=1.17, accuracy=0.746, val_loss=1.96, val_accuracy=0.588, lr=0.1]    27%|██▋       | 20/75 [08:56<22:51, 24.93s/epoch, loss=1.17, accuracy=0.742, val_loss=2.33, val_accuracy=0.44, lr=0.1]  28%|██▊       | 21/75 [09:21<22:23, 24.88s/epoch, loss=1.17, accuracy=0.744, val_loss=2.01, val_accuracy=0.522, lr=0.1] 29%|██▉       | 22/75 [09:46<22:02, 24.96s/epoch, loss=1.17, accuracy=0.746, val_loss=1.51, val_accuracy=0.609, lr=0.1] 31%|███       | 23/75 [10:11<21:40, 25.00s/epoch, loss=1.17, accuracy=0.746, val_loss=4.13, val_accuracy=0.313, lr=0.1] 32%|███▏      | 24/75 [10:36<21:15, 25.01s/epoch, loss=1.17, accuracy=0.746, val_loss=1.71, val_accuracy=0.551, lr=0.1] 33%|███▎      | 25/75 [11:01<20:50, 25.01s/epoch, loss=1.17, accuracy=0.747, val_loss=1.99, val_accuracy=0.475, lr=0.1] 35%|███▍      | 26/75 [11:26<20:21, 24.93s/epoch, loss=1.17, accuracy=0.748, val_loss=3.09, val_accuracy=0.383, lr=0.1] 36%|███▌      | 27/75 [11:51<20:02, 25.05s/epoch, loss=1.16, accuracy=0.749, val_loss=2.33, val_accuracy=0.508, lr=0.0316] 37%|███▋      | 28/75 [12:17<19:40, 25.11s/epoch, loss=1.15, accuracy=0.75, val_loss=1.72, val_accuracy=0.607, lr=0.1]     39%|███▊      | 29/75 [12:41<19:09, 24.98s/epoch, loss=1.16, accuracy=0.75, val_loss=2.87, val_accuracy=0.471, lr=0.1] 40%|████      | 30/75 [13:06<18:46, 25.02s/epoch, loss=1.16, accuracy=0.751, val_loss=1.74, val_accuracy=0.606, lr=0.1] 41%|████▏     | 31/75 [13:31<18:16, 24.93s/epoch, loss=1.16, accuracy=0.749, val_loss=1.79, val_accuracy=0.517, lr=0.1] 43%|████▎     | 32/75 [13:56<17:51, 24.92s/epoch, loss=1.16, accuracy=0.748, val_loss=1.67, val_accuracy=0.6, lr=0.0316] 44%|████▍     | 33/75 [14:21<17:33, 25.08s/epoch, loss=1.16, accuracy=0.75, val_loss=4.1, val_accuracy=0.275, lr=0.1]    45%|████▌     | 34/75 [14:47<17:12, 25.19s/epoch, loss=1.16, accuracy=0.751, val_loss=1.28, val_accuracy=0.712, lr=0.1] 47%|████▋     | 35/75 [15:11<16:40, 25.01s/epoch, loss=1.15, accuracy=0.752, val_loss=1.4, val_accuracy=0.667, lr=0.1]  48%|████▊     | 36/75 [15:37<16:16, 25.03s/epoch, loss=1.15, accuracy=0.756, val_loss=3.1, val_accuracy=0.42, lr=0.1]  49%|████▉     | 37/75 [16:02<15:52, 25.06s/epoch, loss=1.15, accuracy=0.754, val_loss=1.52, val_accuracy=0.623, lr=0.1] 51%|█████     | 38/75 [16:27<15:30, 25.14s/epoch, loss=1.15, accuracy=0.751, val_loss=1.67, val_accuracy=0.577, lr=0.1] 52%|█████▏    | 39/75 [16:52<15:02, 25.07s/epoch, loss=1.15, accuracy=0.754, val_loss=2.51, val_accuracy=0.454, lr=0.0316] 53%|█████▎    | 40/75 [17:16<14:32, 24.92s/epoch, loss=1.15, accuracy=0.752, val_loss=2.21, val_accuracy=0.424, lr=0.1]    55%|█████▍    | 41/75 [17:42<14:11, 25.06s/epoch, loss=1.15, accuracy=0.752, val_loss=1.31, val_accuracy=0.69, lr=0.1]  56%|█████▌    | 42/75 [18:07<13:49, 25.14s/epoch, loss=1.14, accuracy=0.754, val_loss=1.39, val_accuracy=0.667, lr=0.1] 57%|█████▋    | 43/75 [18:32<13:22, 25.09s/epoch, loss=1.14, accuracy=0.754, val_loss=4.89, val_accuracy=0.216, lr=0.1] 59%|█████▊    | 44/75 [18:57<12:59, 25.16s/epoch, loss=1.14, accuracy=0.754, val_loss=2.39, val_accuracy=0.48, lr=0.0316] 60%|██████    | 45/75 [19:22<12:31, 25.03s/epoch, loss=1.14, accuracy=0.755, val_loss=2.2, val_accuracy=0.437, lr=0.1]    61%|██████▏   | 46/75 [19:47<12:02, 24.90s/epoch, loss=1.15, accuracy=0.755, val_loss=2.87, val_accuracy=0.486, lr=0.1] 63%|██████▎   | 47/75 [20:12<11:38, 24.95s/epoch, loss=1.14, accuracy=0.753, val_loss=2.35, val_accuracy=0.441, lr=0.1] 64%|██████▍   | 48/75 [20:37<11:19, 25.16s/epoch, loss=1.14, accuracy=0.757, val_loss=1.59, val_accuracy=0.586, lr=0.1] 65%|██████▌   | 49/75 [21:02<10:51, 25.06s/epoch, loss=1.14, accuracy=0.753, val_loss=1.58, val_accuracy=0.598, lr=0.0316] 67%|██████▋   | 50/75 [21:27<10:25, 25.02s/epoch, loss=1.14, accuracy=0.758, val_loss=3.19, val_accuracy=0.402, lr=0.1]    68%|██████▊   | 51/75 [21:52<09:59, 24.97s/epoch, loss=1.14, accuracy=0.756, val_loss=1.79, val_accuracy=0.566, lr=0.1] 69%|██████▉   | 52/75 [22:17<09:35, 25.04s/epoch, loss=1.13, accuracy=0.756, val_loss=2.03, val_accuracy=0.469, lr=0.1] 71%|███████   | 53/75 [22:42<09:10, 25.02s/epoch, loss=1.13, accuracy=0.76, val_loss=1.81, val_accuracy=0.514, lr=0.1]  72%|███████▏  | 54/75 [23:07<08:44, 24.99s/epoch, loss=1.14, accuracy=0.757, val_loss=1.91, val_accuracy=0.567, lr=0.0316] 73%|███████▎  | 55/75 [23:32<08:17, 24.87s/epoch, loss=1.14, accuracy=0.758, val_loss=2.26, val_accuracy=0.417, lr=0.1]    75%|███████▍  | 56/75 [23:58<08:01, 25.32s/epoch, loss=1.14, accuracy=0.757, val_loss=1.84, val_accuracy=0.485, lr=0.1] 76%|███████▌  | 57/75 [24:24<07:39, 25.54s/epoch, loss=1.14, accuracy=0.755, val_loss=2.27, val_accuracy=0.413, lr=0.1] 77%|███████▋  | 58/75 [24:50<07:15, 25.59s/epoch, loss=1.13, accuracy=0.758, val_loss=1.76, val_accuracy=0.586, lr=0.1] 79%|███████▊  | 59/75 [25:16<06:50, 25.66s/epoch, loss=1.14, accuracy=0.754, val_loss=1.84, val_accuracy=0.54, lr=0.0316] 80%|████████  | 60/75 [25:41<06:21, 25.40s/epoch, loss=1.13, accuracy=0.758, val_loss=1.77, val_accuracy=0.584, lr=0.1]   81%|████████▏ | 61/75 [26:05<05:51, 25.13s/epoch, loss=1.13, accuracy=0.758, val_loss=1.79, val_accuracy=0.531, lr=0.1] 83%|████████▎ | 62/75 [26:30<05:25, 25.02s/epoch, loss=1.13, accuracy=0.756, val_loss=2.44, val_accuracy=0.415, lr=0.1] 84%|████████▍ | 63/75 [26:55<05:00, 25.07s/epoch, loss=1.14, accuracy=0.756, val_loss=3.79, val_accuracy=0.237, lr=0.1] 85%|████████▌ | 64/75 [27:20<04:36, 25.10s/epoch, loss=1.13, accuracy=0.756, val_loss=1.94, val_accuracy=0.508, lr=0.0316] 87%|████████▋ | 65/75 [27:45<04:09, 25.00s/epoch, loss=1.13, accuracy=0.756, val_loss=2.32, val_accuracy=0.421, lr=0.1]    88%|████████▊ | 66/75 [28:10<03:44, 24.96s/epoch, loss=1.13, accuracy=0.759, val_loss=2.3, val_accuracy=0.421, lr=0.1]  89%|████████▉ | 67/75 [28:34<03:18, 24.81s/epoch, loss=1.14, accuracy=0.756, val_loss=3.62, val_accuracy=0.32, lr=0.1] 91%|█████████ | 68/75 [28:59<02:54, 24.87s/epoch, loss=1.14, accuracy=0.756, val_loss=2.01, val_accuracy=0.455, lr=0.1] 92%|█████████▏| 69/75 [29:24<02:28, 24.81s/epoch, loss=1.12, accuracy=0.757, val_loss=2.15, val_accuracy=0.454, lr=0.0316] 93%|█████████▎| 70/75 [29:48<02:03, 24.73s/epoch, loss=1.13, accuracy=0.757, val_loss=1.54, val_accuracy=0.611, lr=0.1]    95%|█████████▍| 71/75 [30:13<01:38, 24.72s/epoch, loss=1.13, accuracy=0.758, val_loss=1.34, val_accuracy=0.683, lr=0.1] 96%|█████████▌| 72/75 [30:39<01:14, 24.94s/epoch, loss=1.13, accuracy=0.755, val_loss=2.69, val_accuracy=0.45, lr=0.1]  97%|█████████▋| 73/75 [31:03<00:49, 24.89s/epoch, loss=1.13, accuracy=0.76, val_loss=2.62, val_accuracy=0.515, lr=0.1] 99%|█████████▊| 74/75 [31:28<00:24, 24.87s/epoch, loss=1.14, accuracy=0.758, val_loss=1.67, val_accuracy=0.585, lr=0.0316]100%|██████████| 75/75 [31:53<00:00, 24.72s/epoch, loss=1.12, accuracy=0.759, val_loss=1.7, val_accuracy=0.576, lr=0.1]    100%|██████████| 75/75 [31:53<00:00, 25.51s/epoch, loss=1.12, accuracy=0.759, val_loss=1.7, val_accuracy=0.576, lr=0.1]
Using real-time data augmentation.
Test score: 1.3315733671188354
Test accuracy: 0.6955999732017517


* * * Run SGD for ID = 20_7. * * *


2024-02-20 03:09:13.002321: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 03:09:15.849213: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 03:09:15.850539: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-20 03:09:15.893004: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:86:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-20 03:09:15.893058: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 03:09:15.896620: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 03:09:15.896697: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-20 03:09:15.899498: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-20 03:09:15.900311: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-20 03:09:15.903095: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-20 03:09:15.904842: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-20 03:09:15.910330: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 03:09:15.911061: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-20 03:09:15.911205: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 03:09:17.359294: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-20 03:09:17.360347: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 03:09:17.360940: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:86:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-20 03:09:17.360981: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 03:09:17.361020: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 03:09:17.361035: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-20 03:09:17.361049: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-20 03:09:17.361063: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-20 03:09:17.361077: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-20 03:09:17.361091: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-20 03:09:17.361105: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 03:09:17.361686: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-20 03:09:17.361729: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 03:09:18.016321: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-20 03:09:18.016380: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-20 03:09:18.016391: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-20 03:09:18.017540: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:86:00.0, compute capability: 6.1)
{'id': '20_07', 'batch_size': 128, 'epochs': 75, 'validation_split': 0.1, 'checkpointing': True, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
x_train shape: (45000, 32, 32, 3)
45000 train samples
5000 validation samples
10000 test samples
y_train shape: (45000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/75 [00:00<?, ?epoch/s]2024-02-20 03:09:18.953325: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-20 03:09:18.966042: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-02-20 03:09:20.979922: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 03:09:21.294357: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 03:09:22.252223: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-20 03:09:22.315230: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|▏         | 1/75 [01:02<1:17:15, 62.65s/epoch, loss=3.68, accuracy=0.271, val_loss=2.74, val_accuracy=0.153, lr=0.1]  3%|▎         | 2/75 [01:27<49:16, 40.50s/epoch, loss=1.64, accuracy=0.506, val_loss=5.1, val_accuracy=0.17, lr=0.1]      4%|▍         | 3/75 [01:53<40:20, 33.61s/epoch, loss=1.36, accuracy=0.626, val_loss=2.01, val_accuracy=0.469, lr=0.1]  5%|▌         | 4/75 [02:17<35:43, 30.19s/epoch, loss=1.28, accuracy=0.674, val_loss=2.09, val_accuracy=0.409, lr=0.1]  7%|▋         | 5/75 [02:43<33:07, 28.40s/epoch, loss=1.24, accuracy=0.695, val_loss=2.61, val_accuracy=0.357, lr=0.1]  8%|▊         | 6/75 [03:08<31:26, 27.34s/epoch, loss=1.23, accuracy=0.707, val_loss=1.47, val_accuracy=0.63, lr=0.1]   9%|▉         | 7/75 [03:33<30:02, 26.51s/epoch, loss=1.21, accuracy=0.715, val_loss=1.77, val_accuracy=0.553, lr=0.1] 11%|█         | 8/75 [03:58<29:17, 26.23s/epoch, loss=1.2, accuracy=0.72, val_loss=1.96, val_accuracy=0.507, lr=0.1]   12%|█▏        | 9/75 [04:24<28:27, 25.87s/epoch, loss=1.2, accuracy=0.726, val_loss=2.42, val_accuracy=0.413, lr=0.1] 13%|█▎        | 10/75 [04:49<27:50, 25.70s/epoch, loss=1.19, accuracy=0.73, val_loss=1.99, val_accuracy=0.521, lr=0.1] 15%|█▍        | 11/75 [05:16<27:50, 26.10s/epoch, loss=1.18, accuracy=0.732, val_loss=1.99, val_accuracy=0.494, lr=0.0316] 16%|█▌        | 12/75 [05:41<26:59, 25.70s/epoch, loss=1.19, accuracy=0.732, val_loss=2.42, val_accuracy=0.403, lr=0.1]    17%|█▋        | 13/75 [06:05<26:12, 25.36s/epoch, loss=1.18, accuracy=0.737, val_loss=2, val_accuracy=0.499, lr=0.1]    19%|█▊        | 14/75 [06:30<25:39, 25.24s/epoch, loss=1.17, accuracy=0.739, val_loss=1.6, val_accuracy=0.613, lr=0.1] 20%|██        | 15/75 [06:55<25:14, 25.24s/epoch, loss=1.18, accuracy=0.737, val_loss=1.5, val_accuracy=0.634, lr=0.1] 21%|██▏       | 16/75 [07:20<24:40, 25.09s/epoch, loss=1.16, accuracy=0.742, val_loss=2.66, val_accuracy=0.426, lr=0.0316] 23%|██▎       | 17/75 [07:45<24:11, 25.02s/epoch, loss=1.17, accuracy=0.737, val_loss=1.85, val_accuracy=0.525, lr=0.1]    24%|██▍       | 18/75 [08:10<23:40, 24.92s/epoch, loss=1.17, accuracy=0.741, val_loss=2.09, val_accuracy=0.484, lr=0.1] 25%|██▌       | 19/75 [08:35<23:23, 25.07s/epoch, loss=1.16, accuracy=0.742, val_loss=1.6, val_accuracy=0.636, lr=0.1]  27%|██▋       | 20/75 [09:00<22:50, 24.93s/epoch, loss=1.16, accuracy=0.744, val_loss=1.74, val_accuracy=0.58, lr=0.1] 28%|██▊       | 21/75 [09:25<22:25, 24.91s/epoch, loss=1.16, accuracy=0.744, val_loss=1.98, val_accuracy=0.508, lr=0.0316] 29%|██▉       | 22/75 [09:50<22:04, 25.00s/epoch, loss=1.15, accuracy=0.745, val_loss=2.35, val_accuracy=0.442, lr=0.1]    31%|███       | 23/75 [10:16<21:54, 25.27s/epoch, loss=1.15, accuracy=0.748, val_loss=1.68, val_accuracy=0.583, lr=0.1] 32%|███▏      | 24/75 [10:41<21:34, 25.37s/epoch, loss=1.15, accuracy=0.745, val_loss=1.62, val_accuracy=0.601, lr=0.1] 33%|███▎      | 25/75 [11:07<21:07, 25.35s/epoch, loss=1.15, accuracy=0.747, val_loss=2.69, val_accuracy=0.401, lr=0.1] 35%|███▍      | 26/75 [11:33<20:59, 25.70s/epoch, loss=1.15, accuracy=0.747, val_loss=1.48, val_accuracy=0.637, lr=0.0316] 36%|███▌      | 27/75 [11:59<20:40, 25.83s/epoch, loss=1.13, accuracy=0.751, val_loss=1.62, val_accuracy=0.579, lr=0.1]    37%|███▋      | 28/75 [12:25<20:08, 25.71s/epoch, loss=1.14, accuracy=0.75, val_loss=1.79, val_accuracy=0.533, lr=0.1]  39%|███▊      | 29/75 [12:52<20:03, 26.17s/epoch, loss=1.13, accuracy=0.752, val_loss=2.36, val_accuracy=0.503, lr=0.1] 40%|████      | 30/75 [13:18<19:30, 26.01s/epoch, loss=1.14, accuracy=0.75, val_loss=3.02, val_accuracy=0.374, lr=0.1]  41%|████▏     | 31/75 [13:43<18:58, 25.87s/epoch, loss=1.13, accuracy=0.75, val_loss=1.85, val_accuracy=0.553, lr=0.0316] 43%|████▎     | 32/75 [14:09<18:26, 25.73s/epoch, loss=1.13, accuracy=0.751, val_loss=2.1, val_accuracy=0.578, lr=0.1]    44%|████▍     | 33/75 [14:34<17:54, 25.57s/epoch, loss=1.13, accuracy=0.752, val_loss=1.8, val_accuracy=0.561, lr=0.1] 45%|████▌     | 34/75 [14:59<17:25, 25.51s/epoch, loss=1.13, accuracy=0.752, val_loss=4.5, val_accuracy=0.347, lr=0.1] 47%|████▋     | 35/75 [15:24<16:57, 25.44s/epoch, loss=1.13, accuracy=0.751, val_loss=2.57, val_accuracy=0.368, lr=0.1] 48%|████▊     | 36/75 [15:50<16:31, 25.43s/epoch, loss=1.13, accuracy=0.751, val_loss=1.42, val_accuracy=0.667, lr=0.1] 49%|████▉     | 37/75 [16:15<16:06, 25.44s/epoch, loss=1.12, accuracy=0.754, val_loss=1.68, val_accuracy=0.595, lr=0.1] 51%|█████     | 38/75 [16:40<15:34, 25.24s/epoch, loss=1.13, accuracy=0.754, val_loss=2.5, val_accuracy=0.43, lr=0.1]   52%|█████▏    | 39/75 [17:05<15:07, 25.22s/epoch, loss=1.13, accuracy=0.754, val_loss=1.39, val_accuracy=0.662, lr=0.1] 53%|█████▎    | 40/75 [17:31<14:47, 25.35s/epoch, loss=1.12, accuracy=0.752, val_loss=3.06, val_accuracy=0.397, lr=0.1] 55%|█████▍    | 41/75 [17:56<14:20, 25.32s/epoch, loss=1.12, accuracy=0.754, val_loss=2.26, val_accuracy=0.478, lr=0.1] 56%|█████▌    | 42/75 [18:21<13:53, 25.24s/epoch, loss=1.12, accuracy=0.753, val_loss=2.98, val_accuracy=0.428, lr=0.1] 57%|█████▋    | 43/75 [18:46<13:25, 25.18s/epoch, loss=1.12, accuracy=0.753, val_loss=2.5, val_accuracy=0.476, lr=0.1]  59%|█████▊    | 44/75 [19:11<12:59, 25.14s/epoch, loss=1.12, accuracy=0.751, val_loss=1.57, val_accuracy=0.612, lr=0.0316] 60%|██████    | 45/75 [19:36<12:32, 25.08s/epoch, loss=1.12, accuracy=0.753, val_loss=1.84, val_accuracy=0.532, lr=0.1]    61%|██████▏   | 46/75 [20:02<12:10, 25.18s/epoch, loss=1.12, accuracy=0.755, val_loss=1.87, val_accuracy=0.503, lr=0.1] 63%|██████▎   | 47/75 [20:26<11:41, 25.07s/epoch, loss=1.12, accuracy=0.756, val_loss=2.57, val_accuracy=0.46, lr=0.1]  64%|██████▍   | 48/75 [20:52<11:17, 25.09s/epoch, loss=1.12, accuracy=0.756, val_loss=2.03, val_accuracy=0.488, lr=0.1] 65%|██████▌   | 49/75 [21:16<10:50, 25.03s/epoch, loss=1.12, accuracy=0.757, val_loss=1.64, val_accuracy=0.575, lr=0.0316] 67%|██████▋   | 50/75 [21:42<10:26, 25.05s/epoch, loss=1.12, accuracy=0.752, val_loss=1.57, val_accuracy=0.636, lr=0.1]    68%|██████▊   | 51/75 [22:07<10:02, 25.10s/epoch, loss=1.12, accuracy=0.756, val_loss=3.39, val_accuracy=0.335, lr=0.1] 69%|██████▉   | 52/75 [22:32<09:35, 25.02s/epoch, loss=1.11, accuracy=0.758, val_loss=1.9, val_accuracy=0.533, lr=0.1]  71%|███████   | 53/75 [22:56<09:08, 24.95s/epoch, loss=1.11, accuracy=0.754, val_loss=1.76, val_accuracy=0.533, lr=0.1] 72%|███████▏  | 54/75 [23:21<08:43, 24.94s/epoch, loss=1.12, accuracy=0.754, val_loss=3.09, val_accuracy=0.413, lr=0.0316] 73%|███████▎  | 55/75 [23:46<08:19, 24.95s/epoch, loss=1.11, accuracy=0.757, val_loss=2, val_accuracy=0.434, lr=0.1]       75%|███████▍  | 56/75 [24:11<07:55, 25.02s/epoch, loss=1.12, accuracy=0.756, val_loss=2.87, val_accuracy=0.418, lr=0.1] 76%|███████▌  | 57/75 [24:36<07:29, 24.95s/epoch, loss=1.11, accuracy=0.759, val_loss=1.69, val_accuracy=0.542, lr=0.1] 77%|███████▋  | 58/75 [25:02<07:08, 25.18s/epoch, loss=1.12, accuracy=0.757, val_loss=2.61, val_accuracy=0.333, lr=0.1] 79%|███████▊  | 59/75 [25:27<06:40, 25.00s/epoch, loss=1.12, accuracy=0.756, val_loss=2.93, val_accuracy=0.314, lr=0.0316] 80%|████████  | 60/75 [25:51<06:13, 24.87s/epoch, loss=1.12, accuracy=0.758, val_loss=2.88, val_accuracy=0.409, lr=0.1]    81%|████████▏ | 61/75 [26:16<05:47, 24.84s/epoch, loss=1.12, accuracy=0.756, val_loss=1.69, val_accuracy=0.576, lr=0.1] 83%|████████▎ | 62/75 [26:41<05:22, 24.84s/epoch, loss=1.11, accuracy=0.756, val_loss=2.16, val_accuracy=0.491, lr=0.1] 84%|████████▍ | 63/75 [27:05<04:57, 24.81s/epoch, loss=1.11, accuracy=0.755, val_loss=1.55, val_accuracy=0.601, lr=0.1] 85%|████████▌ | 64/75 [27:31<04:34, 24.92s/epoch, loss=1.11, accuracy=0.758, val_loss=1.86, val_accuracy=0.49, lr=0.0316] 87%|████████▋ | 65/75 [27:56<04:09, 24.92s/epoch, loss=1.12, accuracy=0.756, val_loss=2.12, val_accuracy=0.501, lr=0.1]   88%|████████▊ | 66/75 [28:20<03:43, 24.78s/epoch, loss=1.12, accuracy=0.755, val_loss=1.73, val_accuracy=0.549, lr=0.1] 89%|████████▉ | 67/75 [28:45<03:18, 24.78s/epoch, loss=1.11, accuracy=0.757, val_loss=2.88, val_accuracy=0.362, lr=0.1] 91%|█████████ | 68/75 [29:10<02:53, 24.83s/epoch, loss=1.11, accuracy=0.756, val_loss=2.7, val_accuracy=0.42, lr=0.1]   92%|█████████▏| 69/75 [29:35<02:29, 24.93s/epoch, loss=1.11, accuracy=0.759, val_loss=1.55, val_accuracy=0.631, lr=0.0316] 93%|█████████▎| 70/75 [30:00<02:04, 24.94s/epoch, loss=1.11, accuracy=0.755, val_loss=2.89, val_accuracy=0.392, lr=0.1]    95%|█████████▍| 71/75 [30:25<01:39, 24.96s/epoch, loss=1.11, accuracy=0.757, val_loss=3.1, val_accuracy=0.292, lr=0.1]  96%|█████████▌| 72/75 [30:50<01:14, 24.94s/epoch, loss=1.11, accuracy=0.757, val_loss=1.74, val_accuracy=0.547, lr=0.1] 97%|█████████▋| 73/75 [31:15<00:49, 24.92s/epoch, loss=1.11, accuracy=0.757, val_loss=1.84, val_accuracy=0.524, lr=0.1] 99%|█████████▊| 74/75 [31:39<00:24, 24.81s/epoch, loss=1.11, accuracy=0.755, val_loss=4.69, val_accuracy=0.306, lr=0.0316]100%|██████████| 75/75 [32:04<00:00, 24.96s/epoch, loss=1.11, accuracy=0.757, val_loss=2.14, val_accuracy=0.516, lr=0.1]   100%|██████████| 75/75 [32:04<00:00, 25.67s/epoch, loss=1.11, accuracy=0.757, val_loss=2.14, val_accuracy=0.516, lr=0.1]
Using real-time data augmentation.
Test score: 1.4423787593841553
Test accuracy: 0.6658999919891357


* * * Run SGD for ID = 20_8. * * *


2024-02-20 03:41:31.340370: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 03:41:35.884369: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 03:41:35.885685: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-20 03:41:35.926906: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:86:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-20 03:41:35.926976: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 03:41:35.932297: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 03:41:35.932361: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-20 03:41:35.935520: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-20 03:41:35.938064: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-20 03:41:35.941250: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-20 03:41:35.943379: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-20 03:41:35.950039: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 03:41:35.950728: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-20 03:41:35.950820: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 03:41:37.364112: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-20 03:41:37.365230: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 03:41:37.365776: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:86:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-20 03:41:37.365811: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 03:41:37.365860: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 03:41:37.365876: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-20 03:41:37.365890: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-20 03:41:37.365904: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-20 03:41:37.365918: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-20 03:41:37.365932: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-20 03:41:37.365946: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 03:41:37.366515: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-20 03:41:37.366562: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 03:41:38.001789: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-20 03:41:38.001861: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-20 03:41:38.001887: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-20 03:41:38.003195: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:86:00.0, compute capability: 6.1)
{'id': '20_08', 'batch_size': 128, 'epochs': 75, 'validation_split': 0.1, 'checkpointing': True, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
x_train shape: (45000, 32, 32, 3)
45000 train samples
5000 validation samples
10000 test samples
y_train shape: (45000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/75 [00:00<?, ?epoch/s]2024-02-20 03:41:38.854310: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-20 03:41:38.854816: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-02-20 03:41:40.846962: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 03:41:41.150395: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 03:41:42.030639: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-20 03:41:42.074069: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|▏         | 1/75 [01:01<1:15:24, 61.14s/epoch, loss=3.51, accuracy=0.246, val_loss=2.87, val_accuracy=0.113, lr=0.1]  3%|▎         | 2/75 [01:27<49:14, 40.47s/epoch, loss=1.76, accuracy=0.432, val_loss=2.46, val_accuracy=0.247, lr=0.1]    4%|▍         | 3/75 [01:52<40:07, 33.44s/epoch, loss=1.5, accuracy=0.549, val_loss=2.16, val_accuracy=0.379, lr=0.1]   5%|▌         | 4/75 [02:17<35:35, 30.08s/epoch, loss=1.34, accuracy=0.644, val_loss=1.71, val_accuracy=0.533, lr=0.1]  7%|▋         | 5/75 [02:43<33:28, 28.69s/epoch, loss=1.27, accuracy=0.685, val_loss=2.5, val_accuracy=0.411, lr=0.1]   8%|▊         | 6/75 [03:11<32:42, 28.45s/epoch, loss=1.24, accuracy=0.702, val_loss=2.31, val_accuracy=0.396, lr=0.1]  9%|▉         | 7/75 [03:38<31:51, 28.12s/epoch, loss=1.23, accuracy=0.713, val_loss=1.79, val_accuracy=0.555, lr=0.1] 11%|█         | 8/75 [04:06<31:08, 27.89s/epoch, loss=1.22, accuracy=0.72, val_loss=1.47, val_accuracy=0.639, lr=0.1]  12%|█▏        | 9/75 [04:33<30:20, 27.58s/epoch, loss=1.22, accuracy=0.723, val_loss=1.85, val_accuracy=0.5, lr=0.1]  13%|█▎        | 10/75 [05:00<29:48, 27.52s/epoch, loss=1.21, accuracy=0.727, val_loss=1.59, val_accuracy=0.596, lr=0.1] 15%|█▍        | 11/75 [05:28<29:27, 27.62s/epoch, loss=1.2, accuracy=0.733, val_loss=1.7, val_accuracy=0.596, lr=0.1]   16%|█▌        | 12/75 [05:56<29:03, 27.67s/epoch, loss=1.2, accuracy=0.732, val_loss=1.88, val_accuracy=0.496, lr=0.1] 17%|█▋        | 13/75 [06:24<28:40, 27.74s/epoch, loss=1.19, accuracy=0.738, val_loss=2.25, val_accuracy=0.431, lr=0.0316] 19%|█▊        | 14/75 [06:51<28:15, 27.80s/epoch, loss=1.19, accuracy=0.737, val_loss=1.57, val_accuracy=0.605, lr=0.1]    20%|██        | 15/75 [07:19<27:48, 27.80s/epoch, loss=1.18, accuracy=0.74, val_loss=3.46, val_accuracy=0.265, lr=0.1]  21%|██▏       | 16/75 [07:47<27:17, 27.76s/epoch, loss=1.18, accuracy=0.741, val_loss=1.6, val_accuracy=0.607, lr=0.1] 23%|██▎       | 17/75 [08:15<26:50, 27.77s/epoch, loss=1.18, accuracy=0.739, val_loss=2.08, val_accuracy=0.482, lr=0.1] 24%|██▍       | 18/75 [08:42<26:22, 27.77s/epoch, loss=1.19, accuracy=0.74, val_loss=2.64, val_accuracy=0.409, lr=0.0316] 25%|██▌       | 19/75 [09:10<25:51, 27.70s/epoch, loss=1.18, accuracy=0.739, val_loss=1.49, val_accuracy=0.633, lr=0.1]   27%|██▋       | 20/75 [09:38<25:24, 27.71s/epoch, loss=1.17, accuracy=0.745, val_loss=1.82, val_accuracy=0.505, lr=0.1] 28%|██▊       | 21/75 [10:06<24:59, 27.78s/epoch, loss=1.17, accuracy=0.744, val_loss=2.83, val_accuracy=0.433, lr=0.1] 29%|██▉       | 22/75 [10:33<24:31, 27.77s/epoch, loss=1.18, accuracy=0.744, val_loss=1.66, val_accuracy=0.59, lr=0.1]  31%|███       | 23/75 [11:01<24:02, 27.73s/epoch, loss=1.17, accuracy=0.746, val_loss=1.98, val_accuracy=0.517, lr=0.0316] 32%|███▏      | 24/75 [11:29<23:39, 27.83s/epoch, loss=1.17, accuracy=0.746, val_loss=1.37, val_accuracy=0.675, lr=0.1]    33%|███▎      | 25/75 [11:57<23:06, 27.73s/epoch, loss=1.17, accuracy=0.747, val_loss=2.02, val_accuracy=0.495, lr=0.1] 35%|███▍      | 26/75 [12:24<22:36, 27.68s/epoch, loss=1.16, accuracy=0.749, val_loss=3.89, val_accuracy=0.182, lr=0.1] 36%|███▌      | 27/75 [12:52<22:10, 27.71s/epoch, loss=1.16, accuracy=0.747, val_loss=2.6, val_accuracy=0.421, lr=0.1]  37%|███▋      | 28/75 [13:20<21:45, 27.78s/epoch, loss=1.16, accuracy=0.748, val_loss=1.79, val_accuracy=0.534, lr=0.1] 39%|███▊      | 29/75 [13:48<21:19, 27.82s/epoch, loss=1.15, accuracy=0.752, val_loss=2.28, val_accuracy=0.469, lr=0.0316] 40%|████      | 30/75 [14:16<20:53, 27.85s/epoch, loss=1.15, accuracy=0.748, val_loss=1.46, val_accuracy=0.663, lr=0.1]    41%|████▏     | 31/75 [14:43<20:23, 27.81s/epoch, loss=1.15, accuracy=0.751, val_loss=2.42, val_accuracy=0.359, lr=0.1] 43%|████▎     | 32/75 [15:11<19:55, 27.81s/epoch, loss=1.16, accuracy=0.75, val_loss=1.64, val_accuracy=0.577, lr=0.1]  44%|████▍     | 33/75 [15:39<19:27, 27.80s/epoch, loss=1.15, accuracy=0.751, val_loss=3.49, val_accuracy=0.24, lr=0.1] 45%|████▌     | 34/75 [16:07<19:00, 27.83s/epoch, loss=1.14, accuracy=0.751, val_loss=1.96, val_accuracy=0.495, lr=0.0316] 47%|████▋     | 35/75 [16:35<18:34, 27.87s/epoch, loss=1.15, accuracy=0.753, val_loss=3.72, val_accuracy=0.242, lr=0.1]    48%|████▊     | 36/75 [17:03<18:04, 27.81s/epoch, loss=1.15, accuracy=0.75, val_loss=1.69, val_accuracy=0.578, lr=0.1]  49%|████▉     | 37/75 [17:31<17:38, 27.86s/epoch, loss=1.15, accuracy=0.753, val_loss=2.1, val_accuracy=0.504, lr=0.1] 51%|█████     | 38/75 [17:58<17:10, 27.84s/epoch, loss=1.15, accuracy=0.751, val_loss=2.5, val_accuracy=0.352, lr=0.1] 52%|█████▏    | 39/75 [18:26<16:40, 27.80s/epoch, loss=1.14, accuracy=0.755, val_loss=1.43, val_accuracy=0.659, lr=0.0316] 53%|█████▎    | 40/75 [18:54<16:11, 27.76s/epoch, loss=1.15, accuracy=0.753, val_loss=2.34, val_accuracy=0.425, lr=0.1]    55%|█████▍    | 41/75 [19:22<15:44, 27.79s/epoch, loss=1.15, accuracy=0.751, val_loss=1.93, val_accuracy=0.54, lr=0.1]  56%|█████▌    | 42/75 [19:49<15:16, 27.78s/epoch, loss=1.14, accuracy=0.755, val_loss=1.52, val_accuracy=0.618, lr=0.1] 57%|█████▋    | 43/75 [20:17<14:48, 27.77s/epoch, loss=1.14, accuracy=0.755, val_loss=1.66, val_accuracy=0.591, lr=0.1] 59%|█████▊    | 44/75 [20:45<14:22, 27.81s/epoch, loss=1.14, accuracy=0.756, val_loss=1.55, val_accuracy=0.602, lr=0.0316] 60%|██████    | 45/75 [21:13<13:53, 27.79s/epoch, loss=1.14, accuracy=0.752, val_loss=3.67, val_accuracy=0.368, lr=0.1]    61%|██████▏   | 46/75 [21:40<13:25, 27.79s/epoch, loss=1.14, accuracy=0.756, val_loss=1.76, val_accuracy=0.589, lr=0.1] 63%|██████▎   | 47/75 [22:08<12:56, 27.73s/epoch, loss=1.14, accuracy=0.752, val_loss=2.64, val_accuracy=0.328, lr=0.1] 64%|██████▍   | 48/75 [22:36<12:30, 27.79s/epoch, loss=1.14, accuracy=0.753, val_loss=4.68, val_accuracy=0.352, lr=0.1] 65%|██████▌   | 49/75 [23:04<12:02, 27.77s/epoch, loss=1.14, accuracy=0.754, val_loss=2.72, val_accuracy=0.346, lr=0.0316] 67%|██████▋   | 50/75 [23:32<11:34, 27.80s/epoch, loss=1.13, accuracy=0.754, val_loss=2.23, val_accuracy=0.454, lr=0.1]    68%|██████▊   | 51/75 [23:59<11:06, 27.78s/epoch, loss=1.13, accuracy=0.755, val_loss=1.42, val_accuracy=0.664, lr=0.1] 69%|██████▉   | 52/75 [24:27<10:39, 27.80s/epoch, loss=1.13, accuracy=0.755, val_loss=1.91, val_accuracy=0.546, lr=0.1] 71%|███████   | 53/75 [24:55<10:11, 27.81s/epoch, loss=1.13, accuracy=0.755, val_loss=2.22, val_accuracy=0.441, lr=0.1] 72%|███████▏  | 54/75 [25:21<09:35, 27.41s/epoch, loss=1.13, accuracy=0.756, val_loss=1.45, val_accuracy=0.653, lr=0.0316] 73%|███████▎  | 55/75 [25:47<08:56, 26.83s/epoch, loss=1.13, accuracy=0.759, val_loss=3.52, val_accuracy=0.39, lr=0.1]     75%|███████▍  | 56/75 [26:12<08:20, 26.33s/epoch, loss=1.14, accuracy=0.754, val_loss=3.14, val_accuracy=0.419, lr=0.1] 76%|███████▌  | 57/75 [26:37<07:46, 25.93s/epoch, loss=1.13, accuracy=0.757, val_loss=1.6, val_accuracy=0.622, lr=0.1]  77%|███████▋  | 58/75 [27:02<07:15, 25.60s/epoch, loss=1.14, accuracy=0.756, val_loss=2.58, val_accuracy=0.438, lr=0.1] 79%|███████▊  | 59/75 [27:27<06:46, 25.40s/epoch, loss=1.13, accuracy=0.757, val_loss=2.71, val_accuracy=0.41, lr=0.0316] 80%|████████  | 60/75 [27:52<06:20, 25.34s/epoch, loss=1.13, accuracy=0.757, val_loss=1.7, val_accuracy=0.595, lr=0.1]    81%|████████▏ | 61/75 [28:17<05:52, 25.19s/epoch, loss=1.13, accuracy=0.758, val_loss=1.7, val_accuracy=0.561, lr=0.1] 83%|████████▎ | 62/75 [28:42<05:26, 25.14s/epoch, loss=1.13, accuracy=0.757, val_loss=3.78, val_accuracy=0.204, lr=0.1] 84%|████████▍ | 63/75 [29:07<05:01, 25.10s/epoch, loss=1.12, accuracy=0.759, val_loss=1.96, val_accuracy=0.494, lr=0.1] 85%|████████▌ | 64/75 [29:32<04:35, 25.03s/epoch, loss=1.13, accuracy=0.757, val_loss=1.52, val_accuracy=0.631, lr=0.0316] 87%|████████▋ | 65/75 [29:57<04:09, 24.94s/epoch, loss=1.12, accuracy=0.758, val_loss=3.57, val_accuracy=0.475, lr=0.1]    88%|████████▊ | 66/75 [30:22<03:45, 25.09s/epoch, loss=1.13, accuracy=0.757, val_loss=1.73, val_accuracy=0.579, lr=0.1] 89%|████████▉ | 67/75 [30:47<03:19, 24.97s/epoch, loss=1.13, accuracy=0.756, val_loss=1.51, val_accuracy=0.635, lr=0.1] 91%|█████████ | 68/75 [31:11<02:54, 24.89s/epoch, loss=1.13, accuracy=0.757, val_loss=1.45, val_accuracy=0.672, lr=0.1] 92%|█████████▏| 69/75 [31:36<02:29, 24.94s/epoch, loss=1.12, accuracy=0.757, val_loss=2.18, val_accuracy=0.512, lr=0.0316] 93%|█████████▎| 70/75 [32:01<02:04, 24.88s/epoch, loss=1.13, accuracy=0.756, val_loss=2.8, val_accuracy=0.433, lr=0.1]     95%|█████████▍| 71/75 [32:26<01:39, 24.98s/epoch, loss=1.12, accuracy=0.757, val_loss=1.55, val_accuracy=0.586, lr=0.1] 96%|█████████▌| 72/75 [32:51<01:14, 24.86s/epoch, loss=1.12, accuracy=0.757, val_loss=2.57, val_accuracy=0.443, lr=0.1] 97%|█████████▋| 73/75 [33:16<00:49, 24.98s/epoch, loss=1.13, accuracy=0.755, val_loss=1.73, val_accuracy=0.556, lr=0.1] 99%|█████████▊| 74/75 [33:41<00:24, 24.96s/epoch, loss=1.12, accuracy=0.756, val_loss=2.65, val_accuracy=0.41, lr=0.0316]100%|██████████| 75/75 [34:06<00:00, 24.98s/epoch, loss=1.13, accuracy=0.757, val_loss=1.95, val_accuracy=0.501, lr=0.1]  100%|██████████| 75/75 [34:06<00:00, 27.29s/epoch, loss=1.13, accuracy=0.757, val_loss=1.95, val_accuracy=0.501, lr=0.1]
Using real-time data augmentation.
Test score: 1.3582570552825928
Test accuracy: 0.675599992275238


* * * Run SGD for ID = 20_9. * * *


2024-02-20 04:15:54.448262: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 04:15:58.586845: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 04:15:58.588261: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-20 04:15:58.630373: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:86:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-20 04:15:58.630418: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 04:15:58.633959: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 04:15:58.634032: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-20 04:15:58.636978: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-20 04:15:58.638451: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-20 04:15:58.641933: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-20 04:15:58.643817: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-20 04:15:58.649344: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 04:15:58.650059: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-20 04:15:58.650149: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 04:16:00.237354: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-20 04:16:00.238489: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 04:16:00.239657: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:86:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-20 04:16:00.239693: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 04:16:00.239737: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 04:16:00.239749: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-20 04:16:00.239761: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-20 04:16:00.239774: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-20 04:16:00.239788: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-20 04:16:00.239802: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-20 04:16:00.239815: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 04:16:00.240345: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-20 04:16:00.240385: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 04:16:00.894582: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-20 04:16:00.894646: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-20 04:16:00.894658: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-20 04:16:00.895840: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:86:00.0, compute capability: 6.1)
{'id': '20_09', 'batch_size': 128, 'epochs': 75, 'validation_split': 0.1, 'checkpointing': True, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
x_train shape: (45000, 32, 32, 3)
45000 train samples
5000 validation samples
10000 test samples
y_train shape: (45000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/75 [00:00<?, ?epoch/s]2024-02-20 04:16:01.790856: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-20 04:16:01.803018: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-02-20 04:16:03.848754: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 04:16:04.207063: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 04:16:05.157145: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-20 04:16:05.207605: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|▏         | 1/75 [01:00<1:14:38, 60.53s/epoch, loss=3.36, accuracy=0.273, val_loss=2.92, val_accuracy=0.178, lr=0.1]  3%|▎         | 2/75 [01:25<48:15, 39.67s/epoch, loss=1.69, accuracy=0.471, val_loss=2.34, val_accuracy=0.323, lr=0.1]    4%|▍         | 3/75 [01:50<39:36, 33.00s/epoch, loss=1.47, accuracy=0.578, val_loss=2.09, val_accuracy=0.427, lr=0.1]  5%|▌         | 4/75 [02:15<35:21, 29.88s/epoch, loss=1.35, accuracy=0.644, val_loss=1.68, val_accuracy=0.552, lr=0.1]  7%|▋         | 5/75 [02:40<32:44, 28.06s/epoch, loss=1.31, accuracy=0.672, val_loss=1.73, val_accuracy=0.546, lr=0.1]  8%|▊         | 6/75 [03:05<31:04, 27.03s/epoch, loss=1.28, accuracy=0.691, val_loss=2.5, val_accuracy=0.376, lr=0.1]   9%|▉         | 7/75 [03:30<29:46, 26.27s/epoch, loss=1.26, accuracy=0.701, val_loss=2.13, val_accuracy=0.492, lr=0.1] 11%|█         | 8/75 [03:55<28:47, 25.79s/epoch, loss=1.25, accuracy=0.708, val_loss=1.74, val_accuracy=0.53, lr=0.1]  12%|█▏        | 9/75 [04:20<28:06, 25.56s/epoch, loss=1.23, accuracy=0.717, val_loss=3.24, val_accuracy=0.309, lr=0.0316] 13%|█▎        | 10/75 [04:44<27:27, 25.34s/epoch, loss=1.23, accuracy=0.721, val_loss=2.54, val_accuracy=0.442, lr=0.1]   15%|█▍        | 11/75 [05:09<26:49, 25.15s/epoch, loss=1.23, accuracy=0.725, val_loss=1.91, val_accuracy=0.488, lr=0.1] 16%|█▌        | 12/75 [05:34<26:24, 25.16s/epoch, loss=1.21, accuracy=0.73, val_loss=1.74, val_accuracy=0.561, lr=0.1]  17%|█▋        | 13/75 [05:59<25:50, 25.01s/epoch, loss=1.2, accuracy=0.733, val_loss=2.04, val_accuracy=0.472, lr=0.1] 19%|█▊        | 14/75 [06:24<25:28, 25.06s/epoch, loss=1.2, accuracy=0.733, val_loss=1.71, val_accuracy=0.563, lr=0.0316] 20%|██        | 15/75 [06:49<24:59, 24.99s/epoch, loss=1.2, accuracy=0.737, val_loss=3.8, val_accuracy=0.288, lr=0.1]     21%|██▏       | 16/75 [07:14<24:39, 25.08s/epoch, loss=1.19, accuracy=0.737, val_loss=1.93, val_accuracy=0.505, lr=0.1] 23%|██▎       | 17/75 [07:39<24:07, 24.95s/epoch, loss=1.19, accuracy=0.737, val_loss=2.37, val_accuracy=0.494, lr=0.1] 24%|██▍       | 18/75 [08:04<23:45, 25.01s/epoch, loss=1.19, accuracy=0.741, val_loss=1.63, val_accuracy=0.61, lr=0.1]  25%|██▌       | 19/75 [08:29<23:16, 24.93s/epoch, loss=1.19, accuracy=0.741, val_loss=4.03, val_accuracy=0.338, lr=0.1] 27%|██▋       | 20/75 [08:54<22:50, 24.93s/epoch, loss=1.18, accuracy=0.744, val_loss=2.13, val_accuracy=0.456, lr=0.1] 28%|██▊       | 21/75 [09:20<22:49, 25.36s/epoch, loss=1.19, accuracy=0.744, val_loss=1.47, val_accuracy=0.636, lr=0.1] 29%|██▉       | 22/75 [09:45<22:12, 25.15s/epoch, loss=1.18, accuracy=0.747, val_loss=1.85, val_accuracy=0.523, lr=0.1] 31%|███       | 23/75 [10:12<22:24, 25.86s/epoch, loss=1.18, accuracy=0.744, val_loss=1.89, val_accuracy=0.534, lr=0.1] 32%|███▏      | 24/75 [10:39<22:04, 25.98s/epoch, loss=1.18, accuracy=0.746, val_loss=2.73, val_accuracy=0.433, lr=0.1] 33%|███▎      | 25/75 [11:05<21:40, 26.01s/epoch, loss=1.17, accuracy=0.746, val_loss=3.43, val_accuracy=0.298, lr=0.1] 35%|███▍      | 26/75 [11:30<20:57, 25.67s/epoch, loss=1.18, accuracy=0.745, val_loss=1.89, val_accuracy=0.526, lr=0.0316] 36%|███▌      | 27/75 [11:54<20:16, 25.34s/epoch, loss=1.17, accuracy=0.748, val_loss=3.75, val_accuracy=0.339, lr=0.1]    37%|███▋      | 28/75 [12:19<19:47, 25.27s/epoch, loss=1.17, accuracy=0.748, val_loss=1.64, val_accuracy=0.577, lr=0.1] 39%|███▊      | 29/75 [12:44<19:19, 25.20s/epoch, loss=1.16, accuracy=0.748, val_loss=2.31, val_accuracy=0.488, lr=0.1] 40%|████      | 30/75 [13:09<18:52, 25.17s/epoch, loss=1.16, accuracy=0.749, val_loss=1.53, val_accuracy=0.618, lr=0.1] 41%|████▏     | 31/75 [13:34<18:14, 24.88s/epoch, loss=1.16, accuracy=0.749, val_loss=2.66, val_accuracy=0.381, lr=0.0316] 43%|████▎     | 32/75 [13:58<17:48, 24.84s/epoch, loss=1.16, accuracy=0.751, val_loss=2.18, val_accuracy=0.514, lr=0.1]    44%|████▍     | 33/75 [14:23<17:16, 24.67s/epoch, loss=1.16, accuracy=0.753, val_loss=1.57, val_accuracy=0.629, lr=0.1] 45%|████▌     | 34/75 [14:48<16:55, 24.76s/epoch, loss=1.17, accuracy=0.748, val_loss=2.61, val_accuracy=0.393, lr=0.1] 47%|████▋     | 35/75 [15:12<16:31, 24.78s/epoch, loss=1.16, accuracy=0.75, val_loss=2.66, val_accuracy=0.396, lr=0.1]  48%|████▊     | 36/75 [15:37<16:03, 24.70s/epoch, loss=1.16, accuracy=0.751, val_loss=2.5, val_accuracy=0.439, lr=0.0316] 49%|████▉     | 37/75 [16:01<15:33, 24.56s/epoch, loss=1.16, accuracy=0.752, val_loss=2.17, val_accuracy=0.507, lr=0.1]   51%|█████     | 38/75 [16:26<15:13, 24.68s/epoch, loss=1.16, accuracy=0.753, val_loss=1.69, val_accuracy=0.607, lr=0.1] 52%|█████▏    | 39/75 [16:51<14:50, 24.75s/epoch, loss=1.16, accuracy=0.752, val_loss=2, val_accuracy=0.491, lr=0.1]    53%|█████▎    | 40/75 [17:16<14:26, 24.74s/epoch, loss=1.16, accuracy=0.75, val_loss=1.69, val_accuracy=0.571, lr=0.1] 55%|█████▍    | 41/75 [17:41<14:03, 24.81s/epoch, loss=1.15, accuracy=0.752, val_loss=3.51, val_accuracy=0.37, lr=0.0316] 56%|█████▌    | 42/75 [18:05<13:38, 24.80s/epoch, loss=1.14, accuracy=0.755, val_loss=2.25, val_accuracy=0.481, lr=0.1]   57%|█████▋    | 43/75 [18:30<13:13, 24.78s/epoch, loss=1.16, accuracy=0.752, val_loss=2.1, val_accuracy=0.523, lr=0.1]  59%|█████▊    | 44/75 [18:55<12:49, 24.82s/epoch, loss=1.15, accuracy=0.755, val_loss=2, val_accuracy=0.508, lr=0.1]   60%|██████    | 45/75 [19:20<12:20, 24.69s/epoch, loss=1.15, accuracy=0.754, val_loss=2.44, val_accuracy=0.341, lr=0.1] 61%|██████▏   | 46/75 [19:45<11:59, 24.82s/epoch, loss=1.15, accuracy=0.753, val_loss=2.23, val_accuracy=0.43, lr=0.0316] 63%|██████▎   | 47/75 [20:09<11:33, 24.78s/epoch, loss=1.15, accuracy=0.752, val_loss=1.86, val_accuracy=0.546, lr=0.1]   64%|██████▍   | 48/75 [20:34<11:08, 24.77s/epoch, loss=1.14, accuracy=0.754, val_loss=1.7, val_accuracy=0.559, lr=0.1]  65%|██████▌   | 49/75 [20:59<10:44, 24.78s/epoch, loss=1.15, accuracy=0.754, val_loss=2.02, val_accuracy=0.548, lr=0.1] 67%|██████▋   | 50/75 [21:24<10:20, 24.81s/epoch, loss=1.15, accuracy=0.755, val_loss=1.82, val_accuracy=0.61, lr=0.1]  68%|██████▊   | 51/75 [21:48<09:53, 24.71s/epoch, loss=1.15, accuracy=0.755, val_loss=2.33, val_accuracy=0.433, lr=0.0316] 69%|██████▉   | 52/75 [22:13<09:29, 24.75s/epoch, loss=1.15, accuracy=0.753, val_loss=1.88, val_accuracy=0.508, lr=0.1]    71%|███████   | 53/75 [22:39<09:11, 25.07s/epoch, loss=1.15, accuracy=0.753, val_loss=2.28, val_accuracy=0.452, lr=0.1] 72%|███████▏  | 54/75 [23:04<08:44, 24.96s/epoch, loss=1.15, accuracy=0.754, val_loss=3.23, val_accuracy=0.366, lr=0.1] 73%|███████▎  | 55/75 [23:28<08:17, 24.90s/epoch, loss=1.15, accuracy=0.753, val_loss=3.02, val_accuracy=0.432, lr=0.1] 75%|███████▍  | 56/75 [23:53<07:52, 24.89s/epoch, loss=1.15, accuracy=0.751, val_loss=2.7, val_accuracy=0.317, lr=0.0316] 76%|███████▌  | 57/75 [24:18<07:27, 24.87s/epoch, loss=1.14, accuracy=0.755, val_loss=2.39, val_accuracy=0.472, lr=0.1]   77%|███████▋  | 58/75 [24:43<07:00, 24.75s/epoch, loss=1.14, accuracy=0.757, val_loss=2.41, val_accuracy=0.467, lr=0.1] 79%|███████▊  | 59/75 [25:07<06:36, 24.79s/epoch, loss=1.15, accuracy=0.752, val_loss=1.95, val_accuracy=0.526, lr=0.1] 80%|████████  | 60/75 [25:33<06:14, 24.99s/epoch, loss=1.15, accuracy=0.754, val_loss=2.88, val_accuracy=0.324, lr=0.1] 81%|████████▏ | 61/75 [25:57<05:47, 24.85s/epoch, loss=1.13, accuracy=0.757, val_loss=1.58, val_accuracy=0.596, lr=0.0316] 83%|████████▎ | 62/75 [26:22<05:22, 24.83s/epoch, loss=1.14, accuracy=0.755, val_loss=2.54, val_accuracy=0.367, lr=0.1]    84%|████████▍ | 63/75 [26:47<04:56, 24.70s/epoch, loss=1.15, accuracy=0.755, val_loss=4.02, val_accuracy=0.262, lr=0.1] 85%|████████▌ | 64/75 [27:12<04:33, 24.86s/epoch, loss=1.13, accuracy=0.756, val_loss=2.64, val_accuracy=0.451, lr=0.1] 87%|████████▋ | 65/75 [27:37<04:08, 24.82s/epoch, loss=1.14, accuracy=0.758, val_loss=3.07, val_accuracy=0.458, lr=0.1] 88%|████████▊ | 66/75 [28:01<03:43, 24.79s/epoch, loss=1.14, accuracy=0.755, val_loss=2.8, val_accuracy=0.368, lr=0.0316] 89%|████████▉ | 67/75 [28:26<03:18, 24.76s/epoch, loss=1.14, accuracy=0.754, val_loss=5.57, val_accuracy=0.212, lr=0.1]   91%|█████████ | 68/75 [28:51<02:53, 24.73s/epoch, loss=1.14, accuracy=0.757, val_loss=1.95, val_accuracy=0.501, lr=0.1] 92%|█████████▏| 69/75 [29:15<02:27, 24.66s/epoch, loss=1.14, accuracy=0.754, val_loss=2.02, val_accuracy=0.524, lr=0.1] 93%|█████████▎| 70/75 [29:40<02:03, 24.62s/epoch, loss=1.14, accuracy=0.754, val_loss=1.62, val_accuracy=0.603, lr=0.1] 95%|█████████▍| 71/75 [30:05<01:39, 24.90s/epoch, loss=1.15, accuracy=0.753, val_loss=2.94, val_accuracy=0.443, lr=0.0316] 96%|█████████▌| 72/75 [30:30<01:14, 24.89s/epoch, loss=1.14, accuracy=0.756, val_loss=1.64, val_accuracy=0.605, lr=0.1]    97%|█████████▋| 73/75 [30:55<00:49, 24.88s/epoch, loss=1.14, accuracy=0.754, val_loss=1.66, val_accuracy=0.562, lr=0.1] 99%|█████████▊| 74/75 [31:20<00:24, 24.87s/epoch, loss=1.14, accuracy=0.757, val_loss=1.78, val_accuracy=0.553, lr=0.1]100%|██████████| 75/75 [31:45<00:00, 24.85s/epoch, loss=1.14, accuracy=0.754, val_loss=1.59, val_accuracy=0.588, lr=0.1]100%|██████████| 75/75 [31:45<00:00, 25.40s/epoch, loss=1.14, accuracy=0.754, val_loss=1.59, val_accuracy=0.588, lr=0.1]
Using real-time data augmentation.
Test score: 1.5029652118682861
Test accuracy: 0.6226000189781189


* * * Run SGD for ID = 20_10. * * *


2024-02-20 04:47:53.877204: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 04:48:00.549623: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 04:48:00.550947: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-20 04:48:00.591576: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:86:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-20 04:48:00.591634: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 04:48:00.597447: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 04:48:00.597513: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-20 04:48:00.601947: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-20 04:48:00.604962: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-20 04:48:00.609247: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-20 04:48:00.612170: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-20 04:48:00.618865: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 04:48:00.619559: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-20 04:48:00.619650: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 04:48:02.042189: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-20 04:48:02.042846: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 04:48:02.043374: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:86:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-20 04:48:02.043410: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 04:48:02.043445: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 04:48:02.043457: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-20 04:48:02.043469: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-20 04:48:02.043481: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-20 04:48:02.043493: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-20 04:48:02.043505: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-20 04:48:02.043518: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 04:48:02.044071: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-20 04:48:02.044111: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 04:48:02.698485: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-20 04:48:02.698554: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-20 04:48:02.698566: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-20 04:48:02.700298: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:86:00.0, compute capability: 6.1)
{'id': '20_10', 'batch_size': 128, 'epochs': 75, 'validation_split': 0.1, 'checkpointing': True, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
x_train shape: (45000, 32, 32, 3)
45000 train samples
5000 validation samples
10000 test samples
y_train shape: (45000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/75 [00:00<?, ?epoch/s]2024-02-20 04:48:03.562919: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-20 04:48:03.575012: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-02-20 04:48:05.594713: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 04:48:05.911056: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 04:48:06.875713: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-20 04:48:06.917179: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|▏         | 1/75 [00:58<1:11:53, 58.29s/epoch, loss=3.82, accuracy=0.266, val_loss=4.03, val_accuracy=0.101, lr=0.1]  3%|▎         | 2/75 [01:23<47:19, 38.90s/epoch, loss=1.69, accuracy=0.481, val_loss=2.15, val_accuracy=0.405, lr=0.1]    4%|▍         | 3/75 [01:49<39:19, 32.77s/epoch, loss=1.4, accuracy=0.606, val_loss=1.9, val_accuracy=0.484, lr=0.1]    5%|▌         | 4/75 [02:14<35:09, 29.71s/epoch, loss=1.31, accuracy=0.661, val_loss=2.15, val_accuracy=0.386, lr=0.1]  7%|▋         | 5/75 [02:39<32:46, 28.09s/epoch, loss=1.27, accuracy=0.685, val_loss=2.32, val_accuracy=0.389, lr=0.1]  8%|▊         | 6/75 [03:04<31:09, 27.09s/epoch, loss=1.24, accuracy=0.701, val_loss=1.79, val_accuracy=0.543, lr=0.1]  9%|▉         | 7/75 [03:29<30:01, 26.50s/epoch, loss=1.23, accuracy=0.71, val_loss=1.59, val_accuracy=0.588, lr=0.1]  11%|█         | 8/75 [03:54<29:07, 26.08s/epoch, loss=1.22, accuracy=0.717, val_loss=4.04, val_accuracy=0.341, lr=0.1] 12%|█▏        | 9/75 [04:20<28:22, 25.80s/epoch, loss=1.21, accuracy=0.723, val_loss=2.09, val_accuracy=0.473, lr=0.1] 13%|█▎        | 10/75 [04:45<27:38, 25.51s/epoch, loss=1.2, accuracy=0.726, val_loss=1.72, val_accuracy=0.569, lr=0.1] 15%|█▍        | 11/75 [05:09<26:59, 25.31s/epoch, loss=1.2, accuracy=0.73, val_loss=2.19, val_accuracy=0.485, lr=0.1]  16%|█▌        | 12/75 [05:34<26:30, 25.25s/epoch, loss=1.19, accuracy=0.731, val_loss=1.98, val_accuracy=0.554, lr=0.0316] 17%|█▋        | 13/75 [05:59<25:59, 25.15s/epoch, loss=1.18, accuracy=0.735, val_loss=1.84, val_accuracy=0.521, lr=0.1]    19%|█▊        | 14/75 [06:25<25:44, 25.32s/epoch, loss=1.18, accuracy=0.735, val_loss=1.66, val_accuracy=0.551, lr=0.1] 20%|██        | 15/75 [06:50<25:17, 25.29s/epoch, loss=1.18, accuracy=0.736, val_loss=2.1, val_accuracy=0.498, lr=0.1]  21%|██▏       | 16/75 [07:15<24:40, 25.10s/epoch, loss=1.17, accuracy=0.738, val_loss=1.87, val_accuracy=0.52, lr=0.1] 23%|██▎       | 17/75 [07:40<24:20, 25.18s/epoch, loss=1.17, accuracy=0.743, val_loss=1.42, val_accuracy=0.655, lr=0.1] 24%|██▍       | 18/75 [08:05<23:40, 24.91s/epoch, loss=1.17, accuracy=0.74, val_loss=1.57, val_accuracy=0.616, lr=0.1]  25%|██▌       | 19/75 [08:30<23:18, 24.98s/epoch, loss=1.16, accuracy=0.741, val_loss=1.86, val_accuracy=0.577, lr=0.1] 27%|██▋       | 20/75 [08:55<22:55, 25.00s/epoch, loss=1.16, accuracy=0.742, val_loss=1.95, val_accuracy=0.531, lr=0.1] 28%|██▊       | 21/75 [09:19<22:22, 24.87s/epoch, loss=1.16, accuracy=0.746, val_loss=1.5, val_accuracy=0.643, lr=0.1]  29%|██▉       | 22/75 [09:44<21:57, 24.85s/epoch, loss=1.16, accuracy=0.744, val_loss=2.05, val_accuracy=0.537, lr=0.0316] 31%|███       | 23/75 [10:09<21:36, 24.94s/epoch, loss=1.16, accuracy=0.742, val_loss=4.04, val_accuracy=0.341, lr=0.1]    32%|███▏      | 24/75 [10:35<21:17, 25.05s/epoch, loss=1.15, accuracy=0.747, val_loss=1.47, val_accuracy=0.643, lr=0.1] 33%|███▎      | 25/75 [11:00<21:02, 25.24s/epoch, loss=1.15, accuracy=0.744, val_loss=2.63, val_accuracy=0.347, lr=0.1] 35%|███▍      | 26/75 [11:25<20:32, 25.16s/epoch, loss=1.14, accuracy=0.745, val_loss=1.82, val_accuracy=0.502, lr=0.1] 36%|███▌      | 27/75 [11:51<20:12, 25.26s/epoch, loss=1.16, accuracy=0.745, val_loss=1.61, val_accuracy=0.607, lr=0.0316] 37%|███▋      | 28/75 [12:15<19:38, 25.06s/epoch, loss=1.14, accuracy=0.748, val_loss=2.17, val_accuracy=0.469, lr=0.1]    39%|███▊      | 29/75 [12:40<19:08, 24.97s/epoch, loss=1.15, accuracy=0.75, val_loss=2.32, val_accuracy=0.415, lr=0.1]  40%|████      | 30/75 [13:05<18:48, 25.07s/epoch, loss=1.15, accuracy=0.747, val_loss=2, val_accuracy=0.517, lr=0.1]   41%|████▏     | 31/75 [13:30<18:19, 24.98s/epoch, loss=1.14, accuracy=0.75, val_loss=1.91, val_accuracy=0.574, lr=0.1] 43%|████▎     | 32/75 [13:55<17:51, 24.93s/epoch, loss=1.14, accuracy=0.747, val_loss=2.21, val_accuracy=0.426, lr=0.0316] 44%|████▍     | 33/75 [14:20<17:23, 24.85s/epoch, loss=1.14, accuracy=0.751, val_loss=1.96, val_accuracy=0.519, lr=0.1]    45%|████▌     | 34/75 [14:45<16:59, 24.86s/epoch, loss=1.14, accuracy=0.752, val_loss=1.74, val_accuracy=0.532, lr=0.1] 47%|████▋     | 35/75 [15:10<16:37, 24.95s/epoch, loss=1.13, accuracy=0.75, val_loss=2.15, val_accuracy=0.495, lr=0.1]  48%|████▊     | 36/75 [15:35<16:15, 25.00s/epoch, loss=1.13, accuracy=0.753, val_loss=3.01, val_accuracy=0.389, lr=0.1] 49%|████▉     | 37/75 [15:59<15:45, 24.89s/epoch, loss=1.12, accuracy=0.754, val_loss=1.6, val_accuracy=0.58, lr=0.0316] 51%|█████     | 38/75 [16:25<15:22, 24.94s/epoch, loss=1.13, accuracy=0.751, val_loss=2.46, val_accuracy=0.387, lr=0.1]  52%|█████▏    | 39/75 [16:50<15:06, 25.17s/epoch, loss=1.13, accuracy=0.754, val_loss=1.73, val_accuracy=0.565, lr=0.1] 53%|█████▎    | 40/75 [17:16<14:42, 25.21s/epoch, loss=1.13, accuracy=0.752, val_loss=1.99, val_accuracy=0.507, lr=0.1] 55%|█████▍    | 41/75 [17:41<14:14, 25.14s/epoch, loss=1.12, accuracy=0.756, val_loss=2.31, val_accuracy=0.399, lr=0.1] 56%|█████▌    | 42/75 [18:06<13:49, 25.14s/epoch, loss=1.12, accuracy=0.757, val_loss=2.12, val_accuracy=0.432, lr=0.0316] 57%|█████▋    | 43/75 [18:30<13:20, 25.02s/epoch, loss=1.12, accuracy=0.755, val_loss=2.44, val_accuracy=0.436, lr=0.1]    59%|█████▊    | 44/75 [18:56<12:57, 25.09s/epoch, loss=1.13, accuracy=0.755, val_loss=2.26, val_accuracy=0.465, lr=0.1] 60%|██████    | 45/75 [19:21<12:33, 25.13s/epoch, loss=1.12, accuracy=0.755, val_loss=1.82, val_accuracy=0.552, lr=0.1] 61%|██████▏   | 46/75 [19:46<12:04, 24.99s/epoch, loss=1.12, accuracy=0.754, val_loss=4.27, val_accuracy=0.243, lr=0.1] 63%|██████▎   | 47/75 [20:11<11:40, 25.01s/epoch, loss=1.12, accuracy=0.754, val_loss=2.88, val_accuracy=0.358, lr=0.0316] 64%|██████▍   | 48/75 [20:36<11:15, 25.00s/epoch, loss=1.12, accuracy=0.754, val_loss=3.28, val_accuracy=0.344, lr=0.1]    65%|██████▌   | 49/75 [21:02<10:57, 25.30s/epoch, loss=1.11, accuracy=0.756, val_loss=2.49, val_accuracy=0.436, lr=0.1] 67%|██████▋   | 50/75 [21:28<10:37, 25.51s/epoch, loss=1.12, accuracy=0.756, val_loss=1.63, val_accuracy=0.602, lr=0.1] 68%|██████▊   | 51/75 [21:54<10:20, 25.85s/epoch, loss=1.13, accuracy=0.753, val_loss=2.4, val_accuracy=0.373, lr=0.1]  69%|██████▉   | 52/75 [22:19<09:49, 25.61s/epoch, loss=1.12, accuracy=0.756, val_loss=1.74, val_accuracy=0.504, lr=0.0316] 71%|███████   | 53/75 [22:44<09:19, 25.43s/epoch, loss=1.12, accuracy=0.754, val_loss=2.48, val_accuracy=0.451, lr=0.1]    72%|███████▏  | 54/75 [23:09<08:49, 25.24s/epoch, loss=1.12, accuracy=0.753, val_loss=1.98, val_accuracy=0.447, lr=0.1] 73%|███████▎  | 55/75 [23:34<08:23, 25.16s/epoch, loss=1.12, accuracy=0.755, val_loss=1.62, val_accuracy=0.596, lr=0.1] 75%|███████▍  | 56/75 [23:59<07:56, 25.05s/epoch, loss=1.12, accuracy=0.753, val_loss=1.73, val_accuracy=0.576, lr=0.1] 76%|███████▌  | 57/75 [24:24<07:29, 24.97s/epoch, loss=1.11, accuracy=0.755, val_loss=1.74, val_accuracy=0.557, lr=0.0316] 77%|███████▋  | 58/75 [24:49<07:04, 24.98s/epoch, loss=1.12, accuracy=0.755, val_loss=1.67, val_accuracy=0.564, lr=0.1]    79%|███████▊  | 59/75 [25:13<06:37, 24.83s/epoch, loss=1.11, accuracy=0.757, val_loss=3.07, val_accuracy=0.272, lr=0.1] 80%|████████  | 60/75 [25:37<06:10, 24.68s/epoch, loss=1.11, accuracy=0.755, val_loss=4.57, val_accuracy=0.208, lr=0.1] 81%|████████▏ | 61/75 [26:02<05:45, 24.71s/epoch, loss=1.11, accuracy=0.759, val_loss=2.09, val_accuracy=0.475, lr=0.1] 83%|████████▎ | 62/75 [26:27<05:20, 24.68s/epoch, loss=1.12, accuracy=0.755, val_loss=1.97, val_accuracy=0.513, lr=0.0316] 84%|████████▍ | 63/75 [26:52<04:58, 24.88s/epoch, loss=1.11, accuracy=0.756, val_loss=1.73, val_accuracy=0.563, lr=0.1]    85%|████████▌ | 64/75 [27:17<04:33, 24.89s/epoch, loss=1.12, accuracy=0.755, val_loss=2.36, val_accuracy=0.395, lr=0.1] 87%|████████▋ | 65/75 [27:42<04:10, 25.01s/epoch, loss=1.11, accuracy=0.756, val_loss=3.36, val_accuracy=0.327, lr=0.1] 88%|████████▊ | 66/75 [28:07<03:44, 24.91s/epoch, loss=1.12, accuracy=0.757, val_loss=1.66, val_accuracy=0.578, lr=0.1] 89%|████████▉ | 67/75 [28:32<03:18, 24.87s/epoch, loss=1.11, accuracy=0.756, val_loss=1.72, val_accuracy=0.555, lr=0.0316] 91%|█████████ | 68/75 [28:56<02:53, 24.80s/epoch, loss=1.11, accuracy=0.757, val_loss=2.37, val_accuracy=0.377, lr=0.1]    92%|█████████▏| 69/75 [29:21<02:29, 24.83s/epoch, loss=1.11, accuracy=0.758, val_loss=1.82, val_accuracy=0.566, lr=0.1] 93%|█████████▎| 70/75 [29:46<02:03, 24.69s/epoch, loss=1.1, accuracy=0.758, val_loss=1.65, val_accuracy=0.585, lr=0.1]  95%|█████████▍| 71/75 [30:11<01:38, 24.74s/epoch, loss=1.11, accuracy=0.755, val_loss=3.47, val_accuracy=0.335, lr=0.1] 96%|█████████▌| 72/75 [30:36<01:14, 24.84s/epoch, loss=1.11, accuracy=0.756, val_loss=1.94, val_accuracy=0.521, lr=0.0316] 97%|█████████▋| 73/75 [31:00<00:49, 24.80s/epoch, loss=1.11, accuracy=0.756, val_loss=1.74, val_accuracy=0.529, lr=0.1]    99%|█████████▊| 74/75 [31:25<00:24, 24.74s/epoch, loss=1.11, accuracy=0.756, val_loss=2.11, val_accuracy=0.509, lr=0.1]100%|██████████| 75/75 [31:50<00:00, 24.75s/epoch, loss=1.11, accuracy=0.756, val_loss=3.35, val_accuracy=0.377, lr=0.1]100%|██████████| 75/75 [31:50<00:00, 25.47s/epoch, loss=1.11, accuracy=0.756, val_loss=3.35, val_accuracy=0.377, lr=0.1]
Using real-time data augmentation.
Test score: 1.3936816453933716
Test accuracy: 0.6571000218391418


* * * Run SGD for ID = 20_11. * * *


2024-02-20 05:20:00.501769: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 05:20:03.922486: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 05:20:03.923849: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-20 05:20:03.966668: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:86:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-20 05:20:03.966713: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 05:20:03.970325: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 05:20:03.970400: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-20 05:20:03.973136: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-20 05:20:03.974011: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-20 05:20:03.976999: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-20 05:20:03.978849: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-20 05:20:03.984781: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 05:20:03.985514: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-20 05:20:03.985600: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 05:20:05.393608: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-20 05:20:05.394664: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 05:20:05.395232: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:86:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-20 05:20:05.395267: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 05:20:05.395300: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 05:20:05.395315: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-20 05:20:05.395329: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-20 05:20:05.395343: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-20 05:20:05.395356: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-20 05:20:05.395379: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-20 05:20:05.395394: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 05:20:05.395965: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-20 05:20:05.396001: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 05:20:06.041629: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-20 05:20:06.041698: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-20 05:20:06.041708: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-20 05:20:06.043415: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:86:00.0, compute capability: 6.1)
{'id': '20_11', 'batch_size': 128, 'epochs': 75, 'validation_split': 0.1, 'checkpointing': True, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
x_train shape: (45000, 32, 32, 3)
45000 train samples
5000 validation samples
10000 test samples
y_train shape: (45000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/75 [00:00<?, ?epoch/s]2024-02-20 05:20:06.920235: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-20 05:20:06.932049: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-02-20 05:20:09.134915: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 05:20:09.482713: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 05:20:10.357162: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-20 05:20:10.403617: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|▏         | 1/75 [01:01<1:15:44, 61.41s/epoch, loss=3.5, accuracy=0.303, val_loss=2.8, val_accuracy=0.17, lr=0.1]  3%|▎         | 2/75 [01:29<50:46, 41.73s/epoch, loss=1.68, accuracy=0.491, val_loss=2.08, val_accuracy=0.365, lr=0.1]  4%|▍         | 3/75 [01:57<42:30, 35.42s/epoch, loss=1.42, accuracy=0.605, val_loss=2.42, val_accuracy=0.449, lr=0.1]  5%|▌         | 4/75 [02:25<38:20, 32.40s/epoch, loss=1.3, accuracy=0.665, val_loss=2.74, val_accuracy=0.33, lr=0.1]    7%|▋         | 5/75 [02:52<35:51, 30.73s/epoch, loss=1.26, accuracy=0.691, val_loss=2.11, val_accuracy=0.438, lr=0.1]  8%|▊         | 6/75 [03:20<34:19, 29.85s/epoch, loss=1.24, accuracy=0.709, val_loss=1.71, val_accuracy=0.537, lr=0.1]  9%|▉         | 7/75 [03:48<32:56, 29.07s/epoch, loss=1.23, accuracy=0.715, val_loss=2.05, val_accuracy=0.536, lr=0.1] 11%|█         | 8/75 [04:16<32:00, 28.67s/epoch, loss=1.22, accuracy=0.723, val_loss=1.82, val_accuracy=0.523, lr=0.1] 12%|█▏        | 9/75 [04:44<31:13, 28.39s/epoch, loss=1.2, accuracy=0.73, val_loss=2.02, val_accuracy=0.45, lr=0.1]    13%|█▎        | 10/75 [05:12<30:43, 28.36s/epoch, loss=1.2, accuracy=0.732, val_loss=1.84, val_accuracy=0.547, lr=0.1] 15%|█▍        | 11/75 [05:39<30:01, 28.15s/epoch, loss=1.19, accuracy=0.733, val_loss=1.71, val_accuracy=0.526, lr=0.0316] 16%|█▌        | 12/75 [06:08<29:33, 28.14s/epoch, loss=1.19, accuracy=0.737, val_loss=1.61, val_accuracy=0.564, lr=0.1]    17%|█▋        | 13/75 [06:35<28:55, 27.99s/epoch, loss=1.18, accuracy=0.742, val_loss=1.77, val_accuracy=0.553, lr=0.1] 19%|█▊        | 14/75 [07:03<28:20, 27.87s/epoch, loss=1.17, accuracy=0.741, val_loss=2.6, val_accuracy=0.442, lr=0.1]  20%|██        | 15/75 [07:31<27:52, 27.87s/epoch, loss=1.18, accuracy=0.742, val_loss=3.29, val_accuracy=0.291, lr=0.1] 21%|██▏       | 16/75 [07:59<27:31, 27.98s/epoch, loss=1.18, accuracy=0.742, val_loss=1.48, val_accuracy=0.637, lr=0.1] 23%|██▎       | 17/75 [08:27<26:56, 27.87s/epoch, loss=1.16, accuracy=0.746, val_loss=2.13, val_accuracy=0.473, lr=0.1] 24%|██▍       | 18/75 [08:54<26:24, 27.80s/epoch, loss=1.16, accuracy=0.747, val_loss=1.54, val_accuracy=0.621, lr=0.1] 25%|██▌       | 19/75 [09:22<25:55, 27.77s/epoch, loss=1.16, accuracy=0.744, val_loss=1.77, val_accuracy=0.563, lr=0.1] 27%|██▋       | 20/75 [09:50<25:27, 27.76s/epoch, loss=1.16, accuracy=0.746, val_loss=1.63, val_accuracy=0.581, lr=0.1] 28%|██▊       | 21/75 [10:17<25:00, 27.78s/epoch, loss=1.15, accuracy=0.747, val_loss=2.12, val_accuracy=0.499, lr=0.0316] 29%|██▉       | 22/75 [10:45<24:32, 27.78s/epoch, loss=1.15, accuracy=0.748, val_loss=2.17, val_accuracy=0.496, lr=0.1]    31%|███       | 23/75 [11:13<24:05, 27.80s/epoch, loss=1.16, accuracy=0.746, val_loss=1.95, val_accuracy=0.548, lr=0.1] 32%|███▏      | 24/75 [11:41<23:39, 27.83s/epoch, loss=1.15, accuracy=0.75, val_loss=1.45, val_accuracy=0.644, lr=0.1]  33%|███▎      | 25/75 [12:09<23:08, 27.77s/epoch, loss=1.15, accuracy=0.75, val_loss=4.19, val_accuracy=0.343, lr=0.1] 35%|███▍      | 26/75 [12:37<22:45, 27.86s/epoch, loss=1.15, accuracy=0.747, val_loss=1.9, val_accuracy=0.496, lr=0.1] 36%|███▌      | 27/75 [13:04<22:14, 27.81s/epoch, loss=1.14, accuracy=0.749, val_loss=2.34, val_accuracy=0.5, lr=0.1]  37%|███▋      | 28/75 [13:32<21:45, 27.79s/epoch, loss=1.14, accuracy=0.753, val_loss=2.22, val_accuracy=0.438, lr=0.1] 39%|███▊      | 29/75 [14:00<21:14, 27.71s/epoch, loss=1.14, accuracy=0.751, val_loss=1.81, val_accuracy=0.569, lr=0.0316] 40%|████      | 30/75 [14:27<20:48, 27.74s/epoch, loss=1.14, accuracy=0.752, val_loss=2.01, val_accuracy=0.489, lr=0.1]    41%|████▏     | 31/75 [14:55<20:24, 27.82s/epoch, loss=1.13, accuracy=0.751, val_loss=2.24, val_accuracy=0.431, lr=0.1] 43%|████▎     | 32/75 [15:24<20:00, 27.92s/epoch, loss=1.14, accuracy=0.751, val_loss=1.39, val_accuracy=0.656, lr=0.1] 44%|████▍     | 33/75 [15:51<19:29, 27.84s/epoch, loss=1.14, accuracy=0.753, val_loss=2.55, val_accuracy=0.35, lr=0.1]  45%|████▌     | 34/75 [16:19<19:00, 27.82s/epoch, loss=1.15, accuracy=0.753, val_loss=1.68, val_accuracy=0.59, lr=0.1] 47%|████▋     | 35/75 [16:47<18:34, 27.86s/epoch, loss=1.14, accuracy=0.753, val_loss=2.54, val_accuracy=0.358, lr=0.1] 48%|████▊     | 36/75 [17:15<18:04, 27.81s/epoch, loss=1.13, accuracy=0.753, val_loss=2.51, val_accuracy=0.407, lr=0.1] 49%|████▉     | 37/75 [17:43<17:37, 27.84s/epoch, loss=1.13, accuracy=0.754, val_loss=2.27, val_accuracy=0.496, lr=0.0316] 51%|█████     | 38/75 [18:10<17:09, 27.82s/epoch, loss=1.14, accuracy=0.752, val_loss=1.76, val_accuracy=0.563, lr=0.1]    52%|█████▏    | 39/75 [18:38<16:41, 27.82s/epoch, loss=1.14, accuracy=0.752, val_loss=1.55, val_accuracy=0.607, lr=0.1] 53%|█████▎    | 40/75 [19:06<16:14, 27.83s/epoch, loss=1.14, accuracy=0.752, val_loss=1.7, val_accuracy=0.587, lr=0.1]  55%|█████▍    | 41/75 [19:34<15:46, 27.84s/epoch, loss=1.13, accuracy=0.755, val_loss=1.71, val_accuracy=0.586, lr=0.1] 56%|█████▌    | 42/75 [20:01<15:15, 27.75s/epoch, loss=1.13, accuracy=0.756, val_loss=1.65, val_accuracy=0.554, lr=0.0316] 57%|█████▋    | 43/75 [20:29<14:48, 27.77s/epoch, loss=1.14, accuracy=0.754, val_loss=5.71, val_accuracy=0.224, lr=0.1]    59%|█████▊    | 44/75 [20:57<14:23, 27.86s/epoch, loss=1.13, accuracy=0.755, val_loss=2.56, val_accuracy=0.435, lr=0.1] 60%|██████    | 45/75 [21:25<13:54, 27.83s/epoch, loss=1.13, accuracy=0.754, val_loss=2.67, val_accuracy=0.36, lr=0.1]  61%|██████▏   | 46/75 [21:53<13:28, 27.88s/epoch, loss=1.12, accuracy=0.757, val_loss=3.12, val_accuracy=0.26, lr=0.1] 63%|██████▎   | 47/75 [22:21<12:59, 27.85s/epoch, loss=1.13, accuracy=0.756, val_loss=2.35, val_accuracy=0.45, lr=0.0316] 64%|██████▍   | 48/75 [22:48<12:28, 27.71s/epoch, loss=1.12, accuracy=0.754, val_loss=2.11, val_accuracy=0.522, lr=0.1]   65%|██████▌   | 49/75 [23:16<12:00, 27.69s/epoch, loss=1.12, accuracy=0.758, val_loss=2.52, val_accuracy=0.418, lr=0.1] 67%|██████▋   | 50/75 [23:44<11:32, 27.71s/epoch, loss=1.13, accuracy=0.755, val_loss=2.02, val_accuracy=0.507, lr=0.1] 68%|██████▊   | 51/75 [24:11<11:05, 27.72s/epoch, loss=1.13, accuracy=0.755, val_loss=2.09, val_accuracy=0.466, lr=0.1] 69%|██████▉   | 52/75 [24:39<10:38, 27.78s/epoch, loss=1.12, accuracy=0.759, val_loss=2.62, val_accuracy=0.321, lr=0.0316] 71%|███████   | 53/75 [25:07<10:11, 27.80s/epoch, loss=1.12, accuracy=0.757, val_loss=3.43, val_accuracy=0.299, lr=0.1]    72%|███████▏  | 54/75 [25:35<09:44, 27.82s/epoch, loss=1.12, accuracy=0.756, val_loss=2.41, val_accuracy=0.349, lr=0.1] 73%|███████▎  | 55/75 [26:03<09:17, 27.87s/epoch, loss=1.12, accuracy=0.755, val_loss=2, val_accuracy=0.446, lr=0.1]    75%|███████▍  | 56/75 [26:30<08:44, 27.60s/epoch, loss=1.13, accuracy=0.753, val_loss=1.82, val_accuracy=0.544, lr=0.1] 76%|███████▌  | 57/75 [26:58<08:18, 27.68s/epoch, loss=1.12, accuracy=0.756, val_loss=1.78, val_accuracy=0.543, lr=0.0316] 77%|███████▋  | 58/75 [27:26<07:50, 27.69s/epoch, loss=1.12, accuracy=0.756, val_loss=2.9, val_accuracy=0.415, lr=0.1]     79%|███████▊  | 59/75 [27:53<07:22, 27.69s/epoch, loss=1.12, accuracy=0.756, val_loss=1.83, val_accuracy=0.533, lr=0.1] 80%|████████  | 60/75 [28:21<06:54, 27.66s/epoch, loss=1.11, accuracy=0.76, val_loss=1.81, val_accuracy=0.549, lr=0.1]  81%|████████▏ | 61/75 [28:49<06:27, 27.69s/epoch, loss=1.12, accuracy=0.755, val_loss=1.71, val_accuracy=0.565, lr=0.1] 83%|████████▎ | 62/75 [29:16<05:59, 27.68s/epoch, loss=1.11, accuracy=0.757, val_loss=2.14, val_accuracy=0.434, lr=0.0316] 84%|████████▍ | 63/75 [29:44<05:32, 27.70s/epoch, loss=1.12, accuracy=0.757, val_loss=1.69, val_accuracy=0.571, lr=0.1]    85%|████████▌ | 64/75 [30:12<05:04, 27.71s/epoch, loss=1.11, accuracy=0.759, val_loss=2.16, val_accuracy=0.408, lr=0.1] 87%|████████▋ | 65/75 [30:40<04:37, 27.78s/epoch, loss=1.12, accuracy=0.756, val_loss=4.83, val_accuracy=0.307, lr=0.1] 88%|████████▊ | 66/75 [31:07<04:09, 27.75s/epoch, loss=1.12, accuracy=0.757, val_loss=2.51, val_accuracy=0.379, lr=0.1] 89%|████████▉ | 67/75 [31:35<03:42, 27.78s/epoch, loss=1.11, accuracy=0.757, val_loss=1.97, val_accuracy=0.462, lr=0.0316] 91%|█████████ | 68/75 [32:03<03:14, 27.72s/epoch, loss=1.12, accuracy=0.756, val_loss=2.73, val_accuracy=0.298, lr=0.1]    92%|█████████▏| 69/75 [32:31<02:46, 27.72s/epoch, loss=1.11, accuracy=0.758, val_loss=1.54, val_accuracy=0.614, lr=0.1] 93%|█████████▎| 70/75 [32:58<02:18, 27.65s/epoch, loss=1.11, accuracy=0.757, val_loss=2.23, val_accuracy=0.455, lr=0.1] 95%|█████████▍| 71/75 [33:26<01:50, 27.65s/epoch, loss=1.11, accuracy=0.758, val_loss=1.92, val_accuracy=0.561, lr=0.1] 96%|█████████▌| 72/75 [33:53<01:22, 27.65s/epoch, loss=1.12, accuracy=0.757, val_loss=2.5, val_accuracy=0.349, lr=0.0316] 97%|█████████▋| 73/75 [34:21<00:55, 27.67s/epoch, loss=1.11, accuracy=0.755, val_loss=1.59, val_accuracy=0.6, lr=0.1]     99%|█████████▊| 74/75 [34:49<00:27, 27.66s/epoch, loss=1.11, accuracy=0.757, val_loss=1.94, val_accuracy=0.524, lr=0.1]100%|██████████| 75/75 [35:16<00:00, 27.65s/epoch, loss=1.11, accuracy=0.76, val_loss=2.89, val_accuracy=0.325, lr=0.1] 100%|██████████| 75/75 [35:16<00:00, 28.22s/epoch, loss=1.11, accuracy=0.76, val_loss=2.89, val_accuracy=0.325, lr=0.1]
Using real-time data augmentation.
Test score: 1.3894840478897095
Test accuracy: 0.6625999808311462


* * * Run SGD for ID = 20_12. * * *


2024-02-20 05:55:30.945886: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 05:55:33.726043: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 05:55:33.727367: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-20 05:55:33.770075: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:86:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-20 05:55:33.770122: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 05:55:33.773790: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 05:55:33.773874: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-20 05:55:33.776611: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-20 05:55:33.777406: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-20 05:55:33.780360: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-20 05:55:33.782191: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-20 05:55:33.788025: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 05:55:33.788798: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-20 05:55:33.788895: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 05:55:35.298130: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-20 05:55:35.299251: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 05:55:35.299775: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:86:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-20 05:55:35.299810: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 05:55:35.299856: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 05:55:35.299871: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-20 05:55:35.299885: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-20 05:55:35.299908: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-20 05:55:35.299922: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-20 05:55:35.299936: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-20 05:55:35.299950: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 05:55:35.300539: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-20 05:55:35.300585: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 05:55:36.004804: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-20 05:55:36.004895: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-20 05:55:36.004908: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-20 05:55:36.006801: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:86:00.0, compute capability: 6.1)
{'id': '20_12', 'batch_size': 128, 'epochs': 75, 'validation_split': 0.1, 'checkpointing': True, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
x_train shape: (45000, 32, 32, 3)
45000 train samples
5000 validation samples
10000 test samples
y_train shape: (45000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/75 [00:00<?, ?epoch/s]2024-02-20 05:55:36.918515: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-20 05:55:36.919194: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-02-20 05:55:39.184397: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 05:55:39.508913: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 05:55:40.549155: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-20 05:55:40.603101: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|▏         | 1/75 [01:04<1:19:19, 64.31s/epoch, loss=3.38, accuracy=0.271, val_loss=3.7, val_accuracy=0.19, lr=0.1]  3%|▎         | 2/75 [01:32<52:07, 42.84s/epoch, loss=1.63, accuracy=0.516, val_loss=2.22, val_accuracy=0.373, lr=0.1]  4%|▍         | 3/75 [01:59<43:11, 35.99s/epoch, loss=1.4, accuracy=0.617, val_loss=1.86, val_accuracy=0.484, lr=0.1]   5%|▌         | 4/75 [02:27<38:49, 32.81s/epoch, loss=1.32, accuracy=0.664, val_loss=1.86, val_accuracy=0.528, lr=0.1]  7%|▋         | 5/75 [02:55<36:07, 30.96s/epoch, loss=1.28, accuracy=0.686, val_loss=1.76, val_accuracy=0.516, lr=0.1]  8%|▊         | 6/75 [03:23<34:22, 29.89s/epoch, loss=1.26, accuracy=0.698, val_loss=2.72, val_accuracy=0.336, lr=0.1]  9%|▉         | 7/75 [03:51<33:02, 29.15s/epoch, loss=1.25, accuracy=0.707, val_loss=2.25, val_accuracy=0.442, lr=0.1] 11%|█         | 8/75 [04:19<32:09, 28.80s/epoch, loss=1.23, accuracy=0.717, val_loss=1.62, val_accuracy=0.589, lr=0.1] 12%|█▏        | 9/75 [04:46<31:13, 28.38s/epoch, loss=1.22, accuracy=0.721, val_loss=2.05, val_accuracy=0.461, lr=0.1] 13%|█▎        | 10/75 [05:14<30:31, 28.17s/epoch, loss=1.22, accuracy=0.723, val_loss=2.86, val_accuracy=0.341, lr=0.1] 15%|█▍        | 11/75 [05:40<29:32, 27.69s/epoch, loss=1.22, accuracy=0.725, val_loss=1.91, val_accuracy=0.539, lr=0.1] 16%|█▌        | 12/75 [06:06<28:32, 27.19s/epoch, loss=1.2, accuracy=0.729, val_loss=3.6, val_accuracy=0.327, lr=0.1]   17%|█▋        | 13/75 [06:31<27:25, 26.55s/epoch, loss=1.2, accuracy=0.731, val_loss=2.11, val_accuracy=0.503, lr=0.0316] 19%|█▊        | 14/75 [06:57<26:48, 26.36s/epoch, loss=1.2, accuracy=0.73, val_loss=2.65, val_accuracy=0.404, lr=0.1]     20%|██        | 15/75 [07:22<25:55, 25.93s/epoch, loss=1.2, accuracy=0.734, val_loss=3.26, val_accuracy=0.292, lr=0.1] 21%|██▏       | 16/75 [07:47<25:09, 25.58s/epoch, loss=1.19, accuracy=0.736, val_loss=1.8, val_accuracy=0.574, lr=0.1] 23%|██▎       | 17/75 [08:12<24:31, 25.37s/epoch, loss=1.19, accuracy=0.735, val_loss=1.84, val_accuracy=0.527, lr=0.1] 24%|██▍       | 18/75 [08:37<23:56, 25.20s/epoch, loss=1.18, accuracy=0.739, val_loss=1.99, val_accuracy=0.544, lr=0.0316] 25%|██▌       | 19/75 [09:02<23:29, 25.17s/epoch, loss=1.19, accuracy=0.739, val_loss=1.84, val_accuracy=0.53, lr=0.1]     27%|██▋       | 20/75 [09:27<23:07, 25.23s/epoch, loss=1.19, accuracy=0.74, val_loss=1.61, val_accuracy=0.582, lr=0.1] 28%|██▊       | 21/75 [09:52<22:36, 25.12s/epoch, loss=1.18, accuracy=0.742, val_loss=1.73, val_accuracy=0.586, lr=0.1] 29%|██▉       | 22/75 [10:17<22:12, 25.14s/epoch, loss=1.18, accuracy=0.741, val_loss=2.94, val_accuracy=0.367, lr=0.1] 31%|███       | 23/75 [10:42<21:44, 25.08s/epoch, loss=1.17, accuracy=0.741, val_loss=1.93, val_accuracy=0.518, lr=0.1] 32%|███▏      | 24/75 [11:07<21:18, 25.06s/epoch, loss=1.17, accuracy=0.744, val_loss=2.45, val_accuracy=0.422, lr=0.1] 33%|███▎      | 25/75 [11:32<20:49, 24.99s/epoch, loss=1.16, accuracy=0.747, val_loss=1.78, val_accuracy=0.552, lr=0.0316] 35%|███▍      | 26/75 [11:57<20:21, 24.93s/epoch, loss=1.17, accuracy=0.748, val_loss=2.05, val_accuracy=0.516, lr=0.1]    36%|███▌      | 27/75 [12:22<19:57, 24.96s/epoch, loss=1.17, accuracy=0.747, val_loss=2.41, val_accuracy=0.434, lr=0.1] 37%|███▋      | 28/75 [12:47<19:33, 24.98s/epoch, loss=1.17, accuracy=0.748, val_loss=2.06, val_accuracy=0.465, lr=0.1] 39%|███▊      | 29/75 [13:12<19:10, 25.02s/epoch, loss=1.17, accuracy=0.746, val_loss=10, val_accuracy=0.122, lr=0.1]   40%|████      | 30/75 [13:37<18:44, 24.99s/epoch, loss=1.17, accuracy=0.747, val_loss=5.67, val_accuracy=0.244, lr=0.0316] 41%|████▏     | 31/75 [14:02<18:17, 24.93s/epoch, loss=1.16, accuracy=0.747, val_loss=3.5, val_accuracy=0.396, lr=0.1]     43%|████▎     | 32/75 [14:27<17:55, 25.00s/epoch, loss=1.16, accuracy=0.749, val_loss=4.74, val_accuracy=0.209, lr=0.1] 44%|████▍     | 33/75 [14:52<17:29, 24.98s/epoch, loss=1.16, accuracy=0.748, val_loss=3.09, val_accuracy=0.395, lr=0.1] 45%|████▌     | 34/75 [15:17<17:04, 24.98s/epoch, loss=1.16, accuracy=0.748, val_loss=1.99, val_accuracy=0.477, lr=0.1] 47%|████▋     | 35/75 [15:42<16:40, 25.01s/epoch, loss=1.16, accuracy=0.748, val_loss=2.09, val_accuracy=0.479, lr=0.0316] 48%|████▊     | 36/75 [16:07<16:12, 24.95s/epoch, loss=1.14, accuracy=0.753, val_loss=1.85, val_accuracy=0.507, lr=0.1]    49%|████▉     | 37/75 [16:32<15:56, 25.16s/epoch, loss=1.15, accuracy=0.752, val_loss=2.82, val_accuracy=0.375, lr=0.1] 51%|█████     | 38/75 [16:57<15:29, 25.12s/epoch, loss=1.15, accuracy=0.752, val_loss=2.75, val_accuracy=0.349, lr=0.1] 52%|█████▏    | 39/75 [17:23<15:09, 25.27s/epoch, loss=1.16, accuracy=0.748, val_loss=1.55, val_accuracy=0.624, lr=0.1] 53%|█████▎    | 40/75 [17:48<14:37, 25.08s/epoch, loss=1.15, accuracy=0.75, val_loss=1.96, val_accuracy=0.554, lr=0.1]  55%|█████▍    | 41/75 [18:13<14:11, 25.06s/epoch, loss=1.15, accuracy=0.752, val_loss=3.24, val_accuracy=0.332, lr=0.1] 56%|█████▌    | 42/75 [18:38<13:47, 25.07s/epoch, loss=1.15, accuracy=0.751, val_loss=2.44, val_accuracy=0.394, lr=0.1] 57%|█████▋    | 43/75 [19:03<13:23, 25.11s/epoch, loss=1.14, accuracy=0.751, val_loss=1.79, val_accuracy=0.556, lr=0.1] 59%|█████▊    | 44/75 [19:28<13:01, 25.21s/epoch, loss=1.15, accuracy=0.752, val_loss=1.85, val_accuracy=0.574, lr=0.0316] 60%|██████    | 45/75 [19:53<12:32, 25.07s/epoch, loss=1.15, accuracy=0.753, val_loss=2.29, val_accuracy=0.374, lr=0.1]    61%|██████▏   | 46/75 [20:19<12:10, 25.18s/epoch, loss=1.14, accuracy=0.751, val_loss=1.61, val_accuracy=0.589, lr=0.1] 63%|██████▎   | 47/75 [20:44<11:47, 25.27s/epoch, loss=1.14, accuracy=0.753, val_loss=2, val_accuracy=0.549, lr=0.1]    64%|██████▍   | 48/75 [21:09<11:18, 25.14s/epoch, loss=1.14, accuracy=0.754, val_loss=4.76, val_accuracy=0.216, lr=0.1] 65%|██████▌   | 49/75 [21:34<10:53, 25.13s/epoch, loss=1.13, accuracy=0.755, val_loss=4.97, val_accuracy=0.335, lr=0.0316] 67%|██████▋   | 50/75 [21:59<10:26, 25.07s/epoch, loss=1.14, accuracy=0.752, val_loss=2.87, val_accuracy=0.434, lr=0.1]    68%|██████▊   | 51/75 [22:24<10:02, 25.09s/epoch, loss=1.14, accuracy=0.752, val_loss=2.63, val_accuracy=0.366, lr=0.1] 69%|██████▉   | 52/75 [22:49<09:35, 25.02s/epoch, loss=1.14, accuracy=0.754, val_loss=2.75, val_accuracy=0.339, lr=0.1] 71%|███████   | 53/75 [23:14<09:12, 25.09s/epoch, loss=1.14, accuracy=0.754, val_loss=5.37, val_accuracy=0.27, lr=0.1]  72%|███████▏  | 54/75 [23:39<08:46, 25.07s/epoch, loss=1.14, accuracy=0.756, val_loss=2.53, val_accuracy=0.345, lr=0.0316] 73%|███████▎  | 55/75 [24:04<08:21, 25.10s/epoch, loss=1.14, accuracy=0.752, val_loss=1.87, val_accuracy=0.561, lr=0.1]    75%|███████▍  | 56/75 [24:30<07:57, 25.12s/epoch, loss=1.13, accuracy=0.754, val_loss=3.4, val_accuracy=0.356, lr=0.1]  76%|███████▌  | 57/75 [24:55<07:32, 25.12s/epoch, loss=1.13, accuracy=0.754, val_loss=1.71, val_accuracy=0.592, lr=0.1] 77%|███████▋  | 58/75 [25:20<07:05, 25.04s/epoch, loss=1.14, accuracy=0.754, val_loss=2.28, val_accuracy=0.501, lr=0.1] 79%|███████▊  | 59/75 [25:45<06:42, 25.13s/epoch, loss=1.14, accuracy=0.755, val_loss=2.42, val_accuracy=0.369, lr=0.0316] 80%|████████  | 60/75 [26:10<06:16, 25.09s/epoch, loss=1.13, accuracy=0.754, val_loss=2.74, val_accuracy=0.41, lr=0.1]     81%|████████▏ | 61/75 [26:35<05:51, 25.10s/epoch, loss=1.14, accuracy=0.756, val_loss=1.9, val_accuracy=0.549, lr=0.1] 83%|████████▎ | 62/75 [27:00<05:25, 25.05s/epoch, loss=1.12, accuracy=0.756, val_loss=2.29, val_accuracy=0.496, lr=0.1] 84%|████████▍ | 63/75 [27:24<04:58, 24.90s/epoch, loss=1.14, accuracy=0.753, val_loss=1.95, val_accuracy=0.524, lr=0.1] 85%|████████▌ | 64/75 [27:50<04:34, 24.97s/epoch, loss=1.13, accuracy=0.756, val_loss=2.61, val_accuracy=0.407, lr=0.0316] 87%|████████▋ | 65/75 [28:14<04:09, 24.95s/epoch, loss=1.13, accuracy=0.757, val_loss=4.05, val_accuracy=0.287, lr=0.1]    88%|████████▊ | 66/75 [28:40<03:45, 25.03s/epoch, loss=1.13, accuracy=0.755, val_loss=2.54, val_accuracy=0.429, lr=0.1] 89%|████████▉ | 67/75 [29:06<03:22, 25.37s/epoch, loss=1.13, accuracy=0.756, val_loss=4.32, val_accuracy=0.251, lr=0.1] 91%|█████████ | 68/75 [29:32<02:58, 25.56s/epoch, loss=1.13, accuracy=0.756, val_loss=3.4, val_accuracy=0.381, lr=0.1]  92%|█████████▏| 69/75 [29:57<02:32, 25.40s/epoch, loss=1.13, accuracy=0.755, val_loss=2.58, val_accuracy=0.358, lr=0.0316] 93%|█████████▎| 70/75 [30:22<02:06, 25.38s/epoch, loss=1.13, accuracy=0.755, val_loss=2.57, val_accuracy=0.329, lr=0.1]    95%|█████████▍| 71/75 [30:47<01:41, 25.33s/epoch, loss=1.13, accuracy=0.756, val_loss=1.63, val_accuracy=0.582, lr=0.1] 96%|█████████▌| 72/75 [31:12<01:15, 25.03s/epoch, loss=1.13, accuracy=0.755, val_loss=3.21, val_accuracy=0.329, lr=0.1] 97%|█████████▋| 73/75 [31:37<00:50, 25.05s/epoch, loss=1.13, accuracy=0.756, val_loss=2.18, val_accuracy=0.433, lr=0.1] 99%|█████████▊| 74/75 [32:02<00:24, 24.94s/epoch, loss=1.13, accuracy=0.756, val_loss=3.49, val_accuracy=0.277, lr=0.0316]100%|██████████| 75/75 [32:27<00:00, 24.97s/epoch, loss=1.13, accuracy=0.756, val_loss=3.12, val_accuracy=0.342, lr=0.1]   100%|██████████| 75/75 [32:27<00:00, 25.96s/epoch, loss=1.13, accuracy=0.756, val_loss=3.12, val_accuracy=0.342, lr=0.1]
Using real-time data augmentation.
Test score: 1.5408570766448975
Test accuracy: 0.6251000165939331


* * * Run SGD for ID = 20_13. * * *


2024-02-20 06:28:11.757500: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 06:28:19.634992: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 06:28:19.636254: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-20 06:28:19.676678: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:86:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-20 06:28:19.676722: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 06:28:19.682528: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 06:28:19.682603: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-20 06:28:19.686904: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-20 06:28:19.689168: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-20 06:28:19.695964: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-20 06:28:19.699224: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-20 06:28:19.705934: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 06:28:19.706653: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-20 06:28:19.706741: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 06:28:21.262932: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-20 06:28:21.263609: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 06:28:21.264785: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:86:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-20 06:28:21.264823: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 06:28:21.264881: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 06:28:21.264897: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-20 06:28:21.264919: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-20 06:28:21.264945: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-20 06:28:21.264959: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-20 06:28:21.264974: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-20 06:28:21.264988: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 06:28:21.265514: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-20 06:28:21.265549: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 06:28:21.916231: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-20 06:28:21.916295: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-20 06:28:21.916305: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-20 06:28:21.917470: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:86:00.0, compute capability: 6.1)
{'id': '20_13', 'batch_size': 128, 'epochs': 75, 'validation_split': 0.1, 'checkpointing': True, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
x_train shape: (45000, 32, 32, 3)
45000 train samples
5000 validation samples
10000 test samples
y_train shape: (45000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/75 [00:00<?, ?epoch/s]2024-02-20 06:28:22.802896: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-20 06:28:22.803433: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-02-20 06:28:24.814563: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 06:28:25.137032: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 06:28:26.102616: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-20 06:28:26.148038: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|▏         | 1/75 [00:57<1:11:09, 57.70s/epoch, loss=3.32, accuracy=0.264, val_loss=2.86, val_accuracy=0.151, lr=0.1]  3%|▎         | 2/75 [01:23<47:11, 38.79s/epoch, loss=1.66, accuracy=0.49, val_loss=2.43, val_accuracy=0.37, lr=0.1]      4%|▍         | 3/75 [01:48<39:07, 32.60s/epoch, loss=1.38, accuracy=0.625, val_loss=1.86, val_accuracy=0.495, lr=0.1]  5%|▌         | 4/75 [02:13<34:52, 29.47s/epoch, loss=1.29, accuracy=0.679, val_loss=2.06, val_accuracy=0.493, lr=0.1]  7%|▋         | 5/75 [02:38<32:43, 28.05s/epoch, loss=1.26, accuracy=0.7, val_loss=1.89, val_accuracy=0.497, lr=0.1]    8%|▊         | 6/75 [03:04<31:28, 27.37s/epoch, loss=1.23, accuracy=0.71, val_loss=1.59, val_accuracy=0.575, lr=0.1]  9%|▉         | 7/75 [03:31<30:52, 27.24s/epoch, loss=1.23, accuracy=0.717, val_loss=2.59, val_accuracy=0.36, lr=0.1] 11%|█         | 8/75 [03:58<30:14, 27.08s/epoch, loss=1.21, accuracy=0.722, val_loss=3.39, val_accuracy=0.377, lr=0.1] 12%|█▏        | 9/75 [04:24<29:29, 26.81s/epoch, loss=1.22, accuracy=0.722, val_loss=1.77, val_accuracy=0.549, lr=0.1] 13%|█▎        | 10/75 [04:49<28:30, 26.32s/epoch, loss=1.2, accuracy=0.727, val_loss=1.77, val_accuracy=0.532, lr=0.1] 15%|█▍        | 11/75 [05:14<27:32, 25.83s/epoch, loss=1.2, accuracy=0.729, val_loss=3.54, val_accuracy=0.322, lr=0.0316] 16%|█▌        | 12/75 [05:39<26:46, 25.50s/epoch, loss=1.2, accuracy=0.734, val_loss=2.75, val_accuracy=0.419, lr=0.1]    17%|█▋        | 13/75 [06:04<26:11, 25.35s/epoch, loss=1.19, accuracy=0.735, val_loss=2.3, val_accuracy=0.469, lr=0.1] 19%|█▊        | 14/75 [06:29<25:40, 25.26s/epoch, loss=1.19, accuracy=0.736, val_loss=1.58, val_accuracy=0.594, lr=0.1] 20%|██        | 15/75 [06:54<25:12, 25.21s/epoch, loss=1.19, accuracy=0.736, val_loss=3.55, val_accuracy=0.391, lr=0.1] 21%|██▏       | 16/75 [07:19<24:43, 25.14s/epoch, loss=1.19, accuracy=0.739, val_loss=1.78, val_accuracy=0.564, lr=0.1] 23%|██▎       | 17/75 [07:44<24:20, 25.19s/epoch, loss=1.18, accuracy=0.738, val_loss=1.83, val_accuracy=0.509, lr=0.1] 24%|██▍       | 18/75 [08:09<23:50, 25.09s/epoch, loss=1.18, accuracy=0.738, val_loss=3.79, val_accuracy=0.337, lr=0.1] 25%|██▌       | 19/75 [08:34<23:27, 25.13s/epoch, loss=1.17, accuracy=0.742, val_loss=1.54, val_accuracy=0.626, lr=0.1] 27%|██▋       | 20/75 [08:59<23:00, 25.10s/epoch, loss=1.18, accuracy=0.742, val_loss=2.53, val_accuracy=0.405, lr=0.1] 28%|██▊       | 21/75 [09:24<22:32, 25.04s/epoch, loss=1.17, accuracy=0.743, val_loss=2.33, val_accuracy=0.471, lr=0.1] 29%|██▉       | 22/75 [09:50<22:10, 25.10s/epoch, loss=1.17, accuracy=0.743, val_loss=1.81, val_accuracy=0.563, lr=0.1] 31%|███       | 23/75 [10:14<21:40, 25.01s/epoch, loss=1.18, accuracy=0.743, val_loss=1.68, val_accuracy=0.588, lr=0.1] 32%|███▏      | 24/75 [10:39<21:09, 24.89s/epoch, loss=1.17, accuracy=0.747, val_loss=1.6, val_accuracy=0.603, lr=0.0316] 33%|███▎      | 25/75 [11:04<20:48, 24.98s/epoch, loss=1.16, accuracy=0.745, val_loss=1.51, val_accuracy=0.617, lr=0.1]   35%|███▍      | 26/75 [11:29<20:27, 25.04s/epoch, loss=1.17, accuracy=0.747, val_loss=2.92, val_accuracy=0.363, lr=0.1] 36%|███▌      | 27/75 [11:54<20:00, 25.00s/epoch, loss=1.17, accuracy=0.743, val_loss=2.76, val_accuracy=0.343, lr=0.1] 37%|███▋      | 28/75 [12:19<19:34, 24.99s/epoch, loss=1.16, accuracy=0.745, val_loss=2.02, val_accuracy=0.486, lr=0.1] 39%|███▊      | 29/75 [12:44<19:08, 24.98s/epoch, loss=1.16, accuracy=0.744, val_loss=1.57, val_accuracy=0.606, lr=0.1] 40%|████      | 30/75 [13:09<18:48, 25.09s/epoch, loss=1.16, accuracy=0.747, val_loss=1.91, val_accuracy=0.535, lr=0.0316] 41%|████▏     | 31/75 [13:34<18:22, 25.05s/epoch, loss=1.17, accuracy=0.744, val_loss=1.92, val_accuracy=0.49, lr=0.1]     43%|████▎     | 32/75 [14:00<18:00, 25.13s/epoch, loss=1.15, accuracy=0.748, val_loss=1.75, val_accuracy=0.559, lr=0.1] 44%|████▍     | 33/75 [14:25<17:37, 25.19s/epoch, loss=1.16, accuracy=0.748, val_loss=5, val_accuracy=0.211, lr=0.1]    45%|████▌     | 34/75 [14:50<17:12, 25.18s/epoch, loss=1.17, accuracy=0.745, val_loss=1.58, val_accuracy=0.614, lr=0.1] 47%|████▋     | 35/75 [15:15<16:46, 25.16s/epoch, loss=1.16, accuracy=0.75, val_loss=1.69, val_accuracy=0.592, lr=0.0316] 48%|████▊     | 36/75 [15:40<16:21, 25.16s/epoch, loss=1.15, accuracy=0.751, val_loss=2.01, val_accuracy=0.458, lr=0.1]   49%|████▉     | 37/75 [16:05<15:52, 25.07s/epoch, loss=1.15, accuracy=0.749, val_loss=2.33, val_accuracy=0.486, lr=0.1] 51%|█████     | 38/75 [16:30<15:25, 25.01s/epoch, loss=1.16, accuracy=0.749, val_loss=2.65, val_accuracy=0.432, lr=0.1] 52%|█████▏    | 39/75 [16:55<15:01, 25.04s/epoch, loss=1.15, accuracy=0.75, val_loss=2.99, val_accuracy=0.388, lr=0.1]  53%|█████▎    | 40/75 [17:21<14:41, 25.19s/epoch, loss=1.15, accuracy=0.748, val_loss=2.09, val_accuracy=0.47, lr=0.0316] 55%|█████▍    | 41/75 [17:46<14:16, 25.20s/epoch, loss=1.15, accuracy=0.75, val_loss=1.79, val_accuracy=0.528, lr=0.1]    56%|█████▌    | 42/75 [18:11<13:47, 25.09s/epoch, loss=1.15, accuracy=0.749, val_loss=2.43, val_accuracy=0.412, lr=0.1] 57%|█████▋    | 43/75 [18:36<13:20, 25.02s/epoch, loss=1.15, accuracy=0.751, val_loss=1.63, val_accuracy=0.585, lr=0.1] 59%|█████▊    | 44/75 [19:01<12:55, 25.02s/epoch, loss=1.15, accuracy=0.751, val_loss=1.96, val_accuracy=0.541, lr=0.1] 60%|██████    | 45/75 [19:26<12:31, 25.05s/epoch, loss=1.15, accuracy=0.749, val_loss=1.9, val_accuracy=0.505, lr=0.0316] 61%|██████▏   | 46/75 [19:52<12:11, 25.21s/epoch, loss=1.15, accuracy=0.751, val_loss=1.72, val_accuracy=0.547, lr=0.1]   63%|██████▎   | 47/75 [20:17<11:45, 25.19s/epoch, loss=1.15, accuracy=0.751, val_loss=1.5, val_accuracy=0.651, lr=0.1]  64%|██████▍   | 48/75 [20:42<11:21, 25.23s/epoch, loss=1.14, accuracy=0.751, val_loss=1.98, val_accuracy=0.543, lr=0.1] 65%|██████▌   | 49/75 [21:07<10:54, 25.17s/epoch, loss=1.15, accuracy=0.751, val_loss=1.9, val_accuracy=0.513, lr=0.1]  67%|██████▋   | 50/75 [21:32<10:25, 25.02s/epoch, loss=1.14, accuracy=0.752, val_loss=3.37, val_accuracy=0.345, lr=0.1] 68%|██████▊   | 51/75 [21:57<10:00, 25.04s/epoch, loss=1.14, accuracy=0.752, val_loss=2.79, val_accuracy=0.446, lr=0.1] 69%|██████▉   | 52/75 [22:22<09:35, 25.01s/epoch, loss=1.14, accuracy=0.753, val_loss=1.63, val_accuracy=0.583, lr=0.0316] 71%|███████   | 53/75 [22:47<09:11, 25.09s/epoch, loss=1.14, accuracy=0.749, val_loss=1.72, val_accuracy=0.556, lr=0.1]    72%|███████▏  | 54/75 [23:12<08:47, 25.11s/epoch, loss=1.14, accuracy=0.751, val_loss=1.94, val_accuracy=0.513, lr=0.1] 73%|███████▎  | 55/75 [23:37<08:23, 25.15s/epoch, loss=1.14, accuracy=0.753, val_loss=2.41, val_accuracy=0.427, lr=0.1] 75%|███████▍  | 56/75 [24:02<07:57, 25.12s/epoch, loss=1.15, accuracy=0.751, val_loss=1.5, val_accuracy=0.625, lr=0.1]  76%|███████▌  | 57/75 [24:27<07:30, 25.02s/epoch, loss=1.13, accuracy=0.753, val_loss=1.75, val_accuracy=0.565, lr=0.0316] 77%|███████▋  | 58/75 [24:52<07:04, 25.00s/epoch, loss=1.13, accuracy=0.754, val_loss=6.33, val_accuracy=0.213, lr=0.1]    79%|███████▊  | 59/75 [25:17<06:39, 24.98s/epoch, loss=1.14, accuracy=0.754, val_loss=1.74, val_accuracy=0.559, lr=0.1] 80%|████████  | 60/75 [25:42<06:15, 25.02s/epoch, loss=1.14, accuracy=0.753, val_loss=3.91, val_accuracy=0.225, lr=0.1] 81%|████████▏ | 61/75 [26:07<05:49, 24.95s/epoch, loss=1.14, accuracy=0.752, val_loss=1.64, val_accuracy=0.58, lr=0.1]  83%|████████▎ | 62/75 [26:32<05:25, 25.00s/epoch, loss=1.14, accuracy=0.754, val_loss=1.94, val_accuracy=0.485, lr=0.0316] 84%|████████▍ | 63/75 [26:57<05:00, 25.07s/epoch, loss=1.14, accuracy=0.753, val_loss=3.09, val_accuracy=0.335, lr=0.1]    85%|████████▌ | 64/75 [27:22<04:35, 25.06s/epoch, loss=1.14, accuracy=0.754, val_loss=2.55, val_accuracy=0.435, lr=0.1] 87%|████████▋ | 65/75 [27:48<04:11, 25.15s/epoch, loss=1.14, accuracy=0.753, val_loss=1.58, val_accuracy=0.606, lr=0.1] 88%|████████▊ | 66/75 [28:13<03:46, 25.14s/epoch, loss=1.14, accuracy=0.754, val_loss=2.18, val_accuracy=0.45, lr=0.1]  89%|████████▉ | 67/75 [28:38<03:20, 25.11s/epoch, loss=1.13, accuracy=0.756, val_loss=2.41, val_accuracy=0.411, lr=0.0316] 91%|█████████ | 68/75 [29:03<02:56, 25.20s/epoch, loss=1.13, accuracy=0.755, val_loss=1.88, val_accuracy=0.531, lr=0.1]    92%|█████████▏| 69/75 [29:28<02:31, 25.18s/epoch, loss=1.13, accuracy=0.756, val_loss=2.33, val_accuracy=0.443, lr=0.1] 93%|█████████▎| 70/75 [29:54<02:06, 25.22s/epoch, loss=1.14, accuracy=0.755, val_loss=1.71, val_accuracy=0.565, lr=0.1] 95%|█████████▍| 71/75 [30:19<01:40, 25.08s/epoch, loss=1.13, accuracy=0.752, val_loss=2.19, val_accuracy=0.501, lr=0.1] 96%|█████████▌| 72/75 [30:44<01:15, 25.19s/epoch, loss=1.14, accuracy=0.755, val_loss=3.78, val_accuracy=0.36, lr=0.0316] 97%|█████████▋| 73/75 [31:09<00:50, 25.20s/epoch, loss=1.14, accuracy=0.753, val_loss=1.54, val_accuracy=0.609, lr=0.1]   99%|█████████▊| 74/75 [31:35<00:25, 25.31s/epoch, loss=1.14, accuracy=0.754, val_loss=1.56, val_accuracy=0.623, lr=0.1]100%|██████████| 75/75 [32:00<00:00, 25.16s/epoch, loss=1.13, accuracy=0.753, val_loss=1.83, val_accuracy=0.565, lr=0.1]100%|██████████| 75/75 [32:00<00:00, 25.60s/epoch, loss=1.13, accuracy=0.753, val_loss=1.83, val_accuracy=0.565, lr=0.1]
Using real-time data augmentation.
Test score: 1.5278291702270508
Test accuracy: 0.6510000228881836


* * * Run SGD for ID = 20_14. * * *


2024-02-20 07:00:31.158633: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 07:00:33.974202: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 07:00:33.975509: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-20 07:00:34.018150: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:86:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-20 07:00:34.018198: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 07:00:34.021635: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 07:00:34.021705: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-20 07:00:34.024390: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-20 07:00:34.025164: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-20 07:00:34.027928: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-20 07:00:34.029730: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-20 07:00:34.035172: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 07:00:34.035878: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-20 07:00:34.035969: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 07:00:35.448124: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-20 07:00:35.449263: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 07:00:35.449817: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:86:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-20 07:00:35.449865: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 07:00:35.449910: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 07:00:35.449925: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-20 07:00:35.449938: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-20 07:00:35.449952: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-20 07:00:35.449966: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-20 07:00:35.449980: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-20 07:00:35.449994: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 07:00:35.450589: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-20 07:00:35.450636: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 07:00:36.099124: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-20 07:00:36.099189: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-20 07:00:36.099200: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-20 07:00:36.100882: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:86:00.0, compute capability: 6.1)
{'id': '20_14', 'batch_size': 128, 'epochs': 75, 'validation_split': 0.1, 'checkpointing': True, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
x_train shape: (45000, 32, 32, 3)
45000 train samples
5000 validation samples
10000 test samples
y_train shape: (45000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/75 [00:00<?, ?epoch/s]2024-02-20 07:00:36.952835: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-20 07:00:36.953406: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-02-20 07:00:38.973984: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 07:00:39.233096: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 07:00:40.043623: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-20 07:00:40.087498: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|▏         | 1/75 [01:00<1:14:30, 60.42s/epoch, loss=3.56, accuracy=0.267, val_loss=2.25, val_accuracy=0.282, lr=0.1]  3%|▎         | 2/75 [01:25<48:23, 39.77s/epoch, loss=1.73, accuracy=0.46, val_loss=1.98, val_accuracy=0.352, lr=0.1]     4%|▍         | 3/75 [01:50<39:43, 33.11s/epoch, loss=1.47, accuracy=0.576, val_loss=3.24, val_accuracy=0.228, lr=0.1]  5%|▌         | 4/75 [02:16<35:32, 30.04s/epoch, loss=1.34, accuracy=0.653, val_loss=1.93, val_accuracy=0.461, lr=0.1]  7%|▋         | 5/75 [02:41<32:55, 28.22s/epoch, loss=1.28, accuracy=0.685, val_loss=2.15, val_accuracy=0.46, lr=0.1]   8%|▊         | 6/75 [03:06<31:09, 27.09s/epoch, loss=1.25, accuracy=0.699, val_loss=1.41, val_accuracy=0.656, lr=0.1]  9%|▉         | 7/75 [03:30<29:46, 26.27s/epoch, loss=1.25, accuracy=0.708, val_loss=1.56, val_accuracy=0.59, lr=0.1]  11%|█         | 8/75 [03:55<28:56, 25.92s/epoch, loss=1.24, accuracy=0.713, val_loss=1.88, val_accuracy=0.485, lr=0.1] 12%|█▏        | 9/75 [04:21<28:15, 25.69s/epoch, loss=1.23, accuracy=0.721, val_loss=2.14, val_accuracy=0.449, lr=0.1] 13%|█▎        | 10/75 [04:46<27:37, 25.51s/epoch, loss=1.23, accuracy=0.727, val_loss=2.52, val_accuracy=0.404, lr=0.1] 15%|█▍        | 11/75 [05:11<27:10, 25.48s/epoch, loss=1.22, accuracy=0.73, val_loss=1.81, val_accuracy=0.516, lr=0.0316] 16%|█▌        | 12/75 [05:36<26:38, 25.37s/epoch, loss=1.22, accuracy=0.73, val_loss=1.53, val_accuracy=0.614, lr=0.1]    17%|█▋        | 13/75 [06:02<26:12, 25.36s/epoch, loss=1.22, accuracy=0.731, val_loss=2.01, val_accuracy=0.457, lr=0.1] 19%|█▊        | 14/75 [06:26<25:37, 25.20s/epoch, loss=1.21, accuracy=0.732, val_loss=2.31, val_accuracy=0.37, lr=0.1]  20%|██        | 15/75 [06:51<25:05, 25.09s/epoch, loss=1.21, accuracy=0.734, val_loss=1.9, val_accuracy=0.519, lr=0.1] 21%|██▏       | 16/75 [07:18<25:02, 25.46s/epoch, loss=1.2, accuracy=0.734, val_loss=1.76, val_accuracy=0.569, lr=0.0316] 23%|██▎       | 17/75 [07:43<24:29, 25.33s/epoch, loss=1.2, accuracy=0.738, val_loss=1.73, val_accuracy=0.58, lr=0.1]     24%|██▍       | 18/75 [08:08<24:14, 25.51s/epoch, loss=1.19, accuracy=0.74, val_loss=1.4, val_accuracy=0.675, lr=0.1] 25%|██▌       | 19/75 [08:33<23:31, 25.20s/epoch, loss=1.19, accuracy=0.738, val_loss=1.58, val_accuracy=0.62, lr=0.1] 27%|██▋       | 20/75 [08:58<23:00, 25.09s/epoch, loss=1.19, accuracy=0.738, val_loss=2.02, val_accuracy=0.478, lr=0.1] 28%|██▊       | 21/75 [09:23<22:37, 25.14s/epoch, loss=1.18, accuracy=0.741, val_loss=1.99, val_accuracy=0.438, lr=0.1] 29%|██▉       | 22/75 [09:48<22:07, 25.04s/epoch, loss=1.18, accuracy=0.745, val_loss=1.78, val_accuracy=0.574, lr=0.1] 31%|███       | 23/75 [10:13<21:37, 24.95s/epoch, loss=1.19, accuracy=0.742, val_loss=1.81, val_accuracy=0.55, lr=0.0316] 32%|███▏      | 24/75 [10:38<21:18, 25.07s/epoch, loss=1.18, accuracy=0.741, val_loss=2.33, val_accuracy=0.527, lr=0.1]   33%|███▎      | 25/75 [11:03<20:56, 25.13s/epoch, loss=1.18, accuracy=0.743, val_loss=1.72, val_accuracy=0.566, lr=0.1] 35%|███▍      | 26/75 [11:28<20:29, 25.10s/epoch, loss=1.18, accuracy=0.743, val_loss=2.19, val_accuracy=0.46, lr=0.1]  36%|███▌      | 27/75 [11:53<19:59, 25.00s/epoch, loss=1.18, accuracy=0.743, val_loss=1.78, val_accuracy=0.538, lr=0.1] 37%|███▋      | 28/75 [12:18<19:35, 25.02s/epoch, loss=1.18, accuracy=0.746, val_loss=2.23, val_accuracy=0.435, lr=0.0316] 39%|███▊      | 29/75 [12:43<19:11, 25.04s/epoch, loss=1.18, accuracy=0.747, val_loss=1.68, val_accuracy=0.572, lr=0.1]    40%|████      | 30/75 [13:08<18:44, 24.98s/epoch, loss=1.17, accuracy=0.747, val_loss=1.97, val_accuracy=0.512, lr=0.1] 41%|████▏     | 31/75 [13:33<18:18, 24.98s/epoch, loss=1.17, accuracy=0.746, val_loss=1.91, val_accuracy=0.522, lr=0.1] 43%|████▎     | 32/75 [13:58<17:58, 25.07s/epoch, loss=1.17, accuracy=0.75, val_loss=2.24, val_accuracy=0.406, lr=0.1]  44%|████▍     | 33/75 [14:25<17:49, 25.45s/epoch, loss=1.17, accuracy=0.747, val_loss=3.27, val_accuracy=0.226, lr=0.0316] 45%|████▌     | 34/75 [14:52<17:52, 26.16s/epoch, loss=1.17, accuracy=0.748, val_loss=2.29, val_accuracy=0.489, lr=0.1]    47%|████▋     | 35/75 [15:19<17:36, 26.42s/epoch, loss=1.17, accuracy=0.747, val_loss=1.86, val_accuracy=0.58, lr=0.1]  48%|████▊     | 36/75 [15:47<17:25, 26.80s/epoch, loss=1.16, accuracy=0.75, val_loss=1.82, val_accuracy=0.542, lr=0.1] 49%|████▉     | 37/75 [16:15<17:07, 27.05s/epoch, loss=1.17, accuracy=0.751, val_loss=1.4, val_accuracy=0.659, lr=0.1] 51%|█████     | 38/75 [16:42<16:47, 27.22s/epoch, loss=1.16, accuracy=0.748, val_loss=2.54, val_accuracy=0.479, lr=0.0316] 52%|█████▏    | 39/75 [17:10<16:24, 27.35s/epoch, loss=1.16, accuracy=0.751, val_loss=1.79, val_accuracy=0.573, lr=0.1]    53%|█████▎    | 40/75 [17:38<16:00, 27.45s/epoch, loss=1.15, accuracy=0.753, val_loss=2.29, val_accuracy=0.478, lr=0.1] 55%|█████▍    | 41/75 [18:05<15:32, 27.43s/epoch, loss=1.15, accuracy=0.752, val_loss=2.01, val_accuracy=0.483, lr=0.1] 56%|█████▌    | 42/75 [18:33<15:07, 27.49s/epoch, loss=1.16, accuracy=0.752, val_loss=1.53, val_accuracy=0.635, lr=0.1] 57%|█████▋    | 43/75 [19:00<14:38, 27.47s/epoch, loss=1.16, accuracy=0.75, val_loss=2.16, val_accuracy=0.444, lr=0.0316] 59%|█████▊    | 44/75 [19:28<14:15, 27.61s/epoch, loss=1.15, accuracy=0.751, val_loss=2.18, val_accuracy=0.46, lr=0.1]    60%|██████    | 45/75 [19:56<13:49, 27.64s/epoch, loss=1.16, accuracy=0.749, val_loss=1.63, val_accuracy=0.578, lr=0.1] 61%|██████▏   | 46/75 [20:23<13:21, 27.65s/epoch, loss=1.15, accuracy=0.753, val_loss=2.11, val_accuracy=0.47, lr=0.1]  63%|██████▎   | 47/75 [20:51<12:54, 27.66s/epoch, loss=1.15, accuracy=0.753, val_loss=15.5, val_accuracy=0.149, lr=0.1] 64%|██████▍   | 48/75 [21:19<12:25, 27.61s/epoch, loss=1.15, accuracy=0.755, val_loss=5.47, val_accuracy=0.287, lr=0.0316] 65%|██████▌   | 49/75 [21:46<11:57, 27.61s/epoch, loss=1.15, accuracy=0.753, val_loss=2.8, val_accuracy=0.375, lr=0.1]     67%|██████▋   | 50/75 [22:14<11:29, 27.59s/epoch, loss=1.16, accuracy=0.751, val_loss=2.63, val_accuracy=0.405, lr=0.1] 68%|██████▊   | 51/75 [22:41<11:01, 27.57s/epoch, loss=1.15, accuracy=0.753, val_loss=1.76, val_accuracy=0.555, lr=0.1] 69%|██████▉   | 52/75 [23:09<10:34, 27.58s/epoch, loss=1.15, accuracy=0.754, val_loss=1.71, val_accuracy=0.541, lr=0.1] 71%|███████   | 53/75 [23:36<10:05, 27.50s/epoch, loss=1.15, accuracy=0.754, val_loss=1.85, val_accuracy=0.558, lr=0.0316] 72%|███████▏  | 54/75 [24:04<09:38, 27.53s/epoch, loss=1.15, accuracy=0.752, val_loss=3.89, val_accuracy=0.298, lr=0.1]    73%|███████▎  | 55/75 [24:31<09:08, 27.44s/epoch, loss=1.14, accuracy=0.755, val_loss=1.89, val_accuracy=0.535, lr=0.1] 75%|███████▍  | 56/75 [24:59<08:41, 27.45s/epoch, loss=1.15, accuracy=0.758, val_loss=1.4, val_accuracy=0.661, lr=0.1]  76%|███████▌  | 57/75 [25:26<08:13, 27.41s/epoch, loss=1.15, accuracy=0.751, val_loss=1.65, val_accuracy=0.58, lr=0.1] 77%|███████▋  | 58/75 [25:53<07:46, 27.43s/epoch, loss=1.14, accuracy=0.754, val_loss=1.74, val_accuracy=0.57, lr=0.1] 79%|███████▊  | 59/75 [26:21<07:19, 27.47s/epoch, loss=1.14, accuracy=0.755, val_loss=2.4, val_accuracy=0.401, lr=0.1] 80%|████████  | 60/75 [26:48<06:52, 27.50s/epoch, loss=1.15, accuracy=0.751, val_loss=2.05, val_accuracy=0.429, lr=0.1] 81%|████████▏ | 61/75 [27:16<06:25, 27.52s/epoch, loss=1.14, accuracy=0.755, val_loss=2.02, val_accuracy=0.425, lr=0.0316] 83%|████████▎ | 62/75 [27:44<05:57, 27.53s/epoch, loss=1.14, accuracy=0.752, val_loss=5.13, val_accuracy=0.26, lr=0.1]     84%|████████▍ | 63/75 [28:11<05:29, 27.49s/epoch, loss=1.14, accuracy=0.754, val_loss=2.01, val_accuracy=0.466, lr=0.1] 85%|████████▌ | 64/75 [28:38<05:02, 27.47s/epoch, loss=1.14, accuracy=0.756, val_loss=1.44, val_accuracy=0.644, lr=0.1] 87%|████████▋ | 65/75 [29:06<04:35, 27.51s/epoch, loss=1.14, accuracy=0.755, val_loss=3.44, val_accuracy=0.316, lr=0.1] 88%|████████▊ | 66/75 [29:33<04:07, 27.46s/epoch, loss=1.14, accuracy=0.754, val_loss=1.82, val_accuracy=0.568, lr=0.0316] 89%|████████▉ | 67/75 [30:01<03:40, 27.52s/epoch, loss=1.13, accuracy=0.757, val_loss=2.48, val_accuracy=0.385, lr=0.1]    91%|█████████ | 68/75 [30:29<03:12, 27.51s/epoch, loss=1.13, accuracy=0.758, val_loss=2.6, val_accuracy=0.351, lr=0.1]  92%|█████████▏| 69/75 [30:56<02:45, 27.51s/epoch, loss=1.15, accuracy=0.752, val_loss=1.51, val_accuracy=0.611, lr=0.1] 93%|█████████▎| 70/75 [31:23<02:17, 27.47s/epoch, loss=1.13, accuracy=0.76, val_loss=1.7, val_accuracy=0.57, lr=0.1]    95%|█████████▍| 71/75 [31:51<01:49, 27.49s/epoch, loss=1.14, accuracy=0.756, val_loss=1.84, val_accuracy=0.56, lr=0.0316] 96%|█████████▌| 72/75 [32:18<01:22, 27.48s/epoch, loss=1.13, accuracy=0.759, val_loss=2.87, val_accuracy=0.306, lr=0.1]   97%|█████████▋| 73/75 [32:46<00:54, 27.46s/epoch, loss=1.14, accuracy=0.757, val_loss=2.37, val_accuracy=0.442, lr=0.1] 99%|█████████▊| 74/75 [33:13<00:27, 27.47s/epoch, loss=1.14, accuracy=0.756, val_loss=1.86, val_accuracy=0.5, lr=0.1]  100%|██████████| 75/75 [33:41<00:00, 27.44s/epoch, loss=1.14, accuracy=0.757, val_loss=1.5, val_accuracy=0.634, lr=0.1]100%|██████████| 75/75 [33:41<00:00, 26.95s/epoch, loss=1.14, accuracy=0.757, val_loss=1.5, val_accuracy=0.634, lr=0.1]
Using real-time data augmentation.
Test score: 1.4099316596984863
Test accuracy: 0.6790000200271606


* * * Run SGD for ID = 20_15. * * *


2024-02-20 07:34:25.417573: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 07:34:32.766045: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 07:34:32.767628: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-20 07:34:32.811013: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:86:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-20 07:34:32.811061: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 07:34:32.816721: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 07:34:32.816796: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-20 07:34:32.821061: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-20 07:34:32.823233: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-20 07:34:32.827529: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-20 07:34:32.830729: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-20 07:34:32.837920: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 07:34:32.838694: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-20 07:34:32.838786: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 07:34:34.363435: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-20 07:34:34.364974: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 07:34:34.365529: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:86:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-20 07:34:34.365586: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 07:34:34.365628: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 07:34:34.365652: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-20 07:34:34.365675: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-20 07:34:34.365698: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-20 07:34:34.365721: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-20 07:34:34.365744: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-20 07:34:34.365767: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 07:34:34.366422: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-20 07:34:34.366468: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 07:34:35.057358: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-20 07:34:35.057422: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-20 07:34:35.057434: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-20 07:34:35.060061: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:86:00.0, compute capability: 6.1)
{'id': '20_15', 'batch_size': 128, 'epochs': 75, 'validation_split': 0.1, 'checkpointing': True, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
x_train shape: (45000, 32, 32, 3)
45000 train samples
5000 validation samples
10000 test samples
y_train shape: (45000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/75 [00:00<?, ?epoch/s]2024-02-20 07:34:35.980542: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-20 07:34:35.993006: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-02-20 07:34:38.245457: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 07:34:38.594427: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 07:34:39.554938: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-20 07:34:39.608736: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|▏         | 1/75 [01:01<1:16:06, 61.70s/epoch, loss=3.3, accuracy=0.287, val_loss=2.89, val_accuracy=0.15, lr=0.1]  3%|▎         | 2/75 [01:29<50:28, 41.48s/epoch, loss=1.63, accuracy=0.501, val_loss=1.6, val_accuracy=0.522, lr=0.1]   4%|▍         | 3/75 [01:54<41:11, 34.32s/epoch, loss=1.36, accuracy=0.628, val_loss=4.16, val_accuracy=0.313, lr=0.1]  5%|▌         | 4/75 [02:22<37:26, 31.64s/epoch, loss=1.29, accuracy=0.672, val_loss=3.07, val_accuracy=0.27, lr=0.1]   7%|▋         | 5/75 [02:50<35:14, 30.21s/epoch, loss=1.26, accuracy=0.693, val_loss=1.84, val_accuracy=0.502, lr=0.1]  8%|▊         | 6/75 [03:18<33:57, 29.52s/epoch, loss=1.25, accuracy=0.706, val_loss=1.69, val_accuracy=0.549, lr=0.1]  9%|▉         | 7/75 [03:45<32:47, 28.94s/epoch, loss=1.23, accuracy=0.712, val_loss=1.64, val_accuracy=0.557, lr=0.0316] 11%|█         | 8/75 [04:13<31:52, 28.55s/epoch, loss=1.22, accuracy=0.72, val_loss=1.59, val_accuracy=0.587, lr=0.1]     12%|█▏        | 9/75 [04:41<31:02, 28.22s/epoch, loss=1.22, accuracy=0.723, val_loss=1.92, val_accuracy=0.516, lr=0.1] 13%|█▎        | 10/75 [05:08<30:23, 28.05s/epoch, loss=1.21, accuracy=0.73, val_loss=1.98, val_accuracy=0.496, lr=0.1] 15%|█▍        | 11/75 [05:36<29:48, 27.94s/epoch, loss=1.21, accuracy=0.729, val_loss=1.88, val_accuracy=0.519, lr=0.1] 16%|█▌        | 12/75 [06:04<29:17, 27.90s/epoch, loss=1.2, accuracy=0.73, val_loss=1.6, val_accuracy=0.583, lr=0.1]    17%|█▋        | 13/75 [06:32<28:45, 27.83s/epoch, loss=1.2, accuracy=0.734, val_loss=1.89, val_accuracy=0.498, lr=0.0316] 19%|█▊        | 14/75 [06:59<28:11, 27.73s/epoch, loss=1.19, accuracy=0.737, val_loss=1.89, val_accuracy=0.531, lr=0.1]   20%|██        | 15/75 [07:27<27:41, 27.70s/epoch, loss=1.19, accuracy=0.738, val_loss=1.73, val_accuracy=0.589, lr=0.1] 21%|██▏       | 16/75 [07:54<27:15, 27.72s/epoch, loss=1.19, accuracy=0.738, val_loss=1.71, val_accuracy=0.584, lr=0.1] 23%|██▎       | 17/75 [08:22<26:46, 27.69s/epoch, loss=1.19, accuracy=0.741, val_loss=4.06, val_accuracy=0.263, lr=0.1] 24%|██▍       | 18/75 [08:50<26:16, 27.66s/epoch, loss=1.19, accuracy=0.74, val_loss=1.7, val_accuracy=0.564, lr=0.0316] 25%|██▌       | 19/75 [09:17<25:49, 27.68s/epoch, loss=1.19, accuracy=0.738, val_loss=1.76, val_accuracy=0.536, lr=0.1]  27%|██▋       | 20/75 [09:45<25:21, 27.67s/epoch, loss=1.18, accuracy=0.742, val_loss=1.86, val_accuracy=0.516, lr=0.1] 28%|██▊       | 21/75 [10:13<24:54, 27.68s/epoch, loss=1.18, accuracy=0.741, val_loss=1.91, val_accuracy=0.516, lr=0.1] 29%|██▉       | 22/75 [10:41<24:31, 27.76s/epoch, loss=1.18, accuracy=0.739, val_loss=1.41, val_accuracy=0.683, lr=0.1] 31%|███       | 23/75 [11:08<23:58, 27.67s/epoch, loss=1.18, accuracy=0.743, val_loss=2.07, val_accuracy=0.476, lr=0.1] 32%|███▏      | 24/75 [11:36<23:32, 27.70s/epoch, loss=1.18, accuracy=0.744, val_loss=2.94, val_accuracy=0.359, lr=0.1] 33%|███▎      | 25/75 [12:03<23:02, 27.65s/epoch, loss=1.18, accuracy=0.744, val_loss=4.85, val_accuracy=0.205, lr=0.1] 35%|███▍      | 26/75 [12:31<22:35, 27.66s/epoch, loss=1.18, accuracy=0.745, val_loss=1.86, val_accuracy=0.538, lr=0.1] 36%|███▌      | 27/75 [12:59<22:10, 27.72s/epoch, loss=1.17, accuracy=0.748, val_loss=1.66, val_accuracy=0.573, lr=0.0316] 37%|███▋      | 28/75 [13:27<21:43, 27.73s/epoch, loss=1.17, accuracy=0.745, val_loss=1.49, val_accuracy=0.629, lr=0.1]    39%|███▊      | 29/75 [13:54<21:16, 27.74s/epoch, loss=1.17, accuracy=0.746, val_loss=1.52, val_accuracy=0.637, lr=0.1] 40%|████      | 30/75 [14:22<20:50, 27.78s/epoch, loss=1.17, accuracy=0.746, val_loss=2.58, val_accuracy=0.404, lr=0.1] 41%|████▏     | 31/75 [14:50<20:21, 27.75s/epoch, loss=1.16, accuracy=0.747, val_loss=1.67, val_accuracy=0.602, lr=0.1] 43%|████▎     | 32/75 [15:18<19:52, 27.73s/epoch, loss=1.16, accuracy=0.748, val_loss=1.44, val_accuracy=0.648, lr=0.0316] 44%|████▍     | 33/75 [15:45<19:23, 27.71s/epoch, loss=1.16, accuracy=0.747, val_loss=2.16, val_accuracy=0.434, lr=0.1]    45%|████▌     | 34/75 [16:13<18:56, 27.71s/epoch, loss=1.17, accuracy=0.747, val_loss=1.74, val_accuracy=0.584, lr=0.1] 47%|████▋     | 35/75 [16:41<18:30, 27.76s/epoch, loss=1.16, accuracy=0.748, val_loss=1.77, val_accuracy=0.519, lr=0.1] 48%|████▊     | 36/75 [17:08<17:58, 27.65s/epoch, loss=1.17, accuracy=0.749, val_loss=1.51, val_accuracy=0.625, lr=0.1] 49%|████▉     | 37/75 [17:36<17:31, 27.66s/epoch, loss=1.17, accuracy=0.745, val_loss=1.47, val_accuracy=0.645, lr=0.0316] 51%|█████     | 38/75 [18:04<17:04, 27.69s/epoch, loss=1.16, accuracy=0.75, val_loss=1.53, val_accuracy=0.623, lr=0.1]     52%|█████▏    | 39/75 [18:32<16:37, 27.71s/epoch, loss=1.16, accuracy=0.748, val_loss=1.54, val_accuracy=0.616, lr=0.1] 53%|█████▎    | 40/75 [18:59<16:10, 27.73s/epoch, loss=1.16, accuracy=0.749, val_loss=2.85, val_accuracy=0.378, lr=0.1] 55%|█████▍    | 41/75 [19:27<15:43, 27.75s/epoch, loss=1.16, accuracy=0.749, val_loss=1.94, val_accuracy=0.52, lr=0.1]  56%|█████▌    | 42/75 [19:55<15:16, 27.76s/epoch, loss=1.16, accuracy=0.747, val_loss=2.09, val_accuracy=0.489, lr=0.0316] 57%|█████▋    | 43/75 [20:23<14:49, 27.80s/epoch, loss=1.15, accuracy=0.751, val_loss=1.57, val_accuracy=0.595, lr=0.1]    59%|█████▊    | 44/75 [20:51<14:21, 27.79s/epoch, loss=1.15, accuracy=0.749, val_loss=1.47, val_accuracy=0.64, lr=0.1]  60%|██████    | 45/75 [21:18<13:53, 27.77s/epoch, loss=1.15, accuracy=0.751, val_loss=2.15, val_accuracy=0.452, lr=0.1] 61%|██████▏   | 46/75 [21:46<13:24, 27.75s/epoch, loss=1.16, accuracy=0.75, val_loss=3.16, val_accuracy=0.361, lr=0.1]  63%|██████▎   | 47/75 [22:14<12:56, 27.72s/epoch, loss=1.15, accuracy=0.75, val_loss=3.45, val_accuracy=0.341, lr=0.0316] 64%|██████▍   | 48/75 [22:41<12:27, 27.69s/epoch, loss=1.15, accuracy=0.753, val_loss=1.69, val_accuracy=0.55, lr=0.1]    65%|██████▌   | 49/75 [23:09<11:59, 27.68s/epoch, loss=1.15, accuracy=0.751, val_loss=2.19, val_accuracy=0.441, lr=0.1] 67%|██████▋   | 50/75 [23:37<11:31, 27.66s/epoch, loss=1.15, accuracy=0.749, val_loss=2.14, val_accuracy=0.479, lr=0.1] 68%|██████▊   | 51/75 [24:04<11:03, 27.66s/epoch, loss=1.15, accuracy=0.752, val_loss=2.04, val_accuracy=0.508, lr=0.1] 69%|██████▉   | 52/75 [24:32<10:35, 27.62s/epoch, loss=1.15, accuracy=0.748, val_loss=2.24, val_accuracy=0.453, lr=0.0316] 71%|███████   | 53/75 [24:59<10:06, 27.58s/epoch, loss=1.14, accuracy=0.751, val_loss=1.5, val_accuracy=0.631, lr=0.1]     72%|███████▏  | 54/75 [25:27<09:41, 27.68s/epoch, loss=1.15, accuracy=0.75, val_loss=1.3, val_accuracy=0.707, lr=0.1]  73%|███████▎  | 55/75 [25:55<09:12, 27.60s/epoch, loss=1.15, accuracy=0.751, val_loss=1.61, val_accuracy=0.598, lr=0.1] 75%|███████▍  | 56/75 [26:22<08:43, 27.56s/epoch, loss=1.15, accuracy=0.753, val_loss=1.77, val_accuracy=0.541, lr=0.1] 76%|███████▌  | 57/75 [26:49<08:15, 27.54s/epoch, loss=1.15, accuracy=0.752, val_loss=1.65, val_accuracy=0.566, lr=0.1] 77%|███████▋  | 58/75 [27:17<07:47, 27.52s/epoch, loss=1.14, accuracy=0.754, val_loss=2.75, val_accuracy=0.451, lr=0.1] 79%|███████▊  | 59/75 [27:45<07:20, 27.55s/epoch, loss=1.14, accuracy=0.754, val_loss=1.99, val_accuracy=0.446, lr=0.0316] 80%|████████  | 60/75 [28:12<06:53, 27.54s/epoch, loss=1.14, accuracy=0.751, val_loss=1.88, val_accuracy=0.513, lr=0.1]    81%|████████▏ | 61/75 [28:40<06:25, 27.52s/epoch, loss=1.14, accuracy=0.752, val_loss=2.33, val_accuracy=0.429, lr=0.1] 83%|████████▎ | 62/75 [29:07<05:58, 27.55s/epoch, loss=1.14, accuracy=0.754, val_loss=1.46, val_accuracy=0.641, lr=0.1] 84%|████████▍ | 63/75 [29:35<05:29, 27.48s/epoch, loss=1.14, accuracy=0.752, val_loss=2.25, val_accuracy=0.425, lr=0.1] 85%|████████▌ | 64/75 [30:02<05:02, 27.50s/epoch, loss=1.15, accuracy=0.754, val_loss=2.03, val_accuracy=0.462, lr=0.0316] 87%|████████▋ | 65/75 [30:30<04:35, 27.51s/epoch, loss=1.14, accuracy=0.752, val_loss=2.14, val_accuracy=0.517, lr=0.1]    88%|████████▊ | 66/75 [30:57<04:07, 27.51s/epoch, loss=1.14, accuracy=0.754, val_loss=2.22, val_accuracy=0.455, lr=0.1] 89%|████████▉ | 67/75 [31:24<03:39, 27.47s/epoch, loss=1.14, accuracy=0.754, val_loss=1.81, val_accuracy=0.536, lr=0.1] 91%|█████████ | 68/75 [31:52<03:12, 27.43s/epoch, loss=1.13, accuracy=0.758, val_loss=3.73, val_accuracy=0.333, lr=0.1] 92%|█████████▏| 69/75 [32:19<02:44, 27.43s/epoch, loss=1.14, accuracy=0.757, val_loss=2.03, val_accuracy=0.547, lr=0.0316] 93%|█████████▎| 70/75 [32:47<02:17, 27.43s/epoch, loss=1.13, accuracy=0.755, val_loss=2.63, val_accuracy=0.378, lr=0.1]    95%|█████████▍| 71/75 [33:14<01:49, 27.46s/epoch, loss=1.14, accuracy=0.753, val_loss=1.52, val_accuracy=0.629, lr=0.1] 96%|█████████▌| 72/75 [33:41<01:21, 27.31s/epoch, loss=1.13, accuracy=0.754, val_loss=2.08, val_accuracy=0.477, lr=0.1] 97%|█████████▋| 73/75 [34:09<00:54, 27.37s/epoch, loss=1.14, accuracy=0.756, val_loss=1.7, val_accuracy=0.584, lr=0.1]  99%|█████████▊| 74/75 [34:36<00:27, 27.37s/epoch, loss=1.13, accuracy=0.755, val_loss=1.71, val_accuracy=0.559, lr=0.0316]100%|██████████| 75/75 [35:03<00:00, 27.39s/epoch, loss=1.14, accuracy=0.754, val_loss=1.64, val_accuracy=0.61, lr=0.1]    100%|██████████| 75/75 [35:03<00:00, 28.05s/epoch, loss=1.14, accuracy=0.754, val_loss=1.64, val_accuracy=0.61, lr=0.1]
Using real-time data augmentation.
Test score: 1.3242034912109375
Test accuracy: 0.6965000033378601


* * * Run SGD for ID = 20_16. * * *


2024-02-20 08:09:47.212165: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 08:09:50.866354: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 08:09:50.867923: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-20 08:09:50.912174: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:86:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-20 08:09:50.912227: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 08:09:50.915887: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 08:09:50.915958: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-20 08:09:50.918775: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-20 08:09:50.919633: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-20 08:09:50.922578: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-20 08:09:50.924507: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-20 08:09:50.930487: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 08:09:50.931255: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-20 08:09:50.931343: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 08:09:52.452232: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-20 08:09:52.453889: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 08:09:52.454459: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:86:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-20 08:09:52.454496: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 08:09:52.454533: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 08:09:52.454548: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-20 08:09:52.454562: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-20 08:09:52.454576: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-20 08:09:52.454591: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-20 08:09:52.454605: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-20 08:09:52.454619: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 08:09:52.455207: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-20 08:09:52.455255: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 08:09:53.162159: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-20 08:09:53.162252: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-20 08:09:53.162267: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-20 08:09:53.164156: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:86:00.0, compute capability: 6.1)
{'id': '20_16', 'batch_size': 128, 'epochs': 75, 'validation_split': 0.1, 'checkpointing': True, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
x_train shape: (45000, 32, 32, 3)
45000 train samples
5000 validation samples
10000 test samples
y_train shape: (45000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/75 [00:00<?, ?epoch/s]2024-02-20 08:09:54.083673: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-20 08:09:54.096040: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-02-20 08:09:56.311007: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 08:09:56.666378: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 08:09:57.516586: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-20 08:09:57.582456: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|▏         | 1/75 [01:03<1:18:31, 63.66s/epoch, loss=3.6, accuracy=0.269, val_loss=2.78, val_accuracy=0.149, lr=0.1]  3%|▎         | 2/75 [01:31<51:51, 42.62s/epoch, loss=1.74, accuracy=0.453, val_loss=1.84, val_accuracy=0.41, lr=0.1]    4%|▍         | 3/75 [01:59<43:02, 35.86s/epoch, loss=1.54, accuracy=0.537, val_loss=2.09, val_accuracy=0.412, lr=0.1]  5%|▌         | 4/75 [02:26<38:29, 32.53s/epoch, loss=1.44, accuracy=0.601, val_loss=2.36, val_accuracy=0.347, lr=0.1]  7%|▋         | 5/75 [02:54<35:56, 30.81s/epoch, loss=1.38, accuracy=0.642, val_loss=3.35, val_accuracy=0.315, lr=0.1]  8%|▊         | 6/75 [03:22<34:19, 29.85s/epoch, loss=1.35, accuracy=0.661, val_loss=2.25, val_accuracy=0.456, lr=0.1]  9%|▉         | 7/75 [03:50<33:03, 29.18s/epoch, loss=1.33, accuracy=0.674, val_loss=1.58, val_accuracy=0.6, lr=0.1]   11%|█         | 8/75 [04:17<32:00, 28.66s/epoch, loss=1.31, accuracy=0.688, val_loss=3.43, val_accuracy=0.317, lr=0.1] 12%|█▏        | 9/75 [04:45<31:10, 28.34s/epoch, loss=1.29, accuracy=0.696, val_loss=1.75, val_accuracy=0.577, lr=0.1] 13%|█▎        | 10/75 [05:13<30:25, 28.09s/epoch, loss=1.28, accuracy=0.702, val_loss=1.93, val_accuracy=0.529, lr=0.1] 15%|█▍        | 11/75 [05:40<29:49, 27.95s/epoch, loss=1.26, accuracy=0.709, val_loss=1.85, val_accuracy=0.53, lr=0.1]  16%|█▌        | 12/75 [06:08<29:18, 27.91s/epoch, loss=1.26, accuracy=0.712, val_loss=1.63, val_accuracy=0.586, lr=0.0316] 17%|█▋        | 13/75 [06:36<28:47, 27.86s/epoch, loss=1.25, accuracy=0.715, val_loss=1.84, val_accuracy=0.559, lr=0.1]    19%|█▊        | 14/75 [07:04<28:17, 27.83s/epoch, loss=1.24, accuracy=0.719, val_loss=2.21, val_accuracy=0.476, lr=0.1] 20%|██        | 15/75 [07:31<27:43, 27.72s/epoch, loss=1.24, accuracy=0.722, val_loss=2.85, val_accuracy=0.42, lr=0.1]  21%|██▏       | 16/75 [07:59<27:15, 27.73s/epoch, loss=1.22, accuracy=0.722, val_loss=1.87, val_accuracy=0.544, lr=0.1] 23%|██▎       | 17/75 [08:27<26:53, 27.81s/epoch, loss=1.23, accuracy=0.724, val_loss=1.51, val_accuracy=0.639, lr=0.1] 24%|██▍       | 18/75 [08:54<26:20, 27.73s/epoch, loss=1.23, accuracy=0.724, val_loss=2.19, val_accuracy=0.52, lr=0.1]  25%|██▌       | 19/75 [09:22<25:49, 27.66s/epoch, loss=1.22, accuracy=0.725, val_loss=1.73, val_accuracy=0.575, lr=0.1] 27%|██▋       | 20/75 [09:49<25:20, 27.65s/epoch, loss=1.22, accuracy=0.725, val_loss=1.76, val_accuracy=0.567, lr=0.1] 28%|██▊       | 21/75 [10:17<24:54, 27.68s/epoch, loss=1.21, accuracy=0.732, val_loss=1.92, val_accuracy=0.511, lr=0.1] 29%|██▉       | 22/75 [10:45<24:29, 27.73s/epoch, loss=1.21, accuracy=0.732, val_loss=2.01, val_accuracy=0.531, lr=0.0316] 31%|███       | 23/75 [11:13<24:00, 27.71s/epoch, loss=1.21, accuracy=0.734, val_loss=2.69, val_accuracy=0.398, lr=0.1]    32%|███▏      | 24/75 [11:40<23:33, 27.72s/epoch, loss=1.21, accuracy=0.733, val_loss=2.84, val_accuracy=0.43, lr=0.1]  33%|███▎      | 25/75 [12:08<23:06, 27.72s/epoch, loss=1.21, accuracy=0.732, val_loss=1.57, val_accuracy=0.606, lr=0.1] 35%|███▍      | 26/75 [12:36<22:37, 27.71s/epoch, loss=1.2, accuracy=0.736, val_loss=3.13, val_accuracy=0.429, lr=0.1]  36%|███▌      | 27/75 [13:04<22:11, 27.73s/epoch, loss=1.2, accuracy=0.738, val_loss=1.81, val_accuracy=0.548, lr=0.0316] 37%|███▋      | 28/75 [13:31<21:42, 27.72s/epoch, loss=1.2, accuracy=0.738, val_loss=3.28, val_accuracy=0.391, lr=0.1]    39%|███▊      | 29/75 [13:59<21:18, 27.78s/epoch, loss=1.2, accuracy=0.737, val_loss=1.94, val_accuracy=0.525, lr=0.1] 40%|████      | 30/75 [14:27<20:50, 27.79s/epoch, loss=1.21, accuracy=0.736, val_loss=1.47, val_accuracy=0.63, lr=0.1] 41%|████▏     | 31/75 [14:55<20:21, 27.76s/epoch, loss=1.2, accuracy=0.738, val_loss=3.26, val_accuracy=0.393, lr=0.1] 43%|████▎     | 32/75 [15:23<19:54, 27.78s/epoch, loss=1.19, accuracy=0.738, val_loss=1.98, val_accuracy=0.576, lr=0.1] 44%|████▍     | 33/75 [15:50<19:24, 27.72s/epoch, loss=1.19, accuracy=0.738, val_loss=2.73, val_accuracy=0.361, lr=0.1] 45%|████▌     | 34/75 [16:18<18:55, 27.70s/epoch, loss=1.18, accuracy=0.74, val_loss=2.01, val_accuracy=0.495, lr=0.1]  47%|████▋     | 35/75 [16:45<18:27, 27.69s/epoch, loss=1.18, accuracy=0.741, val_loss=1.96, val_accuracy=0.559, lr=0.0316] 48%|████▊     | 36/75 [17:13<18:00, 27.71s/epoch, loss=1.18, accuracy=0.74, val_loss=1.9, val_accuracy=0.537, lr=0.1]      49%|████▉     | 37/75 [17:41<17:28, 27.59s/epoch, loss=1.18, accuracy=0.742, val_loss=1.93, val_accuracy=0.526, lr=0.1] 51%|█████     | 38/75 [18:08<17:04, 27.68s/epoch, loss=1.18, accuracy=0.744, val_loss=2.3, val_accuracy=0.44, lr=0.1]   52%|█████▏    | 39/75 [18:36<16:35, 27.65s/epoch, loss=1.18, accuracy=0.741, val_loss=2.73, val_accuracy=0.41, lr=0.1] 53%|█████▎    | 40/75 [19:04<16:08, 27.67s/epoch, loss=1.17, accuracy=0.741, val_loss=2.24, val_accuracy=0.473, lr=0.0316] 55%|█████▍    | 41/75 [19:31<15:38, 27.60s/epoch, loss=1.17, accuracy=0.744, val_loss=2.25, val_accuracy=0.474, lr=0.1]    56%|█████▌    | 42/75 [19:59<15:10, 27.59s/epoch, loss=1.18, accuracy=0.742, val_loss=1.96, val_accuracy=0.471, lr=0.1] 57%|█████▋    | 43/75 [20:26<14:44, 27.65s/epoch, loss=1.18, accuracy=0.742, val_loss=2.54, val_accuracy=0.421, lr=0.1] 59%|█████▊    | 44/75 [20:54<14:18, 27.68s/epoch, loss=1.16, accuracy=0.745, val_loss=1.9, val_accuracy=0.525, lr=0.1]  60%|██████    | 45/75 [21:22<13:51, 27.72s/epoch, loss=1.17, accuracy=0.744, val_loss=1.56, val_accuracy=0.631, lr=0.0316] 61%|██████▏   | 46/75 [21:50<13:23, 27.70s/epoch, loss=1.17, accuracy=0.746, val_loss=2.35, val_accuracy=0.475, lr=0.1]    63%|██████▎   | 47/75 [22:18<12:59, 27.82s/epoch, loss=1.17, accuracy=0.746, val_loss=1.34, val_accuracy=0.687, lr=0.1] 64%|██████▍   | 48/75 [22:46<12:30, 27.80s/epoch, loss=1.17, accuracy=0.744, val_loss=1.97, val_accuracy=0.588, lr=0.1] 65%|██████▌   | 49/75 [23:13<11:56, 27.58s/epoch, loss=1.17, accuracy=0.747, val_loss=1.51, val_accuracy=0.646, lr=0.1] 67%|██████▋   | 50/75 [23:40<11:30, 27.61s/epoch, loss=1.17, accuracy=0.745, val_loss=1.85, val_accuracy=0.506, lr=0.1] 68%|██████▊   | 51/75 [24:08<11:03, 27.63s/epoch, loss=1.17, accuracy=0.745, val_loss=2.01, val_accuracy=0.515, lr=0.1] 69%|██████▉   | 52/75 [24:36<10:35, 27.62s/epoch, loss=1.16, accuracy=0.747, val_loss=3, val_accuracy=0.288, lr=0.0316] 71%|███████   | 53/75 [25:04<10:10, 27.74s/epoch, loss=1.17, accuracy=0.745, val_loss=1.72, val_accuracy=0.576, lr=0.1] 72%|███████▏  | 54/75 [25:31<09:42, 27.76s/epoch, loss=1.17, accuracy=0.746, val_loss=1.94, val_accuracy=0.473, lr=0.1] 73%|███████▎  | 55/75 [25:59<09:14, 27.74s/epoch, loss=1.17, accuracy=0.743, val_loss=1.85, val_accuracy=0.555, lr=0.1] 75%|███████▍  | 56/75 [26:27<08:45, 27.68s/epoch, loss=1.16, accuracy=0.747, val_loss=1.69, val_accuracy=0.597, lr=0.1] 76%|███████▌  | 57/75 [26:54<08:17, 27.66s/epoch, loss=1.16, accuracy=0.747, val_loss=1.84, val_accuracy=0.544, lr=0.0316] 77%|███████▋  | 58/75 [27:22<07:50, 27.66s/epoch, loss=1.16, accuracy=0.744, val_loss=2.37, val_accuracy=0.458, lr=0.1]    79%|███████▊  | 59/75 [27:49<07:21, 27.57s/epoch, loss=1.16, accuracy=0.748, val_loss=1.93, val_accuracy=0.515, lr=0.1] 80%|████████  | 60/75 [28:17<06:53, 27.59s/epoch, loss=1.16, accuracy=0.746, val_loss=1.53, val_accuracy=0.616, lr=0.1] 81%|████████▏ | 61/75 [28:44<06:25, 27.57s/epoch, loss=1.17, accuracy=0.746, val_loss=2.27, val_accuracy=0.435, lr=0.1] 83%|████████▎ | 62/75 [29:12<05:59, 27.62s/epoch, loss=1.16, accuracy=0.748, val_loss=1.73, val_accuracy=0.553, lr=0.0316] 84%|████████▍ | 63/75 [29:40<05:31, 27.64s/epoch, loss=1.16, accuracy=0.748, val_loss=1.87, val_accuracy=0.546, lr=0.1]    85%|████████▌ | 64/75 [30:07<05:04, 27.64s/epoch, loss=1.16, accuracy=0.75, val_loss=1.8, val_accuracy=0.584, lr=0.1]   87%|████████▋ | 65/75 [30:35<04:36, 27.69s/epoch, loss=1.16, accuracy=0.749, val_loss=1.84, val_accuracy=0.53, lr=0.1] 88%|████████▊ | 66/75 [31:03<04:08, 27.63s/epoch, loss=1.16, accuracy=0.75, val_loss=2.51, val_accuracy=0.417, lr=0.1] 89%|████████▉ | 67/75 [31:30<03:41, 27.63s/epoch, loss=1.15, accuracy=0.75, val_loss=2.17, val_accuracy=0.445, lr=0.0316] 91%|█████████ | 68/75 [31:58<03:13, 27.59s/epoch, loss=1.16, accuracy=0.749, val_loss=3.2, val_accuracy=0.358, lr=0.1]    92%|█████████▏| 69/75 [32:26<02:45, 27.60s/epoch, loss=1.16, accuracy=0.749, val_loss=1.87, val_accuracy=0.46, lr=0.1] 93%|█████████▎| 70/75 [32:53<02:17, 27.53s/epoch, loss=1.15, accuracy=0.75, val_loss=1.63, val_accuracy=0.561, lr=0.1] 95%|█████████▍| 71/75 [33:20<01:49, 27.34s/epoch, loss=1.16, accuracy=0.749, val_loss=1.44, val_accuracy=0.646, lr=0.1] 96%|█████████▌| 72/75 [33:47<01:22, 27.41s/epoch, loss=1.15, accuracy=0.75, val_loss=4.19, val_accuracy=0.295, lr=0.0316] 97%|█████████▋| 73/75 [34:15<00:54, 27.44s/epoch, loss=1.16, accuracy=0.749, val_loss=1.81, val_accuracy=0.545, lr=0.1]   99%|█████████▊| 74/75 [34:43<00:27, 27.53s/epoch, loss=1.15, accuracy=0.754, val_loss=1.92, val_accuracy=0.471, lr=0.1]100%|██████████| 75/75 [35:10<00:00, 27.51s/epoch, loss=1.15, accuracy=0.747, val_loss=2.41, val_accuracy=0.459, lr=0.1]100%|██████████| 75/75 [35:10<00:00, 28.14s/epoch, loss=1.15, accuracy=0.747, val_loss=2.41, val_accuracy=0.459, lr=0.1]
Using real-time data augmentation.
Test score: 1.3781832456588745
Test accuracy: 0.6786999702453613


* * * Run SGD for ID = 20_17. * * *


2024-02-20 08:45:11.714349: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 08:45:14.487972: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 08:45:14.489146: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-20 08:45:14.533297: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:86:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-20 08:45:14.533347: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 08:45:14.536906: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 08:45:14.536995: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-20 08:45:14.539624: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-20 08:45:14.540915: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-20 08:45:14.543719: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-20 08:45:14.545361: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-20 08:45:14.550507: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 08:45:14.551212: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-20 08:45:14.551301: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 08:45:15.999361: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-20 08:45:16.000457: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 08:45:16.001063: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:86:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-20 08:45:16.001115: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 08:45:16.001160: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 08:45:16.001183: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-20 08:45:16.001206: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-20 08:45:16.001229: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-20 08:45:16.001252: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-20 08:45:16.001274: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-20 08:45:16.001297: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 08:45:16.001990: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-20 08:45:16.002035: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 08:45:16.664024: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-20 08:45:16.664106: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-20 08:45:16.664119: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-20 08:45:16.665937: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:86:00.0, compute capability: 6.1)
{'id': '20_17', 'batch_size': 128, 'epochs': 75, 'validation_split': 0.1, 'checkpointing': True, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
x_train shape: (45000, 32, 32, 3)
45000 train samples
5000 validation samples
10000 test samples
y_train shape: (45000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/75 [00:00<?, ?epoch/s]2024-02-20 08:45:17.576241: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-20 08:45:17.588048: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-02-20 08:45:19.724279: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 08:45:20.045676: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 08:45:20.865037: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-20 08:45:20.906325: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|▏         | 1/75 [00:59<1:13:15, 59.40s/epoch, loss=3.32, accuracy=0.296, val_loss=2.27, val_accuracy=0.299, lr=0.1]  3%|▎         | 2/75 [01:27<50:04, 41.16s/epoch, loss=1.64, accuracy=0.503, val_loss=2.1, val_accuracy=0.394, lr=0.1]     4%|▍         | 3/75 [01:55<42:10, 35.15s/epoch, loss=1.42, accuracy=0.604, val_loss=2.03, val_accuracy=0.458, lr=0.1]  5%|▌         | 4/75 [02:23<38:13, 32.30s/epoch, loss=1.32, accuracy=0.659, val_loss=1.59, val_accuracy=0.576, lr=0.1]  7%|▋         | 5/75 [02:51<35:43, 30.62s/epoch, loss=1.28, accuracy=0.686, val_loss=2.72, val_accuracy=0.324, lr=0.1]  8%|▊         | 6/75 [03:19<34:06, 29.66s/epoch, loss=1.25, accuracy=0.702, val_loss=1.86, val_accuracy=0.507, lr=0.1]  9%|▉         | 7/75 [03:46<32:50, 28.98s/epoch, loss=1.23, accuracy=0.709, val_loss=1.79, val_accuracy=0.538, lr=0.1] 11%|█         | 8/75 [04:14<31:54, 28.57s/epoch, loss=1.23, accuracy=0.716, val_loss=2.01, val_accuracy=0.425, lr=0.1] 12%|█▏        | 9/75 [04:42<31:06, 28.28s/epoch, loss=1.21, accuracy=0.72, val_loss=2.61, val_accuracy=0.413, lr=0.0316] 13%|█▎        | 10/75 [05:09<30:28, 28.14s/epoch, loss=1.21, accuracy=0.725, val_loss=2.18, val_accuracy=0.483, lr=0.1]  15%|█▍        | 11/75 [05:38<30:03, 28.19s/epoch, loss=1.21, accuracy=0.728, val_loss=1.73, val_accuracy=0.578, lr=0.1] 16%|█▌        | 12/75 [06:05<29:26, 28.04s/epoch, loss=1.2, accuracy=0.731, val_loss=2.64, val_accuracy=0.436, lr=0.1]  17%|█▋        | 13/75 [06:33<28:51, 27.92s/epoch, loss=1.2, accuracy=0.735, val_loss=2.3, val_accuracy=0.387, lr=0.1]  19%|█▊        | 14/75 [07:01<28:26, 27.98s/epoch, loss=1.19, accuracy=0.736, val_loss=2.42, val_accuracy=0.45, lr=0.0316] 20%|██        | 15/75 [07:29<27:57, 27.96s/epoch, loss=1.19, accuracy=0.736, val_loss=1.38, val_accuracy=0.669, lr=0.1]   21%|██▏       | 16/75 [07:56<27:18, 27.77s/epoch, loss=1.18, accuracy=0.742, val_loss=1.72, val_accuracy=0.562, lr=0.1] 23%|██▎       | 17/75 [08:24<26:49, 27.76s/epoch, loss=1.17, accuracy=0.742, val_loss=1.62, val_accuracy=0.578, lr=0.1] 24%|██▍       | 18/75 [08:52<26:27, 27.85s/epoch, loss=1.17, accuracy=0.744, val_loss=1.39, val_accuracy=0.675, lr=0.1] 25%|██▌       | 19/75 [09:20<25:55, 27.78s/epoch, loss=1.16, accuracy=0.745, val_loss=1.8, val_accuracy=0.526, lr=0.1]  27%|██▋       | 20/75 [09:47<25:26, 27.75s/epoch, loss=1.17, accuracy=0.747, val_loss=1.88, val_accuracy=0.533, lr=0.0316] 28%|██▊       | 21/75 [10:15<24:59, 27.78s/epoch, loss=1.16, accuracy=0.744, val_loss=1.72, val_accuracy=0.585, lr=0.1]    29%|██▉       | 22/75 [10:43<24:35, 27.84s/epoch, loss=1.15, accuracy=0.749, val_loss=1.67, val_accuracy=0.565, lr=0.1] 31%|███       | 23/75 [11:11<24:05, 27.80s/epoch, loss=1.15, accuracy=0.747, val_loss=2.33, val_accuracy=0.505, lr=0.1] 32%|███▏      | 24/75 [11:39<23:38, 27.81s/epoch, loss=1.15, accuracy=0.748, val_loss=2.08, val_accuracy=0.455, lr=0.1] 33%|███▎      | 25/75 [12:07<23:10, 27.81s/epoch, loss=1.15, accuracy=0.747, val_loss=2.04, val_accuracy=0.495, lr=0.0316] 35%|███▍      | 26/75 [12:34<22:41, 27.79s/epoch, loss=1.16, accuracy=0.748, val_loss=2.83, val_accuracy=0.379, lr=0.1]    36%|███▌      | 27/75 [13:02<22:13, 27.79s/epoch, loss=1.15, accuracy=0.751, val_loss=1.95, val_accuracy=0.464, lr=0.1] 37%|███▋      | 28/75 [13:30<21:45, 27.77s/epoch, loss=1.15, accuracy=0.752, val_loss=2.39, val_accuracy=0.425, lr=0.1] 39%|███▊      | 29/75 [13:58<21:18, 27.79s/epoch, loss=1.14, accuracy=0.753, val_loss=1.86, val_accuracy=0.564, lr=0.1] 40%|████      | 30/75 [14:26<20:51, 27.81s/epoch, loss=1.15, accuracy=0.751, val_loss=2.56, val_accuracy=0.385, lr=0.0316] 41%|████▏     | 31/75 [14:53<20:23, 27.81s/epoch, loss=1.15, accuracy=0.752, val_loss=3.24, val_accuracy=0.4, lr=0.1]      43%|████▎     | 32/75 [15:21<19:57, 27.85s/epoch, loss=1.15, accuracy=0.752, val_loss=2.35, val_accuracy=0.436, lr=0.1] 44%|████▍     | 33/75 [15:49<19:27, 27.81s/epoch, loss=1.15, accuracy=0.751, val_loss=1.87, val_accuracy=0.569, lr=0.1] 45%|████▌     | 34/75 [16:17<19:00, 27.82s/epoch, loss=1.14, accuracy=0.751, val_loss=1.43, val_accuracy=0.646, lr=0.1] 47%|████▋     | 35/75 [16:45<18:31, 27.79s/epoch, loss=1.15, accuracy=0.752, val_loss=1.7, val_accuracy=0.58, lr=0.0316] 48%|████▊     | 36/75 [17:12<18:01, 27.74s/epoch, loss=1.15, accuracy=0.754, val_loss=1.64, val_accuracy=0.606, lr=0.1]  49%|████▉     | 37/75 [17:40<17:35, 27.77s/epoch, loss=1.14, accuracy=0.753, val_loss=1.94, val_accuracy=0.507, lr=0.1] 51%|█████     | 38/75 [18:08<17:07, 27.78s/epoch, loss=1.15, accuracy=0.75, val_loss=2.24, val_accuracy=0.402, lr=0.1]  52%|█████▏    | 39/75 [18:36<16:40, 27.80s/epoch, loss=1.14, accuracy=0.754, val_loss=1.65, val_accuracy=0.632, lr=0.1] 53%|█████▎    | 40/75 [19:03<16:12, 27.78s/epoch, loss=1.14, accuracy=0.752, val_loss=3.34, val_accuracy=0.321, lr=0.0316] 55%|█████▍    | 41/75 [19:31<15:46, 27.82s/epoch, loss=1.14, accuracy=0.75, val_loss=1.81, val_accuracy=0.561, lr=0.1]     56%|█████▌    | 42/75 [19:59<15:18, 27.82s/epoch, loss=1.14, accuracy=0.753, val_loss=2.08, val_accuracy=0.503, lr=0.1] 57%|█████▋    | 43/75 [20:27<14:50, 27.83s/epoch, loss=1.15, accuracy=0.751, val_loss=1.81, val_accuracy=0.528, lr=0.1] 59%|█████▊    | 44/75 [20:55<14:22, 27.81s/epoch, loss=1.14, accuracy=0.754, val_loss=2, val_accuracy=0.524, lr=0.1]    60%|██████    | 45/75 [21:23<13:53, 27.78s/epoch, loss=1.14, accuracy=0.754, val_loss=2.86, val_accuracy=0.42, lr=0.0316] 61%|██████▏   | 46/75 [21:50<13:25, 27.77s/epoch, loss=1.13, accuracy=0.754, val_loss=2, val_accuracy=0.51, lr=0.1]       63%|██████▎   | 47/75 [22:18<12:58, 27.81s/epoch, loss=1.14, accuracy=0.754, val_loss=2.16, val_accuracy=0.498, lr=0.1] 64%|██████▍   | 48/75 [22:46<12:30, 27.78s/epoch, loss=1.14, accuracy=0.752, val_loss=1.7, val_accuracy=0.571, lr=0.1]  65%|██████▌   | 49/75 [23:13<11:59, 27.68s/epoch, loss=1.13, accuracy=0.754, val_loss=2, val_accuracy=0.486, lr=0.1]   67%|██████▋   | 50/75 [23:41<11:33, 27.75s/epoch, loss=1.13, accuracy=0.757, val_loss=1.84, val_accuracy=0.561, lr=0.0316] 68%|██████▊   | 51/75 [24:09<11:06, 27.77s/epoch, loss=1.14, accuracy=0.751, val_loss=2, val_accuracy=0.504, lr=0.1]       69%|██████▉   | 52/75 [24:37<10:37, 27.73s/epoch, loss=1.13, accuracy=0.756, val_loss=1.78, val_accuracy=0.538, lr=0.1] 71%|███████   | 53/75 [25:05<10:10, 27.76s/epoch, loss=1.14, accuracy=0.754, val_loss=1.56, val_accuracy=0.614, lr=0.1] 72%|███████▏  | 54/75 [25:32<09:43, 27.80s/epoch, loss=1.13, accuracy=0.757, val_loss=1.76, val_accuracy=0.612, lr=0.1] 73%|███████▎  | 55/75 [26:00<09:15, 27.77s/epoch, loss=1.13, accuracy=0.757, val_loss=1.54, val_accuracy=0.623, lr=0.0316] 75%|███████▍  | 56/75 [26:28<08:48, 27.80s/epoch, loss=1.13, accuracy=0.755, val_loss=1.7, val_accuracy=0.546, lr=0.1]     76%|███████▌  | 57/75 [26:56<08:19, 27.76s/epoch, loss=1.13, accuracy=0.756, val_loss=3.4, val_accuracy=0.201, lr=0.1] 77%|███████▋  | 58/75 [27:23<07:51, 27.73s/epoch, loss=1.14, accuracy=0.757, val_loss=2.19, val_accuracy=0.488, lr=0.1] 79%|███████▊  | 59/75 [27:51<07:23, 27.74s/epoch, loss=1.13, accuracy=0.754, val_loss=1.76, val_accuracy=0.594, lr=0.1] 80%|████████  | 60/75 [28:19<06:54, 27.65s/epoch, loss=1.13, accuracy=0.758, val_loss=2.27, val_accuracy=0.426, lr=0.0316] 81%|████████▏ | 61/75 [28:46<06:27, 27.68s/epoch, loss=1.14, accuracy=0.756, val_loss=2.31, val_accuracy=0.43, lr=0.1]     83%|████████▎ | 62/75 [29:14<05:59, 27.67s/epoch, loss=1.13, accuracy=0.755, val_loss=2.43, val_accuracy=0.455, lr=0.1] 84%|████████▍ | 63/75 [29:40<05:26, 27.24s/epoch, loss=1.13, accuracy=0.756, val_loss=4.97, val_accuracy=0.245, lr=0.1] 85%|████████▌ | 64/75 [30:06<04:55, 26.86s/epoch, loss=1.13, accuracy=0.756, val_loss=1.66, val_accuracy=0.6, lr=0.1]   87%|████████▋ | 65/75 [30:32<04:24, 26.43s/epoch, loss=1.13, accuracy=0.755, val_loss=1.89, val_accuracy=0.502, lr=0.0316] 88%|████████▊ | 66/75 [30:59<04:00, 26.69s/epoch, loss=1.13, accuracy=0.758, val_loss=1.79, val_accuracy=0.577, lr=0.1]    89%|████████▉ | 67/75 [31:26<03:33, 26.72s/epoch, loss=1.12, accuracy=0.757, val_loss=1.99, val_accuracy=0.524, lr=0.1] 91%|█████████ | 68/75 [31:51<03:05, 26.44s/epoch, loss=1.13, accuracy=0.759, val_loss=1.88, val_accuracy=0.564, lr=0.1] 92%|█████████▏| 69/75 [32:18<02:39, 26.57s/epoch, loss=1.14, accuracy=0.754, val_loss=2.37, val_accuracy=0.417, lr=0.1] 93%|█████████▎| 70/75 [32:45<02:13, 26.75s/epoch, loss=1.12, accuracy=0.755, val_loss=2.38, val_accuracy=0.455, lr=0.0316] 95%|█████████▍| 71/75 [33:13<01:47, 26.85s/epoch, loss=1.12, accuracy=0.757, val_loss=4.06, val_accuracy=0.35, lr=0.1]     96%|█████████▌| 72/75 [33:40<01:20, 26.91s/epoch, loss=1.12, accuracy=0.758, val_loss=2.37, val_accuracy=0.462, lr=0.1] 97%|█████████▋| 73/75 [34:07<00:54, 27.01s/epoch, loss=1.12, accuracy=0.757, val_loss=2.03, val_accuracy=0.513, lr=0.1] 99%|█████████▊| 74/75 [34:33<00:26, 26.71s/epoch, loss=1.12, accuracy=0.757, val_loss=2.06, val_accuracy=0.534, lr=0.1]100%|██████████| 75/75 [35:00<00:00, 26.75s/epoch, loss=1.11, accuracy=0.76, val_loss=3.05, val_accuracy=0.318, lr=0.0316]100%|██████████| 75/75 [35:00<00:00, 28.00s/epoch, loss=1.11, accuracy=0.76, val_loss=3.05, val_accuracy=0.318, lr=0.0316]
Using real-time data augmentation.
Test score: 1.3936419486999512
Test accuracy: 0.671500027179718


* * * Run SGD for ID = 20_18. * * *


2024-02-20 09:20:26.012254: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 09:20:35.139397: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 09:20:35.141685: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-20 09:20:35.184134: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:86:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-20 09:20:35.184178: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 09:20:35.210652: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 09:20:35.210751: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-20 09:20:35.226870: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-20 09:20:35.250333: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-20 09:20:35.268499: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-20 09:20:35.284762: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-20 09:20:35.310556: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 09:20:35.311475: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-20 09:20:35.311596: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 09:20:36.975001: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-20 09:20:36.975672: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 09:20:36.976202: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:86:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-20 09:20:36.976233: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 09:20:36.976267: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 09:20:36.976280: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-20 09:20:36.976292: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-20 09:20:36.976304: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-20 09:20:36.976316: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-20 09:20:36.976329: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-20 09:20:36.976342: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 09:20:36.976878: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-20 09:20:36.976914: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 09:20:38.736636: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-20 09:20:38.736692: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-20 09:20:38.736703: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-20 09:20:38.738316: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:86:00.0, compute capability: 6.1)
{'id': '20_18', 'batch_size': 128, 'epochs': 75, 'validation_split': 0.1, 'checkpointing': True, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
x_train shape: (45000, 32, 32, 3)
45000 train samples
5000 validation samples
10000 test samples
y_train shape: (45000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/75 [00:00<?, ?epoch/s]2024-02-20 09:20:39.603003: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-20 09:20:39.603478: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-02-20 09:20:41.583870: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 09:20:41.999340: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 09:20:43.571087: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-20 09:20:43.617266: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|▏         | 1/75 [01:00<1:14:01, 60.02s/epoch, loss=3.67, accuracy=0.277, val_loss=2.86, val_accuracy=0.154, lr=0.1]  3%|▎         | 2/75 [01:25<48:23, 39.78s/epoch, loss=1.67, accuracy=0.488, val_loss=2.36, val_accuracy=0.328, lr=0.1]    4%|▍         | 3/75 [01:51<40:20, 33.62s/epoch, loss=1.42, accuracy=0.598, val_loss=1.59, val_accuracy=0.557, lr=0.1]  5%|▌         | 4/75 [02:19<36:53, 31.18s/epoch, loss=1.33, accuracy=0.658, val_loss=2.06, val_accuracy=0.5, lr=0.1]    7%|▋         | 5/75 [02:46<34:47, 29.82s/epoch, loss=1.28, accuracy=0.685, val_loss=2.08, val_accuracy=0.475, lr=0.1]  8%|▊         | 6/75 [03:13<33:09, 28.83s/epoch, loss=1.25, accuracy=0.702, val_loss=3.33, val_accuracy=0.413, lr=0.1]  9%|▉         | 7/75 [03:40<31:45, 28.02s/epoch, loss=1.25, accuracy=0.708, val_loss=1.68, val_accuracy=0.537, lr=0.1] 11%|█         | 8/75 [04:07<30:56, 27.70s/epoch, loss=1.23, accuracy=0.716, val_loss=2.04, val_accuracy=0.538, lr=0.0316] 12%|█▏        | 9/75 [04:34<30:19, 27.56s/epoch, loss=1.22, accuracy=0.721, val_loss=1.63, val_accuracy=0.597, lr=0.1]    13%|█▎        | 10/75 [05:00<29:17, 27.04s/epoch, loss=1.21, accuracy=0.723, val_loss=1.89, val_accuracy=0.514, lr=0.1] 15%|█▍        | 11/75 [05:25<28:09, 26.40s/epoch, loss=1.21, accuracy=0.725, val_loss=1.94, val_accuracy=0.463, lr=0.1] 16%|█▌        | 12/75 [05:52<28:00, 26.67s/epoch, loss=1.19, accuracy=0.733, val_loss=1.82, val_accuracy=0.585, lr=0.1] 17%|█▋        | 13/75 [06:17<27:02, 26.18s/epoch, loss=1.18, accuracy=0.733, val_loss=1.9, val_accuracy=0.499, lr=0.0316] 19%|█▊        | 14/75 [06:42<26:12, 25.78s/epoch, loss=1.18, accuracy=0.735, val_loss=1.93, val_accuracy=0.491, lr=0.1]   20%|██        | 15/75 [07:08<25:56, 25.94s/epoch, loss=1.18, accuracy=0.733, val_loss=1.7, val_accuracy=0.564, lr=0.1]  21%|██▏       | 16/75 [07:36<25:59, 26.43s/epoch, loss=1.17, accuracy=0.736, val_loss=1.7, val_accuracy=0.529, lr=0.1] 23%|██▎       | 17/75 [08:03<25:46, 26.66s/epoch, loss=1.17, accuracy=0.739, val_loss=2.36, val_accuracy=0.45, lr=0.1] 24%|██▍       | 18/75 [08:30<25:29, 26.83s/epoch, loss=1.17, accuracy=0.741, val_loss=3.51, val_accuracy=0.337, lr=0.0316] 25%|██▌       | 19/75 [08:57<25:03, 26.85s/epoch, loss=1.17, accuracy=0.742, val_loss=1.95, val_accuracy=0.494, lr=0.1]    27%|██▋       | 20/75 [09:24<24:44, 26.99s/epoch, loss=1.16, accuracy=0.742, val_loss=3.23, val_accuracy=0.337, lr=0.1] 28%|██▊       | 21/75 [09:51<24:17, 26.99s/epoch, loss=1.15, accuracy=0.745, val_loss=4.22, val_accuracy=0.298, lr=0.1] 29%|██▉       | 22/75 [10:18<23:45, 26.90s/epoch, loss=1.16, accuracy=0.744, val_loss=1.63, val_accuracy=0.617, lr=0.1] 31%|███       | 23/75 [10:45<23:24, 27.02s/epoch, loss=1.16, accuracy=0.744, val_loss=2.88, val_accuracy=0.408, lr=0.0316] 32%|███▏      | 24/75 [11:13<23:03, 27.13s/epoch, loss=1.15, accuracy=0.749, val_loss=1.87, val_accuracy=0.528, lr=0.1]    33%|███▎      | 25/75 [11:40<22:36, 27.13s/epoch, loss=1.15, accuracy=0.747, val_loss=1.32, val_accuracy=0.691, lr=0.1] 35%|███▍      | 26/75 [12:07<22:08, 27.11s/epoch, loss=1.15, accuracy=0.75, val_loss=1.75, val_accuracy=0.55, lr=0.1]   36%|███▌      | 27/75 [12:34<21:43, 27.16s/epoch, loss=1.15, accuracy=0.747, val_loss=2.63, val_accuracy=0.449, lr=0.1] 37%|███▋      | 28/75 [13:01<21:05, 26.93s/epoch, loss=1.15, accuracy=0.747, val_loss=1.88, val_accuracy=0.55, lr=0.1]  39%|███▊      | 29/75 [13:28<20:47, 27.11s/epoch, loss=1.14, accuracy=0.751, val_loss=1.92, val_accuracy=0.51, lr=0.1] 40%|████      | 30/75 [13:55<20:12, 26.93s/epoch, loss=1.14, accuracy=0.747, val_loss=1.63, val_accuracy=0.575, lr=0.0316] 41%|████▏     | 31/75 [14:22<19:48, 27.01s/epoch, loss=1.15, accuracy=0.748, val_loss=3.84, val_accuracy=0.344, lr=0.1]    43%|████▎     | 32/75 [14:49<19:21, 27.01s/epoch, loss=1.14, accuracy=0.751, val_loss=1.98, val_accuracy=0.531, lr=0.1] 44%|████▍     | 33/75 [15:16<18:59, 27.13s/epoch, loss=1.14, accuracy=0.75, val_loss=2.25, val_accuracy=0.454, lr=0.1]  45%|████▌     | 34/75 [15:40<17:56, 26.26s/epoch, loss=1.14, accuracy=0.748, val_loss=2.42, val_accuracy=0.433, lr=0.1] 47%|████▋     | 35/75 [16:08<17:44, 26.62s/epoch, loss=1.14, accuracy=0.749, val_loss=2.38, val_accuracy=0.461, lr=0.0316] 48%|████▊     | 36/75 [16:35<17:24, 26.79s/epoch, loss=1.15, accuracy=0.749, val_loss=1.82, val_accuracy=0.544, lr=0.1]    49%|████▉     | 37/75 [17:02<17:01, 26.89s/epoch, loss=1.14, accuracy=0.752, val_loss=1.6, val_accuracy=0.594, lr=0.1]  51%|█████     | 38/75 [17:28<16:19, 26.47s/epoch, loss=1.14, accuracy=0.75, val_loss=2.67, val_accuracy=0.329, lr=0.1] 52%|█████▏    | 39/75 [17:55<16:03, 26.77s/epoch, loss=1.14, accuracy=0.753, val_loss=2.03, val_accuracy=0.526, lr=0.1] 53%|█████▎    | 40/75 [18:23<15:43, 26.95s/epoch, loss=1.13, accuracy=0.751, val_loss=2.06, val_accuracy=0.52, lr=0.0316] 55%|█████▍    | 41/75 [18:49<15:08, 26.72s/epoch, loss=1.14, accuracy=0.752, val_loss=2.28, val_accuracy=0.519, lr=0.1]   56%|█████▌    | 42/75 [19:16<14:45, 26.84s/epoch, loss=1.13, accuracy=0.752, val_loss=1.79, val_accuracy=0.582, lr=0.1] 57%|█████▋    | 43/75 [19:43<14:24, 27.01s/epoch, loss=1.13, accuracy=0.752, val_loss=1.5, val_accuracy=0.631, lr=0.1]  59%|█████▊    | 44/75 [20:10<13:58, 27.04s/epoch, loss=1.13, accuracy=0.751, val_loss=1.97, val_accuracy=0.524, lr=0.1] 60%|██████    | 45/75 [20:37<13:30, 27.02s/epoch, loss=1.13, accuracy=0.752, val_loss=1.55, val_accuracy=0.644, lr=0.0316] 61%|██████▏   | 46/75 [21:04<13:03, 27.03s/epoch, loss=1.14, accuracy=0.754, val_loss=2.01, val_accuracy=0.515, lr=0.1]    63%|██████▎   | 47/75 [21:30<12:27, 26.71s/epoch, loss=1.13, accuracy=0.752, val_loss=2.95, val_accuracy=0.36, lr=0.1]  64%|██████▍   | 48/75 [21:55<11:40, 25.94s/epoch, loss=1.13, accuracy=0.753, val_loss=1.52, val_accuracy=0.612, lr=0.1] 65%|██████▌   | 49/75 [22:19<11:03, 25.50s/epoch, loss=1.14, accuracy=0.75, val_loss=1.75, val_accuracy=0.56, lr=0.1]   67%|██████▋   | 50/75 [22:43<10:25, 25.01s/epoch, loss=1.13, accuracy=0.753, val_loss=2.09, val_accuracy=0.487, lr=0.0316] 68%|██████▊   | 51/75 [23:06<09:49, 24.57s/epoch, loss=1.13, accuracy=0.752, val_loss=1.82, val_accuracy=0.497, lr=0.1]    69%|██████▉   | 52/75 [23:30<09:21, 24.40s/epoch, loss=1.13, accuracy=0.75, val_loss=2.36, val_accuracy=0.412, lr=0.1]  71%|███████   | 53/75 [23:54<08:51, 24.16s/epoch, loss=1.13, accuracy=0.751, val_loss=2.08, val_accuracy=0.51, lr=0.1] 72%|███████▏  | 54/75 [24:18<08:26, 24.13s/epoch, loss=1.13, accuracy=0.754, val_loss=3.45, val_accuracy=0.399, lr=0.1] 73%|███████▎  | 55/75 [24:42<07:59, 23.96s/epoch, loss=1.14, accuracy=0.752, val_loss=1.93, val_accuracy=0.545, lr=0.0316] 75%|███████▍  | 56/75 [25:05<07:33, 23.86s/epoch, loss=1.13, accuracy=0.754, val_loss=2.31, val_accuracy=0.487, lr=0.1]    76%|███████▌  | 57/75 [25:29<07:10, 23.91s/epoch, loss=1.13, accuracy=0.756, val_loss=2.74, val_accuracy=0.362, lr=0.1] 77%|███████▋  | 58/75 [25:53<06:45, 23.86s/epoch, loss=1.14, accuracy=0.752, val_loss=2.72, val_accuracy=0.308, lr=0.1] 79%|███████▊  | 59/75 [26:17<06:21, 23.83s/epoch, loss=1.14, accuracy=0.754, val_loss=1.76, val_accuracy=0.557, lr=0.1] 80%|████████  | 60/75 [26:41<05:57, 23.84s/epoch, loss=1.13, accuracy=0.753, val_loss=1.47, val_accuracy=0.676, lr=0.0316] 81%|████████▏ | 61/75 [27:05<05:34, 23.87s/epoch, loss=1.14, accuracy=0.754, val_loss=1.79, val_accuracy=0.567, lr=0.1]    83%|████████▎ | 62/75 [27:28<05:10, 23.89s/epoch, loss=1.13, accuracy=0.751, val_loss=2.18, val_accuracy=0.519, lr=0.1] 84%|████████▍ | 63/75 [27:52<04:46, 23.85s/epoch, loss=1.13, accuracy=0.754, val_loss=1.48, val_accuracy=0.641, lr=0.1] 85%|████████▌ | 64/75 [28:16<04:21, 23.81s/epoch, loss=1.12, accuracy=0.756, val_loss=2.11, val_accuracy=0.48, lr=0.1]  87%|████████▋ | 65/75 [28:40<03:58, 23.85s/epoch, loss=1.13, accuracy=0.753, val_loss=3.63, val_accuracy=0.312, lr=0.0316] 88%|████████▊ | 66/75 [29:04<03:34, 23.80s/epoch, loss=1.12, accuracy=0.755, val_loss=2.05, val_accuracy=0.513, lr=0.1]    89%|████████▉ | 67/75 [29:28<03:12, 24.04s/epoch, loss=1.13, accuracy=0.753, val_loss=2.09, val_accuracy=0.497, lr=0.1] 91%|█████████ | 68/75 [29:53<02:49, 24.15s/epoch, loss=1.13, accuracy=0.752, val_loss=4.65, val_accuracy=0.252, lr=0.1] 92%|█████████▏| 69/75 [30:17<02:24, 24.08s/epoch, loss=1.13, accuracy=0.753, val_loss=2.02, val_accuracy=0.44, lr=0.1]  93%|█████████▎| 70/75 [30:40<01:59, 24.00s/epoch, loss=1.13, accuracy=0.754, val_loss=1.49, val_accuracy=0.623, lr=0.0316] 95%|█████████▍| 71/75 [31:04<01:35, 23.96s/epoch, loss=1.13, accuracy=0.755, val_loss=1.67, val_accuracy=0.636, lr=0.1]    96%|█████████▌| 72/75 [31:28<01:11, 23.88s/epoch, loss=1.13, accuracy=0.755, val_loss=1.66, val_accuracy=0.598, lr=0.1] 97%|█████████▋| 73/75 [31:53<00:48, 24.33s/epoch, loss=1.13, accuracy=0.758, val_loss=1.91, val_accuracy=0.532, lr=0.1] 99%|█████████▊| 74/75 [32:17<00:24, 24.25s/epoch, loss=1.13, accuracy=0.757, val_loss=2.33, val_accuracy=0.445, lr=0.1]100%|██████████| 75/75 [32:41<00:00, 24.10s/epoch, loss=1.13, accuracy=0.755, val_loss=1.42, val_accuracy=0.66, lr=0.0316]100%|██████████| 75/75 [32:41<00:00, 26.15s/epoch, loss=1.13, accuracy=0.755, val_loss=1.42, val_accuracy=0.66, lr=0.0316]
Using real-time data augmentation.
Test score: 1.330919623374939
Test accuracy: 0.6848000288009644


* * * Run SGD for ID = 20_19. * * *


2024-02-20 09:53:29.674786: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 09:53:32.396928: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 09:53:32.398290: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-20 09:53:32.438541: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:86:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-20 09:53:32.438592: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 09:53:32.442151: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 09:53:32.442243: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-20 09:53:32.445023: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-20 09:53:32.446155: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-20 09:53:32.448958: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-20 09:53:32.450901: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-20 09:53:32.456785: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 09:53:32.457563: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-20 09:53:32.457660: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 09:53:33.875102: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-20 09:53:33.876226: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 09:53:33.877385: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:86:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-20 09:53:33.877418: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 09:53:33.877461: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 09:53:33.877474: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-20 09:53:33.877486: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-20 09:53:33.877498: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-20 09:53:33.877512: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-20 09:53:33.877526: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-20 09:53:33.877540: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 09:53:33.878072: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-20 09:53:33.878114: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 09:53:34.513249: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-20 09:53:34.513307: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-20 09:53:34.513319: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-20 09:53:34.514476: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:86:00.0, compute capability: 6.1)
{'id': '20_19', 'batch_size': 128, 'epochs': 75, 'validation_split': 0.1, 'checkpointing': True, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
x_train shape: (45000, 32, 32, 3)
45000 train samples
5000 validation samples
10000 test samples
y_train shape: (45000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/75 [00:00<?, ?epoch/s]2024-02-20 09:53:35.381124: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-20 09:53:35.381728: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-02-20 09:53:37.413901: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 09:53:37.717776: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 09:53:38.491880: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-20 09:53:38.545561: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|▏         | 1/75 [00:59<1:13:56, 59.95s/epoch, loss=3.52, accuracy=0.256, val_loss=2.94, val_accuracy=0.214, lr=0.1]  3%|▎         | 2/75 [01:25<48:05, 39.53s/epoch, loss=1.68, accuracy=0.485, val_loss=1.74, val_accuracy=0.439, lr=0.1]    4%|▍         | 3/75 [01:49<39:11, 32.67s/epoch, loss=1.37, accuracy=0.616, val_loss=1.59, val_accuracy=0.589, lr=0.1]  5%|▌         | 4/75 [02:13<34:28, 29.13s/epoch, loss=1.28, accuracy=0.678, val_loss=2.53, val_accuracy=0.425, lr=0.1]  7%|▋         | 5/75 [02:37<31:56, 27.38s/epoch, loss=1.25, accuracy=0.701, val_loss=1.88, val_accuracy=0.497, lr=0.1]  8%|▊         | 6/75 [03:01<30:06, 26.18s/epoch, loss=1.23, accuracy=0.714, val_loss=1.78, val_accuracy=0.553, lr=0.1]  9%|▉         | 7/75 [03:25<29:00, 25.60s/epoch, loss=1.23, accuracy=0.717, val_loss=2.36, val_accuracy=0.429, lr=0.1] 11%|█         | 8/75 [03:50<28:22, 25.42s/epoch, loss=1.21, accuracy=0.724, val_loss=4.93, val_accuracy=0.193, lr=0.0316] 12%|█▏        | 9/75 [04:15<27:33, 25.05s/epoch, loss=1.21, accuracy=0.726, val_loss=2.63, val_accuracy=0.413, lr=0.1]    13%|█▎        | 10/75 [04:39<26:46, 24.72s/epoch, loss=1.2, accuracy=0.729, val_loss=2.79, val_accuracy=0.289, lr=0.1] 15%|█▍        | 11/75 [05:03<26:13, 24.59s/epoch, loss=1.2, accuracy=0.734, val_loss=2.77, val_accuracy=0.296, lr=0.1] 16%|█▌        | 12/75 [05:27<25:38, 24.42s/epoch, loss=1.2, accuracy=0.735, val_loss=2.72, val_accuracy=0.335, lr=0.1] 17%|█▋        | 13/75 [05:51<25:12, 24.40s/epoch, loss=1.19, accuracy=0.737, val_loss=1.72, val_accuracy=0.59, lr=0.0316] 19%|█▊        | 14/75 [06:17<25:06, 24.70s/epoch, loss=1.18, accuracy=0.739, val_loss=1.68, val_accuracy=0.571, lr=0.1]   20%|██        | 15/75 [06:41<24:40, 24.67s/epoch, loss=1.18, accuracy=0.739, val_loss=1.81, val_accuracy=0.52, lr=0.1]  21%|██▏       | 16/75 [07:05<24:03, 24.46s/epoch, loss=1.18, accuracy=0.744, val_loss=4.27, val_accuracy=0.264, lr=0.1] 23%|██▎       | 17/75 [07:30<23:34, 24.38s/epoch, loss=1.18, accuracy=0.741, val_loss=1.55, val_accuracy=0.631, lr=0.1] 24%|██▍       | 18/75 [07:53<23:00, 24.23s/epoch, loss=1.17, accuracy=0.744, val_loss=2.83, val_accuracy=0.402, lr=0.1] 25%|██▌       | 19/75 [08:17<22:32, 24.16s/epoch, loss=1.17, accuracy=0.747, val_loss=1.92, val_accuracy=0.547, lr=0.1] 27%|██▋       | 20/75 [08:41<22:06, 24.11s/epoch, loss=1.17, accuracy=0.746, val_loss=2.49, val_accuracy=0.43, lr=0.1]  28%|██▊       | 21/75 [09:06<21:43, 24.13s/epoch, loss=1.18, accuracy=0.746, val_loss=2.4, val_accuracy=0.46, lr=0.1]  29%|██▉       | 22/75 [09:30<21:17, 24.11s/epoch, loss=1.17, accuracy=0.746, val_loss=2.14, val_accuracy=0.46, lr=0.0316] 31%|███       | 23/75 [09:54<20:53, 24.10s/epoch, loss=1.18, accuracy=0.745, val_loss=2.3, val_accuracy=0.424, lr=0.1]    32%|███▏      | 24/75 [10:18<20:33, 24.18s/epoch, loss=1.17, accuracy=0.748, val_loss=1.53, val_accuracy=0.626, lr=0.1] 33%|███▎      | 25/75 [10:42<20:09, 24.20s/epoch, loss=1.17, accuracy=0.749, val_loss=1.79, val_accuracy=0.52, lr=0.1]  35%|███▍      | 26/75 [11:06<19:44, 24.18s/epoch, loss=1.16, accuracy=0.75, val_loss=2.4, val_accuracy=0.437, lr=0.1]  36%|███▌      | 27/75 [11:32<19:38, 24.55s/epoch, loss=1.17, accuracy=0.748, val_loss=2.23, val_accuracy=0.479, lr=0.1] 37%|███▋      | 28/75 [11:56<19:06, 24.39s/epoch, loss=1.17, accuracy=0.75, val_loss=3.38, val_accuracy=0.344, lr=0.1]  39%|███▊      | 29/75 [12:20<18:35, 24.25s/epoch, loss=1.17, accuracy=0.75, val_loss=1.89, val_accuracy=0.563, lr=0.0316] 40%|████      | 30/75 [12:44<18:08, 24.18s/epoch, loss=1.16, accuracy=0.751, val_loss=1.86, val_accuracy=0.529, lr=0.1]   41%|████▏     | 31/75 [13:08<17:39, 24.07s/epoch, loss=1.16, accuracy=0.751, val_loss=1.79, val_accuracy=0.553, lr=0.1] 43%|████▎     | 32/75 [13:32<17:15, 24.08s/epoch, loss=1.16, accuracy=0.751, val_loss=2.21, val_accuracy=0.482, lr=0.1] 44%|████▍     | 33/75 [13:55<16:46, 23.96s/epoch, loss=1.15, accuracy=0.754, val_loss=1.76, val_accuracy=0.577, lr=0.1] 45%|████▌     | 34/75 [14:20<16:28, 24.11s/epoch, loss=1.15, accuracy=0.754, val_loss=1.61, val_accuracy=0.593, lr=0.0316] 47%|████▋     | 35/75 [14:44<16:01, 24.05s/epoch, loss=1.15, accuracy=0.753, val_loss=1.62, val_accuracy=0.587, lr=0.1]    48%|████▊     | 36/75 [15:08<15:42, 24.16s/epoch, loss=1.15, accuracy=0.754, val_loss=2.22, val_accuracy=0.483, lr=0.1] 49%|████▉     | 37/75 [15:32<15:16, 24.11s/epoch, loss=1.15, accuracy=0.752, val_loss=2.49, val_accuracy=0.408, lr=0.1] 51%|█████     | 38/75 [15:57<14:58, 24.27s/epoch, loss=1.15, accuracy=0.753, val_loss=1.47, val_accuracy=0.641, lr=0.1] 52%|█████▏    | 39/75 [16:21<14:37, 24.38s/epoch, loss=1.16, accuracy=0.753, val_loss=1.57, val_accuracy=0.606, lr=0.1] 53%|█████▎    | 40/75 [16:46<14:12, 24.35s/epoch, loss=1.14, accuracy=0.756, val_loss=1.89, val_accuracy=0.516, lr=0.1] 55%|█████▍    | 41/75 [17:10<13:50, 24.43s/epoch, loss=1.15, accuracy=0.756, val_loss=1.94, val_accuracy=0.483, lr=0.1] 56%|█████▌    | 42/75 [17:34<13:22, 24.31s/epoch, loss=1.16, accuracy=0.754, val_loss=1.76, val_accuracy=0.59, lr=0.1]  57%|█████▋    | 43/75 [17:58<12:54, 24.21s/epoch, loss=1.15, accuracy=0.754, val_loss=1.67, val_accuracy=0.571, lr=0.0316] 59%|█████▊    | 44/75 [18:22<12:28, 24.15s/epoch, loss=1.14, accuracy=0.752, val_loss=2.06, val_accuracy=0.545, lr=0.1]    60%|██████    | 45/75 [18:47<12:04, 24.14s/epoch, loss=1.15, accuracy=0.755, val_loss=2.22, val_accuracy=0.445, lr=0.1] 61%|██████▏   | 46/75 [19:10<11:35, 23.99s/epoch, loss=1.15, accuracy=0.756, val_loss=2.14, val_accuracy=0.443, lr=0.1] 63%|██████▎   | 47/75 [19:34<11:12, 24.01s/epoch, loss=1.15, accuracy=0.755, val_loss=5.61, val_accuracy=0.173, lr=0.1] 64%|██████▍   | 48/75 [19:58<10:45, 23.90s/epoch, loss=1.14, accuracy=0.757, val_loss=2.87, val_accuracy=0.359, lr=0.0316] 65%|██████▌   | 49/75 [20:22<10:21, 23.91s/epoch, loss=1.14, accuracy=0.753, val_loss=1.74, val_accuracy=0.586, lr=0.1]    67%|██████▋   | 50/75 [20:46<09:56, 23.85s/epoch, loss=1.13, accuracy=0.755, val_loss=1.92, val_accuracy=0.55, lr=0.1]  68%|██████▊   | 51/75 [21:09<09:30, 23.78s/epoch, loss=1.14, accuracy=0.755, val_loss=3.38, val_accuracy=0.284, lr=0.1] 69%|██████▉   | 52/75 [21:33<09:09, 23.90s/epoch, loss=1.13, accuracy=0.756, val_loss=1.78, val_accuracy=0.524, lr=0.1] 71%|███████   | 53/75 [21:58<08:48, 24.01s/epoch, loss=1.13, accuracy=0.757, val_loss=1.86, val_accuracy=0.534, lr=0.0316] 72%|███████▏  | 54/75 [22:22<08:26, 24.13s/epoch, loss=1.14, accuracy=0.759, val_loss=1.71, val_accuracy=0.596, lr=0.1]    73%|███████▎  | 55/75 [22:47<08:05, 24.26s/epoch, loss=1.14, accuracy=0.756, val_loss=1.84, val_accuracy=0.531, lr=0.1] 75%|███████▍  | 56/75 [23:11<07:41, 24.27s/epoch, loss=1.14, accuracy=0.753, val_loss=2.1, val_accuracy=0.536, lr=0.1]  76%|███████▌  | 57/75 [23:35<07:14, 24.14s/epoch, loss=1.13, accuracy=0.758, val_loss=2.61, val_accuracy=0.416, lr=0.1] 77%|███████▋  | 58/75 [23:59<06:49, 24.10s/epoch, loss=1.14, accuracy=0.756, val_loss=2.79, val_accuracy=0.326, lr=0.0316] 79%|███████▊  | 59/75 [24:23<06:25, 24.11s/epoch, loss=1.13, accuracy=0.761, val_loss=2.21, val_accuracy=0.446, lr=0.1]    80%|████████  | 60/75 [24:46<05:58, 23.93s/epoch, loss=1.13, accuracy=0.758, val_loss=2.02, val_accuracy=0.536, lr=0.1] 81%|████████▏ | 61/75 [25:10<05:33, 23.84s/epoch, loss=1.13, accuracy=0.757, val_loss=2.69, val_accuracy=0.438, lr=0.1] 83%|████████▎ | 62/75 [25:34<05:09, 23.80s/epoch, loss=1.14, accuracy=0.756, val_loss=1.79, val_accuracy=0.561, lr=0.1] 84%|████████▍ | 63/75 [25:57<04:45, 23.78s/epoch, loss=1.14, accuracy=0.755, val_loss=1.99, val_accuracy=0.484, lr=0.0316] 85%|████████▌ | 64/75 [26:22<04:22, 23.89s/epoch, loss=1.13, accuracy=0.756, val_loss=2.02, val_accuracy=0.499, lr=0.1]    87%|████████▋ | 65/75 [26:46<04:00, 24.02s/epoch, loss=1.13, accuracy=0.756, val_loss=1.85, val_accuracy=0.475, lr=0.1] 88%|████████▊ | 66/75 [27:10<03:35, 23.93s/epoch, loss=1.13, accuracy=0.757, val_loss=2, val_accuracy=0.47, lr=0.1]     89%|████████▉ | 67/75 [27:33<03:10, 23.83s/epoch, loss=1.14, accuracy=0.756, val_loss=2.35, val_accuracy=0.417, lr=0.1] 91%|█████████ | 68/75 [27:57<02:46, 23.85s/epoch, loss=1.13, accuracy=0.757, val_loss=1.68, val_accuracy=0.587, lr=0.0316] 92%|█████████▏| 69/75 [28:21<02:22, 23.80s/epoch, loss=1.13, accuracy=0.757, val_loss=1.52, val_accuracy=0.614, lr=0.1]    93%|█████████▎| 70/75 [28:45<01:59, 23.83s/epoch, loss=1.13, accuracy=0.757, val_loss=2.49, val_accuracy=0.375, lr=0.1] 95%|█████████▍| 71/75 [29:10<01:36, 24.18s/epoch, loss=1.12, accuracy=0.759, val_loss=1.51, val_accuracy=0.622, lr=0.1] 96%|█████████▌| 72/75 [29:34<01:12, 24.29s/epoch, loss=1.13, accuracy=0.761, val_loss=1.74, val_accuracy=0.575, lr=0.1] 97%|█████████▋| 73/75 [29:58<00:48, 24.17s/epoch, loss=1.12, accuracy=0.756, val_loss=2.55, val_accuracy=0.428, lr=0.0316] 99%|█████████▊| 74/75 [30:22<00:24, 24.03s/epoch, loss=1.14, accuracy=0.754, val_loss=1.53, val_accuracy=0.618, lr=0.1]   100%|██████████| 75/75 [30:45<00:00, 23.92s/epoch, loss=1.13, accuracy=0.757, val_loss=3.32, val_accuracy=0.355, lr=0.1]100%|██████████| 75/75 [30:45<00:00, 24.61s/epoch, loss=1.13, accuracy=0.757, val_loss=3.32, val_accuracy=0.355, lr=0.1]
Using real-time data augmentation.
Test score: 1.4843628406524658
Test accuracy: 0.6363999843597412


* * * Run SGD for ID = 20_20. * * *


2024-02-20 10:24:28.157435: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 10:24:34.545434: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 10:24:34.546689: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-20 10:24:34.588119: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:86:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-20 10:24:34.588166: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 10:24:34.594095: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 10:24:34.594168: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-20 10:24:34.598015: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-20 10:24:34.600295: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-20 10:24:34.604557: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-20 10:24:34.608079: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-20 10:24:34.615339: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 10:24:34.616116: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-20 10:24:34.616211: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 10:24:36.024504: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-20 10:24:36.025160: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-20 10:24:36.025710: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:86:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-20 10:24:36.025760: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 10:24:36.025803: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 10:24:36.025826: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-20 10:24:36.025862: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-20 10:24:36.025879: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-20 10:24:36.025894: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-20 10:24:36.025910: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-20 10:24:36.025926: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 10:24:36.026573: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-20 10:24:36.026615: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-20 10:24:36.657627: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-20 10:24:36.657683: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-20 10:24:36.657702: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-20 10:24:36.658893: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:86:00.0, compute capability: 6.1)
{'id': '20_20', 'batch_size': 128, 'epochs': 75, 'validation_split': 0.1, 'checkpointing': True, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
x_train shape: (45000, 32, 32, 3)
45000 train samples
5000 validation samples
10000 test samples
y_train shape: (45000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/75 [00:00<?, ?epoch/s]2024-02-20 10:24:37.513132: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-20 10:24:37.513802: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-02-20 10:24:39.521180: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-20 10:24:39.829099: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-20 10:24:40.886325: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-20 10:24:40.933428: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|▏         | 1/75 [01:04<1:19:31, 64.49s/epoch, loss=3.18, accuracy=0.319, val_loss=4.37, val_accuracy=0.187, lr=0.1]  3%|▎         | 2/75 [01:32<52:10, 42.89s/epoch, loss=1.56, accuracy=0.539, val_loss=2.29, val_accuracy=0.359, lr=0.1]    4%|▍         | 3/75 [01:59<43:06, 35.92s/epoch, loss=1.33, accuracy=0.64, val_loss=2.13, val_accuracy=0.383, lr=0.1]   5%|▌         | 4/75 [02:27<38:25, 32.47s/epoch, loss=1.25, accuracy=0.684, val_loss=1.86, val_accuracy=0.497, lr=0.1]  7%|▋         | 5/75 [02:54<35:43, 30.62s/epoch, loss=1.22, accuracy=0.701, val_loss=2.43, val_accuracy=0.47, lr=0.1]   8%|▊         | 6/75 [03:21<33:46, 29.37s/epoch, loss=1.2, accuracy=0.714, val_loss=1.49, val_accuracy=0.614, lr=0.1]  9%|▉         | 7/75 [03:46<31:53, 28.14s/epoch, loss=1.2, accuracy=0.718, val_loss=2.25, val_accuracy=0.422, lr=0.1] 11%|█         | 8/75 [04:13<30:54, 27.69s/epoch, loss=1.19, accuracy=0.725, val_loss=1.8, val_accuracy=0.506, lr=0.1] 12%|█▏        | 9/75 [04:40<30:18, 27.56s/epoch, loss=1.18, accuracy=0.73, val_loss=2.28, val_accuracy=0.379, lr=0.1] 13%|█▎        | 10/75 [05:06<29:12, 26.96s/epoch, loss=1.18, accuracy=0.734, val_loss=2.55, val_accuracy=0.387, lr=0.1] 15%|█▍        | 11/75 [05:31<27:56, 26.19s/epoch, loss=1.17, accuracy=0.736, val_loss=1.48, val_accuracy=0.635, lr=0.1] 16%|█▌        | 12/75 [05:56<27:15, 25.96s/epoch, loss=1.17, accuracy=0.736, val_loss=1.45, val_accuracy=0.63, lr=0.1]  17%|█▋        | 13/75 [06:21<26:32, 25.69s/epoch, loss=1.17, accuracy=0.739, val_loss=1.74, val_accuracy=0.57, lr=0.1] 19%|█▊        | 14/75 [06:45<25:34, 25.15s/epoch, loss=1.16, accuracy=0.744, val_loss=2.38, val_accuracy=0.494, lr=0.1] 20%|██        | 15/75 [07:08<24:40, 24.68s/epoch, loss=1.16, accuracy=0.74, val_loss=4.12, val_accuracy=0.284, lr=0.1]  21%|██▏       | 16/75 [07:33<24:14, 24.66s/epoch, loss=1.15, accuracy=0.744, val_loss=2.76, val_accuracy=0.429, lr=0.1] 23%|██▎       | 17/75 [07:57<23:33, 24.38s/epoch, loss=1.15, accuracy=0.745, val_loss=2.98, val_accuracy=0.252, lr=0.0316] 24%|██▍       | 18/75 [08:21<23:00, 24.22s/epoch, loss=1.15, accuracy=0.745, val_loss=2.76, val_accuracy=0.358, lr=0.1]    25%|██▌       | 19/75 [08:45<22:30, 24.12s/epoch, loss=1.15, accuracy=0.744, val_loss=1.49, val_accuracy=0.64, lr=0.1]  27%|██▋       | 20/75 [09:08<21:58, 23.98s/epoch, loss=1.15, accuracy=0.747, val_loss=3.46, val_accuracy=0.389, lr=0.1] 28%|██▊       | 21/75 [09:33<21:43, 24.14s/epoch, loss=1.14, accuracy=0.747, val_loss=2.36, val_accuracy=0.457, lr=0.1] 29%|██▉       | 22/75 [09:56<21:09, 23.96s/epoch, loss=1.14, accuracy=0.747, val_loss=1.97, val_accuracy=0.49, lr=0.0316] 31%|███       | 23/75 [10:20<20:41, 23.87s/epoch, loss=1.14, accuracy=0.75, val_loss=2.63, val_accuracy=0.367, lr=0.1]    32%|███▏      | 24/75 [10:44<20:16, 23.85s/epoch, loss=1.13, accuracy=0.749, val_loss=6.7, val_accuracy=0.175, lr=0.1] 33%|███▎      | 25/75 [11:08<19:53, 23.87s/epoch, loss=1.13, accuracy=0.751, val_loss=3.5, val_accuracy=0.171, lr=0.1] 35%|███▍      | 26/75 [11:31<19:27, 23.82s/epoch, loss=1.14, accuracy=0.749, val_loss=1.48, val_accuracy=0.623, lr=0.1] 36%|███▌      | 27/75 [11:55<19:01, 23.79s/epoch, loss=1.14, accuracy=0.748, val_loss=1.49, val_accuracy=0.636, lr=0.0316] 37%|███▋      | 28/75 [12:19<18:33, 23.70s/epoch, loss=1.14, accuracy=0.747, val_loss=2.02, val_accuracy=0.504, lr=0.1]    39%|███▊      | 29/75 [12:42<18:12, 23.74s/epoch, loss=1.13, accuracy=0.751, val_loss=2.04, val_accuracy=0.536, lr=0.1] 40%|████      | 30/75 [13:07<17:54, 23.88s/epoch, loss=1.13, accuracy=0.753, val_loss=3.82, val_accuracy=0.335, lr=0.1] 41%|████▏     | 31/75 [13:31<17:38, 24.06s/epoch, loss=1.13, accuracy=0.753, val_loss=1.44, val_accuracy=0.646, lr=0.1] 43%|████▎     | 32/75 [13:55<17:11, 23.98s/epoch, loss=1.13, accuracy=0.747, val_loss=3.13, val_accuracy=0.384, lr=0.1] 44%|████▍     | 33/75 [14:19<16:51, 24.09s/epoch, loss=1.13, accuracy=0.752, val_loss=2.48, val_accuracy=0.49, lr=0.1]  45%|████▌     | 34/75 [14:43<16:29, 24.13s/epoch, loss=1.13, accuracy=0.754, val_loss=2.52, val_accuracy=0.44, lr=0.1] 47%|████▋     | 35/75 [15:07<15:58, 23.97s/epoch, loss=1.13, accuracy=0.75, val_loss=1.82, val_accuracy=0.49, lr=0.1]  48%|████▊     | 36/75 [15:31<15:35, 23.99s/epoch, loss=1.12, accuracy=0.753, val_loss=2.85, val_accuracy=0.427, lr=0.0316] 49%|████▉     | 37/75 [15:56<15:18, 24.16s/epoch, loss=1.13, accuracy=0.751, val_loss=1.44, val_accuracy=0.639, lr=0.1]    51%|█████     | 38/75 [16:19<14:49, 24.03s/epoch, loss=1.13, accuracy=0.751, val_loss=1.96, val_accuracy=0.536, lr=0.1] 52%|█████▏    | 39/75 [16:44<14:31, 24.19s/epoch, loss=1.12, accuracy=0.755, val_loss=1.49, val_accuracy=0.647, lr=0.1] 53%|█████▎    | 40/75 [17:08<14:01, 24.05s/epoch, loss=1.12, accuracy=0.755, val_loss=2.07, val_accuracy=0.486, lr=0.1] 55%|█████▍    | 41/75 [17:32<13:38, 24.07s/epoch, loss=1.13, accuracy=0.751, val_loss=2.03, val_accuracy=0.446, lr=0.0316] 56%|█████▌    | 42/75 [17:56<13:13, 24.06s/epoch, loss=1.12, accuracy=0.754, val_loss=1.98, val_accuracy=0.543, lr=0.1]    57%|█████▋    | 43/75 [18:20<12:50, 24.08s/epoch, loss=1.12, accuracy=0.755, val_loss=4.66, val_accuracy=0.306, lr=0.1] 59%|█████▊    | 44/75 [18:44<12:28, 24.14s/epoch, loss=1.12, accuracy=0.753, val_loss=1.56, val_accuracy=0.608, lr=0.1] 60%|██████    | 45/75 [19:08<11:56, 23.90s/epoch, loss=1.12, accuracy=0.756, val_loss=2.6, val_accuracy=0.449, lr=0.1]  61%|██████▏   | 46/75 [19:32<11:36, 24.02s/epoch, loss=1.13, accuracy=0.755, val_loss=2.01, val_accuracy=0.586, lr=0.0316] 63%|██████▎   | 47/75 [19:55<11:09, 23.89s/epoch, loss=1.11, accuracy=0.76, val_loss=10.1, val_accuracy=0.0972, lr=0.1]    64%|██████▍   | 48/75 [20:20<10:50, 24.07s/epoch, loss=1.12, accuracy=0.752, val_loss=1.78, val_accuracy=0.55, lr=0.1]  65%|██████▌   | 49/75 [20:43<10:20, 23.87s/epoch, loss=1.12, accuracy=0.755, val_loss=2, val_accuracy=0.505, lr=0.1]   67%|██████▋   | 50/75 [21:07<09:53, 23.75s/epoch, loss=1.11, accuracy=0.756, val_loss=2.5, val_accuracy=0.486, lr=0.1] 68%|██████▊   | 51/75 [21:31<09:31, 23.81s/epoch, loss=1.11, accuracy=0.758, val_loss=1.8, val_accuracy=0.594, lr=0.0316] 69%|██████▉   | 52/75 [21:54<09:06, 23.74s/epoch, loss=1.12, accuracy=0.756, val_loss=2.72, val_accuracy=0.412, lr=0.1]   71%|███████   | 53/75 [22:18<08:44, 23.84s/epoch, loss=1.12, accuracy=0.757, val_loss=1.85, val_accuracy=0.472, lr=0.1] 72%|███████▏  | 54/75 [22:42<08:21, 23.87s/epoch, loss=1.12, accuracy=0.757, val_loss=1.59, val_accuracy=0.563, lr=0.1] 73%|███████▎  | 55/75 [23:07<07:59, 23.96s/epoch, loss=1.11, accuracy=0.758, val_loss=3.83, val_accuracy=0.353, lr=0.1] 75%|███████▍  | 56/75 [23:30<07:34, 23.94s/epoch, loss=1.12, accuracy=0.754, val_loss=2.45, val_accuracy=0.336, lr=0.0316] 76%|███████▌  | 57/75 [23:54<07:08, 23.79s/epoch, loss=1.11, accuracy=0.756, val_loss=2.29, val_accuracy=0.5, lr=0.1]      77%|███████▋  | 58/75 [24:18<06:46, 23.90s/epoch, loss=1.12, accuracy=0.755, val_loss=2.38, val_accuracy=0.433, lr=0.1] 79%|███████▊  | 59/75 [24:42<06:24, 24.04s/epoch, loss=1.11, accuracy=0.756, val_loss=1.65, val_accuracy=0.568, lr=0.1] 80%|████████  | 60/75 [25:07<06:05, 24.35s/epoch, loss=1.11, accuracy=0.758, val_loss=2.31, val_accuracy=0.468, lr=0.1] 81%|████████▏ | 61/75 [25:32<05:40, 24.29s/epoch, loss=1.11, accuracy=0.758, val_loss=2.4, val_accuracy=0.416, lr=0.0316] 83%|████████▎ | 62/75 [25:55<05:14, 24.18s/epoch, loss=1.11, accuracy=0.759, val_loss=1.56, val_accuracy=0.613, lr=0.1]   84%|████████▍ | 63/75 [26:20<04:52, 24.33s/epoch, loss=1.11, accuracy=0.757, val_loss=1.66, val_accuracy=0.602, lr=0.1] 85%|████████▌ | 64/75 [26:44<04:25, 24.17s/epoch, loss=1.11, accuracy=0.76, val_loss=2.96, val_accuracy=0.284, lr=0.1]  87%|████████▋ | 65/75 [27:08<04:00, 24.06s/epoch, loss=1.11, accuracy=0.758, val_loss=2.56, val_accuracy=0.462, lr=0.1] 88%|████████▊ | 66/75 [27:32<03:37, 24.11s/epoch, loss=1.12, accuracy=0.757, val_loss=2.42, val_accuracy=0.324, lr=0.0316] 89%|████████▉ | 67/75 [27:56<03:11, 23.96s/epoch, loss=1.11, accuracy=0.762, val_loss=1.9, val_accuracy=0.53, lr=0.1]      91%|█████████ | 68/75 [28:20<02:48, 24.03s/epoch, loss=1.12, accuracy=0.757, val_loss=1.69, val_accuracy=0.56, lr=0.1] 92%|█████████▏| 69/75 [28:44<02:23, 23.94s/epoch, loss=1.11, accuracy=0.759, val_loss=2.98, val_accuracy=0.357, lr=0.1] 93%|█████████▎| 70/75 [29:07<01:59, 23.84s/epoch, loss=1.11, accuracy=0.755, val_loss=1.44, val_accuracy=0.635, lr=0.1] 95%|█████████▍| 71/75 [29:31<01:35, 23.84s/epoch, loss=1.11, accuracy=0.757, val_loss=1.92, val_accuracy=0.528, lr=0.1] 96%|█████████▌| 72/75 [29:55<01:11, 23.88s/epoch, loss=1.11, accuracy=0.757, val_loss=1.52, val_accuracy=0.617, lr=0.1] 97%|█████████▋| 73/75 [30:19<00:47, 23.82s/epoch, loss=1.11, accuracy=0.758, val_loss=2.85, val_accuracy=0.372, lr=0.1] 99%|█████████▊| 74/75 [30:43<00:24, 24.06s/epoch, loss=1.11, accuracy=0.757, val_loss=3.03, val_accuracy=0.336, lr=0.1]100%|██████████| 75/75 [31:07<00:00, 24.08s/epoch, loss=1.11, accuracy=0.757, val_loss=2.41, val_accuracy=0.455, lr=0.0316]100%|██████████| 75/75 [31:07<00:00, 24.91s/epoch, loss=1.11, accuracy=0.757, val_loss=2.41, val_accuracy=0.455, lr=0.0316]
Using real-time data augmentation.
Test score: 1.4955004453659058
Test accuracy: 0.6430000066757202

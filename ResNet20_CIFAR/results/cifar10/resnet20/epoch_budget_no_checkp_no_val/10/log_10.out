Tue Mar 12 21:27:30 2024       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 545.23.08              Driver Version: 545.23.08    CUDA Version: 12.3     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA TITAN Xp                Off | 00000000:86:00.0 Off |                  N/A |
| 43%   58C    P8              13W / 250W |      0MiB / 12288MiB |      0%      Default |
|                                         |                      |                  N/A |
+-----------------------------------------+----------------------+----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
|  No running processes found                                                           |
+---------------------------------------------------------------------------------------+


* * * Run SGD for cluster size = 10. * * *


Budget: 150


* * * Run SGD for ID = 10_1. * * *


2024-03-12 21:27:36.517371: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-12 21:27:55.035233: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-12 21:27:55.036430: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-12 21:27:55.091594: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:86:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-12 21:27:55.091633: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-12 21:27:55.147671: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-12 21:27:55.147773: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-12 21:27:55.188286: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-12 21:27:55.254893: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-12 21:27:55.316697: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-12 21:27:55.352786: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-12 21:27:55.447872: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-12 21:27:55.448679: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-12 21:27:55.448772: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-12 21:27:56.942267: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-12 21:27:56.942911: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-12 21:27:56.943742: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:86:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-12 21:27:56.943779: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-12 21:27:56.943841: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-12 21:27:56.943872: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-12 21:27:56.943888: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-12 21:27:56.943902: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-12 21:27:56.943916: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-12 21:27:56.943929: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-12 21:27:56.943944: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-12 21:27:56.944495: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-12 21:27:56.944535: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-12 21:27:58.370206: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-12 21:27:58.370259: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-12 21:27:58.370269: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-12 21:27:58.371270: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:86:00.0, compute capability: 6.1)
{'id': '10_01', 'seed': 1, 'out_folder': 'results/epoch_budget_2', 'batch_size': 128, 'epochs': 150, 'validation_split': 0.0, 'checkpointing': False, 'checkpoint_every': -1, 'hold_out_validation_split': 0.0, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'num_classes': 10, 'SSE_lr': False, 'test_time_augmentation': False, 'debug': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
y_train shape: (50000, 10)
x_val shape: (10000, 32, 32, 3)
y_val shape: (10000, 10)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/150 [00:00<?, ?epoch/s]2024-03-12 21:27:58.948917: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-12 21:27:58.949424: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-03-12 21:28:00.695201: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-12 21:28:00.988344: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-12 21:28:02.517941: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-12 21:28:02.573328: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/150 [01:02<2:35:40, 62.69s/epoch, loss=3.21, accuracy=0.297, val_loss=2.83, val_accuracy=0.232, lr=0.1]  1%|▏         | 2/150 [01:24<1:35:13, 38.60s/epoch, loss=1.55, accuracy=0.544, val_loss=2.34, val_accuracy=0.345, lr=0.1]  2%|▏         | 3/150 [01:46<1:15:43, 30.91s/epoch, loss=1.37, accuracy=0.636, val_loss=2.7, val_accuracy=0.361, lr=0.1]   3%|▎         | 4/150 [02:07<1:06:22, 27.28s/epoch, loss=1.32, accuracy=0.666, val_loss=1.69, val_accuracy=0.545, lr=0.1]  3%|▎         | 5/150 [02:29<1:00:51, 25.18s/epoch, loss=1.3, accuracy=0.687, val_loss=1.63, val_accuracy=0.584, lr=0.1]   4%|▍         | 6/150 [02:51<57:36, 24.00s/epoch, loss=1.26, accuracy=0.706, val_loss=2.11, val_accuracy=0.457, lr=0.1]   5%|▍         | 7/150 [03:12<55:27, 23.27s/epoch, loss=1.24, accuracy=0.714, val_loss=1.87, val_accuracy=0.555, lr=0.1]  5%|▌         | 8/150 [03:34<53:50, 22.75s/epoch, loss=1.23, accuracy=0.718, val_loss=4.58, val_accuracy=0.233, lr=0.1]  6%|▌         | 9/150 [03:56<52:40, 22.41s/epoch, loss=1.23, accuracy=0.723, val_loss=1.67, val_accuracy=0.591, lr=0.1]  7%|▋         | 10/150 [04:17<51:52, 22.23s/epoch, loss=1.21, accuracy=0.728, val_loss=5.13, val_accuracy=0.249, lr=0.1]  7%|▋         | 11/150 [04:39<51:13, 22.11s/epoch, loss=1.21, accuracy=0.731, val_loss=1.94, val_accuracy=0.544, lr=0.1]  8%|▊         | 12/150 [05:01<50:34, 21.99s/epoch, loss=1.2, accuracy=0.733, val_loss=1.65, val_accuracy=0.577, lr=0.1]   9%|▊         | 13/150 [05:23<50:03, 21.93s/epoch, loss=1.2, accuracy=0.733, val_loss=1.92, val_accuracy=0.567, lr=0.1]  9%|▉         | 14/150 [05:44<49:31, 21.85s/epoch, loss=1.19, accuracy=0.738, val_loss=2.2, val_accuracy=0.442, lr=0.1] 10%|█         | 15/150 [06:06<49:03, 21.80s/epoch, loss=1.19, accuracy=0.738, val_loss=1.54, val_accuracy=0.624, lr=0.1] 11%|█         | 16/150 [06:28<48:35, 21.76s/epoch, loss=1.18, accuracy=0.741, val_loss=1.95, val_accuracy=0.544, lr=0.1] 11%|█▏        | 17/150 [06:49<48:10, 21.73s/epoch, loss=1.18, accuracy=0.739, val_loss=2.25, val_accuracy=0.517, lr=0.1] 12%|█▏        | 18/150 [07:11<47:46, 21.71s/epoch, loss=1.18, accuracy=0.741, val_loss=2.23, val_accuracy=0.451, lr=0.1] 13%|█▎        | 19/150 [07:33<47:29, 21.75s/epoch, loss=1.18, accuracy=0.743, val_loss=1.99, val_accuracy=0.506, lr=0.1] 13%|█▎        | 20/150 [07:55<47:04, 21.72s/epoch, loss=1.17, accuracy=0.74, val_loss=2.3, val_accuracy=0.479, lr=0.1]   14%|█▍        | 21/150 [08:16<46:42, 21.73s/epoch, loss=1.18, accuracy=0.742, val_loss=1.51, val_accuracy=0.637, lr=0.1] 15%|█▍        | 22/150 [08:38<46:20, 21.72s/epoch, loss=1.17, accuracy=0.742, val_loss=6.17, val_accuracy=0.25, lr=0.1]  15%|█▌        | 23/150 [09:00<45:58, 21.72s/epoch, loss=1.17, accuracy=0.743, val_loss=2.18, val_accuracy=0.498, lr=0.1] 16%|█▌        | 24/150 [09:22<45:40, 21.75s/epoch, loss=1.17, accuracy=0.746, val_loss=2.57, val_accuracy=0.453, lr=0.1] 17%|█▋        | 25/150 [09:45<46:04, 22.12s/epoch, loss=1.16, accuracy=0.749, val_loss=2.46, val_accuracy=0.452, lr=0.1] 17%|█▋        | 26/150 [10:09<47:24, 22.94s/epoch, loss=1.17, accuracy=0.745, val_loss=2.63, val_accuracy=0.386, lr=0.1] 18%|█▊        | 27/150 [10:33<47:37, 23.23s/epoch, loss=1.16, accuracy=0.746, val_loss=1.94, val_accuracy=0.515, lr=0.1] 19%|█▊        | 28/150 [10:57<47:30, 23.36s/epoch, loss=1.17, accuracy=0.745, val_loss=2.51, val_accuracy=0.42, lr=0.1]  19%|█▉        | 29/150 [11:21<47:37, 23.61s/epoch, loss=1.16, accuracy=0.749, val_loss=1.64, val_accuracy=0.59, lr=0.1] 20%|██        | 30/150 [11:45<47:25, 23.72s/epoch, loss=1.16, accuracy=0.749, val_loss=6.73, val_accuracy=0.179, lr=0.1] 21%|██        | 31/150 [12:09<47:11, 23.80s/epoch, loss=1.16, accuracy=0.749, val_loss=1.66, val_accuracy=0.564, lr=0.1] 21%|██▏       | 32/150 [12:33<46:58, 23.89s/epoch, loss=1.16, accuracy=0.747, val_loss=2.3, val_accuracy=0.42, lr=0.1]   22%|██▏       | 33/150 [12:59<47:32, 24.38s/epoch, loss=1.15, accuracy=0.75, val_loss=3.06, val_accuracy=0.459, lr=0.1] 23%|██▎       | 34/150 [13:24<47:47, 24.72s/epoch, loss=1.15, accuracy=0.752, val_loss=2.22, val_accuracy=0.417, lr=0.1] 23%|██▎       | 35/150 [13:50<47:51, 24.97s/epoch, loss=1.15, accuracy=0.751, val_loss=1.86, val_accuracy=0.558, lr=0.1] 24%|██▍       | 36/150 [14:15<47:25, 24.96s/epoch, loss=1.15, accuracy=0.75, val_loss=2.77, val_accuracy=0.408, lr=0.1]  25%|██▍       | 37/150 [14:39<46:21, 24.61s/epoch, loss=1.16, accuracy=0.748, val_loss=1.79, val_accuracy=0.571, lr=0.1] 25%|██▌       | 38/150 [15:03<45:34, 24.41s/epoch, loss=1.15, accuracy=0.751, val_loss=2.32, val_accuracy=0.443, lr=0.1] 26%|██▌       | 39/150 [15:27<45:04, 24.36s/epoch, loss=1.15, accuracy=0.75, val_loss=2.97, val_accuracy=0.36, lr=0.1]   27%|██▋       | 40/150 [15:53<45:28, 24.81s/epoch, loss=1.15, accuracy=0.751, val_loss=2.4, val_accuracy=0.429, lr=0.1] 27%|██▋       | 41/150 [16:18<45:36, 25.11s/epoch, loss=1.15, accuracy=0.754, val_loss=1.77, val_accuracy=0.529, lr=0.1] 28%|██▊       | 42/150 [16:44<45:32, 25.30s/epoch, loss=1.15, accuracy=0.749, val_loss=1.45, val_accuracy=0.639, lr=0.1] 29%|██▊       | 43/150 [17:09<44:53, 25.17s/epoch, loss=1.15, accuracy=0.752, val_loss=2.66, val_accuracy=0.378, lr=0.1] 29%|██▉       | 44/150 [17:33<44:00, 24.91s/epoch, loss=1.14, accuracy=0.753, val_loss=2.04, val_accuracy=0.508, lr=0.1] 30%|███       | 45/150 [17:57<43:04, 24.61s/epoch, loss=1.14, accuracy=0.752, val_loss=2.35, val_accuracy=0.451, lr=0.1] 31%|███       | 46/150 [18:22<42:38, 24.60s/epoch, loss=1.15, accuracy=0.753, val_loss=2.82, val_accuracy=0.44, lr=0.1]  31%|███▏      | 47/150 [18:48<42:50, 24.96s/epoch, loss=1.14, accuracy=0.753, val_loss=1.64, val_accuracy=0.603, lr=0.1] 32%|███▏      | 48/150 [19:14<42:56, 25.26s/epoch, loss=1.15, accuracy=0.752, val_loss=2.38, val_accuracy=0.483, lr=0.1] 33%|███▎      | 49/150 [19:40<42:49, 25.44s/epoch, loss=1.14, accuracy=0.755, val_loss=1.63, val_accuracy=0.601, lr=0.1] 33%|███▎      | 50/150 [20:04<42:01, 25.21s/epoch, loss=1.14, accuracy=0.752, val_loss=2.22, val_accuracy=0.456, lr=0.1] 34%|███▍      | 51/150 [20:28<41:00, 24.86s/epoch, loss=1.14, accuracy=0.752, val_loss=1.9, val_accuracy=0.521, lr=0.1]  35%|███▍      | 52/150 [20:52<40:15, 24.65s/epoch, loss=1.14, accuracy=0.753, val_loss=2.57, val_accuracy=0.384, lr=0.1] 35%|███▌      | 53/150 [21:17<39:59, 24.74s/epoch, loss=1.14, accuracy=0.753, val_loss=1.71, val_accuracy=0.589, lr=0.1] 36%|███▌      | 54/150 [21:43<40:12, 25.13s/epoch, loss=1.14, accuracy=0.753, val_loss=1.99, val_accuracy=0.467, lr=0.1] 37%|███▋      | 55/150 [22:09<40:06, 25.34s/epoch, loss=1.14, accuracy=0.751, val_loss=1.71, val_accuracy=0.57, lr=0.1]  37%|███▋      | 56/150 [22:35<39:53, 25.46s/epoch, loss=1.14, accuracy=0.751, val_loss=2.62, val_accuracy=0.452, lr=0.1] 38%|███▊      | 57/150 [23:00<39:02, 25.19s/epoch, loss=1.14, accuracy=0.751, val_loss=1.99, val_accuracy=0.55, lr=0.1]  39%|███▊      | 58/150 [23:24<38:08, 24.87s/epoch, loss=1.14, accuracy=0.754, val_loss=2.16, val_accuracy=0.494, lr=0.1] 39%|███▉      | 59/150 [23:48<37:25, 24.68s/epoch, loss=1.13, accuracy=0.753, val_loss=2.39, val_accuracy=0.366, lr=0.1] 40%|████      | 60/150 [24:13<37:07, 24.75s/epoch, loss=1.14, accuracy=0.755, val_loss=1.53, val_accuracy=0.625, lr=0.1] 41%|████      | 61/150 [24:38<37:07, 25.03s/epoch, loss=1.13, accuracy=0.751, val_loss=3.31, val_accuracy=0.369, lr=0.1] 41%|████▏     | 62/150 [25:04<37:01, 25.25s/epoch, loss=0.922, accuracy=0.816, val_loss=0.915, val_accuracy=0.798, lr=0.01] 42%|████▏     | 63/150 [25:30<36:46, 25.36s/epoch, loss=0.74, accuracy=0.847, val_loss=0.826, val_accuracy=0.804, lr=0.01]  43%|████▎     | 64/150 [25:54<35:57, 25.08s/epoch, loss=0.658, accuracy=0.854, val_loss=0.765, val_accuracy=0.816, lr=0.01] 43%|████▎     | 65/150 [26:18<35:05, 24.77s/epoch, loss=0.612, accuracy=0.86, val_loss=0.745, val_accuracy=0.809, lr=0.01]  44%|████▍     | 66/150 [26:43<34:27, 24.61s/epoch, loss=0.592, accuracy=0.86, val_loss=0.899, val_accuracy=0.753, lr=0.01] 45%|████▍     | 67/150 [27:08<34:12, 24.73s/epoch, loss=0.58, accuracy=0.862, val_loss=0.943, val_accuracy=0.747, lr=0.01] 45%|████▌     | 68/150 [27:33<34:15, 25.07s/epoch, loss=0.575, accuracy=0.863, val_loss=0.77, val_accuracy=0.805, lr=0.01] 46%|████▌     | 69/150 [27:59<34:04, 25.25s/epoch, loss=0.569, accuracy=0.865, val_loss=0.87, val_accuracy=0.778, lr=0.01] 47%|████▋     | 70/150 [28:25<33:47, 25.35s/epoch, loss=0.567, accuracy=0.863, val_loss=1.03, val_accuracy=0.722, lr=0.01] 47%|████▋     | 71/150 [28:49<32:54, 25.00s/epoch, loss=0.569, accuracy=0.867, val_loss=0.867, val_accuracy=0.774, lr=0.01] 48%|████▊     | 72/150 [29:13<32:09, 24.74s/epoch, loss=0.56, accuracy=0.87, val_loss=0.773, val_accuracy=0.801, lr=0.01]   49%|████▊     | 73/150 [29:37<31:37, 24.64s/epoch, loss=0.564, accuracy=0.869, val_loss=1.06, val_accuracy=0.737, lr=0.01] 49%|████▉     | 74/150 [30:03<31:26, 24.83s/epoch, loss=0.565, accuracy=0.871, val_loss=0.822, val_accuracy=0.787, lr=0.01] 50%|█████     | 75/150 [30:28<31:24, 25.12s/epoch, loss=0.566, accuracy=0.87, val_loss=0.824, val_accuracy=0.782, lr=0.01]  51%|█████     | 76/150 [30:54<31:13, 25.32s/epoch, loss=0.559, accuracy=0.875, val_loss=0.753, val_accuracy=0.812, lr=0.01] 51%|█████▏    | 77/150 [31:20<31:01, 25.50s/epoch, loss=0.561, accuracy=0.873, val_loss=0.851, val_accuracy=0.795, lr=0.01] 52%|█████▏    | 78/150 [31:44<30:08, 25.12s/epoch, loss=0.559, accuracy=0.873, val_loss=1.95, val_accuracy=0.565, lr=0.01]  53%|█████▎    | 79/150 [32:09<29:33, 24.98s/epoch, loss=0.563, accuracy=0.874, val_loss=0.781, val_accuracy=0.806, lr=0.01] 53%|█████▎    | 80/150 [32:33<28:57, 24.82s/epoch, loss=0.567, accuracy=0.872, val_loss=0.883, val_accuracy=0.785, lr=0.01] 54%|█████▍    | 81/150 [32:59<28:43, 24.98s/epoch, loss=0.561, accuracy=0.876, val_loss=0.815, val_accuracy=0.792, lr=0.01] 55%|█████▍    | 82/150 [33:25<28:33, 25.20s/epoch, loss=0.56, accuracy=0.877, val_loss=0.773, val_accuracy=0.82, lr=0.01]   55%|█████▌    | 83/150 [33:50<28:21, 25.39s/epoch, loss=0.558, accuracy=0.879, val_loss=0.724, val_accuracy=0.83, lr=0.01] 56%|█████▌    | 84/150 [34:16<27:57, 25.42s/epoch, loss=0.559, accuracy=0.878, val_loss=0.778, val_accuracy=0.811, lr=0.01] 57%|█████▋    | 85/150 [34:40<27:05, 25.01s/epoch, loss=0.56, accuracy=0.878, val_loss=0.782, val_accuracy=0.81, lr=0.01]   57%|█████▋    | 86/150 [35:04<26:25, 24.77s/epoch, loss=0.559, accuracy=0.878, val_loss=0.765, val_accuracy=0.815, lr=0.01] 58%|█████▊    | 87/150 [35:28<25:52, 24.64s/epoch, loss=0.56, accuracy=0.878, val_loss=1.02, val_accuracy=0.74, lr=0.01]    59%|█████▊    | 88/150 [35:54<25:49, 24.99s/epoch, loss=0.561, accuracy=0.879, val_loss=0.889, val_accuracy=0.788, lr=0.01] 59%|█████▉    | 89/150 [36:20<25:33, 25.15s/epoch, loss=0.555, accuracy=0.882, val_loss=0.934, val_accuracy=0.771, lr=0.01] 60%|██████    | 90/150 [36:45<25:15, 25.26s/epoch, loss=0.558, accuracy=0.88, val_loss=0.765, val_accuracy=0.814, lr=0.01]  61%|██████    | 91/150 [37:10<24:45, 25.18s/epoch, loss=0.554, accuracy=0.883, val_loss=0.745, val_accuracy=0.817, lr=0.01] 61%|██████▏   | 92/150 [37:34<23:58, 24.79s/epoch, loss=0.479, accuracy=0.909, val_loss=0.536, val_accuracy=0.89, lr=0.001] 62%|██████▏   | 93/150 [37:58<23:18, 24.53s/epoch, loss=0.428, accuracy=0.926, val_loss=0.521, val_accuracy=0.896, lr=0.001] 63%|██████▎   | 94/150 [38:22<22:44, 24.37s/epoch, loss=0.406, accuracy=0.932, val_loss=0.512, val_accuracy=0.896, lr=0.001] 63%|██████▎   | 95/150 [38:48<22:39, 24.71s/epoch, loss=0.389, accuracy=0.934, val_loss=0.503, val_accuracy=0.898, lr=0.001] 64%|██████▍   | 96/150 [39:13<22:28, 24.97s/epoch, loss=0.374, accuracy=0.938, val_loss=0.503, val_accuracy=0.896, lr=0.001] 65%|██████▍   | 97/150 [39:39<22:11, 25.13s/epoch, loss=0.364, accuracy=0.94, val_loss=0.5, val_accuracy=0.896, lr=0.001]    65%|██████▌   | 98/150 [40:04<21:45, 25.10s/epoch, loss=0.353, accuracy=0.941, val_loss=0.514, val_accuracy=0.894, lr=0.001] 66%|██████▌   | 99/150 [40:28<21:03, 24.78s/epoch, loss=0.34, accuracy=0.946, val_loss=0.486, val_accuracy=0.9, lr=0.001]    67%|██████▋   | 100/150 [40:52<20:27, 24.55s/epoch, loss=0.332, accuracy=0.946, val_loss=0.486, val_accuracy=0.898, lr=0.001] 67%|██████▋   | 101/150 [41:16<19:56, 24.43s/epoch, loss=0.328, accuracy=0.945, val_loss=0.479, val_accuracy=0.901, lr=0.001] 68%|██████▊   | 102/150 [41:41<19:46, 24.71s/epoch, loss=0.316, accuracy=0.948, val_loss=0.493, val_accuracy=0.897, lr=0.001] 69%|██████▊   | 103/150 [42:07<19:32, 24.95s/epoch, loss=0.309, accuracy=0.949, val_loss=0.481, val_accuracy=0.899, lr=0.001] 69%|██████▉   | 104/150 [42:32<19:16, 25.15s/epoch, loss=0.3, accuracy=0.951, val_loss=0.483, val_accuracy=0.901, lr=0.001]   70%|███████   | 105/150 [42:57<18:48, 25.08s/epoch, loss=0.295, accuracy=0.95, val_loss=0.476, val_accuracy=0.9, lr=0.001]  71%|███████   | 106/150 [43:21<18:07, 24.73s/epoch, loss=0.288, accuracy=0.952, val_loss=0.468, val_accuracy=0.901, lr=0.001] 71%|███████▏  | 107/150 [43:45<17:32, 24.48s/epoch, loss=0.286, accuracy=0.951, val_loss=0.483, val_accuracy=0.896, lr=0.001] 72%|███████▏  | 108/150 [44:09<17:01, 24.31s/epoch, loss=0.278, accuracy=0.954, val_loss=0.491, val_accuracy=0.893, lr=0.001] 73%|███████▎  | 109/150 [44:35<16:51, 24.66s/epoch, loss=0.272, accuracy=0.955, val_loss=0.475, val_accuracy=0.898, lr=0.001] 73%|███████▎  | 110/150 [45:00<16:37, 24.95s/epoch, loss=0.263, accuracy=0.956, val_loss=0.486, val_accuracy=0.894, lr=0.001] 74%|███████▍  | 111/150 [45:26<16:18, 25.10s/epoch, loss=0.264, accuracy=0.955, val_loss=0.488, val_accuracy=0.89, lr=0.001]  75%|███████▍  | 112/150 [45:50<15:49, 25.00s/epoch, loss=0.258, accuracy=0.956, val_loss=0.468, val_accuracy=0.899, lr=0.001] 75%|███████▌  | 113/150 [46:14<15:11, 24.62s/epoch, loss=0.257, accuracy=0.956, val_loss=0.478, val_accuracy=0.892, lr=0.001] 76%|███████▌  | 114/150 [46:38<14:34, 24.28s/epoch, loss=0.253, accuracy=0.957, val_loss=0.493, val_accuracy=0.891, lr=0.001] 77%|███████▋  | 115/150 [47:01<14:03, 24.11s/epoch, loss=0.251, accuracy=0.957, val_loss=0.499, val_accuracy=0.886, lr=0.001] 77%|███████▋  | 116/150 [47:25<13:35, 24.00s/epoch, loss=0.244, accuracy=0.958, val_loss=0.516, val_accuracy=0.88, lr=0.001]  78%|███████▊  | 117/150 [47:49<13:09, 23.92s/epoch, loss=0.243, accuracy=0.958, val_loss=0.512, val_accuracy=0.885, lr=0.001] 79%|███████▊  | 118/150 [48:13<12:48, 24.00s/epoch, loss=0.24, accuracy=0.958, val_loss=0.499, val_accuracy=0.892, lr=0.001]  79%|███████▉  | 119/150 [48:38<12:36, 24.40s/epoch, loss=0.237, accuracy=0.959, val_loss=0.503, val_accuracy=0.886, lr=0.001] 80%|████████  | 120/150 [49:04<12:19, 24.64s/epoch, loss=0.236, accuracy=0.959, val_loss=0.482, val_accuracy=0.888, lr=0.001] 81%|████████  | 121/150 [49:29<12:02, 24.93s/epoch, loss=0.233, accuracy=0.959, val_loss=0.515, val_accuracy=0.882, lr=0.001] 81%|████████▏ | 122/150 [49:54<11:34, 24.80s/epoch, loss=0.213, accuracy=0.966, val_loss=0.44, val_accuracy=0.904, lr=1e-04]  82%|████████▏ | 123/150 [50:17<11:01, 24.52s/epoch, loss=0.203, accuracy=0.972, val_loss=0.439, val_accuracy=0.903, lr=1e-04] 83%|████████▎ | 124/150 [50:41<10:33, 24.36s/epoch, loss=0.196, accuracy=0.974, val_loss=0.437, val_accuracy=0.905, lr=1e-04] 83%|████████▎ | 125/150 [51:06<10:09, 24.36s/epoch, loss=0.193, accuracy=0.975, val_loss=0.44, val_accuracy=0.904, lr=1e-04]  84%|████████▍ | 126/150 [51:31<09:54, 24.76s/epoch, loss=0.188, accuracy=0.977, val_loss=0.438, val_accuracy=0.905, lr=1e-04] 85%|████████▍ | 127/150 [51:57<09:35, 25.03s/epoch, loss=0.189, accuracy=0.976, val_loss=0.438, val_accuracy=0.906, lr=1e-04] 85%|████████▌ | 128/150 [52:23<09:13, 25.14s/epoch, loss=0.187, accuracy=0.977, val_loss=0.439, val_accuracy=0.906, lr=1e-04] 86%|████████▌ | 129/150 [52:47<08:44, 24.99s/epoch, loss=0.184, accuracy=0.977, val_loss=0.439, val_accuracy=0.906, lr=1e-04] 87%|████████▋ | 130/150 [53:11<08:13, 24.67s/epoch, loss=0.181, accuracy=0.979, val_loss=0.44, val_accuracy=0.905, lr=1e-04]  87%|████████▋ | 131/150 [53:35<07:44, 24.42s/epoch, loss=0.18, accuracy=0.979, val_loss=0.44, val_accuracy=0.906, lr=1e-04]  88%|████████▊ | 132/150 [53:59<07:18, 24.33s/epoch, loss=0.178, accuracy=0.979, val_loss=0.441, val_accuracy=0.905, lr=1e-04] 89%|████████▊ | 133/150 [54:24<06:58, 24.62s/epoch, loss=0.177, accuracy=0.979, val_loss=0.438, val_accuracy=0.906, lr=1e-04] 89%|████████▉ | 134/150 [54:50<06:37, 24.87s/epoch, loss=0.176, accuracy=0.98, val_loss=0.442, val_accuracy=0.905, lr=1e-04]  90%|█████████ | 135/150 [55:15<06:15, 25.01s/epoch, loss=0.177, accuracy=0.979, val_loss=0.439, val_accuracy=0.905, lr=1e-04] 91%|█████████ | 136/150 [55:40<05:47, 24.84s/epoch, loss=0.174, accuracy=0.981, val_loss=0.439, val_accuracy=0.906, lr=1e-04] 91%|█████████▏| 137/150 [56:04<05:19, 24.58s/epoch, loss=0.172, accuracy=0.981, val_loss=0.44, val_accuracy=0.906, lr=5e-5]   92%|█████████▏| 138/150 [56:27<04:52, 24.35s/epoch, loss=0.173, accuracy=0.981, val_loss=0.438, val_accuracy=0.905, lr=5e-5] 93%|█████████▎| 139/150 [56:51<04:26, 24.23s/epoch, loss=0.172, accuracy=0.98, val_loss=0.441, val_accuracy=0.905, lr=5e-5]  93%|█████████▎| 140/150 [57:17<04:05, 24.56s/epoch, loss=0.171, accuracy=0.981, val_loss=0.439, val_accuracy=0.905, lr=5e-5] 94%|█████████▍| 141/150 [57:42<03:42, 24.75s/epoch, loss=0.171, accuracy=0.981, val_loss=0.44, val_accuracy=0.905, lr=5e-5]  95%|█████████▍| 142/150 [58:07<03:19, 24.95s/epoch, loss=0.171, accuracy=0.981, val_loss=0.44, val_accuracy=0.906, lr=5e-5] 95%|█████████▌| 143/150 [58:32<02:54, 24.92s/epoch, loss=0.17, accuracy=0.981, val_loss=0.442, val_accuracy=0.906, lr=5e-5] 96%|█████████▌| 144/150 [58:56<02:27, 24.64s/epoch, loss=0.17, accuracy=0.982, val_loss=0.442, val_accuracy=0.905, lr=5e-5] 97%|█████████▋| 145/150 [59:20<02:01, 24.38s/epoch, loss=0.169, accuracy=0.982, val_loss=0.442, val_accuracy=0.907, lr=5e-5] 97%|█████████▋| 146/150 [59:44<01:37, 24.27s/epoch, loss=0.167, accuracy=0.982, val_loss=0.443, val_accuracy=0.904, lr=5e-5] 98%|█████████▊| 147/150 [1:00:10<01:14, 24.67s/epoch, loss=0.165, accuracy=0.983, val_loss=0.44, val_accuracy=0.906, lr=5e-5] 99%|█████████▊| 148/150 [1:00:35<00:49, 24.92s/epoch, loss=0.169, accuracy=0.981, val_loss=0.439, val_accuracy=0.907, lr=5e-5] 99%|█████████▉| 149/150 [1:01:01<00:25, 25.14s/epoch, loss=0.166, accuracy=0.982, val_loss=0.442, val_accuracy=0.907, lr=5e-5]100%|██████████| 150/150 [1:01:26<00:00, 25.08s/epoch, loss=0.166, accuracy=0.982, val_loss=0.441, val_accuracy=0.906, lr=5e-5]100%|██████████| 150/150 [1:01:26<00:00, 24.57s/epoch, loss=0.166, accuracy=0.982, val_loss=0.441, val_accuracy=0.906, lr=5e-5]
Using real-time data augmentation.
Only one model saved

Loading model: 10_01_cifar10_ResNet20v1.h5
Test score: 0.4405905306339264
Test accuracy: 0.9064000248908997


* * * Run SGD for ID = 10_2. * * *


2024-03-12 22:29:29.304218: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-12 22:29:36.761049: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-12 22:29:36.762347: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-12 22:29:36.809471: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:86:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-12 22:29:36.809514: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-12 22:29:36.816280: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-12 22:29:36.816344: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-12 22:29:36.820504: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-12 22:29:36.822666: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-12 22:29:36.826555: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-12 22:29:36.830240: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-12 22:29:36.837461: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-12 22:29:36.838133: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-12 22:29:36.838221: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-12 22:29:38.059344: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-12 22:29:38.060409: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-12 22:29:38.061563: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:86:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-12 22:29:38.061600: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-12 22:29:38.061638: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-12 22:29:38.061650: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-12 22:29:38.061662: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-12 22:29:38.061674: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-12 22:29:38.061688: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-12 22:29:38.061708: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-12 22:29:38.061720: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-12 22:29:38.062245: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-12 22:29:38.062283: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-12 22:29:38.694419: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-12 22:29:38.694477: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-12 22:29:38.694497: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-12 22:29:38.695618: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:86:00.0, compute capability: 6.1)
{'id': '10_02', 'seed': 2, 'out_folder': 'results/epoch_budget_2', 'batch_size': 128, 'epochs': 150, 'validation_split': 0.0, 'checkpointing': False, 'checkpoint_every': -1, 'hold_out_validation_split': 0.0, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'num_classes': 10, 'SSE_lr': False, 'test_time_augmentation': False, 'debug': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
y_train shape: (50000, 10)
x_val shape: (10000, 32, 32, 3)
y_val shape: (10000, 10)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/150 [00:00<?, ?epoch/s]2024-03-12 22:29:39.301631: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-12 22:29:39.313992: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-03-12 22:29:41.133780: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-12 22:29:41.417620: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-12 22:29:42.244051: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-12 22:29:42.294068: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/150 [00:59<2:28:48, 59.92s/epoch, loss=2.88, accuracy=0.378, val_loss=2.7, val_accuracy=0.232, lr=0.1]  1%|▏         | 2/150 [01:25<1:37:44, 39.62s/epoch, loss=1.49, accuracy=0.578, val_loss=2.04, val_accuracy=0.419, lr=0.1]  2%|▏         | 3/150 [01:50<1:21:05, 33.10s/epoch, loss=1.33, accuracy=0.657, val_loss=1.62, val_accuracy=0.574, lr=0.1]  3%|▎         | 4/150 [02:16<1:13:07, 30.05s/epoch, loss=1.28, accuracy=0.691, val_loss=1.68, val_accuracy=0.555, lr=0.1]  3%|▎         | 5/150 [02:40<1:08:07, 28.19s/epoch, loss=1.25, accuracy=0.705, val_loss=2.38, val_accuracy=0.396, lr=0.1]  4%|▍         | 6/150 [03:04<1:03:54, 26.63s/epoch, loss=1.23, accuracy=0.713, val_loss=1.67, val_accuracy=0.582, lr=0.1]  5%|▍         | 7/150 [03:28<1:01:24, 25.76s/epoch, loss=1.22, accuracy=0.72, val_loss=1.74, val_accuracy=0.552, lr=0.1]   5%|▌         | 8/150 [03:52<59:38, 25.20s/epoch, loss=1.21, accuracy=0.725, val_loss=2.91, val_accuracy=0.371, lr=0.1]   6%|▌         | 9/150 [04:17<59:21, 25.26s/epoch, loss=1.2, accuracy=0.729, val_loss=1.42, val_accuracy=0.649, lr=0.1]   7%|▋         | 10/150 [04:43<58:58, 25.28s/epoch, loss=1.2, accuracy=0.734, val_loss=1.72, val_accuracy=0.576, lr=0.1]  7%|▋         | 11/150 [05:08<58:38, 25.31s/epoch, loss=1.19, accuracy=0.736, val_loss=3.02, val_accuracy=0.352, lr=0.1]  8%|▊         | 12/150 [05:33<58:06, 25.26s/epoch, loss=1.19, accuracy=0.738, val_loss=6.02, val_accuracy=0.15, lr=0.1]   9%|▊         | 13/150 [05:57<56:39, 24.81s/epoch, loss=1.18, accuracy=0.74, val_loss=1.95, val_accuracy=0.527, lr=0.1]  9%|▉         | 14/150 [06:21<55:37, 24.54s/epoch, loss=1.18, accuracy=0.739, val_loss=1.6, val_accuracy=0.594, lr=0.1] 10%|█         | 15/150 [06:45<54:57, 24.43s/epoch, loss=1.18, accuracy=0.745, val_loss=2.77, val_accuracy=0.409, lr=0.1] 11%|█         | 16/150 [07:10<55:07, 24.68s/epoch, loss=1.17, accuracy=0.742, val_loss=1.86, val_accuracy=0.549, lr=0.1] 11%|█▏        | 17/150 [07:36<55:10, 24.89s/epoch, loss=1.16, accuracy=0.744, val_loss=1.83, val_accuracy=0.569, lr=0.1] 12%|█▏        | 18/150 [08:01<55:11, 25.08s/epoch, loss=1.17, accuracy=0.742, val_loss=2.26, val_accuracy=0.514, lr=0.1] 13%|█▎        | 19/150 [08:26<54:48, 25.10s/epoch, loss=1.17, accuracy=0.745, val_loss=2.34, val_accuracy=0.399, lr=0.1] 13%|█▎        | 20/150 [08:50<53:39, 24.77s/epoch, loss=1.16, accuracy=0.748, val_loss=1.74, val_accuracy=0.581, lr=0.1] 14%|█▍        | 21/150 [09:14<52:45, 24.54s/epoch, loss=1.17, accuracy=0.745, val_loss=1.61, val_accuracy=0.6, lr=0.1]   15%|█▍        | 22/150 [09:39<52:07, 24.44s/epoch, loss=1.15, accuracy=0.751, val_loss=1.58, val_accuracy=0.598, lr=0.1] 15%|█▌        | 23/150 [10:04<52:20, 24.73s/epoch, loss=1.15, accuracy=0.75, val_loss=1.68, val_accuracy=0.563, lr=0.1]  16%|█▌        | 24/150 [10:30<52:28, 24.99s/epoch, loss=1.15, accuracy=0.752, val_loss=1.59, val_accuracy=0.606, lr=0.1] 17%|█▋        | 25/150 [10:55<52:33, 25.23s/epoch, loss=1.14, accuracy=0.752, val_loss=1.71, val_accuracy=0.539, lr=0.1] 17%|█▋        | 26/150 [11:21<52:13, 25.27s/epoch, loss=1.15, accuracy=0.75, val_loss=3.02, val_accuracy=0.387, lr=0.1]  18%|█▊        | 27/150 [11:46<51:29, 25.12s/epoch, loss=1.15, accuracy=0.749, val_loss=2.32, val_accuracy=0.45, lr=0.1] 19%|█▊        | 28/150 [12:10<50:24, 24.79s/epoch, loss=1.15, accuracy=0.751, val_loss=1.97, val_accuracy=0.543, lr=0.1] 19%|█▉        | 29/150 [12:34<49:33, 24.57s/epoch, loss=1.14, accuracy=0.755, val_loss=2.62, val_accuracy=0.469, lr=0.1] 20%|██        | 30/150 [12:59<49:29, 24.75s/epoch, loss=1.15, accuracy=0.752, val_loss=1.76, val_accuracy=0.54, lr=0.1]  21%|██        | 31/150 [13:24<49:33, 24.99s/epoch, loss=1.14, accuracy=0.753, val_loss=2.45, val_accuracy=0.482, lr=0.1] 21%|██▏       | 32/150 [13:49<49:10, 25.01s/epoch, loss=1.14, accuracy=0.753, val_loss=4.01, val_accuracy=0.265, lr=0.1] 22%|██▏       | 33/150 [14:15<48:54, 25.08s/epoch, loss=1.14, accuracy=0.754, val_loss=1.74, val_accuracy=0.557, lr=0.1] 23%|██▎       | 34/150 [14:38<47:41, 24.67s/epoch, loss=1.14, accuracy=0.756, val_loss=2.24, val_accuracy=0.432, lr=0.1] 23%|██▎       | 35/150 [15:02<46:49, 24.43s/epoch, loss=1.14, accuracy=0.754, val_loss=2.09, val_accuracy=0.46, lr=0.1]  24%|██▍       | 36/150 [15:26<46:08, 24.29s/epoch, loss=1.14, accuracy=0.752, val_loss=1.8, val_accuracy=0.517, lr=0.1] 25%|██▍       | 37/150 [15:51<46:02, 24.45s/epoch, loss=1.13, accuracy=0.754, val_loss=1.53, val_accuracy=0.587, lr=0.1] 25%|██▌       | 38/150 [16:16<46:10, 24.73s/epoch, loss=1.14, accuracy=0.755, val_loss=2.43, val_accuracy=0.438, lr=0.1] 26%|██▌       | 39/150 [16:42<46:07, 24.93s/epoch, loss=1.14, accuracy=0.754, val_loss=2.61, val_accuracy=0.502, lr=0.1] 27%|██▋       | 40/150 [17:07<45:59, 25.08s/epoch, loss=1.13, accuracy=0.755, val_loss=1.45, val_accuracy=0.652, lr=0.1] 27%|██▋       | 41/150 [17:32<45:11, 24.87s/epoch, loss=1.13, accuracy=0.755, val_loss=1.52, val_accuracy=0.644, lr=0.1] 28%|██▊       | 42/150 [17:56<44:41, 24.83s/epoch, loss=1.13, accuracy=0.756, val_loss=2.35, val_accuracy=0.447, lr=0.1] 29%|██▊       | 43/150 [18:21<44:12, 24.79s/epoch, loss=1.13, accuracy=0.758, val_loss=2.09, val_accuracy=0.448, lr=0.1] 29%|██▉       | 44/150 [18:46<43:49, 24.80s/epoch, loss=1.13, accuracy=0.757, val_loss=1.86, val_accuracy=0.544, lr=0.1] 30%|███       | 45/150 [19:11<43:45, 25.00s/epoch, loss=1.13, accuracy=0.757, val_loss=1.57, val_accuracy=0.59, lr=0.1]  31%|███       | 46/150 [19:37<43:33, 25.13s/epoch, loss=1.13, accuracy=0.755, val_loss=2.83, val_accuracy=0.389, lr=0.1] 31%|███▏      | 47/150 [20:02<43:18, 25.23s/epoch, loss=1.12, accuracy=0.758, val_loss=2.51, val_accuracy=0.474, lr=0.1] 32%|███▏      | 48/150 [20:26<42:12, 24.83s/epoch, loss=1.12, accuracy=0.756, val_loss=1.84, val_accuracy=0.577, lr=0.1] 33%|███▎      | 49/150 [20:50<41:11, 24.47s/epoch, loss=1.13, accuracy=0.758, val_loss=1.97, val_accuracy=0.462, lr=0.1] 33%|███▎      | 50/150 [21:13<40:17, 24.18s/epoch, loss=1.13, accuracy=0.756, val_loss=2.73, val_accuracy=0.294, lr=0.1] 34%|███▍      | 51/150 [21:37<39:37, 24.01s/epoch, loss=1.13, accuracy=0.758, val_loss=1.82, val_accuracy=0.546, lr=0.1] 35%|███▍      | 52/150 [22:01<39:04, 23.92s/epoch, loss=1.13, accuracy=0.758, val_loss=4.15, val_accuracy=0.249, lr=0.1] 35%|███▌      | 53/150 [22:24<38:40, 23.92s/epoch, loss=1.12, accuracy=0.757, val_loss=2.21, val_accuracy=0.484, lr=0.1] 36%|███▌      | 54/150 [22:49<38:24, 24.00s/epoch, loss=1.12, accuracy=0.76, val_loss=6.07, val_accuracy=0.214, lr=0.1]  37%|███▋      | 55/150 [23:14<38:47, 24.50s/epoch, loss=1.12, accuracy=0.757, val_loss=1.77, val_accuracy=0.525, lr=0.1] 37%|███▋      | 56/150 [23:40<38:47, 24.77s/epoch, loss=1.12, accuracy=0.758, val_loss=2.94, val_accuracy=0.265, lr=0.1] 38%|███▊      | 57/150 [24:05<38:44, 25.00s/epoch, loss=1.12, accuracy=0.756, val_loss=3.68, val_accuracy=0.4, lr=0.1]   39%|███▊      | 58/150 [24:30<38:08, 24.87s/epoch, loss=1.12, accuracy=0.759, val_loss=2.9, val_accuracy=0.315, lr=0.1] 39%|███▉      | 59/150 [24:54<37:15, 24.56s/epoch, loss=1.13, accuracy=0.757, val_loss=3.28, val_accuracy=0.307, lr=0.1] 40%|████      | 60/150 [25:18<36:32, 24.36s/epoch, loss=1.1, accuracy=0.763, val_loss=1.83, val_accuracy=0.502, lr=0.1]  41%|████      | 61/150 [25:42<36:03, 24.31s/epoch, loss=1.12, accuracy=0.759, val_loss=1.78, val_accuracy=0.539, lr=0.1] 41%|████▏     | 62/150 [26:07<36:06, 24.61s/epoch, loss=0.902, accuracy=0.819, val_loss=0.959, val_accuracy=0.782, lr=0.01] 42%|████▏     | 63/150 [26:33<36:04, 24.87s/epoch, loss=0.724, accuracy=0.85, val_loss=0.874, val_accuracy=0.785, lr=0.01]  43%|████▎     | 64/150 [26:58<35:51, 25.02s/epoch, loss=0.644, accuracy=0.857, val_loss=0.803, val_accuracy=0.8, lr=0.01]  43%|████▎     | 65/150 [27:23<35:21, 24.96s/epoch, loss=0.599, accuracy=0.862, val_loss=0.74, val_accuracy=0.811, lr=0.01] 44%|████▍     | 66/150 [27:46<34:24, 24.58s/epoch, loss=0.578, accuracy=0.864, val_loss=0.745, val_accuracy=0.805, lr=0.01] 45%|████▍     | 67/150 [28:10<33:45, 24.40s/epoch, loss=0.569, accuracy=0.865, val_loss=0.81, val_accuracy=0.788, lr=0.01]  45%|████▌     | 68/150 [28:34<33:10, 24.28s/epoch, loss=0.561, accuracy=0.866, val_loss=0.8, val_accuracy=0.787, lr=0.01]  46%|████▌     | 69/150 [29:00<33:13, 24.61s/epoch, loss=0.56, accuracy=0.866, val_loss=0.646, val_accuracy=0.835, lr=0.01] 47%|████▋     | 70/150 [29:25<33:06, 24.84s/epoch, loss=0.553, accuracy=0.869, val_loss=0.921, val_accuracy=0.755, lr=0.01] 47%|████▋     | 71/150 [29:50<32:53, 24.98s/epoch, loss=0.554, accuracy=0.87, val_loss=0.757, val_accuracy=0.801, lr=0.01]  48%|████▊     | 72/150 [30:15<32:24, 24.93s/epoch, loss=0.551, accuracy=0.873, val_loss=0.747, val_accuracy=0.813, lr=0.01] 49%|████▊     | 73/150 [30:39<31:30, 24.55s/epoch, loss=0.549, accuracy=0.873, val_loss=0.876, val_accuracy=0.77, lr=0.01]  49%|████▉     | 74/150 [31:03<30:50, 24.35s/epoch, loss=0.551, accuracy=0.874, val_loss=0.957, val_accuracy=0.729, lr=0.01] 50%|█████     | 75/150 [31:27<30:18, 24.24s/epoch, loss=0.55, accuracy=0.876, val_loss=1.01, val_accuracy=0.752, lr=0.01]   51%|█████     | 76/150 [31:52<30:19, 24.58s/epoch, loss=0.545, accuracy=0.875, val_loss=0.831, val_accuracy=0.784, lr=0.01] 51%|█████▏    | 77/150 [32:18<30:12, 24.83s/epoch, loss=0.553, accuracy=0.876, val_loss=0.855, val_accuracy=0.781, lr=0.01] 52%|█████▏    | 78/150 [32:43<29:58, 24.97s/epoch, loss=0.547, accuracy=0.878, val_loss=0.966, val_accuracy=0.746, lr=0.01] 53%|█████▎    | 79/150 [33:08<29:37, 25.04s/epoch, loss=0.543, accuracy=0.881, val_loss=0.814, val_accuracy=0.798, lr=0.01] 53%|█████▎    | 80/150 [33:32<28:48, 24.69s/epoch, loss=0.546, accuracy=0.88, val_loss=0.884, val_accuracy=0.792, lr=0.01]  54%|█████▍    | 81/150 [33:56<28:05, 24.43s/epoch, loss=0.551, accuracy=0.879, val_loss=0.992, val_accuracy=0.755, lr=0.01] 55%|█████▍    | 82/150 [34:20<27:29, 24.26s/epoch, loss=0.541, accuracy=0.884, val_loss=1.02, val_accuracy=0.766, lr=0.01]  55%|█████▌    | 83/150 [34:45<27:25, 24.56s/epoch, loss=0.549, accuracy=0.881, val_loss=0.915, val_accuracy=0.759, lr=0.01] 56%|█████▌    | 84/150 [35:10<27:14, 24.77s/epoch, loss=0.539, accuracy=0.884, val_loss=0.888, val_accuracy=0.775, lr=0.01] 57%|█████▋    | 85/150 [35:35<27:00, 24.93s/epoch, loss=0.546, accuracy=0.882, val_loss=0.775, val_accuracy=0.805, lr=0.01] 57%|█████▋    | 86/150 [36:01<26:37, 24.96s/epoch, loss=0.546, accuracy=0.883, val_loss=0.683, val_accuracy=0.837, lr=0.01] 58%|█████▊    | 87/150 [36:24<25:46, 24.55s/epoch, loss=0.541, accuracy=0.885, val_loss=0.77, val_accuracy=0.816, lr=0.01]  59%|█████▊    | 88/150 [36:48<25:05, 24.28s/epoch, loss=0.546, accuracy=0.883, val_loss=0.79, val_accuracy=0.81, lr=0.01]  59%|█████▉    | 89/150 [37:11<24:30, 24.11s/epoch, loss=0.543, accuracy=0.884, val_loss=0.95, val_accuracy=0.759, lr=0.01] 60%|██████    | 90/150 [37:36<24:18, 24.31s/epoch, loss=0.55, accuracy=0.883, val_loss=0.908, val_accuracy=0.763, lr=0.01] 61%|██████    | 91/150 [38:01<24:07, 24.53s/epoch, loss=0.543, accuracy=0.888, val_loss=1.07, val_accuracy=0.733, lr=0.01] 61%|██████▏   | 92/150 [38:26<23:52, 24.71s/epoch, loss=0.469, accuracy=0.911, val_loss=0.529, val_accuracy=0.89, lr=0.001] 62%|██████▏   | 93/150 [38:52<23:36, 24.86s/epoch, loss=0.417, accuracy=0.928, val_loss=0.51, val_accuracy=0.896, lr=0.001] 63%|██████▎   | 94/150 [39:15<22:52, 24.52s/epoch, loss=0.392, accuracy=0.935, val_loss=0.497, val_accuracy=0.896, lr=0.001] 63%|██████▎   | 95/150 [39:39<22:12, 24.23s/epoch, loss=0.376, accuracy=0.937, val_loss=0.487, val_accuracy=0.898, lr=0.001] 64%|██████▍   | 96/150 [40:03<21:43, 24.13s/epoch, loss=0.363, accuracy=0.941, val_loss=0.481, val_accuracy=0.9, lr=0.001]   65%|██████▍   | 97/150 [40:27<21:26, 24.27s/epoch, loss=0.35, accuracy=0.944, val_loss=0.471, val_accuracy=0.904, lr=0.001] 65%|██████▌   | 98/150 [40:53<21:16, 24.54s/epoch, loss=0.34, accuracy=0.945, val_loss=0.468, val_accuracy=0.903, lr=0.001] 66%|██████▌   | 99/150 [41:18<21:02, 24.75s/epoch, loss=0.331, accuracy=0.947, val_loss=0.466, val_accuracy=0.897, lr=0.001] 67%|██████▋   | 100/150 [41:43<20:45, 24.91s/epoch, loss=0.323, accuracy=0.948, val_loss=0.483, val_accuracy=0.896, lr=0.001] 67%|██████▋   | 101/150 [42:07<20:06, 24.62s/epoch, loss=0.315, accuracy=0.95, val_loss=0.456, val_accuracy=0.9, lr=0.001]    68%|██████▊   | 102/150 [42:31<19:29, 24.36s/epoch, loss=0.307, accuracy=0.951, val_loss=0.469, val_accuracy=0.899, lr=0.001] 69%|██████▊   | 103/150 [42:55<18:56, 24.19s/epoch, loss=0.299, accuracy=0.951, val_loss=0.46, val_accuracy=0.899, lr=0.001]  69%|██████▉   | 104/150 [43:19<18:37, 24.29s/epoch, loss=0.29, accuracy=0.954, val_loss=0.445, val_accuracy=0.902, lr=0.001] 70%|███████   | 105/150 [43:44<18:25, 24.56s/epoch, loss=0.284, accuracy=0.953, val_loss=0.461, val_accuracy=0.898, lr=0.001] 71%|███████   | 106/150 [44:09<18:07, 24.71s/epoch, loss=0.277, accuracy=0.955, val_loss=0.457, val_accuracy=0.9, lr=0.001]   71%|███████▏  | 107/150 [44:35<17:50, 24.91s/epoch, loss=0.273, accuracy=0.956, val_loss=0.502, val_accuracy=0.886, lr=0.001] 72%|███████▏  | 108/150 [44:59<17:13, 24.61s/epoch, loss=0.269, accuracy=0.956, val_loss=0.454, val_accuracy=0.899, lr=0.001] 73%|███████▎  | 109/150 [45:22<16:35, 24.28s/epoch, loss=0.263, accuracy=0.957, val_loss=0.446, val_accuracy=0.901, lr=0.001] 73%|███████▎  | 110/150 [45:46<16:04, 24.11s/epoch, loss=0.257, accuracy=0.958, val_loss=0.447, val_accuracy=0.896, lr=0.001] 74%|███████▍  | 111/150 [46:10<15:39, 24.10s/epoch, loss=0.254, accuracy=0.958, val_loss=0.477, val_accuracy=0.892, lr=0.001] 75%|███████▍  | 112/150 [46:35<15:27, 24.40s/epoch, loss=0.249, accuracy=0.959, val_loss=0.472, val_accuracy=0.892, lr=0.001] 75%|███████▌  | 113/150 [47:00<15:10, 24.60s/epoch, loss=0.247, accuracy=0.959, val_loss=0.477, val_accuracy=0.893, lr=0.001] 76%|███████▌  | 114/150 [47:25<14:51, 24.77s/epoch, loss=0.242, accuracy=0.959, val_loss=0.453, val_accuracy=0.899, lr=0.001] 77%|███████▋  | 115/150 [47:50<14:21, 24.61s/epoch, loss=0.238, accuracy=0.959, val_loss=0.456, val_accuracy=0.894, lr=0.001] 77%|███████▋  | 116/150 [48:13<13:47, 24.35s/epoch, loss=0.231, accuracy=0.961, val_loss=0.462, val_accuracy=0.895, lr=0.001] 78%|███████▊  | 117/150 [48:37<13:16, 24.14s/epoch, loss=0.234, accuracy=0.96, val_loss=0.477, val_accuracy=0.892, lr=0.001]  79%|███████▊  | 118/150 [49:01<12:50, 24.08s/epoch, loss=0.228, accuracy=0.962, val_loss=0.458, val_accuracy=0.895, lr=0.001] 79%|███████▉  | 119/150 [49:26<12:36, 24.41s/epoch, loss=0.229, accuracy=0.961, val_loss=0.497, val_accuracy=0.885, lr=0.001] 80%|████████  | 120/150 [49:51<12:17, 24.58s/epoch, loss=0.226, accuracy=0.961, val_loss=0.445, val_accuracy=0.898, lr=0.001] 81%|████████  | 121/150 [50:16<11:57, 24.74s/epoch, loss=0.222, accuracy=0.962, val_loss=0.473, val_accuracy=0.889, lr=0.001] 81%|████████▏ | 122/150 [50:41<11:30, 24.67s/epoch, loss=0.201, accuracy=0.971, val_loss=0.406, val_accuracy=0.907, lr=1e-04] 82%|████████▏ | 123/150 [51:04<10:58, 24.38s/epoch, loss=0.192, accuracy=0.974, val_loss=0.403, val_accuracy=0.909, lr=1e-04] 83%|████████▎ | 124/150 [51:28<10:30, 24.25s/epoch, loss=0.188, accuracy=0.975, val_loss=0.403, val_accuracy=0.909, lr=1e-04] 83%|████████▎ | 125/150 [51:52<10:03, 24.13s/epoch, loss=0.185, accuracy=0.977, val_loss=0.401, val_accuracy=0.91, lr=1e-04]  84%|████████▍ | 126/150 [52:17<09:46, 24.45s/epoch, loss=0.183, accuracy=0.977, val_loss=0.402, val_accuracy=0.909, lr=1e-04] 85%|████████▍ | 127/150 [52:43<09:28, 24.72s/epoch, loss=0.182, accuracy=0.978, val_loss=0.402, val_accuracy=0.909, lr=1e-04] 85%|████████▌ | 128/150 [53:08<09:07, 24.87s/epoch, loss=0.18, accuracy=0.978, val_loss=0.403, val_accuracy=0.907, lr=1e-04]  86%|████████▌ | 129/150 [53:33<08:41, 24.82s/epoch, loss=0.179, accuracy=0.978, val_loss=0.404, val_accuracy=0.909, lr=1e-04] 87%|████████▋ | 130/150 [53:56<08:08, 24.44s/epoch, loss=0.176, accuracy=0.98, val_loss=0.403, val_accuracy=0.91, lr=1e-04]   87%|████████▋ | 131/150 [54:20<07:41, 24.30s/epoch, loss=0.176, accuracy=0.98, val_loss=0.403, val_accuracy=0.91, lr=1e-04] 88%|████████▊ | 132/150 [54:44<07:14, 24.14s/epoch, loss=0.175, accuracy=0.979, val_loss=0.403, val_accuracy=0.909, lr=1e-04] 89%|████████▊ | 133/150 [55:09<06:55, 24.44s/epoch, loss=0.173, accuracy=0.98, val_loss=0.406, val_accuracy=0.909, lr=1e-04]  89%|████████▉ | 134/150 [55:34<06:34, 24.67s/epoch, loss=0.172, accuracy=0.981, val_loss=0.406, val_accuracy=0.91, lr=1e-04] 90%|█████████ | 135/150 [56:00<06:12, 24.86s/epoch, loss=0.171, accuracy=0.98, val_loss=0.409, val_accuracy=0.91, lr=1e-04]  91%|█████████ | 136/150 [56:24<05:46, 24.74s/epoch, loss=0.169, accuracy=0.982, val_loss=0.406, val_accuracy=0.91, lr=1e-04] 91%|█████████▏| 137/150 [56:47<05:15, 24.23s/epoch, loss=0.168, accuracy=0.981, val_loss=0.406, val_accuracy=0.91, lr=5e-5]  92%|█████████▏| 138/150 [57:11<04:50, 24.19s/epoch, loss=0.169, accuracy=0.981, val_loss=0.404, val_accuracy=0.911, lr=5e-5] 93%|█████████▎| 139/150 [57:35<04:24, 24.01s/epoch, loss=0.167, accuracy=0.982, val_loss=0.404, val_accuracy=0.911, lr=5e-5] 93%|█████████▎| 140/150 [57:59<03:59, 23.96s/epoch, loss=0.166, accuracy=0.982, val_loss=0.403, val_accuracy=0.911, lr=5e-5] 94%|█████████▍| 141/150 [58:24<03:38, 24.30s/epoch, loss=0.164, accuracy=0.983, val_loss=0.406, val_accuracy=0.911, lr=5e-5] 95%|█████████▍| 142/150 [58:49<03:16, 24.54s/epoch, loss=0.166, accuracy=0.982, val_loss=0.405, val_accuracy=0.911, lr=5e-5] 95%|█████████▌| 143/150 [59:14<02:53, 24.72s/epoch, loss=0.165, accuracy=0.983, val_loss=0.405, val_accuracy=0.912, lr=5e-5] 96%|█████████▌| 144/150 [59:39<02:29, 24.87s/epoch, loss=0.166, accuracy=0.982, val_loss=0.404, val_accuracy=0.911, lr=5e-5] 97%|█████████▋| 145/150 [1:00:03<02:03, 24.63s/epoch, loss=0.164, accuracy=0.983, val_loss=0.406, val_accuracy=0.91, lr=5e-5] 97%|█████████▋| 146/150 [1:00:28<01:38, 24.60s/epoch, loss=0.162, accuracy=0.984, val_loss=0.406, val_accuracy=0.91, lr=5e-5] 98%|█████████▊| 147/150 [1:00:53<01:14, 24.79s/epoch, loss=0.162, accuracy=0.984, val_loss=0.408, val_accuracy=0.911, lr=5e-5] 99%|█████████▊| 148/150 [1:01:18<00:49, 24.89s/epoch, loss=0.163, accuracy=0.983, val_loss=0.406, val_accuracy=0.91, lr=5e-5]  99%|█████████▉| 149/150 [1:01:44<00:25, 25.07s/epoch, loss=0.163, accuracy=0.983, val_loss=0.407, val_accuracy=0.91, lr=5e-5]100%|██████████| 150/150 [1:02:08<00:00, 24.93s/epoch, loss=0.164, accuracy=0.982, val_loss=0.406, val_accuracy=0.911, lr=5e-5]100%|██████████| 150/150 [1:02:08<00:00, 24.86s/epoch, loss=0.164, accuracy=0.982, val_loss=0.406, val_accuracy=0.911, lr=5e-5]
Using real-time data augmentation.
Only one model saved

Loading model: 10_02_cifar10_ResNet20v1.h5
Test score: 0.4061737060546875
Test accuracy: 0.9110999703407288


* * * Run SGD for ID = 10_3. * * *


2024-03-12 23:31:51.771434: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-12 23:31:54.391692: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-12 23:31:54.392983: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-12 23:31:54.433907: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:86:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-12 23:31:54.433952: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-12 23:31:54.437271: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-12 23:31:54.437354: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-12 23:31:54.439700: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-12 23:31:54.440876: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-12 23:31:54.443651: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-12 23:31:54.445219: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-12 23:31:54.450477: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-12 23:31:54.451151: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-12 23:31:54.451241: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-12 23:31:55.614228: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-12 23:31:55.615294: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-12 23:31:55.616414: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:86:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-12 23:31:55.616450: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-12 23:31:55.616494: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-12 23:31:55.616506: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-12 23:31:55.616517: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-12 23:31:55.616531: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-12 23:31:55.616542: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-12 23:31:55.616555: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-12 23:31:55.616569: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-12 23:31:55.617053: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-12 23:31:55.617094: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-12 23:31:56.234307: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-12 23:31:56.234362: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-12 23:31:56.234371: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-12 23:31:56.235418: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:86:00.0, compute capability: 6.1)
{'id': '10_03', 'seed': 3, 'out_folder': 'results/epoch_budget_2', 'batch_size': 128, 'epochs': 150, 'validation_split': 0.0, 'checkpointing': False, 'checkpoint_every': -1, 'hold_out_validation_split': 0.0, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'num_classes': 10, 'SSE_lr': False, 'test_time_augmentation': False, 'debug': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
y_train shape: (50000, 10)
x_val shape: (10000, 32, 32, 3)
y_val shape: (10000, 10)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/150 [00:00<?, ?epoch/s]2024-03-12 23:31:56.827845: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-12 23:31:56.840014: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-03-12 23:31:58.671733: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-12 23:31:58.947884: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-12 23:31:59.964402: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-12 23:32:00.009329: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/150 [01:07<2:46:50, 67.19s/epoch, loss=2.87, accuracy=0.398, val_loss=2.9, val_accuracy=0.26, lr=0.1]  1%|▏         | 2/150 [01:32<1:45:33, 42.79s/epoch, loss=1.46, accuracy=0.597, val_loss=2.45, val_accuracy=0.432, lr=0.1]  2%|▏         | 3/150 [01:57<1:24:33, 34.52s/epoch, loss=1.3, accuracy=0.672, val_loss=2.12, val_accuracy=0.479, lr=0.1]   3%|▎         | 4/150 [02:22<1:14:44, 30.71s/epoch, loss=1.26, accuracy=0.696, val_loss=2.34, val_accuracy=0.432, lr=0.1]  3%|▎         | 5/150 [02:47<1:09:42, 28.85s/epoch, loss=1.24, accuracy=0.712, val_loss=2.27, val_accuracy=0.484, lr=0.1]  4%|▍         | 6/150 [03:13<1:06:29, 27.71s/epoch, loss=1.22, accuracy=0.719, val_loss=1.95, val_accuracy=0.506, lr=0.1]  5%|▍         | 7/150 [03:38<1:04:17, 26.98s/epoch, loss=1.21, accuracy=0.725, val_loss=1.65, val_accuracy=0.584, lr=0.1]  5%|▌         | 8/150 [04:03<1:02:14, 26.30s/epoch, loss=1.21, accuracy=0.729, val_loss=3.84, val_accuracy=0.289, lr=0.1]  6%|▌         | 9/150 [04:28<1:00:38, 25.81s/epoch, loss=1.19, accuracy=0.733, val_loss=1.79, val_accuracy=0.512, lr=0.1]  7%|▋         | 10/150 [04:54<1:00:01, 25.72s/epoch, loss=1.19, accuracy=0.735, val_loss=2.11, val_accuracy=0.501, lr=0.1]  7%|▋         | 11/150 [05:19<59:32, 25.70s/epoch, loss=1.19, accuracy=0.738, val_loss=1.77, val_accuracy=0.529, lr=0.1]    8%|▊         | 12/150 [05:45<59:05, 25.69s/epoch, loss=1.19, accuracy=0.739, val_loss=2.3, val_accuracy=0.389, lr=0.1]   9%|▊         | 13/150 [06:10<58:16, 25.52s/epoch, loss=1.18, accuracy=0.744, val_loss=2.55, val_accuracy=0.415, lr=0.1]  9%|▉         | 14/150 [06:34<56:56, 25.12s/epoch, loss=1.18, accuracy=0.743, val_loss=2.29, val_accuracy=0.446, lr=0.1] 10%|█         | 15/150 [07:00<56:44, 25.22s/epoch, loss=1.18, accuracy=0.745, val_loss=1.61, val_accuracy=0.582, lr=0.1] 11%|█         | 16/150 [07:25<56:37, 25.36s/epoch, loss=1.17, accuracy=0.748, val_loss=1.69, val_accuracy=0.59, lr=0.1]  11%|█▏        | 17/150 [07:51<56:19, 25.41s/epoch, loss=1.18, accuracy=0.747, val_loss=2.22, val_accuracy=0.415, lr=0.1] 12%|█▏        | 18/150 [08:16<55:38, 25.29s/epoch, loss=1.17, accuracy=0.746, val_loss=1.83, val_accuracy=0.492, lr=0.1] 13%|█▎        | 19/150 [08:40<54:23, 24.92s/epoch, loss=1.17, accuracy=0.747, val_loss=2.88, val_accuracy=0.39, lr=0.1]  13%|█▎        | 20/150 [09:06<54:30, 25.16s/epoch, loss=1.16, accuracy=0.749, val_loss=1.74, val_accuracy=0.542, lr=0.1] 14%|█▍        | 21/150 [09:31<54:20, 25.28s/epoch, loss=1.17, accuracy=0.751, val_loss=1.95, val_accuracy=0.522, lr=0.1] 15%|█▍        | 22/150 [09:57<54:12, 25.41s/epoch, loss=1.16, accuracy=0.749, val_loss=1.82, val_accuracy=0.525, lr=0.1] 15%|█▌        | 23/150 [10:22<53:43, 25.38s/epoch, loss=1.16, accuracy=0.749, val_loss=1.69, val_accuracy=0.58, lr=0.1]  16%|█▌        | 24/150 [10:47<52:38, 25.07s/epoch, loss=1.15, accuracy=0.752, val_loss=1.72, val_accuracy=0.559, lr=0.1] 17%|█▋        | 25/150 [11:12<52:33, 25.23s/epoch, loss=1.15, accuracy=0.755, val_loss=1.86, val_accuracy=0.505, lr=0.1] 17%|█▋        | 26/150 [11:38<52:28, 25.39s/epoch, loss=1.15, accuracy=0.752, val_loss=1.92, val_accuracy=0.512, lr=0.1] 18%|█▊        | 27/150 [12:04<52:11, 25.46s/epoch, loss=1.15, accuracy=0.753, val_loss=2.68, val_accuracy=0.412, lr=0.1] 19%|█▊        | 28/150 [12:29<51:38, 25.40s/epoch, loss=1.15, accuracy=0.752, val_loss=1.81, val_accuracy=0.569, lr=0.1] 19%|█▉        | 29/150 [12:53<50:30, 25.04s/epoch, loss=1.14, accuracy=0.753, val_loss=2.36, val_accuracy=0.394, lr=0.1] 20%|██        | 30/150 [13:18<50:12, 25.11s/epoch, loss=1.14, accuracy=0.755, val_loss=2.78, val_accuracy=0.312, lr=0.1] 21%|██        | 31/150 [13:44<50:00, 25.21s/epoch, loss=1.14, accuracy=0.755, val_loss=3.89, val_accuracy=0.174, lr=0.1] 21%|██▏       | 32/150 [14:09<49:50, 25.34s/epoch, loss=1.14, accuracy=0.753, val_loss=1.66, val_accuracy=0.625, lr=0.1] 22%|██▏       | 33/150 [14:35<49:28, 25.37s/epoch, loss=1.14, accuracy=0.756, val_loss=1.62, val_accuracy=0.615, lr=0.1] 23%|██▎       | 34/150 [14:59<48:20, 25.01s/epoch, loss=1.14, accuracy=0.754, val_loss=1.83, val_accuracy=0.48, lr=0.1]  23%|██▎       | 35/150 [15:24<47:53, 24.99s/epoch, loss=1.13, accuracy=0.755, val_loss=1.38, val_accuracy=0.685, lr=0.1] 24%|██▍       | 36/150 [15:49<47:41, 25.10s/epoch, loss=1.14, accuracy=0.757, val_loss=1.88, val_accuracy=0.481, lr=0.1] 25%|██▍       | 37/150 [16:15<47:28, 25.20s/epoch, loss=1.14, accuracy=0.754, val_loss=2.2, val_accuracy=0.411, lr=0.1]  25%|██▌       | 38/150 [16:40<47:12, 25.29s/epoch, loss=1.14, accuracy=0.755, val_loss=2.32, val_accuracy=0.441, lr=0.1] 26%|██▌       | 39/150 [17:05<46:17, 25.02s/epoch, loss=1.14, accuracy=0.755, val_loss=2.05, val_accuracy=0.448, lr=0.1] 27%|██▋       | 40/150 [17:29<45:39, 24.90s/epoch, loss=1.14, accuracy=0.755, val_loss=1.94, val_accuracy=0.551, lr=0.1] 27%|██▋       | 41/150 [17:55<45:35, 25.09s/epoch, loss=1.13, accuracy=0.757, val_loss=3.11, val_accuracy=0.353, lr=0.1] 28%|██▊       | 42/150 [18:20<45:20, 25.19s/epoch, loss=1.13, accuracy=0.757, val_loss=1.91, val_accuracy=0.511, lr=0.1] 29%|██▊       | 43/150 [18:46<45:08, 25.31s/epoch, loss=1.14, accuracy=0.755, val_loss=2.03, val_accuracy=0.426, lr=0.1] 29%|██▉       | 44/150 [19:11<44:23, 25.12s/epoch, loss=1.13, accuracy=0.757, val_loss=2.1, val_accuracy=0.475, lr=0.1]  30%|███       | 45/150 [19:36<43:57, 25.12s/epoch, loss=1.12, accuracy=0.759, val_loss=7.78, val_accuracy=0.23, lr=0.1] 31%|███       | 46/150 [20:02<43:57, 25.36s/epoch, loss=1.12, accuracy=0.76, val_loss=3.09, val_accuracy=0.323, lr=0.1] 31%|███▏      | 47/150 [20:27<43:41, 25.45s/epoch, loss=1.12, accuracy=0.758, val_loss=3.28, val_accuracy=0.186, lr=0.1] 32%|███▏      | 48/150 [20:53<43:22, 25.51s/epoch, loss=1.13, accuracy=0.757, val_loss=2.66, val_accuracy=0.333, lr=0.1] 33%|███▎      | 49/150 [21:18<42:34, 25.29s/epoch, loss=1.13, accuracy=0.756, val_loss=1.52, val_accuracy=0.607, lr=0.1] 33%|███▎      | 50/150 [21:42<41:34, 24.95s/epoch, loss=1.12, accuracy=0.757, val_loss=2.24, val_accuracy=0.417, lr=0.1] 34%|███▍      | 51/150 [22:06<40:42, 24.67s/epoch, loss=1.12, accuracy=0.76, val_loss=1.82, val_accuracy=0.53, lr=0.1]   35%|███▍      | 52/150 [22:32<40:47, 24.98s/epoch, loss=1.13, accuracy=0.757, val_loss=1.95, val_accuracy=0.475, lr=0.1] 35%|███▌      | 53/150 [22:57<40:49, 25.25s/epoch, loss=1.12, accuracy=0.757, val_loss=1.92, val_accuracy=0.511, lr=0.1] 36%|███▌      | 54/150 [23:23<40:35, 25.37s/epoch, loss=1.12, accuracy=0.758, val_loss=1.55, val_accuracy=0.611, lr=0.1] 37%|███▋      | 55/150 [23:48<40:01, 25.27s/epoch, loss=1.12, accuracy=0.758, val_loss=1.64, val_accuracy=0.61, lr=0.1]  37%|███▋      | 56/150 [24:13<39:12, 25.03s/epoch, loss=1.12, accuracy=0.758, val_loss=1.64, val_accuracy=0.587, lr=0.1] 38%|███▊      | 57/150 [24:38<38:50, 25.05s/epoch, loss=1.12, accuracy=0.757, val_loss=1.77, val_accuracy=0.558, lr=0.1] 39%|███▊      | 58/150 [25:03<38:44, 25.27s/epoch, loss=1.12, accuracy=0.757, val_loss=1.3, val_accuracy=0.701, lr=0.1]  39%|███▉      | 59/150 [25:29<38:29, 25.38s/epoch, loss=1.12, accuracy=0.757, val_loss=3.13, val_accuracy=0.312, lr=0.1] 40%|████      | 60/150 [25:55<38:12, 25.47s/epoch, loss=1.12, accuracy=0.756, val_loss=4.57, val_accuracy=0.29, lr=0.1]  41%|████      | 61/150 [26:19<37:19, 25.16s/epoch, loss=1.12, accuracy=0.758, val_loss=2.17, val_accuracy=0.452, lr=0.1] 41%|████▏     | 62/150 [26:44<36:35, 24.95s/epoch, loss=0.915, accuracy=0.817, val_loss=1.01, val_accuracy=0.767, lr=0.01] 42%|████▏     | 63/150 [27:09<36:30, 25.18s/epoch, loss=0.728, accuracy=0.851, val_loss=0.749, val_accuracy=0.831, lr=0.01] 43%|████▎     | 64/150 [27:35<36:18, 25.33s/epoch, loss=0.646, accuracy=0.858, val_loss=0.757, val_accuracy=0.814, lr=0.01] 43%|████▎     | 65/150 [28:01<36:02, 25.44s/epoch, loss=0.601, accuracy=0.862, val_loss=0.684, val_accuracy=0.83, lr=0.01]  44%|████▍     | 66/150 [28:26<35:23, 25.28s/epoch, loss=0.58, accuracy=0.865, val_loss=0.777, val_accuracy=0.8, lr=0.01]   45%|████▍     | 67/150 [28:50<34:31, 24.96s/epoch, loss=0.566, accuracy=0.865, val_loss=0.794, val_accuracy=0.79, lr=0.01] 45%|████▌     | 68/150 [29:15<34:14, 25.05s/epoch, loss=0.568, accuracy=0.865, val_loss=0.799, val_accuracy=0.797, lr=0.01] 46%|████▌     | 69/150 [29:41<34:04, 25.24s/epoch, loss=0.558, accuracy=0.869, val_loss=0.871, val_accuracy=0.766, lr=0.01] 47%|████▋     | 70/150 [30:06<33:48, 25.36s/epoch, loss=0.556, accuracy=0.868, val_loss=0.8, val_accuracy=0.783, lr=0.01]   47%|████▋     | 71/150 [30:32<33:22, 25.35s/epoch, loss=0.551, accuracy=0.869, val_loss=0.772, val_accuracy=0.801, lr=0.01] 48%|████▊     | 72/150 [30:56<32:32, 25.03s/epoch, loss=0.552, accuracy=0.872, val_loss=0.798, val_accuracy=0.795, lr=0.01] 49%|████▊     | 73/150 [31:20<31:47, 24.78s/epoch, loss=0.55, accuracy=0.873, val_loss=0.799, val_accuracy=0.793, lr=0.01]  49%|████▉     | 74/150 [31:46<31:41, 25.01s/epoch, loss=0.553, accuracy=0.875, val_loss=0.895, val_accuracy=0.755, lr=0.01] 50%|█████     | 75/150 [32:12<31:35, 25.27s/epoch, loss=0.55, accuracy=0.876, val_loss=0.741, val_accuracy=0.813, lr=0.01]  51%|█████     | 76/150 [32:37<31:19, 25.40s/epoch, loss=0.548, accuracy=0.878, val_loss=1.06, val_accuracy=0.717, lr=0.01] 51%|█████▏    | 77/150 [33:03<30:56, 25.43s/epoch, loss=0.552, accuracy=0.876, val_loss=0.922, val_accuracy=0.772, lr=0.01] 52%|█████▏    | 78/150 [33:27<30:04, 25.06s/epoch, loss=0.547, accuracy=0.879, val_loss=0.752, val_accuracy=0.816, lr=0.01] 53%|█████▎    | 79/150 [33:52<29:34, 24.99s/epoch, loss=0.549, accuracy=0.879, val_loss=1.04, val_accuracy=0.729, lr=0.01]  53%|█████▎    | 80/150 [34:18<29:25, 25.21s/epoch, loss=0.547, accuracy=0.88, val_loss=0.764, val_accuracy=0.812, lr=0.01] 54%|█████▍    | 81/150 [34:43<29:06, 25.31s/epoch, loss=0.548, accuracy=0.88, val_loss=1.05, val_accuracy=0.722, lr=0.01]  55%|█████▍    | 82/150 [35:09<28:49, 25.44s/epoch, loss=0.551, accuracy=0.88, val_loss=0.873, val_accuracy=0.775, lr=0.01] 55%|█████▌    | 83/150 [35:34<28:08, 25.20s/epoch, loss=0.547, accuracy=0.882, val_loss=1.06, val_accuracy=0.726, lr=0.01] 56%|█████▌    | 84/150 [35:58<27:36, 25.10s/epoch, loss=0.545, accuracy=0.883, val_loss=1.1, val_accuracy=0.719, lr=0.01]  57%|█████▋    | 85/150 [36:24<27:24, 25.30s/epoch, loss=0.554, accuracy=0.88, val_loss=0.818, val_accuracy=0.8, lr=0.01]  57%|█████▋    | 86/150 [36:50<27:06, 25.41s/epoch, loss=0.549, accuracy=0.883, val_loss=1.5, val_accuracy=0.705, lr=0.01] 58%|█████▊    | 87/150 [37:15<26:42, 25.43s/epoch, loss=0.547, accuracy=0.883, val_loss=1.01, val_accuracy=0.751, lr=0.01] 59%|█████▊    | 88/150 [37:41<26:13, 25.38s/epoch, loss=0.549, accuracy=0.885, val_loss=0.729, val_accuracy=0.823, lr=0.01] 59%|█████▉    | 89/150 [38:05<25:31, 25.10s/epoch, loss=0.549, accuracy=0.882, val_loss=0.852, val_accuracy=0.787, lr=0.01] 60%|██████    | 90/150 [38:30<25:08, 25.14s/epoch, loss=0.551, accuracy=0.884, val_loss=0.701, val_accuracy=0.835, lr=0.01] 61%|██████    | 91/150 [38:56<24:49, 25.24s/epoch, loss=0.546, accuracy=0.886, val_loss=1.01, val_accuracy=0.754, lr=0.01]  61%|██████▏   | 92/150 [39:21<24:25, 25.27s/epoch, loss=0.465, accuracy=0.914, val_loss=0.536, val_accuracy=0.889, lr=0.001] 62%|██████▏   | 93/150 [39:47<24:07, 25.39s/epoch, loss=0.418, accuracy=0.928, val_loss=0.514, val_accuracy=0.892, lr=0.001] 63%|██████▎   | 94/150 [40:11<23:27, 25.14s/epoch, loss=0.395, accuracy=0.936, val_loss=0.508, val_accuracy=0.895, lr=0.001] 63%|██████▎   | 95/150 [40:35<22:45, 24.82s/epoch, loss=0.379, accuracy=0.938, val_loss=0.497, val_accuracy=0.896, lr=0.001] 64%|██████▍   | 96/150 [41:01<22:28, 24.97s/epoch, loss=0.366, accuracy=0.942, val_loss=0.491, val_accuracy=0.898, lr=0.001] 65%|██████▍   | 97/150 [41:26<22:10, 25.11s/epoch, loss=0.354, accuracy=0.944, val_loss=0.488, val_accuracy=0.898, lr=0.001] 65%|██████▌   | 98/150 [41:52<21:52, 25.24s/epoch, loss=0.346, accuracy=0.945, val_loss=0.479, val_accuracy=0.9, lr=0.001]   66%|██████▌   | 99/150 [42:17<21:24, 25.20s/epoch, loss=0.335, accuracy=0.946, val_loss=0.475, val_accuracy=0.898, lr=0.001] 67%|██████▋   | 100/150 [42:41<20:48, 24.97s/epoch, loss=0.324, accuracy=0.948, val_loss=0.468, val_accuracy=0.898, lr=0.001] 67%|██████▋   | 101/150 [43:06<20:16, 24.83s/epoch, loss=0.317, accuracy=0.949, val_loss=0.474, val_accuracy=0.899, lr=0.001] 68%|██████▊   | 102/150 [43:31<20:04, 25.08s/epoch, loss=0.308, accuracy=0.951, val_loss=0.468, val_accuracy=0.9, lr=0.001]   69%|██████▊   | 103/150 [43:57<19:45, 25.22s/epoch, loss=0.299, accuracy=0.953, val_loss=0.461, val_accuracy=0.902, lr=0.001] 69%|██████▉   | 104/150 [44:22<19:23, 25.30s/epoch, loss=0.294, accuracy=0.953, val_loss=0.481, val_accuracy=0.897, lr=0.001] 70%|███████   | 105/150 [44:47<18:47, 25.06s/epoch, loss=0.287, accuracy=0.954, val_loss=0.473, val_accuracy=0.895, lr=0.001] 71%|███████   | 106/150 [45:11<18:13, 24.85s/epoch, loss=0.282, accuracy=0.954, val_loss=0.444, val_accuracy=0.902, lr=0.001] 71%|███████▏  | 107/150 [45:37<17:53, 24.96s/epoch, loss=0.274, accuracy=0.956, val_loss=0.459, val_accuracy=0.896, lr=0.001] 72%|███████▏  | 108/150 [46:02<17:33, 25.08s/epoch, loss=0.27, accuracy=0.958, val_loss=0.48, val_accuracy=0.891, lr=0.001]   73%|███████▎  | 109/150 [46:27<17:10, 25.14s/epoch, loss=0.263, accuracy=0.957, val_loss=0.453, val_accuracy=0.899, lr=0.001] 73%|███████▎  | 110/150 [46:53<16:49, 25.24s/epoch, loss=0.257, accuracy=0.959, val_loss=0.451, val_accuracy=0.895, lr=0.001] 74%|███████▍  | 111/150 [47:17<16:09, 24.86s/epoch, loss=0.255, accuracy=0.96, val_loss=0.451, val_accuracy=0.897, lr=0.001]  75%|███████▍  | 112/150 [47:41<15:36, 24.65s/epoch, loss=0.251, accuracy=0.959, val_loss=0.496, val_accuracy=0.89, lr=0.001] 75%|███████▌  | 113/150 [48:06<15:21, 24.90s/epoch, loss=0.247, accuracy=0.961, val_loss=0.455, val_accuracy=0.899, lr=0.001] 76%|███████▌  | 114/150 [48:31<14:59, 25.00s/epoch, loss=0.244, accuracy=0.96, val_loss=0.456, val_accuracy=0.894, lr=0.001]  77%|███████▋  | 115/150 [48:57<14:40, 25.16s/epoch, loss=0.239, accuracy=0.96, val_loss=0.484, val_accuracy=0.889, lr=0.001] 77%|███████▋  | 116/150 [49:22<14:09, 24.98s/epoch, loss=0.237, accuracy=0.961, val_loss=0.456, val_accuracy=0.896, lr=0.001] 78%|███████▊  | 117/150 [49:46<13:34, 24.67s/epoch, loss=0.234, accuracy=0.962, val_loss=0.473, val_accuracy=0.887, lr=0.001] 79%|███████▊  | 118/150 [50:10<13:03, 24.49s/epoch, loss=0.232, accuracy=0.961, val_loss=0.472, val_accuracy=0.892, lr=0.001] 79%|███████▉  | 119/150 [50:34<12:39, 24.52s/epoch, loss=0.228, accuracy=0.96, val_loss=0.455, val_accuracy=0.893, lr=0.001]  80%|████████  | 120/150 [51:00<12:23, 24.79s/epoch, loss=0.227, accuracy=0.963, val_loss=0.544, val_accuracy=0.874, lr=0.001] 81%|████████  | 121/150 [51:25<12:03, 24.96s/epoch, loss=0.225, accuracy=0.963, val_loss=0.512, val_accuracy=0.878, lr=0.001] 81%|████████▏ | 122/150 [51:50<11:43, 25.12s/epoch, loss=0.208, accuracy=0.968, val_loss=0.418, val_accuracy=0.905, lr=1e-04] 82%|████████▏ | 123/150 [52:15<11:11, 24.85s/epoch, loss=0.194, accuracy=0.975, val_loss=0.415, val_accuracy=0.906, lr=1e-04] 83%|████████▎ | 124/150 [52:39<10:41, 24.67s/epoch, loss=0.191, accuracy=0.976, val_loss=0.412, val_accuracy=0.906, lr=1e-04] 83%|████████▎ | 125/150 [53:04<10:18, 24.75s/epoch, loss=0.188, accuracy=0.976, val_loss=0.411, val_accuracy=0.907, lr=1e-04] 84%|████████▍ | 126/150 [53:29<09:59, 24.98s/epoch, loss=0.187, accuracy=0.977, val_loss=0.411, val_accuracy=0.907, lr=1e-04] 85%|████████▍ | 127/150 [53:55<09:36, 25.06s/epoch, loss=0.185, accuracy=0.977, val_loss=0.412, val_accuracy=0.906, lr=1e-04] 85%|████████▌ | 128/150 [54:20<09:11, 25.06s/epoch, loss=0.183, accuracy=0.978, val_loss=0.412, val_accuracy=0.907, lr=1e-04] 86%|████████▌ | 129/150 [54:44<08:42, 24.90s/epoch, loss=0.179, accuracy=0.979, val_loss=0.413, val_accuracy=0.906, lr=1e-04] 87%|████████▋ | 130/150 [55:08<08:13, 24.67s/epoch, loss=0.181, accuracy=0.979, val_loss=0.41, val_accuracy=0.909, lr=1e-04]  87%|████████▋ | 131/150 [55:33<07:49, 24.71s/epoch, loss=0.179, accuracy=0.979, val_loss=0.408, val_accuracy=0.906, lr=1e-04] 88%|████████▊ | 132/150 [55:58<07:27, 24.88s/epoch, loss=0.177, accuracy=0.98, val_loss=0.413, val_accuracy=0.909, lr=1e-04]  89%|████████▊ | 133/150 [56:24<07:04, 24.96s/epoch, loss=0.176, accuracy=0.98, val_loss=0.41, val_accuracy=0.907, lr=1e-04]  89%|████████▉ | 134/150 [56:49<06:41, 25.07s/epoch, loss=0.174, accuracy=0.981, val_loss=0.412, val_accuracy=0.909, lr=1e-04] 90%|█████████ | 135/150 [57:13<06:11, 24.79s/epoch, loss=0.173, accuracy=0.981, val_loss=0.412, val_accuracy=0.908, lr=1e-04] 91%|█████████ | 136/150 [57:37<05:44, 24.60s/epoch, loss=0.173, accuracy=0.981, val_loss=0.413, val_accuracy=0.909, lr=1e-04] 91%|█████████▏| 137/150 [58:02<05:20, 24.65s/epoch, loss=0.171, accuracy=0.982, val_loss=0.411, val_accuracy=0.908, lr=5e-5]  92%|█████████▏| 138/150 [58:27<04:58, 24.84s/epoch, loss=0.17, accuracy=0.982, val_loss=0.412, val_accuracy=0.909, lr=5e-5]  93%|█████████▎| 139/150 [58:53<04:34, 24.99s/epoch, loss=0.169, accuracy=0.983, val_loss=0.411, val_accuracy=0.907, lr=5e-5] 93%|█████████▎| 140/150 [59:18<04:10, 25.07s/epoch, loss=0.169, accuracy=0.982, val_loss=0.412, val_accuracy=0.908, lr=5e-5] 94%|█████████▍| 141/150 [59:42<03:41, 24.65s/epoch, loss=0.169, accuracy=0.982, val_loss=0.411, val_accuracy=0.909, lr=5e-5] 95%|█████████▍| 142/150 [1:00:06<03:15, 24.45s/epoch, loss=0.168, accuracy=0.982, val_loss=0.41, val_accuracy=0.91, lr=5e-5] 95%|█████████▌| 143/150 [1:00:30<02:52, 24.59s/epoch, loss=0.168, accuracy=0.982, val_loss=0.412, val_accuracy=0.908, lr=5e-5] 96%|█████████▌| 144/150 [1:00:56<02:28, 24.79s/epoch, loss=0.167, accuracy=0.983, val_loss=0.411, val_accuracy=0.909, lr=5e-5] 97%|█████████▋| 145/150 [1:01:21<02:04, 24.95s/epoch, loss=0.166, accuracy=0.983, val_loss=0.41, val_accuracy=0.909, lr=5e-5]  97%|█████████▋| 146/150 [1:01:46<01:40, 25.00s/epoch, loss=0.167, accuracy=0.983, val_loss=0.41, val_accuracy=0.909, lr=5e-5] 98%|█████████▊| 147/150 [1:02:10<01:14, 24.68s/epoch, loss=0.165, accuracy=0.983, val_loss=0.411, val_accuracy=0.908, lr=5e-5] 99%|█████████▊| 148/150 [1:02:34<00:48, 24.48s/epoch, loss=0.166, accuracy=0.982, val_loss=0.413, val_accuracy=0.908, lr=5e-5] 99%|█████████▉| 149/150 [1:02:59<00:24, 24.67s/epoch, loss=0.166, accuracy=0.982, val_loss=0.412, val_accuracy=0.908, lr=5e-5]100%|██████████| 150/150 [1:03:25<00:00, 24.88s/epoch, loss=0.164, accuracy=0.983, val_loss=0.414, val_accuracy=0.906, lr=5e-5]100%|██████████| 150/150 [1:03:25<00:00, 25.37s/epoch, loss=0.164, accuracy=0.983, val_loss=0.414, val_accuracy=0.906, lr=5e-5]
Using real-time data augmentation.
Only one model saved

Loading model: 10_03_cifar10_ResNet20v1.h5
Test score: 0.41390469670295715
Test accuracy: 0.906499981880188


* * * Run SGD for ID = 10_4. * * *


2024-03-13 00:35:25.668777: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 00:35:28.286103: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 00:35:28.287399: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-13 00:35:28.329958: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:86:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-13 00:35:28.330005: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 00:35:28.333328: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 00:35:28.333401: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 00:35:28.335688: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 00:35:28.336410: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 00:35:28.339093: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 00:35:28.340804: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 00:35:28.345977: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 00:35:28.346666: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 00:35:28.346764: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 00:35:29.545553: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-13 00:35:29.546235: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 00:35:29.547391: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:86:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-13 00:35:29.547432: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 00:35:29.547479: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 00:35:29.547495: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 00:35:29.547509: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 00:35:29.547526: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 00:35:29.547541: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 00:35:29.547559: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 00:35:29.547576: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 00:35:29.548159: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 00:35:29.548206: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 00:35:30.188896: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-13 00:35:30.188947: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-13 00:35:30.188959: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-13 00:35:30.190098: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:86:00.0, compute capability: 6.1)
{'id': '10_04', 'seed': 4, 'out_folder': 'results/epoch_budget_2', 'batch_size': 128, 'epochs': 150, 'validation_split': 0.0, 'checkpointing': False, 'checkpoint_every': -1, 'hold_out_validation_split': 0.0, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'num_classes': 10, 'SSE_lr': False, 'test_time_augmentation': False, 'debug': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
y_train shape: (50000, 10)
x_val shape: (10000, 32, 32, 3)
y_val shape: (10000, 10)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/150 [00:00<?, ?epoch/s]2024-03-13 00:35:30.822431: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-13 00:35:30.834962: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-03-13 00:35:32.733315: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 00:35:33.016433: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 00:35:34.734132: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-13 00:35:34.780275: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/150 [01:16<3:09:48, 76.43s/epoch, loss=2.76, accuracy=0.428, val_loss=3.37, val_accuracy=0.191, lr=0.1]  1%|▏         | 2/150 [01:41<1:53:43, 46.10s/epoch, loss=1.43, accuracy=0.614, val_loss=2.64, val_accuracy=0.391, lr=0.1]  2%|▏         | 3/150 [02:06<1:29:47, 36.65s/epoch, loss=1.29, accuracy=0.674, val_loss=2.86, val_accuracy=0.284, lr=0.1]  3%|▎         | 4/150 [02:32<1:18:25, 32.23s/epoch, loss=1.25, accuracy=0.694, val_loss=1.8, val_accuracy=0.488, lr=0.1]   3%|▎         | 5/150 [02:57<1:11:57, 29.78s/epoch, loss=1.24, accuracy=0.708, val_loss=1.87, val_accuracy=0.522, lr=0.1]  4%|▍         | 6/150 [03:21<1:06:48, 27.84s/epoch, loss=1.22, accuracy=0.716, val_loss=2.39, val_accuracy=0.445, lr=0.1]  5%|▍         | 7/150 [03:45<1:03:28, 26.63s/epoch, loss=1.21, accuracy=0.724, val_loss=2.03, val_accuracy=0.521, lr=0.1]  5%|▌         | 8/150 [04:10<1:01:42, 26.07s/epoch, loss=1.2, accuracy=0.727, val_loss=2.35, val_accuracy=0.381, lr=0.1]   6%|▌         | 9/150 [04:36<1:00:55, 25.92s/epoch, loss=1.2, accuracy=0.73, val_loss=1.74, val_accuracy=0.584, lr=0.1]   7%|▋         | 10/150 [05:01<59:52, 25.66s/epoch, loss=1.19, accuracy=0.736, val_loss=1.51, val_accuracy=0.641, lr=0.1]  7%|▋         | 11/150 [05:26<59:10, 25.54s/epoch, loss=1.18, accuracy=0.738, val_loss=1.97, val_accuracy=0.46, lr=0.1]   8%|▊         | 12/150 [05:50<57:47, 25.12s/epoch, loss=1.18, accuracy=0.743, val_loss=1.63, val_accuracy=0.557, lr=0.1]  9%|▊         | 13/150 [06:14<56:36, 24.79s/epoch, loss=1.17, accuracy=0.743, val_loss=2.01, val_accuracy=0.523, lr=0.1]  9%|▉         | 14/150 [06:39<56:21, 24.87s/epoch, loss=1.17, accuracy=0.744, val_loss=3.83, val_accuracy=0.19, lr=0.1]  10%|█         | 15/150 [07:05<56:19, 25.03s/epoch, loss=1.18, accuracy=0.741, val_loss=2.55, val_accuracy=0.384, lr=0.1] 11%|█         | 16/150 [07:30<56:11, 25.16s/epoch, loss=1.17, accuracy=0.743, val_loss=1.95, val_accuracy=0.509, lr=0.1] 11%|█▏        | 17/150 [07:56<56:01, 25.27s/epoch, loss=1.16, accuracy=0.747, val_loss=1.93, val_accuracy=0.581, lr=0.1] 12%|█▏        | 18/150 [08:20<54:44, 24.89s/epoch, loss=1.16, accuracy=0.748, val_loss=1.47, val_accuracy=0.647, lr=0.1] 13%|█▎        | 19/150 [08:44<53:42, 24.60s/epoch, loss=1.16, accuracy=0.749, val_loss=2.11, val_accuracy=0.464, lr=0.1] 13%|█▎        | 20/150 [09:09<53:53, 24.87s/epoch, loss=1.15, accuracy=0.751, val_loss=2.59, val_accuracy=0.349, lr=0.1] 14%|█▍        | 21/150 [09:35<54:03, 25.14s/epoch, loss=1.15, accuracy=0.751, val_loss=2.59, val_accuracy=0.382, lr=0.1] 15%|█▍        | 22/150 [10:01<53:57, 25.29s/epoch, loss=1.15, accuracy=0.752, val_loss=3.44, val_accuracy=0.261, lr=0.1] 15%|█▌        | 23/150 [10:26<53:34, 25.31s/epoch, loss=1.15, accuracy=0.751, val_loss=2.39, val_accuracy=0.393, lr=0.1] 16%|█▌        | 24/150 [10:50<52:26, 24.97s/epoch, loss=1.15, accuracy=0.751, val_loss=2.37, val_accuracy=0.349, lr=0.1] 17%|█▋        | 25/150 [11:14<51:35, 24.76s/epoch, loss=1.15, accuracy=0.751, val_loss=1.33, val_accuracy=0.691, lr=0.1] 17%|█▋        | 26/150 [11:40<51:35, 24.96s/epoch, loss=1.14, accuracy=0.752, val_loss=1.52, val_accuracy=0.628, lr=0.1] 18%|█▊        | 27/150 [12:05<51:33, 25.15s/epoch, loss=1.14, accuracy=0.749, val_loss=1.79, val_accuracy=0.549, lr=0.1] 19%|█▊        | 28/150 [12:31<51:22, 25.26s/epoch, loss=1.14, accuracy=0.754, val_loss=1.44, val_accuracy=0.646, lr=0.1] 19%|█▉        | 29/150 [12:56<50:47, 25.19s/epoch, loss=1.14, accuracy=0.753, val_loss=1.93, val_accuracy=0.526, lr=0.1] 20%|██        | 30/150 [13:20<49:35, 24.79s/epoch, loss=1.14, accuracy=0.751, val_loss=3.03, val_accuracy=0.377, lr=0.1] 21%|██        | 31/150 [13:44<48:50, 24.62s/epoch, loss=1.14, accuracy=0.753, val_loss=2.12, val_accuracy=0.431, lr=0.1] 21%|██▏       | 32/150 [14:09<48:53, 24.86s/epoch, loss=1.14, accuracy=0.753, val_loss=2.21, val_accuracy=0.394, lr=0.1] 22%|██▏       | 33/150 [14:35<48:54, 25.08s/epoch, loss=1.13, accuracy=0.754, val_loss=2.49, val_accuracy=0.4, lr=0.1]   23%|██▎       | 34/150 [15:01<48:41, 25.18s/epoch, loss=1.13, accuracy=0.754, val_loss=3.01, val_accuracy=0.275, lr=0.1] 23%|██▎       | 35/150 [15:24<47:29, 24.78s/epoch, loss=1.13, accuracy=0.754, val_loss=2.4, val_accuracy=0.432, lr=0.1]  24%|██▍       | 36/150 [15:48<46:29, 24.47s/epoch, loss=1.13, accuracy=0.752, val_loss=1.78, val_accuracy=0.581, lr=0.1] 25%|██▍       | 37/150 [16:12<45:52, 24.36s/epoch, loss=1.12, accuracy=0.757, val_loss=2.05, val_accuracy=0.524, lr=0.1] 25%|██▌       | 38/150 [16:36<45:13, 24.23s/epoch, loss=1.13, accuracy=0.755, val_loss=2.91, val_accuracy=0.246, lr=0.1] 26%|██▌       | 39/150 [17:00<44:37, 24.12s/epoch, loss=1.12, accuracy=0.757, val_loss=2.12, val_accuracy=0.473, lr=0.1] 27%|██▋       | 40/150 [17:25<44:34, 24.32s/epoch, loss=1.13, accuracy=0.755, val_loss=3.01, val_accuracy=0.389, lr=0.1] 27%|██▋       | 41/150 [17:50<44:48, 24.67s/epoch, loss=1.13, accuracy=0.758, val_loss=2.43, val_accuracy=0.4, lr=0.1]   28%|██▊       | 42/150 [18:15<44:41, 24.83s/epoch, loss=1.12, accuracy=0.756, val_loss=1.55, val_accuracy=0.613, lr=0.1] 29%|██▊       | 43/150 [18:41<44:42, 25.07s/epoch, loss=1.12, accuracy=0.755, val_loss=1.55, val_accuracy=0.618, lr=0.1] 29%|██▉       | 44/150 [19:05<43:51, 24.83s/epoch, loss=1.13, accuracy=0.754, val_loss=1.77, val_accuracy=0.578, lr=0.1] 30%|███       | 45/150 [19:29<43:03, 24.61s/epoch, loss=1.13, accuracy=0.756, val_loss=2.31, val_accuracy=0.368, lr=0.1] 31%|███       | 46/150 [19:55<43:13, 24.94s/epoch, loss=1.13, accuracy=0.753, val_loss=2.43, val_accuracy=0.417, lr=0.1] 31%|███▏      | 47/150 [20:21<43:09, 25.14s/epoch, loss=1.12, accuracy=0.758, val_loss=3.18, val_accuracy=0.344, lr=0.1] 32%|███▏      | 48/150 [20:46<43:01, 25.30s/epoch, loss=1.12, accuracy=0.761, val_loss=2.4, val_accuracy=0.462, lr=0.1]  33%|███▎      | 49/150 [21:11<42:23, 25.18s/epoch, loss=1.12, accuracy=0.756, val_loss=2.43, val_accuracy=0.384, lr=0.1] 33%|███▎      | 50/150 [21:36<41:28, 24.89s/epoch, loss=1.12, accuracy=0.757, val_loss=1.74, val_accuracy=0.564, lr=0.1] 34%|███▍      | 51/150 [22:00<41:01, 24.86s/epoch, loss=1.12, accuracy=0.755, val_loss=1.73, val_accuracy=0.583, lr=0.1] 35%|███▍      | 52/150 [22:26<40:46, 24.97s/epoch, loss=1.12, accuracy=0.757, val_loss=2.72, val_accuracy=0.34, lr=0.1]  35%|███▌      | 53/150 [22:51<40:41, 25.17s/epoch, loss=1.12, accuracy=0.758, val_loss=2.21, val_accuracy=0.423, lr=0.1] 36%|███▌      | 54/150 [23:17<40:34, 25.36s/epoch, loss=1.12, accuracy=0.757, val_loss=1.73, val_accuracy=0.54, lr=0.1]  37%|███▋      | 55/150 [23:42<39:46, 25.12s/epoch, loss=1.12, accuracy=0.758, val_loss=1.85, val_accuracy=0.563, lr=0.1] 37%|███▋      | 56/150 [24:06<38:49, 24.78s/epoch, loss=1.12, accuracy=0.759, val_loss=1.55, val_accuracy=0.603, lr=0.1] 38%|███▊      | 57/150 [24:31<38:44, 24.99s/epoch, loss=1.12, accuracy=0.757, val_loss=1.68, val_accuracy=0.577, lr=0.1] 39%|███▊      | 58/150 [24:57<38:32, 25.13s/epoch, loss=1.12, accuracy=0.758, val_loss=3.52, val_accuracy=0.379, lr=0.1] 39%|███▉      | 59/150 [25:22<38:17, 25.25s/epoch, loss=1.12, accuracy=0.76, val_loss=2.04, val_accuracy=0.499, lr=0.1]  40%|████      | 60/150 [25:47<37:52, 25.25s/epoch, loss=1.12, accuracy=0.758, val_loss=2.5, val_accuracy=0.47, lr=0.1]  41%|████      | 61/150 [26:11<36:57, 24.91s/epoch, loss=1.11, accuracy=0.759, val_loss=2.36, val_accuracy=0.436, lr=0.1] 41%|████▏     | 62/150 [26:36<36:26, 24.85s/epoch, loss=0.903, accuracy=0.819, val_loss=0.862, val_accuracy=0.819, lr=0.01] 42%|████▏     | 63/150 [27:02<36:25, 25.12s/epoch, loss=0.726, accuracy=0.848, val_loss=0.739, val_accuracy=0.833, lr=0.01] 43%|████▎     | 64/150 [27:27<36:12, 25.26s/epoch, loss=0.646, accuracy=0.857, val_loss=0.811, val_accuracy=0.801, lr=0.01] 43%|████▎     | 65/150 [27:53<35:54, 25.35s/epoch, loss=0.602, accuracy=0.859, val_loss=0.906, val_accuracy=0.768, lr=0.01] 44%|████▍     | 66/150 [28:18<35:08, 25.10s/epoch, loss=0.579, accuracy=0.865, val_loss=0.74, val_accuracy=0.806, lr=0.01]  45%|████▍     | 67/150 [28:41<34:14, 24.75s/epoch, loss=0.569, accuracy=0.864, val_loss=0.758, val_accuracy=0.802, lr=0.01] 45%|████▌     | 68/150 [29:06<33:55, 24.83s/epoch, loss=0.559, accuracy=0.867, val_loss=0.82, val_accuracy=0.786, lr=0.01]  46%|████▌     | 69/150 [29:32<33:45, 25.00s/epoch, loss=0.56, accuracy=0.866, val_loss=0.767, val_accuracy=0.801, lr=0.01] 47%|████▋     | 70/150 [29:57<33:33, 25.17s/epoch, loss=0.56, accuracy=0.867, val_loss=0.892, val_accuracy=0.761, lr=0.01] 47%|████▋     | 71/150 [30:23<33:13, 25.23s/epoch, loss=0.552, accuracy=0.872, val_loss=0.826, val_accuracy=0.786, lr=0.01] 48%|████▊     | 72/150 [30:47<32:21, 24.89s/epoch, loss=0.556, accuracy=0.871, val_loss=0.748, val_accuracy=0.807, lr=0.01] 49%|████▊     | 73/150 [31:11<31:46, 24.76s/epoch, loss=0.558, accuracy=0.871, val_loss=1.16, val_accuracy=0.708, lr=0.01]  49%|████▉     | 74/150 [31:37<31:43, 25.05s/epoch, loss=0.552, accuracy=0.875, val_loss=1.21, val_accuracy=0.698, lr=0.01] 50%|█████     | 75/150 [32:03<31:28, 25.19s/epoch, loss=0.553, accuracy=0.873, val_loss=0.764, val_accuracy=0.808, lr=0.01] 51%|█████     | 76/150 [32:28<31:16, 25.36s/epoch, loss=0.551, accuracy=0.875, val_loss=0.726, val_accuracy=0.818, lr=0.01] 51%|█████▏    | 77/150 [32:53<30:40, 25.21s/epoch, loss=0.548, accuracy=0.878, val_loss=1.13, val_accuracy=0.726, lr=0.01]  52%|█████▏    | 78/150 [33:17<29:53, 24.90s/epoch, loss=0.546, accuracy=0.878, val_loss=0.852, val_accuracy=0.787, lr=0.01] 53%|█████▎    | 79/150 [33:42<29:29, 24.92s/epoch, loss=0.547, accuracy=0.879, val_loss=0.843, val_accuracy=0.786, lr=0.01] 53%|█████▎    | 80/150 [34:08<29:21, 25.16s/epoch, loss=0.548, accuracy=0.877, val_loss=0.815, val_accuracy=0.799, lr=0.01] 54%|█████▍    | 81/150 [34:34<29:06, 25.31s/epoch, loss=0.55, accuracy=0.879, val_loss=1.11, val_accuracy=0.726, lr=0.01]   55%|█████▍    | 82/150 [34:59<28:43, 25.34s/epoch, loss=0.548, accuracy=0.881, val_loss=0.844, val_accuracy=0.789, lr=0.01] 55%|█████▌    | 83/150 [35:23<27:51, 24.94s/epoch, loss=0.55, accuracy=0.88, val_loss=0.93, val_accuracy=0.792, lr=0.01]    56%|█████▌    | 84/150 [35:47<27:09, 24.70s/epoch, loss=0.545, accuracy=0.882, val_loss=1.27, val_accuracy=0.682, lr=0.01] 57%|█████▋    | 85/150 [36:13<27:03, 24.98s/epoch, loss=0.543, accuracy=0.884, val_loss=0.985, val_accuracy=0.758, lr=0.01] 57%|█████▋    | 86/150 [36:38<26:46, 25.11s/epoch, loss=0.549, accuracy=0.881, val_loss=1.02, val_accuracy=0.722, lr=0.01]  58%|█████▊    | 87/150 [37:04<26:28, 25.22s/epoch, loss=0.545, accuracy=0.882, val_loss=0.926, val_accuracy=0.776, lr=0.01] 59%|█████▊    | 88/150 [37:29<25:57, 25.12s/epoch, loss=0.547, accuracy=0.882, val_loss=0.767, val_accuracy=0.817, lr=0.01] 59%|█████▉    | 89/150 [37:53<25:11, 24.77s/epoch, loss=0.544, accuracy=0.885, val_loss=0.914, val_accuracy=0.777, lr=0.01] 60%|██████    | 90/150 [38:17<24:40, 24.67s/epoch, loss=0.548, accuracy=0.884, val_loss=0.853, val_accuracy=0.779, lr=0.01] 61%|██████    | 91/150 [38:43<24:30, 24.93s/epoch, loss=0.549, accuracy=0.884, val_loss=0.763, val_accuracy=0.813, lr=0.01] 61%|██████▏   | 92/150 [39:08<24:16, 25.11s/epoch, loss=0.473, accuracy=0.91, val_loss=0.525, val_accuracy=0.892, lr=0.001] 62%|██████▏   | 93/150 [39:34<23:57, 25.22s/epoch, loss=0.421, accuracy=0.927, val_loss=0.512, val_accuracy=0.895, lr=0.001] 63%|██████▎   | 94/150 [39:58<23:21, 25.02s/epoch, loss=0.399, accuracy=0.932, val_loss=0.503, val_accuracy=0.895, lr=0.001] 63%|██████▎   | 95/150 [40:22<22:42, 24.77s/epoch, loss=0.383, accuracy=0.935, val_loss=0.494, val_accuracy=0.898, lr=0.001] 64%|██████▍   | 96/150 [40:48<22:28, 24.98s/epoch, loss=0.368, accuracy=0.939, val_loss=0.486, val_accuracy=0.898, lr=0.001] 65%|██████▍   | 97/150 [41:14<22:15, 25.21s/epoch, loss=0.355, accuracy=0.942, val_loss=0.488, val_accuracy=0.897, lr=0.001] 65%|██████▌   | 98/150 [41:39<21:58, 25.36s/epoch, loss=0.347, accuracy=0.942, val_loss=0.487, val_accuracy=0.896, lr=0.001] 66%|██████▌   | 99/150 [42:05<21:33, 25.36s/epoch, loss=0.336, accuracy=0.945, val_loss=0.469, val_accuracy=0.9, lr=0.001]   67%|██████▋   | 100/150 [42:29<20:50, 25.02s/epoch, loss=0.327, accuracy=0.947, val_loss=0.463, val_accuracy=0.902, lr=0.001] 67%|██████▋   | 101/150 [42:53<20:16, 24.83s/epoch, loss=0.318, accuracy=0.948, val_loss=0.467, val_accuracy=0.899, lr=0.001] 68%|██████▊   | 102/150 [43:19<20:03, 25.08s/epoch, loss=0.31, accuracy=0.949, val_loss=0.489, val_accuracy=0.893, lr=0.001]  69%|██████▊   | 103/150 [43:44<19:44, 25.20s/epoch, loss=0.303, accuracy=0.952, val_loss=0.463, val_accuracy=0.899, lr=0.001] 69%|██████▉   | 104/150 [44:10<19:27, 25.39s/epoch, loss=0.295, accuracy=0.953, val_loss=0.456, val_accuracy=0.9, lr=0.001]   70%|███████   | 105/150 [44:35<18:49, 25.11s/epoch, loss=0.29, accuracy=0.952, val_loss=0.458, val_accuracy=0.901, lr=0.001] 71%|███████   | 106/150 [44:59<18:09, 24.76s/epoch, loss=0.283, accuracy=0.955, val_loss=0.464, val_accuracy=0.895, lr=0.001] 71%|███████▏  | 107/150 [45:23<17:37, 24.60s/epoch, loss=0.274, accuracy=0.955, val_loss=0.457, val_accuracy=0.9, lr=0.001]   72%|███████▏  | 108/150 [45:47<17:08, 24.50s/epoch, loss=0.27, accuracy=0.956, val_loss=0.459, val_accuracy=0.895, lr=0.001] 73%|███████▎  | 109/150 [46:13<16:59, 24.86s/epoch, loss=0.266, accuracy=0.956, val_loss=0.453, val_accuracy=0.899, lr=0.001] 73%|███████▎  | 110/150 [46:38<16:41, 25.04s/epoch, loss=0.261, accuracy=0.957, val_loss=0.479, val_accuracy=0.891, lr=0.001] 74%|███████▍  | 111/150 [47:04<16:22, 25.18s/epoch, loss=0.257, accuracy=0.957, val_loss=0.445, val_accuracy=0.897, lr=0.001] 75%|███████▍  | 112/150 [47:28<15:50, 25.01s/epoch, loss=0.253, accuracy=0.957, val_loss=0.44, val_accuracy=0.899, lr=0.001]  75%|███████▌  | 113/150 [47:52<15:14, 24.71s/epoch, loss=0.252, accuracy=0.958, val_loss=0.447, val_accuracy=0.897, lr=0.001] 76%|███████▌  | 114/150 [48:17<14:42, 24.53s/epoch, loss=0.248, accuracy=0.958, val_loss=0.44, val_accuracy=0.898, lr=0.001]  77%|███████▋  | 115/150 [48:42<14:25, 24.73s/epoch, loss=0.241, accuracy=0.96, val_loss=0.465, val_accuracy=0.893, lr=0.001] 77%|███████▋  | 116/150 [49:07<14:04, 24.85s/epoch, loss=0.239, accuracy=0.959, val_loss=0.448, val_accuracy=0.894, lr=0.001] 78%|███████▊  | 117/150 [49:32<13:46, 25.05s/epoch, loss=0.239, accuracy=0.959, val_loss=0.459, val_accuracy=0.893, lr=0.001] 79%|███████▊  | 118/150 [49:57<13:21, 25.06s/epoch, loss=0.232, accuracy=0.961, val_loss=0.444, val_accuracy=0.896, lr=0.001] 79%|███████▉  | 119/150 [50:22<12:48, 24.80s/epoch, loss=0.232, accuracy=0.961, val_loss=0.466, val_accuracy=0.891, lr=0.001] 80%|████████  | 120/150 [50:45<12:15, 24.51s/epoch, loss=0.229, accuracy=0.961, val_loss=0.448, val_accuracy=0.898, lr=0.001] 81%|████████  | 121/150 [51:11<11:56, 24.71s/epoch, loss=0.228, accuracy=0.96, val_loss=0.447, val_accuracy=0.897, lr=0.001]  81%|████████▏ | 122/150 [51:36<11:37, 24.91s/epoch, loss=0.208, accuracy=0.968, val_loss=0.412, val_accuracy=0.906, lr=1e-04] 82%|████████▏ | 123/150 [52:02<11:18, 25.12s/epoch, loss=0.197, accuracy=0.972, val_loss=0.409, val_accuracy=0.907, lr=1e-04] 83%|████████▎ | 124/150 [52:27<10:56, 25.24s/epoch, loss=0.193, accuracy=0.974, val_loss=0.408, val_accuracy=0.907, lr=1e-04] 83%|████████▎ | 125/150 [52:52<10:26, 25.08s/epoch, loss=0.19, accuracy=0.974, val_loss=0.41, val_accuracy=0.906, lr=1e-04]   84%|████████▍ | 126/150 [53:16<09:57, 24.88s/epoch, loss=0.188, accuracy=0.976, val_loss=0.409, val_accuracy=0.908, lr=1e-04] 85%|████████▍ | 127/150 [53:41<09:34, 24.96s/epoch, loss=0.187, accuracy=0.976, val_loss=0.408, val_accuracy=0.908, lr=1e-04] 85%|████████▌ | 128/150 [54:07<09:11, 25.06s/epoch, loss=0.185, accuracy=0.977, val_loss=0.409, val_accuracy=0.91, lr=1e-04]  86%|████████▌ | 129/150 [54:32<08:47, 25.11s/epoch, loss=0.185, accuracy=0.976, val_loss=0.408, val_accuracy=0.908, lr=1e-04] 87%|████████▋ | 130/150 [54:57<08:21, 25.07s/epoch, loss=0.182, accuracy=0.977, val_loss=0.41, val_accuracy=0.909, lr=1e-04]  87%|████████▋ | 131/150 [55:21<07:48, 24.68s/epoch, loss=0.181, accuracy=0.978, val_loss=0.411, val_accuracy=0.908, lr=1e-04] 88%|████████▊ | 132/150 [55:45<07:20, 24.49s/epoch, loss=0.18, accuracy=0.979, val_loss=0.412, val_accuracy=0.907, lr=1e-04]  89%|████████▊ | 133/150 [56:10<06:58, 24.61s/epoch, loss=0.178, accuracy=0.978, val_loss=0.412, val_accuracy=0.907, lr=1e-04] 89%|████████▉ | 134/150 [56:35<06:37, 24.82s/epoch, loss=0.178, accuracy=0.978, val_loss=0.41, val_accuracy=0.908, lr=1e-04]  90%|█████████ | 135/150 [57:00<06:14, 24.99s/epoch, loss=0.177, accuracy=0.979, val_loss=0.41, val_accuracy=0.91, lr=1e-04]  91%|█████████ | 136/150 [57:26<05:51, 25.09s/epoch, loss=0.175, accuracy=0.979, val_loss=0.409, val_accuracy=0.909, lr=1e-04] 91%|█████████▏| 137/150 [57:50<05:22, 24.78s/epoch, loss=0.175, accuracy=0.98, val_loss=0.41, val_accuracy=0.908, lr=5e-5]    92%|█████████▏| 138/150 [58:14<04:54, 24.54s/epoch, loss=0.175, accuracy=0.98, val_loss=0.408, val_accuracy=0.909, lr=5e-5] 93%|█████████▎| 139/150 [58:38<04:29, 24.53s/epoch, loss=0.173, accuracy=0.98, val_loss=0.409, val_accuracy=0.909, lr=5e-5] 93%|█████████▎| 140/150 [59:04<04:07, 24.78s/epoch, loss=0.173, accuracy=0.979, val_loss=0.409, val_accuracy=0.91, lr=5e-5] 94%|█████████▍| 141/150 [59:29<03:44, 24.94s/epoch, loss=0.173, accuracy=0.98, val_loss=0.408, val_accuracy=0.909, lr=5e-5] 95%|█████████▍| 142/150 [59:54<03:20, 25.07s/epoch, loss=0.172, accuracy=0.98, val_loss=0.409, val_accuracy=0.91, lr=5e-5]  95%|█████████▌| 143/150 [1:00:18<02:52, 24.71s/epoch, loss=0.172, accuracy=0.98, val_loss=0.409, val_accuracy=0.91, lr=5e-5] 96%|█████████▌| 144/150 [1:00:42<02:26, 24.48s/epoch, loss=0.172, accuracy=0.98, val_loss=0.411, val_accuracy=0.909, lr=5e-5] 97%|█████████▋| 145/150 [1:01:06<02:02, 24.46s/epoch, loss=0.17, accuracy=0.98, val_loss=0.409, val_accuracy=0.909, lr=5e-5]  97%|█████████▋| 146/150 [1:01:32<01:38, 24.75s/epoch, loss=0.169, accuracy=0.981, val_loss=0.41, val_accuracy=0.909, lr=5e-5] 98%|█████████▊| 147/150 [1:01:57<01:14, 24.92s/epoch, loss=0.169, accuracy=0.982, val_loss=0.41, val_accuracy=0.909, lr=5e-5] 99%|█████████▊| 148/150 [1:02:23<00:50, 25.13s/epoch, loss=0.17, accuracy=0.98, val_loss=0.41, val_accuracy=0.91, lr=5e-5]    99%|█████████▉| 149/150 [1:02:47<00:24, 24.90s/epoch, loss=0.168, accuracy=0.982, val_loss=0.409, val_accuracy=0.91, lr=5e-5]100%|██████████| 150/150 [1:03:11<00:00, 24.58s/epoch, loss=0.168, accuracy=0.982, val_loss=0.41, val_accuracy=0.908, lr=5e-5]100%|██████████| 150/150 [1:03:11<00:00, 25.28s/epoch, loss=0.168, accuracy=0.982, val_loss=0.41, val_accuracy=0.908, lr=5e-5]
Using real-time data augmentation.
Only one model saved

Loading model: 10_04_cifar10_ResNet20v1.h5
Test score: 0.41032874584198
Test accuracy: 0.90829998254776


* * * Run SGD for ID = 10_5. * * *


2024-03-13 01:38:46.186443: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 01:38:48.799643: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 01:38:48.800904: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-13 01:38:48.843475: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:86:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-13 01:38:48.843521: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 01:38:48.846931: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 01:38:48.847001: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 01:38:48.849385: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 01:38:48.850099: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 01:38:48.852792: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 01:38:48.854546: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 01:38:48.859750: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 01:38:48.860418: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 01:38:48.860507: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 01:38:50.035838: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-13 01:38:50.036475: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 01:38:50.037640: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:86:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-13 01:38:50.037690: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 01:38:50.037734: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 01:38:50.037753: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 01:38:50.037771: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 01:38:50.037789: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 01:38:50.037817: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 01:38:50.037845: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 01:38:50.037864: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 01:38:50.038398: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 01:38:50.038446: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 01:38:50.655248: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-13 01:38:50.655300: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-13 01:38:50.655310: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-13 01:38:50.656393: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:86:00.0, compute capability: 6.1)
{'id': '10_05', 'seed': 5, 'out_folder': 'results/epoch_budget_2', 'batch_size': 128, 'epochs': 150, 'validation_split': 0.0, 'checkpointing': False, 'checkpoint_every': -1, 'hold_out_validation_split': 0.0, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'num_classes': 10, 'SSE_lr': False, 'test_time_augmentation': False, 'debug': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
y_train shape: (50000, 10)
x_val shape: (10000, 32, 32, 3)
y_val shape: (10000, 10)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/150 [00:00<?, ?epoch/s]2024-03-13 01:38:51.250683: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-13 01:38:51.263008: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-03-13 01:38:53.081583: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 01:38:53.318742: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 01:38:54.302534: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-13 01:38:54.349806: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/150 [00:58<2:25:35, 58.63s/epoch, loss=3.06, accuracy=0.327, val_loss=2.16, val_accuracy=0.31, lr=0.1]  1%|▏         | 2/150 [01:24<1:36:58, 39.31s/epoch, loss=1.52, accuracy=0.557, val_loss=1.65, val_accuracy=0.538, lr=0.1]  2%|▏         | 3/150 [01:49<1:20:23, 32.82s/epoch, loss=1.32, accuracy=0.656, val_loss=1.53, val_accuracy=0.584, lr=0.1]  3%|▎         | 4/150 [02:13<1:11:38, 29.44s/epoch, loss=1.26, accuracy=0.689, val_loss=2.05, val_accuracy=0.465, lr=0.1]  3%|▎         | 5/150 [02:38<1:06:37, 27.57s/epoch, loss=1.23, accuracy=0.709, val_loss=2.32, val_accuracy=0.366, lr=0.1]  4%|▍         | 6/150 [03:03<1:04:40, 26.95s/epoch, loss=1.23, accuracy=0.714, val_loss=1.49, val_accuracy=0.614, lr=0.1]  5%|▍         | 7/150 [03:29<1:03:11, 26.51s/epoch, loss=1.2, accuracy=0.722, val_loss=2.19, val_accuracy=0.437, lr=0.1]   5%|▌         | 8/150 [03:55<1:02:07, 26.25s/epoch, loss=1.21, accuracy=0.725, val_loss=2.8, val_accuracy=0.377, lr=0.1]  6%|▌         | 9/150 [04:20<1:00:54, 25.91s/epoch, loss=1.19, accuracy=0.73, val_loss=2.21, val_accuracy=0.411, lr=0.1]  7%|▋         | 10/150 [04:44<59:21, 25.44s/epoch, loss=1.18, accuracy=0.734, val_loss=2.9, val_accuracy=0.309, lr=0.1]   7%|▋         | 11/150 [05:08<58:01, 25.05s/epoch, loss=1.18, accuracy=0.737, val_loss=1.44, val_accuracy=0.633, lr=0.1]  8%|▊         | 12/150 [05:34<58:01, 25.23s/epoch, loss=1.18, accuracy=0.736, val_loss=1.87, val_accuracy=0.49, lr=0.1]   9%|▊         | 13/150 [05:59<57:48, 25.32s/epoch, loss=1.17, accuracy=0.74, val_loss=1.59, val_accuracy=0.606, lr=0.1]  9%|▉         | 14/150 [06:25<57:43, 25.47s/epoch, loss=1.17, accuracy=0.741, val_loss=2.21, val_accuracy=0.481, lr=0.1] 10%|█         | 15/150 [06:50<57:03, 25.36s/epoch, loss=1.17, accuracy=0.742, val_loss=1.65, val_accuracy=0.586, lr=0.1] 11%|█         | 16/150 [07:15<55:55, 25.04s/epoch, loss=1.17, accuracy=0.74, val_loss=10.4, val_accuracy=0.186, lr=0.1]  11%|█▏        | 17/150 [07:39<54:55, 24.78s/epoch, loss=1.16, accuracy=0.746, val_loss=1.77, val_accuracy=0.562, lr=0.1] 12%|█▏        | 18/150 [08:05<55:09, 25.07s/epoch, loss=1.16, accuracy=0.742, val_loss=1.76, val_accuracy=0.56, lr=0.1]  13%|█▎        | 19/150 [08:30<55:13, 25.30s/epoch, loss=1.16, accuracy=0.744, val_loss=2.02, val_accuracy=0.573, lr=0.1] 13%|█▎        | 20/150 [08:56<55:10, 25.46s/epoch, loss=1.15, accuracy=0.749, val_loss=2.22, val_accuracy=0.507, lr=0.1] 14%|█▍        | 21/150 [09:22<54:41, 25.44s/epoch, loss=1.15, accuracy=0.747, val_loss=1.58, val_accuracy=0.601, lr=0.1] 15%|█▍        | 22/150 [09:46<53:42, 25.17s/epoch, loss=1.15, accuracy=0.749, val_loss=1.61, val_accuracy=0.575, lr=0.1] 15%|█▌        | 23/150 [10:11<52:47, 24.94s/epoch, loss=1.14, accuracy=0.749, val_loss=1.87, val_accuracy=0.584, lr=0.1] 16%|█▌        | 24/150 [10:36<52:54, 25.19s/epoch, loss=1.15, accuracy=0.75, val_loss=1.35, val_accuracy=0.676, lr=0.1]  17%|█▋        | 25/150 [11:02<52:56, 25.41s/epoch, loss=1.14, accuracy=0.751, val_loss=1.83, val_accuracy=0.55, lr=0.1] 17%|█▋        | 26/150 [11:28<52:47, 25.54s/epoch, loss=1.13, accuracy=0.755, val_loss=2.16, val_accuracy=0.468, lr=0.1] 18%|█▊        | 27/150 [11:53<52:11, 25.46s/epoch, loss=1.14, accuracy=0.75, val_loss=1.8, val_accuracy=0.512, lr=0.1]   19%|█▊        | 28/150 [12:17<50:50, 25.01s/epoch, loss=1.13, accuracy=0.752, val_loss=4.56, val_accuracy=0.301, lr=0.1] 19%|█▉        | 29/150 [12:42<49:56, 24.77s/epoch, loss=1.13, accuracy=0.753, val_loss=2.89, val_accuracy=0.373, lr=0.1] 20%|██        | 30/150 [13:06<49:36, 24.80s/epoch, loss=1.13, accuracy=0.755, val_loss=2.3, val_accuracy=0.419, lr=0.1]  21%|██        | 31/150 [13:32<49:42, 25.06s/epoch, loss=1.13, accuracy=0.755, val_loss=3.11, val_accuracy=0.413, lr=0.1] 21%|██▏       | 32/150 [13:58<49:36, 25.23s/epoch, loss=1.13, accuracy=0.755, val_loss=2.17, val_accuracy=0.384, lr=0.1] 22%|██▏       | 33/150 [14:23<49:29, 25.38s/epoch, loss=1.13, accuracy=0.753, val_loss=1.56, val_accuracy=0.608, lr=0.1] 23%|██▎       | 34/150 [14:48<48:20, 25.00s/epoch, loss=1.12, accuracy=0.755, val_loss=2.17, val_accuracy=0.473, lr=0.1] 23%|██▎       | 35/150 [15:12<47:25, 24.74s/epoch, loss=1.12, accuracy=0.755, val_loss=2.51, val_accuracy=0.418, lr=0.1] 24%|██▍       | 36/150 [15:37<47:21, 24.93s/epoch, loss=1.13, accuracy=0.754, val_loss=2.97, val_accuracy=0.429, lr=0.1] 25%|██▍       | 37/150 [16:03<47:19, 25.13s/epoch, loss=1.12, accuracy=0.756, val_loss=2.42, val_accuracy=0.449, lr=0.1] 25%|██▌       | 38/150 [16:28<47:10, 25.27s/epoch, loss=1.12, accuracy=0.755, val_loss=1.68, val_accuracy=0.568, lr=0.1] 26%|██▌       | 39/150 [16:54<46:49, 25.31s/epoch, loss=1.13, accuracy=0.754, val_loss=2.14, val_accuracy=0.458, lr=0.1] 27%|██▋       | 40/150 [17:18<45:56, 25.06s/epoch, loss=1.12, accuracy=0.757, val_loss=1.68, val_accuracy=0.576, lr=0.1] 27%|██▋       | 41/150 [17:42<45:06, 24.83s/epoch, loss=1.12, accuracy=0.757, val_loss=1.79, val_accuracy=0.587, lr=0.1] 28%|██▊       | 42/150 [18:08<45:12, 25.12s/epoch, loss=1.12, accuracy=0.758, val_loss=8.34, val_accuracy=0.15, lr=0.1]  29%|██▊       | 43/150 [18:34<45:08, 25.31s/epoch, loss=1.11, accuracy=0.758, val_loss=4.12, val_accuracy=0.343, lr=0.1] 29%|██▉       | 44/150 [19:00<45:00, 25.47s/epoch, loss=1.12, accuracy=0.755, val_loss=2.12, val_accuracy=0.47, lr=0.1]  30%|███       | 45/150 [19:25<44:22, 25.35s/epoch, loss=1.11, accuracy=0.757, val_loss=3.06, val_accuracy=0.318, lr=0.1] 31%|███       | 46/150 [19:49<43:25, 25.05s/epoch, loss=1.1, accuracy=0.762, val_loss=1.84, val_accuracy=0.536, lr=0.1]  31%|███▏      | 47/150 [20:14<42:56, 25.02s/epoch, loss=1.11, accuracy=0.756, val_loss=1.9, val_accuracy=0.491, lr=0.1] 32%|███▏      | 48/150 [20:40<43:03, 25.33s/epoch, loss=1.12, accuracy=0.755, val_loss=2.26, val_accuracy=0.446, lr=0.1] 33%|███▎      | 49/150 [21:06<42:57, 25.52s/epoch, loss=1.11, accuracy=0.762, val_loss=2.72, val_accuracy=0.292, lr=0.1] 33%|███▎      | 50/150 [21:32<42:40, 25.61s/epoch, loss=1.11, accuracy=0.758, val_loss=1.67, val_accuracy=0.549, lr=0.1] 34%|███▍      | 51/150 [21:57<41:41, 25.27s/epoch, loss=1.11, accuracy=0.758, val_loss=1.7, val_accuracy=0.561, lr=0.1]  35%|███▍      | 52/150 [22:21<40:50, 25.00s/epoch, loss=1.11, accuracy=0.759, val_loss=2.14, val_accuracy=0.428, lr=0.1] 35%|███▌      | 53/150 [22:47<40:44, 25.20s/epoch, loss=1.11, accuracy=0.759, val_loss=1.88, val_accuracy=0.548, lr=0.1] 36%|███▌      | 54/150 [23:13<40:43, 25.45s/epoch, loss=1.12, accuracy=0.756, val_loss=2.77, val_accuracy=0.372, lr=0.1] 37%|███▋      | 55/150 [23:39<40:31, 25.60s/epoch, loss=1.11, accuracy=0.759, val_loss=1.82, val_accuracy=0.534, lr=0.1] 37%|███▋      | 56/150 [24:04<40:07, 25.61s/epoch, loss=1.11, accuracy=0.759, val_loss=1.53, val_accuracy=0.608, lr=0.1] 38%|███▊      | 57/150 [24:29<39:07, 25.24s/epoch, loss=1.11, accuracy=0.757, val_loss=1.64, val_accuracy=0.591, lr=0.1] 39%|███▊      | 58/150 [24:53<38:16, 24.96s/epoch, loss=1.11, accuracy=0.759, val_loss=2.06, val_accuracy=0.533, lr=0.1] 39%|███▉      | 59/150 [25:19<38:12, 25.19s/epoch, loss=1.1, accuracy=0.759, val_loss=2.66, val_accuracy=0.383, lr=0.1]  40%|████      | 60/150 [25:45<38:06, 25.40s/epoch, loss=1.11, accuracy=0.761, val_loss=1.96, val_accuracy=0.514, lr=0.1] 41%|████      | 61/150 [26:10<37:49, 25.50s/epoch, loss=1.11, accuracy=0.76, val_loss=1.87, val_accuracy=0.513, lr=0.1]  41%|████▏     | 62/150 [26:35<37:09, 25.33s/epoch, loss=0.9, accuracy=0.818, val_loss=0.974, val_accuracy=0.768, lr=0.01] 42%|████▏     | 63/150 [27:00<36:19, 25.05s/epoch, loss=0.72, accuracy=0.851, val_loss=0.776, val_accuracy=0.82, lr=0.01] 43%|████▎     | 64/150 [27:24<35:49, 24.99s/epoch, loss=0.645, accuracy=0.856, val_loss=0.831, val_accuracy=0.795, lr=0.01] 43%|████▎     | 65/150 [27:50<35:47, 25.26s/epoch, loss=0.602, accuracy=0.861, val_loss=0.726, val_accuracy=0.812, lr=0.01] 44%|████▍     | 66/150 [28:16<35:37, 25.45s/epoch, loss=0.579, accuracy=0.864, val_loss=0.74, val_accuracy=0.809, lr=0.01]  45%|████▍     | 67/150 [28:42<35:14, 25.48s/epoch, loss=0.572, accuracy=0.861, val_loss=1.28, val_accuracy=0.698, lr=0.01] 45%|████▌     | 68/150 [29:06<34:26, 25.20s/epoch, loss=0.563, accuracy=0.866, val_loss=0.764, val_accuracy=0.797, lr=0.01] 46%|████▌     | 69/150 [29:30<33:32, 24.84s/epoch, loss=0.559, accuracy=0.866, val_loss=1, val_accuracy=0.734, lr=0.01]     47%|████▋     | 70/150 [29:55<33:14, 24.93s/epoch, loss=0.557, accuracy=0.868, val_loss=0.958, val_accuracy=0.748, lr=0.01] 47%|████▋     | 71/150 [30:21<33:07, 25.16s/epoch, loss=0.556, accuracy=0.87, val_loss=1.01, val_accuracy=0.735, lr=0.01]   48%|████▊     | 72/150 [30:47<32:56, 25.34s/epoch, loss=0.554, accuracy=0.872, val_loss=0.898, val_accuracy=0.773, lr=0.01] 49%|████▊     | 73/150 [31:13<32:37, 25.42s/epoch, loss=0.553, accuracy=0.871, val_loss=0.895, val_accuracy=0.765, lr=0.01] 49%|████▉     | 74/150 [31:37<31:47, 25.10s/epoch, loss=0.553, accuracy=0.873, val_loss=0.802, val_accuracy=0.793, lr=0.01] 50%|█████     | 75/150 [32:01<31:03, 24.85s/epoch, loss=0.553, accuracy=0.873, val_loss=0.716, val_accuracy=0.822, lr=0.01] 51%|█████     | 76/150 [32:27<31:03, 25.19s/epoch, loss=0.549, accuracy=0.875, val_loss=0.821, val_accuracy=0.794, lr=0.01] 51%|█████▏    | 77/150 [32:53<30:52, 25.38s/epoch, loss=0.549, accuracy=0.878, val_loss=0.873, val_accuracy=0.784, lr=0.01] 52%|█████▏    | 78/150 [33:19<30:41, 25.58s/epoch, loss=0.551, accuracy=0.876, val_loss=0.84, val_accuracy=0.783, lr=0.01]  53%|█████▎    | 79/150 [33:44<30:01, 25.38s/epoch, loss=0.544, accuracy=0.879, val_loss=1.47, val_accuracy=0.658, lr=0.01] 53%|█████▎    | 80/150 [34:09<29:20, 25.16s/epoch, loss=0.547, accuracy=0.879, val_loss=0.848, val_accuracy=0.794, lr=0.01] 54%|█████▍    | 81/150 [34:33<28:41, 24.95s/epoch, loss=0.545, accuracy=0.879, val_loss=0.946, val_accuracy=0.778, lr=0.01] 55%|█████▍    | 82/150 [34:59<28:34, 25.22s/epoch, loss=0.55, accuracy=0.88, val_loss=0.89, val_accuracy=0.791, lr=0.01]    55%|█████▌    | 83/150 [35:25<28:26, 25.47s/epoch, loss=0.544, accuracy=0.881, val_loss=0.858, val_accuracy=0.785, lr=0.01] 56%|█████▌    | 84/150 [35:51<28:12, 25.64s/epoch, loss=0.548, accuracy=0.88, val_loss=1.05, val_accuracy=0.751, lr=0.01]   57%|█████▋    | 85/150 [36:16<27:36, 25.49s/epoch, loss=0.543, accuracy=0.883, val_loss=0.932, val_accuracy=0.765, lr=0.01] 57%|█████▋    | 86/150 [36:41<26:52, 25.20s/epoch, loss=0.544, accuracy=0.882, val_loss=0.987, val_accuracy=0.754, lr=0.01] 58%|█████▊    | 87/150 [37:06<26:27, 25.19s/epoch, loss=0.544, accuracy=0.882, val_loss=0.88, val_accuracy=0.778, lr=0.01]  59%|█████▊    | 88/150 [37:32<26:13, 25.38s/epoch, loss=0.543, accuracy=0.883, val_loss=0.744, val_accuracy=0.814, lr=0.01] 59%|█████▉    | 89/150 [37:57<25:53, 25.46s/epoch, loss=0.543, accuracy=0.884, val_loss=0.8, val_accuracy=0.806, lr=0.01]   60%|██████    | 90/150 [38:23<25:31, 25.52s/epoch, loss=0.547, accuracy=0.882, val_loss=0.913, val_accuracy=0.768, lr=0.01] 61%|██████    | 91/150 [38:47<24:41, 25.11s/epoch, loss=0.543, accuracy=0.885, val_loss=0.893, val_accuracy=0.793, lr=0.01] 61%|██████▏   | 92/150 [39:11<24:01, 24.85s/epoch, loss=0.464, accuracy=0.912, val_loss=0.529, val_accuracy=0.888, lr=0.001] 62%|██████▏   | 93/150 [39:37<23:47, 25.04s/epoch, loss=0.416, accuracy=0.927, val_loss=0.504, val_accuracy=0.895, lr=0.001] 63%|██████▎   | 94/150 [40:02<23:32, 25.23s/epoch, loss=0.394, accuracy=0.933, val_loss=0.494, val_accuracy=0.896, lr=0.001] 63%|██████▎   | 95/150 [40:28<23:15, 25.38s/epoch, loss=0.379, accuracy=0.936, val_loss=0.493, val_accuracy=0.898, lr=0.001] 64%|██████▍   | 96/150 [40:53<22:47, 25.32s/epoch, loss=0.364, accuracy=0.94, val_loss=0.487, val_accuracy=0.896, lr=0.001]  65%|██████▍   | 97/150 [41:16<21:41, 24.55s/epoch, loss=0.354, accuracy=0.941, val_loss=0.475, val_accuracy=0.898, lr=0.001] 65%|██████▌   | 98/150 [41:41<21:19, 24.61s/epoch, loss=0.342, accuracy=0.944, val_loss=0.475, val_accuracy=0.899, lr=0.001] 66%|██████▌   | 99/150 [42:05<20:48, 24.47s/epoch, loss=0.331, accuracy=0.946, val_loss=0.47, val_accuracy=0.899, lr=0.001]  67%|██████▋   | 100/150 [42:29<20:22, 24.44s/epoch, loss=0.324, accuracy=0.946, val_loss=0.472, val_accuracy=0.898, lr=0.001] 67%|██████▋   | 101/150 [42:55<20:12, 24.75s/epoch, loss=0.316, accuracy=0.947, val_loss=0.47, val_accuracy=0.897, lr=0.001]  68%|██████▊   | 102/150 [43:21<20:02, 25.05s/epoch, loss=0.305, accuracy=0.95, val_loss=0.462, val_accuracy=0.898, lr=0.001] 69%|██████▊   | 103/150 [43:46<19:47, 25.27s/epoch, loss=0.298, accuracy=0.951, val_loss=0.471, val_accuracy=0.895, lr=0.001] 69%|██████▉   | 104/150 [44:12<19:29, 25.43s/epoch, loss=0.293, accuracy=0.951, val_loss=0.465, val_accuracy=0.896, lr=0.001] 70%|███████   | 105/150 [44:36<18:48, 25.08s/epoch, loss=0.287, accuracy=0.953, val_loss=0.464, val_accuracy=0.898, lr=0.001] 71%|███████   | 106/150 [45:02<18:23, 25.08s/epoch, loss=0.279, accuracy=0.955, val_loss=0.456, val_accuracy=0.899, lr=0.001] 71%|███████▏  | 107/150 [45:27<18:06, 25.26s/epoch, loss=0.276, accuracy=0.954, val_loss=0.453, val_accuracy=0.898, lr=0.001] 72%|███████▏  | 108/150 [45:53<17:43, 25.31s/epoch, loss=0.268, accuracy=0.956, val_loss=0.467, val_accuracy=0.891, lr=0.001] 73%|███████▎  | 109/150 [46:18<17:22, 25.43s/epoch, loss=0.267, accuracy=0.954, val_loss=0.455, val_accuracy=0.898, lr=0.001] 73%|███████▎  | 110/150 [46:43<16:48, 25.21s/epoch, loss=0.258, accuracy=0.958, val_loss=0.476, val_accuracy=0.889, lr=0.001] 74%|███████▍  | 111/150 [47:08<16:20, 25.14s/epoch, loss=0.258, accuracy=0.955, val_loss=0.472, val_accuracy=0.892, lr=0.001] 75%|███████▍  | 112/150 [47:34<16:02, 25.34s/epoch, loss=0.248, accuracy=0.959, val_loss=0.443, val_accuracy=0.9, lr=0.001]   75%|███████▌  | 113/150 [47:59<15:39, 25.39s/epoch, loss=0.247, accuracy=0.958, val_loss=0.454, val_accuracy=0.894, lr=0.001] 76%|███████▌  | 114/150 [48:25<15:17, 25.48s/epoch, loss=0.246, accuracy=0.957, val_loss=0.486, val_accuracy=0.886, lr=0.001] 77%|███████▋  | 115/150 [48:49<14:36, 25.04s/epoch, loss=0.241, accuracy=0.959, val_loss=0.464, val_accuracy=0.893, lr=0.001] 77%|███████▋  | 116/150 [49:14<14:07, 24.92s/epoch, loss=0.239, accuracy=0.957, val_loss=0.455, val_accuracy=0.894, lr=0.001] 78%|███████▊  | 117/150 [49:39<13:50, 25.17s/epoch, loss=0.236, accuracy=0.96, val_loss=0.465, val_accuracy=0.895, lr=0.001]  79%|███████▊  | 118/150 [50:05<13:32, 25.38s/epoch, loss=0.232, accuracy=0.959, val_loss=0.477, val_accuracy=0.887, lr=0.001] 79%|███████▉  | 119/150 [50:31<13:10, 25.51s/epoch, loss=0.232, accuracy=0.958, val_loss=0.451, val_accuracy=0.894, lr=0.001] 80%|████████  | 120/150 [50:56<12:39, 25.31s/epoch, loss=0.228, accuracy=0.96, val_loss=0.475, val_accuracy=0.886, lr=0.001]  81%|████████  | 121/150 [51:21<12:09, 25.16s/epoch, loss=0.225, accuracy=0.96, val_loss=0.478, val_accuracy=0.885, lr=0.001] 81%|████████▏ | 122/150 [51:47<11:50, 25.38s/epoch, loss=0.207, accuracy=0.967, val_loss=0.408, val_accuracy=0.908, lr=1e-04] 82%|████████▏ | 123/150 [52:13<11:29, 25.55s/epoch, loss=0.191, accuracy=0.974, val_loss=0.41, val_accuracy=0.908, lr=1e-04]  83%|████████▎ | 124/150 [52:38<11:06, 25.62s/epoch, loss=0.189, accuracy=0.974, val_loss=0.406, val_accuracy=0.909, lr=1e-04] 83%|████████▎ | 125/150 [53:03<10:35, 25.43s/epoch, loss=0.184, accuracy=0.977, val_loss=0.414, val_accuracy=0.908, lr=1e-04] 84%|████████▍ | 126/150 [53:28<10:07, 25.31s/epoch, loss=0.184, accuracy=0.977, val_loss=0.409, val_accuracy=0.908, lr=1e-04] 85%|████████▍ | 127/150 [53:54<09:46, 25.48s/epoch, loss=0.182, accuracy=0.978, val_loss=0.41, val_accuracy=0.909, lr=1e-04]  85%|████████▌ | 128/150 [54:20<09:22, 25.56s/epoch, loss=0.181, accuracy=0.977, val_loss=0.411, val_accuracy=0.906, lr=1e-04] 86%|████████▌ | 129/150 [54:46<08:57, 25.58s/epoch, loss=0.178, accuracy=0.979, val_loss=0.407, val_accuracy=0.908, lr=1e-04] 87%|████████▋ | 130/150 [55:10<08:27, 25.35s/epoch, loss=0.177, accuracy=0.978, val_loss=0.411, val_accuracy=0.908, lr=1e-04] 87%|████████▋ | 131/150 [55:35<07:57, 25.11s/epoch, loss=0.176, accuracy=0.979, val_loss=0.412, val_accuracy=0.908, lr=1e-04] 88%|████████▊ | 132/150 [56:01<07:36, 25.37s/epoch, loss=0.175, accuracy=0.98, val_loss=0.411, val_accuracy=0.908, lr=1e-04]  89%|████████▊ | 133/150 [56:27<07:13, 25.49s/epoch, loss=0.174, accuracy=0.98, val_loss=0.412, val_accuracy=0.908, lr=1e-04] 89%|████████▉ | 134/150 [56:52<06:48, 25.51s/epoch, loss=0.173, accuracy=0.98, val_loss=0.413, val_accuracy=0.905, lr=1e-04] 90%|█████████ | 135/150 [57:17<06:18, 25.26s/epoch, loss=0.173, accuracy=0.979, val_loss=0.41, val_accuracy=0.906, lr=1e-04] 91%|█████████ | 136/150 [57:42<05:50, 25.06s/epoch, loss=0.171, accuracy=0.981, val_loss=0.411, val_accuracy=0.908, lr=1e-04] 91%|█████████▏| 137/150 [58:07<05:27, 25.18s/epoch, loss=0.169, accuracy=0.98, val_loss=0.412, val_accuracy=0.907, lr=5e-5]   92%|█████████▏| 138/150 [58:32<05:03, 25.26s/epoch, loss=0.169, accuracy=0.981, val_loss=0.412, val_accuracy=0.907, lr=5e-5] 93%|█████████▎| 139/150 [58:58<04:39, 25.37s/epoch, loss=0.169, accuracy=0.981, val_loss=0.412, val_accuracy=0.907, lr=5e-5] 93%|█████████▎| 140/150 [59:23<04:11, 25.18s/epoch, loss=0.165, accuracy=0.982, val_loss=0.412, val_accuracy=0.906, lr=5e-5] 94%|█████████▍| 141/150 [59:47<03:44, 24.98s/epoch, loss=0.166, accuracy=0.981, val_loss=0.413, val_accuracy=0.909, lr=5e-5] 95%|█████████▍| 142/150 [1:00:13<03:21, 25.18s/epoch, loss=0.166, accuracy=0.982, val_loss=0.41, val_accuracy=0.909, lr=5e-5] 95%|█████████▌| 143/150 [1:00:38<02:56, 25.24s/epoch, loss=0.165, accuracy=0.982, val_loss=0.413, val_accuracy=0.905, lr=5e-5] 96%|█████████▌| 144/150 [1:01:04<02:31, 25.33s/epoch, loss=0.164, accuracy=0.983, val_loss=0.414, val_accuracy=0.907, lr=5e-5] 97%|█████████▋| 145/150 [1:01:29<02:05, 25.20s/epoch, loss=0.165, accuracy=0.982, val_loss=0.413, val_accuracy=0.908, lr=5e-5] 97%|█████████▋| 146/150 [1:01:53<01:40, 25.00s/epoch, loss=0.164, accuracy=0.982, val_loss=0.413, val_accuracy=0.908, lr=5e-5] 98%|█████████▊| 147/150 [1:02:19<01:15, 25.18s/epoch, loss=0.163, accuracy=0.983, val_loss=0.415, val_accuracy=0.908, lr=5e-5] 99%|█████████▊| 148/150 [1:02:45<00:50, 25.30s/epoch, loss=0.164, accuracy=0.982, val_loss=0.414, val_accuracy=0.907, lr=5e-5] 99%|█████████▉| 149/150 [1:03:10<00:25, 25.43s/epoch, loss=0.163, accuracy=0.983, val_loss=0.415, val_accuracy=0.907, lr=5e-5]100%|██████████| 150/150 [1:03:35<00:00, 25.29s/epoch, loss=0.161, accuracy=0.983, val_loss=0.415, val_accuracy=0.907, lr=5e-5]100%|██████████| 150/150 [1:03:35<00:00, 25.44s/epoch, loss=0.161, accuracy=0.983, val_loss=0.415, val_accuracy=0.907, lr=5e-5]
Using real-time data augmentation.
Only one model saved

Loading model: 10_05_cifar10_ResNet20v1.h5
Test score: 0.41530635952949524
Test accuracy: 0.9067000150680542


* * * Run SGD for ID = 10_6. * * *


2024-03-13 02:42:30.866555: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 02:42:33.554058: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 02:42:33.555254: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-13 02:42:33.600798: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:86:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-13 02:42:33.600849: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 02:42:33.604201: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 02:42:33.604279: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 02:42:33.606762: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 02:42:33.607648: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 02:42:33.610398: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 02:42:33.612201: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 02:42:33.617567: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 02:42:33.618243: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 02:42:33.618330: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 02:42:34.883132: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-13 02:42:34.884223: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 02:42:34.885379: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:86:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-13 02:42:34.885416: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 02:42:34.885454: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 02:42:34.885467: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 02:42:34.885479: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 02:42:34.885491: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 02:42:34.885505: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 02:42:34.885517: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 02:42:34.885529: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 02:42:34.886082: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 02:42:34.886124: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 02:42:35.538598: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-13 02:42:35.538652: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-13 02:42:35.538662: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-13 02:42:35.541505: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:86:00.0, compute capability: 6.1)
{'id': '10_06', 'seed': 6, 'out_folder': 'results/epoch_budget_2', 'batch_size': 128, 'epochs': 150, 'validation_split': 0.0, 'checkpointing': False, 'checkpoint_every': -1, 'hold_out_validation_split': 0.0, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'num_classes': 10, 'SSE_lr': False, 'test_time_augmentation': False, 'debug': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
y_train shape: (50000, 10)
x_val shape: (10000, 32, 32, 3)
y_val shape: (10000, 10)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/150 [00:00<?, ?epoch/s]2024-03-13 02:42:36.156619: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-13 02:42:36.169001: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-03-13 02:42:38.078232: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 02:42:38.360046: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 02:42:40.872874: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-13 02:42:40.917225: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/150 [01:00<2:31:06, 60.85s/epoch, loss=3.09, accuracy=0.3, val_loss=2.02, val_accuracy=0.352, lr=0.1]  1%|▏         | 2/150 [01:26<1:39:17, 40.25s/epoch, loss=1.55, accuracy=0.527, val_loss=1.81, val_accuracy=0.476, lr=0.1]  2%|▏         | 3/150 [01:51<1:21:43, 33.36s/epoch, loss=1.35, accuracy=0.629, val_loss=1.71, val_accuracy=0.507, lr=0.1]  3%|▎         | 4/150 [02:16<1:13:00, 30.00s/epoch, loss=1.27, accuracy=0.676, val_loss=2.11, val_accuracy=0.403, lr=0.1]  3%|▎         | 5/150 [02:42<1:08:59, 28.55s/epoch, loss=1.24, accuracy=0.699, val_loss=2.33, val_accuracy=0.461, lr=0.1]  4%|▍         | 6/150 [03:08<1:06:09, 27.57s/epoch, loss=1.23, accuracy=0.71, val_loss=2.06, val_accuracy=0.516, lr=0.1]   5%|▍         | 7/150 [03:34<1:04:28, 27.05s/epoch, loss=1.22, accuracy=0.717, val_loss=1.66, val_accuracy=0.576, lr=0.1]  5%|▌         | 8/150 [04:00<1:03:00, 26.62s/epoch, loss=1.21, accuracy=0.721, val_loss=1.74, val_accuracy=0.573, lr=0.1]  6%|▌         | 9/150 [04:24<1:01:11, 26.04s/epoch, loss=1.2, accuracy=0.729, val_loss=1.62, val_accuracy=0.593, lr=0.1]   7%|▋         | 10/150 [04:50<1:00:15, 25.83s/epoch, loss=1.2, accuracy=0.731, val_loss=1.68, val_accuracy=0.564, lr=0.1]  7%|▋         | 11/150 [05:16<1:00:08, 25.96s/epoch, loss=1.19, accuracy=0.734, val_loss=7.73, val_accuracy=0.273, lr=0.1]  8%|▊         | 12/150 [05:42<59:48, 26.00s/epoch, loss=1.19, accuracy=0.735, val_loss=2.65, val_accuracy=0.37, lr=0.1]     9%|▊         | 13/150 [06:08<59:16, 25.96s/epoch, loss=1.18, accuracy=0.737, val_loss=1.95, val_accuracy=0.516, lr=0.1]  9%|▉         | 14/150 [06:32<57:40, 25.44s/epoch, loss=1.18, accuracy=0.737, val_loss=1.66, val_accuracy=0.554, lr=0.1] 10%|█         | 15/150 [06:57<56:43, 25.21s/epoch, loss=1.18, accuracy=0.738, val_loss=2.32, val_accuracy=0.479, lr=0.1] 11%|█         | 16/150 [07:22<56:37, 25.36s/epoch, loss=1.18, accuracy=0.74, val_loss=1.63, val_accuracy=0.568, lr=0.1]  11%|█▏        | 17/150 [07:48<56:26, 25.47s/epoch, loss=1.17, accuracy=0.744, val_loss=3.6, val_accuracy=0.315, lr=0.1] 12%|█▏        | 18/150 [08:14<56:12, 25.55s/epoch, loss=1.17, accuracy=0.741, val_loss=1.69, val_accuracy=0.602, lr=0.1] 13%|█▎        | 19/150 [08:39<55:24, 25.38s/epoch, loss=1.16, accuracy=0.744, val_loss=1.58, val_accuracy=0.614, lr=0.1] 13%|█▎        | 20/150 [09:03<54:27, 25.13s/epoch, loss=1.16, accuracy=0.744, val_loss=1.98, val_accuracy=0.489, lr=0.1] 14%|█▍        | 21/150 [09:29<54:21, 25.29s/epoch, loss=1.16, accuracy=0.746, val_loss=1.47, val_accuracy=0.629, lr=0.1] 15%|█▍        | 22/150 [09:55<54:22, 25.49s/epoch, loss=1.15, accuracy=0.747, val_loss=2.96, val_accuracy=0.433, lr=0.1] 15%|█▌        | 23/150 [10:21<54:12, 25.61s/epoch, loss=1.16, accuracy=0.745, val_loss=2.71, val_accuracy=0.446, lr=0.1] 16%|█▌        | 24/150 [10:46<53:38, 25.55s/epoch, loss=1.15, accuracy=0.747, val_loss=2.33, val_accuracy=0.44, lr=0.1]  17%|█▋        | 25/150 [11:11<52:28, 25.19s/epoch, loss=1.15, accuracy=0.747, val_loss=1.55, val_accuracy=0.617, lr=0.1] 17%|█▋        | 26/150 [11:37<52:32, 25.43s/epoch, loss=1.15, accuracy=0.75, val_loss=3.64, val_accuracy=0.238, lr=0.1]  18%|█▊        | 27/150 [12:02<52:19, 25.52s/epoch, loss=1.15, accuracy=0.749, val_loss=1.74, val_accuracy=0.56, lr=0.1] 19%|█▊        | 28/150 [12:28<52:08, 25.64s/epoch, loss=1.15, accuracy=0.749, val_loss=1.84, val_accuracy=0.507, lr=0.1] 19%|█▉        | 29/150 [12:53<51:10, 25.38s/epoch, loss=1.14, accuracy=0.749, val_loss=2.84, val_accuracy=0.387, lr=0.1] 20%|██        | 30/150 [13:18<50:14, 25.12s/epoch, loss=1.14, accuracy=0.753, val_loss=3.25, val_accuracy=0.351, lr=0.1] 21%|██        | 31/150 [13:43<50:06, 25.27s/epoch, loss=1.13, accuracy=0.753, val_loss=1.86, val_accuracy=0.488, lr=0.1] 21%|██▏       | 32/150 [14:09<49:59, 25.42s/epoch, loss=1.13, accuracy=0.752, val_loss=2.34, val_accuracy=0.441, lr=0.1] 22%|██▏       | 33/150 [14:35<49:48, 25.54s/epoch, loss=1.14, accuracy=0.753, val_loss=1.73, val_accuracy=0.564, lr=0.1] 23%|██▎       | 34/150 [15:00<49:19, 25.51s/epoch, loss=1.13, accuracy=0.755, val_loss=1.6, val_accuracy=0.585, lr=0.1]  23%|██▎       | 35/150 [15:25<48:13, 25.16s/epoch, loss=1.13, accuracy=0.755, val_loss=1.89, val_accuracy=0.566, lr=0.1] 24%|██▍       | 36/150 [15:50<47:58, 25.25s/epoch, loss=1.14, accuracy=0.755, val_loss=2.29, val_accuracy=0.499, lr=0.1] 25%|██▍       | 37/150 [16:16<47:45, 25.35s/epoch, loss=1.13, accuracy=0.756, val_loss=1.8, val_accuracy=0.527, lr=0.1]  25%|██▌       | 38/150 [16:41<47:28, 25.43s/epoch, loss=1.13, accuracy=0.754, val_loss=2.11, val_accuracy=0.526, lr=0.1] 26%|██▌       | 39/150 [17:07<47:08, 25.48s/epoch, loss=1.13, accuracy=0.755, val_loss=1.85, val_accuracy=0.486, lr=0.1] 27%|██▋       | 40/150 [17:32<46:14, 25.22s/epoch, loss=1.13, accuracy=0.753, val_loss=1.61, val_accuracy=0.615, lr=0.1] 27%|██▋       | 41/150 [17:57<46:06, 25.38s/epoch, loss=1.12, accuracy=0.756, val_loss=1.61, val_accuracy=0.587, lr=0.1] 28%|██▊       | 42/150 [18:23<45:51, 25.48s/epoch, loss=1.12, accuracy=0.756, val_loss=1.87, val_accuracy=0.488, lr=0.1] 29%|██▊       | 43/150 [18:49<45:31, 25.53s/epoch, loss=1.12, accuracy=0.758, val_loss=2.43, val_accuracy=0.454, lr=0.1] 29%|██▉       | 44/150 [19:14<45:03, 25.50s/epoch, loss=1.13, accuracy=0.755, val_loss=2.04, val_accuracy=0.471, lr=0.1] 30%|███       | 45/150 [19:39<44:04, 25.18s/epoch, loss=1.12, accuracy=0.757, val_loss=2.08, val_accuracy=0.413, lr=0.1] 31%|███       | 46/150 [20:04<43:54, 25.33s/epoch, loss=1.13, accuracy=0.758, val_loss=5.12, val_accuracy=0.23, lr=0.1]  31%|███▏      | 47/150 [20:30<43:41, 25.45s/epoch, loss=1.12, accuracy=0.759, val_loss=1.58, val_accuracy=0.637, lr=0.1] 32%|███▏      | 48/150 [20:56<43:27, 25.56s/epoch, loss=1.12, accuracy=0.756, val_loss=2.05, val_accuracy=0.525, lr=0.1] 33%|███▎      | 49/150 [21:21<42:57, 25.52s/epoch, loss=1.12, accuracy=0.757, val_loss=1.93, val_accuracy=0.472, lr=0.1] 33%|███▎      | 50/150 [21:46<42:04, 25.25s/epoch, loss=1.12, accuracy=0.756, val_loss=3.44, val_accuracy=0.391, lr=0.1] 34%|███▍      | 51/150 [22:12<41:55, 25.41s/epoch, loss=1.11, accuracy=0.758, val_loss=1.75, val_accuracy=0.521, lr=0.1] 35%|███▍      | 52/150 [22:37<41:42, 25.53s/epoch, loss=1.12, accuracy=0.759, val_loss=1.92, val_accuracy=0.509, lr=0.1] 35%|███▌      | 53/150 [23:03<41:29, 25.66s/epoch, loss=1.12, accuracy=0.756, val_loss=3.43, val_accuracy=0.319, lr=0.1] 36%|███▌      | 54/150 [23:29<41:03, 25.67s/epoch, loss=1.11, accuracy=0.758, val_loss=2.74, val_accuracy=0.396, lr=0.1] 37%|███▋      | 55/150 [23:53<39:58, 25.24s/epoch, loss=1.12, accuracy=0.759, val_loss=2.98, val_accuracy=0.27, lr=0.1]  37%|███▋      | 56/150 [24:19<39:53, 25.46s/epoch, loss=1.12, accuracy=0.756, val_loss=1.91, val_accuracy=0.532, lr=0.1] 38%|███▊      | 57/150 [24:45<39:29, 25.48s/epoch, loss=1.11, accuracy=0.76, val_loss=1.96, val_accuracy=0.53, lr=0.1]   39%|███▊      | 58/150 [25:11<39:13, 25.58s/epoch, loss=1.12, accuracy=0.758, val_loss=2.29, val_accuracy=0.468, lr=0.1] 39%|███▉      | 59/150 [25:36<38:43, 25.54s/epoch, loss=1.12, accuracy=0.757, val_loss=2.08, val_accuracy=0.421, lr=0.1] 40%|████      | 60/150 [26:01<37:59, 25.32s/epoch, loss=1.12, accuracy=0.758, val_loss=1.63, val_accuracy=0.606, lr=0.1] 41%|████      | 61/150 [26:26<37:41, 25.41s/epoch, loss=1.11, accuracy=0.758, val_loss=1.74, val_accuracy=0.594, lr=0.1] 41%|████▏     | 62/150 [26:52<37:30, 25.57s/epoch, loss=0.892, accuracy=0.82, val_loss=0.883, val_accuracy=0.805, lr=0.01] 42%|████▏     | 63/150 [27:18<37:11, 25.65s/epoch, loss=0.723, accuracy=0.848, val_loss=0.849, val_accuracy=0.792, lr=0.01] 43%|████▎     | 64/150 [27:44<36:39, 25.57s/epoch, loss=0.638, accuracy=0.859, val_loss=0.805, val_accuracy=0.794, lr=0.01] 43%|████▎     | 65/150 [28:08<35:43, 25.22s/epoch, loss=0.605, accuracy=0.858, val_loss=0.832, val_accuracy=0.773, lr=0.01] 44%|████▍     | 66/150 [28:34<35:34, 25.42s/epoch, loss=0.581, accuracy=0.861, val_loss=0.774, val_accuracy=0.79, lr=0.01]  45%|████▍     | 67/150 [28:59<35:13, 25.46s/epoch, loss=0.57, accuracy=0.862, val_loss=0.874, val_accuracy=0.766, lr=0.01] 45%|████▌     | 68/150 [29:25<34:58, 25.59s/epoch, loss=0.565, accuracy=0.864, val_loss=0.867, val_accuracy=0.766, lr=0.01] 46%|████▌     | 69/150 [29:50<34:22, 25.46s/epoch, loss=0.564, accuracy=0.865, val_loss=0.715, val_accuracy=0.817, lr=0.01] 47%|████▋     | 70/150 [30:14<33:18, 24.98s/epoch, loss=0.561, accuracy=0.866, val_loss=0.738, val_accuracy=0.811, lr=0.01] 47%|████▋     | 71/150 [30:38<32:24, 24.61s/epoch, loss=0.554, accuracy=0.868, val_loss=0.738, val_accuracy=0.815, lr=0.01] 48%|████▊     | 72/150 [31:02<31:46, 24.44s/epoch, loss=0.56, accuracy=0.867, val_loss=0.827, val_accuracy=0.786, lr=0.01]  49%|████▊     | 73/150 [31:26<31:13, 24.33s/epoch, loss=0.554, accuracy=0.871, val_loss=1.37, val_accuracy=0.665, lr=0.01] 49%|████▉     | 74/150 [31:51<30:55, 24.42s/epoch, loss=0.56, accuracy=0.869, val_loss=0.8, val_accuracy=0.791, lr=0.01]   50%|█████     | 75/150 [32:17<31:06, 24.89s/epoch, loss=0.556, accuracy=0.871, val_loss=1.1, val_accuracy=0.735, lr=0.01] 51%|█████     | 76/150 [32:43<31:01, 25.16s/epoch, loss=0.561, accuracy=0.871, val_loss=0.862, val_accuracy=0.777, lr=0.01] 51%|█████▏    | 77/150 [33:08<30:52, 25.37s/epoch, loss=0.555, accuracy=0.872, val_loss=1.17, val_accuracy=0.703, lr=0.01]  52%|█████▏    | 78/150 [33:33<30:05, 25.07s/epoch, loss=0.552, accuracy=0.876, val_loss=0.688, val_accuracy=0.833, lr=0.01] 53%|█████▎    | 79/150 [33:57<29:17, 24.76s/epoch, loss=0.551, accuracy=0.878, val_loss=0.781, val_accuracy=0.804, lr=0.01] 53%|█████▎    | 80/150 [34:21<28:45, 24.65s/epoch, loss=0.554, accuracy=0.874, val_loss=0.741, val_accuracy=0.817, lr=0.01] 54%|█████▍    | 81/150 [34:46<28:27, 24.75s/epoch, loss=0.552, accuracy=0.877, val_loss=0.784, val_accuracy=0.801, lr=0.01] 55%|█████▍    | 82/150 [35:12<28:21, 25.03s/epoch, loss=0.552, accuracy=0.878, val_loss=0.866, val_accuracy=0.79, lr=0.01]  55%|█████▌    | 83/150 [35:38<28:08, 25.20s/epoch, loss=0.548, accuracy=0.878, val_loss=0.954, val_accuracy=0.744, lr=0.01] 56%|█████▌    | 84/150 [36:03<27:49, 25.30s/epoch, loss=0.555, accuracy=0.878, val_loss=0.81, val_accuracy=0.785, lr=0.01]  57%|█████▋    | 85/150 [36:27<26:58, 24.90s/epoch, loss=0.55, accuracy=0.881, val_loss=0.79, val_accuracy=0.798, lr=0.01]  57%|█████▋    | 86/150 [36:51<26:16, 24.63s/epoch, loss=0.548, accuracy=0.88, val_loss=0.916, val_accuracy=0.781, lr=0.01] 58%|█████▊    | 87/150 [37:15<25:39, 24.44s/epoch, loss=0.547, accuracy=0.882, val_loss=1.04, val_accuracy=0.742, lr=0.01] 59%|█████▊    | 88/150 [37:40<25:32, 24.71s/epoch, loss=0.551, accuracy=0.881, val_loss=1.08, val_accuracy=0.719, lr=0.01] 59%|█████▉    | 89/150 [38:06<25:22, 24.96s/epoch, loss=0.547, accuracy=0.882, val_loss=0.746, val_accuracy=0.82, lr=0.01] 60%|██████    | 90/150 [38:31<25:05, 25.10s/epoch, loss=0.55, accuracy=0.882, val_loss=1.14, val_accuracy=0.712, lr=0.01]  61%|██████    | 91/150 [38:57<24:46, 25.19s/epoch, loss=0.55, accuracy=0.881, val_loss=0.747, val_accuracy=0.816, lr=0.01] 61%|██████▏   | 92/150 [39:21<23:59, 24.82s/epoch, loss=0.476, accuracy=0.908, val_loss=0.531, val_accuracy=0.889, lr=0.001] 62%|██████▏   | 93/150 [39:45<23:21, 24.60s/epoch, loss=0.421, accuracy=0.924, val_loss=0.511, val_accuracy=0.895, lr=0.001] 63%|██████▎   | 94/150 [40:09<22:48, 24.44s/epoch, loss=0.399, accuracy=0.931, val_loss=0.502, val_accuracy=0.896, lr=0.001] 63%|██████▎   | 95/150 [40:34<22:38, 24.71s/epoch, loss=0.382, accuracy=0.933, val_loss=0.503, val_accuracy=0.894, lr=0.001] 64%|██████▍   | 96/150 [41:00<22:24, 24.90s/epoch, loss=0.368, accuracy=0.937, val_loss=0.5, val_accuracy=0.896, lr=0.001]   65%|██████▍   | 97/150 [41:25<22:11, 25.12s/epoch, loss=0.359, accuracy=0.938, val_loss=0.493, val_accuracy=0.897, lr=0.001] 65%|██████▌   | 98/150 [41:50<21:47, 25.14s/epoch, loss=0.346, accuracy=0.942, val_loss=0.484, val_accuracy=0.896, lr=0.001] 66%|██████▌   | 99/150 [42:15<21:10, 24.92s/epoch, loss=0.336, accuracy=0.943, val_loss=0.485, val_accuracy=0.896, lr=0.001] 67%|██████▋   | 100/150 [42:40<20:48, 24.97s/epoch, loss=0.329, accuracy=0.943, val_loss=0.495, val_accuracy=0.895, lr=0.001] 67%|██████▋   | 101/150 [43:05<20:22, 24.96s/epoch, loss=0.321, accuracy=0.944, val_loss=0.469, val_accuracy=0.902, lr=0.001] 68%|██████▊   | 102/150 [43:31<20:12, 25.25s/epoch, loss=0.311, accuracy=0.947, val_loss=0.512, val_accuracy=0.889, lr=0.001] 69%|██████▊   | 103/150 [43:56<19:51, 25.36s/epoch, loss=0.302, accuracy=0.949, val_loss=0.479, val_accuracy=0.896, lr=0.001] 69%|██████▉   | 104/150 [44:22<19:31, 25.48s/epoch, loss=0.297, accuracy=0.949, val_loss=0.479, val_accuracy=0.896, lr=0.001] 70%|███████   | 105/150 [44:47<18:58, 25.29s/epoch, loss=0.29, accuracy=0.95, val_loss=0.481, val_accuracy=0.894, lr=0.001]   71%|███████   | 106/150 [45:11<18:16, 24.92s/epoch, loss=0.288, accuracy=0.949, val_loss=0.496, val_accuracy=0.893, lr=0.001] 71%|███████▏  | 107/150 [45:35<17:41, 24.70s/epoch, loss=0.28, accuracy=0.952, val_loss=0.473, val_accuracy=0.898, lr=0.001]  72%|███████▏  | 108/150 [46:00<17:16, 24.67s/epoch, loss=0.272, accuracy=0.954, val_loss=0.486, val_accuracy=0.893, lr=0.001] 73%|███████▎  | 109/150 [46:25<17:01, 24.91s/epoch, loss=0.27, accuracy=0.954, val_loss=0.48, val_accuracy=0.892, lr=0.001]   73%|███████▎  | 110/150 [46:51<16:42, 25.06s/epoch, loss=0.267, accuracy=0.953, val_loss=0.48, val_accuracy=0.897, lr=0.001] 74%|███████▍  | 111/150 [47:16<16:20, 25.14s/epoch, loss=0.261, accuracy=0.955, val_loss=0.483, val_accuracy=0.89, lr=0.001] 75%|███████▍  | 112/150 [47:40<15:48, 24.95s/epoch, loss=0.256, accuracy=0.956, val_loss=0.513, val_accuracy=0.889, lr=0.001] 75%|███████▌  | 113/150 [48:04<15:09, 24.59s/epoch, loss=0.255, accuracy=0.955, val_loss=0.524, val_accuracy=0.882, lr=0.001] 76%|███████▌  | 114/150 [48:28<14:40, 24.46s/epoch, loss=0.254, accuracy=0.955, val_loss=0.49, val_accuracy=0.889, lr=0.001]  77%|███████▋  | 115/150 [48:53<14:18, 24.54s/epoch, loss=0.245, accuracy=0.957, val_loss=0.501, val_accuracy=0.887, lr=0.001] 77%|███████▋  | 116/150 [49:19<14:03, 24.81s/epoch, loss=0.245, accuracy=0.956, val_loss=0.465, val_accuracy=0.898, lr=0.001] 78%|███████▊  | 117/150 [49:44<13:43, 24.96s/epoch, loss=0.243, accuracy=0.956, val_loss=0.485, val_accuracy=0.891, lr=0.001] 79%|███████▊  | 118/150 [50:09<13:24, 25.14s/epoch, loss=0.238, accuracy=0.958, val_loss=0.51, val_accuracy=0.885, lr=0.001]  79%|███████▉  | 119/150 [50:34<12:50, 24.86s/epoch, loss=0.236, accuracy=0.957, val_loss=0.478, val_accuracy=0.892, lr=0.001] 80%|████████  | 120/150 [50:58<12:17, 24.58s/epoch, loss=0.235, accuracy=0.958, val_loss=0.493, val_accuracy=0.883, lr=0.001] 81%|████████  | 121/150 [51:22<11:47, 24.41s/epoch, loss=0.235, accuracy=0.957, val_loss=0.506, val_accuracy=0.882, lr=0.001] 81%|████████▏ | 122/150 [51:46<11:26, 24.53s/epoch, loss=0.212, accuracy=0.966, val_loss=0.426, val_accuracy=0.907, lr=1e-04] 82%|████████▏ | 123/150 [52:12<11:11, 24.85s/epoch, loss=0.197, accuracy=0.972, val_loss=0.426, val_accuracy=0.908, lr=1e-04] 83%|████████▎ | 124/150 [52:37<10:51, 25.04s/epoch, loss=0.195, accuracy=0.973, val_loss=0.423, val_accuracy=0.909, lr=1e-04] 83%|████████▎ | 125/150 [53:03<10:29, 25.17s/epoch, loss=0.188, accuracy=0.975, val_loss=0.427, val_accuracy=0.909, lr=1e-04] 84%|████████▍ | 126/150 [53:27<09:56, 24.85s/epoch, loss=0.188, accuracy=0.975, val_loss=0.428, val_accuracy=0.907, lr=1e-04] 85%|████████▍ | 127/150 [53:51<09:24, 24.55s/epoch, loss=0.184, accuracy=0.977, val_loss=0.432, val_accuracy=0.908, lr=1e-04] 85%|████████▌ | 128/150 [54:15<08:57, 24.43s/epoch, loss=0.181, accuracy=0.978, val_loss=0.428, val_accuracy=0.908, lr=1e-04] 86%|████████▌ | 129/150 [54:40<08:36, 24.62s/epoch, loss=0.181, accuracy=0.978, val_loss=0.426, val_accuracy=0.909, lr=1e-04] 87%|████████▋ | 130/150 [55:06<08:18, 24.91s/epoch, loss=0.18, accuracy=0.978, val_loss=0.429, val_accuracy=0.909, lr=1e-04]  87%|████████▋ | 131/150 [55:31<07:55, 25.05s/epoch, loss=0.177, accuracy=0.979, val_loss=0.427, val_accuracy=0.909, lr=1e-04] 88%|████████▊ | 132/150 [55:56<07:32, 25.12s/epoch, loss=0.175, accuracy=0.979, val_loss=0.428, val_accuracy=0.91, lr=1e-04]  89%|████████▊ | 133/150 [56:20<07:00, 24.74s/epoch, loss=0.175, accuracy=0.979, val_loss=0.43, val_accuracy=0.907, lr=1e-04] 89%|████████▉ | 134/150 [56:44<06:31, 24.45s/epoch, loss=0.176, accuracy=0.978, val_loss=0.428, val_accuracy=0.909, lr=1e-04] 90%|█████████ | 135/150 [57:08<06:05, 24.35s/epoch, loss=0.173, accuracy=0.98, val_loss=0.429, val_accuracy=0.909, lr=1e-04]  91%|█████████ | 136/150 [57:33<05:44, 24.63s/epoch, loss=0.17, accuracy=0.98, val_loss=0.431, val_accuracy=0.909, lr=1e-04]  91%|█████████▏| 137/150 [57:59<05:23, 24.87s/epoch, loss=0.171, accuracy=0.981, val_loss=0.429, val_accuracy=0.909, lr=5e-5] 92%|█████████▏| 138/150 [58:24<05:00, 25.01s/epoch, loss=0.167, accuracy=0.982, val_loss=0.43, val_accuracy=0.909, lr=5e-5]  93%|█████████▎| 139/150 [58:51<04:42, 25.69s/epoch, loss=0.17, accuracy=0.98, val_loss=0.43, val_accuracy=0.908, lr=5e-5]   93%|█████████▎| 140/150 [59:15<04:10, 25.10s/epoch, loss=0.167, accuracy=0.982, val_loss=0.433, val_accuracy=0.908, lr=5e-5] 94%|█████████▍| 141/150 [59:39<03:42, 24.71s/epoch, loss=0.167, accuracy=0.981, val_loss=0.43, val_accuracy=0.907, lr=5e-5]  95%|█████████▍| 142/150 [1:00:03<03:16, 24.51s/epoch, loss=0.167, accuracy=0.981, val_loss=0.43, val_accuracy=0.91, lr=5e-5] 95%|█████████▌| 143/150 [1:00:28<02:53, 24.79s/epoch, loss=0.166, accuracy=0.981, val_loss=0.43, val_accuracy=0.909, lr=5e-5] 96%|█████████▌| 144/150 [1:00:54<02:30, 25.02s/epoch, loss=0.167, accuracy=0.982, val_loss=0.431, val_accuracy=0.909, lr=5e-5] 97%|█████████▋| 145/150 [1:01:20<02:05, 25.19s/epoch, loss=0.165, accuracy=0.982, val_loss=0.432, val_accuracy=0.91, lr=5e-5]  97%|█████████▋| 146/150 [1:01:44<01:40, 25.08s/epoch, loss=0.164, accuracy=0.983, val_loss=0.433, val_accuracy=0.91, lr=5e-5] 98%|█████████▊| 147/150 [1:02:08<01:14, 24.77s/epoch, loss=0.165, accuracy=0.982, val_loss=0.432, val_accuracy=0.91, lr=5e-5] 99%|█████████▊| 148/150 [1:02:33<00:49, 24.59s/epoch, loss=0.163, accuracy=0.983, val_loss=0.431, val_accuracy=0.909, lr=5e-5] 99%|█████████▉| 149/150 [1:02:57<00:24, 24.41s/epoch, loss=0.164, accuracy=0.982, val_loss=0.434, val_accuracy=0.909, lr=5e-5]100%|██████████| 150/150 [1:03:22<00:00, 24.71s/epoch, loss=0.163, accuracy=0.982, val_loss=0.433, val_accuracy=0.908, lr=5e-5]100%|██████████| 150/150 [1:03:22<00:00, 25.35s/epoch, loss=0.163, accuracy=0.982, val_loss=0.433, val_accuracy=0.908, lr=5e-5]
Using real-time data augmentation.
Only one model saved

Loading model: 10_06_cifar10_ResNet20v1.h5
Test score: 0.43264487385749817
Test accuracy: 0.9082000255584717


* * * Run SGD for ID = 10_7. * * *


2024-03-13 03:46:05.984729: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 03:46:12.742942: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 03:46:12.744244: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-13 03:46:12.788311: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:86:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-13 03:46:12.788354: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 03:46:12.791644: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 03:46:12.791710: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 03:46:12.793970: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 03:46:12.794708: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 03:46:12.797437: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 03:46:12.799206: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 03:46:12.804514: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 03:46:12.805189: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 03:46:12.805278: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 03:46:13.997183: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-13 03:46:13.998243: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 03:46:13.999609: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:86:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-13 03:46:13.999652: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 03:46:13.999696: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 03:46:13.999710: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 03:46:13.999724: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 03:46:13.999738: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 03:46:13.999755: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 03:46:13.999769: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 03:46:13.999784: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 03:46:14.000365: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 03:46:14.000406: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 03:46:14.645853: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-13 03:46:14.645900: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-13 03:46:14.645911: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-13 03:46:14.646998: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:86:00.0, compute capability: 6.1)
{'id': '10_07', 'seed': 7, 'out_folder': 'results/epoch_budget_2', 'batch_size': 128, 'epochs': 150, 'validation_split': 0.0, 'checkpointing': False, 'checkpoint_every': -1, 'hold_out_validation_split': 0.0, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'num_classes': 10, 'SSE_lr': False, 'test_time_augmentation': False, 'debug': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
y_train shape: (50000, 10)
x_val shape: (10000, 32, 32, 3)
y_val shape: (10000, 10)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/150 [00:00<?, ?epoch/s]2024-03-13 03:46:15.272196: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-13 03:46:15.284011: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-03-13 03:46:17.198990: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 03:46:17.484568: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 03:46:18.502150: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-13 03:46:18.551049: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/150 [00:57<2:23:51, 57.93s/epoch, loss=3.14, accuracy=0.324, val_loss=3.08, val_accuracy=0.192, lr=0.1]  1%|▏         | 2/150 [01:21<1:33:11, 37.78s/epoch, loss=1.58, accuracy=0.524, val_loss=3.39, val_accuracy=0.221, lr=0.1]  2%|▏         | 3/150 [01:45<1:16:48, 31.35s/epoch, loss=1.37, accuracy=0.618, val_loss=2.11, val_accuracy=0.426, lr=0.1]  3%|▎         | 4/150 [02:09<1:09:20, 28.49s/epoch, loss=1.27, accuracy=0.671, val_loss=2.05, val_accuracy=0.467, lr=0.1]  3%|▎         | 5/150 [02:33<1:04:46, 26.80s/epoch, loss=1.24, accuracy=0.692, val_loss=3.06, val_accuracy=0.34, lr=0.1]   4%|▍         | 6/150 [02:57<1:02:36, 26.09s/epoch, loss=1.23, accuracy=0.705, val_loss=1.96, val_accuracy=0.436, lr=0.1]  5%|▍         | 7/150 [03:23<1:01:50, 25.95s/epoch, loss=1.21, accuracy=0.713, val_loss=2.92, val_accuracy=0.386, lr=0.1]  5%|▌         | 8/150 [03:49<1:01:10, 25.85s/epoch, loss=1.21, accuracy=0.716, val_loss=1.87, val_accuracy=0.494, lr=0.1]  6%|▌         | 9/150 [04:14<1:00:32, 25.76s/epoch, loss=1.2, accuracy=0.724, val_loss=3.93, val_accuracy=0.273, lr=0.1]   7%|▋         | 10/150 [04:39<59:05, 25.32s/epoch, loss=1.2, accuracy=0.726, val_loss=1.89, val_accuracy=0.536, lr=0.1]   7%|▋         | 11/150 [05:02<57:36, 24.87s/epoch, loss=1.2, accuracy=0.727, val_loss=2.25, val_accuracy=0.367, lr=0.1]  8%|▊         | 12/150 [05:26<56:33, 24.59s/epoch, loss=1.19, accuracy=0.73, val_loss=3.69, val_accuracy=0.3, lr=0.1]    9%|▊         | 13/150 [05:51<56:09, 24.60s/epoch, loss=1.2, accuracy=0.73, val_loss=2.22, val_accuracy=0.417, lr=0.1]  9%|▉         | 14/150 [06:16<56:18, 24.84s/epoch, loss=1.2, accuracy=0.734, val_loss=2.8, val_accuracy=0.341, lr=0.1] 10%|█         | 15/150 [06:42<56:10, 24.96s/epoch, loss=1.19, accuracy=0.735, val_loss=1.6, val_accuracy=0.601, lr=0.1] 11%|█         | 16/150 [07:07<56:09, 25.15s/epoch, loss=1.18, accuracy=0.737, val_loss=1.58, val_accuracy=0.609, lr=0.1] 11%|█▏        | 17/150 [07:31<55:04, 24.84s/epoch, loss=1.18, accuracy=0.737, val_loss=1.78, val_accuracy=0.592, lr=0.1] 12%|█▏        | 18/150 [07:55<54:09, 24.61s/epoch, loss=1.18, accuracy=0.74, val_loss=1.55, val_accuracy=0.604, lr=0.1]  13%|█▎        | 19/150 [08:19<53:17, 24.41s/epoch, loss=1.19, accuracy=0.74, val_loss=2.47, val_accuracy=0.388, lr=0.1] 13%|█▎        | 20/150 [08:44<53:06, 24.51s/epoch, loss=1.18, accuracy=0.743, val_loss=2.1, val_accuracy=0.46, lr=0.1]  14%|█▍        | 21/150 [09:10<53:26, 24.85s/epoch, loss=1.18, accuracy=0.742, val_loss=1.67, val_accuracy=0.609, lr=0.1] 15%|█▍        | 22/150 [09:35<53:00, 24.85s/epoch, loss=1.18, accuracy=0.744, val_loss=2.9, val_accuracy=0.272, lr=0.1]  15%|█▌        | 23/150 [10:00<53:12, 25.14s/epoch, loss=1.17, accuracy=0.744, val_loss=2.46, val_accuracy=0.416, lr=0.1] 16%|█▌        | 24/150 [10:25<52:33, 25.03s/epoch, loss=1.17, accuracy=0.748, val_loss=2.24, val_accuracy=0.38, lr=0.1]  17%|█▋        | 25/150 [10:49<51:25, 24.68s/epoch, loss=1.17, accuracy=0.745, val_loss=1.89, val_accuracy=0.522, lr=0.1] 17%|█▋        | 26/150 [11:13<50:34, 24.47s/epoch, loss=1.17, accuracy=0.747, val_loss=1.63, val_accuracy=0.604, lr=0.1] 18%|█▊        | 27/150 [11:38<50:16, 24.53s/epoch, loss=1.17, accuracy=0.747, val_loss=2.91, val_accuracy=0.276, lr=0.1] 19%|█▊        | 28/150 [12:03<50:30, 24.84s/epoch, loss=1.17, accuracy=0.749, val_loss=1.89, val_accuracy=0.558, lr=0.1] 19%|█▉        | 29/150 [12:29<50:32, 25.06s/epoch, loss=1.17, accuracy=0.749, val_loss=2.16, val_accuracy=0.482, lr=0.1] 20%|██        | 30/150 [12:54<50:20, 25.17s/epoch, loss=1.17, accuracy=0.749, val_loss=2.99, val_accuracy=0.229, lr=0.1] 21%|██        | 31/150 [13:19<49:31, 24.97s/epoch, loss=1.17, accuracy=0.746, val_loss=1.93, val_accuracy=0.481, lr=0.1] 21%|██▏       | 32/150 [13:43<48:28, 24.65s/epoch, loss=1.16, accuracy=0.75, val_loss=2.81, val_accuracy=0.423, lr=0.1]  22%|██▏       | 33/150 [14:07<47:42, 24.47s/epoch, loss=1.16, accuracy=0.751, val_loss=1.83, val_accuracy=0.509, lr=0.1] 23%|██▎       | 34/150 [14:31<47:18, 24.47s/epoch, loss=1.16, accuracy=0.75, val_loss=2.15, val_accuracy=0.472, lr=0.1]  23%|██▎       | 35/150 [14:57<47:35, 24.83s/epoch, loss=1.16, accuracy=0.752, val_loss=2.69, val_accuracy=0.381, lr=0.1] 24%|██▍       | 36/150 [15:22<47:34, 25.04s/epoch, loss=1.16, accuracy=0.751, val_loss=2.13, val_accuracy=0.467, lr=0.1] 25%|██▍       | 37/150 [15:48<47:25, 25.18s/epoch, loss=1.15, accuracy=0.752, val_loss=1.58, val_accuracy=0.605, lr=0.1] 25%|██▌       | 38/150 [16:12<46:30, 24.92s/epoch, loss=1.15, accuracy=0.751, val_loss=2.27, val_accuracy=0.494, lr=0.1] 26%|██▌       | 39/150 [16:36<45:31, 24.61s/epoch, loss=1.15, accuracy=0.752, val_loss=1.78, val_accuracy=0.564, lr=0.1] 27%|██▋       | 40/150 [17:00<44:46, 24.42s/epoch, loss=1.15, accuracy=0.752, val_loss=1.59, val_accuracy=0.587, lr=0.1] 27%|██▋       | 41/150 [17:25<44:33, 24.52s/epoch, loss=1.16, accuracy=0.751, val_loss=1.91, val_accuracy=0.53, lr=0.1]  28%|██▊       | 42/150 [17:51<44:43, 24.85s/epoch, loss=1.15, accuracy=0.75, val_loss=2.83, val_accuracy=0.325, lr=0.1] 29%|██▊       | 43/150 [18:16<44:44, 25.08s/epoch, loss=1.15, accuracy=0.755, val_loss=2.07, val_accuracy=0.472, lr=0.1] 29%|██▉       | 44/150 [18:42<44:43, 25.32s/epoch, loss=1.15, accuracy=0.754, val_loss=2.36, val_accuracy=0.405, lr=0.1] 30%|███       | 45/150 [19:06<43:49, 25.04s/epoch, loss=1.14, accuracy=0.753, val_loss=1.62, val_accuracy=0.608, lr=0.1] 31%|███       | 46/150 [19:30<42:52, 24.74s/epoch, loss=1.15, accuracy=0.753, val_loss=2.14, val_accuracy=0.524, lr=0.1] 31%|███▏      | 47/150 [19:55<42:11, 24.57s/epoch, loss=1.15, accuracy=0.752, val_loss=2.12, val_accuracy=0.42, lr=0.1]  32%|███▏      | 48/150 [20:20<41:57, 24.68s/epoch, loss=1.14, accuracy=0.754, val_loss=1.62, val_accuracy=0.583, lr=0.1] 33%|███▎      | 49/150 [20:45<41:55, 24.91s/epoch, loss=1.15, accuracy=0.754, val_loss=2.23, val_accuracy=0.394, lr=0.1] 33%|███▎      | 50/150 [21:10<41:47, 25.07s/epoch, loss=1.14, accuracy=0.753, val_loss=2.29, val_accuracy=0.463, lr=0.1] 34%|███▍      | 51/150 [21:36<41:37, 25.23s/epoch, loss=1.15, accuracy=0.755, val_loss=3.71, val_accuracy=0.304, lr=0.1] 35%|███▍      | 52/150 [22:01<41:09, 25.20s/epoch, loss=1.15, accuracy=0.755, val_loss=2.27, val_accuracy=0.406, lr=0.1] 35%|███▌      | 53/150 [22:26<40:25, 25.00s/epoch, loss=1.14, accuracy=0.754, val_loss=3.6, val_accuracy=0.345, lr=0.1]  36%|███▌      | 54/150 [22:50<39:44, 24.84s/epoch, loss=1.14, accuracy=0.753, val_loss=2.07, val_accuracy=0.417, lr=0.1] 37%|███▋      | 55/150 [23:15<39:26, 24.91s/epoch, loss=1.14, accuracy=0.754, val_loss=2.03, val_accuracy=0.457, lr=0.1] 37%|███▋      | 56/150 [23:41<39:21, 25.12s/epoch, loss=1.13, accuracy=0.756, val_loss=1.83, val_accuracy=0.492, lr=0.1] 38%|███▊      | 57/150 [24:07<39:12, 25.30s/epoch, loss=1.14, accuracy=0.754, val_loss=2.22, val_accuracy=0.403, lr=0.1] 39%|███▊      | 58/150 [24:32<39:03, 25.48s/epoch, loss=1.14, accuracy=0.751, val_loss=2.95, val_accuracy=0.33, lr=0.1]  39%|███▉      | 59/150 [24:57<38:01, 25.08s/epoch, loss=1.13, accuracy=0.754, val_loss=1.75, val_accuracy=0.568, lr=0.1] 40%|████      | 60/150 [25:21<37:11, 24.80s/epoch, loss=1.13, accuracy=0.756, val_loss=1.82, val_accuracy=0.523, lr=0.1] 41%|████      | 61/150 [25:45<36:26, 24.56s/epoch, loss=1.14, accuracy=0.752, val_loss=1.51, val_accuracy=0.641, lr=0.1] 41%|████▏     | 62/150 [26:10<36:23, 24.81s/epoch, loss=0.918, accuracy=0.816, val_loss=0.94, val_accuracy=0.787, lr=0.01] 42%|████▏     | 63/150 [26:36<36:17, 25.02s/epoch, loss=0.736, accuracy=0.848, val_loss=1, val_accuracy=0.739, lr=0.01]    43%|████▎     | 64/150 [27:01<36:07, 25.20s/epoch, loss=0.655, accuracy=0.857, val_loss=0.718, val_accuracy=0.83, lr=0.01] 43%|████▎     | 65/150 [27:27<35:44, 25.23s/epoch, loss=0.61, accuracy=0.861, val_loss=0.779, val_accuracy=0.792, lr=0.01] 44%|████▍     | 66/150 [27:51<34:46, 24.84s/epoch, loss=0.588, accuracy=0.862, val_loss=0.866, val_accuracy=0.782, lr=0.01] 45%|████▍     | 67/150 [28:14<33:58, 24.56s/epoch, loss=0.58, accuracy=0.862, val_loss=0.729, val_accuracy=0.811, lr=0.01]  45%|████▌     | 68/150 [28:38<33:20, 24.39s/epoch, loss=0.575, accuracy=0.863, val_loss=0.669, val_accuracy=0.833, lr=0.01] 46%|████▌     | 69/150 [29:04<33:23, 24.74s/epoch, loss=0.568, accuracy=0.865, val_loss=0.765, val_accuracy=0.8, lr=0.01]   47%|████▋     | 70/150 [29:29<33:17, 24.96s/epoch, loss=0.567, accuracy=0.866, val_loss=0.821, val_accuracy=0.78, lr=0.01] 47%|████▋     | 71/150 [29:55<33:05, 25.14s/epoch, loss=0.565, accuracy=0.867, val_loss=0.975, val_accuracy=0.765, lr=0.01] 48%|████▊     | 72/150 [30:20<32:40, 25.13s/epoch, loss=0.565, accuracy=0.868, val_loss=1.43, val_accuracy=0.633, lr=0.01]  49%|████▊     | 73/150 [30:44<31:50, 24.81s/epoch, loss=0.56, accuracy=0.87, val_loss=0.921, val_accuracy=0.751, lr=0.01]  49%|████▉     | 74/150 [31:08<31:08, 24.58s/epoch, loss=0.561, accuracy=0.871, val_loss=0.891, val_accuracy=0.776, lr=0.01] 50%|█████     | 75/150 [31:32<30:33, 24.44s/epoch, loss=0.561, accuracy=0.874, val_loss=0.982, val_accuracy=0.744, lr=0.01] 51%|█████     | 76/150 [31:58<30:36, 24.82s/epoch, loss=0.564, accuracy=0.873, val_loss=0.926, val_accuracy=0.775, lr=0.01] 51%|█████▏    | 77/150 [32:24<30:30, 25.07s/epoch, loss=0.558, accuracy=0.875, val_loss=0.908, val_accuracy=0.779, lr=0.01] 52%|█████▏    | 78/150 [32:50<30:21, 25.30s/epoch, loss=0.558, accuracy=0.877, val_loss=0.997, val_accuracy=0.752, lr=0.01] 53%|█████▎    | 79/150 [33:15<29:53, 25.26s/epoch, loss=0.558, accuracy=0.875, val_loss=0.911, val_accuracy=0.782, lr=0.01] 53%|█████▎    | 80/150 [33:39<29:03, 24.91s/epoch, loss=0.563, accuracy=0.876, val_loss=0.76, val_accuracy=0.81, lr=0.01]   54%|█████▍    | 81/150 [34:03<28:24, 24.70s/epoch, loss=0.559, accuracy=0.878, val_loss=0.828, val_accuracy=0.8, lr=0.01] 55%|█████▍    | 82/150 [34:27<27:49, 24.54s/epoch, loss=0.558, accuracy=0.878, val_loss=0.797, val_accuracy=0.798, lr=0.01] 55%|█████▌    | 83/150 [34:53<27:43, 24.83s/epoch, loss=0.554, accuracy=0.88, val_loss=1.13, val_accuracy=0.724, lr=0.01]   56%|█████▌    | 84/150 [35:18<27:33, 25.05s/epoch, loss=0.556, accuracy=0.879, val_loss=0.871, val_accuracy=0.781, lr=0.01] 57%|█████▋    | 85/150 [35:44<27:14, 25.15s/epoch, loss=0.56, accuracy=0.879, val_loss=0.851, val_accuracy=0.786, lr=0.01]  57%|█████▋    | 86/150 [36:08<26:34, 24.92s/epoch, loss=0.561, accuracy=0.879, val_loss=0.841, val_accuracy=0.8, lr=0.01]  58%|█████▊    | 87/150 [36:31<25:29, 24.28s/epoch, loss=0.553, accuracy=0.881, val_loss=0.721, val_accuracy=0.827, lr=0.01] 59%|█████▊    | 88/150 [36:54<24:45, 23.97s/epoch, loss=0.56, accuracy=0.879, val_loss=0.874, val_accuracy=0.784, lr=0.01]  59%|█████▉    | 89/150 [37:18<24:20, 23.95s/epoch, loss=0.553, accuracy=0.884, val_loss=1.15, val_accuracy=0.738, lr=0.01] 60%|██████    | 90/150 [37:42<23:57, 23.96s/epoch, loss=0.56, accuracy=0.882, val_loss=0.797, val_accuracy=0.808, lr=0.01] 61%|██████    | 91/150 [38:06<23:38, 24.05s/epoch, loss=0.554, accuracy=0.884, val_loss=0.988, val_accuracy=0.756, lr=0.01] 61%|██████▏   | 92/150 [38:31<23:30, 24.33s/epoch, loss=0.475, accuracy=0.911, val_loss=0.531, val_accuracy=0.891, lr=0.001] 62%|██████▏   | 93/150 [38:56<23:17, 24.51s/epoch, loss=0.423, accuracy=0.928, val_loss=0.523, val_accuracy=0.89, lr=0.001]  63%|██████▎   | 94/150 [39:21<23:00, 24.66s/epoch, loss=0.4, accuracy=0.933, val_loss=0.513, val_accuracy=0.891, lr=0.001]  63%|██████▎   | 95/150 [39:46<22:47, 24.87s/epoch, loss=0.386, accuracy=0.936, val_loss=0.497, val_accuracy=0.898, lr=0.001] 64%|██████▍   | 96/150 [40:11<22:15, 24.74s/epoch, loss=0.374, accuracy=0.939, val_loss=0.49, val_accuracy=0.898, lr=0.001]  65%|██████▍   | 97/150 [40:35<21:40, 24.53s/epoch, loss=0.361, accuracy=0.941, val_loss=0.485, val_accuracy=0.901, lr=0.001] 65%|██████▌   | 98/150 [41:01<21:32, 24.86s/epoch, loss=0.352, accuracy=0.943, val_loss=0.494, val_accuracy=0.895, lr=0.001] 66%|██████▌   | 99/150 [41:26<21:18, 25.07s/epoch, loss=0.341, accuracy=0.944, val_loss=0.473, val_accuracy=0.9, lr=0.001]   67%|██████▋   | 100/150 [41:52<21:05, 25.30s/epoch, loss=0.331, accuracy=0.946, val_loss=0.471, val_accuracy=0.903, lr=0.001] 67%|██████▋   | 101/150 [42:17<20:37, 25.26s/epoch, loss=0.324, accuracy=0.948, val_loss=0.468, val_accuracy=0.9, lr=0.001]   68%|██████▊   | 102/150 [42:41<19:53, 24.86s/epoch, loss=0.315, accuracy=0.95, val_loss=0.471, val_accuracy=0.898, lr=0.001] 69%|██████▊   | 103/150 [43:06<19:29, 24.88s/epoch, loss=0.307, accuracy=0.95, val_loss=0.462, val_accuracy=0.9, lr=0.001]   69%|██████▉   | 104/150 [43:31<19:11, 25.03s/epoch, loss=0.298, accuracy=0.952, val_loss=0.457, val_accuracy=0.9, lr=0.001] 70%|███████   | 105/150 [43:57<18:54, 25.22s/epoch, loss=0.293, accuracy=0.952, val_loss=0.461, val_accuracy=0.899, lr=0.001] 71%|███████   | 106/150 [44:23<18:35, 25.35s/epoch, loss=0.286, accuracy=0.954, val_loss=0.447, val_accuracy=0.901, lr=0.001] 71%|███████▏  | 107/150 [44:47<17:56, 25.04s/epoch, loss=0.28, accuracy=0.954, val_loss=0.46, val_accuracy=0.902, lr=0.001]   72%|███████▏  | 108/150 [45:11<17:22, 24.83s/epoch, loss=0.276, accuracy=0.955, val_loss=0.456, val_accuracy=0.9, lr=0.001] 73%|███████▎  | 109/150 [45:37<17:06, 25.05s/epoch, loss=0.269, accuracy=0.956, val_loss=0.47, val_accuracy=0.895, lr=0.001] 73%|███████▎  | 110/150 [46:02<16:46, 25.17s/epoch, loss=0.261, accuracy=0.958, val_loss=0.457, val_accuracy=0.895, lr=0.001] 74%|███████▍  | 111/150 [46:28<16:25, 25.28s/epoch, loss=0.261, accuracy=0.957, val_loss=0.482, val_accuracy=0.892, lr=0.001] 75%|███████▍  | 112/150 [46:53<15:52, 25.08s/epoch, loss=0.256, accuracy=0.957, val_loss=0.496, val_accuracy=0.891, lr=0.001] 75%|███████▌  | 113/150 [47:17<15:15, 24.75s/epoch, loss=0.25, accuracy=0.959, val_loss=0.453, val_accuracy=0.896, lr=0.001]  76%|███████▌  | 114/150 [47:42<14:54, 24.85s/epoch, loss=0.248, accuracy=0.958, val_loss=0.446, val_accuracy=0.899, lr=0.001] 77%|███████▋  | 115/150 [48:07<14:36, 25.03s/epoch, loss=0.245, accuracy=0.959, val_loss=0.454, val_accuracy=0.896, lr=0.001] 77%|███████▋  | 116/150 [48:33<14:17, 25.22s/epoch, loss=0.242, accuracy=0.959, val_loss=0.456, val_accuracy=0.897, lr=0.001] 78%|███████▊  | 117/150 [48:58<13:49, 25.15s/epoch, loss=0.239, accuracy=0.958, val_loss=0.464, val_accuracy=0.897, lr=0.001] 79%|███████▊  | 118/150 [49:21<13:11, 24.74s/epoch, loss=0.236, accuracy=0.96, val_loss=0.472, val_accuracy=0.891, lr=0.001]  79%|███████▉  | 119/150 [49:46<12:46, 24.72s/epoch, loss=0.236, accuracy=0.958, val_loss=0.476, val_accuracy=0.888, lr=0.001] 80%|████████  | 120/150 [50:12<12:29, 24.97s/epoch, loss=0.228, accuracy=0.962, val_loss=0.516, val_accuracy=0.883, lr=0.001] 81%|████████  | 121/150 [50:37<12:10, 25.20s/epoch, loss=0.23, accuracy=0.96, val_loss=0.5, val_accuracy=0.882, lr=0.001]     81%|████████▏ | 122/150 [51:03<11:47, 25.27s/epoch, loss=0.211, accuracy=0.967, val_loss=0.417, val_accuracy=0.908, lr=1e-04] 82%|████████▏ | 123/150 [51:27<11:16, 25.06s/epoch, loss=0.2, accuracy=0.972, val_loss=0.409, val_accuracy=0.909, lr=1e-04]   83%|████████▎ | 124/150 [51:52<10:45, 24.83s/epoch, loss=0.195, accuracy=0.974, val_loss=0.41, val_accuracy=0.911, lr=1e-04] 83%|████████▎ | 125/150 [52:17<10:25, 25.03s/epoch, loss=0.193, accuracy=0.974, val_loss=0.411, val_accuracy=0.912, lr=1e-04] 84%|████████▍ | 126/150 [52:43<10:03, 25.13s/epoch, loss=0.189, accuracy=0.975, val_loss=0.41, val_accuracy=0.911, lr=1e-04]  85%|████████▍ | 127/150 [53:08<09:40, 25.25s/epoch, loss=0.188, accuracy=0.976, val_loss=0.409, val_accuracy=0.911, lr=1e-04] 85%|████████▌ | 128/150 [53:33<09:11, 25.09s/epoch, loss=0.187, accuracy=0.976, val_loss=0.41, val_accuracy=0.913, lr=1e-04]  86%|████████▌ | 129/150 [53:57<08:39, 24.71s/epoch, loss=0.186, accuracy=0.977, val_loss=0.409, val_accuracy=0.91, lr=1e-04] 87%|████████▋ | 130/150 [54:22<08:15, 24.76s/epoch, loss=0.182, accuracy=0.978, val_loss=0.409, val_accuracy=0.911, lr=1e-04] 87%|████████▋ | 131/150 [54:48<08:01, 25.33s/epoch, loss=0.182, accuracy=0.977, val_loss=0.41, val_accuracy=0.911, lr=1e-04]  88%|████████▊ | 132/150 [55:14<07:35, 25.32s/epoch, loss=0.18, accuracy=0.978, val_loss=0.41, val_accuracy=0.911, lr=1e-04]  89%|████████▊ | 133/150 [55:39<07:09, 25.29s/epoch, loss=0.179, accuracy=0.979, val_loss=0.411, val_accuracy=0.912, lr=1e-04] 89%|████████▉ | 134/150 [56:03<06:37, 24.87s/epoch, loss=0.178, accuracy=0.98, val_loss=0.409, val_accuracy=0.91, lr=1e-04]   90%|█████████ | 135/150 [56:27<06:10, 24.71s/epoch, loss=0.178, accuracy=0.979, val_loss=0.409, val_accuracy=0.911, lr=1e-04] 91%|█████████ | 136/150 [56:52<05:48, 24.89s/epoch, loss=0.176, accuracy=0.979, val_loss=0.406, val_accuracy=0.911, lr=1e-04] 91%|█████████▏| 137/150 [57:18<05:25, 25.07s/epoch, loss=0.174, accuracy=0.98, val_loss=0.409, val_accuracy=0.91, lr=5e-5]    92%|█████████▏| 138/150 [57:43<05:02, 25.21s/epoch, loss=0.173, accuracy=0.981, val_loss=0.408, val_accuracy=0.911, lr=5e-5] 93%|█████████▎| 139/150 [58:08<04:34, 24.93s/epoch, loss=0.173, accuracy=0.981, val_loss=0.407, val_accuracy=0.913, lr=5e-5] 93%|█████████▎| 140/150 [58:31<04:06, 24.62s/epoch, loss=0.173, accuracy=0.98, val_loss=0.408, val_accuracy=0.911, lr=5e-5]  94%|█████████▍| 141/150 [58:56<03:41, 24.64s/epoch, loss=0.174, accuracy=0.98, val_loss=0.406, val_accuracy=0.911, lr=5e-5] 95%|█████████▍| 142/150 [59:21<03:18, 24.84s/epoch, loss=0.171, accuracy=0.981, val_loss=0.408, val_accuracy=0.912, lr=5e-5] 95%|█████████▌| 143/150 [59:47<02:54, 24.93s/epoch, loss=0.172, accuracy=0.982, val_loss=0.408, val_accuracy=0.912, lr=5e-5] 96%|█████████▌| 144/150 [1:00:12<02:29, 24.98s/epoch, loss=0.172, accuracy=0.981, val_loss=0.407, val_accuracy=0.911, lr=5e-5] 97%|█████████▋| 145/150 [1:00:36<02:03, 24.66s/epoch, loss=0.171, accuracy=0.981, val_loss=0.408, val_accuracy=0.91, lr=5e-5]  97%|█████████▋| 146/150 [1:01:00<01:38, 24.59s/epoch, loss=0.17, accuracy=0.982, val_loss=0.407, val_accuracy=0.912, lr=5e-5] 98%|█████████▊| 147/150 [1:01:25<01:14, 24.84s/epoch, loss=0.17, accuracy=0.981, val_loss=0.407, val_accuracy=0.912, lr=5e-5] 99%|█████████▊| 148/150 [1:01:51<00:50, 25.02s/epoch, loss=0.17, accuracy=0.981, val_loss=0.408, val_accuracy=0.912, lr=5e-5] 99%|█████████▉| 149/150 [1:02:16<00:25, 25.12s/epoch, loss=0.169, accuracy=0.981, val_loss=0.408, val_accuracy=0.909, lr=5e-5]100%|██████████| 150/150 [1:02:41<00:00, 24.88s/epoch, loss=0.169, accuracy=0.981, val_loss=0.411, val_accuracy=0.91, lr=5e-5] 100%|██████████| 150/150 [1:02:41<00:00, 25.07s/epoch, loss=0.169, accuracy=0.981, val_loss=0.411, val_accuracy=0.91, lr=5e-5]
Using real-time data augmentation.
Only one model saved

Loading model: 10_07_cifar10_ResNet20v1.h5
Test score: 0.41083431243896484
Test accuracy: 0.909600019454956


* * * Run SGD for ID = 10_8. * * *


2024-03-13 04:49:00.580599: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 04:49:06.474007: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 04:49:06.475312: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-13 04:49:06.516495: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:86:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-13 04:49:06.516540: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 04:49:06.522846: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 04:49:06.522915: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 04:49:06.527264: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 04:49:06.530238: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 04:49:06.534139: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 04:49:06.537306: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 04:49:06.544312: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 04:49:06.545003: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 04:49:06.545099: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 04:49:07.748983: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-13 04:49:07.749613: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 04:49:07.750756: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:86:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-13 04:49:07.750797: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 04:49:07.750848: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 04:49:07.750864: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 04:49:07.750879: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 04:49:07.750894: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 04:49:07.750920: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 04:49:07.750935: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 04:49:07.750950: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 04:49:07.751514: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 04:49:07.751556: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 04:49:08.368913: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-13 04:49:08.368974: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-13 04:49:08.368986: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-13 04:49:08.370133: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:86:00.0, compute capability: 6.1)
{'id': '10_08', 'seed': 8, 'out_folder': 'results/epoch_budget_2', 'batch_size': 128, 'epochs': 150, 'validation_split': 0.0, 'checkpointing': False, 'checkpoint_every': -1, 'hold_out_validation_split': 0.0, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'num_classes': 10, 'SSE_lr': False, 'test_time_augmentation': False, 'debug': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
y_train shape: (50000, 10)
x_val shape: (10000, 32, 32, 3)
y_val shape: (10000, 10)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/150 [00:00<?, ?epoch/s]2024-03-13 04:49:08.983886: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-13 04:49:08.996001: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-03-13 04:49:10.828539: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 04:49:11.100187: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 04:49:12.006969: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-13 04:49:12.055398: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/150 [00:57<2:23:31, 57.80s/epoch, loss=3.05, accuracy=0.336, val_loss=2.06, val_accuracy=0.345, lr=0.1]  1%|▏         | 2/150 [01:23<1:36:06, 38.96s/epoch, loss=1.55, accuracy=0.535, val_loss=1.81, val_accuracy=0.478, lr=0.1]  2%|▏         | 3/150 [01:48<1:19:56, 32.63s/epoch, loss=1.33, accuracy=0.64, val_loss=3.23, val_accuracy=0.321, lr=0.1]   3%|▎         | 4/150 [02:12<1:11:06, 29.23s/epoch, loss=1.26, accuracy=0.683, val_loss=2.11, val_accuracy=0.442, lr=0.1]  3%|▎         | 5/150 [02:36<1:06:02, 27.33s/epoch, loss=1.23, accuracy=0.704, val_loss=2.55, val_accuracy=0.382, lr=0.1]  4%|▍         | 6/150 [03:01<1:03:52, 26.61s/epoch, loss=1.22, accuracy=0.715, val_loss=2.28, val_accuracy=0.452, lr=0.1]  5%|▍         | 7/150 [03:27<1:02:45, 26.33s/epoch, loss=1.2, accuracy=0.724, val_loss=2.22, val_accuracy=0.449, lr=0.1]   5%|▌         | 8/150 [03:52<1:01:35, 26.03s/epoch, loss=1.19, accuracy=0.729, val_loss=1.92, val_accuracy=0.527, lr=0.1]  6%|▌         | 9/150 [04:18<1:00:27, 25.73s/epoch, loss=1.19, accuracy=0.733, val_loss=1.86, val_accuracy=0.526, lr=0.1]  7%|▋         | 10/150 [04:42<59:02, 25.30s/epoch, loss=1.17, accuracy=0.739, val_loss=2.06, val_accuracy=0.477, lr=0.1]   7%|▋         | 11/150 [05:07<58:07, 25.09s/epoch, loss=1.18, accuracy=0.734, val_loss=3.13, val_accuracy=0.292, lr=0.1]  8%|▊         | 12/150 [05:32<57:49, 25.14s/epoch, loss=1.16, accuracy=0.74, val_loss=4.41, val_accuracy=0.231, lr=0.1]   9%|▊         | 13/150 [05:58<57:50, 25.33s/epoch, loss=1.17, accuracy=0.739, val_loss=2.01, val_accuracy=0.516, lr=0.1]  9%|▉         | 14/150 [06:23<57:43, 25.47s/epoch, loss=1.16, accuracy=0.74, val_loss=1.78, val_accuracy=0.544, lr=0.1]  10%|█         | 15/150 [06:47<56:22, 25.05s/epoch, loss=1.16, accuracy=0.741, val_loss=1.88, val_accuracy=0.455, lr=0.1] 11%|█         | 16/150 [07:12<55:30, 24.85s/epoch, loss=1.16, accuracy=0.745, val_loss=2.62, val_accuracy=0.46, lr=0.1]  11%|█▏        | 17/150 [07:37<55:32, 25.06s/epoch, loss=1.15, accuracy=0.747, val_loss=1.88, val_accuracy=0.519, lr=0.1] 12%|█▏        | 18/150 [08:03<55:26, 25.20s/epoch, loss=1.15, accuracy=0.744, val_loss=2.26, val_accuracy=0.466, lr=0.1] 13%|█▎        | 19/150 [08:29<55:27, 25.40s/epoch, loss=1.15, accuracy=0.746, val_loss=2.43, val_accuracy=0.382, lr=0.1] 13%|█▎        | 20/150 [08:53<54:35, 25.19s/epoch, loss=1.15, accuracy=0.745, val_loss=2.38, val_accuracy=0.371, lr=0.1] 14%|█▍        | 21/150 [09:18<53:30, 24.89s/epoch, loss=1.15, accuracy=0.748, val_loss=2.39, val_accuracy=0.483, lr=0.1] 15%|█▍        | 22/150 [09:43<53:30, 25.08s/epoch, loss=1.15, accuracy=0.748, val_loss=1.79, val_accuracy=0.497, lr=0.1] 15%|█▌        | 23/150 [10:09<53:25, 25.24s/epoch, loss=1.14, accuracy=0.749, val_loss=3.41, val_accuracy=0.4, lr=0.1]   16%|█▌        | 24/150 [10:34<53:16, 25.37s/epoch, loss=1.14, accuracy=0.747, val_loss=1.58, val_accuracy=0.596, lr=0.1] 17%|█▋        | 25/150 [11:00<52:47, 25.34s/epoch, loss=1.14, accuracy=0.748, val_loss=2.83, val_accuracy=0.305, lr=0.1] 17%|█▋        | 26/150 [11:24<51:36, 24.97s/epoch, loss=1.14, accuracy=0.75, val_loss=1.84, val_accuracy=0.518, lr=0.1]  18%|█▊        | 27/150 [11:49<51:10, 24.96s/epoch, loss=1.14, accuracy=0.75, val_loss=1.72, val_accuracy=0.536, lr=0.1] 19%|█▊        | 28/150 [12:14<51:03, 25.11s/epoch, loss=1.13, accuracy=0.751, val_loss=3.36, val_accuracy=0.295, lr=0.1] 19%|█▉        | 29/150 [12:40<50:50, 25.21s/epoch, loss=1.14, accuracy=0.751, val_loss=1.74, val_accuracy=0.539, lr=0.1] 20%|██        | 30/150 [13:05<50:30, 25.25s/epoch, loss=1.14, accuracy=0.752, val_loss=2.23, val_accuracy=0.438, lr=0.1] 21%|██        | 31/150 [13:29<49:20, 24.88s/epoch, loss=1.13, accuracy=0.753, val_loss=2.02, val_accuracy=0.5, lr=0.1]   21%|██▏       | 32/150 [13:53<48:40, 24.75s/epoch, loss=1.13, accuracy=0.753, val_loss=1.91, val_accuracy=0.512, lr=0.1] 22%|██▏       | 33/150 [14:19<48:45, 25.00s/epoch, loss=1.13, accuracy=0.753, val_loss=1.77, val_accuracy=0.526, lr=0.1] 23%|██▎       | 34/150 [14:45<48:38, 25.16s/epoch, loss=1.13, accuracy=0.751, val_loss=1.53, val_accuracy=0.616, lr=0.1] 23%|██▎       | 35/150 [15:10<48:30, 25.31s/epoch, loss=1.13, accuracy=0.753, val_loss=1.85, val_accuracy=0.555, lr=0.1] 24%|██▍       | 36/150 [15:35<47:31, 25.02s/epoch, loss=1.13, accuracy=0.752, val_loss=1.55, val_accuracy=0.619, lr=0.1] 25%|██▍       | 37/150 [15:59<46:36, 24.75s/epoch, loss=1.13, accuracy=0.753, val_loss=4.6, val_accuracy=0.323, lr=0.1]  25%|██▌       | 38/150 [16:24<46:38, 24.99s/epoch, loss=1.13, accuracy=0.752, val_loss=2.28, val_accuracy=0.44, lr=0.1] 26%|██▌       | 39/150 [16:50<46:30, 25.14s/epoch, loss=1.13, accuracy=0.754, val_loss=1.87, val_accuracy=0.495, lr=0.1] 27%|██▋       | 40/150 [17:15<46:15, 25.23s/epoch, loss=1.12, accuracy=0.753, val_loss=2.57, val_accuracy=0.494, lr=0.1] 27%|██▋       | 41/150 [17:40<45:41, 25.15s/epoch, loss=1.12, accuracy=0.754, val_loss=1.58, val_accuracy=0.582, lr=0.1] 28%|██▊       | 42/150 [18:05<44:58, 24.99s/epoch, loss=1.12, accuracy=0.754, val_loss=4.7, val_accuracy=0.367, lr=0.1]  29%|██▊       | 43/150 [18:30<44:42, 25.07s/epoch, loss=1.12, accuracy=0.755, val_loss=1.41, val_accuracy=0.659, lr=0.1] 29%|██▉       | 44/150 [18:56<44:39, 25.27s/epoch, loss=1.13, accuracy=0.753, val_loss=2.66, val_accuracy=0.253, lr=0.1] 30%|███       | 45/150 [19:22<44:28, 25.41s/epoch, loss=1.12, accuracy=0.752, val_loss=2.47, val_accuracy=0.483, lr=0.1] 31%|███       | 46/150 [19:47<44:07, 25.45s/epoch, loss=1.12, accuracy=0.754, val_loss=1.87, val_accuracy=0.535, lr=0.1] 31%|███▏      | 47/150 [20:11<43:07, 25.12s/epoch, loss=1.12, accuracy=0.755, val_loss=2.28, val_accuracy=0.449, lr=0.1] 32%|███▏      | 48/150 [20:36<42:36, 25.06s/epoch, loss=1.12, accuracy=0.754, val_loss=1.57, val_accuracy=0.6, lr=0.1]   33%|███▎      | 49/150 [21:02<42:26, 25.21s/epoch, loss=1.12, accuracy=0.755, val_loss=1.9, val_accuracy=0.51, lr=0.1] 33%|███▎      | 50/150 [21:27<42:05, 25.25s/epoch, loss=1.12, accuracy=0.756, val_loss=2.67, val_accuracy=0.303, lr=0.1] 34%|███▍      | 51/150 [21:53<41:49, 25.35s/epoch, loss=1.12, accuracy=0.756, val_loss=2.62, val_accuracy=0.368, lr=0.1] 35%|███▍      | 52/150 [22:17<40:54, 25.04s/epoch, loss=1.11, accuracy=0.759, val_loss=3.39, val_accuracy=0.359, lr=0.1] 35%|███▌      | 53/150 [22:41<40:08, 24.83s/epoch, loss=1.12, accuracy=0.756, val_loss=2.2, val_accuracy=0.455, lr=0.1]  36%|███▌      | 54/150 [23:07<40:14, 25.15s/epoch, loss=1.11, accuracy=0.758, val_loss=3.44, val_accuracy=0.216, lr=0.1] 37%|███▋      | 55/150 [23:33<40:02, 25.29s/epoch, loss=1.12, accuracy=0.755, val_loss=1.86, val_accuracy=0.489, lr=0.1] 37%|███▋      | 56/150 [23:59<39:47, 25.40s/epoch, loss=1.11, accuracy=0.757, val_loss=2.55, val_accuracy=0.353, lr=0.1] 38%|███▊      | 57/150 [24:24<39:07, 25.25s/epoch, loss=1.11, accuracy=0.756, val_loss=1.4, val_accuracy=0.657, lr=0.1]  39%|███▊      | 58/150 [24:48<38:15, 24.95s/epoch, loss=1.11, accuracy=0.759, val_loss=1.78, val_accuracy=0.565, lr=0.1] 39%|███▉      | 59/150 [25:13<38:05, 25.12s/epoch, loss=1.11, accuracy=0.758, val_loss=1.95, val_accuracy=0.524, lr=0.1] 40%|████      | 60/150 [25:39<37:52, 25.25s/epoch, loss=1.11, accuracy=0.761, val_loss=2.49, val_accuracy=0.5, lr=0.1]   41%|████      | 61/150 [26:05<37:39, 25.39s/epoch, loss=1.12, accuracy=0.756, val_loss=2.63, val_accuracy=0.384, lr=0.1] 41%|████▏     | 62/150 [26:29<37:00, 25.23s/epoch, loss=0.897, accuracy=0.818, val_loss=0.852, val_accuracy=0.823, lr=0.01] 42%|████▏     | 63/150 [26:54<36:09, 24.94s/epoch, loss=0.723, accuracy=0.849, val_loss=0.806, val_accuracy=0.81, lr=0.01]  43%|████▎     | 64/150 [27:18<35:41, 24.90s/epoch, loss=0.647, accuracy=0.855, val_loss=0.829, val_accuracy=0.778, lr=0.01] 43%|████▎     | 65/150 [27:44<35:32, 25.09s/epoch, loss=0.6, accuracy=0.86, val_loss=0.763, val_accuracy=0.803, lr=0.01]    44%|████▍     | 66/150 [28:10<35:17, 25.21s/epoch, loss=0.585, accuracy=0.861, val_loss=0.862, val_accuracy=0.763, lr=0.01] 45%|████▍     | 67/150 [28:35<34:58, 25.28s/epoch, loss=0.574, accuracy=0.862, val_loss=0.727, val_accuracy=0.816, lr=0.01] 45%|████▌     | 68/150 [28:59<33:58, 24.86s/epoch, loss=0.57, accuracy=0.862, val_loss=0.888, val_accuracy=0.772, lr=0.01]  46%|████▌     | 69/150 [29:22<33:03, 24.49s/epoch, loss=0.57, accuracy=0.862, val_loss=0.76, val_accuracy=0.798, lr=0.01]  47%|████▋     | 70/150 [29:46<32:20, 24.26s/epoch, loss=0.565, accuracy=0.865, val_loss=0.89, val_accuracy=0.769, lr=0.01] 47%|████▋     | 71/150 [30:10<31:49, 24.17s/epoch, loss=0.561, accuracy=0.867, val_loss=0.886, val_accuracy=0.768, lr=0.01] 48%|████▊     | 72/150 [30:34<31:17, 24.07s/epoch, loss=0.559, accuracy=0.868, val_loss=0.949, val_accuracy=0.768, lr=0.01] 49%|████▊     | 73/150 [30:58<30:50, 24.04s/epoch, loss=0.557, accuracy=0.871, val_loss=0.821, val_accuracy=0.787, lr=0.01] 49%|████▉     | 74/150 [31:24<31:04, 24.53s/epoch, loss=0.557, accuracy=0.871, val_loss=0.822, val_accuracy=0.785, lr=0.01] 50%|█████     | 75/150 [31:49<31:05, 24.88s/epoch, loss=0.554, accuracy=0.872, val_loss=1.08, val_accuracy=0.724, lr=0.01]  51%|█████     | 76/150 [32:15<30:59, 25.13s/epoch, loss=0.555, accuracy=0.874, val_loss=1.21, val_accuracy=0.728, lr=0.01] 51%|█████▏    | 77/150 [32:40<30:27, 25.04s/epoch, loss=0.557, accuracy=0.873, val_loss=0.758, val_accuracy=0.811, lr=0.01] 52%|█████▏    | 78/150 [33:04<29:45, 24.80s/epoch, loss=0.554, accuracy=0.875, val_loss=0.964, val_accuracy=0.757, lr=0.01] 53%|█████▎    | 79/150 [33:28<29:06, 24.60s/epoch, loss=0.554, accuracy=0.875, val_loss=0.798, val_accuracy=0.794, lr=0.01] 53%|█████▎    | 80/150 [33:53<28:35, 24.51s/epoch, loss=0.554, accuracy=0.876, val_loss=0.893, val_accuracy=0.771, lr=0.01] 54%|█████▍    | 81/150 [34:18<28:28, 24.76s/epoch, loss=0.549, accuracy=0.878, val_loss=0.976, val_accuracy=0.753, lr=0.01] 55%|█████▍    | 82/150 [34:44<28:22, 25.03s/epoch, loss=0.551, accuracy=0.877, val_loss=0.945, val_accuracy=0.763, lr=0.01] 55%|█████▌    | 83/150 [35:09<28:06, 25.18s/epoch, loss=0.553, accuracy=0.878, val_loss=0.757, val_accuracy=0.815, lr=0.01] 56%|█████▌    | 84/150 [35:34<27:35, 25.09s/epoch, loss=0.55, accuracy=0.881, val_loss=1.08, val_accuracy=0.715, lr=0.01]   57%|█████▋    | 85/150 [35:58<26:50, 24.78s/epoch, loss=0.552, accuracy=0.878, val_loss=0.881, val_accuracy=0.791, lr=0.01] 57%|█████▋    | 86/150 [36:22<26:09, 24.52s/epoch, loss=0.554, accuracy=0.878, val_loss=1.38, val_accuracy=0.671, lr=0.01]  58%|█████▊    | 87/150 [36:46<25:36, 24.40s/epoch, loss=0.549, accuracy=0.879, val_loss=0.941, val_accuracy=0.763, lr=0.01] 59%|█████▊    | 88/150 [37:11<25:32, 24.71s/epoch, loss=0.55, accuracy=0.881, val_loss=0.874, val_accuracy=0.795, lr=0.01]  59%|█████▉    | 89/150 [37:37<25:22, 24.97s/epoch, loss=0.554, accuracy=0.88, val_loss=0.879, val_accuracy=0.777, lr=0.01] 60%|██████    | 90/150 [38:03<25:11, 25.19s/epoch, loss=0.551, accuracy=0.881, val_loss=1.03, val_accuracy=0.744, lr=0.01] 61%|██████    | 91/150 [38:28<24:47, 25.21s/epoch, loss=0.555, accuracy=0.881, val_loss=0.92, val_accuracy=0.772, lr=0.01] 61%|██████▏   | 92/150 [38:52<24:07, 24.95s/epoch, loss=0.483, accuracy=0.907, val_loss=0.538, val_accuracy=0.887, lr=0.001] 62%|██████▏   | 93/150 [39:17<23:41, 24.94s/epoch, loss=0.425, accuracy=0.924, val_loss=0.518, val_accuracy=0.892, lr=0.001] 63%|██████▎   | 94/150 [39:41<23:03, 24.71s/epoch, loss=0.402, accuracy=0.93, val_loss=0.506, val_accuracy=0.896, lr=0.001]  63%|██████▎   | 95/150 [40:07<22:52, 24.96s/epoch, loss=0.388, accuracy=0.933, val_loss=0.499, val_accuracy=0.898, lr=0.001] 64%|██████▍   | 96/150 [40:33<22:37, 25.13s/epoch, loss=0.373, accuracy=0.937, val_loss=0.497, val_accuracy=0.897, lr=0.001] 65%|██████▍   | 97/150 [40:58<22:22, 25.32s/epoch, loss=0.362, accuracy=0.938, val_loss=0.498, val_accuracy=0.893, lr=0.001] 65%|██████▌   | 98/150 [41:23<21:50, 25.20s/epoch, loss=0.35, accuracy=0.942, val_loss=0.501, val_accuracy=0.893, lr=0.001]  66%|██████▌   | 99/150 [41:48<21:12, 24.95s/epoch, loss=0.339, accuracy=0.943, val_loss=0.491, val_accuracy=0.898, lr=0.001] 67%|██████▋   | 100/150 [42:12<20:37, 24.74s/epoch, loss=0.331, accuracy=0.944, val_loss=0.485, val_accuracy=0.898, lr=0.001] 67%|██████▋   | 101/150 [42:36<20:06, 24.62s/epoch, loss=0.321, accuracy=0.946, val_loss=0.474, val_accuracy=0.898, lr=0.001] 68%|██████▊   | 102/150 [43:02<19:56, 24.94s/epoch, loss=0.315, accuracy=0.946, val_loss=0.473, val_accuracy=0.899, lr=0.001] 69%|██████▊   | 103/150 [43:27<19:39, 25.10s/epoch, loss=0.307, accuracy=0.949, val_loss=0.48, val_accuracy=0.898, lr=0.001]  69%|██████▉   | 104/150 [43:53<19:22, 25.26s/epoch, loss=0.299, accuracy=0.95, val_loss=0.483, val_accuracy=0.895, lr=0.001] 70%|███████   | 105/150 [44:18<18:47, 25.06s/epoch, loss=0.293, accuracy=0.95, val_loss=0.455, val_accuracy=0.9, lr=0.001]   71%|███████   | 106/150 [44:41<18:08, 24.73s/epoch, loss=0.285, accuracy=0.952, val_loss=0.492, val_accuracy=0.891, lr=0.001] 71%|███████▏  | 107/150 [45:05<17:33, 24.49s/epoch, loss=0.28, accuracy=0.953, val_loss=0.484, val_accuracy=0.888, lr=0.001]  72%|███████▏  | 108/150 [45:30<17:05, 24.42s/epoch, loss=0.274, accuracy=0.954, val_loss=0.471, val_accuracy=0.896, lr=0.001] 73%|███████▎  | 109/150 [45:55<16:55, 24.78s/epoch, loss=0.271, accuracy=0.954, val_loss=0.49, val_accuracy=0.892, lr=0.001]  73%|███████▎  | 110/150 [46:21<16:39, 24.99s/epoch, loss=0.269, accuracy=0.953, val_loss=0.481, val_accuracy=0.889, lr=0.001] 74%|███████▍  | 111/150 [46:46<16:22, 25.18s/epoch, loss=0.263, accuracy=0.954, val_loss=0.481, val_accuracy=0.893, lr=0.001] 75%|███████▍  | 112/150 [47:11<15:48, 24.96s/epoch, loss=0.26, accuracy=0.955, val_loss=0.467, val_accuracy=0.893, lr=0.001]  75%|███████▌  | 113/150 [47:35<15:11, 24.63s/epoch, loss=0.252, accuracy=0.957, val_loss=0.47, val_accuracy=0.896, lr=0.001] 76%|███████▌  | 114/150 [47:59<14:40, 24.47s/epoch, loss=0.247, accuracy=0.957, val_loss=0.493, val_accuracy=0.888, lr=0.001] 77%|███████▋  | 115/150 [48:23<14:18, 24.52s/epoch, loss=0.244, accuracy=0.958, val_loss=0.484, val_accuracy=0.89, lr=0.001]  77%|███████▋  | 116/150 [48:49<14:05, 24.87s/epoch, loss=0.243, accuracy=0.958, val_loss=0.506, val_accuracy=0.883, lr=0.001] 78%|███████▊  | 117/150 [49:15<13:47, 25.07s/epoch, loss=0.241, accuracy=0.958, val_loss=0.466, val_accuracy=0.892, lr=0.001] 79%|███████▊  | 118/150 [49:40<13:26, 25.20s/epoch, loss=0.24, accuracy=0.957, val_loss=0.483, val_accuracy=0.888, lr=0.001]  79%|███████▉  | 119/150 [50:04<12:52, 24.93s/epoch, loss=0.236, accuracy=0.959, val_loss=0.493, val_accuracy=0.883, lr=0.001] 80%|████████  | 120/150 [50:29<12:21, 24.72s/epoch, loss=0.233, accuracy=0.958, val_loss=0.492, val_accuracy=0.885, lr=0.001] 81%|████████  | 121/150 [50:53<11:52, 24.59s/epoch, loss=0.231, accuracy=0.958, val_loss=0.494, val_accuracy=0.885, lr=0.001] 81%|████████▏ | 122/150 [51:17<11:27, 24.55s/epoch, loss=0.212, accuracy=0.966, val_loss=0.425, val_accuracy=0.902, lr=1e-04] 82%|████████▏ | 123/150 [51:43<11:13, 24.93s/epoch, loss=0.198, accuracy=0.972, val_loss=0.422, val_accuracy=0.905, lr=1e-04] 83%|████████▎ | 124/150 [52:09<10:54, 25.16s/epoch, loss=0.194, accuracy=0.973, val_loss=0.423, val_accuracy=0.906, lr=1e-04] 83%|████████▎ | 125/150 [52:35<10:33, 25.35s/epoch, loss=0.192, accuracy=0.974, val_loss=0.418, val_accuracy=0.906, lr=1e-04] 84%|████████▍ | 126/150 [52:59<10:02, 25.12s/epoch, loss=0.19, accuracy=0.973, val_loss=0.421, val_accuracy=0.906, lr=1e-04]  85%|████████▍ | 127/150 [53:24<09:32, 24.90s/epoch, loss=0.187, accuracy=0.976, val_loss=0.418, val_accuracy=0.906, lr=1e-04] 85%|████████▌ | 128/150 [53:48<09:04, 24.75s/epoch, loss=0.185, accuracy=0.977, val_loss=0.418, val_accuracy=0.908, lr=1e-04] 86%|████████▌ | 129/150 [54:13<08:40, 24.77s/epoch, loss=0.184, accuracy=0.976, val_loss=0.42, val_accuracy=0.908, lr=1e-04]  87%|████████▋ | 130/150 [54:38<08:19, 24.99s/epoch, loss=0.181, accuracy=0.977, val_loss=0.418, val_accuracy=0.907, lr=1e-04] 87%|████████▋ | 131/150 [55:04<07:59, 25.22s/epoch, loss=0.181, accuracy=0.977, val_loss=0.42, val_accuracy=0.907, lr=1e-04]  88%|████████▊ | 132/150 [55:30<07:36, 25.36s/epoch, loss=0.179, accuracy=0.978, val_loss=0.422, val_accuracy=0.906, lr=1e-04] 89%|████████▊ | 133/150 [55:54<07:04, 25.00s/epoch, loss=0.177, accuracy=0.98, val_loss=0.421, val_accuracy=0.908, lr=1e-04]  89%|████████▉ | 134/150 [56:18<06:34, 24.68s/epoch, loss=0.177, accuracy=0.978, val_loss=0.423, val_accuracy=0.908, lr=1e-04] 90%|█████████ | 135/150 [56:42<06:07, 24.50s/epoch, loss=0.176, accuracy=0.979, val_loss=0.423, val_accuracy=0.906, lr=1e-04] 91%|█████████ | 136/150 [57:07<05:42, 24.49s/epoch, loss=0.176, accuracy=0.977, val_loss=0.421, val_accuracy=0.907, lr=1e-04] 91%|█████████▏| 137/150 [57:32<05:21, 24.75s/epoch, loss=0.172, accuracy=0.98, val_loss=0.421, val_accuracy=0.907, lr=5e-5]   92%|█████████▏| 138/150 [57:57<04:59, 24.99s/epoch, loss=0.17, accuracy=0.981, val_loss=0.422, val_accuracy=0.908, lr=5e-5] 93%|█████████▎| 139/150 [58:23<04:36, 25.16s/epoch, loss=0.173, accuracy=0.98, val_loss=0.422, val_accuracy=0.907, lr=5e-5] 93%|█████████▎| 140/150 [58:48<04:09, 25.00s/epoch, loss=0.172, accuracy=0.98, val_loss=0.424, val_accuracy=0.908, lr=5e-5] 94%|█████████▍| 141/150 [59:11<03:41, 24.65s/epoch, loss=0.169, accuracy=0.981, val_loss=0.422, val_accuracy=0.908, lr=5e-5] 95%|█████████▍| 142/150 [59:36<03:16, 24.54s/epoch, loss=0.17, accuracy=0.981, val_loss=0.424, val_accuracy=0.907, lr=5e-5]  95%|█████████▌| 143/150 [1:00:00<02:52, 24.59s/epoch, loss=0.168, accuracy=0.982, val_loss=0.424, val_accuracy=0.907, lr=5e-5] 96%|█████████▌| 144/150 [1:00:26<02:29, 24.85s/epoch, loss=0.17, accuracy=0.981, val_loss=0.422, val_accuracy=0.907, lr=5e-5]  97%|█████████▋| 145/150 [1:00:51<02:05, 25.01s/epoch, loss=0.168, accuracy=0.981, val_loss=0.422, val_accuracy=0.908, lr=5e-5] 97%|█████████▋| 146/150 [1:01:17<01:40, 25.16s/epoch, loss=0.167, accuracy=0.981, val_loss=0.423, val_accuracy=0.908, lr=5e-5] 98%|█████████▊| 147/150 [1:01:41<01:14, 24.81s/epoch, loss=0.169, accuracy=0.98, val_loss=0.424, val_accuracy=0.907, lr=5e-5]  99%|█████████▊| 148/150 [1:02:05<00:49, 24.56s/epoch, loss=0.168, accuracy=0.981, val_loss=0.423, val_accuracy=0.905, lr=5e-5] 99%|█████████▉| 149/150 [1:02:29<00:24, 24.41s/epoch, loss=0.166, accuracy=0.982, val_loss=0.424, val_accuracy=0.907, lr=5e-5]100%|██████████| 150/150 [1:02:54<00:00, 24.59s/epoch, loss=0.166, accuracy=0.982, val_loss=0.424, val_accuracy=0.907, lr=5e-5]100%|██████████| 150/150 [1:02:54<00:00, 25.16s/epoch, loss=0.166, accuracy=0.982, val_loss=0.424, val_accuracy=0.907, lr=5e-5]
Using real-time data augmentation.
Only one model saved

Loading model: 10_08_cifar10_ResNet20v1.h5
Test score: 0.42439427971839905
Test accuracy: 0.9065999984741211


* * * Run SGD for ID = 10_9. * * *


2024-03-13 05:52:07.174127: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 05:52:09.815835: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 05:52:09.817210: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-13 05:52:09.859046: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:86:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-13 05:52:09.859092: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 05:52:09.862418: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 05:52:09.862487: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 05:52:09.864908: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 05:52:09.865648: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 05:52:09.868315: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 05:52:09.870047: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 05:52:09.875466: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 05:52:09.876170: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 05:52:09.876265: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 05:52:11.083027: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-13 05:52:11.083700: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 05:52:11.084874: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:86:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-13 05:52:11.084917: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 05:52:11.084960: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 05:52:11.084976: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 05:52:11.084991: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 05:52:11.085007: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 05:52:11.085024: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 05:52:11.085039: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 05:52:11.085055: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 05:52:11.085632: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 05:52:11.085683: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 05:52:11.717381: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-13 05:52:11.717434: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-13 05:52:11.717444: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-13 05:52:11.718571: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:86:00.0, compute capability: 6.1)
{'id': '10_09', 'seed': 9, 'out_folder': 'results/epoch_budget_2', 'batch_size': 128, 'epochs': 150, 'validation_split': 0.0, 'checkpointing': False, 'checkpoint_every': -1, 'hold_out_validation_split': 0.0, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'num_classes': 10, 'SSE_lr': False, 'test_time_augmentation': False, 'debug': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
y_train shape: (50000, 10)
x_val shape: (10000, 32, 32, 3)
y_val shape: (10000, 10)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/150 [00:00<?, ?epoch/s]2024-03-13 05:52:12.354711: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-13 05:52:12.367006: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-03-13 05:52:14.265995: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 05:52:14.495316: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 05:52:15.326380: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-13 05:52:15.373034: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/150 [01:00<2:29:18, 60.13s/epoch, loss=2.81, accuracy=0.417, val_loss=2.83, val_accuracy=0.295, lr=0.1]  1%|▏         | 2/150 [01:23<1:35:16, 38.63s/epoch, loss=1.42, accuracy=0.621, val_loss=1.56, val_accuracy=0.555, lr=0.1]  2%|▏         | 3/150 [01:48<1:19:17, 32.36s/epoch, loss=1.28, accuracy=0.679, val_loss=1.89, val_accuracy=0.475, lr=0.1]  3%|▎         | 4/150 [02:12<1:10:35, 29.01s/epoch, loss=1.24, accuracy=0.7, val_loss=1.79, val_accuracy=0.523, lr=0.1]    3%|▎         | 5/150 [02:36<1:05:41, 27.18s/epoch, loss=1.22, accuracy=0.714, val_loss=1.77, val_accuracy=0.522, lr=0.1]  4%|▍         | 6/150 [03:01<1:03:25, 26.43s/epoch, loss=1.21, accuracy=0.724, val_loss=1.92, val_accuracy=0.471, lr=0.1]  5%|▍         | 7/150 [03:27<1:02:25, 26.19s/epoch, loss=1.19, accuracy=0.727, val_loss=3, val_accuracy=0.353, lr=0.1]     5%|▌         | 8/150 [03:52<1:01:35, 26.02s/epoch, loss=1.18, accuracy=0.731, val_loss=1.97, val_accuracy=0.531, lr=0.1]  6%|▌         | 9/150 [04:18<1:00:48, 25.88s/epoch, loss=1.17, accuracy=0.734, val_loss=1.79, val_accuracy=0.578, lr=0.1]  7%|▋         | 10/150 [04:42<59:16, 25.40s/epoch, loss=1.16, accuracy=0.738, val_loss=2.41, val_accuracy=0.43, lr=0.1]    7%|▋         | 11/150 [05:06<57:56, 25.01s/epoch, loss=1.17, accuracy=0.737, val_loss=2.6, val_accuracy=0.368, lr=0.1]  8%|▊         | 12/150 [05:32<57:51, 25.15s/epoch, loss=1.16, accuracy=0.741, val_loss=2.75, val_accuracy=0.434, lr=0.1]  9%|▊         | 13/150 [05:57<57:41, 25.27s/epoch, loss=1.16, accuracy=0.741, val_loss=2.05, val_accuracy=0.489, lr=0.1]  9%|▉         | 14/150 [06:23<57:19, 25.29s/epoch, loss=1.15, accuracy=0.744, val_loss=1.97, val_accuracy=0.449, lr=0.1] 10%|█         | 15/150 [06:48<56:42, 25.20s/epoch, loss=1.14, accuracy=0.744, val_loss=1.61, val_accuracy=0.59, lr=0.1]  11%|█         | 16/150 [07:12<55:38, 24.92s/epoch, loss=1.14, accuracy=0.747, val_loss=1.95, val_accuracy=0.538, lr=0.1] 11%|█▏        | 17/150 [07:37<55:23, 24.99s/epoch, loss=1.14, accuracy=0.745, val_loss=1.9, val_accuracy=0.548, lr=0.1]  12%|█▏        | 18/150 [08:03<55:31, 25.24s/epoch, loss=1.14, accuracy=0.748, val_loss=3.05, val_accuracy=0.381, lr=0.1] 13%|█▎        | 19/150 [08:28<55:22, 25.36s/epoch, loss=1.13, accuracy=0.75, val_loss=2.1, val_accuracy=0.478, lr=0.1]   13%|█▎        | 20/150 [08:54<55:08, 25.45s/epoch, loss=1.13, accuracy=0.749, val_loss=2.99, val_accuracy=0.415, lr=0.1] 14%|█▍        | 21/150 [09:18<53:54, 25.07s/epoch, loss=1.13, accuracy=0.751, val_loss=1.63, val_accuracy=0.588, lr=0.1] 15%|█▍        | 22/150 [09:43<53:01, 24.86s/epoch, loss=1.13, accuracy=0.753, val_loss=3.52, val_accuracy=0.235, lr=0.1] 15%|█▌        | 23/150 [10:09<53:13, 25.15s/epoch, loss=1.13, accuracy=0.753, val_loss=2.35, val_accuracy=0.413, lr=0.1] 16%|█▌        | 24/150 [10:34<53:09, 25.31s/epoch, loss=1.13, accuracy=0.749, val_loss=2.23, val_accuracy=0.433, lr=0.1] 17%|█▋        | 25/150 [11:00<52:48, 25.35s/epoch, loss=1.13, accuracy=0.753, val_loss=1.8, val_accuracy=0.544, lr=0.1]  17%|█▋        | 26/150 [11:25<52:18, 25.31s/epoch, loss=1.13, accuracy=0.753, val_loss=3.96, val_accuracy=0.278, lr=0.1] 18%|█▊        | 27/150 [11:49<51:11, 24.97s/epoch, loss=1.12, accuracy=0.753, val_loss=2.25, val_accuracy=0.44, lr=0.1]  19%|█▊        | 28/150 [12:14<50:57, 25.06s/epoch, loss=1.11, accuracy=0.758, val_loss=2.84, val_accuracy=0.383, lr=0.1] 19%|█▉        | 29/150 [12:39<50:30, 25.05s/epoch, loss=1.12, accuracy=0.753, val_loss=2.74, val_accuracy=0.398, lr=0.1] 20%|██        | 30/150 [13:05<50:22, 25.19s/epoch, loss=1.12, accuracy=0.753, val_loss=1.94, val_accuracy=0.523, lr=0.1] 21%|██        | 31/150 [13:31<50:18, 25.37s/epoch, loss=1.11, accuracy=0.755, val_loss=1.55, val_accuracy=0.598, lr=0.1] 21%|██▏       | 32/150 [13:55<49:09, 25.00s/epoch, loss=1.12, accuracy=0.756, val_loss=1.87, val_accuracy=0.486, lr=0.1] 22%|██▏       | 33/150 [14:19<48:20, 24.79s/epoch, loss=1.11, accuracy=0.756, val_loss=1.51, val_accuracy=0.613, lr=0.1] 23%|██▎       | 34/150 [14:45<48:18, 24.99s/epoch, loss=1.12, accuracy=0.753, val_loss=2.36, val_accuracy=0.349, lr=0.1] 23%|██▎       | 35/150 [15:10<48:10, 25.13s/epoch, loss=1.11, accuracy=0.756, val_loss=1.89, val_accuracy=0.517, lr=0.1] 24%|██▍       | 36/150 [15:36<47:58, 25.25s/epoch, loss=1.11, accuracy=0.757, val_loss=1.84, val_accuracy=0.598, lr=0.1] 25%|██▍       | 37/150 [16:00<47:20, 25.14s/epoch, loss=1.12, accuracy=0.752, val_loss=2.13, val_accuracy=0.456, lr=0.1] 25%|██▌       | 38/150 [16:24<46:17, 24.80s/epoch, loss=1.11, accuracy=0.759, val_loss=5.44, val_accuracy=0.171, lr=0.1] 26%|██▌       | 39/150 [16:50<46:02, 24.89s/epoch, loss=1.11, accuracy=0.759, val_loss=3.01, val_accuracy=0.247, lr=0.1] 27%|██▋       | 40/150 [17:15<45:55, 25.05s/epoch, loss=1.12, accuracy=0.757, val_loss=2.99, val_accuracy=0.301, lr=0.1] 27%|██▋       | 41/150 [17:40<45:43, 25.17s/epoch, loss=1.11, accuracy=0.758, val_loss=2.64, val_accuracy=0.361, lr=0.1] 28%|██▊       | 42/150 [18:06<45:24, 25.22s/epoch, loss=1.1, accuracy=0.76, val_loss=2.84, val_accuracy=0.4, lr=0.1]     29%|██▊       | 43/150 [18:30<44:23, 24.90s/epoch, loss=1.11, accuracy=0.755, val_loss=4.18, val_accuracy=0.252, lr=0.1] 29%|██▉       | 44/150 [18:54<43:41, 24.73s/epoch, loss=1.11, accuracy=0.757, val_loss=1.57, val_accuracy=0.61, lr=0.1]  30%|███       | 45/150 [19:20<43:51, 25.06s/epoch, loss=1.11, accuracy=0.756, val_loss=1.88, val_accuracy=0.525, lr=0.1] 31%|███       | 46/150 [19:46<43:41, 25.21s/epoch, loss=1.11, accuracy=0.756, val_loss=2.14, val_accuracy=0.536, lr=0.1] 31%|███▏      | 47/150 [20:11<43:31, 25.36s/epoch, loss=1.11, accuracy=0.757, val_loss=1.6, val_accuracy=0.592, lr=0.1]  32%|███▏      | 48/150 [20:36<42:49, 25.19s/epoch, loss=1.11, accuracy=0.758, val_loss=1.56, val_accuracy=0.615, lr=0.1] 33%|███▎      | 49/150 [21:00<41:46, 24.81s/epoch, loss=1.11, accuracy=0.755, val_loss=1.99, val_accuracy=0.477, lr=0.1] 33%|███▎      | 50/150 [21:25<41:40, 25.01s/epoch, loss=1.11, accuracy=0.759, val_loss=3.05, val_accuracy=0.363, lr=0.1] 34%|███▍      | 51/150 [21:51<41:33, 25.19s/epoch, loss=1.1, accuracy=0.758, val_loss=2.05, val_accuracy=0.431, lr=0.1]  35%|███▍      | 52/150 [22:17<41:23, 25.34s/epoch, loss=1.11, accuracy=0.758, val_loss=2.58, val_accuracy=0.444, lr=0.1] 35%|███▌      | 53/150 [22:42<40:58, 25.34s/epoch, loss=1.1, accuracy=0.756, val_loss=2.1, val_accuracy=0.43, lr=0.1]    36%|███▌      | 54/150 [23:07<40:06, 25.07s/epoch, loss=1.11, accuracy=0.755, val_loss=1.72, val_accuracy=0.566, lr=0.1] 37%|███▋      | 55/150 [23:32<39:39, 25.05s/epoch, loss=1.1, accuracy=0.761, val_loss=2.03, val_accuracy=0.511, lr=0.1]  37%|███▋      | 56/150 [23:57<39:36, 25.28s/epoch, loss=1.1, accuracy=0.76, val_loss=2.55, val_accuracy=0.464, lr=0.1]  38%|███▊      | 57/150 [24:23<39:27, 25.45s/epoch, loss=1.11, accuracy=0.76, val_loss=1.33, val_accuracy=0.677, lr=0.1] 39%|███▊      | 58/150 [24:49<39:14, 25.60s/epoch, loss=1.1, accuracy=0.758, val_loss=2.12, val_accuracy=0.491, lr=0.1] 39%|███▉      | 59/150 [25:14<38:15, 25.23s/epoch, loss=1.11, accuracy=0.756, val_loss=3.19, val_accuracy=0.368, lr=0.1] 40%|████      | 60/150 [25:38<37:20, 24.90s/epoch, loss=1.11, accuracy=0.758, val_loss=1.87, val_accuracy=0.519, lr=0.1] 41%|████      | 61/150 [26:03<37:16, 25.12s/epoch, loss=1.11, accuracy=0.758, val_loss=2.62, val_accuracy=0.404, lr=0.1] 41%|████▏     | 62/150 [26:29<37:10, 25.35s/epoch, loss=0.896, accuracy=0.82, val_loss=0.915, val_accuracy=0.799, lr=0.01] 42%|████▏     | 63/150 [26:55<36:56, 25.48s/epoch, loss=0.721, accuracy=0.849, val_loss=0.785, val_accuracy=0.816, lr=0.01] 43%|████▎     | 64/150 [27:20<36:14, 25.29s/epoch, loss=0.64, accuracy=0.857, val_loss=0.731, val_accuracy=0.815, lr=0.01]  43%|████▎     | 65/150 [27:44<35:25, 25.00s/epoch, loss=0.599, accuracy=0.862, val_loss=0.76, val_accuracy=0.803, lr=0.01] 44%|████▍     | 66/150 [28:09<35:06, 25.08s/epoch, loss=0.579, accuracy=0.861, val_loss=0.84, val_accuracy=0.781, lr=0.01] 45%|████▍     | 67/150 [28:35<34:55, 25.24s/epoch, loss=0.573, accuracy=0.862, val_loss=0.79, val_accuracy=0.794, lr=0.01] 45%|████▌     | 68/150 [29:01<34:40, 25.37s/epoch, loss=0.56, accuracy=0.865, val_loss=0.811, val_accuracy=0.784, lr=0.01] 46%|████▌     | 69/150 [29:26<34:14, 25.36s/epoch, loss=0.556, accuracy=0.866, val_loss=0.752, val_accuracy=0.797, lr=0.01] 47%|████▋     | 70/150 [29:50<33:16, 24.96s/epoch, loss=0.562, accuracy=0.864, val_loss=0.906, val_accuracy=0.772, lr=0.01] 47%|████▋     | 71/150 [30:14<32:31, 24.70s/epoch, loss=0.555, accuracy=0.868, val_loss=0.817, val_accuracy=0.783, lr=0.01] 48%|████▊     | 72/150 [30:40<32:28, 24.98s/epoch, loss=0.557, accuracy=0.869, val_loss=0.792, val_accuracy=0.793, lr=0.01] 49%|████▊     | 73/150 [31:05<32:17, 25.16s/epoch, loss=0.552, accuracy=0.872, val_loss=0.975, val_accuracy=0.747, lr=0.01] 49%|████▉     | 74/150 [31:31<32:04, 25.33s/epoch, loss=0.55, accuracy=0.873, val_loss=0.779, val_accuracy=0.799, lr=0.01]  50%|█████     | 75/150 [31:56<31:40, 25.34s/epoch, loss=0.551, accuracy=0.874, val_loss=1.22, val_accuracy=0.714, lr=0.01] 51%|█████     | 76/150 [32:21<31:01, 25.15s/epoch, loss=0.553, accuracy=0.872, val_loss=0.79, val_accuracy=0.794, lr=0.01] 51%|█████▏    | 77/150 [32:46<30:33, 25.12s/epoch, loss=0.549, accuracy=0.875, val_loss=0.757, val_accuracy=0.817, lr=0.01] 52%|█████▏    | 78/150 [33:12<30:22, 25.31s/epoch, loss=0.541, accuracy=0.88, val_loss=0.752, val_accuracy=0.812, lr=0.01]  53%|█████▎    | 79/150 [33:38<30:01, 25.38s/epoch, loss=0.553, accuracy=0.876, val_loss=0.781, val_accuracy=0.806, lr=0.01] 53%|█████▎    | 80/150 [34:03<29:42, 25.47s/epoch, loss=0.547, accuracy=0.879, val_loss=0.775, val_accuracy=0.81, lr=0.01]  54%|█████▍    | 81/150 [34:27<28:47, 25.04s/epoch, loss=0.544, accuracy=0.881, val_loss=0.789, val_accuracy=0.801, lr=0.01] 55%|█████▍    | 82/150 [34:52<28:12, 24.90s/epoch, loss=0.555, accuracy=0.878, val_loss=0.932, val_accuracy=0.771, lr=0.01] 55%|█████▌    | 83/150 [35:18<28:04, 25.15s/epoch, loss=0.541, accuracy=0.883, val_loss=0.939, val_accuracy=0.775, lr=0.01] 56%|█████▌    | 84/150 [35:43<27:48, 25.28s/epoch, loss=0.548, accuracy=0.88, val_loss=1.06, val_accuracy=0.732, lr=0.01]   57%|█████▋    | 85/150 [36:09<27:32, 25.42s/epoch, loss=0.546, accuracy=0.883, val_loss=0.829, val_accuracy=0.798, lr=0.01] 57%|█████▋    | 86/150 [36:33<26:49, 25.15s/epoch, loss=0.543, accuracy=0.883, val_loss=1.75, val_accuracy=0.589, lr=0.01]  58%|█████▊    | 87/150 [36:58<26:05, 24.85s/epoch, loss=0.548, accuracy=0.883, val_loss=0.701, val_accuracy=0.833, lr=0.01] 59%|█████▊    | 88/150 [37:23<25:55, 25.08s/epoch, loss=0.548, accuracy=0.882, val_loss=1.01, val_accuracy=0.765, lr=0.01]  59%|█████▉    | 89/150 [37:49<25:41, 25.26s/epoch, loss=0.544, accuracy=0.882, val_loss=0.88, val_accuracy=0.782, lr=0.01] 60%|██████    | 90/150 [38:14<25:20, 25.34s/epoch, loss=0.549, accuracy=0.882, val_loss=0.735, val_accuracy=0.817, lr=0.01] 61%|██████    | 91/150 [38:39<24:50, 25.26s/epoch, loss=0.546, accuracy=0.883, val_loss=1.05, val_accuracy=0.75, lr=0.01]   61%|██████▏   | 92/150 [39:04<24:10, 25.01s/epoch, loss=0.463, accuracy=0.913, val_loss=0.528, val_accuracy=0.891, lr=0.001] 62%|██████▏   | 93/150 [39:29<23:47, 25.05s/epoch, loss=0.412, accuracy=0.929, val_loss=0.51, val_accuracy=0.895, lr=0.001]  63%|██████▎   | 94/150 [39:55<23:32, 25.22s/epoch, loss=0.395, accuracy=0.934, val_loss=0.497, val_accuracy=0.897, lr=0.001] 63%|██████▎   | 95/150 [40:20<23:13, 25.33s/epoch, loss=0.378, accuracy=0.937, val_loss=0.487, val_accuracy=0.902, lr=0.001] 64%|██████▍   | 96/150 [40:46<22:52, 25.42s/epoch, loss=0.367, accuracy=0.939, val_loss=0.478, val_accuracy=0.901, lr=0.001] 65%|██████▍   | 97/150 [41:10<22:05, 25.01s/epoch, loss=0.355, accuracy=0.941, val_loss=0.478, val_accuracy=0.898, lr=0.001] 65%|██████▌   | 98/150 [41:35<21:37, 24.94s/epoch, loss=0.343, accuracy=0.945, val_loss=0.467, val_accuracy=0.902, lr=0.001] 66%|██████▌   | 99/150 [42:00<21:23, 25.17s/epoch, loss=0.333, accuracy=0.947, val_loss=0.46, val_accuracy=0.904, lr=0.001]  67%|██████▋   | 100/150 [42:26<21:04, 25.29s/epoch, loss=0.324, accuracy=0.947, val_loss=0.476, val_accuracy=0.898, lr=0.001] 67%|██████▋   | 101/150 [42:52<20:44, 25.40s/epoch, loss=0.314, accuracy=0.95, val_loss=0.471, val_accuracy=0.899, lr=0.001]  68%|██████▊   | 102/150 [43:16<20:08, 25.17s/epoch, loss=0.309, accuracy=0.949, val_loss=0.466, val_accuracy=0.903, lr=0.001] 69%|██████▊   | 103/150 [43:41<19:31, 24.93s/epoch, loss=0.302, accuracy=0.95, val_loss=0.47, val_accuracy=0.896, lr=0.001]   69%|██████▉   | 104/150 [44:07<19:20, 25.23s/epoch, loss=0.292, accuracy=0.953, val_loss=0.462, val_accuracy=0.901, lr=0.001] 70%|███████   | 105/150 [44:32<19:01, 25.36s/epoch, loss=0.288, accuracy=0.953, val_loss=0.462, val_accuracy=0.9, lr=0.001]   71%|███████   | 106/150 [44:58<18:40, 25.47s/epoch, loss=0.282, accuracy=0.955, val_loss=0.477, val_accuracy=0.893, lr=0.001] 71%|███████▏  | 107/150 [45:23<18:08, 25.30s/epoch, loss=0.275, accuracy=0.956, val_loss=0.489, val_accuracy=0.888, lr=0.001] 72%|███████▏  | 108/150 [45:47<17:27, 24.94s/epoch, loss=0.271, accuracy=0.955, val_loss=0.449, val_accuracy=0.902, lr=0.001] 73%|███████▎  | 109/150 [46:12<17:05, 25.02s/epoch, loss=0.264, accuracy=0.956, val_loss=0.453, val_accuracy=0.899, lr=0.001] 73%|███████▎  | 110/150 [46:38<16:47, 25.18s/epoch, loss=0.257, accuracy=0.958, val_loss=0.449, val_accuracy=0.9, lr=0.001]   74%|███████▍  | 111/150 [47:03<16:27, 25.32s/epoch, loss=0.257, accuracy=0.958, val_loss=0.453, val_accuracy=0.898, lr=0.001] 75%|███████▍  | 112/150 [47:29<16:03, 25.36s/epoch, loss=0.254, accuracy=0.957, val_loss=0.444, val_accuracy=0.896, lr=0.001] 75%|███████▌  | 113/150 [47:53<15:25, 25.02s/epoch, loss=0.249, accuracy=0.958, val_loss=0.47, val_accuracy=0.893, lr=0.001]  76%|███████▌  | 114/150 [48:18<14:57, 24.93s/epoch, loss=0.244, accuracy=0.958, val_loss=0.473, val_accuracy=0.892, lr=0.001] 77%|███████▋  | 115/150 [48:43<14:37, 25.08s/epoch, loss=0.243, accuracy=0.958, val_loss=0.465, val_accuracy=0.893, lr=0.001] 77%|███████▋  | 116/150 [49:09<14:19, 25.29s/epoch, loss=0.24, accuracy=0.959, val_loss=0.496, val_accuracy=0.882, lr=0.001]  78%|███████▊  | 117/150 [49:34<13:55, 25.32s/epoch, loss=0.236, accuracy=0.96, val_loss=0.463, val_accuracy=0.895, lr=0.001] 79%|███████▊  | 118/150 [49:59<13:21, 25.04s/epoch, loss=0.232, accuracy=0.96, val_loss=0.485, val_accuracy=0.887, lr=0.001] 79%|███████▉  | 119/150 [50:23<12:46, 24.71s/epoch, loss=0.233, accuracy=0.959, val_loss=0.494, val_accuracy=0.882, lr=0.001] 80%|████████  | 120/150 [50:48<12:29, 24.97s/epoch, loss=0.228, accuracy=0.961, val_loss=0.472, val_accuracy=0.892, lr=0.001] 81%|████████  | 121/150 [51:14<12:10, 25.19s/epoch, loss=0.226, accuracy=0.961, val_loss=0.526, val_accuracy=0.87, lr=0.001]  81%|████████▏ | 122/150 [51:39<11:48, 25.29s/epoch, loss=0.209, accuracy=0.968, val_loss=0.41, val_accuracy=0.906, lr=1e-04] 82%|████████▏ | 123/150 [52:05<11:22, 25.28s/epoch, loss=0.197, accuracy=0.972, val_loss=0.406, val_accuracy=0.909, lr=1e-04] 83%|████████▎ | 124/150 [52:29<10:49, 24.96s/epoch, loss=0.192, accuracy=0.974, val_loss=0.405, val_accuracy=0.908, lr=1e-04] 83%|████████▎ | 125/150 [52:54<10:27, 25.09s/epoch, loss=0.188, accuracy=0.975, val_loss=0.405, val_accuracy=0.909, lr=1e-04] 84%|████████▍ | 126/150 [53:20<10:07, 25.29s/epoch, loss=0.188, accuracy=0.975, val_loss=0.406, val_accuracy=0.908, lr=1e-04] 85%|████████▍ | 127/150 [53:46<09:42, 25.33s/epoch, loss=0.185, accuracy=0.977, val_loss=0.406, val_accuracy=0.909, lr=1e-04] 85%|████████▌ | 128/150 [54:11<09:18, 25.40s/epoch, loss=0.183, accuracy=0.977, val_loss=0.408, val_accuracy=0.909, lr=1e-04] 86%|████████▌ | 129/150 [54:35<08:46, 25.09s/epoch, loss=0.182, accuracy=0.978, val_loss=0.404, val_accuracy=0.91, lr=1e-04]  87%|████████▋ | 130/150 [55:01<08:24, 25.22s/epoch, loss=0.179, accuracy=0.978, val_loss=0.405, val_accuracy=0.91, lr=1e-04] 87%|████████▋ | 131/150 [55:27<08:01, 25.33s/epoch, loss=0.179, accuracy=0.978, val_loss=0.404, val_accuracy=0.91, lr=1e-04] 88%|████████▊ | 132/150 [55:52<07:37, 25.42s/epoch, loss=0.177, accuracy=0.979, val_loss=0.405, val_accuracy=0.91, lr=1e-04] 89%|████████▊ | 133/150 [56:17<07:11, 25.37s/epoch, loss=0.178, accuracy=0.978, val_loss=0.408, val_accuracy=0.91, lr=1e-04] 89%|████████▉ | 134/150 [56:41<06:39, 24.95s/epoch, loss=0.176, accuracy=0.979, val_loss=0.406, val_accuracy=0.91, lr=1e-04] 90%|█████████ | 135/150 [57:05<06:07, 24.48s/epoch, loss=0.174, accuracy=0.98, val_loss=0.409, val_accuracy=0.911, lr=1e-04] 91%|█████████ | 136/150 [57:28<05:39, 24.24s/epoch, loss=0.174, accuracy=0.979, val_loss=0.405, val_accuracy=0.911, lr=1e-04] 91%|█████████▏| 137/150 [57:52<05:13, 24.13s/epoch, loss=0.173, accuracy=0.98, val_loss=0.406, val_accuracy=0.911, lr=5e-5]   92%|█████████▏| 138/150 [58:16<04:48, 24.06s/epoch, loss=0.172, accuracy=0.98, val_loss=0.407, val_accuracy=0.911, lr=5e-5] 93%|█████████▎| 139/150 [58:40<04:23, 23.94s/epoch, loss=0.171, accuracy=0.98, val_loss=0.405, val_accuracy=0.911, lr=5e-5] 93%|█████████▎| 140/150 [59:05<04:03, 24.35s/epoch, loss=0.171, accuracy=0.981, val_loss=0.407, val_accuracy=0.91, lr=5e-5] 94%|█████████▍| 141/150 [59:31<03:41, 24.65s/epoch, loss=0.17, accuracy=0.98, val_loss=0.408, val_accuracy=0.911, lr=5e-5]  95%|█████████▍| 142/150 [59:56<03:19, 24.90s/epoch, loss=0.169, accuracy=0.982, val_loss=0.407, val_accuracy=0.911, lr=5e-5] 95%|█████████▌| 143/150 [1:00:21<02:54, 24.92s/epoch, loss=0.17, accuracy=0.98, val_loss=0.405, val_accuracy=0.91, lr=5e-5]  96%|█████████▌| 144/150 [1:00:45<02:27, 24.62s/epoch, loss=0.169, accuracy=0.981, val_loss=0.405, val_accuracy=0.911, lr=5e-5] 97%|█████████▋| 145/150 [1:01:09<02:02, 24.42s/epoch, loss=0.169, accuracy=0.981, val_loss=0.406, val_accuracy=0.911, lr=5e-5] 97%|█████████▋| 146/150 [1:01:33<01:37, 24.30s/epoch, loss=0.166, accuracy=0.982, val_loss=0.405, val_accuracy=0.911, lr=5e-5] 98%|█████████▊| 147/150 [1:01:58<01:13, 24.65s/epoch, loss=0.166, accuracy=0.982, val_loss=0.407, val_accuracy=0.91, lr=5e-5]  99%|█████████▊| 148/150 [1:02:24<00:49, 24.97s/epoch, loss=0.167, accuracy=0.981, val_loss=0.41, val_accuracy=0.91, lr=5e-5]  99%|█████████▉| 149/150 [1:02:49<00:25, 25.09s/epoch, loss=0.167, accuracy=0.981, val_loss=0.409, val_accuracy=0.909, lr=5e-5]100%|██████████| 150/150 [1:03:15<00:00, 25.11s/epoch, loss=0.167, accuracy=0.981, val_loss=0.409, val_accuracy=0.91, lr=5e-5] 100%|██████████| 150/150 [1:03:15<00:00, 25.30s/epoch, loss=0.167, accuracy=0.981, val_loss=0.409, val_accuracy=0.91, lr=5e-5]
Using real-time data augmentation.
Only one model saved

Loading model: 10_09_cifar10_ResNet20v1.h5
Test score: 0.4092254340648651
Test accuracy: 0.9104999899864197


* * * Run SGD for ID = 10_10. * * *


2024-03-13 06:55:31.510122: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 06:55:40.431399: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 06:55:40.432598: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-13 06:55:40.475658: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:86:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-13 06:55:40.475698: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 06:55:40.497609: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 06:55:40.497674: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 06:55:40.502125: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 06:55:40.504302: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 06:55:40.513859: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 06:55:40.516590: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 06:55:40.522979: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 06:55:40.523623: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 06:55:40.523709: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 06:55:41.705330: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-13 06:55:41.706018: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 06:55:41.707155: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:86:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-13 06:55:41.707195: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 06:55:41.707238: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 06:55:41.707253: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 06:55:41.707267: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 06:55:41.707283: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 06:55:41.707297: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 06:55:41.707311: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 06:55:41.707326: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 06:55:41.707898: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 06:55:41.707953: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 06:55:42.329523: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-13 06:55:42.329579: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-13 06:55:42.329589: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-13 06:55:42.331843: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:86:00.0, compute capability: 6.1)
{'id': '10_10', 'seed': 10, 'out_folder': 'results/epoch_budget_2', 'batch_size': 128, 'epochs': 150, 'validation_split': 0.0, 'checkpointing': False, 'checkpoint_every': -1, 'hold_out_validation_split': 0.0, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'num_classes': 10, 'SSE_lr': False, 'test_time_augmentation': False, 'debug': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
y_train shape: (50000, 10)
x_val shape: (10000, 32, 32, 3)
y_val shape: (10000, 10)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/150 [00:00<?, ?epoch/s]2024-03-13 06:55:42.939928: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-13 06:55:42.952002: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-03-13 06:55:44.784042: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 06:55:45.048445: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 06:55:45.997174: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-13 06:55:46.057075: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/150 [00:57<2:22:24, 57.34s/epoch, loss=2.97, accuracy=0.343, val_loss=2.95, val_accuracy=0.236, lr=0.1]  1%|▏         | 2/150 [01:23<1:35:32, 38.73s/epoch, loss=1.51, accuracy=0.57, val_loss=3.53, val_accuracy=0.175, lr=0.1]   2%|▏         | 3/150 [01:48<1:20:01, 32.66s/epoch, loss=1.32, accuracy=0.659, val_loss=1.84, val_accuracy=0.522, lr=0.1]  3%|▎         | 4/150 [02:14<1:12:41, 29.87s/epoch, loss=1.28, accuracy=0.689, val_loss=3.84, val_accuracy=0.253, lr=0.1]  3%|▎         | 5/150 [02:39<1:08:09, 28.20s/epoch, loss=1.25, accuracy=0.704, val_loss=1.74, val_accuracy=0.573, lr=0.1]  4%|▍         | 6/150 [03:03<1:04:16, 26.78s/epoch, loss=1.22, accuracy=0.714, val_loss=1.95, val_accuracy=0.532, lr=0.1]  5%|▍         | 7/150 [03:27<1:01:52, 25.96s/epoch, loss=1.21, accuracy=0.722, val_loss=1.76, val_accuracy=0.543, lr=0.1]  5%|▌         | 8/150 [03:51<1:00:01, 25.36s/epoch, loss=1.22, accuracy=0.724, val_loss=1.84, val_accuracy=0.518, lr=0.1]  6%|▌         | 9/150 [04:17<59:34, 25.35s/epoch, loss=1.2, accuracy=0.729, val_loss=2.19, val_accuracy=0.403, lr=0.1]     7%|▋         | 10/150 [04:41<58:40, 25.14s/epoch, loss=1.19, accuracy=0.734, val_loss=2.14, val_accuracy=0.509, lr=0.1]  7%|▋         | 11/150 [05:06<58:04, 25.06s/epoch, loss=1.19, accuracy=0.733, val_loss=1.95, val_accuracy=0.517, lr=0.1]  8%|▊         | 12/150 [05:32<58:02, 25.24s/epoch, loss=1.18, accuracy=0.739, val_loss=1.98, val_accuracy=0.482, lr=0.1]  9%|▊         | 13/150 [05:55<56:33, 24.77s/epoch, loss=1.18, accuracy=0.739, val_loss=1.84, val_accuracy=0.548, lr=0.1]  9%|▉         | 14/150 [06:19<55:32, 24.50s/epoch, loss=1.17, accuracy=0.74, val_loss=2.07, val_accuracy=0.498, lr=0.1]  10%|█         | 15/150 [06:43<54:52, 24.39s/epoch, loss=1.17, accuracy=0.742, val_loss=1.43, val_accuracy=0.657, lr=0.1] 11%|█         | 16/150 [07:08<54:51, 24.57s/epoch, loss=1.16, accuracy=0.744, val_loss=1.86, val_accuracy=0.523, lr=0.1] 11%|█▏        | 17/150 [07:34<55:01, 24.82s/epoch, loss=1.16, accuracy=0.743, val_loss=2.47, val_accuracy=0.475, lr=0.1] 12%|█▏        | 18/150 [07:59<54:59, 25.00s/epoch, loss=1.16, accuracy=0.747, val_loss=2.18, val_accuracy=0.504, lr=0.1] 13%|█▎        | 19/150 [08:25<54:47, 25.09s/epoch, loss=1.15, accuracy=0.748, val_loss=3.04, val_accuracy=0.322, lr=0.1] 13%|█▎        | 20/150 [08:48<53:32, 24.71s/epoch, loss=1.15, accuracy=0.749, val_loss=1.92, val_accuracy=0.537, lr=0.1] 14%|█▍        | 21/150 [09:12<52:36, 24.47s/epoch, loss=1.15, accuracy=0.748, val_loss=3.31, val_accuracy=0.295, lr=0.1] 15%|█▍        | 22/150 [09:37<52:07, 24.43s/epoch, loss=1.16, accuracy=0.749, val_loss=2.44, val_accuracy=0.458, lr=0.1] 15%|█▌        | 23/150 [10:02<52:04, 24.60s/epoch, loss=1.15, accuracy=0.752, val_loss=2.75, val_accuracy=0.437, lr=0.1] 16%|█▌        | 24/150 [10:27<52:13, 24.87s/epoch, loss=1.14, accuracy=0.751, val_loss=1.45, val_accuracy=0.64, lr=0.1]  17%|█▋        | 25/150 [10:53<52:09, 25.03s/epoch, loss=1.14, accuracy=0.752, val_loss=2.42, val_accuracy=0.454, lr=0.1] 17%|█▋        | 26/150 [11:18<52:09, 25.24s/epoch, loss=1.14, accuracy=0.751, val_loss=2, val_accuracy=0.533, lr=0.1]    18%|█▊        | 27/150 [11:42<50:50, 24.80s/epoch, loss=1.14, accuracy=0.753, val_loss=1.71, val_accuracy=0.551, lr=0.1] 19%|█▊        | 28/150 [12:06<49:45, 24.47s/epoch, loss=1.14, accuracy=0.75, val_loss=2.04, val_accuracy=0.486, lr=0.1]  19%|█▉        | 29/150 [12:30<49:13, 24.41s/epoch, loss=1.13, accuracy=0.751, val_loss=2.99, val_accuracy=0.421, lr=0.1] 20%|██        | 30/150 [12:55<49:14, 24.62s/epoch, loss=1.14, accuracy=0.751, val_loss=1.87, val_accuracy=0.532, lr=0.1] 21%|██        | 31/150 [13:20<49:16, 24.84s/epoch, loss=1.13, accuracy=0.755, val_loss=1.66, val_accuracy=0.596, lr=0.1] 21%|██▏       | 32/150 [13:46<49:13, 25.03s/epoch, loss=1.13, accuracy=0.756, val_loss=3.31, val_accuracy=0.388, lr=0.1] 22%|██▏       | 33/150 [14:11<48:57, 25.11s/epoch, loss=1.13, accuracy=0.753, val_loss=2.1, val_accuracy=0.49, lr=0.1]   23%|██▎       | 34/150 [14:35<47:44, 24.70s/epoch, loss=1.13, accuracy=0.754, val_loss=3.03, val_accuracy=0.376, lr=0.1] 23%|██▎       | 35/150 [14:59<46:56, 24.49s/epoch, loss=1.13, accuracy=0.754, val_loss=1.57, val_accuracy=0.598, lr=0.1] 24%|██▍       | 36/150 [15:23<46:18, 24.37s/epoch, loss=1.13, accuracy=0.756, val_loss=1.6, val_accuracy=0.563, lr=0.1]  25%|██▍       | 37/150 [15:48<46:14, 24.55s/epoch, loss=1.12, accuracy=0.756, val_loss=3.28, val_accuracy=0.314, lr=0.1] 25%|██▌       | 38/150 [16:14<46:32, 24.93s/epoch, loss=1.12, accuracy=0.757, val_loss=2.23, val_accuracy=0.445, lr=0.1] 26%|██▌       | 39/150 [16:39<46:20, 25.05s/epoch, loss=1.12, accuracy=0.757, val_loss=1.73, val_accuracy=0.563, lr=0.1] 27%|██▋       | 40/150 [17:05<46:10, 25.19s/epoch, loss=1.12, accuracy=0.757, val_loss=3, val_accuracy=0.318, lr=0.1]    27%|██▋       | 41/150 [17:29<45:03, 24.80s/epoch, loss=1.12, accuracy=0.757, val_loss=2.4, val_accuracy=0.399, lr=0.1] 28%|██▊       | 42/150 [17:52<44:02, 24.47s/epoch, loss=1.11, accuracy=0.759, val_loss=2.1, val_accuracy=0.519, lr=0.1] 29%|██▊       | 43/150 [18:17<43:33, 24.43s/epoch, loss=1.12, accuracy=0.756, val_loss=1.71, val_accuracy=0.596, lr=0.1] 29%|██▉       | 44/150 [18:42<43:35, 24.68s/epoch, loss=1.11, accuracy=0.759, val_loss=1.97, val_accuracy=0.454, lr=0.1] 30%|███       | 45/150 [19:07<43:36, 24.92s/epoch, loss=1.11, accuracy=0.76, val_loss=2.62, val_accuracy=0.3, lr=0.1]    31%|███       | 46/150 [19:33<43:22, 25.02s/epoch, loss=1.13, accuracy=0.754, val_loss=1.55, val_accuracy=0.619, lr=0.1] 31%|███▏      | 47/150 [19:58<43:14, 25.19s/epoch, loss=1.12, accuracy=0.76, val_loss=1.96, val_accuracy=0.467, lr=0.1]  32%|███▏      | 48/150 [20:22<42:04, 24.75s/epoch, loss=1.11, accuracy=0.761, val_loss=3.74, val_accuracy=0.326, lr=0.1] 33%|███▎      | 49/150 [20:46<41:15, 24.51s/epoch, loss=1.12, accuracy=0.755, val_loss=2.72, val_accuracy=0.414, lr=0.1] 33%|███▎      | 50/150 [21:10<40:39, 24.40s/epoch, loss=1.12, accuracy=0.757, val_loss=1.97, val_accuracy=0.52, lr=0.1]  34%|███▍      | 51/150 [21:35<40:33, 24.58s/epoch, loss=1.11, accuracy=0.761, val_loss=2.11, val_accuracy=0.475, lr=0.1] 35%|███▍      | 52/150 [22:00<40:31, 24.81s/epoch, loss=1.11, accuracy=0.76, val_loss=2, val_accuracy=0.513, lr=0.1]     35%|███▌      | 53/150 [22:26<40:31, 25.07s/epoch, loss=1.11, accuracy=0.758, val_loss=2.6, val_accuracy=0.376, lr=0.1] 36%|███▌      | 54/150 [22:51<40:17, 25.19s/epoch, loss=1.11, accuracy=0.76, val_loss=2.38, val_accuracy=0.42, lr=0.1]  37%|███▋      | 55/150 [23:15<39:17, 24.82s/epoch, loss=1.11, accuracy=0.761, val_loss=1.98, val_accuracy=0.461, lr=0.1] 37%|███▋      | 56/150 [23:40<38:35, 24.63s/epoch, loss=1.11, accuracy=0.761, val_loss=1.69, val_accuracy=0.579, lr=0.1] 38%|███▊      | 57/150 [24:04<38:03, 24.55s/epoch, loss=1.12, accuracy=0.758, val_loss=1.72, val_accuracy=0.613, lr=0.1] 39%|███▊      | 58/150 [24:30<38:08, 24.87s/epoch, loss=1.12, accuracy=0.759, val_loss=3.76, val_accuracy=0.294, lr=0.1] 39%|███▉      | 59/150 [24:55<38:01, 25.07s/epoch, loss=1.11, accuracy=0.761, val_loss=1.96, val_accuracy=0.502, lr=0.1] 40%|████      | 60/150 [25:21<37:46, 25.18s/epoch, loss=1.11, accuracy=0.759, val_loss=1.5, val_accuracy=0.641, lr=0.1]  41%|████      | 61/150 [25:46<37:24, 25.22s/epoch, loss=1.11, accuracy=0.76, val_loss=1.64, val_accuracy=0.583, lr=0.1] 41%|████▏     | 62/150 [26:10<36:23, 24.82s/epoch, loss=0.903, accuracy=0.82, val_loss=0.913, val_accuracy=0.799, lr=0.01] 42%|████▏     | 63/150 [26:34<35:39, 24.59s/epoch, loss=0.723, accuracy=0.851, val_loss=0.833, val_accuracy=0.804, lr=0.01] 43%|████▎     | 64/150 [26:58<35:02, 24.45s/epoch, loss=0.646, accuracy=0.857, val_loss=0.709, val_accuracy=0.835, lr=0.01] 43%|████▎     | 65/150 [27:23<34:56, 24.66s/epoch, loss=0.602, accuracy=0.861, val_loss=0.744, val_accuracy=0.813, lr=0.01] 44%|████▍     | 66/150 [27:49<34:52, 24.91s/epoch, loss=0.58, accuracy=0.862, val_loss=0.846, val_accuracy=0.778, lr=0.01]  45%|████▍     | 67/150 [28:14<34:45, 25.12s/epoch, loss=0.57, accuracy=0.864, val_loss=0.837, val_accuracy=0.781, lr=0.01] 45%|████▌     | 68/150 [28:40<34:25, 25.18s/epoch, loss=0.564, accuracy=0.864, val_loss=0.799, val_accuracy=0.788, lr=0.01] 46%|████▌     | 69/150 [29:03<33:07, 24.54s/epoch, loss=0.559, accuracy=0.867, val_loss=0.714, val_accuracy=0.813, lr=0.01] 47%|████▋     | 70/150 [29:27<32:37, 24.47s/epoch, loss=0.556, accuracy=0.867, val_loss=0.781, val_accuracy=0.804, lr=0.01] 47%|████▋     | 71/150 [29:50<31:44, 24.11s/epoch, loss=0.559, accuracy=0.867, val_loss=0.898, val_accuracy=0.761, lr=0.01] 48%|████▊     | 72/150 [30:14<31:18, 24.09s/epoch, loss=0.558, accuracy=0.87, val_loss=0.986, val_accuracy=0.757, lr=0.01]  49%|████▊     | 73/150 [30:38<30:54, 24.09s/epoch, loss=0.554, accuracy=0.872, val_loss=0.702, val_accuracy=0.818, lr=0.01] 49%|████▉     | 74/150 [31:04<30:59, 24.47s/epoch, loss=0.553, accuracy=0.872, val_loss=0.96, val_accuracy=0.752, lr=0.01]  50%|█████     | 75/150 [31:29<30:59, 24.79s/epoch, loss=0.556, accuracy=0.873, val_loss=1.01, val_accuracy=0.741, lr=0.01] 51%|█████     | 76/150 [31:55<30:58, 25.11s/epoch, loss=0.552, accuracy=0.873, val_loss=0.859, val_accuracy=0.788, lr=0.01] 51%|█████▏    | 77/150 [32:20<30:34, 25.13s/epoch, loss=0.549, accuracy=0.876, val_loss=0.957, val_accuracy=0.748, lr=0.01] 52%|█████▏    | 78/150 [32:44<29:46, 24.81s/epoch, loss=0.553, accuracy=0.875, val_loss=1.19, val_accuracy=0.728, lr=0.01]  53%|█████▎    | 79/150 [33:08<29:02, 24.54s/epoch, loss=0.549, accuracy=0.877, val_loss=0.801, val_accuracy=0.795, lr=0.01] 53%|█████▎    | 80/150 [33:34<28:57, 24.82s/epoch, loss=0.55, accuracy=0.879, val_loss=0.93, val_accuracy=0.765, lr=0.01]   54%|█████▍    | 81/150 [33:59<28:44, 24.99s/epoch, loss=0.548, accuracy=0.881, val_loss=1.02, val_accuracy=0.74, lr=0.01] 55%|█████▍    | 82/150 [34:25<28:30, 25.16s/epoch, loss=0.552, accuracy=0.878, val_loss=0.905, val_accuracy=0.766, lr=0.01] 55%|█████▌    | 83/150 [34:49<27:40, 24.78s/epoch, loss=0.552, accuracy=0.879, val_loss=0.896, val_accuracy=0.799, lr=0.01] 56%|█████▌    | 84/150 [35:12<26:56, 24.50s/epoch, loss=0.548, accuracy=0.882, val_loss=0.822, val_accuracy=0.795, lr=0.01] 57%|█████▋    | 85/150 [35:36<26:15, 24.23s/epoch, loss=0.553, accuracy=0.879, val_loss=1.3, val_accuracy=0.688, lr=0.01]   57%|█████▋    | 86/150 [36:01<26:06, 24.48s/epoch, loss=0.554, accuracy=0.88, val_loss=0.793, val_accuracy=0.809, lr=0.01] 58%|█████▊    | 87/150 [36:26<25:59, 24.75s/epoch, loss=0.548, accuracy=0.883, val_loss=1.16, val_accuracy=0.713, lr=0.01] 59%|█████▊    | 88/150 [36:52<25:45, 24.93s/epoch, loss=0.55, accuracy=0.882, val_loss=0.808, val_accuracy=0.805, lr=0.01] 59%|█████▉    | 89/150 [37:17<25:22, 24.96s/epoch, loss=0.549, accuracy=0.883, val_loss=1.34, val_accuracy=0.697, lr=0.01] 60%|██████    | 90/150 [37:41<24:37, 24.62s/epoch, loss=0.549, accuracy=0.884, val_loss=1, val_accuracy=0.75, lr=0.01]     61%|██████    | 91/150 [38:04<23:56, 24.34s/epoch, loss=0.547, accuracy=0.884, val_loss=1.15, val_accuracy=0.709, lr=0.01] 61%|██████▏   | 92/150 [38:29<23:45, 24.58s/epoch, loss=0.467, accuracy=0.912, val_loss=0.534, val_accuracy=0.89, lr=0.001] 62%|██████▏   | 93/150 [38:55<23:35, 24.82s/epoch, loss=0.419, accuracy=0.927, val_loss=0.52, val_accuracy=0.895, lr=0.001] 63%|██████▎   | 94/150 [39:20<23:16, 24.94s/epoch, loss=0.398, accuracy=0.932, val_loss=0.509, val_accuracy=0.897, lr=0.001] 63%|██████▎   | 95/150 [39:45<22:51, 24.93s/epoch, loss=0.379, accuracy=0.937, val_loss=0.509, val_accuracy=0.894, lr=0.001] 64%|██████▍   | 96/150 [40:09<22:09, 24.61s/epoch, loss=0.367, accuracy=0.939, val_loss=0.498, val_accuracy=0.897, lr=0.001] 65%|██████▍   | 97/150 [40:33<21:32, 24.38s/epoch, loss=0.355, accuracy=0.942, val_loss=0.491, val_accuracy=0.899, lr=0.001] 65%|██████▌   | 98/150 [40:58<21:25, 24.73s/epoch, loss=0.344, accuracy=0.943, val_loss=0.484, val_accuracy=0.901, lr=0.001] 66%|██████▌   | 99/150 [41:24<21:10, 24.92s/epoch, loss=0.335, accuracy=0.946, val_loss=0.487, val_accuracy=0.894, lr=0.001] 67%|██████▋   | 100/150 [41:49<20:52, 25.05s/epoch, loss=0.324, accuracy=0.949, val_loss=0.497, val_accuracy=0.895, lr=0.001] 67%|██████▋   | 101/150 [42:14<20:21, 24.94s/epoch, loss=0.316, accuracy=0.949, val_loss=0.483, val_accuracy=0.897, lr=0.001] 68%|██████▊   | 102/150 [42:38<19:43, 24.66s/epoch, loss=0.309, accuracy=0.95, val_loss=0.483, val_accuracy=0.897, lr=0.001]  69%|██████▊   | 103/150 [43:02<19:08, 24.45s/epoch, loss=0.302, accuracy=0.95, val_loss=0.48, val_accuracy=0.893, lr=0.001]  69%|██████▉   | 104/150 [43:27<18:56, 24.71s/epoch, loss=0.296, accuracy=0.951, val_loss=0.478, val_accuracy=0.899, lr=0.001] 70%|███████   | 105/150 [43:52<18:40, 24.89s/epoch, loss=0.287, accuracy=0.953, val_loss=0.47, val_accuracy=0.898, lr=0.001]  71%|███████   | 106/150 [44:17<18:19, 24.99s/epoch, loss=0.279, accuracy=0.955, val_loss=0.504, val_accuracy=0.888, lr=0.001] 71%|███████▏  | 107/150 [44:42<17:48, 24.86s/epoch, loss=0.275, accuracy=0.954, val_loss=0.475, val_accuracy=0.896, lr=0.001] 72%|███████▏  | 108/150 [45:06<17:09, 24.52s/epoch, loss=0.27, accuracy=0.956, val_loss=0.468, val_accuracy=0.897, lr=0.001]  73%|███████▎  | 109/150 [45:30<16:39, 24.38s/epoch, loss=0.265, accuracy=0.956, val_loss=0.463, val_accuracy=0.895, lr=0.001] 73%|███████▎  | 110/150 [45:55<16:24, 24.60s/epoch, loss=0.259, accuracy=0.958, val_loss=0.465, val_accuracy=0.894, lr=0.001] 74%|███████▍  | 111/150 [46:20<16:06, 24.79s/epoch, loss=0.254, accuracy=0.959, val_loss=0.483, val_accuracy=0.895, lr=0.001] 75%|███████▍  | 112/150 [46:45<15:45, 24.89s/epoch, loss=0.249, accuracy=0.959, val_loss=0.489, val_accuracy=0.888, lr=0.001] 75%|███████▌  | 113/150 [47:09<15:13, 24.70s/epoch, loss=0.247, accuracy=0.959, val_loss=0.476, val_accuracy=0.892, lr=0.001] 76%|███████▌  | 114/150 [47:33<14:41, 24.49s/epoch, loss=0.244, accuracy=0.958, val_loss=0.493, val_accuracy=0.887, lr=0.001] 77%|███████▋  | 115/150 [47:58<14:13, 24.39s/epoch, loss=0.239, accuracy=0.96, val_loss=0.488, val_accuracy=0.889, lr=0.001]  77%|███████▋  | 116/150 [48:23<13:58, 24.65s/epoch, loss=0.238, accuracy=0.96, val_loss=0.466, val_accuracy=0.896, lr=0.001] 78%|███████▊  | 117/150 [48:48<13:38, 24.80s/epoch, loss=0.238, accuracy=0.959, val_loss=0.493, val_accuracy=0.885, lr=0.001] 79%|███████▊  | 118/150 [49:13<13:16, 24.89s/epoch, loss=0.233, accuracy=0.961, val_loss=0.477, val_accuracy=0.889, lr=0.001] 79%|███████▉  | 119/150 [49:36<12:33, 24.30s/epoch, loss=0.228, accuracy=0.961, val_loss=0.458, val_accuracy=0.892, lr=0.001] 80%|████████  | 120/150 [50:00<12:05, 24.17s/epoch, loss=0.226, accuracy=0.961, val_loss=0.541, val_accuracy=0.875, lr=0.001] 81%|████████  | 121/150 [50:24<11:39, 24.11s/epoch, loss=0.227, accuracy=0.961, val_loss=0.484, val_accuracy=0.888, lr=0.001] 81%|████████▏ | 122/150 [50:49<11:24, 24.44s/epoch, loss=0.207, accuracy=0.969, val_loss=0.433, val_accuracy=0.902, lr=1e-04] 82%|████████▏ | 123/150 [51:15<11:07, 24.73s/epoch, loss=0.193, accuracy=0.975, val_loss=0.429, val_accuracy=0.904, lr=1e-04] 83%|████████▎ | 124/150 [51:40<10:47, 24.91s/epoch, loss=0.188, accuracy=0.976, val_loss=0.429, val_accuracy=0.902, lr=1e-04] 83%|████████▎ | 125/150 [52:05<10:23, 24.95s/epoch, loss=0.187, accuracy=0.976, val_loss=0.429, val_accuracy=0.902, lr=1e-04] 84%|████████▍ | 126/150 [52:29<09:51, 24.64s/epoch, loss=0.183, accuracy=0.978, val_loss=0.426, val_accuracy=0.904, lr=1e-04] 85%|████████▍ | 127/150 [52:53<09:20, 24.37s/epoch, loss=0.181, accuracy=0.978, val_loss=0.428, val_accuracy=0.904, lr=1e-04] 85%|████████▌ | 128/150 [53:18<09:02, 24.65s/epoch, loss=0.179, accuracy=0.979, val_loss=0.426, val_accuracy=0.904, lr=1e-04] 86%|████████▌ | 129/150 [53:43<08:42, 24.86s/epoch, loss=0.18, accuracy=0.978, val_loss=0.426, val_accuracy=0.904, lr=1e-04]  87%|████████▋ | 130/150 [54:08<08:18, 24.95s/epoch, loss=0.177, accuracy=0.979, val_loss=0.427, val_accuracy=0.904, lr=1e-04] 87%|████████▋ | 131/150 [54:33<07:52, 24.88s/epoch, loss=0.176, accuracy=0.98, val_loss=0.428, val_accuracy=0.904, lr=1e-04]  88%|████████▊ | 132/150 [54:57<07:21, 24.53s/epoch, loss=0.174, accuracy=0.98, val_loss=0.425, val_accuracy=0.905, lr=1e-04] 89%|████████▊ | 133/150 [55:20<06:52, 24.25s/epoch, loss=0.174, accuracy=0.98, val_loss=0.426, val_accuracy=0.904, lr=1e-04] 89%|████████▉ | 134/150 [55:46<06:33, 24.56s/epoch, loss=0.173, accuracy=0.979, val_loss=0.425, val_accuracy=0.905, lr=1e-04] 90%|█████████ | 135/150 [56:11<06:11, 24.76s/epoch, loss=0.172, accuracy=0.98, val_loss=0.428, val_accuracy=0.904, lr=1e-04]  91%|█████████ | 136/150 [56:36<05:48, 24.90s/epoch, loss=0.171, accuracy=0.98, val_loss=0.429, val_accuracy=0.905, lr=1e-04] 91%|█████████▏| 137/150 [57:01<05:22, 24.82s/epoch, loss=0.167, accuracy=0.983, val_loss=0.428, val_accuracy=0.905, lr=5e-5] 92%|█████████▏| 138/150 [57:24<04:53, 24.47s/epoch, loss=0.166, accuracy=0.983, val_loss=0.428, val_accuracy=0.905, lr=5e-5] 93%|█████████▎| 139/150 [57:48<04:27, 24.31s/epoch, loss=0.166, accuracy=0.983, val_loss=0.428, val_accuracy=0.904, lr=5e-5] 93%|█████████▎| 140/150 [58:14<04:05, 24.59s/epoch, loss=0.167, accuracy=0.982, val_loss=0.427, val_accuracy=0.905, lr=5e-5] 94%|█████████▍| 141/150 [58:39<03:43, 24.81s/epoch, loss=0.166, accuracy=0.982, val_loss=0.427, val_accuracy=0.905, lr=5e-5] 95%|█████████▍| 142/150 [59:04<03:19, 24.90s/epoch, loss=0.166, accuracy=0.982, val_loss=0.427, val_accuracy=0.904, lr=5e-5] 95%|█████████▌| 143/150 [59:29<02:53, 24.77s/epoch, loss=0.165, accuracy=0.982, val_loss=0.428, val_accuracy=0.904, lr=5e-5] 96%|█████████▌| 144/150 [59:52<02:26, 24.34s/epoch, loss=0.164, accuracy=0.983, val_loss=0.428, val_accuracy=0.905, lr=5e-5] 97%|█████████▋| 145/150 [1:00:15<02:00, 24.05s/epoch, loss=0.164, accuracy=0.983, val_loss=0.427, val_accuracy=0.904, lr=5e-5] 97%|█████████▋| 146/150 [1:00:39<01:35, 23.95s/epoch, loss=0.163, accuracy=0.983, val_loss=0.427, val_accuracy=0.906, lr=5e-5] 98%|█████████▊| 147/150 [1:01:03<01:11, 23.88s/epoch, loss=0.162, accuracy=0.983, val_loss=0.428, val_accuracy=0.905, lr=5e-5] 99%|█████████▊| 148/150 [1:01:26<00:47, 23.82s/epoch, loss=0.161, accuracy=0.984, val_loss=0.429, val_accuracy=0.904, lr=5e-5] 99%|█████████▉| 149/150 [1:01:51<00:24, 24.09s/epoch, loss=0.163, accuracy=0.983, val_loss=0.426, val_accuracy=0.906, lr=5e-5]100%|██████████| 150/150 [1:02:16<00:00, 24.47s/epoch, loss=0.162, accuracy=0.984, val_loss=0.429, val_accuracy=0.905, lr=5e-5]100%|██████████| 150/150 [1:02:16<00:00, 24.91s/epoch, loss=0.162, accuracy=0.984, val_loss=0.429, val_accuracy=0.905, lr=5e-5]
Using real-time data augmentation.
Only one model saved

Loading model: 10_10_cifar10_ResNet20v1.h5
Test score: 0.42867836356163025
Test accuracy: 0.9050999879837036

Wed Mar 13 02:12:41 2024       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 545.23.08              Driver Version: 545.23.08    CUDA Version: 12.3     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA TITAN Xp                Off | 00000000:83:00.0 Off |                  N/A |
| 47%   66C    P5              17W / 250W |      0MiB / 12288MiB |      0%      Default |
|                                         |                      |                  N/A |
+-----------------------------------------+----------------------+----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
|  No running processes found                                                           |
+---------------------------------------------------------------------------------------+


* * * Run SGD for cluster size = 12. * * *


Budget: 125


* * * Run SGD for ID = 12_1. * * *


2024-03-13 02:12:48.413573: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 02:13:01.418630: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 02:13:01.420716: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-13 02:13:01.464459: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-13 02:13:01.464499: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 02:13:01.510725: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 02:13:01.510776: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 02:13:01.532134: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 02:13:01.576656: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 02:13:01.622550: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 02:13:01.683417: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 02:13:01.723454: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 02:13:01.724081: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 02:13:01.724174: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 02:13:03.239891: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-13 02:13:03.240364: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 02:13:03.241629: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-13 02:13:03.241667: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 02:13:03.241700: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 02:13:03.241717: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 02:13:03.241733: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 02:13:03.241748: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 02:13:03.241764: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 02:13:03.241779: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 02:13:03.241795: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 02:13:03.242270: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 02:13:03.242307: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 02:13:04.131376: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-13 02:13:04.131443: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-13 02:13:04.131453: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-13 02:13:04.132751: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:83:00.0, compute capability: 6.1)
{'id': '12_01', 'seed': 1, 'out_folder': 'results/epoch_budget_2', 'batch_size': 128, 'epochs': 125, 'validation_split': 0.0, 'checkpointing': False, 'checkpoint_every': -1, 'hold_out_validation_split': 0.0, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'num_classes': 10, 'SSE_lr': False, 'test_time_augmentation': False, 'debug': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
y_train shape: (50000, 10)
x_val shape: (10000, 32, 32, 3)
y_val shape: (10000, 10)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/125 [00:00<?, ?epoch/s]2024-03-13 02:13:04.808493: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-13 02:13:04.820968: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199945000 Hz
2024-03-13 02:13:06.991859: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 02:13:07.219149: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 02:13:08.120762: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-13 02:13:08.154845: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/125 [00:47<1:39:06, 47.96s/epoch, loss=3.29, accuracy=0.283, val_loss=2.83, val_accuracy=0.179, lr=0.1]  2%|▏         | 2/125 [01:08<1:05:46, 32.09s/epoch, loss=1.63, accuracy=0.491, val_loss=2.67, val_accuracy=0.347, lr=0.1]  2%|▏         | 3/125 [01:29<54:44, 26.92s/epoch, loss=1.4, accuracy=0.602, val_loss=2.97, val_accuracy=0.34, lr=0.1]      3%|▎         | 4/125 [01:50<49:20, 24.47s/epoch, loss=1.33, accuracy=0.652, val_loss=1.72, val_accuracy=0.522, lr=0.1]  4%|▍         | 5/125 [02:11<46:16, 23.14s/epoch, loss=1.27, accuracy=0.685, val_loss=4.53, val_accuracy=0.23, lr=0.1]   5%|▍         | 6/125 [02:31<44:17, 22.33s/epoch, loss=1.25, accuracy=0.7, val_loss=2.19, val_accuracy=0.382, lr=0.1]   6%|▌         | 7/125 [02:52<42:55, 21.83s/epoch, loss=1.23, accuracy=0.717, val_loss=1.69, val_accuracy=0.58, lr=0.1]  6%|▋         | 8/125 [03:13<41:54, 21.49s/epoch, loss=1.23, accuracy=0.719, val_loss=2.71, val_accuracy=0.442, lr=0.1]  7%|▋         | 9/125 [03:34<41:07, 21.27s/epoch, loss=1.23, accuracy=0.722, val_loss=1.72, val_accuracy=0.564, lr=0.1]  8%|▊         | 10/125 [03:55<40:27, 21.11s/epoch, loss=1.22, accuracy=0.726, val_loss=1.94, val_accuracy=0.558, lr=0.1]  9%|▉         | 11/125 [04:15<39:57, 21.03s/epoch, loss=1.21, accuracy=0.731, val_loss=3.78, val_accuracy=0.273, lr=0.1] 10%|▉         | 12/125 [04:36<39:27, 20.95s/epoch, loss=1.2, accuracy=0.733, val_loss=1.8, val_accuracy=0.553, lr=0.1]   10%|█         | 13/125 [04:57<38:57, 20.87s/epoch, loss=1.2, accuracy=0.736, val_loss=2.3, val_accuracy=0.435, lr=0.1] 11%|█         | 14/125 [05:18<38:35, 20.86s/epoch, loss=1.19, accuracy=0.737, val_loss=1.72, val_accuracy=0.553, lr=0.1] 12%|█▏        | 15/125 [05:39<38:12, 20.84s/epoch, loss=1.19, accuracy=0.739, val_loss=2.53, val_accuracy=0.323, lr=0.1] 13%|█▎        | 16/125 [05:59<37:46, 20.79s/epoch, loss=1.18, accuracy=0.741, val_loss=2.1, val_accuracy=0.499, lr=0.1]  14%|█▎        | 17/125 [06:20<37:22, 20.77s/epoch, loss=1.19, accuracy=0.738, val_loss=2.56, val_accuracy=0.355, lr=0.1] 14%|█▍        | 18/125 [06:41<37:03, 20.78s/epoch, loss=1.17, accuracy=0.744, val_loss=3.24, val_accuracy=0.314, lr=0.1] 15%|█▌        | 19/125 [07:02<36:46, 20.82s/epoch, loss=1.18, accuracy=0.74, val_loss=2.47, val_accuracy=0.402, lr=0.1]  16%|█▌        | 20/125 [07:23<36:29, 20.85s/epoch, loss=1.17, accuracy=0.745, val_loss=1.97, val_accuracy=0.468, lr=0.1] 17%|█▋        | 21/125 [07:43<36:10, 20.87s/epoch, loss=1.17, accuracy=0.745, val_loss=1.97, val_accuracy=0.446, lr=0.1] 18%|█▊        | 22/125 [08:04<35:51, 20.89s/epoch, loss=1.17, accuracy=0.743, val_loss=1.68, val_accuracy=0.561, lr=0.1] 18%|█▊        | 23/125 [08:26<35:50, 21.08s/epoch, loss=1.17, accuracy=0.746, val_loss=2.04, val_accuracy=0.528, lr=0.1] 19%|█▉        | 24/125 [08:47<35:27, 21.07s/epoch, loss=1.16, accuracy=0.744, val_loss=2.18, val_accuracy=0.414, lr=0.1] 20%|██        | 25/125 [09:08<35:02, 21.02s/epoch, loss=1.16, accuracy=0.745, val_loss=1.36, val_accuracy=0.682, lr=0.1] 21%|██        | 26/125 [09:29<34:34, 20.96s/epoch, loss=1.16, accuracy=0.744, val_loss=1.33, val_accuracy=0.68, lr=0.1]  22%|██▏       | 27/125 [09:49<34:07, 20.90s/epoch, loss=1.16, accuracy=0.746, val_loss=1.53, val_accuracy=0.629, lr=0.1] 22%|██▏       | 28/125 [10:10<33:43, 20.86s/epoch, loss=1.16, accuracy=0.749, val_loss=1.62, val_accuracy=0.596, lr=0.1] 23%|██▎       | 29/125 [10:31<33:20, 20.83s/epoch, loss=1.16, accuracy=0.748, val_loss=1.56, val_accuracy=0.606, lr=0.1] 24%|██▍       | 30/125 [10:52<32:55, 20.79s/epoch, loss=1.16, accuracy=0.749, val_loss=2, val_accuracy=0.529, lr=0.1]    25%|██▍       | 31/125 [11:13<32:35, 20.81s/epoch, loss=1.15, accuracy=0.751, val_loss=2.37, val_accuracy=0.441, lr=0.1] 26%|██▌       | 32/125 [11:33<32:14, 20.80s/epoch, loss=1.15, accuracy=0.751, val_loss=2.69, val_accuracy=0.392, lr=0.1] 26%|██▋       | 33/125 [11:54<31:51, 20.77s/epoch, loss=1.16, accuracy=0.75, val_loss=1.57, val_accuracy=0.601, lr=0.1]  27%|██▋       | 34/125 [12:15<31:29, 20.77s/epoch, loss=1.15, accuracy=0.751, val_loss=2.92, val_accuracy=0.5, lr=0.1]  28%|██▊       | 35/125 [12:36<31:09, 20.78s/epoch, loss=1.15, accuracy=0.752, val_loss=2.81, val_accuracy=0.34, lr=0.1] 29%|██▉       | 36/125 [12:56<30:49, 20.78s/epoch, loss=1.15, accuracy=0.751, val_loss=3.39, val_accuracy=0.315, lr=0.1] 30%|██▉       | 37/125 [13:17<30:26, 20.75s/epoch, loss=1.16, accuracy=0.749, val_loss=2.19, val_accuracy=0.432, lr=0.1] 30%|███       | 38/125 [13:38<30:03, 20.73s/epoch, loss=1.15, accuracy=0.748, val_loss=2.85, val_accuracy=0.275, lr=0.1] 31%|███       | 39/125 [13:58<29:41, 20.72s/epoch, loss=1.14, accuracy=0.754, val_loss=2.79, val_accuracy=0.37, lr=0.1]  32%|███▏      | 40/125 [14:19<29:21, 20.72s/epoch, loss=1.14, accuracy=0.75, val_loss=2.41, val_accuracy=0.437, lr=0.1] 33%|███▎      | 41/125 [14:40<29:00, 20.72s/epoch, loss=1.14, accuracy=0.753, val_loss=2.37, val_accuracy=0.365, lr=0.1] 34%|███▎      | 42/125 [15:01<28:41, 20.74s/epoch, loss=1.14, accuracy=0.752, val_loss=3.64, val_accuracy=0.178, lr=0.1] 34%|███▍      | 43/125 [15:21<28:22, 20.76s/epoch, loss=1.14, accuracy=0.753, val_loss=1.98, val_accuracy=0.543, lr=0.1] 35%|███▌      | 44/125 [15:42<28:02, 20.77s/epoch, loss=1.13, accuracy=0.754, val_loss=1.69, val_accuracy=0.574, lr=0.1] 36%|███▌      | 45/125 [16:03<27:41, 20.77s/epoch, loss=1.13, accuracy=0.757, val_loss=1.69, val_accuracy=0.548, lr=0.1] 37%|███▋      | 46/125 [16:24<27:22, 20.79s/epoch, loss=1.13, accuracy=0.754, val_loss=1.69, val_accuracy=0.555, lr=0.1] 38%|███▊      | 47/125 [16:45<27:04, 20.83s/epoch, loss=1.13, accuracy=0.756, val_loss=3.55, val_accuracy=0.337, lr=0.1] 38%|███▊      | 48/125 [17:06<26:43, 20.82s/epoch, loss=1.13, accuracy=0.756, val_loss=2.17, val_accuracy=0.463, lr=0.1] 39%|███▉      | 49/125 [17:26<26:20, 20.80s/epoch, loss=1.13, accuracy=0.755, val_loss=1.72, val_accuracy=0.583, lr=0.1] 40%|████      | 50/125 [17:47<25:59, 20.79s/epoch, loss=1.13, accuracy=0.756, val_loss=1.85, val_accuracy=0.568, lr=0.1] 41%|████      | 51/125 [18:08<25:37, 20.77s/epoch, loss=1.13, accuracy=0.756, val_loss=1.91, val_accuracy=0.484, lr=0.1] 42%|████▏     | 52/125 [18:29<25:14, 20.75s/epoch, loss=0.918, accuracy=0.815, val_loss=0.909, val_accuracy=0.806, lr=0.01] 42%|████▏     | 53/125 [18:49<24:57, 20.80s/epoch, loss=0.738, accuracy=0.848, val_loss=0.882, val_accuracy=0.787, lr=0.01] 43%|████▎     | 54/125 [19:10<24:38, 20.83s/epoch, loss=0.652, accuracy=0.859, val_loss=0.757, val_accuracy=0.816, lr=0.01] 44%|████▍     | 55/125 [19:31<24:15, 20.79s/epoch, loss=0.615, accuracy=0.86, val_loss=0.895, val_accuracy=0.759, lr=0.01]  45%|████▍     | 56/125 [19:52<23:55, 20.81s/epoch, loss=0.592, accuracy=0.859, val_loss=0.936, val_accuracy=0.74, lr=0.01] 46%|████▌     | 57/125 [20:13<23:36, 20.83s/epoch, loss=0.578, accuracy=0.863, val_loss=0.738, val_accuracy=0.805, lr=0.01] 46%|████▋     | 58/125 [20:34<23:14, 20.81s/epoch, loss=0.571, accuracy=0.864, val_loss=0.938, val_accuracy=0.759, lr=0.01] 47%|████▋     | 59/125 [20:54<22:53, 20.81s/epoch, loss=0.568, accuracy=0.866, val_loss=1.18, val_accuracy=0.684, lr=0.01]  48%|████▊     | 60/125 [21:15<22:33, 20.82s/epoch, loss=0.565, accuracy=0.867, val_loss=0.809, val_accuracy=0.785, lr=0.01] 49%|████▉     | 61/125 [21:36<22:11, 20.80s/epoch, loss=0.563, accuracy=0.869, val_loss=0.902, val_accuracy=0.765, lr=0.01] 50%|████▉     | 62/125 [21:57<21:49, 20.78s/epoch, loss=0.564, accuracy=0.868, val_loss=0.791, val_accuracy=0.803, lr=0.01] 50%|█████     | 63/125 [22:17<21:27, 20.77s/epoch, loss=0.565, accuracy=0.87, val_loss=0.817, val_accuracy=0.789, lr=0.01]  51%|█████     | 64/125 [22:38<21:05, 20.74s/epoch, loss=0.564, accuracy=0.87, val_loss=0.76, val_accuracy=0.81, lr=0.01]   52%|█████▏    | 65/125 [22:59<20:43, 20.73s/epoch, loss=0.567, accuracy=0.872, val_loss=0.766, val_accuracy=0.813, lr=0.01] 53%|█████▎    | 66/125 [23:19<20:22, 20.72s/epoch, loss=0.563, accuracy=0.873, val_loss=0.834, val_accuracy=0.799, lr=0.01] 54%|█████▎    | 67/125 [23:40<20:01, 20.72s/epoch, loss=0.563, accuracy=0.874, val_loss=1.46, val_accuracy=0.64, lr=0.01]   54%|█████▍    | 68/125 [24:01<19:41, 20.73s/epoch, loss=0.557, accuracy=0.878, val_loss=0.905, val_accuracy=0.755, lr=0.01] 55%|█████▌    | 69/125 [24:22<19:19, 20.70s/epoch, loss=0.558, accuracy=0.876, val_loss=0.901, val_accuracy=0.772, lr=0.01] 56%|█████▌    | 70/125 [24:42<18:58, 20.71s/epoch, loss=0.558, accuracy=0.878, val_loss=0.85, val_accuracy=0.793, lr=0.01]  57%|█████▋    | 71/125 [25:03<18:38, 20.71s/epoch, loss=0.559, accuracy=0.878, val_loss=0.723, val_accuracy=0.826, lr=0.01] 58%|█████▊    | 72/125 [25:24<18:19, 20.74s/epoch, loss=0.56, accuracy=0.879, val_loss=0.929, val_accuracy=0.765, lr=0.01]  58%|█████▊    | 73/125 [25:45<17:59, 20.76s/epoch, loss=0.556, accuracy=0.88, val_loss=0.871, val_accuracy=0.785, lr=0.01] 59%|█████▉    | 74/125 [26:06<17:41, 20.81s/epoch, loss=0.559, accuracy=0.879, val_loss=0.817, val_accuracy=0.801, lr=0.01] 60%|██████    | 75/125 [26:26<17:20, 20.81s/epoch, loss=0.556, accuracy=0.881, val_loss=0.77, val_accuracy=0.816, lr=0.01]  61%|██████    | 76/125 [26:47<17:00, 20.82s/epoch, loss=0.558, accuracy=0.882, val_loss=0.881, val_accuracy=0.774, lr=0.01] 62%|██████▏   | 77/125 [27:08<16:39, 20.83s/epoch, loss=0.479, accuracy=0.909, val_loss=0.536, val_accuracy=0.887, lr=0.001] 62%|██████▏   | 78/125 [27:29<16:18, 20.83s/epoch, loss=0.428, accuracy=0.925, val_loss=0.51, val_accuracy=0.895, lr=0.001]  63%|██████▎   | 79/125 [27:50<15:57, 20.81s/epoch, loss=0.406, accuracy=0.931, val_loss=0.506, val_accuracy=0.896, lr=0.001] 64%|██████▍   | 80/125 [28:11<15:36, 20.82s/epoch, loss=0.389, accuracy=0.935, val_loss=0.492, val_accuracy=0.899, lr=0.001] 65%|██████▍   | 81/125 [28:31<15:14, 20.79s/epoch, loss=0.376, accuracy=0.937, val_loss=0.491, val_accuracy=0.898, lr=0.001] 66%|██████▌   | 82/125 [28:52<14:53, 20.78s/epoch, loss=0.364, accuracy=0.94, val_loss=0.492, val_accuracy=0.895, lr=0.001]  66%|██████▋   | 83/125 [29:13<14:32, 20.77s/epoch, loss=0.353, accuracy=0.941, val_loss=0.484, val_accuracy=0.897, lr=0.001] 67%|██████▋   | 84/125 [29:34<14:12, 20.78s/epoch, loss=0.34, accuracy=0.944, val_loss=0.477, val_accuracy=0.9, lr=0.001]    68%|██████▊   | 85/125 [29:54<13:49, 20.73s/epoch, loss=0.331, accuracy=0.945, val_loss=0.479, val_accuracy=0.899, lr=0.001] 69%|██████▉   | 86/125 [30:15<13:28, 20.73s/epoch, loss=0.323, accuracy=0.947, val_loss=0.473, val_accuracy=0.899, lr=0.001] 70%|██████▉   | 87/125 [30:36<13:06, 20.70s/epoch, loss=0.316, accuracy=0.949, val_loss=0.467, val_accuracy=0.898, lr=0.001] 70%|███████   | 88/125 [30:56<12:45, 20.68s/epoch, loss=0.307, accuracy=0.95, val_loss=0.499, val_accuracy=0.888, lr=0.001]  71%|███████   | 89/125 [31:17<12:24, 20.69s/epoch, loss=0.298, accuracy=0.952, val_loss=0.489, val_accuracy=0.893, lr=0.001] 72%|███████▏  | 90/125 [31:38<12:03, 20.68s/epoch, loss=0.294, accuracy=0.951, val_loss=0.484, val_accuracy=0.891, lr=0.001] 73%|███████▎  | 91/125 [31:58<11:44, 20.71s/epoch, loss=0.285, accuracy=0.955, val_loss=0.465, val_accuracy=0.898, lr=0.001] 74%|███████▎  | 92/125 [32:19<11:23, 20.70s/epoch, loss=0.28, accuracy=0.954, val_loss=0.46, val_accuracy=0.896, lr=0.001]   74%|███████▍  | 93/125 [32:40<11:01, 20.67s/epoch, loss=0.276, accuracy=0.956, val_loss=0.466, val_accuracy=0.896, lr=0.001] 75%|███████▌  | 94/125 [33:00<10:41, 20.68s/epoch, loss=0.274, accuracy=0.954, val_loss=0.489, val_accuracy=0.887, lr=0.001] 76%|███████▌  | 95/125 [33:21<10:19, 20.66s/epoch, loss=0.265, accuracy=0.957, val_loss=0.473, val_accuracy=0.89, lr=0.001]  77%|███████▋  | 96/125 [33:42<09:58, 20.65s/epoch, loss=0.258, accuracy=0.958, val_loss=0.478, val_accuracy=0.891, lr=0.001] 78%|███████▊  | 97/125 [34:02<09:38, 20.65s/epoch, loss=0.258, accuracy=0.957, val_loss=0.465, val_accuracy=0.894, lr=0.001] 78%|███████▊  | 98/125 [34:23<09:18, 20.69s/epoch, loss=0.254, accuracy=0.958, val_loss=0.495, val_accuracy=0.888, lr=0.001] 79%|███████▉  | 99/125 [34:44<08:58, 20.73s/epoch, loss=0.251, accuracy=0.958, val_loss=0.484, val_accuracy=0.886, lr=0.001] 80%|████████  | 100/125 [35:05<08:38, 20.76s/epoch, loss=0.246, accuracy=0.959, val_loss=0.471, val_accuracy=0.888, lr=0.001] 81%|████████  | 101/125 [35:25<08:18, 20.78s/epoch, loss=0.245, accuracy=0.957, val_loss=0.492, val_accuracy=0.885, lr=0.001] 82%|████████▏ | 102/125 [35:46<07:57, 20.76s/epoch, loss=0.226, accuracy=0.966, val_loss=0.422, val_accuracy=0.904, lr=1e-04] 82%|████████▏ | 103/125 [36:07<07:36, 20.76s/epoch, loss=0.214, accuracy=0.971, val_loss=0.419, val_accuracy=0.905, lr=1e-04] 83%|████████▎ | 104/125 [36:28<07:15, 20.76s/epoch, loss=0.212, accuracy=0.971, val_loss=0.421, val_accuracy=0.906, lr=1e-04] 84%|████████▍ | 105/125 [36:48<06:54, 20.72s/epoch, loss=0.208, accuracy=0.973, val_loss=0.421, val_accuracy=0.907, lr=1e-04] 85%|████████▍ | 106/125 [37:09<06:33, 20.71s/epoch, loss=0.206, accuracy=0.973, val_loss=0.419, val_accuracy=0.906, lr=1e-04] 86%|████████▌ | 107/125 [37:30<06:11, 20.66s/epoch, loss=0.203, accuracy=0.974, val_loss=0.421, val_accuracy=0.905, lr=1e-04] 86%|████████▋ | 108/125 [37:50<05:50, 20.62s/epoch, loss=0.201, accuracy=0.975, val_loss=0.421, val_accuracy=0.907, lr=1e-04] 87%|████████▋ | 109/125 [38:11<05:29, 20.62s/epoch, loss=0.201, accuracy=0.975, val_loss=0.421, val_accuracy=0.905, lr=1e-04] 88%|████████▊ | 110/125 [38:31<05:08, 20.60s/epoch, loss=0.199, accuracy=0.975, val_loss=0.423, val_accuracy=0.906, lr=1e-04] 89%|████████▉ | 111/125 [38:52<04:48, 20.62s/epoch, loss=0.195, accuracy=0.977, val_loss=0.422, val_accuracy=0.906, lr=1e-04] 90%|████████▉ | 112/125 [39:13<04:28, 20.64s/epoch, loss=0.195, accuracy=0.976, val_loss=0.422, val_accuracy=0.907, lr=1e-04] 90%|█████████ | 113/125 [39:33<04:07, 20.63s/epoch, loss=0.195, accuracy=0.977, val_loss=0.424, val_accuracy=0.904, lr=1e-04] 91%|█████████ | 114/125 [39:54<03:46, 20.63s/epoch, loss=0.194, accuracy=0.977, val_loss=0.423, val_accuracy=0.905, lr=5e-5]  92%|█████████▏| 115/125 [40:14<03:26, 20.63s/epoch, loss=0.192, accuracy=0.977, val_loss=0.422, val_accuracy=0.905, lr=5e-5] 93%|█████████▎| 116/125 [40:35<03:05, 20.65s/epoch, loss=0.193, accuracy=0.978, val_loss=0.42, val_accuracy=0.904, lr=5e-5]  94%|█████████▎| 117/125 [40:56<02:44, 20.62s/epoch, loss=0.193, accuracy=0.977, val_loss=0.423, val_accuracy=0.905, lr=5e-5] 94%|█████████▍| 118/125 [41:16<02:24, 20.63s/epoch, loss=0.189, accuracy=0.978, val_loss=0.423, val_accuracy=0.905, lr=5e-5] 95%|█████████▌| 119/125 [41:37<02:03, 20.63s/epoch, loss=0.19, accuracy=0.978, val_loss=0.424, val_accuracy=0.905, lr=5e-5]  96%|█████████▌| 120/125 [41:58<01:43, 20.65s/epoch, loss=0.188, accuracy=0.979, val_loss=0.422, val_accuracy=0.905, lr=5e-5] 97%|█████████▋| 121/125 [42:18<01:22, 20.67s/epoch, loss=0.188, accuracy=0.979, val_loss=0.422, val_accuracy=0.905, lr=5e-5] 98%|█████████▊| 122/125 [42:39<01:02, 20.71s/epoch, loss=0.189, accuracy=0.979, val_loss=0.422, val_accuracy=0.904, lr=5e-5] 98%|█████████▊| 123/125 [43:00<00:41, 20.72s/epoch, loss=0.189, accuracy=0.978, val_loss=0.424, val_accuracy=0.904, lr=5e-5] 99%|█████████▉| 124/125 [43:21<00:20, 20.74s/epoch, loss=0.187, accuracy=0.979, val_loss=0.423, val_accuracy=0.905, lr=5e-5]100%|██████████| 125/125 [43:41<00:00, 20.74s/epoch, loss=0.187, accuracy=0.978, val_loss=0.423, val_accuracy=0.904, lr=5e-5]100%|██████████| 125/125 [43:41<00:00, 20.98s/epoch, loss=0.187, accuracy=0.978, val_loss=0.423, val_accuracy=0.904, lr=5e-5]
Using real-time data augmentation.
Only one model saved

Loading model: 12_01_cifar10_ResNet20v1.h5
Test score: 0.4233674705028534
Test accuracy: 0.9035000205039978


* * * Run SGD for ID = 12_2. * * *


2024-03-13 02:56:50.255128: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 02:56:52.884697: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 02:56:52.885693: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-13 02:56:52.925298: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-13 02:56:52.925334: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 02:56:52.928414: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 02:56:52.928458: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 02:56:52.930669: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 02:56:52.932490: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 02:56:52.935486: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 02:56:52.937101: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 02:56:52.942636: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 02:56:52.943180: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 02:56:52.943258: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 02:56:54.258920: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-13 02:56:54.259850: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 02:56:54.260633: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-13 02:56:54.260666: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 02:56:54.260712: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 02:56:54.260731: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 02:56:54.260749: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 02:56:54.260766: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 02:56:54.260785: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 02:56:54.260804: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 02:56:54.260824: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 02:56:54.261300: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 02:56:54.261335: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 02:56:54.955122: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-13 02:56:54.955174: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-13 02:56:54.955184: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-13 02:56:54.956091: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:83:00.0, compute capability: 6.1)
{'id': '12_02', 'seed': 2, 'out_folder': 'results/epoch_budget_2', 'batch_size': 128, 'epochs': 125, 'validation_split': 0.0, 'checkpointing': False, 'checkpoint_every': -1, 'hold_out_validation_split': 0.0, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'num_classes': 10, 'SSE_lr': False, 'test_time_augmentation': False, 'debug': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
y_train shape: (50000, 10)
x_val shape: (10000, 32, 32, 3)
y_val shape: (10000, 10)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/125 [00:00<?, ?epoch/s]2024-03-13 02:56:55.616612: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-13 02:56:55.628965: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199945000 Hz
2024-03-13 02:56:57.808405: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 02:56:57.996491: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 02:57:04.141906: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-13 02:57:04.236293: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/125 [00:57<1:58:31, 57.35s/epoch, loss=2.77, accuracy=0.414, val_loss=2.29, val_accuracy=0.28, lr=0.1]  2%|▏         | 2/125 [01:18<1:13:28, 35.84s/epoch, loss=1.45, accuracy=0.602, val_loss=1.58, val_accuracy=0.562, lr=0.1]  2%|▏         | 3/125 [01:38<58:45, 28.90s/epoch, loss=1.29, accuracy=0.672, val_loss=1.87, val_accuracy=0.535, lr=0.1]    3%|▎         | 4/125 [01:59<51:39, 25.61s/epoch, loss=1.24, accuracy=0.695, val_loss=2.18, val_accuracy=0.456, lr=0.1]  4%|▍         | 5/125 [02:20<47:39, 23.83s/epoch, loss=1.23, accuracy=0.71, val_loss=1.67, val_accuracy=0.58, lr=0.1]    5%|▍         | 6/125 [02:40<45:11, 22.78s/epoch, loss=1.2, accuracy=0.72, val_loss=1.59, val_accuracy=0.585, lr=0.1]  6%|▌         | 7/125 [03:01<43:24, 22.07s/epoch, loss=1.2, accuracy=0.723, val_loss=2.46, val_accuracy=0.449, lr=0.1]  6%|▋         | 8/125 [03:21<42:06, 21.60s/epoch, loss=1.19, accuracy=0.728, val_loss=2.35, val_accuracy=0.463, lr=0.1]  7%|▋         | 9/125 [03:42<41:12, 21.32s/epoch, loss=1.18, accuracy=0.733, val_loss=1.69, val_accuracy=0.542, lr=0.1]  8%|▊         | 10/125 [04:03<40:22, 21.06s/epoch, loss=1.17, accuracy=0.738, val_loss=1.56, val_accuracy=0.613, lr=0.1]  9%|▉         | 11/125 [04:23<39:45, 20.92s/epoch, loss=1.17, accuracy=0.74, val_loss=1.89, val_accuracy=0.528, lr=0.1]  10%|▉         | 12/125 [04:44<39:18, 20.87s/epoch, loss=1.17, accuracy=0.737, val_loss=1.79, val_accuracy=0.518, lr=0.1] 10%|█         | 13/125 [05:05<38:53, 20.84s/epoch, loss=1.16, accuracy=0.74, val_loss=1.62, val_accuracy=0.612, lr=0.1]  11%|█         | 14/125 [05:25<38:27, 20.79s/epoch, loss=1.15, accuracy=0.745, val_loss=1.54, val_accuracy=0.62, lr=0.1] 12%|█▏        | 15/125 [05:46<38:03, 20.75s/epoch, loss=1.15, accuracy=0.745, val_loss=1.85, val_accuracy=0.498, lr=0.1] 13%|█▎        | 16/125 [06:07<37:31, 20.66s/epoch, loss=1.14, accuracy=0.746, val_loss=1.59, val_accuracy=0.606, lr=0.1] 14%|█▎        | 17/125 [06:27<37:04, 20.59s/epoch, loss=1.14, accuracy=0.748, val_loss=5.01, val_accuracy=0.247, lr=0.1] 14%|█▍        | 18/125 [06:48<36:41, 20.58s/epoch, loss=1.14, accuracy=0.748, val_loss=2.6, val_accuracy=0.44, lr=0.1]   15%|█▌        | 19/125 [07:08<36:21, 20.58s/epoch, loss=1.14, accuracy=0.751, val_loss=1.6, val_accuracy=0.602, lr=0.1] 16%|█▌        | 20/125 [07:29<35:58, 20.56s/epoch, loss=1.14, accuracy=0.75, val_loss=1.38, val_accuracy=0.652, lr=0.1] 17%|█▋        | 21/125 [07:49<35:40, 20.58s/epoch, loss=1.13, accuracy=0.75, val_loss=2.62, val_accuracy=0.449, lr=0.1] 18%|█▊        | 22/125 [08:10<35:19, 20.58s/epoch, loss=1.14, accuracy=0.75, val_loss=2.12, val_accuracy=0.506, lr=0.1] 18%|█▊        | 23/125 [08:30<35:01, 20.60s/epoch, loss=1.13, accuracy=0.75, val_loss=1.75, val_accuracy=0.55, lr=0.1]  19%|█▉        | 24/125 [08:51<34:39, 20.59s/epoch, loss=1.13, accuracy=0.751, val_loss=3.7, val_accuracy=0.329, lr=0.1] 20%|██        | 25/125 [09:12<34:19, 20.59s/epoch, loss=1.13, accuracy=0.752, val_loss=2.5, val_accuracy=0.342, lr=0.1] 21%|██        | 26/125 [09:32<33:56, 20.57s/epoch, loss=1.13, accuracy=0.751, val_loss=2.35, val_accuracy=0.458, lr=0.1] 22%|██▏       | 27/125 [09:53<33:34, 20.55s/epoch, loss=1.13, accuracy=0.753, val_loss=1.81, val_accuracy=0.551, lr=0.1] 22%|██▏       | 28/125 [10:13<33:10, 20.52s/epoch, loss=1.13, accuracy=0.751, val_loss=1.78, val_accuracy=0.549, lr=0.1] 23%|██▎       | 29/125 [10:34<32:48, 20.51s/epoch, loss=1.12, accuracy=0.754, val_loss=2.42, val_accuracy=0.442, lr=0.1] 24%|██▍       | 30/125 [10:54<32:25, 20.48s/epoch, loss=1.12, accuracy=0.755, val_loss=3.29, val_accuracy=0.312, lr=0.1] 25%|██▍       | 31/125 [11:14<32:02, 20.46s/epoch, loss=1.12, accuracy=0.755, val_loss=2.08, val_accuracy=0.528, lr=0.1] 26%|██▌       | 32/125 [11:35<31:41, 20.44s/epoch, loss=1.12, accuracy=0.755, val_loss=1.99, val_accuracy=0.505, lr=0.1] 26%|██▋       | 33/125 [11:55<31:21, 20.45s/epoch, loss=1.12, accuracy=0.757, val_loss=1.7, val_accuracy=0.599, lr=0.1]  27%|██▋       | 34/125 [12:16<31:00, 20.44s/epoch, loss=1.11, accuracy=0.756, val_loss=1.38, val_accuracy=0.666, lr=0.1] 28%|██▊       | 35/125 [12:36<30:39, 20.44s/epoch, loss=1.11, accuracy=0.757, val_loss=1.6, val_accuracy=0.598, lr=0.1]  29%|██▉       | 36/125 [12:57<30:19, 20.44s/epoch, loss=1.12, accuracy=0.752, val_loss=2.28, val_accuracy=0.536, lr=0.1] 30%|██▉       | 37/125 [13:17<30:01, 20.47s/epoch, loss=1.11, accuracy=0.756, val_loss=2.54, val_accuracy=0.419, lr=0.1] 30%|███       | 38/125 [13:38<29:40, 20.47s/epoch, loss=1.12, accuracy=0.753, val_loss=2.69, val_accuracy=0.439, lr=0.1] 31%|███       | 39/125 [13:58<29:18, 20.45s/epoch, loss=1.11, accuracy=0.753, val_loss=2.03, val_accuracy=0.473, lr=0.1] 32%|███▏      | 40/125 [14:18<28:58, 20.46s/epoch, loss=1.12, accuracy=0.755, val_loss=4.28, val_accuracy=0.294, lr=0.1] 33%|███▎      | 41/125 [14:39<28:37, 20.45s/epoch, loss=1.1, accuracy=0.759, val_loss=2.01, val_accuracy=0.565, lr=0.1]  34%|███▎      | 42/125 [14:59<28:17, 20.45s/epoch, loss=1.11, accuracy=0.758, val_loss=1.76, val_accuracy=0.604, lr=0.1] 34%|███▍      | 43/125 [15:20<27:59, 20.48s/epoch, loss=1.11, accuracy=0.759, val_loss=1.65, val_accuracy=0.572, lr=0.1] 35%|███▌      | 44/125 [15:40<27:41, 20.51s/epoch, loss=1.11, accuracy=0.758, val_loss=2.48, val_accuracy=0.417, lr=0.1] 36%|███▌      | 45/125 [16:01<27:22, 20.53s/epoch, loss=1.12, accuracy=0.755, val_loss=1.65, val_accuracy=0.584, lr=0.1] 37%|███▋      | 46/125 [16:22<27:02, 20.54s/epoch, loss=1.11, accuracy=0.756, val_loss=2.3, val_accuracy=0.524, lr=0.1]  38%|███▊      | 47/125 [16:42<26:42, 20.54s/epoch, loss=1.11, accuracy=0.758, val_loss=1.94, val_accuracy=0.552, lr=0.1] 38%|███▊      | 48/125 [17:03<26:20, 20.53s/epoch, loss=1.11, accuracy=0.758, val_loss=3.6, val_accuracy=0.248, lr=0.1]  39%|███▉      | 49/125 [17:23<25:58, 20.50s/epoch, loss=1.11, accuracy=0.759, val_loss=1.72, val_accuracy=0.567, lr=0.1] 40%|████      | 50/125 [17:44<25:37, 20.50s/epoch, loss=1.11, accuracy=0.759, val_loss=3.23, val_accuracy=0.344, lr=0.1] 41%|████      | 51/125 [18:04<25:16, 20.50s/epoch, loss=1.11, accuracy=0.759, val_loss=1.79, val_accuracy=0.569, lr=0.1] 42%|████▏     | 52/125 [18:24<24:53, 20.45s/epoch, loss=0.905, accuracy=0.817, val_loss=0.906, val_accuracy=0.799, lr=0.01] 42%|████▏     | 53/125 [18:45<24:35, 20.49s/epoch, loss=0.726, accuracy=0.848, val_loss=0.835, val_accuracy=0.798, lr=0.01] 43%|████▎     | 54/125 [19:06<24:17, 20.53s/epoch, loss=0.648, accuracy=0.857, val_loss=0.763, val_accuracy=0.807, lr=0.01] 44%|████▍     | 55/125 [19:26<23:59, 20.56s/epoch, loss=0.604, accuracy=0.86, val_loss=0.799, val_accuracy=0.794, lr=0.01]  45%|████▍     | 56/125 [19:47<23:38, 20.55s/epoch, loss=0.583, accuracy=0.863, val_loss=0.846, val_accuracy=0.767, lr=0.01] 46%|████▌     | 57/125 [20:07<23:16, 20.54s/epoch, loss=0.569, accuracy=0.863, val_loss=0.745, val_accuracy=0.808, lr=0.01] 46%|████▋     | 58/125 [20:28<22:56, 20.55s/epoch, loss=0.566, accuracy=0.865, val_loss=0.804, val_accuracy=0.787, lr=0.01] 47%|████▋     | 59/125 [20:48<22:35, 20.54s/epoch, loss=0.56, accuracy=0.866, val_loss=0.78, val_accuracy=0.788, lr=0.01]   48%|████▊     | 60/125 [21:09<22:16, 20.56s/epoch, loss=0.559, accuracy=0.866, val_loss=0.966, val_accuracy=0.754, lr=0.01] 49%|████▉     | 61/125 [21:29<21:53, 20.53s/epoch, loss=0.556, accuracy=0.87, val_loss=0.788, val_accuracy=0.794, lr=0.01]  50%|████▉     | 62/125 [21:50<21:31, 20.50s/epoch, loss=0.558, accuracy=0.872, val_loss=0.789, val_accuracy=0.789, lr=0.01] 50%|█████     | 63/125 [22:10<21:11, 20.51s/epoch, loss=0.56, accuracy=0.87, val_loss=0.892, val_accuracy=0.774, lr=0.01]   51%|█████     | 64/125 [22:31<20:51, 20.52s/epoch, loss=0.555, accuracy=0.873, val_loss=0.756, val_accuracy=0.807, lr=0.01] 52%|█████▏    | 65/125 [22:51<20:29, 20.49s/epoch, loss=0.556, accuracy=0.874, val_loss=0.761, val_accuracy=0.807, lr=0.01] 53%|█████▎    | 66/125 [23:12<20:08, 20.49s/epoch, loss=0.555, accuracy=0.874, val_loss=1.34, val_accuracy=0.685, lr=0.01]  54%|█████▎    | 67/125 [23:32<19:48, 20.48s/epoch, loss=0.555, accuracy=0.874, val_loss=0.898, val_accuracy=0.763, lr=0.01] 54%|█████▍    | 68/125 [23:53<19:28, 20.50s/epoch, loss=0.552, accuracy=0.878, val_loss=0.817, val_accuracy=0.786, lr=0.01] 55%|█████▌    | 69/125 [24:13<19:06, 20.48s/epoch, loss=0.55, accuracy=0.878, val_loss=0.751, val_accuracy=0.813, lr=0.01]  56%|█████▌    | 70/125 [24:34<18:48, 20.51s/epoch, loss=0.554, accuracy=0.877, val_loss=0.916, val_accuracy=0.765, lr=0.01] 57%|█████▋    | 71/125 [24:54<18:27, 20.51s/epoch, loss=0.552, accuracy=0.88, val_loss=0.79, val_accuracy=0.804, lr=0.01]   58%|█████▊    | 72/125 [25:15<18:07, 20.51s/epoch, loss=0.552, accuracy=0.879, val_loss=1.06, val_accuracy=0.74, lr=0.01] 58%|█████▊    | 73/125 [25:35<17:45, 20.49s/epoch, loss=0.554, accuracy=0.878, val_loss=0.788, val_accuracy=0.804, lr=0.01] 59%|█████▉    | 74/125 [25:56<17:26, 20.51s/epoch, loss=0.555, accuracy=0.879, val_loss=1.11, val_accuracy=0.725, lr=0.01]  60%|██████    | 75/125 [26:17<17:07, 20.54s/epoch, loss=0.549, accuracy=0.88, val_loss=0.683, val_accuracy=0.837, lr=0.01] 61%|██████    | 76/125 [26:37<16:47, 20.56s/epoch, loss=0.552, accuracy=0.88, val_loss=1.3, val_accuracy=0.673, lr=0.01]   62%|██████▏   | 77/125 [26:58<16:26, 20.55s/epoch, loss=0.472, accuracy=0.908, val_loss=0.533, val_accuracy=0.886, lr=0.001] 62%|██████▏   | 78/125 [27:18<16:06, 20.57s/epoch, loss=0.419, accuracy=0.925, val_loss=0.537, val_accuracy=0.887, lr=0.001] 63%|██████▎   | 79/125 [27:39<15:44, 20.53s/epoch, loss=0.399, accuracy=0.93, val_loss=0.512, val_accuracy=0.89, lr=0.001]   64%|██████▍   | 80/125 [27:59<15:24, 20.55s/epoch, loss=0.383, accuracy=0.933, val_loss=0.505, val_accuracy=0.893, lr=0.001] 65%|██████▍   | 81/125 [28:20<15:02, 20.51s/epoch, loss=0.371, accuracy=0.937, val_loss=0.498, val_accuracy=0.895, lr=0.001] 66%|██████▌   | 82/125 [28:40<14:42, 20.53s/epoch, loss=0.357, accuracy=0.938, val_loss=0.508, val_accuracy=0.89, lr=0.001]  66%|██████▋   | 83/125 [29:01<14:21, 20.50s/epoch, loss=0.348, accuracy=0.94, val_loss=0.494, val_accuracy=0.896, lr=0.001] 67%|██████▋   | 84/125 [29:21<13:59, 20.48s/epoch, loss=0.34, accuracy=0.941, val_loss=0.51, val_accuracy=0.887, lr=0.001]  68%|██████▊   | 85/125 [29:42<13:38, 20.46s/epoch, loss=0.33, accuracy=0.943, val_loss=0.481, val_accuracy=0.895, lr=0.001] 69%|██████▉   | 86/125 [30:02<13:17, 20.45s/epoch, loss=0.318, accuracy=0.946, val_loss=0.476, val_accuracy=0.894, lr=0.001] 70%|██████▉   | 87/125 [30:22<12:55, 20.41s/epoch, loss=0.314, accuracy=0.947, val_loss=0.473, val_accuracy=0.894, lr=0.001] 70%|███████   | 88/125 [30:43<12:35, 20.41s/epoch, loss=0.303, accuracy=0.949, val_loss=0.539, val_accuracy=0.88, lr=0.001]  71%|███████   | 89/125 [31:03<12:14, 20.41s/epoch, loss=0.299, accuracy=0.949, val_loss=0.485, val_accuracy=0.894, lr=0.001] 72%|███████▏  | 90/125 [31:24<11:54, 20.43s/epoch, loss=0.294, accuracy=0.949, val_loss=0.517, val_accuracy=0.887, lr=0.001] 73%|███████▎  | 91/125 [31:44<11:34, 20.41s/epoch, loss=0.289, accuracy=0.949, val_loss=0.503, val_accuracy=0.886, lr=0.001] 74%|███████▎  | 92/125 [32:04<11:13, 20.42s/epoch, loss=0.279, accuracy=0.953, val_loss=0.469, val_accuracy=0.895, lr=0.001] 74%|███████▍  | 93/125 [32:25<10:52, 20.40s/epoch, loss=0.275, accuracy=0.952, val_loss=0.479, val_accuracy=0.893, lr=0.001] 75%|███████▌  | 94/125 [32:45<10:32, 20.40s/epoch, loss=0.27, accuracy=0.953, val_loss=0.487, val_accuracy=0.892, lr=0.001]  76%|███████▌  | 95/125 [33:06<10:11, 20.38s/epoch, loss=0.264, accuracy=0.954, val_loss=0.477, val_accuracy=0.891, lr=0.001] 77%|███████▋  | 96/125 [33:26<09:50, 20.36s/epoch, loss=0.258, accuracy=0.956, val_loss=0.474, val_accuracy=0.891, lr=0.001] 78%|███████▊  | 97/125 [33:46<09:30, 20.37s/epoch, loss=0.257, accuracy=0.954, val_loss=0.488, val_accuracy=0.887, lr=0.001] 78%|███████▊  | 98/125 [34:07<09:10, 20.39s/epoch, loss=0.254, accuracy=0.955, val_loss=0.489, val_accuracy=0.892, lr=0.001] 79%|███████▉  | 99/125 [34:27<08:50, 20.41s/epoch, loss=0.249, accuracy=0.956, val_loss=0.498, val_accuracy=0.887, lr=0.001] 80%|████████  | 100/125 [34:48<08:30, 20.43s/epoch, loss=0.248, accuracy=0.956, val_loss=0.492, val_accuracy=0.888, lr=0.001] 81%|████████  | 101/125 [35:08<08:10, 20.45s/epoch, loss=0.244, accuracy=0.957, val_loss=0.483, val_accuracy=0.887, lr=0.001] 82%|████████▏ | 102/125 [35:29<07:51, 20.48s/epoch, loss=0.225, accuracy=0.964, val_loss=0.44, val_accuracy=0.898, lr=1e-04]  82%|████████▏ | 103/125 [35:49<07:30, 20.49s/epoch, loss=0.211, accuracy=0.97, val_loss=0.437, val_accuracy=0.901, lr=1e-04] 83%|████████▎ | 104/125 [36:10<07:09, 20.47s/epoch, loss=0.209, accuracy=0.97, val_loss=0.437, val_accuracy=0.899, lr=1e-04] 84%|████████▍ | 105/125 [36:30<06:48, 20.45s/epoch, loss=0.204, accuracy=0.971, val_loss=0.439, val_accuracy=0.9, lr=1e-04]  85%|████████▍ | 106/125 [36:50<06:28, 20.45s/epoch, loss=0.204, accuracy=0.972, val_loss=0.436, val_accuracy=0.901, lr=1e-04] 86%|████████▌ | 107/125 [37:11<06:07, 20.44s/epoch, loss=0.201, accuracy=0.973, val_loss=0.441, val_accuracy=0.899, lr=1e-04] 86%|████████▋ | 108/125 [37:31<05:47, 20.43s/epoch, loss=0.201, accuracy=0.972, val_loss=0.436, val_accuracy=0.9, lr=1e-04]   87%|████████▋ | 109/125 [37:52<05:26, 20.41s/epoch, loss=0.198, accuracy=0.974, val_loss=0.437, val_accuracy=0.902, lr=1e-04] 88%|████████▊ | 110/125 [38:12<05:06, 20.43s/epoch, loss=0.197, accuracy=0.973, val_loss=0.439, val_accuracy=0.901, lr=1e-04] 89%|████████▉ | 111/125 [38:32<04:45, 20.41s/epoch, loss=0.196, accuracy=0.974, val_loss=0.439, val_accuracy=0.902, lr=1e-04] 90%|████████▉ | 112/125 [38:53<04:25, 20.41s/epoch, loss=0.195, accuracy=0.975, val_loss=0.44, val_accuracy=0.902, lr=1e-04]  90%|█████████ | 113/125 [39:13<04:04, 20.40s/epoch, loss=0.191, accuracy=0.976, val_loss=0.438, val_accuracy=0.901, lr=1e-04] 91%|█████████ | 114/125 [39:34<03:44, 20.39s/epoch, loss=0.19, accuracy=0.976, val_loss=0.438, val_accuracy=0.9, lr=5e-5]     92%|█████████▏| 115/125 [39:54<03:23, 20.35s/epoch, loss=0.19, accuracy=0.976, val_loss=0.438, val_accuracy=0.902, lr=5e-5] 93%|█████████▎| 116/125 [40:14<03:03, 20.34s/epoch, loss=0.187, accuracy=0.977, val_loss=0.438, val_accuracy=0.9, lr=5e-5]  94%|█████████▎| 117/125 [40:35<02:42, 20.35s/epoch, loss=0.189, accuracy=0.976, val_loss=0.439, val_accuracy=0.902, lr=5e-5] 94%|█████████▍| 118/125 [40:55<02:22, 20.39s/epoch, loss=0.189, accuracy=0.976, val_loss=0.439, val_accuracy=0.902, lr=5e-5] 95%|█████████▌| 119/125 [41:15<02:02, 20.37s/epoch, loss=0.186, accuracy=0.977, val_loss=0.439, val_accuracy=0.9, lr=5e-5]   96%|█████████▌| 120/125 [41:36<01:41, 20.37s/epoch, loss=0.188, accuracy=0.976, val_loss=0.437, val_accuracy=0.902, lr=5e-5] 97%|█████████▋| 121/125 [41:56<01:21, 20.38s/epoch, loss=0.186, accuracy=0.977, val_loss=0.44, val_accuracy=0.901, lr=5e-5]  98%|█████████▊| 122/125 [42:17<01:01, 20.42s/epoch, loss=0.185, accuracy=0.977, val_loss=0.44, val_accuracy=0.902, lr=5e-5] 98%|█████████▊| 123/125 [42:37<00:40, 20.44s/epoch, loss=0.184, accuracy=0.978, val_loss=0.441, val_accuracy=0.902, lr=5e-5] 99%|█████████▉| 124/125 [42:58<00:20, 20.46s/epoch, loss=0.183, accuracy=0.978, val_loss=0.439, val_accuracy=0.902, lr=5e-5]100%|██████████| 125/125 [43:18<00:00, 20.46s/epoch, loss=0.185, accuracy=0.977, val_loss=0.441, val_accuracy=0.902, lr=5e-5]100%|██████████| 125/125 [43:18<00:00, 20.79s/epoch, loss=0.185, accuracy=0.977, val_loss=0.441, val_accuracy=0.902, lr=5e-5]
Using real-time data augmentation.
Only one model saved

Loading model: 12_02_cifar10_ResNet20v1.h5
Test score: 0.4407714307308197
Test accuracy: 0.9021999835968018


* * * Run SGD for ID = 12_3. * * *


2024-03-13 03:40:17.997530: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 03:40:25.096138: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 03:40:25.097277: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-13 03:40:25.138292: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-13 03:40:25.138326: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 03:40:25.160267: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 03:40:25.160313: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 03:40:25.166375: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 03:40:25.173781: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 03:40:25.178953: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 03:40:25.182242: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 03:40:25.189274: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 03:40:25.189834: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 03:40:25.189912: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 03:40:26.801516: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-13 03:40:26.802428: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 03:40:26.803013: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-13 03:40:26.803048: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 03:40:26.803087: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 03:40:26.803107: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 03:40:26.803125: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 03:40:26.803142: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 03:40:26.803161: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 03:40:26.803185: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 03:40:26.803202: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 03:40:26.803643: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 03:40:26.803678: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 03:40:27.506016: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-13 03:40:27.506071: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-13 03:40:27.506080: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-13 03:40:27.506985: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:83:00.0, compute capability: 6.1)
{'id': '12_03', 'seed': 3, 'out_folder': 'results/epoch_budget_2', 'batch_size': 128, 'epochs': 125, 'validation_split': 0.0, 'checkpointing': False, 'checkpoint_every': -1, 'hold_out_validation_split': 0.0, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'num_classes': 10, 'SSE_lr': False, 'test_time_augmentation': False, 'debug': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
y_train shape: (50000, 10)
x_val shape: (10000, 32, 32, 3)
y_val shape: (10000, 10)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/125 [00:00<?, ?epoch/s]2024-03-13 03:40:28.186567: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-13 03:40:28.187066: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199945000 Hz
2024-03-13 03:40:30.369868: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 03:40:30.552479: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 03:40:31.470042: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-13 03:40:31.510724: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/125 [00:49<1:42:27, 49.57s/epoch, loss=2.91, accuracy=0.387, val_loss=2.03, val_accuracy=0.38, lr=0.1]  2%|▏         | 2/125 [01:10<1:06:52, 32.62s/epoch, loss=1.51, accuracy=0.567, val_loss=1.78, val_accuracy=0.504, lr=0.1]  2%|▏         | 3/125 [01:31<55:20, 27.22s/epoch, loss=1.32, accuracy=0.655, val_loss=1.76, val_accuracy=0.515, lr=0.1]    3%|▎         | 4/125 [01:52<49:53, 24.74s/epoch, loss=1.26, accuracy=0.695, val_loss=2.92, val_accuracy=0.26, lr=0.1]   4%|▍         | 5/125 [02:12<46:33, 23.28s/epoch, loss=1.24, accuracy=0.709, val_loss=4.85, val_accuracy=0.292, lr=0.1]  5%|▍         | 6/125 [02:33<44:23, 22.38s/epoch, loss=1.24, accuracy=0.715, val_loss=1.65, val_accuracy=0.584, lr=0.1]  6%|▌         | 7/125 [02:53<42:53, 21.81s/epoch, loss=1.22, accuracy=0.723, val_loss=2.36, val_accuracy=0.444, lr=0.1]  6%|▋         | 8/125 [03:14<41:46, 21.42s/epoch, loss=1.22, accuracy=0.727, val_loss=1.51, val_accuracy=0.618, lr=0.1]  7%|▋         | 9/125 [03:35<40:55, 21.17s/epoch, loss=1.2, accuracy=0.732, val_loss=2.22, val_accuracy=0.443, lr=0.1]   8%|▊         | 10/125 [03:55<40:09, 20.96s/epoch, loss=1.2, accuracy=0.734, val_loss=1.77, val_accuracy=0.551, lr=0.1]  9%|▉         | 11/125 [04:16<39:36, 20.85s/epoch, loss=1.2, accuracy=0.735, val_loss=2.55, val_accuracy=0.437, lr=0.1] 10%|▉         | 12/125 [04:36<39:06, 20.77s/epoch, loss=1.19, accuracy=0.74, val_loss=3.13, val_accuracy=0.456, lr=0.1] 10%|█         | 13/125 [04:57<38:39, 20.71s/epoch, loss=1.18, accuracy=0.74, val_loss=2.54, val_accuracy=0.406, lr=0.1] 11%|█         | 14/125 [05:18<38:16, 20.69s/epoch, loss=1.19, accuracy=0.739, val_loss=1.79, val_accuracy=0.535, lr=0.1] 12%|█▏        | 15/125 [05:38<37:51, 20.65s/epoch, loss=1.19, accuracy=0.742, val_loss=1.75, val_accuracy=0.556, lr=0.1] 13%|█▎        | 16/125 [05:59<37:26, 20.61s/epoch, loss=1.18, accuracy=0.744, val_loss=2.67, val_accuracy=0.373, lr=0.1] 14%|█▎        | 17/125 [06:19<37:05, 20.60s/epoch, loss=1.18, accuracy=0.743, val_loss=2.17, val_accuracy=0.491, lr=0.1] 14%|█▍        | 18/125 [06:40<36:42, 20.59s/epoch, loss=1.18, accuracy=0.744, val_loss=2.4, val_accuracy=0.436, lr=0.1]  15%|█▌        | 19/125 [07:00<36:21, 20.58s/epoch, loss=1.17, accuracy=0.746, val_loss=2.09, val_accuracy=0.527, lr=0.1] 16%|█▌        | 20/125 [07:21<36:01, 20.59s/epoch, loss=1.16, accuracy=0.749, val_loss=2.02, val_accuracy=0.435, lr=0.1] 17%|█▋        | 21/125 [07:42<35:40, 20.58s/epoch, loss=1.17, accuracy=0.748, val_loss=1.76, val_accuracy=0.597, lr=0.1] 18%|█▊        | 22/125 [08:02<35:21, 20.60s/epoch, loss=1.16, accuracy=0.749, val_loss=1.68, val_accuracy=0.578, lr=0.1] 18%|█▊        | 23/125 [08:23<35:01, 20.61s/epoch, loss=1.15, accuracy=0.754, val_loss=3.53, val_accuracy=0.313, lr=0.1] 19%|█▉        | 24/125 [08:43<34:42, 20.62s/epoch, loss=1.15, accuracy=0.753, val_loss=2.36, val_accuracy=0.419, lr=0.1] 20%|██        | 25/125 [09:04<34:22, 20.62s/epoch, loss=1.16, accuracy=0.752, val_loss=1.32, val_accuracy=0.687, lr=0.1] 21%|██        | 26/125 [09:25<34:02, 20.64s/epoch, loss=1.16, accuracy=0.75, val_loss=2.27, val_accuracy=0.435, lr=0.1]  22%|██▏       | 27/125 [09:45<33:41, 20.62s/epoch, loss=1.16, accuracy=0.75, val_loss=2.18, val_accuracy=0.398, lr=0.1] 22%|██▏       | 28/125 [10:06<33:18, 20.60s/epoch, loss=1.15, accuracy=0.753, val_loss=2.41, val_accuracy=0.482, lr=0.1] 23%|██▎       | 29/125 [10:26<32:56, 20.59s/epoch, loss=1.16, accuracy=0.75, val_loss=2, val_accuracy=0.507, lr=0.1]     24%|██▍       | 30/125 [10:47<32:34, 20.58s/epoch, loss=1.15, accuracy=0.751, val_loss=2.23, val_accuracy=0.465, lr=0.1] 25%|██▍       | 31/125 [11:07<32:11, 20.55s/epoch, loss=1.15, accuracy=0.751, val_loss=2.06, val_accuracy=0.454, lr=0.1] 26%|██▌       | 32/125 [11:28<31:51, 20.55s/epoch, loss=1.15, accuracy=0.753, val_loss=2.16, val_accuracy=0.49, lr=0.1]  26%|██▋       | 33/125 [11:49<31:29, 20.54s/epoch, loss=1.15, accuracy=0.753, val_loss=2.38, val_accuracy=0.495, lr=0.1] 27%|██▋       | 34/125 [12:09<31:08, 20.53s/epoch, loss=1.15, accuracy=0.752, val_loss=1.61, val_accuracy=0.571, lr=0.1] 28%|██▊       | 35/125 [12:30<30:46, 20.52s/epoch, loss=1.15, accuracy=0.753, val_loss=2.05, val_accuracy=0.534, lr=0.1] 29%|██▉       | 36/125 [12:50<30:27, 20.54s/epoch, loss=1.15, accuracy=0.754, val_loss=2.7, val_accuracy=0.419, lr=0.1]  30%|██▉       | 37/125 [13:11<30:06, 20.53s/epoch, loss=1.15, accuracy=0.752, val_loss=1.75, val_accuracy=0.539, lr=0.1] 30%|███       | 38/125 [13:31<29:45, 20.53s/epoch, loss=1.14, accuracy=0.755, val_loss=1.94, val_accuracy=0.53, lr=0.1]  31%|███       | 39/125 [13:52<29:26, 20.54s/epoch, loss=1.14, accuracy=0.756, val_loss=1.71, val_accuracy=0.568, lr=0.1] 32%|███▏      | 40/125 [14:12<29:07, 20.56s/epoch, loss=1.14, accuracy=0.754, val_loss=1.72, val_accuracy=0.557, lr=0.1] 33%|███▎      | 41/125 [14:33<28:48, 20.58s/epoch, loss=1.14, accuracy=0.754, val_loss=1.93, val_accuracy=0.498, lr=0.1] 34%|███▎      | 42/125 [14:53<28:25, 20.55s/epoch, loss=1.14, accuracy=0.755, val_loss=1.81, val_accuracy=0.508, lr=0.1] 34%|███▍      | 43/125 [15:14<28:05, 20.55s/epoch, loss=1.13, accuracy=0.756, val_loss=2.61, val_accuracy=0.49, lr=0.1]  35%|███▌      | 44/125 [15:35<27:46, 20.57s/epoch, loss=1.14, accuracy=0.758, val_loss=1.62, val_accuracy=0.599, lr=0.1] 36%|███▌      | 45/125 [15:55<27:26, 20.58s/epoch, loss=1.14, accuracy=0.755, val_loss=1.72, val_accuracy=0.571, lr=0.1] 37%|███▋      | 46/125 [16:16<27:08, 20.61s/epoch, loss=1.14, accuracy=0.755, val_loss=1.59, val_accuracy=0.605, lr=0.1] 38%|███▊      | 47/125 [16:37<26:47, 20.61s/epoch, loss=1.14, accuracy=0.755, val_loss=1.89, val_accuracy=0.556, lr=0.1] 38%|███▊      | 48/125 [16:57<26:26, 20.60s/epoch, loss=1.14, accuracy=0.756, val_loss=1.86, val_accuracy=0.472, lr=0.1] 39%|███▉      | 49/125 [17:18<26:07, 20.62s/epoch, loss=1.13, accuracy=0.755, val_loss=1.74, val_accuracy=0.553, lr=0.1] 40%|████      | 50/125 [17:38<25:47, 20.63s/epoch, loss=1.13, accuracy=0.754, val_loss=1.4, val_accuracy=0.665, lr=0.1]  41%|████      | 51/125 [17:59<25:24, 20.60s/epoch, loss=1.13, accuracy=0.757, val_loss=1.81, val_accuracy=0.523, lr=0.1] 42%|████▏     | 52/125 [18:19<25:02, 20.58s/epoch, loss=0.907, accuracy=0.821, val_loss=0.915, val_accuracy=0.799, lr=0.01] 42%|████▏     | 53/125 [18:40<24:43, 20.60s/epoch, loss=0.732, accuracy=0.851, val_loss=0.841, val_accuracy=0.799, lr=0.01] 43%|████▎     | 54/125 [19:01<24:22, 20.60s/epoch, loss=0.653, accuracy=0.857, val_loss=0.78, val_accuracy=0.806, lr=0.01]  44%|████▍     | 55/125 [19:21<24:01, 20.59s/epoch, loss=0.609, accuracy=0.861, val_loss=0.831, val_accuracy=0.778, lr=0.01] 45%|████▍     | 56/125 [19:42<23:40, 20.59s/epoch, loss=0.591, accuracy=0.86, val_loss=0.736, val_accuracy=0.818, lr=0.01]  46%|████▌     | 57/125 [20:02<23:17, 20.55s/epoch, loss=0.582, accuracy=0.859, val_loss=1.02, val_accuracy=0.751, lr=0.01] 46%|████▋     | 58/125 [20:23<22:56, 20.54s/epoch, loss=0.57, accuracy=0.863, val_loss=0.833, val_accuracy=0.779, lr=0.01] 47%|████▋     | 59/125 [20:43<22:35, 20.53s/epoch, loss=0.569, accuracy=0.864, val_loss=0.731, val_accuracy=0.815, lr=0.01] 48%|████▊     | 60/125 [21:04<22:13, 20.52s/epoch, loss=0.566, accuracy=0.866, val_loss=0.758, val_accuracy=0.805, lr=0.01] 49%|████▉     | 61/125 [21:24<21:49, 20.46s/epoch, loss=0.563, accuracy=0.869, val_loss=0.855, val_accuracy=0.784, lr=0.01] 50%|████▉     | 62/125 [21:45<21:27, 20.44s/epoch, loss=0.563, accuracy=0.869, val_loss=0.772, val_accuracy=0.81, lr=0.01]  50%|█████     | 63/125 [22:05<21:06, 20.43s/epoch, loss=0.563, accuracy=0.871, val_loss=1.09, val_accuracy=0.741, lr=0.01] 51%|█████     | 64/125 [22:25<20:46, 20.43s/epoch, loss=0.555, accuracy=0.874, val_loss=0.746, val_accuracy=0.82, lr=0.01] 52%|█████▏    | 65/125 [22:46<20:25, 20.43s/epoch, loss=0.56, accuracy=0.873, val_loss=0.714, val_accuracy=0.824, lr=0.01] 53%|█████▎    | 66/125 [23:06<20:05, 20.43s/epoch, loss=0.561, accuracy=0.874, val_loss=0.662, val_accuracy=0.841, lr=0.01] 54%|█████▎    | 67/125 [23:27<19:44, 20.42s/epoch, loss=0.559, accuracy=0.875, val_loss=0.835, val_accuracy=0.79, lr=0.01]  54%|█████▍    | 68/125 [23:47<19:23, 20.42s/epoch, loss=0.559, accuracy=0.877, val_loss=0.822, val_accuracy=0.799, lr=0.01] 55%|█████▌    | 69/125 [24:08<19:03, 20.42s/epoch, loss=0.556, accuracy=0.877, val_loss=0.775, val_accuracy=0.8, lr=0.01]   56%|█████▌    | 70/125 [24:28<18:43, 20.43s/epoch, loss=0.556, accuracy=0.878, val_loss=0.776, val_accuracy=0.818, lr=0.01] 57%|█████▋    | 71/125 [24:48<18:24, 20.45s/epoch, loss=0.558, accuracy=0.879, val_loss=0.749, val_accuracy=0.82, lr=0.01]  58%|█████▊    | 72/125 [25:09<18:04, 20.45s/epoch, loss=0.559, accuracy=0.88, val_loss=0.873, val_accuracy=0.794, lr=0.01] 58%|█████▊    | 73/125 [25:29<17:43, 20.45s/epoch, loss=0.559, accuracy=0.878, val_loss=0.86, val_accuracy=0.784, lr=0.01] 59%|█████▉    | 74/125 [25:50<17:23, 20.46s/epoch, loss=0.556, accuracy=0.88, val_loss=0.832, val_accuracy=0.794, lr=0.01] 60%|██████    | 75/125 [26:10<17:05, 20.51s/epoch, loss=0.557, accuracy=0.881, val_loss=1.19, val_accuracy=0.711, lr=0.01] 61%|██████    | 76/125 [26:31<16:44, 20.51s/epoch, loss=0.556, accuracy=0.881, val_loss=1.08, val_accuracy=0.726, lr=0.01] 62%|██████▏   | 77/125 [26:52<16:25, 20.54s/epoch, loss=0.484, accuracy=0.908, val_loss=0.538, val_accuracy=0.889, lr=0.001] 62%|██████▏   | 78/125 [27:12<16:05, 20.54s/epoch, loss=0.43, accuracy=0.925, val_loss=0.52, val_accuracy=0.895, lr=0.001]   63%|██████▎   | 79/125 [27:33<15:45, 20.54s/epoch, loss=0.406, accuracy=0.932, val_loss=0.512, val_accuracy=0.894, lr=0.001] 64%|██████▍   | 80/125 [27:53<15:23, 20.53s/epoch, loss=0.39, accuracy=0.934, val_loss=0.504, val_accuracy=0.896, lr=0.001]  65%|██████▍   | 81/125 [28:14<15:02, 20.52s/epoch, loss=0.376, accuracy=0.938, val_loss=0.495, val_accuracy=0.897, lr=0.001] 66%|██████▌   | 82/125 [28:34<14:41, 20.50s/epoch, loss=0.364, accuracy=0.94, val_loss=0.49, val_accuracy=0.897, lr=0.001]   66%|██████▋   | 83/125 [28:55<14:21, 20.51s/epoch, loss=0.352, accuracy=0.942, val_loss=0.477, val_accuracy=0.902, lr=0.001] 67%|██████▋   | 84/125 [29:15<13:59, 20.46s/epoch, loss=0.338, accuracy=0.946, val_loss=0.476, val_accuracy=0.901, lr=0.001] 68%|██████▊   | 85/125 [29:35<13:36, 20.42s/epoch, loss=0.332, accuracy=0.946, val_loss=0.475, val_accuracy=0.899, lr=0.001] 69%|██████▉   | 86/125 [29:56<13:17, 20.44s/epoch, loss=0.321, accuracy=0.948, val_loss=0.488, val_accuracy=0.895, lr=0.001] 70%|██████▉   | 87/125 [30:16<12:55, 20.42s/epoch, loss=0.313, accuracy=0.95, val_loss=0.477, val_accuracy=0.898, lr=0.001]  70%|███████   | 88/125 [30:37<12:35, 20.42s/epoch, loss=0.306, accuracy=0.951, val_loss=0.47, val_accuracy=0.897, lr=0.001] 71%|███████   | 89/125 [30:57<12:15, 20.43s/epoch, loss=0.3, accuracy=0.951, val_loss=0.475, val_accuracy=0.898, lr=0.001]  72%|███████▏  | 90/125 [31:18<11:55, 20.44s/epoch, loss=0.292, accuracy=0.953, val_loss=0.464, val_accuracy=0.896, lr=0.001] 73%|███████▎  | 91/125 [31:38<11:34, 20.42s/epoch, loss=0.283, accuracy=0.954, val_loss=0.471, val_accuracy=0.901, lr=0.001] 74%|███████▎  | 92/125 [31:58<11:14, 20.44s/epoch, loss=0.279, accuracy=0.955, val_loss=0.474, val_accuracy=0.897, lr=0.001] 74%|███████▍  | 93/125 [32:19<10:53, 20.43s/epoch, loss=0.273, accuracy=0.956, val_loss=0.46, val_accuracy=0.899, lr=0.001]  75%|███████▌  | 94/125 [32:39<10:33, 20.42s/epoch, loss=0.268, accuracy=0.957, val_loss=0.463, val_accuracy=0.899, lr=0.001] 76%|███████▌  | 95/125 [33:00<10:13, 20.44s/epoch, loss=0.264, accuracy=0.957, val_loss=0.474, val_accuracy=0.897, lr=0.001] 77%|███████▋  | 96/125 [33:20<09:53, 20.47s/epoch, loss=0.257, accuracy=0.958, val_loss=0.45, val_accuracy=0.899, lr=0.001]  78%|███████▊  | 97/125 [33:41<09:32, 20.43s/epoch, loss=0.255, accuracy=0.958, val_loss=0.514, val_accuracy=0.882, lr=0.001] 78%|███████▊  | 98/125 [34:01<09:11, 20.44s/epoch, loss=0.251, accuracy=0.958, val_loss=0.462, val_accuracy=0.893, lr=0.001] 79%|███████▉  | 99/125 [34:22<08:51, 20.46s/epoch, loss=0.246, accuracy=0.96, val_loss=0.462, val_accuracy=0.897, lr=0.001]  80%|████████  | 100/125 [34:42<08:32, 20.49s/epoch, loss=0.243, accuracy=0.96, val_loss=0.459, val_accuracy=0.892, lr=0.001] 81%|████████  | 101/125 [35:03<08:12, 20.51s/epoch, loss=0.243, accuracy=0.959, val_loss=0.477, val_accuracy=0.891, lr=0.001] 82%|████████▏ | 102/125 [35:23<07:51, 20.51s/epoch, loss=0.223, accuracy=0.967, val_loss=0.428, val_accuracy=0.908, lr=1e-04] 82%|████████▏ | 103/125 [35:44<07:30, 20.50s/epoch, loss=0.212, accuracy=0.972, val_loss=0.423, val_accuracy=0.908, lr=1e-04] 83%|████████▎ | 104/125 [36:04<07:10, 20.49s/epoch, loss=0.208, accuracy=0.973, val_loss=0.423, val_accuracy=0.908, lr=1e-04] 84%|████████▍ | 105/125 [36:24<06:48, 20.44s/epoch, loss=0.204, accuracy=0.974, val_loss=0.424, val_accuracy=0.907, lr=1e-04] 85%|████████▍ | 106/125 [36:45<06:28, 20.45s/epoch, loss=0.205, accuracy=0.974, val_loss=0.421, val_accuracy=0.907, lr=1e-04] 86%|████████▌ | 107/125 [37:05<06:07, 20.44s/epoch, loss=0.202, accuracy=0.974, val_loss=0.423, val_accuracy=0.908, lr=1e-04] 86%|████████▋ | 108/125 [37:26<05:47, 20.45s/epoch, loss=0.199, accuracy=0.976, val_loss=0.423, val_accuracy=0.908, lr=1e-04] 87%|████████▋ | 109/125 [37:46<05:27, 20.44s/epoch, loss=0.2, accuracy=0.975, val_loss=0.428, val_accuracy=0.907, lr=1e-04]   88%|████████▊ | 110/125 [38:07<05:06, 20.43s/epoch, loss=0.197, accuracy=0.976, val_loss=0.425, val_accuracy=0.908, lr=1e-04] 89%|████████▉ | 111/125 [38:27<04:45, 20.41s/epoch, loss=0.196, accuracy=0.977, val_loss=0.427, val_accuracy=0.908, lr=1e-04] 90%|████████▉ | 112/125 [38:47<04:25, 20.43s/epoch, loss=0.193, accuracy=0.977, val_loss=0.426, val_accuracy=0.907, lr=1e-04] 90%|█████████ | 113/125 [39:08<04:04, 20.41s/epoch, loss=0.192, accuracy=0.978, val_loss=0.424, val_accuracy=0.908, lr=1e-04] 91%|█████████ | 114/125 [39:28<03:44, 20.41s/epoch, loss=0.19, accuracy=0.979, val_loss=0.424, val_accuracy=0.906, lr=5e-5]   92%|█████████▏| 115/125 [39:49<03:23, 20.40s/epoch, loss=0.189, accuracy=0.979, val_loss=0.425, val_accuracy=0.907, lr=5e-5] 93%|█████████▎| 116/125 [40:09<03:03, 20.40s/epoch, loss=0.191, accuracy=0.977, val_loss=0.423, val_accuracy=0.908, lr=5e-5] 94%|█████████▎| 117/125 [40:29<02:43, 20.40s/epoch, loss=0.189, accuracy=0.978, val_loss=0.425, val_accuracy=0.908, lr=5e-5] 94%|█████████▍| 118/125 [40:50<02:22, 20.40s/epoch, loss=0.189, accuracy=0.977, val_loss=0.425, val_accuracy=0.909, lr=5e-5] 95%|█████████▌| 119/125 [41:10<02:02, 20.41s/epoch, loss=0.188, accuracy=0.979, val_loss=0.425, val_accuracy=0.908, lr=5e-5] 96%|█████████▌| 120/125 [41:31<01:42, 20.42s/epoch, loss=0.188, accuracy=0.979, val_loss=0.425, val_accuracy=0.908, lr=5e-5] 97%|█████████▋| 121/125 [41:51<01:21, 20.43s/epoch, loss=0.187, accuracy=0.979, val_loss=0.425, val_accuracy=0.908, lr=5e-5] 98%|█████████▊| 122/125 [42:12<01:01, 20.48s/epoch, loss=0.187, accuracy=0.979, val_loss=0.425, val_accuracy=0.907, lr=5e-5] 98%|█████████▊| 123/125 [42:32<00:40, 20.48s/epoch, loss=0.186, accuracy=0.979, val_loss=0.425, val_accuracy=0.907, lr=5e-5] 99%|█████████▉| 124/125 [42:53<00:20, 20.52s/epoch, loss=0.185, accuracy=0.979, val_loss=0.425, val_accuracy=0.909, lr=5e-5]100%|██████████| 125/125 [43:13<00:00, 20.54s/epoch, loss=0.185, accuracy=0.979, val_loss=0.425, val_accuracy=0.909, lr=5e-5]100%|██████████| 125/125 [43:13<00:00, 20.75s/epoch, loss=0.185, accuracy=0.979, val_loss=0.425, val_accuracy=0.909, lr=5e-5]
Using real-time data augmentation.
Only one model saved

Loading model: 12_03_cifar10_ResNet20v1.h5
Test score: 0.4253232479095459
Test accuracy: 0.9088000059127808


* * * Run SGD for ID = 12_4. * * *


2024-03-13 04:23:45.596497: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 04:23:48.409676: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 04:23:48.410767: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-13 04:23:48.451601: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-13 04:23:48.451639: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 04:23:48.454487: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 04:23:48.454530: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 04:23:48.456653: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 04:23:48.457410: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 04:23:48.459838: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 04:23:48.461300: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 04:23:48.465931: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 04:23:48.466450: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 04:23:48.466527: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 04:23:49.801865: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-13 04:23:49.802313: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 04:23:49.803100: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-13 04:23:49.803135: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 04:23:49.803187: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 04:23:49.803208: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 04:23:49.803224: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 04:23:49.803241: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 04:23:49.803258: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 04:23:49.803275: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 04:23:49.803292: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 04:23:49.803711: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 04:23:49.803749: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 04:23:50.515100: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-13 04:23:50.515160: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-13 04:23:50.515171: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-13 04:23:50.516075: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:83:00.0, compute capability: 6.1)
{'id': '12_04', 'seed': 4, 'out_folder': 'results/epoch_budget_2', 'batch_size': 128, 'epochs': 125, 'validation_split': 0.0, 'checkpointing': False, 'checkpoint_every': -1, 'hold_out_validation_split': 0.0, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'num_classes': 10, 'SSE_lr': False, 'test_time_augmentation': False, 'debug': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
y_train shape: (50000, 10)
x_val shape: (10000, 32, 32, 3)
y_val shape: (10000, 10)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/125 [00:00<?, ?epoch/s]2024-03-13 04:23:51.188454: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-13 04:23:51.200970: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199945000 Hz
2024-03-13 04:23:53.450596: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 04:23:53.640192: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 04:23:54.395150: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-13 04:23:54.431023: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/125 [00:47<1:39:05, 47.95s/epoch, loss=2.84, accuracy=0.396, val_loss=2.88, val_accuracy=0.217, lr=0.1]  2%|▏         | 2/125 [01:08<1:05:37, 32.02s/epoch, loss=1.45, accuracy=0.595, val_loss=1.94, val_accuracy=0.438, lr=0.1]  2%|▏         | 3/125 [01:29<54:33, 26.83s/epoch, loss=1.28, accuracy=0.676, val_loss=1.88, val_accuracy=0.478, lr=0.1]    3%|▎         | 4/125 [01:50<49:18, 24.45s/epoch, loss=1.24, accuracy=0.703, val_loss=1.88, val_accuracy=0.503, lr=0.1]  4%|▍         | 5/125 [02:11<46:16, 23.14s/epoch, loss=1.22, accuracy=0.715, val_loss=2.13, val_accuracy=0.425, lr=0.1]  5%|▍         | 6/125 [02:31<44:17, 22.33s/epoch, loss=1.2, accuracy=0.724, val_loss=5.36, val_accuracy=0.212, lr=0.1]   6%|▌         | 7/125 [02:52<42:53, 21.81s/epoch, loss=1.2, accuracy=0.726, val_loss=1.7, val_accuracy=0.534, lr=0.1]   6%|▋         | 8/125 [03:13<41:55, 21.50s/epoch, loss=1.2, accuracy=0.732, val_loss=1.63, val_accuracy=0.604, lr=0.1]  7%|▋         | 9/125 [03:34<41:03, 21.23s/epoch, loss=1.2, accuracy=0.732, val_loss=2.55, val_accuracy=0.345, lr=0.1]  8%|▊         | 10/125 [03:54<40:25, 21.09s/epoch, loss=1.19, accuracy=0.735, val_loss=1.57, val_accuracy=0.614, lr=0.1]  9%|▉         | 11/125 [04:15<39:50, 20.97s/epoch, loss=1.19, accuracy=0.737, val_loss=2.21, val_accuracy=0.484, lr=0.1] 10%|▉         | 12/125 [04:36<39:20, 20.89s/epoch, loss=1.19, accuracy=0.737, val_loss=2.94, val_accuracy=0.368, lr=0.1] 10%|█         | 13/125 [04:56<38:54, 20.84s/epoch, loss=1.18, accuracy=0.74, val_loss=1.6, val_accuracy=0.605, lr=0.1]   11%|█         | 14/125 [05:17<38:31, 20.82s/epoch, loss=1.18, accuracy=0.744, val_loss=2.56, val_accuracy=0.427, lr=0.1] 12%|█▏        | 15/125 [05:38<38:07, 20.80s/epoch, loss=1.17, accuracy=0.743, val_loss=1.74, val_accuracy=0.568, lr=0.1] 13%|█▎        | 16/125 [05:59<37:45, 20.78s/epoch, loss=1.18, accuracy=0.745, val_loss=1.73, val_accuracy=0.552, lr=0.1] 14%|█▎        | 17/125 [06:19<37:22, 20.76s/epoch, loss=1.17, accuracy=0.745, val_loss=1.86, val_accuracy=0.497, lr=0.1] 14%|█▍        | 18/125 [06:40<37:03, 20.78s/epoch, loss=1.17, accuracy=0.747, val_loss=3.28, val_accuracy=0.285, lr=0.1] 15%|█▌        | 19/125 [07:01<36:41, 20.77s/epoch, loss=1.17, accuracy=0.747, val_loss=2.33, val_accuracy=0.444, lr=0.1] 16%|█▌        | 20/125 [07:22<36:24, 20.80s/epoch, loss=1.16, accuracy=0.748, val_loss=1.75, val_accuracy=0.507, lr=0.1] 17%|█▋        | 21/125 [07:43<36:04, 20.81s/epoch, loss=1.16, accuracy=0.75, val_loss=2.55, val_accuracy=0.405, lr=0.1]  18%|█▊        | 22/125 [08:04<35:43, 20.81s/epoch, loss=1.15, accuracy=0.751, val_loss=2.26, val_accuracy=0.506, lr=0.1] 18%|█▊        | 23/125 [08:24<35:23, 20.82s/epoch, loss=1.16, accuracy=0.751, val_loss=1.7, val_accuracy=0.569, lr=0.1]  19%|█▉        | 24/125 [08:45<35:03, 20.83s/epoch, loss=1.15, accuracy=0.751, val_loss=1.48, val_accuracy=0.646, lr=0.1] 20%|██        | 25/125 [09:06<34:41, 20.81s/epoch, loss=1.15, accuracy=0.75, val_loss=1.9, val_accuracy=0.521, lr=0.1]   21%|██        | 26/125 [09:27<34:18, 20.79s/epoch, loss=1.15, accuracy=0.752, val_loss=2.6, val_accuracy=0.306, lr=0.1] 22%|██▏       | 27/125 [09:47<33:55, 20.77s/epoch, loss=1.15, accuracy=0.753, val_loss=2.28, val_accuracy=0.442, lr=0.1] 22%|██▏       | 28/125 [10:08<33:35, 20.78s/epoch, loss=1.15, accuracy=0.754, val_loss=2.67, val_accuracy=0.368, lr=0.1] 23%|██▎       | 29/125 [10:29<33:13, 20.77s/epoch, loss=1.14, accuracy=0.752, val_loss=2.48, val_accuracy=0.383, lr=0.1] 24%|██▍       | 30/125 [10:50<32:51, 20.75s/epoch, loss=1.15, accuracy=0.756, val_loss=2.18, val_accuracy=0.366, lr=0.1] 25%|██▍       | 31/125 [11:10<32:29, 20.74s/epoch, loss=1.15, accuracy=0.753, val_loss=2.38, val_accuracy=0.372, lr=0.1] 26%|██▌       | 32/125 [11:31<32:09, 20.75s/epoch, loss=1.14, accuracy=0.757, val_loss=2.08, val_accuracy=0.419, lr=0.1] 26%|██▋       | 33/125 [11:52<31:48, 20.75s/epoch, loss=1.14, accuracy=0.755, val_loss=3.07, val_accuracy=0.25, lr=0.1]  27%|██▋       | 34/125 [12:13<31:30, 20.77s/epoch, loss=1.13, accuracy=0.756, val_loss=1.75, val_accuracy=0.533, lr=0.1] 28%|██▊       | 35/125 [12:33<31:08, 20.76s/epoch, loss=1.14, accuracy=0.757, val_loss=3, val_accuracy=0.395, lr=0.1]    29%|██▉       | 36/125 [12:54<30:46, 20.75s/epoch, loss=1.14, accuracy=0.755, val_loss=1.69, val_accuracy=0.567, lr=0.1] 30%|██▉       | 37/125 [13:15<30:23, 20.73s/epoch, loss=1.14, accuracy=0.756, val_loss=3.01, val_accuracy=0.373, lr=0.1] 30%|███       | 38/125 [13:36<30:02, 20.72s/epoch, loss=1.14, accuracy=0.756, val_loss=1.7, val_accuracy=0.595, lr=0.1]  31%|███       | 39/125 [13:56<29:42, 20.73s/epoch, loss=1.14, accuracy=0.759, val_loss=1.99, val_accuracy=0.517, lr=0.1] 32%|███▏      | 40/125 [14:17<29:24, 20.76s/epoch, loss=1.15, accuracy=0.755, val_loss=1.68, val_accuracy=0.575, lr=0.1] 33%|███▎      | 41/125 [14:38<29:04, 20.76s/epoch, loss=1.13, accuracy=0.756, val_loss=3.94, val_accuracy=0.23, lr=0.1]  34%|███▎      | 42/125 [14:59<28:43, 20.77s/epoch, loss=1.13, accuracy=0.759, val_loss=2.82, val_accuracy=0.425, lr=0.1] 34%|███▍      | 43/125 [15:20<28:26, 20.81s/epoch, loss=1.14, accuracy=0.756, val_loss=1.57, val_accuracy=0.591, lr=0.1] 35%|███▌      | 44/125 [15:41<28:08, 20.84s/epoch, loss=1.13, accuracy=0.756, val_loss=1.83, val_accuracy=0.552, lr=0.1] 36%|███▌      | 45/125 [16:01<27:48, 20.86s/epoch, loss=1.13, accuracy=0.758, val_loss=1.63, val_accuracy=0.59, lr=0.1]  37%|███▋      | 46/125 [16:22<27:25, 20.83s/epoch, loss=1.13, accuracy=0.757, val_loss=2.72, val_accuracy=0.274, lr=0.1] 38%|███▊      | 47/125 [16:43<27:05, 20.85s/epoch, loss=1.13, accuracy=0.757, val_loss=2.36, val_accuracy=0.446, lr=0.1] 38%|███▊      | 48/125 [17:04<26:46, 20.86s/epoch, loss=1.13, accuracy=0.759, val_loss=1.82, val_accuracy=0.54, lr=0.1]  39%|███▉      | 49/125 [17:25<26:24, 20.85s/epoch, loss=1.13, accuracy=0.759, val_loss=1.71, val_accuracy=0.538, lr=0.1] 40%|████      | 50/125 [17:46<26:04, 20.86s/epoch, loss=1.14, accuracy=0.758, val_loss=1.75, val_accuracy=0.542, lr=0.1] 41%|████      | 51/125 [18:06<25:41, 20.83s/epoch, loss=1.13, accuracy=0.759, val_loss=3.37, val_accuracy=0.239, lr=0.1] 42%|████▏     | 52/125 [18:27<25:20, 20.83s/epoch, loss=0.912, accuracy=0.822, val_loss=0.959, val_accuracy=0.791, lr=0.01] 42%|████▏     | 53/125 [18:48<25:00, 20.84s/epoch, loss=0.733, accuracy=0.852, val_loss=0.756, val_accuracy=0.833, lr=0.01] 43%|████▎     | 54/125 [19:09<24:41, 20.86s/epoch, loss=0.646, accuracy=0.86, val_loss=0.727, val_accuracy=0.828, lr=0.01]  44%|████▍     | 55/125 [19:30<24:20, 20.87s/epoch, loss=0.603, accuracy=0.863, val_loss=0.692, val_accuracy=0.827, lr=0.01] 45%|████▍     | 56/125 [19:51<24:00, 20.88s/epoch, loss=0.582, accuracy=0.865, val_loss=0.847, val_accuracy=0.776, lr=0.01] 46%|████▌     | 57/125 [20:12<23:39, 20.88s/epoch, loss=0.57, accuracy=0.867, val_loss=0.998, val_accuracy=0.729, lr=0.01]  46%|████▋     | 58/125 [20:33<23:18, 20.87s/epoch, loss=0.565, accuracy=0.867, val_loss=0.695, val_accuracy=0.828, lr=0.01] 47%|████▋     | 59/125 [20:53<22:57, 20.86s/epoch, loss=0.561, accuracy=0.868, val_loss=0.767, val_accuracy=0.8, lr=0.01]   48%|████▊     | 60/125 [21:14<22:36, 20.87s/epoch, loss=0.559, accuracy=0.87, val_loss=0.773, val_accuracy=0.8, lr=0.01]  49%|████▉     | 61/125 [21:35<22:13, 20.83s/epoch, loss=0.554, accuracy=0.871, val_loss=0.773, val_accuracy=0.805, lr=0.01] 50%|████▉     | 62/125 [21:56<21:51, 20.82s/epoch, loss=0.557, accuracy=0.873, val_loss=0.759, val_accuracy=0.806, lr=0.01] 50%|█████     | 63/125 [22:17<21:31, 20.82s/epoch, loss=0.556, accuracy=0.874, val_loss=0.805, val_accuracy=0.8, lr=0.01]   51%|█████     | 64/125 [22:38<21:10, 20.84s/epoch, loss=0.558, accuracy=0.875, val_loss=0.793, val_accuracy=0.801, lr=0.01] 52%|█████▏    | 65/125 [22:58<20:49, 20.82s/epoch, loss=0.551, accuracy=0.879, val_loss=0.92, val_accuracy=0.763, lr=0.01]  53%|█████▎    | 66/125 [23:19<20:28, 20.82s/epoch, loss=0.549, accuracy=0.878, val_loss=0.708, val_accuracy=0.828, lr=0.01] 54%|█████▎    | 67/125 [23:40<20:07, 20.82s/epoch, loss=0.557, accuracy=0.877, val_loss=0.834, val_accuracy=0.792, lr=0.01] 54%|█████▍    | 68/125 [24:01<19:45, 20.80s/epoch, loss=0.55, accuracy=0.88, val_loss=0.72, val_accuracy=0.829, lr=0.01]    55%|█████▌    | 69/125 [24:22<19:24, 20.79s/epoch, loss=0.551, accuracy=0.88, val_loss=0.795, val_accuracy=0.808, lr=0.01] 56%|█████▌    | 70/125 [24:42<19:02, 20.78s/epoch, loss=0.551, accuracy=0.881, val_loss=0.819, val_accuracy=0.794, lr=0.01] 57%|█████▋    | 71/125 [25:03<18:41, 20.76s/epoch, loss=0.548, accuracy=0.882, val_loss=0.883, val_accuracy=0.775, lr=0.01] 58%|█████▊    | 72/125 [25:24<18:21, 20.78s/epoch, loss=0.554, accuracy=0.879, val_loss=0.825, val_accuracy=0.783, lr=0.01] 58%|█████▊    | 73/125 [25:45<18:00, 20.77s/epoch, loss=0.556, accuracy=0.881, val_loss=1.34, val_accuracy=0.671, lr=0.01]  59%|█████▉    | 74/125 [26:05<17:38, 20.76s/epoch, loss=0.551, accuracy=0.885, val_loss=0.726, val_accuracy=0.827, lr=0.01] 60%|██████    | 75/125 [26:26<17:17, 20.75s/epoch, loss=0.547, accuracy=0.884, val_loss=0.741, val_accuracy=0.822, lr=0.01] 61%|██████    | 76/125 [26:47<16:57, 20.77s/epoch, loss=0.555, accuracy=0.883, val_loss=0.85, val_accuracy=0.808, lr=0.01]  62%|██████▏   | 77/125 [27:08<16:37, 20.78s/epoch, loss=0.472, accuracy=0.913, val_loss=0.523, val_accuracy=0.895, lr=0.001] 62%|██████▏   | 78/125 [27:28<16:16, 20.79s/epoch, loss=0.419, accuracy=0.928, val_loss=0.525, val_accuracy=0.893, lr=0.001] 63%|██████▎   | 79/125 [27:49<15:55, 20.78s/epoch, loss=0.397, accuracy=0.935, val_loss=0.498, val_accuracy=0.903, lr=0.001] 64%|██████▍   | 80/125 [28:10<15:35, 20.80s/epoch, loss=0.384, accuracy=0.939, val_loss=0.491, val_accuracy=0.902, lr=0.001] 65%|██████▍   | 81/125 [28:31<15:13, 20.76s/epoch, loss=0.369, accuracy=0.94, val_loss=0.473, val_accuracy=0.907, lr=0.001]  66%|██████▌   | 82/125 [28:51<14:51, 20.73s/epoch, loss=0.358, accuracy=0.942, val_loss=0.479, val_accuracy=0.903, lr=0.001] 66%|██████▋   | 83/125 [29:12<14:29, 20.71s/epoch, loss=0.345, accuracy=0.945, val_loss=0.469, val_accuracy=0.905, lr=0.001] 67%|██████▋   | 84/125 [29:33<14:08, 20.69s/epoch, loss=0.336, accuracy=0.947, val_loss=0.459, val_accuracy=0.905, lr=0.001] 68%|██████▊   | 85/125 [29:53<13:47, 20.68s/epoch, loss=0.325, accuracy=0.949, val_loss=0.468, val_accuracy=0.904, lr=0.001] 69%|██████▉   | 86/125 [30:14<13:26, 20.68s/epoch, loss=0.318, accuracy=0.949, val_loss=0.466, val_accuracy=0.902, lr=0.001] 70%|██████▉   | 87/125 [30:35<13:05, 20.67s/epoch, loss=0.309, accuracy=0.951, val_loss=0.451, val_accuracy=0.907, lr=0.001] 70%|███████   | 88/125 [30:55<12:44, 20.66s/epoch, loss=0.301, accuracy=0.952, val_loss=0.453, val_accuracy=0.906, lr=0.001] 71%|███████   | 89/125 [31:16<12:23, 20.65s/epoch, loss=0.292, accuracy=0.954, val_loss=0.455, val_accuracy=0.904, lr=0.001] 72%|███████▏  | 90/125 [31:37<12:02, 20.64s/epoch, loss=0.285, accuracy=0.955, val_loss=0.47, val_accuracy=0.897, lr=0.001]  73%|███████▎  | 91/125 [31:57<11:40, 20.61s/epoch, loss=0.28, accuracy=0.955, val_loss=0.453, val_accuracy=0.901, lr=0.001] 74%|███████▎  | 92/125 [32:18<11:20, 20.63s/epoch, loss=0.275, accuracy=0.956, val_loss=0.446, val_accuracy=0.902, lr=0.001] 74%|███████▍  | 93/125 [32:38<10:59, 20.61s/epoch, loss=0.268, accuracy=0.957, val_loss=0.452, val_accuracy=0.9, lr=0.001]   75%|███████▌  | 94/125 [32:59<10:38, 20.61s/epoch, loss=0.26, accuracy=0.96, val_loss=0.463, val_accuracy=0.901, lr=0.001] 76%|███████▌  | 95/125 [33:19<10:17, 20.59s/epoch, loss=0.258, accuracy=0.959, val_loss=0.485, val_accuracy=0.893, lr=0.001] 77%|███████▋  | 96/125 [33:40<09:57, 20.60s/epoch, loss=0.252, accuracy=0.96, val_loss=0.455, val_accuracy=0.899, lr=0.001]  78%|███████▊  | 97/125 [34:01<09:36, 20.60s/epoch, loss=0.253, accuracy=0.959, val_loss=0.461, val_accuracy=0.897, lr=0.001] 78%|███████▊  | 98/125 [34:21<09:16, 20.61s/epoch, loss=0.247, accuracy=0.961, val_loss=0.465, val_accuracy=0.893, lr=0.001] 79%|███████▉  | 99/125 [34:42<08:56, 20.63s/epoch, loss=0.243, accuracy=0.96, val_loss=0.454, val_accuracy=0.897, lr=0.001]  80%|████████  | 100/125 [35:03<08:35, 20.64s/epoch, loss=0.237, accuracy=0.961, val_loss=0.479, val_accuracy=0.895, lr=0.001] 81%|████████  | 101/125 [35:23<08:15, 20.65s/epoch, loss=0.237, accuracy=0.96, val_loss=0.501, val_accuracy=0.891, lr=0.001]  82%|████████▏ | 102/125 [35:44<07:55, 20.66s/epoch, loss=0.218, accuracy=0.968, val_loss=0.417, val_accuracy=0.908, lr=1e-04] 82%|████████▏ | 103/125 [36:05<07:34, 20.64s/epoch, loss=0.208, accuracy=0.972, val_loss=0.414, val_accuracy=0.909, lr=1e-04] 83%|████████▎ | 104/125 [36:25<07:13, 20.65s/epoch, loss=0.203, accuracy=0.974, val_loss=0.413, val_accuracy=0.909, lr=1e-04] 84%|████████▍ | 105/125 [36:46<06:52, 20.61s/epoch, loss=0.202, accuracy=0.975, val_loss=0.412, val_accuracy=0.91, lr=1e-04]  85%|████████▍ | 106/125 [37:06<06:31, 20.62s/epoch, loss=0.198, accuracy=0.976, val_loss=0.412, val_accuracy=0.91, lr=1e-04] 86%|████████▌ | 107/125 [37:27<06:10, 20.59s/epoch, loss=0.197, accuracy=0.977, val_loss=0.414, val_accuracy=0.909, lr=1e-04] 86%|████████▋ | 108/125 [37:48<05:49, 20.58s/epoch, loss=0.197, accuracy=0.977, val_loss=0.414, val_accuracy=0.911, lr=1e-04] 87%|████████▋ | 109/125 [38:08<05:28, 20.55s/epoch, loss=0.194, accuracy=0.978, val_loss=0.415, val_accuracy=0.909, lr=1e-04] 88%|████████▊ | 110/125 [38:29<05:08, 20.58s/epoch, loss=0.193, accuracy=0.976, val_loss=0.415, val_accuracy=0.91, lr=1e-04]  89%|████████▉ | 111/125 [38:49<04:47, 20.57s/epoch, loss=0.193, accuracy=0.977, val_loss=0.416, val_accuracy=0.909, lr=1e-04] 90%|████████▉ | 112/125 [39:10<04:27, 20.58s/epoch, loss=0.191, accuracy=0.978, val_loss=0.416, val_accuracy=0.911, lr=1e-04] 90%|█████████ | 113/125 [39:31<04:07, 20.64s/epoch, loss=0.189, accuracy=0.979, val_loss=0.414, val_accuracy=0.909, lr=1e-04] 91%|█████████ | 114/125 [39:51<03:47, 20.64s/epoch, loss=0.187, accuracy=0.979, val_loss=0.414, val_accuracy=0.91, lr=5e-5]   92%|█████████▏| 115/125 [40:12<03:26, 20.68s/epoch, loss=0.187, accuracy=0.979, val_loss=0.415, val_accuracy=0.91, lr=5e-5] 93%|█████████▎| 116/125 [40:33<03:05, 20.65s/epoch, loss=0.186, accuracy=0.98, val_loss=0.416, val_accuracy=0.91, lr=5e-5]  94%|█████████▎| 117/125 [40:53<02:45, 20.64s/epoch, loss=0.185, accuracy=0.979, val_loss=0.416, val_accuracy=0.909, lr=5e-5] 94%|█████████▍| 118/125 [41:14<02:24, 20.64s/epoch, loss=0.183, accuracy=0.98, val_loss=0.416, val_accuracy=0.908, lr=5e-5]  95%|█████████▌| 119/125 [41:34<02:03, 20.61s/epoch, loss=0.183, accuracy=0.98, val_loss=0.416, val_accuracy=0.91, lr=5e-5]  96%|█████████▌| 120/125 [41:55<01:43, 20.61s/epoch, loss=0.182, accuracy=0.981, val_loss=0.416, val_accuracy=0.909, lr=5e-5] 97%|█████████▋| 121/125 [42:16<01:22, 20.59s/epoch, loss=0.183, accuracy=0.98, val_loss=0.417, val_accuracy=0.909, lr=5e-5]  98%|█████████▊| 122/125 [42:36<01:01, 20.61s/epoch, loss=0.183, accuracy=0.98, val_loss=0.416, val_accuracy=0.909, lr=5e-5] 98%|█████████▊| 123/125 [42:57<00:41, 20.62s/epoch, loss=0.181, accuracy=0.981, val_loss=0.417, val_accuracy=0.908, lr=5e-5] 99%|█████████▉| 124/125 [43:18<00:20, 20.65s/epoch, loss=0.181, accuracy=0.98, val_loss=0.417, val_accuracy=0.909, lr=5e-5] 100%|██████████| 125/125 [43:38<00:00, 20.63s/epoch, loss=0.181, accuracy=0.981, val_loss=0.417, val_accuracy=0.908, lr=5e-5]100%|██████████| 125/125 [43:38<00:00, 20.95s/epoch, loss=0.181, accuracy=0.981, val_loss=0.417, val_accuracy=0.908, lr=5e-5]
Using real-time data augmentation.
Only one model saved

Loading model: 12_04_cifar10_ResNet20v1.h5
Test score: 0.4167967140674591
Test accuracy: 0.90829998254776


* * * Run SGD for ID = 12_5. * * *


2024-03-13 05:07:33.317607: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 05:07:36.011620: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 05:07:36.012762: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-13 05:07:36.053240: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-13 05:07:36.053275: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 05:07:36.056198: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 05:07:36.056249: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 05:07:36.058373: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 05:07:36.059030: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 05:07:36.061487: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 05:07:36.063031: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 05:07:36.067802: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 05:07:36.068350: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 05:07:36.068439: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 05:07:37.378112: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-13 05:07:37.378605: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 05:07:37.379372: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-13 05:07:37.379406: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 05:07:37.379443: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 05:07:37.379462: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 05:07:37.379479: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 05:07:37.379499: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 05:07:37.379516: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 05:07:37.379533: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 05:07:37.379550: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 05:07:37.380005: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 05:07:37.380045: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 05:07:38.088072: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-13 05:07:38.088124: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-13 05:07:38.088134: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-13 05:07:38.089055: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:83:00.0, compute capability: 6.1)
{'id': '12_05', 'seed': 5, 'out_folder': 'results/epoch_budget_2', 'batch_size': 128, 'epochs': 125, 'validation_split': 0.0, 'checkpointing': False, 'checkpoint_every': -1, 'hold_out_validation_split': 0.0, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'num_classes': 10, 'SSE_lr': False, 'test_time_augmentation': False, 'debug': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
y_train shape: (50000, 10)
x_val shape: (10000, 32, 32, 3)
y_val shape: (10000, 10)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/125 [00:00<?, ?epoch/s]2024-03-13 05:07:38.762119: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-13 05:07:38.773968: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199945000 Hz
2024-03-13 05:07:40.980483: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 05:07:41.200535: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 05:07:41.880236: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-13 05:07:41.912891: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/125 [00:46<1:37:06, 46.98s/epoch, loss=3.24, accuracy=0.285, val_loss=2.53, val_accuracy=0.189, lr=0.1]  2%|▏         | 2/125 [01:07<1:04:46, 31.59s/epoch, loss=1.59, accuracy=0.521, val_loss=3.31, val_accuracy=0.334, lr=0.1]  2%|▏         | 3/125 [01:28<54:04, 26.60s/epoch, loss=1.35, accuracy=0.641, val_loss=2.42, val_accuracy=0.351, lr=0.1]    3%|▎         | 4/125 [01:49<48:51, 24.23s/epoch, loss=1.29, accuracy=0.679, val_loss=1.88, val_accuracy=0.488, lr=0.1]  4%|▍         | 5/125 [02:09<45:53, 22.94s/epoch, loss=1.26, accuracy=0.696, val_loss=2.38, val_accuracy=0.425, lr=0.1]  5%|▍         | 6/125 [02:30<43:56, 22.15s/epoch, loss=1.24, accuracy=0.709, val_loss=2.1, val_accuracy=0.43, lr=0.1]    6%|▌         | 7/125 [02:51<42:38, 21.68s/epoch, loss=1.22, accuracy=0.715, val_loss=1.63, val_accuracy=0.593, lr=0.1]  6%|▋         | 8/125 [03:11<41:38, 21.35s/epoch, loss=1.21, accuracy=0.724, val_loss=1.96, val_accuracy=0.527, lr=0.1]  7%|▋         | 9/125 [03:32<40:49, 21.12s/epoch, loss=1.21, accuracy=0.727, val_loss=1.63, val_accuracy=0.589, lr=0.1]  8%|▊         | 10/125 [03:52<40:11, 20.97s/epoch, loss=1.2, accuracy=0.728, val_loss=1.84, val_accuracy=0.528, lr=0.1]  9%|▉         | 11/125 [04:13<39:39, 20.87s/epoch, loss=1.2, accuracy=0.729, val_loss=1.95, val_accuracy=0.509, lr=0.1] 10%|▉         | 12/125 [04:34<39:09, 20.80s/epoch, loss=1.19, accuracy=0.732, val_loss=1.58, val_accuracy=0.634, lr=0.1] 10%|█         | 13/125 [04:54<38:45, 20.76s/epoch, loss=1.19, accuracy=0.734, val_loss=1.69, val_accuracy=0.593, lr=0.1] 11%|█         | 14/125 [05:15<38:23, 20.75s/epoch, loss=1.18, accuracy=0.738, val_loss=1.83, val_accuracy=0.523, lr=0.1] 12%|█▏        | 15/125 [05:36<37:58, 20.72s/epoch, loss=1.18, accuracy=0.737, val_loss=2.63, val_accuracy=0.475, lr=0.1] 13%|█▎        | 16/125 [05:56<37:37, 20.71s/epoch, loss=1.16, accuracy=0.741, val_loss=1.86, val_accuracy=0.559, lr=0.1] 14%|█▎        | 17/125 [06:17<37:13, 20.68s/epoch, loss=1.17, accuracy=0.741, val_loss=2.08, val_accuracy=0.473, lr=0.1] 14%|█▍        | 18/125 [06:38<36:52, 20.67s/epoch, loss=1.17, accuracy=0.744, val_loss=2.35, val_accuracy=0.394, lr=0.1] 15%|█▌        | 19/125 [06:58<36:32, 20.68s/epoch, loss=1.16, accuracy=0.742, val_loss=2.74, val_accuracy=0.466, lr=0.1] 16%|█▌        | 20/125 [07:19<36:15, 20.71s/epoch, loss=1.16, accuracy=0.744, val_loss=2.9, val_accuracy=0.349, lr=0.1]  17%|█▋        | 21/125 [07:40<35:56, 20.73s/epoch, loss=1.16, accuracy=0.744, val_loss=1.58, val_accuracy=0.574, lr=0.1] 18%|█▊        | 22/125 [08:01<35:37, 20.75s/epoch, loss=1.16, accuracy=0.747, val_loss=1.88, val_accuracy=0.507, lr=0.1] 18%|█▊        | 23/125 [08:22<35:17, 20.76s/epoch, loss=1.16, accuracy=0.744, val_loss=2.56, val_accuracy=0.419, lr=0.1] 19%|█▉        | 24/125 [08:42<34:57, 20.77s/epoch, loss=1.15, accuracy=0.745, val_loss=1.46, val_accuracy=0.646, lr=0.1] 20%|██        | 25/125 [09:03<34:38, 20.78s/epoch, loss=1.15, accuracy=0.746, val_loss=1.91, val_accuracy=0.553, lr=0.1] 21%|██        | 26/125 [09:24<34:14, 20.76s/epoch, loss=1.15, accuracy=0.749, val_loss=2.35, val_accuracy=0.419, lr=0.1] 22%|██▏       | 27/125 [09:45<33:54, 20.76s/epoch, loss=1.15, accuracy=0.75, val_loss=1.98, val_accuracy=0.516, lr=0.1]  22%|██▏       | 28/125 [10:05<33:33, 20.76s/epoch, loss=1.15, accuracy=0.749, val_loss=2.07, val_accuracy=0.464, lr=0.1] 23%|██▎       | 29/125 [10:26<33:12, 20.75s/epoch, loss=1.14, accuracy=0.751, val_loss=1.83, val_accuracy=0.568, lr=0.1] 24%|██▍       | 30/125 [10:47<32:50, 20.74s/epoch, loss=1.15, accuracy=0.749, val_loss=3.06, val_accuracy=0.253, lr=0.1] 25%|██▍       | 31/125 [11:08<32:28, 20.73s/epoch, loss=1.14, accuracy=0.753, val_loss=2.06, val_accuracy=0.506, lr=0.1] 26%|██▌       | 32/125 [11:28<32:04, 20.70s/epoch, loss=1.13, accuracy=0.752, val_loss=3.12, val_accuracy=0.366, lr=0.1] 26%|██▋       | 33/125 [11:49<31:43, 20.69s/epoch, loss=1.14, accuracy=0.753, val_loss=1.63, val_accuracy=0.617, lr=0.1] 27%|██▋       | 34/125 [12:10<31:24, 20.71s/epoch, loss=1.13, accuracy=0.752, val_loss=1.81, val_accuracy=0.559, lr=0.1] 28%|██▊       | 35/125 [12:30<31:02, 20.70s/epoch, loss=1.14, accuracy=0.753, val_loss=2.92, val_accuracy=0.382, lr=0.1] 29%|██▉       | 36/125 [12:51<30:41, 20.69s/epoch, loss=1.13, accuracy=0.753, val_loss=2.75, val_accuracy=0.336, lr=0.1] 30%|██▉       | 37/125 [13:12<30:21, 20.70s/epoch, loss=1.13, accuracy=0.753, val_loss=1.53, val_accuracy=0.605, lr=0.1] 30%|███       | 38/125 [13:32<30:01, 20.71s/epoch, loss=1.13, accuracy=0.755, val_loss=1.77, val_accuracy=0.544, lr=0.1] 31%|███       | 39/125 [13:53<29:40, 20.71s/epoch, loss=1.13, accuracy=0.753, val_loss=1.61, val_accuracy=0.628, lr=0.1] 32%|███▏      | 40/125 [14:14<29:19, 20.70s/epoch, loss=1.13, accuracy=0.752, val_loss=2.37, val_accuracy=0.415, lr=0.1] 33%|███▎      | 41/125 [14:34<28:58, 20.70s/epoch, loss=1.13, accuracy=0.751, val_loss=3.23, val_accuracy=0.405, lr=0.1] 34%|███▎      | 42/125 [14:55<28:37, 20.69s/epoch, loss=1.12, accuracy=0.755, val_loss=1.8, val_accuracy=0.539, lr=0.1]  34%|███▍      | 43/125 [15:16<28:19, 20.73s/epoch, loss=1.12, accuracy=0.756, val_loss=2.37, val_accuracy=0.338, lr=0.1] 35%|███▌      | 44/125 [15:37<27:59, 20.73s/epoch, loss=1.13, accuracy=0.756, val_loss=2.21, val_accuracy=0.483, lr=0.1] 36%|███▌      | 45/125 [15:58<27:40, 20.76s/epoch, loss=1.12, accuracy=0.754, val_loss=2.2, val_accuracy=0.447, lr=0.1]  37%|███▋      | 46/125 [16:18<27:19, 20.75s/epoch, loss=1.13, accuracy=0.756, val_loss=2.68, val_accuracy=0.297, lr=0.1] 38%|███▊      | 47/125 [16:39<26:59, 20.77s/epoch, loss=1.12, accuracy=0.756, val_loss=1.95, val_accuracy=0.516, lr=0.1] 38%|███▊      | 48/125 [17:00<26:39, 20.77s/epoch, loss=1.12, accuracy=0.757, val_loss=1.91, val_accuracy=0.546, lr=0.1] 39%|███▉      | 49/125 [17:21<26:18, 20.77s/epoch, loss=1.12, accuracy=0.757, val_loss=1.89, val_accuracy=0.495, lr=0.1] 40%|████      | 50/125 [17:41<25:55, 20.75s/epoch, loss=1.12, accuracy=0.757, val_loss=1.69, val_accuracy=0.558, lr=0.1] 41%|████      | 51/125 [18:02<25:34, 20.74s/epoch, loss=1.11, accuracy=0.757, val_loss=1.98, val_accuracy=0.444, lr=0.1] 42%|████▏     | 52/125 [18:23<25:14, 20.75s/epoch, loss=0.902, accuracy=0.817, val_loss=0.892, val_accuracy=0.802, lr=0.01] 42%|████▏     | 53/125 [18:44<24:55, 20.77s/epoch, loss=0.723, accuracy=0.85, val_loss=0.865, val_accuracy=0.796, lr=0.01]  43%|████▎     | 54/125 [19:05<24:37, 20.81s/epoch, loss=0.644, accuracy=0.857, val_loss=0.695, val_accuracy=0.836, lr=0.01] 44%|████▍     | 55/125 [19:25<24:17, 20.82s/epoch, loss=0.603, accuracy=0.861, val_loss=0.769, val_accuracy=0.807, lr=0.01] 45%|████▍     | 56/125 [19:46<23:57, 20.84s/epoch, loss=0.582, accuracy=0.863, val_loss=0.769, val_accuracy=0.797, lr=0.01] 46%|████▌     | 57/125 [20:07<23:35, 20.82s/epoch, loss=0.571, accuracy=0.864, val_loss=0.83, val_accuracy=0.785, lr=0.01]  46%|████▋     | 58/125 [20:28<23:17, 20.86s/epoch, loss=0.568, accuracy=0.864, val_loss=0.98, val_accuracy=0.751, lr=0.01] 47%|████▋     | 59/125 [20:49<22:55, 20.84s/epoch, loss=0.564, accuracy=0.867, val_loss=0.818, val_accuracy=0.78, lr=0.01] 48%|████▊     | 60/125 [21:10<22:35, 20.86s/epoch, loss=0.557, accuracy=0.871, val_loss=1.03, val_accuracy=0.72, lr=0.01]  49%|████▉     | 61/125 [21:30<22:12, 20.82s/epoch, loss=0.56, accuracy=0.869, val_loss=0.796, val_accuracy=0.804, lr=0.01] 50%|████▉     | 62/125 [21:51<21:49, 20.79s/epoch, loss=0.558, accuracy=0.872, val_loss=0.739, val_accuracy=0.815, lr=0.01] 50%|█████     | 63/125 [22:12<21:28, 20.78s/epoch, loss=0.558, accuracy=0.873, val_loss=1.1, val_accuracy=0.692, lr=0.01]   51%|█████     | 64/125 [22:33<21:06, 20.76s/epoch, loss=0.557, accuracy=0.872, val_loss=0.886, val_accuracy=0.774, lr=0.01] 52%|█████▏    | 65/125 [22:53<20:45, 20.76s/epoch, loss=0.554, accuracy=0.876, val_loss=0.794, val_accuracy=0.798, lr=0.01] 53%|█████▎    | 66/125 [23:14<20:23, 20.74s/epoch, loss=0.552, accuracy=0.876, val_loss=1.02, val_accuracy=0.745, lr=0.01]  54%|█████▎    | 67/125 [23:35<20:01, 20.72s/epoch, loss=0.555, accuracy=0.877, val_loss=0.747, val_accuracy=0.816, lr=0.01] 54%|█████▍    | 68/125 [23:55<19:39, 20.70s/epoch, loss=0.551, accuracy=0.879, val_loss=0.809, val_accuracy=0.811, lr=0.01] 55%|█████▌    | 69/125 [24:16<19:20, 20.73s/epoch, loss=0.554, accuracy=0.878, val_loss=0.868, val_accuracy=0.785, lr=0.01] 56%|█████▌    | 70/125 [24:37<18:59, 20.73s/epoch, loss=0.554, accuracy=0.88, val_loss=0.826, val_accuracy=0.802, lr=0.01]  57%|█████▋    | 71/125 [24:58<18:39, 20.73s/epoch, loss=0.55, accuracy=0.882, val_loss=1.31, val_accuracy=0.685, lr=0.01]  58%|█████▊    | 72/125 [25:18<18:18, 20.73s/epoch, loss=0.548, accuracy=0.882, val_loss=1.24, val_accuracy=0.71, lr=0.01] 58%|█████▊    | 73/125 [25:39<17:57, 20.72s/epoch, loss=0.552, accuracy=0.883, val_loss=0.811, val_accuracy=0.799, lr=0.01] 59%|█████▉    | 74/125 [26:00<17:38, 20.75s/epoch, loss=0.551, accuracy=0.882, val_loss=0.933, val_accuracy=0.785, lr=0.01] 60%|██████    | 75/125 [26:21<17:17, 20.76s/epoch, loss=0.549, accuracy=0.884, val_loss=1.09, val_accuracy=0.753, lr=0.01]  61%|██████    | 76/125 [26:41<16:55, 20.73s/epoch, loss=0.549, accuracy=0.884, val_loss=0.847, val_accuracy=0.799, lr=0.01] 62%|██████▏   | 77/125 [27:02<16:34, 20.71s/epoch, loss=0.472, accuracy=0.911, val_loss=0.528, val_accuracy=0.891, lr=0.001] 62%|██████▏   | 78/125 [27:23<16:13, 20.71s/epoch, loss=0.418, accuracy=0.928, val_loss=0.517, val_accuracy=0.892, lr=0.001] 63%|██████▎   | 79/125 [27:43<15:52, 20.71s/epoch, loss=0.4, accuracy=0.934, val_loss=0.495, val_accuracy=0.9, lr=0.001]     64%|██████▍   | 80/125 [28:04<15:32, 20.72s/epoch, loss=0.382, accuracy=0.937, val_loss=0.489, val_accuracy=0.901, lr=0.001] 65%|██████▍   | 81/125 [28:25<15:10, 20.69s/epoch, loss=0.369, accuracy=0.939, val_loss=0.488, val_accuracy=0.898, lr=0.001] 66%|██████▌   | 82/125 [28:45<14:49, 20.69s/epoch, loss=0.356, accuracy=0.943, val_loss=0.484, val_accuracy=0.898, lr=0.001] 66%|██████▋   | 83/125 [29:06<14:27, 20.66s/epoch, loss=0.343, accuracy=0.945, val_loss=0.47, val_accuracy=0.904, lr=0.001]  67%|██████▋   | 84/125 [29:27<14:06, 20.64s/epoch, loss=0.337, accuracy=0.945, val_loss=0.472, val_accuracy=0.904, lr=0.001] 68%|██████▊   | 85/125 [29:47<13:45, 20.63s/epoch, loss=0.327, accuracy=0.948, val_loss=0.481, val_accuracy=0.898, lr=0.001] 69%|██████▉   | 86/125 [30:08<13:23, 20.61s/epoch, loss=0.319, accuracy=0.949, val_loss=0.463, val_accuracy=0.904, lr=0.001] 70%|██████▉   | 87/125 [30:28<13:02, 20.60s/epoch, loss=0.31, accuracy=0.951, val_loss=0.464, val_accuracy=0.903, lr=0.001]  70%|███████   | 88/125 [30:49<12:42, 20.60s/epoch, loss=0.302, accuracy=0.952, val_loss=0.454, val_accuracy=0.902, lr=0.001] 71%|███████   | 89/125 [31:09<12:20, 20.57s/epoch, loss=0.296, accuracy=0.953, val_loss=0.46, val_accuracy=0.901, lr=0.001]  72%|███████▏  | 90/125 [31:30<12:00, 20.58s/epoch, loss=0.291, accuracy=0.952, val_loss=0.451, val_accuracy=0.903, lr=0.001] 73%|███████▎  | 91/125 [31:51<11:39, 20.58s/epoch, loss=0.28, accuracy=0.955, val_loss=0.445, val_accuracy=0.904, lr=0.001]  74%|███████▎  | 92/125 [32:11<11:19, 20.58s/epoch, loss=0.276, accuracy=0.956, val_loss=0.464, val_accuracy=0.9, lr=0.001]  74%|███████▍  | 93/125 [32:32<10:58, 20.56s/epoch, loss=0.268, accuracy=0.958, val_loss=0.454, val_accuracy=0.901, lr=0.001] 75%|███████▌  | 94/125 [32:52<10:37, 20.56s/epoch, loss=0.264, accuracy=0.958, val_loss=0.456, val_accuracy=0.9, lr=0.001]   76%|███████▌  | 95/125 [33:13<10:15, 20.52s/epoch, loss=0.259, accuracy=0.959, val_loss=0.468, val_accuracy=0.896, lr=0.001] 77%|███████▋  | 96/125 [33:33<09:55, 20.52s/epoch, loss=0.259, accuracy=0.958, val_loss=0.476, val_accuracy=0.893, lr=0.001] 78%|███████▊  | 97/125 [33:54<09:34, 20.53s/epoch, loss=0.251, accuracy=0.959, val_loss=0.469, val_accuracy=0.895, lr=0.001] 78%|███████▊  | 98/125 [34:14<09:14, 20.53s/epoch, loss=0.247, accuracy=0.959, val_loss=0.459, val_accuracy=0.895, lr=0.001] 79%|███████▉  | 99/125 [34:35<08:54, 20.54s/epoch, loss=0.244, accuracy=0.959, val_loss=0.441, val_accuracy=0.898, lr=0.001] 80%|████████  | 100/125 [34:56<08:34, 20.57s/epoch, loss=0.241, accuracy=0.959, val_loss=0.459, val_accuracy=0.894, lr=0.001] 81%|████████  | 101/125 [35:16<08:14, 20.61s/epoch, loss=0.238, accuracy=0.96, val_loss=0.458, val_accuracy=0.899, lr=0.001]  82%|████████▏ | 102/125 [35:37<07:54, 20.61s/epoch, loss=0.221, accuracy=0.966, val_loss=0.412, val_accuracy=0.908, lr=1e-04] 82%|████████▏ | 103/125 [35:57<07:32, 20.58s/epoch, loss=0.212, accuracy=0.97, val_loss=0.411, val_accuracy=0.909, lr=1e-04]  83%|████████▎ | 104/125 [36:18<07:12, 20.58s/epoch, loss=0.206, accuracy=0.972, val_loss=0.408, val_accuracy=0.91, lr=1e-04] 84%|████████▍ | 105/125 [36:38<06:51, 20.57s/epoch, loss=0.203, accuracy=0.974, val_loss=0.408, val_accuracy=0.911, lr=1e-04] 85%|████████▍ | 106/125 [36:59<06:31, 20.61s/epoch, loss=0.202, accuracy=0.974, val_loss=0.409, val_accuracy=0.911, lr=1e-04] 86%|████████▌ | 107/125 [37:20<06:10, 20.60s/epoch, loss=0.203, accuracy=0.973, val_loss=0.41, val_accuracy=0.909, lr=1e-04]  86%|████████▋ | 108/125 [37:40<05:50, 20.64s/epoch, loss=0.199, accuracy=0.975, val_loss=0.409, val_accuracy=0.911, lr=1e-04] 87%|████████▋ | 109/125 [38:01<05:29, 20.60s/epoch, loss=0.198, accuracy=0.975, val_loss=0.409, val_accuracy=0.91, lr=1e-04]  88%|████████▊ | 110/125 [38:21<05:08, 20.57s/epoch, loss=0.196, accuracy=0.976, val_loss=0.407, val_accuracy=0.912, lr=1e-04] 89%|████████▉ | 111/125 [38:42<04:47, 20.53s/epoch, loss=0.194, accuracy=0.976, val_loss=0.409, val_accuracy=0.913, lr=1e-04] 90%|████████▉ | 112/125 [39:03<04:27, 20.54s/epoch, loss=0.193, accuracy=0.976, val_loss=0.407, val_accuracy=0.911, lr=1e-04] 90%|█████████ | 113/125 [39:23<04:06, 20.51s/epoch, loss=0.193, accuracy=0.976, val_loss=0.411, val_accuracy=0.91, lr=1e-04]  91%|█████████ | 114/125 [39:43<03:45, 20.49s/epoch, loss=0.191, accuracy=0.977, val_loss=0.408, val_accuracy=0.911, lr=5e-5] 92%|█████████▏| 115/125 [40:04<03:24, 20.47s/epoch, loss=0.189, accuracy=0.978, val_loss=0.408, val_accuracy=0.911, lr=5e-5] 93%|█████████▎| 116/125 [40:24<03:04, 20.46s/epoch, loss=0.19, accuracy=0.978, val_loss=0.407, val_accuracy=0.911, lr=5e-5]  94%|█████████▎| 117/125 [40:45<02:43, 20.46s/epoch, loss=0.187, accuracy=0.978, val_loss=0.406, val_accuracy=0.911, lr=5e-5] 94%|█████████▍| 118/125 [41:05<02:23, 20.46s/epoch, loss=0.189, accuracy=0.978, val_loss=0.409, val_accuracy=0.91, lr=5e-5]  95%|█████████▌| 119/125 [41:26<02:02, 20.46s/epoch, loss=0.188, accuracy=0.978, val_loss=0.408, val_accuracy=0.911, lr=5e-5] 96%|█████████▌| 120/125 [41:46<01:42, 20.44s/epoch, loss=0.188, accuracy=0.978, val_loss=0.408, val_accuracy=0.911, lr=5e-5] 97%|█████████▋| 121/125 [42:07<01:21, 20.48s/epoch, loss=0.187, accuracy=0.978, val_loss=0.408, val_accuracy=0.91, lr=5e-5]  98%|█████████▊| 122/125 [42:27<01:01, 20.48s/epoch, loss=0.186, accuracy=0.979, val_loss=0.406, val_accuracy=0.912, lr=5e-5] 98%|█████████▊| 123/125 [42:48<00:40, 20.50s/epoch, loss=0.185, accuracy=0.979, val_loss=0.408, val_accuracy=0.911, lr=5e-5] 99%|█████████▉| 124/125 [43:08<00:20, 20.54s/epoch, loss=0.185, accuracy=0.979, val_loss=0.406, val_accuracy=0.911, lr=5e-5]100%|██████████| 125/125 [43:29<00:00, 20.54s/epoch, loss=0.185, accuracy=0.978, val_loss=0.407, val_accuracy=0.91, lr=5e-5] 100%|██████████| 125/125 [43:29<00:00, 20.87s/epoch, loss=0.185, accuracy=0.978, val_loss=0.407, val_accuracy=0.91, lr=5e-5]
Using real-time data augmentation.
Only one model saved

Loading model: 12_05_cifar10_ResNet20v1.h5
Test score: 0.40736475586891174
Test accuracy: 0.909500002861023


* * * Run SGD for ID = 12_6. * * *


2024-03-13 05:51:11.535745: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 05:51:14.189846: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 05:51:14.190844: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-13 05:51:14.230585: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-13 05:51:14.230623: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 05:51:14.233407: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 05:51:14.233452: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 05:51:14.235555: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 05:51:14.236244: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 05:51:14.238698: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 05:51:14.240196: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 05:51:14.244930: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 05:51:14.245432: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 05:51:14.245512: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 05:51:15.590445: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-13 05:51:15.591000: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 05:51:15.591764: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-13 05:51:15.591796: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 05:51:15.591859: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 05:51:15.591880: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 05:51:15.591898: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 05:51:15.591915: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 05:51:15.591933: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 05:51:15.591952: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 05:51:15.591971: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 05:51:15.592420: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 05:51:15.592455: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 05:51:16.301910: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-13 05:51:16.301958: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-13 05:51:16.301967: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-13 05:51:16.303396: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:83:00.0, compute capability: 6.1)
{'id': '12_06', 'seed': 6, 'out_folder': 'results/epoch_budget_2', 'batch_size': 128, 'epochs': 125, 'validation_split': 0.0, 'checkpointing': False, 'checkpoint_every': -1, 'hold_out_validation_split': 0.0, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'num_classes': 10, 'SSE_lr': False, 'test_time_augmentation': False, 'debug': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
y_train shape: (50000, 10)
x_val shape: (10000, 32, 32, 3)
y_val shape: (10000, 10)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/125 [00:00<?, ?epoch/s]2024-03-13 05:51:16.985659: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-13 05:51:16.997967: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199945000 Hz
2024-03-13 05:51:19.182240: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 05:51:19.423017: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 05:51:20.189712: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-13 05:51:20.222121: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/125 [00:48<1:40:19, 48.54s/epoch, loss=3.06, accuracy=0.344, val_loss=2.2, val_accuracy=0.283, lr=0.1]  2%|▏         | 2/125 [01:10<1:07:08, 32.75s/epoch, loss=1.49, accuracy=0.566, val_loss=1.78, val_accuracy=0.501, lr=0.1]  2%|▏         | 3/125 [01:31<56:17, 27.69s/epoch, loss=1.31, accuracy=0.657, val_loss=2.18, val_accuracy=0.434, lr=0.1]    3%|▎         | 4/125 [01:53<50:56, 25.26s/epoch, loss=1.26, accuracy=0.685, val_loss=1.99, val_accuracy=0.443, lr=0.1]  4%|▍         | 5/125 [02:15<47:52, 23.93s/epoch, loss=1.25, accuracy=0.698, val_loss=2.21, val_accuracy=0.441, lr=0.1]  5%|▍         | 6/125 [02:36<45:48, 23.10s/epoch, loss=1.23, accuracy=0.711, val_loss=1.84, val_accuracy=0.536, lr=0.1]  6%|▌         | 7/125 [02:58<44:27, 22.61s/epoch, loss=1.22, accuracy=0.715, val_loss=1.93, val_accuracy=0.501, lr=0.1]  6%|▋         | 8/125 [03:19<43:25, 22.27s/epoch, loss=1.21, accuracy=0.723, val_loss=1.68, val_accuracy=0.575, lr=0.1]  7%|▋         | 9/125 [03:41<42:37, 22.05s/epoch, loss=1.21, accuracy=0.726, val_loss=1.79, val_accuracy=0.54, lr=0.1]   8%|▊         | 10/125 [04:02<42:01, 21.92s/epoch, loss=1.2, accuracy=0.731, val_loss=2.78, val_accuracy=0.319, lr=0.1]  9%|▉         | 11/125 [04:24<41:27, 21.82s/epoch, loss=1.19, accuracy=0.732, val_loss=2.02, val_accuracy=0.457, lr=0.1] 10%|▉         | 12/125 [04:46<40:57, 21.74s/epoch, loss=1.19, accuracy=0.734, val_loss=1.65, val_accuracy=0.598, lr=0.1] 10%|█         | 13/125 [05:07<40:30, 21.70s/epoch, loss=1.18, accuracy=0.735, val_loss=1.74, val_accuracy=0.553, lr=0.1] 11%|█         | 14/125 [05:29<40:04, 21.66s/epoch, loss=1.18, accuracy=0.736, val_loss=2.68, val_accuracy=0.306, lr=0.1] 12%|█▏        | 15/125 [05:50<39:41, 21.65s/epoch, loss=1.18, accuracy=0.739, val_loss=1.49, val_accuracy=0.627, lr=0.1] 13%|█▎        | 16/125 [06:12<39:17, 21.62s/epoch, loss=1.18, accuracy=0.74, val_loss=1.53, val_accuracy=0.627, lr=0.1]  14%|█▎        | 17/125 [06:33<38:53, 21.61s/epoch, loss=1.18, accuracy=0.74, val_loss=2.44, val_accuracy=0.39, lr=0.1]  14%|█▍        | 18/125 [06:55<38:30, 21.60s/epoch, loss=1.18, accuracy=0.742, val_loss=3.49, val_accuracy=0.262, lr=0.1] 15%|█▌        | 19/125 [07:17<38:10, 21.61s/epoch, loss=1.19, accuracy=0.743, val_loss=1.64, val_accuracy=0.626, lr=0.1] 16%|█▌        | 20/125 [07:38<37:49, 21.61s/epoch, loss=1.17, accuracy=0.743, val_loss=1.84, val_accuracy=0.525, lr=0.1] 17%|█▋        | 21/125 [08:00<37:30, 21.64s/epoch, loss=1.17, accuracy=0.745, val_loss=1.99, val_accuracy=0.504, lr=0.1] 18%|█▊        | 22/125 [08:22<37:09, 21.64s/epoch, loss=1.17, accuracy=0.746, val_loss=3.3, val_accuracy=0.241, lr=0.1]  18%|█▊        | 23/125 [08:43<36:47, 21.65s/epoch, loss=1.17, accuracy=0.744, val_loss=2.7, val_accuracy=0.463, lr=0.1] 19%|█▉        | 24/125 [09:05<36:26, 21.64s/epoch, loss=1.16, accuracy=0.747, val_loss=1.78, val_accuracy=0.603, lr=0.1] 20%|██        | 25/125 [09:26<36:02, 21.63s/epoch, loss=1.16, accuracy=0.745, val_loss=1.83, val_accuracy=0.535, lr=0.1] 21%|██        | 26/125 [09:48<35:41, 21.64s/epoch, loss=1.16, accuracy=0.747, val_loss=1.87, val_accuracy=0.502, lr=0.1] 22%|██▏       | 27/125 [10:10<35:17, 21.61s/epoch, loss=1.16, accuracy=0.747, val_loss=1.78, val_accuracy=0.555, lr=0.1] 22%|██▏       | 28/125 [10:31<34:56, 21.61s/epoch, loss=1.15, accuracy=0.751, val_loss=2.01, val_accuracy=0.535, lr=0.1] 23%|██▎       | 29/125 [10:53<34:32, 21.59s/epoch, loss=1.15, accuracy=0.749, val_loss=1.71, val_accuracy=0.616, lr=0.1] 24%|██▍       | 30/125 [11:14<34:11, 21.59s/epoch, loss=1.15, accuracy=0.752, val_loss=1.95, val_accuracy=0.521, lr=0.1] 25%|██▍       | 31/125 [11:36<33:49, 21.59s/epoch, loss=1.15, accuracy=0.75, val_loss=1.56, val_accuracy=0.586, lr=0.1]  26%|██▌       | 32/125 [11:58<33:29, 21.61s/epoch, loss=1.15, accuracy=0.751, val_loss=1.96, val_accuracy=0.513, lr=0.1] 26%|██▋       | 33/125 [12:19<33:09, 21.62s/epoch, loss=1.14, accuracy=0.752, val_loss=2.25, val_accuracy=0.487, lr=0.1] 27%|██▋       | 34/125 [12:41<32:45, 21.60s/epoch, loss=1.15, accuracy=0.751, val_loss=1.7, val_accuracy=0.593, lr=0.1]  28%|██▊       | 35/125 [13:03<32:24, 21.60s/epoch, loss=1.15, accuracy=0.751, val_loss=2.02, val_accuracy=0.522, lr=0.1] 29%|██▉       | 36/125 [13:24<32:01, 21.59s/epoch, loss=1.14, accuracy=0.75, val_loss=2.74, val_accuracy=0.355, lr=0.1]  30%|██▉       | 37/125 [13:46<31:40, 21.60s/epoch, loss=1.14, accuracy=0.753, val_loss=1.82, val_accuracy=0.504, lr=0.1] 30%|███       | 38/125 [14:07<31:19, 21.60s/epoch, loss=1.14, accuracy=0.75, val_loss=3.77, val_accuracy=0.281, lr=0.1]  31%|███       | 39/125 [14:29<30:59, 21.62s/epoch, loss=1.14, accuracy=0.753, val_loss=2.67, val_accuracy=0.372, lr=0.1] 32%|███▏      | 40/125 [14:51<30:36, 21.60s/epoch, loss=1.14, accuracy=0.753, val_loss=1.4, val_accuracy=0.672, lr=0.1]  33%|███▎      | 41/125 [15:12<30:12, 21.58s/epoch, loss=1.14, accuracy=0.753, val_loss=1.46, val_accuracy=0.651, lr=0.1] 34%|███▎      | 42/125 [15:34<29:52, 21.60s/epoch, loss=1.13, accuracy=0.755, val_loss=4.11, val_accuracy=0.361, lr=0.1] 34%|███▍      | 43/125 [15:55<29:32, 21.61s/epoch, loss=1.13, accuracy=0.754, val_loss=1.98, val_accuracy=0.488, lr=0.1] 35%|███▌      | 44/125 [16:17<29:12, 21.63s/epoch, loss=1.12, accuracy=0.757, val_loss=1.83, val_accuracy=0.567, lr=0.1] 36%|███▌      | 45/125 [16:39<28:54, 21.68s/epoch, loss=1.13, accuracy=0.752, val_loss=1.87, val_accuracy=0.564, lr=0.1] 37%|███▋      | 46/125 [17:00<28:31, 21.67s/epoch, loss=1.13, accuracy=0.754, val_loss=2.47, val_accuracy=0.416, lr=0.1] 38%|███▊      | 47/125 [17:22<28:11, 21.68s/epoch, loss=1.13, accuracy=0.754, val_loss=1.92, val_accuracy=0.504, lr=0.1] 38%|███▊      | 48/125 [17:44<27:49, 21.68s/epoch, loss=1.13, accuracy=0.758, val_loss=3.34, val_accuracy=0.313, lr=0.1] 39%|███▉      | 49/125 [18:05<27:27, 21.67s/epoch, loss=1.13, accuracy=0.755, val_loss=2.26, val_accuracy=0.405, lr=0.1] 40%|████      | 50/125 [18:27<27:08, 21.71s/epoch, loss=1.13, accuracy=0.752, val_loss=2.29, val_accuracy=0.359, lr=0.1] 41%|████      | 51/125 [18:49<26:46, 21.70s/epoch, loss=1.13, accuracy=0.755, val_loss=1.47, val_accuracy=0.649, lr=0.1] 42%|████▏     | 52/125 [19:11<26:22, 21.68s/epoch, loss=0.899, accuracy=0.817, val_loss=1, val_accuracy=0.771, lr=0.01]  42%|████▏     | 53/125 [19:32<26:01, 21.68s/epoch, loss=0.73, accuracy=0.848, val_loss=0.791, val_accuracy=0.817, lr=0.01] 43%|████▎     | 54/125 [19:54<25:41, 21.71s/epoch, loss=0.65, accuracy=0.857, val_loss=0.822, val_accuracy=0.79, lr=0.01]  44%|████▍     | 55/125 [20:16<25:19, 21.70s/epoch, loss=0.61, accuracy=0.859, val_loss=0.905, val_accuracy=0.757, lr=0.01] 45%|████▍     | 56/125 [20:37<24:56, 21.69s/epoch, loss=0.586, accuracy=0.861, val_loss=0.767, val_accuracy=0.798, lr=0.01] 46%|████▌     | 57/125 [20:59<24:36, 21.72s/epoch, loss=0.578, accuracy=0.863, val_loss=0.778, val_accuracy=0.792, lr=0.01] 46%|████▋     | 58/125 [21:21<24:15, 21.73s/epoch, loss=0.574, accuracy=0.862, val_loss=1.46, val_accuracy=0.649, lr=0.01]  47%|████▋     | 59/125 [21:43<23:52, 21.71s/epoch, loss=0.571, accuracy=0.863, val_loss=0.73, val_accuracy=0.808, lr=0.01] 48%|████▊     | 60/125 [22:04<23:31, 21.72s/epoch, loss=0.566, accuracy=0.866, val_loss=0.78, val_accuracy=0.805, lr=0.01] 49%|████▉     | 61/125 [22:26<23:09, 21.71s/epoch, loss=0.56, accuracy=0.868, val_loss=0.742, val_accuracy=0.811, lr=0.01] 50%|████▉     | 62/125 [22:48<22:46, 21.69s/epoch, loss=0.561, accuracy=0.87, val_loss=0.841, val_accuracy=0.787, lr=0.01] 50%|█████     | 63/125 [23:09<22:23, 21.67s/epoch, loss=0.559, accuracy=0.871, val_loss=0.84, val_accuracy=0.781, lr=0.01] 51%|█████     | 64/125 [23:31<22:01, 21.66s/epoch, loss=0.562, accuracy=0.87, val_loss=0.724, val_accuracy=0.817, lr=0.01] 52%|█████▏    | 65/125 [23:53<21:38, 21.63s/epoch, loss=0.56, accuracy=0.873, val_loss=0.922, val_accuracy=0.778, lr=0.01] 53%|█████▎    | 66/125 [24:14<21:16, 21.63s/epoch, loss=0.555, accuracy=0.874, val_loss=0.919, val_accuracy=0.775, lr=0.01] 54%|█████▎    | 67/125 [24:36<20:53, 21.61s/epoch, loss=0.557, accuracy=0.874, val_loss=0.748, val_accuracy=0.811, lr=0.01] 54%|█████▍    | 68/125 [24:57<20:32, 21.62s/epoch, loss=0.557, accuracy=0.875, val_loss=0.862, val_accuracy=0.777, lr=0.01] 55%|█████▌    | 69/125 [25:19<20:10, 21.62s/epoch, loss=0.555, accuracy=0.878, val_loss=0.798, val_accuracy=0.802, lr=0.01] 56%|█████▌    | 70/125 [25:41<19:49, 21.62s/epoch, loss=0.553, accuracy=0.879, val_loss=0.827, val_accuracy=0.799, lr=0.01] 57%|█████▋    | 71/125 [26:02<19:27, 21.62s/epoch, loss=0.554, accuracy=0.878, val_loss=1.13, val_accuracy=0.729, lr=0.01]  58%|█████▊    | 72/125 [26:24<19:05, 21.61s/epoch, loss=0.559, accuracy=0.877, val_loss=1.06, val_accuracy=0.741, lr=0.01] 58%|█████▊    | 73/125 [26:45<18:41, 21.58s/epoch, loss=0.557, accuracy=0.879, val_loss=0.794, val_accuracy=0.802, lr=0.01] 59%|█████▉    | 74/125 [27:07<18:20, 21.59s/epoch, loss=0.555, accuracy=0.878, val_loss=1.23, val_accuracy=0.683, lr=0.01]  60%|██████    | 75/125 [27:29<18:00, 21.61s/epoch, loss=0.554, accuracy=0.88, val_loss=1.17, val_accuracy=0.73, lr=0.01]   61%|██████    | 76/125 [27:50<17:38, 21.60s/epoch, loss=0.555, accuracy=0.882, val_loss=0.854, val_accuracy=0.791, lr=0.01] 62%|██████▏   | 77/125 [28:12<17:16, 21.59s/epoch, loss=0.478, accuracy=0.908, val_loss=0.545, val_accuracy=0.882, lr=0.001] 62%|██████▏   | 78/125 [28:33<16:56, 21.63s/epoch, loss=0.426, accuracy=0.925, val_loss=0.526, val_accuracy=0.888, lr=0.001] 63%|██████▎   | 79/125 [28:55<16:33, 21.60s/epoch, loss=0.406, accuracy=0.929, val_loss=0.51, val_accuracy=0.891, lr=0.001]  64%|██████▍   | 80/125 [29:16<16:11, 21.59s/epoch, loss=0.388, accuracy=0.934, val_loss=0.496, val_accuracy=0.894, lr=0.001] 65%|██████▍   | 81/125 [29:38<15:48, 21.56s/epoch, loss=0.376, accuracy=0.935, val_loss=0.496, val_accuracy=0.894, lr=0.001] 66%|██████▌   | 82/125 [29:59<15:26, 21.54s/epoch, loss=0.361, accuracy=0.938, val_loss=0.491, val_accuracy=0.894, lr=0.001] 66%|██████▋   | 83/125 [30:21<15:04, 21.54s/epoch, loss=0.35, accuracy=0.941, val_loss=0.487, val_accuracy=0.896, lr=0.001]  67%|██████▋   | 84/125 [30:43<14:42, 21.53s/epoch, loss=0.343, accuracy=0.941, val_loss=0.474, val_accuracy=0.9, lr=0.001]  68%|██████▊   | 85/125 [31:04<14:20, 21.50s/epoch, loss=0.332, accuracy=0.944, val_loss=0.487, val_accuracy=0.896, lr=0.001] 69%|██████▉   | 86/125 [31:26<13:59, 21.52s/epoch, loss=0.325, accuracy=0.944, val_loss=0.476, val_accuracy=0.896, lr=0.001] 70%|██████▉   | 87/125 [31:47<13:37, 21.51s/epoch, loss=0.318, accuracy=0.947, val_loss=0.488, val_accuracy=0.891, lr=0.001] 70%|███████   | 88/125 [32:08<13:15, 21.50s/epoch, loss=0.311, accuracy=0.946, val_loss=0.469, val_accuracy=0.897, lr=0.001] 71%|███████   | 89/125 [32:30<12:53, 21.49s/epoch, loss=0.3, accuracy=0.95, val_loss=0.46, val_accuracy=0.899, lr=0.001]     72%|███████▏  | 90/125 [32:51<12:31, 21.48s/epoch, loss=0.297, accuracy=0.949, val_loss=0.469, val_accuracy=0.899, lr=0.001] 73%|███████▎  | 91/125 [33:13<12:09, 21.46s/epoch, loss=0.291, accuracy=0.95, val_loss=0.469, val_accuracy=0.898, lr=0.001]  74%|███████▎  | 92/125 [33:34<11:49, 21.51s/epoch, loss=0.282, accuracy=0.952, val_loss=0.463, val_accuracy=0.899, lr=0.001] 74%|███████▍  | 93/125 [33:56<11:30, 21.57s/epoch, loss=0.278, accuracy=0.952, val_loss=0.448, val_accuracy=0.901, lr=0.001] 75%|███████▌  | 94/125 [34:18<11:08, 21.57s/epoch, loss=0.275, accuracy=0.953, val_loss=0.472, val_accuracy=0.892, lr=0.001] 76%|███████▌  | 95/125 [34:39<10:46, 21.54s/epoch, loss=0.27, accuracy=0.953, val_loss=0.465, val_accuracy=0.895, lr=0.001]  77%|███████▋  | 96/125 [35:01<10:23, 21.51s/epoch, loss=0.266, accuracy=0.953, val_loss=0.495, val_accuracy=0.888, lr=0.001] 78%|███████▊  | 97/125 [35:22<10:01, 21.49s/epoch, loss=0.258, accuracy=0.955, val_loss=0.508, val_accuracy=0.887, lr=0.001] 78%|███████▊  | 98/125 [35:44<09:40, 21.50s/epoch, loss=0.256, accuracy=0.955, val_loss=0.456, val_accuracy=0.894, lr=0.001] 79%|███████▉  | 99/125 [36:05<09:19, 21.51s/epoch, loss=0.253, accuracy=0.956, val_loss=0.499, val_accuracy=0.887, lr=0.001] 80%|████████  | 100/125 [36:27<08:57, 21.51s/epoch, loss=0.25, accuracy=0.956, val_loss=0.462, val_accuracy=0.893, lr=0.001] 81%|████████  | 101/125 [36:48<08:36, 21.52s/epoch, loss=0.245, accuracy=0.956, val_loss=0.446, val_accuracy=0.897, lr=0.001] 82%|████████▏ | 102/125 [37:10<08:15, 21.54s/epoch, loss=0.224, accuracy=0.965, val_loss=0.416, val_accuracy=0.903, lr=1e-04] 82%|████████▏ | 103/125 [37:31<07:53, 21.53s/epoch, loss=0.217, accuracy=0.967, val_loss=0.411, val_accuracy=0.906, lr=1e-04] 83%|████████▎ | 104/125 [37:53<07:32, 21.52s/epoch, loss=0.212, accuracy=0.97, val_loss=0.416, val_accuracy=0.906, lr=1e-04]  84%|████████▍ | 105/125 [38:14<07:10, 21.50s/epoch, loss=0.21, accuracy=0.969, val_loss=0.413, val_accuracy=0.906, lr=1e-04] 85%|████████▍ | 106/125 [38:36<06:48, 21.49s/epoch, loss=0.207, accuracy=0.972, val_loss=0.414, val_accuracy=0.907, lr=1e-04] 86%|████████▌ | 107/125 [38:57<06:26, 21.48s/epoch, loss=0.205, accuracy=0.972, val_loss=0.412, val_accuracy=0.907, lr=1e-04] 86%|████████▋ | 108/125 [39:19<06:04, 21.46s/epoch, loss=0.202, accuracy=0.973, val_loss=0.414, val_accuracy=0.907, lr=1e-04] 87%|████████▋ | 109/125 [39:40<05:43, 21.45s/epoch, loss=0.201, accuracy=0.973, val_loss=0.416, val_accuracy=0.909, lr=1e-04] 88%|████████▊ | 110/125 [40:01<05:21, 21.43s/epoch, loss=0.2, accuracy=0.974, val_loss=0.417, val_accuracy=0.906, lr=1e-04]   89%|████████▉ | 111/125 [40:23<04:59, 21.42s/epoch, loss=0.2, accuracy=0.973, val_loss=0.416, val_accuracy=0.909, lr=1e-04] 90%|████████▉ | 112/125 [40:44<04:38, 21.43s/epoch, loss=0.197, accuracy=0.974, val_loss=0.418, val_accuracy=0.909, lr=1e-04] 90%|█████████ | 113/125 [41:06<04:17, 21.43s/epoch, loss=0.196, accuracy=0.974, val_loss=0.417, val_accuracy=0.907, lr=1e-04] 91%|█████████ | 114/125 [41:27<03:55, 21.41s/epoch, loss=0.195, accuracy=0.975, val_loss=0.417, val_accuracy=0.908, lr=5e-5]  92%|█████████▏| 115/125 [41:48<03:33, 21.39s/epoch, loss=0.193, accuracy=0.976, val_loss=0.417, val_accuracy=0.908, lr=5e-5] 93%|█████████▎| 116/125 [42:10<03:12, 21.38s/epoch, loss=0.192, accuracy=0.976, val_loss=0.415, val_accuracy=0.908, lr=5e-5] 94%|█████████▎| 117/125 [42:31<02:51, 21.38s/epoch, loss=0.193, accuracy=0.975, val_loss=0.417, val_accuracy=0.908, lr=5e-5] 94%|█████████▍| 118/125 [42:52<02:29, 21.37s/epoch, loss=0.194, accuracy=0.975, val_loss=0.415, val_accuracy=0.907, lr=5e-5] 95%|█████████▌| 119/125 [43:14<02:08, 21.37s/epoch, loss=0.191, accuracy=0.976, val_loss=0.417, val_accuracy=0.908, lr=5e-5] 96%|█████████▌| 120/125 [43:35<01:46, 21.39s/epoch, loss=0.191, accuracy=0.976, val_loss=0.418, val_accuracy=0.908, lr=5e-5] 97%|█████████▋| 121/125 [43:57<01:25, 21.39s/epoch, loss=0.19, accuracy=0.977, val_loss=0.416, val_accuracy=0.908, lr=5e-5]  98%|█████████▊| 122/125 [44:18<01:04, 21.39s/epoch, loss=0.189, accuracy=0.976, val_loss=0.416, val_accuracy=0.908, lr=5e-5] 98%|█████████▊| 123/125 [44:39<00:42, 21.40s/epoch, loss=0.191, accuracy=0.976, val_loss=0.417, val_accuracy=0.908, lr=5e-5] 99%|█████████▉| 124/125 [45:01<00:21, 21.43s/epoch, loss=0.19, accuracy=0.976, val_loss=0.417, val_accuracy=0.907, lr=5e-5] 100%|██████████| 125/125 [45:22<00:00, 21.44s/epoch, loss=0.188, accuracy=0.977, val_loss=0.417, val_accuracy=0.909, lr=5e-5]100%|██████████| 125/125 [45:22<00:00, 21.78s/epoch, loss=0.188, accuracy=0.977, val_loss=0.417, val_accuracy=0.909, lr=5e-5]
Using real-time data augmentation.
Only one model saved

Loading model: 12_06_cifar10_ResNet20v1.h5
Test score: 0.4172084927558899
Test accuracy: 0.9085000157356262


* * * Run SGD for ID = 12_7. * * *


2024-03-13 06:36:43.384332: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 06:36:46.126930: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 06:36:46.128047: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-13 06:36:46.168941: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-13 06:36:46.168977: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 06:36:46.171656: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 06:36:46.171700: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 06:36:46.173824: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 06:36:46.174908: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 06:36:46.177284: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 06:36:46.178791: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 06:36:46.183413: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 06:36:46.185334: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 06:36:46.185417: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 06:36:47.493585: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-13 06:36:47.494113: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 06:36:47.494878: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-13 06:36:47.494912: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 06:36:47.494950: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 06:36:47.494969: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 06:36:47.494987: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 06:36:47.495004: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 06:36:47.495023: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 06:36:47.495043: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 06:36:47.495062: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 06:36:47.495499: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 06:36:47.495534: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 06:36:48.181047: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-13 06:36:48.181103: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-13 06:36:48.181113: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-13 06:36:48.182001: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:83:00.0, compute capability: 6.1)
{'id': '12_07', 'seed': 7, 'out_folder': 'results/epoch_budget_2', 'batch_size': 128, 'epochs': 125, 'validation_split': 0.0, 'checkpointing': False, 'checkpoint_every': -1, 'hold_out_validation_split': 0.0, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'num_classes': 10, 'SSE_lr': False, 'test_time_augmentation': False, 'debug': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
y_train shape: (50000, 10)
x_val shape: (10000, 32, 32, 3)
y_val shape: (10000, 10)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/125 [00:00<?, ?epoch/s]2024-03-13 06:36:48.848126: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-13 06:36:48.859959: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199945000 Hz
2024-03-13 06:36:51.059532: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 06:36:51.283690: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 06:36:52.052744: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-13 06:36:52.087801: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/125 [00:47<1:37:46, 47.31s/epoch, loss=3.12, accuracy=0.33, val_loss=2.55, val_accuracy=0.231, lr=0.1]  2%|▏         | 2/125 [01:07<1:04:48, 31.61s/epoch, loss=1.6, accuracy=0.515, val_loss=2.45, val_accuracy=0.36, lr=0.1]   2%|▏         | 3/125 [01:28<53:58, 26.55s/epoch, loss=1.38, accuracy=0.622, val_loss=3.12, val_accuracy=0.284, lr=0.1]  3%|▎         | 4/125 [01:48<48:41, 24.14s/epoch, loss=1.29, accuracy=0.672, val_loss=2.38, val_accuracy=0.404, lr=0.1]  4%|▍         | 5/125 [02:09<45:41, 22.85s/epoch, loss=1.26, accuracy=0.692, val_loss=1.61, val_accuracy=0.566, lr=0.1]  5%|▍         | 6/125 [02:29<43:38, 22.00s/epoch, loss=1.24, accuracy=0.704, val_loss=1.63, val_accuracy=0.614, lr=0.1]  6%|▌         | 7/125 [02:50<42:15, 21.49s/epoch, loss=1.22, accuracy=0.712, val_loss=2.09, val_accuracy=0.445, lr=0.1]  6%|▋         | 8/125 [03:10<41:15, 21.16s/epoch, loss=1.22, accuracy=0.721, val_loss=2.1, val_accuracy=0.45, lr=0.1]    7%|▋         | 9/125 [03:31<40:26, 20.92s/epoch, loss=1.22, accuracy=0.722, val_loss=2.49, val_accuracy=0.369, lr=0.1]  8%|▊         | 10/125 [03:51<39:47, 20.76s/epoch, loss=1.21, accuracy=0.725, val_loss=1.99, val_accuracy=0.459, lr=0.1]  9%|▉         | 11/125 [04:11<39:14, 20.66s/epoch, loss=1.19, accuracy=0.729, val_loss=2.05, val_accuracy=0.465, lr=0.1] 10%|▉         | 12/125 [04:32<38:47, 20.60s/epoch, loss=1.21, accuracy=0.732, val_loss=2.37, val_accuracy=0.479, lr=0.1] 10%|█         | 13/125 [04:52<38:19, 20.54s/epoch, loss=1.2, accuracy=0.734, val_loss=1.68, val_accuracy=0.585, lr=0.1]  11%|█         | 14/125 [05:13<37:55, 20.50s/epoch, loss=1.2, accuracy=0.733, val_loss=1.82, val_accuracy=0.544, lr=0.1] 12%|█▏        | 15/125 [05:33<37:31, 20.47s/epoch, loss=1.2, accuracy=0.735, val_loss=1.75, val_accuracy=0.548, lr=0.1] 13%|█▎        | 16/125 [05:54<37:13, 20.49s/epoch, loss=1.19, accuracy=0.734, val_loss=2.61, val_accuracy=0.359, lr=0.1] 14%|█▎        | 17/125 [06:14<36:51, 20.48s/epoch, loss=1.19, accuracy=0.737, val_loss=1.91, val_accuracy=0.522, lr=0.1] 14%|█▍        | 18/125 [06:35<36:29, 20.46s/epoch, loss=1.2, accuracy=0.734, val_loss=2.38, val_accuracy=0.378, lr=0.1]  15%|█▌        | 19/125 [06:55<36:10, 20.48s/epoch, loss=1.18, accuracy=0.741, val_loss=1.72, val_accuracy=0.573, lr=0.1] 16%|█▌        | 20/125 [07:16<35:50, 20.48s/epoch, loss=1.19, accuracy=0.739, val_loss=2.3, val_accuracy=0.501, lr=0.1]  17%|█▋        | 21/125 [07:36<35:31, 20.49s/epoch, loss=1.19, accuracy=0.74, val_loss=1.5, val_accuracy=0.626, lr=0.1]  18%|█▊        | 22/125 [07:57<35:11, 20.50s/epoch, loss=1.18, accuracy=0.74, val_loss=1.93, val_accuracy=0.535, lr=0.1] 18%|█▊        | 23/125 [08:17<34:53, 20.53s/epoch, loss=1.18, accuracy=0.739, val_loss=1.45, val_accuracy=0.644, lr=0.1] 19%|█▉        | 24/125 [08:38<34:32, 20.52s/epoch, loss=1.19, accuracy=0.739, val_loss=2.36, val_accuracy=0.413, lr=0.1] 20%|██        | 25/125 [08:58<34:10, 20.50s/epoch, loss=1.19, accuracy=0.741, val_loss=2.25, val_accuracy=0.487, lr=0.1] 21%|██        | 26/125 [09:19<33:49, 20.50s/epoch, loss=1.18, accuracy=0.742, val_loss=1.55, val_accuracy=0.589, lr=0.1] 22%|██▏       | 27/125 [09:39<33:31, 20.52s/epoch, loss=1.18, accuracy=0.744, val_loss=1.51, val_accuracy=0.618, lr=0.1] 22%|██▏       | 28/125 [10:00<33:08, 20.50s/epoch, loss=1.18, accuracy=0.743, val_loss=1.9, val_accuracy=0.52, lr=0.1]   23%|██▎       | 29/125 [10:20<32:45, 20.47s/epoch, loss=1.18, accuracy=0.745, val_loss=1.64, val_accuracy=0.614, lr=0.1] 24%|██▍       | 30/125 [10:40<32:23, 20.46s/epoch, loss=1.18, accuracy=0.743, val_loss=6.83, val_accuracy=0.208, lr=0.1] 25%|██▍       | 31/125 [11:01<32:02, 20.45s/epoch, loss=1.18, accuracy=0.744, val_loss=2.81, val_accuracy=0.396, lr=0.1] 26%|██▌       | 32/125 [11:21<31:43, 20.47s/epoch, loss=1.17, accuracy=0.748, val_loss=1.56, val_accuracy=0.595, lr=0.1] 26%|██▋       | 33/125 [11:42<31:24, 20.48s/epoch, loss=1.17, accuracy=0.746, val_loss=2.03, val_accuracy=0.486, lr=0.1] 27%|██▋       | 34/125 [12:02<31:03, 20.48s/epoch, loss=1.17, accuracy=0.746, val_loss=1.7, val_accuracy=0.55, lr=0.1]   28%|██▊       | 35/125 [12:23<30:42, 20.47s/epoch, loss=1.17, accuracy=0.747, val_loss=3.18, val_accuracy=0.258, lr=0.1] 29%|██▉       | 36/125 [12:43<30:21, 20.46s/epoch, loss=1.17, accuracy=0.746, val_loss=1.73, val_accuracy=0.58, lr=0.1]  30%|██▉       | 37/125 [13:04<29:59, 20.45s/epoch, loss=1.18, accuracy=0.745, val_loss=1.88, val_accuracy=0.469, lr=0.1] 30%|███       | 38/125 [13:24<29:37, 20.44s/epoch, loss=1.17, accuracy=0.749, val_loss=3.12, val_accuracy=0.404, lr=0.1] 31%|███       | 39/125 [13:45<29:19, 20.46s/epoch, loss=1.16, accuracy=0.749, val_loss=2.44, val_accuracy=0.429, lr=0.1] 32%|███▏      | 40/125 [14:05<28:59, 20.46s/epoch, loss=1.17, accuracy=0.747, val_loss=1.79, val_accuracy=0.546, lr=0.1] 33%|███▎      | 41/125 [14:26<28:39, 20.46s/epoch, loss=1.17, accuracy=0.75, val_loss=2.9, val_accuracy=0.33, lr=0.1]    34%|███▎      | 42/125 [14:46<28:18, 20.46s/epoch, loss=1.16, accuracy=0.75, val_loss=2.14, val_accuracy=0.471, lr=0.1] 34%|███▍      | 43/125 [15:07<28:01, 20.51s/epoch, loss=1.17, accuracy=0.748, val_loss=1.93, val_accuracy=0.531, lr=0.1] 35%|███▌      | 44/125 [15:27<27:43, 20.53s/epoch, loss=1.16, accuracy=0.75, val_loss=2.28, val_accuracy=0.468, lr=0.1]  36%|███▌      | 45/125 [15:48<27:24, 20.56s/epoch, loss=1.15, accuracy=0.751, val_loss=1.36, val_accuracy=0.686, lr=0.1] 37%|███▋      | 46/125 [16:08<27:05, 20.57s/epoch, loss=1.15, accuracy=0.751, val_loss=3.28, val_accuracy=0.29, lr=0.1]  38%|███▊      | 47/125 [16:29<26:45, 20.58s/epoch, loss=1.16, accuracy=0.751, val_loss=2.12, val_accuracy=0.458, lr=0.1] 38%|███▊      | 48/125 [16:50<26:26, 20.61s/epoch, loss=1.16, accuracy=0.752, val_loss=3.42, val_accuracy=0.38, lr=0.1]  39%|███▉      | 49/125 [17:10<26:04, 20.58s/epoch, loss=1.15, accuracy=0.752, val_loss=2.1, val_accuracy=0.537, lr=0.1] 40%|████      | 50/125 [17:31<25:41, 20.55s/epoch, loss=1.16, accuracy=0.75, val_loss=2.44, val_accuracy=0.408, lr=0.1] 41%|████      | 51/125 [17:51<25:18, 20.52s/epoch, loss=1.15, accuracy=0.752, val_loss=1.89, val_accuracy=0.525, lr=0.1] 42%|████▏     | 52/125 [18:12<24:56, 20.50s/epoch, loss=0.944, accuracy=0.81, val_loss=0.934, val_accuracy=0.796, lr=0.01] 42%|████▏     | 53/125 [18:32<24:38, 20.53s/epoch, loss=0.756, accuracy=0.843, val_loss=0.786, val_accuracy=0.826, lr=0.01] 43%|████▎     | 54/125 [18:53<24:21, 20.59s/epoch, loss=0.667, accuracy=0.854, val_loss=0.771, val_accuracy=0.812, lr=0.01] 44%|████▍     | 55/125 [19:14<24:02, 20.61s/epoch, loss=0.623, accuracy=0.86, val_loss=0.832, val_accuracy=0.791, lr=0.01]  45%|████▍     | 56/125 [19:34<23:43, 20.63s/epoch, loss=0.602, accuracy=0.858, val_loss=0.81, val_accuracy=0.786, lr=0.01] 46%|████▌     | 57/125 [19:55<23:21, 20.61s/epoch, loss=0.593, accuracy=0.858, val_loss=0.784, val_accuracy=0.796, lr=0.01] 46%|████▋     | 58/125 [20:15<23:00, 20.60s/epoch, loss=0.585, accuracy=0.861, val_loss=0.894, val_accuracy=0.768, lr=0.01] 47%|████▋     | 59/125 [20:36<22:41, 20.63s/epoch, loss=0.581, accuracy=0.865, val_loss=0.792, val_accuracy=0.798, lr=0.01] 48%|████▊     | 60/125 [20:57<22:20, 20.62s/epoch, loss=0.582, accuracy=0.863, val_loss=0.8, val_accuracy=0.794, lr=0.01]   49%|████▉     | 61/125 [21:17<21:56, 20.57s/epoch, loss=0.576, accuracy=0.867, val_loss=0.882, val_accuracy=0.779, lr=0.01] 50%|████▉     | 62/125 [21:38<21:35, 20.56s/epoch, loss=0.573, accuracy=0.87, val_loss=0.849, val_accuracy=0.787, lr=0.01]  50%|█████     | 63/125 [21:58<21:13, 20.54s/epoch, loss=0.574, accuracy=0.868, val_loss=1.11, val_accuracy=0.731, lr=0.01] 51%|█████     | 64/125 [22:19<20:51, 20.52s/epoch, loss=0.571, accuracy=0.87, val_loss=0.763, val_accuracy=0.811, lr=0.01] 52%|█████▏    | 65/125 [22:39<20:29, 20.49s/epoch, loss=0.573, accuracy=0.873, val_loss=0.816, val_accuracy=0.795, lr=0.01] 53%|█████▎    | 66/125 [23:00<20:10, 20.52s/epoch, loss=0.568, accuracy=0.872, val_loss=0.794, val_accuracy=0.794, lr=0.01] 54%|█████▎    | 67/125 [23:20<19:48, 20.50s/epoch, loss=0.566, accuracy=0.875, val_loss=0.768, val_accuracy=0.809, lr=0.01] 54%|█████▍    | 68/125 [23:41<19:29, 20.52s/epoch, loss=0.573, accuracy=0.873, val_loss=0.845, val_accuracy=0.787, lr=0.01] 55%|█████▌    | 69/125 [24:01<19:07, 20.49s/epoch, loss=0.575, accuracy=0.873, val_loss=0.817, val_accuracy=0.801, lr=0.01] 56%|█████▌    | 70/125 [24:22<18:46, 20.48s/epoch, loss=0.565, accuracy=0.877, val_loss=0.835, val_accuracy=0.794, lr=0.01] 57%|█████▋    | 71/125 [24:42<18:25, 20.48s/epoch, loss=0.568, accuracy=0.877, val_loss=0.78, val_accuracy=0.811, lr=0.01]  58%|█████▊    | 72/125 [25:03<18:04, 20.47s/epoch, loss=0.569, accuracy=0.879, val_loss=0.852, val_accuracy=0.788, lr=0.01] 58%|█████▊    | 73/125 [25:23<17:42, 20.44s/epoch, loss=0.565, accuracy=0.878, val_loss=0.846, val_accuracy=0.793, lr=0.01] 59%|█████▉    | 74/125 [25:43<17:24, 20.47s/epoch, loss=0.568, accuracy=0.878, val_loss=0.969, val_accuracy=0.743, lr=0.01] 60%|██████    | 75/125 [26:04<17:06, 20.53s/epoch, loss=0.567, accuracy=0.88, val_loss=0.821, val_accuracy=0.8, lr=0.01]    61%|██████    | 76/125 [26:25<16:46, 20.54s/epoch, loss=0.567, accuracy=0.881, val_loss=0.775, val_accuracy=0.807, lr=0.01] 62%|██████▏   | 77/125 [26:45<16:25, 20.53s/epoch, loss=0.493, accuracy=0.905, val_loss=0.541, val_accuracy=0.889, lr=0.001] 62%|██████▏   | 78/125 [27:06<16:04, 20.53s/epoch, loss=0.438, accuracy=0.924, val_loss=0.517, val_accuracy=0.894, lr=0.001] 63%|██████▎   | 79/125 [27:26<15:42, 20.49s/epoch, loss=0.412, accuracy=0.93, val_loss=0.508, val_accuracy=0.897, lr=0.001]  64%|██████▍   | 80/125 [27:47<15:22, 20.50s/epoch, loss=0.397, accuracy=0.933, val_loss=0.498, val_accuracy=0.897, lr=0.001] 65%|██████▍   | 81/125 [28:07<15:00, 20.47s/epoch, loss=0.384, accuracy=0.936, val_loss=0.499, val_accuracy=0.896, lr=0.001] 66%|██████▌   | 82/125 [28:27<14:39, 20.45s/epoch, loss=0.368, accuracy=0.94, val_loss=0.49, val_accuracy=0.899, lr=0.001]   66%|██████▋   | 83/125 [28:48<14:17, 20.41s/epoch, loss=0.359, accuracy=0.941, val_loss=0.479, val_accuracy=0.899, lr=0.001] 67%|██████▋   | 84/125 [29:08<13:55, 20.39s/epoch, loss=0.348, accuracy=0.943, val_loss=0.48, val_accuracy=0.895, lr=0.001]  68%|██████▊   | 85/125 [29:28<13:35, 20.38s/epoch, loss=0.338, accuracy=0.945, val_loss=0.48, val_accuracy=0.898, lr=0.001] 69%|██████▉   | 86/125 [29:49<13:14, 20.37s/epoch, loss=0.332, accuracy=0.945, val_loss=0.475, val_accuracy=0.896, lr=0.001] 70%|██████▉   | 87/125 [30:09<12:56, 20.42s/epoch, loss=0.322, accuracy=0.948, val_loss=0.465, val_accuracy=0.897, lr=0.001] 70%|███████   | 88/125 [30:30<12:35, 20.43s/epoch, loss=0.314, accuracy=0.949, val_loss=0.467, val_accuracy=0.897, lr=0.001] 71%|███████   | 89/125 [30:50<12:15, 20.42s/epoch, loss=0.307, accuracy=0.95, val_loss=0.478, val_accuracy=0.891, lr=0.001]  72%|███████▏  | 90/125 [31:10<11:53, 20.38s/epoch, loss=0.299, accuracy=0.952, val_loss=0.471, val_accuracy=0.898, lr=0.001] 73%|███████▎  | 91/125 [31:31<11:32, 20.36s/epoch, loss=0.294, accuracy=0.952, val_loss=0.484, val_accuracy=0.892, lr=0.001] 74%|███████▎  | 92/125 [31:51<11:11, 20.36s/epoch, loss=0.288, accuracy=0.953, val_loss=0.462, val_accuracy=0.897, lr=0.001] 74%|███████▍  | 93/125 [32:11<10:51, 20.36s/epoch, loss=0.281, accuracy=0.953, val_loss=0.486, val_accuracy=0.891, lr=0.001] 75%|███████▌  | 94/125 [32:32<10:30, 20.33s/epoch, loss=0.275, accuracy=0.955, val_loss=0.467, val_accuracy=0.896, lr=0.001] 76%|███████▌  | 95/125 [32:52<10:10, 20.34s/epoch, loss=0.273, accuracy=0.956, val_loss=0.462, val_accuracy=0.898, lr=0.001] 77%|███████▋  | 96/125 [33:12<09:49, 20.33s/epoch, loss=0.267, accuracy=0.954, val_loss=0.477, val_accuracy=0.892, lr=0.001] 78%|███████▊  | 97/125 [33:33<09:28, 20.32s/epoch, loss=0.262, accuracy=0.956, val_loss=0.469, val_accuracy=0.894, lr=0.001] 78%|███████▊  | 98/125 [33:53<09:09, 20.34s/epoch, loss=0.258, accuracy=0.956, val_loss=0.451, val_accuracy=0.899, lr=0.001] 79%|███████▉  | 99/125 [34:13<08:49, 20.35s/epoch, loss=0.253, accuracy=0.958, val_loss=0.477, val_accuracy=0.892, lr=0.001] 80%|████████  | 100/125 [34:34<08:29, 20.38s/epoch, loss=0.251, accuracy=0.959, val_loss=0.476, val_accuracy=0.892, lr=0.001] 81%|████████  | 101/125 [34:54<08:09, 20.40s/epoch, loss=0.249, accuracy=0.958, val_loss=0.479, val_accuracy=0.89, lr=0.001]  82%|████████▏ | 102/125 [35:15<07:49, 20.40s/epoch, loss=0.229, accuracy=0.965, val_loss=0.423, val_accuracy=0.906, lr=1e-04] 82%|████████▏ | 103/125 [35:35<07:28, 20.40s/epoch, loss=0.22, accuracy=0.969, val_loss=0.418, val_accuracy=0.906, lr=1e-04]  83%|████████▎ | 104/125 [35:56<07:08, 20.41s/epoch, loss=0.218, accuracy=0.969, val_loss=0.417, val_accuracy=0.908, lr=1e-04] 84%|████████▍ | 105/125 [36:16<06:47, 20.39s/epoch, loss=0.214, accuracy=0.971, val_loss=0.415, val_accuracy=0.908, lr=1e-04] 85%|████████▍ | 106/125 [36:36<06:26, 20.36s/epoch, loss=0.211, accuracy=0.972, val_loss=0.419, val_accuracy=0.907, lr=1e-04] 86%|████████▌ | 107/125 [36:57<06:06, 20.34s/epoch, loss=0.208, accuracy=0.973, val_loss=0.415, val_accuracy=0.908, lr=1e-04] 86%|████████▋ | 108/125 [37:17<05:45, 20.35s/epoch, loss=0.207, accuracy=0.973, val_loss=0.418, val_accuracy=0.905, lr=1e-04] 87%|████████▋ | 109/125 [37:37<05:25, 20.32s/epoch, loss=0.205, accuracy=0.974, val_loss=0.417, val_accuracy=0.907, lr=1e-04] 88%|████████▊ | 110/125 [37:57<05:04, 20.32s/epoch, loss=0.203, accuracy=0.975, val_loss=0.418, val_accuracy=0.907, lr=1e-04] 89%|████████▉ | 111/125 [38:18<04:44, 20.29s/epoch, loss=0.202, accuracy=0.976, val_loss=0.418, val_accuracy=0.906, lr=1e-04] 90%|████████▉ | 112/125 [38:38<04:23, 20.29s/epoch, loss=0.202, accuracy=0.974, val_loss=0.416, val_accuracy=0.907, lr=1e-04] 90%|█████████ | 113/125 [38:58<04:03, 20.26s/epoch, loss=0.201, accuracy=0.975, val_loss=0.419, val_accuracy=0.907, lr=1e-04] 91%|█████████ | 114/125 [39:18<03:42, 20.26s/epoch, loss=0.201, accuracy=0.975, val_loss=0.416, val_accuracy=0.906, lr=5e-5]  92%|█████████▏| 115/125 [39:39<03:22, 20.22s/epoch, loss=0.197, accuracy=0.975, val_loss=0.416, val_accuracy=0.907, lr=5e-5] 93%|█████████▎| 116/125 [39:59<03:02, 20.23s/epoch, loss=0.196, accuracy=0.977, val_loss=0.417, val_accuracy=0.907, lr=5e-5] 94%|█████████▎| 117/125 [40:19<02:41, 20.24s/epoch, loss=0.197, accuracy=0.976, val_loss=0.414, val_accuracy=0.908, lr=5e-5] 94%|█████████▍| 118/125 [40:39<02:21, 20.24s/epoch, loss=0.196, accuracy=0.977, val_loss=0.415, val_accuracy=0.908, lr=5e-5] 95%|█████████▌| 119/125 [41:00<02:01, 20.23s/epoch, loss=0.196, accuracy=0.976, val_loss=0.416, val_accuracy=0.907, lr=5e-5] 96%|█████████▌| 120/125 [41:20<01:41, 20.23s/epoch, loss=0.194, accuracy=0.978, val_loss=0.414, val_accuracy=0.907, lr=5e-5] 97%|█████████▋| 121/125 [41:40<01:20, 20.24s/epoch, loss=0.195, accuracy=0.977, val_loss=0.415, val_accuracy=0.908, lr=5e-5] 98%|█████████▊| 122/125 [42:00<01:00, 20.26s/epoch, loss=0.196, accuracy=0.976, val_loss=0.415, val_accuracy=0.908, lr=5e-5] 98%|█████████▊| 123/125 [42:21<00:40, 20.29s/epoch, loss=0.193, accuracy=0.977, val_loss=0.418, val_accuracy=0.908, lr=5e-5] 99%|█████████▉| 124/125 [42:41<00:20, 20.29s/epoch, loss=0.193, accuracy=0.977, val_loss=0.416, val_accuracy=0.908, lr=5e-5]100%|██████████| 125/125 [43:01<00:00, 20.30s/epoch, loss=0.192, accuracy=0.978, val_loss=0.416, val_accuracy=0.908, lr=5e-5]100%|██████████| 125/125 [43:01<00:00, 20.65s/epoch, loss=0.192, accuracy=0.978, val_loss=0.416, val_accuracy=0.908, lr=5e-5]
Using real-time data augmentation.
Only one model saved

Loading model: 12_07_cifar10_ResNet20v1.h5
Test score: 0.41647475957870483
Test accuracy: 0.9075000286102295


* * * Run SGD for ID = 12_8. * * *


2024-03-13 07:19:54.219067: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 07:19:56.892163: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 07:19:56.893300: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-13 07:19:56.932410: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-13 07:19:56.932450: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 07:19:56.935066: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 07:19:56.935111: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 07:19:56.937208: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 07:19:56.937864: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 07:19:56.940194: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 07:19:56.941623: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 07:19:56.946287: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 07:19:56.946782: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 07:19:56.946890: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 07:19:58.257221: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-13 07:19:58.257676: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 07:19:58.258458: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-13 07:19:58.258492: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 07:19:58.258531: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 07:19:58.258557: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 07:19:58.258575: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 07:19:58.258592: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 07:19:58.258611: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 07:19:58.258629: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 07:19:58.258648: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 07:19:58.259115: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 07:19:58.259169: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 07:19:58.959559: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-13 07:19:58.959611: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-13 07:19:58.959621: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-13 07:19:58.960507: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:83:00.0, compute capability: 6.1)
{'id': '12_08', 'seed': 8, 'out_folder': 'results/epoch_budget_2', 'batch_size': 128, 'epochs': 125, 'validation_split': 0.0, 'checkpointing': False, 'checkpoint_every': -1, 'hold_out_validation_split': 0.0, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'num_classes': 10, 'SSE_lr': False, 'test_time_augmentation': False, 'debug': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
y_train shape: (50000, 10)
x_val shape: (10000, 32, 32, 3)
y_val shape: (10000, 10)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/125 [00:00<?, ?epoch/s]2024-03-13 07:19:59.629275: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-13 07:19:59.629785: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199945000 Hz
2024-03-13 07:20:01.825563: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 07:20:02.034562: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 07:20:03.121336: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-13 07:20:03.158210: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/125 [00:48<1:40:42, 48.73s/epoch, loss=2.85, accuracy=0.4, val_loss=3.97, val_accuracy=0.241, lr=0.1]  2%|▏         | 2/125 [01:09<1:06:39, 32.52s/epoch, loss=1.44, accuracy=0.611, val_loss=1.65, val_accuracy=0.545, lr=0.1]  2%|▏         | 3/125 [01:30<55:22, 27.23s/epoch, loss=1.31, accuracy=0.668, val_loss=2.45, val_accuracy=0.413, lr=0.1]    3%|▎         | 4/125 [01:51<49:53, 24.74s/epoch, loss=1.27, accuracy=0.692, val_loss=2.46, val_accuracy=0.406, lr=0.1]  4%|▍         | 5/125 [02:12<46:44, 23.37s/epoch, loss=1.24, accuracy=0.707, val_loss=2.44, val_accuracy=0.47, lr=0.1]   5%|▍         | 6/125 [02:33<44:43, 22.55s/epoch, loss=1.23, accuracy=0.716, val_loss=2.12, val_accuracy=0.545, lr=0.1]  6%|▌         | 7/125 [02:54<43:19, 22.03s/epoch, loss=1.21, accuracy=0.722, val_loss=1.36, val_accuracy=0.672, lr=0.1]  6%|▋         | 8/125 [03:15<42:18, 21.70s/epoch, loss=1.2, accuracy=0.728, val_loss=1.81, val_accuracy=0.54, lr=0.1]    7%|▋         | 9/125 [03:36<41:29, 21.46s/epoch, loss=1.2, accuracy=0.727, val_loss=1.55, val_accuracy=0.635, lr=0.1]  8%|▊         | 10/125 [03:57<40:52, 21.33s/epoch, loss=1.19, accuracy=0.731, val_loss=1.86, val_accuracy=0.552, lr=0.1]  9%|▉         | 11/125 [04:18<40:16, 21.20s/epoch, loss=1.18, accuracy=0.735, val_loss=1.7, val_accuracy=0.567, lr=0.1]  10%|▉         | 12/125 [04:39<39:48, 21.14s/epoch, loss=1.19, accuracy=0.732, val_loss=2.03, val_accuracy=0.481, lr=0.1] 10%|█         | 13/125 [05:00<39:18, 21.06s/epoch, loss=1.18, accuracy=0.738, val_loss=1.33, val_accuracy=0.682, lr=0.1] 11%|█         | 14/125 [05:21<38:53, 21.02s/epoch, loss=1.17, accuracy=0.739, val_loss=3.52, val_accuracy=0.318, lr=0.1] 12%|█▏        | 15/125 [05:42<38:30, 21.01s/epoch, loss=1.17, accuracy=0.739, val_loss=1.35, val_accuracy=0.667, lr=0.1] 13%|█▎        | 16/125 [06:03<38:08, 21.00s/epoch, loss=1.16, accuracy=0.74, val_loss=1.67, val_accuracy=0.574, lr=0.1]  14%|█▎        | 17/125 [06:24<37:50, 21.02s/epoch, loss=1.16, accuracy=0.742, val_loss=2.61, val_accuracy=0.428, lr=0.1] 14%|█▍        | 18/125 [06:45<37:28, 21.01s/epoch, loss=1.17, accuracy=0.745, val_loss=1.49, val_accuracy=0.641, lr=0.1] 15%|█▌        | 19/125 [07:06<37:11, 21.05s/epoch, loss=1.16, accuracy=0.745, val_loss=1.77, val_accuracy=0.529, lr=0.1] 16%|█▌        | 20/125 [07:27<36:54, 21.09s/epoch, loss=1.17, accuracy=0.742, val_loss=1.53, val_accuracy=0.657, lr=0.1] 17%|█▋        | 21/125 [07:48<36:33, 21.09s/epoch, loss=1.17, accuracy=0.744, val_loss=1.54, val_accuracy=0.617, lr=0.1] 18%|█▊        | 22/125 [08:09<36:12, 21.09s/epoch, loss=1.16, accuracy=0.746, val_loss=1.47, val_accuracy=0.636, lr=0.1] 18%|█▊        | 23/125 [08:30<35:52, 21.10s/epoch, loss=1.16, accuracy=0.745, val_loss=2.01, val_accuracy=0.5, lr=0.1]   19%|█▉        | 24/125 [08:52<35:30, 21.09s/epoch, loss=1.15, accuracy=0.747, val_loss=1.74, val_accuracy=0.539, lr=0.1] 20%|██        | 25/125 [09:13<35:07, 21.07s/epoch, loss=1.15, accuracy=0.747, val_loss=1.64, val_accuracy=0.608, lr=0.1] 21%|██        | 26/125 [09:34<34:45, 21.06s/epoch, loss=1.15, accuracy=0.749, val_loss=1.57, val_accuracy=0.586, lr=0.1] 22%|██▏       | 27/125 [09:55<34:20, 21.03s/epoch, loss=1.15, accuracy=0.744, val_loss=2.09, val_accuracy=0.481, lr=0.1] 22%|██▏       | 28/125 [10:16<33:59, 21.02s/epoch, loss=1.14, accuracy=0.747, val_loss=2.82, val_accuracy=0.359, lr=0.1] 23%|██▎       | 29/125 [10:36<33:35, 20.99s/epoch, loss=1.15, accuracy=0.747, val_loss=3.87, val_accuracy=0.356, lr=0.1] 24%|██▍       | 30/125 [10:57<33:14, 21.00s/epoch, loss=1.14, accuracy=0.748, val_loss=2.63, val_accuracy=0.471, lr=0.1] 25%|██▍       | 31/125 [11:18<32:52, 20.99s/epoch, loss=1.14, accuracy=0.752, val_loss=3.36, val_accuracy=0.331, lr=0.1] 26%|██▌       | 32/125 [11:39<32:31, 20.99s/epoch, loss=1.14, accuracy=0.751, val_loss=4.19, val_accuracy=0.171, lr=0.1] 26%|██▋       | 33/125 [12:00<32:08, 20.97s/epoch, loss=1.14, accuracy=0.753, val_loss=1.45, val_accuracy=0.651, lr=0.1] 27%|██▋       | 34/125 [12:21<31:46, 20.95s/epoch, loss=1.13, accuracy=0.75, val_loss=1.68, val_accuracy=0.567, lr=0.1]  28%|██▊       | 35/125 [12:42<31:24, 20.93s/epoch, loss=1.14, accuracy=0.752, val_loss=1.43, val_accuracy=0.66, lr=0.1] 29%|██▉       | 36/125 [13:03<31:04, 20.95s/epoch, loss=1.13, accuracy=0.751, val_loss=2.09, val_accuracy=0.51, lr=0.1] 30%|██▉       | 37/125 [13:24<30:42, 20.94s/epoch, loss=1.13, accuracy=0.753, val_loss=2.16, val_accuracy=0.507, lr=0.1] 30%|███       | 38/125 [13:45<30:23, 20.96s/epoch, loss=1.12, accuracy=0.752, val_loss=2.63, val_accuracy=0.368, lr=0.1] 31%|███       | 39/125 [14:06<29:58, 20.92s/epoch, loss=1.14, accuracy=0.749, val_loss=2.14, val_accuracy=0.459, lr=0.1] 32%|███▏      | 40/125 [14:27<29:38, 20.93s/epoch, loss=1.12, accuracy=0.754, val_loss=1.59, val_accuracy=0.602, lr=0.1] 33%|███▎      | 41/125 [14:48<29:18, 20.93s/epoch, loss=1.13, accuracy=0.755, val_loss=2.62, val_accuracy=0.442, lr=0.1] 34%|███▎      | 42/125 [15:09<28:57, 20.94s/epoch, loss=1.13, accuracy=0.754, val_loss=1.75, val_accuracy=0.576, lr=0.1] 34%|███▍      | 43/125 [15:30<28:40, 20.98s/epoch, loss=1.13, accuracy=0.752, val_loss=1.44, val_accuracy=0.641, lr=0.1] 35%|███▌      | 44/125 [15:51<28:20, 21.00s/epoch, loss=1.12, accuracy=0.753, val_loss=1.97, val_accuracy=0.515, lr=0.1] 36%|███▌      | 45/125 [16:12<28:00, 21.01s/epoch, loss=1.12, accuracy=0.756, val_loss=2.13, val_accuracy=0.427, lr=0.1] 37%|███▋      | 46/125 [16:33<27:42, 21.05s/epoch, loss=1.12, accuracy=0.752, val_loss=2.51, val_accuracy=0.472, lr=0.1] 38%|███▊      | 47/125 [16:54<27:22, 21.06s/epoch, loss=1.12, accuracy=0.755, val_loss=2.15, val_accuracy=0.431, lr=0.1] 38%|███▊      | 48/125 [17:15<27:02, 21.07s/epoch, loss=1.12, accuracy=0.756, val_loss=1.72, val_accuracy=0.524, lr=0.1] 39%|███▉      | 49/125 [17:36<26:38, 21.03s/epoch, loss=1.12, accuracy=0.757, val_loss=2.05, val_accuracy=0.511, lr=0.1] 40%|████      | 50/125 [17:57<26:17, 21.03s/epoch, loss=1.12, accuracy=0.754, val_loss=2.36, val_accuracy=0.392, lr=0.1] 41%|████      | 51/125 [18:18<25:54, 21.00s/epoch, loss=1.12, accuracy=0.756, val_loss=2.46, val_accuracy=0.451, lr=0.1] 42%|████▏     | 52/125 [18:39<25:32, 20.99s/epoch, loss=0.908, accuracy=0.815, val_loss=0.925, val_accuracy=0.792, lr=0.01] 42%|████▏     | 53/125 [19:00<25:12, 21.01s/epoch, loss=0.725, accuracy=0.849, val_loss=0.766, val_accuracy=0.823, lr=0.01] 43%|████▎     | 54/125 [19:21<24:55, 21.06s/epoch, loss=0.649, accuracy=0.858, val_loss=0.746, val_accuracy=0.814, lr=0.01] 44%|████▍     | 55/125 [19:43<24:37, 21.11s/epoch, loss=0.609, accuracy=0.859, val_loss=0.737, val_accuracy=0.816, lr=0.01] 45%|████▍     | 56/125 [20:04<24:16, 21.11s/epoch, loss=0.584, accuracy=0.861, val_loss=1.02, val_accuracy=0.741, lr=0.01]  46%|████▌     | 57/125 [20:25<23:54, 21.09s/epoch, loss=0.577, accuracy=0.861, val_loss=0.718, val_accuracy=0.81, lr=0.01] 46%|████▋     | 58/125 [20:46<23:32, 21.08s/epoch, loss=0.569, accuracy=0.863, val_loss=0.815, val_accuracy=0.776, lr=0.01] 47%|████▋     | 59/125 [21:07<23:10, 21.06s/epoch, loss=0.567, accuracy=0.863, val_loss=0.733, val_accuracy=0.808, lr=0.01] 48%|████▊     | 60/125 [21:28<22:49, 21.06s/epoch, loss=0.563, accuracy=0.867, val_loss=0.773, val_accuracy=0.805, lr=0.01] 49%|████▉     | 61/125 [21:49<22:24, 21.00s/epoch, loss=0.562, accuracy=0.866, val_loss=0.841, val_accuracy=0.77, lr=0.01]  50%|████▉     | 62/125 [22:10<22:03, 21.01s/epoch, loss=0.558, accuracy=0.87, val_loss=0.833, val_accuracy=0.792, lr=0.01] 50%|█████     | 63/125 [22:31<21:41, 20.99s/epoch, loss=0.558, accuracy=0.871, val_loss=0.73, val_accuracy=0.823, lr=0.01] 51%|█████     | 64/125 [22:52<21:20, 20.99s/epoch, loss=0.561, accuracy=0.872, val_loss=0.914, val_accuracy=0.77, lr=0.01] 52%|█████▏    | 65/125 [23:13<20:58, 20.97s/epoch, loss=0.557, accuracy=0.873, val_loss=0.967, val_accuracy=0.75, lr=0.01] 53%|█████▎    | 66/125 [23:34<20:37, 20.98s/epoch, loss=0.556, accuracy=0.873, val_loss=1, val_accuracy=0.753, lr=0.01]    54%|█████▎    | 67/125 [23:54<20:15, 20.96s/epoch, loss=0.558, accuracy=0.874, val_loss=1.33, val_accuracy=0.659, lr=0.01] 54%|█████▍    | 68/125 [24:16<19:56, 20.99s/epoch, loss=0.559, accuracy=0.875, val_loss=0.814, val_accuracy=0.791, lr=0.01] 55%|█████▌    | 69/125 [24:36<19:34, 20.97s/epoch, loss=0.553, accuracy=0.878, val_loss=0.972, val_accuracy=0.756, lr=0.01] 56%|█████▌    | 70/125 [24:57<19:13, 20.98s/epoch, loss=0.551, accuracy=0.878, val_loss=0.875, val_accuracy=0.775, lr=0.01] 57%|█████▋    | 71/125 [25:18<18:52, 20.97s/epoch, loss=0.557, accuracy=0.876, val_loss=0.77, val_accuracy=0.811, lr=0.01]  58%|█████▊    | 72/125 [25:39<18:29, 20.93s/epoch, loss=0.557, accuracy=0.877, val_loss=0.729, val_accuracy=0.819, lr=0.01] 58%|█████▊    | 73/125 [26:00<18:09, 20.96s/epoch, loss=0.549, accuracy=0.88, val_loss=0.744, val_accuracy=0.826, lr=0.01]  59%|█████▉    | 74/125 [26:21<17:51, 21.01s/epoch, loss=0.55, accuracy=0.88, val_loss=0.753, val_accuracy=0.811, lr=0.01]  60%|██████    | 75/125 [26:43<17:32, 21.04s/epoch, loss=0.55, accuracy=0.881, val_loss=0.718, val_accuracy=0.83, lr=0.01] 61%|██████    | 76/125 [27:04<17:10, 21.03s/epoch, loss=0.551, accuracy=0.879, val_loss=0.839, val_accuracy=0.792, lr=0.01] 62%|██████▏   | 77/125 [27:25<16:50, 21.05s/epoch, loss=0.476, accuracy=0.907, val_loss=0.532, val_accuracy=0.889, lr=0.001] 62%|██████▏   | 78/125 [27:46<16:31, 21.10s/epoch, loss=0.424, accuracy=0.924, val_loss=0.512, val_accuracy=0.893, lr=0.001] 63%|██████▎   | 79/125 [28:07<16:09, 21.07s/epoch, loss=0.404, accuracy=0.929, val_loss=0.503, val_accuracy=0.894, lr=0.001] 64%|██████▍   | 80/125 [28:28<15:48, 21.07s/epoch, loss=0.388, accuracy=0.932, val_loss=0.503, val_accuracy=0.895, lr=0.001] 65%|██████▍   | 81/125 [28:49<15:22, 20.96s/epoch, loss=0.376, accuracy=0.935, val_loss=0.492, val_accuracy=0.896, lr=0.001] 66%|██████▌   | 82/125 [29:10<15:00, 20.95s/epoch, loss=0.363, accuracy=0.936, val_loss=0.481, val_accuracy=0.898, lr=0.001] 66%|██████▋   | 83/125 [29:30<14:37, 20.90s/epoch, loss=0.35, accuracy=0.94, val_loss=0.479, val_accuracy=0.897, lr=0.001]   67%|██████▋   | 84/125 [29:51<14:16, 20.88s/epoch, loss=0.341, accuracy=0.941, val_loss=0.475, val_accuracy=0.896, lr=0.001] 68%|██████▊   | 85/125 [30:12<13:54, 20.87s/epoch, loss=0.332, accuracy=0.943, val_loss=0.484, val_accuracy=0.895, lr=0.001] 69%|██████▉   | 86/125 [30:33<13:33, 20.85s/epoch, loss=0.324, accuracy=0.945, val_loss=0.479, val_accuracy=0.896, lr=0.001] 70%|██████▉   | 87/125 [30:53<13:10, 20.81s/epoch, loss=0.315, accuracy=0.946, val_loss=0.469, val_accuracy=0.897, lr=0.001] 70%|███████   | 88/125 [31:14<12:50, 20.81s/epoch, loss=0.311, accuracy=0.946, val_loss=0.474, val_accuracy=0.893, lr=0.001] 71%|███████   | 89/125 [31:35<12:28, 20.80s/epoch, loss=0.301, accuracy=0.949, val_loss=0.466, val_accuracy=0.899, lr=0.001] 72%|███████▏  | 90/125 [31:56<12:07, 20.80s/epoch, loss=0.296, accuracy=0.948, val_loss=0.454, val_accuracy=0.899, lr=0.001] 73%|███████▎  | 91/125 [32:17<11:46, 20.78s/epoch, loss=0.288, accuracy=0.951, val_loss=0.464, val_accuracy=0.894, lr=0.001] 74%|███████▎  | 92/125 [32:37<11:25, 20.78s/epoch, loss=0.283, accuracy=0.952, val_loss=0.474, val_accuracy=0.894, lr=0.001] 74%|███████▍  | 93/125 [32:58<11:04, 20.77s/epoch, loss=0.278, accuracy=0.952, val_loss=0.462, val_accuracy=0.895, lr=0.001] 75%|███████▌  | 94/125 [33:19<10:43, 20.77s/epoch, loss=0.273, accuracy=0.952, val_loss=0.467, val_accuracy=0.893, lr=0.001] 76%|███████▌  | 95/125 [33:40<10:23, 20.78s/epoch, loss=0.266, accuracy=0.953, val_loss=0.494, val_accuracy=0.887, lr=0.001] 77%|███████▋  | 96/125 [34:01<10:02, 20.78s/epoch, loss=0.264, accuracy=0.953, val_loss=0.471, val_accuracy=0.891, lr=0.001] 78%|███████▊  | 97/125 [34:21<09:42, 20.81s/epoch, loss=0.259, accuracy=0.955, val_loss=0.456, val_accuracy=0.892, lr=0.001] 78%|███████▊  | 98/125 [34:42<09:22, 20.83s/epoch, loss=0.257, accuracy=0.955, val_loss=0.476, val_accuracy=0.889, lr=0.001] 79%|███████▉  | 99/125 [35:03<09:02, 20.85s/epoch, loss=0.253, accuracy=0.955, val_loss=0.475, val_accuracy=0.89, lr=0.001]  80%|████████  | 100/125 [35:24<08:41, 20.86s/epoch, loss=0.248, accuracy=0.955, val_loss=0.489, val_accuracy=0.888, lr=0.001] 81%|████████  | 101/125 [35:45<08:20, 20.87s/epoch, loss=0.244, accuracy=0.956, val_loss=0.475, val_accuracy=0.888, lr=0.001] 82%|████████▏ | 102/125 [36:06<08:00, 20.88s/epoch, loss=0.227, accuracy=0.963, val_loss=0.419, val_accuracy=0.902, lr=1e-04] 82%|████████▏ | 103/125 [36:27<07:39, 20.87s/epoch, loss=0.217, accuracy=0.967, val_loss=0.414, val_accuracy=0.905, lr=1e-04] 83%|████████▎ | 104/125 [36:48<07:18, 20.89s/epoch, loss=0.212, accuracy=0.969, val_loss=0.415, val_accuracy=0.903, lr=1e-04] 84%|████████▍ | 105/125 [37:08<06:56, 20.84s/epoch, loss=0.21, accuracy=0.97, val_loss=0.415, val_accuracy=0.904, lr=1e-04]   85%|████████▍ | 106/125 [37:29<06:35, 20.81s/epoch, loss=0.209, accuracy=0.97, val_loss=0.415, val_accuracy=0.905, lr=1e-04] 86%|████████▌ | 107/125 [37:50<06:14, 20.80s/epoch, loss=0.206, accuracy=0.97, val_loss=0.417, val_accuracy=0.904, lr=1e-04] 86%|████████▋ | 108/125 [38:11<05:53, 20.79s/epoch, loss=0.203, accuracy=0.972, val_loss=0.416, val_accuracy=0.905, lr=1e-04] 87%|████████▋ | 109/125 [38:31<05:32, 20.75s/epoch, loss=0.202, accuracy=0.973, val_loss=0.414, val_accuracy=0.904, lr=1e-04] 88%|████████▊ | 110/125 [38:52<05:10, 20.73s/epoch, loss=0.199, accuracy=0.973, val_loss=0.414, val_accuracy=0.905, lr=1e-04] 89%|████████▉ | 111/125 [39:13<04:49, 20.71s/epoch, loss=0.198, accuracy=0.974, val_loss=0.417, val_accuracy=0.904, lr=1e-04] 90%|████████▉ | 112/125 [39:33<04:29, 20.71s/epoch, loss=0.199, accuracy=0.973, val_loss=0.417, val_accuracy=0.905, lr=1e-04] 90%|█████████ | 113/125 [39:54<04:08, 20.72s/epoch, loss=0.196, accuracy=0.975, val_loss=0.415, val_accuracy=0.904, lr=1e-04] 91%|█████████ | 114/125 [40:15<03:48, 20.74s/epoch, loss=0.193, accuracy=0.976, val_loss=0.415, val_accuracy=0.904, lr=5e-5]  92%|█████████▏| 115/125 [40:36<03:27, 20.75s/epoch, loss=0.195, accuracy=0.974, val_loss=0.415, val_accuracy=0.905, lr=5e-5] 93%|█████████▎| 116/125 [40:56<03:06, 20.74s/epoch, loss=0.193, accuracy=0.975, val_loss=0.418, val_accuracy=0.903, lr=5e-5] 94%|█████████▎| 117/125 [41:17<02:45, 20.73s/epoch, loss=0.191, accuracy=0.976, val_loss=0.416, val_accuracy=0.905, lr=5e-5] 94%|█████████▍| 118/125 [41:38<02:25, 20.74s/epoch, loss=0.192, accuracy=0.976, val_loss=0.416, val_accuracy=0.905, lr=5e-5] 95%|█████████▌| 119/125 [41:59<02:04, 20.74s/epoch, loss=0.19, accuracy=0.977, val_loss=0.416, val_accuracy=0.905, lr=5e-5]  96%|█████████▌| 120/125 [42:19<01:43, 20.73s/epoch, loss=0.191, accuracy=0.976, val_loss=0.416, val_accuracy=0.904, lr=5e-5] 97%|█████████▋| 121/125 [42:40<01:22, 20.75s/epoch, loss=0.191, accuracy=0.975, val_loss=0.416, val_accuracy=0.904, lr=5e-5] 98%|█████████▊| 122/125 [43:01<01:02, 20.77s/epoch, loss=0.188, accuracy=0.976, val_loss=0.418, val_accuracy=0.904, lr=5e-5] 98%|█████████▊| 123/125 [43:22<00:41, 20.79s/epoch, loss=0.189, accuracy=0.976, val_loss=0.419, val_accuracy=0.906, lr=5e-5] 99%|█████████▉| 124/125 [43:42<00:20, 20.78s/epoch, loss=0.189, accuracy=0.976, val_loss=0.418, val_accuracy=0.905, lr=5e-5]100%|██████████| 125/125 [44:03<00:00, 20.81s/epoch, loss=0.189, accuracy=0.976, val_loss=0.418, val_accuracy=0.905, lr=5e-5]100%|██████████| 125/125 [44:03<00:00, 21.15s/epoch, loss=0.189, accuracy=0.976, val_loss=0.418, val_accuracy=0.905, lr=5e-5]
Using real-time data augmentation.
Only one model saved

Loading model: 12_08_cifar10_ResNet20v1.h5
Test score: 0.41846588253974915
Test accuracy: 0.9046000242233276


* * * Run SGD for ID = 12_9. * * *


2024-03-13 08:04:06.960497: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 08:04:09.650839: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 08:04:09.651883: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-13 08:04:09.692724: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-13 08:04:09.692779: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 08:04:09.695664: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 08:04:09.695709: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 08:04:09.698031: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 08:04:09.698638: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 08:04:09.701214: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 08:04:09.702781: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 08:04:09.707694: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 08:04:09.708291: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 08:04:09.708374: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 08:04:11.043472: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-13 08:04:11.043956: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 08:04:11.044727: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-13 08:04:11.044760: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 08:04:11.044800: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 08:04:11.044819: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 08:04:11.044861: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 08:04:11.044878: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 08:04:11.044897: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 08:04:11.044916: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 08:04:11.044943: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 08:04:11.045400: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 08:04:11.045436: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 08:04:11.730221: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-13 08:04:11.730276: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-13 08:04:11.730287: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-13 08:04:11.732522: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:83:00.0, compute capability: 6.1)
{'id': '12_09', 'seed': 9, 'out_folder': 'results/epoch_budget_2', 'batch_size': 128, 'epochs': 125, 'validation_split': 0.0, 'checkpointing': False, 'checkpoint_every': -1, 'hold_out_validation_split': 0.0, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'num_classes': 10, 'SSE_lr': False, 'test_time_augmentation': False, 'debug': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
y_train shape: (50000, 10)
x_val shape: (10000, 32, 32, 3)
y_val shape: (10000, 10)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/125 [00:00<?, ?epoch/s]2024-03-13 08:04:12.393595: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-13 08:04:12.405978: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199945000 Hz
2024-03-13 08:04:14.594653: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 08:04:14.831870: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 08:04:15.790442: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-13 08:04:15.825877: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/125 [00:48<1:40:07, 48.45s/epoch, loss=3, accuracy=0.376, val_loss=2.96, val_accuracy=0.201, lr=0.1]  2%|▏         | 2/125 [01:09<1:06:14, 32.31s/epoch, loss=1.53, accuracy=0.567, val_loss=1.73, val_accuracy=0.505, lr=0.1]  2%|▏         | 3/125 [01:30<55:01, 27.07s/epoch, loss=1.34, accuracy=0.653, val_loss=2.04, val_accuracy=0.466, lr=0.1]    3%|▎         | 4/125 [01:51<49:41, 24.64s/epoch, loss=1.29, accuracy=0.685, val_loss=2.48, val_accuracy=0.46, lr=0.1]   4%|▍         | 5/125 [02:12<46:30, 23.26s/epoch, loss=1.25, accuracy=0.701, val_loss=1.51, val_accuracy=0.613, lr=0.1]  5%|▍         | 6/125 [02:32<44:31, 22.45s/epoch, loss=1.24, accuracy=0.709, val_loss=1.91, val_accuracy=0.519, lr=0.1]  6%|▌         | 7/125 [02:53<43:05, 21.91s/epoch, loss=1.23, accuracy=0.716, val_loss=1.92, val_accuracy=0.48, lr=0.1]   6%|▋         | 8/125 [03:14<42:00, 21.55s/epoch, loss=1.21, accuracy=0.721, val_loss=1.31, val_accuracy=0.687, lr=0.1]  7%|▋         | 9/125 [03:35<41:12, 21.31s/epoch, loss=1.2, accuracy=0.726, val_loss=1.69, val_accuracy=0.575, lr=0.1]   8%|▊         | 10/125 [03:56<40:30, 21.14s/epoch, loss=1.2, accuracy=0.728, val_loss=3.8, val_accuracy=0.306, lr=0.1]  9%|▉         | 11/125 [04:16<39:59, 21.05s/epoch, loss=1.19, accuracy=0.731, val_loss=1.57, val_accuracy=0.612, lr=0.1] 10%|▉         | 12/125 [04:37<39:30, 20.97s/epoch, loss=1.19, accuracy=0.734, val_loss=1.52, val_accuracy=0.604, lr=0.1] 10%|█         | 13/125 [04:58<39:02, 20.92s/epoch, loss=1.18, accuracy=0.735, val_loss=1.61, val_accuracy=0.608, lr=0.1] 11%|█         | 14/125 [05:19<38:38, 20.89s/epoch, loss=1.18, accuracy=0.74, val_loss=2.29, val_accuracy=0.426, lr=0.1]  12%|█▏        | 15/125 [05:40<38:16, 20.88s/epoch, loss=1.17, accuracy=0.741, val_loss=1.64, val_accuracy=0.579, lr=0.1] 13%|█▎        | 16/125 [06:00<37:52, 20.85s/epoch, loss=1.17, accuracy=0.741, val_loss=2.02, val_accuracy=0.54, lr=0.1]  14%|█▎        | 17/125 [06:21<37:32, 20.86s/epoch, loss=1.17, accuracy=0.739, val_loss=2.43, val_accuracy=0.48, lr=0.1] 14%|█▍        | 18/125 [06:42<37:13, 20.88s/epoch, loss=1.17, accuracy=0.745, val_loss=2.21, val_accuracy=0.449, lr=0.1] 15%|█▌        | 19/125 [07:03<36:54, 20.89s/epoch, loss=1.18, accuracy=0.741, val_loss=1.51, val_accuracy=0.617, lr=0.1] 16%|█▌        | 20/125 [07:24<36:34, 20.90s/epoch, loss=1.16, accuracy=0.745, val_loss=3.15, val_accuracy=0.364, lr=0.1] 17%|█▋        | 21/125 [07:45<36:13, 20.90s/epoch, loss=1.16, accuracy=0.746, val_loss=1.52, val_accuracy=0.62, lr=0.1]  18%|█▊        | 22/125 [08:06<35:56, 20.93s/epoch, loss=1.16, accuracy=0.746, val_loss=1.46, val_accuracy=0.657, lr=0.1] 18%|█▊        | 23/125 [08:27<35:37, 20.96s/epoch, loss=1.16, accuracy=0.743, val_loss=1.75, val_accuracy=0.549, lr=0.1] 19%|█▉        | 24/125 [08:48<35:15, 20.94s/epoch, loss=1.16, accuracy=0.748, val_loss=1.84, val_accuracy=0.518, lr=0.1] 20%|██        | 25/125 [09:09<34:53, 20.94s/epoch, loss=1.16, accuracy=0.748, val_loss=2.32, val_accuracy=0.535, lr=0.1] 21%|██        | 26/125 [09:30<34:33, 20.94s/epoch, loss=1.16, accuracy=0.748, val_loss=1.57, val_accuracy=0.638, lr=0.1] 22%|██▏       | 27/125 [09:51<34:08, 20.91s/epoch, loss=1.15, accuracy=0.75, val_loss=2.01, val_accuracy=0.559, lr=0.1]  22%|██▏       | 28/125 [10:11<33:46, 20.89s/epoch, loss=1.15, accuracy=0.749, val_loss=1.91, val_accuracy=0.518, lr=0.1] 23%|██▎       | 29/125 [10:32<33:23, 20.87s/epoch, loss=1.15, accuracy=0.751, val_loss=1.98, val_accuracy=0.519, lr=0.1] 24%|██▍       | 30/125 [10:53<33:01, 20.86s/epoch, loss=1.15, accuracy=0.75, val_loss=2.2, val_accuracy=0.484, lr=0.1]   25%|██▍       | 31/125 [11:14<32:40, 20.85s/epoch, loss=1.14, accuracy=0.752, val_loss=3.94, val_accuracy=0.274, lr=0.1] 26%|██▌       | 32/125 [11:35<32:17, 20.84s/epoch, loss=1.15, accuracy=0.751, val_loss=1.7, val_accuracy=0.567, lr=0.1]  26%|██▋       | 33/125 [11:56<31:55, 20.82s/epoch, loss=1.15, accuracy=0.751, val_loss=1.44, val_accuracy=0.662, lr=0.1] 27%|██▋       | 34/125 [12:16<31:35, 20.83s/epoch, loss=1.14, accuracy=0.752, val_loss=1.62, val_accuracy=0.608, lr=0.1] 28%|██▊       | 35/125 [12:37<31:17, 20.86s/epoch, loss=1.14, accuracy=0.753, val_loss=1.73, val_accuracy=0.541, lr=0.1] 29%|██▉       | 36/125 [12:58<30:54, 20.84s/epoch, loss=1.14, accuracy=0.755, val_loss=1.67, val_accuracy=0.572, lr=0.1] 30%|██▉       | 37/125 [13:19<30:34, 20.85s/epoch, loss=1.13, accuracy=0.754, val_loss=1.55, val_accuracy=0.621, lr=0.1] 30%|███       | 38/125 [13:40<30:11, 20.82s/epoch, loss=1.14, accuracy=0.754, val_loss=1.71, val_accuracy=0.554, lr=0.1] 31%|███       | 39/125 [14:01<29:51, 20.83s/epoch, loss=1.14, accuracy=0.753, val_loss=2.35, val_accuracy=0.455, lr=0.1] 32%|███▏      | 40/125 [14:21<29:31, 20.84s/epoch, loss=1.14, accuracy=0.753, val_loss=1.74, val_accuracy=0.567, lr=0.1] 33%|███▎      | 41/125 [14:42<29:09, 20.83s/epoch, loss=1.14, accuracy=0.754, val_loss=1.99, val_accuracy=0.523, lr=0.1] 34%|███▎      | 42/125 [15:03<28:46, 20.80s/epoch, loss=1.13, accuracy=0.755, val_loss=1.91, val_accuracy=0.502, lr=0.1] 34%|███▍      | 43/125 [15:24<28:29, 20.85s/epoch, loss=1.14, accuracy=0.755, val_loss=1.98, val_accuracy=0.499, lr=0.1] 35%|███▌      | 44/125 [15:45<28:11, 20.88s/epoch, loss=1.14, accuracy=0.752, val_loss=1.59, val_accuracy=0.598, lr=0.1] 36%|███▌      | 45/125 [16:06<27:51, 20.89s/epoch, loss=1.14, accuracy=0.755, val_loss=1.59, val_accuracy=0.604, lr=0.1] 37%|███▋      | 46/125 [16:27<27:31, 20.90s/epoch, loss=1.14, accuracy=0.754, val_loss=1.36, val_accuracy=0.671, lr=0.1] 38%|███▊      | 47/125 [16:48<27:11, 20.92s/epoch, loss=1.13, accuracy=0.755, val_loss=1.6, val_accuracy=0.577, lr=0.1]  38%|███▊      | 48/125 [17:09<26:49, 20.90s/epoch, loss=1.14, accuracy=0.755, val_loss=3.54, val_accuracy=0.231, lr=0.1] 39%|███▉      | 49/125 [17:29<26:26, 20.88s/epoch, loss=1.14, accuracy=0.755, val_loss=1.69, val_accuracy=0.564, lr=0.1] 40%|████      | 50/125 [17:50<26:04, 20.86s/epoch, loss=1.13, accuracy=0.757, val_loss=3.26, val_accuracy=0.382, lr=0.1] 41%|████      | 51/125 [18:11<25:43, 20.86s/epoch, loss=1.14, accuracy=0.753, val_loss=2.98, val_accuracy=0.445, lr=0.1] 42%|████▏     | 52/125 [18:32<25:24, 20.88s/epoch, loss=0.928, accuracy=0.816, val_loss=0.961, val_accuracy=0.783, lr=0.01] 42%|████▏     | 53/125 [18:53<25:05, 20.91s/epoch, loss=0.74, accuracy=0.848, val_loss=1, val_accuracy=0.755, lr=0.01]      43%|████▎     | 54/125 [19:14<24:46, 20.94s/epoch, loss=0.656, accuracy=0.857, val_loss=0.723, val_accuracy=0.826, lr=0.01] 44%|████▍     | 55/125 [19:35<24:29, 20.99s/epoch, loss=0.613, accuracy=0.86, val_loss=0.829, val_accuracy=0.783, lr=0.01]  45%|████▍     | 56/125 [19:56<24:07, 20.98s/epoch, loss=0.584, accuracy=0.864, val_loss=0.732, val_accuracy=0.816, lr=0.01] 46%|████▌     | 57/125 [20:17<23:46, 20.97s/epoch, loss=0.576, accuracy=0.864, val_loss=0.747, val_accuracy=0.81, lr=0.01]  46%|████▋     | 58/125 [20:38<23:27, 21.00s/epoch, loss=0.567, accuracy=0.866, val_loss=0.769, val_accuracy=0.807, lr=0.01] 47%|████▋     | 59/125 [20:59<23:05, 20.99s/epoch, loss=0.567, accuracy=0.865, val_loss=0.705, val_accuracy=0.821, lr=0.01] 48%|████▊     | 60/125 [21:20<22:45, 21.01s/epoch, loss=0.563, accuracy=0.867, val_loss=0.764, val_accuracy=0.804, lr=0.01] 49%|████▉     | 61/125 [21:41<22:23, 21.00s/epoch, loss=0.561, accuracy=0.87, val_loss=0.786, val_accuracy=0.805, lr=0.01]  50%|████▉     | 62/125 [22:02<22:02, 20.99s/epoch, loss=0.562, accuracy=0.87, val_loss=0.838, val_accuracy=0.791, lr=0.01] 50%|█████     | 63/125 [22:23<21:38, 20.94s/epoch, loss=0.56, accuracy=0.873, val_loss=0.954, val_accuracy=0.764, lr=0.01] 51%|█████     | 64/125 [22:44<21:16, 20.93s/epoch, loss=0.565, accuracy=0.872, val_loss=0.765, val_accuracy=0.811, lr=0.01] 52%|█████▏    | 65/125 [23:05<20:53, 20.90s/epoch, loss=0.555, accuracy=0.875, val_loss=0.74, val_accuracy=0.817, lr=0.01]  53%|█████▎    | 66/125 [23:26<20:36, 20.95s/epoch, loss=0.558, accuracy=0.876, val_loss=1.14, val_accuracy=0.717, lr=0.01] 54%|█████▎    | 67/125 [23:47<20:17, 21.00s/epoch, loss=0.558, accuracy=0.877, val_loss=0.935, val_accuracy=0.757, lr=0.01] 54%|█████▍    | 68/125 [24:08<19:54, 20.95s/epoch, loss=0.559, accuracy=0.876, val_loss=0.808, val_accuracy=0.799, lr=0.01] 55%|█████▌    | 69/125 [24:28<19:31, 20.92s/epoch, loss=0.555, accuracy=0.877, val_loss=0.852, val_accuracy=0.789, lr=0.01] 56%|█████▌    | 70/125 [24:49<19:08, 20.87s/epoch, loss=0.558, accuracy=0.878, val_loss=0.783, val_accuracy=0.806, lr=0.01] 57%|█████▋    | 71/125 [25:10<18:44, 20.82s/epoch, loss=0.554, accuracy=0.88, val_loss=0.82, val_accuracy=0.794, lr=0.01]   58%|█████▊    | 72/125 [25:31<18:22, 20.81s/epoch, loss=0.554, accuracy=0.881, val_loss=0.9, val_accuracy=0.773, lr=0.01] 58%|█████▊    | 73/125 [25:51<18:00, 20.78s/epoch, loss=0.554, accuracy=0.881, val_loss=0.799, val_accuracy=0.805, lr=0.01] 59%|█████▉    | 74/125 [26:12<17:39, 20.77s/epoch, loss=0.552, accuracy=0.883, val_loss=1.01, val_accuracy=0.742, lr=0.01]  60%|██████    | 75/125 [26:36<18:00, 21.60s/epoch, loss=0.56, accuracy=0.881, val_loss=0.831, val_accuracy=0.797, lr=0.01] 61%|██████    | 76/125 [26:57<17:27, 21.38s/epoch, loss=0.555, accuracy=0.881, val_loss=0.809, val_accuracy=0.804, lr=0.01] 62%|██████▏   | 77/125 [27:17<16:58, 21.23s/epoch, loss=0.475, accuracy=0.911, val_loss=0.546, val_accuracy=0.885, lr=0.001] 62%|██████▏   | 78/125 [27:38<16:30, 21.08s/epoch, loss=0.426, accuracy=0.926, val_loss=0.529, val_accuracy=0.893, lr=0.001] 63%|██████▎   | 79/125 [27:59<16:05, 20.98s/epoch, loss=0.402, accuracy=0.933, val_loss=0.529, val_accuracy=0.891, lr=0.001] 64%|██████▍   | 80/125 [28:20<15:40, 20.91s/epoch, loss=0.387, accuracy=0.935, val_loss=0.505, val_accuracy=0.896, lr=0.001] 65%|██████▍   | 81/125 [28:40<15:17, 20.85s/epoch, loss=0.374, accuracy=0.938, val_loss=0.502, val_accuracy=0.898, lr=0.001] 66%|██████▌   | 82/125 [29:01<14:54, 20.81s/epoch, loss=0.359, accuracy=0.942, val_loss=0.49, val_accuracy=0.9, lr=0.001]    66%|██████▋   | 83/125 [29:22<14:33, 20.79s/epoch, loss=0.351, accuracy=0.942, val_loss=0.491, val_accuracy=0.894, lr=0.001] 67%|██████▋   | 84/125 [29:42<14:10, 20.75s/epoch, loss=0.34, accuracy=0.945, val_loss=0.483, val_accuracy=0.899, lr=0.001]  68%|██████▊   | 85/125 [30:03<13:48, 20.72s/epoch, loss=0.331, accuracy=0.947, val_loss=0.477, val_accuracy=0.901, lr=0.001] 69%|██████▉   | 86/125 [30:24<13:26, 20.69s/epoch, loss=0.322, accuracy=0.948, val_loss=0.492, val_accuracy=0.894, lr=0.001] 70%|██████▉   | 87/125 [30:44<13:05, 20.67s/epoch, loss=0.314, accuracy=0.95, val_loss=0.475, val_accuracy=0.899, lr=0.001]  70%|███████   | 88/125 [31:05<12:44, 20.67s/epoch, loss=0.305, accuracy=0.95, val_loss=0.472, val_accuracy=0.897, lr=0.001] 71%|███████   | 89/125 [31:26<12:24, 20.67s/epoch, loss=0.298, accuracy=0.953, val_loss=0.467, val_accuracy=0.902, lr=0.001] 72%|███████▏  | 90/125 [31:46<12:03, 20.68s/epoch, loss=0.292, accuracy=0.952, val_loss=0.485, val_accuracy=0.891, lr=0.001] 73%|███████▎  | 91/125 [32:07<11:43, 20.68s/epoch, loss=0.288, accuracy=0.953, val_loss=0.517, val_accuracy=0.886, lr=0.001] 74%|███████▎  | 92/125 [32:28<11:22, 20.69s/epoch, loss=0.281, accuracy=0.954, val_loss=0.452, val_accuracy=0.9, lr=0.001]   74%|███████▍  | 93/125 [32:48<11:01, 20.67s/epoch, loss=0.273, accuracy=0.956, val_loss=0.46, val_accuracy=0.896, lr=0.001] 75%|███████▌  | 94/125 [33:09<10:39, 20.64s/epoch, loss=0.271, accuracy=0.955, val_loss=0.459, val_accuracy=0.898, lr=0.001] 76%|███████▌  | 95/125 [33:30<10:18, 20.63s/epoch, loss=0.267, accuracy=0.955, val_loss=0.459, val_accuracy=0.897, lr=0.001] 77%|███████▋  | 96/125 [33:50<09:58, 20.63s/epoch, loss=0.26, accuracy=0.957, val_loss=0.471, val_accuracy=0.895, lr=0.001]  78%|███████▊  | 97/125 [34:11<09:38, 20.65s/epoch, loss=0.258, accuracy=0.957, val_loss=0.455, val_accuracy=0.897, lr=0.001] 78%|███████▊  | 98/125 [34:32<09:18, 20.69s/epoch, loss=0.254, accuracy=0.957, val_loss=0.46, val_accuracy=0.897, lr=0.001]  79%|███████▉  | 99/125 [34:52<08:57, 20.68s/epoch, loss=0.25, accuracy=0.957, val_loss=0.462, val_accuracy=0.894, lr=0.001] 80%|████████  | 100/125 [35:13<08:37, 20.70s/epoch, loss=0.245, accuracy=0.959, val_loss=0.477, val_accuracy=0.888, lr=0.001] 81%|████████  | 101/125 [35:34<08:16, 20.70s/epoch, loss=0.242, accuracy=0.959, val_loss=0.477, val_accuracy=0.891, lr=0.001] 82%|████████▏ | 102/125 [35:55<07:56, 20.72s/epoch, loss=0.224, accuracy=0.967, val_loss=0.419, val_accuracy=0.909, lr=1e-04] 82%|████████▏ | 103/125 [36:15<07:35, 20.71s/epoch, loss=0.216, accuracy=0.969, val_loss=0.42, val_accuracy=0.909, lr=1e-04]  83%|████████▎ | 104/125 [36:36<07:14, 20.70s/epoch, loss=0.211, accuracy=0.971, val_loss=0.417, val_accuracy=0.909, lr=1e-04] 84%|████████▍ | 105/125 [36:56<06:53, 20.66s/epoch, loss=0.209, accuracy=0.972, val_loss=0.415, val_accuracy=0.91, lr=1e-04]  85%|████████▍ | 106/125 [37:17<06:32, 20.65s/epoch, loss=0.206, accuracy=0.974, val_loss=0.413, val_accuracy=0.911, lr=1e-04] 86%|████████▌ | 107/125 [37:38<06:11, 20.65s/epoch, loss=0.207, accuracy=0.973, val_loss=0.414, val_accuracy=0.911, lr=1e-04] 86%|████████▋ | 108/125 [37:58<05:50, 20.63s/epoch, loss=0.203, accuracy=0.974, val_loss=0.415, val_accuracy=0.911, lr=1e-04] 87%|████████▋ | 109/125 [38:19<05:29, 20.61s/epoch, loss=0.203, accuracy=0.974, val_loss=0.415, val_accuracy=0.91, lr=1e-04]  88%|████████▊ | 110/125 [38:40<05:08, 20.60s/epoch, loss=0.202, accuracy=0.974, val_loss=0.416, val_accuracy=0.91, lr=1e-04] 89%|████████▉ | 111/125 [39:00<04:48, 20.61s/epoch, loss=0.2, accuracy=0.975, val_loss=0.414, val_accuracy=0.911, lr=1e-04]  90%|████████▉ | 112/125 [39:21<04:27, 20.59s/epoch, loss=0.198, accuracy=0.975, val_loss=0.413, val_accuracy=0.91, lr=1e-04] 90%|█████████ | 113/125 [39:41<04:06, 20.56s/epoch, loss=0.197, accuracy=0.975, val_loss=0.413, val_accuracy=0.91, lr=1e-04] 91%|█████████ | 114/125 [40:02<03:46, 20.57s/epoch, loss=0.196, accuracy=0.976, val_loss=0.412, val_accuracy=0.91, lr=5e-5]  92%|█████████▏| 115/125 [40:22<03:25, 20.56s/epoch, loss=0.195, accuracy=0.976, val_loss=0.412, val_accuracy=0.91, lr=5e-5] 93%|█████████▎| 116/125 [40:43<03:04, 20.55s/epoch, loss=0.194, accuracy=0.976, val_loss=0.413, val_accuracy=0.911, lr=5e-5] 94%|█████████▎| 117/125 [41:03<02:44, 20.57s/epoch, loss=0.194, accuracy=0.976, val_loss=0.413, val_accuracy=0.911, lr=5e-5] 94%|█████████▍| 118/125 [41:24<02:24, 20.58s/epoch, loss=0.193, accuracy=0.977, val_loss=0.413, val_accuracy=0.911, lr=5e-5] 95%|█████████▌| 119/125 [41:45<02:03, 20.58s/epoch, loss=0.192, accuracy=0.977, val_loss=0.413, val_accuracy=0.911, lr=5e-5] 96%|█████████▌| 120/125 [42:05<01:42, 20.58s/epoch, loss=0.191, accuracy=0.978, val_loss=0.413, val_accuracy=0.911, lr=5e-5] 97%|█████████▋| 121/125 [42:26<01:22, 20.58s/epoch, loss=0.192, accuracy=0.977, val_loss=0.413, val_accuracy=0.912, lr=5e-5] 98%|█████████▊| 122/125 [42:46<01:01, 20.61s/epoch, loss=0.191, accuracy=0.977, val_loss=0.413, val_accuracy=0.912, lr=5e-5] 98%|█████████▊| 123/125 [43:07<00:41, 20.62s/epoch, loss=0.191, accuracy=0.977, val_loss=0.412, val_accuracy=0.91, lr=5e-5]  99%|█████████▉| 124/125 [43:28<00:20, 20.65s/epoch, loss=0.189, accuracy=0.978, val_loss=0.412, val_accuracy=0.912, lr=5e-5]100%|██████████| 125/125 [43:49<00:00, 20.67s/epoch, loss=0.188, accuracy=0.979, val_loss=0.412, val_accuracy=0.911, lr=5e-5]100%|██████████| 125/125 [43:49<00:00, 21.03s/epoch, loss=0.188, accuracy=0.979, val_loss=0.412, val_accuracy=0.911, lr=5e-5]
Using real-time data augmentation.
Only one model saved

Loading model: 12_09_cifar10_ResNet20v1.h5
Test score: 0.4119401276111603
Test accuracy: 0.9106000065803528


* * * Run SGD for ID = 12_10. * * *


2024-03-13 08:48:05.019863: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 08:48:09.196590: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 08:48:09.197677: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-13 08:48:09.237119: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-13 08:48:09.237153: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 08:48:09.239876: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 08:48:09.239936: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 08:48:09.242168: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 08:48:09.242862: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 08:48:09.245341: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 08:48:09.246897: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 08:48:09.251838: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 08:48:09.252344: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 08:48:09.252421: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 08:48:10.585736: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-13 08:48:10.586656: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 08:48:10.587427: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-13 08:48:10.587459: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 08:48:10.587496: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 08:48:10.587514: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 08:48:10.587546: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 08:48:10.587564: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 08:48:10.587580: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 08:48:10.587596: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 08:48:10.587612: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 08:48:10.588071: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 08:48:10.588106: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 08:48:11.293267: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-13 08:48:11.293317: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-13 08:48:11.293334: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-13 08:48:11.294239: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:83:00.0, compute capability: 6.1)
{'id': '12_10', 'seed': 10, 'out_folder': 'results/epoch_budget_2', 'batch_size': 128, 'epochs': 125, 'validation_split': 0.0, 'checkpointing': False, 'checkpoint_every': -1, 'hold_out_validation_split': 0.0, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'num_classes': 10, 'SSE_lr': False, 'test_time_augmentation': False, 'debug': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
y_train shape: (50000, 10)
x_val shape: (10000, 32, 32, 3)
y_val shape: (10000, 10)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/125 [00:00<?, ?epoch/s]2024-03-13 08:48:11.961597: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-13 08:48:11.962107: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199945000 Hz
2024-03-13 08:48:14.151269: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 08:48:14.365088: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 08:48:15.177031: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-13 08:48:15.215519: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/125 [00:49<1:41:56, 49.33s/epoch, loss=2.89, accuracy=0.37, val_loss=3.09, val_accuracy=0.205, lr=0.1]  2%|▏         | 2/125 [01:10<1:06:53, 32.63s/epoch, loss=1.46, accuracy=0.588, val_loss=1.65, val_accuracy=0.536, lr=0.1]  2%|▏         | 3/125 [01:31<55:29, 27.29s/epoch, loss=1.3, accuracy=0.668, val_loss=2.01, val_accuracy=0.432, lr=0.1]     3%|▎         | 4/125 [01:51<49:49, 24.71s/epoch, loss=1.25, accuracy=0.697, val_loss=1.87, val_accuracy=0.509, lr=0.1]  4%|▍         | 5/125 [02:12<46:35, 23.30s/epoch, loss=1.24, accuracy=0.707, val_loss=1.63, val_accuracy=0.585, lr=0.1]  5%|▍         | 6/125 [02:33<44:32, 22.46s/epoch, loss=1.21, accuracy=0.716, val_loss=1.54, val_accuracy=0.612, lr=0.1]  6%|▌         | 7/125 [02:54<43:05, 21.91s/epoch, loss=1.21, accuracy=0.723, val_loss=1.46, val_accuracy=0.641, lr=0.1]  6%|▋         | 8/125 [03:15<42:02, 21.56s/epoch, loss=1.2, accuracy=0.728, val_loss=1.5, val_accuracy=0.623, lr=0.1]    7%|▋         | 9/125 [03:35<41:12, 21.31s/epoch, loss=1.2, accuracy=0.732, val_loss=2.35, val_accuracy=0.449, lr=0.1]  8%|▊         | 10/125 [03:56<40:31, 21.14s/epoch, loss=1.18, accuracy=0.736, val_loss=1.54, val_accuracy=0.617, lr=0.1]  9%|▉         | 11/125 [04:17<39:58, 21.04s/epoch, loss=1.19, accuracy=0.735, val_loss=1.61, val_accuracy=0.589, lr=0.1] 10%|▉         | 12/125 [04:38<39:28, 20.96s/epoch, loss=1.18, accuracy=0.736, val_loss=2.99, val_accuracy=0.33, lr=0.1]  10%|█         | 13/125 [04:59<38:59, 20.89s/epoch, loss=1.18, accuracy=0.738, val_loss=1.9, val_accuracy=0.56, lr=0.1]  11%|█         | 14/125 [05:19<38:33, 20.85s/epoch, loss=1.18, accuracy=0.741, val_loss=1.38, val_accuracy=0.667, lr=0.1] 12%|█▏        | 15/125 [05:40<38:10, 20.82s/epoch, loss=1.17, accuracy=0.741, val_loss=1.76, val_accuracy=0.596, lr=0.1] 13%|█▎        | 16/125 [06:01<37:49, 20.82s/epoch, loss=1.17, accuracy=0.744, val_loss=2.71, val_accuracy=0.46, lr=0.1]  14%|█▎        | 17/125 [06:22<37:24, 20.78s/epoch, loss=1.17, accuracy=0.744, val_loss=1.41, val_accuracy=0.65, lr=0.1] 14%|█▍        | 18/125 [06:42<37:02, 20.78s/epoch, loss=1.16, accuracy=0.746, val_loss=3.28, val_accuracy=0.384, lr=0.1] 15%|█▌        | 19/125 [07:03<36:43, 20.79s/epoch, loss=1.15, accuracy=0.747, val_loss=1.59, val_accuracy=0.618, lr=0.1] 16%|█▌        | 20/125 [07:24<36:25, 20.81s/epoch, loss=1.16, accuracy=0.748, val_loss=1.45, val_accuracy=0.66, lr=0.1]  17%|█▋        | 21/125 [07:45<36:07, 20.84s/epoch, loss=1.15, accuracy=0.748, val_loss=1.77, val_accuracy=0.535, lr=0.1] 18%|█▊        | 22/125 [08:06<35:48, 20.86s/epoch, loss=1.15, accuracy=0.747, val_loss=3.02, val_accuracy=0.32, lr=0.1]  18%|█▊        | 23/125 [08:27<35:25, 20.83s/epoch, loss=1.15, accuracy=0.746, val_loss=1.9, val_accuracy=0.507, lr=0.1] 19%|█▉        | 24/125 [08:47<35:06, 20.86s/epoch, loss=1.15, accuracy=0.749, val_loss=1.94, val_accuracy=0.475, lr=0.1] 20%|██        | 25/125 [09:08<34:46, 20.87s/epoch, loss=1.15, accuracy=0.75, val_loss=2.03, val_accuracy=0.511, lr=0.1]  21%|██        | 26/125 [09:29<34:23, 20.84s/epoch, loss=1.14, accuracy=0.752, val_loss=2.91, val_accuracy=0.451, lr=0.1] 22%|██▏       | 27/125 [09:50<34:02, 20.84s/epoch, loss=1.15, accuracy=0.75, val_loss=1.69, val_accuracy=0.611, lr=0.1]  22%|██▏       | 28/125 [10:11<33:43, 20.86s/epoch, loss=1.14, accuracy=0.751, val_loss=1.65, val_accuracy=0.578, lr=0.1] 23%|██▎       | 29/125 [10:32<33:19, 20.83s/epoch, loss=1.14, accuracy=0.751, val_loss=2.05, val_accuracy=0.517, lr=0.1] 24%|██▍       | 30/125 [10:53<33:00, 20.84s/epoch, loss=1.14, accuracy=0.75, val_loss=1.45, val_accuracy=0.641, lr=0.1]  25%|██▍       | 31/125 [11:13<32:37, 20.83s/epoch, loss=1.14, accuracy=0.751, val_loss=5.63, val_accuracy=0.25, lr=0.1] 26%|██▌       | 32/125 [11:34<32:16, 20.83s/epoch, loss=1.14, accuracy=0.751, val_loss=1.82, val_accuracy=0.582, lr=0.1] 26%|██▋       | 33/125 [11:55<31:53, 20.80s/epoch, loss=1.13, accuracy=0.754, val_loss=2.07, val_accuracy=0.523, lr=0.1] 27%|██▋       | 34/125 [12:16<31:30, 20.78s/epoch, loss=1.13, accuracy=0.754, val_loss=1.75, val_accuracy=0.564, lr=0.1] 28%|██▊       | 35/125 [12:36<31:11, 20.79s/epoch, loss=1.13, accuracy=0.753, val_loss=2.1, val_accuracy=0.471, lr=0.1]  29%|██▉       | 36/125 [12:57<30:48, 20.77s/epoch, loss=1.13, accuracy=0.752, val_loss=1.96, val_accuracy=0.472, lr=0.1] 30%|██▉       | 37/125 [13:18<30:28, 20.77s/epoch, loss=1.13, accuracy=0.753, val_loss=2.54, val_accuracy=0.466, lr=0.1] 30%|███       | 38/125 [13:39<30:08, 20.78s/epoch, loss=1.13, accuracy=0.752, val_loss=2.24, val_accuracy=0.511, lr=0.1] 31%|███       | 39/125 [13:59<29:46, 20.77s/epoch, loss=1.13, accuracy=0.753, val_loss=1.54, val_accuracy=0.625, lr=0.1] 32%|███▏      | 40/125 [14:20<29:25, 20.77s/epoch, loss=1.12, accuracy=0.755, val_loss=1.66, val_accuracy=0.567, lr=0.1] 33%|███▎      | 41/125 [14:41<29:07, 20.80s/epoch, loss=1.12, accuracy=0.753, val_loss=1.93, val_accuracy=0.496, lr=0.1] 34%|███▎      | 42/125 [15:02<28:44, 20.77s/epoch, loss=1.12, accuracy=0.757, val_loss=1.69, val_accuracy=0.59, lr=0.1]  34%|███▍      | 43/125 [15:23<28:26, 20.82s/epoch, loss=1.12, accuracy=0.755, val_loss=2.63, val_accuracy=0.36, lr=0.1] 35%|███▌      | 44/125 [15:44<28:07, 20.84s/epoch, loss=1.12, accuracy=0.757, val_loss=2.04, val_accuracy=0.464, lr=0.1] 36%|███▌      | 45/125 [16:05<27:49, 20.87s/epoch, loss=1.12, accuracy=0.757, val_loss=1.7, val_accuracy=0.57, lr=0.1]   37%|███▋      | 46/125 [16:25<27:28, 20.87s/epoch, loss=1.12, accuracy=0.755, val_loss=2.8, val_accuracy=0.33, lr=0.1] 38%|███▊      | 47/125 [16:46<27:08, 20.88s/epoch, loss=1.12, accuracy=0.758, val_loss=2.39, val_accuracy=0.479, lr=0.1] 38%|███▊      | 48/125 [17:07<26:47, 20.88s/epoch, loss=1.12, accuracy=0.757, val_loss=2.16, val_accuracy=0.495, lr=0.1] 39%|███▉      | 49/125 [17:28<26:27, 20.89s/epoch, loss=1.13, accuracy=0.756, val_loss=1.51, val_accuracy=0.621, lr=0.1] 40%|████      | 50/125 [17:49<26:05, 20.88s/epoch, loss=1.12, accuracy=0.758, val_loss=1.57, val_accuracy=0.583, lr=0.1] 41%|████      | 51/125 [18:10<25:42, 20.84s/epoch, loss=1.11, accuracy=0.758, val_loss=4.92, val_accuracy=0.191, lr=0.1] 42%|████▏     | 52/125 [18:31<25:19, 20.82s/epoch, loss=0.91, accuracy=0.816, val_loss=1.09, val_accuracy=0.731, lr=0.01] 42%|████▏     | 53/125 [18:52<25:02, 20.87s/epoch, loss=0.733, accuracy=0.847, val_loss=0.816, val_accuracy=0.807, lr=0.01] 43%|████▎     | 54/125 [19:13<24:45, 20.92s/epoch, loss=0.651, accuracy=0.855, val_loss=0.753, val_accuracy=0.811, lr=0.01] 44%|████▍     | 55/125 [19:33<24:25, 20.93s/epoch, loss=0.609, accuracy=0.857, val_loss=0.861, val_accuracy=0.768, lr=0.01] 45%|████▍     | 56/125 [19:55<24:07, 20.98s/epoch, loss=0.588, accuracy=0.859, val_loss=0.903, val_accuracy=0.757, lr=0.01] 46%|████▌     | 57/125 [20:15<23:44, 20.95s/epoch, loss=0.577, accuracy=0.861, val_loss=0.724, val_accuracy=0.812, lr=0.01] 46%|████▋     | 58/125 [20:37<23:25, 20.98s/epoch, loss=0.571, accuracy=0.861, val_loss=0.93, val_accuracy=0.743, lr=0.01]  47%|████▋     | 59/125 [20:57<23:01, 20.93s/epoch, loss=0.569, accuracy=0.862, val_loss=0.77, val_accuracy=0.804, lr=0.01] 48%|████▊     | 60/125 [21:18<22:38, 20.90s/epoch, loss=0.565, accuracy=0.864, val_loss=0.805, val_accuracy=0.79, lr=0.01] 49%|████▉     | 61/125 [21:39<22:15, 20.86s/epoch, loss=0.562, accuracy=0.866, val_loss=0.811, val_accuracy=0.786, lr=0.01] 50%|████▉     | 62/125 [22:00<21:52, 20.84s/epoch, loss=0.56, accuracy=0.87, val_loss=0.73, val_accuracy=0.813, lr=0.01]    50%|█████     | 63/125 [22:20<21:28, 20.79s/epoch, loss=0.565, accuracy=0.868, val_loss=1.04, val_accuracy=0.745, lr=0.01] 51%|█████     | 64/125 [22:41<21:05, 20.75s/epoch, loss=0.56, accuracy=0.871, val_loss=0.885, val_accuracy=0.784, lr=0.01] 52%|█████▏    | 65/125 [23:02<20:44, 20.75s/epoch, loss=0.563, accuracy=0.871, val_loss=0.847, val_accuracy=0.786, lr=0.01] 53%|█████▎    | 66/125 [23:23<20:24, 20.76s/epoch, loss=0.556, accuracy=0.874, val_loss=0.919, val_accuracy=0.762, lr=0.01] 54%|█████▎    | 67/125 [23:43<20:02, 20.74s/epoch, loss=0.559, accuracy=0.875, val_loss=0.862, val_accuracy=0.787, lr=0.01] 54%|█████▍    | 68/125 [24:04<19:41, 20.73s/epoch, loss=0.556, accuracy=0.876, val_loss=0.844, val_accuracy=0.783, lr=0.01] 55%|█████▌    | 69/125 [24:25<19:19, 20.71s/epoch, loss=0.56, accuracy=0.876, val_loss=0.894, val_accuracy=0.788, lr=0.01]  56%|█████▌    | 70/125 [24:45<18:58, 20.69s/epoch, loss=0.56, accuracy=0.875, val_loss=0.722, val_accuracy=0.823, lr=0.01] 57%|█████▋    | 71/125 [25:06<18:36, 20.68s/epoch, loss=0.553, accuracy=0.878, val_loss=0.906, val_accuracy=0.77, lr=0.01] 58%|█████▊    | 72/125 [25:27<18:16, 20.68s/epoch, loss=0.557, accuracy=0.879, val_loss=0.761, val_accuracy=0.808, lr=0.01] 58%|█████▊    | 73/125 [25:47<17:54, 20.67s/epoch, loss=0.562, accuracy=0.876, val_loss=0.814, val_accuracy=0.8, lr=0.01]   59%|█████▉    | 74/125 [26:08<17:35, 20.70s/epoch, loss=0.556, accuracy=0.879, val_loss=0.885, val_accuracy=0.769, lr=0.01] 60%|██████    | 75/125 [26:29<17:15, 20.71s/epoch, loss=0.556, accuracy=0.879, val_loss=0.854, val_accuracy=0.785, lr=0.01] 61%|██████    | 76/125 [26:50<16:55, 20.73s/epoch, loss=0.561, accuracy=0.878, val_loss=0.916, val_accuracy=0.78, lr=0.01]  62%|██████▏   | 77/125 [27:10<16:35, 20.74s/epoch, loss=0.479, accuracy=0.908, val_loss=0.544, val_accuracy=0.887, lr=0.001] 62%|██████▏   | 78/125 [27:31<16:14, 20.73s/epoch, loss=0.429, accuracy=0.924, val_loss=0.526, val_accuracy=0.893, lr=0.001] 63%|██████▎   | 79/125 [27:52<15:54, 20.74s/epoch, loss=0.407, accuracy=0.929, val_loss=0.524, val_accuracy=0.89, lr=0.001]  64%|██████▍   | 80/125 [28:13<15:34, 20.76s/epoch, loss=0.389, accuracy=0.933, val_loss=0.509, val_accuracy=0.893, lr=0.001] 65%|██████▍   | 81/125 [28:33<15:12, 20.75s/epoch, loss=0.379, accuracy=0.934, val_loss=0.501, val_accuracy=0.897, lr=0.001] 66%|██████▌   | 82/125 [28:54<14:51, 20.73s/epoch, loss=0.365, accuracy=0.938, val_loss=0.496, val_accuracy=0.896, lr=0.001] 66%|██████▋   | 83/125 [29:15<14:30, 20.72s/epoch, loss=0.356, accuracy=0.94, val_loss=0.493, val_accuracy=0.896, lr=0.001]  67%|██████▋   | 84/125 [29:35<14:09, 20.71s/epoch, loss=0.344, accuracy=0.941, val_loss=0.491, val_accuracy=0.894, lr=0.001] 68%|██████▊   | 85/125 [29:56<13:47, 20.69s/epoch, loss=0.334, accuracy=0.943, val_loss=0.495, val_accuracy=0.893, lr=0.001] 69%|██████▉   | 86/125 [30:17<13:26, 20.69s/epoch, loss=0.325, accuracy=0.944, val_loss=0.495, val_accuracy=0.893, lr=0.001] 70%|██████▉   | 87/125 [30:37<13:04, 20.65s/epoch, loss=0.319, accuracy=0.945, val_loss=0.501, val_accuracy=0.892, lr=0.001] 70%|███████   | 88/125 [30:58<12:44, 20.66s/epoch, loss=0.309, accuracy=0.949, val_loss=0.483, val_accuracy=0.896, lr=0.001] 71%|███████   | 89/125 [31:19<12:23, 20.65s/epoch, loss=0.302, accuracy=0.949, val_loss=0.506, val_accuracy=0.89, lr=0.001]  72%|███████▏  | 90/125 [31:39<12:01, 20.62s/epoch, loss=0.296, accuracy=0.951, val_loss=0.491, val_accuracy=0.891, lr=0.001] 73%|███████▎  | 91/125 [32:00<11:41, 20.63s/epoch, loss=0.29, accuracy=0.951, val_loss=0.492, val_accuracy=0.893, lr=0.001]  74%|███████▎  | 92/125 [32:20<11:20, 20.62s/epoch, loss=0.285, accuracy=0.951, val_loss=0.492, val_accuracy=0.891, lr=0.001] 74%|███████▍  | 93/125 [32:41<10:59, 20.62s/epoch, loss=0.275, accuracy=0.953, val_loss=0.512, val_accuracy=0.884, lr=0.001] 75%|███████▌  | 94/125 [33:02<10:38, 20.61s/epoch, loss=0.273, accuracy=0.953, val_loss=0.498, val_accuracy=0.887, lr=0.001] 76%|███████▌  | 95/125 [33:22<10:17, 20.60s/epoch, loss=0.271, accuracy=0.952, val_loss=0.474, val_accuracy=0.893, lr=0.001] 77%|███████▋  | 96/125 [33:43<09:57, 20.61s/epoch, loss=0.267, accuracy=0.953, val_loss=0.518, val_accuracy=0.882, lr=0.001] 78%|███████▊  | 97/125 [34:03<09:37, 20.62s/epoch, loss=0.261, accuracy=0.954, val_loss=0.485, val_accuracy=0.89, lr=0.001]  78%|███████▊  | 98/125 [34:24<09:17, 20.64s/epoch, loss=0.255, accuracy=0.956, val_loss=0.483, val_accuracy=0.891, lr=0.001] 79%|███████▉  | 99/125 [34:45<08:56, 20.64s/epoch, loss=0.256, accuracy=0.955, val_loss=0.502, val_accuracy=0.886, lr=0.001] 80%|████████  | 100/125 [35:05<08:36, 20.66s/epoch, loss=0.249, accuracy=0.955, val_loss=0.482, val_accuracy=0.887, lr=0.001] 81%|████████  | 101/125 [35:26<08:16, 20.67s/epoch, loss=0.248, accuracy=0.956, val_loss=0.495, val_accuracy=0.889, lr=0.001] 82%|████████▏ | 102/125 [35:47<07:56, 20.70s/epoch, loss=0.228, accuracy=0.965, val_loss=0.44, val_accuracy=0.903, lr=1e-04]  82%|████████▏ | 103/125 [36:08<07:34, 20.68s/epoch, loss=0.216, accuracy=0.969, val_loss=0.438, val_accuracy=0.904, lr=1e-04] 83%|████████▎ | 104/125 [36:28<07:14, 20.69s/epoch, loss=0.212, accuracy=0.97, val_loss=0.437, val_accuracy=0.904, lr=1e-04]  84%|████████▍ | 105/125 [36:49<06:53, 20.67s/epoch, loss=0.209, accuracy=0.971, val_loss=0.437, val_accuracy=0.905, lr=1e-04] 85%|████████▍ | 106/125 [37:10<06:32, 20.67s/epoch, loss=0.205, accuracy=0.973, val_loss=0.438, val_accuracy=0.905, lr=1e-04] 86%|████████▌ | 107/125 [37:30<06:11, 20.66s/epoch, loss=0.202, accuracy=0.973, val_loss=0.439, val_accuracy=0.906, lr=1e-04] 86%|████████▋ | 108/125 [37:51<05:50, 20.62s/epoch, loss=0.203, accuracy=0.973, val_loss=0.44, val_accuracy=0.903, lr=1e-04]  87%|████████▋ | 109/125 [38:11<05:29, 20.58s/epoch, loss=0.2, accuracy=0.974, val_loss=0.437, val_accuracy=0.904, lr=1e-04]  88%|████████▊ | 110/125 [38:32<05:08, 20.57s/epoch, loss=0.199, accuracy=0.974, val_loss=0.44, val_accuracy=0.905, lr=1e-04] 89%|████████▉ | 111/125 [38:52<04:47, 20.55s/epoch, loss=0.198, accuracy=0.974, val_loss=0.441, val_accuracy=0.905, lr=1e-04] 90%|████████▉ | 112/125 [39:13<04:27, 20.56s/epoch, loss=0.195, accuracy=0.976, val_loss=0.441, val_accuracy=0.903, lr=1e-04] 90%|█████████ | 113/125 [39:33<04:06, 20.51s/epoch, loss=0.194, accuracy=0.975, val_loss=0.443, val_accuracy=0.904, lr=1e-04] 91%|█████████ | 114/125 [39:54<03:45, 20.52s/epoch, loss=0.193, accuracy=0.976, val_loss=0.441, val_accuracy=0.904, lr=5e-5]  92%|█████████▏| 115/125 [40:14<03:25, 20.52s/epoch, loss=0.192, accuracy=0.977, val_loss=0.441, val_accuracy=0.905, lr=5e-5] 93%|█████████▎| 116/125 [40:35<03:04, 20.52s/epoch, loss=0.192, accuracy=0.976, val_loss=0.44, val_accuracy=0.906, lr=5e-5]  94%|█████████▎| 117/125 [40:55<02:43, 20.49s/epoch, loss=0.191, accuracy=0.977, val_loss=0.44, val_accuracy=0.904, lr=5e-5] 94%|█████████▍| 118/125 [41:16<02:23, 20.49s/epoch, loss=0.191, accuracy=0.976, val_loss=0.44, val_accuracy=0.905, lr=5e-5] 95%|█████████▌| 119/125 [41:36<02:03, 20.50s/epoch, loss=0.189, accuracy=0.977, val_loss=0.441, val_accuracy=0.905, lr=5e-5] 96%|█████████▌| 120/125 [41:57<01:42, 20.54s/epoch, loss=0.189, accuracy=0.977, val_loss=0.44, val_accuracy=0.905, lr=5e-5]  97%|█████████▋| 121/125 [42:17<01:22, 20.52s/epoch, loss=0.189, accuracy=0.977, val_loss=0.442, val_accuracy=0.904, lr=5e-5] 98%|█████████▊| 122/125 [42:38<01:01, 20.54s/epoch, loss=0.189, accuracy=0.977, val_loss=0.441, val_accuracy=0.905, lr=5e-5] 98%|█████████▊| 123/125 [42:59<00:41, 20.55s/epoch, loss=0.185, accuracy=0.978, val_loss=0.442, val_accuracy=0.905, lr=5e-5] 99%|█████████▉| 124/125 [43:19<00:20, 20.56s/epoch, loss=0.185, accuracy=0.978, val_loss=0.44, val_accuracy=0.904, lr=5e-5] 100%|██████████| 125/125 [43:40<00:00, 20.56s/epoch, loss=0.187, accuracy=0.978, val_loss=0.442, val_accuracy=0.904, lr=5e-5]100%|██████████| 125/125 [43:40<00:00, 20.96s/epoch, loss=0.187, accuracy=0.978, val_loss=0.442, val_accuracy=0.904, lr=5e-5]
Using real-time data augmentation.
Only one model saved

Loading model: 12_10_cifar10_ResNet20v1.h5
Test score: 0.44189390540122986
Test accuracy: 0.9042999744415283


* * * Run SGD for ID = 12_11. * * *


2024-03-13 09:31:56.097909: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 09:32:02.461970: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 09:32:02.463047: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-13 09:32:02.502926: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-13 09:32:02.502960: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 09:32:02.508884: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 09:32:02.508930: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 09:32:02.512738: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 09:32:02.515067: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 09:32:02.518727: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 09:32:02.521670: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 09:32:02.528239: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 09:32:02.528768: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 09:32:02.528856: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 09:32:03.862381: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-13 09:32:03.862885: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 09:32:03.863316: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-13 09:32:03.863346: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 09:32:03.863380: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 09:32:03.863397: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 09:32:03.863413: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 09:32:03.863429: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 09:32:03.863446: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 09:32:03.863463: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 09:32:03.863479: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 09:32:03.863950: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 09:32:03.863986: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 09:32:04.580830: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-13 09:32:04.580894: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-13 09:32:04.580904: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-13 09:32:04.582167: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:83:00.0, compute capability: 6.1)
{'id': '12_11', 'seed': 11, 'out_folder': 'results/epoch_budget_2', 'batch_size': 128, 'epochs': 125, 'validation_split': 0.0, 'checkpointing': False, 'checkpoint_every': -1, 'hold_out_validation_split': 0.0, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'num_classes': 10, 'SSE_lr': False, 'test_time_augmentation': False, 'debug': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
y_train shape: (50000, 10)
x_val shape: (10000, 32, 32, 3)
y_val shape: (10000, 10)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/125 [00:00<?, ?epoch/s]2024-03-13 09:32:05.247343: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-13 09:32:05.247862: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199945000 Hz
2024-03-13 09:32:07.414607: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 09:32:07.604479: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 09:32:08.314844: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-13 09:32:08.356023: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/125 [00:48<1:40:47, 48.77s/epoch, loss=2.64, accuracy=0.477, val_loss=2.32, val_accuracy=0.364, lr=0.1]  2%|▏         | 2/125 [01:09<1:06:03, 32.22s/epoch, loss=1.4, accuracy=0.638, val_loss=2.77, val_accuracy=0.323, lr=0.1]   2%|▏         | 3/125 [01:29<54:32, 26.83s/epoch, loss=1.28, accuracy=0.682, val_loss=2.27, val_accuracy=0.442, lr=0.1]   3%|▎         | 4/125 [01:50<49:08, 24.36s/epoch, loss=1.25, accuracy=0.699, val_loss=2.32, val_accuracy=0.489, lr=0.1]  4%|▍         | 5/125 [02:10<45:52, 22.94s/epoch, loss=1.23, accuracy=0.709, val_loss=2.72, val_accuracy=0.462, lr=0.1]  5%|▍         | 6/125 [02:31<43:51, 22.12s/epoch, loss=1.21, accuracy=0.719, val_loss=1.48, val_accuracy=0.625, lr=0.1]  6%|▌         | 7/125 [02:51<42:28, 21.60s/epoch, loss=1.21, accuracy=0.722, val_loss=1.7, val_accuracy=0.56, lr=0.1]    6%|▋         | 8/125 [03:12<41:26, 21.25s/epoch, loss=1.2, accuracy=0.725, val_loss=1.7, val_accuracy=0.585, lr=0.1]  7%|▋         | 9/125 [03:32<40:39, 21.03s/epoch, loss=1.19, accuracy=0.728, val_loss=2.13, val_accuracy=0.437, lr=0.1]  8%|▊         | 10/125 [03:53<39:58, 20.86s/epoch, loss=1.18, accuracy=0.734, val_loss=1.5, val_accuracy=0.615, lr=0.1]  9%|▉         | 11/125 [04:13<39:24, 20.74s/epoch, loss=1.18, accuracy=0.734, val_loss=2.25, val_accuracy=0.493, lr=0.1] 10%|▉         | 12/125 [04:34<38:54, 20.66s/epoch, loss=1.18, accuracy=0.737, val_loss=2.49, val_accuracy=0.403, lr=0.1] 10%|█         | 13/125 [04:54<38:26, 20.60s/epoch, loss=1.17, accuracy=0.737, val_loss=2.36, val_accuracy=0.468, lr=0.1] 11%|█         | 14/125 [05:15<38:01, 20.56s/epoch, loss=1.17, accuracy=0.741, val_loss=1.8, val_accuracy=0.535, lr=0.1]  12%|█▏        | 15/125 [05:35<37:38, 20.53s/epoch, loss=1.16, accuracy=0.743, val_loss=2.06, val_accuracy=0.508, lr=0.1] 13%|█▎        | 16/125 [05:56<37:15, 20.51s/epoch, loss=1.16, accuracy=0.745, val_loss=2.41, val_accuracy=0.436, lr=0.1] 14%|█▎        | 17/125 [06:16<36:54, 20.50s/epoch, loss=1.15, accuracy=0.746, val_loss=2.09, val_accuracy=0.536, lr=0.1] 14%|█▍        | 18/125 [06:37<36:30, 20.48s/epoch, loss=1.15, accuracy=0.746, val_loss=4.58, val_accuracy=0.296, lr=0.1] 15%|█▌        | 19/125 [06:57<36:12, 20.50s/epoch, loss=1.16, accuracy=0.744, val_loss=3.4, val_accuracy=0.291, lr=0.1]  16%|█▌        | 20/125 [07:18<35:49, 20.47s/epoch, loss=1.15, accuracy=0.746, val_loss=2.12, val_accuracy=0.472, lr=0.1] 17%|█▋        | 21/125 [07:38<35:32, 20.51s/epoch, loss=1.15, accuracy=0.748, val_loss=2.05, val_accuracy=0.487, lr=0.1] 18%|█▊        | 22/125 [07:59<35:13, 20.52s/epoch, loss=1.15, accuracy=0.748, val_loss=2.22, val_accuracy=0.474, lr=0.1] 18%|█▊        | 23/125 [08:19<34:57, 20.56s/epoch, loss=1.15, accuracy=0.747, val_loss=1.69, val_accuracy=0.537, lr=0.1] 19%|█▉        | 24/125 [08:40<34:37, 20.57s/epoch, loss=1.15, accuracy=0.748, val_loss=1.95, val_accuracy=0.49, lr=0.1]  20%|██        | 25/125 [09:00<34:16, 20.56s/epoch, loss=1.13, accuracy=0.751, val_loss=1.83, val_accuracy=0.524, lr=0.1] 21%|██        | 26/125 [09:21<33:56, 20.57s/epoch, loss=1.14, accuracy=0.749, val_loss=6.64, val_accuracy=0.145, lr=0.1] 22%|██▏       | 27/125 [09:42<33:35, 20.57s/epoch, loss=1.13, accuracy=0.748, val_loss=4.22, val_accuracy=0.257, lr=0.1] 22%|██▏       | 28/125 [10:02<33:13, 20.55s/epoch, loss=1.13, accuracy=0.752, val_loss=1.67, val_accuracy=0.584, lr=0.1] 23%|██▎       | 29/125 [10:23<32:52, 20.54s/epoch, loss=1.13, accuracy=0.755, val_loss=2.05, val_accuracy=0.405, lr=0.1] 24%|██▍       | 30/125 [10:43<32:30, 20.53s/epoch, loss=1.14, accuracy=0.751, val_loss=1.98, val_accuracy=0.455, lr=0.1] 25%|██▍       | 31/125 [11:04<32:09, 20.53s/epoch, loss=1.13, accuracy=0.755, val_loss=1.73, val_accuracy=0.583, lr=0.1] 26%|██▌       | 32/125 [11:24<31:46, 20.50s/epoch, loss=1.13, accuracy=0.754, val_loss=2.01, val_accuracy=0.45, lr=0.1]  26%|██▋       | 33/125 [11:45<31:25, 20.49s/epoch, loss=1.12, accuracy=0.754, val_loss=2.4, val_accuracy=0.359, lr=0.1] 27%|██▋       | 34/125 [12:05<31:03, 20.48s/epoch, loss=1.13, accuracy=0.752, val_loss=1.41, val_accuracy=0.655, lr=0.1] 28%|██▊       | 35/125 [12:26<30:44, 20.49s/epoch, loss=1.12, accuracy=0.752, val_loss=2.15, val_accuracy=0.431, lr=0.1] 29%|██▉       | 36/125 [12:46<30:23, 20.49s/epoch, loss=1.12, accuracy=0.752, val_loss=1.73, val_accuracy=0.567, lr=0.1] 30%|██▉       | 37/125 [13:07<30:03, 20.49s/epoch, loss=1.13, accuracy=0.754, val_loss=1.9, val_accuracy=0.542, lr=0.1]  30%|███       | 38/125 [13:27<29:43, 20.50s/epoch, loss=1.12, accuracy=0.753, val_loss=2.21, val_accuracy=0.44, lr=0.1] 31%|███       | 39/125 [13:48<29:22, 20.50s/epoch, loss=1.12, accuracy=0.753, val_loss=2.67, val_accuracy=0.419, lr=0.1] 32%|███▏      | 40/125 [14:08<29:02, 20.50s/epoch, loss=1.12, accuracy=0.755, val_loss=2.15, val_accuracy=0.384, lr=0.1] 33%|███▎      | 41/125 [14:28<28:40, 20.48s/epoch, loss=1.12, accuracy=0.755, val_loss=2.85, val_accuracy=0.444, lr=0.1] 34%|███▎      | 42/125 [14:49<28:18, 20.47s/epoch, loss=1.12, accuracy=0.754, val_loss=3.13, val_accuracy=0.359, lr=0.1] 34%|███▍      | 43/125 [15:10<28:01, 20.51s/epoch, loss=1.12, accuracy=0.753, val_loss=2.18, val_accuracy=0.407, lr=0.1] 35%|███▌      | 44/125 [15:30<27:43, 20.54s/epoch, loss=1.12, accuracy=0.757, val_loss=1.82, val_accuracy=0.557, lr=0.1] 36%|███▌      | 45/125 [15:51<27:25, 20.57s/epoch, loss=1.12, accuracy=0.756, val_loss=2.49, val_accuracy=0.375, lr=0.1] 37%|███▋      | 46/125 [16:11<27:07, 20.60s/epoch, loss=1.12, accuracy=0.754, val_loss=1.5, val_accuracy=0.63, lr=0.1]   38%|███▊      | 47/125 [16:32<26:45, 20.59s/epoch, loss=1.12, accuracy=0.756, val_loss=1.66, val_accuracy=0.551, lr=0.1] 38%|███▊      | 48/125 [16:53<26:30, 20.65s/epoch, loss=1.12, accuracy=0.754, val_loss=1.51, val_accuracy=0.614, lr=0.1] 39%|███▉      | 49/125 [17:13<26:07, 20.62s/epoch, loss=1.11, accuracy=0.756, val_loss=1.62, val_accuracy=0.588, lr=0.1] 40%|████      | 50/125 [17:34<25:47, 20.63s/epoch, loss=1.11, accuracy=0.754, val_loss=2.06, val_accuracy=0.527, lr=0.1] 41%|████      | 51/125 [17:54<25:20, 20.55s/epoch, loss=1.12, accuracy=0.754, val_loss=2.38, val_accuracy=0.387, lr=0.1] 42%|████▏     | 52/125 [18:15<24:54, 20.48s/epoch, loss=0.9, accuracy=0.814, val_loss=0.877, val_accuracy=0.808, lr=0.01] 42%|████▏     | 53/125 [18:35<24:34, 20.47s/epoch, loss=0.723, accuracy=0.848, val_loss=0.778, val_accuracy=0.82, lr=0.01] 43%|████▎     | 54/125 [18:56<24:15, 20.50s/epoch, loss=0.647, accuracy=0.856, val_loss=0.742, val_accuracy=0.822, lr=0.01] 44%|████▍     | 55/125 [19:16<23:53, 20.48s/epoch, loss=0.607, accuracy=0.858, val_loss=0.826, val_accuracy=0.78, lr=0.01]  45%|████▍     | 56/125 [19:37<23:35, 20.52s/epoch, loss=0.586, accuracy=0.86, val_loss=0.753, val_accuracy=0.806, lr=0.01] 46%|████▌     | 57/125 [19:57<23:15, 20.52s/epoch, loss=0.578, accuracy=0.862, val_loss=0.677, val_accuracy=0.833, lr=0.01] 46%|████▋     | 58/125 [20:18<22:55, 20.53s/epoch, loss=0.57, accuracy=0.861, val_loss=0.777, val_accuracy=0.799, lr=0.01]  47%|████▋     | 59/125 [20:38<22:32, 20.50s/epoch, loss=0.568, accuracy=0.864, val_loss=0.809, val_accuracy=0.779, lr=0.01] 48%|████▊     | 60/125 [20:59<22:09, 20.46s/epoch, loss=0.565, accuracy=0.865, val_loss=1.04, val_accuracy=0.729, lr=0.01]  49%|████▉     | 61/125 [21:19<21:46, 20.42s/epoch, loss=0.562, accuracy=0.866, val_loss=0.886, val_accuracy=0.766, lr=0.01] 50%|████▉     | 62/125 [21:39<21:25, 20.40s/epoch, loss=0.558, accuracy=0.87, val_loss=0.756, val_accuracy=0.808, lr=0.01]  50%|█████     | 63/125 [22:00<21:03, 20.38s/epoch, loss=0.559, accuracy=0.87, val_loss=1.14, val_accuracy=0.705, lr=0.01]  51%|█████     | 64/125 [22:20<20:43, 20.38s/epoch, loss=0.558, accuracy=0.871, val_loss=0.948, val_accuracy=0.744, lr=0.01] 52%|█████▏    | 65/125 [22:40<20:22, 20.38s/epoch, loss=0.558, accuracy=0.872, val_loss=1.14, val_accuracy=0.698, lr=0.01]  53%|█████▎    | 66/125 [23:01<20:01, 20.37s/epoch, loss=0.553, accuracy=0.874, val_loss=0.99, val_accuracy=0.752, lr=0.01] 54%|█████▎    | 67/125 [23:21<19:41, 20.38s/epoch, loss=0.559, accuracy=0.873, val_loss=0.79, val_accuracy=0.81, lr=0.01]  54%|█████▍    | 68/125 [23:41<19:20, 20.36s/epoch, loss=0.554, accuracy=0.876, val_loss=0.886, val_accuracy=0.773, lr=0.01] 55%|█████▌    | 69/125 [24:02<18:59, 20.35s/epoch, loss=0.554, accuracy=0.877, val_loss=0.781, val_accuracy=0.802, lr=0.01] 56%|█████▌    | 70/125 [24:22<18:39, 20.36s/epoch, loss=0.554, accuracy=0.877, val_loss=0.801, val_accuracy=0.808, lr=0.01] 57%|█████▋    | 71/125 [24:42<18:18, 20.35s/epoch, loss=0.556, accuracy=0.879, val_loss=0.681, val_accuracy=0.838, lr=0.01] 58%|█████▊    | 72/125 [25:03<17:57, 20.33s/epoch, loss=0.557, accuracy=0.877, val_loss=1.06, val_accuracy=0.73, lr=0.01]   58%|█████▊    | 73/125 [25:23<17:36, 20.32s/epoch, loss=0.554, accuracy=0.879, val_loss=0.825, val_accuracy=0.797, lr=0.01] 59%|█████▉    | 74/125 [25:43<17:17, 20.34s/epoch, loss=0.554, accuracy=0.879, val_loss=0.872, val_accuracy=0.783, lr=0.01] 60%|██████    | 75/125 [26:04<16:59, 20.39s/epoch, loss=0.552, accuracy=0.88, val_loss=0.739, val_accuracy=0.82, lr=0.01]   61%|██████    | 76/125 [26:24<16:39, 20.40s/epoch, loss=0.55, accuracy=0.881, val_loss=0.844, val_accuracy=0.798, lr=0.01] 62%|██████▏   | 77/125 [26:45<16:20, 20.44s/epoch, loss=0.474, accuracy=0.908, val_loss=0.536, val_accuracy=0.887, lr=0.001] 62%|██████▏   | 78/125 [27:05<16:01, 20.45s/epoch, loss=0.425, accuracy=0.922, val_loss=0.513, val_accuracy=0.891, lr=0.001] 63%|██████▎   | 79/125 [27:26<15:40, 20.44s/epoch, loss=0.403, accuracy=0.928, val_loss=0.501, val_accuracy=0.895, lr=0.001] 64%|██████▍   | 80/125 [27:46<15:19, 20.43s/epoch, loss=0.388, accuracy=0.931, val_loss=0.492, val_accuracy=0.895, lr=0.001] 65%|██████▍   | 81/125 [28:07<14:57, 20.39s/epoch, loss=0.374, accuracy=0.935, val_loss=0.485, val_accuracy=0.897, lr=0.001] 66%|██████▌   | 82/125 [28:27<14:35, 20.36s/epoch, loss=0.36, accuracy=0.938, val_loss=0.482, val_accuracy=0.894, lr=0.001]  66%|██████▋   | 83/125 [28:47<14:14, 20.34s/epoch, loss=0.352, accuracy=0.938, val_loss=0.48, val_accuracy=0.894, lr=0.001] 67%|██████▋   | 84/125 [29:07<13:53, 20.33s/epoch, loss=0.34, accuracy=0.941, val_loss=0.475, val_accuracy=0.896, lr=0.001] 68%|██████▊   | 85/125 [29:28<13:32, 20.31s/epoch, loss=0.334, accuracy=0.943, val_loss=0.488, val_accuracy=0.893, lr=0.001] 69%|██████▉   | 86/125 [29:48<13:11, 20.29s/epoch, loss=0.324, accuracy=0.943, val_loss=0.468, val_accuracy=0.896, lr=0.001] 70%|██████▉   | 87/125 [30:08<12:50, 20.28s/epoch, loss=0.316, accuracy=0.945, val_loss=0.472, val_accuracy=0.894, lr=0.001] 70%|███████   | 88/125 [30:28<12:29, 20.25s/epoch, loss=0.307, accuracy=0.948, val_loss=0.48, val_accuracy=0.891, lr=0.001]  71%|███████   | 89/125 [30:49<12:09, 20.26s/epoch, loss=0.3, accuracy=0.948, val_loss=0.467, val_accuracy=0.896, lr=0.001]  72%|███████▏  | 90/125 [31:09<11:48, 20.25s/epoch, loss=0.292, accuracy=0.951, val_loss=0.468, val_accuracy=0.895, lr=0.001] 73%|███████▎  | 91/125 [31:29<11:28, 20.25s/epoch, loss=0.289, accuracy=0.951, val_loss=0.462, val_accuracy=0.896, lr=0.001] 74%|███████▎  | 92/125 [31:49<11:08, 20.27s/epoch, loss=0.285, accuracy=0.95, val_loss=0.502, val_accuracy=0.882, lr=0.001]  74%|███████▍  | 93/125 [32:10<10:48, 20.27s/epoch, loss=0.276, accuracy=0.952, val_loss=0.47, val_accuracy=0.891, lr=0.001] 75%|███████▌  | 94/125 [32:30<10:28, 20.28s/epoch, loss=0.274, accuracy=0.952, val_loss=0.446, val_accuracy=0.896, lr=0.001] 76%|███████▌  | 95/125 [32:50<10:07, 20.26s/epoch, loss=0.268, accuracy=0.953, val_loss=0.465, val_accuracy=0.892, lr=0.001] 77%|███████▋  | 96/125 [33:10<09:47, 20.26s/epoch, loss=0.264, accuracy=0.953, val_loss=0.452, val_accuracy=0.897, lr=0.001] 78%|███████▊  | 97/125 [33:31<09:27, 20.25s/epoch, loss=0.26, accuracy=0.954, val_loss=0.462, val_accuracy=0.891, lr=0.001]  78%|███████▊  | 98/125 [33:51<09:06, 20.25s/epoch, loss=0.257, accuracy=0.954, val_loss=0.461, val_accuracy=0.891, lr=0.001] 79%|███████▉  | 99/125 [34:11<08:47, 20.28s/epoch, loss=0.25, accuracy=0.956, val_loss=0.473, val_accuracy=0.892, lr=0.001]  80%|████████  | 100/125 [34:32<08:28, 20.33s/epoch, loss=0.25, accuracy=0.956, val_loss=0.462, val_accuracy=0.892, lr=0.001] 81%|████████  | 101/125 [34:52<08:08, 20.34s/epoch, loss=0.248, accuracy=0.955, val_loss=0.476, val_accuracy=0.89, lr=0.001] 82%|████████▏ | 102/125 [35:13<07:48, 20.36s/epoch, loss=0.228, accuracy=0.963, val_loss=0.417, val_accuracy=0.904, lr=1e-04] 82%|████████▏ | 103/125 [35:33<07:28, 20.37s/epoch, loss=0.218, accuracy=0.967, val_loss=0.418, val_accuracy=0.902, lr=1e-04] 83%|████████▎ | 104/125 [35:53<07:07, 20.38s/epoch, loss=0.213, accuracy=0.969, val_loss=0.414, val_accuracy=0.905, lr=1e-04] 84%|████████▍ | 105/125 [36:14<06:47, 20.37s/epoch, loss=0.209, accuracy=0.97, val_loss=0.415, val_accuracy=0.905, lr=1e-04]  85%|████████▍ | 106/125 [36:34<06:26, 20.33s/epoch, loss=0.208, accuracy=0.97, val_loss=0.415, val_accuracy=0.905, lr=1e-04] 86%|████████▌ | 107/125 [36:54<06:06, 20.34s/epoch, loss=0.207, accuracy=0.97, val_loss=0.416, val_accuracy=0.906, lr=1e-04] 86%|████████▋ | 108/125 [37:15<05:45, 20.33s/epoch, loss=0.204, accuracy=0.972, val_loss=0.416, val_accuracy=0.905, lr=1e-04] 87%|████████▋ | 109/125 [37:35<05:24, 20.31s/epoch, loss=0.202, accuracy=0.973, val_loss=0.417, val_accuracy=0.906, lr=1e-04] 88%|████████▊ | 110/125 [37:55<05:04, 20.29s/epoch, loss=0.2, accuracy=0.973, val_loss=0.417, val_accuracy=0.905, lr=1e-04]   89%|████████▉ | 111/125 [38:15<04:43, 20.28s/epoch, loss=0.201, accuracy=0.972, val_loss=0.416, val_accuracy=0.905, lr=1e-04] 90%|████████▉ | 112/125 [38:36<04:23, 20.28s/epoch, loss=0.197, accuracy=0.974, val_loss=0.417, val_accuracy=0.905, lr=1e-04] 90%|█████████ | 113/125 [38:56<04:03, 20.30s/epoch, loss=0.197, accuracy=0.974, val_loss=0.418, val_accuracy=0.904, lr=1e-04] 91%|█████████ | 114/125 [39:16<03:43, 20.28s/epoch, loss=0.195, accuracy=0.975, val_loss=0.419, val_accuracy=0.906, lr=5e-5]  92%|█████████▏| 115/125 [39:36<03:22, 20.26s/epoch, loss=0.195, accuracy=0.974, val_loss=0.417, val_accuracy=0.905, lr=5e-5] 93%|█████████▎| 116/125 [39:57<03:02, 20.29s/epoch, loss=0.193, accuracy=0.975, val_loss=0.418, val_accuracy=0.907, lr=5e-5] 94%|█████████▎| 117/125 [40:17<02:42, 20.30s/epoch, loss=0.193, accuracy=0.975, val_loss=0.417, val_accuracy=0.906, lr=5e-5] 94%|█████████▍| 118/125 [40:37<02:22, 20.32s/epoch, loss=0.192, accuracy=0.975, val_loss=0.418, val_accuracy=0.905, lr=5e-5] 95%|█████████▌| 119/125 [40:58<02:01, 20.28s/epoch, loss=0.191, accuracy=0.975, val_loss=0.418, val_accuracy=0.906, lr=5e-5] 96%|█████████▌| 120/125 [41:18<01:41, 20.27s/epoch, loss=0.192, accuracy=0.975, val_loss=0.418, val_accuracy=0.906, lr=5e-5] 97%|█████████▋| 121/125 [41:38<01:21, 20.26s/epoch, loss=0.19, accuracy=0.976, val_loss=0.419, val_accuracy=0.905, lr=5e-5]  98%|█████████▊| 122/125 [41:58<01:00, 20.27s/epoch, loss=0.192, accuracy=0.974, val_loss=0.417, val_accuracy=0.905, lr=5e-5] 98%|█████████▊| 123/125 [42:19<00:40, 20.29s/epoch, loss=0.19, accuracy=0.976, val_loss=0.417, val_accuracy=0.905, lr=5e-5]  99%|█████████▉| 124/125 [42:39<00:20, 20.31s/epoch, loss=0.188, accuracy=0.977, val_loss=0.418, val_accuracy=0.905, lr=5e-5]100%|██████████| 125/125 [42:59<00:00, 20.31s/epoch, loss=0.189, accuracy=0.975, val_loss=0.418, val_accuracy=0.906, lr=5e-5]100%|██████████| 125/125 [42:59<00:00, 20.64s/epoch, loss=0.189, accuracy=0.975, val_loss=0.418, val_accuracy=0.906, lr=5e-5]
Using real-time data augmentation.
Only one model saved

Loading model: 12_11_cifar10_ResNet20v1.h5
Test score: 0.417743980884552
Test accuracy: 0.9057999849319458


* * * Run SGD for ID = 12_12. * * *


2024-03-13 10:15:15.173769: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 10:15:18.061164: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 10:15:18.062275: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-13 10:15:18.102778: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-13 10:15:18.102813: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 10:15:18.105791: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 10:15:18.105859: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 10:15:18.108264: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 10:15:18.109110: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 10:15:18.111458: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 10:15:18.112966: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 10:15:18.117774: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 10:15:18.119447: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 10:15:18.119529: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 10:15:19.479746: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-13 10:15:19.480696: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 10:15:19.481473: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:83:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-13 10:15:19.481507: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 10:15:19.481544: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 10:15:19.481564: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 10:15:19.481581: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 10:15:19.481598: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 10:15:19.481616: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 10:15:19.481633: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 10:15:19.481650: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 10:15:19.482104: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 10:15:19.482139: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 10:15:20.179987: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-13 10:15:20.180039: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-13 10:15:20.180049: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-13 10:15:20.182184: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:83:00.0, compute capability: 6.1)
{'id': '12_12', 'seed': 12, 'out_folder': 'results/epoch_budget_2', 'batch_size': 128, 'epochs': 125, 'validation_split': 0.0, 'checkpointing': False, 'checkpoint_every': -1, 'hold_out_validation_split': 0.0, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'num_classes': 10, 'SSE_lr': False, 'test_time_augmentation': False, 'debug': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
y_train shape: (50000, 10)
x_val shape: (10000, 32, 32, 3)
y_val shape: (10000, 10)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/125 [00:00<?, ?epoch/s]2024-03-13 10:15:20.855292: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-13 10:15:20.866966: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199945000 Hz
2024-03-13 10:15:23.061066: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 10:15:23.250854: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 10:15:23.999721: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-13 10:15:24.036569: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/125 [00:50<1:43:43, 50.19s/epoch, loss=3.11, accuracy=0.315, val_loss=2.32, val_accuracy=0.29, lr=0.1]  2%|▏         | 2/125 [01:10<1:07:17, 32.83s/epoch, loss=1.61, accuracy=0.513, val_loss=1.77, val_accuracy=0.455, lr=0.1]  2%|▏         | 3/125 [01:31<55:21, 27.22s/epoch, loss=1.43, accuracy=0.606, val_loss=1.89, val_accuracy=0.494, lr=0.1]    3%|▎         | 4/125 [01:51<49:36, 24.60s/epoch, loss=1.32, accuracy=0.666, val_loss=1.77, val_accuracy=0.495, lr=0.1]  4%|▍         | 5/125 [02:12<46:16, 23.14s/epoch, loss=1.28, accuracy=0.689, val_loss=1.89, val_accuracy=0.497, lr=0.1]  5%|▍         | 6/125 [02:33<44:09, 22.26s/epoch, loss=1.25, accuracy=0.707, val_loss=2.03, val_accuracy=0.503, lr=0.1]  6%|▌         | 7/125 [02:53<42:43, 21.73s/epoch, loss=1.24, accuracy=0.716, val_loss=1.64, val_accuracy=0.572, lr=0.1]  6%|▋         | 8/125 [03:14<41:36, 21.34s/epoch, loss=1.22, accuracy=0.722, val_loss=1.54, val_accuracy=0.605, lr=0.1]  7%|▋         | 9/125 [03:34<40:45, 21.08s/epoch, loss=1.21, accuracy=0.727, val_loss=2.82, val_accuracy=0.278, lr=0.1]  8%|▊         | 10/125 [03:55<40:03, 20.90s/epoch, loss=1.21, accuracy=0.73, val_loss=2, val_accuracy=0.543, lr=0.1]     9%|▉         | 11/125 [04:15<39:28, 20.78s/epoch, loss=1.2, accuracy=0.734, val_loss=1.77, val_accuracy=0.564, lr=0.1] 10%|▉         | 12/125 [04:36<39:00, 20.71s/epoch, loss=1.2, accuracy=0.734, val_loss=2.15, val_accuracy=0.509, lr=0.1] 10%|█         | 13/125 [04:56<38:30, 20.63s/epoch, loss=1.19, accuracy=0.739, val_loss=2.19, val_accuracy=0.459, lr=0.1] 11%|█         | 14/125 [05:17<38:06, 20.60s/epoch, loss=1.18, accuracy=0.741, val_loss=1.77, val_accuracy=0.555, lr=0.1] 12%|█▏        | 15/125 [05:37<37:43, 20.57s/epoch, loss=1.19, accuracy=0.742, val_loss=2.05, val_accuracy=0.495, lr=0.1] 13%|█▎        | 16/125 [05:58<37:21, 20.56s/epoch, loss=1.18, accuracy=0.743, val_loss=2.14, val_accuracy=0.44, lr=0.1]  14%|█▎        | 17/125 [06:18<37:01, 20.57s/epoch, loss=1.17, accuracy=0.743, val_loss=1.98, val_accuracy=0.485, lr=0.1] 14%|█▍        | 18/125 [06:39<36:40, 20.57s/epoch, loss=1.18, accuracy=0.744, val_loss=1.69, val_accuracy=0.583, lr=0.1] 15%|█▌        | 19/125 [07:00<36:20, 20.57s/epoch, loss=1.17, accuracy=0.748, val_loss=5.06, val_accuracy=0.361, lr=0.1] 16%|█▌        | 20/125 [07:20<36:05, 20.62s/epoch, loss=1.17, accuracy=0.747, val_loss=1.84, val_accuracy=0.546, lr=0.1] 17%|█▋        | 21/125 [07:41<35:44, 20.62s/epoch, loss=1.17, accuracy=0.747, val_loss=2.2, val_accuracy=0.465, lr=0.1]  18%|█▊        | 22/125 [08:02<35:25, 20.63s/epoch, loss=1.17, accuracy=0.748, val_loss=2.61, val_accuracy=0.416, lr=0.1] 18%|█▊        | 23/125 [08:22<35:03, 20.62s/epoch, loss=1.17, accuracy=0.748, val_loss=1.96, val_accuracy=0.52, lr=0.1]  19%|█▉        | 24/125 [08:43<34:41, 20.61s/epoch, loss=1.16, accuracy=0.749, val_loss=1.99, val_accuracy=0.502, lr=0.1] 20%|██        | 25/125 [09:03<34:15, 20.56s/epoch, loss=1.15, accuracy=0.75, val_loss=1.73, val_accuracy=0.57, lr=0.1]   21%|██        | 26/125 [09:24<33:55, 20.56s/epoch, loss=1.15, accuracy=0.752, val_loss=2.54, val_accuracy=0.394, lr=0.1] 22%|██▏       | 27/125 [09:44<33:33, 20.55s/epoch, loss=1.16, accuracy=0.751, val_loss=1.65, val_accuracy=0.593, lr=0.1] 22%|██▏       | 28/125 [10:05<33:13, 20.55s/epoch, loss=1.15, accuracy=0.75, val_loss=3.81, val_accuracy=0.248, lr=0.1]  23%|██▎       | 29/125 [10:25<32:48, 20.51s/epoch, loss=1.16, accuracy=0.748, val_loss=3.72, val_accuracy=0.29, lr=0.1] 24%|██▍       | 30/125 [10:46<32:25, 20.48s/epoch, loss=1.15, accuracy=0.753, val_loss=1.83, val_accuracy=0.543, lr=0.1] 25%|██▍       | 31/125 [11:06<32:05, 20.49s/epoch, loss=1.15, accuracy=0.753, val_loss=2.26, val_accuracy=0.51, lr=0.1]  26%|██▌       | 32/125 [11:27<31:45, 20.49s/epoch, loss=1.14, accuracy=0.751, val_loss=1.99, val_accuracy=0.461, lr=0.1] 26%|██▋       | 33/125 [11:47<31:25, 20.49s/epoch, loss=1.15, accuracy=0.751, val_loss=4.28, val_accuracy=0.309, lr=0.1] 27%|██▋       | 34/125 [12:08<31:04, 20.49s/epoch, loss=1.14, accuracy=0.754, val_loss=1.44, val_accuracy=0.655, lr=0.1] 28%|██▊       | 35/125 [12:28<30:46, 20.52s/epoch, loss=1.14, accuracy=0.754, val_loss=2.21, val_accuracy=0.418, lr=0.1] 29%|██▉       | 36/125 [12:49<30:23, 20.49s/epoch, loss=1.14, accuracy=0.752, val_loss=1.98, val_accuracy=0.511, lr=0.1] 30%|██▉       | 37/125 [13:09<30:02, 20.48s/epoch, loss=1.14, accuracy=0.751, val_loss=2.11, val_accuracy=0.513, lr=0.1] 30%|███       | 38/125 [13:30<29:41, 20.48s/epoch, loss=1.15, accuracy=0.751, val_loss=1.81, val_accuracy=0.524, lr=0.1] 31%|███       | 39/125 [13:50<29:22, 20.50s/epoch, loss=1.15, accuracy=0.752, val_loss=1.59, val_accuracy=0.608, lr=0.1] 32%|███▏      | 40/125 [14:11<29:06, 20.55s/epoch, loss=1.14, accuracy=0.755, val_loss=3, val_accuracy=0.323, lr=0.1]    33%|███▎      | 41/125 [14:31<28:47, 20.57s/epoch, loss=1.14, accuracy=0.754, val_loss=2.09, val_accuracy=0.463, lr=0.1] 34%|███▎      | 42/125 [14:52<28:30, 20.60s/epoch, loss=1.13, accuracy=0.754, val_loss=1.55, val_accuracy=0.617, lr=0.1] 34%|███▍      | 43/125 [15:13<28:09, 20.60s/epoch, loss=1.13, accuracy=0.756, val_loss=1.51, val_accuracy=0.633, lr=0.1] 35%|███▌      | 44/125 [15:33<27:44, 20.55s/epoch, loss=1.14, accuracy=0.755, val_loss=2.45, val_accuracy=0.456, lr=0.1] 36%|███▌      | 45/125 [15:54<27:23, 20.54s/epoch, loss=1.13, accuracy=0.757, val_loss=2.17, val_accuracy=0.52, lr=0.1]  37%|███▋      | 46/125 [16:14<27:00, 20.51s/epoch, loss=1.14, accuracy=0.756, val_loss=2.03, val_accuracy=0.462, lr=0.1] 38%|███▊      | 47/125 [16:35<26:41, 20.53s/epoch, loss=1.14, accuracy=0.755, val_loss=2.06, val_accuracy=0.416, lr=0.1] 38%|███▊      | 48/125 [16:55<26:18, 20.50s/epoch, loss=1.14, accuracy=0.755, val_loss=2.42, val_accuracy=0.371, lr=0.1] 39%|███▉      | 49/125 [17:15<25:54, 20.45s/epoch, loss=1.13, accuracy=0.757, val_loss=2.77, val_accuracy=0.439, lr=0.1] 40%|████      | 50/125 [17:36<25:33, 20.45s/epoch, loss=1.13, accuracy=0.756, val_loss=1.54, val_accuracy=0.611, lr=0.1] 41%|████      | 51/125 [17:56<25:12, 20.44s/epoch, loss=1.13, accuracy=0.754, val_loss=3.42, val_accuracy=0.309, lr=0.1] 42%|████▏     | 52/125 [18:17<24:52, 20.44s/epoch, loss=0.921, accuracy=0.816, val_loss=0.889, val_accuracy=0.811, lr=0.01] 42%|████▏     | 53/125 [18:37<24:34, 20.48s/epoch, loss=0.737, accuracy=0.847, val_loss=0.931, val_accuracy=0.78, lr=0.01]  43%|████▎     | 54/125 [18:58<24:16, 20.51s/epoch, loss=0.651, accuracy=0.858, val_loss=0.768, val_accuracy=0.816, lr=0.01] 44%|████▍     | 55/125 [19:18<23:56, 20.52s/epoch, loss=0.61, accuracy=0.862, val_loss=1.12, val_accuracy=0.714, lr=0.01]   45%|████▍     | 56/125 [19:39<23:36, 20.52s/epoch, loss=0.586, accuracy=0.864, val_loss=0.729, val_accuracy=0.817, lr=0.01] 46%|████▌     | 57/125 [19:59<23:14, 20.51s/epoch, loss=0.577, accuracy=0.865, val_loss=0.823, val_accuracy=0.793, lr=0.01] 46%|████▋     | 58/125 [20:20<22:54, 20.52s/epoch, loss=0.568, accuracy=0.866, val_loss=0.765, val_accuracy=0.803, lr=0.01] 47%|████▋     | 59/125 [20:40<22:33, 20.50s/epoch, loss=0.567, accuracy=0.867, val_loss=0.76, val_accuracy=0.805, lr=0.01]  48%|████▊     | 60/125 [21:01<22:11, 20.48s/epoch, loss=0.562, accuracy=0.871, val_loss=0.845, val_accuracy=0.783, lr=0.01] 49%|████▉     | 61/125 [21:21<21:48, 20.45s/epoch, loss=0.56, accuracy=0.871, val_loss=1.03, val_accuracy=0.724, lr=0.01]   50%|████▉     | 62/125 [21:42<21:26, 20.42s/epoch, loss=0.561, accuracy=0.871, val_loss=0.798, val_accuracy=0.802, lr=0.01] 50%|█████     | 63/125 [22:02<21:04, 20.40s/epoch, loss=0.559, accuracy=0.872, val_loss=0.778, val_accuracy=0.801, lr=0.01] 51%|█████     | 64/125 [22:22<20:43, 20.39s/epoch, loss=0.559, accuracy=0.875, val_loss=0.757, val_accuracy=0.814, lr=0.01] 52%|█████▏    | 65/125 [22:43<20:22, 20.37s/epoch, loss=0.557, accuracy=0.874, val_loss=0.807, val_accuracy=0.795, lr=0.01] 53%|█████▎    | 66/125 [23:03<20:02, 20.37s/epoch, loss=0.557, accuracy=0.875, val_loss=0.831, val_accuracy=0.788, lr=0.01] 54%|█████▎    | 67/125 [23:23<19:42, 20.39s/epoch, loss=0.555, accuracy=0.877, val_loss=0.794, val_accuracy=0.803, lr=0.01] 54%|█████▍    | 68/125 [23:44<19:22, 20.40s/epoch, loss=0.56, accuracy=0.876, val_loss=0.696, val_accuracy=0.831, lr=0.01]  55%|█████▌    | 69/125 [24:04<19:00, 20.37s/epoch, loss=0.554, accuracy=0.88, val_loss=0.967, val_accuracy=0.757, lr=0.01] 56%|█████▌    | 70/125 [24:25<18:40, 20.37s/epoch, loss=0.561, accuracy=0.879, val_loss=0.857, val_accuracy=0.788, lr=0.01] 57%|█████▋    | 71/125 [24:45<18:19, 20.37s/epoch, loss=0.556, accuracy=0.88, val_loss=0.859, val_accuracy=0.789, lr=0.01]  58%|█████▊    | 72/125 [25:05<17:59, 20.38s/epoch, loss=0.553, accuracy=0.881, val_loss=1.16, val_accuracy=0.729, lr=0.01] 58%|█████▊    | 73/125 [25:26<17:39, 20.37s/epoch, loss=0.554, accuracy=0.88, val_loss=0.835, val_accuracy=0.794, lr=0.01] 59%|█████▉    | 74/125 [25:46<17:19, 20.39s/epoch, loss=0.552, accuracy=0.881, val_loss=0.982, val_accuracy=0.764, lr=0.01] 60%|██████    | 75/125 [26:13<18:38, 22.38s/epoch, loss=0.554, accuracy=0.883, val_loss=0.899, val_accuracy=0.769, lr=0.01] 61%|██████    | 76/125 [26:34<17:47, 21.79s/epoch, loss=0.556, accuracy=0.881, val_loss=0.812, val_accuracy=0.81, lr=0.01]  62%|██████▏   | 77/125 [26:54<17:06, 21.39s/epoch, loss=0.473, accuracy=0.91, val_loss=0.529, val_accuracy=0.889, lr=0.001] 62%|██████▏   | 78/125 [27:15<16:32, 21.13s/epoch, loss=0.425, accuracy=0.926, val_loss=0.514, val_accuracy=0.893, lr=0.001] 63%|██████▎   | 79/125 [27:35<16:02, 20.92s/epoch, loss=0.404, accuracy=0.931, val_loss=0.51, val_accuracy=0.894, lr=0.001]  64%|██████▍   | 80/125 [27:55<15:34, 20.76s/epoch, loss=0.389, accuracy=0.936, val_loss=0.501, val_accuracy=0.899, lr=0.001] 65%|██████▍   | 81/125 [28:16<15:08, 20.64s/epoch, loss=0.37, accuracy=0.94, val_loss=0.496, val_accuracy=0.894, lr=0.001]   66%|██████▌   | 82/125 [28:36<14:44, 20.57s/epoch, loss=0.362, accuracy=0.94, val_loss=0.49, val_accuracy=0.899, lr=0.001] 66%|██████▋   | 83/125 [28:56<14:20, 20.50s/epoch, loss=0.348, accuracy=0.943, val_loss=0.48, val_accuracy=0.899, lr=0.001] 67%|██████▋   | 84/125 [29:17<13:58, 20.44s/epoch, loss=0.341, accuracy=0.946, val_loss=0.481, val_accuracy=0.897, lr=0.001] 68%|██████▊   | 85/125 [29:37<13:37, 20.43s/epoch, loss=0.332, accuracy=0.946, val_loss=0.471, val_accuracy=0.9, lr=0.001]   69%|██████▉   | 86/125 [29:57<13:14, 20.37s/epoch, loss=0.321, accuracy=0.948, val_loss=0.481, val_accuracy=0.896, lr=0.001] 70%|██████▉   | 87/125 [30:18<12:52, 20.34s/epoch, loss=0.314, accuracy=0.95, val_loss=0.492, val_accuracy=0.891, lr=0.001]  70%|███████   | 88/125 [30:38<12:31, 20.32s/epoch, loss=0.307, accuracy=0.949, val_loss=0.471, val_accuracy=0.895, lr=0.001] 71%|███████   | 89/125 [30:58<12:11, 20.32s/epoch, loss=0.3, accuracy=0.952, val_loss=0.48, val_accuracy=0.896, lr=0.001]    72%|███████▏  | 90/125 [31:19<11:50, 20.31s/epoch, loss=0.291, accuracy=0.952, val_loss=0.459, val_accuracy=0.896, lr=0.001] 73%|███████▎  | 91/125 [31:39<11:31, 20.34s/epoch, loss=0.282, accuracy=0.955, val_loss=0.473, val_accuracy=0.894, lr=0.001] 74%|███████▎  | 92/125 [31:59<11:10, 20.32s/epoch, loss=0.28, accuracy=0.955, val_loss=0.483, val_accuracy=0.892, lr=0.001]  74%|███████▍  | 93/125 [32:19<10:49, 20.30s/epoch, loss=0.275, accuracy=0.955, val_loss=0.468, val_accuracy=0.896, lr=0.001] 75%|███████▌  | 94/125 [32:40<10:28, 20.28s/epoch, loss=0.269, accuracy=0.957, val_loss=0.479, val_accuracy=0.892, lr=0.001] 76%|███████▌  | 95/125 [33:00<10:08, 20.27s/epoch, loss=0.265, accuracy=0.956, val_loss=0.46, val_accuracy=0.896, lr=0.001]  77%|███████▋  | 96/125 [33:20<09:47, 20.26s/epoch, loss=0.259, accuracy=0.958, val_loss=0.481, val_accuracy=0.891, lr=0.001] 78%|███████▊  | 97/125 [33:40<09:27, 20.26s/epoch, loss=0.254, accuracy=0.959, val_loss=0.459, val_accuracy=0.894, lr=0.001] 78%|███████▊  | 98/125 [34:01<09:06, 20.26s/epoch, loss=0.252, accuracy=0.958, val_loss=0.478, val_accuracy=0.89, lr=0.001]  79%|███████▉  | 99/125 [34:21<08:47, 20.30s/epoch, loss=0.246, accuracy=0.959, val_loss=0.464, val_accuracy=0.896, lr=0.001] 80%|████████  | 100/125 [34:41<08:27, 20.30s/epoch, loss=0.244, accuracy=0.959, val_loss=0.463, val_accuracy=0.893, lr=0.001] 81%|████████  | 101/125 [35:02<08:07, 20.33s/epoch, loss=0.241, accuracy=0.959, val_loss=0.484, val_accuracy=0.89, lr=0.001]  82%|████████▏ | 102/125 [35:22<07:47, 20.33s/epoch, loss=0.224, accuracy=0.967, val_loss=0.427, val_accuracy=0.903, lr=1e-04] 82%|████████▏ | 103/125 [35:42<07:26, 20.31s/epoch, loss=0.212, accuracy=0.971, val_loss=0.426, val_accuracy=0.904, lr=1e-04] 83%|████████▎ | 104/125 [36:03<07:07, 20.33s/epoch, loss=0.211, accuracy=0.971, val_loss=0.422, val_accuracy=0.905, lr=1e-04] 84%|████████▍ | 105/125 [36:23<06:46, 20.32s/epoch, loss=0.207, accuracy=0.973, val_loss=0.424, val_accuracy=0.906, lr=1e-04] 85%|████████▍ | 106/125 [36:43<06:25, 20.31s/epoch, loss=0.204, accuracy=0.974, val_loss=0.424, val_accuracy=0.906, lr=1e-04] 86%|████████▌ | 107/125 [37:04<06:05, 20.30s/epoch, loss=0.205, accuracy=0.973, val_loss=0.421, val_accuracy=0.905, lr=1e-04] 86%|████████▋ | 108/125 [37:24<05:44, 20.29s/epoch, loss=0.202, accuracy=0.974, val_loss=0.423, val_accuracy=0.906, lr=1e-04] 87%|████████▋ | 109/125 [37:44<05:25, 20.33s/epoch, loss=0.2, accuracy=0.975, val_loss=0.423, val_accuracy=0.906, lr=1e-04]   88%|████████▊ | 110/125 [38:05<05:04, 20.30s/epoch, loss=0.198, accuracy=0.976, val_loss=0.428, val_accuracy=0.906, lr=1e-04] 89%|████████▉ | 111/125 [38:25<04:44, 20.29s/epoch, loss=0.199, accuracy=0.974, val_loss=0.422, val_accuracy=0.906, lr=1e-04] 90%|████████▉ | 112/125 [38:45<04:23, 20.26s/epoch, loss=0.196, accuracy=0.976, val_loss=0.423, val_accuracy=0.905, lr=1e-04] 90%|█████████ | 113/125 [39:05<04:03, 20.27s/epoch, loss=0.195, accuracy=0.976, val_loss=0.421, val_accuracy=0.908, lr=1e-04] 91%|█████████ | 114/125 [39:26<03:42, 20.25s/epoch, loss=0.192, accuracy=0.978, val_loss=0.424, val_accuracy=0.906, lr=5e-5]  92%|█████████▏| 115/125 [39:46<03:22, 20.22s/epoch, loss=0.191, accuracy=0.978, val_loss=0.426, val_accuracy=0.905, lr=5e-5] 93%|█████████▎| 116/125 [40:06<03:02, 20.23s/epoch, loss=0.193, accuracy=0.976, val_loss=0.423, val_accuracy=0.908, lr=5e-5] 94%|█████████▎| 117/125 [40:26<02:41, 20.21s/epoch, loss=0.192, accuracy=0.977, val_loss=0.423, val_accuracy=0.908, lr=5e-5] 94%|█████████▍| 118/125 [40:46<02:21, 20.24s/epoch, loss=0.191, accuracy=0.978, val_loss=0.422, val_accuracy=0.907, lr=5e-5] 95%|█████████▌| 119/125 [41:06<02:01, 20.20s/epoch, loss=0.191, accuracy=0.978, val_loss=0.422, val_accuracy=0.906, lr=5e-5] 96%|█████████▌| 120/125 [41:27<01:41, 20.21s/epoch, loss=0.19, accuracy=0.978, val_loss=0.423, val_accuracy=0.906, lr=5e-5]  97%|█████████▋| 121/125 [41:47<01:20, 20.23s/epoch, loss=0.19, accuracy=0.978, val_loss=0.423, val_accuracy=0.907, lr=5e-5] 98%|█████████▊| 122/125 [42:07<01:00, 20.26s/epoch, loss=0.188, accuracy=0.979, val_loss=0.423, val_accuracy=0.907, lr=5e-5] 98%|█████████▊| 123/125 [42:28<00:40, 20.29s/epoch, loss=0.188, accuracy=0.978, val_loss=0.424, val_accuracy=0.907, lr=5e-5] 99%|█████████▉| 124/125 [42:48<00:20, 20.31s/epoch, loss=0.187, accuracy=0.978, val_loss=0.422, val_accuracy=0.907, lr=5e-5]100%|██████████| 125/125 [43:08<00:00, 20.30s/epoch, loss=0.187, accuracy=0.978, val_loss=0.423, val_accuracy=0.907, lr=5e-5]100%|██████████| 125/125 [43:08<00:00, 20.71s/epoch, loss=0.187, accuracy=0.978, val_loss=0.423, val_accuracy=0.907, lr=5e-5]
Using real-time data augmentation.
Only one model saved

Loading model: 12_12_cifar10_ResNet20v1.h5
Test score: 0.422730952501297
Test accuracy: 0.9067999720573425

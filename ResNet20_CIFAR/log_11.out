Tue Mar 12 22:12:31 2024       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 545.23.08              Driver Version: 545.23.08    CUDA Version: 12.3     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA TITAN X (Pascal)        Off | 00000000:03:00.0 Off |                  N/A |
| 23%   31C    P8               9W / 250W |      0MiB / 12288MiB |      0%      Default |
|                                         |                      |                  N/A |
+-----------------------------------------+----------------------+----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
|  No running processes found                                                           |
+---------------------------------------------------------------------------------------+


* * * Run SGD for cluster size = 11. * * *


Budget: 136


* * * Run SGD for ID = 11_1. * * *


2024-03-12 22:12:32.038983: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-12 22:12:34.925499: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-12 22:12:34.926410: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-12 22:12:34.957733: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-03-12 22:12:34.957759: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-12 22:12:34.960586: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-12 22:12:34.960621: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-12 22:12:34.962984: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-12 22:12:34.963675: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-12 22:12:34.966068: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-12 22:12:34.967456: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-12 22:12:34.971841: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-12 22:12:34.972294: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-12 22:12:34.972364: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-12 22:12:36.142768: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-12 22:12:36.143356: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-12 22:12:36.143805: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-03-12 22:12:36.143838: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-12 22:12:36.143869: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-12 22:12:36.143884: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-12 22:12:36.143898: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-12 22:12:36.143912: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-12 22:12:36.143926: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-12 22:12:36.143940: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-12 22:12:36.143954: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-12 22:12:36.144439: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-12 22:12:36.144471: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-12 22:12:36.761553: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-12 22:12:36.761628: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-12 22:12:36.761640: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-12 22:12:36.762860: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11227 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN X (Pascal), pci bus id: 0000:03:00.0, compute capability: 6.1)
{'id': '11_01', 'seed': 1, 'out_folder': 'results/epoch_budget_2', 'batch_size': 128, 'epochs': 136, 'validation_split': 0.0, 'checkpointing': False, 'checkpoint_every': -1, 'hold_out_validation_split': 0.0, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'num_classes': 10, 'SSE_lr': False, 'test_time_augmentation': False, 'debug': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN X (Pascal)'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
y_train shape: (50000, 10)
x_val shape: (10000, 32, 32, 3)
y_val shape: (10000, 10)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/136 [00:00<?, ?epoch/s]2024-03-12 22:12:37.357921: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-12 22:12:37.370090: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2600020000 Hz
2024-03-12 22:12:39.387461: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-12 22:12:39.600020: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-12 22:12:40.291797: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-12 22:12:40.346524: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/136 [01:00<2:15:23, 60.17s/epoch, loss=3.12, accuracy=0.333, val_loss=2.71, val_accuracy=0.193, lr=0.1]  1%|▏         | 2/136 [01:22<1:24:00, 37.62s/epoch, loss=1.55, accuracy=0.553, val_loss=2.18, val_accuracy=0.444, lr=0.1]  2%|▏         | 3/136 [01:43<1:07:08, 30.29s/epoch, loss=1.37, accuracy=0.636, val_loss=1.63, val_accuracy=0.569, lr=0.1]  3%|▎         | 4/136 [02:05<59:02, 26.84s/epoch, loss=1.3, accuracy=0.675, val_loss=1.69, val_accuracy=0.546, lr=0.1]     4%|▎         | 5/136 [02:26<54:24, 24.92s/epoch, loss=1.28, accuracy=0.692, val_loss=2.7, val_accuracy=0.386, lr=0.1]  4%|▍         | 6/136 [02:48<51:26, 23.74s/epoch, loss=1.25, accuracy=0.704, val_loss=2.61, val_accuracy=0.448, lr=0.1]  5%|▌         | 7/136 [03:09<49:16, 22.92s/epoch, loss=1.23, accuracy=0.719, val_loss=1.7, val_accuracy=0.565, lr=0.1]   6%|▌         | 8/136 [03:30<47:42, 22.36s/epoch, loss=1.23, accuracy=0.719, val_loss=2.33, val_accuracy=0.45, lr=0.1]  7%|▋         | 9/136 [03:51<46:25, 21.93s/epoch, loss=1.22, accuracy=0.724, val_loss=1.77, val_accuracy=0.532, lr=0.1]  7%|▋         | 10/136 [04:12<45:44, 21.78s/epoch, loss=1.21, accuracy=0.726, val_loss=1.67, val_accuracy=0.58, lr=0.1]  8%|▊         | 11/136 [04:34<45:09, 21.68s/epoch, loss=1.2, accuracy=0.731, val_loss=2.07, val_accuracy=0.521, lr=0.1]  9%|▉         | 12/136 [04:55<44:29, 21.53s/epoch, loss=1.21, accuracy=0.732, val_loss=1.72, val_accuracy=0.553, lr=0.1] 10%|▉         | 13/136 [05:17<44:05, 21.51s/epoch, loss=1.2, accuracy=0.734, val_loss=2.17, val_accuracy=0.49, lr=0.1]   10%|█         | 14/136 [05:38<43:40, 21.48s/epoch, loss=1.19, accuracy=0.736, val_loss=1.8, val_accuracy=0.56, lr=0.1] 11%|█         | 15/136 [05:59<43:14, 21.44s/epoch, loss=1.19, accuracy=0.738, val_loss=1.7, val_accuracy=0.585, lr=0.1] 12%|█▏        | 16/136 [06:21<42:50, 21.42s/epoch, loss=1.18, accuracy=0.739, val_loss=1.84, val_accuracy=0.535, lr=0.1] 12%|█▎        | 17/136 [06:42<42:32, 21.45s/epoch, loss=1.19, accuracy=0.74, val_loss=2.53, val_accuracy=0.404, lr=0.1]  13%|█▎        | 18/136 [07:03<42:04, 21.39s/epoch, loss=1.18, accuracy=0.74, val_loss=1.63, val_accuracy=0.592, lr=0.1] 14%|█▍        | 19/136 [07:25<41:32, 21.31s/epoch, loss=1.18, accuracy=0.744, val_loss=1.66, val_accuracy=0.597, lr=0.1] 15%|█▍        | 20/136 [07:46<41:09, 21.29s/epoch, loss=1.17, accuracy=0.741, val_loss=1.56, val_accuracy=0.593, lr=0.1] 15%|█▌        | 21/136 [08:07<40:45, 21.27s/epoch, loss=1.17, accuracy=0.744, val_loss=2, val_accuracy=0.559, lr=0.1]    16%|█▌        | 22/136 [08:28<40:27, 21.29s/epoch, loss=1.18, accuracy=0.745, val_loss=2.08, val_accuracy=0.458, lr=0.1] 17%|█▋        | 23/136 [08:50<40:06, 21.30s/epoch, loss=1.17, accuracy=0.745, val_loss=1.47, val_accuracy=0.639, lr=0.1] 18%|█▊        | 24/136 [09:11<39:50, 21.35s/epoch, loss=1.17, accuracy=0.743, val_loss=1.45, val_accuracy=0.631, lr=0.1] 18%|█▊        | 25/136 [09:32<39:30, 21.35s/epoch, loss=1.17, accuracy=0.746, val_loss=1.78, val_accuracy=0.577, lr=0.1] 19%|█▉        | 26/136 [09:54<39:01, 21.29s/epoch, loss=1.17, accuracy=0.747, val_loss=2.33, val_accuracy=0.449, lr=0.1] 20%|█▉        | 27/136 [10:14<38:23, 21.13s/epoch, loss=1.16, accuracy=0.747, val_loss=1.47, val_accuracy=0.627, lr=0.1] 21%|██        | 28/136 [10:35<37:58, 21.10s/epoch, loss=1.16, accuracy=0.749, val_loss=1.8, val_accuracy=0.594, lr=0.1]  21%|██▏       | 29/136 [10:57<37:38, 21.11s/epoch, loss=1.16, accuracy=0.75, val_loss=2.97, val_accuracy=0.445, lr=0.1] 22%|██▏       | 30/136 [11:18<37:22, 21.15s/epoch, loss=1.16, accuracy=0.75, val_loss=2.66, val_accuracy=0.446, lr=0.1] 23%|██▎       | 31/136 [11:39<37:10, 21.24s/epoch, loss=1.15, accuracy=0.75, val_loss=2.21, val_accuracy=0.539, lr=0.1] 24%|██▎       | 32/136 [12:00<36:42, 21.17s/epoch, loss=1.15, accuracy=0.748, val_loss=2.12, val_accuracy=0.482, lr=0.1] 24%|██▍       | 33/136 [12:22<36:24, 21.20s/epoch, loss=1.15, accuracy=0.748, val_loss=1.76, val_accuracy=0.528, lr=0.1] 25%|██▌       | 34/136 [12:43<35:57, 21.15s/epoch, loss=1.15, accuracy=0.749, val_loss=1.66, val_accuracy=0.566, lr=0.1] 26%|██▌       | 35/136 [13:04<35:37, 21.16s/epoch, loss=1.14, accuracy=0.752, val_loss=2.71, val_accuracy=0.411, lr=0.1] 26%|██▋       | 36/136 [13:25<35:19, 21.20s/epoch, loss=1.15, accuracy=0.749, val_loss=1.66, val_accuracy=0.574, lr=0.1] 27%|██▋       | 37/136 [13:46<35:02, 21.24s/epoch, loss=1.15, accuracy=0.75, val_loss=2.24, val_accuracy=0.489, lr=0.1]  28%|██▊       | 38/136 [14:08<34:46, 21.29s/epoch, loss=1.14, accuracy=0.753, val_loss=1.57, val_accuracy=0.621, lr=0.1] 29%|██▊       | 39/136 [14:29<34:13, 21.17s/epoch, loss=1.14, accuracy=0.754, val_loss=1.91, val_accuracy=0.567, lr=0.1] 29%|██▉       | 40/136 [14:50<33:53, 21.19s/epoch, loss=1.14, accuracy=0.753, val_loss=1.79, val_accuracy=0.555, lr=0.1] 30%|███       | 41/136 [15:11<33:17, 21.02s/epoch, loss=1.15, accuracy=0.751, val_loss=1.77, val_accuracy=0.541, lr=0.1] 31%|███       | 42/136 [15:31<32:52, 20.99s/epoch, loss=1.15, accuracy=0.752, val_loss=3.98, val_accuracy=0.354, lr=0.1] 32%|███▏      | 43/136 [15:53<32:38, 21.06s/epoch, loss=1.14, accuracy=0.753, val_loss=1.77, val_accuracy=0.556, lr=0.1] 32%|███▏      | 44/136 [16:14<32:13, 21.02s/epoch, loss=1.14, accuracy=0.754, val_loss=3.26, val_accuracy=0.369, lr=0.1] 33%|███▎      | 45/136 [16:35<32:06, 21.17s/epoch, loss=1.14, accuracy=0.754, val_loss=2.19, val_accuracy=0.47, lr=0.1]  34%|███▍      | 46/136 [16:57<31:52, 21.25s/epoch, loss=1.14, accuracy=0.751, val_loss=4.97, val_accuracy=0.27, lr=0.1] 35%|███▍      | 47/136 [17:17<31:11, 21.02s/epoch, loss=1.14, accuracy=0.754, val_loss=1.46, val_accuracy=0.633, lr=0.1] 35%|███▌      | 48/136 [17:39<31:03, 21.18s/epoch, loss=1.14, accuracy=0.755, val_loss=3.87, val_accuracy=0.318, lr=0.1] 36%|███▌      | 49/136 [18:00<30:41, 21.16s/epoch, loss=1.13, accuracy=0.755, val_loss=3.32, val_accuracy=0.379, lr=0.1] 37%|███▋      | 50/136 [18:20<30:04, 20.98s/epoch, loss=1.14, accuracy=0.752, val_loss=1.8, val_accuracy=0.547, lr=0.1]  38%|███▊      | 51/136 [18:41<29:48, 21.04s/epoch, loss=1.13, accuracy=0.753, val_loss=2.1, val_accuracy=0.48, lr=0.1]  38%|███▊      | 52/136 [19:03<29:31, 21.09s/epoch, loss=1.13, accuracy=0.753, val_loss=1.44, val_accuracy=0.637, lr=0.1] 39%|███▉      | 53/136 [19:24<29:17, 21.18s/epoch, loss=1.13, accuracy=0.759, val_loss=2.81, val_accuracy=0.472, lr=0.1] 40%|███▉      | 54/136 [19:45<28:57, 21.19s/epoch, loss=1.13, accuracy=0.754, val_loss=1.8, val_accuracy=0.573, lr=0.1]  40%|████      | 55/136 [20:07<28:38, 21.22s/epoch, loss=1.13, accuracy=0.755, val_loss=1.64, val_accuracy=0.598, lr=0.1] 41%|████      | 56/136 [20:27<28:10, 21.13s/epoch, loss=0.918, accuracy=0.814, val_loss=0.887, val_accuracy=0.81, lr=0.01] 42%|████▏     | 57/136 [20:49<27:51, 21.16s/epoch, loss=0.738, accuracy=0.846, val_loss=0.754, val_accuracy=0.832, lr=0.01] 43%|████▎     | 58/136 [21:10<27:37, 21.24s/epoch, loss=0.655, accuracy=0.856, val_loss=0.731, val_accuracy=0.821, lr=0.01] 43%|████▎     | 59/136 [21:31<27:14, 21.22s/epoch, loss=0.609, accuracy=0.857, val_loss=0.703, val_accuracy=0.826, lr=0.01] 44%|████▍     | 60/136 [21:53<26:53, 21.23s/epoch, loss=0.586, accuracy=0.862, val_loss=0.886, val_accuracy=0.762, lr=0.01] 45%|████▍     | 61/136 [22:14<26:31, 21.22s/epoch, loss=0.581, accuracy=0.863, val_loss=0.734, val_accuracy=0.809, lr=0.01] 46%|████▌     | 62/136 [22:35<26:06, 21.17s/epoch, loss=0.572, accuracy=0.862, val_loss=0.855, val_accuracy=0.776, lr=0.01] 46%|████▋     | 63/136 [22:56<25:44, 21.15s/epoch, loss=0.565, accuracy=0.864, val_loss=0.85, val_accuracy=0.78, lr=0.01]   47%|████▋     | 64/136 [23:17<25:27, 21.22s/epoch, loss=0.569, accuracy=0.864, val_loss=0.902, val_accuracy=0.763, lr=0.01] 48%|████▊     | 65/136 [23:39<25:08, 21.24s/epoch, loss=0.561, accuracy=0.869, val_loss=0.764, val_accuracy=0.807, lr=0.01] 49%|████▊     | 66/136 [24:00<24:45, 21.22s/epoch, loss=0.56, accuracy=0.869, val_loss=0.738, val_accuracy=0.82, lr=0.01]   49%|████▉     | 67/136 [24:21<24:19, 21.15s/epoch, loss=0.56, accuracy=0.87, val_loss=0.829, val_accuracy=0.781, lr=0.01] 50%|█████     | 68/136 [24:42<23:53, 21.09s/epoch, loss=0.56, accuracy=0.872, val_loss=0.815, val_accuracy=0.794, lr=0.01] 51%|█████     | 69/136 [25:02<23:22, 20.93s/epoch, loss=0.56, accuracy=0.872, val_loss=0.884, val_accuracy=0.78, lr=0.01]  51%|█████▏    | 70/136 [25:24<23:09, 21.05s/epoch, loss=0.558, accuracy=0.873, val_loss=0.859, val_accuracy=0.786, lr=0.01] 52%|█████▏    | 71/136 [25:45<22:50, 21.08s/epoch, loss=0.555, accuracy=0.876, val_loss=0.889, val_accuracy=0.775, lr=0.01] 53%|█████▎    | 72/136 [26:06<22:32, 21.13s/epoch, loss=0.557, accuracy=0.876, val_loss=0.78, val_accuracy=0.803, lr=0.01]  54%|█████▎    | 73/136 [26:27<22:14, 21.18s/epoch, loss=0.555, accuracy=0.876, val_loss=1.03, val_accuracy=0.749, lr=0.01] 54%|█████▍    | 74/136 [26:47<21:33, 20.86s/epoch, loss=0.557, accuracy=0.878, val_loss=0.672, val_accuracy=0.841, lr=0.01] 55%|█████▌    | 75/136 [27:09<21:20, 20.99s/epoch, loss=0.56, accuracy=0.877, val_loss=0.721, val_accuracy=0.824, lr=0.01]  56%|█████▌    | 76/136 [27:30<21:01, 21.03s/epoch, loss=0.56, accuracy=0.877, val_loss=0.78, val_accuracy=0.805, lr=0.01]  57%|█████▋    | 77/136 [27:51<20:44, 21.09s/epoch, loss=0.553, accuracy=0.881, val_loss=0.912, val_accuracy=0.773, lr=0.01] 57%|█████▋    | 78/136 [28:12<20:29, 21.19s/epoch, loss=0.557, accuracy=0.881, val_loss=0.757, val_accuracy=0.818, lr=0.01] 58%|█████▊    | 79/136 [28:33<20:03, 21.12s/epoch, loss=0.554, accuracy=0.882, val_loss=0.736, val_accuracy=0.824, lr=0.01] 59%|█████▉    | 80/136 [28:55<19:43, 21.13s/epoch, loss=0.557, accuracy=0.88, val_loss=0.928, val_accuracy=0.76, lr=0.01]   60%|█████▉    | 81/136 [29:16<19:25, 21.18s/epoch, loss=0.554, accuracy=0.882, val_loss=0.799, val_accuracy=0.803, lr=0.01] 60%|██████    | 82/136 [29:35<18:38, 20.71s/epoch, loss=0.551, accuracy=0.884, val_loss=0.751, val_accuracy=0.817, lr=0.01] 61%|██████    | 83/136 [29:57<18:23, 20.81s/epoch, loss=0.481, accuracy=0.908, val_loss=0.529, val_accuracy=0.892, lr=0.001] 62%|██████▏   | 84/136 [30:18<18:09, 20.95s/epoch, loss=0.425, accuracy=0.926, val_loss=0.513, val_accuracy=0.896, lr=0.001] 62%|██████▎   | 85/136 [30:39<17:54, 21.07s/epoch, loss=0.406, accuracy=0.931, val_loss=0.506, val_accuracy=0.896, lr=0.001] 63%|██████▎   | 86/136 [31:00<17:36, 21.13s/epoch, loss=0.39, accuracy=0.935, val_loss=0.493, val_accuracy=0.898, lr=0.001]  64%|██████▍   | 87/136 [31:22<17:20, 21.23s/epoch, loss=0.378, accuracy=0.937, val_loss=0.489, val_accuracy=0.895, lr=0.001] 65%|██████▍   | 88/136 [31:43<17:00, 21.27s/epoch, loss=0.365, accuracy=0.939, val_loss=0.488, val_accuracy=0.898, lr=0.001] 65%|██████▌   | 89/136 [32:05<16:40, 21.29s/epoch, loss=0.353, accuracy=0.942, val_loss=0.489, val_accuracy=0.896, lr=0.001] 66%|██████▌   | 90/136 [32:26<16:18, 21.26s/epoch, loss=0.344, accuracy=0.943, val_loss=0.476, val_accuracy=0.9, lr=0.001]   67%|██████▋   | 91/136 [32:47<15:54, 21.21s/epoch, loss=0.333, accuracy=0.945, val_loss=0.481, val_accuracy=0.896, lr=0.001] 68%|██████▊   | 92/136 [33:08<15:34, 21.23s/epoch, loss=0.325, accuracy=0.946, val_loss=0.486, val_accuracy=0.895, lr=0.001] 68%|██████▊   | 93/136 [33:29<15:10, 21.18s/epoch, loss=0.318, accuracy=0.948, val_loss=0.471, val_accuracy=0.9, lr=0.001]   69%|██████▉   | 94/136 [33:50<14:50, 21.19s/epoch, loss=0.31, accuracy=0.948, val_loss=0.457, val_accuracy=0.9, lr=0.001]  70%|██████▉   | 95/136 [34:11<14:25, 21.11s/epoch, loss=0.301, accuracy=0.951, val_loss=0.486, val_accuracy=0.896, lr=0.001] 71%|███████   | 96/136 [34:32<14:03, 21.08s/epoch, loss=0.297, accuracy=0.95, val_loss=0.47, val_accuracy=0.898, lr=0.001]   71%|███████▏  | 97/136 [34:54<13:44, 21.13s/epoch, loss=0.293, accuracy=0.95, val_loss=0.476, val_accuracy=0.896, lr=0.001] 72%|███████▏  | 98/136 [35:15<13:21, 21.09s/epoch, loss=0.284, accuracy=0.953, val_loss=0.457, val_accuracy=0.901, lr=0.001] 73%|███████▎  | 99/136 [35:35<12:53, 20.92s/epoch, loss=0.28, accuracy=0.954, val_loss=0.49, val_accuracy=0.889, lr=0.001]   74%|███████▎  | 100/136 [35:56<12:33, 20.92s/epoch, loss=0.273, accuracy=0.955, val_loss=0.457, val_accuracy=0.899, lr=0.001] 74%|███████▍  | 101/136 [36:17<12:16, 21.05s/epoch, loss=0.269, accuracy=0.955, val_loss=0.459, val_accuracy=0.897, lr=0.001] 75%|███████▌  | 102/136 [36:39<11:58, 21.13s/epoch, loss=0.262, accuracy=0.956, val_loss=0.464, val_accuracy=0.894, lr=0.001] 76%|███████▌  | 103/136 [37:00<11:35, 21.09s/epoch, loss=0.259, accuracy=0.956, val_loss=0.471, val_accuracy=0.893, lr=0.001] 76%|███████▋  | 104/136 [37:21<11:14, 21.07s/epoch, loss=0.257, accuracy=0.956, val_loss=0.462, val_accuracy=0.894, lr=0.001] 77%|███████▋  | 105/136 [37:42<10:53, 21.08s/epoch, loss=0.252, accuracy=0.957, val_loss=0.473, val_accuracy=0.892, lr=0.001] 78%|███████▊  | 106/136 [38:03<10:31, 21.06s/epoch, loss=0.249, accuracy=0.958, val_loss=0.463, val_accuracy=0.893, lr=0.001] 79%|███████▊  | 107/136 [38:24<10:11, 21.09s/epoch, loss=0.246, accuracy=0.957, val_loss=0.476, val_accuracy=0.887, lr=0.001] 79%|███████▉  | 108/136 [38:44<09:45, 20.92s/epoch, loss=0.242, accuracy=0.959, val_loss=0.484, val_accuracy=0.883, lr=0.001] 80%|████████  | 109/136 [39:06<09:25, 20.95s/epoch, loss=0.241, accuracy=0.958, val_loss=0.471, val_accuracy=0.885, lr=0.001] 81%|████████  | 110/136 [39:26<09:02, 20.87s/epoch, loss=0.225, accuracy=0.963, val_loss=0.42, val_accuracy=0.905, lr=1e-04]  82%|████████▏ | 111/136 [39:47<08:42, 20.89s/epoch, loss=0.212, accuracy=0.969, val_loss=0.418, val_accuracy=0.906, lr=1e-04] 82%|████████▏ | 112/136 [40:08<08:23, 21.00s/epoch, loss=0.208, accuracy=0.971, val_loss=0.415, val_accuracy=0.907, lr=1e-04] 83%|████████▎ | 113/136 [40:29<08:03, 21.01s/epoch, loss=0.206, accuracy=0.972, val_loss=0.419, val_accuracy=0.906, lr=1e-04] 84%|████████▍ | 114/136 [40:50<07:39, 20.89s/epoch, loss=0.203, accuracy=0.973, val_loss=0.418, val_accuracy=0.906, lr=1e-04] 85%|████████▍ | 115/136 [41:10<07:15, 20.72s/epoch, loss=0.199, accuracy=0.973, val_loss=0.417, val_accuracy=0.908, lr=1e-04] 85%|████████▌ | 116/136 [41:32<06:57, 20.86s/epoch, loss=0.201, accuracy=0.973, val_loss=0.418, val_accuracy=0.906, lr=1e-04] 86%|████████▌ | 117/136 [41:53<06:37, 20.92s/epoch, loss=0.201, accuracy=0.973, val_loss=0.415, val_accuracy=0.907, lr=1e-04] 87%|████████▋ | 118/136 [42:13<06:15, 20.84s/epoch, loss=0.196, accuracy=0.975, val_loss=0.416, val_accuracy=0.906, lr=1e-04] 88%|████████▊ | 119/136 [42:34<05:55, 20.91s/epoch, loss=0.196, accuracy=0.974, val_loss=0.42, val_accuracy=0.906, lr=1e-04]  88%|████████▊ | 120/136 [42:55<05:33, 20.83s/epoch, loss=0.194, accuracy=0.975, val_loss=0.418, val_accuracy=0.907, lr=1e-04] 89%|████████▉ | 121/136 [43:16<05:12, 20.86s/epoch, loss=0.193, accuracy=0.975, val_loss=0.417, val_accuracy=0.908, lr=1e-04] 90%|████████▉ | 122/136 [43:37<04:53, 20.94s/epoch, loss=0.192, accuracy=0.975, val_loss=0.417, val_accuracy=0.907, lr=1e-04] 90%|█████████ | 123/136 [43:58<04:32, 20.99s/epoch, loss=0.191, accuracy=0.975, val_loss=0.416, val_accuracy=0.907, lr=1e-04] 91%|█████████ | 124/136 [44:19<04:12, 21.01s/epoch, loss=0.188, accuracy=0.977, val_loss=0.418, val_accuracy=0.907, lr=5e-5]  92%|█████████▏| 125/136 [44:40<03:52, 21.10s/epoch, loss=0.189, accuracy=0.976, val_loss=0.419, val_accuracy=0.907, lr=5e-5] 93%|█████████▎| 126/136 [45:02<03:31, 21.13s/epoch, loss=0.189, accuracy=0.977, val_loss=0.417, val_accuracy=0.908, lr=5e-5] 93%|█████████▎| 127/136 [45:23<03:10, 21.12s/epoch, loss=0.188, accuracy=0.977, val_loss=0.415, val_accuracy=0.909, lr=5e-5] 94%|█████████▍| 128/136 [45:44<02:49, 21.20s/epoch, loss=0.188, accuracy=0.977, val_loss=0.416, val_accuracy=0.908, lr=5e-5] 95%|█████████▍| 129/136 [46:05<02:28, 21.17s/epoch, loss=0.187, accuracy=0.977, val_loss=0.415, val_accuracy=0.909, lr=5e-5] 96%|█████████▌| 130/136 [46:25<02:04, 20.81s/epoch, loss=0.187, accuracy=0.977, val_loss=0.415, val_accuracy=0.908, lr=5e-5] 96%|█████████▋| 131/136 [46:46<01:44, 20.88s/epoch, loss=0.186, accuracy=0.977, val_loss=0.416, val_accuracy=0.909, lr=5e-5] 97%|█████████▋| 132/136 [47:07<01:23, 20.92s/epoch, loss=0.186, accuracy=0.976, val_loss=0.417, val_accuracy=0.908, lr=5e-5] 98%|█████████▊| 133/136 [47:28<01:02, 20.94s/epoch, loss=0.185, accuracy=0.977, val_loss=0.417, val_accuracy=0.907, lr=5e-5] 99%|█████████▊| 134/136 [47:49<00:42, 21.01s/epoch, loss=0.185, accuracy=0.977, val_loss=0.418, val_accuracy=0.906, lr=5e-5] 99%|█████████▉| 135/136 [48:10<00:20, 21.00s/epoch, loss=0.184, accuracy=0.978, val_loss=0.416, val_accuracy=0.907, lr=5e-5]100%|██████████| 136/136 [48:32<00:00, 21.09s/epoch, loss=0.182, accuracy=0.979, val_loss=0.419, val_accuracy=0.908, lr=5e-5]100%|██████████| 136/136 [48:32<00:00, 21.41s/epoch, loss=0.182, accuracy=0.979, val_loss=0.419, val_accuracy=0.908, lr=5e-5]
Using real-time data augmentation.
Only one model saved

Loading model: 11_01_cifar10_ResNet20v1.h5
Test score: 0.4187411963939667
Test accuracy: 0.9082000255584717


* * * Run SGD for ID = 11_2. * * *


2024-03-12 23:01:13.046657: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-12 23:01:28.734432: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-12 23:01:28.735419: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-12 23:01:28.773731: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-03-12 23:01:28.773765: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-12 23:01:28.776338: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-12 23:01:28.776377: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-12 23:01:28.778581: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-12 23:01:28.779190: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-12 23:01:28.781382: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-12 23:01:28.782671: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-12 23:01:28.786972: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-12 23:01:28.787556: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-12 23:01:28.787625: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-12 23:01:29.974407: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-12 23:01:29.974884: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-12 23:01:29.975392: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-03-12 23:01:29.975419: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-12 23:01:29.975451: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-12 23:01:29.975467: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-12 23:01:29.975481: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-12 23:01:29.975496: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-12 23:01:29.975510: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-12 23:01:29.975524: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-12 23:01:29.975539: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-12 23:01:29.975943: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-12 23:01:29.975999: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-12 23:01:30.571306: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-12 23:01:30.571372: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-12 23:01:30.571382: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-12 23:01:30.572591: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11227 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN X (Pascal), pci bus id: 0000:03:00.0, compute capability: 6.1)
{'id': '11_02', 'seed': 2, 'out_folder': 'results/epoch_budget_2', 'batch_size': 128, 'epochs': 136, 'validation_split': 0.0, 'checkpointing': False, 'checkpoint_every': -1, 'hold_out_validation_split': 0.0, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'num_classes': 10, 'SSE_lr': False, 'test_time_augmentation': False, 'debug': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN X (Pascal)'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
y_train shape: (50000, 10)
x_val shape: (10000, 32, 32, 3)
y_val shape: (10000, 10)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/136 [00:00<?, ?epoch/s]2024-03-12 23:01:31.189563: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-12 23:01:31.202081: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2600020000 Hz
2024-03-12 23:01:33.091336: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-12 23:01:33.331700: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-12 23:01:35.356412: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-12 23:01:35.419267: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/136 [01:01<2:17:31, 61.12s/epoch, loss=2.73, accuracy=0.451, val_loss=2.47, val_accuracy=0.298, lr=0.1]  1%|▏         | 2/136 [01:22<1:24:55, 38.03s/epoch, loss=1.41, accuracy=0.622, val_loss=1.5, val_accuracy=0.596, lr=0.1]   2%|▏         | 3/136 [01:44<1:07:39, 30.52s/epoch, loss=1.3, accuracy=0.673, val_loss=1.79, val_accuracy=0.49, lr=0.1]   3%|▎         | 4/136 [02:06<59:32, 27.06s/epoch, loss=1.25, accuracy=0.7, val_loss=2.37, val_accuracy=0.501, lr=0.1]    4%|▎         | 5/136 [02:27<54:49, 25.11s/epoch, loss=1.23, accuracy=0.708, val_loss=2.28, val_accuracy=0.437, lr=0.1]  4%|▍         | 6/136 [02:49<51:53, 23.95s/epoch, loss=1.21, accuracy=0.721, val_loss=2.01, val_accuracy=0.482, lr=0.1]  5%|▌         | 7/136 [03:11<49:57, 23.24s/epoch, loss=1.21, accuracy=0.722, val_loss=2.6, val_accuracy=0.341, lr=0.1]   6%|▌         | 8/136 [03:33<48:26, 22.71s/epoch, loss=1.2, accuracy=0.727, val_loss=2.02, val_accuracy=0.488, lr=0.1]  7%|▋         | 9/136 [03:54<47:28, 22.43s/epoch, loss=1.19, accuracy=0.733, val_loss=2.22, val_accuracy=0.499, lr=0.1]  7%|▋         | 10/136 [04:16<46:22, 22.08s/epoch, loss=1.19, accuracy=0.734, val_loss=1.64, val_accuracy=0.592, lr=0.1]  8%|▊         | 11/136 [04:37<45:47, 21.98s/epoch, loss=1.18, accuracy=0.736, val_loss=1.74, val_accuracy=0.574, lr=0.1]  9%|▉         | 12/136 [04:59<45:10, 21.86s/epoch, loss=1.17, accuracy=0.741, val_loss=1.84, val_accuracy=0.569, lr=0.1] 10%|▉         | 13/136 [05:21<44:40, 21.79s/epoch, loss=1.17, accuracy=0.741, val_loss=3.68, val_accuracy=0.388, lr=0.1] 10%|█         | 14/136 [05:42<44:11, 21.73s/epoch, loss=1.16, accuracy=0.74, val_loss=1.61, val_accuracy=0.6, lr=0.1]    11%|█         | 15/136 [06:03<43:31, 21.58s/epoch, loss=1.17, accuracy=0.742, val_loss=2.46, val_accuracy=0.434, lr=0.1] 12%|█▏        | 16/136 [06:25<43:00, 21.50s/epoch, loss=1.16, accuracy=0.743, val_loss=2.06, val_accuracy=0.493, lr=0.1] 12%|█▎        | 17/136 [06:46<42:47, 21.57s/epoch, loss=1.15, accuracy=0.748, val_loss=1.64, val_accuracy=0.58, lr=0.1]  13%|█▎        | 18/136 [07:08<42:22, 21.55s/epoch, loss=1.15, accuracy=0.747, val_loss=3.22, val_accuracy=0.22, lr=0.1] 14%|█▍        | 19/136 [07:30<42:06, 21.59s/epoch, loss=1.15, accuracy=0.749, val_loss=1.4, val_accuracy=0.662, lr=0.1] 15%|█▍        | 20/136 [07:51<41:44, 21.59s/epoch, loss=1.15, accuracy=0.748, val_loss=1.84, val_accuracy=0.521, lr=0.1] 15%|█▌        | 21/136 [08:13<41:35, 21.70s/epoch, loss=1.15, accuracy=0.75, val_loss=1.44, val_accuracy=0.66, lr=0.1]   16%|█▌        | 22/136 [08:35<41:17, 21.74s/epoch, loss=1.14, accuracy=0.752, val_loss=2.63, val_accuracy=0.462, lr=0.1] 17%|█▋        | 23/136 [08:57<40:49, 21.68s/epoch, loss=1.15, accuracy=0.748, val_loss=1.78, val_accuracy=0.584, lr=0.1] 18%|█▊        | 24/136 [09:18<40:32, 21.71s/epoch, loss=1.14, accuracy=0.75, val_loss=2, val_accuracy=0.475, lr=0.1]     18%|█▊        | 25/136 [09:40<39:59, 21.62s/epoch, loss=1.14, accuracy=0.751, val_loss=1.65, val_accuracy=0.572, lr=0.1] 19%|█▉        | 26/136 [10:01<39:41, 21.65s/epoch, loss=1.14, accuracy=0.751, val_loss=2.69, val_accuracy=0.389, lr=0.1] 20%|█▉        | 27/136 [10:23<39:06, 21.52s/epoch, loss=1.14, accuracy=0.75, val_loss=1.64, val_accuracy=0.614, lr=0.1]  21%|██        | 28/136 [10:44<38:41, 21.49s/epoch, loss=1.13, accuracy=0.751, val_loss=2.21, val_accuracy=0.477, lr=0.1] 21%|██▏       | 29/136 [11:06<38:17, 21.47s/epoch, loss=1.13, accuracy=0.752, val_loss=2.78, val_accuracy=0.42, lr=0.1]  22%|██▏       | 30/136 [11:27<37:59, 21.50s/epoch, loss=1.13, accuracy=0.753, val_loss=2.29, val_accuracy=0.432, lr=0.1] 23%|██▎       | 31/136 [11:49<37:45, 21.57s/epoch, loss=1.13, accuracy=0.753, val_loss=2.83, val_accuracy=0.408, lr=0.1] 24%|██▎       | 32/136 [12:11<37:26, 21.60s/epoch, loss=1.13, accuracy=0.752, val_loss=1.76, val_accuracy=0.556, lr=0.1] 24%|██▍       | 33/136 [12:32<37:04, 21.60s/epoch, loss=1.12, accuracy=0.756, val_loss=2.64, val_accuracy=0.354, lr=0.1] 25%|██▌       | 34/136 [12:54<36:45, 21.63s/epoch, loss=1.13, accuracy=0.755, val_loss=1.57, val_accuracy=0.573, lr=0.1] 26%|██▌       | 35/136 [13:15<36:22, 21.61s/epoch, loss=1.13, accuracy=0.754, val_loss=1.84, val_accuracy=0.559, lr=0.1] 26%|██▋       | 36/136 [13:37<36:01, 21.61s/epoch, loss=1.13, accuracy=0.757, val_loss=1.52, val_accuracy=0.604, lr=0.1] 27%|██▋       | 37/136 [13:58<35:27, 21.49s/epoch, loss=1.12, accuracy=0.757, val_loss=1.53, val_accuracy=0.617, lr=0.1] 28%|██▊       | 38/136 [14:20<35:08, 21.52s/epoch, loss=1.12, accuracy=0.755, val_loss=1.92, val_accuracy=0.502, lr=0.1] 29%|██▊       | 39/136 [14:41<34:51, 21.56s/epoch, loss=1.12, accuracy=0.756, val_loss=3.6, val_accuracy=0.358, lr=0.1]  29%|██▉       | 40/136 [15:02<34:14, 21.40s/epoch, loss=1.12, accuracy=0.757, val_loss=1.91, val_accuracy=0.551, lr=0.1] 30%|███       | 41/136 [15:24<33:55, 21.42s/epoch, loss=1.12, accuracy=0.757, val_loss=2.38, val_accuracy=0.337, lr=0.1] 31%|███       | 42/136 [15:45<33:36, 21.45s/epoch, loss=1.12, accuracy=0.755, val_loss=2.15, val_accuracy=0.43, lr=0.1]  32%|███▏      | 43/136 [16:07<33:23, 21.54s/epoch, loss=1.12, accuracy=0.757, val_loss=1.74, val_accuracy=0.539, lr=0.1] 32%|███▏      | 44/136 [16:29<33:02, 21.55s/epoch, loss=1.12, accuracy=0.756, val_loss=1.92, val_accuracy=0.502, lr=0.1] 33%|███▎      | 45/136 [16:50<32:35, 21.49s/epoch, loss=1.11, accuracy=0.756, val_loss=2.18, val_accuracy=0.489, lr=0.1] 34%|███▍      | 46/136 [17:12<32:16, 21.51s/epoch, loss=1.11, accuracy=0.759, val_loss=3.75, val_accuracy=0.326, lr=0.1] 35%|███▍      | 47/136 [17:33<31:52, 21.49s/epoch, loss=1.11, accuracy=0.757, val_loss=2.52, val_accuracy=0.451, lr=0.1] 35%|███▌      | 48/136 [17:55<31:35, 21.54s/epoch, loss=1.11, accuracy=0.758, val_loss=1.44, val_accuracy=0.637, lr=0.1] 36%|███▌      | 49/136 [18:16<31:11, 21.51s/epoch, loss=1.12, accuracy=0.756, val_loss=1.62, val_accuracy=0.595, lr=0.1] 37%|███▋      | 50/136 [18:38<30:43, 21.44s/epoch, loss=1.12, accuracy=0.756, val_loss=1.92, val_accuracy=0.547, lr=0.1] 38%|███▊      | 51/136 [18:59<30:20, 21.41s/epoch, loss=1.11, accuracy=0.757, val_loss=1.65, val_accuracy=0.61, lr=0.1]  38%|███▊      | 52/136 [19:20<30:01, 21.44s/epoch, loss=1.12, accuracy=0.757, val_loss=2.87, val_accuracy=0.262, lr=0.1] 39%|███▉      | 53/136 [19:42<29:43, 21.48s/epoch, loss=1.11, accuracy=0.758, val_loss=2.89, val_accuracy=0.28, lr=0.1]  40%|███▉      | 54/136 [20:03<29:20, 21.47s/epoch, loss=1.11, accuracy=0.757, val_loss=2.21, val_accuracy=0.459, lr=0.1] 40%|████      | 55/136 [20:25<29:02, 21.51s/epoch, loss=1.11, accuracy=0.757, val_loss=1.73, val_accuracy=0.573, lr=0.1] 41%|████      | 56/136 [20:47<28:43, 21.55s/epoch, loss=0.903, accuracy=0.816, val_loss=0.909, val_accuracy=0.803, lr=0.01] 42%|████▏     | 57/136 [21:08<28:20, 21.52s/epoch, loss=0.725, accuracy=0.849, val_loss=0.867, val_accuracy=0.789, lr=0.01] 43%|████▎     | 58/136 [21:30<27:58, 21.52s/epoch, loss=0.645, accuracy=0.857, val_loss=0.752, val_accuracy=0.813, lr=0.01] 43%|████▎     | 59/136 [21:51<27:39, 21.56s/epoch, loss=0.6, accuracy=0.861, val_loss=0.725, val_accuracy=0.811, lr=0.01]   44%|████▍     | 60/136 [22:13<27:20, 21.59s/epoch, loss=0.58, accuracy=0.861, val_loss=0.943, val_accuracy=0.749, lr=0.01] 45%|████▍     | 61/136 [22:35<27:02, 21.63s/epoch, loss=0.57, accuracy=0.863, val_loss=0.953, val_accuracy=0.731, lr=0.01] 46%|████▌     | 62/136 [22:56<26:32, 21.52s/epoch, loss=0.566, accuracy=0.864, val_loss=0.756, val_accuracy=0.797, lr=0.01] 46%|████▋     | 63/136 [23:17<26:08, 21.48s/epoch, loss=0.559, accuracy=0.866, val_loss=0.676, val_accuracy=0.827, lr=0.01] 47%|████▋     | 64/136 [23:39<25:42, 21.42s/epoch, loss=0.558, accuracy=0.867, val_loss=0.797, val_accuracy=0.793, lr=0.01] 48%|████▊     | 65/136 [24:00<25:22, 21.45s/epoch, loss=0.552, accuracy=0.87, val_loss=0.825, val_accuracy=0.785, lr=0.01]  49%|████▊     | 66/136 [24:21<24:53, 21.33s/epoch, loss=0.555, accuracy=0.869, val_loss=0.919, val_accuracy=0.767, lr=0.01] 49%|████▉     | 67/136 [24:42<24:30, 21.32s/epoch, loss=0.553, accuracy=0.872, val_loss=0.929, val_accuracy=0.771, lr=0.01] 50%|█████     | 68/136 [25:04<24:06, 21.27s/epoch, loss=0.552, accuracy=0.873, val_loss=0.926, val_accuracy=0.767, lr=0.01] 51%|█████     | 69/136 [25:25<23:45, 21.27s/epoch, loss=0.549, accuracy=0.873, val_loss=1.04, val_accuracy=0.715, lr=0.01]  51%|█████▏    | 70/136 [25:46<23:29, 21.35s/epoch, loss=0.557, accuracy=0.871, val_loss=0.853, val_accuracy=0.785, lr=0.01] 52%|█████▏    | 71/136 [26:08<23:15, 21.47s/epoch, loss=0.55, accuracy=0.877, val_loss=0.739, val_accuracy=0.825, lr=0.01]  53%|█████▎    | 72/136 [26:29<22:48, 21.38s/epoch, loss=0.544, accuracy=0.878, val_loss=0.766, val_accuracy=0.818, lr=0.01] 54%|█████▎    | 73/136 [26:51<22:30, 21.43s/epoch, loss=0.55, accuracy=0.877, val_loss=0.984, val_accuracy=0.75, lr=0.01]   54%|█████▍    | 74/136 [27:12<22:09, 21.44s/epoch, loss=0.547, accuracy=0.88, val_loss=1.2, val_accuracy=0.688, lr=0.01]  55%|█████▌    | 75/136 [27:34<21:53, 21.54s/epoch, loss=0.543, accuracy=0.881, val_loss=1.02, val_accuracy=0.758, lr=0.01] 56%|█████▌    | 76/136 [27:56<21:30, 21.50s/epoch, loss=0.543, accuracy=0.881, val_loss=0.782, val_accuracy=0.811, lr=0.01] 57%|█████▋    | 77/136 [28:17<21:13, 21.58s/epoch, loss=0.545, accuracy=0.88, val_loss=1.33, val_accuracy=0.677, lr=0.01]   57%|█████▋    | 78/136 [28:38<20:40, 21.39s/epoch, loss=0.545, accuracy=0.88, val_loss=0.719, val_accuracy=0.822, lr=0.01] 58%|█████▊    | 79/136 [29:00<20:24, 21.48s/epoch, loss=0.544, accuracy=0.882, val_loss=0.924, val_accuracy=0.778, lr=0.01] 59%|█████▉    | 80/136 [29:22<20:04, 21.51s/epoch, loss=0.548, accuracy=0.881, val_loss=0.737, val_accuracy=0.823, lr=0.01] 60%|█████▉    | 81/136 [29:42<19:29, 21.26s/epoch, loss=0.545, accuracy=0.884, val_loss=1.07, val_accuracy=0.745, lr=0.01]  60%|██████    | 82/136 [30:04<19:14, 21.38s/epoch, loss=0.544, accuracy=0.883, val_loss=0.973, val_accuracy=0.75, lr=0.01] 61%|██████    | 83/136 [30:25<18:45, 21.24s/epoch, loss=0.468, accuracy=0.911, val_loss=0.531, val_accuracy=0.888, lr=0.001] 62%|██████▏   | 84/136 [30:46<18:29, 21.34s/epoch, loss=0.418, accuracy=0.926, val_loss=0.507, val_accuracy=0.893, lr=0.001] 62%|██████▎   | 85/136 [31:07<18:05, 21.28s/epoch, loss=0.398, accuracy=0.932, val_loss=0.494, val_accuracy=0.896, lr=0.001] 63%|██████▎   | 86/136 [31:29<17:50, 21.40s/epoch, loss=0.381, accuracy=0.934, val_loss=0.483, val_accuracy=0.899, lr=0.001] 64%|██████▍   | 87/136 [31:50<17:16, 21.15s/epoch, loss=0.367, accuracy=0.938, val_loss=0.482, val_accuracy=0.896, lr=0.001] 65%|██████▍   | 88/136 [32:11<16:57, 21.21s/epoch, loss=0.358, accuracy=0.94, val_loss=0.473, val_accuracy=0.897, lr=0.001]  65%|██████▌   | 89/136 [32:33<16:40, 21.29s/epoch, loss=0.348, accuracy=0.939, val_loss=0.468, val_accuracy=0.897, lr=0.001] 66%|██████▌   | 90/136 [32:54<16:24, 21.40s/epoch, loss=0.337, accuracy=0.942, val_loss=0.464, val_accuracy=0.896, lr=0.001] 67%|██████▋   | 91/136 [33:16<16:07, 21.49s/epoch, loss=0.325, accuracy=0.946, val_loss=0.479, val_accuracy=0.895, lr=0.001] 68%|██████▊   | 92/136 [33:38<15:47, 21.53s/epoch, loss=0.319, accuracy=0.946, val_loss=0.474, val_accuracy=0.895, lr=0.001] 68%|██████▊   | 93/136 [33:59<15:22, 21.46s/epoch, loss=0.312, accuracy=0.947, val_loss=0.471, val_accuracy=0.896, lr=0.001] 69%|██████▉   | 94/136 [34:20<14:58, 21.38s/epoch, loss=0.306, accuracy=0.948, val_loss=0.462, val_accuracy=0.896, lr=0.001] 70%|██████▉   | 95/136 [34:41<14:36, 21.37s/epoch, loss=0.296, accuracy=0.949, val_loss=0.458, val_accuracy=0.894, lr=0.001] 71%|███████   | 96/136 [35:03<14:13, 21.35s/epoch, loss=0.289, accuracy=0.952, val_loss=0.48, val_accuracy=0.892, lr=0.001]  71%|███████▏  | 97/136 [35:24<13:54, 21.40s/epoch, loss=0.283, accuracy=0.951, val_loss=0.477, val_accuracy=0.893, lr=0.001] 72%|███████▏  | 98/136 [35:46<13:37, 21.50s/epoch, loss=0.279, accuracy=0.953, val_loss=0.489, val_accuracy=0.887, lr=0.001] 73%|███████▎  | 99/136 [36:07<13:11, 21.40s/epoch, loss=0.273, accuracy=0.954, val_loss=0.475, val_accuracy=0.887, lr=0.001] 74%|███████▎  | 100/136 [36:29<12:54, 21.50s/epoch, loss=0.268, accuracy=0.955, val_loss=0.447, val_accuracy=0.896, lr=0.001] 74%|███████▍  | 101/136 [36:50<12:33, 21.54s/epoch, loss=0.265, accuracy=0.954, val_loss=0.457, val_accuracy=0.895, lr=0.001] 75%|███████▌  | 102/136 [37:12<12:14, 21.60s/epoch, loss=0.261, accuracy=0.954, val_loss=0.462, val_accuracy=0.893, lr=0.001] 76%|███████▌  | 103/136 [37:34<11:52, 21.58s/epoch, loss=0.254, accuracy=0.956, val_loss=0.466, val_accuracy=0.892, lr=0.001] 76%|███████▋  | 104/136 [37:55<11:28, 21.51s/epoch, loss=0.249, accuracy=0.956, val_loss=0.479, val_accuracy=0.887, lr=0.001] 77%|███████▋  | 105/136 [38:17<11:07, 21.54s/epoch, loss=0.249, accuracy=0.957, val_loss=0.466, val_accuracy=0.891, lr=0.001] 78%|███████▊  | 106/136 [38:38<10:46, 21.56s/epoch, loss=0.246, accuracy=0.957, val_loss=0.435, val_accuracy=0.895, lr=0.001] 79%|███████▊  | 107/136 [38:59<10:21, 21.44s/epoch, loss=0.244, accuracy=0.957, val_loss=0.45, val_accuracy=0.893, lr=0.001]  79%|███████▉  | 108/136 [39:21<09:59, 21.42s/epoch, loss=0.238, accuracy=0.958, val_loss=0.493, val_accuracy=0.882, lr=0.001] 80%|████████  | 109/136 [39:42<09:40, 21.49s/epoch, loss=0.237, accuracy=0.959, val_loss=0.457, val_accuracy=0.891, lr=0.001] 81%|████████  | 110/136 [40:04<09:18, 21.49s/epoch, loss=0.218, accuracy=0.965, val_loss=0.416, val_accuracy=0.903, lr=1e-04] 82%|████████▏ | 111/136 [40:26<08:57, 21.51s/epoch, loss=0.209, accuracy=0.968, val_loss=0.413, val_accuracy=0.907, lr=1e-04] 82%|████████▏ | 112/136 [40:47<08:35, 21.46s/epoch, loss=0.202, accuracy=0.97, val_loss=0.411, val_accuracy=0.905, lr=1e-04]  83%|████████▎ | 113/136 [41:08<08:13, 21.46s/epoch, loss=0.198, accuracy=0.973, val_loss=0.411, val_accuracy=0.906, lr=1e-04] 84%|████████▍ | 114/136 [41:29<07:50, 21.37s/epoch, loss=0.197, accuracy=0.973, val_loss=0.411, val_accuracy=0.908, lr=1e-04] 85%|████████▍ | 115/136 [41:51<07:29, 21.40s/epoch, loss=0.194, accuracy=0.974, val_loss=0.413, val_accuracy=0.906, lr=1e-04] 85%|████████▌ | 116/136 [42:12<07:05, 21.27s/epoch, loss=0.193, accuracy=0.974, val_loss=0.41, val_accuracy=0.908, lr=1e-04]  86%|████████▌ | 117/136 [42:33<06:43, 21.24s/epoch, loss=0.189, accuracy=0.975, val_loss=0.412, val_accuracy=0.907, lr=1e-04] 87%|████████▋ | 118/136 [42:55<06:24, 21.34s/epoch, loss=0.191, accuracy=0.975, val_loss=0.412, val_accuracy=0.906, lr=1e-04] 88%|████████▊ | 119/136 [43:16<06:03, 21.38s/epoch, loss=0.189, accuracy=0.976, val_loss=0.411, val_accuracy=0.906, lr=1e-04] 88%|████████▊ | 120/136 [43:38<05:42, 21.38s/epoch, loss=0.188, accuracy=0.976, val_loss=0.41, val_accuracy=0.907, lr=1e-04]  89%|████████▉ | 121/136 [43:59<05:20, 21.38s/epoch, loss=0.187, accuracy=0.976, val_loss=0.414, val_accuracy=0.905, lr=1e-04] 90%|████████▉ | 122/136 [44:20<04:59, 21.41s/epoch, loss=0.187, accuracy=0.976, val_loss=0.412, val_accuracy=0.905, lr=1e-04] 90%|█████████ | 123/136 [44:42<04:37, 21.37s/epoch, loss=0.185, accuracy=0.976, val_loss=0.413, val_accuracy=0.907, lr=1e-04] 91%|█████████ | 124/136 [45:03<04:15, 21.30s/epoch, loss=0.182, accuracy=0.978, val_loss=0.409, val_accuracy=0.907, lr=5e-5]  92%|█████████▏| 125/136 [45:24<03:53, 21.23s/epoch, loss=0.183, accuracy=0.976, val_loss=0.41, val_accuracy=0.908, lr=5e-5]  93%|█████████▎| 126/136 [45:45<03:32, 21.22s/epoch, loss=0.181, accuracy=0.978, val_loss=0.41, val_accuracy=0.907, lr=5e-5] 93%|█████████▎| 127/136 [46:06<03:11, 21.24s/epoch, loss=0.181, accuracy=0.977, val_loss=0.411, val_accuracy=0.908, lr=5e-5] 94%|█████████▍| 128/136 [46:28<02:50, 21.34s/epoch, loss=0.179, accuracy=0.978, val_loss=0.413, val_accuracy=0.907, lr=5e-5] 95%|█████████▍| 129/136 [46:49<02:29, 21.31s/epoch, loss=0.181, accuracy=0.977, val_loss=0.411, val_accuracy=0.907, lr=5e-5] 96%|█████████▌| 130/136 [47:11<02:07, 21.32s/epoch, loss=0.178, accuracy=0.978, val_loss=0.411, val_accuracy=0.906, lr=5e-5] 96%|█████████▋| 131/136 [47:32<01:46, 21.29s/epoch, loss=0.178, accuracy=0.979, val_loss=0.411, val_accuracy=0.907, lr=5e-5] 97%|█████████▋| 132/136 [47:53<01:24, 21.19s/epoch, loss=0.179, accuracy=0.977, val_loss=0.41, val_accuracy=0.907, lr=5e-5]  98%|█████████▊| 133/136 [48:14<01:03, 21.16s/epoch, loss=0.177, accuracy=0.978, val_loss=0.411, val_accuracy=0.907, lr=5e-5] 99%|█████████▊| 134/136 [48:35<00:42, 21.18s/epoch, loss=0.177, accuracy=0.979, val_loss=0.41, val_accuracy=0.907, lr=5e-5]  99%|█████████▉| 135/136 [48:56<00:21, 21.14s/epoch, loss=0.176, accuracy=0.979, val_loss=0.41, val_accuracy=0.907, lr=5e-5]100%|██████████| 136/136 [49:18<00:00, 21.25s/epoch, loss=0.175, accuracy=0.979, val_loss=0.411, val_accuracy=0.908, lr=5e-5]100%|██████████| 136/136 [49:18<00:00, 21.75s/epoch, loss=0.175, accuracy=0.979, val_loss=0.411, val_accuracy=0.908, lr=5e-5]
Using real-time data augmentation.
Only one model saved

Loading model: 11_02_cifar10_ResNet20v1.h5
Test score: 0.4109029769897461
Test accuracy: 0.9082000255584717


* * * Run SGD for ID = 11_3. * * *


2024-03-12 23:50:52.644483: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-12 23:50:54.858919: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-12 23:50:54.859810: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-12 23:50:54.896911: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-03-12 23:50:54.896945: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-12 23:50:54.899537: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-12 23:50:54.899572: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-12 23:50:54.901709: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-12 23:50:54.902341: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-12 23:50:54.904598: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-12 23:50:54.905895: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-12 23:50:54.910317: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-12 23:50:54.910752: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-12 23:50:54.910821: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-12 23:50:56.072827: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-12 23:50:56.073358: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-12 23:50:56.073784: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-03-12 23:50:56.073818: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-12 23:50:56.073849: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-12 23:50:56.073865: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-12 23:50:56.073878: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-12 23:50:56.073892: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-12 23:50:56.073906: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-12 23:50:56.073920: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-12 23:50:56.073935: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-12 23:50:56.074415: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-12 23:50:56.074448: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-12 23:50:56.665468: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-12 23:50:56.665528: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-12 23:50:56.665539: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-12 23:50:56.666719: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11227 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN X (Pascal), pci bus id: 0000:03:00.0, compute capability: 6.1)
{'id': '11_03', 'seed': 3, 'out_folder': 'results/epoch_budget_2', 'batch_size': 128, 'epochs': 136, 'validation_split': 0.0, 'checkpointing': False, 'checkpoint_every': -1, 'hold_out_validation_split': 0.0, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'num_classes': 10, 'SSE_lr': False, 'test_time_augmentation': False, 'debug': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN X (Pascal)'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
y_train shape: (50000, 10)
x_val shape: (10000, 32, 32, 3)
y_val shape: (10000, 10)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/136 [00:00<?, ?epoch/s]2024-03-12 23:50:57.239545: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-12 23:50:57.252077: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2600020000 Hz
2024-03-12 23:50:59.167794: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-12 23:50:59.394714: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-12 23:51:00.081338: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-12 23:51:00.123478: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/136 [00:56<2:06:50, 56.38s/epoch, loss=2.92, accuracy=0.38, val_loss=2.56, val_accuracy=0.299, lr=0.1]  1%|▏         | 2/136 [01:17<1:20:00, 35.83s/epoch, loss=1.5, accuracy=0.572, val_loss=2.33, val_accuracy=0.401, lr=0.1]  2%|▏         | 3/136 [01:39<1:04:51, 29.26s/epoch, loss=1.32, accuracy=0.658, val_loss=1.86, val_accuracy=0.494, lr=0.1]  3%|▎         | 4/136 [02:00<57:37, 26.20s/epoch, loss=1.26, accuracy=0.691, val_loss=1.65, val_accuracy=0.547, lr=0.1]    4%|▎         | 5/136 [02:22<53:30, 24.51s/epoch, loss=1.24, accuracy=0.706, val_loss=2.03, val_accuracy=0.527, lr=0.1]  4%|▍         | 6/136 [02:43<50:44, 23.42s/epoch, loss=1.22, accuracy=0.717, val_loss=1.82, val_accuracy=0.534, lr=0.1]  5%|▌         | 7/136 [03:04<48:52, 22.73s/epoch, loss=1.22, accuracy=0.723, val_loss=1.86, val_accuracy=0.54, lr=0.1]   6%|▌         | 8/136 [03:26<47:29, 22.26s/epoch, loss=1.21, accuracy=0.728, val_loss=1.5, val_accuracy=0.635, lr=0.1]  7%|▋         | 9/136 [03:46<46:07, 21.79s/epoch, loss=1.2, accuracy=0.733, val_loss=1.47, val_accuracy=0.634, lr=0.1]  7%|▋         | 10/136 [04:08<45:21, 21.60s/epoch, loss=1.2, accuracy=0.735, val_loss=2.27, val_accuracy=0.512, lr=0.1]  8%|▊         | 11/136 [04:29<44:37, 21.42s/epoch, loss=1.19, accuracy=0.741, val_loss=3.24, val_accuracy=0.384, lr=0.1]  9%|▉         | 12/136 [04:50<44:13, 21.40s/epoch, loss=1.19, accuracy=0.738, val_loss=1.65, val_accuracy=0.571, lr=0.1] 10%|▉         | 13/136 [05:11<43:48, 21.37s/epoch, loss=1.18, accuracy=0.743, val_loss=2.25, val_accuracy=0.447, lr=0.1] 10%|█         | 14/136 [05:33<43:24, 21.35s/epoch, loss=1.19, accuracy=0.741, val_loss=2.33, val_accuracy=0.49, lr=0.1]  11%|█         | 15/136 [05:54<43:08, 21.39s/epoch, loss=1.19, accuracy=0.744, val_loss=2.62, val_accuracy=0.38, lr=0.1] 12%|█▏        | 16/136 [06:15<42:48, 21.41s/epoch, loss=1.17, accuracy=0.749, val_loss=2.13, val_accuracy=0.459, lr=0.1] 12%|█▎        | 17/136 [06:37<42:22, 21.36s/epoch, loss=1.17, accuracy=0.746, val_loss=1.71, val_accuracy=0.581, lr=0.1] 13%|█▎        | 18/136 [06:58<41:56, 21.32s/epoch, loss=1.18, accuracy=0.743, val_loss=2.36, val_accuracy=0.395, lr=0.1] 14%|█▍        | 19/136 [07:19<41:24, 21.24s/epoch, loss=1.17, accuracy=0.744, val_loss=3.94, val_accuracy=0.286, lr=0.1] 15%|█▍        | 20/136 [07:40<41:00, 21.21s/epoch, loss=1.17, accuracy=0.75, val_loss=1.3, val_accuracy=0.703, lr=0.1]   15%|█▌        | 21/136 [08:01<40:15, 21.00s/epoch, loss=1.17, accuracy=0.749, val_loss=1.96, val_accuracy=0.511, lr=0.1] 16%|█▌        | 22/136 [08:22<40:13, 21.17s/epoch, loss=1.17, accuracy=0.749, val_loss=2.33, val_accuracy=0.397, lr=0.1] 17%|█▋        | 23/136 [08:44<40:03, 21.27s/epoch, loss=1.15, accuracy=0.752, val_loss=2.25, val_accuracy=0.41, lr=0.1]  18%|█▊        | 24/136 [09:05<39:40, 21.25s/epoch, loss=1.16, accuracy=0.751, val_loss=1.75, val_accuracy=0.565, lr=0.1] 18%|█▊        | 25/136 [09:26<39:20, 21.27s/epoch, loss=1.15, accuracy=0.754, val_loss=3.38, val_accuracy=0.28, lr=0.1]  19%|█▉        | 26/136 [09:48<39:03, 21.31s/epoch, loss=1.15, accuracy=0.75, val_loss=1.6, val_accuracy=0.585, lr=0.1]  20%|█▉        | 27/136 [10:09<38:42, 21.31s/epoch, loss=1.14, accuracy=0.752, val_loss=1.98, val_accuracy=0.476, lr=0.1] 21%|██        | 28/136 [10:30<38:23, 21.33s/epoch, loss=1.15, accuracy=0.754, val_loss=1.84, val_accuracy=0.542, lr=0.1] 21%|██▏       | 29/136 [10:52<38:01, 21.32s/epoch, loss=1.14, accuracy=0.755, val_loss=2.05, val_accuracy=0.514, lr=0.1] 22%|██▏       | 30/136 [11:13<37:33, 21.26s/epoch, loss=1.14, accuracy=0.755, val_loss=1.92, val_accuracy=0.52, lr=0.1]  23%|██▎       | 31/136 [11:34<37:15, 21.29s/epoch, loss=1.14, accuracy=0.753, val_loss=3.33, val_accuracy=0.31, lr=0.1] 24%|██▎       | 32/136 [11:55<36:52, 21.27s/epoch, loss=1.14, accuracy=0.754, val_loss=3.34, val_accuracy=0.253, lr=0.1] 24%|██▍       | 33/136 [12:17<36:32, 21.29s/epoch, loss=1.14, accuracy=0.753, val_loss=3.3, val_accuracy=0.288, lr=0.1]  25%|██▌       | 34/136 [12:38<36:10, 21.28s/epoch, loss=1.14, accuracy=0.755, val_loss=1.69, val_accuracy=0.559, lr=0.1] 26%|██▌       | 35/136 [12:59<35:48, 21.27s/epoch, loss=1.14, accuracy=0.755, val_loss=2.02, val_accuracy=0.531, lr=0.1] 26%|██▋       | 36/136 [13:21<35:29, 21.29s/epoch, loss=1.13, accuracy=0.758, val_loss=1.79, val_accuracy=0.533, lr=0.1] 27%|██▋       | 37/136 [13:42<35:00, 21.22s/epoch, loss=1.14, accuracy=0.755, val_loss=2.16, val_accuracy=0.543, lr=0.1] 28%|██▊       | 38/136 [14:03<34:36, 21.19s/epoch, loss=1.13, accuracy=0.758, val_loss=1.55, val_accuracy=0.603, lr=0.1] 29%|██▊       | 39/136 [14:23<33:50, 20.93s/epoch, loss=1.13, accuracy=0.756, val_loss=1.9, val_accuracy=0.529, lr=0.1]  29%|██▉       | 40/136 [14:44<33:40, 21.05s/epoch, loss=1.13, accuracy=0.756, val_loss=2.91, val_accuracy=0.268, lr=0.1] 30%|███       | 41/136 [15:06<33:24, 21.10s/epoch, loss=1.13, accuracy=0.757, val_loss=1.95, val_accuracy=0.531, lr=0.1] 31%|███       | 42/136 [15:27<33:03, 21.10s/epoch, loss=1.13, accuracy=0.757, val_loss=2.43, val_accuracy=0.432, lr=0.1] 32%|███▏      | 43/136 [15:48<32:45, 21.14s/epoch, loss=1.12, accuracy=0.761, val_loss=4.12, val_accuracy=0.304, lr=0.1] 32%|███▏      | 44/136 [16:09<32:29, 21.19s/epoch, loss=1.12, accuracy=0.759, val_loss=1.42, val_accuracy=0.653, lr=0.1] 33%|███▎      | 45/136 [16:31<32:17, 21.29s/epoch, loss=1.13, accuracy=0.757, val_loss=1.7, val_accuracy=0.564, lr=0.1]  34%|███▍      | 46/136 [16:52<31:55, 21.28s/epoch, loss=1.12, accuracy=0.759, val_loss=3.26, val_accuracy=0.284, lr=0.1] 35%|███▍      | 47/136 [17:14<31:41, 21.36s/epoch, loss=1.12, accuracy=0.759, val_loss=2.01, val_accuracy=0.538, lr=0.1] 35%|███▌      | 48/136 [17:35<31:18, 21.34s/epoch, loss=1.12, accuracy=0.757, val_loss=3.26, val_accuracy=0.329, lr=0.1] 36%|███▌      | 49/136 [17:56<30:59, 21.37s/epoch, loss=1.12, accuracy=0.757, val_loss=3.86, val_accuracy=0.237, lr=0.1] 37%|███▋      | 50/136 [18:17<30:30, 21.28s/epoch, loss=1.12, accuracy=0.76, val_loss=2.55, val_accuracy=0.424, lr=0.1]  38%|███▊      | 51/136 [18:39<30:12, 21.32s/epoch, loss=1.12, accuracy=0.757, val_loss=2.02, val_accuracy=0.558, lr=0.1] 38%|███▊      | 52/136 [19:00<29:51, 21.33s/epoch, loss=1.12, accuracy=0.757, val_loss=2.04, val_accuracy=0.502, lr=0.1] 39%|███▉      | 53/136 [19:21<29:29, 21.32s/epoch, loss=1.12, accuracy=0.76, val_loss=2.79, val_accuracy=0.397, lr=0.1]  40%|███▉      | 54/136 [19:43<29:09, 21.34s/epoch, loss=1.12, accuracy=0.758, val_loss=1.83, val_accuracy=0.514, lr=0.1] 40%|████      | 55/136 [20:04<28:55, 21.42s/epoch, loss=1.12, accuracy=0.76, val_loss=1.83, val_accuracy=0.531, lr=0.1]  41%|████      | 56/136 [20:25<28:23, 21.29s/epoch, loss=0.899, accuracy=0.822, val_loss=0.952, val_accuracy=0.781, lr=0.01] 42%|████▏     | 57/136 [20:47<27:58, 21.24s/epoch, loss=0.722, accuracy=0.851, val_loss=0.805, val_accuracy=0.805, lr=0.01] 43%|████▎     | 58/136 [21:08<27:40, 21.29s/epoch, loss=0.643, accuracy=0.86, val_loss=0.805, val_accuracy=0.802, lr=0.01]  43%|████▎     | 59/136 [21:29<27:12, 21.20s/epoch, loss=0.599, accuracy=0.863, val_loss=0.66, val_accuracy=0.837, lr=0.01] 44%|████▍     | 60/136 [21:50<26:55, 21.26s/epoch, loss=0.577, accuracy=0.865, val_loss=0.7, val_accuracy=0.822, lr=0.01]  45%|████▍     | 61/136 [22:12<26:33, 21.24s/epoch, loss=0.567, accuracy=0.864, val_loss=0.859, val_accuracy=0.769, lr=0.01] 46%|████▌     | 62/136 [22:33<26:06, 21.17s/epoch, loss=0.56, accuracy=0.867, val_loss=0.731, val_accuracy=0.81, lr=0.01]   46%|████▋     | 63/136 [22:54<25:47, 21.20s/epoch, loss=0.558, accuracy=0.867, val_loss=0.899, val_accuracy=0.773, lr=0.01] 47%|████▋     | 64/136 [23:15<25:24, 21.17s/epoch, loss=0.555, accuracy=0.871, val_loss=0.996, val_accuracy=0.719, lr=0.01] 48%|████▊     | 65/136 [23:36<25:05, 21.21s/epoch, loss=0.557, accuracy=0.872, val_loss=0.996, val_accuracy=0.737, lr=0.01] 49%|████▊     | 66/136 [23:57<24:43, 21.19s/epoch, loss=0.556, accuracy=0.871, val_loss=0.916, val_accuracy=0.763, lr=0.01] 49%|████▉     | 67/136 [24:19<24:25, 21.25s/epoch, loss=0.557, accuracy=0.872, val_loss=0.724, val_accuracy=0.817, lr=0.01] 50%|█████     | 68/136 [24:39<23:40, 20.90s/epoch, loss=0.548, accuracy=0.877, val_loss=0.739, val_accuracy=0.812, lr=0.01] 51%|█████     | 69/136 [25:00<23:24, 20.96s/epoch, loss=0.548, accuracy=0.876, val_loss=1.08, val_accuracy=0.721, lr=0.01]  51%|█████▏    | 70/136 [25:21<23:05, 20.99s/epoch, loss=0.549, accuracy=0.877, val_loss=0.869, val_accuracy=0.775, lr=0.01] 52%|█████▏    | 71/136 [25:42<22:47, 21.03s/epoch, loss=0.548, accuracy=0.878, val_loss=0.74, val_accuracy=0.819, lr=0.01]  53%|█████▎    | 72/136 [26:03<22:29, 21.08s/epoch, loss=0.548, accuracy=0.879, val_loss=0.89, val_accuracy=0.762, lr=0.01] 54%|█████▎    | 73/136 [26:24<22:10, 21.12s/epoch, loss=0.552, accuracy=0.878, val_loss=0.905, val_accuracy=0.779, lr=0.01] 54%|█████▍    | 74/136 [26:46<21:54, 21.20s/epoch, loss=0.552, accuracy=0.88, val_loss=1.2, val_accuracy=0.712, lr=0.01]    55%|█████▌    | 75/136 [27:07<21:34, 21.22s/epoch, loss=0.547, accuracy=0.88, val_loss=0.876, val_accuracy=0.785, lr=0.01] 56%|█████▌    | 76/136 [27:29<21:16, 21.27s/epoch, loss=0.547, accuracy=0.882, val_loss=0.908, val_accuracy=0.768, lr=0.01] 57%|█████▋    | 77/136 [27:50<20:55, 21.28s/epoch, loss=0.548, accuracy=0.883, val_loss=0.673, val_accuracy=0.845, lr=0.01] 57%|█████▋    | 78/136 [28:11<20:30, 21.21s/epoch, loss=0.549, accuracy=0.883, val_loss=0.888, val_accuracy=0.769, lr=0.01] 58%|█████▊    | 79/136 [28:32<20:05, 21.16s/epoch, loss=0.548, accuracy=0.884, val_loss=1.28, val_accuracy=0.713, lr=0.01]  59%|█████▉    | 80/136 [28:53<19:48, 21.22s/epoch, loss=0.549, accuracy=0.882, val_loss=0.903, val_accuracy=0.768, lr=0.01] 60%|█████▉    | 81/136 [29:15<19:29, 21.26s/epoch, loss=0.543, accuracy=0.886, val_loss=1.35, val_accuracy=0.659, lr=0.01]  60%|██████    | 82/136 [29:36<19:06, 21.23s/epoch, loss=0.55, accuracy=0.882, val_loss=0.802, val_accuracy=0.799, lr=0.01] 61%|██████    | 83/136 [29:57<18:40, 21.13s/epoch, loss=0.471, accuracy=0.911, val_loss=0.526, val_accuracy=0.892, lr=0.001] 62%|██████▏   | 84/136 [30:18<18:21, 21.18s/epoch, loss=0.42, accuracy=0.929, val_loss=0.509, val_accuracy=0.894, lr=0.001]  62%|██████▎   | 85/136 [30:39<17:56, 21.11s/epoch, loss=0.397, accuracy=0.934, val_loss=0.494, val_accuracy=0.9, lr=0.001]  63%|██████▎   | 86/136 [31:00<17:37, 21.16s/epoch, loss=0.379, accuracy=0.938, val_loss=0.485, val_accuracy=0.902, lr=0.001] 64%|██████▍   | 87/136 [31:21<17:15, 21.14s/epoch, loss=0.365, accuracy=0.942, val_loss=0.48, val_accuracy=0.901, lr=0.001]  65%|██████▍   | 88/136 [31:43<16:57, 21.20s/epoch, loss=0.357, accuracy=0.942, val_loss=0.481, val_accuracy=0.9, lr=0.001]  65%|██████▌   | 89/136 [32:04<16:37, 21.22s/epoch, loss=0.342, accuracy=0.946, val_loss=0.477, val_accuracy=0.901, lr=0.001] 66%|██████▌   | 90/136 [32:25<16:11, 21.13s/epoch, loss=0.332, accuracy=0.948, val_loss=0.472, val_accuracy=0.9, lr=0.001]   67%|██████▋   | 91/136 [32:46<15:53, 21.18s/epoch, loss=0.325, accuracy=0.949, val_loss=0.467, val_accuracy=0.901, lr=0.001] 68%|██████▊   | 92/136 [33:07<15:30, 21.15s/epoch, loss=0.315, accuracy=0.95, val_loss=0.469, val_accuracy=0.901, lr=0.001]  68%|██████▊   | 93/136 [33:28<15:11, 21.19s/epoch, loss=0.308, accuracy=0.951, val_loss=0.461, val_accuracy=0.899, lr=0.001] 69%|██████▉   | 94/136 [33:50<14:50, 21.21s/epoch, loss=0.3, accuracy=0.953, val_loss=0.456, val_accuracy=0.902, lr=0.001]   70%|██████▉   | 95/136 [34:10<14:18, 20.95s/epoch, loss=0.293, accuracy=0.953, val_loss=0.446, val_accuracy=0.902, lr=0.001] 71%|███████   | 96/136 [34:31<14:00, 21.00s/epoch, loss=0.286, accuracy=0.954, val_loss=0.46, val_accuracy=0.899, lr=0.001]  71%|███████▏  | 97/136 [34:53<13:43, 21.12s/epoch, loss=0.279, accuracy=0.957, val_loss=0.452, val_accuracy=0.899, lr=0.001] 72%|███████▏  | 98/136 [35:14<13:25, 21.21s/epoch, loss=0.275, accuracy=0.957, val_loss=0.455, val_accuracy=0.9, lr=0.001]   73%|███████▎  | 99/136 [35:35<13:03, 21.17s/epoch, loss=0.265, accuracy=0.958, val_loss=0.448, val_accuracy=0.897, lr=0.001] 74%|███████▎  | 100/136 [35:56<12:34, 20.95s/epoch, loss=0.264, accuracy=0.957, val_loss=0.46, val_accuracy=0.898, lr=0.001] 74%|███████▍  | 101/136 [36:17<12:16, 21.05s/epoch, loss=0.257, accuracy=0.96, val_loss=0.46, val_accuracy=0.896, lr=0.001]  75%|███████▌  | 102/136 [36:38<11:57, 21.11s/epoch, loss=0.256, accuracy=0.958, val_loss=0.445, val_accuracy=0.899, lr=0.001] 76%|███████▌  | 103/136 [36:59<11:35, 21.08s/epoch, loss=0.248, accuracy=0.961, val_loss=0.456, val_accuracy=0.897, lr=0.001] 76%|███████▋  | 104/136 [37:20<11:15, 21.11s/epoch, loss=0.246, accuracy=0.96, val_loss=0.455, val_accuracy=0.898, lr=0.001]  77%|███████▋  | 105/136 [37:41<10:52, 21.06s/epoch, loss=0.243, accuracy=0.961, val_loss=0.448, val_accuracy=0.895, lr=0.001] 78%|███████▊  | 106/136 [38:03<10:34, 21.14s/epoch, loss=0.236, accuracy=0.962, val_loss=0.448, val_accuracy=0.895, lr=0.001] 79%|███████▊  | 107/136 [38:24<10:12, 21.11s/epoch, loss=0.235, accuracy=0.962, val_loss=0.485, val_accuracy=0.889, lr=0.001] 79%|███████▉  | 108/136 [38:44<09:48, 21.00s/epoch, loss=0.232, accuracy=0.962, val_loss=0.466, val_accuracy=0.894, lr=0.001] 80%|████████  | 109/136 [39:06<09:28, 21.05s/epoch, loss=0.231, accuracy=0.962, val_loss=0.461, val_accuracy=0.894, lr=0.001] 81%|████████  | 110/136 [39:27<09:07, 21.07s/epoch, loss=0.21, accuracy=0.97, val_loss=0.418, val_accuracy=0.907, lr=1e-04]   82%|████████▏ | 111/136 [39:47<08:43, 20.94s/epoch, loss=0.201, accuracy=0.973, val_loss=0.412, val_accuracy=0.908, lr=1e-04] 82%|████████▏ | 112/136 [40:08<08:24, 21.01s/epoch, loss=0.198, accuracy=0.974, val_loss=0.408, val_accuracy=0.909, lr=1e-04] 83%|████████▎ | 113/136 [40:30<08:05, 21.10s/epoch, loss=0.195, accuracy=0.976, val_loss=0.408, val_accuracy=0.908, lr=1e-04] 84%|████████▍ | 114/136 [40:51<07:45, 21.16s/epoch, loss=0.191, accuracy=0.977, val_loss=0.41, val_accuracy=0.908, lr=1e-04]  85%|████████▍ | 115/136 [41:12<07:24, 21.17s/epoch, loss=0.189, accuracy=0.978, val_loss=0.41, val_accuracy=0.907, lr=1e-04] 85%|████████▌ | 116/136 [41:33<07:01, 21.05s/epoch, loss=0.188, accuracy=0.978, val_loss=0.408, val_accuracy=0.908, lr=1e-04] 86%|████████▌ | 117/136 [41:54<06:41, 21.12s/epoch, loss=0.188, accuracy=0.978, val_loss=0.408, val_accuracy=0.908, lr=1e-04] 87%|████████▋ | 118/136 [42:15<06:19, 21.07s/epoch, loss=0.187, accuracy=0.978, val_loss=0.407, val_accuracy=0.909, lr=1e-04] 88%|████████▊ | 119/136 [42:36<05:58, 21.11s/epoch, loss=0.183, accuracy=0.979, val_loss=0.409, val_accuracy=0.908, lr=1e-04] 88%|████████▊ | 120/136 [42:57<05:37, 21.07s/epoch, loss=0.184, accuracy=0.978, val_loss=0.407, val_accuracy=0.909, lr=1e-04] 89%|████████▉ | 121/136 [43:19<05:17, 21.14s/epoch, loss=0.182, accuracy=0.98, val_loss=0.41, val_accuracy=0.908, lr=1e-04]   90%|████████▉ | 122/136 [43:40<04:54, 21.04s/epoch, loss=0.183, accuracy=0.979, val_loss=0.408, val_accuracy=0.908, lr=1e-04] 90%|█████████ | 123/136 [44:01<04:33, 21.05s/epoch, loss=0.181, accuracy=0.98, val_loss=0.408, val_accuracy=0.909, lr=1e-04]  91%|█████████ | 124/136 [44:22<04:12, 21.04s/epoch, loss=0.178, accuracy=0.981, val_loss=0.406, val_accuracy=0.91, lr=5e-5]  92%|█████████▏| 125/136 [44:43<03:51, 21.04s/epoch, loss=0.178, accuracy=0.981, val_loss=0.406, val_accuracy=0.909, lr=5e-5] 93%|█████████▎| 126/136 [45:04<03:30, 21.09s/epoch, loss=0.178, accuracy=0.981, val_loss=0.407, val_accuracy=0.909, lr=5e-5] 93%|█████████▎| 127/136 [45:25<03:10, 21.19s/epoch, loss=0.176, accuracy=0.981, val_loss=0.407, val_accuracy=0.91, lr=5e-5]  94%|█████████▍| 128/136 [45:47<02:49, 21.25s/epoch, loss=0.175, accuracy=0.981, val_loss=0.406, val_accuracy=0.909, lr=5e-5] 95%|█████████▍| 129/136 [46:08<02:28, 21.22s/epoch, loss=0.175, accuracy=0.982, val_loss=0.408, val_accuracy=0.909, lr=5e-5] 96%|█████████▌| 130/136 [46:29<02:06, 21.11s/epoch, loss=0.175, accuracy=0.981, val_loss=0.406, val_accuracy=0.909, lr=5e-5] 96%|█████████▋| 131/136 [46:50<01:45, 21.10s/epoch, loss=0.176, accuracy=0.981, val_loss=0.406, val_accuracy=0.909, lr=5e-5] 97%|█████████▋| 132/136 [47:11<01:24, 21.13s/epoch, loss=0.173, accuracy=0.982, val_loss=0.406, val_accuracy=0.908, lr=5e-5] 98%|█████████▊| 133/136 [47:32<01:03, 21.18s/epoch, loss=0.174, accuracy=0.981, val_loss=0.405, val_accuracy=0.908, lr=5e-5] 99%|█████████▊| 134/136 [47:53<00:42, 21.17s/epoch, loss=0.173, accuracy=0.982, val_loss=0.407, val_accuracy=0.908, lr=5e-5] 99%|█████████▉| 135/136 [48:15<00:21, 21.21s/epoch, loss=0.173, accuracy=0.982, val_loss=0.408, val_accuracy=0.907, lr=5e-5]100%|██████████| 136/136 [48:36<00:00, 21.18s/epoch, loss=0.172, accuracy=0.982, val_loss=0.408, val_accuracy=0.908, lr=5e-5]100%|██████████| 136/136 [48:36<00:00, 21.44s/epoch, loss=0.172, accuracy=0.982, val_loss=0.408, val_accuracy=0.908, lr=5e-5]
Using real-time data augmentation.
Only one model saved

Loading model: 11_03_cifar10_ResNet20v1.h5
Test score: 0.4082695543766022
Test accuracy: 0.9077000021934509


* * * Run SGD for ID = 11_4. * * *


2024-03-13 00:39:37.118083: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 00:39:39.402808: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 00:39:39.403795: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-13 00:39:39.440665: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-03-13 00:39:39.440697: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 00:39:39.443107: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 00:39:39.443144: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 00:39:39.445235: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 00:39:39.445783: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 00:39:39.447896: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 00:39:39.449186: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 00:39:39.453420: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 00:39:39.453881: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 00:39:39.453963: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 00:39:40.625165: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-13 00:39:40.625710: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 00:39:40.626164: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-03-13 00:39:40.626194: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 00:39:40.626226: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 00:39:40.626242: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 00:39:40.626274: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 00:39:40.626288: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 00:39:40.626302: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 00:39:40.626317: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 00:39:40.626337: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 00:39:40.626730: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 00:39:40.626762: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 00:39:41.203942: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-13 00:39:41.204032: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-13 00:39:41.204045: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-13 00:39:41.205190: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11227 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN X (Pascal), pci bus id: 0000:03:00.0, compute capability: 6.1)
{'id': '11_04', 'seed': 4, 'out_folder': 'results/epoch_budget_2', 'batch_size': 128, 'epochs': 136, 'validation_split': 0.0, 'checkpointing': False, 'checkpoint_every': -1, 'hold_out_validation_split': 0.0, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'num_classes': 10, 'SSE_lr': False, 'test_time_augmentation': False, 'debug': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN X (Pascal)'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
y_train shape: (50000, 10)
x_val shape: (10000, 32, 32, 3)
y_val shape: (10000, 10)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/136 [00:00<?, ?epoch/s]2024-03-13 00:39:41.783165: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-13 00:39:41.795087: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2600020000 Hz
2024-03-13 00:39:43.692143: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 00:39:43.920991: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 00:39:44.592519: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-13 00:39:44.644806: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/136 [00:59<2:14:35, 59.82s/epoch, loss=2.82, accuracy=0.393, val_loss=2.26, val_accuracy=0.353, lr=0.1]  1%|▏         | 2/136 [01:22<1:24:19, 37.76s/epoch, loss=1.46, accuracy=0.603, val_loss=2.52, val_accuracy=0.359, lr=0.1]  2%|▏         | 3/136 [01:44<1:08:08, 30.74s/epoch, loss=1.29, accuracy=0.675, val_loss=2.23, val_accuracy=0.397, lr=0.1]  3%|▎         | 4/136 [02:06<1:00:15, 27.39s/epoch, loss=1.25, accuracy=0.7, val_loss=3.17, val_accuracy=0.399, lr=0.1]    4%|▎         | 5/136 [02:29<55:47, 25.56s/epoch, loss=1.23, accuracy=0.711, val_loss=1.93, val_accuracy=0.505, lr=0.1]  4%|▍         | 6/136 [02:51<52:51, 24.40s/epoch, loss=1.21, accuracy=0.721, val_loss=3.36, val_accuracy=0.325, lr=0.1]  5%|▌         | 7/136 [03:13<50:45, 23.61s/epoch, loss=1.2, accuracy=0.727, val_loss=2.95, val_accuracy=0.387, lr=0.1]   6%|▌         | 8/136 [03:35<49:24, 23.16s/epoch, loss=1.2, accuracy=0.73, val_loss=6.54, val_accuracy=0.133, lr=0.1]   7%|▋         | 9/136 [03:57<48:23, 22.86s/epoch, loss=1.19, accuracy=0.736, val_loss=2.88, val_accuracy=0.345, lr=0.1]  7%|▋         | 10/136 [04:19<47:38, 22.68s/epoch, loss=1.19, accuracy=0.734, val_loss=1.92, val_accuracy=0.506, lr=0.1]  8%|▊         | 11/136 [04:42<46:57, 22.54s/epoch, loss=1.18, accuracy=0.738, val_loss=2.22, val_accuracy=0.474, lr=0.1]  9%|▉         | 12/136 [05:04<46:22, 22.44s/epoch, loss=1.18, accuracy=0.741, val_loss=1.82, val_accuracy=0.521, lr=0.1] 10%|▉         | 13/136 [05:26<45:33, 22.22s/epoch, loss=1.17, accuracy=0.743, val_loss=1.96, val_accuracy=0.473, lr=0.1] 10%|█         | 14/136 [05:47<44:53, 22.08s/epoch, loss=1.17, accuracy=0.741, val_loss=1.86, val_accuracy=0.511, lr=0.1] 11%|█         | 15/136 [06:09<44:34, 22.11s/epoch, loss=1.17, accuracy=0.744, val_loss=1.99, val_accuracy=0.492, lr=0.1] 12%|█▏        | 16/136 [06:32<44:10, 22.09s/epoch, loss=1.17, accuracy=0.743, val_loss=3.11, val_accuracy=0.282, lr=0.1] 12%|█▎        | 17/136 [06:54<43:52, 22.12s/epoch, loss=1.16, accuracy=0.745, val_loss=2.39, val_accuracy=0.474, lr=0.1] 13%|█▎        | 18/136 [07:16<43:27, 22.10s/epoch, loss=1.16, accuracy=0.748, val_loss=2.12, val_accuracy=0.446, lr=0.1] 14%|█▍        | 19/136 [07:38<42:53, 21.99s/epoch, loss=1.17, accuracy=0.746, val_loss=2.53, val_accuracy=0.366, lr=0.1] 15%|█▍        | 20/136 [07:59<42:28, 21.97s/epoch, loss=1.16, accuracy=0.746, val_loss=1.64, val_accuracy=0.593, lr=0.1] 15%|█▌        | 21/136 [08:22<42:16, 22.06s/epoch, loss=1.16, accuracy=0.748, val_loss=2.09, val_accuracy=0.496, lr=0.1] 16%|█▌        | 22/136 [08:44<42:02, 22.13s/epoch, loss=1.16, accuracy=0.749, val_loss=2.25, val_accuracy=0.429, lr=0.1] 17%|█▋        | 23/136 [09:06<41:43, 22.16s/epoch, loss=1.16, accuracy=0.747, val_loss=2, val_accuracy=0.521, lr=0.1]    18%|█▊        | 24/136 [09:28<41:24, 22.18s/epoch, loss=1.15, accuracy=0.751, val_loss=1.57, val_accuracy=0.62, lr=0.1] 18%|█▊        | 25/136 [09:50<40:54, 22.12s/epoch, loss=1.15, accuracy=0.753, val_loss=2.02, val_accuracy=0.481, lr=0.1] 19%|█▉        | 26/136 [10:12<40:04, 21.86s/epoch, loss=1.14, accuracy=0.751, val_loss=1.99, val_accuracy=0.47, lr=0.1]  20%|█▉        | 27/136 [10:34<39:43, 21.86s/epoch, loss=1.15, accuracy=0.753, val_loss=3.29, val_accuracy=0.261, lr=0.1] 21%|██        | 28/136 [10:56<39:26, 21.92s/epoch, loss=1.15, accuracy=0.752, val_loss=3.38, val_accuracy=0.347, lr=0.1] 21%|██▏       | 29/136 [11:17<39:04, 21.91s/epoch, loss=1.15, accuracy=0.751, val_loss=1.96, val_accuracy=0.517, lr=0.1] 22%|██▏       | 30/136 [11:39<38:34, 21.84s/epoch, loss=1.14, accuracy=0.755, val_loss=2.87, val_accuracy=0.329, lr=0.1] 23%|██▎       | 31/136 [12:01<38:20, 21.91s/epoch, loss=1.14, accuracy=0.753, val_loss=2.09, val_accuracy=0.489, lr=0.1] 24%|██▎       | 32/136 [12:23<38:00, 21.92s/epoch, loss=1.14, accuracy=0.753, val_loss=1.97, val_accuracy=0.426, lr=0.1] 24%|██▍       | 33/136 [12:45<37:44, 21.98s/epoch, loss=1.14, accuracy=0.753, val_loss=8.41, val_accuracy=0.135, lr=0.1] 25%|██▌       | 34/136 [13:07<37:26, 22.03s/epoch, loss=1.14, accuracy=0.756, val_loss=1.86, val_accuracy=0.508, lr=0.1] 26%|██▌       | 35/136 [13:30<37:06, 22.05s/epoch, loss=1.14, accuracy=0.754, val_loss=2.25, val_accuracy=0.434, lr=0.1] 26%|██▋       | 36/136 [13:52<36:46, 22.06s/epoch, loss=1.14, accuracy=0.754, val_loss=2.24, val_accuracy=0.499, lr=0.1] 27%|██▋       | 37/136 [14:14<36:26, 22.09s/epoch, loss=1.14, accuracy=0.755, val_loss=2.1, val_accuracy=0.517, lr=0.1]  28%|██▊       | 38/136 [14:36<36:04, 22.09s/epoch, loss=1.13, accuracy=0.756, val_loss=1.81, val_accuracy=0.542, lr=0.1] 29%|██▊       | 39/136 [14:57<35:10, 21.76s/epoch, loss=1.14, accuracy=0.753, val_loss=3.27, val_accuracy=0.307, lr=0.1] 29%|██▉       | 40/136 [15:18<34:32, 21.59s/epoch, loss=1.13, accuracy=0.757, val_loss=1.78, val_accuracy=0.577, lr=0.1] 30%|███       | 41/136 [15:40<34:10, 21.59s/epoch, loss=1.12, accuracy=0.758, val_loss=2.06, val_accuracy=0.484, lr=0.1] 31%|███       | 42/136 [16:02<34:08, 21.79s/epoch, loss=1.13, accuracy=0.756, val_loss=2.1, val_accuracy=0.471, lr=0.1]  32%|███▏      | 43/136 [16:24<33:58, 21.92s/epoch, loss=1.14, accuracy=0.755, val_loss=1.88, val_accuracy=0.497, lr=0.1] 32%|███▏      | 44/136 [16:46<33:47, 22.04s/epoch, loss=1.12, accuracy=0.757, val_loss=6.84, val_accuracy=0.198, lr=0.1] 33%|███▎      | 45/136 [17:09<33:32, 22.11s/epoch, loss=1.14, accuracy=0.755, val_loss=11, val_accuracy=0.164, lr=0.1]   34%|███▍      | 46/136 [17:31<33:06, 22.07s/epoch, loss=1.12, accuracy=0.756, val_loss=2.18, val_accuracy=0.486, lr=0.1] 35%|███▍      | 47/136 [17:53<32:42, 22.05s/epoch, loss=1.13, accuracy=0.756, val_loss=2.5, val_accuracy=0.394, lr=0.1]  35%|███▌      | 48/136 [18:15<32:27, 22.13s/epoch, loss=1.12, accuracy=0.759, val_loss=3.29, val_accuracy=0.317, lr=0.1] 36%|███▌      | 49/136 [18:37<32:02, 22.10s/epoch, loss=1.12, accuracy=0.758, val_loss=1.62, val_accuracy=0.59, lr=0.1]  37%|███▋      | 50/136 [18:59<31:38, 22.07s/epoch, loss=1.12, accuracy=0.759, val_loss=3.18, val_accuracy=0.404, lr=0.1] 38%|███▊      | 51/136 [19:21<31:17, 22.09s/epoch, loss=1.12, accuracy=0.757, val_loss=1.83, val_accuracy=0.498, lr=0.1] 38%|███▊      | 52/136 [19:43<30:57, 22.11s/epoch, loss=1.13, accuracy=0.758, val_loss=1.92, val_accuracy=0.499, lr=0.1] 39%|███▉      | 53/136 [20:05<30:25, 22.00s/epoch, loss=1.12, accuracy=0.756, val_loss=2.44, val_accuracy=0.4, lr=0.1]   40%|███▉      | 54/136 [20:26<29:28, 21.57s/epoch, loss=1.12, accuracy=0.759, val_loss=2.04, val_accuracy=0.516, lr=0.1] 40%|████      | 55/136 [20:48<29:23, 21.78s/epoch, loss=1.12, accuracy=0.756, val_loss=1.82, val_accuracy=0.547, lr=0.1] 41%|████      | 56/136 [21:10<29:13, 21.92s/epoch, loss=0.916, accuracy=0.814, val_loss=0.903, val_accuracy=0.803, lr=0.01] 42%|████▏     | 57/136 [21:32<29:01, 22.04s/epoch, loss=0.732, accuracy=0.848, val_loss=0.947, val_accuracy=0.762, lr=0.01] 43%|████▎     | 58/136 [21:54<28:37, 22.02s/epoch, loss=0.65, accuracy=0.857, val_loss=0.828, val_accuracy=0.801, lr=0.01]  43%|████▎     | 59/136 [22:16<27:59, 21.81s/epoch, loss=0.603, accuracy=0.862, val_loss=0.672, val_accuracy=0.839, lr=0.01] 44%|████▍     | 60/136 [22:38<27:47, 21.95s/epoch, loss=0.579, accuracy=0.863, val_loss=0.784, val_accuracy=0.799, lr=0.01] 45%|████▍     | 61/136 [23:00<27:31, 22.02s/epoch, loss=0.569, accuracy=0.865, val_loss=0.697, val_accuracy=0.818, lr=0.01] 46%|████▌     | 62/136 [23:22<27:13, 22.07s/epoch, loss=0.562, accuracy=0.865, val_loss=1.03, val_accuracy=0.73, lr=0.01]   46%|████▋     | 63/136 [23:44<26:44, 21.97s/epoch, loss=0.558, accuracy=0.866, val_loss=0.713, val_accuracy=0.817, lr=0.01] 47%|████▋     | 64/136 [24:06<26:16, 21.89s/epoch, loss=0.559, accuracy=0.867, val_loss=0.923, val_accuracy=0.75, lr=0.01]  48%|████▊     | 65/136 [24:28<26:00, 21.98s/epoch, loss=0.556, accuracy=0.87, val_loss=0.839, val_accuracy=0.781, lr=0.01] 49%|████▊     | 66/136 [24:50<25:42, 22.04s/epoch, loss=0.557, accuracy=0.87, val_loss=0.871, val_accuracy=0.776, lr=0.01] 49%|████▉     | 67/136 [25:12<25:18, 22.01s/epoch, loss=0.556, accuracy=0.872, val_loss=0.775, val_accuracy=0.808, lr=0.01] 50%|█████     | 68/136 [25:34<24:58, 22.04s/epoch, loss=0.552, accuracy=0.874, val_loss=0.736, val_accuracy=0.817, lr=0.01] 51%|█████     | 69/136 [25:56<24:33, 21.99s/epoch, loss=0.551, accuracy=0.876, val_loss=1.19, val_accuracy=0.711, lr=0.01]  51%|█████▏    | 70/136 [26:18<24:08, 21.95s/epoch, loss=0.552, accuracy=0.876, val_loss=0.802, val_accuracy=0.792, lr=0.01] 52%|█████▏    | 71/136 [26:40<23:47, 21.96s/epoch, loss=0.555, accuracy=0.876, val_loss=0.837, val_accuracy=0.785, lr=0.01] 53%|█████▎    | 72/136 [27:02<23:22, 21.92s/epoch, loss=0.551, accuracy=0.879, val_loss=0.859, val_accuracy=0.789, lr=0.01] 54%|█████▎    | 73/136 [27:24<23:05, 22.00s/epoch, loss=0.552, accuracy=0.878, val_loss=0.734, val_accuracy=0.83, lr=0.01]  54%|█████▍    | 74/136 [27:46<22:44, 22.01s/epoch, loss=0.551, accuracy=0.881, val_loss=0.79, val_accuracy=0.805, lr=0.01] 55%|█████▌    | 75/136 [28:08<22:27, 22.09s/epoch, loss=0.549, accuracy=0.881, val_loss=0.706, val_accuracy=0.828, lr=0.01] 56%|█████▌    | 76/136 [28:31<22:08, 22.14s/epoch, loss=0.554, accuracy=0.878, val_loss=0.828, val_accuracy=0.796, lr=0.01] 57%|█████▋    | 77/136 [28:53<21:50, 22.21s/epoch, loss=0.554, accuracy=0.879, val_loss=0.766, val_accuracy=0.813, lr=0.01] 57%|█████▋    | 78/136 [29:15<21:30, 22.25s/epoch, loss=0.552, accuracy=0.881, val_loss=0.784, val_accuracy=0.806, lr=0.01] 58%|█████▊    | 79/136 [29:38<21:08, 22.25s/epoch, loss=0.545, accuracy=0.883, val_loss=1.02, val_accuracy=0.746, lr=0.01]  59%|█████▉    | 80/136 [30:00<20:45, 22.25s/epoch, loss=0.549, accuracy=0.884, val_loss=1.12, val_accuracy=0.717, lr=0.01] 60%|█████▉    | 81/136 [30:22<20:20, 22.20s/epoch, loss=0.554, accuracy=0.883, val_loss=0.707, val_accuracy=0.839, lr=0.01] 60%|██████    | 82/136 [30:44<19:57, 22.18s/epoch, loss=0.55, accuracy=0.883, val_loss=1.02, val_accuracy=0.761, lr=0.01]   61%|██████    | 83/136 [31:06<19:33, 22.15s/epoch, loss=0.473, accuracy=0.912, val_loss=0.529, val_accuracy=0.893, lr=0.001] 62%|██████▏   | 84/136 [31:28<19:07, 22.07s/epoch, loss=0.422, accuracy=0.928, val_loss=0.517, val_accuracy=0.894, lr=0.001] 62%|██████▎   | 85/136 [31:50<18:40, 21.98s/epoch, loss=0.4, accuracy=0.934, val_loss=0.508, val_accuracy=0.896, lr=0.001]   63%|██████▎   | 86/136 [32:12<18:22, 22.04s/epoch, loss=0.384, accuracy=0.938, val_loss=0.493, val_accuracy=0.898, lr=0.001] 64%|██████▍   | 87/136 [32:34<18:01, 22.06s/epoch, loss=0.371, accuracy=0.939, val_loss=0.49, val_accuracy=0.895, lr=0.001]  65%|██████▍   | 88/136 [32:56<17:37, 22.04s/epoch, loss=0.358, accuracy=0.944, val_loss=0.487, val_accuracy=0.898, lr=0.001] 65%|██████▌   | 89/136 [33:18<17:13, 21.99s/epoch, loss=0.346, accuracy=0.944, val_loss=0.49, val_accuracy=0.899, lr=0.001]  66%|██████▌   | 90/136 [33:40<16:53, 22.03s/epoch, loss=0.337, accuracy=0.945, val_loss=0.473, val_accuracy=0.903, lr=0.001] 67%|██████▋   | 91/136 [34:01<16:20, 21.78s/epoch, loss=0.327, accuracy=0.947, val_loss=0.48, val_accuracy=0.897, lr=0.001]  68%|██████▊   | 92/136 [34:23<16:00, 21.83s/epoch, loss=0.321, accuracy=0.948, val_loss=0.476, val_accuracy=0.901, lr=0.001] 68%|██████▊   | 93/136 [34:45<15:43, 21.94s/epoch, loss=0.313, accuracy=0.95, val_loss=0.461, val_accuracy=0.902, lr=0.001]  69%|██████▉   | 94/136 [35:06<15:10, 21.68s/epoch, loss=0.305, accuracy=0.95, val_loss=0.464, val_accuracy=0.901, lr=0.001] 70%|██████▉   | 95/136 [35:29<14:54, 21.82s/epoch, loss=0.295, accuracy=0.953, val_loss=0.465, val_accuracy=0.903, lr=0.001] 71%|███████   | 96/136 [35:51<14:35, 21.89s/epoch, loss=0.291, accuracy=0.953, val_loss=0.475, val_accuracy=0.896, lr=0.001] 71%|███████▏  | 97/136 [36:13<14:14, 21.91s/epoch, loss=0.283, accuracy=0.954, val_loss=0.477, val_accuracy=0.899, lr=0.001] 72%|███████▏  | 98/136 [36:34<13:52, 21.91s/epoch, loss=0.276, accuracy=0.957, val_loss=0.458, val_accuracy=0.899, lr=0.001] 73%|███████▎  | 99/136 [36:56<13:31, 21.93s/epoch, loss=0.273, accuracy=0.956, val_loss=0.472, val_accuracy=0.896, lr=0.001] 74%|███████▎  | 100/136 [37:18<13:06, 21.85s/epoch, loss=0.266, accuracy=0.957, val_loss=0.465, val_accuracy=0.899, lr=0.001] 74%|███████▍  | 101/136 [37:40<12:42, 21.78s/epoch, loss=0.262, accuracy=0.957, val_loss=0.475, val_accuracy=0.896, lr=0.001] 75%|███████▌  | 102/136 [38:01<12:12, 21.55s/epoch, loss=0.257, accuracy=0.958, val_loss=0.455, val_accuracy=0.899, lr=0.001] 76%|███████▌  | 103/136 [38:23<11:54, 21.66s/epoch, loss=0.252, accuracy=0.959, val_loss=0.461, val_accuracy=0.9, lr=0.001]   76%|███████▋  | 104/136 [38:45<11:38, 21.83s/epoch, loss=0.249, accuracy=0.96, val_loss=0.473, val_accuracy=0.893, lr=0.001] 77%|███████▋  | 105/136 [39:07<11:17, 21.84s/epoch, loss=0.246, accuracy=0.958, val_loss=0.481, val_accuracy=0.892, lr=0.001] 78%|███████▊  | 106/136 [39:28<10:53, 21.77s/epoch, loss=0.243, accuracy=0.959, val_loss=0.464, val_accuracy=0.894, lr=0.001] 79%|███████▊  | 107/136 [39:50<10:33, 21.86s/epoch, loss=0.241, accuracy=0.959, val_loss=0.477, val_accuracy=0.896, lr=0.001] 79%|███████▉  | 108/136 [40:12<10:12, 21.86s/epoch, loss=0.235, accuracy=0.961, val_loss=0.465, val_accuracy=0.895, lr=0.001] 80%|████████  | 109/136 [40:34<09:52, 21.95s/epoch, loss=0.233, accuracy=0.961, val_loss=0.481, val_accuracy=0.889, lr=0.001] 81%|████████  | 110/136 [40:56<09:28, 21.88s/epoch, loss=0.217, accuracy=0.967, val_loss=0.419, val_accuracy=0.907, lr=1e-04] 82%|████████▏ | 111/136 [41:18<09:06, 21.86s/epoch, loss=0.207, accuracy=0.971, val_loss=0.414, val_accuracy=0.907, lr=1e-04] 82%|████████▏ | 112/136 [41:40<08:45, 21.91s/epoch, loss=0.2, accuracy=0.974, val_loss=0.416, val_accuracy=0.908, lr=1e-04]   83%|████████▎ | 113/136 [42:02<08:23, 21.91s/epoch, loss=0.198, accuracy=0.974, val_loss=0.415, val_accuracy=0.908, lr=1e-04] 84%|████████▍ | 114/136 [42:23<07:59, 21.81s/epoch, loss=0.195, accuracy=0.976, val_loss=0.413, val_accuracy=0.91, lr=1e-04]  85%|████████▍ | 115/136 [42:45<07:39, 21.86s/epoch, loss=0.195, accuracy=0.975, val_loss=0.413, val_accuracy=0.909, lr=1e-04] 85%|████████▌ | 116/136 [43:07<07:13, 21.66s/epoch, loss=0.194, accuracy=0.975, val_loss=0.413, val_accuracy=0.91, lr=1e-04]  86%|████████▌ | 117/136 [43:29<06:52, 21.72s/epoch, loss=0.191, accuracy=0.976, val_loss=0.414, val_accuracy=0.91, lr=1e-04] 87%|████████▋ | 118/136 [43:51<06:32, 21.80s/epoch, loss=0.188, accuracy=0.978, val_loss=0.415, val_accuracy=0.91, lr=1e-04] 88%|████████▊ | 119/136 [44:12<06:09, 21.75s/epoch, loss=0.188, accuracy=0.978, val_loss=0.415, val_accuracy=0.91, lr=1e-04] 88%|████████▊ | 120/136 [44:34<05:48, 21.79s/epoch, loss=0.188, accuracy=0.977, val_loss=0.414, val_accuracy=0.909, lr=1e-04] 89%|████████▉ | 121/136 [44:56<05:26, 21.76s/epoch, loss=0.184, accuracy=0.978, val_loss=0.416, val_accuracy=0.908, lr=1e-04] 90%|████████▉ | 122/136 [45:17<05:03, 21.68s/epoch, loss=0.185, accuracy=0.979, val_loss=0.415, val_accuracy=0.911, lr=1e-04] 90%|█████████ | 123/136 [45:39<04:41, 21.68s/epoch, loss=0.185, accuracy=0.978, val_loss=0.415, val_accuracy=0.91, lr=1e-04]  91%|█████████ | 124/136 [46:00<04:19, 21.61s/epoch, loss=0.182, accuracy=0.979, val_loss=0.417, val_accuracy=0.909, lr=5e-5] 92%|█████████▏| 125/136 [46:21<03:55, 21.45s/epoch, loss=0.182, accuracy=0.979, val_loss=0.415, val_accuracy=0.909, lr=5e-5] 93%|█████████▎| 126/136 [46:43<03:35, 21.59s/epoch, loss=0.18, accuracy=0.98, val_loss=0.416, val_accuracy=0.91, lr=5e-5]    93%|█████████▎| 127/136 [47:05<03:15, 21.67s/epoch, loss=0.18, accuracy=0.98, val_loss=0.415, val_accuracy=0.91, lr=5e-5] 94%|█████████▍| 128/136 [47:27<02:53, 21.69s/epoch, loss=0.18, accuracy=0.98, val_loss=0.416, val_accuracy=0.91, lr=5e-5] 95%|█████████▍| 129/136 [47:49<02:32, 21.75s/epoch, loss=0.18, accuracy=0.98, val_loss=0.418, val_accuracy=0.91, lr=5e-5] 96%|█████████▌| 130/136 [48:11<02:10, 21.76s/epoch, loss=0.177, accuracy=0.98, val_loss=0.417, val_accuracy=0.909, lr=5e-5] 96%|█████████▋| 131/136 [48:32<01:48, 21.69s/epoch, loss=0.178, accuracy=0.982, val_loss=0.417, val_accuracy=0.91, lr=5e-5] 97%|█████████▋| 132/136 [48:53<01:26, 21.54s/epoch, loss=0.177, accuracy=0.98, val_loss=0.418, val_accuracy=0.91, lr=5e-5]  98%|█████████▊| 133/136 [49:14<01:04, 21.42s/epoch, loss=0.178, accuracy=0.981, val_loss=0.417, val_accuracy=0.909, lr=5e-5] 99%|█████████▊| 134/136 [49:36<00:42, 21.37s/epoch, loss=0.178, accuracy=0.981, val_loss=0.416, val_accuracy=0.91, lr=5e-5]  99%|█████████▉| 135/136 [49:57<00:21, 21.46s/epoch, loss=0.177, accuracy=0.981, val_loss=0.419, val_accuracy=0.909, lr=5e-5]100%|██████████| 136/136 [50:18<00:00, 21.34s/epoch, loss=0.177, accuracy=0.981, val_loss=0.419, val_accuracy=0.91, lr=5e-5] 100%|██████████| 136/136 [50:18<00:00, 22.20s/epoch, loss=0.177, accuracy=0.981, val_loss=0.419, val_accuracy=0.91, lr=5e-5]
Using real-time data augmentation.
Only one model saved

Loading model: 11_04_cifar10_ResNet20v1.h5
Test score: 0.4186801612377167
Test accuracy: 0.9096999764442444


* * * Run SGD for ID = 11_5. * * *


2024-03-13 01:30:04.640452: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 01:30:06.873330: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 01:30:06.874304: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-13 01:30:06.911443: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-03-13 01:30:06.911472: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 01:30:06.913910: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 01:30:06.913947: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 01:30:06.916127: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 01:30:06.916676: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 01:30:06.918940: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 01:30:06.920253: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 01:30:06.924570: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 01:30:06.925067: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 01:30:06.925136: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 01:30:08.082132: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-13 01:30:08.083163: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 01:30:08.083589: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-03-13 01:30:08.083619: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 01:30:08.083672: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 01:30:08.083688: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 01:30:08.083703: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 01:30:08.083717: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 01:30:08.083731: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 01:30:08.083744: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 01:30:08.083759: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 01:30:08.084224: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 01:30:08.084271: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 01:30:08.667496: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-13 01:30:08.667562: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-13 01:30:08.667573: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-13 01:30:08.668784: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11227 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN X (Pascal), pci bus id: 0000:03:00.0, compute capability: 6.1)
{'id': '11_05', 'seed': 5, 'out_folder': 'results/epoch_budget_2', 'batch_size': 128, 'epochs': 136, 'validation_split': 0.0, 'checkpointing': False, 'checkpoint_every': -1, 'hold_out_validation_split': 0.0, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'num_classes': 10, 'SSE_lr': False, 'test_time_augmentation': False, 'debug': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN X (Pascal)'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
y_train shape: (50000, 10)
x_val shape: (10000, 32, 32, 3)
y_val shape: (10000, 10)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/136 [00:00<?, ?epoch/s]2024-03-13 01:30:09.256880: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-13 01:30:09.269072: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2600020000 Hz
2024-03-13 01:30:11.147133: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 01:30:11.421421: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 01:30:12.259483: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-13 01:30:12.317516: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/136 [00:59<2:14:29, 59.77s/epoch, loss=3.06, accuracy=0.3, val_loss=3.27, val_accuracy=0.123, lr=0.1]  1%|▏         | 2/136 [01:21<1:23:22, 37.33s/epoch, loss=1.55, accuracy=0.538, val_loss=3.12, val_accuracy=0.258, lr=0.1]  2%|▏         | 3/136 [01:43<1:06:57, 30.20s/epoch, loss=1.35, accuracy=0.639, val_loss=1.74, val_accuracy=0.507, lr=0.1]  3%|▎         | 4/136 [02:04<59:07, 26.88s/epoch, loss=1.27, accuracy=0.681, val_loss=1.44, val_accuracy=0.636, lr=0.1]    4%|▎         | 5/136 [02:26<54:11, 24.82s/epoch, loss=1.25, accuracy=0.699, val_loss=1.95, val_accuracy=0.491, lr=0.1]  4%|▍         | 6/136 [02:47<51:31, 23.78s/epoch, loss=1.24, accuracy=0.711, val_loss=1.8, val_accuracy=0.541, lr=0.1]   5%|▌         | 7/136 [03:09<49:36, 23.08s/epoch, loss=1.22, accuracy=0.72, val_loss=3.01, val_accuracy=0.375, lr=0.1]  6%|▌         | 8/136 [03:31<48:17, 22.64s/epoch, loss=1.22, accuracy=0.724, val_loss=2.13, val_accuracy=0.444, lr=0.1]  7%|▋         | 9/136 [03:52<47:10, 22.29s/epoch, loss=1.21, accuracy=0.728, val_loss=1.62, val_accuracy=0.576, lr=0.1]  7%|▋         | 10/136 [04:14<46:25, 22.10s/epoch, loss=1.2, accuracy=0.731, val_loss=1.4, val_accuracy=0.646, lr=0.1]   8%|▊         | 11/136 [04:35<45:39, 21.91s/epoch, loss=1.19, accuracy=0.733, val_loss=1.6, val_accuracy=0.598, lr=0.1]  9%|▉         | 12/136 [04:57<45:05, 21.82s/epoch, loss=1.18, accuracy=0.738, val_loss=1.74, val_accuracy=0.594, lr=0.1] 10%|▉         | 13/136 [05:18<44:31, 21.72s/epoch, loss=1.18, accuracy=0.739, val_loss=2.66, val_accuracy=0.454, lr=0.1] 10%|█         | 14/136 [05:39<43:44, 21.51s/epoch, loss=1.18, accuracy=0.738, val_loss=1.68, val_accuracy=0.599, lr=0.1] 11%|█         | 15/136 [06:01<43:09, 21.40s/epoch, loss=1.18, accuracy=0.741, val_loss=1.74, val_accuracy=0.541, lr=0.1] 12%|█▏        | 16/136 [06:22<42:56, 21.47s/epoch, loss=1.17, accuracy=0.742, val_loss=1.7, val_accuracy=0.585, lr=0.1]  12%|█▎        | 17/136 [06:44<42:39, 21.51s/epoch, loss=1.16, accuracy=0.747, val_loss=1.88, val_accuracy=0.496, lr=0.1] 13%|█▎        | 18/136 [07:06<42:25, 21.57s/epoch, loss=1.16, accuracy=0.746, val_loss=1.81, val_accuracy=0.554, lr=0.1] 14%|█▍        | 19/136 [07:27<42:12, 21.65s/epoch, loss=1.16, accuracy=0.748, val_loss=2.05, val_accuracy=0.54, lr=0.1]  15%|█▍        | 20/136 [07:49<41:56, 21.69s/epoch, loss=1.16, accuracy=0.746, val_loss=1.57, val_accuracy=0.614, lr=0.1] 15%|█▌        | 21/136 [08:11<41:37, 21.72s/epoch, loss=1.15, accuracy=0.75, val_loss=1.99, val_accuracy=0.577, lr=0.1]  16%|█▌        | 22/136 [08:32<40:58, 21.57s/epoch, loss=1.15, accuracy=0.747, val_loss=2.12, val_accuracy=0.464, lr=0.1] 17%|█▋        | 23/136 [08:54<40:43, 21.62s/epoch, loss=1.15, accuracy=0.749, val_loss=1.93, val_accuracy=0.543, lr=0.1] 18%|█▊        | 24/136 [09:15<40:16, 21.58s/epoch, loss=1.15, accuracy=0.748, val_loss=2.32, val_accuracy=0.414, lr=0.1] 18%|█▊        | 25/136 [09:37<39:53, 21.56s/epoch, loss=1.14, accuracy=0.753, val_loss=3.23, val_accuracy=0.327, lr=0.1] 19%|█▉        | 26/136 [09:58<39:28, 21.53s/epoch, loss=1.15, accuracy=0.752, val_loss=1.55, val_accuracy=0.61, lr=0.1]  20%|█▉        | 27/136 [10:20<39:09, 21.56s/epoch, loss=1.15, accuracy=0.751, val_loss=1.99, val_accuracy=0.552, lr=0.1] 21%|██        | 28/136 [10:42<38:55, 21.62s/epoch, loss=1.14, accuracy=0.754, val_loss=1.93, val_accuracy=0.52, lr=0.1]  21%|██▏       | 29/136 [11:04<38:37, 21.66s/epoch, loss=1.15, accuracy=0.749, val_loss=1.45, val_accuracy=0.648, lr=0.1] 22%|██▏       | 30/136 [11:25<38:14, 21.65s/epoch, loss=1.15, accuracy=0.752, val_loss=1.71, val_accuracy=0.538, lr=0.1] 23%|██▎       | 31/136 [11:46<37:40, 21.53s/epoch, loss=1.14, accuracy=0.752, val_loss=2.06, val_accuracy=0.487, lr=0.1] 24%|██▎       | 32/136 [12:08<37:14, 21.48s/epoch, loss=1.14, accuracy=0.754, val_loss=1.89, val_accuracy=0.571, lr=0.1] 24%|██▍       | 33/136 [12:29<36:37, 21.33s/epoch, loss=1.14, accuracy=0.754, val_loss=1.67, val_accuracy=0.556, lr=0.1] 25%|██▌       | 34/136 [12:50<36:23, 21.41s/epoch, loss=1.14, accuracy=0.754, val_loss=1.86, val_accuracy=0.572, lr=0.1] 26%|██▌       | 35/136 [13:12<36:13, 21.52s/epoch, loss=1.14, accuracy=0.753, val_loss=1.71, val_accuracy=0.618, lr=0.1] 26%|██▋       | 36/136 [13:33<35:21, 21.22s/epoch, loss=1.13, accuracy=0.752, val_loss=1.37, val_accuracy=0.663, lr=0.1] 27%|██▋       | 37/136 [13:54<35:13, 21.35s/epoch, loss=1.14, accuracy=0.754, val_loss=1.47, val_accuracy=0.614, lr=0.1] 28%|██▊       | 38/136 [14:16<35:07, 21.50s/epoch, loss=1.13, accuracy=0.757, val_loss=3.71, val_accuracy=0.319, lr=0.1] 29%|██▊       | 39/136 [14:38<34:44, 21.49s/epoch, loss=1.13, accuracy=0.755, val_loss=1.67, val_accuracy=0.589, lr=0.1] 29%|██▉       | 40/136 [14:59<34:32, 21.58s/epoch, loss=1.14, accuracy=0.756, val_loss=2.69, val_accuracy=0.412, lr=0.1] 30%|███       | 41/136 [15:21<34:13, 21.62s/epoch, loss=1.13, accuracy=0.756, val_loss=2.48, val_accuracy=0.415, lr=0.1] 31%|███       | 42/136 [15:43<33:57, 21.67s/epoch, loss=1.13, accuracy=0.754, val_loss=1.81, val_accuracy=0.53, lr=0.1]  32%|███▏      | 43/136 [16:05<33:38, 21.70s/epoch, loss=1.12, accuracy=0.756, val_loss=6.47, val_accuracy=0.23, lr=0.1] 32%|███▏      | 44/136 [16:26<33:19, 21.73s/epoch, loss=1.13, accuracy=0.758, val_loss=1.66, val_accuracy=0.574, lr=0.1] 33%|███▎      | 45/136 [16:48<32:53, 21.68s/epoch, loss=1.13, accuracy=0.755, val_loss=2.51, val_accuracy=0.465, lr=0.1] 34%|███▍      | 46/136 [17:10<32:30, 21.68s/epoch, loss=1.13, accuracy=0.756, val_loss=1.94, val_accuracy=0.494, lr=0.1] 35%|███▍      | 47/136 [17:31<32:04, 21.62s/epoch, loss=1.12, accuracy=0.757, val_loss=3.77, val_accuracy=0.302, lr=0.1] 35%|███▌      | 48/136 [17:53<31:39, 21.59s/epoch, loss=1.12, accuracy=0.757, val_loss=2.45, val_accuracy=0.458, lr=0.1] 36%|███▌      | 49/136 [18:14<31:09, 21.49s/epoch, loss=1.12, accuracy=0.758, val_loss=2.47, val_accuracy=0.389, lr=0.1] 37%|███▋      | 50/136 [18:36<30:53, 21.55s/epoch, loss=1.12, accuracy=0.755, val_loss=3.04, val_accuracy=0.363, lr=0.1] 38%|███▊      | 51/136 [18:57<30:31, 21.54s/epoch, loss=1.13, accuracy=0.756, val_loss=2.28, val_accuracy=0.468, lr=0.1] 38%|███▊      | 52/136 [19:19<30:10, 21.55s/epoch, loss=1.12, accuracy=0.757, val_loss=2.7, val_accuracy=0.493, lr=0.1]  39%|███▉      | 53/136 [19:40<29:52, 21.59s/epoch, loss=1.12, accuracy=0.758, val_loss=1.36, val_accuracy=0.683, lr=0.1] 40%|███▉      | 54/136 [20:01<29:13, 21.38s/epoch, loss=1.12, accuracy=0.756, val_loss=1.7, val_accuracy=0.576, lr=0.1]  40%|████      | 55/136 [20:23<28:59, 21.47s/epoch, loss=1.12, accuracy=0.757, val_loss=1.88, val_accuracy=0.531, lr=0.1] 41%|████      | 56/136 [20:45<28:53, 21.67s/epoch, loss=0.912, accuracy=0.819, val_loss=0.876, val_accuracy=0.811, lr=0.01] 42%|████▏     | 57/136 [21:07<28:32, 21.67s/epoch, loss=0.729, accuracy=0.853, val_loss=0.83, val_accuracy=0.81, lr=0.01]   43%|████▎     | 58/136 [21:29<28:17, 21.77s/epoch, loss=0.651, accuracy=0.857, val_loss=0.745, val_accuracy=0.82, lr=0.01] 43%|████▎     | 59/136 [21:51<27:58, 21.80s/epoch, loss=0.605, accuracy=0.861, val_loss=0.665, val_accuracy=0.839, lr=0.01] 44%|████▍     | 60/136 [22:12<27:35, 21.79s/epoch, loss=0.581, accuracy=0.865, val_loss=0.728, val_accuracy=0.811, lr=0.01] 45%|████▍     | 61/136 [22:34<27:05, 21.68s/epoch, loss=0.569, accuracy=0.865, val_loss=0.671, val_accuracy=0.831, lr=0.01] 46%|████▌     | 62/136 [22:55<26:32, 21.52s/epoch, loss=0.563, accuracy=0.867, val_loss=0.801, val_accuracy=0.794, lr=0.01] 46%|████▋     | 63/136 [23:17<26:14, 21.56s/epoch, loss=0.557, accuracy=0.869, val_loss=0.823, val_accuracy=0.775, lr=0.01] 47%|████▋     | 64/136 [23:38<25:47, 21.50s/epoch, loss=0.558, accuracy=0.869, val_loss=0.774, val_accuracy=0.799, lr=0.01] 48%|████▊     | 65/136 [24:00<25:28, 21.53s/epoch, loss=0.554, accuracy=0.87, val_loss=0.774, val_accuracy=0.806, lr=0.01]  49%|████▊     | 66/136 [24:22<25:14, 21.63s/epoch, loss=0.555, accuracy=0.871, val_loss=0.928, val_accuracy=0.765, lr=0.01] 49%|████▉     | 67/136 [24:43<24:49, 21.59s/epoch, loss=0.549, accuracy=0.874, val_loss=0.833, val_accuracy=0.793, lr=0.01] 50%|█████     | 68/136 [25:04<24:13, 21.37s/epoch, loss=0.555, accuracy=0.875, val_loss=0.735, val_accuracy=0.817, lr=0.01] 51%|█████     | 69/136 [25:25<23:54, 21.41s/epoch, loss=0.553, accuracy=0.874, val_loss=1.06, val_accuracy=0.733, lr=0.01]  51%|█████▏    | 70/136 [25:47<23:37, 21.48s/epoch, loss=0.55, accuracy=0.876, val_loss=1.11, val_accuracy=0.726, lr=0.01]  52%|█████▏    | 71/136 [26:09<23:18, 21.52s/epoch, loss=0.55, accuracy=0.879, val_loss=0.913, val_accuracy=0.78, lr=0.01] 53%|█████▎    | 72/136 [26:30<22:59, 21.55s/epoch, loss=0.549, accuracy=0.878, val_loss=0.856, val_accuracy=0.796, lr=0.01] 54%|█████▎    | 73/136 [26:52<22:40, 21.60s/epoch, loss=0.549, accuracy=0.879, val_loss=0.742, val_accuracy=0.818, lr=0.01] 54%|█████▍    | 74/136 [27:13<22:15, 21.54s/epoch, loss=0.552, accuracy=0.877, val_loss=0.804, val_accuracy=0.801, lr=0.01] 55%|█████▌    | 75/136 [27:35<21:55, 21.57s/epoch, loss=0.55, accuracy=0.88, val_loss=1.17, val_accuracy=0.726, lr=0.01]    56%|█████▌    | 76/136 [27:57<21:38, 21.64s/epoch, loss=0.551, accuracy=0.88, val_loss=0.956, val_accuracy=0.766, lr=0.01] 57%|█████▋    | 77/136 [28:18<21:00, 21.36s/epoch, loss=0.548, accuracy=0.881, val_loss=0.756, val_accuracy=0.814, lr=0.01] 57%|█████▋    | 78/136 [28:39<20:43, 21.44s/epoch, loss=0.547, accuracy=0.882, val_loss=0.929, val_accuracy=0.766, lr=0.01] 58%|█████▊    | 79/136 [29:01<20:29, 21.56s/epoch, loss=0.55, accuracy=0.882, val_loss=0.827, val_accuracy=0.797, lr=0.01]  59%|█████▉    | 80/136 [29:23<20:06, 21.55s/epoch, loss=0.55, accuracy=0.882, val_loss=0.862, val_accuracy=0.786, lr=0.01] 60%|█████▉    | 81/136 [29:44<19:45, 21.56s/epoch, loss=0.546, accuracy=0.884, val_loss=0.835, val_accuracy=0.801, lr=0.01] 60%|██████    | 82/136 [30:06<19:24, 21.56s/epoch, loss=0.545, accuracy=0.884, val_loss=0.85, val_accuracy=0.8, lr=0.01]    61%|██████    | 83/136 [30:27<19:05, 21.62s/epoch, loss=0.473, accuracy=0.91, val_loss=0.525, val_accuracy=0.891, lr=0.001] 62%|██████▏   | 84/136 [30:49<18:42, 21.58s/epoch, loss=0.42, accuracy=0.928, val_loss=0.515, val_accuracy=0.891, lr=0.001] 62%|██████▎   | 85/136 [31:10<18:19, 21.57s/epoch, loss=0.397, accuracy=0.933, val_loss=0.501, val_accuracy=0.897, lr=0.001] 63%|██████▎   | 86/136 [31:32<18:01, 21.63s/epoch, loss=0.382, accuracy=0.935, val_loss=0.493, val_accuracy=0.9, lr=0.001]   64%|██████▍   | 87/136 [31:54<17:42, 21.68s/epoch, loss=0.368, accuracy=0.94, val_loss=0.494, val_accuracy=0.896, lr=0.001] 65%|██████▍   | 88/136 [32:16<17:22, 21.72s/epoch, loss=0.357, accuracy=0.941, val_loss=0.487, val_accuracy=0.897, lr=0.001] 65%|██████▌   | 89/136 [32:37<16:54, 21.59s/epoch, loss=0.344, accuracy=0.945, val_loss=0.483, val_accuracy=0.9, lr=0.001]   66%|██████▌   | 90/136 [32:59<16:35, 21.65s/epoch, loss=0.338, accuracy=0.945, val_loss=0.485, val_accuracy=0.896, lr=0.001] 67%|██████▋   | 91/136 [33:20<16:12, 21.61s/epoch, loss=0.328, accuracy=0.946, val_loss=0.484, val_accuracy=0.899, lr=0.001] 68%|██████▊   | 92/136 [33:42<15:50, 21.61s/epoch, loss=0.318, accuracy=0.949, val_loss=0.486, val_accuracy=0.899, lr=0.001] 68%|██████▊   | 93/136 [34:03<15:24, 21.50s/epoch, loss=0.306, accuracy=0.952, val_loss=0.494, val_accuracy=0.893, lr=0.001] 69%|██████▉   | 94/136 [34:25<15:06, 21.58s/epoch, loss=0.303, accuracy=0.951, val_loss=0.469, val_accuracy=0.899, lr=0.001] 70%|██████▉   | 95/136 [34:47<14:43, 21.56s/epoch, loss=0.294, accuracy=0.952, val_loss=0.486, val_accuracy=0.893, lr=0.001] 71%|███████   | 96/136 [35:08<14:22, 21.55s/epoch, loss=0.289, accuracy=0.954, val_loss=0.469, val_accuracy=0.895, lr=0.001] 71%|███████▏  | 97/136 [35:30<14:00, 21.56s/epoch, loss=0.282, accuracy=0.955, val_loss=0.462, val_accuracy=0.897, lr=0.001] 72%|███████▏  | 98/136 [35:52<13:42, 21.65s/epoch, loss=0.277, accuracy=0.955, val_loss=0.462, val_accuracy=0.898, lr=0.001] 73%|███████▎  | 99/136 [36:13<13:23, 21.72s/epoch, loss=0.269, accuracy=0.957, val_loss=0.466, val_accuracy=0.894, lr=0.001] 74%|███████▎  | 100/136 [36:35<13:04, 21.78s/epoch, loss=0.265, accuracy=0.956, val_loss=0.469, val_accuracy=0.896, lr=0.001] 74%|███████▍  | 101/136 [36:57<12:43, 21.80s/epoch, loss=0.256, accuracy=0.96, val_loss=0.483, val_accuracy=0.892, lr=0.001]  75%|███████▌  | 102/136 [37:19<12:22, 21.83s/epoch, loss=0.256, accuracy=0.959, val_loss=0.489, val_accuracy=0.889, lr=0.001] 76%|███████▌  | 103/136 [37:41<11:58, 21.78s/epoch, loss=0.253, accuracy=0.958, val_loss=0.462, val_accuracy=0.893, lr=0.001] 76%|███████▋  | 104/136 [38:03<11:37, 21.80s/epoch, loss=0.248, accuracy=0.959, val_loss=0.456, val_accuracy=0.896, lr=0.001] 77%|███████▋  | 105/136 [38:24<11:14, 21.77s/epoch, loss=0.247, accuracy=0.958, val_loss=0.479, val_accuracy=0.891, lr=0.001] 78%|███████▊  | 106/136 [38:46<10:51, 21.73s/epoch, loss=0.246, accuracy=0.958, val_loss=0.485, val_accuracy=0.89, lr=0.001]  79%|███████▊  | 107/136 [39:07<10:27, 21.64s/epoch, loss=0.239, accuracy=0.961, val_loss=0.469, val_accuracy=0.891, lr=0.001] 79%|███████▉  | 108/136 [39:29<10:05, 21.61s/epoch, loss=0.238, accuracy=0.96, val_loss=0.487, val_accuracy=0.885, lr=0.001]  80%|████████  | 109/136 [39:50<09:43, 21.61s/epoch, loss=0.234, accuracy=0.96, val_loss=0.526, val_accuracy=0.878, lr=0.001] 81%|████████  | 110/136 [40:12<09:21, 21.61s/epoch, loss=0.213, accuracy=0.969, val_loss=0.422, val_accuracy=0.904, lr=1e-04] 82%|████████▏ | 111/136 [40:34<09:00, 21.61s/epoch, loss=0.203, accuracy=0.973, val_loss=0.419, val_accuracy=0.905, lr=1e-04] 82%|████████▏ | 112/136 [40:56<08:40, 21.67s/epoch, loss=0.201, accuracy=0.973, val_loss=0.42, val_accuracy=0.907, lr=1e-04]  83%|████████▎ | 113/136 [41:17<08:17, 21.65s/epoch, loss=0.197, accuracy=0.974, val_loss=0.418, val_accuracy=0.905, lr=1e-04] 84%|████████▍ | 114/136 [41:39<07:56, 21.65s/epoch, loss=0.196, accuracy=0.975, val_loss=0.417, val_accuracy=0.905, lr=1e-04] 85%|████████▍ | 115/136 [42:01<07:35, 21.70s/epoch, loss=0.194, accuracy=0.975, val_loss=0.419, val_accuracy=0.905, lr=1e-04] 85%|████████▌ | 116/136 [42:22<07:14, 21.74s/epoch, loss=0.19, accuracy=0.978, val_loss=0.419, val_accuracy=0.905, lr=1e-04]  86%|████████▌ | 117/136 [42:44<06:53, 21.74s/epoch, loss=0.191, accuracy=0.976, val_loss=0.421, val_accuracy=0.904, lr=1e-04] 87%|████████▋ | 118/136 [43:06<06:32, 21.78s/epoch, loss=0.188, accuracy=0.978, val_loss=0.42, val_accuracy=0.905, lr=1e-04]  88%|████████▊ | 119/136 [43:28<06:10, 21.79s/epoch, loss=0.187, accuracy=0.978, val_loss=0.422, val_accuracy=0.905, lr=1e-04] 88%|████████▊ | 120/136 [43:49<05:47, 21.73s/epoch, loss=0.186, accuracy=0.978, val_loss=0.421, val_accuracy=0.906, lr=1e-04] 89%|████████▉ | 121/136 [44:11<05:26, 21.77s/epoch, loss=0.186, accuracy=0.977, val_loss=0.423, val_accuracy=0.906, lr=1e-04] 90%|████████▉ | 122/136 [44:33<05:03, 21.69s/epoch, loss=0.184, accuracy=0.978, val_loss=0.419, val_accuracy=0.905, lr=1e-04] 90%|█████████ | 123/136 [44:54<04:41, 21.69s/epoch, loss=0.183, accuracy=0.978, val_loss=0.421, val_accuracy=0.905, lr=1e-04] 91%|█████████ | 124/136 [45:16<04:21, 21.76s/epoch, loss=0.182, accuracy=0.979, val_loss=0.421, val_accuracy=0.905, lr=5e-5]  92%|█████████▏| 125/136 [45:38<03:59, 21.79s/epoch, loss=0.181, accuracy=0.979, val_loss=0.421, val_accuracy=0.905, lr=5e-5] 93%|█████████▎| 126/136 [46:00<03:38, 21.83s/epoch, loss=0.18, accuracy=0.98, val_loss=0.419, val_accuracy=0.906, lr=5e-5]   93%|█████████▎| 127/136 [46:22<03:16, 21.78s/epoch, loss=0.182, accuracy=0.979, val_loss=0.42, val_accuracy=0.905, lr=5e-5] 94%|█████████▍| 128/136 [46:44<02:54, 21.82s/epoch, loss=0.18, accuracy=0.979, val_loss=0.422, val_accuracy=0.904, lr=5e-5] 95%|█████████▍| 129/136 [47:05<02:32, 21.75s/epoch, loss=0.177, accuracy=0.981, val_loss=0.421, val_accuracy=0.905, lr=5e-5] 96%|█████████▌| 130/136 [47:27<02:10, 21.76s/epoch, loss=0.178, accuracy=0.98, val_loss=0.421, val_accuracy=0.904, lr=5e-5]  96%|█████████▋| 131/136 [47:49<01:48, 21.72s/epoch, loss=0.178, accuracy=0.98, val_loss=0.421, val_accuracy=0.906, lr=5e-5] 97%|█████████▋| 132/136 [48:10<01:26, 21.71s/epoch, loss=0.175, accuracy=0.981, val_loss=0.421, val_accuracy=0.906, lr=5e-5] 98%|█████████▊| 133/136 [48:32<01:05, 21.75s/epoch, loss=0.179, accuracy=0.979, val_loss=0.421, val_accuracy=0.905, lr=5e-5] 99%|█████████▊| 134/136 [48:54<00:43, 21.71s/epoch, loss=0.176, accuracy=0.981, val_loss=0.422, val_accuracy=0.905, lr=5e-5] 99%|█████████▉| 135/136 [49:16<00:21, 21.74s/epoch, loss=0.175, accuracy=0.981, val_loss=0.42, val_accuracy=0.905, lr=5e-5] 100%|██████████| 136/136 [49:37<00:00, 21.69s/epoch, loss=0.176, accuracy=0.981, val_loss=0.423, val_accuracy=0.905, lr=5e-5]100%|██████████| 136/136 [49:37<00:00, 21.90s/epoch, loss=0.176, accuracy=0.981, val_loss=0.423, val_accuracy=0.905, lr=5e-5]
Using real-time data augmentation.
Only one model saved

Loading model: 11_05_cifar10_ResNet20v1.h5
Test score: 0.4226166009902954
Test accuracy: 0.9046000242233276


* * * Run SGD for ID = 11_6. * * *


2024-03-13 02:19:50.956682: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 02:19:53.839553: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 02:19:53.840544: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-13 02:19:53.877849: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-03-13 02:19:53.877873: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 02:19:53.881139: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 02:19:53.881177: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 02:19:53.884261: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 02:19:53.885182: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 02:19:53.887498: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 02:19:53.888911: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 02:19:53.893481: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 02:19:53.893927: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 02:19:53.894012: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 02:19:55.053467: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-13 02:19:55.054530: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 02:19:55.055007: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-03-13 02:19:55.055040: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 02:19:55.055072: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 02:19:55.055088: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 02:19:55.055103: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 02:19:55.055119: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 02:19:55.055134: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 02:19:55.055149: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 02:19:55.055164: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 02:19:55.055596: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 02:19:55.055631: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 02:19:55.647501: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-13 02:19:55.647563: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-13 02:19:55.647572: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-13 02:19:55.648748: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11227 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN X (Pascal), pci bus id: 0000:03:00.0, compute capability: 6.1)
{'id': '11_06', 'seed': 6, 'out_folder': 'results/epoch_budget_2', 'batch_size': 128, 'epochs': 136, 'validation_split': 0.0, 'checkpointing': False, 'checkpoint_every': -1, 'hold_out_validation_split': 0.0, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'num_classes': 10, 'SSE_lr': False, 'test_time_augmentation': False, 'debug': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN X (Pascal)'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
y_train shape: (50000, 10)
x_val shape: (10000, 32, 32, 3)
y_val shape: (10000, 10)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/136 [00:00<?, ?epoch/s]2024-03-13 02:19:56.233488: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-13 02:19:56.246067: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2600020000 Hz
2024-03-13 02:19:58.155132: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 02:19:58.451546: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 02:19:59.311109: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-13 02:19:59.381646: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/136 [01:01<2:17:22, 61.06s/epoch, loss=3.14, accuracy=0.309, val_loss=2.18, val_accuracy=0.356, lr=0.1]  1%|▏         | 2/136 [01:20<1:22:04, 36.75s/epoch, loss=1.51, accuracy=0.557, val_loss=1.72, val_accuracy=0.496, lr=0.1]  2%|▏         | 3/136 [01:41<1:04:44, 29.21s/epoch, loss=1.33, accuracy=0.642, val_loss=1.77, val_accuracy=0.501, lr=0.1]  3%|▎         | 4/136 [02:02<57:32, 26.16s/epoch, loss=1.26, accuracy=0.683, val_loss=2.14, val_accuracy=0.456, lr=0.1]    4%|▎         | 5/136 [02:24<53:31, 24.52s/epoch, loss=1.24, accuracy=0.698, val_loss=2.59, val_accuracy=0.393, lr=0.1]  4%|▍         | 6/136 [02:45<50:51, 23.48s/epoch, loss=1.23, accuracy=0.709, val_loss=1.63, val_accuracy=0.57, lr=0.1]   5%|▌         | 7/136 [03:07<49:10, 22.87s/epoch, loss=1.22, accuracy=0.717, val_loss=2.23, val_accuracy=0.425, lr=0.1]  6%|▌         | 8/136 [03:28<47:57, 22.48s/epoch, loss=1.2, accuracy=0.723, val_loss=1.56, val_accuracy=0.598, lr=0.1]   7%|▋         | 9/136 [03:50<46:46, 22.10s/epoch, loss=1.2, accuracy=0.726, val_loss=2.24, val_accuracy=0.39, lr=0.1]   7%|▋         | 10/136 [04:11<45:49, 21.82s/epoch, loss=1.2, accuracy=0.727, val_loss=2.51, val_accuracy=0.375, lr=0.1]  8%|▊         | 11/136 [04:32<45:06, 21.65s/epoch, loss=1.19, accuracy=0.734, val_loss=1.96, val_accuracy=0.475, lr=0.1]  9%|▉         | 12/136 [04:53<44:15, 21.42s/epoch, loss=1.18, accuracy=0.735, val_loss=3.74, val_accuracy=0.288, lr=0.1] 10%|▉         | 13/136 [05:14<43:54, 21.42s/epoch, loss=1.18, accuracy=0.736, val_loss=2.11, val_accuracy=0.512, lr=0.1] 10%|█         | 14/136 [05:35<43:14, 21.26s/epoch, loss=1.18, accuracy=0.738, val_loss=1.93, val_accuracy=0.474, lr=0.1] 11%|█         | 15/136 [05:57<42:59, 21.32s/epoch, loss=1.18, accuracy=0.74, val_loss=1.5, val_accuracy=0.624, lr=0.1]   12%|█▏        | 16/136 [06:18<42:39, 21.33s/epoch, loss=1.17, accuracy=0.741, val_loss=2.31, val_accuracy=0.421, lr=0.1] 12%|█▎        | 17/136 [06:39<42:18, 21.33s/epoch, loss=1.17, accuracy=0.742, val_loss=1.66, val_accuracy=0.564, lr=0.1] 13%|█▎        | 18/136 [07:01<41:53, 21.30s/epoch, loss=1.17, accuracy=0.742, val_loss=1.73, val_accuracy=0.593, lr=0.1] 14%|█▍        | 19/136 [07:22<41:41, 21.38s/epoch, loss=1.17, accuracy=0.745, val_loss=1.9, val_accuracy=0.525, lr=0.1]  15%|█▍        | 20/136 [07:42<40:18, 20.85s/epoch, loss=1.16, accuracy=0.747, val_loss=2.66, val_accuracy=0.462, lr=0.1] 15%|█▌        | 21/136 [08:02<39:41, 20.71s/epoch, loss=1.16, accuracy=0.748, val_loss=2.67, val_accuracy=0.376, lr=0.1] 16%|█▌        | 22/136 [08:22<38:57, 20.50s/epoch, loss=1.16, accuracy=0.744, val_loss=1.8, val_accuracy=0.529, lr=0.1]  17%|█▋        | 23/136 [08:42<38:20, 20.36s/epoch, loss=1.16, accuracy=0.747, val_loss=3.47, val_accuracy=0.315, lr=0.1] 18%|█▊        | 24/136 [09:04<38:33, 20.66s/epoch, loss=1.17, accuracy=0.745, val_loss=1.77, val_accuracy=0.527, lr=0.1] 18%|█▊        | 25/136 [09:25<38:25, 20.77s/epoch, loss=1.16, accuracy=0.749, val_loss=1.5, val_accuracy=0.641, lr=0.1]  19%|█▉        | 26/136 [09:46<38:23, 20.95s/epoch, loss=1.16, accuracy=0.748, val_loss=1.74, val_accuracy=0.535, lr=0.1] 20%|█▉        | 27/136 [10:07<38:15, 21.06s/epoch, loss=1.15, accuracy=0.749, val_loss=3.5, val_accuracy=0.323, lr=0.1]  21%|██        | 28/136 [10:28<37:48, 21.01s/epoch, loss=1.16, accuracy=0.748, val_loss=1.83, val_accuracy=0.514, lr=0.1] 21%|██▏       | 29/136 [10:49<37:25, 20.99s/epoch, loss=1.15, accuracy=0.751, val_loss=1.59, val_accuracy=0.611, lr=0.1] 22%|██▏       | 30/136 [11:10<37:11, 21.05s/epoch, loss=1.15, accuracy=0.753, val_loss=1.79, val_accuracy=0.562, lr=0.1] 23%|██▎       | 31/136 [11:31<36:49, 21.04s/epoch, loss=1.16, accuracy=0.752, val_loss=1.73, val_accuracy=0.562, lr=0.1] 24%|██▎       | 32/136 [11:52<36:19, 20.96s/epoch, loss=1.15, accuracy=0.75, val_loss=1.9, val_accuracy=0.528, lr=0.1]   24%|██▍       | 33/136 [12:13<36:09, 21.07s/epoch, loss=1.15, accuracy=0.752, val_loss=1.7, val_accuracy=0.562, lr=0.1] 25%|██▌       | 34/136 [12:35<35:56, 21.14s/epoch, loss=1.15, accuracy=0.751, val_loss=1.56, val_accuracy=0.61, lr=0.1] 26%|██▌       | 35/136 [12:56<35:39, 21.18s/epoch, loss=1.15, accuracy=0.75, val_loss=1.87, val_accuracy=0.498, lr=0.1] 26%|██▋       | 36/136 [13:17<35:23, 21.24s/epoch, loss=1.15, accuracy=0.752, val_loss=1.55, val_accuracy=0.621, lr=0.1] 27%|██▋       | 37/136 [13:39<35:01, 21.23s/epoch, loss=1.14, accuracy=0.755, val_loss=2.64, val_accuracy=0.384, lr=0.1] 28%|██▊       | 38/136 [14:00<34:40, 21.23s/epoch, loss=1.15, accuracy=0.752, val_loss=3.22, val_accuracy=0.285, lr=0.1] 29%|██▊       | 39/136 [14:20<34:00, 21.04s/epoch, loss=1.15, accuracy=0.752, val_loss=1.85, val_accuracy=0.558, lr=0.1] 29%|██▉       | 40/136 [14:41<33:39, 21.04s/epoch, loss=1.14, accuracy=0.753, val_loss=1.97, val_accuracy=0.463, lr=0.1] 30%|███       | 41/136 [15:03<33:23, 21.09s/epoch, loss=1.13, accuracy=0.756, val_loss=1.87, val_accuracy=0.508, lr=0.1] 31%|███       | 42/136 [15:24<33:07, 21.14s/epoch, loss=1.14, accuracy=0.752, val_loss=1.42, val_accuracy=0.657, lr=0.1] 32%|███▏      | 43/136 [15:45<32:48, 21.16s/epoch, loss=1.14, accuracy=0.753, val_loss=2.48, val_accuracy=0.331, lr=0.1] 32%|███▏      | 44/136 [16:06<32:30, 21.20s/epoch, loss=1.14, accuracy=0.754, val_loss=2.4, val_accuracy=0.412, lr=0.1]  33%|███▎      | 45/136 [16:28<32:11, 21.23s/epoch, loss=1.14, accuracy=0.754, val_loss=2.35, val_accuracy=0.4, lr=0.1]  34%|███▍      | 46/136 [16:49<31:44, 21.16s/epoch, loss=1.13, accuracy=0.755, val_loss=2.65, val_accuracy=0.435, lr=0.1] 35%|███▍      | 47/136 [17:10<31:20, 21.13s/epoch, loss=1.13, accuracy=0.754, val_loss=2.08, val_accuracy=0.535, lr=0.1] 35%|███▌      | 48/136 [17:31<31:00, 21.14s/epoch, loss=1.13, accuracy=0.754, val_loss=4.31, val_accuracy=0.302, lr=0.1] 36%|███▌      | 49/136 [17:52<30:37, 21.12s/epoch, loss=1.13, accuracy=0.753, val_loss=4.12, val_accuracy=0.263, lr=0.1] 37%|███▋      | 50/136 [18:13<30:10, 21.05s/epoch, loss=1.13, accuracy=0.756, val_loss=2.32, val_accuracy=0.393, lr=0.1] 38%|███▊      | 51/136 [18:34<29:46, 21.01s/epoch, loss=1.13, accuracy=0.756, val_loss=2.02, val_accuracy=0.444, lr=0.1] 38%|███▊      | 52/136 [18:55<29:22, 20.99s/epoch, loss=1.13, accuracy=0.758, val_loss=1.44, val_accuracy=0.634, lr=0.1] 39%|███▉      | 53/136 [19:16<29:01, 20.98s/epoch, loss=1.13, accuracy=0.757, val_loss=2.03, val_accuracy=0.563, lr=0.1] 40%|███▉      | 54/136 [19:37<28:35, 20.92s/epoch, loss=1.13, accuracy=0.757, val_loss=1.46, val_accuracy=0.639, lr=0.1] 40%|████      | 55/136 [19:57<28:11, 20.88s/epoch, loss=1.13, accuracy=0.757, val_loss=1.99, val_accuracy=0.521, lr=0.1] 41%|████      | 56/136 [20:18<27:48, 20.86s/epoch, loss=0.909, accuracy=0.818, val_loss=0.934, val_accuracy=0.791, lr=0.01] 42%|████▏     | 57/136 [20:39<27:39, 21.01s/epoch, loss=0.733, accuracy=0.848, val_loss=0.789, val_accuracy=0.819, lr=0.01] 43%|████▎     | 58/136 [21:01<27:27, 21.12s/epoch, loss=0.652, accuracy=0.856, val_loss=0.753, val_accuracy=0.812, lr=0.01] 43%|████▎     | 59/136 [21:22<27:07, 21.14s/epoch, loss=0.61, accuracy=0.859, val_loss=0.767, val_accuracy=0.811, lr=0.01]  44%|████▍     | 60/136 [21:43<26:49, 21.17s/epoch, loss=0.587, accuracy=0.863, val_loss=0.716, val_accuracy=0.82, lr=0.01] 45%|████▍     | 61/136 [22:04<26:13, 20.98s/epoch, loss=0.574, accuracy=0.863, val_loss=0.72, val_accuracy=0.813, lr=0.01] 46%|████▌     | 62/136 [22:25<26:03, 21.12s/epoch, loss=0.567, accuracy=0.866, val_loss=0.708, val_accuracy=0.82, lr=0.01] 46%|████▋     | 63/136 [22:46<25:34, 21.03s/epoch, loss=0.569, accuracy=0.866, val_loss=0.908, val_accuracy=0.755, lr=0.01] 47%|████▋     | 64/136 [23:08<25:22, 21.15s/epoch, loss=0.567, accuracy=0.866, val_loss=0.673, val_accuracy=0.834, lr=0.01] 48%|████▊     | 65/136 [23:28<24:48, 20.97s/epoch, loss=0.564, accuracy=0.868, val_loss=0.722, val_accuracy=0.823, lr=0.01] 49%|████▊     | 66/136 [23:49<24:37, 21.11s/epoch, loss=0.562, accuracy=0.871, val_loss=0.681, val_accuracy=0.831, lr=0.01] 49%|████▉     | 67/136 [24:11<24:15, 21.09s/epoch, loss=0.558, accuracy=0.874, val_loss=0.783, val_accuracy=0.798, lr=0.01] 50%|█████     | 68/136 [24:32<23:58, 21.16s/epoch, loss=0.558, accuracy=0.874, val_loss=0.902, val_accuracy=0.764, lr=0.01] 51%|█████     | 69/136 [24:53<23:41, 21.21s/epoch, loss=0.56, accuracy=0.873, val_loss=0.745, val_accuracy=0.812, lr=0.01]  51%|█████▏    | 70/136 [25:15<23:22, 21.25s/epoch, loss=0.555, accuracy=0.876, val_loss=0.864, val_accuracy=0.774, lr=0.01] 52%|█████▏    | 71/136 [25:35<22:50, 21.09s/epoch, loss=0.558, accuracy=0.876, val_loss=0.899, val_accuracy=0.775, lr=0.01] 53%|█████▎    | 72/136 [25:56<22:29, 21.09s/epoch, loss=0.556, accuracy=0.878, val_loss=1.22, val_accuracy=0.684, lr=0.01]  54%|█████▎    | 73/136 [26:17<21:56, 20.90s/epoch, loss=0.555, accuracy=0.879, val_loss=0.778, val_accuracy=0.799, lr=0.01] 54%|█████▍    | 74/136 [26:38<21:45, 21.06s/epoch, loss=0.553, accuracy=0.88, val_loss=0.748, val_accuracy=0.823, lr=0.01]  55%|█████▌    | 75/136 [27:00<21:30, 21.15s/epoch, loss=0.554, accuracy=0.882, val_loss=0.899, val_accuracy=0.783, lr=0.01] 56%|█████▌    | 76/136 [27:21<21:04, 21.08s/epoch, loss=0.56, accuracy=0.878, val_loss=0.783, val_accuracy=0.809, lr=0.01]  57%|█████▋    | 77/136 [27:42<20:50, 21.20s/epoch, loss=0.563, accuracy=0.879, val_loss=0.831, val_accuracy=0.792, lr=0.01] 57%|█████▋    | 78/136 [28:03<20:31, 21.24s/epoch, loss=0.558, accuracy=0.881, val_loss=0.786, val_accuracy=0.816, lr=0.01] 58%|█████▊    | 79/136 [28:24<20:03, 21.11s/epoch, loss=0.553, accuracy=0.882, val_loss=0.935, val_accuracy=0.775, lr=0.01] 59%|█████▉    | 80/136 [28:45<19:37, 21.02s/epoch, loss=0.559, accuracy=0.88, val_loss=0.888, val_accuracy=0.779, lr=0.01]  60%|█████▉    | 81/136 [29:06<19:20, 21.09s/epoch, loss=0.553, accuracy=0.884, val_loss=1.67, val_accuracy=0.564, lr=0.01] 60%|██████    | 82/136 [29:27<19:01, 21.15s/epoch, loss=0.552, accuracy=0.884, val_loss=0.761, val_accuracy=0.817, lr=0.01] 61%|██████    | 83/136 [29:48<18:27, 20.90s/epoch, loss=0.476, accuracy=0.912, val_loss=0.543, val_accuracy=0.889, lr=0.001] 62%|██████▏   | 84/136 [30:09<18:10, 20.97s/epoch, loss=0.426, accuracy=0.927, val_loss=0.515, val_accuracy=0.894, lr=0.001] 62%|██████▎   | 85/136 [30:30<17:50, 21.00s/epoch, loss=0.404, accuracy=0.932, val_loss=0.511, val_accuracy=0.897, lr=0.001] 63%|██████▎   | 86/136 [30:51<17:29, 21.00s/epoch, loss=0.389, accuracy=0.935, val_loss=0.502, val_accuracy=0.896, lr=0.001] 64%|██████▍   | 87/136 [31:12<17:08, 20.99s/epoch, loss=0.373, accuracy=0.94, val_loss=0.507, val_accuracy=0.895, lr=0.001]  65%|██████▍   | 88/136 [31:33<16:52, 21.09s/epoch, loss=0.36, accuracy=0.941, val_loss=0.484, val_accuracy=0.902, lr=0.001] 65%|██████▌   | 89/136 [31:54<16:30, 21.07s/epoch, loss=0.351, accuracy=0.943, val_loss=0.498, val_accuracy=0.895, lr=0.001] 66%|██████▌   | 90/136 [32:15<16:09, 21.07s/epoch, loss=0.341, accuracy=0.944, val_loss=0.489, val_accuracy=0.896, lr=0.001] 67%|██████▋   | 91/136 [32:36<15:44, 20.98s/epoch, loss=0.329, accuracy=0.947, val_loss=0.483, val_accuracy=0.898, lr=0.001] 68%|██████▊   | 92/136 [32:57<15:19, 20.90s/epoch, loss=0.321, accuracy=0.948, val_loss=0.474, val_accuracy=0.898, lr=0.001] 68%|██████▊   | 93/136 [33:17<14:54, 20.80s/epoch, loss=0.313, accuracy=0.95, val_loss=0.476, val_accuracy=0.896, lr=0.001]  69%|██████▉   | 94/136 [33:38<14:33, 20.79s/epoch, loss=0.305, accuracy=0.952, val_loss=0.48, val_accuracy=0.893, lr=0.001] 70%|██████▉   | 95/136 [33:59<14:15, 20.87s/epoch, loss=0.297, accuracy=0.952, val_loss=0.463, val_accuracy=0.9, lr=0.001]  71%|███████   | 96/136 [34:19<13:41, 20.54s/epoch, loss=0.294, accuracy=0.952, val_loss=0.477, val_accuracy=0.895, lr=0.001] 71%|███████▏  | 97/136 [34:40<13:28, 20.74s/epoch, loss=0.283, accuracy=0.955, val_loss=0.467, val_accuracy=0.898, lr=0.001] 72%|███████▏  | 98/136 [35:01<13:11, 20.82s/epoch, loss=0.281, accuracy=0.955, val_loss=0.461, val_accuracy=0.896, lr=0.001] 73%|███████▎  | 99/136 [35:23<12:55, 20.97s/epoch, loss=0.275, accuracy=0.955, val_loss=0.463, val_accuracy=0.895, lr=0.001] 74%|███████▎  | 100/136 [35:42<12:23, 20.65s/epoch, loss=0.27, accuracy=0.956, val_loss=0.463, val_accuracy=0.898, lr=0.001] 74%|███████▍  | 101/136 [36:04<12:09, 20.84s/epoch, loss=0.265, accuracy=0.957, val_loss=0.455, val_accuracy=0.899, lr=0.001] 75%|███████▌  | 102/136 [36:25<11:51, 20.94s/epoch, loss=0.256, accuracy=0.96, val_loss=0.454, val_accuracy=0.897, lr=0.001]  76%|███████▌  | 103/136 [36:46<11:31, 20.94s/epoch, loss=0.258, accuracy=0.957, val_loss=0.467, val_accuracy=0.892, lr=0.001] 76%|███████▋  | 104/136 [37:07<11:10, 20.94s/epoch, loss=0.25, accuracy=0.958, val_loss=0.473, val_accuracy=0.891, lr=0.001]  77%|███████▋  | 105/136 [37:28<10:52, 21.05s/epoch, loss=0.248, accuracy=0.959, val_loss=0.5, val_accuracy=0.889, lr=0.001]  78%|███████▊  | 106/136 [37:48<10:21, 20.73s/epoch, loss=0.247, accuracy=0.958, val_loss=0.456, val_accuracy=0.894, lr=0.001] 79%|███████▊  | 107/136 [38:09<10:06, 20.90s/epoch, loss=0.24, accuracy=0.959, val_loss=0.47, val_accuracy=0.893, lr=0.001]   79%|███████▉  | 108/136 [38:30<09:44, 20.87s/epoch, loss=0.238, accuracy=0.961, val_loss=0.498, val_accuracy=0.886, lr=0.001] 80%|████████  | 109/136 [38:51<09:26, 20.98s/epoch, loss=0.237, accuracy=0.96, val_loss=0.476, val_accuracy=0.889, lr=0.001]  81%|████████  | 110/136 [39:12<09:06, 21.00s/epoch, loss=0.219, accuracy=0.968, val_loss=0.428, val_accuracy=0.903, lr=1e-04] 82%|████████▏ | 111/136 [39:34<08:46, 21.08s/epoch, loss=0.207, accuracy=0.972, val_loss=0.424, val_accuracy=0.906, lr=1e-04] 82%|████████▏ | 112/136 [39:55<08:26, 21.11s/epoch, loss=0.204, accuracy=0.973, val_loss=0.422, val_accuracy=0.904, lr=1e-04] 83%|████████▎ | 113/136 [40:15<07:56, 20.73s/epoch, loss=0.2, accuracy=0.974, val_loss=0.422, val_accuracy=0.907, lr=1e-04]   84%|████████▍ | 114/136 [40:35<07:35, 20.71s/epoch, loss=0.197, accuracy=0.975, val_loss=0.426, val_accuracy=0.906, lr=1e-04] 85%|████████▍ | 115/136 [40:56<07:13, 20.64s/epoch, loss=0.197, accuracy=0.975, val_loss=0.423, val_accuracy=0.909, lr=1e-04] 85%|████████▌ | 116/136 [41:15<06:44, 20.22s/epoch, loss=0.194, accuracy=0.976, val_loss=0.426, val_accuracy=0.906, lr=1e-04] 86%|████████▌ | 117/136 [41:35<06:24, 20.23s/epoch, loss=0.194, accuracy=0.976, val_loss=0.421, val_accuracy=0.908, lr=1e-04] 87%|████████▋ | 118/136 [41:56<06:05, 20.32s/epoch, loss=0.191, accuracy=0.978, val_loss=0.423, val_accuracy=0.907, lr=1e-04] 88%|████████▊ | 119/136 [42:17<05:49, 20.54s/epoch, loss=0.19, accuracy=0.977, val_loss=0.421, val_accuracy=0.908, lr=1e-04]  88%|████████▊ | 120/136 [42:38<05:32, 20.79s/epoch, loss=0.187, accuracy=0.978, val_loss=0.422, val_accuracy=0.907, lr=1e-04] 89%|████████▉ | 121/136 [42:59<05:10, 20.70s/epoch, loss=0.187, accuracy=0.978, val_loss=0.424, val_accuracy=0.907, lr=1e-04] 90%|████████▉ | 122/136 [43:19<04:48, 20.64s/epoch, loss=0.187, accuracy=0.978, val_loss=0.424, val_accuracy=0.908, lr=1e-04] 90%|█████████ | 123/136 [43:40<04:29, 20.72s/epoch, loss=0.188, accuracy=0.977, val_loss=0.425, val_accuracy=0.906, lr=1e-04] 91%|█████████ | 124/136 [44:01<04:09, 20.82s/epoch, loss=0.185, accuracy=0.979, val_loss=0.423, val_accuracy=0.908, lr=5e-5]  92%|█████████▏| 125/136 [44:23<03:50, 20.94s/epoch, loss=0.184, accuracy=0.978, val_loss=0.422, val_accuracy=0.907, lr=5e-5] 93%|█████████▎| 126/136 [44:43<03:29, 20.94s/epoch, loss=0.185, accuracy=0.978, val_loss=0.422, val_accuracy=0.908, lr=5e-5] 93%|█████████▎| 127/136 [45:05<03:09, 21.01s/epoch, loss=0.181, accuracy=0.979, val_loss=0.422, val_accuracy=0.909, lr=5e-5] 94%|█████████▍| 128/136 [45:25<02:47, 20.90s/epoch, loss=0.182, accuracy=0.98, val_loss=0.424, val_accuracy=0.906, lr=5e-5]  95%|█████████▍| 129/136 [45:46<02:26, 20.93s/epoch, loss=0.178, accuracy=0.981, val_loss=0.422, val_accuracy=0.909, lr=5e-5] 96%|█████████▌| 130/136 [46:07<02:05, 21.00s/epoch, loss=0.181, accuracy=0.98, val_loss=0.424, val_accuracy=0.908, lr=5e-5]  96%|█████████▋| 131/136 [46:29<01:45, 21.07s/epoch, loss=0.181, accuracy=0.979, val_loss=0.424, val_accuracy=0.909, lr=5e-5] 97%|█████████▋| 132/136 [46:49<01:23, 20.92s/epoch, loss=0.18, accuracy=0.981, val_loss=0.423, val_accuracy=0.909, lr=5e-5]  98%|█████████▊| 133/136 [47:10<01:02, 20.95s/epoch, loss=0.18, accuracy=0.98, val_loss=0.424, val_accuracy=0.909, lr=5e-5]  99%|█████████▊| 134/136 [47:31<00:41, 20.95s/epoch, loss=0.18, accuracy=0.98, val_loss=0.424, val_accuracy=0.909, lr=5e-5] 99%|█████████▉| 135/136 [47:51<00:20, 20.67s/epoch, loss=0.179, accuracy=0.98, val_loss=0.425, val_accuracy=0.907, lr=5e-5]100%|██████████| 136/136 [48:11<00:00, 20.33s/epoch, loss=0.178, accuracy=0.98, val_loss=0.426, val_accuracy=0.907, lr=5e-5]100%|██████████| 136/136 [48:11<00:00, 21.26s/epoch, loss=0.178, accuracy=0.98, val_loss=0.426, val_accuracy=0.907, lr=5e-5]
Using real-time data augmentation.
Only one model saved

Loading model: 11_06_cifar10_ResNet20v1.h5
Test score: 0.42592984437942505
Test accuracy: 0.9070000052452087


* * * Run SGD for ID = 11_7. * * *


2024-03-13 03:08:10.984194: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 03:08:13.201772: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 03:08:13.202677: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-13 03:08:13.238919: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-03-13 03:08:13.238945: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 03:08:13.241514: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 03:08:13.241550: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 03:08:13.243723: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 03:08:13.244357: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 03:08:13.246536: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 03:08:13.247794: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 03:08:13.252111: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 03:08:13.252604: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 03:08:13.252675: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 03:08:14.406839: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-13 03:08:14.407444: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 03:08:14.407883: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-03-13 03:08:14.407911: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 03:08:14.407943: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 03:08:14.407967: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 03:08:14.408001: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 03:08:14.408016: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 03:08:14.408030: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 03:08:14.408044: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 03:08:14.408058: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 03:08:14.408479: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 03:08:14.408512: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 03:08:14.996575: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-13 03:08:14.996643: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-13 03:08:14.996653: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-13 03:08:14.997844: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11227 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN X (Pascal), pci bus id: 0000:03:00.0, compute capability: 6.1)
{'id': '11_07', 'seed': 7, 'out_folder': 'results/epoch_budget_2', 'batch_size': 128, 'epochs': 136, 'validation_split': 0.0, 'checkpointing': False, 'checkpoint_every': -1, 'hold_out_validation_split': 0.0, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'num_classes': 10, 'SSE_lr': False, 'test_time_augmentation': False, 'debug': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN X (Pascal)'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
y_train shape: (50000, 10)
x_val shape: (10000, 32, 32, 3)
y_val shape: (10000, 10)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/136 [00:00<?, ?epoch/s]2024-03-13 03:08:15.579849: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-13 03:08:15.592081: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2600020000 Hz
2024-03-13 03:08:17.494379: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 03:08:17.698804: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 03:08:18.513022: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-13 03:08:18.556071: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/136 [00:59<2:13:31, 59.34s/epoch, loss=3.23, accuracy=0.309, val_loss=2.2, val_accuracy=0.279, lr=0.1]  1%|▏         | 2/136 [01:20<1:22:53, 37.12s/epoch, loss=1.64, accuracy=0.487, val_loss=1.71, val_accuracy=0.456, lr=0.1]  2%|▏         | 3/136 [01:42<1:06:29, 29.99s/epoch, loss=1.42, accuracy=0.595, val_loss=3.04, val_accuracy=0.33, lr=0.1]   3%|▎         | 4/136 [02:03<58:33, 26.62s/epoch, loss=1.3, accuracy=0.662, val_loss=2.39, val_accuracy=0.366, lr=0.1]    4%|▎         | 5/136 [02:25<54:09, 24.81s/epoch, loss=1.26, accuracy=0.686, val_loss=2.33, val_accuracy=0.443, lr=0.1]  4%|▍         | 6/136 [02:46<51:16, 23.66s/epoch, loss=1.25, accuracy=0.7, val_loss=2.17, val_accuracy=0.447, lr=0.1]    5%|▌         | 7/136 [03:08<49:20, 22.95s/epoch, loss=1.23, accuracy=0.712, val_loss=1.79, val_accuracy=0.521, lr=0.1]  6%|▌         | 8/136 [03:29<47:54, 22.46s/epoch, loss=1.21, accuracy=0.721, val_loss=2.17, val_accuracy=0.447, lr=0.1]  7%|▋         | 9/136 [03:51<46:53, 22.15s/epoch, loss=1.2, accuracy=0.726, val_loss=2.24, val_accuracy=0.476, lr=0.1]   7%|▋         | 10/136 [04:12<45:55, 21.87s/epoch, loss=1.2, accuracy=0.729, val_loss=2.95, val_accuracy=0.458, lr=0.1]  8%|▊         | 11/136 [04:32<44:13, 21.23s/epoch, loss=1.19, accuracy=0.732, val_loss=1.56, val_accuracy=0.611, lr=0.1]  9%|▉         | 12/136 [04:53<44:07, 21.35s/epoch, loss=1.19, accuracy=0.734, val_loss=1.72, val_accuracy=0.601, lr=0.1] 10%|▉         | 13/136 [05:15<43:55, 21.43s/epoch, loss=1.18, accuracy=0.738, val_loss=1.64, val_accuracy=0.61, lr=0.1]  10%|█         | 14/136 [05:37<43:36, 21.45s/epoch, loss=1.18, accuracy=0.738, val_loss=1.76, val_accuracy=0.581, lr=0.1] 11%|█         | 15/136 [05:58<43:04, 21.36s/epoch, loss=1.18, accuracy=0.741, val_loss=3.91, val_accuracy=0.348, lr=0.1] 12%|█▏        | 16/136 [06:19<42:37, 21.31s/epoch, loss=1.17, accuracy=0.742, val_loss=1.6, val_accuracy=0.597, lr=0.1]  12%|█▎        | 17/136 [06:40<42:26, 21.40s/epoch, loss=1.18, accuracy=0.742, val_loss=2.42, val_accuracy=0.487, lr=0.1] 13%|█▎        | 18/136 [07:02<42:15, 21.49s/epoch, loss=1.18, accuracy=0.744, val_loss=1.7, val_accuracy=0.593, lr=0.1]  14%|█▍        | 19/136 [07:24<41:57, 21.52s/epoch, loss=1.18, accuracy=0.745, val_loss=1.92, val_accuracy=0.524, lr=0.1] 15%|█▍        | 20/136 [07:45<41:30, 21.47s/epoch, loss=1.16, accuracy=0.746, val_loss=2.15, val_accuracy=0.458, lr=0.1] 15%|█▌        | 21/136 [08:07<41:12, 21.50s/epoch, loss=1.17, accuracy=0.745, val_loss=1.78, val_accuracy=0.555, lr=0.1] 16%|█▌        | 22/136 [08:28<40:59, 21.57s/epoch, loss=1.17, accuracy=0.746, val_loss=2.9, val_accuracy=0.326, lr=0.1]  17%|█▋        | 23/136 [08:50<40:31, 21.52s/epoch, loss=1.16, accuracy=0.749, val_loss=1.68, val_accuracy=0.581, lr=0.1] 18%|█▊        | 24/136 [09:11<40:11, 21.53s/epoch, loss=1.17, accuracy=0.749, val_loss=2.66, val_accuracy=0.338, lr=0.1] 18%|█▊        | 25/136 [09:33<39:56, 21.59s/epoch, loss=1.15, accuracy=0.751, val_loss=3.71, val_accuracy=0.217, lr=0.1] 19%|█▉        | 26/136 [09:55<39:30, 21.55s/epoch, loss=1.16, accuracy=0.748, val_loss=2, val_accuracy=0.454, lr=0.1]    20%|█▉        | 27/136 [10:16<39:10, 21.56s/epoch, loss=1.16, accuracy=0.751, val_loss=2.13, val_accuracy=0.472, lr=0.1] 21%|██        | 28/136 [10:38<38:50, 21.58s/epoch, loss=1.16, accuracy=0.75, val_loss=3.4, val_accuracy=0.322, lr=0.1]   21%|██▏       | 29/136 [10:59<38:28, 21.57s/epoch, loss=1.16, accuracy=0.75, val_loss=1.49, val_accuracy=0.649, lr=0.1] 22%|██▏       | 30/136 [11:21<38:03, 21.54s/epoch, loss=1.15, accuracy=0.75, val_loss=1.6, val_accuracy=0.601, lr=0.1]  23%|██▎       | 31/136 [11:43<37:49, 21.62s/epoch, loss=1.15, accuracy=0.751, val_loss=1.48, val_accuracy=0.649, lr=0.1] 24%|██▎       | 32/136 [12:04<37:25, 21.59s/epoch, loss=1.14, accuracy=0.754, val_loss=2.9, val_accuracy=0.323, lr=0.1]  24%|██▍       | 33/136 [12:25<36:48, 21.44s/epoch, loss=1.14, accuracy=0.753, val_loss=2.02, val_accuracy=0.492, lr=0.1] 25%|██▌       | 34/136 [12:47<36:34, 21.51s/epoch, loss=1.14, accuracy=0.752, val_loss=1.72, val_accuracy=0.525, lr=0.1] 26%|██▌       | 35/136 [13:09<36:20, 21.59s/epoch, loss=1.14, accuracy=0.753, val_loss=1.52, val_accuracy=0.618, lr=0.1] 26%|██▋       | 36/136 [13:30<35:57, 21.58s/epoch, loss=1.14, accuracy=0.753, val_loss=1.82, val_accuracy=0.557, lr=0.1] 27%|██▋       | 37/136 [13:51<35:22, 21.44s/epoch, loss=1.14, accuracy=0.752, val_loss=1.85, val_accuracy=0.532, lr=0.1] 28%|██▊       | 38/136 [14:13<35:03, 21.46s/epoch, loss=1.14, accuracy=0.751, val_loss=1.43, val_accuracy=0.642, lr=0.1] 29%|██▊       | 39/136 [14:35<34:50, 21.56s/epoch, loss=1.13, accuracy=0.754, val_loss=1.56, val_accuracy=0.6, lr=0.1]   29%|██▉       | 40/136 [14:56<34:31, 21.58s/epoch, loss=1.14, accuracy=0.756, val_loss=1.64, val_accuracy=0.568, lr=0.1] 30%|███       | 41/136 [15:17<33:46, 21.33s/epoch, loss=1.13, accuracy=0.754, val_loss=2.06, val_accuracy=0.457, lr=0.1] 31%|███       | 42/136 [15:39<33:35, 21.44s/epoch, loss=1.13, accuracy=0.754, val_loss=2.78, val_accuracy=0.273, lr=0.1] 32%|███▏      | 43/136 [16:01<33:26, 21.58s/epoch, loss=1.14, accuracy=0.754, val_loss=1.81, val_accuracy=0.549, lr=0.1] 32%|███▏      | 44/136 [16:22<33:08, 21.61s/epoch, loss=1.13, accuracy=0.756, val_loss=1.48, val_accuracy=0.618, lr=0.1] 33%|███▎      | 45/136 [16:44<32:47, 21.62s/epoch, loss=1.13, accuracy=0.756, val_loss=2.12, val_accuracy=0.456, lr=0.1] 34%|███▍      | 46/136 [17:06<32:26, 21.63s/epoch, loss=1.13, accuracy=0.756, val_loss=2.83, val_accuracy=0.397, lr=0.1] 35%|███▍      | 47/136 [17:27<32:10, 21.69s/epoch, loss=1.13, accuracy=0.755, val_loss=2.9, val_accuracy=0.334, lr=0.1]  35%|███▌      | 48/136 [17:49<31:46, 21.67s/epoch, loss=1.13, accuracy=0.755, val_loss=1.49, val_accuracy=0.636, lr=0.1] 36%|███▌      | 49/136 [18:11<31:22, 21.63s/epoch, loss=1.13, accuracy=0.755, val_loss=2.2, val_accuracy=0.417, lr=0.1]  37%|███▋      | 50/136 [18:32<30:51, 21.53s/epoch, loss=1.12, accuracy=0.758, val_loss=2.18, val_accuracy=0.479, lr=0.1] 38%|███▊      | 51/136 [18:54<30:33, 21.57s/epoch, loss=1.12, accuracy=0.758, val_loss=1.73, val_accuracy=0.545, lr=0.1] 38%|███▊      | 52/136 [19:15<30:11, 21.56s/epoch, loss=1.13, accuracy=0.757, val_loss=2.19, val_accuracy=0.447, lr=0.1] 39%|███▉      | 53/136 [19:37<29:56, 21.64s/epoch, loss=1.13, accuracy=0.755, val_loss=4.53, val_accuracy=0.25, lr=0.1]  40%|███▉      | 54/136 [19:58<29:31, 21.61s/epoch, loss=1.12, accuracy=0.756, val_loss=3.06, val_accuracy=0.352, lr=0.1] 40%|████      | 55/136 [20:20<28:58, 21.46s/epoch, loss=1.12, accuracy=0.756, val_loss=2.43, val_accuracy=0.47, lr=0.1]  41%|████      | 56/136 [20:41<28:42, 21.53s/epoch, loss=0.907, accuracy=0.817, val_loss=0.916, val_accuracy=0.796, lr=0.01] 42%|████▏     | 57/136 [21:03<28:24, 21.57s/epoch, loss=0.73, accuracy=0.847, val_loss=0.858, val_accuracy=0.792, lr=0.01]  43%|████▎     | 58/136 [21:24<27:59, 21.53s/epoch, loss=0.649, accuracy=0.856, val_loss=0.873, val_accuracy=0.779, lr=0.01] 43%|████▎     | 59/136 [21:46<27:45, 21.63s/epoch, loss=0.609, accuracy=0.859, val_loss=1.14, val_accuracy=0.708, lr=0.01]  44%|████▍     | 60/136 [22:08<27:24, 21.64s/epoch, loss=0.591, accuracy=0.859, val_loss=0.788, val_accuracy=0.794, lr=0.01] 45%|████▍     | 61/136 [22:30<27:04, 21.66s/epoch, loss=0.582, accuracy=0.86, val_loss=0.878, val_accuracy=0.77, lr=0.01]   46%|████▌     | 62/136 [22:51<26:29, 21.48s/epoch, loss=0.571, accuracy=0.864, val_loss=0.809, val_accuracy=0.788, lr=0.01] 46%|████▋     | 63/136 [23:12<26:11, 21.53s/epoch, loss=0.566, accuracy=0.865, val_loss=0.893, val_accuracy=0.763, lr=0.01] 47%|████▋     | 64/136 [23:33<25:40, 21.40s/epoch, loss=0.57, accuracy=0.866, val_loss=0.762, val_accuracy=0.802, lr=0.01]  48%|████▊     | 65/136 [23:55<25:15, 21.34s/epoch, loss=0.564, accuracy=0.868, val_loss=0.719, val_accuracy=0.815, lr=0.01] 49%|████▊     | 66/136 [24:16<24:55, 21.36s/epoch, loss=0.564, accuracy=0.87, val_loss=0.775, val_accuracy=0.804, lr=0.01]  49%|████▉     | 67/136 [24:38<24:37, 21.42s/epoch, loss=0.564, accuracy=0.87, val_loss=0.784, val_accuracy=0.804, lr=0.01] 50%|█████     | 68/136 [24:59<24:18, 21.45s/epoch, loss=0.566, accuracy=0.869, val_loss=0.882, val_accuracy=0.775, lr=0.01] 51%|█████     | 69/136 [25:20<23:55, 21.43s/epoch, loss=0.561, accuracy=0.872, val_loss=1.36, val_accuracy=0.641, lr=0.01]  51%|█████▏    | 70/136 [25:42<23:37, 21.48s/epoch, loss=0.564, accuracy=0.873, val_loss=0.767, val_accuracy=0.807, lr=0.01] 52%|█████▏    | 71/136 [26:04<23:15, 21.48s/epoch, loss=0.564, accuracy=0.873, val_loss=0.862, val_accuracy=0.785, lr=0.01] 53%|█████▎    | 72/136 [26:25<22:57, 21.52s/epoch, loss=0.563, accuracy=0.874, val_loss=1.22, val_accuracy=0.683, lr=0.01]  54%|█████▎    | 73/136 [26:47<22:39, 21.58s/epoch, loss=0.562, accuracy=0.876, val_loss=1.07, val_accuracy=0.737, lr=0.01] 54%|█████▍    | 74/136 [27:09<22:21, 21.64s/epoch, loss=0.564, accuracy=0.877, val_loss=1, val_accuracy=0.754, lr=0.01]    55%|█████▌    | 75/136 [27:30<21:59, 21.63s/epoch, loss=0.56, accuracy=0.877, val_loss=1.11, val_accuracy=0.729, lr=0.01] 56%|█████▌    | 76/136 [27:52<21:36, 21.60s/epoch, loss=0.559, accuracy=0.877, val_loss=0.757, val_accuracy=0.812, lr=0.01] 57%|█████▋    | 77/136 [28:13<21:15, 21.61s/epoch, loss=0.558, accuracy=0.88, val_loss=0.918, val_accuracy=0.772, lr=0.01]  57%|█████▋    | 78/136 [28:35<20:53, 21.62s/epoch, loss=0.558, accuracy=0.88, val_loss=1.51, val_accuracy=0.656, lr=0.01]  58%|█████▊    | 79/136 [28:56<20:27, 21.53s/epoch, loss=0.561, accuracy=0.88, val_loss=1.1, val_accuracy=0.733, lr=0.01]  59%|█████▉    | 80/136 [29:18<19:59, 21.41s/epoch, loss=0.559, accuracy=0.88, val_loss=0.918, val_accuracy=0.783, lr=0.01] 60%|█████▉    | 81/136 [29:38<19:24, 21.17s/epoch, loss=0.561, accuracy=0.881, val_loss=0.766, val_accuracy=0.816, lr=0.01] 60%|██████    | 82/136 [30:00<19:10, 21.31s/epoch, loss=0.561, accuracy=0.881, val_loss=0.936, val_accuracy=0.768, lr=0.01] 61%|██████    | 83/136 [30:21<18:51, 21.34s/epoch, loss=0.481, accuracy=0.909, val_loss=0.547, val_accuracy=0.887, lr=0.001] 62%|██████▏   | 84/136 [30:43<18:33, 21.41s/epoch, loss=0.431, accuracy=0.925, val_loss=0.531, val_accuracy=0.892, lr=0.001] 62%|██████▎   | 85/136 [31:04<18:10, 21.38s/epoch, loss=0.406, accuracy=0.932, val_loss=0.52, val_accuracy=0.892, lr=0.001]  63%|██████▎   | 86/136 [31:26<17:53, 21.46s/epoch, loss=0.392, accuracy=0.933, val_loss=0.514, val_accuracy=0.894, lr=0.001] 64%|██████▍   | 87/136 [31:47<17:33, 21.51s/epoch, loss=0.377, accuracy=0.937, val_loss=0.504, val_accuracy=0.896, lr=0.001] 65%|██████▍   | 88/136 [32:08<17:06, 21.39s/epoch, loss=0.367, accuracy=0.939, val_loss=0.491, val_accuracy=0.9, lr=0.001]   65%|██████▌   | 89/136 [32:29<16:31, 21.11s/epoch, loss=0.353, accuracy=0.942, val_loss=0.485, val_accuracy=0.898, lr=0.001] 66%|██████▌   | 90/136 [32:51<16:18, 21.28s/epoch, loss=0.346, accuracy=0.943, val_loss=0.491, val_accuracy=0.897, lr=0.001] 67%|██████▋   | 91/136 [33:12<15:54, 21.21s/epoch, loss=0.335, accuracy=0.943, val_loss=0.481, val_accuracy=0.897, lr=0.001] 68%|██████▊   | 92/136 [33:33<15:32, 21.19s/epoch, loss=0.326, accuracy=0.947, val_loss=0.483, val_accuracy=0.895, lr=0.001] 68%|██████▊   | 93/136 [33:54<15:15, 21.28s/epoch, loss=0.319, accuracy=0.947, val_loss=0.475, val_accuracy=0.896, lr=0.001] 69%|██████▉   | 94/136 [34:16<14:58, 21.39s/epoch, loss=0.312, accuracy=0.948, val_loss=0.479, val_accuracy=0.895, lr=0.001] 70%|██████▉   | 95/136 [34:37<14:36, 21.38s/epoch, loss=0.302, accuracy=0.95, val_loss=0.474, val_accuracy=0.896, lr=0.001]  71%|███████   | 96/136 [34:58<14:11, 21.29s/epoch, loss=0.295, accuracy=0.951, val_loss=0.479, val_accuracy=0.896, lr=0.001] 71%|███████▏  | 97/136 [35:20<13:52, 21.36s/epoch, loss=0.289, accuracy=0.952, val_loss=0.482, val_accuracy=0.894, lr=0.001] 72%|███████▏  | 98/136 [35:42<13:35, 21.45s/epoch, loss=0.285, accuracy=0.953, val_loss=0.493, val_accuracy=0.891, lr=0.001] 73%|███████▎  | 99/136 [36:03<13:14, 21.47s/epoch, loss=0.278, accuracy=0.954, val_loss=0.462, val_accuracy=0.898, lr=0.001] 74%|███████▎  | 100/136 [36:24<12:50, 21.40s/epoch, loss=0.271, accuracy=0.955, val_loss=0.468, val_accuracy=0.892, lr=0.001] 74%|███████▍  | 101/136 [36:46<12:31, 21.46s/epoch, loss=0.267, accuracy=0.955, val_loss=0.46, val_accuracy=0.896, lr=0.001]  75%|███████▌  | 102/136 [37:07<12:09, 21.45s/epoch, loss=0.262, accuracy=0.956, val_loss=0.472, val_accuracy=0.892, lr=0.001] 76%|███████▌  | 103/136 [37:29<11:47, 21.45s/epoch, loss=0.262, accuracy=0.956, val_loss=0.485, val_accuracy=0.888, lr=0.001] 76%|███████▋  | 104/136 [37:50<11:28, 21.52s/epoch, loss=0.254, accuracy=0.958, val_loss=0.509, val_accuracy=0.885, lr=0.001] 77%|███████▋  | 105/136 [38:11<10:58, 21.24s/epoch, loss=0.255, accuracy=0.957, val_loss=0.5, val_accuracy=0.886, lr=0.001]   78%|███████▊  | 106/136 [38:33<10:40, 21.35s/epoch, loss=0.25, accuracy=0.957, val_loss=0.452, val_accuracy=0.895, lr=0.001] 79%|███████▊  | 107/136 [38:54<10:18, 21.34s/epoch, loss=0.243, accuracy=0.96, val_loss=0.476, val_accuracy=0.894, lr=0.001] 79%|███████▉  | 108/136 [39:15<09:57, 21.34s/epoch, loss=0.244, accuracy=0.958, val_loss=0.468, val_accuracy=0.892, lr=0.001] 80%|████████  | 109/136 [39:37<09:36, 21.35s/epoch, loss=0.242, accuracy=0.958, val_loss=0.473, val_accuracy=0.889, lr=0.001] 81%|████████  | 110/136 [39:58<09:15, 21.36s/epoch, loss=0.222, accuracy=0.966, val_loss=0.426, val_accuracy=0.903, lr=1e-04] 82%|████████▏ | 111/136 [40:20<08:55, 21.41s/epoch, loss=0.209, accuracy=0.971, val_loss=0.426, val_accuracy=0.904, lr=1e-04] 82%|████████▏ | 112/136 [40:41<08:33, 21.38s/epoch, loss=0.206, accuracy=0.972, val_loss=0.422, val_accuracy=0.906, lr=1e-04] 83%|████████▎ | 113/136 [41:02<08:08, 21.24s/epoch, loss=0.204, accuracy=0.972, val_loss=0.422, val_accuracy=0.905, lr=1e-04] 84%|████████▍ | 114/136 [41:23<07:46, 21.22s/epoch, loss=0.202, accuracy=0.974, val_loss=0.424, val_accuracy=0.906, lr=1e-04] 85%|████████▍ | 115/136 [41:44<07:24, 21.19s/epoch, loss=0.2, accuracy=0.974, val_loss=0.422, val_accuracy=0.906, lr=1e-04]   85%|████████▌ | 116/136 [42:05<07:03, 21.18s/epoch, loss=0.196, accuracy=0.975, val_loss=0.422, val_accuracy=0.905, lr=1e-04] 86%|████████▌ | 117/136 [42:26<06:42, 21.17s/epoch, loss=0.195, accuracy=0.975, val_loss=0.425, val_accuracy=0.905, lr=1e-04] 87%|████████▋ | 118/136 [42:48<06:23, 21.31s/epoch, loss=0.194, accuracy=0.976, val_loss=0.424, val_accuracy=0.906, lr=1e-04] 88%|████████▊ | 119/136 [43:08<05:57, 21.02s/epoch, loss=0.194, accuracy=0.975, val_loss=0.427, val_accuracy=0.906, lr=1e-04] 88%|████████▊ | 120/136 [43:30<05:37, 21.10s/epoch, loss=0.191, accuracy=0.976, val_loss=0.428, val_accuracy=0.904, lr=1e-04] 89%|████████▉ | 121/136 [43:51<05:16, 21.11s/epoch, loss=0.192, accuracy=0.976, val_loss=0.428, val_accuracy=0.904, lr=1e-04] 90%|████████▉ | 122/136 [44:12<04:57, 21.23s/epoch, loss=0.189, accuracy=0.977, val_loss=0.423, val_accuracy=0.906, lr=1e-04] 90%|█████████ | 123/136 [44:34<04:36, 21.26s/epoch, loss=0.189, accuracy=0.977, val_loss=0.423, val_accuracy=0.905, lr=1e-04] 91%|█████████ | 124/136 [44:55<04:14, 21.20s/epoch, loss=0.187, accuracy=0.978, val_loss=0.425, val_accuracy=0.906, lr=5e-5]  92%|█████████▏| 125/136 [45:16<03:53, 21.26s/epoch, loss=0.186, accuracy=0.977, val_loss=0.423, val_accuracy=0.906, lr=5e-5] 93%|█████████▎| 126/136 [45:37<03:32, 21.22s/epoch, loss=0.184, accuracy=0.979, val_loss=0.425, val_accuracy=0.905, lr=5e-5] 93%|█████████▎| 127/136 [45:58<03:10, 21.17s/epoch, loss=0.185, accuracy=0.978, val_loss=0.425, val_accuracy=0.904, lr=5e-5] 94%|█████████▍| 128/136 [46:19<02:48, 21.12s/epoch, loss=0.183, accuracy=0.978, val_loss=0.425, val_accuracy=0.906, lr=5e-5] 95%|█████████▍| 129/136 [46:41<02:28, 21.18s/epoch, loss=0.184, accuracy=0.978, val_loss=0.424, val_accuracy=0.907, lr=5e-5] 96%|█████████▌| 130/136 [47:01<02:06, 21.07s/epoch, loss=0.183, accuracy=0.978, val_loss=0.425, val_accuracy=0.905, lr=5e-5] 96%|█████████▋| 131/136 [47:23<01:45, 21.10s/epoch, loss=0.183, accuracy=0.978, val_loss=0.425, val_accuracy=0.906, lr=5e-5] 97%|█████████▋| 132/136 [47:44<01:24, 21.17s/epoch, loss=0.182, accuracy=0.979, val_loss=0.427, val_accuracy=0.905, lr=5e-5] 98%|█████████▊| 133/136 [48:04<01:02, 20.90s/epoch, loss=0.181, accuracy=0.979, val_loss=0.425, val_accuracy=0.906, lr=5e-5] 99%|█████████▊| 134/136 [48:25<00:41, 20.99s/epoch, loss=0.182, accuracy=0.979, val_loss=0.424, val_accuracy=0.907, lr=5e-5] 99%|█████████▉| 135/136 [48:47<00:21, 21.12s/epoch, loss=0.181, accuracy=0.98, val_loss=0.427, val_accuracy=0.906, lr=5e-5] 100%|██████████| 136/136 [49:08<00:00, 21.19s/epoch, loss=0.18, accuracy=0.979, val_loss=0.426, val_accuracy=0.905, lr=5e-5]100%|██████████| 136/136 [49:08<00:00, 21.68s/epoch, loss=0.18, accuracy=0.979, val_loss=0.426, val_accuracy=0.905, lr=5e-5]
Using real-time data augmentation.
Only one model saved

Loading model: 11_07_cifar10_ResNet20v1.h5
Test score: 0.42571836709976196
Test accuracy: 0.9054999947547913


* * * Run SGD for ID = 11_8. * * *


2024-03-13 03:57:28.667705: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 03:57:31.077746: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 03:57:31.078772: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-13 03:57:31.114733: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-03-13 03:57:31.114771: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 03:57:31.117170: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 03:57:31.117216: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 03:57:31.119179: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 03:57:31.119753: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 03:57:31.121803: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 03:57:31.123147: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 03:57:31.127262: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 03:57:31.127774: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 03:57:31.127851: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 03:57:32.420799: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-13 03:57:32.422229: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 03:57:32.422628: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-03-13 03:57:32.422663: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 03:57:32.422694: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 03:57:32.422710: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 03:57:32.422725: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 03:57:32.422740: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 03:57:32.422756: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 03:57:32.422771: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 03:57:32.422786: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 03:57:32.423208: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 03:57:32.423239: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 03:57:33.050286: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-13 03:57:33.050344: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-13 03:57:33.050353: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-13 03:57:33.051512: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11227 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN X (Pascal), pci bus id: 0000:03:00.0, compute capability: 6.1)
{'id': '11_08', 'seed': 8, 'out_folder': 'results/epoch_budget_2', 'batch_size': 128, 'epochs': 136, 'validation_split': 0.0, 'checkpointing': False, 'checkpoint_every': -1, 'hold_out_validation_split': 0.0, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'num_classes': 10, 'SSE_lr': False, 'test_time_augmentation': False, 'debug': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN X (Pascal)'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
y_train shape: (50000, 10)
x_val shape: (10000, 32, 32, 3)
y_val shape: (10000, 10)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/136 [00:00<?, ?epoch/s]2024-03-13 03:57:33.635839: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-13 03:57:33.648090: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2600020000 Hz
2024-03-13 03:57:35.508919: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 03:57:35.751259: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 03:57:36.968800: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-13 03:57:37.186744: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/136 [01:07<2:31:12, 67.20s/epoch, loss=2.88, accuracy=0.372, val_loss=3.3, val_accuracy=0.13, lr=0.1]  1%|▏         | 2/136 [01:27<1:28:52, 39.79s/epoch, loss=1.47, accuracy=0.58, val_loss=3.19, val_accuracy=0.299, lr=0.1]  2%|▏         | 3/136 [01:49<1:09:43, 31.45s/epoch, loss=1.31, accuracy=0.656, val_loss=2.95, val_accuracy=0.321, lr=0.1]  3%|▎         | 4/136 [02:10<1:00:33, 27.53s/epoch, loss=1.25, accuracy=0.69, val_loss=2.31, val_accuracy=0.415, lr=0.1]   4%|▎         | 5/136 [02:32<55:11, 25.28s/epoch, loss=1.23, accuracy=0.707, val_loss=2.68, val_accuracy=0.359, lr=0.1]   4%|▍         | 6/136 [02:53<51:47, 23.90s/epoch, loss=1.21, accuracy=0.719, val_loss=2.14, val_accuracy=0.411, lr=0.1]  5%|▌         | 7/136 [03:14<49:25, 22.99s/epoch, loss=1.2, accuracy=0.726, val_loss=1.74, val_accuracy=0.541, lr=0.1]   6%|▌         | 8/136 [03:35<47:47, 22.40s/epoch, loss=1.18, accuracy=0.731, val_loss=4.22, val_accuracy=0.293, lr=0.1]  7%|▋         | 9/136 [03:57<46:46, 22.10s/epoch, loss=1.18, accuracy=0.732, val_loss=2.12, val_accuracy=0.471, lr=0.1]  7%|▋         | 10/136 [04:18<45:50, 21.83s/epoch, loss=1.18, accuracy=0.739, val_loss=1.49, val_accuracy=0.609, lr=0.1]  8%|▊         | 11/136 [04:39<45:11, 21.69s/epoch, loss=1.18, accuracy=0.736, val_loss=2.34, val_accuracy=0.425, lr=0.1]  9%|▉         | 12/136 [05:01<44:38, 21.60s/epoch, loss=1.17, accuracy=0.738, val_loss=2.51, val_accuracy=0.423, lr=0.1] 10%|▉         | 13/136 [05:21<43:51, 21.40s/epoch, loss=1.16, accuracy=0.742, val_loss=2.19, val_accuracy=0.423, lr=0.1] 10%|█         | 14/136 [05:43<43:30, 21.40s/epoch, loss=1.16, accuracy=0.744, val_loss=2.8, val_accuracy=0.42, lr=0.1]   11%|█         | 15/136 [06:04<43:02, 21.35s/epoch, loss=1.16, accuracy=0.744, val_loss=1.56, val_accuracy=0.603, lr=0.1] 12%|█▏        | 16/136 [06:26<42:47, 21.39s/epoch, loss=1.15, accuracy=0.745, val_loss=1.52, val_accuracy=0.63, lr=0.1]  12%|█▎        | 17/136 [06:47<42:22, 21.37s/epoch, loss=1.15, accuracy=0.747, val_loss=1.33, val_accuracy=0.674, lr=0.1] 13%|█▎        | 18/136 [07:08<41:52, 21.29s/epoch, loss=1.15, accuracy=0.748, val_loss=2.56, val_accuracy=0.439, lr=0.1] 14%|█▍        | 19/136 [07:30<41:38, 21.35s/epoch, loss=1.13, accuracy=0.751, val_loss=3.13, val_accuracy=0.425, lr=0.1] 15%|█▍        | 20/136 [07:51<41:16, 21.35s/epoch, loss=1.14, accuracy=0.752, val_loss=1.39, val_accuracy=0.662, lr=0.1] 15%|█▌        | 21/136 [08:12<40:57, 21.37s/epoch, loss=1.14, accuracy=0.75, val_loss=2.34, val_accuracy=0.415, lr=0.1]  16%|█▌        | 22/136 [08:34<40:37, 21.39s/epoch, loss=1.14, accuracy=0.753, val_loss=1.5, val_accuracy=0.64, lr=0.1]  17%|█▋        | 23/136 [08:55<40:14, 21.37s/epoch, loss=1.13, accuracy=0.754, val_loss=1.85, val_accuracy=0.546, lr=0.1] 18%|█▊        | 24/136 [09:16<39:53, 21.37s/epoch, loss=1.13, accuracy=0.752, val_loss=1.73, val_accuracy=0.575, lr=0.1] 18%|█▊        | 25/136 [09:38<39:30, 21.35s/epoch, loss=1.13, accuracy=0.755, val_loss=1.51, val_accuracy=0.626, lr=0.1] 19%|█▉        | 26/136 [09:59<39:15, 21.41s/epoch, loss=1.13, accuracy=0.754, val_loss=1.8, val_accuracy=0.556, lr=0.1]  20%|█▉        | 27/136 [10:21<38:54, 21.42s/epoch, loss=1.12, accuracy=0.755, val_loss=2.6, val_accuracy=0.378, lr=0.1] 21%|██        | 28/136 [10:42<38:35, 21.44s/epoch, loss=1.13, accuracy=0.752, val_loss=8.98, val_accuracy=0.143, lr=0.1] 21%|██▏       | 29/136 [11:04<38:11, 21.42s/epoch, loss=1.13, accuracy=0.757, val_loss=1.78, val_accuracy=0.567, lr=0.1] 22%|██▏       | 30/136 [11:25<37:54, 21.45s/epoch, loss=1.13, accuracy=0.755, val_loss=1.74, val_accuracy=0.555, lr=0.1] 23%|██▎       | 31/136 [11:46<37:29, 21.42s/epoch, loss=1.13, accuracy=0.757, val_loss=3.73, val_accuracy=0.295, lr=0.1] 24%|██▎       | 32/136 [12:08<37:04, 21.39s/epoch, loss=1.12, accuracy=0.758, val_loss=1.51, val_accuracy=0.632, lr=0.1] 24%|██▍       | 33/136 [12:29<36:49, 21.45s/epoch, loss=1.13, accuracy=0.756, val_loss=1.85, val_accuracy=0.525, lr=0.1] 25%|██▌       | 34/136 [12:51<36:30, 21.48s/epoch, loss=1.12, accuracy=0.756, val_loss=1.76, val_accuracy=0.522, lr=0.1] 26%|██▌       | 35/136 [13:12<36:10, 21.49s/epoch, loss=1.12, accuracy=0.756, val_loss=2.34, val_accuracy=0.397, lr=0.1] 26%|██▋       | 36/136 [13:34<35:44, 21.44s/epoch, loss=1.12, accuracy=0.757, val_loss=2.9, val_accuracy=0.383, lr=0.1]  27%|██▋       | 37/136 [13:55<35:20, 21.42s/epoch, loss=1.12, accuracy=0.76, val_loss=2.03, val_accuracy=0.506, lr=0.1] 28%|██▊       | 38/136 [14:16<34:56, 21.40s/epoch, loss=1.11, accuracy=0.758, val_loss=2.14, val_accuracy=0.51, lr=0.1] 29%|██▊       | 39/136 [14:38<34:30, 21.35s/epoch, loss=1.12, accuracy=0.758, val_loss=3.83, val_accuracy=0.251, lr=0.1] 29%|██▉       | 40/136 [14:59<34:07, 21.33s/epoch, loss=1.11, accuracy=0.758, val_loss=1.35, val_accuracy=0.685, lr=0.1] 30%|███       | 41/136 [15:20<33:44, 21.31s/epoch, loss=1.11, accuracy=0.757, val_loss=1.77, val_accuracy=0.518, lr=0.1] 31%|███       | 42/136 [15:42<33:21, 21.30s/epoch, loss=1.12, accuracy=0.755, val_loss=1.92, val_accuracy=0.519, lr=0.1] 32%|███▏      | 43/136 [16:03<33:04, 21.33s/epoch, loss=1.11, accuracy=0.758, val_loss=2.3, val_accuracy=0.414, lr=0.1]  32%|███▏      | 44/136 [16:24<32:36, 21.26s/epoch, loss=1.11, accuracy=0.758, val_loss=1.88, val_accuracy=0.527, lr=0.1] 33%|███▎      | 45/136 [16:45<32:13, 21.25s/epoch, loss=1.11, accuracy=0.76, val_loss=1.76, val_accuracy=0.54, lr=0.1]   34%|███▍      | 46/136 [17:07<31:59, 21.33s/epoch, loss=1.11, accuracy=0.76, val_loss=2.29, val_accuracy=0.424, lr=0.1] 35%|███▍      | 47/136 [17:28<31:29, 21.23s/epoch, loss=1.11, accuracy=0.761, val_loss=4.68, val_accuracy=0.236, lr=0.1] 35%|███▌      | 48/136 [17:49<31:10, 21.26s/epoch, loss=1.11, accuracy=0.76, val_loss=1.69, val_accuracy=0.562, lr=0.1]  36%|███▌      | 49/136 [18:10<30:50, 21.27s/epoch, loss=1.11, accuracy=0.759, val_loss=1.89, val_accuracy=0.516, lr=0.1] 37%|███▋      | 50/136 [18:31<30:08, 21.03s/epoch, loss=1.1, accuracy=0.76, val_loss=3.32, val_accuracy=0.252, lr=0.1]   38%|███▊      | 51/136 [18:52<29:56, 21.14s/epoch, loss=1.1, accuracy=0.759, val_loss=1.78, val_accuracy=0.505, lr=0.1] 38%|███▊      | 52/136 [19:13<29:32, 21.10s/epoch, loss=1.1, accuracy=0.761, val_loss=1.93, val_accuracy=0.478, lr=0.1] 39%|███▉      | 53/136 [19:35<29:15, 21.15s/epoch, loss=1.11, accuracy=0.758, val_loss=1.73, val_accuracy=0.565, lr=0.1] 40%|███▉      | 54/136 [19:56<29:05, 21.29s/epoch, loss=1.1, accuracy=0.76, val_loss=1.94, val_accuracy=0.552, lr=0.1]   40%|████      | 55/136 [20:18<28:49, 21.36s/epoch, loss=1.11, accuracy=0.76, val_loss=2.88, val_accuracy=0.399, lr=0.1] 41%|████      | 56/136 [20:39<28:20, 21.26s/epoch, loss=0.903, accuracy=0.817, val_loss=0.933, val_accuracy=0.794, lr=0.01] 42%|████▏     | 57/136 [21:00<28:04, 21.32s/epoch, loss=0.724, accuracy=0.851, val_loss=0.744, val_accuracy=0.832, lr=0.01] 43%|████▎     | 58/136 [21:21<27:36, 21.24s/epoch, loss=0.643, accuracy=0.86, val_loss=0.807, val_accuracy=0.796, lr=0.01]  43%|████▎     | 59/136 [21:42<27:08, 21.15s/epoch, loss=0.598, accuracy=0.863, val_loss=0.744, val_accuracy=0.807, lr=0.01] 44%|████▍     | 60/136 [22:03<26:51, 21.20s/epoch, loss=0.578, accuracy=0.863, val_loss=1.05, val_accuracy=0.712, lr=0.01]  45%|████▍     | 61/136 [22:25<26:37, 21.30s/epoch, loss=0.567, accuracy=0.864, val_loss=0.763, val_accuracy=0.803, lr=0.01] 46%|████▌     | 62/136 [22:46<26:19, 21.35s/epoch, loss=0.561, accuracy=0.867, val_loss=0.917, val_accuracy=0.75, lr=0.01]  46%|████▋     | 63/136 [23:08<25:55, 21.30s/epoch, loss=0.559, accuracy=0.866, val_loss=0.82, val_accuracy=0.786, lr=0.01] 47%|████▋     | 64/136 [23:29<25:30, 21.25s/epoch, loss=0.556, accuracy=0.869, val_loss=0.792, val_accuracy=0.794, lr=0.01] 48%|████▊     | 65/136 [23:50<25:14, 21.33s/epoch, loss=0.553, accuracy=0.87, val_loss=0.732, val_accuracy=0.815, lr=0.01]  49%|████▊     | 66/136 [24:12<24:55, 21.36s/epoch, loss=0.55, accuracy=0.872, val_loss=0.774, val_accuracy=0.793, lr=0.01] 49%|████▉     | 67/136 [24:33<24:32, 21.35s/epoch, loss=0.549, accuracy=0.873, val_loss=0.846, val_accuracy=0.787, lr=0.01] 50%|█████     | 68/136 [24:54<24:14, 21.38s/epoch, loss=0.553, accuracy=0.873, val_loss=0.7, val_accuracy=0.824, lr=0.01]   51%|█████     | 69/136 [25:16<23:56, 21.44s/epoch, loss=0.546, accuracy=0.876, val_loss=0.818, val_accuracy=0.784, lr=0.01] 51%|█████▏    | 70/136 [25:38<23:38, 21.49s/epoch, loss=0.548, accuracy=0.877, val_loss=1.03, val_accuracy=0.723, lr=0.01]  52%|█████▏    | 71/136 [25:59<23:11, 21.40s/epoch, loss=0.545, accuracy=0.877, val_loss=1.48, val_accuracy=0.656, lr=0.01] 53%|█████▎    | 72/136 [26:20<22:42, 21.30s/epoch, loss=0.547, accuracy=0.878, val_loss=0.809, val_accuracy=0.795, lr=0.01] 54%|█████▎    | 73/136 [26:41<22:26, 21.37s/epoch, loss=0.55, accuracy=0.877, val_loss=0.97, val_accuracy=0.754, lr=0.01]   54%|█████▍    | 74/136 [27:03<22:08, 21.43s/epoch, loss=0.542, accuracy=0.882, val_loss=0.666, val_accuracy=0.841, lr=0.01] 55%|█████▌    | 75/136 [27:24<21:36, 21.26s/epoch, loss=0.544, accuracy=0.88, val_loss=0.93, val_accuracy=0.77, lr=0.01]    56%|█████▌    | 76/136 [27:45<21:17, 21.30s/epoch, loss=0.551, accuracy=0.879, val_loss=0.813, val_accuracy=0.798, lr=0.01] 57%|█████▋    | 77/136 [28:07<20:55, 21.29s/epoch, loss=0.545, accuracy=0.881, val_loss=0.898, val_accuracy=0.771, lr=0.01] 57%|█████▋    | 78/136 [28:28<20:36, 21.32s/epoch, loss=0.54, accuracy=0.884, val_loss=0.895, val_accuracy=0.79, lr=0.01]   58%|█████▊    | 79/136 [28:49<20:15, 21.32s/epoch, loss=0.543, accuracy=0.883, val_loss=0.842, val_accuracy=0.793, lr=0.01] 59%|█████▉    | 80/136 [29:10<19:47, 21.20s/epoch, loss=0.547, accuracy=0.883, val_loss=0.907, val_accuracy=0.778, lr=0.01] 60%|█████▉    | 81/136 [29:31<19:26, 21.20s/epoch, loss=0.545, accuracy=0.883, val_loss=0.75, val_accuracy=0.821, lr=0.01]  60%|██████    | 82/136 [29:53<19:06, 21.24s/epoch, loss=0.546, accuracy=0.883, val_loss=0.826, val_accuracy=0.795, lr=0.01] 61%|██████    | 83/136 [30:14<18:50, 21.32s/epoch, loss=0.467, accuracy=0.912, val_loss=0.527, val_accuracy=0.888, lr=0.001] 62%|██████▏   | 84/136 [30:36<18:29, 21.33s/epoch, loss=0.419, accuracy=0.927, val_loss=0.509, val_accuracy=0.894, lr=0.001] 62%|██████▎   | 85/136 [30:57<18:07, 21.33s/epoch, loss=0.399, accuracy=0.933, val_loss=0.493, val_accuracy=0.896, lr=0.001] 63%|██████▎   | 86/136 [31:18<17:45, 21.30s/epoch, loss=0.38, accuracy=0.937, val_loss=0.481, val_accuracy=0.901, lr=0.001]  64%|██████▍   | 87/136 [31:39<17:20, 21.23s/epoch, loss=0.368, accuracy=0.939, val_loss=0.476, val_accuracy=0.9, lr=0.001]  65%|██████▍   | 88/136 [32:00<16:50, 21.04s/epoch, loss=0.356, accuracy=0.942, val_loss=0.476, val_accuracy=0.901, lr=0.001] 65%|██████▌   | 89/136 [32:21<16:25, 20.97s/epoch, loss=0.347, accuracy=0.942, val_loss=0.474, val_accuracy=0.898, lr=0.001] 66%|██████▌   | 90/136 [32:42<16:06, 21.01s/epoch, loss=0.334, accuracy=0.946, val_loss=0.461, val_accuracy=0.904, lr=0.001] 67%|██████▋   | 91/136 [33:02<15:38, 20.85s/epoch, loss=0.326, accuracy=0.947, val_loss=0.462, val_accuracy=0.901, lr=0.001] 68%|██████▊   | 92/136 [33:24<15:24, 21.00s/epoch, loss=0.318, accuracy=0.949, val_loss=0.462, val_accuracy=0.9, lr=0.001]   68%|██████▊   | 93/136 [33:45<15:03, 21.00s/epoch, loss=0.31, accuracy=0.949, val_loss=0.475, val_accuracy=0.897, lr=0.001] 69%|██████▉   | 94/136 [34:06<14:46, 21.11s/epoch, loss=0.302, accuracy=0.951, val_loss=0.452, val_accuracy=0.904, lr=0.001] 70%|██████▉   | 95/136 [34:27<14:26, 21.13s/epoch, loss=0.296, accuracy=0.95, val_loss=0.454, val_accuracy=0.897, lr=0.001]  71%|███████   | 96/136 [34:48<14:04, 21.12s/epoch, loss=0.287, accuracy=0.953, val_loss=0.463, val_accuracy=0.897, lr=0.001] 71%|███████▏  | 97/136 [35:09<13:42, 21.08s/epoch, loss=0.281, accuracy=0.955, val_loss=0.44, val_accuracy=0.902, lr=0.001]  72%|███████▏  | 98/136 [35:30<13:21, 21.10s/epoch, loss=0.277, accuracy=0.955, val_loss=0.459, val_accuracy=0.896, lr=0.001] 73%|███████▎  | 99/136 [35:51<12:50, 20.83s/epoch, loss=0.273, accuracy=0.954, val_loss=0.459, val_accuracy=0.897, lr=0.001] 74%|███████▎  | 100/136 [36:12<12:35, 20.98s/epoch, loss=0.266, accuracy=0.956, val_loss=0.466, val_accuracy=0.894, lr=0.001] 74%|███████▍  | 101/136 [36:33<12:15, 21.00s/epoch, loss=0.262, accuracy=0.956, val_loss=0.446, val_accuracy=0.899, lr=0.001] 75%|███████▌  | 102/136 [36:54<11:58, 21.14s/epoch, loss=0.255, accuracy=0.958, val_loss=0.438, val_accuracy=0.901, lr=0.001] 76%|███████▌  | 103/136 [37:15<11:36, 21.11s/epoch, loss=0.252, accuracy=0.958, val_loss=0.45, val_accuracy=0.897, lr=0.001]  76%|███████▋  | 104/136 [37:37<11:15, 21.11s/epoch, loss=0.249, accuracy=0.958, val_loss=0.443, val_accuracy=0.896, lr=0.001] 77%|███████▋  | 105/136 [37:58<10:54, 21.13s/epoch, loss=0.245, accuracy=0.958, val_loss=0.458, val_accuracy=0.894, lr=0.001] 78%|███████▊  | 106/136 [38:19<10:33, 21.12s/epoch, loss=0.241, accuracy=0.96, val_loss=0.465, val_accuracy=0.893, lr=0.001]  79%|███████▊  | 107/136 [38:38<09:58, 20.63s/epoch, loss=0.239, accuracy=0.959, val_loss=0.471, val_accuracy=0.891, lr=0.001] 79%|███████▉  | 108/136 [38:59<09:39, 20.70s/epoch, loss=0.235, accuracy=0.96, val_loss=0.474, val_accuracy=0.891, lr=0.001]  80%|████████  | 109/136 [39:20<09:18, 20.68s/epoch, loss=0.234, accuracy=0.96, val_loss=0.469, val_accuracy=0.889, lr=0.001] 81%|████████  | 110/136 [39:40<08:53, 20.53s/epoch, loss=0.217, accuracy=0.966, val_loss=0.409, val_accuracy=0.906, lr=1e-04] 82%|████████▏ | 111/136 [40:01<08:34, 20.56s/epoch, loss=0.204, accuracy=0.972, val_loss=0.408, val_accuracy=0.906, lr=1e-04] 82%|████████▏ | 112/136 [40:22<08:17, 20.74s/epoch, loss=0.2, accuracy=0.973, val_loss=0.405, val_accuracy=0.908, lr=1e-04]   83%|████████▎ | 113/136 [40:42<07:51, 20.50s/epoch, loss=0.197, accuracy=0.975, val_loss=0.406, val_accuracy=0.908, lr=1e-04] 84%|████████▍ | 114/136 [41:02<07:30, 20.49s/epoch, loss=0.198, accuracy=0.973, val_loss=0.402, val_accuracy=0.907, lr=1e-04] 85%|████████▍ | 115/136 [41:23<07:11, 20.54s/epoch, loss=0.195, accuracy=0.973, val_loss=0.404, val_accuracy=0.908, lr=1e-04] 85%|████████▌ | 116/136 [41:44<06:54, 20.73s/epoch, loss=0.193, accuracy=0.975, val_loss=0.405, val_accuracy=0.907, lr=1e-04] 86%|████████▌ | 117/136 [42:05<06:34, 20.76s/epoch, loss=0.192, accuracy=0.976, val_loss=0.404, val_accuracy=0.908, lr=1e-04] 87%|████████▋ | 118/136 [42:26<06:14, 20.80s/epoch, loss=0.19, accuracy=0.976, val_loss=0.406, val_accuracy=0.907, lr=1e-04]  88%|████████▊ | 119/136 [42:47<05:54, 20.85s/epoch, loss=0.189, accuracy=0.977, val_loss=0.405, val_accuracy=0.906, lr=1e-04] 88%|████████▊ | 120/136 [43:08<05:34, 20.93s/epoch, loss=0.188, accuracy=0.977, val_loss=0.406, val_accuracy=0.906, lr=1e-04] 89%|████████▉ | 121/136 [43:29<05:15, 21.03s/epoch, loss=0.186, accuracy=0.978, val_loss=0.407, val_accuracy=0.906, lr=1e-04] 90%|████████▉ | 122/136 [43:50<04:55, 21.07s/epoch, loss=0.185, accuracy=0.978, val_loss=0.405, val_accuracy=0.906, lr=1e-04] 90%|█████████ | 123/136 [44:11<04:34, 21.11s/epoch, loss=0.184, accuracy=0.978, val_loss=0.406, val_accuracy=0.907, lr=1e-04] 91%|█████████ | 124/136 [44:33<04:13, 21.15s/epoch, loss=0.182, accuracy=0.979, val_loss=0.405, val_accuracy=0.907, lr=5e-5]  92%|█████████▏| 125/136 [44:54<03:52, 21.17s/epoch, loss=0.182, accuracy=0.979, val_loss=0.403, val_accuracy=0.907, lr=5e-5] 93%|█████████▎| 126/136 [45:15<03:31, 21.19s/epoch, loss=0.181, accuracy=0.978, val_loss=0.404, val_accuracy=0.908, lr=5e-5] 93%|█████████▎| 127/136 [45:36<03:10, 21.22s/epoch, loss=0.18, accuracy=0.979, val_loss=0.404, val_accuracy=0.908, lr=5e-5]  94%|█████████▍| 128/136 [45:57<02:48, 21.09s/epoch, loss=0.182, accuracy=0.978, val_loss=0.404, val_accuracy=0.908, lr=5e-5] 95%|█████████▍| 129/136 [46:18<02:26, 20.93s/epoch, loss=0.18, accuracy=0.979, val_loss=0.403, val_accuracy=0.909, lr=5e-5]  96%|█████████▌| 130/136 [46:38<02:04, 20.77s/epoch, loss=0.178, accuracy=0.98, val_loss=0.402, val_accuracy=0.909, lr=5e-5] 96%|█████████▋| 131/136 [46:58<01:43, 20.64s/epoch, loss=0.179, accuracy=0.979, val_loss=0.404, val_accuracy=0.908, lr=5e-5] 97%|█████████▋| 132/136 [47:20<01:23, 20.83s/epoch, loss=0.177, accuracy=0.98, val_loss=0.403, val_accuracy=0.907, lr=5e-5]  98%|█████████▊| 133/136 [47:41<01:02, 20.95s/epoch, loss=0.177, accuracy=0.98, val_loss=0.403, val_accuracy=0.908, lr=5e-5] 99%|█████████▊| 134/136 [48:02<00:41, 20.95s/epoch, loss=0.177, accuracy=0.98, val_loss=0.404, val_accuracy=0.909, lr=5e-5] 99%|█████████▉| 135/136 [48:23<00:21, 21.02s/epoch, loss=0.176, accuracy=0.98, val_loss=0.405, val_accuracy=0.908, lr=5e-5]100%|██████████| 136/136 [48:43<00:00, 20.81s/epoch, loss=0.176, accuracy=0.98, val_loss=0.405, val_accuracy=0.906, lr=5e-5]100%|██████████| 136/136 [48:43<00:00, 21.50s/epoch, loss=0.176, accuracy=0.98, val_loss=0.405, val_accuracy=0.906, lr=5e-5]
Using real-time data augmentation.
Only one model saved

Loading model: 11_08_cifar10_ResNet20v1.h5
Test score: 0.40517061948776245
Test accuracy: 0.9057000279426575


* * * Run SGD for ID = 11_9. * * *


2024-03-13 04:46:21.077320: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 04:46:26.075944: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 04:46:26.076905: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-13 04:46:26.113151: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-03-13 04:46:26.113176: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 04:46:26.116479: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 04:46:26.116514: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 04:46:26.119109: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 04:46:26.119911: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 04:46:26.122583: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 04:46:26.123861: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 04:46:26.128135: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 04:46:26.128623: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 04:46:26.128688: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 04:46:27.277085: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-13 04:46:27.277555: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 04:46:27.277945: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-03-13 04:46:27.278003: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 04:46:27.278035: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 04:46:27.278069: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 04:46:27.278084: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 04:46:27.278099: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 04:46:27.278113: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 04:46:27.278128: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 04:46:27.278148: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 04:46:27.278577: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 04:46:27.278606: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 04:46:27.868111: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-13 04:46:27.868185: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-13 04:46:27.868198: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-13 04:46:27.869305: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11227 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN X (Pascal), pci bus id: 0000:03:00.0, compute capability: 6.1)
{'id': '11_09', 'seed': 9, 'out_folder': 'results/epoch_budget_2', 'batch_size': 128, 'epochs': 136, 'validation_split': 0.0, 'checkpointing': False, 'checkpoint_every': -1, 'hold_out_validation_split': 0.0, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'num_classes': 10, 'SSE_lr': False, 'test_time_augmentation': False, 'debug': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN X (Pascal)'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
y_train shape: (50000, 10)
x_val shape: (10000, 32, 32, 3)
y_val shape: (10000, 10)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/136 [00:00<?, ?epoch/s]2024-03-13 04:46:28.462386: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-13 04:46:28.474100: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2600020000 Hz
2024-03-13 04:46:30.359439: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 04:46:30.598866: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 04:46:31.386269: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-13 04:46:31.447277: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/136 [00:59<2:13:08, 59.17s/epoch, loss=2.76, accuracy=0.444, val_loss=2.59, val_accuracy=0.328, lr=0.1]  1%|▏         | 2/136 [01:20<1:22:41, 37.03s/epoch, loss=1.45, accuracy=0.614, val_loss=1.79, val_accuracy=0.518, lr=0.1]  2%|▏         | 3/136 [01:42<1:06:33, 30.02s/epoch, loss=1.31, accuracy=0.673, val_loss=1.76, val_accuracy=0.529, lr=0.1]  3%|▎         | 4/136 [02:03<58:27, 26.57s/epoch, loss=1.26, accuracy=0.698, val_loss=2.59, val_accuracy=0.359, lr=0.1]    4%|▎         | 5/136 [02:25<54:00, 24.74s/epoch, loss=1.24, accuracy=0.71, val_loss=1.75, val_accuracy=0.557, lr=0.1]   4%|▍         | 6/136 [02:46<51:01, 23.55s/epoch, loss=1.23, accuracy=0.717, val_loss=1.65, val_accuracy=0.58, lr=0.1]  5%|▌         | 7/136 [03:08<49:19, 22.94s/epoch, loss=1.22, accuracy=0.72, val_loss=2.98, val_accuracy=0.428, lr=0.1]  6%|▌         | 8/136 [03:28<47:25, 22.23s/epoch, loss=1.22, accuracy=0.727, val_loss=1.93, val_accuracy=0.534, lr=0.1]  7%|▋         | 9/136 [03:50<46:33, 22.00s/epoch, loss=1.21, accuracy=0.729, val_loss=1.45, val_accuracy=0.651, lr=0.1]  7%|▋         | 10/136 [04:11<45:54, 21.86s/epoch, loss=1.2, accuracy=0.735, val_loss=2.25, val_accuracy=0.481, lr=0.1]  8%|▊         | 11/136 [04:33<45:24, 21.80s/epoch, loss=1.19, accuracy=0.735, val_loss=1.6, val_accuracy=0.606, lr=0.1]  9%|▉         | 12/136 [04:55<45:01, 21.79s/epoch, loss=1.19, accuracy=0.737, val_loss=1.71, val_accuracy=0.592, lr=0.1] 10%|▉         | 13/136 [05:16<44:33, 21.73s/epoch, loss=1.18, accuracy=0.738, val_loss=1.6, val_accuracy=0.607, lr=0.1]  10%|█         | 14/136 [05:38<44:10, 21.72s/epoch, loss=1.18, accuracy=0.74, val_loss=3.65, val_accuracy=0.371, lr=0.1] 11%|█         | 15/136 [06:00<43:39, 21.65s/epoch, loss=1.18, accuracy=0.742, val_loss=1.95, val_accuracy=0.55, lr=0.1] 12%|█▏        | 16/136 [06:21<43:15, 21.63s/epoch, loss=1.18, accuracy=0.745, val_loss=1.66, val_accuracy=0.574, lr=0.1] 12%|█▎        | 17/136 [06:42<42:21, 21.36s/epoch, loss=1.17, accuracy=0.743, val_loss=2.21, val_accuracy=0.443, lr=0.1] 13%|█▎        | 18/136 [07:04<42:13, 21.47s/epoch, loss=1.18, accuracy=0.743, val_loss=3.36, val_accuracy=0.342, lr=0.1] 14%|█▍        | 19/136 [07:25<41:55, 21.50s/epoch, loss=1.18, accuracy=0.745, val_loss=1.35, val_accuracy=0.681, lr=0.1] 15%|█▍        | 20/136 [07:46<41:27, 21.44s/epoch, loss=1.16, accuracy=0.748, val_loss=2.47, val_accuracy=0.434, lr=0.1] 15%|█▌        | 21/136 [08:08<41:12, 21.50s/epoch, loss=1.16, accuracy=0.748, val_loss=2.19, val_accuracy=0.534, lr=0.1] 16%|█▌        | 22/136 [08:29<40:41, 21.42s/epoch, loss=1.17, accuracy=0.747, val_loss=2.55, val_accuracy=0.456, lr=0.1] 17%|█▋        | 23/136 [08:51<40:13, 21.36s/epoch, loss=1.15, accuracy=0.749, val_loss=1.68, val_accuracy=0.567, lr=0.1] 18%|█▊        | 24/136 [09:12<39:56, 21.39s/epoch, loss=1.16, accuracy=0.749, val_loss=2.45, val_accuracy=0.386, lr=0.1] 18%|█▊        | 25/136 [09:33<39:13, 21.20s/epoch, loss=1.16, accuracy=0.749, val_loss=2.63, val_accuracy=0.379, lr=0.1] 19%|█▉        | 26/136 [09:54<38:57, 21.25s/epoch, loss=1.15, accuracy=0.751, val_loss=3.02, val_accuracy=0.368, lr=0.1] 20%|█▉        | 27/136 [10:16<38:48, 21.37s/epoch, loss=1.14, accuracy=0.754, val_loss=1.63, val_accuracy=0.594, lr=0.1] 21%|██        | 28/136 [10:37<38:27, 21.37s/epoch, loss=1.14, accuracy=0.752, val_loss=3.31, val_accuracy=0.313, lr=0.1] 21%|██▏       | 29/136 [10:58<37:49, 21.21s/epoch, loss=1.15, accuracy=0.752, val_loss=1.87, val_accuracy=0.535, lr=0.1] 22%|██▏       | 30/136 [11:20<37:44, 21.36s/epoch, loss=1.15, accuracy=0.752, val_loss=2.74, val_accuracy=0.391, lr=0.1] 23%|██▎       | 31/136 [11:41<37:32, 21.45s/epoch, loss=1.14, accuracy=0.754, val_loss=2.04, val_accuracy=0.497, lr=0.1] 24%|██▎       | 32/136 [12:03<37:08, 21.43s/epoch, loss=1.14, accuracy=0.755, val_loss=2.09, val_accuracy=0.562, lr=0.1] 24%|██▍       | 33/136 [12:24<36:48, 21.44s/epoch, loss=1.14, accuracy=0.755, val_loss=2.48, val_accuracy=0.398, lr=0.1] 25%|██▌       | 34/136 [12:46<36:28, 21.46s/epoch, loss=1.14, accuracy=0.754, val_loss=1.71, val_accuracy=0.56, lr=0.1]  26%|██▌       | 35/136 [13:07<36:12, 21.51s/epoch, loss=1.14, accuracy=0.755, val_loss=1.57, val_accuracy=0.611, lr=0.1] 26%|██▋       | 36/136 [13:29<35:45, 21.46s/epoch, loss=1.13, accuracy=0.755, val_loss=2.2, val_accuracy=0.429, lr=0.1]  27%|██▋       | 37/136 [13:50<35:22, 21.44s/epoch, loss=1.13, accuracy=0.754, val_loss=4.77, val_accuracy=0.309, lr=0.1] 28%|██▊       | 38/136 [14:12<35:01, 21.44s/epoch, loss=1.13, accuracy=0.755, val_loss=1.69, val_accuracy=0.552, lr=0.1] 29%|██▊       | 39/136 [14:33<34:38, 21.42s/epoch, loss=1.13, accuracy=0.755, val_loss=1.83, val_accuracy=0.546, lr=0.1] 29%|██▉       | 40/136 [14:54<34:20, 21.47s/epoch, loss=1.12, accuracy=0.758, val_loss=1.52, val_accuracy=0.623, lr=0.1] 30%|███       | 41/136 [15:16<33:52, 21.40s/epoch, loss=1.13, accuracy=0.755, val_loss=2.51, val_accuracy=0.382, lr=0.1] 31%|███       | 42/136 [15:37<33:33, 21.42s/epoch, loss=1.12, accuracy=0.758, val_loss=2.08, val_accuracy=0.492, lr=0.1] 32%|███▏      | 43/136 [15:59<33:11, 21.41s/epoch, loss=1.12, accuracy=0.758, val_loss=1.65, val_accuracy=0.577, lr=0.1] 32%|███▏      | 44/136 [16:20<32:58, 21.51s/epoch, loss=1.12, accuracy=0.758, val_loss=1.6, val_accuracy=0.587, lr=0.1]  33%|███▎      | 45/136 [16:42<32:42, 21.57s/epoch, loss=1.13, accuracy=0.755, val_loss=1.64, val_accuracy=0.613, lr=0.1] 34%|███▍      | 46/136 [17:04<32:20, 21.56s/epoch, loss=1.13, accuracy=0.757, val_loss=2.17, val_accuracy=0.428, lr=0.1] 35%|███▍      | 47/136 [17:25<31:54, 21.51s/epoch, loss=1.13, accuracy=0.756, val_loss=3.72, val_accuracy=0.37, lr=0.1]  35%|███▌      | 48/136 [17:46<31:32, 21.50s/epoch, loss=1.13, accuracy=0.755, val_loss=2.31, val_accuracy=0.521, lr=0.1] 36%|███▌      | 49/136 [18:08<31:05, 21.44s/epoch, loss=1.12, accuracy=0.758, val_loss=2.47, val_accuracy=0.438, lr=0.1] 37%|███▋      | 50/136 [18:29<30:45, 21.46s/epoch, loss=1.12, accuracy=0.758, val_loss=1.75, val_accuracy=0.579, lr=0.1] 38%|███▊      | 51/136 [18:51<30:24, 21.47s/epoch, loss=1.12, accuracy=0.761, val_loss=1.76, val_accuracy=0.558, lr=0.1] 38%|███▊      | 52/136 [19:12<29:59, 21.43s/epoch, loss=1.12, accuracy=0.757, val_loss=1.74, val_accuracy=0.572, lr=0.1] 39%|███▉      | 53/136 [19:34<29:44, 21.51s/epoch, loss=1.12, accuracy=0.755, val_loss=2.18, val_accuracy=0.479, lr=0.1] 40%|███▉      | 54/136 [19:55<29:05, 21.29s/epoch, loss=1.11, accuracy=0.759, val_loss=1.77, val_accuracy=0.582, lr=0.1] 40%|████      | 55/136 [20:16<28:58, 21.46s/epoch, loss=1.12, accuracy=0.757, val_loss=2.22, val_accuracy=0.454, lr=0.1] 41%|████      | 56/136 [20:38<28:41, 21.52s/epoch, loss=0.925, accuracy=0.816, val_loss=0.911, val_accuracy=0.808, lr=0.01] 42%|████▏     | 57/136 [21:00<28:22, 21.56s/epoch, loss=0.74, accuracy=0.847, val_loss=0.786, val_accuracy=0.823, lr=0.01]  43%|████▎     | 58/136 [21:21<28:06, 21.62s/epoch, loss=0.654, accuracy=0.859, val_loss=0.723, val_accuracy=0.825, lr=0.01] 43%|████▎     | 59/136 [21:43<27:47, 21.66s/epoch, loss=0.607, accuracy=0.859, val_loss=1.13, val_accuracy=0.726, lr=0.01]  44%|████▍     | 60/136 [22:05<27:25, 21.65s/epoch, loss=0.582, accuracy=0.863, val_loss=0.782, val_accuracy=0.794, lr=0.01] 45%|████▍     | 61/136 [22:26<26:55, 21.54s/epoch, loss=0.57, accuracy=0.864, val_loss=0.852, val_accuracy=0.763, lr=0.01]  46%|████▌     | 62/136 [22:47<26:26, 21.44s/epoch, loss=0.568, accuracy=0.865, val_loss=0.76, val_accuracy=0.799, lr=0.01] 46%|████▋     | 63/136 [23:09<26:07, 21.47s/epoch, loss=0.562, accuracy=0.867, val_loss=0.744, val_accuracy=0.813, lr=0.01] 47%|████▋     | 64/136 [23:30<25:48, 21.51s/epoch, loss=0.556, accuracy=0.868, val_loss=1.61, val_accuracy=0.647, lr=0.01]  48%|████▊     | 65/136 [23:52<25:27, 21.52s/epoch, loss=0.559, accuracy=0.87, val_loss=0.795, val_accuracy=0.791, lr=0.01] 49%|████▊     | 66/136 [24:13<24:56, 21.37s/epoch, loss=0.555, accuracy=0.87, val_loss=0.715, val_accuracy=0.821, lr=0.01] 49%|████▉     | 67/136 [24:34<24:34, 21.37s/epoch, loss=0.556, accuracy=0.872, val_loss=0.767, val_accuracy=0.805, lr=0.01] 50%|█████     | 68/136 [24:56<24:15, 21.40s/epoch, loss=0.555, accuracy=0.872, val_loss=0.943, val_accuracy=0.759, lr=0.01] 51%|█████     | 69/136 [25:16<23:37, 21.16s/epoch, loss=0.553, accuracy=0.875, val_loss=0.852, val_accuracy=0.786, lr=0.01] 51%|█████▏    | 70/136 [25:38<23:24, 21.28s/epoch, loss=0.555, accuracy=0.875, val_loss=0.862, val_accuracy=0.776, lr=0.01] 52%|█████▏    | 71/136 [25:59<23:05, 21.32s/epoch, loss=0.547, accuracy=0.878, val_loss=0.816, val_accuracy=0.796, lr=0.01] 53%|█████▎    | 72/136 [26:21<22:44, 21.33s/epoch, loss=0.553, accuracy=0.878, val_loss=1.17, val_accuracy=0.711, lr=0.01]  54%|█████▎    | 73/136 [26:42<22:26, 21.37s/epoch, loss=0.553, accuracy=0.878, val_loss=0.743, val_accuracy=0.813, lr=0.01] 54%|█████▍    | 74/136 [27:04<22:06, 21.40s/epoch, loss=0.552, accuracy=0.878, val_loss=0.858, val_accuracy=0.788, lr=0.01] 55%|█████▌    | 75/136 [27:25<21:49, 21.47s/epoch, loss=0.552, accuracy=0.88, val_loss=0.884, val_accuracy=0.787, lr=0.01]  56%|█████▌    | 76/136 [27:47<21:27, 21.45s/epoch, loss=0.549, accuracy=0.881, val_loss=0.96, val_accuracy=0.757, lr=0.01] 57%|█████▋    | 77/136 [28:08<20:59, 21.35s/epoch, loss=0.551, accuracy=0.88, val_loss=0.881, val_accuracy=0.794, lr=0.01] 57%|█████▋    | 78/136 [28:29<20:41, 21.41s/epoch, loss=0.549, accuracy=0.883, val_loss=0.98, val_accuracy=0.75, lr=0.01]  58%|█████▊    | 79/136 [28:50<20:12, 21.27s/epoch, loss=0.552, accuracy=0.881, val_loss=0.811, val_accuracy=0.804, lr=0.01] 59%|█████▉    | 80/136 [29:11<19:43, 21.13s/epoch, loss=0.551, accuracy=0.883, val_loss=0.945, val_accuracy=0.763, lr=0.01] 60%|█████▉    | 81/136 [29:32<19:23, 21.15s/epoch, loss=0.551, accuracy=0.882, val_loss=0.855, val_accuracy=0.79, lr=0.01]  60%|██████    | 82/136 [29:54<19:05, 21.22s/epoch, loss=0.553, accuracy=0.882, val_loss=0.918, val_accuracy=0.77, lr=0.01] 61%|██████    | 83/136 [30:15<18:46, 21.26s/epoch, loss=0.478, accuracy=0.91, val_loss=0.536, val_accuracy=0.887, lr=0.001] 62%|██████▏   | 84/136 [30:37<18:28, 21.32s/epoch, loss=0.424, accuracy=0.928, val_loss=0.52, val_accuracy=0.891, lr=0.001] 62%|██████▎   | 85/136 [30:58<18:03, 21.24s/epoch, loss=0.401, accuracy=0.932, val_loss=0.51, val_accuracy=0.892, lr=0.001] 63%|██████▎   | 86/136 [31:18<17:32, 21.05s/epoch, loss=0.388, accuracy=0.935, val_loss=0.497, val_accuracy=0.896, lr=0.001] 64%|██████▍   | 87/136 [31:39<17:14, 21.11s/epoch, loss=0.372, accuracy=0.939, val_loss=0.495, val_accuracy=0.896, lr=0.001] 65%|██████▍   | 88/136 [32:01<17:00, 21.25s/epoch, loss=0.358, accuracy=0.943, val_loss=0.483, val_accuracy=0.899, lr=0.001] 65%|██████▌   | 89/136 [32:23<16:41, 21.32s/epoch, loss=0.348, accuracy=0.944, val_loss=0.493, val_accuracy=0.895, lr=0.001] 66%|██████▌   | 90/136 [32:43<16:15, 21.20s/epoch, loss=0.337, accuracy=0.947, val_loss=0.475, val_accuracy=0.897, lr=0.001] 67%|██████▋   | 91/136 [33:05<15:54, 21.22s/epoch, loss=0.326, accuracy=0.947, val_loss=0.474, val_accuracy=0.895, lr=0.001] 68%|██████▊   | 92/136 [33:26<15:35, 21.25s/epoch, loss=0.322, accuracy=0.948, val_loss=0.471, val_accuracy=0.896, lr=0.001] 68%|██████▊   | 93/136 [33:47<15:16, 21.31s/epoch, loss=0.313, accuracy=0.95, val_loss=0.476, val_accuracy=0.896, lr=0.001]  69%|██████▉   | 94/136 [34:09<14:53, 21.26s/epoch, loss=0.305, accuracy=0.951, val_loss=0.471, val_accuracy=0.894, lr=0.001] 70%|██████▉   | 95/136 [34:30<14:32, 21.28s/epoch, loss=0.298, accuracy=0.952, val_loss=0.471, val_accuracy=0.894, lr=0.001] 71%|███████   | 96/136 [34:51<14:09, 21.25s/epoch, loss=0.293, accuracy=0.952, val_loss=0.464, val_accuracy=0.9, lr=0.001]   71%|███████▏  | 97/136 [35:13<13:50, 21.30s/epoch, loss=0.284, accuracy=0.956, val_loss=0.456, val_accuracy=0.898, lr=0.001] 72%|███████▏  | 98/136 [35:34<13:27, 21.25s/epoch, loss=0.277, accuracy=0.956, val_loss=0.454, val_accuracy=0.897, lr=0.001] 73%|███████▎  | 99/136 [35:55<13:03, 21.17s/epoch, loss=0.273, accuracy=0.956, val_loss=0.452, val_accuracy=0.898, lr=0.001] 74%|███████▎  | 100/136 [36:16<12:46, 21.28s/epoch, loss=0.267, accuracy=0.957, val_loss=0.466, val_accuracy=0.892, lr=0.001] 74%|███████▍  | 101/136 [36:38<12:27, 21.37s/epoch, loss=0.263, accuracy=0.958, val_loss=0.465, val_accuracy=0.894, lr=0.001] 75%|███████▌  | 102/136 [36:59<12:07, 21.39s/epoch, loss=0.259, accuracy=0.957, val_loss=0.465, val_accuracy=0.893, lr=0.001] 76%|███████▌  | 103/136 [37:21<11:45, 21.37s/epoch, loss=0.253, accuracy=0.958, val_loss=0.466, val_accuracy=0.893, lr=0.001] 76%|███████▋  | 104/136 [37:42<11:26, 21.44s/epoch, loss=0.25, accuracy=0.959, val_loss=0.478, val_accuracy=0.892, lr=0.001]  77%|███████▋  | 105/136 [38:04<11:04, 21.45s/epoch, loss=0.246, accuracy=0.96, val_loss=0.469, val_accuracy=0.891, lr=0.001] 78%|███████▊  | 106/136 [38:24<10:37, 21.24s/epoch, loss=0.243, accuracy=0.96, val_loss=0.494, val_accuracy=0.886, lr=0.001] 79%|███████▊  | 107/136 [38:45<10:07, 20.94s/epoch, loss=0.24, accuracy=0.959, val_loss=0.475, val_accuracy=0.888, lr=0.001] 79%|███████▉  | 108/136 [39:06<09:49, 21.07s/epoch, loss=0.237, accuracy=0.961, val_loss=0.487, val_accuracy=0.887, lr=0.001] 80%|████████  | 109/136 [39:27<09:30, 21.14s/epoch, loss=0.233, accuracy=0.961, val_loss=0.466, val_accuracy=0.889, lr=0.001] 81%|████████  | 110/136 [39:49<09:10, 21.18s/epoch, loss=0.219, accuracy=0.967, val_loss=0.425, val_accuracy=0.904, lr=1e-04] 82%|████████▏ | 111/136 [40:10<08:48, 21.14s/epoch, loss=0.206, accuracy=0.972, val_loss=0.417, val_accuracy=0.904, lr=1e-04] 82%|████████▏ | 112/136 [40:31<08:29, 21.22s/epoch, loss=0.202, accuracy=0.973, val_loss=0.415, val_accuracy=0.906, lr=1e-04] 83%|████████▎ | 113/136 [40:52<08:06, 21.14s/epoch, loss=0.198, accuracy=0.975, val_loss=0.414, val_accuracy=0.905, lr=1e-04] 84%|████████▍ | 114/136 [41:13<07:43, 21.06s/epoch, loss=0.198, accuracy=0.975, val_loss=0.415, val_accuracy=0.905, lr=1e-04] 85%|████████▍ | 115/136 [41:34<07:24, 21.17s/epoch, loss=0.195, accuracy=0.975, val_loss=0.417, val_accuracy=0.906, lr=1e-04] 85%|████████▌ | 116/136 [41:55<06:59, 21.00s/epoch, loss=0.193, accuracy=0.976, val_loss=0.415, val_accuracy=0.906, lr=1e-04] 86%|████████▌ | 117/136 [42:16<06:41, 21.12s/epoch, loss=0.191, accuracy=0.977, val_loss=0.416, val_accuracy=0.907, lr=1e-04] 87%|████████▋ | 118/136 [42:37<06:16, 20.93s/epoch, loss=0.19, accuracy=0.978, val_loss=0.417, val_accuracy=0.906, lr=1e-04]  88%|████████▊ | 119/136 [42:58<05:57, 21.05s/epoch, loss=0.188, accuracy=0.977, val_loss=0.417, val_accuracy=0.906, lr=1e-04] 88%|████████▊ | 120/136 [43:19<05:36, 21.01s/epoch, loss=0.187, accuracy=0.978, val_loss=0.416, val_accuracy=0.908, lr=1e-04] 89%|████████▉ | 121/136 [43:40<05:16, 21.07s/epoch, loss=0.187, accuracy=0.978, val_loss=0.417, val_accuracy=0.908, lr=1e-04] 90%|████████▉ | 122/136 [44:02<04:56, 21.20s/epoch, loss=0.185, accuracy=0.978, val_loss=0.416, val_accuracy=0.905, lr=1e-04] 90%|█████████ | 123/136 [44:23<04:35, 21.20s/epoch, loss=0.185, accuracy=0.978, val_loss=0.419, val_accuracy=0.907, lr=1e-04] 91%|█████████ | 124/136 [44:44<04:14, 21.24s/epoch, loss=0.181, accuracy=0.981, val_loss=0.416, val_accuracy=0.906, lr=5e-5]  92%|█████████▏| 125/136 [45:05<03:53, 21.24s/epoch, loss=0.183, accuracy=0.979, val_loss=0.416, val_accuracy=0.906, lr=5e-5] 93%|█████████▎| 126/136 [45:27<03:32, 21.26s/epoch, loss=0.181, accuracy=0.979, val_loss=0.415, val_accuracy=0.907, lr=5e-5] 93%|█████████▎| 127/136 [45:48<03:11, 21.24s/epoch, loss=0.181, accuracy=0.98, val_loss=0.416, val_accuracy=0.906, lr=5e-5]  94%|█████████▍| 128/136 [46:09<02:49, 21.17s/epoch, loss=0.181, accuracy=0.98, val_loss=0.415, val_accuracy=0.907, lr=5e-5] 95%|█████████▍| 129/136 [46:30<02:27, 21.03s/epoch, loss=0.179, accuracy=0.98, val_loss=0.417, val_accuracy=0.906, lr=5e-5] 96%|█████████▌| 130/136 [46:50<02:05, 20.85s/epoch, loss=0.18, accuracy=0.98, val_loss=0.418, val_accuracy=0.905, lr=5e-5]  96%|█████████▋| 131/136 [47:11<01:44, 20.94s/epoch, loss=0.178, accuracy=0.98, val_loss=0.417, val_accuracy=0.905, lr=5e-5] 97%|█████████▋| 132/136 [47:32<01:23, 20.77s/epoch, loss=0.178, accuracy=0.98, val_loss=0.417, val_accuracy=0.906, lr=5e-5] 98%|█████████▊| 133/136 [47:52<01:02, 20.70s/epoch, loss=0.178, accuracy=0.98, val_loss=0.418, val_accuracy=0.906, lr=5e-5] 99%|█████████▊| 134/136 [48:13<00:41, 20.66s/epoch, loss=0.178, accuracy=0.98, val_loss=0.418, val_accuracy=0.904, lr=5e-5] 99%|█████████▉| 135/136 [48:33<00:20, 20.64s/epoch, loss=0.178, accuracy=0.98, val_loss=0.418, val_accuracy=0.906, lr=5e-5]100%|██████████| 136/136 [48:54<00:00, 20.58s/epoch, loss=0.177, accuracy=0.98, val_loss=0.416, val_accuracy=0.905, lr=5e-5]100%|██████████| 136/136 [48:54<00:00, 21.58s/epoch, loss=0.177, accuracy=0.98, val_loss=0.416, val_accuracy=0.905, lr=5e-5]
Using real-time data augmentation.
Only one model saved

Loading model: 11_09_cifar10_ResNet20v1.h5
Test score: 0.4158557653427124
Test accuracy: 0.9053000211715698


* * * Run SGD for ID = 11_10. * * *


2024-03-13 05:35:28.427437: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 05:35:37.731138: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 05:35:37.732808: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-13 05:35:37.773877: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-03-13 05:35:37.773904: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 05:35:37.819446: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 05:35:37.819485: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 05:35:37.912749: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 05:35:37.961389: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 05:35:37.993419: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 05:35:38.015160: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 05:35:38.045052: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 05:35:38.045510: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 05:35:38.045599: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 05:35:39.781403: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-13 05:35:39.782051: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 05:35:39.782741: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-03-13 05:35:39.782771: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 05:35:39.782813: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 05:35:39.782830: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 05:35:39.782845: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 05:35:39.782859: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 05:35:39.782876: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 05:35:39.782892: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 05:35:39.782910: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 05:35:39.783381: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 05:35:39.783415: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 05:35:41.738656: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-13 05:35:41.738712: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-13 05:35:41.738721: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-13 05:35:41.739600: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11227 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN X (Pascal), pci bus id: 0000:03:00.0, compute capability: 6.1)
{'id': '11_10', 'seed': 10, 'out_folder': 'results/epoch_budget_2', 'batch_size': 128, 'epochs': 136, 'validation_split': 0.0, 'checkpointing': False, 'checkpoint_every': -1, 'hold_out_validation_split': 0.0, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'num_classes': 10, 'SSE_lr': False, 'test_time_augmentation': False, 'debug': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN X (Pascal)'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
y_train shape: (50000, 10)
x_val shape: (10000, 32, 32, 3)
y_val shape: (10000, 10)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/136 [00:00<?, ?epoch/s]2024-03-13 05:35:42.327306: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-13 05:35:42.327907: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2600020000 Hz
2024-03-13 05:35:44.132917: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 05:35:44.480554: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 05:35:45.758152: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-13 05:35:45.808288: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/136 [00:55<2:05:26, 55.75s/epoch, loss=2.97, accuracy=0.343, val_loss=2.39, val_accuracy=0.254, lr=0.1]  1%|▏         | 2/136 [01:17<1:19:33, 35.62s/epoch, loss=1.55, accuracy=0.544, val_loss=2.4, val_accuracy=0.399, lr=0.1]   2%|▏         | 3/136 [01:38<1:04:23, 29.05s/epoch, loss=1.33, accuracy=0.648, val_loss=2.42, val_accuracy=0.407, lr=0.1]  3%|▎         | 4/136 [01:59<56:55, 25.87s/epoch, loss=1.28, accuracy=0.685, val_loss=3.14, val_accuracy=0.219, lr=0.1]    4%|▎         | 5/136 [02:20<52:48, 24.19s/epoch, loss=1.24, accuracy=0.706, val_loss=1.7, val_accuracy=0.54, lr=0.1]    4%|▍         | 6/136 [02:41<50:08, 23.14s/epoch, loss=1.23, accuracy=0.715, val_loss=2.64, val_accuracy=0.331, lr=0.1]  5%|▌         | 7/136 [03:03<48:26, 22.53s/epoch, loss=1.21, accuracy=0.723, val_loss=1.5, val_accuracy=0.619, lr=0.1]   6%|▌         | 8/136 [03:24<47:23, 22.22s/epoch, loss=1.21, accuracy=0.728, val_loss=2.9, val_accuracy=0.471, lr=0.1]  7%|▋         | 9/136 [03:45<46:27, 21.95s/epoch, loss=1.2, accuracy=0.732, val_loss=1.77, val_accuracy=0.542, lr=0.1]  7%|▋         | 10/136 [04:06<45:28, 21.65s/epoch, loss=1.19, accuracy=0.733, val_loss=2.31, val_accuracy=0.466, lr=0.1]  8%|▊         | 11/136 [04:28<44:50, 21.53s/epoch, loss=1.19, accuracy=0.737, val_loss=1.4, val_accuracy=0.654, lr=0.1]   9%|▉         | 12/136 [04:49<44:14, 21.41s/epoch, loss=1.18, accuracy=0.741, val_loss=1.96, val_accuracy=0.534, lr=0.1] 10%|▉         | 13/136 [05:10<43:27, 21.20s/epoch, loss=1.18, accuracy=0.74, val_loss=1.52, val_accuracy=0.627, lr=0.1]  10%|█         | 14/136 [05:31<42:57, 21.12s/epoch, loss=1.17, accuracy=0.743, val_loss=1.66, val_accuracy=0.59, lr=0.1] 11%|█         | 15/136 [05:52<42:40, 21.16s/epoch, loss=1.18, accuracy=0.743, val_loss=2.16, val_accuracy=0.516, lr=0.1] 12%|█▏        | 16/136 [06:13<42:28, 21.24s/epoch, loss=1.18, accuracy=0.744, val_loss=1.56, val_accuracy=0.644, lr=0.1] 12%|█▎        | 17/136 [06:34<42:05, 21.22s/epoch, loss=1.16, accuracy=0.745, val_loss=2.09, val_accuracy=0.47, lr=0.1]  13%|█▎        | 18/136 [06:55<41:36, 21.16s/epoch, loss=1.17, accuracy=0.743, val_loss=1.47, val_accuracy=0.635, lr=0.1] 14%|█▍        | 19/136 [07:16<41:12, 21.14s/epoch, loss=1.16, accuracy=0.746, val_loss=1.39, val_accuracy=0.674, lr=0.1] 15%|█▍        | 20/136 [07:37<40:38, 21.02s/epoch, loss=1.16, accuracy=0.746, val_loss=2.31, val_accuracy=0.483, lr=0.1] 15%|█▌        | 21/136 [07:58<40:22, 21.06s/epoch, loss=1.17, accuracy=0.746, val_loss=2.08, val_accuracy=0.461, lr=0.1] 16%|█▌        | 22/136 [08:20<40:15, 21.19s/epoch, loss=1.15, accuracy=0.749, val_loss=2.16, val_accuracy=0.461, lr=0.1] 17%|█▋        | 23/136 [08:41<40:02, 21.26s/epoch, loss=1.16, accuracy=0.748, val_loss=1.68, val_accuracy=0.566, lr=0.1] 18%|█▊        | 24/136 [09:03<39:46, 21.31s/epoch, loss=1.15, accuracy=0.751, val_loss=1.95, val_accuracy=0.526, lr=0.1] 18%|█▊        | 25/136 [09:24<39:26, 21.32s/epoch, loss=1.15, accuracy=0.752, val_loss=2.15, val_accuracy=0.525, lr=0.1] 19%|█▉        | 26/136 [09:45<38:56, 21.24s/epoch, loss=1.15, accuracy=0.751, val_loss=2.9, val_accuracy=0.352, lr=0.1]  20%|█▉        | 27/136 [10:06<38:29, 21.19s/epoch, loss=1.15, accuracy=0.752, val_loss=1.45, val_accuracy=0.657, lr=0.1] 21%|██        | 28/136 [10:27<38:05, 21.16s/epoch, loss=1.16, accuracy=0.75, val_loss=3.28, val_accuracy=0.381, lr=0.1]  21%|██▏       | 29/136 [10:48<37:36, 21.09s/epoch, loss=1.14, accuracy=0.754, val_loss=2.27, val_accuracy=0.408, lr=0.1] 22%|██▏       | 30/136 [11:09<36:57, 20.92s/epoch, loss=1.16, accuracy=0.751, val_loss=1.53, val_accuracy=0.621, lr=0.1] 23%|██▎       | 31/136 [11:30<36:46, 21.01s/epoch, loss=1.15, accuracy=0.752, val_loss=1.51, val_accuracy=0.612, lr=0.1] 24%|██▎       | 32/136 [11:51<36:34, 21.10s/epoch, loss=1.14, accuracy=0.752, val_loss=2.28, val_accuracy=0.485, lr=0.1] 24%|██▍       | 33/136 [12:12<36:09, 21.07s/epoch, loss=1.14, accuracy=0.753, val_loss=3.57, val_accuracy=0.356, lr=0.1] 25%|██▌       | 34/136 [12:33<35:48, 21.06s/epoch, loss=1.14, accuracy=0.754, val_loss=1.81, val_accuracy=0.559, lr=0.1] 26%|██▌       | 35/136 [12:55<35:32, 21.11s/epoch, loss=1.14, accuracy=0.753, val_loss=2.34, val_accuracy=0.481, lr=0.1] 26%|██▋       | 36/136 [13:16<35:21, 21.21s/epoch, loss=1.14, accuracy=0.756, val_loss=1.58, val_accuracy=0.592, lr=0.1] 27%|██▋       | 37/136 [13:37<35:03, 21.24s/epoch, loss=1.14, accuracy=0.755, val_loss=1.56, val_accuracy=0.619, lr=0.1] 28%|██▊       | 38/136 [13:58<34:39, 21.22s/epoch, loss=1.13, accuracy=0.756, val_loss=1.64, val_accuracy=0.567, lr=0.1] 29%|██▊       | 39/136 [14:20<34:13, 21.17s/epoch, loss=1.14, accuracy=0.754, val_loss=3.65, val_accuracy=0.241, lr=0.1] 29%|██▉       | 40/136 [14:41<33:51, 21.16s/epoch, loss=1.13, accuracy=0.757, val_loss=2.6, val_accuracy=0.342, lr=0.1]  30%|███       | 41/136 [15:02<33:25, 21.11s/epoch, loss=1.14, accuracy=0.756, val_loss=2.05, val_accuracy=0.459, lr=0.1] 31%|███       | 42/136 [15:23<32:59, 21.06s/epoch, loss=1.13, accuracy=0.758, val_loss=1.9, val_accuracy=0.522, lr=0.1]  32%|███▏      | 43/136 [15:44<32:42, 21.10s/epoch, loss=1.13, accuracy=0.755, val_loss=3.72, val_accuracy=0.308, lr=0.1] 32%|███▏      | 44/136 [16:05<32:26, 21.15s/epoch, loss=1.12, accuracy=0.758, val_loss=1.83, val_accuracy=0.524, lr=0.1] 33%|███▎      | 45/136 [16:26<31:48, 20.98s/epoch, loss=1.13, accuracy=0.757, val_loss=1.89, val_accuracy=0.507, lr=0.1] 34%|███▍      | 46/136 [16:46<31:15, 20.84s/epoch, loss=1.13, accuracy=0.758, val_loss=1.98, val_accuracy=0.447, lr=0.1] 35%|███▍      | 47/136 [17:08<31:09, 21.01s/epoch, loss=1.12, accuracy=0.757, val_loss=5.34, val_accuracy=0.232, lr=0.1] 35%|███▌      | 48/136 [17:29<30:49, 21.01s/epoch, loss=1.12, accuracy=0.757, val_loss=3.31, val_accuracy=0.315, lr=0.1] 36%|███▌      | 49/136 [17:50<30:27, 21.00s/epoch, loss=1.13, accuracy=0.758, val_loss=1.67, val_accuracy=0.563, lr=0.1] 37%|███▋      | 50/136 [18:11<30:19, 21.15s/epoch, loss=1.12, accuracy=0.757, val_loss=2.8, val_accuracy=0.388, lr=0.1]  38%|███▊      | 51/136 [18:32<29:58, 21.16s/epoch, loss=1.12, accuracy=0.757, val_loss=2.05, val_accuracy=0.491, lr=0.1] 38%|███▊      | 52/136 [18:54<29:42, 21.22s/epoch, loss=1.12, accuracy=0.757, val_loss=1.61, val_accuracy=0.596, lr=0.1] 39%|███▉      | 53/136 [19:15<29:24, 21.26s/epoch, loss=1.12, accuracy=0.757, val_loss=1.77, val_accuracy=0.522, lr=0.1] 40%|███▉      | 54/136 [19:36<29:05, 21.29s/epoch, loss=1.12, accuracy=0.755, val_loss=2.21, val_accuracy=0.452, lr=0.1] 40%|████      | 55/136 [19:58<28:43, 21.27s/epoch, loss=1.11, accuracy=0.759, val_loss=2.24, val_accuracy=0.435, lr=0.1] 41%|████      | 56/136 [20:19<28:22, 21.28s/epoch, loss=0.905, accuracy=0.817, val_loss=0.868, val_accuracy=0.818, lr=0.01] 42%|████▏     | 57/136 [20:40<28:05, 21.33s/epoch, loss=0.727, accuracy=0.848, val_loss=0.729, val_accuracy=0.835, lr=0.01] 43%|████▎     | 58/136 [21:02<27:51, 21.43s/epoch, loss=0.648, accuracy=0.856, val_loss=0.751, val_accuracy=0.813, lr=0.01] 43%|████▎     | 59/136 [21:24<27:35, 21.50s/epoch, loss=0.604, accuracy=0.861, val_loss=0.818, val_accuracy=0.793, lr=0.01] 44%|████▍     | 60/136 [21:45<27:09, 21.44s/epoch, loss=0.581, accuracy=0.863, val_loss=0.731, val_accuracy=0.809, lr=0.01] 45%|████▍     | 61/136 [22:06<26:33, 21.25s/epoch, loss=0.569, accuracy=0.864, val_loss=0.903, val_accuracy=0.767, lr=0.01] 46%|████▌     | 62/136 [22:27<26:06, 21.17s/epoch, loss=0.567, accuracy=0.864, val_loss=0.69, val_accuracy=0.824, lr=0.01]  46%|████▋     | 63/136 [22:48<25:48, 21.21s/epoch, loss=0.559, accuracy=0.866, val_loss=0.873, val_accuracy=0.776, lr=0.01] 47%|████▋     | 64/136 [23:09<25:22, 21.14s/epoch, loss=0.557, accuracy=0.869, val_loss=0.827, val_accuracy=0.79, lr=0.01]  48%|████▊     | 65/136 [23:31<25:09, 21.26s/epoch, loss=0.561, accuracy=0.867, val_loss=0.91, val_accuracy=0.771, lr=0.01] 49%|████▊     | 66/136 [23:52<24:52, 21.32s/epoch, loss=0.557, accuracy=0.87, val_loss=1.08, val_accuracy=0.718, lr=0.01]  49%|████▉     | 67/136 [24:13<24:29, 21.30s/epoch, loss=0.554, accuracy=0.874, val_loss=0.79, val_accuracy=0.802, lr=0.01] 50%|█████     | 68/136 [24:34<24:06, 21.27s/epoch, loss=0.554, accuracy=0.873, val_loss=0.774, val_accuracy=0.8, lr=0.01]  51%|█████     | 69/136 [24:56<23:43, 21.24s/epoch, loss=0.556, accuracy=0.874, val_loss=1.01, val_accuracy=0.737, lr=0.01] 51%|█████▏    | 70/136 [25:17<23:15, 21.14s/epoch, loss=0.549, accuracy=0.877, val_loss=0.693, val_accuracy=0.83, lr=0.01] 52%|█████▏    | 71/136 [25:38<22:54, 21.14s/epoch, loss=0.556, accuracy=0.874, val_loss=0.953, val_accuracy=0.766, lr=0.01] 53%|█████▎    | 72/136 [25:59<22:31, 21.12s/epoch, loss=0.553, accuracy=0.877, val_loss=0.851, val_accuracy=0.779, lr=0.01] 54%|█████▎    | 73/136 [26:20<22:08, 21.08s/epoch, loss=0.552, accuracy=0.88, val_loss=0.788, val_accuracy=0.802, lr=0.01]  54%|█████▍    | 74/136 [26:41<21:54, 21.20s/epoch, loss=0.551, accuracy=0.879, val_loss=0.843, val_accuracy=0.792, lr=0.01] 55%|█████▌    | 75/136 [27:02<21:30, 21.15s/epoch, loss=0.551, accuracy=0.88, val_loss=0.907, val_accuracy=0.776, lr=0.01]  56%|█████▌    | 76/136 [27:23<21:02, 21.04s/epoch, loss=0.552, accuracy=0.879, val_loss=0.771, val_accuracy=0.81, lr=0.01] 57%|█████▋    | 77/136 [27:44<20:44, 21.10s/epoch, loss=0.552, accuracy=0.882, val_loss=0.831, val_accuracy=0.793, lr=0.01] 57%|█████▋    | 78/136 [28:05<20:25, 21.13s/epoch, loss=0.554, accuracy=0.881, val_loss=0.956, val_accuracy=0.771, lr=0.01] 58%|█████▊    | 79/136 [28:27<20:08, 21.21s/epoch, loss=0.547, accuracy=0.882, val_loss=0.864, val_accuracy=0.79, lr=0.01]  59%|█████▉    | 80/136 [28:48<19:48, 21.23s/epoch, loss=0.551, accuracy=0.882, val_loss=0.996, val_accuracy=0.755, lr=0.01] 60%|█████▉    | 81/136 [29:09<19:29, 21.26s/epoch, loss=0.551, accuracy=0.882, val_loss=0.734, val_accuracy=0.83, lr=0.01]  60%|██████    | 82/136 [29:30<18:48, 20.90s/epoch, loss=0.554, accuracy=0.881, val_loss=1.03, val_accuracy=0.738, lr=0.01] 61%|██████    | 83/136 [29:51<18:31, 20.97s/epoch, loss=0.482, accuracy=0.909, val_loss=0.538, val_accuracy=0.888, lr=0.001] 62%|██████▏   | 84/136 [30:12<18:10, 20.96s/epoch, loss=0.427, accuracy=0.925, val_loss=0.524, val_accuracy=0.892, lr=0.001] 62%|██████▎   | 85/136 [30:33<17:49, 20.97s/epoch, loss=0.403, accuracy=0.932, val_loss=0.51, val_accuracy=0.896, lr=0.001]  63%|██████▎   | 86/136 [30:54<17:30, 21.02s/epoch, loss=0.387, accuracy=0.935, val_loss=0.5, val_accuracy=0.899, lr=0.001]  64%|██████▍   | 87/136 [31:15<17:13, 21.09s/epoch, loss=0.374, accuracy=0.937, val_loss=0.493, val_accuracy=0.899, lr=0.001] 65%|██████▍   | 88/136 [31:36<16:56, 21.17s/epoch, loss=0.361, accuracy=0.94, val_loss=0.492, val_accuracy=0.9, lr=0.001]    65%|██████▌   | 89/136 [31:57<16:27, 21.01s/epoch, loss=0.349, accuracy=0.944, val_loss=0.499, val_accuracy=0.896, lr=0.001] 66%|██████▌   | 90/136 [32:18<16:08, 21.05s/epoch, loss=0.339, accuracy=0.945, val_loss=0.484, val_accuracy=0.896, lr=0.001] 67%|██████▋   | 91/136 [32:39<15:45, 21.02s/epoch, loss=0.33, accuracy=0.946, val_loss=0.479, val_accuracy=0.899, lr=0.001]  68%|██████▊   | 92/136 [33:00<15:26, 21.06s/epoch, loss=0.32, accuracy=0.948, val_loss=0.466, val_accuracy=0.902, lr=0.001] 68%|██████▊   | 93/136 [33:21<15:05, 21.06s/epoch, loss=0.313, accuracy=0.949, val_loss=0.462, val_accuracy=0.901, lr=0.001] 69%|██████▉   | 94/136 [33:43<14:46, 21.11s/epoch, loss=0.306, accuracy=0.951, val_loss=0.469, val_accuracy=0.898, lr=0.001] 70%|██████▉   | 95/136 [34:03<14:23, 21.06s/epoch, loss=0.3, accuracy=0.95, val_loss=0.464, val_accuracy=0.898, lr=0.001]    71%|███████   | 96/136 [34:25<14:05, 21.13s/epoch, loss=0.292, accuracy=0.953, val_loss=0.459, val_accuracy=0.901, lr=0.001] 71%|███████▏  | 97/136 [34:46<13:46, 21.19s/epoch, loss=0.283, accuracy=0.955, val_loss=0.471, val_accuracy=0.896, lr=0.001] 72%|███████▏  | 98/136 [35:07<13:25, 21.19s/epoch, loss=0.279, accuracy=0.955, val_loss=0.481, val_accuracy=0.894, lr=0.001] 73%|███████▎  | 99/136 [35:28<13:04, 21.19s/epoch, loss=0.278, accuracy=0.954, val_loss=0.47, val_accuracy=0.893, lr=0.001]  74%|███████▎  | 100/136 [35:49<12:36, 21.03s/epoch, loss=0.269, accuracy=0.955, val_loss=0.469, val_accuracy=0.896, lr=0.001] 74%|███████▍  | 101/136 [36:09<12:05, 20.73s/epoch, loss=0.266, accuracy=0.956, val_loss=0.466, val_accuracy=0.897, lr=0.001] 75%|███████▌  | 102/136 [36:28<11:26, 20.19s/epoch, loss=0.258, accuracy=0.959, val_loss=0.538, val_accuracy=0.877, lr=0.001] 76%|███████▌  | 103/136 [36:49<11:10, 20.31s/epoch, loss=0.256, accuracy=0.958, val_loss=0.457, val_accuracy=0.896, lr=0.001] 76%|███████▋  | 104/136 [37:09<10:51, 20.35s/epoch, loss=0.254, accuracy=0.957, val_loss=0.477, val_accuracy=0.889, lr=0.001] 77%|███████▋  | 105/136 [37:29<10:30, 20.34s/epoch, loss=0.246, accuracy=0.959, val_loss=0.432, val_accuracy=0.903, lr=0.001] 78%|███████▊  | 106/136 [37:50<10:09, 20.33s/epoch, loss=0.241, accuracy=0.959, val_loss=0.451, val_accuracy=0.896, lr=0.001] 79%|███████▊  | 107/136 [38:10<09:48, 20.30s/epoch, loss=0.242, accuracy=0.959, val_loss=0.458, val_accuracy=0.899, lr=0.001] 79%|███████▉  | 108/136 [38:30<09:24, 20.15s/epoch, loss=0.24, accuracy=0.959, val_loss=0.463, val_accuracy=0.894, lr=0.001]  80%|████████  | 109/136 [38:50<09:04, 20.17s/epoch, loss=0.236, accuracy=0.958, val_loss=0.593, val_accuracy=0.862, lr=0.001] 81%|████████  | 110/136 [39:10<08:45, 20.20s/epoch, loss=0.218, accuracy=0.966, val_loss=0.425, val_accuracy=0.903, lr=1e-04] 82%|████████▏ | 111/136 [39:31<08:28, 20.34s/epoch, loss=0.207, accuracy=0.971, val_loss=0.424, val_accuracy=0.904, lr=1e-04] 82%|████████▏ | 112/136 [39:51<08:07, 20.30s/epoch, loss=0.204, accuracy=0.973, val_loss=0.423, val_accuracy=0.904, lr=1e-04] 83%|████████▎ | 113/136 [40:10<07:39, 20.00s/epoch, loss=0.2, accuracy=0.973, val_loss=0.422, val_accuracy=0.906, lr=1e-04]   84%|████████▍ | 114/136 [40:29<07:13, 19.69s/epoch, loss=0.198, accuracy=0.973, val_loss=0.422, val_accuracy=0.905, lr=1e-04] 85%|████████▍ | 115/136 [40:48<06:48, 19.46s/epoch, loss=0.197, accuracy=0.975, val_loss=0.421, val_accuracy=0.905, lr=1e-04] 85%|████████▌ | 116/136 [41:09<06:35, 19.76s/epoch, loss=0.193, accuracy=0.976, val_loss=0.424, val_accuracy=0.906, lr=1e-04] 86%|████████▌ | 117/136 [41:29<06:17, 19.87s/epoch, loss=0.195, accuracy=0.975, val_loss=0.421, val_accuracy=0.907, lr=1e-04] 87%|████████▋ | 118/136 [41:49<06:01, 20.08s/epoch, loss=0.192, accuracy=0.976, val_loss=0.422, val_accuracy=0.907, lr=1e-04] 88%|████████▊ | 119/136 [42:08<05:34, 19.66s/epoch, loss=0.189, accuracy=0.977, val_loss=0.421, val_accuracy=0.908, lr=1e-04] 88%|████████▊ | 120/136 [42:28<05:14, 19.69s/epoch, loss=0.191, accuracy=0.976, val_loss=0.423, val_accuracy=0.906, lr=1e-04] 89%|████████▉ | 121/136 [42:47<04:53, 19.55s/epoch, loss=0.189, accuracy=0.977, val_loss=0.423, val_accuracy=0.907, lr=1e-04] 90%|████████▉ | 122/136 [43:08<04:38, 19.87s/epoch, loss=0.187, accuracy=0.978, val_loss=0.421, val_accuracy=0.908, lr=1e-04] 90%|█████████ | 123/136 [43:28<04:18, 19.88s/epoch, loss=0.185, accuracy=0.978, val_loss=0.42, val_accuracy=0.908, lr=1e-04]  91%|█████████ | 124/136 [43:48<04:00, 20.02s/epoch, loss=0.187, accuracy=0.977, val_loss=0.421, val_accuracy=0.907, lr=5e-5] 92%|█████████▏| 125/136 [44:09<03:41, 20.18s/epoch, loss=0.183, accuracy=0.979, val_loss=0.421, val_accuracy=0.906, lr=5e-5] 93%|█████████▎| 126/136 [44:29<03:22, 20.28s/epoch, loss=0.182, accuracy=0.98, val_loss=0.42, val_accuracy=0.907, lr=5e-5]   93%|█████████▎| 127/136 [44:49<03:00, 20.10s/epoch, loss=0.183, accuracy=0.978, val_loss=0.422, val_accuracy=0.906, lr=5e-5] 94%|█████████▍| 128/136 [45:09<02:41, 20.23s/epoch, loss=0.184, accuracy=0.978, val_loss=0.422, val_accuracy=0.906, lr=5e-5] 95%|█████████▍| 129/136 [45:29<02:21, 20.16s/epoch, loss=0.181, accuracy=0.979, val_loss=0.418, val_accuracy=0.907, lr=5e-5] 96%|█████████▌| 130/136 [45:48<01:57, 19.59s/epoch, loss=0.181, accuracy=0.98, val_loss=0.421, val_accuracy=0.907, lr=5e-5]  96%|█████████▋| 131/136 [46:06<01:36, 19.39s/epoch, loss=0.179, accuracy=0.98, val_loss=0.42, val_accuracy=0.907, lr=5e-5]  97%|█████████▋| 132/136 [46:27<01:18, 19.70s/epoch, loss=0.179, accuracy=0.979, val_loss=0.421, val_accuracy=0.906, lr=5e-5] 98%|█████████▊| 133/136 [46:47<00:59, 19.95s/epoch, loss=0.178, accuracy=0.98, val_loss=0.42, val_accuracy=0.907, lr=5e-5]   99%|█████████▊| 134/136 [47:08<00:40, 20.02s/epoch, loss=0.178, accuracy=0.981, val_loss=0.421, val_accuracy=0.907, lr=5e-5] 99%|█████████▉| 135/136 [47:28<00:20, 20.09s/epoch, loss=0.178, accuracy=0.98, val_loss=0.421, val_accuracy=0.907, lr=5e-5] 100%|██████████| 136/136 [47:48<00:00, 20.09s/epoch, loss=0.178, accuracy=0.98, val_loss=0.419, val_accuracy=0.906, lr=5e-5]100%|██████████| 136/136 [47:48<00:00, 21.09s/epoch, loss=0.178, accuracy=0.98, val_loss=0.419, val_accuracy=0.906, lr=5e-5]
Using real-time data augmentation.
Only one model saved

Loading model: 11_10_cifar10_ResNet20v1.h5
Test score: 0.4187115728855133
Test accuracy: 0.9061999917030334


* * * Run SGD for ID = 11_11. * * *


2024-03-13 06:23:34.233281: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 06:23:36.502887: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 06:23:36.509990: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-13 06:23:36.545725: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-03-13 06:23:36.545752: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 06:23:36.548182: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 06:23:36.548219: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 06:23:36.550129: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 06:23:36.550672: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 06:23:36.552818: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 06:23:36.554087: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 06:23:36.558183: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 06:23:36.558639: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 06:23:36.558723: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 06:23:37.715734: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-13 06:23:37.716773: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 06:23:37.717234: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN X (Pascal) computeCapability: 6.1
coreClock: 1.531GHz coreCount: 28 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 447.48GiB/s
2024-03-13 06:23:37.717261: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 06:23:37.717292: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 06:23:37.717309: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 06:23:37.717324: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 06:23:37.717338: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 06:23:37.717353: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 06:23:37.717367: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 06:23:37.717382: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 06:23:37.717794: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 06:23:37.717824: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 06:23:38.319923: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-13 06:23:38.319987: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-13 06:23:38.320001: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-13 06:23:38.321166: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11227 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN X (Pascal), pci bus id: 0000:03:00.0, compute capability: 6.1)
{'id': '11_11', 'seed': 11, 'out_folder': 'results/epoch_budget_2', 'batch_size': 128, 'epochs': 136, 'validation_split': 0.0, 'checkpointing': False, 'checkpoint_every': -1, 'hold_out_validation_split': 0.0, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'num_classes': 10, 'SSE_lr': False, 'test_time_augmentation': False, 'debug': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN X (Pascal)'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
y_train shape: (50000, 10)
x_val shape: (10000, 32, 32, 3)
y_val shape: (10000, 10)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/136 [00:00<?, ?epoch/s]2024-03-13 06:23:38.874767: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-13 06:23:38.887060: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2600020000 Hz
2024-03-13 06:23:40.609859: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 06:23:40.850029: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 06:23:41.507597: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-13 06:23:41.562135: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/136 [00:50<1:54:19, 50.81s/epoch, loss=2.66, accuracy=0.472, val_loss=2.65, val_accuracy=0.314, lr=0.1]  1%|▏         | 2/136 [01:10<1:12:24, 32.42s/epoch, loss=1.41, accuracy=0.633, val_loss=2.6, val_accuracy=0.385, lr=0.1]   2%|▏         | 3/136 [01:30<59:10, 26.70s/epoch, loss=1.29, accuracy=0.681, val_loss=1.6, val_accuracy=0.562, lr=0.1]    3%|▎         | 4/136 [01:51<53:56, 24.52s/epoch, loss=1.26, accuracy=0.7, val_loss=1.79, val_accuracy=0.523, lr=0.1]   4%|▎         | 5/136 [02:12<50:30, 23.13s/epoch, loss=1.24, accuracy=0.708, val_loss=2.34, val_accuracy=0.388, lr=0.1]  4%|▍         | 6/136 [02:33<48:33, 22.41s/epoch, loss=1.22, accuracy=0.717, val_loss=1.79, val_accuracy=0.531, lr=0.1]  5%|▌         | 7/136 [02:54<47:09, 21.94s/epoch, loss=1.21, accuracy=0.723, val_loss=1.73, val_accuracy=0.563, lr=0.1]  6%|▌         | 8/136 [03:13<45:18, 21.24s/epoch, loss=1.2, accuracy=0.727, val_loss=1.75, val_accuracy=0.53, lr=0.1]    7%|▋         | 9/136 [03:32<43:34, 20.59s/epoch, loss=1.2, accuracy=0.73, val_loss=1.42, val_accuracy=0.658, lr=0.1]  7%|▋         | 10/136 [03:54<43:31, 20.73s/epoch, loss=1.18, accuracy=0.734, val_loss=1.95, val_accuracy=0.511, lr=0.1]  8%|▊         | 11/136 [04:14<43:09, 20.72s/epoch, loss=1.18, accuracy=0.74, val_loss=1.44, val_accuracy=0.64, lr=0.1]    9%|▉         | 12/136 [04:35<42:57, 20.79s/epoch, loss=1.18, accuracy=0.741, val_loss=3.09, val_accuracy=0.329, lr=0.1] 10%|▉         | 13/136 [04:56<42:35, 20.77s/epoch, loss=1.18, accuracy=0.738, val_loss=1.69, val_accuracy=0.568, lr=0.1] 10%|█         | 14/136 [05:17<42:17, 20.80s/epoch, loss=1.17, accuracy=0.741, val_loss=1.42, val_accuracy=0.656, lr=0.1] 11%|█         | 15/136 [05:38<41:55, 20.79s/epoch, loss=1.17, accuracy=0.744, val_loss=1.98, val_accuracy=0.446, lr=0.1] 12%|█▏        | 16/136 [05:59<41:43, 20.86s/epoch, loss=1.17, accuracy=0.745, val_loss=3.31, val_accuracy=0.335, lr=0.1] 12%|█▎        | 17/136 [06:20<41:32, 20.94s/epoch, loss=1.16, accuracy=0.746, val_loss=1.52, val_accuracy=0.63, lr=0.1]  13%|█▎        | 18/136 [06:41<41:19, 21.01s/epoch, loss=1.16, accuracy=0.746, val_loss=2.59, val_accuracy=0.361, lr=0.1] 14%|█▍        | 19/136 [07:02<40:59, 21.02s/epoch, loss=1.16, accuracy=0.746, val_loss=1.75, val_accuracy=0.558, lr=0.1] 15%|█▍        | 20/136 [07:22<40:02, 20.71s/epoch, loss=1.15, accuracy=0.746, val_loss=1.77, val_accuracy=0.541, lr=0.1] 15%|█▌        | 21/136 [07:42<39:36, 20.66s/epoch, loss=1.16, accuracy=0.748, val_loss=1.72, val_accuracy=0.58, lr=0.1]  16%|█▌        | 22/136 [08:03<39:26, 20.76s/epoch, loss=1.16, accuracy=0.748, val_loss=1.57, val_accuracy=0.612, lr=0.1] 17%|█▋        | 23/136 [08:24<39:16, 20.86s/epoch, loss=1.15, accuracy=0.747, val_loss=1.77, val_accuracy=0.587, lr=0.1] 18%|█▊        | 24/136 [08:46<39:05, 20.95s/epoch, loss=1.15, accuracy=0.749, val_loss=1.63, val_accuracy=0.602, lr=0.1] 18%|█▊        | 25/136 [09:06<38:38, 20.89s/epoch, loss=1.15, accuracy=0.751, val_loss=1.43, val_accuracy=0.656, lr=0.1] 19%|█▉        | 26/136 [09:27<38:09, 20.82s/epoch, loss=1.15, accuracy=0.752, val_loss=2.36, val_accuracy=0.427, lr=0.1] 20%|█▉        | 27/136 [09:48<37:43, 20.76s/epoch, loss=1.14, accuracy=0.751, val_loss=1.45, val_accuracy=0.645, lr=0.1] 21%|██        | 28/136 [10:08<37:19, 20.74s/epoch, loss=1.15, accuracy=0.753, val_loss=1.81, val_accuracy=0.516, lr=0.1] 21%|██▏       | 29/136 [10:27<35:58, 20.17s/epoch, loss=1.14, accuracy=0.752, val_loss=2.73, val_accuracy=0.367, lr=0.1] 22%|██▏       | 30/136 [10:48<35:49, 20.28s/epoch, loss=1.14, accuracy=0.752, val_loss=2.15, val_accuracy=0.448, lr=0.1] 23%|██▎       | 31/136 [11:09<35:44, 20.43s/epoch, loss=1.14, accuracy=0.752, val_loss=1.65, val_accuracy=0.619, lr=0.1] 24%|██▎       | 32/136 [11:29<35:39, 20.58s/epoch, loss=1.15, accuracy=0.753, val_loss=2.14, val_accuracy=0.482, lr=0.1] 24%|██▍       | 33/136 [11:51<35:35, 20.74s/epoch, loss=1.14, accuracy=0.754, val_loss=2.37, val_accuracy=0.308, lr=0.1] 25%|██▌       | 34/136 [12:11<35:12, 20.71s/epoch, loss=1.15, accuracy=0.755, val_loss=2.71, val_accuracy=0.396, lr=0.1] 26%|██▌       | 35/136 [12:32<34:48, 20.68s/epoch, loss=1.14, accuracy=0.752, val_loss=2.24, val_accuracy=0.425, lr=0.1] 26%|██▋       | 36/136 [12:52<34:21, 20.62s/epoch, loss=1.13, accuracy=0.753, val_loss=3.03, val_accuracy=0.318, lr=0.1] 27%|██▋       | 37/136 [13:12<33:44, 20.45s/epoch, loss=1.14, accuracy=0.753, val_loss=2.67, val_accuracy=0.405, lr=0.1] 28%|██▊       | 38/136 [13:33<33:29, 20.50s/epoch, loss=1.14, accuracy=0.756, val_loss=3.37, val_accuracy=0.324, lr=0.1] 29%|██▊       | 39/136 [13:54<33:18, 20.61s/epoch, loss=1.13, accuracy=0.752, val_loss=1.86, val_accuracy=0.571, lr=0.1] 29%|██▉       | 40/136 [14:15<33:16, 20.80s/epoch, loss=1.13, accuracy=0.757, val_loss=2.86, val_accuracy=0.333, lr=0.1] 30%|███       | 41/136 [14:36<32:57, 20.82s/epoch, loss=1.12, accuracy=0.756, val_loss=1.75, val_accuracy=0.549, lr=0.1] 31%|███       | 42/136 [14:57<32:47, 20.94s/epoch, loss=1.14, accuracy=0.756, val_loss=1.57, val_accuracy=0.609, lr=0.1] 32%|███▏      | 43/136 [15:18<32:27, 20.94s/epoch, loss=1.13, accuracy=0.753, val_loss=3.94, val_accuracy=0.317, lr=0.1] 32%|███▏      | 44/136 [15:39<32:05, 20.93s/epoch, loss=1.12, accuracy=0.756, val_loss=1.87, val_accuracy=0.517, lr=0.1] 33%|███▎      | 45/136 [16:00<31:45, 20.94s/epoch, loss=1.13, accuracy=0.757, val_loss=2.03, val_accuracy=0.493, lr=0.1] 34%|███▍      | 46/136 [16:21<31:22, 20.92s/epoch, loss=1.13, accuracy=0.756, val_loss=1.64, val_accuracy=0.588, lr=0.1] 35%|███▍      | 47/136 [16:41<30:53, 20.83s/epoch, loss=1.12, accuracy=0.756, val_loss=2.16, val_accuracy=0.43, lr=0.1]  35%|███▌      | 48/136 [17:03<30:44, 20.96s/epoch, loss=1.13, accuracy=0.756, val_loss=1.98, val_accuracy=0.509, lr=0.1] 36%|███▌      | 49/136 [17:24<30:29, 21.03s/epoch, loss=1.13, accuracy=0.756, val_loss=1.59, val_accuracy=0.601, lr=0.1] 37%|███▋      | 50/136 [17:45<30:13, 21.09s/epoch, loss=1.13, accuracy=0.759, val_loss=1.47, val_accuracy=0.638, lr=0.1] 38%|███▊      | 51/136 [18:06<29:41, 20.95s/epoch, loss=1.12, accuracy=0.756, val_loss=2.02, val_accuracy=0.467, lr=0.1] 38%|███▊      | 52/136 [18:27<29:15, 20.90s/epoch, loss=1.13, accuracy=0.757, val_loss=1.9, val_accuracy=0.498, lr=0.1]  39%|███▉      | 53/136 [18:47<28:52, 20.88s/epoch, loss=1.12, accuracy=0.76, val_loss=6.03, val_accuracy=0.179, lr=0.1] 40%|███▉      | 54/136 [19:08<28:36, 20.94s/epoch, loss=1.12, accuracy=0.756, val_loss=1.67, val_accuracy=0.58, lr=0.1] 40%|████      | 55/136 [19:30<28:19, 20.98s/epoch, loss=1.12, accuracy=0.757, val_loss=2.47, val_accuracy=0.446, lr=0.1] 41%|████      | 56/136 [19:49<27:28, 20.61s/epoch, loss=0.906, accuracy=0.815, val_loss=1.03, val_accuracy=0.754, lr=0.01] 42%|████▏     | 57/136 [20:10<27:08, 20.61s/epoch, loss=0.724, accuracy=0.849, val_loss=0.812, val_accuracy=0.808, lr=0.01] 43%|████▎     | 58/136 [20:30<26:46, 20.60s/epoch, loss=0.643, accuracy=0.858, val_loss=0.799, val_accuracy=0.803, lr=0.01] 43%|████▎     | 59/136 [20:51<26:24, 20.58s/epoch, loss=0.603, accuracy=0.861, val_loss=1.01, val_accuracy=0.731, lr=0.01]  44%|████▍     | 60/136 [21:12<26:03, 20.58s/epoch, loss=0.582, accuracy=0.862, val_loss=0.739, val_accuracy=0.805, lr=0.01] 45%|████▍     | 61/136 [21:32<25:47, 20.63s/epoch, loss=0.573, accuracy=0.863, val_loss=1.09, val_accuracy=0.715, lr=0.01]  46%|████▌     | 62/136 [21:53<25:25, 20.61s/epoch, loss=0.564, accuracy=0.866, val_loss=0.819, val_accuracy=0.792, lr=0.01] 46%|████▋     | 63/136 [22:13<25:02, 20.58s/epoch, loss=0.565, accuracy=0.866, val_loss=0.767, val_accuracy=0.801, lr=0.01] 47%|████▋     | 64/136 [22:34<24:52, 20.72s/epoch, loss=0.561, accuracy=0.868, val_loss=0.73, val_accuracy=0.813, lr=0.01]  48%|████▊     | 65/136 [22:55<24:35, 20.78s/epoch, loss=0.553, accuracy=0.871, val_loss=0.784, val_accuracy=0.799, lr=0.01] 49%|████▊     | 66/136 [23:15<23:50, 20.44s/epoch, loss=0.555, accuracy=0.87, val_loss=0.813, val_accuracy=0.793, lr=0.01]  49%|████▉     | 67/136 [23:35<23:15, 20.23s/epoch, loss=0.553, accuracy=0.873, val_loss=0.993, val_accuracy=0.75, lr=0.01] 50%|█████     | 68/136 [23:53<22:22, 19.74s/epoch, loss=0.552, accuracy=0.874, val_loss=0.902, val_accuracy=0.767, lr=0.01] 51%|█████     | 69/136 [24:13<21:58, 19.68s/epoch, loss=0.554, accuracy=0.876, val_loss=0.695, val_accuracy=0.832, lr=0.01] 51%|█████▏    | 70/136 [24:34<22:08, 20.13s/epoch, loss=0.55, accuracy=0.877, val_loss=0.762, val_accuracy=0.809, lr=0.01]  52%|█████▏    | 71/136 [24:55<22:07, 20.43s/epoch, loss=0.552, accuracy=0.876, val_loss=0.937, val_accuracy=0.757, lr=0.01] 53%|█████▎    | 72/136 [25:16<22:02, 20.67s/epoch, loss=0.555, accuracy=0.877, val_loss=0.963, val_accuracy=0.758, lr=0.01] 54%|█████▎    | 73/136 [25:35<21:07, 20.11s/epoch, loss=0.553, accuracy=0.878, val_loss=0.866, val_accuracy=0.793, lr=0.01] 54%|█████▍    | 74/136 [25:56<21:03, 20.37s/epoch, loss=0.549, accuracy=0.88, val_loss=0.853, val_accuracy=0.786, lr=0.01]  55%|█████▌    | 75/136 [26:17<20:53, 20.55s/epoch, loss=0.548, accuracy=0.881, val_loss=1.17, val_accuracy=0.713, lr=0.01] 56%|█████▌    | 76/136 [26:38<20:30, 20.52s/epoch, loss=0.555, accuracy=0.88, val_loss=0.986, val_accuracy=0.756, lr=0.01] 57%|█████▋    | 77/136 [26:58<20:10, 20.52s/epoch, loss=0.553, accuracy=0.882, val_loss=0.961, val_accuracy=0.749, lr=0.01] 57%|█████▋    | 78/136 [27:19<20:03, 20.75s/epoch, loss=0.55, accuracy=0.881, val_loss=0.927, val_accuracy=0.77, lr=0.01]   58%|█████▊    | 79/136 [27:40<19:45, 20.81s/epoch, loss=0.55, accuracy=0.883, val_loss=1.48, val_accuracy=0.656, lr=0.01] 59%|█████▉    | 80/136 [28:00<18:59, 20.35s/epoch, loss=0.549, accuracy=0.884, val_loss=0.919, val_accuracy=0.764, lr=0.01] 60%|█████▉    | 81/136 [28:21<18:48, 20.53s/epoch, loss=0.548, accuracy=0.884, val_loss=0.805, val_accuracy=0.803, lr=0.01] 60%|██████    | 82/136 [28:41<18:27, 20.52s/epoch, loss=0.545, accuracy=0.885, val_loss=0.944, val_accuracy=0.761, lr=0.01] 61%|██████    | 83/136 [29:01<18:00, 20.39s/epoch, loss=0.476, accuracy=0.91, val_loss=0.534, val_accuracy=0.892, lr=0.001] 62%|██████▏   | 84/136 [29:22<17:45, 20.50s/epoch, loss=0.421, accuracy=0.929, val_loss=0.519, val_accuracy=0.894, lr=0.001] 62%|██████▎   | 85/136 [29:42<17:24, 20.48s/epoch, loss=0.399, accuracy=0.933, val_loss=0.507, val_accuracy=0.898, lr=0.001] 63%|██████▎   | 86/136 [30:03<17:08, 20.57s/epoch, loss=0.384, accuracy=0.936, val_loss=0.507, val_accuracy=0.896, lr=0.001] 64%|██████▍   | 87/136 [30:24<16:56, 20.74s/epoch, loss=0.369, accuracy=0.94, val_loss=0.488, val_accuracy=0.899, lr=0.001]  65%|██████▍   | 88/136 [30:45<16:35, 20.74s/epoch, loss=0.358, accuracy=0.941, val_loss=0.48, val_accuracy=0.9, lr=0.001]   65%|██████▌   | 89/136 [31:06<16:18, 20.82s/epoch, loss=0.346, accuracy=0.945, val_loss=0.474, val_accuracy=0.903, lr=0.001] 66%|██████▌   | 90/136 [31:27<16:00, 20.88s/epoch, loss=0.336, accuracy=0.946, val_loss=0.492, val_accuracy=0.896, lr=0.001] 67%|██████▋   | 91/136 [31:48<15:37, 20.84s/epoch, loss=0.325, accuracy=0.948, val_loss=0.472, val_accuracy=0.9, lr=0.001]   68%|██████▊   | 92/136 [32:09<15:19, 20.89s/epoch, loss=0.321, accuracy=0.947, val_loss=0.48, val_accuracy=0.897, lr=0.001] 68%|██████▊   | 93/136 [32:28<14:42, 20.53s/epoch, loss=0.309, accuracy=0.951, val_loss=0.494, val_accuracy=0.895, lr=0.001] 69%|██████▉   | 94/136 [32:48<14:11, 20.26s/epoch, loss=0.301, accuracy=0.952, val_loss=0.479, val_accuracy=0.899, lr=0.001] 70%|██████▉   | 95/136 [33:09<14:03, 20.56s/epoch, loss=0.294, accuracy=0.953, val_loss=0.469, val_accuracy=0.9, lr=0.001]   71%|███████   | 96/136 [33:31<13:49, 20.74s/epoch, loss=0.286, accuracy=0.955, val_loss=0.473, val_accuracy=0.9, lr=0.001] 71%|███████▏  | 97/136 [33:52<13:32, 20.83s/epoch, loss=0.281, accuracy=0.955, val_loss=0.471, val_accuracy=0.897, lr=0.001] 72%|███████▏  | 98/136 [34:12<13:05, 20.68s/epoch, loss=0.275, accuracy=0.956, val_loss=0.482, val_accuracy=0.891, lr=0.001] 73%|███████▎  | 99/136 [34:33<12:51, 20.85s/epoch, loss=0.268, accuracy=0.957, val_loss=0.462, val_accuracy=0.9, lr=0.001]   74%|███████▎  | 100/136 [34:53<12:24, 20.68s/epoch, loss=0.264, accuracy=0.957, val_loss=0.45, val_accuracy=0.902, lr=0.001] 74%|███████▍  | 101/136 [35:15<12:10, 20.86s/epoch, loss=0.261, accuracy=0.957, val_loss=0.459, val_accuracy=0.897, lr=0.001] 75%|███████▌  | 102/136 [35:36<11:52, 20.97s/epoch, loss=0.257, accuracy=0.958, val_loss=0.461, val_accuracy=0.897, lr=0.001] 76%|███████▌  | 103/136 [35:57<11:33, 21.02s/epoch, loss=0.252, accuracy=0.958, val_loss=0.473, val_accuracy=0.893, lr=0.001] 76%|███████▋  | 104/136 [36:18<11:13, 21.05s/epoch, loss=0.249, accuracy=0.959, val_loss=0.445, val_accuracy=0.895, lr=0.001] 77%|███████▋  | 105/136 [36:39<10:49, 20.95s/epoch, loss=0.243, accuracy=0.96, val_loss=0.453, val_accuracy=0.895, lr=0.001]  78%|███████▊  | 106/136 [36:59<10:22, 20.74s/epoch, loss=0.242, accuracy=0.96, val_loss=0.459, val_accuracy=0.894, lr=0.001] 79%|███████▊  | 107/136 [37:20<10:03, 20.80s/epoch, loss=0.237, accuracy=0.96, val_loss=0.461, val_accuracy=0.889, lr=0.001] 79%|███████▉  | 108/136 [37:40<09:33, 20.47s/epoch, loss=0.236, accuracy=0.96, val_loss=0.488, val_accuracy=0.89, lr=0.001]  80%|████████  | 109/136 [38:01<09:18, 20.69s/epoch, loss=0.234, accuracy=0.961, val_loss=0.446, val_accuracy=0.897, lr=0.001] 81%|████████  | 110/136 [38:22<08:59, 20.75s/epoch, loss=0.214, accuracy=0.967, val_loss=0.412, val_accuracy=0.908, lr=1e-04] 82%|████████▏ | 111/136 [38:43<08:39, 20.80s/epoch, loss=0.205, accuracy=0.972, val_loss=0.41, val_accuracy=0.91, lr=1e-04]   82%|████████▏ | 112/136 [39:03<08:17, 20.75s/epoch, loss=0.199, accuracy=0.974, val_loss=0.411, val_accuracy=0.909, lr=1e-04] 83%|████████▎ | 113/136 [39:25<07:59, 20.86s/epoch, loss=0.198, accuracy=0.974, val_loss=0.409, val_accuracy=0.907, lr=1e-04] 84%|████████▍ | 114/136 [39:46<07:40, 20.95s/epoch, loss=0.194, accuracy=0.977, val_loss=0.409, val_accuracy=0.908, lr=1e-04] 85%|████████▍ | 115/136 [40:07<07:20, 20.96s/epoch, loss=0.192, accuracy=0.976, val_loss=0.411, val_accuracy=0.908, lr=1e-04] 85%|████████▌ | 116/136 [40:27<06:57, 20.89s/epoch, loss=0.192, accuracy=0.976, val_loss=0.41, val_accuracy=0.909, lr=1e-04]  86%|████████▌ | 117/136 [40:48<06:36, 20.85s/epoch, loss=0.189, accuracy=0.977, val_loss=0.411, val_accuracy=0.91, lr=1e-04] 87%|████████▋ | 118/136 [41:09<06:14, 20.79s/epoch, loss=0.189, accuracy=0.977, val_loss=0.411, val_accuracy=0.909, lr=1e-04] 88%|████████▊ | 119/136 [41:28<05:45, 20.34s/epoch, loss=0.187, accuracy=0.978, val_loss=0.41, val_accuracy=0.908, lr=1e-04]  88%|████████▊ | 120/136 [41:48<05:21, 20.12s/epoch, loss=0.186, accuracy=0.979, val_loss=0.411, val_accuracy=0.909, lr=1e-04] 89%|████████▉ | 121/136 [42:07<04:56, 19.79s/epoch, loss=0.185, accuracy=0.978, val_loss=0.406, val_accuracy=0.911, lr=1e-04] 90%|████████▉ | 122/136 [42:27<04:38, 19.89s/epoch, loss=0.186, accuracy=0.977, val_loss=0.408, val_accuracy=0.909, lr=1e-04] 90%|█████████ | 123/136 [42:47<04:19, 19.93s/epoch, loss=0.183, accuracy=0.979, val_loss=0.408, val_accuracy=0.908, lr=1e-04] 91%|█████████ | 124/136 [43:08<04:02, 20.18s/epoch, loss=0.181, accuracy=0.979, val_loss=0.409, val_accuracy=0.91, lr=5e-5]   92%|█████████▏| 125/136 [43:28<03:43, 20.32s/epoch, loss=0.181, accuracy=0.978, val_loss=0.406, val_accuracy=0.91, lr=5e-5] 93%|█████████▎| 126/136 [43:49<03:25, 20.58s/epoch, loss=0.179, accuracy=0.98, val_loss=0.409, val_accuracy=0.909, lr=5e-5] 93%|█████████▎| 127/136 [44:10<03:04, 20.47s/epoch, loss=0.181, accuracy=0.979, val_loss=0.409, val_accuracy=0.909, lr=5e-5] 94%|█████████▍| 128/136 [44:30<02:44, 20.55s/epoch, loss=0.181, accuracy=0.98, val_loss=0.409, val_accuracy=0.909, lr=5e-5]  95%|█████████▍| 129/136 [44:51<02:23, 20.46s/epoch, loss=0.178, accuracy=0.98, val_loss=0.409, val_accuracy=0.909, lr=5e-5] 96%|█████████▌| 130/136 [45:11<02:02, 20.34s/epoch, loss=0.178, accuracy=0.98, val_loss=0.409, val_accuracy=0.909, lr=5e-5] 96%|█████████▋| 131/136 [45:31<01:41, 20.35s/epoch, loss=0.178, accuracy=0.981, val_loss=0.41, val_accuracy=0.91, lr=5e-5]  97%|█████████▋| 132/136 [45:52<01:21, 20.39s/epoch, loss=0.176, accuracy=0.98, val_loss=0.41, val_accuracy=0.91, lr=5e-5]  98%|█████████▊| 133/136 [46:12<01:01, 20.53s/epoch, loss=0.177, accuracy=0.98, val_loss=0.409, val_accuracy=0.91, lr=5e-5] 99%|█████████▊| 134/136 [46:33<00:40, 20.40s/epoch, loss=0.176, accuracy=0.981, val_loss=0.409, val_accuracy=0.909, lr=5e-5] 99%|█████████▉| 135/136 [46:53<00:20, 20.33s/epoch, loss=0.176, accuracy=0.981, val_loss=0.408, val_accuracy=0.91, lr=5e-5] 100%|██████████| 136/136 [47:12<00:00, 19.96s/epoch, loss=0.175, accuracy=0.981, val_loss=0.411, val_accuracy=0.909, lr=5e-5]100%|██████████| 136/136 [47:12<00:00, 20.83s/epoch, loss=0.175, accuracy=0.981, val_loss=0.411, val_accuracy=0.909, lr=5e-5]
Using real-time data augmentation.
Only one model saved

Loading model: 11_11_cifar10_ResNet20v1.h5
Test score: 0.41088783740997314
Test accuracy: 0.9093999862670898

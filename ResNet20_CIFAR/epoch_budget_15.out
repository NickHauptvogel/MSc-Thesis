Thu Feb 15 13:13:07 2024       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 535.104.05             Driver Version: 535.104.05   CUDA Version: 12.2     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA TITAN Xp                Off | 00000000:02:00.0 Off |                  N/A |
| 46%   71C    P0              87W / 250W |      0MiB / 12288MiB |     20%      Default |
|                                         |                      |                  N/A |
+-----------------------------------------+----------------------+----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
|  No running processes found                                                           |
+---------------------------------------------------------------------------------------+


* * * Run SGD for cluster size = 15. * * *


Budget: 100


* * * Run SGD for ID = 15_1. * * *


2024-02-15 13:13:08.258583: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 13:13:12.449531: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 13:13:12.450609: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-15 13:13:12.491063: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 13:13:12.491096: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 13:13:12.510344: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 13:13:12.510400: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 13:13:12.513155: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 13:13:12.514021: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 13:13:12.516553: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 13:13:12.529258: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 13:13:12.548355: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 13:13:12.549039: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 13:13:12.549131: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 13:13:13.832715: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-15 13:13:13.833488: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 13:13:13.834009: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 13:13:13.834042: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 13:13:13.834076: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 13:13:13.834094: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 13:13:13.834112: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 13:13:13.834129: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 13:13:13.834147: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 13:13:13.834164: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 13:13:13.834182: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 13:13:13.834653: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 13:13:13.834719: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 13:13:14.627056: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-15 13:13:14.627143: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-15 13:13:14.627154: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-15 13:13:14.628461: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:02:00.0, compute capability: 6.1)
{'id': 151, 'batch_size': 128, 'epochs': 100, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/100 [00:00<?, ?epoch/s]2024-02-15 13:13:15.447093: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-15 13:13:15.458824: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199950000 Hz
2024-02-15 13:13:17.576263: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 13:13:17.864060: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 13:13:18.658838: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-15 13:13:18.696891: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/100 [00:51<1:24:43, 51.34s/epoch, loss=3.37, accuracy=0.281, val_loss=2.49, val_accuracy=0.221, lr=0.1]  2%|▏         | 2/100 [01:15<57:45, 35.36s/epoch, loss=1.61, accuracy=0.511, val_loss=2.03, val_accuracy=0.435, lr=0.1]    3%|▎         | 3/100 [01:39<48:54, 30.25s/epoch, loss=1.38, accuracy=0.624, val_loss=2.2, val_accuracy=0.476, lr=0.1]   4%|▍         | 4/100 [02:03<44:34, 27.86s/epoch, loss=1.3, accuracy=0.672, val_loss=2.13, val_accuracy=0.468, lr=0.1]  5%|▌         | 5/100 [02:27<41:55, 26.48s/epoch, loss=1.28, accuracy=0.693, val_loss=1.89, val_accuracy=0.516, lr=0.1]  6%|▌         | 6/100 [02:51<40:09, 25.63s/epoch, loss=1.26, accuracy=0.706, val_loss=2.76, val_accuracy=0.415, lr=0.1]  7%|▋         | 7/100 [03:16<38:57, 25.13s/epoch, loss=1.24, accuracy=0.715, val_loss=2.39, val_accuracy=0.432, lr=0.1]  8%|▊         | 8/100 [03:40<38:04, 24.83s/epoch, loss=1.23, accuracy=0.723, val_loss=1.53, val_accuracy=0.621, lr=0.1]  9%|▉         | 9/100 [04:04<37:13, 24.55s/epoch, loss=1.22, accuracy=0.727, val_loss=1.83, val_accuracy=0.523, lr=0.1] 10%|█         | 10/100 [04:28<36:30, 24.34s/epoch, loss=1.22, accuracy=0.731, val_loss=1.73, val_accuracy=0.544, lr=0.1] 11%|█         | 11/100 [04:52<35:57, 24.24s/epoch, loss=1.21, accuracy=0.732, val_loss=1.69, val_accuracy=0.605, lr=0.1] 12%|█▏        | 12/100 [05:15<35:23, 24.14s/epoch, loss=1.2, accuracy=0.733, val_loss=2.14, val_accuracy=0.504, lr=0.1]  13%|█▎        | 13/100 [05:39<34:54, 24.07s/epoch, loss=1.2, accuracy=0.736, val_loss=2.36, val_accuracy=0.454, lr=0.0316] 14%|█▍        | 14/100 [06:03<34:30, 24.07s/epoch, loss=1.2, accuracy=0.737, val_loss=1.73, val_accuracy=0.571, lr=0.1]    15%|█▌        | 15/100 [06:28<34:09, 24.12s/epoch, loss=1.2, accuracy=0.741, val_loss=1.48, val_accuracy=0.642, lr=0.1] 16%|█▌        | 16/100 [06:52<33:48, 24.14s/epoch, loss=1.2, accuracy=0.739, val_loss=1.89, val_accuracy=0.533, lr=0.1] 17%|█▋        | 17/100 [07:16<33:20, 24.10s/epoch, loss=1.19, accuracy=0.74, val_loss=2.07, val_accuracy=0.472, lr=0.1] 18%|█▊        | 18/100 [07:40<32:56, 24.10s/epoch, loss=1.19, accuracy=0.741, val_loss=1.75, val_accuracy=0.549, lr=0.1] 19%|█▉        | 19/100 [08:04<32:30, 24.08s/epoch, loss=1.19, accuracy=0.742, val_loss=1.61, val_accuracy=0.586, lr=0.1] 20%|██        | 20/100 [08:28<32:04, 24.06s/epoch, loss=1.19, accuracy=0.741, val_loss=1.89, val_accuracy=0.529, lr=0.0316] 21%|██        | 21/100 [08:52<31:46, 24.13s/epoch, loss=1.18, accuracy=0.743, val_loss=1.59, val_accuracy=0.617, lr=0.1]    22%|██▏       | 22/100 [09:16<31:19, 24.10s/epoch, loss=1.18, accuracy=0.746, val_loss=1.66, val_accuracy=0.551, lr=0.1] 23%|██▎       | 23/100 [09:40<30:53, 24.08s/epoch, loss=1.17, accuracy=0.747, val_loss=1.41, val_accuracy=0.663, lr=0.1] 24%|██▍       | 24/100 [10:04<30:26, 24.04s/epoch, loss=1.17, accuracy=0.747, val_loss=1.54, val_accuracy=0.625, lr=0.1] 25%|██▌       | 25/100 [10:28<30:03, 24.05s/epoch, loss=1.17, accuracy=0.747, val_loss=1.9, val_accuracy=0.48, lr=0.1]   26%|██▌       | 26/100 [10:53<29:42, 24.09s/epoch, loss=1.17, accuracy=0.746, val_loss=1.87, val_accuracy=0.567, lr=0.1] 27%|██▋       | 27/100 [11:17<29:17, 24.08s/epoch, loss=1.17, accuracy=0.747, val_loss=2.17, val_accuracy=0.487, lr=0.1] 28%|██▊       | 28/100 [11:41<28:52, 24.07s/epoch, loss=1.16, accuracy=0.748, val_loss=1.63, val_accuracy=0.579, lr=0.0316] 29%|██▉       | 29/100 [12:05<28:26, 24.04s/epoch, loss=1.16, accuracy=0.748, val_loss=1.85, val_accuracy=0.54, lr=0.1]     30%|███       | 30/100 [12:29<28:00, 24.01s/epoch, loss=1.16, accuracy=0.749, val_loss=3.72, val_accuracy=0.344, lr=0.1] 31%|███       | 31/100 [12:53<27:48, 24.18s/epoch, loss=1.15, accuracy=0.748, val_loss=1.81, val_accuracy=0.52, lr=0.1]  32%|███▏      | 32/100 [13:17<27:23, 24.17s/epoch, loss=1.16, accuracy=0.749, val_loss=2.05, val_accuracy=0.487, lr=0.1] 33%|███▎      | 33/100 [13:41<26:56, 24.12s/epoch, loss=1.16, accuracy=0.749, val_loss=1.93, val_accuracy=0.518, lr=0.0316] 34%|███▍      | 34/100 [14:05<26:30, 24.09s/epoch, loss=1.16, accuracy=0.749, val_loss=1.81, val_accuracy=0.515, lr=0.1]    35%|███▌      | 35/100 [14:29<26:03, 24.06s/epoch, loss=1.15, accuracy=0.75, val_loss=3.02, val_accuracy=0.375, lr=0.1]  36%|███▌      | 36/100 [14:53<25:40, 24.06s/epoch, loss=1.16, accuracy=0.749, val_loss=1.63, val_accuracy=0.627, lr=0.1] 37%|███▋      | 37/100 [15:17<25:14, 24.04s/epoch, loss=1.15, accuracy=0.751, val_loss=1.34, val_accuracy=0.692, lr=0.1] 38%|███▊      | 38/100 [15:41<24:51, 24.05s/epoch, loss=1.15, accuracy=0.753, val_loss=1.72, val_accuracy=0.574, lr=0.1] 39%|███▉      | 39/100 [16:05<24:25, 24.02s/epoch, loss=1.15, accuracy=0.75, val_loss=1.53, val_accuracy=0.633, lr=0.1]  40%|████      | 40/100 [16:29<24:00, 24.01s/epoch, loss=1.15, accuracy=0.75, val_loss=2.38, val_accuracy=0.438, lr=0.1] 41%|████      | 41/100 [16:54<23:40, 24.08s/epoch, loss=1.15, accuracy=0.754, val_loss=1.67, val_accuracy=0.573, lr=0.1] 42%|████▏     | 42/100 [17:18<23:16, 24.08s/epoch, loss=1.14, accuracy=0.754, val_loss=2.85, val_accuracy=0.337, lr=0.0316] 43%|████▎     | 43/100 [17:42<22:55, 24.13s/epoch, loss=1.14, accuracy=0.752, val_loss=1.46, val_accuracy=0.642, lr=0.1]    44%|████▍     | 44/100 [18:06<22:30, 24.11s/epoch, loss=1.15, accuracy=0.752, val_loss=1.88, val_accuracy=0.493, lr=0.1] 45%|████▌     | 45/100 [18:30<22:05, 24.09s/epoch, loss=1.15, accuracy=0.75, val_loss=1.57, val_accuracy=0.595, lr=0.1]  46%|████▌     | 46/100 [18:54<21:39, 24.07s/epoch, loss=1.14, accuracy=0.749, val_loss=1.5, val_accuracy=0.622, lr=0.1] 47%|████▋     | 47/100 [19:18<21:16, 24.08s/epoch, loss=1.14, accuracy=0.753, val_loss=3.94, val_accuracy=0.266, lr=0.0316] 48%|████▊     | 48/100 [19:42<20:52, 24.08s/epoch, loss=1.15, accuracy=0.749, val_loss=1.81, val_accuracy=0.547, lr=0.1]    49%|████▉     | 49/100 [20:06<20:27, 24.06s/epoch, loss=1.15, accuracy=0.749, val_loss=2.4, val_accuracy=0.475, lr=0.1]  50%|█████     | 50/100 [20:30<20:04, 24.08s/epoch, loss=1.14, accuracy=0.756, val_loss=1.77, val_accuracy=0.548, lr=0.1] 51%|█████     | 51/100 [20:54<19:39, 24.08s/epoch, loss=1.14, accuracy=0.755, val_loss=1.88, val_accuracy=0.513, lr=0.1] 52%|█████▏    | 52/100 [21:19<19:16, 24.09s/epoch, loss=1.14, accuracy=0.754, val_loss=1.9, val_accuracy=0.501, lr=0.0316] 53%|█████▎    | 53/100 [21:43<18:54, 24.14s/epoch, loss=1.14, accuracy=0.754, val_loss=3.19, val_accuracy=0.401, lr=0.1]   54%|█████▍    | 54/100 [22:07<18:32, 24.19s/epoch, loss=1.15, accuracy=0.753, val_loss=1.97, val_accuracy=0.503, lr=0.1] 55%|█████▌    | 55/100 [22:31<18:09, 24.20s/epoch, loss=1.14, accuracy=0.752, val_loss=2.55, val_accuracy=0.46, lr=0.1]  56%|█████▌    | 56/100 [22:55<17:43, 24.17s/epoch, loss=1.14, accuracy=0.753, val_loss=4.15, val_accuracy=0.241, lr=0.1] 57%|█████▋    | 57/100 [23:20<17:20, 24.19s/epoch, loss=1.15, accuracy=0.753, val_loss=1.87, val_accuracy=0.509, lr=0.0316] 58%|█████▊    | 58/100 [23:44<16:54, 24.16s/epoch, loss=1.14, accuracy=0.75, val_loss=1.54, val_accuracy=0.608, lr=0.1]     59%|█████▉    | 59/100 [24:08<16:28, 24.10s/epoch, loss=1.13, accuracy=0.756, val_loss=1.92, val_accuracy=0.504, lr=0.1] 60%|██████    | 60/100 [24:32<16:03, 24.09s/epoch, loss=1.14, accuracy=0.751, val_loss=2.59, val_accuracy=0.444, lr=0.1] 61%|██████    | 61/100 [24:56<15:37, 24.04s/epoch, loss=1.14, accuracy=0.751, val_loss=1.94, val_accuracy=0.528, lr=0.1] 62%|██████▏   | 62/100 [25:20<15:12, 24.03s/epoch, loss=1.15, accuracy=0.75, val_loss=1.71, val_accuracy=0.599, lr=0.0316] 63%|██████▎   | 63/100 [25:44<14:47, 23.98s/epoch, loss=1.13, accuracy=0.753, val_loss=2.05, val_accuracy=0.499, lr=0.1]   64%|██████▍   | 64/100 [26:08<14:23, 23.98s/epoch, loss=1.14, accuracy=0.752, val_loss=2.64, val_accuracy=0.394, lr=0.1] 65%|██████▌   | 65/100 [26:32<13:58, 23.96s/epoch, loss=1.14, accuracy=0.753, val_loss=1.5, val_accuracy=0.631, lr=0.1]  66%|██████▌   | 66/100 [26:55<13:33, 23.92s/epoch, loss=1.15, accuracy=0.75, val_loss=1.89, val_accuracy=0.505, lr=0.1] 67%|██████▋   | 67/100 [27:19<13:08, 23.88s/epoch, loss=1.14, accuracy=0.752, val_loss=2.88, val_accuracy=0.473, lr=0.0316] 68%|██████▊   | 68/100 [27:43<12:44, 23.88s/epoch, loss=1.14, accuracy=0.754, val_loss=2.69, val_accuracy=0.419, lr=0.1]    69%|██████▉   | 69/100 [28:07<12:20, 23.90s/epoch, loss=1.14, accuracy=0.753, val_loss=2.64, val_accuracy=0.417, lr=0.1] 70%|███████   | 70/100 [28:31<11:54, 23.82s/epoch, loss=1.14, accuracy=0.751, val_loss=1.76, val_accuracy=0.539, lr=0.1] 71%|███████   | 71/100 [28:54<11:28, 23.74s/epoch, loss=1.14, accuracy=0.751, val_loss=4.28, val_accuracy=0.257, lr=0.1] 72%|███████▏  | 72/100 [29:18<11:02, 23.64s/epoch, loss=1.14, accuracy=0.754, val_loss=1.52, val_accuracy=0.632, lr=0.0316] 73%|███████▎  | 73/100 [29:41<10:35, 23.54s/epoch, loss=1.13, accuracy=0.753, val_loss=1.44, val_accuracy=0.649, lr=0.1]    74%|███████▍  | 74/100 [30:04<10:12, 23.55s/epoch, loss=1.14, accuracy=0.753, val_loss=1.74, val_accuracy=0.561, lr=0.1] 75%|███████▌  | 75/100 [30:28<09:49, 23.57s/epoch, loss=1.14, accuracy=0.752, val_loss=1.55, val_accuracy=0.612, lr=0.1] 76%|███████▌  | 76/100 [30:52<09:24, 23.54s/epoch, loss=1.13, accuracy=0.754, val_loss=1.63, val_accuracy=0.596, lr=0.1] 77%|███████▋  | 77/100 [31:15<09:01, 23.54s/epoch, loss=1.13, accuracy=0.756, val_loss=5.39, val_accuracy=0.252, lr=0.0316] 78%|███████▊  | 78/100 [31:39<08:37, 23.53s/epoch, loss=1.13, accuracy=0.756, val_loss=2.5, val_accuracy=0.391, lr=0.1]     79%|███████▉  | 79/100 [32:02<08:12, 23.43s/epoch, loss=1.14, accuracy=0.754, val_loss=3.26, val_accuracy=0.351, lr=0.1] 80%|████████  | 80/100 [32:25<07:47, 23.39s/epoch, loss=1.14, accuracy=0.754, val_loss=3.1, val_accuracy=0.366, lr=0.1]  81%|████████  | 81/100 [32:49<07:25, 23.42s/epoch, loss=1.14, accuracy=0.755, val_loss=1.73, val_accuracy=0.576, lr=0.1] 82%|████████▏ | 82/100 [33:12<07:01, 23.42s/epoch, loss=0.922, accuracy=0.816, val_loss=0.941, val_accuracy=0.787, lr=0.01] 83%|████████▎ | 83/100 [33:35<06:37, 23.41s/epoch, loss=0.744, accuracy=0.846, val_loss=0.858, val_accuracy=0.796, lr=0.01] 84%|████████▍ | 84/100 [33:59<06:16, 23.53s/epoch, loss=0.663, accuracy=0.853, val_loss=0.806, val_accuracy=0.797, lr=0.01] 85%|████████▌ | 85/100 [34:23<05:53, 23.60s/epoch, loss=0.616, accuracy=0.858, val_loss=0.717, val_accuracy=0.82, lr=0.01]  86%|████████▌ | 86/100 [34:47<05:31, 23.67s/epoch, loss=0.595, accuracy=0.858, val_loss=0.729, val_accuracy=0.814, lr=0.01] 87%|████████▋ | 87/100 [35:10<05:06, 23.59s/epoch, loss=0.582, accuracy=0.861, val_loss=0.852, val_accuracy=0.78, lr=0.01]  88%|████████▊ | 88/100 [35:34<04:42, 23.53s/epoch, loss=0.573, accuracy=0.862, val_loss=0.814, val_accuracy=0.78, lr=0.01] 89%|████████▉ | 89/100 [35:57<04:18, 23.52s/epoch, loss=0.573, accuracy=0.862, val_loss=0.765, val_accuracy=0.805, lr=0.01] 90%|█████████ | 90/100 [36:21<03:55, 23.55s/epoch, loss=0.571, accuracy=0.864, val_loss=0.886, val_accuracy=0.779, lr=0.00316] 91%|█████████ | 91/100 [36:45<03:32, 23.66s/epoch, loss=0.569, accuracy=0.865, val_loss=0.896, val_accuracy=0.76, lr=0.01]     92%|█████████▏| 92/100 [37:08<03:09, 23.73s/epoch, loss=0.565, accuracy=0.868, val_loss=0.849, val_accuracy=0.79, lr=0.01] 93%|█████████▎| 93/100 [37:32<02:45, 23.61s/epoch, loss=0.568, accuracy=0.868, val_loss=0.702, val_accuracy=0.829, lr=0.01] 94%|█████████▍| 94/100 [37:55<02:21, 23.59s/epoch, loss=0.565, accuracy=0.869, val_loss=0.791, val_accuracy=0.799, lr=0.01] 95%|█████████▌| 95/100 [38:18<01:57, 23.43s/epoch, loss=0.561, accuracy=0.873, val_loss=0.891, val_accuracy=0.755, lr=0.01] 96%|█████████▌| 96/100 [38:42<01:33, 23.38s/epoch, loss=0.563, accuracy=0.871, val_loss=0.956, val_accuracy=0.767, lr=0.01] 97%|█████████▋| 97/100 [39:05<01:10, 23.46s/epoch, loss=0.562, accuracy=0.873, val_loss=0.881, val_accuracy=0.776, lr=0.01] 98%|█████████▊| 98/100 [39:29<00:46, 23.42s/epoch, loss=0.56, accuracy=0.874, val_loss=0.911, val_accuracy=0.772, lr=0.00316] 99%|█████████▉| 99/100 [39:52<00:23, 23.47s/epoch, loss=0.563, accuracy=0.874, val_loss=0.785, val_accuracy=0.799, lr=0.01]  100%|██████████| 100/100 [40:16<00:00, 23.48s/epoch, loss=0.563, accuracy=0.875, val_loss=0.87, val_accuracy=0.785, lr=0.01]100%|██████████| 100/100 [40:16<00:00, 24.16s/epoch, loss=0.563, accuracy=0.875, val_loss=0.87, val_accuracy=0.785, lr=0.01]
Using real-time data augmentation.
Test loss: 0.8697185516357422
Test accuracy: 0.7849000096321106


* * * Run SGD for ID = 15_2. * * *


2024-02-15 13:53:34.667098: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 13:53:37.390885: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 13:53:37.391997: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-15 13:53:37.431849: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 13:53:37.431886: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 13:53:37.434743: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 13:53:37.434786: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 13:53:37.436809: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 13:53:37.437400: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 13:53:37.439632: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 13:53:37.441054: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 13:53:37.445743: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 13:53:37.446272: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 13:53:37.446542: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 13:53:38.671481: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-15 13:53:38.672041: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 13:53:38.672494: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 13:53:38.672535: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 13:53:38.672570: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 13:53:38.672589: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 13:53:38.672605: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 13:53:38.672622: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 13:53:38.672640: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 13:53:38.672656: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 13:53:38.672673: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 13:53:38.673222: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 13:53:38.673258: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 13:53:39.314005: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-15 13:53:39.314060: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-15 13:53:39.314070: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-15 13:53:39.315078: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:02:00.0, compute capability: 6.1)
{'id': 152, 'batch_size': 128, 'epochs': 100, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/100 [00:00<?, ?epoch/s]2024-02-15 13:53:40.104338: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-15 13:53:40.104874: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199950000 Hz
2024-02-15 13:53:42.046209: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 13:53:42.316340: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 13:53:42.999407: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-15 13:53:43.034182: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/100 [00:50<1:23:51, 50.82s/epoch, loss=3.19, accuracy=0.303, val_loss=2.57, val_accuracy=0.254, lr=0.1]  2%|▏         | 2/100 [01:15<57:54, 35.45s/epoch, loss=1.59, accuracy=0.52, val_loss=2.38, val_accuracy=0.343, lr=0.1]     3%|▎         | 3/100 [01:39<49:07, 30.39s/epoch, loss=1.36, accuracy=0.634, val_loss=1.5, val_accuracy=0.592, lr=0.1]  4%|▍         | 4/100 [02:04<44:49, 28.02s/epoch, loss=1.29, accuracy=0.681, val_loss=1.86, val_accuracy=0.503, lr=0.1]  5%|▌         | 5/100 [02:28<42:23, 26.77s/epoch, loss=1.26, accuracy=0.697, val_loss=1.49, val_accuracy=0.622, lr=0.1]  6%|▌         | 6/100 [02:53<40:41, 25.98s/epoch, loss=1.24, accuracy=0.71, val_loss=1.73, val_accuracy=0.554, lr=0.1]   7%|▋         | 7/100 [03:18<39:43, 25.63s/epoch, loss=1.23, accuracy=0.717, val_loss=2.35, val_accuracy=0.354, lr=0.1]  8%|▊         | 8/100 [03:42<38:50, 25.33s/epoch, loss=1.22, accuracy=0.723, val_loss=1.65, val_accuracy=0.6, lr=0.1]    9%|▉         | 9/100 [04:07<38:02, 25.08s/epoch, loss=1.22, accuracy=0.727, val_loss=1.97, val_accuracy=0.482, lr=0.1] 10%|█         | 10/100 [04:32<37:25, 24.95s/epoch, loss=1.21, accuracy=0.731, val_loss=2.42, val_accuracy=0.436, lr=0.0316] 11%|█         | 11/100 [04:56<36:47, 24.80s/epoch, loss=1.2, accuracy=0.731, val_loss=2.09, val_accuracy=0.532, lr=0.1]     12%|█▏        | 12/100 [05:21<36:15, 24.72s/epoch, loss=1.2, accuracy=0.731, val_loss=2.1, val_accuracy=0.524, lr=0.1]  13%|█▎        | 13/100 [05:45<35:46, 24.67s/epoch, loss=1.19, accuracy=0.738, val_loss=1.63, val_accuracy=0.585, lr=0.1] 14%|█▍        | 14/100 [06:10<35:17, 24.62s/epoch, loss=1.19, accuracy=0.739, val_loss=2.53, val_accuracy=0.46, lr=0.1]  15%|█▌        | 15/100 [06:34<34:59, 24.70s/epoch, loss=1.2, accuracy=0.738, val_loss=1.47, val_accuracy=0.643, lr=0.1] 16%|█▌        | 16/100 [06:59<34:34, 24.69s/epoch, loss=1.19, accuracy=0.74, val_loss=3.19, val_accuracy=0.358, lr=0.1] 17%|█▋        | 17/100 [07:24<34:01, 24.60s/epoch, loss=1.18, accuracy=0.743, val_loss=2.16, val_accuracy=0.458, lr=0.1] 18%|█▊        | 18/100 [07:48<33:32, 24.55s/epoch, loss=1.18, accuracy=0.741, val_loss=1.72, val_accuracy=0.581, lr=0.1] 19%|█▉        | 19/100 [08:12<33:03, 24.49s/epoch, loss=1.18, accuracy=0.745, val_loss=1.8, val_accuracy=0.549, lr=0.1]  20%|██        | 20/100 [08:37<32:40, 24.50s/epoch, loss=1.18, accuracy=0.744, val_loss=2.41, val_accuracy=0.4, lr=0.0316] 21%|██        | 21/100 [09:01<32:07, 24.39s/epoch, loss=1.17, accuracy=0.744, val_loss=1.6, val_accuracy=0.597, lr=0.1]   22%|██▏       | 22/100 [09:25<31:26, 24.18s/epoch, loss=1.17, accuracy=0.746, val_loss=1.84, val_accuracy=0.52, lr=0.1] 23%|██▎       | 23/100 [09:49<31:05, 24.23s/epoch, loss=1.17, accuracy=0.745, val_loss=1.85, val_accuracy=0.585, lr=0.1] 24%|██▍       | 24/100 [10:13<30:43, 24.26s/epoch, loss=1.16, accuracy=0.749, val_loss=2.22, val_accuracy=0.46, lr=0.1]  25%|██▌       | 25/100 [10:38<30:23, 24.31s/epoch, loss=1.17, accuracy=0.748, val_loss=1.74, val_accuracy=0.557, lr=0.0316] 26%|██▌       | 26/100 [11:02<29:56, 24.27s/epoch, loss=1.16, accuracy=0.745, val_loss=9.53, val_accuracy=0.179, lr=0.1]    27%|██▋       | 27/100 [11:26<29:31, 24.27s/epoch, loss=1.17, accuracy=0.748, val_loss=2.22, val_accuracy=0.447, lr=0.1] 28%|██▊       | 28/100 [11:50<29:03, 24.21s/epoch, loss=1.16, accuracy=0.748, val_loss=1.95, val_accuracy=0.516, lr=0.1] 29%|██▉       | 29/100 [12:14<28:30, 24.09s/epoch, loss=1.17, accuracy=0.749, val_loss=1.57, val_accuracy=0.604, lr=0.1] 30%|███       | 30/100 [12:39<28:13, 24.19s/epoch, loss=1.16, accuracy=0.752, val_loss=2.76, val_accuracy=0.427, lr=0.0316] 31%|███       | 31/100 [13:03<27:47, 24.16s/epoch, loss=1.15, accuracy=0.751, val_loss=1.59, val_accuracy=0.628, lr=0.1]    32%|███▏      | 32/100 [13:27<27:20, 24.12s/epoch, loss=1.16, accuracy=0.748, val_loss=1.72, val_accuracy=0.546, lr=0.1] 33%|███▎      | 33/100 [13:51<26:54, 24.09s/epoch, loss=1.15, accuracy=0.751, val_loss=2.24, val_accuracy=0.452, lr=0.1] 34%|███▍      | 34/100 [14:15<26:39, 24.24s/epoch, loss=1.16, accuracy=0.749, val_loss=1.93, val_accuracy=0.5, lr=0.1]   35%|███▌      | 35/100 [14:39<26:05, 24.08s/epoch, loss=1.16, accuracy=0.75, val_loss=2.02, val_accuracy=0.527, lr=0.0316] 36%|███▌      | 36/100 [15:03<25:44, 24.13s/epoch, loss=1.15, accuracy=0.752, val_loss=2.39, val_accuracy=0.439, lr=0.1]   37%|███▋      | 37/100 [15:27<25:16, 24.08s/epoch, loss=1.15, accuracy=0.752, val_loss=1.45, val_accuracy=0.654, lr=0.1] 38%|███▊      | 38/100 [15:51<24:53, 24.09s/epoch, loss=1.15, accuracy=0.754, val_loss=1.63, val_accuracy=0.61, lr=0.1]  39%|███▉      | 39/100 [16:15<24:30, 24.10s/epoch, loss=1.15, accuracy=0.755, val_loss=1.98, val_accuracy=0.506, lr=0.1] 40%|████      | 40/100 [16:39<24:01, 24.03s/epoch, loss=1.15, accuracy=0.75, val_loss=2.06, val_accuracy=0.512, lr=0.1]  41%|████      | 41/100 [17:03<23:40, 24.07s/epoch, loss=1.15, accuracy=0.752, val_loss=2.05, val_accuracy=0.471, lr=0.1] 42%|████▏     | 42/100 [17:28<23:17, 24.09s/epoch, loss=1.15, accuracy=0.75, val_loss=2.66, val_accuracy=0.422, lr=0.0316] 43%|████▎     | 43/100 [17:52<22:57, 24.17s/epoch, loss=1.14, accuracy=0.753, val_loss=1.59, val_accuracy=0.588, lr=0.1]   44%|████▍     | 44/100 [18:16<22:27, 24.06s/epoch, loss=1.14, accuracy=0.752, val_loss=1.85, val_accuracy=0.524, lr=0.1] 45%|████▌     | 45/100 [18:40<22:09, 24.18s/epoch, loss=1.14, accuracy=0.755, val_loss=4.04, val_accuracy=0.213, lr=0.1] 46%|████▌     | 46/100 [19:04<21:46, 24.19s/epoch, loss=1.14, accuracy=0.754, val_loss=2.57, val_accuracy=0.451, lr=0.1] 47%|████▋     | 47/100 [19:28<21:16, 24.09s/epoch, loss=1.14, accuracy=0.755, val_loss=1.93, val_accuracy=0.53, lr=0.0316] 48%|████▊     | 48/100 [19:52<20:50, 24.05s/epoch, loss=1.14, accuracy=0.754, val_loss=1.62, val_accuracy=0.594, lr=0.1]   49%|████▉     | 49/100 [20:16<20:26, 24.04s/epoch, loss=1.14, accuracy=0.754, val_loss=1.91, val_accuracy=0.569, lr=0.1] 50%|█████     | 50/100 [20:40<20:04, 24.09s/epoch, loss=1.15, accuracy=0.752, val_loss=1.67, val_accuracy=0.554, lr=0.1] 51%|█████     | 51/100 [21:05<19:40, 24.10s/epoch, loss=1.14, accuracy=0.752, val_loss=1.56, val_accuracy=0.604, lr=0.1] 52%|█████▏    | 52/100 [21:28<19:10, 23.97s/epoch, loss=1.14, accuracy=0.754, val_loss=2.49, val_accuracy=0.48, lr=0.0316] 53%|█████▎    | 53/100 [21:52<18:50, 24.06s/epoch, loss=1.14, accuracy=0.752, val_loss=1.65, val_accuracy=0.574, lr=0.1]   54%|█████▍    | 54/100 [22:16<18:23, 24.00s/epoch, loss=1.14, accuracy=0.753, val_loss=1.96, val_accuracy=0.463, lr=0.1] 55%|█████▌    | 55/100 [22:40<17:58, 23.96s/epoch, loss=1.13, accuracy=0.756, val_loss=1.84, val_accuracy=0.572, lr=0.1] 56%|█████▌    | 56/100 [23:04<17:37, 24.03s/epoch, loss=1.14, accuracy=0.754, val_loss=2.08, val_accuracy=0.55, lr=0.1]  57%|█████▋    | 57/100 [23:29<17:16, 24.10s/epoch, loss=1.14, accuracy=0.754, val_loss=3.44, val_accuracy=0.299, lr=0.0316] 58%|█████▊    | 58/100 [23:53<16:56, 24.20s/epoch, loss=1.14, accuracy=0.753, val_loss=1.64, val_accuracy=0.601, lr=0.1]    59%|█████▉    | 59/100 [24:17<16:33, 24.22s/epoch, loss=1.14, accuracy=0.753, val_loss=1.39, val_accuracy=0.668, lr=0.1] 60%|██████    | 60/100 [24:42<16:09, 24.24s/epoch, loss=1.14, accuracy=0.754, val_loss=1.72, val_accuracy=0.576, lr=0.1] 61%|██████    | 61/100 [25:06<15:42, 24.17s/epoch, loss=1.14, accuracy=0.753, val_loss=1.86, val_accuracy=0.517, lr=0.1] 62%|██████▏   | 62/100 [25:29<15:13, 24.05s/epoch, loss=1.13, accuracy=0.754, val_loss=1.76, val_accuracy=0.571, lr=0.1] 63%|██████▎   | 63/100 [25:54<14:51, 24.10s/epoch, loss=1.13, accuracy=0.754, val_loss=2.39, val_accuracy=0.457, lr=0.1] 64%|██████▍   | 64/100 [26:18<14:31, 24.21s/epoch, loss=1.14, accuracy=0.756, val_loss=1.4, val_accuracy=0.674, lr=0.0316] 65%|██████▌   | 65/100 [26:42<14:05, 24.16s/epoch, loss=1.14, accuracy=0.753, val_loss=2.82, val_accuracy=0.299, lr=0.1]   66%|██████▌   | 66/100 [27:07<13:43, 24.22s/epoch, loss=1.13, accuracy=0.754, val_loss=1.38, val_accuracy=0.666, lr=0.1] 67%|██████▋   | 67/100 [27:31<13:19, 24.21s/epoch, loss=1.13, accuracy=0.752, val_loss=3.25, val_accuracy=0.331, lr=0.1] 68%|██████▊   | 68/100 [27:54<12:49, 24.06s/epoch, loss=1.13, accuracy=0.756, val_loss=2.99, val_accuracy=0.393, lr=0.1] 69%|██████▉   | 69/100 [28:18<12:25, 24.05s/epoch, loss=1.13, accuracy=0.755, val_loss=2.04, val_accuracy=0.468, lr=0.1] 70%|███████   | 70/100 [28:43<12:02, 24.10s/epoch, loss=1.12, accuracy=0.759, val_loss=1.56, val_accuracy=0.599, lr=0.1] 71%|███████   | 71/100 [29:07<11:36, 24.03s/epoch, loss=1.14, accuracy=0.756, val_loss=1.91, val_accuracy=0.573, lr=0.0316] 72%|███████▏  | 72/100 [29:30<11:07, 23.85s/epoch, loss=1.13, accuracy=0.758, val_loss=1.92, val_accuracy=0.552, lr=0.1]    73%|███████▎  | 73/100 [29:54<10:44, 23.87s/epoch, loss=1.13, accuracy=0.756, val_loss=2.38, val_accuracy=0.426, lr=0.1] 74%|███████▍  | 74/100 [30:18<10:19, 23.84s/epoch, loss=1.14, accuracy=0.756, val_loss=2.06, val_accuracy=0.512, lr=0.1] 75%|███████▌  | 75/100 [30:42<09:57, 23.89s/epoch, loss=1.13, accuracy=0.755, val_loss=2.09, val_accuracy=0.477, lr=0.1] 76%|███████▌  | 76/100 [31:06<09:34, 23.92s/epoch, loss=1.13, accuracy=0.756, val_loss=2.04, val_accuracy=0.491, lr=0.0316] 77%|███████▋  | 77/100 [31:29<09:09, 23.89s/epoch, loss=1.13, accuracy=0.755, val_loss=1.88, val_accuracy=0.486, lr=0.1]    78%|███████▊  | 78/100 [31:54<08:48, 24.01s/epoch, loss=1.13, accuracy=0.755, val_loss=2.66, val_accuracy=0.423, lr=0.1] 79%|███████▉  | 79/100 [32:17<08:21, 23.87s/epoch, loss=1.13, accuracy=0.755, val_loss=1.52, val_accuracy=0.621, lr=0.1] 80%|████████  | 80/100 [32:41<07:57, 23.89s/epoch, loss=1.12, accuracy=0.754, val_loss=1.95, val_accuracy=0.519, lr=0.1] 81%|████████  | 81/100 [33:05<07:33, 23.88s/epoch, loss=1.13, accuracy=0.755, val_loss=1.78, val_accuracy=0.554, lr=0.0316] 82%|████████▏ | 82/100 [33:29<07:07, 23.76s/epoch, loss=0.913, accuracy=0.816, val_loss=0.87, val_accuracy=0.818, lr=0.01]  83%|████████▎ | 83/100 [33:53<06:46, 23.91s/epoch, loss=0.732, accuracy=0.847, val_loss=0.776, val_accuracy=0.82, lr=0.01] 84%|████████▍ | 84/100 [34:17<06:24, 24.06s/epoch, loss=0.65, accuracy=0.856, val_loss=0.747, val_accuracy=0.812, lr=0.01] 85%|████████▌ | 85/100 [34:41<06:01, 24.08s/epoch, loss=0.61, accuracy=0.859, val_loss=0.815, val_accuracy=0.791, lr=0.01] 86%|████████▌ | 86/100 [35:06<05:37, 24.12s/epoch, loss=0.589, accuracy=0.858, val_loss=0.736, val_accuracy=0.813, lr=0.01] 87%|████████▋ | 87/100 [35:30<05:13, 24.09s/epoch, loss=0.579, accuracy=0.862, val_loss=0.841, val_accuracy=0.779, lr=0.01] 88%|████████▊ | 88/100 [35:54<04:48, 24.08s/epoch, loss=0.574, accuracy=0.862, val_loss=0.693, val_accuracy=0.823, lr=0.01] 89%|████████▉ | 89/100 [36:18<04:24, 24.07s/epoch, loss=0.57, accuracy=0.865, val_loss=0.831, val_accuracy=0.788, lr=0.01]  90%|█████████ | 90/100 [36:42<04:00, 24.09s/epoch, loss=0.561, accuracy=0.868, val_loss=0.797, val_accuracy=0.798, lr=0.01] 91%|█████████ | 91/100 [37:06<03:36, 24.08s/epoch, loss=0.563, accuracy=0.868, val_loss=0.9, val_accuracy=0.745, lr=0.01]   92%|█████████▏| 92/100 [37:30<03:12, 24.07s/epoch, loss=0.563, accuracy=0.868, val_loss=0.716, val_accuracy=0.819, lr=0.01] 93%|█████████▎| 93/100 [37:54<02:48, 24.02s/epoch, loss=0.561, accuracy=0.869, val_loss=1.07, val_accuracy=0.727, lr=0.00316] 94%|█████████▍| 94/100 [38:18<02:23, 23.96s/epoch, loss=0.562, accuracy=0.872, val_loss=0.725, val_accuracy=0.818, lr=0.01]   95%|█████████▌| 95/100 [38:41<01:59, 23.91s/epoch, loss=0.555, accuracy=0.875, val_loss=0.88, val_accuracy=0.782, lr=0.01]  96%|█████████▌| 96/100 [39:05<01:35, 23.94s/epoch, loss=0.557, accuracy=0.873, val_loss=0.865, val_accuracy=0.781, lr=0.01] 97%|█████████▋| 97/100 [39:29<01:11, 23.93s/epoch, loss=0.562, accuracy=0.872, val_loss=0.846, val_accuracy=0.785, lr=0.01] 98%|█████████▊| 98/100 [39:53<00:47, 23.95s/epoch, loss=0.558, accuracy=0.876, val_loss=0.766, val_accuracy=0.814, lr=0.00316] 99%|█████████▉| 99/100 [40:17<00:23, 23.97s/epoch, loss=0.557, accuracy=0.876, val_loss=0.79, val_accuracy=0.798, lr=0.01]    100%|██████████| 100/100 [40:42<00:00, 24.09s/epoch, loss=0.556, accuracy=0.877, val_loss=0.772, val_accuracy=0.811, lr=0.01]100%|██████████| 100/100 [40:42<00:00, 24.42s/epoch, loss=0.556, accuracy=0.877, val_loss=0.772, val_accuracy=0.811, lr=0.01]
Using real-time data augmentation.
Test loss: 0.7715287208557129
Test accuracy: 0.810699999332428


* * * Run SGD for ID = 15_3. * * *


2024-02-15 14:34:24.927909: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 14:34:27.413178: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 14:34:27.414567: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-15 14:34:27.453615: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 14:34:27.453661: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 14:34:27.456388: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 14:34:27.456435: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 14:34:27.458837: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 14:34:27.459535: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 14:34:27.461999: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 14:34:27.463407: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 14:34:27.468290: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 14:34:27.468882: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 14:34:27.468975: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 14:34:28.833186: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-15 14:34:28.834219: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 14:34:28.834719: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 14:34:28.834754: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 14:34:28.834798: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 14:34:28.834819: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 14:34:28.834838: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 14:34:28.834856: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 14:34:28.834874: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 14:34:28.834891: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 14:34:28.834910: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 14:34:28.835403: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 14:34:28.835439: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 14:34:29.551498: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-15 14:34:29.551560: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-15 14:34:29.551578: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-15 14:34:29.552966: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:02:00.0, compute capability: 6.1)
{'id': 153, 'batch_size': 128, 'epochs': 100, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/100 [00:00<?, ?epoch/s]2024-02-15 14:34:30.390925: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-15 14:34:30.402801: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199950000 Hz
2024-02-15 14:34:32.494646: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 14:34:32.806784: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 14:34:33.563220: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-15 14:34:33.614719: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/100 [01:09<1:55:02, 69.72s/epoch, loss=3.15, accuracy=0.311, val_loss=2.57, val_accuracy=0.19, lr=0.1]  2%|▏         | 2/100 [01:34<1:10:44, 43.31s/epoch, loss=1.55, accuracy=0.542, val_loss=1.65, val_accuracy=0.497, lr=0.1]  3%|▎         | 3/100 [01:59<56:20, 34.85s/epoch, loss=1.38, accuracy=0.629, val_loss=2.24, val_accuracy=0.483, lr=0.1]    4%|▍         | 4/100 [02:24<49:21, 30.84s/epoch, loss=1.29, accuracy=0.676, val_loss=1.96, val_accuracy=0.448, lr=0.1]  5%|▌         | 5/100 [02:48<45:13, 28.56s/epoch, loss=1.26, accuracy=0.692, val_loss=1.89, val_accuracy=0.491, lr=0.1]  6%|▌         | 6/100 [03:13<42:37, 27.21s/epoch, loss=1.25, accuracy=0.705, val_loss=2.03, val_accuracy=0.499, lr=0.1]  7%|▋         | 7/100 [03:37<40:48, 26.33s/epoch, loss=1.23, accuracy=0.713, val_loss=1.93, val_accuracy=0.51, lr=0.0316]  8%|▊         | 8/100 [04:02<39:29, 25.76s/epoch, loss=1.22, accuracy=0.72, val_loss=2.09, val_accuracy=0.462, lr=0.1]     9%|▉         | 9/100 [04:26<38:30, 25.39s/epoch, loss=1.21, accuracy=0.725, val_loss=3.77, val_accuracy=0.318, lr=0.1] 10%|█         | 10/100 [04:51<37:47, 25.19s/epoch, loss=1.2, accuracy=0.73, val_loss=2.61, val_accuracy=0.396, lr=0.1]  11%|█         | 11/100 [05:16<37:06, 25.01s/epoch, loss=1.2, accuracy=0.73, val_loss=2.02, val_accuracy=0.464, lr=0.1] 12%|█▏        | 12/100 [05:40<36:30, 24.89s/epoch, loss=1.19, accuracy=0.732, val_loss=2.11, val_accuracy=0.443, lr=0.0316] 13%|█▎        | 13/100 [06:05<35:55, 24.78s/epoch, loss=1.19, accuracy=0.734, val_loss=2.04, val_accuracy=0.513, lr=0.1]    14%|█▍        | 14/100 [06:29<35:28, 24.74s/epoch, loss=1.18, accuracy=0.736, val_loss=2.41, val_accuracy=0.472, lr=0.1] 15%|█▌        | 15/100 [06:54<35:04, 24.76s/epoch, loss=1.19, accuracy=0.737, val_loss=1.69, val_accuracy=0.572, lr=0.1] 16%|█▌        | 16/100 [07:19<34:43, 24.80s/epoch, loss=1.17, accuracy=0.739, val_loss=2.94, val_accuracy=0.426, lr=0.1] 17%|█▋        | 17/100 [07:44<34:20, 24.83s/epoch, loss=1.17, accuracy=0.738, val_loss=2.18, val_accuracy=0.428, lr=0.0316] 18%|█▊        | 18/100 [08:09<33:53, 24.80s/epoch, loss=1.16, accuracy=0.742, val_loss=1.71, val_accuracy=0.57, lr=0.1]     19%|█▉        | 19/100 [08:33<33:28, 24.79s/epoch, loss=1.17, accuracy=0.743, val_loss=1.76, val_accuracy=0.553, lr=0.1] 20%|██        | 20/100 [08:58<33:01, 24.77s/epoch, loss=1.16, accuracy=0.742, val_loss=1.97, val_accuracy=0.482, lr=0.1] 21%|██        | 21/100 [09:23<32:35, 24.75s/epoch, loss=1.17, accuracy=0.745, val_loss=2.01, val_accuracy=0.555, lr=0.1] 22%|██▏       | 22/100 [09:48<32:11, 24.77s/epoch, loss=1.16, accuracy=0.743, val_loss=4.16, val_accuracy=0.253, lr=0.0316] 23%|██▎       | 23/100 [10:12<31:44, 24.73s/epoch, loss=1.16, accuracy=0.746, val_loss=1.87, val_accuracy=0.525, lr=0.1]    24%|██▍       | 24/100 [10:37<31:15, 24.68s/epoch, loss=1.16, accuracy=0.746, val_loss=2.86, val_accuracy=0.397, lr=0.1] 25%|██▌       | 25/100 [11:01<30:44, 24.59s/epoch, loss=1.16, accuracy=0.745, val_loss=2.03, val_accuracy=0.472, lr=0.1] 26%|██▌       | 26/100 [11:26<30:22, 24.62s/epoch, loss=1.15, accuracy=0.748, val_loss=1.37, val_accuracy=0.667, lr=0.1] 27%|██▋       | 27/100 [11:50<29:40, 24.39s/epoch, loss=1.15, accuracy=0.754, val_loss=2.64, val_accuracy=0.329, lr=0.1] 28%|██▊       | 28/100 [12:14<29:21, 24.47s/epoch, loss=1.15, accuracy=0.75, val_loss=3.01, val_accuracy=0.366, lr=0.1]  29%|██▉       | 29/100 [12:39<28:53, 24.41s/epoch, loss=1.15, accuracy=0.749, val_loss=1.51, val_accuracy=0.61, lr=0.1] 30%|███       | 30/100 [13:03<28:19, 24.28s/epoch, loss=1.15, accuracy=0.749, val_loss=2.11, val_accuracy=0.412, lr=0.1] 31%|███       | 31/100 [13:27<27:51, 24.22s/epoch, loss=1.14, accuracy=0.75, val_loss=1.95, val_accuracy=0.522, lr=0.0316] 32%|███▏      | 32/100 [13:51<27:31, 24.29s/epoch, loss=1.15, accuracy=0.75, val_loss=4.36, val_accuracy=0.148, lr=0.1]    33%|███▎      | 33/100 [14:15<27:00, 24.19s/epoch, loss=1.14, accuracy=0.752, val_loss=1.71, val_accuracy=0.577, lr=0.1] 34%|███▍      | 34/100 [14:39<26:31, 24.12s/epoch, loss=1.14, accuracy=0.752, val_loss=3.37, val_accuracy=0.324, lr=0.1] 35%|███▌      | 35/100 [15:03<25:57, 23.96s/epoch, loss=1.13, accuracy=0.754, val_loss=2.49, val_accuracy=0.427, lr=0.1] 36%|███▌      | 36/100 [15:27<25:40, 24.07s/epoch, loss=1.14, accuracy=0.753, val_loss=2.57, val_accuracy=0.44, lr=0.0316] 37%|███▋      | 37/100 [15:51<25:19, 24.12s/epoch, loss=1.14, accuracy=0.754, val_loss=3.31, val_accuracy=0.338, lr=0.1]   38%|███▊      | 38/100 [16:16<24:57, 24.16s/epoch, loss=1.13, accuracy=0.755, val_loss=4.71, val_accuracy=0.197, lr=0.1] 39%|███▉      | 39/100 [16:40<24:35, 24.19s/epoch, loss=1.13, accuracy=0.757, val_loss=2.17, val_accuracy=0.495, lr=0.1] 40%|████      | 40/100 [17:04<24:15, 24.27s/epoch, loss=1.13, accuracy=0.751, val_loss=2.33, val_accuracy=0.413, lr=0.1] 41%|████      | 41/100 [17:29<23:51, 24.26s/epoch, loss=1.13, accuracy=0.754, val_loss=1.75, val_accuracy=0.548, lr=0.0316] 42%|████▏     | 42/100 [17:53<23:27, 24.28s/epoch, loss=1.14, accuracy=0.753, val_loss=2.86, val_accuracy=0.353, lr=0.1]    43%|████▎     | 43/100 [18:17<23:04, 24.30s/epoch, loss=1.13, accuracy=0.752, val_loss=2.08, val_accuracy=0.493, lr=0.1] 44%|████▍     | 44/100 [18:41<22:38, 24.26s/epoch, loss=1.13, accuracy=0.754, val_loss=2.56, val_accuracy=0.299, lr=0.1] 45%|████▌     | 45/100 [19:06<22:21, 24.39s/epoch, loss=1.13, accuracy=0.752, val_loss=3.63, val_accuracy=0.246, lr=0.1] 46%|████▌     | 46/100 [19:30<21:53, 24.33s/epoch, loss=1.13, accuracy=0.753, val_loss=2.59, val_accuracy=0.308, lr=0.0316] 47%|████▋     | 47/100 [19:55<21:29, 24.33s/epoch, loss=1.13, accuracy=0.753, val_loss=1.94, val_accuracy=0.517, lr=0.1]    48%|████▊     | 48/100 [20:19<21:08, 24.40s/epoch, loss=1.12, accuracy=0.756, val_loss=2.03, val_accuracy=0.477, lr=0.1] 49%|████▉     | 49/100 [20:44<20:45, 24.42s/epoch, loss=1.13, accuracy=0.753, val_loss=3.17, val_accuracy=0.377, lr=0.1] 50%|█████     | 50/100 [21:08<20:21, 24.43s/epoch, loss=1.12, accuracy=0.754, val_loss=1.99, val_accuracy=0.494, lr=0.1] 51%|█████     | 51/100 [21:33<19:57, 24.44s/epoch, loss=1.11, accuracy=0.756, val_loss=6.44, val_accuracy=0.26, lr=0.0316] 52%|█████▏    | 52/100 [21:57<19:31, 24.40s/epoch, loss=1.12, accuracy=0.757, val_loss=1.7, val_accuracy=0.582, lr=0.1]    53%|█████▎    | 53/100 [22:21<19:05, 24.37s/epoch, loss=1.12, accuracy=0.756, val_loss=2.31, val_accuracy=0.425, lr=0.1] 54%|█████▍    | 54/100 [22:46<18:43, 24.43s/epoch, loss=1.13, accuracy=0.754, val_loss=1.78, val_accuracy=0.564, lr=0.1] 55%|█████▌    | 55/100 [23:10<18:19, 24.42s/epoch, loss=1.12, accuracy=0.755, val_loss=1.68, val_accuracy=0.558, lr=0.1] 56%|█████▌    | 56/100 [23:35<17:55, 24.45s/epoch, loss=1.12, accuracy=0.757, val_loss=1.74, val_accuracy=0.511, lr=0.0316] 57%|█████▋    | 57/100 [23:59<17:29, 24.40s/epoch, loss=1.12, accuracy=0.754, val_loss=2.36, val_accuracy=0.377, lr=0.1]    58%|█████▊    | 58/100 [24:23<17:07, 24.45s/epoch, loss=1.12, accuracy=0.754, val_loss=1.76, val_accuracy=0.538, lr=0.1] 59%|█████▉    | 59/100 [24:48<16:41, 24.44s/epoch, loss=1.11, accuracy=0.758, val_loss=3.39, val_accuracy=0.284, lr=0.1] 60%|██████    | 60/100 [25:12<16:18, 24.47s/epoch, loss=1.11, accuracy=0.757, val_loss=1.49, val_accuracy=0.61, lr=0.1]  61%|██████    | 61/100 [25:37<15:58, 24.59s/epoch, loss=1.11, accuracy=0.756, val_loss=4.43, val_accuracy=0.342, lr=0.0316] 62%|██████▏   | 62/100 [26:02<15:35, 24.62s/epoch, loss=1.11, accuracy=0.757, val_loss=1.42, val_accuracy=0.655, lr=0.1]    63%|██████▎   | 63/100 [26:27<15:12, 24.66s/epoch, loss=1.11, accuracy=0.755, val_loss=2.78, val_accuracy=0.405, lr=0.1] 64%|██████▍   | 64/100 [26:52<14:49, 24.70s/epoch, loss=1.11, accuracy=0.757, val_loss=1.97, val_accuracy=0.491, lr=0.1] 65%|██████▌   | 65/100 [27:16<14:24, 24.70s/epoch, loss=1.11, accuracy=0.755, val_loss=2.18, val_accuracy=0.491, lr=0.1] 66%|██████▌   | 66/100 [27:41<14:00, 24.73s/epoch, loss=1.11, accuracy=0.758, val_loss=2.68, val_accuracy=0.278, lr=0.0316] 67%|██████▋   | 67/100 [28:06<13:36, 24.74s/epoch, loss=1.12, accuracy=0.754, val_loss=2.08, val_accuracy=0.502, lr=0.1]    68%|██████▊   | 68/100 [28:30<13:10, 24.71s/epoch, loss=1.11, accuracy=0.757, val_loss=1.69, val_accuracy=0.564, lr=0.1] 69%|██████▉   | 69/100 [28:55<12:43, 24.64s/epoch, loss=1.12, accuracy=0.756, val_loss=3.7, val_accuracy=0.346, lr=0.1]  70%|███████   | 70/100 [29:20<12:18, 24.63s/epoch, loss=1.11, accuracy=0.756, val_loss=9.24, val_accuracy=0.152, lr=0.1] 71%|███████   | 71/100 [29:44<11:52, 24.58s/epoch, loss=1.11, accuracy=0.757, val_loss=2.13, val_accuracy=0.444, lr=0.0316] 72%|███████▏  | 72/100 [30:09<11:28, 24.57s/epoch, loss=1.11, accuracy=0.756, val_loss=1.8, val_accuracy=0.582, lr=0.1]     73%|███████▎  | 73/100 [30:33<11:02, 24.55s/epoch, loss=1.1, accuracy=0.758, val_loss=1.4, val_accuracy=0.66, lr=0.1]   74%|███████▍  | 74/100 [30:58<10:39, 24.59s/epoch, loss=1.11, accuracy=0.759, val_loss=2.19, val_accuracy=0.469, lr=0.1] 75%|███████▌  | 75/100 [31:22<10:15, 24.64s/epoch, loss=1.1, accuracy=0.758, val_loss=2.78, val_accuracy=0.452, lr=0.1]  76%|███████▌  | 76/100 [31:47<09:52, 24.69s/epoch, loss=1.12, accuracy=0.755, val_loss=2.88, val_accuracy=0.389, lr=0.0316] 77%|███████▋  | 77/100 [32:12<09:27, 24.68s/epoch, loss=1.11, accuracy=0.757, val_loss=1.76, val_accuracy=0.549, lr=0.1]    78%|███████▊  | 78/100 [32:37<09:03, 24.69s/epoch, loss=1.11, accuracy=0.756, val_loss=3.49, val_accuracy=0.329, lr=0.1] 79%|███████▉  | 79/100 [33:01<08:38, 24.67s/epoch, loss=1.11, accuracy=0.757, val_loss=3.69, val_accuracy=0.276, lr=0.1] 80%|████████  | 80/100 [33:26<08:13, 24.68s/epoch, loss=1.11, accuracy=0.758, val_loss=5.46, val_accuracy=0.219, lr=0.1] 81%|████████  | 81/100 [33:51<07:48, 24.64s/epoch, loss=1.11, accuracy=0.757, val_loss=2.92, val_accuracy=0.394, lr=0.0316] 82%|████████▏ | 82/100 [34:15<07:23, 24.62s/epoch, loss=0.912, accuracy=0.813, val_loss=0.95, val_accuracy=0.78, lr=0.01]   83%|████████▎ | 83/100 [34:40<06:57, 24.57s/epoch, loss=0.729, accuracy=0.847, val_loss=0.94, val_accuracy=0.764, lr=0.01] 84%|████████▍ | 84/100 [35:04<06:33, 24.56s/epoch, loss=0.652, accuracy=0.854, val_loss=0.794, val_accuracy=0.794, lr=0.01] 85%|████████▌ | 85/100 [35:29<06:08, 24.55s/epoch, loss=0.608, accuracy=0.858, val_loss=0.74, val_accuracy=0.807, lr=0.01]  86%|████████▌ | 86/100 [35:53<05:43, 24.52s/epoch, loss=0.582, accuracy=0.861, val_loss=0.882, val_accuracy=0.761, lr=0.01] 87%|████████▋ | 87/100 [36:18<05:18, 24.49s/epoch, loss=0.576, accuracy=0.859, val_loss=0.799, val_accuracy=0.784, lr=0.01] 88%|████████▊ | 88/100 [36:42<04:53, 24.48s/epoch, loss=0.569, accuracy=0.86, val_loss=0.697, val_accuracy=0.822, lr=0.01]  89%|████████▉ | 89/100 [37:06<04:28, 24.45s/epoch, loss=0.565, accuracy=0.862, val_loss=0.781, val_accuracy=0.791, lr=0.01] 90%|█████████ | 90/100 [37:31<04:04, 24.48s/epoch, loss=0.562, accuracy=0.863, val_loss=1.19, val_accuracy=0.7, lr=0.01]    91%|█████████ | 91/100 [37:55<03:40, 24.52s/epoch, loss=0.562, accuracy=0.864, val_loss=1.07, val_accuracy=0.715, lr=0.01] 92%|█████████▏| 92/100 [38:20<03:16, 24.54s/epoch, loss=0.561, accuracy=0.866, val_loss=0.899, val_accuracy=0.759, lr=0.01] 93%|█████████▎| 93/100 [38:45<02:51, 24.54s/epoch, loss=0.555, accuracy=0.869, val_loss=0.785, val_accuracy=0.802, lr=0.00316] 94%|█████████▍| 94/100 [39:09<02:27, 24.57s/epoch, loss=0.565, accuracy=0.866, val_loss=0.779, val_accuracy=0.796, lr=0.01]    95%|█████████▌| 95/100 [39:34<02:02, 24.58s/epoch, loss=0.559, accuracy=0.868, val_loss=0.832, val_accuracy=0.778, lr=0.01] 96%|█████████▌| 96/100 [39:58<01:38, 24.59s/epoch, loss=0.555, accuracy=0.872, val_loss=1.08, val_accuracy=0.71, lr=0.01]   97%|█████████▋| 97/100 [40:23<01:13, 24.58s/epoch, loss=0.555, accuracy=0.87, val_loss=0.74, val_accuracy=0.816, lr=0.01] 98%|█████████▊| 98/100 [40:48<00:49, 24.64s/epoch, loss=0.559, accuracy=0.871, val_loss=0.832, val_accuracy=0.776, lr=0.00316] 99%|█████████▉| 99/100 [41:12<00:24, 24.62s/epoch, loss=0.554, accuracy=0.874, val_loss=1.02, val_accuracy=0.742, lr=0.01]    100%|██████████| 100/100 [41:37<00:00, 24.60s/epoch, loss=0.556, accuracy=0.875, val_loss=0.788, val_accuracy=0.802, lr=0.01]100%|██████████| 100/100 [41:37<00:00, 24.97s/epoch, loss=0.556, accuracy=0.875, val_loss=0.788, val_accuracy=0.802, lr=0.01]
Using real-time data augmentation.
Test loss: 0.7881214618682861
Test accuracy: 0.8015999794006348


* * * Run SGD for ID = 15_4. * * *


2024-02-15 15:16:10.580406: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 15:16:13.553105: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 15:16:13.554307: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-15 15:16:13.594971: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 15:16:13.595028: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 15:16:13.598261: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 15:16:13.598307: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 15:16:13.600767: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 15:16:13.601511: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 15:16:13.604203: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 15:16:13.605841: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 15:16:13.611081: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 15:16:13.611691: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 15:16:13.611771: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 15:16:14.987509: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-15 15:16:14.988087: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 15:16:14.988536: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 15:16:14.988571: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 15:16:14.988606: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 15:16:14.988626: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 15:16:14.988653: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 15:16:14.988672: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 15:16:14.988702: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 15:16:14.988722: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 15:16:14.988740: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 15:16:14.989226: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 15:16:14.989262: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 15:16:15.713151: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-15 15:16:15.713216: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-15 15:16:15.713233: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-15 15:16:15.714602: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:02:00.0, compute capability: 6.1)
{'id': 154, 'batch_size': 128, 'epochs': 100, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/100 [00:00<?, ?epoch/s]2024-02-15 15:16:16.563852: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-15 15:16:16.575841: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199950000 Hz
2024-02-15 15:16:18.790606: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 15:16:19.096524: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 15:16:19.896812: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-15 15:16:19.958899: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/100 [01:09<1:55:03, 69.73s/epoch, loss=3.19, accuracy=0.297, val_loss=2.52, val_accuracy=0.216, lr=0.1]  2%|▏         | 2/100 [01:34<1:10:27, 43.14s/epoch, loss=1.65, accuracy=0.482, val_loss=1.85, val_accuracy=0.431, lr=0.1]  3%|▎         | 3/100 [01:58<55:55, 34.60s/epoch, loss=1.44, accuracy=0.589, val_loss=2.3, val_accuracy=0.368, lr=0.1]     4%|▍         | 4/100 [02:22<48:44, 30.46s/epoch, loss=1.32, accuracy=0.654, val_loss=2.37, val_accuracy=0.355, lr=0.1]  5%|▌         | 5/100 [02:47<44:52, 28.34s/epoch, loss=1.28, accuracy=0.681, val_loss=2.39, val_accuracy=0.361, lr=0.1]  6%|▌         | 6/100 [03:11<42:07, 26.89s/epoch, loss=1.27, accuracy=0.694, val_loss=1.74, val_accuracy=0.55, lr=0.1]   7%|▋         | 7/100 [03:35<40:19, 26.02s/epoch, loss=1.25, accuracy=0.706, val_loss=2.47, val_accuracy=0.364, lr=0.1]  8%|▊         | 8/100 [03:59<38:57, 25.41s/epoch, loss=1.23, accuracy=0.718, val_loss=3.71, val_accuracy=0.243, lr=0.1]  9%|▉         | 9/100 [04:23<37:55, 25.00s/epoch, loss=1.23, accuracy=0.719, val_loss=2.01, val_accuracy=0.473, lr=0.1] 10%|█         | 10/100 [04:48<37:07, 24.75s/epoch, loss=1.22, accuracy=0.726, val_loss=4.56, val_accuracy=0.253, lr=0.1] 11%|█         | 11/100 [05:12<36:20, 24.50s/epoch, loss=1.21, accuracy=0.728, val_loss=1.64, val_accuracy=0.578, lr=0.1] 12%|█▏        | 12/100 [05:36<35:45, 24.38s/epoch, loss=1.21, accuracy=0.731, val_loss=2.14, val_accuracy=0.424, lr=0.1] 13%|█▎        | 13/100 [06:00<35:13, 24.30s/epoch, loss=1.2, accuracy=0.733, val_loss=1.71, val_accuracy=0.574, lr=0.1]  14%|█▍        | 14/100 [06:24<34:41, 24.20s/epoch, loss=1.2, accuracy=0.736, val_loss=2.62, val_accuracy=0.388, lr=0.1] 15%|█▌        | 15/100 [06:48<34:14, 24.17s/epoch, loss=1.2, accuracy=0.736, val_loss=2.9, val_accuracy=0.204, lr=0.1]  16%|█▌        | 16/100 [07:12<33:58, 24.27s/epoch, loss=1.19, accuracy=0.736, val_loss=1.55, val_accuracy=0.585, lr=0.1] 17%|█▋        | 17/100 [07:37<33:37, 24.30s/epoch, loss=1.18, accuracy=0.74, val_loss=2.46, val_accuracy=0.429, lr=0.1]  18%|█▊        | 18/100 [08:01<33:11, 24.28s/epoch, loss=1.19, accuracy=0.739, val_loss=1.76, val_accuracy=0.577, lr=0.1] 19%|█▉        | 19/100 [08:25<32:48, 24.30s/epoch, loss=1.19, accuracy=0.738, val_loss=3.45, val_accuracy=0.289, lr=0.1] 20%|██        | 20/100 [08:50<32:27, 24.34s/epoch, loss=1.19, accuracy=0.741, val_loss=2.23, val_accuracy=0.481, lr=0.1] 21%|██        | 21/100 [09:14<31:59, 24.30s/epoch, loss=1.18, accuracy=0.743, val_loss=2.16, val_accuracy=0.505, lr=0.0316] 22%|██▏       | 22/100 [09:38<31:31, 24.25s/epoch, loss=1.18, accuracy=0.744, val_loss=2.64, val_accuracy=0.347, lr=0.1]    23%|██▎       | 23/100 [10:02<31:03, 24.21s/epoch, loss=1.18, accuracy=0.742, val_loss=1.83, val_accuracy=0.531, lr=0.1] 24%|██▍       | 24/100 [10:26<30:39, 24.20s/epoch, loss=1.16, accuracy=0.745, val_loss=2.31, val_accuracy=0.463, lr=0.1] 25%|██▌       | 25/100 [10:51<30:14, 24.19s/epoch, loss=1.17, accuracy=0.746, val_loss=1.95, val_accuracy=0.488, lr=0.1] 26%|██▌       | 26/100 [11:15<29:51, 24.21s/epoch, loss=1.17, accuracy=0.745, val_loss=2.42, val_accuracy=0.322, lr=0.0316] 27%|██▋       | 27/100 [11:39<29:28, 24.22s/epoch, loss=1.16, accuracy=0.75, val_loss=2.13, val_accuracy=0.486, lr=0.1]     28%|██▊       | 28/100 [12:03<29:05, 24.24s/epoch, loss=1.17, accuracy=0.747, val_loss=2.41, val_accuracy=0.385, lr=0.1] 29%|██▉       | 29/100 [12:28<28:43, 24.28s/epoch, loss=1.16, accuracy=0.75, val_loss=1.53, val_accuracy=0.62, lr=0.1]   30%|███       | 30/100 [12:52<28:22, 24.32s/epoch, loss=1.16, accuracy=0.749, val_loss=2.03, val_accuracy=0.447, lr=0.1] 31%|███       | 31/100 [13:16<27:59, 24.34s/epoch, loss=1.16, accuracy=0.749, val_loss=1.99, val_accuracy=0.51, lr=0.1]  32%|███▏      | 32/100 [13:41<27:36, 24.37s/epoch, loss=1.16, accuracy=0.752, val_loss=3.78, val_accuracy=0.35, lr=0.1] 33%|███▎      | 33/100 [14:05<27:11, 24.35s/epoch, loss=1.15, accuracy=0.75, val_loss=3.93, val_accuracy=0.212, lr=0.1] 34%|███▍      | 34/100 [14:29<26:45, 24.32s/epoch, loss=1.15, accuracy=0.749, val_loss=1.86, val_accuracy=0.536, lr=0.0316] 35%|███▌      | 35/100 [14:54<26:19, 24.30s/epoch, loss=1.15, accuracy=0.752, val_loss=3.08, val_accuracy=0.373, lr=0.1]    36%|███▌      | 36/100 [15:18<25:55, 24.30s/epoch, loss=1.15, accuracy=0.753, val_loss=1.61, val_accuracy=0.577, lr=0.1] 37%|███▋      | 37/100 [15:42<25:27, 24.25s/epoch, loss=1.15, accuracy=0.751, val_loss=1.59, val_accuracy=0.599, lr=0.1] 38%|███▊      | 38/100 [16:06<25:03, 24.25s/epoch, loss=1.15, accuracy=0.751, val_loss=1.58, val_accuracy=0.6, lr=0.1]   39%|███▉      | 39/100 [16:31<24:40, 24.27s/epoch, loss=1.15, accuracy=0.753, val_loss=1.59, val_accuracy=0.583, lr=0.0316] 40%|████      | 40/100 [16:55<24:15, 24.26s/epoch, loss=1.15, accuracy=0.753, val_loss=2.95, val_accuracy=0.407, lr=0.1]    41%|████      | 41/100 [17:19<23:52, 24.28s/epoch, loss=1.14, accuracy=0.753, val_loss=1.47, val_accuracy=0.646, lr=0.1] 42%|████▏     | 42/100 [17:44<23:28, 24.29s/epoch, loss=1.15, accuracy=0.751, val_loss=1.57, val_accuracy=0.604, lr=0.1] 43%|████▎     | 43/100 [18:08<23:05, 24.31s/epoch, loss=1.15, accuracy=0.753, val_loss=1.41, val_accuracy=0.665, lr=0.1] 44%|████▍     | 44/100 [18:32<22:41, 24.31s/epoch, loss=1.14, accuracy=0.755, val_loss=2.73, val_accuracy=0.409, lr=0.1] 45%|████▌     | 45/100 [18:57<22:17, 24.32s/epoch, loss=1.14, accuracy=0.754, val_loss=1.6, val_accuracy=0.606, lr=0.1]  46%|████▌     | 46/100 [19:21<21:52, 24.31s/epoch, loss=1.14, accuracy=0.755, val_loss=1.39, val_accuracy=0.68, lr=0.1] 47%|████▋     | 47/100 [19:45<21:29, 24.33s/epoch, loss=1.14, accuracy=0.753, val_loss=1.98, val_accuracy=0.462, lr=0.1] 48%|████▊     | 48/100 [20:09<21:03, 24.30s/epoch, loss=1.14, accuracy=0.756, val_loss=1.72, val_accuracy=0.568, lr=0.1] 49%|████▉     | 49/100 [20:34<20:39, 24.31s/epoch, loss=1.14, accuracy=0.753, val_loss=1.94, val_accuracy=0.541, lr=0.1] 50%|█████     | 50/100 [20:58<20:15, 24.31s/epoch, loss=1.14, accuracy=0.755, val_loss=2.32, val_accuracy=0.479, lr=0.1] 51%|█████     | 51/100 [21:22<19:50, 24.30s/epoch, loss=1.14, accuracy=0.756, val_loss=2.21, val_accuracy=0.482, lr=0.0316] 52%|█████▏    | 52/100 [21:47<19:30, 24.39s/epoch, loss=1.14, accuracy=0.756, val_loss=1.78, val_accuracy=0.548, lr=0.1]    53%|█████▎    | 53/100 [22:11<19:06, 24.38s/epoch, loss=1.14, accuracy=0.754, val_loss=1.91, val_accuracy=0.531, lr=0.1] 54%|█████▍    | 54/100 [22:36<18:41, 24.39s/epoch, loss=1.14, accuracy=0.754, val_loss=1.95, val_accuracy=0.495, lr=0.1] 55%|█████▌    | 55/100 [23:00<18:17, 24.40s/epoch, loss=1.14, accuracy=0.754, val_loss=1.72, val_accuracy=0.571, lr=0.1] 56%|█████▌    | 56/100 [23:25<17:53, 24.39s/epoch, loss=1.13, accuracy=0.755, val_loss=1.47, val_accuracy=0.626, lr=0.0316] 57%|█████▋    | 57/100 [23:49<17:28, 24.39s/epoch, loss=1.13, accuracy=0.757, val_loss=2.31, val_accuracy=0.505, lr=0.1]    58%|█████▊    | 58/100 [24:13<17:04, 24.39s/epoch, loss=1.13, accuracy=0.754, val_loss=1.72, val_accuracy=0.565, lr=0.1] 59%|█████▉    | 59/100 [24:38<16:39, 24.38s/epoch, loss=1.14, accuracy=0.754, val_loss=2.05, val_accuracy=0.487, lr=0.1] 60%|██████    | 60/100 [25:02<16:15, 24.38s/epoch, loss=1.14, accuracy=0.753, val_loss=1.95, val_accuracy=0.501, lr=0.1] 61%|██████    | 61/100 [25:26<15:49, 24.34s/epoch, loss=1.13, accuracy=0.756, val_loss=2.58, val_accuracy=0.437, lr=0.0316] 62%|██████▏   | 62/100 [25:51<15:27, 24.41s/epoch, loss=1.13, accuracy=0.758, val_loss=2.99, val_accuracy=0.279, lr=0.1]    63%|██████▎   | 63/100 [26:15<15:02, 24.39s/epoch, loss=1.14, accuracy=0.755, val_loss=2.28, val_accuracy=0.444, lr=0.1] 64%|██████▍   | 64/100 [26:40<14:37, 24.37s/epoch, loss=1.13, accuracy=0.756, val_loss=2.33, val_accuracy=0.525, lr=0.1] 65%|██████▌   | 65/100 [27:04<14:11, 24.34s/epoch, loss=1.14, accuracy=0.754, val_loss=2.03, val_accuracy=0.516, lr=0.1] 66%|██████▌   | 66/100 [27:28<13:48, 24.37s/epoch, loss=1.13, accuracy=0.756, val_loss=2.91, val_accuracy=0.368, lr=0.0316] 67%|██████▋   | 67/100 [27:53<13:24, 24.37s/epoch, loss=1.13, accuracy=0.754, val_loss=1.74, val_accuracy=0.55, lr=0.1]     68%|██████▊   | 68/100 [28:17<12:58, 24.34s/epoch, loss=1.13, accuracy=0.755, val_loss=2.98, val_accuracy=0.406, lr=0.1] 69%|██████▉   | 69/100 [28:41<12:33, 24.30s/epoch, loss=1.13, accuracy=0.754, val_loss=2.44, val_accuracy=0.407, lr=0.1] 70%|███████   | 70/100 [29:05<12:07, 24.25s/epoch, loss=1.13, accuracy=0.756, val_loss=1.58, val_accuracy=0.607, lr=0.1] 71%|███████   | 71/100 [29:29<11:42, 24.23s/epoch, loss=1.13, accuracy=0.754, val_loss=2.11, val_accuracy=0.445, lr=0.0316] 72%|███████▏  | 72/100 [29:54<11:17, 24.19s/epoch, loss=1.12, accuracy=0.758, val_loss=2.09, val_accuracy=0.56, lr=0.1]     73%|███████▎  | 73/100 [30:18<10:53, 24.21s/epoch, loss=1.13, accuracy=0.756, val_loss=2.3, val_accuracy=0.412, lr=0.1] 74%|███████▍  | 74/100 [30:42<10:29, 24.23s/epoch, loss=1.12, accuracy=0.757, val_loss=1.99, val_accuracy=0.518, lr=0.1] 75%|███████▌  | 75/100 [31:06<10:05, 24.23s/epoch, loss=1.13, accuracy=0.756, val_loss=1.57, val_accuracy=0.622, lr=0.1] 76%|███████▌  | 76/100 [31:31<09:43, 24.30s/epoch, loss=1.13, accuracy=0.754, val_loss=1.85, val_accuracy=0.549, lr=0.0316] 77%|███████▋  | 77/100 [31:55<09:18, 24.27s/epoch, loss=1.12, accuracy=0.759, val_loss=3.44, val_accuracy=0.345, lr=0.1]    78%|███████▊  | 78/100 [32:19<08:54, 24.30s/epoch, loss=1.12, accuracy=0.755, val_loss=1.79, val_accuracy=0.545, lr=0.1] 79%|███████▉  | 79/100 [32:44<08:29, 24.28s/epoch, loss=1.12, accuracy=0.757, val_loss=1.83, val_accuracy=0.502, lr=0.1] 80%|████████  | 80/100 [33:08<08:05, 24.25s/epoch, loss=1.13, accuracy=0.755, val_loss=2.45, val_accuracy=0.38, lr=0.1]  81%|████████  | 81/100 [33:32<07:40, 24.22s/epoch, loss=1.13, accuracy=0.755, val_loss=2.07, val_accuracy=0.463, lr=0.0316] 82%|████████▏ | 82/100 [33:56<07:15, 24.19s/epoch, loss=0.912, accuracy=0.815, val_loss=0.976, val_accuracy=0.773, lr=0.01] 83%|████████▎ | 83/100 [34:20<06:50, 24.16s/epoch, loss=0.735, accuracy=0.847, val_loss=0.783, val_accuracy=0.816, lr=0.01] 84%|████████▍ | 84/100 [34:44<06:27, 24.19s/epoch, loss=0.653, accuracy=0.856, val_loss=0.844, val_accuracy=0.785, lr=0.01] 85%|████████▌ | 85/100 [35:09<06:02, 24.18s/epoch, loss=0.61, accuracy=0.86, val_loss=0.788, val_accuracy=0.794, lr=0.01]   86%|████████▌ | 86/100 [35:33<05:39, 24.23s/epoch, loss=0.584, accuracy=0.862, val_loss=0.709, val_accuracy=0.82, lr=0.01] 87%|████████▋ | 87/100 [35:57<05:15, 24.26s/epoch, loss=0.579, accuracy=0.86, val_loss=0.829, val_accuracy=0.782, lr=0.01] 88%|████████▊ | 88/100 [36:22<04:51, 24.26s/epoch, loss=0.571, accuracy=0.863, val_loss=0.824, val_accuracy=0.783, lr=0.01] 89%|████████▉ | 89/100 [36:46<04:26, 24.25s/epoch, loss=0.566, accuracy=0.866, val_loss=0.757, val_accuracy=0.809, lr=0.01] 90%|█████████ | 90/100 [37:10<04:02, 24.21s/epoch, loss=0.565, accuracy=0.867, val_loss=0.749, val_accuracy=0.81, lr=0.01]  91%|█████████ | 91/100 [37:34<03:37, 24.16s/epoch, loss=0.56, accuracy=0.869, val_loss=0.972, val_accuracy=0.741, lr=0.00316] 92%|█████████▏| 92/100 [37:58<03:13, 24.18s/epoch, loss=0.556, accuracy=0.871, val_loss=0.91, val_accuracy=0.771, lr=0.01]    93%|█████████▎| 93/100 [38:22<02:49, 24.18s/epoch, loss=0.561, accuracy=0.871, val_loss=0.807, val_accuracy=0.79, lr=0.01] 94%|█████████▍| 94/100 [38:46<02:24, 24.16s/epoch, loss=0.558, accuracy=0.872, val_loss=0.686, val_accuracy=0.836, lr=0.01] 95%|█████████▌| 95/100 [39:11<02:00, 24.15s/epoch, loss=0.561, accuracy=0.872, val_loss=0.751, val_accuracy=0.809, lr=0.01] 96%|█████████▌| 96/100 [39:35<01:36, 24.17s/epoch, loss=0.562, accuracy=0.874, val_loss=0.775, val_accuracy=0.807, lr=0.01] 97%|█████████▋| 97/100 [39:59<01:12, 24.18s/epoch, loss=0.56, accuracy=0.875, val_loss=1.18, val_accuracy=0.7, lr=0.01]     98%|█████████▊| 98/100 [40:23<00:48, 24.20s/epoch, loss=0.556, accuracy=0.876, val_loss=0.766, val_accuracy=0.811, lr=0.01] 99%|█████████▉| 99/100 [40:47<00:24, 24.18s/epoch, loss=0.557, accuracy=0.876, val_loss=0.77, val_accuracy=0.805, lr=0.00316]100%|██████████| 100/100 [41:12<00:00, 24.23s/epoch, loss=0.556, accuracy=0.876, val_loss=0.999, val_accuracy=0.752, lr=0.01] 100%|██████████| 100/100 [41:12<00:00, 24.72s/epoch, loss=0.556, accuracy=0.876, val_loss=0.999, val_accuracy=0.752, lr=0.01]
Using real-time data augmentation.
Test loss: 0.9989511966705322
Test accuracy: 0.7515000104904175


* * * Run SGD for ID = 15_5. * * *


2024-02-15 15:57:31.297105: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 15:57:34.410107: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 15:57:34.411355: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-15 15:57:34.450303: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 15:57:34.450349: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 15:57:34.453522: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 15:57:34.453569: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 15:57:34.456027: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 15:57:34.456713: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 15:57:34.459402: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 15:57:34.460958: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 15:57:34.466108: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 15:57:34.466712: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 15:57:34.466796: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 15:57:35.831096: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-15 15:57:35.831642: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 15:57:35.832111: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 15:57:35.832145: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 15:57:35.832180: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 15:57:35.832200: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 15:57:35.832219: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 15:57:35.832238: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 15:57:35.832257: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 15:57:35.832284: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 15:57:35.832304: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 15:57:35.832793: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 15:57:35.832836: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 15:57:36.548727: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-15 15:57:36.548792: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-15 15:57:36.548803: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-15 15:57:36.550180: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:02:00.0, compute capability: 6.1)
{'id': 155, 'batch_size': 128, 'epochs': 100, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/100 [00:00<?, ?epoch/s]2024-02-15 15:57:37.400219: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-15 15:57:37.412821: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199950000 Hz
2024-02-15 15:57:39.644095: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 15:57:39.925912: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 15:57:40.806286: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-15 15:57:40.864861: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/100 [01:08<1:53:19, 68.68s/epoch, loss=3.2, accuracy=0.32, val_loss=2.84, val_accuracy=0.194, lr=0.1]  2%|▏         | 2/100 [01:32<1:09:17, 42.43s/epoch, loss=1.57, accuracy=0.533, val_loss=1.78, val_accuracy=0.461, lr=0.1]  3%|▎         | 3/100 [01:56<54:56, 33.99s/epoch, loss=1.41, accuracy=0.611, val_loss=2.75, val_accuracy=0.346, lr=0.1]    4%|▍         | 4/100 [02:20<48:03, 30.04s/epoch, loss=1.32, accuracy=0.667, val_loss=2.02, val_accuracy=0.485, lr=0.1]  5%|▌         | 5/100 [02:44<44:05, 27.85s/epoch, loss=1.28, accuracy=0.688, val_loss=1.89, val_accuracy=0.508, lr=0.1]  6%|▌         | 6/100 [03:08<41:31, 26.50s/epoch, loss=1.25, accuracy=0.706, val_loss=1.78, val_accuracy=0.522, lr=0.1]  7%|▋         | 7/100 [03:32<39:45, 25.65s/epoch, loss=1.23, accuracy=0.715, val_loss=1.49, val_accuracy=0.624, lr=0.1]  8%|▊         | 8/100 [03:56<38:33, 25.15s/epoch, loss=1.23, accuracy=0.718, val_loss=2.44, val_accuracy=0.416, lr=0.1]  9%|▉         | 9/100 [04:20<37:32, 24.76s/epoch, loss=1.22, accuracy=0.725, val_loss=1.36, val_accuracy=0.669, lr=0.1] 10%|█         | 10/100 [04:44<36:45, 24.51s/epoch, loss=1.21, accuracy=0.732, val_loss=4.88, val_accuracy=0.238, lr=0.1] 11%|█         | 11/100 [05:08<36:01, 24.29s/epoch, loss=1.2, accuracy=0.732, val_loss=1.84, val_accuracy=0.569, lr=0.1]  12%|█▏        | 12/100 [05:31<35:22, 24.12s/epoch, loss=1.2, accuracy=0.734, val_loss=3.69, val_accuracy=0.309, lr=0.1] 13%|█▎        | 13/100 [05:56<35:03, 24.18s/epoch, loss=1.2, accuracy=0.737, val_loss=2.38, val_accuracy=0.432, lr=0.1] 14%|█▍        | 14/100 [06:20<34:36, 24.14s/epoch, loss=1.19, accuracy=0.738, val_loss=2.05, val_accuracy=0.511, lr=0.0316] 15%|█▌        | 15/100 [06:44<34:11, 24.13s/epoch, loss=1.19, accuracy=0.739, val_loss=2.86, val_accuracy=0.399, lr=0.1]    16%|█▌        | 16/100 [07:08<33:41, 24.07s/epoch, loss=1.19, accuracy=0.741, val_loss=2.19, val_accuracy=0.467, lr=0.1] 17%|█▋        | 17/100 [07:32<33:15, 24.05s/epoch, loss=1.18, accuracy=0.743, val_loss=1.66, val_accuracy=0.552, lr=0.1] 18%|█▊        | 18/100 [07:56<32:48, 24.01s/epoch, loss=1.18, accuracy=0.742, val_loss=1.86, val_accuracy=0.558, lr=0.1] 19%|█▉        | 19/100 [08:20<32:20, 23.96s/epoch, loss=1.19, accuracy=0.742, val_loss=1.61, val_accuracy=0.63, lr=0.0316] 20%|██        | 20/100 [08:43<31:55, 23.95s/epoch, loss=1.18, accuracy=0.745, val_loss=1.92, val_accuracy=0.535, lr=0.1]   21%|██        | 21/100 [09:07<31:28, 23.91s/epoch, loss=1.18, accuracy=0.747, val_loss=1.82, val_accuracy=0.545, lr=0.1] 22%|██▏       | 22/100 [09:31<31:01, 23.86s/epoch, loss=1.17, accuracy=0.747, val_loss=1.85, val_accuracy=0.508, lr=0.1] 23%|██▎       | 23/100 [09:55<30:39, 23.89s/epoch, loss=1.17, accuracy=0.746, val_loss=2.21, val_accuracy=0.464, lr=0.1] 24%|██▍       | 24/100 [10:19<30:14, 23.88s/epoch, loss=1.18, accuracy=0.747, val_loss=2.26, val_accuracy=0.445, lr=0.0316] 25%|██▌       | 25/100 [10:43<29:51, 23.88s/epoch, loss=1.17, accuracy=0.75, val_loss=1.46, val_accuracy=0.662, lr=0.1]     26%|██▌       | 26/100 [11:07<29:26, 23.88s/epoch, loss=1.17, accuracy=0.746, val_loss=2.33, val_accuracy=0.436, lr=0.1] 27%|██▋       | 27/100 [11:30<29:01, 23.86s/epoch, loss=1.17, accuracy=0.747, val_loss=1.48, val_accuracy=0.624, lr=0.1] 28%|██▊       | 28/100 [11:55<28:44, 23.95s/epoch, loss=1.17, accuracy=0.75, val_loss=2.15, val_accuracy=0.507, lr=0.1]  29%|██▉       | 29/100 [12:19<28:20, 23.95s/epoch, loss=1.16, accuracy=0.75, val_loss=1.72, val_accuracy=0.615, lr=0.0316] 30%|███       | 30/100 [12:42<27:53, 23.91s/epoch, loss=1.17, accuracy=0.749, val_loss=2.24, val_accuracy=0.458, lr=0.1]   31%|███       | 31/100 [13:06<27:30, 23.92s/epoch, loss=1.16, accuracy=0.748, val_loss=5.58, val_accuracy=0.3, lr=0.1]   32%|███▏      | 32/100 [13:30<27:07, 23.94s/epoch, loss=1.16, accuracy=0.752, val_loss=1.6, val_accuracy=0.573, lr=0.1] 33%|███▎      | 33/100 [13:54<26:46, 23.97s/epoch, loss=1.17, accuracy=0.748, val_loss=1.7, val_accuracy=0.596, lr=0.1] 34%|███▍      | 34/100 [14:18<26:24, 24.01s/epoch, loss=1.15, accuracy=0.751, val_loss=1.69, val_accuracy=0.568, lr=0.0316] 35%|███▌      | 35/100 [14:42<25:56, 23.95s/epoch, loss=1.16, accuracy=0.75, val_loss=1.57, val_accuracy=0.609, lr=0.1]     36%|███▌      | 36/100 [15:06<25:29, 23.90s/epoch, loss=1.16, accuracy=0.751, val_loss=2.33, val_accuracy=0.449, lr=0.1] 37%|███▋      | 37/100 [15:30<25:05, 23.89s/epoch, loss=1.17, accuracy=0.751, val_loss=2.36, val_accuracy=0.372, lr=0.1] 38%|███▊      | 38/100 [15:54<24:41, 23.90s/epoch, loss=1.16, accuracy=0.752, val_loss=1.74, val_accuracy=0.568, lr=0.1] 39%|███▉      | 39/100 [16:18<24:18, 23.90s/epoch, loss=1.15, accuracy=0.753, val_loss=2.35, val_accuracy=0.439, lr=0.0316] 40%|████      | 40/100 [16:42<23:57, 23.96s/epoch, loss=1.16, accuracy=0.752, val_loss=1.49, val_accuracy=0.642, lr=0.1]    41%|████      | 41/100 [17:06<23:32, 23.95s/epoch, loss=1.16, accuracy=0.752, val_loss=1.44, val_accuracy=0.646, lr=0.1] 42%|████▏     | 42/100 [17:30<23:08, 23.94s/epoch, loss=1.15, accuracy=0.753, val_loss=2.08, val_accuracy=0.509, lr=0.1] 43%|████▎     | 43/100 [17:54<22:44, 23.94s/epoch, loss=1.15, accuracy=0.753, val_loss=1.79, val_accuracy=0.542, lr=0.1] 44%|████▍     | 44/100 [18:18<22:21, 23.96s/epoch, loss=1.14, accuracy=0.754, val_loss=1.89, val_accuracy=0.518, lr=0.0316] 45%|████▌     | 45/100 [18:41<21:50, 23.82s/epoch, loss=1.14, accuracy=0.755, val_loss=3.62, val_accuracy=0.368, lr=0.1]    46%|████▌     | 46/100 [19:05<21:21, 23.72s/epoch, loss=1.15, accuracy=0.752, val_loss=1.65, val_accuracy=0.585, lr=0.1] 47%|████▋     | 47/100 [19:28<20:50, 23.59s/epoch, loss=1.15, accuracy=0.755, val_loss=2.81, val_accuracy=0.375, lr=0.1] 48%|████▊     | 48/100 [19:51<20:23, 23.53s/epoch, loss=1.14, accuracy=0.754, val_loss=2.75, val_accuracy=0.387, lr=0.1] 49%|████▉     | 49/100 [20:15<19:57, 23.48s/epoch, loss=1.15, accuracy=0.755, val_loss=1.72, val_accuracy=0.584, lr=0.0316] 50%|█████     | 50/100 [20:38<19:35, 23.51s/epoch, loss=1.14, accuracy=0.756, val_loss=2.54, val_accuracy=0.428, lr=0.1]    51%|█████     | 51/100 [21:02<19:12, 23.51s/epoch, loss=1.14, accuracy=0.755, val_loss=1.83, val_accuracy=0.553, lr=0.1] 52%|█████▏    | 52/100 [21:25<18:48, 23.52s/epoch, loss=1.14, accuracy=0.756, val_loss=1.99, val_accuracy=0.552, lr=0.1] 53%|█████▎    | 53/100 [21:49<18:24, 23.49s/epoch, loss=1.14, accuracy=0.756, val_loss=1.77, val_accuracy=0.529, lr=0.1] 54%|█████▍    | 54/100 [22:12<17:59, 23.48s/epoch, loss=1.14, accuracy=0.756, val_loss=2.27, val_accuracy=0.423, lr=0.0316] 55%|█████▌    | 55/100 [22:36<17:37, 23.50s/epoch, loss=1.14, accuracy=0.755, val_loss=2.29, val_accuracy=0.413, lr=0.1]    56%|█████▌    | 56/100 [22:59<17:16, 23.57s/epoch, loss=1.14, accuracy=0.756, val_loss=1.76, val_accuracy=0.57, lr=0.1]  57%|█████▋    | 57/100 [23:23<16:52, 23.55s/epoch, loss=1.13, accuracy=0.758, val_loss=2.01, val_accuracy=0.527, lr=0.1] 58%|█████▊    | 58/100 [23:47<16:32, 23.63s/epoch, loss=1.13, accuracy=0.758, val_loss=2.68, val_accuracy=0.386, lr=0.1] 59%|█████▉    | 59/100 [24:10<16:09, 23.64s/epoch, loss=1.13, accuracy=0.76, val_loss=4.31, val_accuracy=0.289, lr=0.0316] 60%|██████    | 60/100 [24:34<15:40, 23.52s/epoch, loss=1.13, accuracy=0.756, val_loss=1.91, val_accuracy=0.488, lr=0.1]   61%|██████    | 61/100 [24:57<15:15, 23.48s/epoch, loss=1.13, accuracy=0.756, val_loss=2.31, val_accuracy=0.511, lr=0.1] 62%|██████▏   | 62/100 [25:21<14:52, 23.49s/epoch, loss=1.14, accuracy=0.754, val_loss=1.71, val_accuracy=0.548, lr=0.1] 63%|██████▎   | 63/100 [25:44<14:25, 23.39s/epoch, loss=1.13, accuracy=0.758, val_loss=7.04, val_accuracy=0.145, lr=0.1] 64%|██████▍   | 64/100 [26:07<14:00, 23.34s/epoch, loss=1.13, accuracy=0.758, val_loss=2.66, val_accuracy=0.41, lr=0.0316] 65%|██████▌   | 65/100 [26:30<13:36, 23.33s/epoch, loss=1.13, accuracy=0.757, val_loss=1.89, val_accuracy=0.569, lr=0.1]   66%|██████▌   | 66/100 [26:54<13:14, 23.37s/epoch, loss=1.14, accuracy=0.757, val_loss=1.68, val_accuracy=0.595, lr=0.1] 67%|██████▋   | 67/100 [27:17<12:54, 23.48s/epoch, loss=1.13, accuracy=0.756, val_loss=1.57, val_accuracy=0.596, lr=0.1] 68%|██████▊   | 68/100 [27:41<12:30, 23.44s/epoch, loss=1.12, accuracy=0.759, val_loss=2.57, val_accuracy=0.41, lr=0.1]  69%|██████▉   | 69/100 [28:04<12:07, 23.46s/epoch, loss=1.12, accuracy=0.759, val_loss=2.96, val_accuracy=0.331, lr=0.0316] 70%|███████   | 70/100 [28:28<11:42, 23.43s/epoch, loss=1.13, accuracy=0.759, val_loss=1.7, val_accuracy=0.565, lr=0.1]     71%|███████   | 71/100 [28:51<11:17, 23.35s/epoch, loss=1.13, accuracy=0.757, val_loss=3.52, val_accuracy=0.314, lr=0.1] 72%|███████▏  | 72/100 [29:14<10:56, 23.46s/epoch, loss=1.13, accuracy=0.758, val_loss=1.79, val_accuracy=0.553, lr=0.1] 73%|███████▎  | 73/100 [29:38<10:34, 23.51s/epoch, loss=1.13, accuracy=0.758, val_loss=1.44, val_accuracy=0.644, lr=0.1] 74%|███████▍  | 74/100 [30:02<10:11, 23.53s/epoch, loss=1.12, accuracy=0.759, val_loss=2.55, val_accuracy=0.47, lr=0.0316] 75%|███████▌  | 75/100 [30:25<09:46, 23.47s/epoch, loss=1.12, accuracy=0.757, val_loss=2.46, val_accuracy=0.434, lr=0.1]   76%|███████▌  | 76/100 [30:49<09:23, 23.50s/epoch, loss=1.13, accuracy=0.756, val_loss=2.06, val_accuracy=0.454, lr=0.1] 77%|███████▋  | 77/100 [31:12<09:01, 23.53s/epoch, loss=1.12, accuracy=0.755, val_loss=1.63, val_accuracy=0.587, lr=0.1] 78%|███████▊  | 78/100 [31:36<08:38, 23.59s/epoch, loss=1.12, accuracy=0.759, val_loss=2.2, val_accuracy=0.427, lr=0.1]  79%|███████▉  | 79/100 [32:00<08:17, 23.69s/epoch, loss=1.12, accuracy=0.758, val_loss=2.19, val_accuracy=0.522, lr=0.0316] 80%|████████  | 80/100 [32:24<07:54, 23.71s/epoch, loss=1.13, accuracy=0.757, val_loss=2.37, val_accuracy=0.434, lr=0.1]    81%|████████  | 81/100 [32:47<07:28, 23.63s/epoch, loss=1.12, accuracy=0.758, val_loss=4.18, val_accuracy=0.179, lr=0.1] 82%|████████▏ | 82/100 [33:11<07:05, 23.64s/epoch, loss=0.919, accuracy=0.815, val_loss=0.897, val_accuracy=0.807, lr=0.01] 83%|████████▎ | 83/100 [33:34<06:39, 23.49s/epoch, loss=0.733, accuracy=0.848, val_loss=0.814, val_accuracy=0.811, lr=0.01] 84%|████████▍ | 84/100 [33:58<06:18, 23.68s/epoch, loss=0.646, accuracy=0.858, val_loss=0.765, val_accuracy=0.814, lr=0.01] 85%|████████▌ | 85/100 [34:21<05:52, 23.48s/epoch, loss=0.603, accuracy=0.863, val_loss=0.7, val_accuracy=0.826, lr=0.01]   86%|████████▌ | 86/100 [34:45<05:30, 23.58s/epoch, loss=0.585, accuracy=0.861, val_loss=0.926, val_accuracy=0.75, lr=0.01] 87%|████████▋ | 87/100 [35:08<05:06, 23.54s/epoch, loss=0.573, accuracy=0.864, val_loss=0.687, val_accuracy=0.828, lr=0.01] 88%|████████▊ | 88/100 [35:32<04:42, 23.56s/epoch, loss=0.566, accuracy=0.866, val_loss=0.707, val_accuracy=0.817, lr=0.01] 89%|████████▉ | 89/100 [35:55<04:18, 23.49s/epoch, loss=0.565, accuracy=0.864, val_loss=0.868, val_accuracy=0.779, lr=0.01] 90%|█████████ | 90/100 [36:19<03:54, 23.48s/epoch, loss=0.56, accuracy=0.867, val_loss=0.881, val_accuracy=0.766, lr=0.01]  91%|█████████ | 91/100 [36:42<03:29, 23.33s/epoch, loss=0.559, accuracy=0.867, val_loss=0.885, val_accuracy=0.777, lr=0.01] 92%|█████████▏| 92/100 [37:05<03:05, 23.21s/epoch, loss=0.557, accuracy=0.869, val_loss=0.877, val_accuracy=0.763, lr=0.00316] 93%|█████████▎| 93/100 [37:28<02:43, 23.29s/epoch, loss=0.556, accuracy=0.872, val_loss=1.48, val_accuracy=0.661, lr=0.01]     94%|█████████▍| 94/100 [37:51<02:19, 23.29s/epoch, loss=0.555, accuracy=0.873, val_loss=0.747, val_accuracy=0.813, lr=0.01] 95%|█████████▌| 95/100 [38:15<01:56, 23.27s/epoch, loss=0.555, accuracy=0.874, val_loss=1.22, val_accuracy=0.711, lr=0.01]  96%|█████████▌| 96/100 [38:38<01:33, 23.27s/epoch, loss=0.555, accuracy=0.875, val_loss=0.849, val_accuracy=0.786, lr=0.01] 97%|█████████▋| 97/100 [39:01<01:09, 23.27s/epoch, loss=0.554, accuracy=0.876, val_loss=0.887, val_accuracy=0.778, lr=0.00316] 98%|█████████▊| 98/100 [39:24<00:46, 23.25s/epoch, loss=0.553, accuracy=0.876, val_loss=0.789, val_accuracy=0.799, lr=0.01]    99%|█████████▉| 99/100 [39:48<00:23, 23.27s/epoch, loss=0.552, accuracy=0.878, val_loss=1.11, val_accuracy=0.745, lr=0.01] 100%|██████████| 100/100 [40:11<00:00, 23.25s/epoch, loss=0.556, accuracy=0.877, val_loss=0.746, val_accuracy=0.817, lr=0.01]100%|██████████| 100/100 [40:11<00:00, 24.11s/epoch, loss=0.556, accuracy=0.877, val_loss=0.746, val_accuracy=0.817, lr=0.01]
Using real-time data augmentation.
Test loss: 0.7458692193031311
Test accuracy: 0.8169999718666077


* * * Run SGD for ID = 15_6. * * *


2024-02-15 16:37:51.232825: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 16:37:54.040450: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 16:37:54.041764: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-15 16:37:54.080604: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 16:37:54.080646: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 16:37:54.083599: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 16:37:54.083640: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 16:37:54.085951: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 16:37:54.086761: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 16:37:54.089250: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 16:37:54.090777: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 16:37:54.095526: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 16:37:54.096138: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 16:37:54.096226: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 16:37:55.317638: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-15 16:37:55.318188: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 16:37:55.318657: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 16:37:55.318713: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 16:37:55.318748: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 16:37:55.318766: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 16:37:55.318783: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 16:37:55.318800: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 16:37:55.318817: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 16:37:55.318834: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 16:37:55.318851: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 16:37:55.319331: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 16:37:55.319364: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 16:37:55.994667: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-15 16:37:55.994735: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-15 16:37:55.994746: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-15 16:37:55.995728: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:02:00.0, compute capability: 6.1)
{'id': 156, 'batch_size': 128, 'epochs': 100, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/100 [00:00<?, ?epoch/s]2024-02-15 16:37:56.799328: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-15 16:37:56.811817: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199950000 Hz
2024-02-15 16:37:59.035856: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 16:37:59.325342: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 16:38:00.108560: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-15 16:38:00.171649: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/100 [01:03<1:44:15, 63.19s/epoch, loss=3.21, accuracy=0.267, val_loss=2.34, val_accuracy=0.3, lr=0.1]  2%|▏         | 2/100 [01:27<1:05:31, 40.11s/epoch, loss=1.6, accuracy=0.514, val_loss=2.67, val_accuracy=0.332, lr=0.1]  3%|▎         | 3/100 [01:50<52:20, 32.38s/epoch, loss=1.36, accuracy=0.63, val_loss=2.19, val_accuracy=0.373, lr=0.1]    4%|▍         | 4/100 [02:13<46:10, 28.86s/epoch, loss=1.29, accuracy=0.673, val_loss=2.15, val_accuracy=0.475, lr=0.1]  5%|▌         | 5/100 [02:37<42:34, 26.89s/epoch, loss=1.25, accuracy=0.697, val_loss=1.72, val_accuracy=0.552, lr=0.1]  6%|▌         | 6/100 [03:00<40:21, 25.76s/epoch, loss=1.23, accuracy=0.71, val_loss=3.13, val_accuracy=0.382, lr=0.1]   7%|▋         | 7/100 [03:24<38:43, 24.99s/epoch, loss=1.23, accuracy=0.716, val_loss=1.92, val_accuracy=0.479, lr=0.1]  8%|▊         | 8/100 [03:47<37:45, 24.62s/epoch, loss=1.22, accuracy=0.718, val_loss=2.67, val_accuracy=0.35, lr=0.1]   9%|▉         | 9/100 [04:11<36:47, 24.26s/epoch, loss=1.21, accuracy=0.726, val_loss=1.93, val_accuracy=0.497, lr=0.1] 10%|█         | 10/100 [04:34<35:52, 23.92s/epoch, loss=1.21, accuracy=0.728, val_loss=1.73, val_accuracy=0.624, lr=0.0316] 11%|█         | 11/100 [04:58<35:22, 23.85s/epoch, loss=1.2, accuracy=0.729, val_loss=1.68, val_accuracy=0.568, lr=0.1]     12%|█▏        | 12/100 [05:21<34:50, 23.76s/epoch, loss=1.2, accuracy=0.731, val_loss=2.2, val_accuracy=0.438, lr=0.1]  13%|█▎        | 13/100 [05:44<34:09, 23.56s/epoch, loss=1.2, accuracy=0.733, val_loss=2.46, val_accuracy=0.483, lr=0.1] 14%|█▍        | 14/100 [06:08<33:40, 23.49s/epoch, loss=1.19, accuracy=0.732, val_loss=2.62, val_accuracy=0.447, lr=0.1] 15%|█▌        | 15/100 [06:32<33:33, 23.69s/epoch, loss=1.19, accuracy=0.735, val_loss=1.7, val_accuracy=0.598, lr=0.1]  16%|█▌        | 16/100 [06:56<33:18, 23.79s/epoch, loss=1.18, accuracy=0.741, val_loss=2.19, val_accuracy=0.481, lr=0.0316] 17%|█▋        | 17/100 [07:20<32:58, 23.83s/epoch, loss=1.18, accuracy=0.739, val_loss=1.62, val_accuracy=0.608, lr=0.1]    18%|█▊        | 18/100 [07:43<32:27, 23.75s/epoch, loss=1.19, accuracy=0.737, val_loss=1.96, val_accuracy=0.535, lr=0.1] 19%|█▉        | 19/100 [08:07<31:52, 23.62s/epoch, loss=1.17, accuracy=0.742, val_loss=1.88, val_accuracy=0.546, lr=0.1] 20%|██        | 20/100 [08:30<31:18, 23.49s/epoch, loss=1.18, accuracy=0.741, val_loss=1.9, val_accuracy=0.522, lr=0.1]  21%|██        | 21/100 [08:54<30:58, 23.52s/epoch, loss=1.17, accuracy=0.742, val_loss=1.82, val_accuracy=0.522, lr=0.1] 22%|██▏       | 22/100 [09:17<30:31, 23.47s/epoch, loss=1.17, accuracy=0.743, val_loss=1.6, val_accuracy=0.621, lr=0.1]  23%|██▎       | 23/100 [09:40<30:07, 23.48s/epoch, loss=1.18, accuracy=0.74, val_loss=3.02, val_accuracy=0.344, lr=0.1] 24%|██▍       | 24/100 [10:04<29:49, 23.54s/epoch, loss=1.17, accuracy=0.745, val_loss=1.79, val_accuracy=0.528, lr=0.1] 25%|██▌       | 25/100 [10:28<29:24, 23.53s/epoch, loss=1.17, accuracy=0.744, val_loss=2.1, val_accuracy=0.475, lr=0.1]  26%|██▌       | 26/100 [10:51<29:01, 23.53s/epoch, loss=1.16, accuracy=0.747, val_loss=1.76, val_accuracy=0.562, lr=0.1] 27%|██▋       | 27/100 [11:15<28:45, 23.63s/epoch, loss=1.16, accuracy=0.746, val_loss=2.51, val_accuracy=0.382, lr=0.0316] 28%|██▊       | 28/100 [11:39<28:30, 23.76s/epoch, loss=1.16, accuracy=0.746, val_loss=1.89, val_accuracy=0.547, lr=0.1]    29%|██▉       | 29/100 [12:03<28:02, 23.70s/epoch, loss=1.16, accuracy=0.747, val_loss=2.48, val_accuracy=0.42, lr=0.1]  30%|███       | 30/100 [12:27<27:45, 23.79s/epoch, loss=1.16, accuracy=0.747, val_loss=1.89, val_accuracy=0.496, lr=0.1] 31%|███       | 31/100 [12:50<27:17, 23.74s/epoch, loss=1.16, accuracy=0.748, val_loss=1.61, val_accuracy=0.608, lr=0.1] 32%|███▏      | 32/100 [13:14<26:52, 23.72s/epoch, loss=1.15, accuracy=0.751, val_loss=1.66, val_accuracy=0.57, lr=0.0316] 33%|███▎      | 33/100 [13:37<26:21, 23.60s/epoch, loss=1.15, accuracy=0.75, val_loss=1.47, val_accuracy=0.638, lr=0.1]    34%|███▍      | 34/100 [14:01<25:55, 23.57s/epoch, loss=1.15, accuracy=0.747, val_loss=2.32, val_accuracy=0.451, lr=0.1] 35%|███▌      | 35/100 [14:24<25:31, 23.56s/epoch, loss=1.16, accuracy=0.746, val_loss=2.19, val_accuracy=0.518, lr=0.1] 36%|███▌      | 36/100 [14:48<25:03, 23.49s/epoch, loss=1.16, accuracy=0.748, val_loss=3.12, val_accuracy=0.31, lr=0.1]  37%|███▋      | 37/100 [15:11<24:33, 23.39s/epoch, loss=1.15, accuracy=0.746, val_loss=2.42, val_accuracy=0.461, lr=0.1] 38%|███▊      | 38/100 [15:34<24:14, 23.46s/epoch, loss=1.14, accuracy=0.751, val_loss=1.72, val_accuracy=0.536, lr=0.0316] 39%|███▉      | 39/100 [15:58<23:53, 23.51s/epoch, loss=1.15, accuracy=0.749, val_loss=2.04, val_accuracy=0.456, lr=0.1]    40%|████      | 40/100 [16:21<23:24, 23.41s/epoch, loss=1.15, accuracy=0.751, val_loss=1.81, val_accuracy=0.587, lr=0.1] 41%|████      | 41/100 [16:44<22:59, 23.38s/epoch, loss=1.15, accuracy=0.749, val_loss=2.36, val_accuracy=0.534, lr=0.1] 42%|████▏     | 42/100 [17:08<22:40, 23.46s/epoch, loss=1.14, accuracy=0.751, val_loss=1.79, val_accuracy=0.579, lr=0.1] 43%|████▎     | 43/100 [17:32<22:23, 23.57s/epoch, loss=1.14, accuracy=0.749, val_loss=1.8, val_accuracy=0.561, lr=0.0316] 44%|████▍     | 44/100 [17:56<22:01, 23.59s/epoch, loss=1.14, accuracy=0.751, val_loss=2.81, val_accuracy=0.357, lr=0.1]   45%|████▌     | 45/100 [18:19<21:32, 23.50s/epoch, loss=1.14, accuracy=0.752, val_loss=1.94, val_accuracy=0.533, lr=0.1] 46%|████▌     | 46/100 [18:42<21:10, 23.52s/epoch, loss=1.14, accuracy=0.751, val_loss=2.38, val_accuracy=0.481, lr=0.1] 47%|████▋     | 47/100 [19:06<20:46, 23.51s/epoch, loss=1.14, accuracy=0.751, val_loss=3.1, val_accuracy=0.401, lr=0.1]  48%|████▊     | 48/100 [19:29<20:21, 23.49s/epoch, loss=1.14, accuracy=0.752, val_loss=1.91, val_accuracy=0.5, lr=0.0316] 49%|████▉     | 49/100 [19:53<20:01, 23.56s/epoch, loss=1.15, accuracy=0.748, val_loss=1.86, val_accuracy=0.48, lr=0.1]   50%|█████     | 50/100 [20:17<19:36, 23.54s/epoch, loss=1.14, accuracy=0.752, val_loss=1.65, val_accuracy=0.574, lr=0.1] 51%|█████     | 51/100 [20:40<19:09, 23.46s/epoch, loss=1.14, accuracy=0.752, val_loss=1.67, val_accuracy=0.563, lr=0.1] 52%|█████▏    | 52/100 [21:03<18:45, 23.44s/epoch, loss=1.13, accuracy=0.753, val_loss=1.73, val_accuracy=0.551, lr=0.1] 53%|█████▎    | 53/100 [21:27<18:24, 23.50s/epoch, loss=1.14, accuracy=0.751, val_loss=2.24, val_accuracy=0.475, lr=0.0316] 54%|█████▍    | 54/100 [21:50<18:02, 23.53s/epoch, loss=1.13, accuracy=0.756, val_loss=2.32, val_accuracy=0.447, lr=0.1]    55%|█████▌    | 55/100 [22:15<17:45, 23.68s/epoch, loss=1.13, accuracy=0.755, val_loss=2, val_accuracy=0.529, lr=0.1]    56%|█████▌    | 56/100 [22:38<17:24, 23.74s/epoch, loss=1.14, accuracy=0.751, val_loss=2.56, val_accuracy=0.404, lr=0.1] 57%|█████▋    | 57/100 [23:02<16:57, 23.66s/epoch, loss=1.13, accuracy=0.753, val_loss=1.99, val_accuracy=0.438, lr=0.1] 58%|█████▊    | 58/100 [23:26<16:39, 23.79s/epoch, loss=1.13, accuracy=0.754, val_loss=1.71, val_accuracy=0.549, lr=0.0316] 59%|█████▉    | 59/100 [23:49<16:11, 23.70s/epoch, loss=1.13, accuracy=0.752, val_loss=1.69, val_accuracy=0.548, lr=0.1]    60%|██████    | 60/100 [24:13<15:45, 23.65s/epoch, loss=1.13, accuracy=0.753, val_loss=4.27, val_accuracy=0.299, lr=0.1] 61%|██████    | 61/100 [24:37<15:25, 23.72s/epoch, loss=1.13, accuracy=0.752, val_loss=1.6, val_accuracy=0.593, lr=0.1]  62%|██████▏   | 62/100 [25:00<14:58, 23.63s/epoch, loss=1.13, accuracy=0.752, val_loss=3.38, val_accuracy=0.392, lr=0.1] 63%|██████▎   | 63/100 [25:24<14:38, 23.73s/epoch, loss=1.13, accuracy=0.753, val_loss=2.73, val_accuracy=0.405, lr=0.0316] 64%|██████▍   | 64/100 [25:48<14:12, 23.67s/epoch, loss=1.13, accuracy=0.754, val_loss=1.56, val_accuracy=0.626, lr=0.1]    65%|██████▌   | 65/100 [26:11<13:47, 23.64s/epoch, loss=1.12, accuracy=0.755, val_loss=2.12, val_accuracy=0.55, lr=0.1]  66%|██████▌   | 66/100 [26:35<13:24, 23.67s/epoch, loss=1.13, accuracy=0.755, val_loss=2.26, val_accuracy=0.452, lr=0.1] 67%|██████▋   | 67/100 [26:59<12:58, 23.60s/epoch, loss=1.13, accuracy=0.751, val_loss=2.69, val_accuracy=0.398, lr=0.1] 68%|██████▊   | 68/100 [27:22<12:36, 23.65s/epoch, loss=1.14, accuracy=0.752, val_loss=1.8, val_accuracy=0.575, lr=0.0316] 69%|██████▉   | 69/100 [27:46<12:13, 23.66s/epoch, loss=1.13, accuracy=0.754, val_loss=2.07, val_accuracy=0.475, lr=0.1]   70%|███████   | 70/100 [28:10<11:52, 23.74s/epoch, loss=1.12, accuracy=0.755, val_loss=2.19, val_accuracy=0.471, lr=0.1] 71%|███████   | 71/100 [28:34<11:27, 23.71s/epoch, loss=1.13, accuracy=0.753, val_loss=1.51, val_accuracy=0.612, lr=0.1] 72%|███████▏  | 72/100 [28:57<11:03, 23.70s/epoch, loss=1.13, accuracy=0.754, val_loss=1.8, val_accuracy=0.585, lr=0.1]  73%|███████▎  | 73/100 [29:21<10:38, 23.66s/epoch, loss=1.12, accuracy=0.754, val_loss=2.09, val_accuracy=0.531, lr=0.0316] 74%|███████▍  | 74/100 [29:44<10:11, 23.51s/epoch, loss=1.13, accuracy=0.753, val_loss=2.73, val_accuracy=0.332, lr=0.1]    75%|███████▌  | 75/100 [30:07<09:46, 23.48s/epoch, loss=1.12, accuracy=0.754, val_loss=2.31, val_accuracy=0.393, lr=0.1] 76%|███████▌  | 76/100 [30:31<09:25, 23.56s/epoch, loss=1.12, accuracy=0.755, val_loss=3.99, val_accuracy=0.378, lr=0.1] 77%|███████▋  | 77/100 [30:55<09:02, 23.60s/epoch, loss=1.12, accuracy=0.754, val_loss=2.27, val_accuracy=0.482, lr=0.1] 78%|███████▊  | 78/100 [31:18<08:39, 23.62s/epoch, loss=1.13, accuracy=0.754, val_loss=1.92, val_accuracy=0.524, lr=0.0316] 79%|███████▉  | 79/100 [31:42<08:14, 23.53s/epoch, loss=1.12, accuracy=0.754, val_loss=1.53, val_accuracy=0.634, lr=0.1]    80%|████████  | 80/100 [32:05<07:51, 23.58s/epoch, loss=1.13, accuracy=0.752, val_loss=2.22, val_accuracy=0.487, lr=0.1] 81%|████████  | 81/100 [32:29<07:29, 23.63s/epoch, loss=1.12, accuracy=0.755, val_loss=1.63, val_accuracy=0.592, lr=0.1] 82%|████████▏ | 82/100 [32:53<07:04, 23.58s/epoch, loss=0.903, accuracy=0.815, val_loss=0.876, val_accuracy=0.812, lr=0.01] 83%|████████▎ | 83/100 [33:16<06:41, 23.64s/epoch, loss=0.739, accuracy=0.842, val_loss=0.849, val_accuracy=0.798, lr=0.01] 84%|████████▍ | 84/100 [33:40<06:17, 23.60s/epoch, loss=0.657, accuracy=0.853, val_loss=0.87, val_accuracy=0.768, lr=0.01]  85%|████████▌ | 85/100 [34:03<05:53, 23.55s/epoch, loss=0.617, accuracy=0.855, val_loss=0.753, val_accuracy=0.805, lr=0.01] 86%|████████▌ | 86/100 [34:27<05:30, 23.59s/epoch, loss=0.597, accuracy=0.854, val_loss=0.834, val_accuracy=0.774, lr=0.01] 87%|████████▋ | 87/100 [34:51<05:07, 23.64s/epoch, loss=0.585, accuracy=0.857, val_loss=0.797, val_accuracy=0.785, lr=0.01] 88%|████████▊ | 88/100 [35:14<04:42, 23.53s/epoch, loss=0.583, accuracy=0.857, val_loss=0.858, val_accuracy=0.778, lr=0.01] 89%|████████▉ | 89/100 [35:38<04:18, 23.50s/epoch, loss=0.582, accuracy=0.858, val_loss=1, val_accuracy=0.743, lr=0.01]     90%|█████████ | 90/100 [36:01<03:54, 23.50s/epoch, loss=0.574, accuracy=0.863, val_loss=0.761, val_accuracy=0.794, lr=0.00316] 91%|█████████ | 91/100 [36:24<03:31, 23.47s/epoch, loss=0.568, accuracy=0.863, val_loss=1.36, val_accuracy=0.657, lr=0.01]     92%|█████████▏| 92/100 [36:48<03:07, 23.50s/epoch, loss=0.574, accuracy=0.862, val_loss=0.734, val_accuracy=0.815, lr=0.01] 93%|█████████▎| 93/100 [37:11<02:43, 23.34s/epoch, loss=0.568, accuracy=0.865, val_loss=1.16, val_accuracy=0.703, lr=0.01]  94%|█████████▍| 94/100 [37:34<02:19, 23.32s/epoch, loss=0.566, accuracy=0.866, val_loss=0.874, val_accuracy=0.773, lr=0.01] 95%|█████████▌| 95/100 [37:57<01:56, 23.28s/epoch, loss=0.565, accuracy=0.869, val_loss=0.706, val_accuracy=0.823, lr=0.01] 96%|█████████▌| 96/100 [38:21<01:33, 23.28s/epoch, loss=0.571, accuracy=0.868, val_loss=0.874, val_accuracy=0.774, lr=0.01] 97%|█████████▋| 97/100 [38:44<01:09, 23.23s/epoch, loss=0.563, accuracy=0.87, val_loss=1.1, val_accuracy=0.732, lr=0.01]    98%|█████████▊| 98/100 [39:07<00:46, 23.35s/epoch, loss=0.566, accuracy=0.869, val_loss=1.79, val_accuracy=0.611, lr=0.01] 99%|█████████▉| 99/100 [39:31<00:23, 23.26s/epoch, loss=0.565, accuracy=0.872, val_loss=1.08, val_accuracy=0.709, lr=0.01]100%|██████████| 100/100 [39:54<00:00, 23.27s/epoch, loss=0.566, accuracy=0.872, val_loss=1.16, val_accuracy=0.71, lr=0.00316]100%|██████████| 100/100 [39:54<00:00, 23.94s/epoch, loss=0.566, accuracy=0.872, val_loss=1.16, val_accuracy=0.71, lr=0.00316]
Using real-time data augmentation.
Test loss: 1.1571063995361328
Test accuracy: 0.7103999853134155


* * * Run SGD for ID = 15_7. * * *


2024-02-15 17:17:53.629623: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 17:17:56.391927: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 17:17:56.393159: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-15 17:17:56.432867: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 17:17:56.432906: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 17:17:56.435832: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 17:17:56.435878: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 17:17:56.438260: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 17:17:56.438930: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 17:17:56.441389: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 17:17:56.442901: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 17:17:56.447781: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 17:17:56.448357: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 17:17:56.448436: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 17:17:57.847367: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-15 17:17:57.848561: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 17:17:57.849963: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 17:17:57.850020: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 17:17:57.850142: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 17:17:57.850175: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 17:17:57.850210: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 17:17:57.850263: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 17:17:57.850293: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 17:17:57.850323: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 17:17:57.850354: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 17:17:57.850900: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 17:17:57.850938: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 17:17:58.581779: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-15 17:17:58.581846: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-15 17:17:58.581861: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-15 17:17:58.582877: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:02:00.0, compute capability: 6.1)
{'id': 157, 'batch_size': 128, 'epochs': 100, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/100 [00:00<?, ?epoch/s]2024-02-15 17:17:59.460484: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-15 17:17:59.472819: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199950000 Hz
2024-02-15 17:18:01.758849: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 17:18:02.040766: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 17:18:02.962974: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-15 17:18:03.033249: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/100 [01:06<1:49:33, 66.40s/epoch, loss=4.35, accuracy=0.298, val_loss=2.83, val_accuracy=0.171, lr=0.1]  2%|▏         | 2/100 [01:30<1:07:51, 41.54s/epoch, loss=1.71, accuracy=0.48, val_loss=2.34, val_accuracy=0.371, lr=0.1]   3%|▎         | 3/100 [01:54<54:11, 33.53s/epoch, loss=1.49, accuracy=0.57, val_loss=2.02, val_accuracy=0.398, lr=0.1]    4%|▍         | 4/100 [02:18<47:37, 29.77s/epoch, loss=1.43, accuracy=0.615, val_loss=2.02, val_accuracy=0.478, lr=0.1]  5%|▌         | 5/100 [02:42<43:53, 27.72s/epoch, loss=1.38, accuracy=0.649, val_loss=1.47, val_accuracy=0.621, lr=0.1]  6%|▌         | 6/100 [03:06<41:26, 26.45s/epoch, loss=1.35, accuracy=0.667, val_loss=1.76, val_accuracy=0.554, lr=0.1]  7%|▋         | 7/100 [03:30<39:39, 25.59s/epoch, loss=1.33, accuracy=0.681, val_loss=3.27, val_accuracy=0.372, lr=0.1]  8%|▊         | 8/100 [03:54<38:23, 25.04s/epoch, loss=1.3, accuracy=0.693, val_loss=1.92, val_accuracy=0.538, lr=0.1]   9%|▉         | 9/100 [04:17<37:20, 24.62s/epoch, loss=1.29, accuracy=0.701, val_loss=1.74, val_accuracy=0.559, lr=0.1] 10%|█         | 10/100 [04:42<36:42, 24.47s/epoch, loss=1.28, accuracy=0.709, val_loss=1.7, val_accuracy=0.575, lr=0.0316] 11%|█         | 11/100 [05:06<36:09, 24.38s/epoch, loss=1.26, accuracy=0.712, val_loss=1.74, val_accuracy=0.571, lr=0.1]   12%|█▏        | 12/100 [05:30<35:31, 24.23s/epoch, loss=1.26, accuracy=0.715, val_loss=1.57, val_accuracy=0.608, lr=0.1] 13%|█▎        | 13/100 [05:54<34:58, 24.12s/epoch, loss=1.26, accuracy=0.716, val_loss=2.19, val_accuracy=0.532, lr=0.1] 14%|█▍        | 14/100 [06:18<34:33, 24.11s/epoch, loss=1.25, accuracy=0.721, val_loss=1.73, val_accuracy=0.561, lr=0.1] 15%|█▌        | 15/100 [06:42<34:08, 24.10s/epoch, loss=1.24, accuracy=0.723, val_loss=1.88, val_accuracy=0.537, lr=0.0316] 16%|█▌        | 16/100 [07:06<33:38, 24.03s/epoch, loss=1.24, accuracy=0.726, val_loss=1.54, val_accuracy=0.628, lr=0.1]    17%|█▋        | 17/100 [07:29<33:10, 23.98s/epoch, loss=1.24, accuracy=0.727, val_loss=1.82, val_accuracy=0.559, lr=0.1] 18%|█▊        | 18/100 [07:54<32:49, 24.02s/epoch, loss=1.23, accuracy=0.727, val_loss=1.78, val_accuracy=0.563, lr=0.1] 19%|█▉        | 19/100 [08:17<32:23, 24.00s/epoch, loss=1.24, accuracy=0.726, val_loss=1.84, val_accuracy=0.575, lr=0.1] 20%|██        | 20/100 [08:42<32:03, 24.04s/epoch, loss=1.23, accuracy=0.729, val_loss=1.83, val_accuracy=0.539, lr=0.0316] 21%|██        | 21/100 [09:06<31:40, 24.06s/epoch, loss=1.22, accuracy=0.731, val_loss=1.83, val_accuracy=0.564, lr=0.1]    22%|██▏       | 22/100 [09:30<31:13, 24.02s/epoch, loss=1.22, accuracy=0.733, val_loss=2.52, val_accuracy=0.394, lr=0.1] 23%|██▎       | 23/100 [09:54<30:46, 23.99s/epoch, loss=1.22, accuracy=0.732, val_loss=1.59, val_accuracy=0.604, lr=0.1] 24%|██▍       | 24/100 [10:18<30:33, 24.13s/epoch, loss=1.22, accuracy=0.734, val_loss=2.45, val_accuracy=0.338, lr=0.1] 25%|██▌       | 25/100 [10:42<30:07, 24.10s/epoch, loss=1.22, accuracy=0.736, val_loss=1.61, val_accuracy=0.619, lr=0.0316] 26%|██▌       | 26/100 [11:06<29:40, 24.06s/epoch, loss=1.21, accuracy=0.736, val_loss=1.89, val_accuracy=0.512, lr=0.1]    27%|██▋       | 27/100 [11:30<29:19, 24.11s/epoch, loss=1.21, accuracy=0.738, val_loss=1.99, val_accuracy=0.442, lr=0.1] 28%|██▊       | 28/100 [11:54<28:57, 24.13s/epoch, loss=1.21, accuracy=0.736, val_loss=1.67, val_accuracy=0.563, lr=0.1] 29%|██▉       | 29/100 [12:19<28:37, 24.19s/epoch, loss=1.2, accuracy=0.736, val_loss=1.72, val_accuracy=0.542, lr=0.1]  30%|███       | 30/100 [12:43<28:15, 24.22s/epoch, loss=1.2, accuracy=0.737, val_loss=2.15, val_accuracy=0.515, lr=0.0316] 31%|███       | 31/100 [13:07<27:45, 24.13s/epoch, loss=1.2, accuracy=0.738, val_loss=2.62, val_accuracy=0.36, lr=0.1]     32%|███▏      | 32/100 [13:31<27:24, 24.18s/epoch, loss=1.19, accuracy=0.738, val_loss=2.01, val_accuracy=0.543, lr=0.1] 33%|███▎      | 33/100 [13:55<26:58, 24.16s/epoch, loss=1.19, accuracy=0.741, val_loss=2.36, val_accuracy=0.443, lr=0.1] 34%|███▍      | 34/100 [14:19<26:31, 24.12s/epoch, loss=1.19, accuracy=0.74, val_loss=1.8, val_accuracy=0.545, lr=0.1]   35%|███▌      | 35/100 [14:44<26:12, 24.19s/epoch, loss=1.19, accuracy=0.74, val_loss=1.61, val_accuracy=0.6, lr=0.0316] 36%|███▌      | 36/100 [15:08<25:46, 24.17s/epoch, loss=1.19, accuracy=0.741, val_loss=1.91, val_accuracy=0.567, lr=0.1] 37%|███▋      | 37/100 [15:32<25:15, 24.05s/epoch, loss=1.18, accuracy=0.742, val_loss=1.59, val_accuracy=0.607, lr=0.1] 38%|███▊      | 38/100 [15:56<24:53, 24.09s/epoch, loss=1.19, accuracy=0.741, val_loss=1.88, val_accuracy=0.503, lr=0.1] 39%|███▉      | 39/100 [16:20<24:33, 24.15s/epoch, loss=1.19, accuracy=0.74, val_loss=1.42, val_accuracy=0.669, lr=0.1]  40%|████      | 40/100 [16:45<24:14, 24.24s/epoch, loss=1.18, accuracy=0.744, val_loss=1.86, val_accuracy=0.541, lr=0.1] 41%|████      | 41/100 [17:09<23:54, 24.31s/epoch, loss=1.18, accuracy=0.743, val_loss=1.91, val_accuracy=0.501, lr=0.1] 42%|████▏     | 42/100 [17:33<23:20, 24.15s/epoch, loss=1.18, accuracy=0.743, val_loss=2.45, val_accuracy=0.471, lr=0.1] 43%|████▎     | 43/100 [17:57<22:58, 24.18s/epoch, loss=1.19, accuracy=0.745, val_loss=1.87, val_accuracy=0.52, lr=0.1]  44%|████▍     | 44/100 [18:20<22:18, 23.90s/epoch, loss=1.18, accuracy=0.744, val_loss=1.62, val_accuracy=0.61, lr=0.0316] 45%|████▌     | 45/100 [18:44<21:54, 23.90s/epoch, loss=1.17, accuracy=0.745, val_loss=2.3, val_accuracy=0.449, lr=0.1]    46%|████▌     | 46/100 [19:08<21:30, 23.90s/epoch, loss=1.18, accuracy=0.743, val_loss=2.26, val_accuracy=0.466, lr=0.1] 47%|████▋     | 47/100 [19:32<21:09, 23.94s/epoch, loss=1.17, accuracy=0.745, val_loss=1.66, val_accuracy=0.587, lr=0.1] 48%|████▊     | 48/100 [19:57<20:51, 24.07s/epoch, loss=1.17, accuracy=0.746, val_loss=1.77, val_accuracy=0.549, lr=0.1] 49%|████▉     | 49/100 [20:20<20:25, 24.04s/epoch, loss=1.17, accuracy=0.747, val_loss=1.78, val_accuracy=0.559, lr=0.0316] 50%|█████     | 50/100 [20:44<20:00, 24.00s/epoch, loss=1.17, accuracy=0.747, val_loss=2.08, val_accuracy=0.543, lr=0.1]    51%|█████     | 51/100 [21:09<19:41, 24.11s/epoch, loss=1.17, accuracy=0.747, val_loss=1.54, val_accuracy=0.61, lr=0.1]  52%|█████▏    | 52/100 [21:33<19:15, 24.08s/epoch, loss=1.17, accuracy=0.747, val_loss=2.25, val_accuracy=0.412, lr=0.1] 53%|█████▎    | 53/100 [21:57<18:50, 24.05s/epoch, loss=1.17, accuracy=0.747, val_loss=1.76, val_accuracy=0.553, lr=0.1] 54%|█████▍    | 54/100 [22:21<18:27, 24.09s/epoch, loss=1.17, accuracy=0.748, val_loss=1.72, val_accuracy=0.585, lr=0.0316] 55%|█████▌    | 55/100 [22:45<18:07, 24.17s/epoch, loss=1.17, accuracy=0.746, val_loss=2.54, val_accuracy=0.391, lr=0.1]    56%|█████▌    | 56/100 [23:09<17:40, 24.11s/epoch, loss=1.17, accuracy=0.748, val_loss=1.89, val_accuracy=0.53, lr=0.1]  57%|█████▋    | 57/100 [23:33<17:16, 24.11s/epoch, loss=1.17, accuracy=0.745, val_loss=3.11, val_accuracy=0.356, lr=0.1] 58%|█████▊    | 58/100 [23:58<16:56, 24.21s/epoch, loss=1.17, accuracy=0.744, val_loss=1.61, val_accuracy=0.603, lr=0.1] 59%|█████▉    | 59/100 [24:22<16:28, 24.11s/epoch, loss=1.17, accuracy=0.747, val_loss=2.22, val_accuracy=0.414, lr=0.0316] 60%|██████    | 60/100 [24:45<15:59, 23.99s/epoch, loss=1.16, accuracy=0.748, val_loss=1.77, val_accuracy=0.544, lr=0.1]    61%|██████    | 61/100 [25:09<15:34, 23.95s/epoch, loss=1.17, accuracy=0.748, val_loss=1.56, val_accuracy=0.642, lr=0.1] 62%|██████▏   | 62/100 [25:33<15:07, 23.89s/epoch, loss=1.16, accuracy=0.748, val_loss=1.81, val_accuracy=0.591, lr=0.1] 63%|██████▎   | 63/100 [25:57<14:45, 23.95s/epoch, loss=1.16, accuracy=0.747, val_loss=2.22, val_accuracy=0.462, lr=0.1] 64%|██████▍   | 64/100 [26:21<14:22, 23.95s/epoch, loss=1.17, accuracy=0.747, val_loss=1.69, val_accuracy=0.608, lr=0.0316] 65%|██████▌   | 65/100 [26:45<13:59, 23.98s/epoch, loss=1.16, accuracy=0.746, val_loss=1.7, val_accuracy=0.576, lr=0.1]     66%|██████▌   | 66/100 [27:09<13:36, 24.02s/epoch, loss=1.16, accuracy=0.746, val_loss=1.99, val_accuracy=0.521, lr=0.1] 67%|██████▋   | 67/100 [27:33<13:12, 24.01s/epoch, loss=1.16, accuracy=0.747, val_loss=1.81, val_accuracy=0.572, lr=0.1] 68%|██████▊   | 68/100 [27:57<12:46, 23.96s/epoch, loss=1.15, accuracy=0.75, val_loss=1.91, val_accuracy=0.542, lr=0.1]  69%|██████▉   | 69/100 [28:21<12:22, 23.94s/epoch, loss=1.16, accuracy=0.749, val_loss=2, val_accuracy=0.481, lr=0.0316] 70%|███████   | 70/100 [28:45<11:55, 23.84s/epoch, loss=1.16, accuracy=0.748, val_loss=2.25, val_accuracy=0.456, lr=0.1] 71%|███████   | 71/100 [29:08<11:29, 23.78s/epoch, loss=1.16, accuracy=0.751, val_loss=1.9, val_accuracy=0.478, lr=0.1]  72%|███████▏  | 72/100 [29:32<11:05, 23.77s/epoch, loss=1.16, accuracy=0.75, val_loss=1.69, val_accuracy=0.566, lr=0.1] 73%|███████▎  | 73/100 [29:56<10:41, 23.77s/epoch, loss=1.16, accuracy=0.749, val_loss=1.73, val_accuracy=0.564, lr=0.1] 74%|███████▍  | 74/100 [30:19<10:18, 23.78s/epoch, loss=1.16, accuracy=0.747, val_loss=2.59, val_accuracy=0.457, lr=0.0316] 75%|███████▌  | 75/100 [30:43<09:54, 23.79s/epoch, loss=1.15, accuracy=0.752, val_loss=2.22, val_accuracy=0.432, lr=0.1]    76%|███████▌  | 76/100 [31:07<09:31, 23.81s/epoch, loss=1.16, accuracy=0.748, val_loss=2.28, val_accuracy=0.508, lr=0.1] 77%|███████▋  | 77/100 [31:31<09:07, 23.80s/epoch, loss=1.15, accuracy=0.751, val_loss=2.06, val_accuracy=0.509, lr=0.1] 78%|███████▊  | 78/100 [31:55<08:42, 23.77s/epoch, loss=1.16, accuracy=0.75, val_loss=2.64, val_accuracy=0.418, lr=0.1]  79%|███████▉  | 79/100 [32:18<08:17, 23.70s/epoch, loss=1.15, accuracy=0.75, val_loss=1.65, val_accuracy=0.585, lr=0.0316] 80%|████████  | 80/100 [32:42<07:52, 23.62s/epoch, loss=1.15, accuracy=0.751, val_loss=2.32, val_accuracy=0.436, lr=0.1]   81%|████████  | 81/100 [33:05<07:29, 23.68s/epoch, loss=1.15, accuracy=0.749, val_loss=3.44, val_accuracy=0.405, lr=0.1] 82%|████████▏ | 82/100 [33:29<07:06, 23.67s/epoch, loss=0.949, accuracy=0.807, val_loss=0.926, val_accuracy=0.803, lr=0.01] 83%|████████▎ | 83/100 [33:53<06:41, 23.61s/epoch, loss=0.759, accuracy=0.842, val_loss=0.814, val_accuracy=0.806, lr=0.01] 84%|████████▍ | 84/100 [34:16<06:16, 23.50s/epoch, loss=0.673, accuracy=0.853, val_loss=0.796, val_accuracy=0.797, lr=0.01] 85%|████████▌ | 85/100 [34:40<05:54, 23.64s/epoch, loss=0.628, accuracy=0.855, val_loss=0.735, val_accuracy=0.816, lr=0.01] 86%|████████▌ | 86/100 [35:03<05:29, 23.56s/epoch, loss=0.603, accuracy=0.857, val_loss=0.937, val_accuracy=0.752, lr=0.01] 87%|████████▋ | 87/100 [35:27<05:06, 23.60s/epoch, loss=0.594, accuracy=0.858, val_loss=0.743, val_accuracy=0.807, lr=0.01] 88%|████████▊ | 88/100 [35:51<04:44, 23.68s/epoch, loss=0.582, accuracy=0.861, val_loss=0.805, val_accuracy=0.802, lr=0.01] 89%|████████▉ | 89/100 [36:14<04:20, 23.67s/epoch, loss=0.584, accuracy=0.862, val_loss=0.891, val_accuracy=0.77, lr=0.01]  90%|█████████ | 90/100 [36:38<03:57, 23.75s/epoch, loss=0.582, accuracy=0.863, val_loss=0.734, val_accuracy=0.81, lr=0.01] 91%|█████████ | 91/100 [37:02<03:34, 23.87s/epoch, loss=0.583, accuracy=0.863, val_loss=0.704, val_accuracy=0.823, lr=0.01] 92%|█████████▏| 92/100 [37:26<03:10, 23.78s/epoch, loss=0.577, accuracy=0.865, val_loss=0.953, val_accuracy=0.756, lr=0.01] 93%|█████████▎| 93/100 [37:50<02:46, 23.75s/epoch, loss=0.574, accuracy=0.868, val_loss=0.784, val_accuracy=0.808, lr=0.01] 94%|█████████▍| 94/100 [38:13<02:22, 23.77s/epoch, loss=0.578, accuracy=0.868, val_loss=0.772, val_accuracy=0.805, lr=0.01] 95%|█████████▌| 95/100 [38:37<01:58, 23.74s/epoch, loss=0.576, accuracy=0.87, val_loss=0.722, val_accuracy=0.822, lr=0.01]  96%|█████████▌| 96/100 [39:01<01:34, 23.67s/epoch, loss=0.575, accuracy=0.87, val_loss=0.843, val_accuracy=0.785, lr=0.00316] 97%|█████████▋| 97/100 [39:24<01:11, 23.68s/epoch, loss=0.57, accuracy=0.871, val_loss=0.824, val_accuracy=0.785, lr=0.01]    98%|█████████▊| 98/100 [39:48<00:47, 23.60s/epoch, loss=0.572, accuracy=0.872, val_loss=0.77, val_accuracy=0.807, lr=0.01] 99%|█████████▉| 99/100 [40:12<00:23, 23.78s/epoch, loss=0.574, accuracy=0.873, val_loss=0.824, val_accuracy=0.796, lr=0.01]100%|██████████| 100/100 [40:36<00:00, 23.81s/epoch, loss=0.572, accuracy=0.874, val_loss=0.759, val_accuracy=0.811, lr=0.01]100%|██████████| 100/100 [40:36<00:00, 24.36s/epoch, loss=0.572, accuracy=0.874, val_loss=0.759, val_accuracy=0.811, lr=0.01]
Using real-time data augmentation.
Test loss: 0.7587060332298279
Test accuracy: 0.8112000226974487


* * * Run SGD for ID = 15_8. * * *


2024-02-15 17:58:38.282660: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 17:58:41.041401: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 17:58:41.042478: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-15 17:58:41.081060: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 17:58:41.081106: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 17:58:41.083902: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 17:58:41.083946: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 17:58:41.086116: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 17:58:41.086899: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 17:58:41.089203: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 17:58:41.093636: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 17:58:41.098667: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 17:58:41.099290: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 17:58:41.099543: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 17:58:42.378723: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-15 17:58:42.379230: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 17:58:42.379719: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 17:58:42.379753: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 17:58:42.379786: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 17:58:42.379805: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 17:58:42.379823: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 17:58:42.379840: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 17:58:42.379857: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 17:58:42.379875: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 17:58:42.379892: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 17:58:42.380342: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 17:58:42.380374: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 17:58:43.009855: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-15 17:58:43.009904: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-15 17:58:43.009914: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-15 17:58:43.010819: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:02:00.0, compute capability: 6.1)
{'id': 158, 'batch_size': 128, 'epochs': 100, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/100 [00:00<?, ?epoch/s]2024-02-15 17:58:43.785790: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-15 17:58:43.797829: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199950000 Hz
2024-02-15 17:58:45.717823: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 17:58:45.975385: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 17:58:46.701052: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-15 17:58:46.746734: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/100 [01:00<1:39:38, 60.39s/epoch, loss=3.28, accuracy=0.291, val_loss=2.26, val_accuracy=0.259, lr=0.1]  2%|▏         | 2/100 [01:24<1:03:31, 38.90s/epoch, loss=1.62, accuracy=0.499, val_loss=1.78, val_accuracy=0.474, lr=0.1]  3%|▎         | 3/100 [01:47<51:34, 31.90s/epoch, loss=1.39, accuracy=0.611, val_loss=3.73, val_accuracy=0.273, lr=0.1]    4%|▍         | 4/100 [02:11<45:46, 28.61s/epoch, loss=1.29, accuracy=0.674, val_loss=1.92, val_accuracy=0.47, lr=0.1]   5%|▌         | 5/100 [02:35<42:27, 26.81s/epoch, loss=1.26, accuracy=0.694, val_loss=1.97, val_accuracy=0.486, lr=0.1]  6%|▌         | 6/100 [02:58<40:25, 25.81s/epoch, loss=1.25, accuracy=0.707, val_loss=1.95, val_accuracy=0.481, lr=0.1]  7%|▋         | 7/100 [03:22<38:53, 25.09s/epoch, loss=1.23, accuracy=0.716, val_loss=1.94, val_accuracy=0.539, lr=0.0316]  8%|▊         | 8/100 [03:46<37:54, 24.72s/epoch, loss=1.23, accuracy=0.72, val_loss=1.62, val_accuracy=0.576, lr=0.1]      9%|▉         | 9/100 [04:10<37:00, 24.40s/epoch, loss=1.22, accuracy=0.724, val_loss=3.08, val_accuracy=0.378, lr=0.1] 10%|█         | 10/100 [04:33<36:11, 24.13s/epoch, loss=1.21, accuracy=0.728, val_loss=1.59, val_accuracy=0.581, lr=0.1] 11%|█         | 11/100 [04:56<35:26, 23.90s/epoch, loss=1.2, accuracy=0.729, val_loss=1.92, val_accuracy=0.542, lr=0.1]  12%|█▏        | 12/100 [05:20<34:46, 23.71s/epoch, loss=1.19, accuracy=0.734, val_loss=1.99, val_accuracy=0.46, lr=0.1] 13%|█▎        | 13/100 [05:43<34:15, 23.62s/epoch, loss=1.2, accuracy=0.733, val_loss=1.71, val_accuracy=0.615, lr=0.1] 14%|█▍        | 14/100 [06:07<33:56, 23.68s/epoch, loss=1.2, accuracy=0.737, val_loss=1.47, val_accuracy=0.632, lr=0.1] 15%|█▌        | 15/100 [06:31<33:35, 23.71s/epoch, loss=1.19, accuracy=0.738, val_loss=1.59, val_accuracy=0.622, lr=0.1] 16%|█▌        | 16/100 [06:55<33:13, 23.73s/epoch, loss=1.18, accuracy=0.741, val_loss=1.62, val_accuracy=0.594, lr=0.1] 17%|█▋        | 17/100 [07:18<32:53, 23.77s/epoch, loss=1.19, accuracy=0.738, val_loss=2.44, val_accuracy=0.474, lr=0.1] 18%|█▊        | 18/100 [07:42<32:26, 23.73s/epoch, loss=1.18, accuracy=0.743, val_loss=2.25, val_accuracy=0.459, lr=0.1] 19%|█▉        | 19/100 [08:06<32:01, 23.72s/epoch, loss=1.18, accuracy=0.743, val_loss=2.68, val_accuracy=0.394, lr=0.0316] 20%|██        | 20/100 [08:29<31:34, 23.69s/epoch, loss=1.18, accuracy=0.742, val_loss=1.65, val_accuracy=0.567, lr=0.1]    21%|██        | 21/100 [08:53<31:07, 23.64s/epoch, loss=1.18, accuracy=0.743, val_loss=2.21, val_accuracy=0.436, lr=0.1] 22%|██▏       | 22/100 [09:17<30:44, 23.64s/epoch, loss=1.18, accuracy=0.743, val_loss=1.93, val_accuracy=0.543, lr=0.1] 23%|██▎       | 23/100 [09:40<30:21, 23.65s/epoch, loss=1.17, accuracy=0.745, val_loss=2.31, val_accuracy=0.464, lr=0.1] 24%|██▍       | 24/100 [10:04<29:54, 23.61s/epoch, loss=1.17, accuracy=0.744, val_loss=1.63, val_accuracy=0.59, lr=0.0316] 25%|██▌       | 25/100 [10:27<29:23, 23.51s/epoch, loss=1.17, accuracy=0.747, val_loss=4.34, val_accuracy=0.235, lr=0.1]   26%|██▌       | 26/100 [10:51<29:11, 23.67s/epoch, loss=1.17, accuracy=0.747, val_loss=2.34, val_accuracy=0.432, lr=0.1] 27%|██▋       | 27/100 [11:15<28:53, 23.75s/epoch, loss=1.17, accuracy=0.747, val_loss=1.83, val_accuracy=0.548, lr=0.1] 28%|██▊       | 28/100 [11:39<28:36, 23.84s/epoch, loss=1.17, accuracy=0.748, val_loss=1.47, val_accuracy=0.644, lr=0.1] 29%|██▉       | 29/100 [12:03<28:16, 23.90s/epoch, loss=1.17, accuracy=0.748, val_loss=2.59, val_accuracy=0.417, lr=0.0316] 30%|███       | 30/100 [12:27<27:47, 23.82s/epoch, loss=1.17, accuracy=0.748, val_loss=1.39, val_accuracy=0.675, lr=0.1]    31%|███       | 31/100 [12:50<27:22, 23.80s/epoch, loss=1.17, accuracy=0.751, val_loss=1.81, val_accuracy=0.531, lr=0.1] 32%|███▏      | 32/100 [13:14<26:56, 23.78s/epoch, loss=1.17, accuracy=0.749, val_loss=1.75, val_accuracy=0.565, lr=0.1] 33%|███▎      | 33/100 [13:38<26:34, 23.80s/epoch, loss=1.16, accuracy=0.748, val_loss=1.45, val_accuracy=0.651, lr=0.1] 34%|███▍      | 34/100 [14:02<26:12, 23.83s/epoch, loss=1.16, accuracy=0.749, val_loss=1.66, val_accuracy=0.581, lr=0.1] 35%|███▌      | 35/100 [14:26<25:49, 23.83s/epoch, loss=1.16, accuracy=0.748, val_loss=2.85, val_accuracy=0.417, lr=0.0316] 36%|███▌      | 36/100 [14:50<25:23, 23.80s/epoch, loss=1.16, accuracy=0.749, val_loss=1.67, val_accuracy=0.589, lr=0.1]    37%|███▋      | 37/100 [15:13<25:00, 23.82s/epoch, loss=1.15, accuracy=0.751, val_loss=1.75, val_accuracy=0.567, lr=0.1] 38%|███▊      | 38/100 [15:37<24:40, 23.88s/epoch, loss=1.16, accuracy=0.751, val_loss=1.37, val_accuracy=0.68, lr=0.1]  39%|███▉      | 39/100 [16:01<24:17, 23.90s/epoch, loss=1.15, accuracy=0.752, val_loss=2.41, val_accuracy=0.486, lr=0.1] 40%|████      | 40/100 [16:25<23:50, 23.84s/epoch, loss=1.16, accuracy=0.751, val_loss=1.63, val_accuracy=0.58, lr=0.1]  41%|████      | 41/100 [16:49<23:30, 23.91s/epoch, loss=1.16, accuracy=0.751, val_loss=1.44, val_accuracy=0.645, lr=0.1] 42%|████▏     | 42/100 [17:13<23:07, 23.92s/epoch, loss=1.16, accuracy=0.75, val_loss=2.04, val_accuracy=0.42, lr=0.1]   43%|████▎     | 43/100 [17:37<22:44, 23.93s/epoch, loss=1.16, accuracy=0.748, val_loss=1.51, val_accuracy=0.645, lr=0.0316] 44%|████▍     | 44/100 [18:01<22:16, 23.87s/epoch, loss=1.16, accuracy=0.751, val_loss=2.53, val_accuracy=0.446, lr=0.1]    45%|████▌     | 45/100 [18:25<21:52, 23.87s/epoch, loss=1.16, accuracy=0.749, val_loss=2.6, val_accuracy=0.464, lr=0.1]  46%|████▌     | 46/100 [18:48<21:25, 23.80s/epoch, loss=1.16, accuracy=0.752, val_loss=2.36, val_accuracy=0.415, lr=0.1] 47%|████▋     | 47/100 [19:12<20:56, 23.71s/epoch, loss=1.15, accuracy=0.753, val_loss=1.55, val_accuracy=0.633, lr=0.1] 48%|████▊     | 48/100 [19:35<20:33, 23.72s/epoch, loss=1.15, accuracy=0.751, val_loss=1.93, val_accuracy=0.515, lr=0.0316] 49%|████▉     | 49/100 [20:00<20:15, 23.83s/epoch, loss=1.16, accuracy=0.749, val_loss=1.59, val_accuracy=0.62, lr=0.1]     50%|█████     | 50/100 [20:24<19:55, 23.91s/epoch, loss=1.16, accuracy=0.751, val_loss=2.08, val_accuracy=0.437, lr=0.1] 51%|█████     | 51/100 [20:48<19:31, 23.90s/epoch, loss=1.16, accuracy=0.751, val_loss=1.66, val_accuracy=0.582, lr=0.1] 52%|█████▏    | 52/100 [21:11<19:04, 23.84s/epoch, loss=1.15, accuracy=0.754, val_loss=1.98, val_accuracy=0.553, lr=0.1] 53%|█████▎    | 53/100 [21:35<18:42, 23.88s/epoch, loss=1.15, accuracy=0.753, val_loss=2.22, val_accuracy=0.442, lr=0.0316] 54%|█████▍    | 54/100 [21:59<18:21, 23.94s/epoch, loss=1.15, accuracy=0.754, val_loss=1.95, val_accuracy=0.503, lr=0.1]    55%|█████▌    | 55/100 [22:23<17:54, 23.88s/epoch, loss=1.14, accuracy=0.753, val_loss=1.67, val_accuracy=0.597, lr=0.1] 56%|█████▌    | 56/100 [22:47<17:28, 23.84s/epoch, loss=1.14, accuracy=0.752, val_loss=1.54, val_accuracy=0.608, lr=0.1] 57%|█████▋    | 57/100 [23:10<17:00, 23.72s/epoch, loss=1.15, accuracy=0.757, val_loss=1.64, val_accuracy=0.566, lr=0.1] 58%|█████▊    | 58/100 [23:34<16:32, 23.64s/epoch, loss=1.14, accuracy=0.751, val_loss=1.6, val_accuracy=0.61, lr=0.0316] 59%|█████▉    | 59/100 [23:58<16:12, 23.71s/epoch, loss=1.14, accuracy=0.752, val_loss=2.04, val_accuracy=0.5, lr=0.1]    60%|██████    | 60/100 [24:21<15:44, 23.60s/epoch, loss=1.14, accuracy=0.754, val_loss=1.48, val_accuracy=0.632, lr=0.1] 61%|██████    | 61/100 [24:45<15:25, 23.74s/epoch, loss=1.15, accuracy=0.752, val_loss=1.34, val_accuracy=0.681, lr=0.1] 62%|██████▏   | 62/100 [25:09<15:01, 23.73s/epoch, loss=1.14, accuracy=0.753, val_loss=1.44, val_accuracy=0.64, lr=0.1]  63%|██████▎   | 63/100 [25:33<14:38, 23.75s/epoch, loss=1.14, accuracy=0.754, val_loss=1.72, val_accuracy=0.53, lr=0.1] 64%|██████▍   | 64/100 [25:56<14:17, 23.82s/epoch, loss=1.15, accuracy=0.75, val_loss=1.31, val_accuracy=0.69, lr=0.1]  65%|██████▌   | 65/100 [26:20<13:50, 23.72s/epoch, loss=1.14, accuracy=0.753, val_loss=1.59, val_accuracy=0.605, lr=0.1] 66%|██████▌   | 66/100 [26:43<13:23, 23.64s/epoch, loss=1.14, accuracy=0.753, val_loss=1.58, val_accuracy=0.604, lr=0.1] 67%|██████▋   | 67/100 [27:07<13:00, 23.64s/epoch, loss=1.14, accuracy=0.755, val_loss=1.72, val_accuracy=0.548, lr=0.1] 68%|██████▊   | 68/100 [27:30<12:29, 23.43s/epoch, loss=1.14, accuracy=0.754, val_loss=1.89, val_accuracy=0.544, lr=0.1] 69%|██████▉   | 69/100 [27:53<12:05, 23.41s/epoch, loss=1.14, accuracy=0.754, val_loss=1.4, val_accuracy=0.662, lr=0.0316] 70%|███████   | 70/100 [28:17<11:42, 23.41s/epoch, loss=1.14, accuracy=0.752, val_loss=1.54, val_accuracy=0.615, lr=0.1]   71%|███████   | 71/100 [28:40<11:19, 23.42s/epoch, loss=1.15, accuracy=0.753, val_loss=2.46, val_accuracy=0.493, lr=0.1] 72%|███████▏  | 72/100 [29:04<10:58, 23.51s/epoch, loss=1.13, accuracy=0.752, val_loss=3.05, val_accuracy=0.403, lr=0.1] 73%|███████▎  | 73/100 [29:27<10:31, 23.39s/epoch, loss=1.14, accuracy=0.753, val_loss=2.66, val_accuracy=0.396, lr=0.1] 74%|███████▍  | 74/100 [29:51<10:09, 23.44s/epoch, loss=1.14, accuracy=0.754, val_loss=1.96, val_accuracy=0.569, lr=0.0316] 75%|███████▌  | 75/100 [30:14<09:44, 23.39s/epoch, loss=1.14, accuracy=0.755, val_loss=2.12, val_accuracy=0.49, lr=0.1]     76%|███████▌  | 76/100 [30:37<09:21, 23.38s/epoch, loss=1.15, accuracy=0.753, val_loss=1.87, val_accuracy=0.471, lr=0.1] 77%|███████▋  | 77/100 [31:01<08:58, 23.42s/epoch, loss=1.13, accuracy=0.755, val_loss=3.73, val_accuracy=0.324, lr=0.1] 78%|███████▊  | 78/100 [31:25<08:37, 23.52s/epoch, loss=1.14, accuracy=0.753, val_loss=2.12, val_accuracy=0.488, lr=0.1] 79%|███████▉  | 79/100 [31:48<08:15, 23.60s/epoch, loss=1.13, accuracy=0.756, val_loss=2.12, val_accuracy=0.498, lr=0.0316] 80%|████████  | 80/100 [32:11<07:49, 23.46s/epoch, loss=1.14, accuracy=0.756, val_loss=1.71, val_accuracy=0.581, lr=0.1]    81%|████████  | 81/100 [32:35<07:25, 23.43s/epoch, loss=1.14, accuracy=0.753, val_loss=1.54, val_accuracy=0.632, lr=0.1] 82%|████████▏ | 82/100 [32:58<07:02, 23.49s/epoch, loss=0.934, accuracy=0.812, val_loss=0.909, val_accuracy=0.804, lr=0.01] 83%|████████▎ | 83/100 [33:22<06:41, 23.59s/epoch, loss=0.75, accuracy=0.843, val_loss=0.812, val_accuracy=0.81, lr=0.01]   84%|████████▍ | 84/100 [33:46<06:18, 23.67s/epoch, loss=0.663, accuracy=0.854, val_loss=0.825, val_accuracy=0.79, lr=0.01] 85%|████████▌ | 85/100 [34:09<05:53, 23.56s/epoch, loss=0.618, accuracy=0.857, val_loss=0.712, val_accuracy=0.821, lr=0.01] 86%|████████▌ | 86/100 [34:33<05:28, 23.45s/epoch, loss=0.593, accuracy=0.86, val_loss=0.801, val_accuracy=0.787, lr=0.01]  87%|████████▋ | 87/100 [34:56<05:04, 23.45s/epoch, loss=0.583, accuracy=0.861, val_loss=0.768, val_accuracy=0.805, lr=0.01] 88%|████████▊ | 88/100 [35:20<04:42, 23.53s/epoch, loss=0.576, accuracy=0.862, val_loss=0.841, val_accuracy=0.783, lr=0.01] 89%|████████▉ | 89/100 [35:43<04:17, 23.45s/epoch, loss=0.571, accuracy=0.864, val_loss=0.87, val_accuracy=0.778, lr=0.01]  90%|█████████ | 90/100 [36:06<03:54, 23.43s/epoch, loss=0.566, accuracy=0.866, val_loss=0.731, val_accuracy=0.811, lr=0.00316] 91%|█████████ | 91/100 [36:30<03:32, 23.56s/epoch, loss=0.565, accuracy=0.867, val_loss=0.782, val_accuracy=0.797, lr=0.01]    92%|█████████▏| 92/100 [36:54<03:08, 23.60s/epoch, loss=0.567, accuracy=0.867, val_loss=0.871, val_accuracy=0.777, lr=0.01] 93%|█████████▎| 93/100 [37:17<02:44, 23.57s/epoch, loss=0.57, accuracy=0.867, val_loss=0.696, val_accuracy=0.826, lr=0.01]  94%|█████████▍| 94/100 [37:41<02:20, 23.47s/epoch, loss=0.568, accuracy=0.87, val_loss=0.947, val_accuracy=0.749, lr=0.01] 95%|█████████▌| 95/100 [38:04<01:56, 23.39s/epoch, loss=0.561, accuracy=0.873, val_loss=0.776, val_accuracy=0.812, lr=0.01] 96%|█████████▌| 96/100 [38:27<01:33, 23.32s/epoch, loss=0.569, accuracy=0.87, val_loss=0.871, val_accuracy=0.779, lr=0.01]  97%|█████████▋| 97/100 [38:51<01:10, 23.36s/epoch, loss=0.566, accuracy=0.874, val_loss=0.849, val_accuracy=0.777, lr=0.01] 98%|█████████▊| 98/100 [39:14<00:46, 23.34s/epoch, loss=0.567, accuracy=0.872, val_loss=0.904, val_accuracy=0.764, lr=0.00316] 99%|█████████▉| 99/100 [39:38<00:23, 23.47s/epoch, loss=0.566, accuracy=0.874, val_loss=0.988, val_accuracy=0.744, lr=0.01]   100%|██████████| 100/100 [40:01<00:00, 23.53s/epoch, loss=0.568, accuracy=0.873, val_loss=0.806, val_accuracy=0.801, lr=0.01]100%|██████████| 100/100 [40:01<00:00, 24.02s/epoch, loss=0.568, accuracy=0.873, val_loss=0.806, val_accuracy=0.801, lr=0.01]
Using real-time data augmentation.
Test loss: 0.806283175945282
Test accuracy: 0.8011000156402588


* * * Run SGD for ID = 15_9. * * *


2024-02-15 18:38:48.393498: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 18:38:51.175025: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 18:38:51.176302: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-15 18:38:51.213884: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 18:38:51.213917: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 18:38:51.216756: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 18:38:51.216806: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 18:38:51.218950: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 18:38:51.219603: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 18:38:51.221921: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 18:38:51.223330: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 18:38:51.227784: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 18:38:51.228322: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 18:38:51.228405: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 18:38:52.520130: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-15 18:38:52.520695: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 18:38:52.521152: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 18:38:52.521183: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 18:38:52.521217: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 18:38:52.521235: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 18:38:52.521252: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 18:38:52.521268: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 18:38:52.521285: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 18:38:52.521302: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 18:38:52.521319: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 18:38:52.521794: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 18:38:52.521834: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 18:38:53.174522: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-15 18:38:53.174574: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-15 18:38:53.174584: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-15 18:38:53.175542: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:02:00.0, compute capability: 6.1)
{'id': 159, 'batch_size': 128, 'epochs': 100, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/100 [00:00<?, ?epoch/s]2024-02-15 18:38:53.972172: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-15 18:38:53.983807: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199950000 Hz
2024-02-15 18:38:55.962321: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 18:38:56.246395: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 18:38:57.072566: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-15 18:38:57.157774: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/100 [01:06<1:49:56, 66.63s/epoch, loss=3.32, accuracy=0.243, val_loss=3.09, val_accuracy=0.177, lr=0.1]  2%|▏         | 2/100 [01:30<1:08:02, 41.65s/epoch, loss=1.71, accuracy=0.451, val_loss=2.04, val_accuracy=0.345, lr=0.1]  3%|▎         | 3/100 [01:54<54:20, 33.61s/epoch, loss=1.46, accuracy=0.574, val_loss=1.87, val_accuracy=0.475, lr=0.1]    4%|▍         | 4/100 [02:18<47:37, 29.76s/epoch, loss=1.32, accuracy=0.659, val_loss=3.11, val_accuracy=0.324, lr=0.1]  5%|▌         | 5/100 [02:42<43:44, 27.63s/epoch, loss=1.27, accuracy=0.688, val_loss=1.46, val_accuracy=0.615, lr=0.1]  6%|▌         | 6/100 [03:06<41:12, 26.30s/epoch, loss=1.25, accuracy=0.705, val_loss=1.71, val_accuracy=0.549, lr=0.1]  7%|▋         | 7/100 [03:29<39:27, 25.46s/epoch, loss=1.24, accuracy=0.715, val_loss=1.91, val_accuracy=0.498, lr=0.1]  8%|▊         | 8/100 [03:53<37:59, 24.77s/epoch, loss=1.22, accuracy=0.724, val_loss=1.77, val_accuracy=0.548, lr=0.1]  9%|▉         | 9/100 [04:17<37:15, 24.56s/epoch, loss=1.22, accuracy=0.726, val_loss=3.3, val_accuracy=0.306, lr=0.1]  10%|█         | 10/100 [04:41<36:25, 24.29s/epoch, loss=1.2, accuracy=0.732, val_loss=1.44, val_accuracy=0.663, lr=0.1] 11%|█         | 11/100 [05:04<35:47, 24.12s/epoch, loss=1.21, accuracy=0.734, val_loss=2, val_accuracy=0.477, lr=0.1]   12%|█▏        | 12/100 [05:28<35:03, 23.90s/epoch, loss=1.2, accuracy=0.735, val_loss=1.7, val_accuracy=0.557, lr=0.1] 13%|█▎        | 13/100 [05:51<34:27, 23.76s/epoch, loss=1.2, accuracy=0.738, val_loss=2.18, val_accuracy=0.461, lr=0.1] 14%|█▍        | 14/100 [06:15<34:04, 23.77s/epoch, loss=1.19, accuracy=0.742, val_loss=3.35, val_accuracy=0.41, lr=0.1] 15%|█▌        | 15/100 [06:39<33:37, 23.73s/epoch, loss=1.19, accuracy=0.741, val_loss=5.23, val_accuracy=0.211, lr=0.0316] 16%|█▌        | 16/100 [07:03<33:20, 23.81s/epoch, loss=1.19, accuracy=0.744, val_loss=5.73, val_accuracy=0.29, lr=0.1]     17%|█▋        | 17/100 [07:27<33:00, 23.86s/epoch, loss=1.19, accuracy=0.744, val_loss=2.45, val_accuracy=0.393, lr=0.1] 18%|█▊        | 18/100 [07:50<32:33, 23.82s/epoch, loss=1.19, accuracy=0.744, val_loss=1.74, val_accuracy=0.568, lr=0.1] 19%|█▉        | 19/100 [08:14<32:01, 23.72s/epoch, loss=1.17, accuracy=0.746, val_loss=1.6, val_accuracy=0.582, lr=0.1]  20%|██        | 20/100 [08:38<31:38, 23.73s/epoch, loss=1.18, accuracy=0.745, val_loss=2.06, val_accuracy=0.529, lr=0.0316] 21%|██        | 21/100 [09:01<31:16, 23.75s/epoch, loss=1.17, accuracy=0.748, val_loss=1.82, val_accuracy=0.567, lr=0.1]    22%|██▏       | 22/100 [09:25<30:46, 23.67s/epoch, loss=1.17, accuracy=0.75, val_loss=1.78, val_accuracy=0.54, lr=0.1]   23%|██▎       | 23/100 [09:49<30:27, 23.73s/epoch, loss=1.16, accuracy=0.75, val_loss=2.08, val_accuracy=0.457, lr=0.1] 24%|██▍       | 24/100 [10:12<29:59, 23.68s/epoch, loss=1.16, accuracy=0.75, val_loss=2.21, val_accuracy=0.491, lr=0.1] 25%|██▌       | 25/100 [10:36<29:38, 23.72s/epoch, loss=1.17, accuracy=0.749, val_loss=1.79, val_accuracy=0.535, lr=0.0316] 26%|██▌       | 26/100 [11:00<29:18, 23.76s/epoch, loss=1.16, accuracy=0.75, val_loss=1.68, val_accuracy=0.555, lr=0.1]     27%|██▋       | 27/100 [11:24<28:57, 23.81s/epoch, loss=1.16, accuracy=0.75, val_loss=1.64, val_accuracy=0.612, lr=0.1] 28%|██▊       | 28/100 [11:48<28:49, 24.02s/epoch, loss=1.15, accuracy=0.75, val_loss=2.11, val_accuracy=0.478, lr=0.1] 29%|██▉       | 29/100 [12:12<28:26, 24.04s/epoch, loss=1.16, accuracy=0.751, val_loss=1.62, val_accuracy=0.618, lr=0.1] 30%|███       | 30/100 [12:37<28:06, 24.10s/epoch, loss=1.15, accuracy=0.753, val_loss=1.96, val_accuracy=0.505, lr=0.0316] 31%|███       | 31/100 [13:01<27:37, 24.03s/epoch, loss=1.15, accuracy=0.752, val_loss=1.63, val_accuracy=0.582, lr=0.1]    32%|███▏      | 32/100 [13:25<27:16, 24.06s/epoch, loss=1.15, accuracy=0.751, val_loss=2.6, val_accuracy=0.29, lr=0.1]   33%|███▎      | 33/100 [13:49<26:47, 24.00s/epoch, loss=1.14, accuracy=0.755, val_loss=2.09, val_accuracy=0.515, lr=0.1] 34%|███▍      | 34/100 [14:12<26:18, 23.91s/epoch, loss=1.16, accuracy=0.75, val_loss=2.26, val_accuracy=0.412, lr=0.1]  35%|███▌      | 35/100 [14:35<25:41, 23.71s/epoch, loss=1.15, accuracy=0.751, val_loss=2.58, val_accuracy=0.46, lr=0.0316] 36%|███▌      | 36/100 [14:59<25:14, 23.66s/epoch, loss=1.15, accuracy=0.752, val_loss=2.95, val_accuracy=0.429, lr=0.1]   37%|███▋      | 37/100 [15:23<25:01, 23.83s/epoch, loss=1.15, accuracy=0.754, val_loss=2.39, val_accuracy=0.412, lr=0.1] 38%|███▊      | 38/100 [15:47<24:34, 23.78s/epoch, loss=1.15, accuracy=0.753, val_loss=2.79, val_accuracy=0.386, lr=0.1] 39%|███▉      | 39/100 [16:11<24:12, 23.82s/epoch, loss=1.14, accuracy=0.753, val_loss=1.86, val_accuracy=0.542, lr=0.1] 40%|████      | 40/100 [16:35<23:51, 23.86s/epoch, loss=1.15, accuracy=0.753, val_loss=6.12, val_accuracy=0.201, lr=0.0316] 41%|████      | 41/100 [16:58<23:22, 23.77s/epoch, loss=1.15, accuracy=0.752, val_loss=2.16, val_accuracy=0.534, lr=0.1]    42%|████▏     | 42/100 [17:22<23:00, 23.79s/epoch, loss=1.14, accuracy=0.755, val_loss=2.1, val_accuracy=0.438, lr=0.1]  43%|████▎     | 43/100 [17:45<22:28, 23.65s/epoch, loss=1.14, accuracy=0.753, val_loss=2.47, val_accuracy=0.346, lr=0.1] 44%|████▍     | 44/100 [18:09<22:09, 23.74s/epoch, loss=1.14, accuracy=0.755, val_loss=4.2, val_accuracy=0.27, lr=0.1]   45%|████▌     | 45/100 [18:33<21:39, 23.62s/epoch, loss=1.14, accuracy=0.756, val_loss=2.48, val_accuracy=0.421, lr=0.0316] 46%|████▌     | 46/100 [18:56<21:11, 23.55s/epoch, loss=1.14, accuracy=0.755, val_loss=2.57, val_accuracy=0.353, lr=0.1]    47%|████▋     | 47/100 [19:20<20:51, 23.60s/epoch, loss=1.14, accuracy=0.757, val_loss=2.01, val_accuracy=0.48, lr=0.1]  48%|████▊     | 48/100 [19:44<20:33, 23.72s/epoch, loss=1.14, accuracy=0.757, val_loss=2.65, val_accuracy=0.389, lr=0.1] 49%|████▉     | 49/100 [20:08<20:18, 23.88s/epoch, loss=1.14, accuracy=0.755, val_loss=3.05, val_accuracy=0.374, lr=0.1] 50%|█████     | 50/100 [20:32<19:54, 23.90s/epoch, loss=1.14, accuracy=0.756, val_loss=1.58, val_accuracy=0.61, lr=0.0316] 51%|█████     | 51/100 [20:56<19:32, 23.93s/epoch, loss=1.15, accuracy=0.755, val_loss=2.03, val_accuracy=0.473, lr=0.1]   52%|█████▏    | 52/100 [21:20<19:11, 24.00s/epoch, loss=1.14, accuracy=0.753, val_loss=2.57, val_accuracy=0.48, lr=0.1]  53%|█████▎    | 53/100 [21:44<18:47, 23.99s/epoch, loss=1.14, accuracy=0.757, val_loss=1.99, val_accuracy=0.471, lr=0.1] 54%|█████▍    | 54/100 [22:08<18:20, 23.92s/epoch, loss=1.13, accuracy=0.755, val_loss=1.81, val_accuracy=0.514, lr=0.1] 55%|█████▌    | 55/100 [22:31<17:51, 23.80s/epoch, loss=1.13, accuracy=0.756, val_loss=1.53, val_accuracy=0.635, lr=0.0316] 56%|█████▌    | 56/100 [22:55<17:27, 23.81s/epoch, loss=1.13, accuracy=0.757, val_loss=2.08, val_accuracy=0.481, lr=0.1]    57%|█████▋    | 57/100 [23:19<17:00, 23.72s/epoch, loss=1.13, accuracy=0.758, val_loss=2.17, val_accuracy=0.483, lr=0.1] 58%|█████▊    | 58/100 [23:43<16:37, 23.74s/epoch, loss=1.14, accuracy=0.756, val_loss=2.06, val_accuracy=0.494, lr=0.1] 59%|█████▉    | 59/100 [24:07<16:19, 23.89s/epoch, loss=1.13, accuracy=0.757, val_loss=2.51, val_accuracy=0.343, lr=0.1] 60%|██████    | 60/100 [24:31<15:58, 23.96s/epoch, loss=1.13, accuracy=0.758, val_loss=1.72, val_accuracy=0.574, lr=0.0316] 61%|██████    | 61/100 [24:55<15:39, 24.08s/epoch, loss=1.13, accuracy=0.757, val_loss=2.33, val_accuracy=0.445, lr=0.1]    62%|██████▏   | 62/100 [25:19<15:12, 24.01s/epoch, loss=1.12, accuracy=0.759, val_loss=1.76, val_accuracy=0.521, lr=0.1] 63%|██████▎   | 63/100 [25:43<14:45, 23.94s/epoch, loss=1.12, accuracy=0.759, val_loss=2.94, val_accuracy=0.364, lr=0.1] 64%|██████▍   | 64/100 [26:07<14:17, 23.83s/epoch, loss=1.14, accuracy=0.756, val_loss=2.13, val_accuracy=0.441, lr=0.1] 65%|██████▌   | 65/100 [26:30<13:49, 23.71s/epoch, loss=1.13, accuracy=0.755, val_loss=1.55, val_accuracy=0.614, lr=0.0316] 66%|██████▌   | 66/100 [26:53<13:21, 23.59s/epoch, loss=1.13, accuracy=0.756, val_loss=2.2, val_accuracy=0.465, lr=0.1]     67%|██████▋   | 67/100 [27:17<12:58, 23.58s/epoch, loss=1.13, accuracy=0.758, val_loss=1.73, val_accuracy=0.557, lr=0.1] 68%|██████▊   | 68/100 [27:41<12:35, 23.62s/epoch, loss=1.13, accuracy=0.755, val_loss=3.05, val_accuracy=0.37, lr=0.1]  69%|██████▉   | 69/100 [28:04<12:12, 23.64s/epoch, loss=1.13, accuracy=0.757, val_loss=2.54, val_accuracy=0.432, lr=0.1] 70%|███████   | 70/100 [28:28<11:49, 23.65s/epoch, loss=1.13, accuracy=0.754, val_loss=2.51, val_accuracy=0.44, lr=0.0316] 71%|███████   | 71/100 [28:51<11:25, 23.63s/epoch, loss=1.13, accuracy=0.757, val_loss=1.77, val_accuracy=0.525, lr=0.1]   72%|███████▏  | 72/100 [29:15<11:01, 23.61s/epoch, loss=1.12, accuracy=0.755, val_loss=2.58, val_accuracy=0.432, lr=0.1] 73%|███████▎  | 73/100 [29:39<10:40, 23.73s/epoch, loss=1.12, accuracy=0.759, val_loss=3.6, val_accuracy=0.259, lr=0.1]  74%|███████▍  | 74/100 [30:03<10:16, 23.71s/epoch, loss=1.12, accuracy=0.758, val_loss=2.97, val_accuracy=0.429, lr=0.1] 75%|███████▌  | 75/100 [30:26<09:51, 23.67s/epoch, loss=1.12, accuracy=0.757, val_loss=1.97, val_accuracy=0.491, lr=0.0316] 76%|███████▌  | 76/100 [30:50<09:30, 23.79s/epoch, loss=1.12, accuracy=0.76, val_loss=2.9, val_accuracy=0.419, lr=0.1]      77%|███████▋  | 77/100 [31:14<09:06, 23.76s/epoch, loss=1.12, accuracy=0.758, val_loss=1.65, val_accuracy=0.592, lr=0.1] 78%|███████▊  | 78/100 [31:38<08:41, 23.70s/epoch, loss=1.12, accuracy=0.759, val_loss=1.4, val_accuracy=0.663, lr=0.1]  79%|███████▉  | 79/100 [32:01<08:17, 23.67s/epoch, loss=1.12, accuracy=0.76, val_loss=1.7, val_accuracy=0.552, lr=0.1]  80%|████████  | 80/100 [32:25<07:54, 23.70s/epoch, loss=1.12, accuracy=0.756, val_loss=1.98, val_accuracy=0.476, lr=0.1] 81%|████████  | 81/100 [32:49<07:30, 23.70s/epoch, loss=1.12, accuracy=0.756, val_loss=1.72, val_accuracy=0.535, lr=0.1] 82%|████████▏ | 82/100 [33:12<07:05, 23.63s/epoch, loss=0.911, accuracy=0.816, val_loss=0.906, val_accuracy=0.799, lr=0.01] 83%|████████▎ | 83/100 [33:36<06:41, 23.60s/epoch, loss=0.736, accuracy=0.848, val_loss=0.812, val_accuracy=0.809, lr=0.01] 84%|████████▍ | 84/100 [34:00<06:18, 23.68s/epoch, loss=0.65, accuracy=0.858, val_loss=0.777, val_accuracy=0.803, lr=0.01]  85%|████████▌ | 85/100 [34:23<05:53, 23.56s/epoch, loss=0.607, accuracy=0.86, val_loss=0.764, val_accuracy=0.806, lr=0.01] 86%|████████▌ | 86/100 [34:47<05:30, 23.63s/epoch, loss=0.585, accuracy=0.861, val_loss=0.892, val_accuracy=0.765, lr=0.01] 87%|████████▋ | 87/100 [35:10<05:06, 23.59s/epoch, loss=0.571, accuracy=0.865, val_loss=0.832, val_accuracy=0.785, lr=0.01] 88%|████████▊ | 88/100 [35:34<04:42, 23.54s/epoch, loss=0.563, accuracy=0.866, val_loss=0.723, val_accuracy=0.817, lr=0.01] 89%|████████▉ | 89/100 [35:57<04:19, 23.62s/epoch, loss=0.561, accuracy=0.868, val_loss=0.777, val_accuracy=0.798, lr=0.01] 90%|█████████ | 90/100 [36:21<03:55, 23.60s/epoch, loss=0.562, accuracy=0.866, val_loss=0.884, val_accuracy=0.768, lr=0.01] 91%|█████████ | 91/100 [36:44<03:31, 23.50s/epoch, loss=0.555, accuracy=0.87, val_loss=0.715, val_accuracy=0.821, lr=0.01]  92%|█████████▏| 92/100 [37:08<03:08, 23.54s/epoch, loss=0.563, accuracy=0.868, val_loss=0.981, val_accuracy=0.756, lr=0.01] 93%|█████████▎| 93/100 [37:32<02:45, 23.64s/epoch, loss=0.56, accuracy=0.871, val_loss=0.868, val_accuracy=0.77, lr=0.01]   94%|█████████▍| 94/100 [37:55<02:21, 23.55s/epoch, loss=0.557, accuracy=0.872, val_loss=0.752, val_accuracy=0.805, lr=0.01] 95%|█████████▌| 95/100 [38:18<01:57, 23.44s/epoch, loss=0.556, accuracy=0.874, val_loss=0.835, val_accuracy=0.785, lr=0.01] 96%|█████████▌| 96/100 [38:42<01:34, 23.59s/epoch, loss=0.553, accuracy=0.877, val_loss=0.793, val_accuracy=0.802, lr=0.00316] 97%|█████████▋| 97/100 [39:06<01:11, 23.68s/epoch, loss=0.556, accuracy=0.876, val_loss=1.26, val_accuracy=0.694, lr=0.01]     98%|█████████▊| 98/100 [39:30<00:47, 23.77s/epoch, loss=0.557, accuracy=0.875, val_loss=0.77, val_accuracy=0.813, lr=0.01] 99%|█████████▉| 99/100 [39:54<00:23, 23.72s/epoch, loss=0.552, accuracy=0.877, val_loss=0.84, val_accuracy=0.795, lr=0.01]100%|██████████| 100/100 [40:17<00:00, 23.61s/epoch, loss=0.552, accuracy=0.877, val_loss=0.782, val_accuracy=0.813, lr=0.01]100%|██████████| 100/100 [40:17<00:00, 24.17s/epoch, loss=0.552, accuracy=0.877, val_loss=0.782, val_accuracy=0.813, lr=0.01]
Using real-time data augmentation.
Test loss: 0.7819504737854004
Test accuracy: 0.8127999901771545


* * * Run SGD for ID = 15_10. * * *


2024-02-15 19:19:15.442784: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 19:19:19.261164: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 19:19:19.262508: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-15 19:19:19.302276: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 19:19:19.302321: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 19:19:19.305186: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 19:19:19.305233: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 19:19:19.307648: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 19:19:19.308381: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 19:19:19.310927: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 19:19:19.312480: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 19:19:19.317661: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 19:19:19.318278: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 19:19:19.318360: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 19:19:20.676267: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-15 19:19:20.677752: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 19:19:20.678247: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 19:19:20.678281: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 19:19:20.678317: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 19:19:20.678336: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 19:19:20.678355: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 19:19:20.678373: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 19:19:20.678391: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 19:19:20.678409: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 19:19:20.678427: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 19:19:20.678942: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 19:19:20.678980: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 19:19:21.417690: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-15 19:19:21.417757: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-15 19:19:21.417768: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-15 19:19:21.419178: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:02:00.0, compute capability: 6.1)
{'id': 1510, 'batch_size': 128, 'epochs': 100, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/100 [00:00<?, ?epoch/s]2024-02-15 19:19:22.264845: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-15 19:19:22.276824: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199950000 Hz
2024-02-15 19:19:24.344688: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 19:19:24.617667: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 19:19:25.417330: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-15 19:19:25.522390: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/100 [01:21<2:14:55, 81.77s/epoch, loss=3.17, accuracy=0.299, val_loss=3.28, val_accuracy=0.147, lr=0.1]  2%|▏         | 2/100 [01:45<1:18:06, 47.83s/epoch, loss=1.59, accuracy=0.515, val_loss=1.89, val_accuracy=0.458, lr=0.1]  3%|▎         | 3/100 [02:09<59:24, 36.75s/epoch, loss=1.4, accuracy=0.618, val_loss=1.85, val_accuracy=0.499, lr=0.1]     4%|▍         | 4/100 [02:33<50:39, 31.66s/epoch, loss=1.31, accuracy=0.668, val_loss=1.94, val_accuracy=0.475, lr=0.1]  5%|▌         | 5/100 [02:56<45:25, 28.69s/epoch, loss=1.27, accuracy=0.693, val_loss=1.77, val_accuracy=0.547, lr=0.1]  6%|▌         | 6/100 [03:20<42:27, 27.10s/epoch, loss=1.26, accuracy=0.702, val_loss=1.66, val_accuracy=0.549, lr=0.1]  7%|▋         | 7/100 [03:44<40:18, 26.00s/epoch, loss=1.24, accuracy=0.709, val_loss=1.44, val_accuracy=0.659, lr=0.1]  8%|▊         | 8/100 [04:08<38:48, 25.31s/epoch, loss=1.22, accuracy=0.717, val_loss=1.44, val_accuracy=0.64, lr=0.1]   9%|▉         | 9/100 [04:31<37:32, 24.76s/epoch, loss=1.22, accuracy=0.72, val_loss=2.03, val_accuracy=0.503, lr=0.1] 10%|█         | 10/100 [04:55<36:41, 24.47s/epoch, loss=1.22, accuracy=0.721, val_loss=2.43, val_accuracy=0.445, lr=0.1] 11%|█         | 11/100 [05:19<36:08, 24.36s/epoch, loss=1.2, accuracy=0.726, val_loss=4.61, val_accuracy=0.245, lr=0.1]  12%|█▏        | 12/100 [05:43<35:26, 24.16s/epoch, loss=1.2, accuracy=0.729, val_loss=2.3, val_accuracy=0.511, lr=0.0316] 13%|█▎        | 13/100 [06:07<34:55, 24.08s/epoch, loss=1.2, accuracy=0.728, val_loss=2.08, val_accuracy=0.42, lr=0.1]    14%|█▍        | 14/100 [06:31<34:22, 23.98s/epoch, loss=1.18, accuracy=0.734, val_loss=2.08, val_accuracy=0.398, lr=0.1] 15%|█▌        | 15/100 [06:54<33:56, 23.95s/epoch, loss=1.18, accuracy=0.733, val_loss=1.63, val_accuracy=0.596, lr=0.1] 16%|█▌        | 16/100 [07:19<33:34, 23.98s/epoch, loss=1.18, accuracy=0.738, val_loss=1.54, val_accuracy=0.638, lr=0.1] 17%|█▋        | 17/100 [07:42<33:05, 23.92s/epoch, loss=1.18, accuracy=0.738, val_loss=1.39, val_accuracy=0.665, lr=0.1] 18%|█▊        | 18/100 [08:06<32:41, 23.92s/epoch, loss=1.18, accuracy=0.738, val_loss=2.79, val_accuracy=0.453, lr=0.1] 19%|█▉        | 19/100 [08:30<32:13, 23.87s/epoch, loss=1.18, accuracy=0.74, val_loss=1.75, val_accuracy=0.541, lr=0.1]  20%|██        | 20/100 [08:54<31:53, 23.91s/epoch, loss=1.17, accuracy=0.742, val_loss=1.47, val_accuracy=0.627, lr=0.1] 21%|██        | 21/100 [09:18<31:23, 23.85s/epoch, loss=1.16, accuracy=0.744, val_loss=1.81, val_accuracy=0.544, lr=0.1] 22%|██▏       | 22/100 [09:42<30:59, 23.84s/epoch, loss=1.16, accuracy=0.744, val_loss=1.94, val_accuracy=0.52, lr=0.0316] 23%|██▎       | 23/100 [10:05<30:35, 23.83s/epoch, loss=1.17, accuracy=0.743, val_loss=2.39, val_accuracy=0.487, lr=0.1]   24%|██▍       | 24/100 [10:29<30:08, 23.80s/epoch, loss=1.15, accuracy=0.749, val_loss=1.46, val_accuracy=0.648, lr=0.1] 25%|██▌       | 25/100 [10:53<29:44, 23.79s/epoch, loss=1.15, accuracy=0.745, val_loss=1.86, val_accuracy=0.531, lr=0.1] 26%|██▌       | 26/100 [11:17<29:18, 23.76s/epoch, loss=1.15, accuracy=0.745, val_loss=1.56, val_accuracy=0.614, lr=0.1] 27%|██▋       | 27/100 [11:41<29:02, 23.87s/epoch, loss=1.15, accuracy=0.749, val_loss=2.84, val_accuracy=0.429, lr=0.0316] 28%|██▊       | 28/100 [12:04<28:36, 23.84s/epoch, loss=1.15, accuracy=0.747, val_loss=1.59, val_accuracy=0.598, lr=0.1]    29%|██▉       | 29/100 [12:28<28:04, 23.73s/epoch, loss=1.14, accuracy=0.749, val_loss=2.45, val_accuracy=0.458, lr=0.1] 30%|███       | 30/100 [12:52<27:44, 23.77s/epoch, loss=1.14, accuracy=0.749, val_loss=1.78, val_accuracy=0.582, lr=0.1] 31%|███       | 31/100 [13:15<27:15, 23.71s/epoch, loss=1.14, accuracy=0.75, val_loss=2.02, val_accuracy=0.453, lr=0.1]  32%|███▏      | 32/100 [13:39<26:55, 23.75s/epoch, loss=1.14, accuracy=0.751, val_loss=2.08, val_accuracy=0.497, lr=0.0316] 33%|███▎      | 33/100 [14:03<26:37, 23.84s/epoch, loss=1.13, accuracy=0.751, val_loss=1.54, val_accuracy=0.643, lr=0.1]    34%|███▍      | 34/100 [14:27<26:17, 23.90s/epoch, loss=1.13, accuracy=0.75, val_loss=2.84, val_accuracy=0.338, lr=0.1]  35%|███▌      | 35/100 [14:51<25:46, 23.79s/epoch, loss=1.13, accuracy=0.752, val_loss=1.99, val_accuracy=0.479, lr=0.1] 36%|███▌      | 36/100 [15:15<25:24, 23.81s/epoch, loss=1.12, accuracy=0.753, val_loss=1.44, val_accuracy=0.647, lr=0.1] 37%|███▋      | 37/100 [15:39<25:08, 23.94s/epoch, loss=1.13, accuracy=0.751, val_loss=1.57, val_accuracy=0.588, lr=0.0316] 38%|███▊      | 38/100 [16:03<24:45, 23.96s/epoch, loss=1.12, accuracy=0.756, val_loss=1.53, val_accuracy=0.605, lr=0.1]    39%|███▉      | 39/100 [16:27<24:19, 23.92s/epoch, loss=1.13, accuracy=0.753, val_loss=1.82, val_accuracy=0.527, lr=0.1] 40%|████      | 40/100 [16:51<23:54, 23.90s/epoch, loss=1.13, accuracy=0.753, val_loss=2.43, val_accuracy=0.418, lr=0.1] 41%|████      | 41/100 [17:15<23:37, 24.02s/epoch, loss=1.13, accuracy=0.753, val_loss=1.74, val_accuracy=0.558, lr=0.1] 42%|████▏     | 42/100 [17:39<23:11, 24.00s/epoch, loss=1.12, accuracy=0.753, val_loss=1.45, val_accuracy=0.628, lr=0.0316] 43%|████▎     | 43/100 [18:03<22:52, 24.07s/epoch, loss=1.13, accuracy=0.752, val_loss=1.65, val_accuracy=0.577, lr=0.1]    44%|████▍     | 44/100 [18:27<22:20, 23.93s/epoch, loss=1.12, accuracy=0.756, val_loss=2, val_accuracy=0.49, lr=0.1]     45%|████▌     | 45/100 [18:51<21:55, 23.91s/epoch, loss=1.12, accuracy=0.756, val_loss=2.43, val_accuracy=0.45, lr=0.1] 46%|████▌     | 46/100 [19:14<21:31, 23.92s/epoch, loss=1.12, accuracy=0.758, val_loss=2.44, val_accuracy=0.416, lr=0.1] 47%|████▋     | 47/100 [19:38<21:06, 23.89s/epoch, loss=1.12, accuracy=0.755, val_loss=1.5, val_accuracy=0.638, lr=0.0316] 48%|████▊     | 48/100 [20:02<20:46, 23.98s/epoch, loss=1.12, accuracy=0.755, val_loss=1.93, val_accuracy=0.524, lr=0.1]   49%|████▉     | 49/100 [20:26<20:16, 23.86s/epoch, loss=1.12, accuracy=0.754, val_loss=1.62, val_accuracy=0.575, lr=0.1] 50%|█████     | 50/100 [20:50<19:58, 23.96s/epoch, loss=1.12, accuracy=0.757, val_loss=1.91, val_accuracy=0.467, lr=0.1] 51%|█████     | 51/100 [21:14<19:29, 23.86s/epoch, loss=1.12, accuracy=0.757, val_loss=1.36, val_accuracy=0.668, lr=0.1] 52%|█████▏    | 52/100 [21:38<19:04, 23.85s/epoch, loss=1.13, accuracy=0.755, val_loss=2.14, val_accuracy=0.484, lr=0.1] 53%|█████▎    | 53/100 [22:02<18:42, 23.87s/epoch, loss=1.12, accuracy=0.757, val_loss=1.96, val_accuracy=0.546, lr=0.1] 54%|█████▍    | 54/100 [22:26<18:21, 23.94s/epoch, loss=1.12, accuracy=0.756, val_loss=4.22, val_accuracy=0.3, lr=0.1]   55%|█████▌    | 55/100 [22:50<17:57, 23.93s/epoch, loss=1.11, accuracy=0.757, val_loss=1.6, val_accuracy=0.582, lr=0.1] 56%|█████▌    | 56/100 [23:14<17:34, 23.96s/epoch, loss=1.12, accuracy=0.756, val_loss=1.65, val_accuracy=0.577, lr=0.0316] 57%|█████▋    | 57/100 [23:37<17:03, 23.80s/epoch, loss=1.12, accuracy=0.757, val_loss=1.82, val_accuracy=0.512, lr=0.1]    58%|█████▊    | 58/100 [24:01<16:41, 23.84s/epoch, loss=1.12, accuracy=0.756, val_loss=2.03, val_accuracy=0.524, lr=0.1] 59%|█████▉    | 59/100 [24:25<16:12, 23.73s/epoch, loss=1.12, accuracy=0.756, val_loss=2.47, val_accuracy=0.423, lr=0.1] 60%|██████    | 60/100 [24:49<15:52, 23.81s/epoch, loss=1.11, accuracy=0.756, val_loss=2.12, val_accuracy=0.453, lr=0.1] 61%|██████    | 61/100 [25:12<15:30, 23.85s/epoch, loss=1.11, accuracy=0.757, val_loss=2.99, val_accuracy=0.277, lr=0.0316] 62%|██████▏   | 62/100 [25:36<15:03, 23.78s/epoch, loss=1.12, accuracy=0.757, val_loss=3.24, val_accuracy=0.381, lr=0.1]    63%|██████▎   | 63/100 [25:59<14:35, 23.67s/epoch, loss=1.11, accuracy=0.757, val_loss=2.93, val_accuracy=0.408, lr=0.1] 64%|██████▍   | 64/100 [26:23<14:11, 23.67s/epoch, loss=1.11, accuracy=0.757, val_loss=2.05, val_accuracy=0.436, lr=0.1] 65%|██████▌   | 65/100 [26:47<13:50, 23.72s/epoch, loss=1.11, accuracy=0.757, val_loss=1.62, val_accuracy=0.567, lr=0.1] 66%|██████▌   | 66/100 [27:11<13:29, 23.81s/epoch, loss=1.12, accuracy=0.758, val_loss=1.49, val_accuracy=0.63, lr=0.0316] 67%|██████▋   | 67/100 [27:35<13:07, 23.86s/epoch, loss=1.11, accuracy=0.759, val_loss=2.09, val_accuracy=0.507, lr=0.1]   68%|██████▊   | 68/100 [27:59<12:45, 23.94s/epoch, loss=1.11, accuracy=0.76, val_loss=3.24, val_accuracy=0.363, lr=0.1]  69%|██████▉   | 69/100 [28:23<12:25, 24.06s/epoch, loss=1.11, accuracy=0.756, val_loss=4.55, val_accuracy=0.342, lr=0.1] 70%|███████   | 70/100 [28:47<12:01, 24.06s/epoch, loss=1.11, accuracy=0.758, val_loss=2.36, val_accuracy=0.456, lr=0.1] 71%|███████   | 71/100 [29:11<11:30, 23.81s/epoch, loss=1.11, accuracy=0.756, val_loss=1.88, val_accuracy=0.579, lr=0.0316] 72%|███████▏  | 72/100 [29:34<11:04, 23.73s/epoch, loss=1.11, accuracy=0.76, val_loss=2.9, val_accuracy=0.396, lr=0.1]      73%|███████▎  | 73/100 [29:58<10:37, 23.63s/epoch, loss=1.12, accuracy=0.755, val_loss=2.4, val_accuracy=0.462, lr=0.1] 74%|███████▍  | 74/100 [30:21<10:13, 23.61s/epoch, loss=1.11, accuracy=0.757, val_loss=1.93, val_accuracy=0.44, lr=0.1] 75%|███████▌  | 75/100 [30:45<09:48, 23.53s/epoch, loss=1.11, accuracy=0.757, val_loss=2.11, val_accuracy=0.473, lr=0.1] 76%|███████▌  | 76/100 [31:08<09:24, 23.52s/epoch, loss=1.11, accuracy=0.758, val_loss=1.69, val_accuracy=0.546, lr=0.0316] 77%|███████▋  | 77/100 [31:32<09:04, 23.68s/epoch, loss=1.11, accuracy=0.758, val_loss=1.41, val_accuracy=0.654, lr=0.1]    78%|███████▊  | 78/100 [31:56<08:39, 23.63s/epoch, loss=1.11, accuracy=0.755, val_loss=1.99, val_accuracy=0.456, lr=0.1] 79%|███████▉  | 79/100 [32:19<08:15, 23.59s/epoch, loss=1.11, accuracy=0.758, val_loss=1.95, val_accuracy=0.494, lr=0.1] 80%|████████  | 80/100 [32:42<07:50, 23.51s/epoch, loss=1.11, accuracy=0.757, val_loss=6.2, val_accuracy=0.276, lr=0.1]  81%|████████  | 81/100 [33:06<07:27, 23.58s/epoch, loss=1.11, accuracy=0.759, val_loss=1.85, val_accuracy=0.548, lr=0.0316] 82%|████████▏ | 82/100 [33:30<07:07, 23.74s/epoch, loss=0.907, accuracy=0.814, val_loss=0.874, val_accuracy=0.806, lr=0.01] 83%|████████▎ | 83/100 [33:54<06:43, 23.76s/epoch, loss=0.724, accuracy=0.848, val_loss=0.82, val_accuracy=0.799, lr=0.01]  84%|████████▍ | 84/100 [34:18<06:20, 23.76s/epoch, loss=0.648, accuracy=0.855, val_loss=0.752, val_accuracy=0.812, lr=0.01] 85%|████████▌ | 85/100 [34:41<05:54, 23.67s/epoch, loss=0.603, accuracy=0.858, val_loss=0.977, val_accuracy=0.734, lr=0.01] 86%|████████▌ | 86/100 [35:05<05:30, 23.61s/epoch, loss=0.582, accuracy=0.86, val_loss=0.846, val_accuracy=0.775, lr=0.01]  87%|████████▋ | 87/100 [35:28<05:07, 23.64s/epoch, loss=0.573, accuracy=0.862, val_loss=0.897, val_accuracy=0.75, lr=0.01] 88%|████████▊ | 88/100 [35:52<04:44, 23.69s/epoch, loss=0.569, accuracy=0.862, val_loss=0.977, val_accuracy=0.734, lr=0.01] 89%|████████▉ | 89/100 [36:16<04:20, 23.69s/epoch, loss=0.563, accuracy=0.865, val_loss=0.917, val_accuracy=0.748, lr=0.00316] 90%|█████████ | 90/100 [36:40<03:57, 23.77s/epoch, loss=0.563, accuracy=0.865, val_loss=1.07, val_accuracy=0.72, lr=0.01]      91%|█████████ | 91/100 [37:03<03:33, 23.69s/epoch, loss=0.55, accuracy=0.868, val_loss=0.803, val_accuracy=0.797, lr=0.01] 92%|█████████▏| 92/100 [37:27<03:09, 23.68s/epoch, loss=0.56, accuracy=0.867, val_loss=0.747, val_accuracy=0.805, lr=0.01] 93%|█████████▎| 93/100 [37:51<02:45, 23.69s/epoch, loss=0.559, accuracy=0.868, val_loss=0.836, val_accuracy=0.783, lr=0.01] 94%|█████████▍| 94/100 [38:15<02:22, 23.72s/epoch, loss=0.556, accuracy=0.87, val_loss=0.846, val_accuracy=0.786, lr=0.01]  95%|█████████▌| 95/100 [38:38<01:58, 23.74s/epoch, loss=0.558, accuracy=0.871, val_loss=0.787, val_accuracy=0.795, lr=0.01] 96%|█████████▌| 96/100 [39:02<01:34, 23.71s/epoch, loss=0.558, accuracy=0.872, val_loss=0.688, val_accuracy=0.832, lr=0.01] 97%|█████████▋| 97/100 [39:26<01:11, 23.74s/epoch, loss=0.557, accuracy=0.873, val_loss=0.788, val_accuracy=0.807, lr=0.01] 98%|█████████▊| 98/100 [39:49<00:47, 23.68s/epoch, loss=0.554, accuracy=0.875, val_loss=0.884, val_accuracy=0.773, lr=0.01] 99%|█████████▉| 99/100 [40:13<00:23, 23.77s/epoch, loss=0.552, accuracy=0.876, val_loss=0.899, val_accuracy=0.774, lr=0.01]100%|██████████| 100/100 [40:37<00:00, 23.73s/epoch, loss=0.552, accuracy=0.875, val_loss=1.02, val_accuracy=0.746, lr=0.01]100%|██████████| 100/100 [40:37<00:00, 24.37s/epoch, loss=0.552, accuracy=0.875, val_loss=1.02, val_accuracy=0.746, lr=0.01]
Using real-time data augmentation.
Test loss: 1.0169342756271362
Test accuracy: 0.7461000084877014


* * * Run SGD for ID = 15_11. * * *


2024-02-15 20:00:02.212389: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 20:00:04.972120: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 20:00:04.973126: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-15 20:00:05.014134: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 20:00:05.014171: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 20:00:05.017176: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 20:00:05.017220: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 20:00:05.019353: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 20:00:05.020000: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 20:00:05.022264: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 20:00:05.023696: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 20:00:05.027963: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 20:00:05.028480: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 20:00:05.028748: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 20:00:06.248390: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-15 20:00:06.248966: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 20:00:06.249438: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 20:00:06.249472: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 20:00:06.249505: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 20:00:06.249524: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 20:00:06.249540: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 20:00:06.249558: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 20:00:06.249574: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 20:00:06.249592: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 20:00:06.249609: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 20:00:06.250076: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 20:00:06.250114: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 20:00:06.885799: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-15 20:00:06.885852: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-15 20:00:06.885862: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-15 20:00:06.886786: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:02:00.0, compute capability: 6.1)
{'id': 1511, 'batch_size': 128, 'epochs': 100, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/100 [00:00<?, ?epoch/s]2024-02-15 20:00:07.663590: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-15 20:00:07.675801: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199950000 Hz
2024-02-15 20:00:09.617080: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 20:00:09.908643: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 20:00:10.722761: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-15 20:00:10.765130: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/100 [00:57<1:34:59, 57.57s/epoch, loss=3.14, accuracy=0.304, val_loss=2.72, val_accuracy=0.221, lr=0.1]  2%|▏         | 2/100 [01:22<1:02:16, 38.13s/epoch, loss=1.6, accuracy=0.507, val_loss=2.31, val_accuracy=0.318, lr=0.1]   3%|▎         | 3/100 [01:46<51:19, 31.75s/epoch, loss=1.35, accuracy=0.627, val_loss=2.17, val_accuracy=0.44, lr=0.1]    4%|▍         | 4/100 [02:10<45:59, 28.75s/epoch, loss=1.26, accuracy=0.682, val_loss=1.97, val_accuracy=0.461, lr=0.1]  5%|▌         | 5/100 [02:34<42:50, 27.06s/epoch, loss=1.23, accuracy=0.702, val_loss=2.69, val_accuracy=0.329, lr=0.1]  6%|▌         | 6/100 [02:58<40:53, 26.10s/epoch, loss=1.22, accuracy=0.714, val_loss=2.29, val_accuracy=0.417, lr=0.1]  7%|▋         | 7/100 [03:22<39:30, 25.49s/epoch, loss=1.21, accuracy=0.722, val_loss=2.85, val_accuracy=0.356, lr=0.1]  8%|▊         | 8/100 [03:46<38:19, 25.00s/epoch, loss=1.2, accuracy=0.728, val_loss=2.51, val_accuracy=0.445, lr=0.1]   9%|▉         | 9/100 [04:10<37:21, 24.63s/epoch, loss=1.2, accuracy=0.73, val_loss=2.22, val_accuracy=0.468, lr=0.0316] 10%|█         | 10/100 [04:34<36:47, 24.53s/epoch, loss=1.19, accuracy=0.737, val_loss=1.93, val_accuracy=0.545, lr=0.1] 11%|█         | 11/100 [04:59<36:16, 24.45s/epoch, loss=1.18, accuracy=0.738, val_loss=4.14, val_accuracy=0.236, lr=0.1] 12%|█▏        | 12/100 [05:22<35:27, 24.18s/epoch, loss=1.18, accuracy=0.743, val_loss=1.92, val_accuracy=0.499, lr=0.1] 13%|█▎        | 13/100 [05:46<34:50, 24.03s/epoch, loss=1.17, accuracy=0.744, val_loss=1.98, val_accuracy=0.543, lr=0.1] 14%|█▍        | 14/100 [06:10<34:21, 23.97s/epoch, loss=1.17, accuracy=0.741, val_loss=1.66, val_accuracy=0.581, lr=0.1] 15%|█▌        | 15/100 [06:33<33:41, 23.78s/epoch, loss=1.16, accuracy=0.746, val_loss=2.01, val_accuracy=0.483, lr=0.1] 16%|█▌        | 16/100 [06:57<33:19, 23.80s/epoch, loss=1.16, accuracy=0.745, val_loss=1.58, val_accuracy=0.601, lr=0.1] 17%|█▋        | 17/100 [07:20<32:46, 23.69s/epoch, loss=1.16, accuracy=0.747, val_loss=2.04, val_accuracy=0.403, lr=0.1] 18%|█▊        | 18/100 [07:44<32:17, 23.63s/epoch, loss=1.16, accuracy=0.746, val_loss=2.34, val_accuracy=0.443, lr=0.1] 19%|█▉        | 19/100 [08:08<31:56, 23.66s/epoch, loss=1.16, accuracy=0.748, val_loss=1.67, val_accuracy=0.586, lr=0.1] 20%|██        | 20/100 [08:31<31:20, 23.50s/epoch, loss=1.15, accuracy=0.749, val_loss=2.28, val_accuracy=0.417, lr=0.1] 21%|██        | 21/100 [08:55<31:06, 23.63s/epoch, loss=1.15, accuracy=0.746, val_loss=1.9, val_accuracy=0.529, lr=0.0316] 22%|██▏       | 22/100 [09:18<30:39, 23.59s/epoch, loss=1.16, accuracy=0.747, val_loss=2.38, val_accuracy=0.435, lr=0.1]   23%|██▎       | 23/100 [09:42<30:09, 23.50s/epoch, loss=1.14, accuracy=0.751, val_loss=2.58, val_accuracy=0.438, lr=0.1] 24%|██▍       | 24/100 [10:05<29:51, 23.57s/epoch, loss=1.15, accuracy=0.752, val_loss=2.82, val_accuracy=0.445, lr=0.1] 25%|██▌       | 25/100 [10:29<29:30, 23.61s/epoch, loss=1.14, accuracy=0.75, val_loss=1.9, val_accuracy=0.533, lr=0.1]   26%|██▌       | 26/100 [10:53<29:09, 23.65s/epoch, loss=1.14, accuracy=0.755, val_loss=2.03, val_accuracy=0.564, lr=0.0316] 27%|██▋       | 27/100 [11:16<28:41, 23.59s/epoch, loss=1.14, accuracy=0.754, val_loss=2.83, val_accuracy=0.382, lr=0.1]    28%|██▊       | 28/100 [11:39<28:11, 23.49s/epoch, loss=1.14, accuracy=0.753, val_loss=1.69, val_accuracy=0.551, lr=0.1] 29%|██▉       | 29/100 [12:03<27:54, 23.59s/epoch, loss=1.14, accuracy=0.753, val_loss=2.48, val_accuracy=0.392, lr=0.1] 30%|███       | 30/100 [12:27<27:39, 23.71s/epoch, loss=1.14, accuracy=0.756, val_loss=2.01, val_accuracy=0.486, lr=0.1] 31%|███       | 31/100 [12:51<27:15, 23.70s/epoch, loss=1.13, accuracy=0.755, val_loss=2.39, val_accuracy=0.422, lr=0.0316] 32%|███▏      | 32/100 [13:15<26:59, 23.81s/epoch, loss=1.14, accuracy=0.754, val_loss=1.7, val_accuracy=0.545, lr=0.1]     33%|███▎      | 33/100 [13:39<26:32, 23.76s/epoch, loss=1.13, accuracy=0.756, val_loss=6.59, val_accuracy=0.243, lr=0.1] 34%|███▍      | 34/100 [14:02<26:07, 23.76s/epoch, loss=1.14, accuracy=0.753, val_loss=2.37, val_accuracy=0.397, lr=0.1] 35%|███▌      | 35/100 [14:26<25:47, 23.81s/epoch, loss=1.13, accuracy=0.757, val_loss=2.07, val_accuracy=0.534, lr=0.1] 36%|███▌      | 36/100 [14:50<25:22, 23.78s/epoch, loss=1.13, accuracy=0.756, val_loss=4.72, val_accuracy=0.284, lr=0.0316] 37%|███▋      | 37/100 [15:14<24:56, 23.75s/epoch, loss=1.13, accuracy=0.755, val_loss=2.56, val_accuracy=0.462, lr=0.1]    38%|███▊      | 38/100 [15:37<24:25, 23.64s/epoch, loss=1.13, accuracy=0.755, val_loss=2.51, val_accuracy=0.456, lr=0.1] 39%|███▉      | 39/100 [16:01<24:01, 23.63s/epoch, loss=1.12, accuracy=0.758, val_loss=1.75, val_accuracy=0.535, lr=0.1] 40%|████      | 40/100 [16:24<23:32, 23.54s/epoch, loss=1.13, accuracy=0.755, val_loss=1.68, val_accuracy=0.596, lr=0.1] 41%|████      | 41/100 [16:47<23:07, 23.52s/epoch, loss=1.13, accuracy=0.758, val_loss=1.7, val_accuracy=0.549, lr=0.0316] 42%|████▏     | 42/100 [17:11<22:44, 23.53s/epoch, loss=1.11, accuracy=0.761, val_loss=5.56, val_accuracy=0.228, lr=0.1]   43%|████▎     | 43/100 [17:35<22:24, 23.59s/epoch, loss=1.13, accuracy=0.757, val_loss=4.56, val_accuracy=0.202, lr=0.1] 44%|████▍     | 44/100 [17:59<22:04, 23.64s/epoch, loss=1.13, accuracy=0.757, val_loss=2.95, val_accuracy=0.354, lr=0.1] 45%|████▌     | 45/100 [18:22<21:34, 23.53s/epoch, loss=1.13, accuracy=0.756, val_loss=2.45, val_accuracy=0.314, lr=0.1] 46%|████▌     | 46/100 [18:45<21:06, 23.45s/epoch, loss=1.13, accuracy=0.758, val_loss=1.79, val_accuracy=0.527, lr=0.0316] 47%|████▋     | 47/100 [19:09<20:45, 23.50s/epoch, loss=1.13, accuracy=0.759, val_loss=3.94, val_accuracy=0.334, lr=0.1]    48%|████▊     | 48/100 [19:32<20:21, 23.49s/epoch, loss=1.13, accuracy=0.756, val_loss=1.39, val_accuracy=0.66, lr=0.1]  49%|████▉     | 49/100 [19:55<19:52, 23.38s/epoch, loss=1.13, accuracy=0.759, val_loss=2.19, val_accuracy=0.505, lr=0.1] 50%|█████     | 50/100 [20:18<19:26, 23.34s/epoch, loss=1.13, accuracy=0.757, val_loss=4.08, val_accuracy=0.368, lr=0.1] 51%|█████     | 51/100 [20:42<19:03, 23.34s/epoch, loss=1.12, accuracy=0.757, val_loss=2.87, val_accuracy=0.436, lr=0.1] 52%|█████▏    | 52/100 [21:06<18:46, 23.46s/epoch, loss=1.12, accuracy=0.758, val_loss=2.86, val_accuracy=0.405, lr=0.1] 53%|█████▎    | 53/100 [21:29<18:27, 23.57s/epoch, loss=1.11, accuracy=0.761, val_loss=1.43, val_accuracy=0.641, lr=0.0316] 54%|█████▍    | 54/100 [21:53<18:04, 23.57s/epoch, loss=1.12, accuracy=0.757, val_loss=3.34, val_accuracy=0.411, lr=0.1]    55%|█████▌    | 55/100 [22:17<17:47, 23.72s/epoch, loss=1.13, accuracy=0.756, val_loss=2.18, val_accuracy=0.357, lr=0.1] 56%|█████▌    | 56/100 [22:41<17:25, 23.77s/epoch, loss=1.12, accuracy=0.757, val_loss=4.06, val_accuracy=0.321, lr=0.1] 57%|█████▋    | 57/100 [23:04<16:53, 23.57s/epoch, loss=1.12, accuracy=0.757, val_loss=2.07, val_accuracy=0.498, lr=0.1] 58%|█████▊    | 58/100 [23:27<16:28, 23.54s/epoch, loss=1.12, accuracy=0.758, val_loss=2.05, val_accuracy=0.484, lr=0.0316] 59%|█████▉    | 59/100 [23:51<16:05, 23.55s/epoch, loss=1.12, accuracy=0.759, val_loss=2.32, val_accuracy=0.462, lr=0.1]    60%|██████    | 60/100 [24:15<15:42, 23.55s/epoch, loss=1.12, accuracy=0.757, val_loss=1.71, val_accuracy=0.612, lr=0.1] 61%|██████    | 61/100 [24:38<15:16, 23.49s/epoch, loss=1.12, accuracy=0.758, val_loss=1.74, val_accuracy=0.533, lr=0.1] 62%|██████▏   | 62/100 [25:02<14:56, 23.60s/epoch, loss=1.12, accuracy=0.756, val_loss=1.77, val_accuracy=0.532, lr=0.1] 63%|██████▎   | 63/100 [25:25<14:32, 23.57s/epoch, loss=1.11, accuracy=0.759, val_loss=1.6, val_accuracy=0.58, lr=0.0316] 64%|██████▍   | 64/100 [25:49<14:08, 23.57s/epoch, loss=1.12, accuracy=0.756, val_loss=1.47, val_accuracy=0.623, lr=0.1]  65%|██████▌   | 65/100 [26:12<13:43, 23.53s/epoch, loss=1.12, accuracy=0.757, val_loss=2.25, val_accuracy=0.452, lr=0.1] 66%|██████▌   | 66/100 [26:36<13:21, 23.58s/epoch, loss=1.12, accuracy=0.759, val_loss=2.46, val_accuracy=0.416, lr=0.1] 67%|██████▋   | 67/100 [27:00<12:57, 23.56s/epoch, loss=1.12, accuracy=0.759, val_loss=2.79, val_accuracy=0.358, lr=0.1] 68%|██████▊   | 68/100 [27:23<12:32, 23.52s/epoch, loss=1.11, accuracy=0.761, val_loss=1.63, val_accuracy=0.591, lr=0.0316] 69%|██████▉   | 69/100 [27:47<12:09, 23.54s/epoch, loss=1.11, accuracy=0.76, val_loss=1.62, val_accuracy=0.586, lr=0.1]     70%|███████   | 70/100 [28:10<11:46, 23.54s/epoch, loss=1.12, accuracy=0.759, val_loss=1.69, val_accuracy=0.556, lr=0.1] 71%|███████   | 71/100 [28:33<11:20, 23.46s/epoch, loss=1.12, accuracy=0.759, val_loss=5.24, val_accuracy=0.261, lr=0.1] 72%|███████▏  | 72/100 [28:57<10:56, 23.43s/epoch, loss=1.12, accuracy=0.757, val_loss=2.54, val_accuracy=0.504, lr=0.1] 73%|███████▎  | 73/100 [29:21<10:35, 23.55s/epoch, loss=1.12, accuracy=0.758, val_loss=3.11, val_accuracy=0.396, lr=0.0316] 74%|███████▍  | 74/100 [29:44<10:13, 23.61s/epoch, loss=1.12, accuracy=0.757, val_loss=2.15, val_accuracy=0.482, lr=0.1]    75%|███████▌  | 75/100 [30:08<09:51, 23.64s/epoch, loss=1.12, accuracy=0.754, val_loss=2.18, val_accuracy=0.529, lr=0.1] 76%|███████▌  | 76/100 [30:32<09:27, 23.66s/epoch, loss=1.12, accuracy=0.758, val_loss=1.49, val_accuracy=0.627, lr=0.1] 77%|███████▋  | 77/100 [30:55<09:03, 23.61s/epoch, loss=1.12, accuracy=0.759, val_loss=1.6, val_accuracy=0.614, lr=0.1]  78%|███████▊  | 78/100 [31:19<08:38, 23.59s/epoch, loss=1.12, accuracy=0.759, val_loss=1.76, val_accuracy=0.559, lr=0.0316] 79%|███████▉  | 79/100 [31:42<08:15, 23.58s/epoch, loss=1.12, accuracy=0.758, val_loss=3.57, val_accuracy=0.3, lr=0.1]      80%|████████  | 80/100 [32:06<07:54, 23.71s/epoch, loss=1.11, accuracy=0.757, val_loss=1.99, val_accuracy=0.549, lr=0.1] 81%|████████  | 81/100 [32:29<07:27, 23.55s/epoch, loss=1.12, accuracy=0.755, val_loss=2, val_accuracy=0.484, lr=0.1]    82%|████████▏ | 82/100 [32:53<07:05, 23.63s/epoch, loss=0.918, accuracy=0.815, val_loss=0.883, val_accuracy=0.816, lr=0.01] 83%|████████▎ | 83/100 [33:17<06:40, 23.53s/epoch, loss=0.728, accuracy=0.848, val_loss=0.861, val_accuracy=0.792, lr=0.01] 84%|████████▍ | 84/100 [33:40<06:16, 23.54s/epoch, loss=0.647, accuracy=0.858, val_loss=1.3, val_accuracy=0.684, lr=0.01]   85%|████████▌ | 85/100 [34:04<05:53, 23.55s/epoch, loss=0.598, accuracy=0.863, val_loss=0.852, val_accuracy=0.783, lr=0.01] 86%|████████▌ | 86/100 [34:27<05:28, 23.43s/epoch, loss=0.575, accuracy=0.864, val_loss=0.878, val_accuracy=0.769, lr=0.01] 87%|████████▋ | 87/100 [34:50<05:02, 23.26s/epoch, loss=0.565, accuracy=0.865, val_loss=0.906, val_accuracy=0.761, lr=0.01] 88%|████████▊ | 88/100 [35:13<04:39, 23.33s/epoch, loss=0.562, accuracy=0.864, val_loss=0.696, val_accuracy=0.822, lr=0.01] 89%|████████▉ | 89/100 [35:37<04:17, 23.43s/epoch, loss=0.561, accuracy=0.865, val_loss=0.772, val_accuracy=0.797, lr=0.01] 90%|█████████ | 90/100 [36:00<03:54, 23.44s/epoch, loss=0.556, accuracy=0.868, val_loss=0.792, val_accuracy=0.799, lr=0.01] 91%|█████████ | 91/100 [36:24<03:31, 23.46s/epoch, loss=0.554, accuracy=0.869, val_loss=0.754, val_accuracy=0.8, lr=0.01]   92%|█████████▏| 92/100 [36:47<03:07, 23.46s/epoch, loss=0.553, accuracy=0.872, val_loss=0.975, val_accuracy=0.743, lr=0.01] 93%|█████████▎| 93/100 [37:11<02:44, 23.45s/epoch, loss=0.554, accuracy=0.87, val_loss=0.759, val_accuracy=0.809, lr=0.00316] 94%|█████████▍| 94/100 [37:34<02:19, 23.31s/epoch, loss=0.551, accuracy=0.873, val_loss=1.01, val_accuracy=0.723, lr=0.01]    95%|█████████▌| 95/100 [37:57<01:56, 23.38s/epoch, loss=0.548, accuracy=0.874, val_loss=0.891, val_accuracy=0.771, lr=0.01] 96%|█████████▌| 96/100 [38:21<01:33, 23.45s/epoch, loss=0.548, accuracy=0.875, val_loss=0.76, val_accuracy=0.808, lr=0.01]  97%|█████████▋| 97/100 [38:45<01:10, 23.51s/epoch, loss=0.545, accuracy=0.878, val_loss=1.14, val_accuracy=0.716, lr=0.01] 98%|█████████▊| 98/100 [39:08<00:46, 23.41s/epoch, loss=0.548, accuracy=0.876, val_loss=0.83, val_accuracy=0.797, lr=0.00316] 99%|█████████▉| 99/100 [39:31<00:23, 23.38s/epoch, loss=0.549, accuracy=0.876, val_loss=0.739, val_accuracy=0.819, lr=0.01]  100%|██████████| 100/100 [39:55<00:00, 23.42s/epoch, loss=0.548, accuracy=0.877, val_loss=1.04, val_accuracy=0.733, lr=0.01]100%|██████████| 100/100 [39:55<00:00, 23.95s/epoch, loss=0.548, accuracy=0.877, val_loss=1.04, val_accuracy=0.733, lr=0.01]
Using real-time data augmentation.
Test loss: 1.0424373149871826
Test accuracy: 0.7330999970436096


* * * Run SGD for ID = 15_12. * * *


2024-02-15 20:40:05.491700: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 20:40:08.243119: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 20:40:08.244168: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-15 20:40:08.287870: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 20:40:08.287909: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 20:40:08.290932: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 20:40:08.290994: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 20:40:08.293177: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 20:40:08.293821: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 20:40:08.296165: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 20:40:08.297678: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 20:40:08.302271: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 20:40:08.302842: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 20:40:08.303147: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 20:40:09.559475: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-15 20:40:09.560033: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 20:40:09.560502: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 20:40:09.560534: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 20:40:09.560565: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 20:40:09.560583: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 20:40:09.560599: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 20:40:09.560616: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 20:40:09.560632: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 20:40:09.560648: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 20:40:09.560665: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 20:40:09.561195: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 20:40:09.561231: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 20:40:10.218510: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-15 20:40:10.218562: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-15 20:40:10.218572: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-15 20:40:10.219518: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:02:00.0, compute capability: 6.1)
{'id': 1512, 'batch_size': 128, 'epochs': 100, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/100 [00:00<?, ?epoch/s]2024-02-15 20:40:11.023793: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-15 20:40:11.035922: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199950000 Hz
2024-02-15 20:40:13.009477: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 20:40:13.308954: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 20:40:14.123716: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-15 20:40:14.205913: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/100 [01:00<1:39:11, 60.12s/epoch, loss=3.3, accuracy=0.276, val_loss=2.56, val_accuracy=0.164, lr=0.1]  2%|▏         | 2/100 [01:23<1:03:14, 38.72s/epoch, loss=1.71, accuracy=0.447, val_loss=2.32, val_accuracy=0.28, lr=0.1]  3%|▎         | 3/100 [01:47<51:21, 31.77s/epoch, loss=1.5, accuracy=0.55, val_loss=1.82, val_accuracy=0.484, lr=0.1]     4%|▍         | 4/100 [02:10<45:38, 28.52s/epoch, loss=1.34, accuracy=0.649, val_loss=3.9, val_accuracy=0.206, lr=0.1]  5%|▌         | 5/100 [02:34<42:19, 26.73s/epoch, loss=1.29, accuracy=0.684, val_loss=2.08, val_accuracy=0.454, lr=0.1]  6%|▌         | 6/100 [02:57<40:05, 25.59s/epoch, loss=1.26, accuracy=0.703, val_loss=1.63, val_accuracy=0.567, lr=0.1]  7%|▋         | 7/100 [03:20<38:25, 24.79s/epoch, loss=1.24, accuracy=0.714, val_loss=1.97, val_accuracy=0.535, lr=0.1]  8%|▊         | 8/100 [03:44<37:25, 24.41s/epoch, loss=1.23, accuracy=0.721, val_loss=2.56, val_accuracy=0.412, lr=0.1]  9%|▉         | 9/100 [04:08<36:34, 24.12s/epoch, loss=1.22, accuracy=0.726, val_loss=1.92, val_accuracy=0.529, lr=0.1] 10%|█         | 10/100 [04:31<35:56, 23.96s/epoch, loss=1.22, accuracy=0.727, val_loss=2.54, val_accuracy=0.41, lr=0.1] 11%|█         | 11/100 [04:55<35:28, 23.92s/epoch, loss=1.21, accuracy=0.729, val_loss=2.06, val_accuracy=0.502, lr=0.0316] 12%|█▏        | 12/100 [05:19<34:55, 23.81s/epoch, loss=1.21, accuracy=0.73, val_loss=1.74, val_accuracy=0.537, lr=0.1]     13%|█▎        | 13/100 [05:42<34:25, 23.75s/epoch, loss=1.21, accuracy=0.734, val_loss=2.43, val_accuracy=0.477, lr=0.1] 14%|█▍        | 14/100 [06:06<33:52, 23.64s/epoch, loss=1.21, accuracy=0.735, val_loss=1.92, val_accuracy=0.537, lr=0.1] 15%|█▌        | 15/100 [06:29<33:23, 23.57s/epoch, loss=1.2, accuracy=0.737, val_loss=3.09, val_accuracy=0.432, lr=0.1]  16%|█▌        | 16/100 [06:53<33:09, 23.68s/epoch, loss=1.21, accuracy=0.735, val_loss=1.77, val_accuracy=0.534, lr=0.0316] 17%|█▋        | 17/100 [07:16<32:42, 23.64s/epoch, loss=1.21, accuracy=0.735, val_loss=3.89, val_accuracy=0.219, lr=0.1]    18%|█▊        | 18/100 [07:40<32:14, 23.59s/epoch, loss=1.19, accuracy=0.74, val_loss=1.79, val_accuracy=0.532, lr=0.1]  19%|█▉        | 19/100 [08:04<31:52, 23.61s/epoch, loss=1.19, accuracy=0.74, val_loss=1.88, val_accuracy=0.535, lr=0.1] 20%|██        | 20/100 [08:27<31:27, 23.59s/epoch, loss=1.19, accuracy=0.741, val_loss=1.41, val_accuracy=0.667, lr=0.1] 21%|██        | 21/100 [08:51<31:06, 23.62s/epoch, loss=1.18, accuracy=0.744, val_loss=1.92, val_accuracy=0.479, lr=0.1] 22%|██▏       | 22/100 [09:14<30:37, 23.56s/epoch, loss=1.18, accuracy=0.74, val_loss=2.66, val_accuracy=0.357, lr=0.1]  23%|██▎       | 23/100 [09:38<30:12, 23.54s/epoch, loss=1.18, accuracy=0.742, val_loss=2.64, val_accuracy=0.308, lr=0.1] 24%|██▍       | 24/100 [10:01<29:48, 23.54s/epoch, loss=1.18, accuracy=0.744, val_loss=1.61, val_accuracy=0.601, lr=0.1] 25%|██▌       | 25/100 [10:25<29:28, 23.58s/epoch, loss=1.18, accuracy=0.744, val_loss=3.75, val_accuracy=0.24, lr=0.0316] 26%|██▌       | 26/100 [10:48<29:05, 23.58s/epoch, loss=1.17, accuracy=0.743, val_loss=1.83, val_accuracy=0.58, lr=0.1]    27%|██▋       | 27/100 [11:12<28:46, 23.65s/epoch, loss=1.17, accuracy=0.744, val_loss=1.92, val_accuracy=0.507, lr=0.1] 28%|██▊       | 28/100 [11:36<28:22, 23.64s/epoch, loss=1.18, accuracy=0.745, val_loss=1.55, val_accuracy=0.615, lr=0.1] 29%|██▉       | 29/100 [12:00<28:01, 23.68s/epoch, loss=1.18, accuracy=0.745, val_loss=2.18, val_accuracy=0.474, lr=0.1] 30%|███       | 30/100 [12:24<27:44, 23.78s/epoch, loss=1.17, accuracy=0.747, val_loss=1.69, val_accuracy=0.581, lr=0.0316] 31%|███       | 31/100 [12:48<27:24, 23.83s/epoch, loss=1.17, accuracy=0.746, val_loss=1.7, val_accuracy=0.565, lr=0.1]     32%|███▏      | 32/100 [13:12<27:08, 23.95s/epoch, loss=1.17, accuracy=0.746, val_loss=1.62, val_accuracy=0.571, lr=0.1] 33%|███▎      | 33/100 [13:36<26:39, 23.88s/epoch, loss=1.16, accuracy=0.746, val_loss=2.14, val_accuracy=0.47, lr=0.1]  34%|███▍      | 34/100 [13:59<26:12, 23.82s/epoch, loss=1.17, accuracy=0.746, val_loss=1.76, val_accuracy=0.532, lr=0.1] 35%|███▌      | 35/100 [14:23<25:44, 23.76s/epoch, loss=1.16, accuracy=0.746, val_loss=2.16, val_accuracy=0.432, lr=0.0316] 36%|███▌      | 36/100 [14:47<25:18, 23.72s/epoch, loss=1.16, accuracy=0.749, val_loss=2.35, val_accuracy=0.397, lr=0.1]    37%|███▋      | 37/100 [15:10<24:52, 23.68s/epoch, loss=1.16, accuracy=0.748, val_loss=1.86, val_accuracy=0.533, lr=0.1] 38%|███▊      | 38/100 [15:34<24:30, 23.71s/epoch, loss=1.16, accuracy=0.749, val_loss=7.16, val_accuracy=0.193, lr=0.1] 39%|███▉      | 39/100 [15:58<24:06, 23.71s/epoch, loss=1.16, accuracy=0.749, val_loss=1.5, val_accuracy=0.615, lr=0.1]  40%|████      | 40/100 [16:21<23:38, 23.64s/epoch, loss=1.17, accuracy=0.748, val_loss=2.73, val_accuracy=0.401, lr=0.0316] 41%|████      | 41/100 [16:44<23:09, 23.56s/epoch, loss=1.16, accuracy=0.75, val_loss=3.1, val_accuracy=0.328, lr=0.1]      42%|████▏     | 42/100 [17:08<22:49, 23.61s/epoch, loss=1.15, accuracy=0.751, val_loss=2.07, val_accuracy=0.508, lr=0.1] 43%|████▎     | 43/100 [17:32<22:32, 23.72s/epoch, loss=1.17, accuracy=0.745, val_loss=1.84, val_accuracy=0.561, lr=0.1] 44%|████▍     | 44/100 [17:56<22:08, 23.72s/epoch, loss=1.16, accuracy=0.75, val_loss=1.63, val_accuracy=0.589, lr=0.1]  45%|████▌     | 45/100 [18:20<21:47, 23.77s/epoch, loss=1.15, accuracy=0.752, val_loss=2.77, val_accuracy=0.38, lr=0.0316] 46%|████▌     | 46/100 [18:43<21:19, 23.70s/epoch, loss=1.16, accuracy=0.75, val_loss=1.69, val_accuracy=0.56, lr=0.1]     47%|████▋     | 47/100 [19:07<20:54, 23.67s/epoch, loss=1.15, accuracy=0.75, val_loss=1.92, val_accuracy=0.527, lr=0.1] 48%|████▊     | 48/100 [19:31<20:30, 23.65s/epoch, loss=1.15, accuracy=0.752, val_loss=1.93, val_accuracy=0.516, lr=0.1] 49%|████▉     | 49/100 [19:54<20:02, 23.58s/epoch, loss=1.16, accuracy=0.748, val_loss=2.47, val_accuracy=0.458, lr=0.1] 50%|█████     | 50/100 [20:18<19:44, 23.69s/epoch, loss=1.15, accuracy=0.752, val_loss=1.73, val_accuracy=0.546, lr=0.0316] 51%|█████     | 51/100 [20:42<19:20, 23.68s/epoch, loss=1.15, accuracy=0.75, val_loss=1.58, val_accuracy=0.587, lr=0.1]     52%|█████▏    | 52/100 [21:06<19:03, 23.82s/epoch, loss=1.14, accuracy=0.754, val_loss=1.47, val_accuracy=0.645, lr=0.1] 53%|█████▎    | 53/100 [21:29<18:34, 23.72s/epoch, loss=1.15, accuracy=0.753, val_loss=1.97, val_accuracy=0.492, lr=0.1] 54%|█████▍    | 54/100 [21:53<18:07, 23.63s/epoch, loss=1.15, accuracy=0.75, val_loss=2.14, val_accuracy=0.478, lr=0.1]  55%|█████▌    | 55/100 [22:16<17:43, 23.63s/epoch, loss=1.14, accuracy=0.755, val_loss=1.89, val_accuracy=0.543, lr=0.0316] 56%|█████▌    | 56/100 [22:39<17:14, 23.51s/epoch, loss=1.15, accuracy=0.754, val_loss=1.8, val_accuracy=0.622, lr=0.1]     57%|█████▋    | 57/100 [23:03<16:48, 23.46s/epoch, loss=1.15, accuracy=0.755, val_loss=2.09, val_accuracy=0.474, lr=0.1] 58%|█████▊    | 58/100 [23:26<16:23, 23.42s/epoch, loss=1.15, accuracy=0.752, val_loss=1.58, val_accuracy=0.591, lr=0.1] 59%|█████▉    | 59/100 [23:50<16:06, 23.58s/epoch, loss=1.15, accuracy=0.752, val_loss=1.87, val_accuracy=0.535, lr=0.1] 60%|██████    | 60/100 [24:14<15:46, 23.67s/epoch, loss=1.14, accuracy=0.755, val_loss=1.47, val_accuracy=0.627, lr=0.0316] 61%|██████    | 61/100 [24:38<15:23, 23.67s/epoch, loss=1.15, accuracy=0.751, val_loss=1.53, val_accuracy=0.615, lr=0.1]    62%|██████▏   | 62/100 [25:02<15:02, 23.76s/epoch, loss=1.15, accuracy=0.755, val_loss=1.95, val_accuracy=0.516, lr=0.1] 63%|██████▎   | 63/100 [25:25<14:33, 23.62s/epoch, loss=1.15, accuracy=0.754, val_loss=3.72, val_accuracy=0.401, lr=0.1] 64%|██████▍   | 64/100 [25:49<14:13, 23.70s/epoch, loss=1.13, accuracy=0.755, val_loss=1.98, val_accuracy=0.524, lr=0.1] 65%|██████▌   | 65/100 [26:12<13:48, 23.66s/epoch, loss=1.15, accuracy=0.753, val_loss=1.87, val_accuracy=0.543, lr=0.0316] 66%|██████▌   | 66/100 [26:36<13:21, 23.57s/epoch, loss=1.15, accuracy=0.752, val_loss=1.93, val_accuracy=0.508, lr=0.1]    67%|██████▋   | 67/100 [26:59<12:57, 23.57s/epoch, loss=1.14, accuracy=0.753, val_loss=3.06, val_accuracy=0.322, lr=0.1] 68%|██████▊   | 68/100 [27:23<12:36, 23.65s/epoch, loss=1.14, accuracy=0.754, val_loss=2.65, val_accuracy=0.43, lr=0.1]  69%|██████▉   | 69/100 [27:46<12:09, 23.55s/epoch, loss=1.14, accuracy=0.752, val_loss=1.48, val_accuracy=0.627, lr=0.1] 70%|███████   | 70/100 [28:10<11:47, 23.59s/epoch, loss=1.14, accuracy=0.755, val_loss=1.74, val_accuracy=0.593, lr=0.0316] 71%|███████   | 71/100 [28:34<11:24, 23.59s/epoch, loss=1.14, accuracy=0.753, val_loss=2.8, val_accuracy=0.359, lr=0.1]     72%|███████▏  | 72/100 [28:57<10:59, 23.54s/epoch, loss=1.14, accuracy=0.755, val_loss=2.31, val_accuracy=0.489, lr=0.1] 73%|███████▎  | 73/100 [29:21<10:34, 23.51s/epoch, loss=1.14, accuracy=0.754, val_loss=2.29, val_accuracy=0.404, lr=0.1] 74%|███████▍  | 74/100 [29:44<10:13, 23.61s/epoch, loss=1.14, accuracy=0.754, val_loss=2.27, val_accuracy=0.488, lr=0.1] 75%|███████▌  | 75/100 [30:08<09:51, 23.66s/epoch, loss=1.14, accuracy=0.754, val_loss=2.45, val_accuracy=0.402, lr=0.0316] 76%|███████▌  | 76/100 [30:32<09:27, 23.64s/epoch, loss=1.13, accuracy=0.754, val_loss=1.4, val_accuracy=0.671, lr=0.1]     77%|███████▋  | 77/100 [30:55<09:01, 23.56s/epoch, loss=1.14, accuracy=0.753, val_loss=2.01, val_accuracy=0.536, lr=0.1] 78%|███████▊  | 78/100 [31:18<08:36, 23.46s/epoch, loss=1.14, accuracy=0.756, val_loss=2.26, val_accuracy=0.435, lr=0.1] 79%|███████▉  | 79/100 [31:42<08:14, 23.55s/epoch, loss=1.14, accuracy=0.757, val_loss=1.66, val_accuracy=0.584, lr=0.1] 80%|████████  | 80/100 [32:06<07:51, 23.58s/epoch, loss=1.14, accuracy=0.756, val_loss=1.65, val_accuracy=0.596, lr=0.1] 81%|████████  | 81/100 [32:29<07:26, 23.48s/epoch, loss=1.13, accuracy=0.755, val_loss=2.12, val_accuracy=0.468, lr=0.0316] 82%|████████▏ | 82/100 [32:53<07:03, 23.54s/epoch, loss=0.927, accuracy=0.814, val_loss=0.91, val_accuracy=0.804, lr=0.01]  83%|████████▎ | 83/100 [33:16<06:41, 23.61s/epoch, loss=0.739, accuracy=0.849, val_loss=0.796, val_accuracy=0.815, lr=0.01] 84%|████████▍ | 84/100 [33:40<06:18, 23.66s/epoch, loss=0.657, accuracy=0.855, val_loss=0.787, val_accuracy=0.804, lr=0.01] 85%|████████▌ | 85/100 [34:04<05:55, 23.69s/epoch, loss=0.611, accuracy=0.858, val_loss=0.763, val_accuracy=0.806, lr=0.01] 86%|████████▌ | 86/100 [34:27<05:30, 23.60s/epoch, loss=0.592, accuracy=0.859, val_loss=0.779, val_accuracy=0.803, lr=0.01] 87%|████████▋ | 87/100 [34:51<05:05, 23.47s/epoch, loss=0.581, accuracy=0.862, val_loss=0.938, val_accuracy=0.757, lr=0.01] 88%|████████▊ | 88/100 [35:14<04:41, 23.47s/epoch, loss=0.573, accuracy=0.864, val_loss=0.813, val_accuracy=0.794, lr=0.01] 89%|████████▉ | 89/100 [35:37<04:17, 23.42s/epoch, loss=0.568, accuracy=0.865, val_loss=0.845, val_accuracy=0.784, lr=0.01] 90%|█████████ | 90/100 [36:01<03:54, 23.47s/epoch, loss=0.563, accuracy=0.866, val_loss=0.842, val_accuracy=0.776, lr=0.00316] 91%|█████████ | 91/100 [36:25<03:32, 23.64s/epoch, loss=0.569, accuracy=0.867, val_loss=0.86, val_accuracy=0.787, lr=0.01]     92%|█████████▏| 92/100 [36:49<03:08, 23.61s/epoch, loss=0.563, accuracy=0.869, val_loss=1.28, val_accuracy=0.678, lr=0.01] 93%|█████████▎| 93/100 [37:12<02:45, 23.69s/epoch, loss=0.564, accuracy=0.869, val_loss=1.04, val_accuracy=0.728, lr=0.01] 94%|█████████▍| 94/100 [37:36<02:21, 23.62s/epoch, loss=0.564, accuracy=0.871, val_loss=0.758, val_accuracy=0.812, lr=0.01] 95%|█████████▌| 95/100 [37:59<01:57, 23.57s/epoch, loss=0.564, accuracy=0.872, val_loss=0.744, val_accuracy=0.808, lr=0.01] 96%|█████████▌| 96/100 [38:23<01:34, 23.51s/epoch, loss=0.561, accuracy=0.873, val_loss=0.741, val_accuracy=0.815, lr=0.01] 97%|█████████▋| 97/100 [38:46<01:10, 23.50s/epoch, loss=0.561, accuracy=0.874, val_loss=0.821, val_accuracy=0.799, lr=0.01] 98%|█████████▊| 98/100 [39:09<00:46, 23.39s/epoch, loss=0.558, accuracy=0.874, val_loss=0.875, val_accuracy=0.781, lr=0.01] 99%|█████████▉| 99/100 [39:33<00:23, 23.39s/epoch, loss=0.567, accuracy=0.873, val_loss=1.05, val_accuracy=0.754, lr=0.01] 100%|██████████| 100/100 [39:56<00:00, 23.49s/epoch, loss=0.564, accuracy=0.875, val_loss=0.761, val_accuracy=0.817, lr=0.01]100%|██████████| 100/100 [39:56<00:00, 23.97s/epoch, loss=0.564, accuracy=0.875, val_loss=0.761, val_accuracy=0.817, lr=0.01]
Using real-time data augmentation.
Test loss: 0.7614912390708923
Test accuracy: 0.8166000247001648


* * * Run SGD for ID = 15_13. * * *


2024-02-15 21:20:11.211323: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 21:20:18.991300: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 21:20:18.992434: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-15 21:20:19.031958: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 21:20:19.031991: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 21:20:19.036980: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 21:20:19.037021: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 21:20:19.040545: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 21:20:19.042532: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 21:20:19.046094: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 21:20:19.049322: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 21:20:19.055735: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 21:20:19.056269: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 21:20:19.056362: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 21:20:20.283075: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-15 21:20:20.284100: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 21:20:20.284778: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 21:20:20.284813: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 21:20:20.284867: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 21:20:20.284889: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 21:20:20.284909: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 21:20:20.284928: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 21:20:20.284948: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 21:20:20.284969: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 21:20:20.284988: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 21:20:20.285444: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 21:20:20.285479: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 21:20:20.918730: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-15 21:20:20.918791: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-15 21:20:20.918803: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-15 21:20:20.920094: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:02:00.0, compute capability: 6.1)
{'id': 1513, 'batch_size': 128, 'epochs': 100, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/100 [00:00<?, ?epoch/s]2024-02-15 21:20:21.694743: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-15 21:20:21.706798: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199950000 Hz
2024-02-15 21:20:23.627255: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 21:20:23.885461: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 21:20:24.707573: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-15 21:20:24.753035: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/100 [01:01<1:41:47, 61.70s/epoch, loss=3.23, accuracy=0.285, val_loss=2.15, val_accuracy=0.24, lr=0.1]  2%|▏         | 2/100 [01:25<1:04:22, 39.41s/epoch, loss=1.69, accuracy=0.457, val_loss=2.78, val_accuracy=0.273, lr=0.1]  3%|▎         | 3/100 [01:49<52:07, 32.24s/epoch, loss=1.45, accuracy=0.579, val_loss=3.2, val_accuracy=0.363, lr=0.1]     4%|▍         | 4/100 [02:12<46:08, 28.84s/epoch, loss=1.32, accuracy=0.658, val_loss=1.69, val_accuracy=0.511, lr=0.1]  5%|▌         | 5/100 [02:36<42:45, 27.01s/epoch, loss=1.27, accuracy=0.693, val_loss=1.92, val_accuracy=0.538, lr=0.1]  6%|▌         | 6/100 [03:00<40:43, 26.00s/epoch, loss=1.25, accuracy=0.709, val_loss=1.44, val_accuracy=0.637, lr=0.1]  7%|▋         | 7/100 [03:24<39:15, 25.33s/epoch, loss=1.23, accuracy=0.717, val_loss=1.82, val_accuracy=0.533, lr=0.1]  8%|▊         | 8/100 [03:48<38:01, 24.79s/epoch, loss=1.23, accuracy=0.719, val_loss=2.03, val_accuracy=0.486, lr=0.1]  9%|▉         | 9/100 [04:11<37:06, 24.47s/epoch, loss=1.24, accuracy=0.723, val_loss=2.3, val_accuracy=0.499, lr=0.1]  10%|█         | 10/100 [04:35<36:19, 24.22s/epoch, loss=1.23, accuracy=0.727, val_loss=2.41, val_accuracy=0.436, lr=0.1] 11%|█         | 11/100 [04:59<35:46, 24.12s/epoch, loss=1.22, accuracy=0.728, val_loss=2.27, val_accuracy=0.443, lr=0.0316] 12%|█▏        | 12/100 [05:23<35:07, 23.95s/epoch, loss=1.22, accuracy=0.733, val_loss=1.73, val_accuracy=0.578, lr=0.1]    13%|█▎        | 13/100 [05:46<34:39, 23.90s/epoch, loss=1.22, accuracy=0.733, val_loss=2.78, val_accuracy=0.404, lr=0.1] 14%|█▍        | 14/100 [06:10<34:08, 23.82s/epoch, loss=1.21, accuracy=0.736, val_loss=2.26, val_accuracy=0.511, lr=0.1] 15%|█▌        | 15/100 [06:34<33:39, 23.76s/epoch, loss=1.21, accuracy=0.735, val_loss=1.74, val_accuracy=0.568, lr=0.1] 16%|█▌        | 16/100 [06:58<33:18, 23.79s/epoch, loss=1.2, accuracy=0.737, val_loss=2.6, val_accuracy=0.39, lr=0.0316] 17%|█▋        | 17/100 [07:21<32:57, 23.82s/epoch, loss=1.2, accuracy=0.735, val_loss=1.88, val_accuracy=0.578, lr=0.1]  18%|█▊        | 18/100 [07:45<32:38, 23.89s/epoch, loss=1.2, accuracy=0.738, val_loss=1.71, val_accuracy=0.569, lr=0.1] 19%|█▉        | 19/100 [08:09<32:04, 23.76s/epoch, loss=1.2, accuracy=0.738, val_loss=2.91, val_accuracy=0.279, lr=0.1] 20%|██        | 20/100 [08:33<31:49, 23.87s/epoch, loss=1.2, accuracy=0.739, val_loss=1.72, val_accuracy=0.564, lr=0.1] 21%|██        | 21/100 [08:57<31:22, 23.83s/epoch, loss=1.2, accuracy=0.742, val_loss=1.61, val_accuracy=0.581, lr=0.0316] 22%|██▏       | 22/100 [09:20<30:52, 23.74s/epoch, loss=1.19, accuracy=0.742, val_loss=1.37, val_accuracy=0.669, lr=0.1]   23%|██▎       | 23/100 [09:44<30:36, 23.85s/epoch, loss=1.19, accuracy=0.741, val_loss=2.19, val_accuracy=0.456, lr=0.1] 24%|██▍       | 24/100 [10:09<30:19, 23.94s/epoch, loss=1.19, accuracy=0.743, val_loss=1.98, val_accuracy=0.445, lr=0.1] 25%|██▌       | 25/100 [10:33<30:02, 24.03s/epoch, loss=1.19, accuracy=0.743, val_loss=1.47, val_accuracy=0.646, lr=0.1] 26%|██▌       | 26/100 [10:57<29:39, 24.04s/epoch, loss=1.19, accuracy=0.743, val_loss=1.76, val_accuracy=0.565, lr=0.1] 27%|██▋       | 27/100 [11:21<29:09, 23.96s/epoch, loss=1.18, accuracy=0.744, val_loss=1.65, val_accuracy=0.577, lr=0.0316] 28%|██▊       | 28/100 [11:44<28:37, 23.85s/epoch, loss=1.19, accuracy=0.745, val_loss=1.64, val_accuracy=0.616, lr=0.1]    29%|██▉       | 29/100 [12:08<28:16, 23.90s/epoch, loss=1.18, accuracy=0.745, val_loss=2.28, val_accuracy=0.497, lr=0.1] 30%|███       | 30/100 [12:32<27:54, 23.92s/epoch, loss=1.18, accuracy=0.743, val_loss=1.57, val_accuracy=0.584, lr=0.1] 31%|███       | 31/100 [12:56<27:28, 23.89s/epoch, loss=1.18, accuracy=0.743, val_loss=1.58, val_accuracy=0.613, lr=0.1] 32%|███▏      | 32/100 [13:20<27:08, 23.95s/epoch, loss=1.18, accuracy=0.745, val_loss=1.57, val_accuracy=0.633, lr=0.0316] 33%|███▎      | 33/100 [13:44<26:51, 24.05s/epoch, loss=1.18, accuracy=0.746, val_loss=1.31, val_accuracy=0.699, lr=0.1]    34%|███▍      | 34/100 [14:08<26:23, 24.00s/epoch, loss=1.18, accuracy=0.745, val_loss=1.89, val_accuracy=0.519, lr=0.1] 35%|███▌      | 35/100 [14:32<26:01, 24.03s/epoch, loss=1.17, accuracy=0.747, val_loss=1.82, val_accuracy=0.566, lr=0.1] 36%|███▌      | 36/100 [14:56<25:33, 23.96s/epoch, loss=1.17, accuracy=0.744, val_loss=1.49, val_accuracy=0.634, lr=0.1] 37%|███▋      | 37/100 [15:20<25:08, 23.95s/epoch, loss=1.18, accuracy=0.745, val_loss=2.06, val_accuracy=0.478, lr=0.1] 38%|███▊      | 38/100 [15:44<24:46, 23.98s/epoch, loss=1.17, accuracy=0.75, val_loss=2.62, val_accuracy=0.444, lr=0.0316] 39%|███▉      | 39/100 [16:09<24:32, 24.14s/epoch, loss=1.17, accuracy=0.748, val_loss=1.44, val_accuracy=0.644, lr=0.1]   40%|████      | 40/100 [16:33<24:03, 24.06s/epoch, loss=1.17, accuracy=0.748, val_loss=3.84, val_accuracy=0.292, lr=0.1] 41%|████      | 41/100 [16:56<23:35, 23.99s/epoch, loss=1.17, accuracy=0.747, val_loss=1.99, val_accuracy=0.506, lr=0.1] 42%|████▏     | 42/100 [17:20<23:09, 23.95s/epoch, loss=1.16, accuracy=0.752, val_loss=1.42, val_accuracy=0.664, lr=0.1] 43%|████▎     | 43/100 [17:44<22:46, 23.98s/epoch, loss=1.17, accuracy=0.748, val_loss=1.86, val_accuracy=0.555, lr=0.0316] 44%|████▍     | 44/100 [18:08<22:22, 23.96s/epoch, loss=1.17, accuracy=0.745, val_loss=3.26, val_accuracy=0.352, lr=0.1]    45%|████▌     | 45/100 [18:32<21:54, 23.90s/epoch, loss=1.16, accuracy=0.75, val_loss=2.08, val_accuracy=0.52, lr=0.1]   46%|████▌     | 46/100 [18:55<21:19, 23.70s/epoch, loss=1.16, accuracy=0.75, val_loss=2.65, val_accuracy=0.398, lr=0.1] 47%|████▋     | 47/100 [19:19<21:00, 23.79s/epoch, loss=1.17, accuracy=0.749, val_loss=1.69, val_accuracy=0.576, lr=0.1] 48%|████▊     | 48/100 [19:43<20:40, 23.86s/epoch, loss=1.17, accuracy=0.749, val_loss=3.49, val_accuracy=0.337, lr=0.0316] 49%|████▉     | 49/100 [20:07<20:17, 23.87s/epoch, loss=1.16, accuracy=0.751, val_loss=1.59, val_accuracy=0.604, lr=0.1]    50%|█████     | 50/100 [20:31<19:55, 23.92s/epoch, loss=1.16, accuracy=0.752, val_loss=1.64, val_accuracy=0.575, lr=0.1] 51%|█████     | 51/100 [20:55<19:33, 23.95s/epoch, loss=1.16, accuracy=0.751, val_loss=2.15, val_accuracy=0.532, lr=0.1] 52%|█████▏    | 52/100 [21:19<19:08, 23.93s/epoch, loss=1.16, accuracy=0.75, val_loss=1.78, val_accuracy=0.543, lr=0.1]  53%|█████▎    | 53/100 [21:43<18:45, 23.95s/epoch, loss=1.16, accuracy=0.752, val_loss=1.85, val_accuracy=0.539, lr=0.0316] 54%|█████▍    | 54/100 [22:07<18:19, 23.89s/epoch, loss=1.16, accuracy=0.753, val_loss=2.3, val_accuracy=0.499, lr=0.1]     55%|█████▌    | 55/100 [22:31<17:55, 23.89s/epoch, loss=1.15, accuracy=0.751, val_loss=1.65, val_accuracy=0.579, lr=0.1] 56%|█████▌    | 56/100 [22:55<17:29, 23.86s/epoch, loss=1.14, accuracy=0.756, val_loss=3.05, val_accuracy=0.355, lr=0.1] 57%|█████▋    | 57/100 [23:18<17:03, 23.80s/epoch, loss=1.15, accuracy=0.75, val_loss=2.07, val_accuracy=0.498, lr=0.1]  58%|█████▊    | 58/100 [23:42<16:39, 23.79s/epoch, loss=1.15, accuracy=0.752, val_loss=1.6, val_accuracy=0.622, lr=0.0316] 59%|█████▉    | 59/100 [24:05<16:12, 23.71s/epoch, loss=1.15, accuracy=0.749, val_loss=2.37, val_accuracy=0.466, lr=0.1]   60%|██████    | 60/100 [24:30<15:52, 23.82s/epoch, loss=1.15, accuracy=0.75, val_loss=1.37, val_accuracy=0.673, lr=0.1]  61%|██████    | 61/100 [24:54<15:32, 23.90s/epoch, loss=1.15, accuracy=0.753, val_loss=2.01, val_accuracy=0.491, lr=0.1] 62%|██████▏   | 62/100 [25:17<15:03, 23.79s/epoch, loss=1.15, accuracy=0.753, val_loss=1.66, val_accuracy=0.608, lr=0.1] 63%|██████▎   | 63/100 [25:41<14:39, 23.78s/epoch, loss=1.15, accuracy=0.751, val_loss=2.54, val_accuracy=0.404, lr=0.0316] 64%|██████▍   | 64/100 [26:05<14:16, 23.78s/epoch, loss=1.15, accuracy=0.751, val_loss=1.59, val_accuracy=0.633, lr=0.1]    65%|██████▌   | 65/100 [26:29<13:53, 23.82s/epoch, loss=1.15, accuracy=0.752, val_loss=1.91, val_accuracy=0.489, lr=0.1] 66%|██████▌   | 66/100 [26:52<13:30, 23.83s/epoch, loss=1.14, accuracy=0.754, val_loss=2.15, val_accuracy=0.504, lr=0.1] 67%|██████▋   | 67/100 [27:16<13:06, 23.82s/epoch, loss=1.15, accuracy=0.753, val_loss=1.75, val_accuracy=0.575, lr=0.1] 68%|██████▊   | 68/100 [27:40<12:43, 23.85s/epoch, loss=1.14, accuracy=0.753, val_loss=2.33, val_accuracy=0.45, lr=0.0316] 69%|██████▉   | 69/100 [28:04<12:17, 23.79s/epoch, loss=1.15, accuracy=0.752, val_loss=2.99, val_accuracy=0.387, lr=0.1]   70%|███████   | 70/100 [28:27<11:51, 23.72s/epoch, loss=1.15, accuracy=0.751, val_loss=1.97, val_accuracy=0.489, lr=0.1] 71%|███████   | 71/100 [28:51<11:27, 23.71s/epoch, loss=1.14, accuracy=0.754, val_loss=3.17, val_accuracy=0.394, lr=0.1] 72%|███████▏  | 72/100 [29:15<11:05, 23.76s/epoch, loss=1.15, accuracy=0.753, val_loss=2.41, val_accuracy=0.455, lr=0.1] 73%|███████▎  | 73/100 [29:39<10:45, 23.91s/epoch, loss=1.14, accuracy=0.752, val_loss=1.37, val_accuracy=0.677, lr=0.0316] 74%|███████▍  | 74/100 [30:03<10:18, 23.79s/epoch, loss=1.14, accuracy=0.753, val_loss=2.5, val_accuracy=0.403, lr=0.1]     75%|███████▌  | 75/100 [30:26<09:53, 23.75s/epoch, loss=1.14, accuracy=0.755, val_loss=1.79, val_accuracy=0.546, lr=0.1] 76%|███████▌  | 76/100 [30:50<09:29, 23.71s/epoch, loss=1.15, accuracy=0.751, val_loss=1.49, val_accuracy=0.632, lr=0.1] 77%|███████▋  | 77/100 [31:14<09:09, 23.88s/epoch, loss=1.13, accuracy=0.756, val_loss=1.88, val_accuracy=0.579, lr=0.1] 78%|███████▊  | 78/100 [31:38<08:45, 23.90s/epoch, loss=1.14, accuracy=0.755, val_loss=1.93, val_accuracy=0.536, lr=0.0316] 79%|███████▉  | 79/100 [32:02<08:23, 23.95s/epoch, loss=1.14, accuracy=0.752, val_loss=1.75, val_accuracy=0.54, lr=0.1]     80%|████████  | 80/100 [32:26<07:58, 23.95s/epoch, loss=1.14, accuracy=0.756, val_loss=1.54, val_accuracy=0.626, lr=0.1] 81%|████████  | 81/100 [32:50<07:34, 23.92s/epoch, loss=1.15, accuracy=0.755, val_loss=2.02, val_accuracy=0.517, lr=0.1] 82%|████████▏ | 82/100 [33:14<07:10, 23.90s/epoch, loss=0.929, accuracy=0.815, val_loss=0.898, val_accuracy=0.808, lr=0.01] 83%|████████▎ | 83/100 [33:38<06:46, 23.93s/epoch, loss=0.747, accuracy=0.846, val_loss=0.836, val_accuracy=0.803, lr=0.01] 84%|████████▍ | 84/100 [34:02<06:24, 24.02s/epoch, loss=0.657, accuracy=0.858, val_loss=0.786, val_accuracy=0.814, lr=0.01] 85%|████████▌ | 85/100 [34:26<05:59, 23.99s/epoch, loss=0.615, accuracy=0.858, val_loss=0.863, val_accuracy=0.776, lr=0.01] 86%|████████▌ | 86/100 [34:50<05:35, 23.96s/epoch, loss=0.595, accuracy=0.859, val_loss=0.723, val_accuracy=0.814, lr=0.01] 87%|████████▋ | 87/100 [35:14<05:12, 24.06s/epoch, loss=0.583, accuracy=0.86, val_loss=0.722, val_accuracy=0.818, lr=0.01]  88%|████████▊ | 88/100 [35:38<04:47, 23.97s/epoch, loss=0.575, accuracy=0.863, val_loss=0.778, val_accuracy=0.803, lr=0.01] 89%|████████▉ | 89/100 [36:02<04:23, 23.92s/epoch, loss=0.576, accuracy=0.863, val_loss=0.783, val_accuracy=0.803, lr=0.01] 90%|█████████ | 90/100 [36:26<04:00, 24.03s/epoch, loss=0.568, accuracy=0.868, val_loss=0.824, val_accuracy=0.778, lr=0.01] 91%|█████████ | 91/100 [36:50<03:36, 24.03s/epoch, loss=0.568, accuracy=0.866, val_loss=0.91, val_accuracy=0.765, lr=0.01]  92%|█████████▏| 92/100 [37:14<03:11, 23.98s/epoch, loss=0.57, accuracy=0.866, val_loss=1.43, val_accuracy=0.658, lr=0.00316] 93%|█████████▎| 93/100 [37:38<02:47, 23.99s/epoch, loss=0.566, accuracy=0.868, val_loss=0.681, val_accuracy=0.836, lr=0.01]  94%|█████████▍| 94/100 [38:02<02:23, 23.89s/epoch, loss=0.565, accuracy=0.87, val_loss=0.863, val_accuracy=0.784, lr=0.01]  95%|█████████▌| 95/100 [38:26<01:59, 23.87s/epoch, loss=0.56, accuracy=0.875, val_loss=0.694, val_accuracy=0.83, lr=0.01]  96%|█████████▌| 96/100 [38:49<01:35, 23.85s/epoch, loss=0.565, accuracy=0.872, val_loss=1.31, val_accuracy=0.693, lr=0.01] 97%|█████████▋| 97/100 [39:13<01:11, 23.79s/epoch, loss=0.561, accuracy=0.873, val_loss=0.804, val_accuracy=0.792, lr=0.01] 98%|█████████▊| 98/100 [39:37<00:47, 23.84s/epoch, loss=0.559, accuracy=0.874, val_loss=1.09, val_accuracy=0.725, lr=0.00316] 99%|█████████▉| 99/100 [40:01<00:23, 23.85s/epoch, loss=0.563, accuracy=0.876, val_loss=0.824, val_accuracy=0.796, lr=0.01]  100%|██████████| 100/100 [40:25<00:00, 23.84s/epoch, loss=0.564, accuracy=0.875, val_loss=0.937, val_accuracy=0.774, lr=0.01]100%|██████████| 100/100 [40:25<00:00, 24.25s/epoch, loss=0.564, accuracy=0.875, val_loss=0.937, val_accuracy=0.774, lr=0.01]
Using real-time data augmentation.
Test loss: 0.9368221759796143
Test accuracy: 0.7735999822616577


* * * Run SGD for ID = 15_14. * * *


2024-02-15 22:00:49.812125: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 22:00:52.076546: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 22:00:52.077762: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-15 22:00:52.120038: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 22:00:52.120137: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 22:00:52.123396: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 22:00:52.123444: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 22:00:52.125827: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 22:00:52.126442: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 22:00:52.129117: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 22:00:52.130586: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 22:00:52.136031: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 22:00:52.148975: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 22:00:52.149234: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 22:00:53.507666: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-15 22:00:53.508715: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 22:00:53.509215: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 22:00:53.509258: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 22:00:53.509292: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 22:00:53.509311: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 22:00:53.509328: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 22:00:53.509345: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 22:00:53.509362: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 22:00:53.509379: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 22:00:53.509396: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 22:00:53.509894: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 22:00:53.509930: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 22:00:54.219162: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-15 22:00:54.219218: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-15 22:00:54.219227: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-15 22:00:54.220224: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:02:00.0, compute capability: 6.1)
{'id': 1514, 'batch_size': 128, 'epochs': 100, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/100 [00:00<?, ?epoch/s]2024-02-15 22:00:55.076101: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-15 22:00:55.087816: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199950000 Hz
2024-02-15 22:00:57.188509: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 22:00:57.438619: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 22:00:58.173611: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-15 22:00:58.217277: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/100 [01:03<1:44:39, 63.43s/epoch, loss=3.24, accuracy=0.282, val_loss=2.1, val_accuracy=0.323, lr=0.1]  2%|▏         | 2/100 [01:26<1:05:15, 39.96s/epoch, loss=1.64, accuracy=0.486, val_loss=2.44, val_accuracy=0.373, lr=0.1]  3%|▎         | 3/100 [01:50<52:42, 32.60s/epoch, loss=1.4, accuracy=0.61, val_loss=2.69, val_accuracy=0.343, lr=0.1]      4%|▍         | 4/100 [02:14<46:33, 29.10s/epoch, loss=1.31, accuracy=0.665, val_loss=3.07, val_accuracy=0.39, lr=0.1]  5%|▌         | 5/100 [02:38<42:53, 27.09s/epoch, loss=1.28, accuracy=0.688, val_loss=2.43, val_accuracy=0.431, lr=0.1]  6%|▌         | 6/100 [03:01<40:40, 25.96s/epoch, loss=1.26, accuracy=0.702, val_loss=2.78, val_accuracy=0.346, lr=0.0316]  7%|▋         | 7/100 [03:25<39:01, 25.18s/epoch, loss=1.25, accuracy=0.709, val_loss=2.18, val_accuracy=0.458, lr=0.1]     8%|▊         | 8/100 [03:49<37:59, 24.78s/epoch, loss=1.23, accuracy=0.714, val_loss=2.22, val_accuracy=0.492, lr=0.1]  9%|▉         | 9/100 [04:13<37:19, 24.61s/epoch, loss=1.22, accuracy=0.721, val_loss=2.01, val_accuracy=0.515, lr=0.1] 10%|█         | 10/100 [04:37<36:33, 24.37s/epoch, loss=1.21, accuracy=0.725, val_loss=1.67, val_accuracy=0.554, lr=0.1] 11%|█         | 11/100 [05:00<35:44, 24.10s/epoch, loss=1.21, accuracy=0.726, val_loss=3.23, val_accuracy=0.324, lr=0.1] 12%|█▏        | 12/100 [05:24<35:07, 23.94s/epoch, loss=1.2, accuracy=0.727, val_loss=4.79, val_accuracy=0.28, lr=0.1]   13%|█▎        | 13/100 [05:48<34:41, 23.93s/epoch, loss=1.19, accuracy=0.733, val_loss=2.22, val_accuracy=0.364, lr=0.1] 14%|█▍        | 14/100 [06:12<34:12, 23.86s/epoch, loss=1.19, accuracy=0.731, val_loss=1.48, val_accuracy=0.646, lr=0.1] 15%|█▌        | 15/100 [06:36<33:58, 23.98s/epoch, loss=1.18, accuracy=0.737, val_loss=1.65, val_accuracy=0.584, lr=0.1] 16%|█▌        | 16/100 [07:00<33:31, 23.94s/epoch, loss=1.18, accuracy=0.736, val_loss=1.61, val_accuracy=0.589, lr=0.1] 17%|█▋        | 17/100 [07:24<33:12, 24.00s/epoch, loss=1.17, accuracy=0.737, val_loss=1.88, val_accuracy=0.506, lr=0.1] 18%|█▊        | 18/100 [07:48<32:51, 24.04s/epoch, loss=1.17, accuracy=0.739, val_loss=2.12, val_accuracy=0.437, lr=0.1] 19%|█▉        | 19/100 [08:12<32:18, 23.93s/epoch, loss=1.18, accuracy=0.739, val_loss=1.81, val_accuracy=0.52, lr=0.0316] 20%|██        | 20/100 [08:35<31:50, 23.88s/epoch, loss=1.17, accuracy=0.741, val_loss=2.06, val_accuracy=0.58, lr=0.1]    21%|██        | 21/100 [08:59<31:31, 23.94s/epoch, loss=1.17, accuracy=0.739, val_loss=2.65, val_accuracy=0.376, lr=0.1] 22%|██▏       | 22/100 [09:23<31:04, 23.91s/epoch, loss=1.16, accuracy=0.744, val_loss=2.1, val_accuracy=0.463, lr=0.1]  23%|██▎       | 23/100 [09:47<30:43, 23.95s/epoch, loss=1.16, accuracy=0.744, val_loss=1.77, val_accuracy=0.522, lr=0.1] 24%|██▍       | 24/100 [10:11<30:21, 23.97s/epoch, loss=1.16, accuracy=0.744, val_loss=1.49, val_accuracy=0.635, lr=0.0316] 25%|██▌       | 25/100 [10:35<29:54, 23.93s/epoch, loss=1.16, accuracy=0.743, val_loss=1.94, val_accuracy=0.559, lr=0.1]    26%|██▌       | 26/100 [10:59<29:31, 23.93s/epoch, loss=1.16, accuracy=0.746, val_loss=2.26, val_accuracy=0.481, lr=0.1] 27%|██▋       | 27/100 [11:23<29:12, 24.01s/epoch, loss=1.16, accuracy=0.746, val_loss=1.83, val_accuracy=0.53, lr=0.1]  28%|██▊       | 28/100 [11:47<28:47, 23.99s/epoch, loss=1.15, accuracy=0.745, val_loss=2.03, val_accuracy=0.504, lr=0.1] 29%|██▉       | 29/100 [12:11<28:26, 24.03s/epoch, loss=1.15, accuracy=0.748, val_loss=1.85, val_accuracy=0.499, lr=0.0316] 30%|███       | 30/100 [12:35<28:02, 24.04s/epoch, loss=1.14, accuracy=0.749, val_loss=1.69, val_accuracy=0.586, lr=0.1]    31%|███       | 31/100 [12:59<27:30, 23.92s/epoch, loss=1.15, accuracy=0.746, val_loss=2.89, val_accuracy=0.401, lr=0.1] 32%|███▏      | 32/100 [13:23<27:12, 24.01s/epoch, loss=1.15, accuracy=0.745, val_loss=1.79, val_accuracy=0.569, lr=0.1] 33%|███▎      | 33/100 [13:47<26:49, 24.02s/epoch, loss=1.15, accuracy=0.747, val_loss=1.77, val_accuracy=0.545, lr=0.1] 34%|███▍      | 34/100 [14:11<26:24, 24.01s/epoch, loss=1.14, accuracy=0.749, val_loss=1.63, val_accuracy=0.594, lr=0.0316] 35%|███▌      | 35/100 [14:36<26:06, 24.11s/epoch, loss=1.15, accuracy=0.746, val_loss=3.17, val_accuracy=0.428, lr=0.1]    36%|███▌      | 36/100 [14:59<25:37, 24.02s/epoch, loss=1.14, accuracy=0.75, val_loss=1.86, val_accuracy=0.53, lr=0.1]   37%|███▋      | 37/100 [15:23<25:03, 23.86s/epoch, loss=1.14, accuracy=0.751, val_loss=2.85, val_accuracy=0.367, lr=0.1] 38%|███▊      | 38/100 [15:47<24:41, 23.90s/epoch, loss=1.14, accuracy=0.748, val_loss=2.62, val_accuracy=0.429, lr=0.1] 39%|███▉      | 39/100 [16:11<24:12, 23.80s/epoch, loss=1.15, accuracy=0.747, val_loss=2.08, val_accuracy=0.487, lr=0.0316] 40%|████      | 40/100 [16:34<23:48, 23.80s/epoch, loss=1.14, accuracy=0.751, val_loss=1.84, val_accuracy=0.548, lr=0.1]    41%|████      | 41/100 [16:58<23:29, 23.89s/epoch, loss=1.14, accuracy=0.747, val_loss=1.56, val_accuracy=0.613, lr=0.1] 42%|████▏     | 42/100 [17:22<23:07, 23.92s/epoch, loss=1.14, accuracy=0.752, val_loss=2.86, val_accuracy=0.318, lr=0.1] 43%|████▎     | 43/100 [17:46<22:40, 23.87s/epoch, loss=1.14, accuracy=0.75, val_loss=1.8, val_accuracy=0.553, lr=0.1]   44%|████▍     | 44/100 [18:10<22:18, 23.91s/epoch, loss=1.14, accuracy=0.75, val_loss=3.84, val_accuracy=0.309, lr=0.0316] 45%|████▌     | 45/100 [18:34<21:54, 23.91s/epoch, loss=1.14, accuracy=0.751, val_loss=4.67, val_accuracy=0.259, lr=0.1]   46%|████▌     | 46/100 [18:58<21:27, 23.84s/epoch, loss=1.13, accuracy=0.749, val_loss=1.58, val_accuracy=0.596, lr=0.1] 47%|████▋     | 47/100 [19:21<20:59, 23.77s/epoch, loss=1.14, accuracy=0.752, val_loss=3.31, val_accuracy=0.31, lr=0.1]  48%|████▊     | 48/100 [19:45<20:40, 23.86s/epoch, loss=1.14, accuracy=0.751, val_loss=2.09, val_accuracy=0.506, lr=0.1] 49%|████▉     | 49/100 [20:09<20:17, 23.87s/epoch, loss=1.14, accuracy=0.752, val_loss=1.54, val_accuracy=0.616, lr=0.0316] 50%|█████     | 50/100 [20:33<19:55, 23.92s/epoch, loss=1.14, accuracy=0.75, val_loss=2.37, val_accuracy=0.453, lr=0.1]     51%|█████     | 51/100 [20:57<19:25, 23.79s/epoch, loss=1.13, accuracy=0.753, val_loss=2.75, val_accuracy=0.22, lr=0.1] 52%|█████▏    | 52/100 [21:21<19:01, 23.79s/epoch, loss=1.13, accuracy=0.753, val_loss=2.02, val_accuracy=0.497, lr=0.1] 53%|█████▎    | 53/100 [21:44<18:36, 23.76s/epoch, loss=1.13, accuracy=0.752, val_loss=2.33, val_accuracy=0.434, lr=0.1] 54%|█████▍    | 54/100 [22:08<18:11, 23.74s/epoch, loss=1.13, accuracy=0.753, val_loss=2.66, val_accuracy=0.447, lr=0.0316] 55%|█████▌    | 55/100 [22:32<17:52, 23.83s/epoch, loss=1.13, accuracy=0.754, val_loss=4.03, val_accuracy=0.251, lr=0.1]    56%|█████▌    | 56/100 [22:56<17:29, 23.85s/epoch, loss=1.13, accuracy=0.753, val_loss=1.73, val_accuracy=0.543, lr=0.1] 57%|█████▋    | 57/100 [23:20<17:05, 23.84s/epoch, loss=1.13, accuracy=0.752, val_loss=1.93, val_accuracy=0.52, lr=0.1]  58%|█████▊    | 58/100 [23:44<16:42, 23.88s/epoch, loss=1.13, accuracy=0.75, val_loss=1.87, val_accuracy=0.469, lr=0.1] 59%|█████▉    | 59/100 [24:07<16:13, 23.74s/epoch, loss=1.13, accuracy=0.752, val_loss=1.96, val_accuracy=0.523, lr=0.0316] 60%|██████    | 60/100 [24:31<15:54, 23.86s/epoch, loss=1.13, accuracy=0.752, val_loss=1.55, val_accuracy=0.601, lr=0.1]   
Thu Feb 15 13:04:29 2024       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 535.104.05             Driver Version: 535.104.05   CUDA Version: 12.2     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA TITAN Xp                Off | 00000000:03:00.0 Off |                  N/A |
| 48%   74C    P0              98W / 250W |      0MiB / 12288MiB |      0%      Default |
|                                         |                      |                  N/A |
+-----------------------------------------+----------------------+----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
|  No running processes found                                                           |
+---------------------------------------------------------------------------------------+


* * * Run SGD for cluster size = 14. * * *


Budget: 107


* * * Run SGD for ID = 14_1. * * *


2024-02-15 13:04:29.919152: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 13:04:34.408280: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 13:04:34.409428: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-15 13:04:34.463813: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 13:04:34.463849: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 13:04:34.477629: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 13:04:34.477705: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 13:04:34.491776: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 13:04:34.528369: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 13:04:34.568716: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 13:04:34.573675: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 13:04:34.585771: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 13:04:34.586406: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 13:04:34.586504: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 13:04:35.894145: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-15 13:04:35.895583: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 13:04:35.896077: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 13:04:35.896109: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 13:04:35.896142: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 13:04:35.896159: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 13:04:35.896175: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 13:04:35.896192: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 13:04:35.896208: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 13:04:35.896224: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 13:04:35.896241: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 13:04:35.896690: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 13:04:35.896731: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 13:04:36.684177: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-15 13:04:36.684261: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-15 13:04:36.684272: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-15 13:04:36.685614: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:03:00.0, compute capability: 6.1)
{'id': 141, 'batch_size': 128, 'epochs': 107, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/107 [00:00<?, ?epoch/s]2024-02-15 13:04:37.468466: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-15 13:04:37.480907: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199950000 Hz
2024-02-15 13:04:39.457074: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 13:04:39.768716: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 13:04:40.718711: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-15 13:04:40.765918: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/107 [01:07<1:58:39, 67.17s/epoch, loss=3.27, accuracy=0.292, val_loss=2.61, val_accuracy=0.259, lr=0.1]  2%|▏         | 2/107 [01:31<1:13:57, 42.26s/epoch, loss=1.58, accuracy=0.528, val_loss=1.97, val_accuracy=0.385, lr=0.1]  3%|▎         | 3/107 [01:57<59:46, 34.48s/epoch, loss=1.39, accuracy=0.614, val_loss=1.98, val_accuracy=0.493, lr=0.1]    4%|▎         | 4/107 [02:22<53:01, 30.89s/epoch, loss=1.3, accuracy=0.663, val_loss=1.91, val_accuracy=0.491, lr=0.1]   5%|▍         | 5/107 [02:47<49:03, 28.85s/epoch, loss=1.28, accuracy=0.681, val_loss=2, val_accuracy=0.395, lr=0.1]    6%|▌         | 6/107 [03:12<46:15, 27.48s/epoch, loss=1.26, accuracy=0.697, val_loss=1.7, val_accuracy=0.529, lr=0.1]  7%|▋         | 7/107 [03:37<44:31, 26.72s/epoch, loss=1.24, accuracy=0.711, val_loss=4.3, val_accuracy=0.296, lr=0.1]  7%|▋         | 8/107 [04:02<43:12, 26.19s/epoch, loss=1.24, accuracy=0.715, val_loss=1.52, val_accuracy=0.614, lr=0.1]  8%|▊         | 9/107 [04:27<42:03, 25.75s/epoch, loss=1.23, accuracy=0.717, val_loss=1.81, val_accuracy=0.561, lr=0.1]  9%|▉         | 10/107 [04:52<41:20, 25.57s/epoch, loss=1.22, accuracy=0.723, val_loss=4.56, val_accuracy=0.336, lr=0.1] 10%|█         | 11/107 [05:17<40:29, 25.31s/epoch, loss=1.22, accuracy=0.726, val_loss=2.3, val_accuracy=0.422, lr=0.1]  11%|█         | 12/107 [05:42<39:57, 25.24s/epoch, loss=1.21, accuracy=0.728, val_loss=2.04, val_accuracy=0.441, lr=0.1] 12%|█▏        | 13/107 [06:07<39:23, 25.14s/epoch, loss=1.2, accuracy=0.733, val_loss=1.68, val_accuracy=0.558, lr=0.0316] 13%|█▎        | 14/107 [06:32<38:51, 25.07s/epoch, loss=1.19, accuracy=0.732, val_loss=2.85, val_accuracy=0.393, lr=0.1]   14%|█▍        | 15/107 [06:57<38:38, 25.20s/epoch, loss=1.19, accuracy=0.734, val_loss=1.65, val_accuracy=0.577, lr=0.1] 15%|█▍        | 16/107 [07:22<38:08, 25.15s/epoch, loss=1.19, accuracy=0.734, val_loss=1.68, val_accuracy=0.548, lr=0.1] 16%|█▌        | 17/107 [07:48<37:52, 25.25s/epoch, loss=1.19, accuracy=0.738, val_loss=1.97, val_accuracy=0.516, lr=0.1] 17%|█▋        | 18/107 [08:13<37:17, 25.14s/epoch, loss=1.18, accuracy=0.742, val_loss=1.65, val_accuracy=0.593, lr=0.0316] 18%|█▊        | 19/107 [08:38<36:55, 25.17s/epoch, loss=1.18, accuracy=0.742, val_loss=1.78, val_accuracy=0.573, lr=0.1]    19%|█▊        | 20/107 [09:03<36:27, 25.14s/epoch, loss=1.18, accuracy=0.742, val_loss=1.66, val_accuracy=0.609, lr=0.1] 20%|█▉        | 21/107 [09:28<35:56, 25.07s/epoch, loss=1.17, accuracy=0.742, val_loss=1.96, val_accuracy=0.456, lr=0.1] 21%|██        | 22/107 [09:53<35:22, 24.97s/epoch, loss=1.18, accuracy=0.744, val_loss=2.07, val_accuracy=0.494, lr=0.1] 21%|██▏       | 23/107 [10:18<35:04, 25.05s/epoch, loss=1.17, accuracy=0.744, val_loss=5.18, val_accuracy=0.248, lr=0.0316] 22%|██▏       | 24/107 [10:43<34:47, 25.15s/epoch, loss=1.17, accuracy=0.746, val_loss=2.6, val_accuracy=0.272, lr=0.1]     23%|██▎       | 25/107 [11:08<34:16, 25.08s/epoch, loss=1.17, accuracy=0.745, val_loss=1.75, val_accuracy=0.564, lr=0.1] 24%|██▍       | 26/107 [11:32<33:23, 24.73s/epoch, loss=1.17, accuracy=0.745, val_loss=2.47, val_accuracy=0.404, lr=0.1] 25%|██▌       | 27/107 [11:57<33:11, 24.89s/epoch, loss=1.17, accuracy=0.745, val_loss=2.31, val_accuracy=0.424, lr=0.1] 26%|██▌       | 28/107 [12:22<32:41, 24.83s/epoch, loss=1.16, accuracy=0.745, val_loss=2.09, val_accuracy=0.46, lr=0.0316] 27%|██▋       | 29/107 [12:47<32:11, 24.76s/epoch, loss=1.16, accuracy=0.746, val_loss=2.88, val_accuracy=0.356, lr=0.1]   28%|██▊       | 30/107 [13:12<31:59, 24.93s/epoch, loss=1.15, accuracy=0.747, val_loss=1.98, val_accuracy=0.488, lr=0.1] 29%|██▉       | 31/107 [13:37<31:42, 25.03s/epoch, loss=1.16, accuracy=0.747, val_loss=1.82, val_accuracy=0.574, lr=0.1] 30%|██▉       | 32/107 [14:02<31:05, 24.88s/epoch, loss=1.16, accuracy=0.748, val_loss=3.43, val_accuracy=0.36, lr=0.1]  31%|███       | 33/107 [14:27<30:41, 24.88s/epoch, loss=1.15, accuracy=0.753, val_loss=1.6, val_accuracy=0.587, lr=0.0316] 32%|███▏      | 34/107 [14:52<30:19, 24.93s/epoch, loss=1.16, accuracy=0.751, val_loss=4.36, val_accuracy=0.295, lr=0.1]   33%|███▎      | 35/107 [15:17<30:03, 25.05s/epoch, loss=1.16, accuracy=0.747, val_loss=1.61, val_accuracy=0.586, lr=0.1] 34%|███▎      | 36/107 [15:42<29:42, 25.11s/epoch, loss=1.15, accuracy=0.749, val_loss=1.8, val_accuracy=0.516, lr=0.1]  35%|███▍      | 37/107 [16:07<28:57, 24.82s/epoch, loss=1.15, accuracy=0.752, val_loss=2.32, val_accuracy=0.374, lr=0.1] 36%|███▌      | 38/107 [16:32<28:43, 24.98s/epoch, loss=1.14, accuracy=0.755, val_loss=1.59, val_accuracy=0.604, lr=0.0316] 36%|███▋      | 39/107 [16:56<28:03, 24.75s/epoch, loss=1.16, accuracy=0.751, val_loss=2.97, val_accuracy=0.342, lr=0.1]    37%|███▋      | 40/107 [17:20<27:22, 24.51s/epoch, loss=1.15, accuracy=0.754, val_loss=2.27, val_accuracy=0.431, lr=0.1] 38%|███▊      | 41/107 [17:45<27:14, 24.77s/epoch, loss=1.15, accuracy=0.751, val_loss=1.91, val_accuracy=0.537, lr=0.1] 39%|███▉      | 42/107 [18:10<26:47, 24.73s/epoch, loss=1.15, accuracy=0.752, val_loss=3.08, val_accuracy=0.336, lr=0.1] 40%|████      | 43/107 [18:35<26:24, 24.76s/epoch, loss=1.14, accuracy=0.753, val_loss=2.26, val_accuracy=0.423, lr=0.0316] 41%|████      | 44/107 [19:00<26:09, 24.91s/epoch, loss=1.15, accuracy=0.75, val_loss=1.49, val_accuracy=0.651, lr=0.1]     42%|████▏     | 45/107 [19:26<25:52, 25.05s/epoch, loss=1.13, accuracy=0.755, val_loss=3.41, val_accuracy=0.347, lr=0.1] 43%|████▎     | 46/107 [19:50<25:14, 24.83s/epoch, loss=1.15, accuracy=0.754, val_loss=5.27, val_accuracy=0.254, lr=0.1] 44%|████▍     | 47/107 [20:14<24:43, 24.72s/epoch, loss=1.15, accuracy=0.753, val_loss=1.87, val_accuracy=0.555, lr=0.1] 45%|████▍     | 48/107 [20:38<23:57, 24.36s/epoch, loss=1.15, accuracy=0.752, val_loss=1.78, val_accuracy=0.575, lr=0.1] 46%|████▌     | 49/107 [21:02<23:34, 24.38s/epoch, loss=1.14, accuracy=0.755, val_loss=2.71, val_accuracy=0.326, lr=0.0316] 47%|████▋     | 50/107 [21:27<23:23, 24.63s/epoch, loss=1.14, accuracy=0.754, val_loss=1.41, val_accuracy=0.67, lr=0.1]     48%|████▊     | 51/107 [21:53<23:09, 24.81s/epoch, loss=1.15, accuracy=0.751, val_loss=1.77, val_accuracy=0.593, lr=0.1] 49%|████▊     | 52/107 [22:18<22:51, 24.94s/epoch, loss=1.15, accuracy=0.75, val_loss=1.76, val_accuracy=0.564, lr=0.1]  50%|████▉     | 53/107 [22:43<22:33, 25.06s/epoch, loss=1.14, accuracy=0.751, val_loss=2.22, val_accuracy=0.495, lr=0.1] 50%|█████     | 54/107 [23:08<22:09, 25.08s/epoch, loss=1.15, accuracy=0.752, val_loss=3.04, val_accuracy=0.343, lr=0.1] 51%|█████▏    | 55/107 [23:34<21:48, 25.16s/epoch, loss=1.15, accuracy=0.754, val_loss=1.87, val_accuracy=0.591, lr=0.0316] 52%|█████▏    | 56/107 [23:59<21:24, 25.19s/epoch, loss=1.14, accuracy=0.752, val_loss=1.82, val_accuracy=0.501, lr=0.1]    53%|█████▎    | 57/107 [24:24<20:58, 25.18s/epoch, loss=1.15, accuracy=0.752, val_loss=1.76, val_accuracy=0.549, lr=0.1] 54%|█████▍    | 58/107 [24:49<20:34, 25.19s/epoch, loss=1.15, accuracy=0.753, val_loss=1.57, val_accuracy=0.593, lr=0.1] 55%|█████▌    | 59/107 [25:15<20:12, 25.26s/epoch, loss=1.14, accuracy=0.753, val_loss=1.9, val_accuracy=0.518, lr=0.1]  56%|█████▌    | 60/107 [25:39<19:36, 25.03s/epoch, loss=1.15, accuracy=0.754, val_loss=2.29, val_accuracy=0.461, lr=0.0316] 57%|█████▋    | 61/107 [26:03<18:54, 24.66s/epoch, loss=1.15, accuracy=0.753, val_loss=3.13, val_accuracy=0.328, lr=0.1]    58%|█████▊    | 62/107 [26:27<18:19, 24.44s/epoch, loss=1.14, accuracy=0.753, val_loss=1.83, val_accuracy=0.522, lr=0.1] 59%|█████▉    | 63/107 [26:52<18:02, 24.60s/epoch, loss=1.14, accuracy=0.756, val_loss=2.36, val_accuracy=0.451, lr=0.1] 60%|█████▉    | 64/107 [27:16<17:29, 24.40s/epoch, loss=1.14, accuracy=0.759, val_loss=1.99, val_accuracy=0.471, lr=0.1] 61%|██████    | 65/107 [27:41<17:13, 24.62s/epoch, loss=1.14, accuracy=0.755, val_loss=2.25, val_accuracy=0.507, lr=0.0316] 62%|██████▏   | 66/107 [28:07<17:00, 24.88s/epoch, loss=1.14, accuracy=0.755, val_loss=2.28, val_accuracy=0.474, lr=0.1]    63%|██████▎   | 67/107 [28:31<16:30, 24.76s/epoch, loss=1.13, accuracy=0.754, val_loss=1.59, val_accuracy=0.584, lr=0.1] 64%|██████▎   | 68/107 [28:56<16:12, 24.95s/epoch, loss=1.13, accuracy=0.756, val_loss=1.9, val_accuracy=0.513, lr=0.1]  64%|██████▍   | 69/107 [29:22<15:52, 25.06s/epoch, loss=1.13, accuracy=0.755, val_loss=2.11, val_accuracy=0.5, lr=0.1]  65%|██████▌   | 70/107 [29:47<15:31, 25.17s/epoch, loss=1.13, accuracy=0.755, val_loss=2.45, val_accuracy=0.42, lr=0.0316] 66%|██████▋   | 71/107 [30:12<15:05, 25.16s/epoch, loss=1.13, accuracy=0.755, val_loss=1.71, val_accuracy=0.614, lr=0.1]   67%|██████▋   | 72/107 [30:38<14:43, 25.25s/epoch, loss=1.13, accuracy=0.756, val_loss=1.85, val_accuracy=0.537, lr=0.1] 68%|██████▊   | 73/107 [31:02<14:05, 24.87s/epoch, loss=1.13, accuracy=0.755, val_loss=2.75, val_accuracy=0.382, lr=0.1] 69%|██████▉   | 74/107 [31:27<13:44, 24.97s/epoch, loss=1.13, accuracy=0.758, val_loss=1.45, val_accuracy=0.648, lr=0.1] 70%|███████   | 75/107 [31:51<13:14, 24.82s/epoch, loss=1.13, accuracy=0.754, val_loss=2.03, val_accuracy=0.496, lr=0.0316] 71%|███████   | 76/107 [32:17<12:53, 24.94s/epoch, loss=1.13, accuracy=0.756, val_loss=2.27, val_accuracy=0.395, lr=0.1]    72%|███████▏  | 77/107 [32:42<12:29, 24.98s/epoch, loss=1.13, accuracy=0.757, val_loss=2.27, val_accuracy=0.401, lr=0.1] 73%|███████▎  | 78/107 [33:06<11:55, 24.67s/epoch, loss=1.13, accuracy=0.755, val_loss=2.78, val_accuracy=0.373, lr=0.1] 74%|███████▍  | 79/107 [33:31<11:37, 24.89s/epoch, loss=1.13, accuracy=0.757, val_loss=1.88, val_accuracy=0.572, lr=0.1] 75%|███████▍  | 80/107 [33:57<11:16, 25.06s/epoch, loss=1.13, accuracy=0.752, val_loss=1.92, val_accuracy=0.509, lr=0.0316] 76%|███████▌  | 81/107 [34:22<10:52, 25.08s/epoch, loss=1.12, accuracy=0.755, val_loss=2.39, val_accuracy=0.481, lr=0.1]    77%|███████▋  | 82/107 [34:47<10:27, 25.10s/epoch, loss=0.931, accuracy=0.813, val_loss=0.923, val_accuracy=0.795, lr=0.01] 78%|███████▊  | 83/107 [35:12<10:00, 25.03s/epoch, loss=0.742, accuracy=0.848, val_loss=0.894, val_accuracy=0.781, lr=0.01] 79%|███████▊  | 84/107 [35:37<09:37, 25.10s/epoch, loss=0.658, accuracy=0.856, val_loss=0.782, val_accuracy=0.808, lr=0.01] 79%|███████▉  | 85/107 [36:02<09:11, 25.05s/epoch, loss=0.611, accuracy=0.86, val_loss=0.757, val_accuracy=0.804, lr=0.01]  80%|████████  | 86/107 [36:27<08:46, 25.07s/epoch, loss=0.585, accuracy=0.864, val_loss=0.723, val_accuracy=0.815, lr=0.01] 81%|████████▏ | 87/107 [36:51<08:13, 24.68s/epoch, loss=0.578, accuracy=0.862, val_loss=0.7, val_accuracy=0.818, lr=0.01]   82%|████████▏ | 88/107 [37:15<07:47, 24.60s/epoch, loss=0.571, accuracy=0.864, val_loss=0.719, val_accuracy=0.813, lr=0.01] 83%|████████▎ | 89/107 [37:40<07:25, 24.76s/epoch, loss=0.571, accuracy=0.863, val_loss=0.948, val_accuracy=0.746, lr=0.01] 84%|████████▍ | 90/107 [38:04<06:57, 24.54s/epoch, loss=0.569, accuracy=0.866, val_loss=0.802, val_accuracy=0.793, lr=0.01] 85%|████████▌ | 91/107 [38:29<06:30, 24.43s/epoch, loss=0.569, accuracy=0.865, val_loss=0.82, val_accuracy=0.792, lr=0.01]  86%|████████▌ | 92/107 [38:54<06:09, 24.63s/epoch, loss=0.564, accuracy=0.868, val_loss=0.871, val_accuracy=0.777, lr=0.00316] 87%|████████▋ | 93/107 [39:18<05:44, 24.58s/epoch, loss=0.559, accuracy=0.872, val_loss=0.81, val_accuracy=0.786, lr=0.01]     88%|████████▊ | 94/107 [39:42<05:18, 24.49s/epoch, loss=0.563, accuracy=0.87, val_loss=0.752, val_accuracy=0.806, lr=0.01] 89%|████████▉ | 95/107 [40:07<04:56, 24.69s/epoch, loss=0.558, accuracy=0.872, val_loss=0.951, val_accuracy=0.758, lr=0.01] 90%|████████▉ | 96/107 [40:33<04:33, 24.85s/epoch, loss=0.561, accuracy=0.873, val_loss=0.847, val_accuracy=0.792, lr=0.01] 91%|█████████ | 97/107 [40:58<04:08, 24.88s/epoch, loss=0.559, accuracy=0.874, val_loss=0.853, val_accuracy=0.788, lr=0.00316] 92%|█████████▏| 98/107 [41:23<03:44, 24.98s/epoch, loss=0.554, accuracy=0.876, val_loss=0.74, val_accuracy=0.814, lr=0.01]     93%|█████████▎| 99/107 [41:48<03:19, 24.97s/epoch, loss=0.557, accuracy=0.875, val_loss=0.824, val_accuracy=0.802, lr=0.01] 93%|█████████▎| 100/107 [42:12<02:52, 24.61s/epoch, loss=0.561, accuracy=0.873, val_loss=0.723, val_accuracy=0.821, lr=0.01] 94%|█████████▍| 101/107 [42:37<02:29, 24.85s/epoch, loss=0.555, accuracy=0.877, val_loss=0.767, val_accuracy=0.806, lr=0.01] 95%|█████████▌| 102/107 [43:02<02:05, 25.02s/epoch, loss=0.556, accuracy=0.876, val_loss=0.846, val_accuracy=0.79, lr=0.00316] 96%|█████████▋| 103/107 [43:27<01:39, 24.83s/epoch, loss=0.558, accuracy=0.876, val_loss=0.752, val_accuracy=0.823, lr=0.01]   97%|█████████▋| 104/107 [43:51<01:13, 24.60s/epoch, loss=0.556, accuracy=0.878, val_loss=0.732, val_accuracy=0.821, lr=0.01] 98%|█████████▊| 105/107 [44:15<00:48, 24.41s/epoch, loss=0.556, accuracy=0.878, val_loss=0.845, val_accuracy=0.79, lr=0.01]  99%|█████████▉| 106/107 [44:39<00:24, 24.34s/epoch, loss=0.557, accuracy=0.879, val_loss=0.864, val_accuracy=0.788, lr=0.01]100%|██████████| 107/107 [45:03<00:00, 24.31s/epoch, loss=0.56, accuracy=0.878, val_loss=0.778, val_accuracy=0.808, lr=0.00316]100%|██████████| 107/107 [45:03<00:00, 25.27s/epoch, loss=0.56, accuracy=0.878, val_loss=0.778, val_accuracy=0.808, lr=0.00316]
Using real-time data augmentation.
Test loss: 0.7783064842224121
Test accuracy: 0.8076000213623047


* * * Run SGD for ID = 14_2. * * *


2024-02-15 13:49:43.781513: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 13:49:46.565532: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 13:49:46.566808: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-15 13:49:46.606303: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 13:49:46.606341: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 13:49:46.609281: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 13:49:46.609326: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 13:49:46.611613: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 13:49:46.612775: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 13:49:46.615302: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 13:49:46.616869: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 13:49:46.622035: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 13:49:46.622593: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 13:49:46.622677: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 13:49:47.928898: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-15 13:49:47.929475: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 13:49:47.929919: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 13:49:47.929953: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 13:49:47.929988: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 13:49:47.930007: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 13:49:47.930026: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 13:49:47.930044: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 13:49:47.930062: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 13:49:47.930080: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 13:49:47.930099: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 13:49:47.930571: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 13:49:47.930606: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 13:49:48.631570: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-15 13:49:48.631634: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-15 13:49:48.631646: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-15 13:49:48.633080: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:03:00.0, compute capability: 6.1)
{'id': 142, 'batch_size': 128, 'epochs': 107, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/107 [00:00<?, ?epoch/s]2024-02-15 13:49:49.463317: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-15 13:49:49.475809: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199950000 Hz
2024-02-15 13:49:51.646372: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 13:49:51.933805: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 13:49:52.876240: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-15 13:49:52.930899: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/107 [01:03<1:53:03, 63.99s/epoch, loss=3.29, accuracy=0.248, val_loss=4.22, val_accuracy=0.106, lr=0.1]  2%|▏         | 2/107 [01:27<1:10:10, 40.10s/epoch, loss=1.6, accuracy=0.498, val_loss=2.15, val_accuracy=0.388, lr=0.1]   3%|▎         | 3/107 [01:51<57:10, 32.99s/epoch, loss=1.38, accuracy=0.611, val_loss=2.14, val_accuracy=0.427, lr=0.1]   4%|▎         | 4/107 [02:16<50:45, 29.57s/epoch, loss=1.29, accuracy=0.665, val_loss=2.37, val_accuracy=0.438, lr=0.1]  5%|▍         | 5/107 [02:40<47:17, 27.82s/epoch, loss=1.25, accuracy=0.69, val_loss=1.88, val_accuracy=0.503, lr=0.1]   6%|▌         | 6/107 [03:06<45:16, 26.89s/epoch, loss=1.23, accuracy=0.706, val_loss=2.61, val_accuracy=0.323, lr=0.1]  7%|▋         | 7/107 [03:31<43:49, 26.29s/epoch, loss=1.21, accuracy=0.716, val_loss=1.53, val_accuracy=0.607, lr=0.1]  7%|▋         | 8/107 [03:56<42:42, 25.88s/epoch, loss=1.21, accuracy=0.718, val_loss=2.3, val_accuracy=0.374, lr=0.1]   8%|▊         | 9/107 [04:21<41:59, 25.71s/epoch, loss=1.21, accuracy=0.723, val_loss=2.55, val_accuracy=0.392, lr=0.1]  9%|▉         | 10/107 [04:46<41:11, 25.48s/epoch, loss=1.2, accuracy=0.725, val_loss=3.3, val_accuracy=0.33, lr=0.1]   10%|█         | 11/107 [05:11<40:30, 25.32s/epoch, loss=1.19, accuracy=0.73, val_loss=1.7, val_accuracy=0.582, lr=0.1] 11%|█         | 12/107 [05:35<39:39, 25.04s/epoch, loss=1.19, accuracy=0.732, val_loss=2.12, val_accuracy=0.454, lr=0.0316] 12%|█▏        | 13/107 [06:00<39:12, 25.03s/epoch, loss=1.18, accuracy=0.735, val_loss=1.86, val_accuracy=0.538, lr=0.1]    13%|█▎        | 14/107 [06:25<38:43, 24.98s/epoch, loss=1.18, accuracy=0.734, val_loss=1.6, val_accuracy=0.605, lr=0.1]  14%|█▍        | 15/107 [06:50<38:26, 25.07s/epoch, loss=1.18, accuracy=0.737, val_loss=2.67, val_accuracy=0.391, lr=0.1] 15%|█▍        | 16/107 [07:17<38:34, 25.43s/epoch, loss=1.18, accuracy=0.738, val_loss=2.09, val_accuracy=0.455, lr=0.1] 16%|█▌        | 17/107 [07:42<38:11, 25.46s/epoch, loss=1.17, accuracy=0.741, val_loss=2.08, val_accuracy=0.517, lr=0.0316] 17%|█▋        | 18/107 [08:08<37:43, 25.43s/epoch, loss=1.17, accuracy=0.739, val_loss=2.47, val_accuracy=0.389, lr=0.1]    18%|█▊        | 19/107 [08:33<37:15, 25.40s/epoch, loss=1.17, accuracy=0.741, val_loss=1.65, val_accuracy=0.586, lr=0.1] 19%|█▊        | 20/107 [08:58<36:39, 25.28s/epoch, loss=1.16, accuracy=0.743, val_loss=2.36, val_accuracy=0.399, lr=0.1] 20%|█▉        | 21/107 [09:22<35:56, 25.07s/epoch, loss=1.16, accuracy=0.745, val_loss=2.8, val_accuracy=0.352, lr=0.1]  21%|██        | 22/107 [09:47<35:20, 24.95s/epoch, loss=1.15, accuracy=0.745, val_loss=1.67, val_accuracy=0.598, lr=0.0316] 21%|██▏       | 23/107 [10:12<34:41, 24.78s/epoch, loss=1.16, accuracy=0.746, val_loss=1.45, val_accuracy=0.637, lr=0.1]    22%|██▏       | 24/107 [10:36<34:13, 24.74s/epoch, loss=1.16, accuracy=0.744, val_loss=2.13, val_accuracy=0.516, lr=0.1] 23%|██▎       | 25/107 [11:01<33:53, 24.79s/epoch, loss=1.16, accuracy=0.745, val_loss=2.63, val_accuracy=0.389, lr=0.1] 24%|██▍       | 26/107 [11:26<33:25, 24.76s/epoch, loss=1.16, accuracy=0.747, val_loss=2.1, val_accuracy=0.478, lr=0.1]  25%|██▌       | 27/107 [11:51<33:06, 24.83s/epoch, loss=1.15, accuracy=0.744, val_loss=1.86, val_accuracy=0.538, lr=0.1] 26%|██▌       | 28/107 [12:16<32:53, 24.98s/epoch, loss=1.15, accuracy=0.746, val_loss=2.24, val_accuracy=0.373, lr=0.0316] 27%|██▋       | 29/107 [12:39<31:43, 24.41s/epoch, loss=1.15, accuracy=0.748, val_loss=1.43, val_accuracy=0.66, lr=0.1]     28%|██▊       | 30/107 [13:03<30:57, 24.13s/epoch, loss=1.15, accuracy=0.749, val_loss=1.94, val_accuracy=0.481, lr=0.1] 29%|██▉       | 31/107 [13:28<30:51, 24.37s/epoch, loss=1.15, accuracy=0.748, val_loss=1.38, val_accuracy=0.667, lr=0.1] 30%|██▉       | 32/107 [13:53<30:40, 24.54s/epoch, loss=1.15, accuracy=0.748, val_loss=3.07, val_accuracy=0.361, lr=0.1] 31%|███       | 33/107 [14:18<30:27, 24.70s/epoch, loss=1.14, accuracy=0.751, val_loss=3.3, val_accuracy=0.273, lr=0.1]  32%|███▏      | 34/107 [14:42<30:00, 24.67s/epoch, loss=1.14, accuracy=0.751, val_loss=3.33, val_accuracy=0.393, lr=0.1] 33%|███▎      | 35/107 [15:07<29:30, 24.59s/epoch, loss=1.15, accuracy=0.749, val_loss=1.53, val_accuracy=0.602, lr=0.1] 34%|███▎      | 36/107 [15:31<28:59, 24.50s/epoch, loss=1.14, accuracy=0.75, val_loss=2.35, val_accuracy=0.398, lr=0.0316] 35%|███▍      | 37/107 [15:54<28:14, 24.21s/epoch, loss=1.14, accuracy=0.749, val_loss=1.79, val_accuracy=0.595, lr=0.1]   36%|███▌      | 38/107 [16:19<27:53, 24.26s/epoch, loss=1.15, accuracy=0.749, val_loss=4.41, val_accuracy=0.265, lr=0.1] 36%|███▋      | 39/107 [16:44<27:41, 24.43s/epoch, loss=1.14, accuracy=0.752, val_loss=4.9, val_accuracy=0.245, lr=0.1]  37%|███▋      | 40/107 [17:08<27:17, 24.45s/epoch, loss=1.14, accuracy=0.751, val_loss=2.38, val_accuracy=0.464, lr=0.1] 38%|███▊      | 41/107 [17:32<26:42, 24.28s/epoch, loss=1.13, accuracy=0.749, val_loss=2.83, val_accuracy=0.432, lr=0.0316] 39%|███▉      | 42/107 [17:56<26:13, 24.20s/epoch, loss=1.14, accuracy=0.751, val_loss=2.81, val_accuracy=0.355, lr=0.1]    40%|████      | 43/107 [18:20<25:46, 24.16s/epoch, loss=1.13, accuracy=0.752, val_loss=5.42, val_accuracy=0.242, lr=0.1] 41%|████      | 44/107 [18:45<25:31, 24.31s/epoch, loss=1.14, accuracy=0.751, val_loss=1.68, val_accuracy=0.567, lr=0.1] 42%|████▏     | 45/107 [19:09<25:13, 24.42s/epoch, loss=1.14, accuracy=0.749, val_loss=2.93, val_accuracy=0.431, lr=0.1] 43%|████▎     | 46/107 [19:34<24:51, 24.45s/epoch, loss=1.14, accuracy=0.75, val_loss=1.33, val_accuracy=0.691, lr=0.1]  44%|████▍     | 47/107 [19:59<24:32, 24.54s/epoch, loss=1.14, accuracy=0.75, val_loss=3.75, val_accuracy=0.303, lr=0.1] 45%|████▍     | 48/107 [20:24<24:16, 24.68s/epoch, loss=1.14, accuracy=0.751, val_loss=2.45, val_accuracy=0.422, lr=0.1] 46%|████▌     | 49/107 [20:49<23:56, 24.76s/epoch, loss=1.13, accuracy=0.751, val_loss=2.13, val_accuracy=0.522, lr=0.1] 47%|████▋     | 50/107 [21:13<23:22, 24.61s/epoch, loss=1.14, accuracy=0.751, val_loss=1.65, val_accuracy=0.608, lr=0.1] 48%|████▊     | 51/107 [21:37<22:56, 24.57s/epoch, loss=1.14, accuracy=0.752, val_loss=2.22, val_accuracy=0.416, lr=0.0316] 49%|████▊     | 52/107 [22:00<22:06, 24.12s/epoch, loss=1.13, accuracy=0.753, val_loss=1.65, val_accuracy=0.578, lr=0.1]    50%|████▉     | 53/107 [22:25<21:54, 24.34s/epoch, loss=1.14, accuracy=0.749, val_loss=2.2, val_accuracy=0.433, lr=0.1]  50%|█████     | 54/107 [22:49<21:16, 24.09s/epoch, loss=1.14, accuracy=0.752, val_loss=1.9, val_accuracy=0.513, lr=0.1] 51%|█████▏    | 55/107 [23:13<21:00, 24.23s/epoch, loss=1.14, accuracy=0.749, val_loss=2.1, val_accuracy=0.468, lr=0.1] 52%|█████▏    | 56/107 [23:38<20:46, 24.45s/epoch, loss=1.13, accuracy=0.753, val_loss=2.16, val_accuracy=0.467, lr=0.0316] 53%|█████▎    | 57/107 [24:03<20:20, 24.40s/epoch, loss=1.14, accuracy=0.754, val_loss=2.56, val_accuracy=0.419, lr=0.1]    54%|█████▍    | 58/107 [24:27<19:54, 24.38s/epoch, loss=1.14, accuracy=0.755, val_loss=2.12, val_accuracy=0.494, lr=0.1] 55%|█████▌    | 59/107 [24:51<19:31, 24.40s/epoch, loss=1.14, accuracy=0.75, val_loss=1.53, val_accuracy=0.636, lr=0.1]  56%|█████▌    | 60/107 [25:16<19:09, 24.46s/epoch, loss=1.14, accuracy=0.752, val_loss=1.66, val_accuracy=0.589, lr=0.1] 57%|█████▋    | 61/107 [25:41<18:47, 24.52s/epoch, loss=1.14, accuracy=0.752, val_loss=1.69, val_accuracy=0.566, lr=0.0316] 58%|█████▊    | 62/107 [26:05<18:18, 24.41s/epoch, loss=1.13, accuracy=0.753, val_loss=1.68, val_accuracy=0.629, lr=0.1]    59%|█████▉    | 63/107 [26:29<17:52, 24.38s/epoch, loss=1.13, accuracy=0.753, val_loss=2.09, val_accuracy=0.45, lr=0.1]  60%|█████▉    | 64/107 [26:54<17:31, 24.45s/epoch, loss=1.14, accuracy=0.752, val_loss=2.67, val_accuracy=0.323, lr=0.1] 61%|██████    | 65/107 [27:18<16:58, 24.26s/epoch, loss=1.13, accuracy=0.753, val_loss=3.69, val_accuracy=0.297, lr=0.1] 62%|██████▏   | 66/107 [27:43<16:44, 24.50s/epoch, loss=1.13, accuracy=0.755, val_loss=1.96, val_accuracy=0.519, lr=0.0316] 63%|██████▎   | 67/107 [28:07<16:15, 24.38s/epoch, loss=1.13, accuracy=0.755, val_loss=2.11, val_accuracy=0.518, lr=0.1]    64%|██████▎   | 68/107 [28:32<15:58, 24.57s/epoch, loss=1.14, accuracy=0.754, val_loss=2, val_accuracy=0.55, lr=0.1]     64%|██████▍   | 69/107 [28:56<15:30, 24.48s/epoch, loss=1.12, accuracy=0.755, val_loss=1.82, val_accuracy=0.505, lr=0.1] 65%|██████▌   | 70/107 [29:21<15:09, 24.59s/epoch, loss=1.13, accuracy=0.753, val_loss=2.69, val_accuracy=0.426, lr=0.1] 66%|██████▋   | 71/107 [29:46<14:47, 24.65s/epoch, loss=1.13, accuracy=0.752, val_loss=1.69, val_accuracy=0.56, lr=0.0316] 67%|██████▋   | 72/107 [30:11<14:28, 24.81s/epoch, loss=1.12, accuracy=0.755, val_loss=2.03, val_accuracy=0.498, lr=0.1]   68%|██████▊   | 73/107 [30:36<14:02, 24.79s/epoch, loss=1.13, accuracy=0.754, val_loss=1.79, val_accuracy=0.549, lr=0.1] 69%|██████▉   | 74/107 [31:00<13:35, 24.70s/epoch, loss=1.13, accuracy=0.753, val_loss=2.48, val_accuracy=0.503, lr=0.1] 70%|███████   | 75/107 [31:25<13:08, 24.63s/epoch, loss=1.13, accuracy=0.754, val_loss=2.17, val_accuracy=0.455, lr=0.1] 71%|███████   | 76/107 [31:49<12:43, 24.62s/epoch, loss=1.13, accuracy=0.755, val_loss=1.52, val_accuracy=0.599, lr=0.0316] 72%|███████▏  | 77/107 [32:13<12:08, 24.28s/epoch, loss=1.13, accuracy=0.753, val_loss=1.85, val_accuracy=0.575, lr=0.1]    73%|███████▎  | 78/107 [32:36<11:39, 24.12s/epoch, loss=1.13, accuracy=0.755, val_loss=3.28, val_accuracy=0.271, lr=0.1] 74%|███████▍  | 79/107 [33:01<11:23, 24.41s/epoch, loss=1.12, accuracy=0.757, val_loss=3.21, val_accuracy=0.248, lr=0.1] 75%|███████▍  | 80/107 [33:25<10:53, 24.21s/epoch, loss=1.12, accuracy=0.756, val_loss=2.33, val_accuracy=0.475, lr=0.1] 76%|███████▌  | 81/107 [33:49<10:28, 24.19s/epoch, loss=1.12, accuracy=0.756, val_loss=1.78, val_accuracy=0.543, lr=0.0316] 77%|███████▋  | 82/107 [34:14<10:09, 24.37s/epoch, loss=0.922, accuracy=0.812, val_loss=0.98, val_accuracy=0.776, lr=0.01]  78%|███████▊  | 83/107 [34:39<09:49, 24.58s/epoch, loss=0.739, accuracy=0.847, val_loss=0.841, val_accuracy=0.8, lr=0.01]  79%|███████▊  | 84/107 [35:04<09:25, 24.57s/epoch, loss=0.658, accuracy=0.854, val_loss=0.751, val_accuracy=0.815, lr=0.01] 79%|███████▉  | 85/107 [35:28<08:58, 24.49s/epoch, loss=0.61, accuracy=0.859, val_loss=0.76, val_accuracy=0.811, lr=0.01]   80%|████████  | 86/107 [35:52<08:32, 24.41s/epoch, loss=0.592, accuracy=0.859, val_loss=0.776, val_accuracy=0.798, lr=0.01] 81%|████████▏ | 87/107 [36:16<08:06, 24.35s/epoch, loss=0.578, accuracy=0.862, val_loss=0.717, val_accuracy=0.818, lr=0.01] 82%|████████▏ | 88/107 [36:41<07:45, 24.50s/epoch, loss=0.576, accuracy=0.862, val_loss=0.757, val_accuracy=0.8, lr=0.01]   83%|████████▎ | 89/107 [37:04<07:13, 24.10s/epoch, loss=0.573, accuracy=0.863, val_loss=0.814, val_accuracy=0.791, lr=0.01] 84%|████████▍ | 90/107 [37:29<06:53, 24.32s/epoch, loss=0.567, accuracy=0.865, val_loss=0.877, val_accuracy=0.779, lr=0.01] 85%|████████▌ | 91/107 [37:54<06:29, 24.33s/epoch, loss=0.565, accuracy=0.867, val_loss=0.688, val_accuracy=0.823, lr=0.01] 86%|████████▌ | 92/107 [38:18<06:04, 24.28s/epoch, loss=0.566, accuracy=0.867, val_loss=0.753, val_accuracy=0.807, lr=0.01] 87%|████████▋ | 93/107 [38:40<05:32, 23.77s/epoch, loss=0.559, accuracy=0.87, val_loss=0.757, val_accuracy=0.802, lr=0.01]  88%|████████▊ | 94/107 [39:04<05:06, 23.57s/epoch, loss=0.565, accuracy=0.87, val_loss=0.766, val_accuracy=0.804, lr=0.01] 89%|████████▉ | 95/107 [39:27<04:42, 23.58s/epoch, loss=0.564, accuracy=0.87, val_loss=1.02, val_accuracy=0.736, lr=0.01]  90%|████████▉ | 96/107 [39:50<04:16, 23.35s/epoch, loss=0.561, accuracy=0.872, val_loss=0.966, val_accuracy=0.758, lr=0.00316] 91%|█████████ | 97/107 [40:14<03:55, 23.53s/epoch, loss=0.564, accuracy=0.871, val_loss=0.796, val_accuracy=0.813, lr=0.01]    92%|█████████▏| 98/107 [40:38<03:32, 23.62s/epoch, loss=0.557, accuracy=0.875, val_loss=0.776, val_accuracy=0.812, lr=0.01] 93%|█████████▎| 99/107 [41:02<03:09, 23.69s/epoch, loss=0.563, accuracy=0.873, val_loss=0.789, val_accuracy=0.798, lr=0.01] 93%|█████████▎| 100/107 [41:25<02:45, 23.61s/epoch, loss=0.56, accuracy=0.876, val_loss=0.742, val_accuracy=0.828, lr=0.01] 94%|█████████▍| 101/107 [41:48<02:20, 23.49s/epoch, loss=0.562, accuracy=0.876, val_loss=0.958, val_accuracy=0.762, lr=0.00316] 95%|█████████▌| 102/107 [42:12<01:57, 23.53s/epoch, loss=0.563, accuracy=0.875, val_loss=0.813, val_accuracy=0.794, lr=0.01]    96%|█████████▋| 103/107 [42:36<01:34, 23.63s/epoch, loss=0.562, accuracy=0.877, val_loss=0.88, val_accuracy=0.775, lr=0.01]  97%|█████████▋| 104/107 [42:59<01:10, 23.55s/epoch, loss=0.557, accuracy=0.878, val_loss=0.988, val_accuracy=0.739, lr=0.01] 98%|█████████▊| 105/107 [43:23<00:47, 23.74s/epoch, loss=0.56, accuracy=0.877, val_loss=0.891, val_accuracy=0.785, lr=0.01]  99%|█████████▉| 106/107 [43:47<00:23, 23.72s/epoch, loss=0.56, accuracy=0.878, val_loss=0.707, val_accuracy=0.827, lr=0.00316]100%|██████████| 107/107 [44:12<00:00, 23.99s/epoch, loss=0.559, accuracy=0.878, val_loss=0.964, val_accuracy=0.766, lr=0.01]  100%|██████████| 107/107 [44:12<00:00, 24.79s/epoch, loss=0.559, accuracy=0.878, val_loss=0.964, val_accuracy=0.766, lr=0.01]
Using real-time data augmentation.
Test loss: 0.9641801714897156
Test accuracy: 0.7656999826431274


* * * Run SGD for ID = 14_3. * * *


2024-02-15 14:34:04.006569: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 14:34:06.941881: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 14:34:06.943205: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-15 14:34:06.982143: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 14:34:06.982177: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 14:34:06.985273: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 14:34:06.985316: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 14:34:06.987843: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 14:34:06.988535: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 14:34:06.991044: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 14:34:06.992618: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 14:34:06.997484: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 14:34:06.998089: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 14:34:06.998175: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 14:34:08.359466: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-15 14:34:08.360496: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 14:34:08.360923: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 14:34:08.360956: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 14:34:08.361011: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 14:34:08.361030: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 14:34:08.361047: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 14:34:08.361064: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 14:34:08.361081: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 14:34:08.361097: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 14:34:08.361115: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 14:34:08.361588: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 14:34:08.361634: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 14:34:09.100756: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-15 14:34:09.100817: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-15 14:34:09.100827: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-15 14:34:09.102324: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:03:00.0, compute capability: 6.1)
{'id': 143, 'batch_size': 128, 'epochs': 107, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/107 [00:00<?, ?epoch/s]2024-02-15 14:34:09.969515: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-15 14:34:09.981835: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199950000 Hz
2024-02-15 14:34:12.231341: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 14:34:12.539281: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 14:34:13.622030: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-15 14:34:13.673049: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/107 [01:07<1:59:16, 67.51s/epoch, loss=3.31, accuracy=0.308, val_loss=2.96, val_accuracy=0.157, lr=0.1]  2%|▏         | 2/107 [01:31<1:12:55, 41.67s/epoch, loss=1.62, accuracy=0.507, val_loss=2.37, val_accuracy=0.298, lr=0.1]  3%|▎         | 3/107 [01:54<58:06, 33.53s/epoch, loss=1.47, accuracy=0.582, val_loss=2.22, val_accuracy=0.405, lr=0.1]    4%|▎         | 4/107 [02:19<51:18, 29.89s/epoch, loss=1.4, accuracy=0.63, val_loss=2.8, val_accuracy=0.365, lr=0.1]     5%|▍         | 5/107 [02:43<47:39, 28.04s/epoch, loss=1.36, accuracy=0.66, val_loss=2.03, val_accuracy=0.481, lr=0.1]  6%|▌         | 6/107 [03:08<45:01, 26.74s/epoch, loss=1.32, accuracy=0.683, val_loss=2.47, val_accuracy=0.368, lr=0.1]  7%|▋         | 7/107 [03:33<43:31, 26.11s/epoch, loss=1.28, accuracy=0.698, val_loss=1.72, val_accuracy=0.561, lr=0.1]  7%|▋         | 8/107 [03:58<42:29, 25.76s/epoch, loss=1.26, accuracy=0.709, val_loss=1.55, val_accuracy=0.596, lr=0.1]  8%|▊         | 9/107 [04:22<41:30, 25.42s/epoch, loss=1.25, accuracy=0.713, val_loss=1.85, val_accuracy=0.495, lr=0.1]  9%|▉         | 10/107 [04:47<40:53, 25.30s/epoch, loss=1.23, accuracy=0.718, val_loss=1.46, val_accuracy=0.637, lr=0.1] 10%|█         | 11/107 [05:12<40:18, 25.19s/epoch, loss=1.22, accuracy=0.725, val_loss=1.89, val_accuracy=0.47, lr=0.1]  11%|█         | 12/107 [05:38<39:57, 25.24s/epoch, loss=1.22, accuracy=0.725, val_loss=2.26, val_accuracy=0.495, lr=0.1] 12%|█▏        | 13/107 [06:03<39:29, 25.21s/epoch, loss=1.21, accuracy=0.732, val_loss=2.05, val_accuracy=0.439, lr=0.1] 13%|█▎        | 14/107 [06:28<39:04, 25.21s/epoch, loss=1.21, accuracy=0.732, val_loss=1.95, val_accuracy=0.514, lr=0.1] 14%|█▍        | 15/107 [06:52<38:14, 24.94s/epoch, loss=1.21, accuracy=0.732, val_loss=2.16, val_accuracy=0.547, lr=0.0316] 15%|█▍        | 16/107 [07:18<38:00, 25.06s/epoch, loss=1.2, accuracy=0.734, val_loss=2.54, val_accuracy=0.449, lr=0.1]     16%|█▌        | 17/107 [07:43<37:41, 25.13s/epoch, loss=1.21, accuracy=0.732, val_loss=1.78, val_accuracy=0.541, lr=0.1] 17%|█▋        | 18/107 [08:08<37:13, 25.10s/epoch, loss=1.2, accuracy=0.736, val_loss=1.66, val_accuracy=0.59, lr=0.1]   18%|█▊        | 19/107 [08:33<36:49, 25.11s/epoch, loss=1.2, accuracy=0.736, val_loss=2.11, val_accuracy=0.51, lr=0.1] 19%|█▊        | 20/107 [08:58<36:16, 25.02s/epoch, loss=1.19, accuracy=0.739, val_loss=2.04, val_accuracy=0.542, lr=0.0316] 20%|█▉        | 21/107 [09:23<35:54, 25.05s/epoch, loss=1.19, accuracy=0.74, val_loss=1.44, val_accuracy=0.651, lr=0.1]     21%|██        | 22/107 [09:48<35:32, 25.09s/epoch, loss=1.19, accuracy=0.741, val_loss=2.51, val_accuracy=0.409, lr=0.1] 21%|██▏       | 23/107 [10:13<35:00, 25.01s/epoch, loss=1.19, accuracy=0.74, val_loss=1.38, val_accuracy=0.672, lr=0.1]  22%|██▏       | 24/107 [10:37<34:21, 24.84s/epoch, loss=1.18, accuracy=0.74, val_loss=1.48, val_accuracy=0.654, lr=0.1] 23%|██▎       | 25/107 [11:02<33:57, 24.84s/epoch, loss=1.18, accuracy=0.742, val_loss=1.93, val_accuracy=0.512, lr=0.1] 24%|██▍       | 26/107 [11:28<33:47, 25.03s/epoch, loss=1.18, accuracy=0.741, val_loss=1.51, val_accuracy=0.626, lr=0.1] 25%|██▌       | 27/107 [11:52<33:03, 24.80s/epoch, loss=1.18, accuracy=0.744, val_loss=2.05, val_accuracy=0.469, lr=0.1] 26%|██▌       | 28/107 [12:16<32:13, 24.47s/epoch, loss=1.17, accuracy=0.746, val_loss=1.6, val_accuracy=0.61, lr=0.0316] 27%|██▋       | 29/107 [12:41<32:05, 24.69s/epoch, loss=1.17, accuracy=0.744, val_loss=2.83, val_accuracy=0.341, lr=0.1]  28%|██▊       | 30/107 [13:06<31:44, 24.73s/epoch, loss=1.17, accuracy=0.745, val_loss=2.84, val_accuracy=0.396, lr=0.1] 29%|██▉       | 31/107 [13:31<31:28, 24.84s/epoch, loss=1.17, accuracy=0.745, val_loss=1.62, val_accuracy=0.601, lr=0.1] 30%|██▉       | 32/107 [13:55<30:43, 24.58s/epoch, loss=1.17, accuracy=0.746, val_loss=1.72, val_accuracy=0.569, lr=0.1] 31%|███       | 33/107 [14:20<30:29, 24.73s/epoch, loss=1.16, accuracy=0.75, val_loss=1.79, val_accuracy=0.518, lr=0.0316] 32%|███▏      | 34/107 [14:45<30:06, 24.74s/epoch, loss=1.16, accuracy=0.748, val_loss=1.58, val_accuracy=0.593, lr=0.1]   33%|███▎      | 35/107 [15:09<29:41, 24.74s/epoch, loss=1.17, accuracy=0.748, val_loss=1.73, val_accuracy=0.572, lr=0.1] 34%|███▎      | 36/107 [15:32<28:41, 24.24s/epoch, loss=1.16, accuracy=0.748, val_loss=2.34, val_accuracy=0.481, lr=0.1] 35%|███▍      | 37/107 [15:56<27:59, 23.99s/epoch, loss=1.16, accuracy=0.75, val_loss=2.92, val_accuracy=0.399, lr=0.1]  36%|███▌      | 38/107 [16:19<27:22, 23.80s/epoch, loss=1.16, accuracy=0.749, val_loss=1.63, val_accuracy=0.607, lr=0.0316] 36%|███▋      | 39/107 [16:44<27:17, 24.08s/epoch, loss=1.16, accuracy=0.747, val_loss=2.92, val_accuracy=0.372, lr=0.1]    37%|███▋      | 40/107 [17:09<27:15, 24.41s/epoch, loss=1.15, accuracy=0.75, val_loss=1.48, val_accuracy=0.636, lr=0.1]  38%|███▊      | 41/107 [17:34<27:01, 24.56s/epoch, loss=1.15, accuracy=0.749, val_loss=1.61, val_accuracy=0.579, lr=0.1] 39%|███▉      | 42/107 [17:59<26:46, 24.72s/epoch, loss=1.15, accuracy=0.75, val_loss=1.83, val_accuracy=0.546, lr=0.1]  40%|████      | 43/107 [18:24<26:24, 24.75s/epoch, loss=1.15, accuracy=0.752, val_loss=2.47, val_accuracy=0.444, lr=0.0316] 41%|████      | 44/107 [18:49<26:06, 24.87s/epoch, loss=1.15, accuracy=0.751, val_loss=2.26, val_accuracy=0.485, lr=0.1]    42%|████▏     | 45/107 [19:14<25:45, 24.93s/epoch, loss=1.15, accuracy=0.751, val_loss=1.7, val_accuracy=0.623, lr=0.1]  43%|████▎     | 46/107 [19:39<25:18, 24.89s/epoch, loss=1.14, accuracy=0.753, val_loss=1.65, val_accuracy=0.585, lr=0.1] 44%|████▍     | 47/107 [20:04<24:49, 24.82s/epoch, loss=1.15, accuracy=0.754, val_loss=2.21, val_accuracy=0.456, lr=0.1] 45%|████▍     | 48/107 [20:29<24:34, 25.00s/epoch, loss=1.15, accuracy=0.75, val_loss=1.82, val_accuracy=0.555, lr=0.0316] 46%|████▌     | 49/107 [20:54<24:06, 24.93s/epoch, loss=1.15, accuracy=0.751, val_loss=1.7, val_accuracy=0.565, lr=0.1]    47%|████▋     | 50/107 [21:19<23:39, 24.90s/epoch, loss=1.14, accuracy=0.754, val_loss=1.78, val_accuracy=0.567, lr=0.1] 48%|████▊     | 51/107 [21:44<23:17, 24.96s/epoch, loss=1.15, accuracy=0.751, val_loss=2.14, val_accuracy=0.432, lr=0.1] 49%|████▊     | 52/107 [22:07<22:25, 24.47s/epoch, loss=1.14, accuracy=0.752, val_loss=1.94, val_accuracy=0.537, lr=0.1] 50%|████▉     | 53/107 [22:31<21:45, 24.18s/epoch, loss=1.15, accuracy=0.752, val_loss=1.56, val_accuracy=0.603, lr=0.0316] 50%|█████     | 54/107 [22:54<21:17, 24.10s/epoch, loss=1.14, accuracy=0.752, val_loss=2.03, val_accuracy=0.559, lr=0.1]    51%|█████▏    | 55/107 [23:18<20:38, 23.82s/epoch, loss=1.13, accuracy=0.755, val_loss=2.18, val_accuracy=0.424, lr=0.1] 52%|█████▏    | 56/107 [23:41<20:09, 23.72s/epoch, loss=1.15, accuracy=0.752, val_loss=3.11, val_accuracy=0.349, lr=0.1] 53%|█████▎    | 57/107 [24:04<19:35, 23.51s/epoch, loss=1.14, accuracy=0.754, val_loss=1.99, val_accuracy=0.502, lr=0.1] 54%|█████▍    | 58/107 [24:29<19:26, 23.82s/epoch, loss=1.15, accuracy=0.753, val_loss=1.6, val_accuracy=0.573, lr=0.0316] 55%|█████▌    | 59/107 [24:53<19:04, 23.84s/epoch, loss=1.14, accuracy=0.754, val_loss=1.74, val_accuracy=0.543, lr=0.1]   56%|█████▌    | 60/107 [25:16<18:32, 23.66s/epoch, loss=1.14, accuracy=0.755, val_loss=1.84, val_accuracy=0.521, lr=0.1] 57%|█████▋    | 61/107 [25:39<18:05, 23.60s/epoch, loss=1.14, accuracy=0.752, val_loss=1.92, val_accuracy=0.536, lr=0.1] 58%|█████▊    | 62/107 [26:04<17:52, 23.83s/epoch, loss=1.14, accuracy=0.753, val_loss=2.48, val_accuracy=0.432, lr=0.1] 59%|█████▉    | 63/107 [26:29<17:43, 24.17s/epoch, loss=1.14, accuracy=0.754, val_loss=2.31, val_accuracy=0.413, lr=0.0316] 60%|█████▉    | 64/107 [26:53<17:28, 24.39s/epoch, loss=1.14, accuracy=0.753, val_loss=3.08, val_accuracy=0.403, lr=0.1]    61%|██████    | 65/107 [27:18<17:03, 24.37s/epoch, loss=1.14, accuracy=0.754, val_loss=1.8, val_accuracy=0.531, lr=0.1]  62%|██████▏   | 66/107 [27:42<16:36, 24.31s/epoch, loss=1.14, accuracy=0.758, val_loss=1.92, val_accuracy=0.485, lr=0.1] 63%|██████▎   | 67/107 [28:06<16:10, 24.25s/epoch, loss=1.13, accuracy=0.756, val_loss=3.04, val_accuracy=0.425, lr=0.1] 64%|██████▎   | 68/107 [28:31<15:57, 24.54s/epoch, loss=1.14, accuracy=0.753, val_loss=1.91, val_accuracy=0.518, lr=0.0316] 64%|██████▍   | 69/107 [28:57<15:40, 24.75s/epoch, loss=1.14, accuracy=0.755, val_loss=2.65, val_accuracy=0.416, lr=0.1]    65%|██████▌   | 70/107 [29:21<15:12, 24.66s/epoch, loss=1.14, accuracy=0.749, val_loss=1.99, val_accuracy=0.444, lr=0.1] 66%|██████▋   | 71/107 [29:46<14:51, 24.77s/epoch, loss=1.13, accuracy=0.755, val_loss=1.65, val_accuracy=0.577, lr=0.1] 67%|██████▋   | 72/107 [30:11<14:25, 24.72s/epoch, loss=1.14, accuracy=0.753, val_loss=2.35, val_accuracy=0.409, lr=0.1] 68%|██████▊   | 73/107 [30:35<14:02, 24.77s/epoch, loss=1.14, accuracy=0.754, val_loss=2.43, val_accuracy=0.413, lr=0.0316] 69%|██████▉   | 74/107 [30:59<13:26, 24.43s/epoch, loss=1.13, accuracy=0.756, val_loss=1.82, val_accuracy=0.592, lr=0.1]    70%|███████   | 75/107 [31:24<13:09, 24.67s/epoch, loss=1.13, accuracy=0.756, val_loss=1.71, val_accuracy=0.559, lr=0.1] 71%|███████   | 76/107 [31:49<12:44, 24.66s/epoch, loss=1.14, accuracy=0.755, val_loss=2.26, val_accuracy=0.448, lr=0.1] 72%|███████▏  | 77/107 [32:14<12:19, 24.64s/epoch, loss=1.14, accuracy=0.754, val_loss=2.38, val_accuracy=0.419, lr=0.1] 73%|███████▎  | 78/107 [32:38<11:54, 24.62s/epoch, loss=1.14, accuracy=0.755, val_loss=1.45, val_accuracy=0.639, lr=0.0316] 74%|███████▍  | 79/107 [33:03<11:32, 24.73s/epoch, loss=1.13, accuracy=0.752, val_loss=1.93, val_accuracy=0.552, lr=0.1]    75%|███████▍  | 80/107 [33:28<11:06, 24.69s/epoch, loss=1.13, accuracy=0.758, val_loss=1.41, val_accuracy=0.647, lr=0.1] 76%|███████▌  | 81/107 [33:53<10:44, 24.78s/epoch, loss=1.14, accuracy=0.753, val_loss=2.98, val_accuracy=0.395, lr=0.1] 77%|███████▋  | 82/107 [34:17<10:17, 24.69s/epoch, loss=0.922, accuracy=0.814, val_loss=0.907, val_accuracy=0.811, lr=0.01] 78%|███████▊  | 83/107 [34:42<09:51, 24.63s/epoch, loss=0.74, accuracy=0.847, val_loss=0.879, val_accuracy=0.785, lr=0.01]  79%|███████▊  | 84/107 [35:05<09:18, 24.30s/epoch, loss=0.656, accuracy=0.855, val_loss=0.803, val_accuracy=0.8, lr=0.01]  79%|███████▉  | 85/107 [35:30<08:58, 24.48s/epoch, loss=0.612, accuracy=0.86, val_loss=0.779, val_accuracy=0.799, lr=0.01] 80%|████████  | 86/107 [35:55<08:35, 24.56s/epoch, loss=0.592, accuracy=0.86, val_loss=0.82, val_accuracy=0.792, lr=0.01]  81%|████████▏ | 87/107 [36:20<08:12, 24.62s/epoch, loss=0.579, accuracy=0.861, val_loss=0.893, val_accuracy=0.765, lr=0.01] 82%|████████▏ | 88/107 [36:45<07:51, 24.79s/epoch, loss=0.575, accuracy=0.861, val_loss=1.03, val_accuracy=0.722, lr=0.01]  83%|████████▎ | 89/107 [37:10<07:25, 24.77s/epoch, loss=0.571, accuracy=0.863, val_loss=0.821, val_accuracy=0.791, lr=0.01] 84%|████████▍ | 90/107 [37:35<07:03, 24.91s/epoch, loss=0.566, accuracy=0.866, val_loss=0.735, val_accuracy=0.813, lr=0.01] 85%|████████▌ | 91/107 [37:59<06:37, 24.83s/epoch, loss=0.566, accuracy=0.867, val_loss=0.834, val_accuracy=0.784, lr=0.01] 86%|████████▌ | 92/107 [38:24<06:12, 24.87s/epoch, loss=0.569, accuracy=0.866, val_loss=0.741, val_accuracy=0.808, lr=0.01] 87%|████████▋ | 93/107 [38:48<05:44, 24.64s/epoch, loss=0.56, accuracy=0.869, val_loss=0.832, val_accuracy=0.793, lr=0.01]  88%|████████▊ | 94/107 [39:14<05:22, 24.79s/epoch, loss=0.565, accuracy=0.868, val_loss=0.874, val_accuracy=0.779, lr=0.01] 89%|████████▉ | 95/107 [39:38<04:56, 24.68s/epoch, loss=0.564, accuracy=0.872, val_loss=0.85, val_accuracy=0.778, lr=0.00316] 90%|████████▉ | 96/107 [40:02<04:29, 24.46s/epoch, loss=0.559, accuracy=0.874, val_loss=0.792, val_accuracy=0.804, lr=0.01]   91%|█████████ | 97/107 [40:26<04:02, 24.22s/epoch, loss=0.557, accuracy=0.875, val_loss=0.81, val_accuracy=0.795, lr=0.01]  92%|█████████▏| 98/107 [40:49<03:34, 23.88s/epoch, loss=0.558, accuracy=0.875, val_loss=0.923, val_accuracy=0.773, lr=0.01] 93%|█████████▎| 99/107 [41:13<03:12, 24.04s/epoch, loss=0.563, accuracy=0.873, val_loss=0.785, val_accuracy=0.801, lr=0.01] 93%|█████████▎| 100/107 [41:38<02:49, 24.28s/epoch, loss=0.564, accuracy=0.876, val_loss=0.833, val_accuracy=0.783, lr=0.00316] 94%|█████████▍| 101/107 [42:02<02:24, 24.10s/epoch, loss=0.558, accuracy=0.878, val_loss=0.753, val_accuracy=0.818, lr=0.01]    95%|█████████▌| 102/107 [42:27<02:02, 24.45s/epoch, loss=0.562, accuracy=0.877, val_loss=0.989, val_accuracy=0.753, lr=0.01] 96%|█████████▋| 103/107 [42:52<01:38, 24.74s/epoch, loss=0.566, accuracy=0.876, val_loss=0.876, val_accuracy=0.789, lr=0.01] 97%|█████████▋| 104/107 [43:17<01:14, 24.85s/epoch, loss=0.56, accuracy=0.879, val_loss=0.728, val_accuracy=0.824, lr=0.01]  98%|█████████▊| 105/107 [43:41<00:48, 24.39s/epoch, loss=0.56, accuracy=0.878, val_loss=0.861, val_accuracy=0.786, lr=0.01] 99%|█████████▉| 106/107 [44:05<00:24, 24.38s/epoch, loss=0.559, accuracy=0.88, val_loss=0.795, val_accuracy=0.806, lr=0.01]100%|██████████| 107/107 [44:29<00:00, 24.31s/epoch, loss=0.566, accuracy=0.879, val_loss=0.776, val_accuracy=0.808, lr=0.01]100%|██████████| 107/107 [44:29<00:00, 24.95s/epoch, loss=0.566, accuracy=0.879, val_loss=0.776, val_accuracy=0.808, lr=0.01]
Using real-time data augmentation.
Test loss: 0.7763077616691589
Test accuracy: 0.8083000183105469


* * * Run SGD for ID = 14_4. * * *


2024-02-15 15:18:42.488801: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 15:18:45.465776: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 15:18:45.467067: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-15 15:18:45.506975: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 15:18:45.507014: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 15:18:45.510176: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 15:18:45.510220: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 15:18:45.512709: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 15:18:45.513401: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 15:18:45.515903: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 15:18:45.517395: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 15:18:45.522550: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 15:18:45.523142: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 15:18:45.523225: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 15:18:46.882880: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-15 15:18:46.883396: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 15:18:46.883840: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 15:18:46.883873: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 15:18:46.883908: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 15:18:46.883928: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 15:18:46.883946: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 15:18:46.883964: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 15:18:46.883982: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 15:18:46.884000: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 15:18:46.884019: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 15:18:46.884490: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 15:18:46.884533: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 15:18:47.630020: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-15 15:18:47.630099: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-15 15:18:47.630119: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-15 15:18:47.631514: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:03:00.0, compute capability: 6.1)
{'id': 144, 'batch_size': 128, 'epochs': 107, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/107 [00:00<?, ?epoch/s]2024-02-15 15:18:48.474105: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-15 15:18:48.485853: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199950000 Hz
2024-02-15 15:18:50.613445: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 15:18:50.889515: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 15:18:51.733910: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-15 15:18:51.783095: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/107 [01:00<1:47:15, 60.71s/epoch, loss=3.25, accuracy=0.292, val_loss=4.65, val_accuracy=0.152, lr=0.1]  2%|▏         | 2/107 [01:23<1:07:17, 38.46s/epoch, loss=1.53, accuracy=0.544, val_loss=6.65, val_accuracy=0.21, lr=0.1]   3%|▎         | 3/107 [01:46<54:08, 31.24s/epoch, loss=1.32, accuracy=0.643, val_loss=4.92, val_accuracy=0.123, lr=0.1]   4%|▎         | 4/107 [02:10<48:58, 28.53s/epoch, loss=1.27, accuracy=0.675, val_loss=1.7, val_accuracy=0.529, lr=0.1]   5%|▍         | 5/107 [02:34<45:39, 26.86s/epoch, loss=1.25, accuracy=0.695, val_loss=2.83, val_accuracy=0.331, lr=0.1]  6%|▌         | 6/107 [02:59<44:06, 26.21s/epoch, loss=1.23, accuracy=0.708, val_loss=1.83, val_accuracy=0.514, lr=0.1]  7%|▋         | 7/107 [03:24<43:04, 25.84s/epoch, loss=1.22, accuracy=0.714, val_loss=2.5, val_accuracy=0.478, lr=0.1]   7%|▋         | 8/107 [03:49<42:02, 25.48s/epoch, loss=1.21, accuracy=0.719, val_loss=2.36, val_accuracy=0.384, lr=0.1]  8%|▊         | 9/107 [04:13<40:53, 25.03s/epoch, loss=1.21, accuracy=0.725, val_loss=2.07, val_accuracy=0.481, lr=0.0316]  9%|▉         | 10/107 [04:38<40:34, 25.09s/epoch, loss=1.2, accuracy=0.727, val_loss=2.7, val_accuracy=0.311, lr=0.1]     10%|█         | 11/107 [05:03<39:57, 24.98s/epoch, loss=1.19, accuracy=0.729, val_loss=1.97, val_accuracy=0.467, lr=0.1] 11%|█         | 12/107 [05:27<39:23, 24.88s/epoch, loss=1.18, accuracy=0.733, val_loss=1.74, val_accuracy=0.538, lr=0.1] 12%|█▏        | 13/107 [05:51<38:34, 24.62s/epoch, loss=1.19, accuracy=0.733, val_loss=2.95, val_accuracy=0.359, lr=0.1] 13%|█▎        | 14/107 [06:16<37:59, 24.51s/epoch, loss=1.18, accuracy=0.737, val_loss=1.85, val_accuracy=0.537, lr=0.0316] 14%|█▍        | 15/107 [06:41<37:46, 24.64s/epoch, loss=1.18, accuracy=0.736, val_loss=1.8, val_accuracy=0.592, lr=0.1]     15%|█▍        | 16/107 [07:05<37:22, 24.65s/epoch, loss=1.18, accuracy=0.736, val_loss=2.51, val_accuracy=0.392, lr=0.1] 16%|█▌        | 17/107 [07:30<37:03, 24.70s/epoch, loss=1.18, accuracy=0.736, val_loss=2.57, val_accuracy=0.458, lr=0.1] 17%|█▋        | 18/107 [07:54<36:06, 24.35s/epoch, loss=1.18, accuracy=0.739, val_loss=1.55, val_accuracy=0.623, lr=0.1] 18%|█▊        | 19/107 [08:18<35:55, 24.50s/epoch, loss=1.17, accuracy=0.741, val_loss=1.84, val_accuracy=0.538, lr=0.1] 19%|█▊        | 20/107 [08:43<35:43, 24.64s/epoch, loss=1.17, accuracy=0.741, val_loss=1.94, val_accuracy=0.514, lr=0.1] 20%|█▉        | 21/107 [09:07<34:56, 24.38s/epoch, loss=1.17, accuracy=0.741, val_loss=1.8, val_accuracy=0.559, lr=0.1]  21%|██        | 22/107 [09:32<34:42, 24.50s/epoch, loss=1.16, accuracy=0.745, val_loss=2.48, val_accuracy=0.396, lr=0.1] 21%|██▏       | 23/107 [09:57<34:22, 24.56s/epoch, loss=1.16, accuracy=0.744, val_loss=1.68, val_accuracy=0.6, lr=0.0316] 22%|██▏       | 24/107 [10:22<34:10, 24.71s/epoch, loss=1.16, accuracy=0.742, val_loss=2.38, val_accuracy=0.404, lr=0.1]  23%|██▎       | 25/107 [10:46<33:39, 24.63s/epoch, loss=1.16, accuracy=0.744, val_loss=4.97, val_accuracy=0.276, lr=0.1] 24%|██▍       | 26/107 [11:11<33:13, 24.61s/epoch, loss=1.16, accuracy=0.747, val_loss=2.4, val_accuracy=0.454, lr=0.1]  25%|██▌       | 27/107 [11:36<33:01, 24.77s/epoch, loss=1.15, accuracy=0.744, val_loss=2.1, val_accuracy=0.512, lr=0.1] 26%|██▌       | 28/107 [12:01<32:41, 24.84s/epoch, loss=1.16, accuracy=0.745, val_loss=2.49, val_accuracy=0.447, lr=0.0316] 27%|██▋       | 29/107 [12:26<32:19, 24.86s/epoch, loss=1.15, accuracy=0.748, val_loss=1.46, val_accuracy=0.632, lr=0.1]    28%|██▊       | 30/107 [12:51<31:58, 24.92s/epoch, loss=1.15, accuracy=0.744, val_loss=1.64, val_accuracy=0.616, lr=0.1] 29%|██▉       | 31/107 [13:16<31:35, 24.95s/epoch, loss=1.16, accuracy=0.747, val_loss=2.29, val_accuracy=0.45, lr=0.1]  30%|██▉       | 32/107 [13:41<31:09, 24.92s/epoch, loss=1.15, accuracy=0.744, val_loss=2.05, val_accuracy=0.495, lr=0.1] 31%|███       | 33/107 [14:06<30:42, 24.89s/epoch, loss=1.15, accuracy=0.745, val_loss=3.87, val_accuracy=0.23, lr=0.1]  32%|███▏      | 34/107 [14:31<30:21, 24.96s/epoch, loss=1.14, accuracy=0.746, val_loss=1.85, val_accuracy=0.571, lr=0.0316] 33%|███▎      | 35/107 [14:56<30:01, 25.02s/epoch, loss=1.14, accuracy=0.748, val_loss=1.69, val_accuracy=0.557, lr=0.1]    34%|███▎      | 36/107 [15:19<29:05, 24.59s/epoch, loss=1.15, accuracy=0.748, val_loss=1.54, val_accuracy=0.62, lr=0.1]  35%|███▍      | 37/107 [15:43<28:25, 24.37s/epoch, loss=1.15, accuracy=0.748, val_loss=2.71, val_accuracy=0.459, lr=0.1] 36%|███▌      | 38/107 [16:09<28:22, 24.67s/epoch, loss=1.15, accuracy=0.748, val_loss=2.41, val_accuracy=0.45, lr=0.1]  36%|███▋      | 39/107 [16:34<28:03, 24.75s/epoch, loss=1.14, accuracy=0.75, val_loss=2.89, val_accuracy=0.453, lr=0.0316] 37%|███▋      | 40/107 [16:59<27:49, 24.91s/epoch, loss=1.14, accuracy=0.75, val_loss=4.37, val_accuracy=0.333, lr=0.1]    38%|███▊      | 41/107 [17:24<27:28, 24.98s/epoch, loss=1.14, accuracy=0.749, val_loss=2.12, val_accuracy=0.431, lr=0.1] 39%|███▉      | 42/107 [17:49<27:08, 25.05s/epoch, loss=1.14, accuracy=0.75, val_loss=1.82, val_accuracy=0.507, lr=0.1]  40%|████      | 43/107 [18:13<26:23, 24.75s/epoch, loss=1.12, accuracy=0.753, val_loss=1.48, val_accuracy=0.652, lr=0.1] 41%|████      | 44/107 [18:38<25:51, 24.63s/epoch, loss=1.13, accuracy=0.752, val_loss=4.43, val_accuracy=0.297, lr=0.0316] 42%|████▏     | 45/107 [19:03<25:32, 24.72s/epoch, loss=1.14, accuracy=0.75, val_loss=1.85, val_accuracy=0.506, lr=0.1]     43%|████▎     | 46/107 [19:27<25:07, 24.72s/epoch, loss=1.13, accuracy=0.752, val_loss=2.18, val_accuracy=0.467, lr=0.1] 44%|████▍     | 47/107 [19:52<24:48, 24.80s/epoch, loss=1.13, accuracy=0.752, val_loss=1.73, val_accuracy=0.583, lr=0.1] 45%|████▍     | 48/107 [20:18<24:32, 24.95s/epoch, loss=1.14, accuracy=0.751, val_loss=1.37, val_accuracy=0.679, lr=0.1] 46%|████▌     | 49/107 [20:43<24:12, 25.05s/epoch, loss=1.13, accuracy=0.753, val_loss=2.51, val_accuracy=0.396, lr=0.1] 47%|████▋     | 50/107 [21:08<23:51, 25.12s/epoch, loss=1.14, accuracy=0.752, val_loss=3.92, val_accuracy=0.228, lr=0.1] 48%|████▊     | 51/107 [21:33<23:18, 24.97s/epoch, loss=1.13, accuracy=0.754, val_loss=2.58, val_accuracy=0.307, lr=0.1] 49%|████▊     | 52/107 [21:58<23:00, 25.10s/epoch, loss=1.13, accuracy=0.755, val_loss=2.21, val_accuracy=0.446, lr=0.1] 50%|████▉     | 53/107 [22:22<22:20, 24.83s/epoch, loss=1.13, accuracy=0.755, val_loss=1.91, val_accuracy=0.521, lr=0.0316] 50%|█████     | 54/107 [22:46<21:35, 24.45s/epoch, loss=1.13, accuracy=0.752, val_loss=1.61, val_accuracy=0.586, lr=0.1]    51%|█████▏    | 55/107 [23:11<21:20, 24.62s/epoch, loss=1.13, accuracy=0.754, val_loss=2.03, val_accuracy=0.502, lr=0.1] 52%|█████▏    | 56/107 [23:36<20:59, 24.70s/epoch, loss=1.13, accuracy=0.754, val_loss=2.03, val_accuracy=0.489, lr=0.1] 53%|█████▎    | 57/107 [24:01<20:39, 24.79s/epoch, loss=1.13, accuracy=0.753, val_loss=3.54, val_accuracy=0.298, lr=0.1] 54%|█████▍    | 58/107 [24:26<20:17, 24.84s/epoch, loss=1.13, accuracy=0.755, val_loss=2.14, val_accuracy=0.518, lr=0.0316] 55%|█████▌    | 59/107 [24:51<19:57, 24.95s/epoch, loss=1.13, accuracy=0.752, val_loss=1.79, val_accuracy=0.524, lr=0.1]    56%|█████▌    | 60/107 [25:16<19:29, 24.89s/epoch, loss=1.12, accuracy=0.755, val_loss=2.7, val_accuracy=0.43, lr=0.1]   57%|█████▋    | 61/107 [25:41<19:04, 24.88s/epoch, loss=1.13, accuracy=0.755, val_loss=3.89, val_accuracy=0.303, lr=0.1] 58%|█████▊    | 62/107 [26:05<18:35, 24.79s/epoch, loss=1.12, accuracy=0.752, val_loss=6.34, val_accuracy=0.191, lr=0.1] 59%|█████▉    | 63/107 [26:30<18:09, 24.77s/epoch, loss=1.13, accuracy=0.753, val_loss=2.48, val_accuracy=0.442, lr=0.0316] 60%|█████▉    | 64/107 [26:55<17:52, 24.95s/epoch, loss=1.13, accuracy=0.754, val_loss=1.8, val_accuracy=0.508, lr=0.1]     61%|██████    | 65/107 [27:19<17:16, 24.67s/epoch, loss=1.13, accuracy=0.754, val_loss=1.99, val_accuracy=0.481, lr=0.1] 62%|██████▏   | 66/107 [27:44<16:50, 24.65s/epoch, loss=1.12, accuracy=0.756, val_loss=1.82, val_accuracy=0.493, lr=0.1] 63%|██████▎   | 67/107 [28:09<16:27, 24.70s/epoch, loss=1.14, accuracy=0.753, val_loss=1.66, val_accuracy=0.595, lr=0.1] 64%|██████▎   | 68/107 [28:34<16:06, 24.79s/epoch, loss=1.13, accuracy=0.753, val_loss=1.58, val_accuracy=0.591, lr=0.0316] 64%|██████▍   | 69/107 [28:58<15:41, 24.78s/epoch, loss=1.12, accuracy=0.757, val_loss=3.13, val_accuracy=0.341, lr=0.1]    65%|██████▌   | 70/107 [29:24<15:21, 24.91s/epoch, loss=1.12, accuracy=0.757, val_loss=2.54, val_accuracy=0.356, lr=0.1] 66%|██████▋   | 71/107 [29:48<14:50, 24.74s/epoch, loss=1.12, accuracy=0.755, val_loss=1.87, val_accuracy=0.542, lr=0.1] 67%|██████▋   | 72/107 [30:13<14:25, 24.73s/epoch, loss=1.13, accuracy=0.755, val_loss=2.17, val_accuracy=0.479, lr=0.1] 68%|██████▊   | 73/107 [30:37<13:56, 24.60s/epoch, loss=1.12, accuracy=0.757, val_loss=1.78, val_accuracy=0.531, lr=0.0316] 69%|██████▉   | 74/107 [31:02<13:34, 24.70s/epoch, loss=1.12, accuracy=0.753, val_loss=3.05, val_accuracy=0.3, lr=0.1]      70%|███████   | 75/107 [31:27<13:14, 24.82s/epoch, loss=1.13, accuracy=0.756, val_loss=4.3, val_accuracy=0.309, lr=0.1] 71%|███████   | 76/107 [31:52<12:51, 24.90s/epoch, loss=1.12, accuracy=0.755, val_loss=1.53, val_accuracy=0.612, lr=0.1] 72%|███████▏  | 77/107 [32:16<12:20, 24.70s/epoch, loss=1.13, accuracy=0.753, val_loss=3.38, val_accuracy=0.341, lr=0.1] 73%|███████▎  | 78/107 [32:40<11:51, 24.53s/epoch, loss=1.12, accuracy=0.755, val_loss=4.33, val_accuracy=0.285, lr=0.0316] 74%|███████▍  | 79/107 [33:06<11:32, 24.74s/epoch, loss=1.12, accuracy=0.757, val_loss=2.24, val_accuracy=0.403, lr=0.1]    75%|███████▍  | 80/107 [33:31<11:08, 24.77s/epoch, loss=1.12, accuracy=0.755, val_loss=1.95, val_accuracy=0.511, lr=0.1] 76%|███████▌  | 81/107 [33:55<10:44, 24.79s/epoch, loss=1.12, accuracy=0.758, val_loss=2.12, val_accuracy=0.474, lr=0.1] 77%|███████▋  | 82/107 [34:20<10:21, 24.86s/epoch, loss=0.903, accuracy=0.816, val_loss=0.89, val_accuracy=0.802, lr=0.01] 78%|███████▊  | 83/107 [34:45<09:58, 24.92s/epoch, loss=0.726, accuracy=0.848, val_loss=0.84, val_accuracy=0.795, lr=0.01] 79%|███████▊  | 84/107 [35:10<09:31, 24.83s/epoch, loss=0.653, accuracy=0.854, val_loss=0.797, val_accuracy=0.798, lr=0.01] 79%|███████▉  | 85/107 [35:35<09:07, 24.87s/epoch, loss=0.61, accuracy=0.858, val_loss=0.959, val_accuracy=0.742, lr=0.01]  80%|████████  | 86/107 [36:00<08:43, 24.95s/epoch, loss=0.589, accuracy=0.858, val_loss=1.02, val_accuracy=0.725, lr=0.01] 81%|████████▏ | 87/107 [36:25<08:20, 25.03s/epoch, loss=0.577, accuracy=0.859, val_loss=0.787, val_accuracy=0.785, lr=0.01] 82%|████████▏ | 88/107 [36:51<07:55, 25.05s/epoch, loss=0.578, accuracy=0.859, val_loss=0.858, val_accuracy=0.763, lr=0.01] 83%|████████▎ | 89/107 [37:15<07:27, 24.83s/epoch, loss=0.568, accuracy=0.863, val_loss=0.769, val_accuracy=0.795, lr=0.01] 84%|████████▍ | 90/107 [37:39<06:59, 24.66s/epoch, loss=0.567, accuracy=0.863, val_loss=0.994, val_accuracy=0.734, lr=0.01] 85%|████████▌ | 91/107 [38:04<06:36, 24.78s/epoch, loss=0.564, accuracy=0.865, val_loss=0.687, val_accuracy=0.823, lr=0.01] 86%|████████▌ | 92/107 [38:29<06:11, 24.74s/epoch, loss=0.565, accuracy=0.864, val_loss=1.08, val_accuracy=0.73, lr=0.01]   87%|████████▋ | 93/107 [38:52<05:40, 24.29s/epoch, loss=0.561, accuracy=0.867, val_loss=1.08, val_accuracy=0.696, lr=0.01] 88%|████████▊ | 94/107 [39:15<05:12, 24.03s/epoch, loss=0.565, accuracy=0.869, val_loss=0.855, val_accuracy=0.774, lr=0.01] 89%|████████▉ | 95/107 [39:40<04:48, 24.03s/epoch, loss=0.566, accuracy=0.867, val_loss=0.9, val_accuracy=0.764, lr=0.01]   90%|████████▉ | 96/107 [40:04<04:24, 24.04s/epoch, loss=0.562, accuracy=0.871, val_loss=0.726, val_accuracy=0.815, lr=0.00316] 91%|█████████ | 97/107 [40:27<03:57, 23.79s/epoch, loss=0.559, accuracy=0.872, val_loss=0.842, val_accuracy=0.786, lr=0.01]    92%|█████████▏| 98/107 [40:51<03:34, 23.84s/epoch, loss=0.562, accuracy=0.871, val_loss=1.1, val_accuracy=0.721, lr=0.01]   93%|█████████▎| 99/107 [41:14<03:09, 23.68s/epoch, loss=0.561, accuracy=0.872, val_loss=0.918, val_accuracy=0.761, lr=0.01] 93%|█████████▎| 100/107 [41:37<02:44, 23.54s/epoch, loss=0.563, accuracy=0.872, val_loss=0.779, val_accuracy=0.808, lr=0.01] 94%|█████████▍| 101/107 [42:00<02:20, 23.37s/epoch, loss=0.558, accuracy=0.874, val_loss=0.804, val_accuracy=0.795, lr=0.00316] 95%|█████████▌| 102/107 [42:24<01:56, 23.36s/epoch, loss=0.558, accuracy=0.875, val_loss=0.994, val_accuracy=0.748, lr=0.01]    96%|█████████▋| 103/107 [42:48<01:34, 23.63s/epoch, loss=0.559, accuracy=0.876, val_loss=0.879, val_accuracy=0.779, lr=0.01] 97%|█████████▋| 104/107 [43:11<01:10, 23.45s/epoch, loss=0.562, accuracy=0.873, val_loss=0.777, val_accuracy=0.804, lr=0.01] 98%|█████████▊| 105/107 [43:36<00:47, 23.92s/epoch, loss=0.56, accuracy=0.874, val_loss=0.844, val_accuracy=0.79, lr=0.01]   99%|█████████▉| 106/107 [44:00<00:23, 23.85s/epoch, loss=0.559, accuracy=0.876, val_loss=0.879, val_accuracy=0.773, lr=0.00316]100%|██████████| 107/107 [44:23<00:00, 23.79s/epoch, loss=0.561, accuracy=0.876, val_loss=0.897, val_accuracy=0.774, lr=0.01]   100%|██████████| 107/107 [44:23<00:00, 24.89s/epoch, loss=0.561, accuracy=0.876, val_loss=0.897, val_accuracy=0.774, lr=0.01]
Using real-time data augmentation.
Test loss: 0.8967688679695129
Test accuracy: 0.7739999890327454


* * * Run SGD for ID = 14_5. * * *


2024-02-15 16:03:15.154573: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 16:03:19.312279: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 16:03:19.313660: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-15 16:03:19.353366: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 16:03:19.353403: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 16:03:19.356442: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 16:03:19.356485: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 16:03:19.358917: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 16:03:19.359625: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 16:03:19.362284: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 16:03:19.363864: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 16:03:19.368908: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 16:03:19.369549: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 16:03:19.369630: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 16:03:20.738394: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-15 16:03:20.739483: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 16:03:20.739943: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 16:03:20.739979: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 16:03:20.740016: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 16:03:20.740036: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 16:03:20.740054: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 16:03:20.740072: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 16:03:20.740090: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 16:03:20.740108: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 16:03:20.740137: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 16:03:20.740614: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 16:03:20.740655: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 16:03:21.483808: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-15 16:03:21.483862: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-15 16:03:21.483873: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-15 16:03:21.485310: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:03:00.0, compute capability: 6.1)
{'id': 145, 'batch_size': 128, 'epochs': 107, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/107 [00:00<?, ?epoch/s]2024-02-15 16:03:22.345644: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-15 16:03:22.357823: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199950000 Hz
2024-02-15 16:03:24.623512: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 16:03:24.861141: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 16:03:25.663433: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-15 16:03:25.720379: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/107 [01:03<1:51:57, 63.37s/epoch, loss=3.36, accuracy=0.268, val_loss=2.29, val_accuracy=0.257, lr=0.1]  2%|▏         | 2/107 [01:27<1:10:28, 40.27s/epoch, loss=1.69, accuracy=0.455, val_loss=1.92, val_accuracy=0.422, lr=0.1]  3%|▎         | 3/107 [01:52<58:04, 33.51s/epoch, loss=1.47, accuracy=0.564, val_loss=1.84, val_accuracy=0.453, lr=0.1]    4%|▎         | 4/107 [02:17<51:15, 29.86s/epoch, loss=1.32, accuracy=0.647, val_loss=3.45, val_accuracy=0.328, lr=0.1]  5%|▍         | 5/107 [02:41<47:03, 27.68s/epoch, loss=1.26, accuracy=0.685, val_loss=1.81, val_accuracy=0.483, lr=0.1]  6%|▌         | 6/107 [03:04<44:26, 26.40s/epoch, loss=1.24, accuracy=0.701, val_loss=3.4, val_accuracy=0.371, lr=0.1]   7%|▋         | 7/107 [03:28<42:34, 25.55s/epoch, loss=1.22, accuracy=0.712, val_loss=1.89, val_accuracy=0.541, lr=0.1]  7%|▋         | 8/107 [03:53<41:31, 25.16s/epoch, loss=1.22, accuracy=0.717, val_loss=2.52, val_accuracy=0.361, lr=0.1]  8%|▊         | 9/107 [04:17<40:29, 24.79s/epoch, loss=1.21, accuracy=0.723, val_loss=1.99, val_accuracy=0.56, lr=0.1]   9%|▉         | 10/107 [04:40<39:33, 24.47s/epoch, loss=1.23, accuracy=0.724, val_loss=2.13, val_accuracy=0.488, lr=0.0316] 10%|█         | 11/107 [05:05<39:22, 24.61s/epoch, loss=1.21, accuracy=0.728, val_loss=2.51, val_accuracy=0.308, lr=0.1]    11%|█         | 12/107 [05:31<39:20, 24.84s/epoch, loss=1.2, accuracy=0.731, val_loss=1.79, val_accuracy=0.566, lr=0.1]  12%|█▏        | 13/107 [05:56<39:13, 25.04s/epoch, loss=1.2, accuracy=0.733, val_loss=1.63, val_accuracy=0.59, lr=0.1]  13%|█▎        | 14/107 [06:22<39:17, 25.35s/epoch, loss=1.2, accuracy=0.736, val_loss=2.1, val_accuracy=0.463, lr=0.1] 14%|█▍        | 15/107 [06:46<38:12, 24.92s/epoch, loss=1.2, accuracy=0.736, val_loss=1.95, val_accuracy=0.451, lr=0.1] 15%|█▍        | 16/107 [07:10<37:32, 24.75s/epoch, loss=1.19, accuracy=0.738, val_loss=2.34, val_accuracy=0.387, lr=0.1] 16%|█▌        | 17/107 [07:34<36:41, 24.47s/epoch, loss=1.19, accuracy=0.738, val_loss=3.72, val_accuracy=0.322, lr=0.1] 17%|█▋        | 18/107 [07:58<35:58, 24.26s/epoch, loss=1.19, accuracy=0.737, val_loss=1.62, val_accuracy=0.579, lr=0.1] 18%|█▊        | 19/107 [08:22<35:34, 24.25s/epoch, loss=1.19, accuracy=0.737, val_loss=2.14, val_accuracy=0.451, lr=0.1] 19%|█▊        | 20/107 [08:47<35:18, 24.35s/epoch, loss=1.19, accuracy=0.741, val_loss=2.48, val_accuracy=0.393, lr=0.1] 20%|█▉        | 21/107 [09:11<34:42, 24.21s/epoch, loss=1.19, accuracy=0.742, val_loss=2.19, val_accuracy=0.488, lr=0.1] 21%|██        | 22/107 [09:35<34:22, 24.27s/epoch, loss=1.18, accuracy=0.743, val_loss=1.95, val_accuracy=0.528, lr=0.1] 21%|██▏       | 23/107 [09:59<34:00, 24.29s/epoch, loss=1.18, accuracy=0.743, val_loss=2.88, val_accuracy=0.38, lr=0.0316] 22%|██▏       | 24/107 [10:24<33:51, 24.48s/epoch, loss=1.18, accuracy=0.743, val_loss=1.96, val_accuracy=0.541, lr=0.1]   23%|██▎       | 25/107 [10:51<34:08, 24.98s/epoch, loss=1.17, accuracy=0.744, val_loss=2.08, val_accuracy=0.501, lr=0.1] 24%|██▍       | 26/107 [11:15<33:20, 24.69s/epoch, loss=1.17, accuracy=0.745, val_loss=3.01, val_accuracy=0.359, lr=0.1] 25%|██▌       | 27/107 [11:40<33:04, 24.81s/epoch, loss=1.17, accuracy=0.746, val_loss=2.17, val_accuracy=0.51, lr=0.1]  26%|██▌       | 28/107 [12:05<32:53, 24.98s/epoch, loss=1.17, accuracy=0.745, val_loss=2.83, val_accuracy=0.322, lr=0.0316] 27%|██▋       | 29/107 [12:30<32:28, 24.98s/epoch, loss=1.17, accuracy=0.745, val_loss=2.09, val_accuracy=0.512, lr=0.1]    28%|██▊       | 30/107 [12:54<31:49, 24.80s/epoch, loss=1.17, accuracy=0.746, val_loss=2.6, val_accuracy=0.468, lr=0.1]  29%|██▉       | 31/107 [13:20<31:50, 25.13s/epoch, loss=1.18, accuracy=0.747, val_loss=3.93, val_accuracy=0.288, lr=0.1] 30%|██▉       | 32/107 [13:46<31:47, 25.43s/epoch, loss=1.17, accuracy=0.747, val_loss=2.94, val_accuracy=0.397, lr=0.1] 31%|███       | 33/107 [14:12<31:24, 25.47s/epoch, loss=1.17, accuracy=0.747, val_loss=1.57, val_accuracy=0.617, lr=0.1] 32%|███▏      | 34/107 [14:37<30:58, 25.47s/epoch, loss=1.16, accuracy=0.75, val_loss=1.87, val_accuracy=0.562, lr=0.1]  33%|███▎      | 35/107 [15:03<30:46, 25.64s/epoch, loss=1.16, accuracy=0.747, val_loss=2.1, val_accuracy=0.491, lr=0.1] 34%|███▎      | 36/107 [15:28<30:02, 25.38s/epoch, loss=1.17, accuracy=0.747, val_loss=1.7, val_accuracy=0.578, lr=0.1] 35%|███▍      | 37/107 [15:54<29:48, 25.54s/epoch, loss=1.16, accuracy=0.754, val_loss=1.44, val_accuracy=0.652, lr=0.1] 36%|███▌      | 38/107 [16:20<29:32, 25.69s/epoch, loss=1.16, accuracy=0.75, val_loss=1.92, val_accuracy=0.534, lr=0.1]  36%|███▋      | 39/107 [16:46<29:09, 25.73s/epoch, loss=1.16, accuracy=0.749, val_loss=2.74, val_accuracy=0.43, lr=0.1] 37%|███▋      | 40/107 [17:12<28:46, 25.78s/epoch, loss=1.16, accuracy=0.749, val_loss=2.54, val_accuracy=0.486, lr=0.1] 38%|███▊      | 41/107 [17:36<27:57, 25.41s/epoch, loss=1.15, accuracy=0.752, val_loss=1.83, val_accuracy=0.532, lr=0.1] 39%|███▉      | 42/107 [18:03<27:44, 25.60s/epoch, loss=1.15, accuracy=0.751, val_loss=1.65, val_accuracy=0.582, lr=0.0316] 40%|████      | 43/107 [18:28<27:18, 25.60s/epoch, loss=1.15, accuracy=0.75, val_loss=1.51, val_accuracy=0.633, lr=0.1]     41%|████      | 44/107 [18:53<26:31, 25.26s/epoch, loss=1.15, accuracy=0.754, val_loss=1.65, val_accuracy=0.578, lr=0.1] 42%|████▏     | 45/107 [19:18<26:02, 25.21s/epoch, loss=1.14, accuracy=0.751, val_loss=2.29, val_accuracy=0.438, lr=0.1] 43%|████▎     | 46/107 [19:42<25:26, 25.03s/epoch, loss=1.15, accuracy=0.751, val_loss=1.76, val_accuracy=0.542, lr=0.1] 44%|████▍     | 47/107 [20:08<25:11, 25.19s/epoch, loss=1.15, accuracy=0.754, val_loss=1.81, val_accuracy=0.552, lr=0.0316] 45%|████▍     | 48/107 [20:34<25:01, 25.45s/epoch, loss=1.15, accuracy=0.75, val_loss=1.86, val_accuracy=0.523, lr=0.1]     46%|████▌     | 49/107 [20:58<24:15, 25.10s/epoch, loss=1.15, accuracy=0.751, val_loss=1.51, val_accuracy=0.617, lr=0.1] 47%|████▋     | 50/107 [21:23<23:53, 25.14s/epoch, loss=1.15, accuracy=0.752, val_loss=3.47, val_accuracy=0.32, lr=0.1]  48%|████▊     | 51/107 [21:49<23:27, 25.13s/epoch, loss=1.14, accuracy=0.752, val_loss=3.4, val_accuracy=0.378, lr=0.1] 49%|████▊     | 52/107 [22:14<23:03, 25.16s/epoch, loss=1.14, accuracy=0.752, val_loss=2.09, val_accuracy=0.518, lr=0.0316] 50%|████▉     | 53/107 [22:39<22:47, 25.33s/epoch, loss=1.13, accuracy=0.757, val_loss=1.68, val_accuracy=0.59, lr=0.1]     50%|█████     | 54/107 [23:04<22:10, 25.11s/epoch, loss=1.14, accuracy=0.754, val_loss=2.03, val_accuracy=0.491, lr=0.1] 51%|█████▏    | 55/107 [23:30<21:56, 25.31s/epoch, loss=1.14, accuracy=0.755, val_loss=2.23, val_accuracy=0.395, lr=0.1] 52%|█████▏    | 56/107 [23:56<21:40, 25.50s/epoch, loss=1.14, accuracy=0.758, val_loss=2.55, val_accuracy=0.391, lr=0.1] 53%|█████▎    | 57/107 [24:22<21:20, 25.60s/epoch, loss=1.14, accuracy=0.753, val_loss=5.24, val_accuracy=0.207, lr=0.0316] 54%|█████▍    | 58/107 [24:47<20:49, 25.49s/epoch, loss=1.13, accuracy=0.756, val_loss=3.76, val_accuracy=0.262, lr=0.1]    55%|█████▌    | 59/107 [25:13<20:27, 25.57s/epoch, loss=1.14, accuracy=0.754, val_loss=2.2, val_accuracy=0.518, lr=0.1]  56%|█████▌    | 60/107 [25:37<19:44, 25.19s/epoch, loss=1.13, accuracy=0.755, val_loss=4.47, val_accuracy=0.156, lr=0.1] 57%|█████▋    | 61/107 [26:03<19:28, 25.40s/epoch, loss=1.13, accuracy=0.757, val_loss=2.84, val_accuracy=0.381, lr=0.1] 58%|█████▊    | 62/107 [26:29<19:10, 25.57s/epoch, loss=1.14, accuracy=0.754, val_loss=1.75, val_accuracy=0.583, lr=0.0316] 59%|█████▉    | 63/107 [26:54<18:42, 25.50s/epoch, loss=1.13, accuracy=0.755, val_loss=1.95, val_accuracy=0.568, lr=0.1]    60%|█████▉    | 64/107 [27:19<18:02, 25.18s/epoch, loss=1.14, accuracy=0.753, val_loss=4.02, val_accuracy=0.277, lr=0.1] 61%|██████    | 65/107 [27:45<17:47, 25.43s/epoch, loss=1.13, accuracy=0.754, val_loss=2.02, val_accuracy=0.485, lr=0.1] 62%|██████▏   | 66/107 [28:10<17:27, 25.56s/epoch, loss=1.13, accuracy=0.755, val_loss=2.05, val_accuracy=0.493, lr=0.1] 63%|██████▎   | 67/107 [28:35<16:47, 25.18s/epoch, loss=1.13, accuracy=0.756, val_loss=2.51, val_accuracy=0.328, lr=0.0316] 64%|██████▎   | 68/107 [29:00<16:28, 25.35s/epoch, loss=1.12, accuracy=0.756, val_loss=1.85, val_accuracy=0.534, lr=0.1]    64%|██████▍   | 69/107 [29:25<15:54, 25.13s/epoch, loss=1.13, accuracy=0.757, val_loss=1.65, val_accuracy=0.601, lr=0.1] 65%|██████▌   | 70/107 [29:51<15:35, 25.28s/epoch, loss=1.13, accuracy=0.758, val_loss=1.56, val_accuracy=0.608, lr=0.1] 66%|██████▋   | 71/107 [30:16<15:14, 25.40s/epoch, loss=1.13, accuracy=0.756, val_loss=2.06, val_accuracy=0.467, lr=0.1] 67%|██████▋   | 72/107 [30:42<14:51, 25.46s/epoch, loss=1.13, accuracy=0.755, val_loss=1.58, val_accuracy=0.587, lr=0.0316] 68%|██████▊   | 73/107 [31:06<14:12, 25.08s/epoch, loss=1.13, accuracy=0.757, val_loss=1.86, val_accuracy=0.526, lr=0.1]    69%|██████▉   | 74/107 [31:32<13:53, 25.27s/epoch, loss=1.12, accuracy=0.758, val_loss=1.61, val_accuracy=0.575, lr=0.1] 70%|███████   | 75/107 [31:58<13:36, 25.52s/epoch, loss=1.12, accuracy=0.759, val_loss=2.37, val_accuracy=0.371, lr=0.1] 71%|███████   | 76/107 [32:23<13:10, 25.49s/epoch, loss=1.12, accuracy=0.759, val_loss=2, val_accuracy=0.489, lr=0.1]    72%|███████▏  | 77/107 [32:49<12:48, 25.62s/epoch, loss=1.12, accuracy=0.758, val_loss=1.64, val_accuracy=0.599, lr=0.0316] 73%|███████▎  | 78/107 [33:14<12:10, 25.17s/epoch, loss=1.12, accuracy=0.758, val_loss=2.99, val_accuracy=0.36, lr=0.1]     74%|███████▍  | 79/107 [33:39<11:50, 25.36s/epoch, loss=1.12, accuracy=0.755, val_loss=1.87, val_accuracy=0.54, lr=0.1] 75%|███████▍  | 80/107 [34:05<11:29, 25.54s/epoch, loss=1.12, accuracy=0.758, val_loss=3.13, val_accuracy=0.419, lr=0.1] 76%|███████▌  | 81/107 [34:31<11:04, 25.56s/epoch, loss=1.12, accuracy=0.757, val_loss=2.76, val_accuracy=0.357, lr=0.1] 77%|███████▋  | 82/107 [34:57<10:40, 25.62s/epoch, loss=0.929, accuracy=0.813, val_loss=0.905, val_accuracy=0.803, lr=0.01] 78%|███████▊  | 83/107 [35:23<10:17, 25.74s/epoch, loss=0.738, accuracy=0.849, val_loss=0.794, val_accuracy=0.816, lr=0.01] 79%|███████▊  | 84/107 [35:49<09:55, 25.89s/epoch, loss=0.652, accuracy=0.858, val_loss=0.748, val_accuracy=0.819, lr=0.01] 79%|███████▉  | 85/107 [36:15<09:29, 25.87s/epoch, loss=0.607, accuracy=0.86, val_loss=0.729, val_accuracy=0.818, lr=0.01]  80%|████████  | 86/107 [36:40<09:01, 25.77s/epoch, loss=0.588, accuracy=0.86, val_loss=0.755, val_accuracy=0.802, lr=0.01] 81%|████████▏ | 87/107 [37:05<08:28, 25.44s/epoch, loss=0.573, accuracy=0.864, val_loss=1.06, val_accuracy=0.714, lr=0.01] 82%|████████▏ | 88/107 [37:30<08:02, 25.40s/epoch, loss=0.565, accuracy=0.867, val_loss=0.756, val_accuracy=0.806, lr=0.01] 83%|████████▎ | 89/107 [37:55<07:35, 25.31s/epoch, loss=0.565, accuracy=0.865, val_loss=0.85, val_accuracy=0.772, lr=0.01]  84%|████████▍ | 90/107 [38:21<07:11, 25.37s/epoch, loss=0.561, accuracy=0.868, val_loss=1.08, val_accuracy=0.706, lr=0.00316] 85%|████████▌ | 91/107 [38:46<06:44, 25.26s/epoch, loss=0.56, accuracy=0.869, val_loss=0.733, val_accuracy=0.814, lr=0.01]    86%|████████▌ | 92/107 [39:11<06:17, 25.17s/epoch, loss=0.555, accuracy=0.872, val_loss=0.907, val_accuracy=0.77, lr=0.01] 87%|████████▋ | 93/107 [39:36<05:52, 25.19s/epoch, loss=0.555, accuracy=0.872, val_loss=0.921, val_accuracy=0.765, lr=0.01] 88%|████████▊ | 94/107 [40:01<05:27, 25.23s/epoch, loss=0.553, accuracy=0.874, val_loss=0.736, val_accuracy=0.811, lr=0.01] 89%|████████▉ | 95/107 [40:26<05:00, 25.04s/epoch, loss=0.557, accuracy=0.874, val_loss=0.847, val_accuracy=0.77, lr=0.00316] 90%|████████▉ | 96/107 [40:51<04:34, 24.98s/epoch, loss=0.553, accuracy=0.874, val_loss=1.1, val_accuracy=0.725, lr=0.01]     91%|█████████ | 97/107 [41:17<04:12, 25.24s/epoch, loss=0.551, accuracy=0.876, val_loss=0.82, val_accuracy=0.808, lr=0.01] 92%|█████████▏| 98/107 [41:42<03:47, 25.33s/epoch, loss=0.551, accuracy=0.877, val_loss=1.08, val_accuracy=0.737, lr=0.01] 93%|█████████▎| 99/107 [42:08<03:23, 25.42s/epoch, loss=0.556, accuracy=0.876, val_loss=0.72, val_accuracy=0.82, lr=0.01]  93%|█████████▎| 100/107 [42:33<02:58, 25.45s/epoch, loss=0.55, accuracy=0.879, val_loss=0.804, val_accuracy=0.797, lr=0.01] 94%|█████████▍| 101/107 [42:59<02:33, 25.51s/epoch, loss=0.549, accuracy=0.88, val_loss=1.02, val_accuracy=0.726, lr=0.01]  95%|█████████▌| 102/107 [43:25<02:07, 25.52s/epoch, loss=0.551, accuracy=0.879, val_loss=1.46, val_accuracy=0.662, lr=0.01] 96%|█████████▋| 103/107 [43:50<01:41, 25.45s/epoch, loss=0.545, accuracy=0.882, val_loss=0.828, val_accuracy=0.799, lr=0.01] 97%|█████████▋| 104/107 [44:15<01:15, 25.33s/epoch, loss=0.552, accuracy=0.881, val_loss=0.934, val_accuracy=0.777, lr=0.00316] 98%|█████████▊| 105/107 [44:41<00:50, 25.44s/epoch, loss=0.551, accuracy=0.882, val_loss=0.803, val_accuracy=0.798, lr=0.01]    99%|█████████▉| 106/107 [45:05<00:25, 25.29s/epoch, loss=0.552, accuracy=0.881, val_loss=0.758, val_accuracy=0.813, lr=0.01]100%|██████████| 107/107 [45:31<00:00, 25.33s/epoch, loss=0.552, accuracy=0.882, val_loss=0.843, val_accuracy=0.795, lr=0.01]100%|██████████| 107/107 [45:31<00:00, 25.53s/epoch, loss=0.552, accuracy=0.882, val_loss=0.843, val_accuracy=0.795, lr=0.01]
Using real-time data augmentation.
Test loss: 0.842502236366272
Test accuracy: 0.795199990272522


* * * Run SGD for ID = 14_6. * * *


2024-02-15 16:48:56.162355: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 16:48:59.033570: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 16:48:59.034875: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-15 16:48:59.074829: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 16:48:59.074866: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 16:48:59.077746: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 16:48:59.077791: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 16:48:59.080047: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 16:48:59.080760: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 16:48:59.083176: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 16:48:59.084708: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 16:48:59.089568: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 16:48:59.090189: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 16:48:59.090277: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 16:49:00.358620: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-15 16:49:00.359242: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 16:49:00.359759: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 16:49:00.359792: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 16:49:00.359827: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 16:49:00.359846: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 16:49:00.359873: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 16:49:00.359892: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 16:49:00.359909: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 16:49:00.359927: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 16:49:00.359945: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 16:49:00.360430: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 16:49:00.360464: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 16:49:01.036658: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-15 16:49:01.036727: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-15 16:49:01.036739: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-15 16:49:01.037722: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:03:00.0, compute capability: 6.1)
{'id': 146, 'batch_size': 128, 'epochs': 107, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/107 [00:00<?, ?epoch/s]2024-02-15 16:49:01.845862: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-15 16:49:01.857825: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199950000 Hz
2024-02-15 16:49:03.928645: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 16:49:04.225501: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 16:49:05.117499: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-15 16:49:05.175561: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/107 [01:06<1:57:43, 66.64s/epoch, loss=3.18, accuracy=0.3, val_loss=4.11, val_accuracy=0.156, lr=0.1]  2%|▏         | 2/107 [01:31<1:13:14, 41.85s/epoch, loss=1.64, accuracy=0.488, val_loss=4.37, val_accuracy=0.231, lr=0.1]  3%|▎         | 3/107 [01:56<59:08, 34.12s/epoch, loss=1.4, accuracy=0.615, val_loss=1.79, val_accuracy=0.485, lr=0.1]     4%|▎         | 4/107 [02:21<52:28, 30.57s/epoch, loss=1.3, accuracy=0.673, val_loss=1.77, val_accuracy=0.507, lr=0.1]  5%|▍         | 5/107 [02:44<47:26, 27.90s/epoch, loss=1.26, accuracy=0.699, val_loss=1.47, val_accuracy=0.621, lr=0.1]  6%|▌         | 6/107 [03:07<44:16, 26.30s/epoch, loss=1.24, accuracy=0.709, val_loss=2.33, val_accuracy=0.467, lr=0.1]  7%|▋         | 7/107 [03:31<42:39, 25.60s/epoch, loss=1.23, accuracy=0.717, val_loss=2.26, val_accuracy=0.427, lr=0.1]  7%|▋         | 8/107 [03:55<41:31, 25.17s/epoch, loss=1.22, accuracy=0.723, val_loss=2, val_accuracy=0.457, lr=0.1]     8%|▊         | 9/107 [04:19<40:04, 24.53s/epoch, loss=1.22, accuracy=0.726, val_loss=1.61, val_accuracy=0.578, lr=0.1]  9%|▉         | 10/107 [04:43<39:29, 24.43s/epoch, loss=1.21, accuracy=0.729, val_loss=2.51, val_accuracy=0.407, lr=0.0316] 10%|█         | 11/107 [05:07<39:00, 24.38s/epoch, loss=1.2, accuracy=0.73, val_loss=1.99, val_accuracy=0.478, lr=0.1]      11%|█         | 12/107 [05:32<38:54, 24.57s/epoch, loss=1.2, accuracy=0.731, val_loss=2.44, val_accuracy=0.448, lr=0.1] 12%|█▏        | 13/107 [05:57<38:46, 24.75s/epoch, loss=1.19, accuracy=0.737, val_loss=1.49, val_accuracy=0.643, lr=0.1] 13%|█▎        | 14/107 [06:22<38:26, 24.80s/epoch, loss=1.19, accuracy=0.736, val_loss=2.16, val_accuracy=0.44, lr=0.1]  14%|█▍        | 15/107 [06:47<38:05, 24.84s/epoch, loss=1.19, accuracy=0.736, val_loss=2.04, val_accuracy=0.442, lr=0.0316] 15%|█▍        | 16/107 [07:12<37:50, 24.95s/epoch, loss=1.19, accuracy=0.737, val_loss=1.74, val_accuracy=0.571, lr=0.1]    16%|█▌        | 17/107 [07:36<36:59, 24.66s/epoch, loss=1.19, accuracy=0.739, val_loss=2.23, val_accuracy=0.481, lr=0.1] 17%|█▋        | 18/107 [08:01<36:49, 24.83s/epoch, loss=1.18, accuracy=0.74, val_loss=2.9, val_accuracy=0.47, lr=0.1]    18%|█▊        | 19/107 [08:26<36:26, 24.84s/epoch, loss=1.18, accuracy=0.74, val_loss=1.49, val_accuracy=0.631, lr=0.1] 19%|█▊        | 20/107 [08:50<35:39, 24.59s/epoch, loss=1.19, accuracy=0.742, val_loss=2.34, val_accuracy=0.414, lr=0.0316] 20%|█▉        | 21/107 [09:15<35:22, 24.68s/epoch, loss=1.18, accuracy=0.742, val_loss=2.39, val_accuracy=0.412, lr=0.1]    21%|██        | 22/107 [09:40<35:00, 24.71s/epoch, loss=1.18, accuracy=0.742, val_loss=1.73, val_accuracy=0.584, lr=0.1] 21%|██▏       | 23/107 [10:05<34:46, 24.84s/epoch, loss=1.18, accuracy=0.745, val_loss=3.51, val_accuracy=0.336, lr=0.1] 22%|██▏       | 24/107 [10:30<34:30, 24.95s/epoch, loss=1.18, accuracy=0.743, val_loss=2.47, val_accuracy=0.428, lr=0.1] 23%|██▎       | 25/107 [10:56<34:14, 25.05s/epoch, loss=1.17, accuracy=0.747, val_loss=4.42, val_accuracy=0.292, lr=0.0316] 24%|██▍       | 26/107 [11:21<33:46, 25.02s/epoch, loss=1.18, accuracy=0.743, val_loss=1.41, val_accuracy=0.665, lr=0.1]    25%|██▌       | 27/107 [11:46<33:29, 25.12s/epoch, loss=1.17, accuracy=0.747, val_loss=1.82, val_accuracy=0.565, lr=0.1] 26%|██▌       | 28/107 [12:11<33:06, 25.14s/epoch, loss=1.18, accuracy=0.745, val_loss=1.55, val_accuracy=0.607, lr=0.1] 27%|██▋       | 29/107 [12:36<32:44, 25.19s/epoch, loss=1.16, accuracy=0.749, val_loss=2.05, val_accuracy=0.434, lr=0.1] 28%|██▊       | 30/107 [13:00<31:38, 24.65s/epoch, loss=1.17, accuracy=0.748, val_loss=2.77, val_accuracy=0.302, lr=0.1] 29%|██▉       | 31/107 [13:25<31:28, 24.85s/epoch, loss=1.17, accuracy=0.745, val_loss=3.73, val_accuracy=0.339, lr=0.0316] 30%|██▉       | 32/107 [13:50<31:11, 24.96s/epoch, loss=1.17, accuracy=0.746, val_loss=1.48, val_accuracy=0.642, lr=0.1]    31%|███       | 33/107 [14:16<30:52, 25.04s/epoch, loss=1.16, accuracy=0.748, val_loss=2, val_accuracy=0.533, lr=0.1]    32%|███▏      | 34/107 [14:41<30:32, 25.10s/epoch, loss=1.16, accuracy=0.749, val_loss=1.45, val_accuracy=0.652, lr=0.1] 33%|███▎      | 35/107 [15:06<29:59, 24.99s/epoch, loss=1.17, accuracy=0.747, val_loss=2.21, val_accuracy=0.426, lr=0.1] 34%|███▎      | 36/107 [15:30<29:29, 24.92s/epoch, loss=1.16, accuracy=0.749, val_loss=3.94, val_accuracy=0.242, lr=0.0316] 35%|███▍      | 37/107 [15:55<29:07, 24.97s/epoch, loss=1.16, accuracy=0.749, val_loss=1.56, val_accuracy=0.616, lr=0.1]    36%|███▌      | 38/107 [16:21<28:47, 25.04s/epoch, loss=1.16, accuracy=0.75, val_loss=1.51, val_accuracy=0.627, lr=0.1]  36%|███▋      | 39/107 [16:46<28:29, 25.15s/epoch, loss=1.15, accuracy=0.752, val_loss=3.23, val_accuracy=0.275, lr=0.1] 37%|███▋      | 40/107 [17:11<28:09, 25.22s/epoch, loss=1.16, accuracy=0.751, val_loss=1.37, val_accuracy=0.676, lr=0.1] 38%|███▊      | 41/107 [17:37<27:49, 25.30s/epoch, loss=1.15, accuracy=0.753, val_loss=1.39, val_accuracy=0.667, lr=0.1] 39%|███▉      | 42/107 [18:02<27:23, 25.28s/epoch, loss=1.14, accuracy=0.754, val_loss=3.16, val_accuracy=0.385, lr=0.1] 40%|████      | 43/107 [18:27<26:41, 25.02s/epoch, loss=1.15, accuracy=0.749, val_loss=1.49, val_accuracy=0.646, lr=0.1] 41%|████      | 44/107 [18:51<25:57, 24.72s/epoch, loss=1.14, accuracy=0.755, val_loss=1.64, val_accuracy=0.589, lr=0.1] 42%|████▏     | 45/107 [19:16<25:40, 24.85s/epoch, loss=1.14, accuracy=0.754, val_loss=2.08, val_accuracy=0.477, lr=0.0316] 43%|████▎     | 46/107 [19:40<25:05, 24.68s/epoch, loss=1.14, accuracy=0.755, val_loss=1.92, val_accuracy=0.467, lr=0.1]    44%|████▍     | 47/107 [20:05<24:46, 24.78s/epoch, loss=1.14, accuracy=0.753, val_loss=1.92, val_accuracy=0.518, lr=0.1] 45%|████▍     | 48/107 [20:29<24:09, 24.56s/epoch, loss=1.14, accuracy=0.753, val_loss=1.67, val_accuracy=0.583, lr=0.1] 46%|████▌     | 49/107 [20:54<23:47, 24.61s/epoch, loss=1.13, accuracy=0.757, val_loss=1.93, val_accuracy=0.522, lr=0.1] 47%|████▋     | 50/107 [21:19<23:36, 24.84s/epoch, loss=1.14, accuracy=0.752, val_loss=1.76, val_accuracy=0.574, lr=0.0316] 48%|████▊     | 51/107 [21:44<23:17, 24.96s/epoch, loss=1.14, accuracy=0.755, val_loss=1.89, val_accuracy=0.497, lr=0.1]    49%|████▊     | 52/107 [22:10<22:56, 25.03s/epoch, loss=1.14, accuracy=0.756, val_loss=1.65, val_accuracy=0.587, lr=0.1] 50%|████▉     | 53/107 [22:35<22:37, 25.14s/epoch, loss=1.13, accuracy=0.755, val_loss=1.76, val_accuracy=0.54, lr=0.1]  50%|█████     | 54/107 [22:59<21:53, 24.79s/epoch, loss=1.13, accuracy=0.754, val_loss=1.74, val_accuracy=0.548, lr=0.1] 51%|█████▏    | 55/107 [23:24<21:37, 24.96s/epoch, loss=1.13, accuracy=0.755, val_loss=1.63, val_accuracy=0.617, lr=0.0316] 52%|█████▏    | 56/107 [23:50<21:18, 25.08s/epoch, loss=1.14, accuracy=0.752, val_loss=2.33, val_accuracy=0.439, lr=0.1]    53%|█████▎    | 57/107 [24:15<20:58, 25.17s/epoch, loss=1.13, accuracy=0.756, val_loss=1.91, val_accuracy=0.558, lr=0.1] 54%|█████▍    | 58/107 [24:40<20:35, 25.21s/epoch, loss=1.13, accuracy=0.756, val_loss=1.91, val_accuracy=0.512, lr=0.1] 55%|█████▌    | 59/107 [25:05<19:56, 24.94s/epoch, loss=1.13, accuracy=0.755, val_loss=1.9, val_accuracy=0.477, lr=0.1]  56%|█████▌    | 60/107 [25:30<19:34, 24.98s/epoch, loss=1.13, accuracy=0.756, val_loss=1.97, val_accuracy=0.487, lr=0.0316] 57%|█████▋    | 61/107 [25:55<19:13, 25.09s/epoch, loss=1.13, accuracy=0.758, val_loss=1.7, val_accuracy=0.574, lr=0.1]     58%|█████▊    | 62/107 [26:20<18:42, 24.95s/epoch, loss=1.13, accuracy=0.756, val_loss=1.66, val_accuracy=0.585, lr=0.1] 59%|█████▉    | 63/107 [26:45<18:22, 25.06s/epoch, loss=1.14, accuracy=0.756, val_loss=2.15, val_accuracy=0.543, lr=0.1] 60%|█████▉    | 64/107 [27:10<18:00, 25.13s/epoch, loss=1.13, accuracy=0.758, val_loss=2.53, val_accuracy=0.454, lr=0.1] 61%|██████    | 65/107 [27:35<17:26, 24.92s/epoch, loss=1.13, accuracy=0.757, val_loss=1.94, val_accuracy=0.536, lr=0.0316] 62%|██████▏   | 66/107 [28:00<17:07, 25.06s/epoch, loss=1.13, accuracy=0.755, val_loss=3.09, val_accuracy=0.41, lr=0.1]     63%|██████▎   | 67/107 [28:24<16:30, 24.77s/epoch, loss=1.13, accuracy=0.756, val_loss=3.2, val_accuracy=0.351, lr=0.1] 64%|██████▎   | 68/107 [28:49<16:06, 24.79s/epoch, loss=1.13, accuracy=0.759, val_loss=2.83, val_accuracy=0.432, lr=0.1] 64%|██████▍   | 69/107 [29:14<15:44, 24.87s/epoch, loss=1.13, accuracy=0.756, val_loss=1.88, val_accuracy=0.522, lr=0.1] 65%|██████▌   | 70/107 [29:39<15:14, 24.72s/epoch, loss=1.13, accuracy=0.755, val_loss=1.72, val_accuracy=0.583, lr=0.0316] 66%|██████▋   | 71/107 [30:03<14:48, 24.68s/epoch, loss=1.13, accuracy=0.757, val_loss=1.55, val_accuracy=0.637, lr=0.1]    67%|██████▋   | 72/107 [30:28<14:26, 24.76s/epoch, loss=1.12, accuracy=0.756, val_loss=2.49, val_accuracy=0.407, lr=0.1] 68%|██████▊   | 73/107 [30:53<14:04, 24.85s/epoch, loss=1.13, accuracy=0.758, val_loss=5.8, val_accuracy=0.211, lr=0.1]  69%|██████▉   | 74/107 [31:17<13:33, 24.66s/epoch, loss=1.12, accuracy=0.759, val_loss=1.52, val_accuracy=0.627, lr=0.1] 70%|███████   | 75/107 [31:42<13:04, 24.53s/epoch, loss=1.13, accuracy=0.756, val_loss=1.62, val_accuracy=0.585, lr=0.0316] 71%|███████   | 76/107 [32:06<12:39, 24.49s/epoch, loss=1.12, accuracy=0.758, val_loss=3.19, val_accuracy=0.316, lr=0.1]    72%|███████▏  | 77/107 [32:31<12:16, 24.54s/epoch, loss=1.13, accuracy=0.758, val_loss=3.47, val_accuracy=0.354, lr=0.1] 73%|███████▎  | 78/107 [32:54<11:44, 24.28s/epoch, loss=1.14, accuracy=0.755, val_loss=4.17, val_accuracy=0.239, lr=0.1] 74%|███████▍  | 79/107 [33:19<11:24, 24.44s/epoch, loss=1.12, accuracy=0.76, val_loss=1.64, val_accuracy=0.583, lr=0.1]  75%|███████▍  | 80/107 [33:43<10:57, 24.33s/epoch, loss=1.13, accuracy=0.757, val_loss=1.67, val_accuracy=0.595, lr=0.0316] 76%|███████▌  | 81/107 [34:08<10:33, 24.35s/epoch, loss=1.12, accuracy=0.76, val_loss=2.25, val_accuracy=0.447, lr=0.1]     77%|███████▋  | 82/107 [34:32<10:06, 24.24s/epoch, loss=0.904, accuracy=0.819, val_loss=0.916, val_accuracy=0.79, lr=0.01] 78%|███████▊  | 83/107 [34:56<09:46, 24.43s/epoch, loss=0.73, accuracy=0.849, val_loss=0.787, val_accuracy=0.812, lr=0.01] 79%|███████▊  | 84/107 [35:22<09:27, 24.66s/epoch, loss=0.648, accuracy=0.856, val_loss=0.727, val_accuracy=0.82, lr=0.01] 79%|███████▉  | 85/107 [35:47<09:04, 24.77s/epoch, loss=0.604, accuracy=0.861, val_loss=0.795, val_accuracy=0.794, lr=0.01] 80%|████████  | 86/107 [36:12<08:42, 24.89s/epoch, loss=0.584, accuracy=0.861, val_loss=0.839, val_accuracy=0.771, lr=0.01] 81%|████████▏ | 87/107 [36:37<08:18, 24.94s/epoch, loss=0.575, accuracy=0.863, val_loss=0.766, val_accuracy=0.798, lr=0.01] 82%|████████▏ | 88/107 [37:01<07:49, 24.71s/epoch, loss=0.567, accuracy=0.866, val_loss=0.965, val_accuracy=0.756, lr=0.01] 83%|████████▎ | 89/107 [37:26<07:24, 24.72s/epoch, loss=0.562, accuracy=0.865, val_loss=0.996, val_accuracy=0.732, lr=0.00316] 84%|████████▍ | 90/107 [37:50<06:59, 24.65s/epoch, loss=0.56, accuracy=0.868, val_loss=0.719, val_accuracy=0.816, lr=0.01]     85%|████████▌ | 91/107 [38:15<06:36, 24.80s/epoch, loss=0.562, accuracy=0.869, val_loss=0.876, val_accuracy=0.772, lr=0.01] 86%|████████▌ | 92/107 [38:40<06:10, 24.72s/epoch, loss=0.559, accuracy=0.87, val_loss=0.756, val_accuracy=0.806, lr=0.01]  87%|████████▋ | 93/107 [39:04<05:45, 24.66s/epoch, loss=0.557, accuracy=0.871, val_loss=0.839, val_accuracy=0.79, lr=0.01] 88%|████████▊ | 94/107 [39:30<05:22, 24.78s/epoch, loss=0.556, accuracy=0.873, val_loss=0.78, val_accuracy=0.803, lr=0.01] 89%|████████▉ | 95/107 [39:53<04:53, 24.47s/epoch, loss=0.553, accuracy=0.874, val_loss=0.915, val_accuracy=0.77, lr=0.00316] 90%|████████▉ | 96/107 [40:18<04:29, 24.48s/epoch, loss=0.557, accuracy=0.874, val_loss=0.906, val_accuracy=0.778, lr=0.01]   91%|█████████ | 97/107 [40:42<04:03, 24.37s/epoch, loss=0.555, accuracy=0.876, val_loss=1.03, val_accuracy=0.743, lr=0.01]  92%|█████████▏| 98/107 [41:07<03:41, 24.60s/epoch, loss=0.556, accuracy=0.877, val_loss=1.16, val_accuracy=0.709, lr=0.01] 93%|█████████▎| 99/107 [41:31<03:16, 24.51s/epoch, loss=0.563, accuracy=0.875, val_loss=0.826, val_accuracy=0.791, lr=0.01] 93%|█████████▎| 100/107 [41:56<02:51, 24.54s/epoch, loss=0.555, accuracy=0.879, val_loss=0.858, val_accuracy=0.776, lr=0.00316] 94%|█████████▍| 101/107 [42:21<02:27, 24.59s/epoch, loss=0.555, accuracy=0.879, val_loss=0.757, val_accuracy=0.815, lr=0.01]    95%|█████████▌| 102/107 [42:44<02:01, 24.30s/epoch, loss=0.558, accuracy=0.878, val_loss=0.895, val_accuracy=0.776, lr=0.01] 96%|█████████▋| 103/107 [43:09<01:37, 24.37s/epoch, loss=0.552, accuracy=0.88, val_loss=0.999, val_accuracy=0.767, lr=0.01]  97%|█████████▋| 104/107 [43:33<01:13, 24.40s/epoch, loss=0.559, accuracy=0.88, val_loss=0.992, val_accuracy=0.759, lr=0.01] 98%|█████████▊| 105/107 [43:58<00:48, 24.45s/epoch, loss=0.553, accuracy=0.881, val_loss=1.32, val_accuracy=0.695, lr=0.00316] 99%|█████████▉| 106/107 [44:23<00:24, 24.58s/epoch, loss=0.551, accuracy=0.882, val_loss=0.816, val_accuracy=0.807, lr=0.01]  100%|██████████| 107/107 [44:48<00:00, 24.65s/epoch, loss=0.556, accuracy=0.881, val_loss=0.789, val_accuracy=0.81, lr=0.01] 100%|██████████| 107/107 [44:48<00:00, 25.12s/epoch, loss=0.556, accuracy=0.881, val_loss=0.789, val_accuracy=0.81, lr=0.01]
Using real-time data augmentation.
Test loss: 0.7892749309539795
Test accuracy: 0.8098999857902527


* * * Run SGD for ID = 14_7. * * *


2024-02-15 17:33:52.701974: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 17:33:55.660209: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 17:33:55.661619: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-15 17:33:55.702494: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 17:33:55.702551: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 17:33:55.705718: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 17:33:55.705764: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 17:33:55.708199: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 17:33:55.708898: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 17:33:55.711430: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 17:33:55.713030: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 17:33:55.718306: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 17:33:55.718973: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 17:33:55.719073: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 17:33:57.065851: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-15 17:33:57.066386: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 17:33:57.066907: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 17:33:57.066950: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 17:33:57.066985: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 17:33:57.067004: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 17:33:57.067037: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 17:33:57.067054: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 17:33:57.067070: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 17:33:57.067087: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 17:33:57.067104: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 17:33:57.067590: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 17:33:57.067631: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 17:33:57.789349: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-15 17:33:57.789416: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-15 17:33:57.789426: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-15 17:33:57.790859: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:03:00.0, compute capability: 6.1)
{'id': 147, 'batch_size': 128, 'epochs': 107, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/107 [00:00<?, ?epoch/s]2024-02-15 17:33:58.637511: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-15 17:33:58.649825: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199950000 Hz
2024-02-15 17:34:00.806999: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 17:34:01.047456: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 17:34:01.914678: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-15 17:34:01.971602: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/107 [01:01<1:48:20, 61.32s/epoch, loss=3.23, accuracy=0.284, val_loss=2.35, val_accuracy=0.28, lr=0.1]  2%|▏         | 2/107 [01:24<1:07:36, 38.63s/epoch, loss=1.62, accuracy=0.506, val_loss=2.18, val_accuracy=0.39, lr=0.1]  3%|▎         | 3/107 [01:48<55:55, 32.27s/epoch, loss=1.38, accuracy=0.616, val_loss=2, val_accuracy=0.459, lr=0.1]      4%|▎         | 4/107 [02:11<48:50, 28.45s/epoch, loss=1.29, accuracy=0.668, val_loss=2.52, val_accuracy=0.4, lr=0.1]  5%|▍         | 5/107 [02:35<46:01, 27.07s/epoch, loss=1.25, accuracy=0.692, val_loss=2.07, val_accuracy=0.47, lr=0.1]  6%|▌         | 6/107 [03:00<43:54, 26.08s/epoch, loss=1.23, accuracy=0.705, val_loss=2.02, val_accuracy=0.478, lr=0.1]  7%|▋         | 7/107 [03:24<42:35, 25.55s/epoch, loss=1.22, accuracy=0.712, val_loss=1.96, val_accuracy=0.482, lr=0.1]  7%|▋         | 8/107 [03:49<41:51, 25.37s/epoch, loss=1.22, accuracy=0.719, val_loss=1.71, val_accuracy=0.544, lr=0.1]  8%|▊         | 9/107 [04:13<40:52, 25.03s/epoch, loss=1.21, accuracy=0.721, val_loss=2.4, val_accuracy=0.408, lr=0.1]   9%|▉         | 10/107 [04:37<39:42, 24.57s/epoch, loss=1.21, accuracy=0.725, val_loss=1.58, val_accuracy=0.593, lr=0.1] 10%|█         | 11/107 [05:02<39:27, 24.67s/epoch, loss=1.2, accuracy=0.728, val_loss=1.66, val_accuracy=0.605, lr=0.1]  11%|█         | 12/107 [05:27<39:12, 24.76s/epoch, loss=1.19, accuracy=0.731, val_loss=1.77, val_accuracy=0.612, lr=0.1] 12%|█▏        | 13/107 [05:51<38:20, 24.48s/epoch, loss=1.18, accuracy=0.734, val_loss=1.63, val_accuracy=0.587, lr=0.1] 13%|█▎        | 14/107 [06:15<37:58, 24.50s/epoch, loss=1.18, accuracy=0.737, val_loss=1.51, val_accuracy=0.626, lr=0.1] 14%|█▍        | 15/107 [06:40<37:42, 24.59s/epoch, loss=1.18, accuracy=0.736, val_loss=1.68, val_accuracy=0.583, lr=0.1] 15%|█▍        | 16/107 [07:04<37:04, 24.45s/epoch, loss=1.17, accuracy=0.739, val_loss=2.08, val_accuracy=0.499, lr=0.1] 16%|█▌        | 17/107 [07:28<36:39, 24.44s/epoch, loss=1.17, accuracy=0.74, val_loss=1.63, val_accuracy=0.595, lr=0.1]  17%|█▋        | 18/107 [07:53<36:27, 24.58s/epoch, loss=1.17, accuracy=0.741, val_loss=2.02, val_accuracy=0.503, lr=0.1] 18%|█▊        | 19/107 [08:18<35:55, 24.50s/epoch, loss=1.17, accuracy=0.743, val_loss=1.47, val_accuracy=0.634, lr=0.1] 19%|█▊        | 20/107 [08:43<35:43, 24.64s/epoch, loss=1.16, accuracy=0.742, val_loss=1.84, val_accuracy=0.516, lr=0.1] 20%|█▉        | 21/107 [09:06<34:56, 24.38s/epoch, loss=1.16, accuracy=0.745, val_loss=1.86, val_accuracy=0.55, lr=0.1]  21%|██        | 22/107 [09:31<34:32, 24.38s/epoch, loss=1.16, accuracy=0.745, val_loss=1.4, val_accuracy=0.662, lr=0.1] 21%|██▏       | 23/107 [09:54<33:48, 24.15s/epoch, loss=1.15, accuracy=0.744, val_loss=2.1, val_accuracy=0.514, lr=0.1] 22%|██▏       | 24/107 [10:19<33:25, 24.17s/epoch, loss=1.15, accuracy=0.747, val_loss=2.27, val_accuracy=0.466, lr=0.1] 23%|██▎       | 25/107 [10:43<33:07, 24.23s/epoch, loss=1.15, accuracy=0.748, val_loss=2.08, val_accuracy=0.508, lr=0.1] 24%|██▍       | 26/107 [11:08<33:01, 24.46s/epoch, loss=1.16, accuracy=0.748, val_loss=6.46, val_accuracy=0.265, lr=0.1] 25%|██▌       | 27/107 [11:33<32:55, 24.70s/epoch, loss=1.16, accuracy=0.745, val_loss=1.48, val_accuracy=0.642, lr=0.0316] 26%|██▌       | 28/107 [11:58<32:21, 24.58s/epoch, loss=1.15, accuracy=0.748, val_loss=1.9, val_accuracy=0.542, lr=0.1]     27%|██▋       | 29/107 [12:23<32:07, 24.71s/epoch, loss=1.15, accuracy=0.748, val_loss=2.86, val_accuracy=0.333, lr=0.1] 28%|██▊       | 30/107 [12:47<31:36, 24.63s/epoch, loss=1.15, accuracy=0.752, val_loss=1.7, val_accuracy=0.539, lr=0.1]  29%|██▉       | 31/107 [13:11<30:49, 24.33s/epoch, loss=1.15, accuracy=0.75, val_loss=4.41, val_accuracy=0.299, lr=0.1] 30%|██▉       | 32/107 [13:36<30:38, 24.51s/epoch, loss=1.15, accuracy=0.747, val_loss=1.73, val_accuracy=0.566, lr=0.0316] 31%|███       | 33/107 [14:00<30:12, 24.49s/epoch, loss=1.15, accuracy=0.75, val_loss=1.47, val_accuracy=0.65, lr=0.1]      32%|███▏      | 34/107 [14:24<29:39, 24.37s/epoch, loss=1.15, accuracy=0.749, val_loss=1.59, val_accuracy=0.599, lr=0.1] 33%|███▎      | 35/107 [14:49<29:15, 24.38s/epoch, loss=1.14, accuracy=0.75, val_loss=2.21, val_accuracy=0.502, lr=0.1]  34%|███▎      | 36/107 [15:14<29:07, 24.62s/epoch, loss=1.15, accuracy=0.751, val_loss=1.84, val_accuracy=0.51, lr=0.1] 35%|███▍      | 37/107 [15:37<28:22, 24.31s/epoch, loss=1.15, accuracy=0.753, val_loss=1.62, val_accuracy=0.597, lr=0.0316] 36%|███▌      | 38/107 [16:02<28:00, 24.35s/epoch, loss=1.14, accuracy=0.753, val_loss=2.1, val_accuracy=0.524, lr=0.1]     36%|███▋      | 39/107 [16:27<27:46, 24.51s/epoch, loss=1.14, accuracy=0.751, val_loss=1.62, val_accuracy=0.618, lr=0.1] 37%|███▋      | 40/107 [16:52<27:33, 24.68s/epoch, loss=1.13, accuracy=0.755, val_loss=1.52, val_accuracy=0.62, lr=0.1]  38%|███▊      | 41/107 [17:17<27:17, 24.81s/epoch, loss=1.14, accuracy=0.752, val_loss=3.59, val_accuracy=0.378, lr=0.1] 39%|███▉      | 42/107 [17:42<26:53, 24.83s/epoch, loss=1.14, accuracy=0.753, val_loss=1.74, val_accuracy=0.55, lr=0.0316] 40%|████      | 43/107 [18:06<26:21, 24.71s/epoch, loss=1.13, accuracy=0.756, val_loss=1.92, val_accuracy=0.523, lr=0.1]   41%|████      | 44/107 [18:30<25:45, 24.54s/epoch, loss=1.14, accuracy=0.754, val_loss=4.13, val_accuracy=0.261, lr=0.1] 42%|████▏     | 45/107 [18:55<25:21, 24.54s/epoch, loss=1.13, accuracy=0.753, val_loss=1.55, val_accuracy=0.606, lr=0.1] 43%|████▎     | 46/107 [19:19<24:59, 24.57s/epoch, loss=1.14, accuracy=0.753, val_loss=6.59, val_accuracy=0.277, lr=0.1] 44%|████▍     | 47/107 [19:44<24:34, 24.58s/epoch, loss=1.13, accuracy=0.753, val_loss=2.4, val_accuracy=0.403, lr=0.0316] 45%|████▍     | 48/107 [20:09<24:17, 24.70s/epoch, loss=1.13, accuracy=0.754, val_loss=1.68, val_accuracy=0.591, lr=0.1]   46%|████▌     | 49/107 [20:34<23:59, 24.82s/epoch, loss=1.13, accuracy=0.756, val_loss=1.35, val_accuracy=0.665, lr=0.1] 47%|████▋     | 50/107 [20:59<23:38, 24.88s/epoch, loss=1.13, accuracy=0.754, val_loss=3.03, val_accuracy=0.382, lr=0.1] 48%|████▊     | 51/107 [21:24<23:16, 24.94s/epoch, loss=1.14, accuracy=0.75, val_loss=2.19, val_accuracy=0.486, lr=0.1]  49%|████▊     | 52/107 [21:49<22:52, 24.95s/epoch, loss=1.13, accuracy=0.756, val_loss=1.67, val_accuracy=0.593, lr=0.1] 50%|████▉     | 53/107 [22:14<22:26, 24.94s/epoch, loss=1.13, accuracy=0.757, val_loss=2.92, val_accuracy=0.353, lr=0.1] 50%|█████     | 54/107 [22:39<21:54, 24.81s/epoch, loss=1.12, accuracy=0.756, val_loss=2.07, val_accuracy=0.424, lr=0.0316] 51%|█████▏    | 55/107 [23:03<21:29, 24.79s/epoch, loss=1.12, accuracy=0.758, val_loss=2.06, val_accuracy=0.424, lr=0.1]    52%|█████▏    | 56/107 [23:28<21:07, 24.85s/epoch, loss=1.13, accuracy=0.753, val_loss=2.94, val_accuracy=0.367, lr=0.1] 53%|█████▎    | 57/107 [23:53<20:36, 24.73s/epoch, loss=1.13, accuracy=0.753, val_loss=15.2, val_accuracy=0.119, lr=0.1] 54%|█████▍    | 58/107 [24:18<20:13, 24.77s/epoch, loss=1.12, accuracy=0.756, val_loss=2.09, val_accuracy=0.477, lr=0.1] 55%|█████▌    | 59/107 [24:43<19:54, 24.88s/epoch, loss=1.12, accuracy=0.755, val_loss=2, val_accuracy=0.486, lr=0.0316] 56%|█████▌    | 60/107 [25:06<19:07, 24.42s/epoch, loss=1.12, accuracy=0.757, val_loss=1.95, val_accuracy=0.493, lr=0.1] 57%|█████▋    | 61/107 [25:30<18:39, 24.34s/epoch, loss=1.13, accuracy=0.758, val_loss=2.69, val_accuracy=0.353, lr=0.1] 58%|█████▊    | 62/107 [25:55<18:24, 24.54s/epoch, loss=1.12, accuracy=0.754, val_loss=1.99, val_accuracy=0.475, lr=0.1] 59%|█████▉    | 63/107 [26:20<18:03, 24.62s/epoch, loss=1.12, accuracy=0.756, val_loss=1.59, val_accuracy=0.598, lr=0.1] 60%|█████▉    | 64/107 [26:45<17:39, 24.63s/epoch, loss=1.12, accuracy=0.759, val_loss=2.65, val_accuracy=0.47, lr=0.0316] 61%|██████    | 65/107 [27:09<17:08, 24.50s/epoch, loss=1.12, accuracy=0.756, val_loss=2.08, val_accuracy=0.493, lr=0.1]   62%|██████▏   | 66/107 [27:34<16:45, 24.52s/epoch, loss=1.12, accuracy=0.757, val_loss=1.4, val_accuracy=0.663, lr=0.1]  63%|██████▎   | 67/107 [27:58<16:19, 24.50s/epoch, loss=1.12, accuracy=0.756, val_loss=2.04, val_accuracy=0.483, lr=0.1] 64%|██████▎   | 68/107 [28:22<15:47, 24.28s/epoch, loss=1.12, accuracy=0.756, val_loss=2.21, val_accuracy=0.428, lr=0.1] 64%|██████▍   | 69/107 [28:47<15:29, 24.47s/epoch, loss=1.12, accuracy=0.756, val_loss=2.39, val_accuracy=0.435, lr=0.0316] 65%|██████▌   | 70/107 [29:11<15:02, 24.39s/epoch, loss=1.12, accuracy=0.756, val_loss=2.54, val_accuracy=0.42, lr=0.1]     66%|██████▋   | 71/107 [29:35<14:37, 24.37s/epoch, loss=1.13, accuracy=0.756, val_loss=1.73, val_accuracy=0.582, lr=0.1] 67%|██████▋   | 72/107 [30:00<14:18, 24.51s/epoch, loss=1.12, accuracy=0.755, val_loss=3.04, val_accuracy=0.333, lr=0.1] 68%|██████▊   | 73/107 [30:24<13:49, 24.41s/epoch, loss=1.12, accuracy=0.756, val_loss=2.65, val_accuracy=0.257, lr=0.1] 69%|██████▉   | 74/107 [30:49<13:29, 24.54s/epoch, loss=1.12, accuracy=0.757, val_loss=1.98, val_accuracy=0.521, lr=0.0316] 70%|███████   | 75/107 [31:13<13:03, 24.47s/epoch, loss=1.12, accuracy=0.758, val_loss=2.95, val_accuracy=0.37, lr=0.1]     71%|███████   | 76/107 [31:38<12:38, 24.45s/epoch, loss=1.13, accuracy=0.755, val_loss=2.14, val_accuracy=0.415, lr=0.1] 72%|███████▏  | 77/107 [32:02<12:14, 24.50s/epoch, loss=1.12, accuracy=0.755, val_loss=2.2, val_accuracy=0.482, lr=0.1]  73%|███████▎  | 78/107 [32:27<11:53, 24.61s/epoch, loss=1.12, accuracy=0.754, val_loss=1.67, val_accuracy=0.588, lr=0.1] 74%|███████▍  | 79/107 [32:52<11:29, 24.62s/epoch, loss=1.12, accuracy=0.758, val_loss=1.79, val_accuracy=0.542, lr=0.0316] 75%|███████▍  | 80/107 [33:17<11:09, 24.79s/epoch, loss=1.12, accuracy=0.758, val_loss=2.34, val_accuracy=0.403, lr=0.1]    76%|███████▌  | 81/107 [33:41<10:41, 24.66s/epoch, loss=1.12, accuracy=0.755, val_loss=3.16, val_accuracy=0.261, lr=0.1] 77%|███████▋  | 82/107 [34:06<10:17, 24.69s/epoch, loss=0.914, accuracy=0.816, val_loss=0.976, val_accuracy=0.774, lr=0.01] 78%|███████▊  | 83/107 [34:30<09:49, 24.56s/epoch, loss=0.735, accuracy=0.844, val_loss=0.819, val_accuracy=0.806, lr=0.01] 79%|███████▊  | 84/107 [34:55<09:22, 24.46s/epoch, loss=0.655, accuracy=0.854, val_loss=0.763, val_accuracy=0.81, lr=0.01]  79%|███████▉  | 85/107 [35:19<08:58, 24.48s/epoch, loss=0.611, accuracy=0.856, val_loss=0.784, val_accuracy=0.795, lr=0.01] 80%|████████  | 86/107 [35:44<08:34, 24.50s/epoch, loss=0.589, accuracy=0.858, val_loss=0.725, val_accuracy=0.813, lr=0.01] 81%|████████▏ | 87/107 [36:07<08:05, 24.25s/epoch, loss=0.578, accuracy=0.86, val_loss=0.749, val_accuracy=0.801, lr=0.01]  82%|████████▏ | 88/107 [36:31<07:38, 24.14s/epoch, loss=0.575, accuracy=0.859, val_loss=0.871, val_accuracy=0.761, lr=0.01] 83%|████████▎ | 89/107 [36:56<07:15, 24.17s/epoch, loss=0.574, accuracy=0.86, val_loss=0.949, val_accuracy=0.769, lr=0.01]  84%|████████▍ | 90/107 [37:19<06:45, 23.87s/epoch, loss=0.568, accuracy=0.862, val_loss=0.813, val_accuracy=0.783, lr=0.01] 85%|████████▌ | 91/107 [37:43<06:24, 24.02s/epoch, loss=0.57, accuracy=0.863, val_loss=0.817, val_accuracy=0.788, lr=0.00316] 86%|████████▌ | 92/107 [38:07<06:00, 24.05s/epoch, loss=0.567, accuracy=0.864, val_loss=0.724, val_accuracy=0.814, lr=0.01]   87%|████████▋ | 93/107 [38:31<05:34, 23.92s/epoch, loss=0.562, accuracy=0.866, val_loss=1.65, val_accuracy=0.598, lr=0.01]  88%|████████▊ | 94/107 [38:55<05:11, 23.99s/epoch, loss=0.567, accuracy=0.866, val_loss=0.899, val_accuracy=0.775, lr=0.01] 89%|████████▉ | 95/107 [39:19<04:49, 24.14s/epoch, loss=0.561, accuracy=0.869, val_loss=0.893, val_accuracy=0.777, lr=0.01] 90%|████████▉ | 96/107 [39:43<04:24, 24.05s/epoch, loss=0.563, accuracy=0.87, val_loss=1.14, val_accuracy=0.716, lr=0.01]   91%|█████████ | 97/107 [40:08<04:00, 24.10s/epoch, loss=0.562, accuracy=0.869, val_loss=0.711, val_accuracy=0.819, lr=0.01] 92%|█████████▏| 98/107 [40:32<03:37, 24.16s/epoch, loss=0.562, accuracy=0.87, val_loss=0.835, val_accuracy=0.784, lr=0.01]  93%|█████████▎| 99/107 [40:56<03:13, 24.21s/epoch, loss=0.564, accuracy=0.869, val_loss=0.789, val_accuracy=0.793, lr=0.01] 93%|█████████▎| 100/107 [41:20<02:49, 24.17s/epoch, loss=0.559, accuracy=0.874, val_loss=0.997, val_accuracy=0.751, lr=0.01] 94%|█████████▍| 101/107 [41:45<02:26, 24.35s/epoch, loss=0.561, accuracy=0.873, val_loss=0.806, val_accuracy=0.804, lr=0.01] 95%|█████████▌| 102/107 [42:09<02:01, 24.21s/epoch, loss=0.564, accuracy=0.873, val_loss=0.866, val_accuracy=0.786, lr=0.00316] 96%|█████████▋| 103/107 [42:33<01:37, 24.32s/epoch, loss=0.557, accuracy=0.876, val_loss=0.95, val_accuracy=0.749, lr=0.01]     97%|█████████▋| 104/107 [42:58<01:13, 24.51s/epoch, loss=0.559, accuracy=0.875, val_loss=0.853, val_accuracy=0.794, lr=0.01] 98%|█████████▊| 105/107 [43:22<00:48, 24.20s/epoch, loss=0.559, accuracy=0.875, val_loss=0.9, val_accuracy=0.777, lr=0.01]   99%|█████████▉| 106/107 [43:47<00:24, 24.33s/epoch, loss=0.558, accuracy=0.876, val_loss=0.776, val_accuracy=0.811, lr=0.01]100%|██████████| 107/107 [44:11<00:00, 24.38s/epoch, loss=0.558, accuracy=0.876, val_loss=0.784, val_accuracy=0.812, lr=0.00316]100%|██████████| 107/107 [44:11<00:00, 24.78s/epoch, loss=0.558, accuracy=0.876, val_loss=0.784, val_accuracy=0.812, lr=0.00316]
Using real-time data augmentation.
Test loss: 0.7838557958602905
Test accuracy: 0.8122000098228455


* * * Run SGD for ID = 14_8. * * *


2024-02-15 18:18:13.323563: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 18:18:16.209410: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 18:18:16.210848: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-15 18:18:16.249021: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 18:18:16.249059: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 18:18:16.252200: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 18:18:16.252244: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 18:18:16.254768: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 18:18:16.255523: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 18:18:16.258236: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 18:18:16.259872: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 18:18:16.265218: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 18:18:16.265835: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 18:18:16.265915: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 18:18:17.602838: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-15 18:18:17.603394: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 18:18:17.603849: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 18:18:17.603882: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 18:18:17.603917: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 18:18:17.603935: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 18:18:17.603952: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 18:18:17.603970: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 18:18:17.604006: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 18:18:17.604023: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 18:18:17.604040: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 18:18:17.604526: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 18:18:17.604562: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 18:18:18.321708: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-15 18:18:18.321770: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-15 18:18:18.321780: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-15 18:18:18.323201: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:03:00.0, compute capability: 6.1)
{'id': 148, 'batch_size': 128, 'epochs': 107, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/107 [00:00<?, ?epoch/s]2024-02-15 18:18:19.173840: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-15 18:18:19.185820: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199950000 Hz
2024-02-15 18:18:21.389101: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 18:18:21.637721: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 18:18:22.408423: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-15 18:18:22.458499: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/107 [01:02<1:50:32, 62.57s/epoch, loss=3.31, accuracy=0.277, val_loss=2.41, val_accuracy=0.206, lr=0.1]  2%|▏         | 2/107 [01:25<1:08:56, 39.39s/epoch, loss=1.64, accuracy=0.489, val_loss=2.52, val_accuracy=0.349, lr=0.1]  3%|▎         | 3/107 [01:49<55:43, 32.15s/epoch, loss=1.43, accuracy=0.595, val_loss=2.44, val_accuracy=0.336, lr=0.1]    4%|▎         | 4/107 [02:12<49:14, 28.69s/epoch, loss=1.34, accuracy=0.649, val_loss=2.35, val_accuracy=0.394, lr=0.1]  5%|▍         | 5/107 [02:36<45:30, 26.77s/epoch, loss=1.28, accuracy=0.679, val_loss=1.84, val_accuracy=0.501, lr=0.1]  6%|▌         | 6/107 [02:59<43:27, 25.82s/epoch, loss=1.26, accuracy=0.696, val_loss=2.21, val_accuracy=0.496, lr=0.1]  7%|▋         | 7/107 [03:23<41:40, 25.00s/epoch, loss=1.24, accuracy=0.71, val_loss=5.79, val_accuracy=0.238, lr=0.1]   7%|▋         | 8/107 [03:47<40:49, 24.74s/epoch, loss=1.23, accuracy=0.718, val_loss=1.8, val_accuracy=0.554, lr=0.1]  8%|▊         | 9/107 [04:12<40:29, 24.79s/epoch, loss=1.23, accuracy=0.72, val_loss=1.58, val_accuracy=0.593, lr=0.1]  9%|▉         | 10/107 [04:37<40:02, 24.77s/epoch, loss=1.22, accuracy=0.725, val_loss=2.07, val_accuracy=0.503, lr=0.1] 10%|█         | 11/107 [05:02<39:45, 24.84s/epoch, loss=1.22, accuracy=0.727, val_loss=1.83, val_accuracy=0.539, lr=0.1] 11%|█         | 12/107 [05:27<39:33, 24.98s/epoch, loss=1.21, accuracy=0.733, val_loss=1.69, val_accuracy=0.569, lr=0.1] 12%|█▏        | 13/107 [05:51<38:50, 24.79s/epoch, loss=1.2, accuracy=0.732, val_loss=1.95, val_accuracy=0.491, lr=0.1]  13%|█▎        | 14/107 [06:16<38:19, 24.73s/epoch, loss=1.21, accuracy=0.736, val_loss=1.86, val_accuracy=0.492, lr=0.0316] 14%|█▍        | 15/107 [06:41<38:02, 24.81s/epoch, loss=1.2, accuracy=0.739, val_loss=2.61, val_accuracy=0.433, lr=0.1]     15%|█▍        | 16/107 [07:06<37:54, 24.99s/epoch, loss=1.2, accuracy=0.735, val_loss=1.79, val_accuracy=0.536, lr=0.1] 16%|█▌        | 17/107 [07:31<37:19, 24.88s/epoch, loss=1.19, accuracy=0.739, val_loss=1.95, val_accuracy=0.518, lr=0.1] 17%|█▋        | 18/107 [07:55<36:44, 24.77s/epoch, loss=1.19, accuracy=0.741, val_loss=1.62, val_accuracy=0.603, lr=0.1] 18%|█▊        | 19/107 [08:20<36:15, 24.72s/epoch, loss=1.18, accuracy=0.744, val_loss=2.36, val_accuracy=0.411, lr=0.0316] 19%|█▊        | 20/107 [08:45<35:50, 24.72s/epoch, loss=1.19, accuracy=0.741, val_loss=2.88, val_accuracy=0.369, lr=0.1]    20%|█▉        | 21/107 [09:08<34:49, 24.29s/epoch, loss=1.19, accuracy=0.743, val_loss=1.63, val_accuracy=0.595, lr=0.1] 21%|██        | 22/107 [09:32<34:19, 24.23s/epoch, loss=1.17, accuracy=0.745, val_loss=1.59, val_accuracy=0.612, lr=0.1] 21%|██▏       | 23/107 [09:57<34:04, 24.33s/epoch, loss=1.17, accuracy=0.746, val_loss=2.8, val_accuracy=0.408, lr=0.1]  22%|██▏       | 24/107 [10:22<33:57, 24.55s/epoch, loss=1.17, accuracy=0.749, val_loss=2.37, val_accuracy=0.424, lr=0.0316] 23%|██▎       | 25/107 [10:46<33:27, 24.49s/epoch, loss=1.17, accuracy=0.746, val_loss=1.9, val_accuracy=0.524, lr=0.1]     24%|██▍       | 26/107 [11:11<33:19, 24.68s/epoch, loss=1.17, accuracy=0.747, val_loss=2.09, val_accuracy=0.531, lr=0.1] 25%|██▌       | 27/107 [11:36<33:08, 24.86s/epoch, loss=1.16, accuracy=0.747, val_loss=1.89, val_accuracy=0.52, lr=0.1]  26%|██▌       | 28/107 [12:01<32:39, 24.81s/epoch, loss=1.16, accuracy=0.746, val_loss=2.05, val_accuracy=0.447, lr=0.1] 27%|██▋       | 29/107 [12:26<32:11, 24.76s/epoch, loss=1.16, accuracy=0.747, val_loss=3.52, val_accuracy=0.35, lr=0.0316] 28%|██▊       | 30/107 [12:51<31:44, 24.74s/epoch, loss=1.16, accuracy=0.749, val_loss=1.78, val_accuracy=0.552, lr=0.1]   29%|██▉       | 31/107 [13:15<31:12, 24.64s/epoch, loss=1.15, accuracy=0.751, val_loss=3.36, val_accuracy=0.284, lr=0.1] 30%|██▉       | 32/107 [13:40<30:57, 24.77s/epoch, loss=1.16, accuracy=0.753, val_loss=2.68, val_accuracy=0.398, lr=0.1] 31%|███       | 33/107 [14:04<30:26, 24.68s/epoch, loss=1.16, accuracy=0.751, val_loss=2.89, val_accuracy=0.419, lr=0.1] 32%|███▏      | 34/107 [14:27<29:24, 24.17s/epoch, loss=1.16, accuracy=0.751, val_loss=3.73, val_accuracy=0.222, lr=0.0316] 33%|███▎      | 35/107 [14:52<29:18, 24.42s/epoch, loss=1.16, accuracy=0.752, val_loss=2.39, val_accuracy=0.439, lr=0.1]    34%|███▎      | 36/107 [15:17<28:49, 24.36s/epoch, loss=1.14, accuracy=0.757, val_loss=2.13, val_accuracy=0.446, lr=0.1] 35%|███▍      | 37/107 [15:41<28:30, 24.44s/epoch, loss=1.15, accuracy=0.752, val_loss=1.99, val_accuracy=0.503, lr=0.1] 36%|███▌      | 38/107 [16:06<28:09, 24.49s/epoch, loss=1.15, accuracy=0.753, val_loss=2.1, val_accuracy=0.449, lr=0.1]  36%|███▋      | 39/107 [16:31<27:57, 24.66s/epoch, loss=1.15, accuracy=0.752, val_loss=3.41, val_accuracy=0.233, lr=0.0316] 37%|███▋      | 40/107 [16:56<27:42, 24.81s/epoch, loss=1.15, accuracy=0.754, val_loss=2.23, val_accuracy=0.492, lr=0.1]    38%|███▊      | 41/107 [17:21<27:24, 24.91s/epoch, loss=1.15, accuracy=0.75, val_loss=4, val_accuracy=0.295, lr=0.1]     39%|███▉      | 42/107 [17:46<26:55, 24.86s/epoch, loss=1.14, accuracy=0.755, val_loss=1.72, val_accuracy=0.586, lr=0.1] 40%|████      | 43/107 [18:11<26:24, 24.76s/epoch, loss=1.15, accuracy=0.753, val_loss=1.54, val_accuracy=0.611, lr=0.1] 41%|████      | 44/107 [18:34<25:35, 24.38s/epoch, loss=1.14, accuracy=0.756, val_loss=2.48, val_accuracy=0.41, lr=0.1]  42%|████▏     | 45/107 [18:58<24:54, 24.11s/epoch, loss=1.14, accuracy=0.753, val_loss=1.93, val_accuracy=0.505, lr=0.1] 43%|████▎     | 46/107 [19:21<24:16, 23.87s/epoch, loss=1.14, accuracy=0.756, val_loss=1.43, val_accuracy=0.658, lr=0.1] 44%|████▍     | 47/107 [19:46<24:14, 24.24s/epoch, loss=1.13, accuracy=0.755, val_loss=4.22, val_accuracy=0.308, lr=0.1] 45%|████▍     | 48/107 [20:10<23:41, 24.09s/epoch, loss=1.14, accuracy=0.752, val_loss=2.45, val_accuracy=0.469, lr=0.1] 46%|████▌     | 49/107 [20:34<23:26, 24.24s/epoch, loss=1.14, accuracy=0.752, val_loss=1.54, val_accuracy=0.628, lr=0.1] 47%|████▋     | 50/107 [21:00<23:21, 24.58s/epoch, loss=1.14, accuracy=0.755, val_loss=1.86, val_accuracy=0.532, lr=0.1] 48%|████▊     | 51/107 [21:25<23:03, 24.70s/epoch, loss=1.14, accuracy=0.754, val_loss=2.35, val_accuracy=0.498, lr=0.0316] 49%|████▊     | 52/107 [21:48<22:22, 24.40s/epoch, loss=1.13, accuracy=0.756, val_loss=1.73, val_accuracy=0.555, lr=0.1]    50%|████▉     | 53/107 [22:13<22:08, 24.60s/epoch, loss=1.14, accuracy=0.756, val_loss=3.24, val_accuracy=0.313, lr=0.1] 50%|█████     | 54/107 [22:38<21:47, 24.67s/epoch, loss=1.13, accuracy=0.755, val_loss=2.23, val_accuracy=0.444, lr=0.1] 51%|█████▏    | 55/107 [23:02<21:14, 24.52s/epoch, loss=1.14, accuracy=0.752, val_loss=1.6, val_accuracy=0.595, lr=0.1]  52%|█████▏    | 56/107 [23:27<20:54, 24.61s/epoch, loss=1.13, accuracy=0.757, val_loss=2.74, val_accuracy=0.336, lr=0.0316] 53%|█████▎    | 57/107 [23:52<20:30, 24.61s/epoch, loss=1.14, accuracy=0.756, val_loss=2.05, val_accuracy=0.419, lr=0.1]    54%|█████▍    | 58/107 [24:16<20:02, 24.54s/epoch, loss=1.13, accuracy=0.758, val_loss=1.59, val_accuracy=0.573, lr=0.1] 55%|█████▌    | 59/107 [24:41<19:37, 24.53s/epoch, loss=1.13, accuracy=0.757, val_loss=2.39, val_accuracy=0.447, lr=0.1] 56%|█████▌    | 60/107 [25:05<19:09, 24.46s/epoch, loss=1.13, accuracy=0.757, val_loss=1.87, val_accuracy=0.554, lr=0.1] 57%|█████▋    | 61/107 [25:30<18:48, 24.53s/epoch, loss=1.14, accuracy=0.753, val_loss=1.94, val_accuracy=0.477, lr=0.0316] 58%|█████▊    | 62/107 [25:54<18:18, 24.42s/epoch, loss=1.13, accuracy=0.757, val_loss=1.69, val_accuracy=0.585, lr=0.1]    59%|█████▉    | 63/107 [26:18<17:46, 24.24s/epoch, loss=1.13, accuracy=0.757, val_loss=1.93, val_accuracy=0.495, lr=0.1] 60%|█████▉    | 64/107 [26:42<17:22, 24.25s/epoch, loss=1.13, accuracy=0.754, val_loss=1.81, val_accuracy=0.509, lr=0.1] 61%|██████    | 65/107 [27:07<17:07, 24.46s/epoch, loss=1.13, accuracy=0.757, val_loss=1.87, val_accuracy=0.519, lr=0.1] 62%|██████▏   | 66/107 [27:31<16:42, 24.46s/epoch, loss=1.13, accuracy=0.756, val_loss=1.63, val_accuracy=0.589, lr=0.0316] 63%|██████▎   | 67/107 [27:56<16:18, 24.45s/epoch, loss=1.12, accuracy=0.755, val_loss=2.37, val_accuracy=0.436, lr=0.1]    64%|██████▎   | 68/107 [28:20<15:55, 24.51s/epoch, loss=1.12, accuracy=0.758, val_loss=3.97, val_accuracy=0.299, lr=0.1] 64%|██████▍   | 69/107 [28:45<15:34, 24.58s/epoch, loss=1.12, accuracy=0.759, val_loss=1.93, val_accuracy=0.54, lr=0.1]  65%|██████▌   | 70/107 [29:10<15:09, 24.59s/epoch, loss=1.13, accuracy=0.755, val_loss=1.88, val_accuracy=0.517, lr=0.1] 66%|██████▋   | 71/107 [29:33<14:35, 24.32s/epoch, loss=1.12, accuracy=0.758, val_loss=1.71, val_accuracy=0.562, lr=0.0316] 67%|██████▋   | 72/107 [29:57<14:02, 24.07s/epoch, loss=1.13, accuracy=0.756, val_loss=1.39, val_accuracy=0.66, lr=0.1]     68%|██████▊   | 73/107 [30:22<13:43, 24.23s/epoch, loss=1.13, accuracy=0.756, val_loss=2.24, val_accuracy=0.396, lr=0.1] 69%|██████▉   | 74/107 [30:47<13:27, 24.46s/epoch, loss=1.12, accuracy=0.757, val_loss=2.3, val_accuracy=0.428, lr=0.1]  70%|███████   | 75/107 [31:12<13:08, 24.65s/epoch, loss=1.12, accuracy=0.758, val_loss=1.77, val_accuracy=0.525, lr=0.1] 71%|███████   | 76/107 [31:36<12:43, 24.63s/epoch, loss=1.12, accuracy=0.758, val_loss=1.64, val_accuracy=0.576, lr=0.1] 72%|███████▏  | 77/107 [32:00<12:13, 24.45s/epoch, loss=1.12, accuracy=0.757, val_loss=2.58, val_accuracy=0.345, lr=0.0316] 73%|███████▎  | 78/107 [32:25<11:54, 24.65s/epoch, loss=1.12, accuracy=0.76, val_loss=2.07, val_accuracy=0.501, lr=0.1]     74%|███████▍  | 79/107 [32:49<11:25, 24.48s/epoch, loss=1.12, accuracy=0.757, val_loss=2.28, val_accuracy=0.423, lr=0.1] 75%|███████▍  | 80/107 [33:14<10:59, 24.41s/epoch, loss=1.12, accuracy=0.759, val_loss=2.32, val_accuracy=0.438, lr=0.1] 76%|███████▌  | 81/107 [33:38<10:30, 24.24s/epoch, loss=1.12, accuracy=0.757, val_loss=1.77, val_accuracy=0.593, lr=0.1] 77%|███████▋  | 82/107 [34:03<10:11, 24.47s/epoch, loss=0.916, accuracy=0.816, val_loss=0.946, val_accuracy=0.791, lr=0.01] 78%|███████▊  | 83/107 [34:27<09:45, 24.41s/epoch, loss=0.734, accuracy=0.85, val_loss=0.924, val_accuracy=0.774, lr=0.01]  79%|███████▊  | 84/107 [34:52<09:23, 24.52s/epoch, loss=0.655, accuracy=0.855, val_loss=0.746, val_accuracy=0.813, lr=0.01] 79%|███████▉  | 85/107 [35:16<08:56, 24.40s/epoch, loss=0.605, accuracy=0.861, val_loss=0.793, val_accuracy=0.794, lr=0.01] 80%|████████  | 86/107 [35:40<08:32, 24.40s/epoch, loss=0.582, accuracy=0.862, val_loss=0.813, val_accuracy=0.786, lr=0.01] 81%|████████▏ | 87/107 [36:05<08:09, 24.47s/epoch, loss=0.573, accuracy=0.864, val_loss=0.815, val_accuracy=0.785, lr=0.01] 82%|████████▏ | 88/107 [36:29<07:41, 24.27s/epoch, loss=0.567, accuracy=0.864, val_loss=0.749, val_accuracy=0.808, lr=0.01] 83%|████████▎ | 89/107 [36:53<07:17, 24.29s/epoch, loss=0.566, accuracy=0.866, val_loss=0.761, val_accuracy=0.805, lr=0.00316] 84%|████████▍ | 90/107 [37:17<06:54, 24.38s/epoch, loss=0.558, accuracy=0.869, val_loss=0.799, val_accuracy=0.799, lr=0.01]    85%|████████▌ | 91/107 [37:42<06:28, 24.27s/epoch, loss=0.563, accuracy=0.868, val_loss=1.18, val_accuracy=0.71, lr=0.01]   86%|████████▌ | 92/107 [38:06<06:04, 24.27s/epoch, loss=0.561, accuracy=0.87, val_loss=0.776, val_accuracy=0.804, lr=0.01] 87%|████████▋ | 93/107 [38:29<05:35, 24.00s/epoch, loss=0.559, accuracy=0.873, val_loss=1.17, val_accuracy=0.699, lr=0.01] 88%|████████▊ | 94/107 [38:53<05:10, 23.85s/epoch, loss=0.558, accuracy=0.874, val_loss=0.859, val_accuracy=0.783, lr=0.00316] 89%|████████▉ | 95/107 [39:17<04:48, 24.08s/epoch, loss=0.558, accuracy=0.873, val_loss=1.39, val_accuracy=0.662, lr=0.01]     90%|████████▉ | 96/107 [39:40<04:21, 23.76s/epoch, loss=0.562, accuracy=0.872, val_loss=0.859, val_accuracy=0.771, lr=0.01] 91%|█████████ | 97/107 [40:05<03:59, 23.92s/epoch, loss=0.558, accuracy=0.876, val_loss=0.842, val_accuracy=0.794, lr=0.01] 92%|█████████▏| 98/107 [40:29<03:37, 24.19s/epoch, loss=0.554, accuracy=0.878, val_loss=0.762, val_accuracy=0.817, lr=0.01] 93%|█████████▎| 99/107 [40:53<03:13, 24.13s/epoch, loss=0.557, accuracy=0.876, val_loss=1.03, val_accuracy=0.734, lr=0.00316] 93%|█████████▎| 100/107 [41:18<02:49, 24.22s/epoch, loss=0.553, accuracy=0.877, val_loss=1.13, val_accuracy=0.728, lr=0.01]   94%|█████████▍| 101/107 [41:43<02:26, 24.45s/epoch, loss=0.558, accuracy=0.879, val_loss=0.987, val_accuracy=0.756, lr=0.01] 95%|█████████▌| 102/107 [42:08<02:02, 24.54s/epoch, loss=0.561, accuracy=0.878, val_loss=0.829, val_accuracy=0.788, lr=0.01] 96%|█████████▋| 103/107 [42:32<01:38, 24.66s/epoch, loss=0.553, accuracy=0.88, val_loss=0.908, val_accuracy=0.777, lr=0.01]  97%|█████████▋| 104/107 [42:57<01:14, 24.76s/epoch, loss=0.556, accuracy=0.878, val_loss=0.85, val_accuracy=0.787, lr=0.00316] 98%|█████████▊| 105/107 [43:22<00:49, 24.61s/epoch, loss=0.555, accuracy=0.88, val_loss=1.31, val_accuracy=0.68, lr=0.01]      99%|█████████▉| 106/107 [43:46<00:24, 24.64s/epoch, loss=0.557, accuracy=0.88, val_loss=0.885, val_accuracy=0.782, lr=0.01]100%|██████████| 107/107 [44:11<00:00, 24.75s/epoch, loss=0.556, accuracy=0.879, val_loss=0.779, val_accuracy=0.799, lr=0.01]100%|██████████| 107/107 [44:11<00:00, 24.78s/epoch, loss=0.556, accuracy=0.879, val_loss=0.779, val_accuracy=0.799, lr=0.01]
Using real-time data augmentation.
Test loss: 0.7790237069129944
Test accuracy: 0.7990000247955322


* * * Run SGD for ID = 14_9. * * *


2024-02-15 19:02:33.658769: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 19:02:36.586208: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 19:02:36.587500: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-15 19:02:36.626487: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 19:02:36.626523: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 19:02:36.629446: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 19:02:36.629491: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 19:02:36.631650: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 19:02:36.632350: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 19:02:36.634722: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 19:02:36.636295: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 19:02:36.641080: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 19:02:36.641647: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 19:02:36.641737: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 19:02:37.906578: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-15 19:02:37.907262: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 19:02:37.907742: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 19:02:37.907775: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 19:02:37.907809: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 19:02:37.907829: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 19:02:37.907846: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 19:02:37.907864: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 19:02:37.907882: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 19:02:37.907901: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 19:02:37.907919: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 19:02:37.908394: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 19:02:37.908431: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 19:02:38.558006: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-15 19:02:38.558067: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-15 19:02:38.558078: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-15 19:02:38.558982: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:03:00.0, compute capability: 6.1)
{'id': 149, 'batch_size': 128, 'epochs': 107, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/107 [00:00<?, ?epoch/s]2024-02-15 19:02:39.349310: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-15 19:02:39.361918: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199950000 Hz
2024-02-15 19:02:41.385177: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 19:02:41.634122: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 19:02:42.330737: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-15 19:02:42.368500: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/107 [01:04<1:53:51, 64.44s/epoch, loss=3.24, accuracy=0.308, val_loss=3.49, val_accuracy=0.149, lr=0.1]  2%|▏         | 2/107 [01:27<1:09:58, 39.99s/epoch, loss=1.61, accuracy=0.512, val_loss=2.07, val_accuracy=0.408, lr=0.1]  3%|▎         | 3/107 [01:50<55:47, 32.18s/epoch, loss=1.39, accuracy=0.621, val_loss=2.29, val_accuracy=0.405, lr=0.1]    4%|▎         | 4/107 [02:13<49:12, 28.66s/epoch, loss=1.31, accuracy=0.671, val_loss=1.72, val_accuracy=0.551, lr=0.1]  5%|▍         | 5/107 [02:37<45:40, 26.87s/epoch, loss=1.28, accuracy=0.691, val_loss=1.89, val_accuracy=0.476, lr=0.1]  6%|▌         | 6/107 [03:00<43:11, 25.66s/epoch, loss=1.26, accuracy=0.705, val_loss=1.99, val_accuracy=0.481, lr=0.1]  7%|▋         | 7/107 [03:24<41:58, 25.19s/epoch, loss=1.25, accuracy=0.713, val_loss=1.54, val_accuracy=0.606, lr=0.1]  7%|▋         | 8/107 [03:49<41:19, 25.05s/epoch, loss=1.24, accuracy=0.718, val_loss=1.84, val_accuracy=0.497, lr=0.1]  8%|▊         | 9/107 [04:14<40:48, 24.99s/epoch, loss=1.23, accuracy=0.721, val_loss=1.62, val_accuracy=0.599, lr=0.1]  9%|▉         | 10/107 [04:39<40:29, 25.05s/epoch, loss=1.22, accuracy=0.727, val_loss=2.22, val_accuracy=0.45, lr=0.1] 10%|█         | 11/107 [05:04<39:54, 24.95s/epoch, loss=1.22, accuracy=0.727, val_loss=1.87, val_accuracy=0.541, lr=0.1] 11%|█         | 12/107 [05:29<39:37, 25.02s/epoch, loss=1.21, accuracy=0.733, val_loss=1.74, val_accuracy=0.571, lr=0.0316] 12%|█▏        | 13/107 [05:54<39:16, 25.07s/epoch, loss=1.22, accuracy=0.731, val_loss=3.2, val_accuracy=0.411, lr=0.1]     13%|█▎        | 14/107 [06:19<38:45, 25.00s/epoch, loss=1.21, accuracy=0.735, val_loss=1.91, val_accuracy=0.526, lr=0.1] 14%|█▍        | 15/107 [06:43<37:49, 24.67s/epoch, loss=1.2, accuracy=0.736, val_loss=1.69, val_accuracy=0.548, lr=0.1]  15%|█▍        | 16/107 [07:08<37:33, 24.77s/epoch, loss=1.2, accuracy=0.738, val_loss=1.68, val_accuracy=0.596, lr=0.1] 16%|█▌        | 17/107 [07:33<37:16, 24.85s/epoch, loss=1.2, accuracy=0.738, val_loss=1.83, val_accuracy=0.529, lr=0.0316] 17%|█▋        | 18/107 [07:56<36:13, 24.42s/epoch, loss=1.19, accuracy=0.739, val_loss=1.87, val_accuracy=0.552, lr=0.1]   18%|█▊        | 19/107 [08:21<36:01, 24.56s/epoch, loss=1.18, accuracy=0.744, val_loss=1.74, val_accuracy=0.563, lr=0.1] 19%|█▊        | 20/107 [08:45<35:08, 24.23s/epoch, loss=1.18, accuracy=0.742, val_loss=1.91, val_accuracy=0.489, lr=0.1] 20%|█▉        | 21/107 [09:10<35:06, 24.49s/epoch, loss=1.18, accuracy=0.742, val_loss=2.12, val_accuracy=0.542, lr=0.1] 21%|██        | 22/107 [09:34<34:26, 24.31s/epoch, loss=1.18, accuracy=0.744, val_loss=3.96, val_accuracy=0.371, lr=0.0316] 21%|██▏       | 23/107 [09:59<34:21, 24.54s/epoch, loss=1.18, accuracy=0.747, val_loss=1.93, val_accuracy=0.545, lr=0.1]    22%|██▏       | 24/107 [10:24<34:07, 24.66s/epoch, loss=1.17, accuracy=0.747, val_loss=2.52, val_accuracy=0.454, lr=0.1] 23%|██▎       | 25/107 [10:48<33:23, 24.44s/epoch, loss=1.18, accuracy=0.746, val_loss=2.45, val_accuracy=0.414, lr=0.1] 24%|██▍       | 26/107 [11:12<32:59, 24.44s/epoch, loss=1.17, accuracy=0.747, val_loss=1.9, val_accuracy=0.513, lr=0.1]  25%|██▌       | 27/107 [11:37<32:48, 24.61s/epoch, loss=1.17, accuracy=0.747, val_loss=1.52, val_accuracy=0.623, lr=0.1] 26%|██▌       | 28/107 [12:01<32:07, 24.39s/epoch, loss=1.16, accuracy=0.749, val_loss=2.09, val_accuracy=0.491, lr=0.1] 27%|██▋       | 29/107 [12:26<32:00, 24.62s/epoch, loss=1.17, accuracy=0.748, val_loss=1.82, val_accuracy=0.527, lr=0.1] 28%|██▊       | 30/107 [12:50<31:30, 24.55s/epoch, loss=1.17, accuracy=0.746, val_loss=1.9, val_accuracy=0.534, lr=0.1]  29%|██▉       | 31/107 [13:15<31:08, 24.58s/epoch, loss=1.16, accuracy=0.749, val_loss=1.98, val_accuracy=0.556, lr=0.1] 30%|██▉       | 32/107 [13:40<30:52, 24.71s/epoch, loss=1.16, accuracy=0.749, val_loss=2.22, val_accuracy=0.506, lr=0.0316] 31%|███       | 33/107 [14:04<30:19, 24.59s/epoch, loss=1.17, accuracy=0.748, val_loss=1.98, val_accuracy=0.554, lr=0.1]    32%|███▏      | 34/107 [14:29<29:58, 24.64s/epoch, loss=1.16, accuracy=0.75, val_loss=1.8, val_accuracy=0.534, lr=0.1]   33%|███▎      | 35/107 [14:54<29:43, 24.77s/epoch, loss=1.15, accuracy=0.751, val_loss=2.27, val_accuracy=0.451, lr=0.1] 34%|███▎      | 36/107 [15:19<29:26, 24.88s/epoch, loss=1.15, accuracy=0.751, val_loss=2.05, val_accuracy=0.458, lr=0.1] 35%|███▍      | 37/107 [15:44<28:54, 24.78s/epoch, loss=1.15, accuracy=0.753, val_loss=2.37, val_accuracy=0.51, lr=0.0316] 36%|███▌      | 38/107 [16:08<28:12, 24.54s/epoch, loss=1.16, accuracy=0.754, val_loss=1.75, val_accuracy=0.592, lr=0.1]   36%|███▋      | 39/107 [16:31<27:24, 24.18s/epoch, loss=1.16, accuracy=0.752, val_loss=1.92, val_accuracy=0.483, lr=0.1] 37%|███▋      | 40/107 [16:56<27:16, 24.42s/epoch, loss=1.16, accuracy=0.751, val_loss=2.74, val_accuracy=0.429, lr=0.1] 38%|███▊      | 41/107 [17:21<27:00, 24.55s/epoch, loss=1.16, accuracy=0.752, val_loss=1.67, val_accuracy=0.576, lr=0.1] 39%|███▉      | 42/107 [17:46<26:48, 24.74s/epoch, loss=1.15, accuracy=0.752, val_loss=1.77, val_accuracy=0.532, lr=0.0316] 40%|████      | 43/107 [18:11<26:23, 24.75s/epoch, loss=1.16, accuracy=0.754, val_loss=1.49, val_accuracy=0.63, lr=0.1]     41%|████      | 44/107 [18:36<26:10, 24.93s/epoch, loss=1.15, accuracy=0.753, val_loss=2.56, val_accuracy=0.479, lr=0.1] 42%|████▏     | 45/107 [19:01<25:48, 24.97s/epoch, loss=1.15, accuracy=0.754, val_loss=2.74, val_accuracy=0.414, lr=0.1] 43%|████▎     | 46/107 [19:26<25:19, 24.92s/epoch, loss=1.15, accuracy=0.755, val_loss=1.67, val_accuracy=0.588, lr=0.1] 44%|████▍     | 47/107 [19:51<24:53, 24.89s/epoch, loss=1.16, accuracy=0.752, val_loss=1.92, val_accuracy=0.507, lr=0.1] 45%|████▍     | 48/107 [20:16<24:27, 24.87s/epoch, loss=1.15, accuracy=0.755, val_loss=2.27, val_accuracy=0.467, lr=0.0316] 46%|████▌     | 49/107 [20:41<24:05, 24.92s/epoch, loss=1.15, accuracy=0.753, val_loss=2.6, val_accuracy=0.459, lr=0.1]     47%|████▋     | 50/107 [21:06<23:42, 24.96s/epoch, loss=1.16, accuracy=0.753, val_loss=1.6, val_accuracy=0.579, lr=0.1] 48%|████▊     | 51/107 [21:31<23:20, 25.00s/epoch, loss=1.15, accuracy=0.751, val_loss=1.85, val_accuracy=0.547, lr=0.1] 49%|████▊     | 52/107 [21:56<23:00, 25.10s/epoch, loss=1.15, accuracy=0.752, val_loss=2.18, val_accuracy=0.469, lr=0.1] 50%|████▉     | 53/107 [22:21<22:20, 24.82s/epoch, loss=1.15, accuracy=0.753, val_loss=2.96, val_accuracy=0.403, lr=0.0316] 50%|█████     | 54/107 [22:46<22:00, 24.91s/epoch, loss=1.15, accuracy=0.754, val_loss=1.8, val_accuracy=0.526, lr=0.1]     51%|█████▏    | 55/107 [23:10<21:27, 24.76s/epoch, loss=1.16, accuracy=0.752, val_loss=2.83, val_accuracy=0.403, lr=0.1] 52%|█████▏    | 56/107 [23:35<20:59, 24.70s/epoch, loss=1.15, accuracy=0.754, val_loss=1.77, val_accuracy=0.551, lr=0.1] 53%|█████▎    | 57/107 [23:59<20:24, 24.48s/epoch, loss=1.14, accuracy=0.754, val_loss=2.44, val_accuracy=0.462, lr=0.1] 54%|█████▍    | 58/107 [24:24<20:11, 24.73s/epoch, loss=1.15, accuracy=0.755, val_loss=1.6, val_accuracy=0.624, lr=0.0316] 55%|█████▌    | 59/107 [24:49<19:50, 24.80s/epoch, loss=1.14, accuracy=0.755, val_loss=1.8, val_accuracy=0.574, lr=0.1]    56%|█████▌    | 60/107 [25:14<19:28, 24.87s/epoch, loss=1.14, accuracy=0.757, val_loss=2.84, val_accuracy=0.439, lr=0.1] 57%|█████▋    | 61/107 [25:39<19:07, 24.95s/epoch, loss=1.15, accuracy=0.754, val_loss=1.56, val_accuracy=0.636, lr=0.1] 58%|█████▊    | 62/107 [26:03<18:33, 24.75s/epoch, loss=1.14, accuracy=0.754, val_loss=1.86, val_accuracy=0.567, lr=0.1] 59%|█████▉    | 63/107 [26:28<18:12, 24.82s/epoch, loss=1.15, accuracy=0.759, val_loss=2.14, val_accuracy=0.482, lr=0.0316] 60%|█████▉    | 64/107 [26:53<17:47, 24.82s/epoch, loss=1.14, accuracy=0.756, val_loss=1.39, val_accuracy=0.675, lr=0.1]    61%|██████    | 65/107 [27:18<17:25, 24.90s/epoch, loss=1.14, accuracy=0.758, val_loss=2.14, val_accuracy=0.443, lr=0.1] 62%|██████▏   | 66/107 [27:43<17:00, 24.90s/epoch, loss=1.15, accuracy=0.755, val_loss=1.9, val_accuracy=0.497, lr=0.1]  63%|██████▎   | 67/107 [28:08<16:32, 24.81s/epoch, loss=1.15, accuracy=0.754, val_loss=2.96, val_accuracy=0.366, lr=0.1] 64%|██████▎   | 68/107 [28:32<16:04, 24.73s/epoch, loss=1.15, accuracy=0.755, val_loss=1.73, val_accuracy=0.591, lr=0.1] 64%|██████▍   | 69/107 [28:57<15:38, 24.68s/epoch, loss=1.14, accuracy=0.756, val_loss=2.17, val_accuracy=0.482, lr=0.0316] 65%|██████▌   | 70/107 [29:22<15:15, 24.73s/epoch, loss=1.15, accuracy=0.755, val_loss=2.96, val_accuracy=0.363, lr=0.1]    66%|██████▋   | 71/107 [29:46<14:41, 24.50s/epoch, loss=1.15, accuracy=0.752, val_loss=1.74, val_accuracy=0.576, lr=0.1] 67%|██████▋   | 72/107 [30:11<14:23, 24.67s/epoch, loss=1.15, accuracy=0.756, val_loss=2.07, val_accuracy=0.517, lr=0.1] 68%|██████▊   | 73/107 [30:36<14:01, 24.75s/epoch, loss=1.15, accuracy=0.755, val_loss=3.64, val_accuracy=0.329, lr=0.1] 69%|██████▉   | 74/107 [31:01<13:38, 24.81s/epoch, loss=1.14, accuracy=0.756, val_loss=2.33, val_accuracy=0.454, lr=0.0316] 70%|███████   | 75/107 [31:26<13:16, 24.88s/epoch, loss=1.14, accuracy=0.756, val_loss=2.04, val_accuracy=0.458, lr=0.1]    71%|███████   | 76/107 [31:50<12:43, 24.63s/epoch, loss=1.14, accuracy=0.757, val_loss=2.55, val_accuracy=0.39, lr=0.1]  72%|███████▏  | 77/107 [32:14<12:19, 24.66s/epoch, loss=1.14, accuracy=0.758, val_loss=1.65, val_accuracy=0.606, lr=0.1] 73%|███████▎  | 78/107 [32:40<11:59, 24.80s/epoch, loss=1.14, accuracy=0.753, val_loss=2.45, val_accuracy=0.453, lr=0.1] 74%|███████▍  | 79/107 [33:04<11:30, 24.64s/epoch, loss=1.14, accuracy=0.756, val_loss=1.93, val_accuracy=0.499, lr=0.0316] 75%|███████▍  | 80/107 [33:28<11:01, 24.51s/epoch, loss=1.14, accuracy=0.757, val_loss=3.19, val_accuracy=0.374, lr=0.1]    76%|███████▌  | 81/107 [33:51<10:24, 24.02s/epoch, loss=1.14, accuracy=0.754, val_loss=2.15, val_accuracy=0.5, lr=0.1]   77%|███████▋  | 82/107 [34:14<09:54, 23.78s/epoch, loss=0.934, accuracy=0.815, val_loss=0.91, val_accuracy=0.803, lr=0.01] 78%|███████▊  | 83/107 [34:39<09:37, 24.07s/epoch, loss=0.745, accuracy=0.847, val_loss=0.817, val_accuracy=0.811, lr=0.01] 79%|███████▊  | 84/107 [35:04<09:17, 24.25s/epoch, loss=0.656, accuracy=0.858, val_loss=0.796, val_accuracy=0.812, lr=0.01] 79%|███████▉  | 85/107 [35:28<08:52, 24.20s/epoch, loss=0.611, accuracy=0.862, val_loss=0.792, val_accuracy=0.795, lr=0.01] 80%|████████  | 86/107 [35:52<08:26, 24.13s/epoch, loss=0.592, accuracy=0.861, val_loss=0.761, val_accuracy=0.802, lr=0.01] 81%|████████▏ | 87/107 [36:16<08:02, 24.14s/epoch, loss=0.581, accuracy=0.862, val_loss=0.806, val_accuracy=0.786, lr=0.01] 82%|████████▏ | 88/107 [36:41<07:44, 24.45s/epoch, loss=0.573, accuracy=0.865, val_loss=0.771, val_accuracy=0.809, lr=0.01] 83%|████████▎ | 89/107 [37:06<07:21, 24.53s/epoch, loss=0.569, accuracy=0.865, val_loss=0.792, val_accuracy=0.796, lr=0.01] 84%|████████▍ | 90/107 [37:30<06:56, 24.53s/epoch, loss=0.565, accuracy=0.867, val_loss=0.926, val_accuracy=0.758, lr=0.01] 85%|████████▌ | 91/107 [37:55<06:31, 24.49s/epoch, loss=0.561, accuracy=0.869, val_loss=0.769, val_accuracy=0.799, lr=0.00316] 86%|████████▌ | 92/107 [38:19<06:09, 24.61s/epoch, loss=0.561, accuracy=0.87, val_loss=0.892, val_accuracy=0.779, lr=0.01]     87%|████████▋ | 93/107 [38:43<05:40, 24.35s/epoch, loss=0.563, accuracy=0.869, val_loss=0.725, val_accuracy=0.819, lr=0.01] 88%|████████▊ | 94/107 [39:08<05:17, 24.43s/epoch, loss=0.555, accuracy=0.872, val_loss=0.834, val_accuracy=0.794, lr=0.01] 89%|████████▉ | 95/107 [39:32<04:52, 24.34s/epoch, loss=0.559, accuracy=0.874, val_loss=0.851, val_accuracy=0.778, lr=0.01] 90%|████████▉ | 96/107 [39:56<04:28, 24.38s/epoch, loss=0.557, accuracy=0.875, val_loss=0.892, val_accuracy=0.769, lr=0.01] 91%|█████████ | 97/107 [40:20<04:01, 24.20s/epoch, loss=0.56, accuracy=0.875, val_loss=0.803, val_accuracy=0.786, lr=0.01]  92%|█████████▏| 98/107 [40:45<03:39, 24.34s/epoch, loss=0.561, accuracy=0.875, val_loss=0.911, val_accuracy=0.768, lr=0.00316] 93%|█████████▎| 99/107 [41:09<03:13, 24.13s/epoch, loss=0.553, accuracy=0.877, val_loss=0.73, val_accuracy=0.822, lr=0.01]     93%|█████████▎| 100/107 [41:33<02:50, 24.37s/epoch, loss=0.559, accuracy=0.878, val_loss=0.742, val_accuracy=0.813, lr=0.01] 94%|█████████▍| 101/107 [41:58<02:26, 24.42s/epoch, loss=0.553, accuracy=0.879, val_loss=0.915, val_accuracy=0.786, lr=0.01] 95%|█████████▌| 102/107 [42:21<02:00, 24.04s/epoch, loss=0.554, accuracy=0.879, val_loss=0.866, val_accuracy=0.792, lr=0.01] 96%|█████████▋| 103/107 [42:46<01:36, 24.21s/epoch, loss=0.56, accuracy=0.877, val_loss=0.831, val_accuracy=0.798, lr=0.00316] 97%|█████████▋| 104/107 [43:10<01:12, 24.30s/epoch, loss=0.551, accuracy=0.881, val_loss=0.762, val_accuracy=0.811, lr=0.01]   98%|█████████▊| 105/107 [43:33<00:47, 23.95s/epoch, loss=0.561, accuracy=0.879, val_loss=0.774, val_accuracy=0.816, lr=0.01] 99%|█████████▉| 106/107 [43:58<00:24, 24.02s/epoch, loss=0.551, accuracy=0.883, val_loss=0.969, val_accuracy=0.755, lr=0.01]100%|██████████| 107/107 [44:22<00:00, 24.09s/epoch, loss=0.556, accuracy=0.881, val_loss=0.749, val_accuracy=0.829, lr=0.01]100%|██████████| 107/107 [44:22<00:00, 24.88s/epoch, loss=0.556, accuracy=0.881, val_loss=0.749, val_accuracy=0.829, lr=0.01]
Using real-time data augmentation.
Test loss: 0.7493993639945984
Test accuracy: 0.829200029373169


* * * Run SGD for ID = 14_10. * * *


2024-02-15 19:47:04.557746: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 19:47:07.443947: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 19:47:07.445285: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-15 19:47:07.484112: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 19:47:07.484148: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 19:47:07.487269: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 19:47:07.487313: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 19:47:07.489658: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 19:47:07.490491: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 19:47:07.492926: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 19:47:07.494444: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 19:47:07.499327: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 19:47:07.499887: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 19:47:07.499971: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 19:47:08.801182: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-15 19:47:08.802220: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 19:47:08.802675: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 19:47:08.802745: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 19:47:08.802780: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 19:47:08.802799: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 19:47:08.802817: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 19:47:08.802835: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 19:47:08.802852: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 19:47:08.802870: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 19:47:08.802888: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 19:47:08.803367: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 19:47:08.803401: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 19:47:09.479958: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-15 19:47:09.480010: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-15 19:47:09.480026: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-15 19:47:09.481030: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:03:00.0, compute capability: 6.1)
{'id': 1410, 'batch_size': 128, 'epochs': 107, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/107 [00:00<?, ?epoch/s]2024-02-15 19:47:10.299852: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-15 19:47:10.311816: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199950000 Hz
2024-02-15 19:47:12.382455: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 19:47:12.649152: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 19:47:13.478529: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-15 19:47:13.536365: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/107 [01:04<1:53:22, 64.17s/epoch, loss=3.46, accuracy=0.313, val_loss=2.21, val_accuracy=0.247, lr=0.1]  2%|▏         | 2/107 [01:27<1:10:06, 40.06s/epoch, loss=1.65, accuracy=0.484, val_loss=2.05, val_accuracy=0.404, lr=0.1]  3%|▎         | 3/107 [01:52<57:34, 33.21s/epoch, loss=1.39, accuracy=0.616, val_loss=3.9, val_accuracy=0.207, lr=0.1]     4%|▎         | 4/107 [02:15<50:27, 29.40s/epoch, loss=1.29, accuracy=0.677, val_loss=1.85, val_accuracy=0.493, lr=0.1]  5%|▍         | 5/107 [02:40<47:00, 27.65s/epoch, loss=1.26, accuracy=0.693, val_loss=4.85, val_accuracy=0.227, lr=0.1]  6%|▌         | 6/107 [03:04<44:16, 26.31s/epoch, loss=1.24, accuracy=0.709, val_loss=1.59, val_accuracy=0.609, lr=0.1]  7%|▋         | 7/107 [03:27<42:25, 25.46s/epoch, loss=1.23, accuracy=0.716, val_loss=1.93, val_accuracy=0.525, lr=0.1]  7%|▋         | 8/107 [03:53<41:51, 25.37s/epoch, loss=1.23, accuracy=0.717, val_loss=2.42, val_accuracy=0.412, lr=0.1]  8%|▊         | 9/107 [04:17<41:06, 25.17s/epoch, loss=1.23, accuracy=0.728, val_loss=1.88, val_accuracy=0.515, lr=0.1]  9%|▉         | 10/107 [04:42<40:33, 25.09s/epoch, loss=1.21, accuracy=0.729, val_loss=2.01, val_accuracy=0.49, lr=0.1] 10%|█         | 11/107 [05:06<39:39, 24.79s/epoch, loss=1.21, accuracy=0.731, val_loss=1.5, val_accuracy=0.621, lr=0.1] 11%|█         | 12/107 [05:31<39:22, 24.87s/epoch, loss=1.21, accuracy=0.733, val_loss=2.4, val_accuracy=0.443, lr=0.1] 12%|█▏        | 13/107 [05:55<38:32, 24.60s/epoch, loss=1.2, accuracy=0.735, val_loss=1.55, val_accuracy=0.619, lr=0.1] 13%|█▎        | 14/107 [06:19<37:49, 24.41s/epoch, loss=1.21, accuracy=0.736, val_loss=1.88, val_accuracy=0.568, lr=0.1] 14%|█▍        | 15/107 [06:44<37:45, 24.62s/epoch, loss=1.2, accuracy=0.736, val_loss=2.34, val_accuracy=0.369, lr=0.1]  15%|█▍        | 16/107 [07:10<37:32, 24.75s/epoch, loss=1.2, accuracy=0.739, val_loss=2.04, val_accuracy=0.528, lr=0.0316] 16%|█▌        | 17/107 [07:33<36:38, 24.43s/epoch, loss=1.19, accuracy=0.739, val_loss=1.6, val_accuracy=0.605, lr=0.1]    17%|█▋        | 18/107 [07:58<36:28, 24.59s/epoch, loss=1.2, accuracy=0.738, val_loss=1.72, val_accuracy=0.537, lr=0.1] 18%|█▊        | 19/107 [08:23<36:08, 24.65s/epoch, loss=1.18, accuracy=0.743, val_loss=2.44, val_accuracy=0.428, lr=0.1] 19%|█▊        | 20/107 [08:48<35:45, 24.67s/epoch, loss=1.19, accuracy=0.743, val_loss=2.39, val_accuracy=0.437, lr=0.1] 20%|█▉        | 21/107 [09:12<35:24, 24.70s/epoch, loss=1.19, accuracy=0.739, val_loss=2.86, val_accuracy=0.391, lr=0.0316] 21%|██        | 22/107 [09:37<35:03, 24.74s/epoch, loss=1.19, accuracy=0.739, val_loss=1.59, val_accuracy=0.606, lr=0.1]    21%|██▏       | 23/107 [10:02<34:30, 24.64s/epoch, loss=1.18, accuracy=0.743, val_loss=1.64, val_accuracy=0.604, lr=0.1] 22%|██▏       | 24/107 [10:27<34:15, 24.77s/epoch, loss=1.17, accuracy=0.745, val_loss=1.78, val_accuracy=0.531, lr=0.1] 23%|██▎       | 25/107 [10:52<33:56, 24.83s/epoch, loss=1.18, accuracy=0.744, val_loss=2.34, val_accuracy=0.434, lr=0.1] 24%|██▍       | 26/107 [11:15<33:05, 24.51s/epoch, loss=1.17, accuracy=0.745, val_loss=1.99, val_accuracy=0.541, lr=0.0316] 25%|██▌       | 27/107 [11:41<32:54, 24.68s/epoch, loss=1.18, accuracy=0.743, val_loss=2.87, val_accuracy=0.385, lr=0.1]    26%|██▌       | 28/107 [12:05<32:14, 24.49s/epoch, loss=1.17, accuracy=0.746, val_loss=1.54, val_accuracy=0.616, lr=0.1] 27%|██▋       | 29/107 [12:29<31:52, 24.52s/epoch, loss=1.16, accuracy=0.746, val_loss=1.59, val_accuracy=0.607, lr=0.1] 28%|██▊       | 30/107 [12:54<31:29, 24.54s/epoch, loss=1.17, accuracy=0.746, val_loss=1.86, val_accuracy=0.55, lr=0.1]  29%|██▉       | 31/107 [13:19<31:13, 24.65s/epoch, loss=1.17, accuracy=0.747, val_loss=2.7, val_accuracy=0.386, lr=0.0316] 30%|██▉       | 32/107 [13:44<31:03, 24.84s/epoch, loss=1.17, accuracy=0.749, val_loss=1.58, val_accuracy=0.605, lr=0.1]   31%|███       | 33/107 [14:09<30:46, 24.95s/epoch, loss=1.17, accuracy=0.747, val_loss=1.99, val_accuracy=0.471, lr=0.1] 32%|███▏      | 34/107 [14:34<30:18, 24.92s/epoch, loss=1.17, accuracy=0.747, val_loss=2.79, val_accuracy=0.361, lr=0.1] 33%|███▎      | 35/107 [14:59<29:48, 24.84s/epoch, loss=1.16, accuracy=0.751, val_loss=6.41, val_accuracy=0.243, lr=0.1] 34%|███▎      | 36/107 [15:23<29:08, 24.63s/epoch, loss=1.17, accuracy=0.748, val_loss=1.96, val_accuracy=0.527, lr=0.0316] 35%|███▍      | 37/107 [15:48<28:47, 24.68s/epoch, loss=1.16, accuracy=0.75, val_loss=1.57, val_accuracy=0.593, lr=0.1]     36%|███▌      | 38/107 [16:12<28:07, 24.45s/epoch, loss=1.15, accuracy=0.751, val_loss=1.66, val_accuracy=0.587, lr=0.1] 36%|███▋      | 39/107 [16:36<27:39, 24.41s/epoch, loss=1.16, accuracy=0.752, val_loss=1.96, val_accuracy=0.522, lr=0.1] 37%|███▋      | 40/107 [17:00<27:05, 24.27s/epoch, loss=1.16, accuracy=0.751, val_loss=1.87, val_accuracy=0.519, lr=0.1] 38%|███▊      | 41/107 [17:24<26:40, 24.26s/epoch, loss=1.16, accuracy=0.75, val_loss=2.42, val_accuracy=0.354, lr=0.0316] 39%|███▉      | 42/107 [17:49<26:26, 24.41s/epoch, loss=1.16, accuracy=0.752, val_loss=2.49, val_accuracy=0.375, lr=0.1]   40%|████      | 43/107 [18:13<26:05, 24.46s/epoch, loss=1.16, accuracy=0.752, val_loss=2.98, val_accuracy=0.321, lr=0.1] 41%|████      | 44/107 [18:37<25:30, 24.30s/epoch, loss=1.16, accuracy=0.752, val_loss=2.06, val_accuracy=0.528, lr=0.1] 42%|████▏     | 45/107 [19:02<25:20, 24.52s/epoch, loss=1.16, accuracy=0.75, val_loss=2.23, val_accuracy=0.52, lr=0.1]   43%|████▎     | 46/107 [19:26<24:48, 24.39s/epoch, loss=1.16, accuracy=0.751, val_loss=2, val_accuracy=0.547, lr=0.0316] 44%|████▍     | 47/107 [19:51<24:36, 24.60s/epoch, loss=1.15, accuracy=0.753, val_loss=1.76, val_accuracy=0.556, lr=0.1] 45%|████▍     | 48/107 [20:15<23:52, 24.28s/epoch, loss=1.16, accuracy=0.751, val_loss=4.6, val_accuracy=0.207, lr=0.1]  46%|████▌     | 49/107 [20:40<23:32, 24.35s/epoch, loss=1.16, accuracy=0.748, val_loss=1.78, val_accuracy=0.572, lr=0.1] 47%|████▋     | 50/107 [21:04<23:10, 24.39s/epoch, loss=1.15, accuracy=0.753, val_loss=2.5, val_accuracy=0.346, lr=0.1]  48%|████▊     | 51/107 [21:29<22:52, 24.51s/epoch, loss=1.15, accuracy=0.752, val_loss=1.8, val_accuracy=0.534, lr=0.0316] 49%|████▊     | 52/107 [21:54<22:39, 24.72s/epoch, loss=1.15, accuracy=0.754, val_loss=2.17, val_accuracy=0.483, lr=0.1]   50%|████▉     | 53/107 [22:19<22:20, 24.81s/epoch, loss=1.15, accuracy=0.752, val_loss=1.74, val_accuracy=0.556, lr=0.1] 50%|█████     | 54/107 [22:44<21:55, 24.81s/epoch, loss=1.15, accuracy=0.752, val_loss=2.02, val_accuracy=0.453, lr=0.1] 51%|█████▏    | 55/107 [23:08<21:24, 24.70s/epoch, loss=1.15, accuracy=0.751, val_loss=2.18, val_accuracy=0.484, lr=0.1] 52%|█████▏    | 56/107 [23:33<21:02, 24.75s/epoch, loss=1.15, accuracy=0.752, val_loss=5.59, val_accuracy=0.227, lr=0.0316] 53%|█████▎    | 57/107 [23:58<20:39, 24.80s/epoch, loss=1.15, accuracy=0.752, val_loss=1.91, val_accuracy=0.541, lr=0.1]    54%|█████▍    | 58/107 [24:23<20:19, 24.90s/epoch, loss=1.14, accuracy=0.752, val_loss=3.19, val_accuracy=0.339, lr=0.1] 55%|█████▌    | 59/107 [24:48<19:53, 24.86s/epoch, loss=1.14, accuracy=0.754, val_loss=2.89, val_accuracy=0.365, lr=0.1] 56%|█████▌    | 60/107 [25:13<19:32, 24.95s/epoch, loss=1.15, accuracy=0.753, val_loss=2.46, val_accuracy=0.418, lr=0.1] 57%|█████▋    | 61/107 [25:38<19:10, 25.02s/epoch, loss=1.15, accuracy=0.753, val_loss=1.75, val_accuracy=0.589, lr=0.0316] 58%|█████▊    | 62/107 [26:03<18:41, 24.93s/epoch, loss=1.15, accuracy=0.755, val_loss=2.05, val_accuracy=0.491, lr=0.1]    59%|█████▉    | 63/107 [26:28<18:20, 25.02s/epoch, loss=1.15, accuracy=0.75, val_loss=2.51, val_accuracy=0.407, lr=0.1]  60%|█████▉    | 64/107 [26:53<17:46, 24.79s/epoch, loss=1.14, accuracy=0.757, val_loss=3.3, val_accuracy=0.349, lr=0.1] 61%|██████    | 65/107 [27:18<17:25, 24.88s/epoch, loss=1.14, accuracy=0.754, val_loss=2.8, val_accuracy=0.412, lr=0.1] 62%|██████▏   | 66/107 [27:42<16:51, 24.67s/epoch, loss=1.14, accuracy=0.754, val_loss=2.53, val_accuracy=0.44, lr=0.0316] 63%|██████▎   | 67/107 [28:07<16:29, 24.73s/epoch, loss=1.14, accuracy=0.753, val_loss=3.79, val_accuracy=0.344, lr=0.1]   64%|██████▎   | 68/107 [28:30<15:50, 24.37s/epoch, loss=1.14, accuracy=0.756, val_loss=4.71, val_accuracy=0.162, lr=0.1] 64%|██████▍   | 69/107 [28:54<15:24, 24.34s/epoch, loss=1.14, accuracy=0.754, val_loss=1.62, val_accuracy=0.594, lr=0.1] 65%|██████▌   | 70/107 [29:19<15:02, 24.39s/epoch, loss=1.14, accuracy=0.754, val_loss=4.88, val_accuracy=0.219, lr=0.1] 66%|██████▋   | 71/107 [29:43<14:33, 24.25s/epoch, loss=1.14, accuracy=0.753, val_loss=2.33, val_accuracy=0.425, lr=0.0316] 67%|██████▋   | 72/107 [30:08<14:15, 24.44s/epoch, loss=1.14, accuracy=0.754, val_loss=4.39, val_accuracy=0.251, lr=0.1]    68%|██████▊   | 73/107 [30:32<13:50, 24.41s/epoch, loss=1.14, accuracy=0.754, val_loss=2, val_accuracy=0.527, lr=0.1]    69%|██████▉   | 74/107 [30:57<13:30, 24.55s/epoch, loss=1.13, accuracy=0.756, val_loss=2.43, val_accuracy=0.366, lr=0.1] 70%|███████   | 75/107 [31:21<13:03, 24.49s/epoch, loss=1.14, accuracy=0.754, val_loss=2.08, val_accuracy=0.485, lr=0.1] 71%|███████   | 76/107 [31:46<12:42, 24.58s/epoch, loss=1.14, accuracy=0.755, val_loss=5.66, val_accuracy=0.215, lr=0.0316] 72%|███████▏  | 77/107 [32:11<12:20, 24.69s/epoch, loss=1.13, accuracy=0.757, val_loss=2.24, val_accuracy=0.384, lr=0.1]    73%|███████▎  | 78/107 [32:35<11:53, 24.59s/epoch, loss=1.13, accuracy=0.758, val_loss=1.95, val_accuracy=0.543, lr=0.1] 74%|███████▍  | 79/107 [32:59<11:17, 24.21s/epoch, loss=1.14, accuracy=0.755, val_loss=2.04, val_accuracy=0.486, lr=0.1] 75%|███████▍  | 80/107 [33:24<10:59, 24.44s/epoch, loss=1.14, accuracy=0.757, val_loss=3.14, val_accuracy=0.27, lr=0.1]  76%|███████▌  | 81/107 [33:49<10:38, 24.56s/epoch, loss=1.13, accuracy=0.756, val_loss=2.54, val_accuracy=0.373, lr=0.0316] 77%|███████▋  | 82/107 [34:13<10:16, 24.65s/epoch, loss=0.926, accuracy=0.812, val_loss=0.963, val_accuracy=0.786, lr=0.01] 78%|███████▊  | 83/107 [34:38<09:50, 24.60s/epoch, loss=0.741, accuracy=0.846, val_loss=0.807, val_accuracy=0.811, lr=0.01] 79%|███████▊  | 84/107 [35:02<09:25, 24.57s/epoch, loss=0.659, accuracy=0.855, val_loss=0.765, val_accuracy=0.816, lr=0.01] 79%|███████▉  | 85/107 [35:27<09:00, 24.58s/epoch, loss=0.614, accuracy=0.858, val_loss=0.723, val_accuracy=0.816, lr=0.01] 80%|████████  | 86/107 [35:52<08:35, 24.55s/epoch, loss=0.592, accuracy=0.86, val_loss=0.864, val_accuracy=0.767, lr=0.01]  81%|████████▏ | 87/107 [36:16<08:10, 24.50s/epoch, loss=0.586, accuracy=0.861, val_loss=0.847, val_accuracy=0.78, lr=0.01] 82%|████████▏ | 88/107 [36:40<07:43, 24.38s/epoch, loss=0.575, accuracy=0.862, val_loss=0.858, val_accuracy=0.771, lr=0.01] 83%|████████▎ | 89/107 [37:05<07:20, 24.45s/epoch, loss=0.573, accuracy=0.863, val_loss=0.856, val_accuracy=0.784, lr=0.01] 84%|████████▍ | 90/107 [37:28<06:52, 24.28s/epoch, loss=0.571, accuracy=0.865, val_loss=0.857, val_accuracy=0.777, lr=0.00316] 85%|████████▌ | 91/107 [37:53<06:30, 24.40s/epoch, loss=0.569, accuracy=0.866, val_loss=0.957, val_accuracy=0.77, lr=0.01]     86%|████████▌ | 92/107 [38:18<06:08, 24.55s/epoch, loss=0.57, accuracy=0.866, val_loss=1.01, val_accuracy=0.749, lr=0.01]  87%|████████▋ | 93/107 [38:42<05:39, 24.25s/epoch, loss=0.566, accuracy=0.868, val_loss=1.24, val_accuracy=0.687, lr=0.01] 88%|████████▊ | 94/107 [39:07<05:17, 24.45s/epoch, loss=0.565, accuracy=0.869, val_loss=0.962, val_accuracy=0.748, lr=0.01] 89%|████████▉ | 95/107 [39:31<04:54, 24.51s/epoch, loss=0.563, accuracy=0.873, val_loss=0.83, val_accuracy=0.788, lr=0.00316] 90%|████████▉ | 96/107 [39:56<04:30, 24.62s/epoch, loss=0.568, accuracy=0.871, val_loss=0.723, val_accuracy=0.824, lr=0.01]   91%|█████████ | 97/107 [40:21<04:06, 24.70s/epoch, loss=0.562, accuracy=0.874, val_loss=0.859, val_accuracy=0.777, lr=0.01] 92%|█████████▏| 98/107 [40:45<03:41, 24.64s/epoch, loss=0.563, accuracy=0.876, val_loss=0.756, val_accuracy=0.812, lr=0.01] 93%|█████████▎| 99/107 [41:10<03:16, 24.61s/epoch, loss=0.561, accuracy=0.876, val_loss=1.11, val_accuracy=0.723, lr=0.01]  93%|█████████▎| 100/107 [41:35<02:52, 24.68s/epoch, loss=0.565, accuracy=0.874, val_loss=0.821, val_accuracy=0.799, lr=0.00316] 94%|█████████▍| 101/107 [42:00<02:28, 24.73s/epoch, loss=0.561, accuracy=0.876, val_loss=0.84, val_accuracy=0.784, lr=0.01]     95%|█████████▌| 102/107 [42:24<02:02, 24.54s/epoch, loss=0.564, accuracy=0.877, val_loss=0.961, val_accuracy=0.774, lr=0.01] 96%|█████████▋| 103/107 [42:48<01:37, 24.40s/epoch, loss=0.565, accuracy=0.877, val_loss=1.2, val_accuracy=0.708, lr=0.01]   97%|█████████▋| 104/107 [43:12<01:12, 24.29s/epoch, loss=0.557, accuracy=0.88, val_loss=0.8, val_accuracy=0.8, lr=0.01]    98%|█████████▊| 105/107 [43:35<00:47, 23.81s/epoch, loss=0.567, accuracy=0.877, val_loss=0.966, val_accuracy=0.76, lr=0.00316] 99%|█████████▉| 106/107 [43:58<00:23, 23.75s/epoch, loss=0.565, accuracy=0.878, val_loss=0.811, val_accuracy=0.805, lr=0.01]  100%|██████████| 107/107 [44:23<00:00, 23.96s/epoch, loss=0.563, accuracy=0.878, val_loss=0.787, val_accuracy=0.802, lr=0.01]100%|██████████| 107/107 [44:23<00:00, 24.89s/epoch, loss=0.563, accuracy=0.878, val_loss=0.787, val_accuracy=0.802, lr=0.01]
Using real-time data augmentation.
Test loss: 0.7865634560585022
Test accuracy: 0.8022000193595886


* * * Run SGD for ID = 14_11. * * *


2024-02-15 20:31:36.013121: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 20:31:38.957346: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 20:31:38.958797: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-15 20:31:38.999600: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 20:31:38.999648: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 20:31:39.002860: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 20:31:39.002909: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 20:31:39.005395: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 20:31:39.006605: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 20:31:39.009284: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 20:31:39.010921: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 20:31:39.015839: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 20:31:39.016459: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 20:31:39.016540: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 20:31:40.356700: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-15 20:31:40.357230: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 20:31:40.357717: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 20:31:40.357752: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 20:31:40.357787: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 20:31:40.357807: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 20:31:40.357826: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 20:31:40.357845: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 20:31:40.357864: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 20:31:40.357882: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 20:31:40.357901: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 20:31:40.358390: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 20:31:40.358427: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 20:31:41.078740: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-15 20:31:41.078800: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-15 20:31:41.078811: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-15 20:31:41.080206: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:03:00.0, compute capability: 6.1)
{'id': 1411, 'batch_size': 128, 'epochs': 107, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/107 [00:00<?, ?epoch/s]2024-02-15 20:31:41.918159: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-15 20:31:41.918785: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199950000 Hz
2024-02-15 20:31:44.070990: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 20:31:44.378454: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 20:31:45.219818: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-15 20:31:45.284296: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/107 [01:04<1:53:11, 64.07s/epoch, loss=3.19, accuracy=0.312, val_loss=2.63, val_accuracy=0.292, lr=0.1]  2%|▏         | 2/107 [01:29<1:12:07, 41.22s/epoch, loss=1.56, accuracy=0.535, val_loss=1.72, val_accuracy=0.51, lr=0.1]   3%|▎         | 3/107 [01:53<58:17, 33.63s/epoch, loss=1.35, accuracy=0.64, val_loss=2.14, val_accuracy=0.446, lr=0.1]    4%|▎         | 4/107 [02:18<51:42, 30.12s/epoch, loss=1.28, accuracy=0.682, val_loss=2.13, val_accuracy=0.441, lr=0.1]  5%|▍         | 5/107 [02:43<48:00, 28.24s/epoch, loss=1.25, accuracy=0.7, val_loss=2.25, val_accuracy=0.486, lr=0.1]    6%|▌         | 6/107 [03:08<45:38, 27.11s/epoch, loss=1.24, accuracy=0.711, val_loss=2.83, val_accuracy=0.367, lr=0.1]  7%|▋         | 7/107 [03:33<43:54, 26.34s/epoch, loss=1.23, accuracy=0.719, val_loss=1.64, val_accuracy=0.589, lr=0.1]  7%|▋         | 8/107 [03:58<42:41, 25.87s/epoch, loss=1.23, accuracy=0.72, val_loss=2.62, val_accuracy=0.372, lr=0.1]   8%|▊         | 9/107 [04:23<41:48, 25.59s/epoch, loss=1.22, accuracy=0.729, val_loss=1.81, val_accuracy=0.548, lr=0.1]  9%|▉         | 10/107 [04:47<40:57, 25.34s/epoch, loss=1.21, accuracy=0.728, val_loss=1.83, val_accuracy=0.504, lr=0.1] 10%|█         | 11/107 [05:12<40:04, 25.05s/epoch, loss=1.22, accuracy=0.732, val_loss=2.42, val_accuracy=0.435, lr=0.1] 11%|█         | 12/107 [05:37<39:34, 25.00s/epoch, loss=1.21, accuracy=0.735, val_loss=2.17, val_accuracy=0.44, lr=0.0316] 12%|█▏        | 13/107 [06:01<38:59, 24.89s/epoch, loss=1.21, accuracy=0.735, val_loss=1.63, val_accuracy=0.567, lr=0.1]   13%|█▎        | 14/107 [06:26<38:33, 24.87s/epoch, loss=1.19, accuracy=0.74, val_loss=1.84, val_accuracy=0.507, lr=0.1]  14%|█▍        | 15/107 [06:51<38:08, 24.88s/epoch, loss=1.2, accuracy=0.737, val_loss=2, val_accuracy=0.539, lr=0.1]    15%|█▍        | 16/107 [07:16<37:46, 24.91s/epoch, loss=1.2, accuracy=0.738, val_loss=3.69, val_accuracy=0.382, lr=0.1] 16%|█▌        | 17/107 [07:41<37:20, 24.89s/epoch, loss=1.19, accuracy=0.74, val_loss=1.5, val_accuracy=0.636, lr=0.1]  17%|█▋        | 18/107 [08:06<37:00, 24.95s/epoch, loss=1.19, accuracy=0.742, val_loss=1.9, val_accuracy=0.507, lr=0.1] 18%|█▊        | 19/107 [08:31<36:40, 25.01s/epoch, loss=1.19, accuracy=0.741, val_loss=1.6, val_accuracy=0.631, lr=0.1] 19%|█▊        | 20/107 [08:55<35:56, 24.78s/epoch, loss=1.19, accuracy=0.743, val_loss=1.61, val_accuracy=0.617, lr=0.1] 20%|█▉        | 21/107 [09:20<35:37, 24.85s/epoch, loss=1.17, accuracy=0.747, val_loss=2.78, val_accuracy=0.368, lr=0.1] 21%|██        | 22/107 [09:45<35:05, 24.78s/epoch, loss=1.18, accuracy=0.742, val_loss=2.15, val_accuracy=0.501, lr=0.0316] 21%|██▏       | 23/107 [10:09<34:35, 24.71s/epoch, loss=1.18, accuracy=0.744, val_loss=1.79, val_accuracy=0.55, lr=0.1]     22%|██▏       | 24/107 [10:34<34:15, 24.77s/epoch, loss=1.18, accuracy=0.745, val_loss=2.41, val_accuracy=0.43, lr=0.1] 23%|██▎       | 25/107 [10:59<33:49, 24.75s/epoch, loss=1.17, accuracy=0.747, val_loss=1.93, val_accuracy=0.513, lr=0.1] 24%|██▍       | 26/107 [11:23<33:07, 24.54s/epoch, loss=1.18, accuracy=0.744, val_loss=1.61, val_accuracy=0.617, lr=0.1] 25%|██▌       | 27/107 [11:48<32:53, 24.67s/epoch, loss=1.17, accuracy=0.749, val_loss=2.32, val_accuracy=0.41, lr=0.0316] 26%|██▌       | 28/107 [12:12<32:01, 24.33s/epoch, loss=1.16, accuracy=0.749, val_loss=3.23, val_accuracy=0.387, lr=0.1]   27%|██▋       | 29/107 [12:36<31:36, 24.32s/epoch, loss=1.16, accuracy=0.751, val_loss=3.62, val_accuracy=0.284, lr=0.1] 28%|██▊       | 30/107 [12:59<30:42, 23.93s/epoch, loss=1.16, accuracy=0.75, val_loss=3.03, val_accuracy=0.354, lr=0.1]  29%|██▉       | 31/107 [13:24<30:45, 24.29s/epoch, loss=1.16, accuracy=0.747, val_loss=3.35, val_accuracy=0.316, lr=0.1] 30%|██▉       | 32/107 [13:47<29:59, 24.00s/epoch, loss=1.16, accuracy=0.747, val_loss=1.92, val_accuracy=0.48, lr=0.0316] 31%|███       | 33/107 [14:12<29:58, 24.30s/epoch, loss=1.17, accuracy=0.747, val_loss=1.96, val_accuracy=0.528, lr=0.1]   32%|███▏      | 34/107 [14:37<29:35, 24.32s/epoch, loss=1.16, accuracy=0.747, val_loss=3.41, val_accuracy=0.308, lr=0.1] 33%|███▎      | 35/107 [15:02<29:25, 24.51s/epoch, loss=1.16, accuracy=0.749, val_loss=1.35, val_accuracy=0.679, lr=0.1] 34%|███▎      | 36/107 [15:26<29:01, 24.53s/epoch, loss=1.17, accuracy=0.746, val_loss=2.32, val_accuracy=0.479, lr=0.1] 35%|███▍      | 37/107 [15:50<28:25, 24.37s/epoch, loss=1.16, accuracy=0.748, val_loss=1.65, val_accuracy=0.579, lr=0.1] 36%|███▌      | 38/107 [16:15<28:01, 24.37s/epoch, loss=1.16, accuracy=0.749, val_loss=2.05, val_accuracy=0.526, lr=0.1] 36%|███▋      | 39/107 [16:40<27:48, 24.54s/epoch, loss=1.16, accuracy=0.749, val_loss=2.35, val_accuracy=0.431, lr=0.1] 37%|███▋      | 40/107 [17:04<27:28, 24.60s/epoch, loss=1.15, accuracy=0.749, val_loss=1.83, val_accuracy=0.529, lr=0.0316] 38%|███▊      | 41/107 [17:29<27:05, 24.63s/epoch, loss=1.16, accuracy=0.75, val_loss=2.11, val_accuracy=0.547, lr=0.1]     39%|███▉      | 42/107 [17:54<26:42, 24.66s/epoch, loss=1.15, accuracy=0.752, val_loss=2.27, val_accuracy=0.451, lr=0.1] 40%|████      | 43/107 [18:18<26:06, 24.47s/epoch, loss=1.16, accuracy=0.749, val_loss=2.53, val_accuracy=0.407, lr=0.1] 41%|████      | 44/107 [18:42<25:42, 24.49s/epoch, loss=1.15, accuracy=0.752, val_loss=1.95, val_accuracy=0.509, lr=0.1] 42%|████▏     | 45/107 [19:07<25:27, 24.64s/epoch, loss=1.15, accuracy=0.75, val_loss=2.31, val_accuracy=0.44, lr=0.0316] 43%|████▎     | 46/107 [19:32<25:01, 24.61s/epoch, loss=1.15, accuracy=0.75, val_loss=1.72, val_accuracy=0.562, lr=0.1]   44%|████▍     | 47/107 [19:57<24:38, 24.64s/epoch, loss=1.15, accuracy=0.753, val_loss=2.64, val_accuracy=0.341, lr=0.1] 45%|████▍     | 48/107 [20:22<24:20, 24.76s/epoch, loss=1.15, accuracy=0.752, val_loss=1.54, val_accuracy=0.598, lr=0.1] 46%|████▌     | 49/107 [20:46<23:50, 24.66s/epoch, loss=1.14, accuracy=0.753, val_loss=1.49, val_accuracy=0.645, lr=0.1] 47%|████▋     | 50/107 [21:11<23:26, 24.68s/epoch, loss=1.15, accuracy=0.749, val_loss=1.99, val_accuracy=0.525, lr=0.0316] 48%|████▊     | 51/107 [21:36<23:14, 24.90s/epoch, loss=1.15, accuracy=0.752, val_loss=2.38, val_accuracy=0.428, lr=0.1]    49%|████▊     | 52/107 [22:01<22:43, 24.80s/epoch, loss=1.14, accuracy=0.752, val_loss=1.83, val_accuracy=0.564, lr=0.1] 50%|████▉     | 53/107 [22:26<22:19, 24.81s/epoch, loss=1.14, accuracy=0.753, val_loss=1.43, val_accuracy=0.636, lr=0.1] 50%|█████     | 54/107 [22:50<21:44, 24.61s/epoch, loss=1.15, accuracy=0.749, val_loss=1.81, val_accuracy=0.544, lr=0.1] 51%|█████▏    | 55/107 [23:14<21:07, 24.38s/epoch, loss=1.14, accuracy=0.756, val_loss=2.1, val_accuracy=0.503, lr=0.0316] 52%|█████▏    | 56/107 [23:38<20:48, 24.49s/epoch, loss=1.15, accuracy=0.75, val_loss=1.63, val_accuracy=0.576, lr=0.1]    53%|█████▎    | 57/107 [24:02<20:09, 24.18s/epoch, loss=1.14, accuracy=0.752, val_loss=2.25, val_accuracy=0.536, lr=0.1] 54%|█████▍    | 58/107 [24:26<19:40, 24.09s/epoch, loss=1.14, accuracy=0.752, val_loss=1.83, val_accuracy=0.56, lr=0.1]  55%|█████▌    | 59/107 [24:50<19:18, 24.14s/epoch, loss=1.14, accuracy=0.753, val_loss=1.68, val_accuracy=0.589, lr=0.1] 56%|█████▌    | 60/107 [25:14<18:49, 24.02s/epoch, loss=1.14, accuracy=0.753, val_loss=1.53, val_accuracy=0.611, lr=0.0316] 57%|█████▋    | 61/107 [25:38<18:31, 24.17s/epoch, loss=1.14, accuracy=0.754, val_loss=1.79, val_accuracy=0.559, lr=0.1]    58%|█████▊    | 62/107 [26:03<18:13, 24.30s/epoch, loss=1.14, accuracy=0.754, val_loss=1.66, val_accuracy=0.576, lr=0.1] 59%|█████▉    | 63/107 [26:26<17:40, 24.10s/epoch, loss=1.14, accuracy=0.752, val_loss=2.01, val_accuracy=0.509, lr=0.1] 60%|█████▉    | 64/107 [26:51<17:23, 24.26s/epoch, loss=1.13, accuracy=0.753, val_loss=1.53, val_accuracy=0.612, lr=0.1] 61%|██████    | 65/107 [27:15<16:55, 24.17s/epoch, loss=1.13, accuracy=0.754, val_loss=1.47, val_accuracy=0.632, lr=0.0316] 62%|██████▏   | 66/107 [27:39<16:34, 24.26s/epoch, loss=1.14, accuracy=0.754, val_loss=1.81, val_accuracy=0.526, lr=0.1]    63%|██████▎   | 67/107 [28:04<16:10, 24.26s/epoch, loss=1.15, accuracy=0.753, val_loss=1.64, val_accuracy=0.604, lr=0.1] 64%|██████▎   | 68/107 [28:28<15:48, 24.33s/epoch, loss=1.14, accuracy=0.754, val_loss=1.61, val_accuracy=0.584, lr=0.1] 64%|██████▍   | 69/107 [28:53<15:25, 24.35s/epoch, loss=1.14, accuracy=0.754, val_loss=10.6, val_accuracy=0.136, lr=0.1] 65%|██████▌   | 70/107 [29:17<15:01, 24.37s/epoch, loss=1.14, accuracy=0.753, val_loss=2.88, val_accuracy=0.383, lr=0.0316] 66%|██████▋   | 71/107 [29:41<14:38, 24.40s/epoch, loss=1.13, accuracy=0.753, val_loss=3.66, val_accuracy=0.32, lr=0.1]     67%|██████▋   | 72/107 [30:06<14:12, 24.37s/epoch, loss=1.14, accuracy=0.753, val_loss=2.67, val_accuracy=0.438, lr=0.1] 68%|██████▊   | 73/107 [30:30<13:50, 24.44s/epoch, loss=1.14, accuracy=0.755, val_loss=1.93, val_accuracy=0.511, lr=0.1] 69%|██████▉   | 74/107 [30:55<13:27, 24.47s/epoch, loss=1.14, accuracy=0.753, val_loss=2.21, val_accuracy=0.481, lr=0.1] 70%|███████   | 75/107 [31:19<12:57, 24.31s/epoch, loss=1.14, accuracy=0.752, val_loss=1.94, val_accuracy=0.532, lr=0.0316] 71%|███████   | 76/107 [31:44<12:38, 24.47s/epoch, loss=1.14, accuracy=0.756, val_loss=1.39, val_accuracy=0.669, lr=0.1]    72%|███████▏  | 77/107 [32:09<12:19, 24.64s/epoch, loss=1.13, accuracy=0.755, val_loss=1.67, val_accuracy=0.612, lr=0.1] 73%|███████▎  | 78/107 [32:33<11:53, 24.61s/epoch, loss=1.14, accuracy=0.757, val_loss=1.93, val_accuracy=0.544, lr=0.1] 74%|███████▍  | 79/107 [32:57<11:24, 24.43s/epoch, loss=1.14, accuracy=0.753, val_loss=1.98, val_accuracy=0.51, lr=0.1]  75%|███████▍  | 80/107 [33:22<10:59, 24.41s/epoch, loss=1.15, accuracy=0.753, val_loss=2.28, val_accuracy=0.45, lr=0.0316] 76%|███████▌  | 81/107 [33:46<10:36, 24.50s/epoch, loss=1.14, accuracy=0.752, val_loss=2.14, val_accuracy=0.506, lr=0.1]   77%|███████▋  | 82/107 [34:11<10:12, 24.51s/epoch, loss=0.933, accuracy=0.811, val_loss=0.979, val_accuracy=0.776, lr=0.01] 78%|███████▊  | 83/107 [34:35<09:46, 24.42s/epoch, loss=0.744, accuracy=0.844, val_loss=0.827, val_accuracy=0.8, lr=0.01]   79%|███████▊  | 84/107 [34:59<09:17, 24.25s/epoch, loss=0.663, accuracy=0.854, val_loss=0.791, val_accuracy=0.804, lr=0.01] 79%|███████▉  | 85/107 [35:22<08:48, 24.02s/epoch, loss=0.616, accuracy=0.859, val_loss=0.744, val_accuracy=0.814, lr=0.01] 80%|████████  | 86/107 [35:47<08:25, 24.07s/epoch, loss=0.595, accuracy=0.858, val_loss=0.762, val_accuracy=0.803, lr=0.01] 81%|████████▏ | 87/107 [36:11<08:05, 24.26s/epoch, loss=0.584, accuracy=0.861, val_loss=0.737, val_accuracy=0.811, lr=0.01] 82%|████████▏ | 88/107 [36:36<07:44, 24.44s/epoch, loss=0.579, accuracy=0.861, val_loss=0.776, val_accuracy=0.802, lr=0.01] 83%|████████▎ | 89/107 [37:01<07:19, 24.44s/epoch, loss=0.576, accuracy=0.862, val_loss=0.863, val_accuracy=0.77, lr=0.01]  84%|████████▍ | 90/107 [37:24<06:49, 24.07s/epoch, loss=0.573, accuracy=0.865, val_loss=0.825, val_accuracy=0.789, lr=0.01] 85%|████████▌ | 91/107 [37:47<06:20, 23.77s/epoch, loss=0.572, accuracy=0.865, val_loss=0.924, val_accuracy=0.754, lr=0.01] 86%|████████▌ | 92/107 [38:12<06:01, 24.10s/epoch, loss=0.566, accuracy=0.868, val_loss=0.889, val_accuracy=0.782, lr=0.00316] 87%|████████▋ | 93/107 [38:36<05:39, 24.23s/epoch, loss=0.564, accuracy=0.871, val_loss=0.822, val_accuracy=0.783, lr=0.01]    88%|████████▊ | 94/107 [39:01<05:17, 24.42s/epoch, loss=0.565, accuracy=0.871, val_loss=0.716, val_accuracy=0.816, lr=0.01] 89%|████████▉ | 95/107 [39:25<04:50, 24.21s/epoch, loss=0.567, accuracy=0.871, val_loss=0.911, val_accuracy=0.779, lr=0.01] 90%|████████▉ | 96/107 [39:49<04:26, 24.19s/epoch, loss=0.566, accuracy=0.871, val_loss=0.868, val_accuracy=0.778, lr=0.01] 91%|█████████ | 97/107 [40:12<03:59, 23.94s/epoch, loss=0.569, accuracy=0.872, val_loss=0.801, val_accuracy=0.796, lr=0.01] 92%|█████████▏| 98/107 [40:37<03:37, 24.16s/epoch, loss=0.56, accuracy=0.874, val_loss=0.903, val_accuracy=0.76, lr=0.01]   93%|█████████▎| 99/107 [41:01<03:13, 24.17s/epoch, loss=0.565, accuracy=0.873, val_loss=0.941, val_accuracy=0.754, lr=0.00316] 93%|█████████▎| 100/107 [41:25<02:48, 24.11s/epoch, loss=0.564, accuracy=0.877, val_loss=0.903, val_accuracy=0.79, lr=0.01]    94%|█████████▍| 101/107 [41:50<02:25, 24.28s/epoch, loss=0.561, accuracy=0.875, val_loss=0.836, val_accuracy=0.792, lr=0.01] 95%|█████████▌| 102/107 [42:14<02:01, 24.26s/epoch, loss=0.565, accuracy=0.875, val_loss=0.817, val_accuracy=0.79, lr=0.01]  96%|█████████▋| 103/107 [42:38<01:37, 24.29s/epoch, loss=0.563, accuracy=0.878, val_loss=0.757, val_accuracy=0.812, lr=0.01] 97%|█████████▋| 104/107 [43:03<01:12, 24.29s/epoch, loss=0.565, accuracy=0.877, val_loss=0.777, val_accuracy=0.805, lr=0.00316] 98%|█████████▊| 105/107 [43:27<00:48, 24.40s/epoch, loss=0.558, accuracy=0.879, val_loss=1.03, val_accuracy=0.751, lr=0.01]     99%|█████████▉| 106/107 [43:52<00:24, 24.40s/epoch, loss=0.562, accuracy=0.879, val_loss=0.846, val_accuracy=0.804, lr=0.01]100%|██████████| 107/107 [44:17<00:00, 24.55s/epoch, loss=0.56, accuracy=0.881, val_loss=1.11, val_accuracy=0.737, lr=0.01]  100%|██████████| 107/107 [44:17<00:00, 24.83s/epoch, loss=0.56, accuracy=0.881, val_loss=1.11, val_accuracy=0.737, lr=0.01]
Using real-time data augmentation.
Test loss: 1.1131895780563354
Test accuracy: 0.7368000149726868


* * * Run SGD for ID = 14_12. * * *


2024-02-15 21:16:01.562121: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 21:16:04.347920: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 21:16:04.349425: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-15 21:16:04.389145: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 21:16:04.389186: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 21:16:04.392164: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 21:16:04.392209: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 21:16:04.394412: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 21:16:04.395123: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 21:16:04.397538: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 21:16:04.399035: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 21:16:04.403621: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 21:16:04.404156: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 21:16:04.404262: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 21:16:05.670581: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-15 21:16:05.671165: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 21:16:05.671640: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 21:16:05.671673: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 21:16:05.671735: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 21:16:05.671756: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 21:16:05.671773: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 21:16:05.671791: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 21:16:05.671809: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 21:16:05.671835: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 21:16:05.671853: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 21:16:05.672349: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 21:16:05.672387: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 21:16:06.342149: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-15 21:16:06.342204: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-15 21:16:06.342215: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-15 21:16:06.343238: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:03:00.0, compute capability: 6.1)
{'id': 1412, 'batch_size': 128, 'epochs': 107, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/107 [00:00<?, ?epoch/s]2024-02-15 21:16:07.153914: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-15 21:16:07.154445: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199950000 Hz
2024-02-15 21:16:09.249975: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 21:16:09.535839: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 21:16:10.422490: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-15 21:16:10.481666: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/107 [01:24<2:29:40, 84.73s/epoch, loss=3.06, accuracy=0.31, val_loss=2.59, val_accuracy=0.218, lr=0.1]  2%|▏         | 2/107 [01:47<1:24:41, 48.39s/epoch, loss=1.57, accuracy=0.532, val_loss=2.33, val_accuracy=0.394, lr=0.1]  3%|▎         | 3/107 [02:10<1:03:52, 36.85s/epoch, loss=1.36, accuracy=0.636, val_loss=2.38, val_accuracy=0.406, lr=0.1]  4%|▎         | 4/107 [02:34<54:27, 31.72s/epoch, loss=1.28, accuracy=0.681, val_loss=2.9, val_accuracy=0.343, lr=0.1]     5%|▍         | 5/107 [02:58<49:12, 28.94s/epoch, loss=1.25, accuracy=0.701, val_loss=1.72, val_accuracy=0.563, lr=0.1]  6%|▌         | 6/107 [03:23<46:26, 27.59s/epoch, loss=1.24, accuracy=0.711, val_loss=2.51, val_accuracy=0.335, lr=0.1]  7%|▋         | 7/107 [03:46<43:38, 26.18s/epoch, loss=1.22, accuracy=0.717, val_loss=2.37, val_accuracy=0.395, lr=0.1]  7%|▋         | 8/107 [04:11<42:20, 25.66s/epoch, loss=1.22, accuracy=0.725, val_loss=1.65, val_accuracy=0.614, lr=0.1]  8%|▊         | 9/107 [04:36<41:41, 25.53s/epoch, loss=1.21, accuracy=0.73, val_loss=1.57, val_accuracy=0.587, lr=0.1]   9%|▉         | 10/107 [05:00<40:38, 25.14s/epoch, loss=1.2, accuracy=0.734, val_loss=1.96, val_accuracy=0.496, lr=0.1] 10%|█         | 11/107 [05:26<40:20, 25.21s/epoch, loss=1.2, accuracy=0.736, val_loss=1.62, val_accuracy=0.586, lr=0.1] 11%|█         | 12/107 [05:49<39:09, 24.73s/epoch, loss=1.2, accuracy=0.736, val_loss=2.7, val_accuracy=0.287, lr=0.1]  12%|█▏        | 13/107 [06:15<38:55, 24.85s/epoch, loss=1.2, accuracy=0.736, val_loss=1.62, val_accuracy=0.601, lr=0.1] 13%|█▎        | 14/107 [06:39<38:14, 24.67s/epoch, loss=1.19, accuracy=0.742, val_loss=3.06, val_accuracy=0.43, lr=0.0316] 14%|█▍        | 15/107 [07:04<37:49, 24.67s/epoch, loss=1.19, accuracy=0.741, val_loss=1.83, val_accuracy=0.502, lr=0.1]   15%|█▍        | 16/107 [07:29<37:35, 24.79s/epoch, loss=1.19, accuracy=0.744, val_loss=1.55, val_accuracy=0.615, lr=0.1] 16%|█▌        | 17/107 [07:54<37:25, 24.95s/epoch, loss=1.18, accuracy=0.746, val_loss=2.02, val_accuracy=0.54, lr=0.1]  17%|█▋        | 18/107 [08:19<37:00, 24.95s/epoch, loss=1.17, accuracy=0.75, val_loss=1.9, val_accuracy=0.574, lr=0.1]  18%|█▊        | 19/107 [08:44<36:27, 24.86s/epoch, loss=1.18, accuracy=0.743, val_loss=1.75, val_accuracy=0.561, lr=0.1] 19%|█▊        | 20/107 [09:09<36:12, 24.97s/epoch, loss=1.17, accuracy=0.748, val_loss=2.15, val_accuracy=0.466, lr=0.1] 20%|█▉        | 21/107 [09:34<35:49, 25.00s/epoch, loss=1.17, accuracy=0.747, val_loss=3.28, val_accuracy=0.428, lr=0.0316] 21%|██        | 22/107 [09:59<35:17, 24.91s/epoch, loss=1.15, accuracy=0.749, val_loss=1.84, val_accuracy=0.544, lr=0.1]    21%|██▏       | 23/107 [10:24<34:55, 24.94s/epoch, loss=1.16, accuracy=0.746, val_loss=1.72, val_accuracy=0.577, lr=0.1] 22%|██▏       | 24/107 [10:48<34:20, 24.83s/epoch, loss=1.16, accuracy=0.75, val_loss=1.84, val_accuracy=0.541, lr=0.1]  23%|██▎       | 25/107 [11:12<33:41, 24.65s/epoch, loss=1.15, accuracy=0.751, val_loss=1.4, val_accuracy=0.652, lr=0.1] 24%|██▍       | 26/107 [11:37<33:22, 24.72s/epoch, loss=1.15, accuracy=0.752, val_loss=5.13, val_accuracy=0.236, lr=0.1] 25%|██▌       | 27/107 [12:03<33:13, 24.92s/epoch, loss=1.15, accuracy=0.752, val_loss=1.94, val_accuracy=0.53, lr=0.1]  26%|██▌       | 28/107 [12:28<32:56, 25.01s/epoch, loss=1.15, accuracy=0.751, val_loss=1.42, val_accuracy=0.655, lr=0.1] 27%|██▋       | 29/107 [12:52<32:12, 24.77s/epoch, loss=1.15, accuracy=0.753, val_loss=1.51, val_accuracy=0.629, lr=0.1] 28%|██▊       | 30/107 [13:16<31:37, 24.64s/epoch, loss=1.15, accuracy=0.752, val_loss=2.3, val_accuracy=0.476, lr=0.0316] 29%|██▉       | 31/107 [13:42<31:30, 24.88s/epoch, loss=1.15, accuracy=0.752, val_loss=1.78, val_accuracy=0.506, lr=0.1]   30%|██▉       | 32/107 [14:06<30:45, 24.60s/epoch, loss=1.15, accuracy=0.752, val_loss=2.65, val_accuracy=0.272, lr=0.1] 31%|███       | 33/107 [14:29<29:55, 24.26s/epoch, loss=1.14, accuracy=0.755, val_loss=2.05, val_accuracy=0.52, lr=0.1]  32%|███▏      | 34/107 [14:54<29:37, 24.35s/epoch, loss=1.14, accuracy=0.752, val_loss=3.94, val_accuracy=0.236, lr=0.1] 33%|███▎      | 35/107 [15:18<29:17, 24.41s/epoch, loss=1.14, accuracy=0.752, val_loss=1.91, val_accuracy=0.448, lr=0.0316] 34%|███▎      | 36/107 [15:42<28:37, 24.19s/epoch, loss=1.13, accuracy=0.755, val_loss=2.32, val_accuracy=0.354, lr=0.1]    35%|███▍      | 37/107 [16:07<28:29, 24.43s/epoch, loss=1.13, accuracy=0.755, val_loss=3.13, val_accuracy=0.408, lr=0.1] 36%|███▌      | 38/107 [16:32<28:17, 24.60s/epoch, loss=1.14, accuracy=0.755, val_loss=1.9, val_accuracy=0.528, lr=0.1]  36%|███▋      | 39/107 [16:57<28:00, 24.71s/epoch, loss=1.14, accuracy=0.756, val_loss=3.73, val_accuracy=0.217, lr=0.1] 37%|███▋      | 40/107 [17:21<27:31, 24.66s/epoch, loss=1.13, accuracy=0.754, val_loss=1.76, val_accuracy=0.514, lr=0.0316] 38%|███▊      | 41/107 [17:46<27:12, 24.73s/epoch, loss=1.13, accuracy=0.756, val_loss=2.1, val_accuracy=0.498, lr=0.1]     39%|███▉      | 42/107 [18:10<26:21, 24.33s/epoch, loss=1.13, accuracy=0.757, val_loss=2.86, val_accuracy=0.31, lr=0.1] 40%|████      | 43/107 [18:34<25:54, 24.29s/epoch, loss=1.14, accuracy=0.755, val_loss=2.21, val_accuracy=0.47, lr=0.1] 41%|████      | 44/107 [18:59<25:34, 24.36s/epoch, loss=1.14, accuracy=0.754, val_loss=2.15, val_accuracy=0.443, lr=0.1] 42%|████▏     | 45/107 [19:23<25:21, 24.53s/epoch, loss=1.13, accuracy=0.757, val_loss=1.65, val_accuracy=0.579, lr=0.0316] 43%|████▎     | 46/107 [19:48<24:54, 24.49s/epoch, loss=1.13, accuracy=0.758, val_loss=3.32, val_accuracy=0.384, lr=0.1]    44%|████▍     | 47/107 [20:13<24:38, 24.65s/epoch, loss=1.14, accuracy=0.753, val_loss=2.1, val_accuracy=0.506, lr=0.1]  45%|████▍     | 48/107 [20:38<24:26, 24.86s/epoch, loss=1.13, accuracy=0.755, val_loss=2.87, val_accuracy=0.404, lr=0.1] 46%|████▌     | 49/107 [21:02<23:49, 24.64s/epoch, loss=1.13, accuracy=0.754, val_loss=2.24, val_accuracy=0.453, lr=0.1] 47%|████▋     | 50/107 [21:27<23:26, 24.68s/epoch, loss=1.12, accuracy=0.758, val_loss=1.61, val_accuracy=0.597, lr=0.0316] 48%|████▊     | 51/107 [21:52<23:07, 24.77s/epoch, loss=1.13, accuracy=0.755, val_loss=2.59, val_accuracy=0.361, lr=0.1]    49%|████▊     | 52/107 [22:16<22:23, 24.42s/epoch, loss=1.13, accuracy=0.757, val_loss=1.65, val_accuracy=0.648, lr=0.1] 50%|████▉     | 53/107 [22:39<21:42, 24.11s/epoch, loss=1.13, accuracy=0.755, val_loss=1.73, val_accuracy=0.574, lr=0.1] 50%|█████     | 54/107 [23:03<21:10, 23.96s/epoch, loss=1.13, accuracy=0.757, val_loss=2.79, val_accuracy=0.439, lr=0.1] 51%|█████▏    | 55/107 [23:27<20:48, 24.02s/epoch, loss=1.13, accuracy=0.759, val_loss=1.59, val_accuracy=0.603, lr=0.0316] 52%|█████▏    | 56/107 [23:52<20:38, 24.29s/epoch, loss=1.12, accuracy=0.758, val_loss=3.95, val_accuracy=0.338, lr=0.1]    53%|█████▎    | 57/107 [24:17<20:23, 24.47s/epoch, loss=1.13, accuracy=0.76, val_loss=2.47, val_accuracy=0.489, lr=0.1]  54%|█████▍    | 58/107 [24:41<19:50, 24.29s/epoch, loss=1.13, accuracy=0.756, val_loss=2.41, val_accuracy=0.305, lr=0.1] 55%|█████▌    | 59/107 [25:06<19:37, 24.52s/epoch, loss=1.13, accuracy=0.756, val_loss=3.99, val_accuracy=0.287, lr=0.1] 56%|█████▌    | 60/107 [25:30<19:04, 24.35s/epoch, loss=1.13, accuracy=0.757, val_loss=1.91, val_accuracy=0.485, lr=0.0316] 57%|█████▋    | 61/107 [25:55<18:48, 24.53s/epoch, loss=1.12, accuracy=0.758, val_loss=2.01, val_accuracy=0.497, lr=0.1]    58%|█████▊    | 62/107 [26:18<18:09, 24.20s/epoch, loss=1.12, accuracy=0.758, val_loss=5.44, val_accuracy=0.235, lr=0.1] 59%|█████▉    | 63/107 [26:43<17:53, 24.40s/epoch, loss=1.12, accuracy=0.756, val_loss=2.84, val_accuracy=0.393, lr=0.1] 60%|█████▉    | 64/107 [27:08<17:37, 24.60s/epoch, loss=1.12, accuracy=0.757, val_loss=2.77, val_accuracy=0.408, lr=0.1] 61%|██████    | 65/107 [27:32<17:13, 24.60s/epoch, loss=1.12, accuracy=0.754, val_loss=1.62, val_accuracy=0.596, lr=0.0316] 62%|██████▏   | 66/107 [27:57<16:46, 24.54s/epoch, loss=1.12, accuracy=0.758, val_loss=1.8, val_accuracy=0.564, lr=0.1]     63%|██████▎   | 67/107 [28:21<16:18, 24.46s/epoch, loss=1.12, accuracy=0.76, val_loss=3.09, val_accuracy=0.391, lr=0.1] 64%|██████▎   | 68/107 [28:46<15:53, 24.44s/epoch, loss=1.12, accuracy=0.758, val_loss=1.84, val_accuracy=0.545, lr=0.1] 64%|██████▍   | 69/107 [29:11<15:37, 24.67s/epoch, loss=1.12, accuracy=0.76, val_loss=2.11, val_accuracy=0.495, lr=0.1]  65%|██████▌   | 70/107 [29:35<15:11, 24.65s/epoch, loss=1.12, accuracy=0.758, val_loss=1.47, val_accuracy=0.636, lr=0.0316] 66%|██████▋   | 71/107 [29:59<14:41, 24.50s/epoch, loss=1.12, accuracy=0.76, val_loss=3.18, val_accuracy=0.326, lr=0.1]     67%|██████▋   | 72/107 [30:23<14:09, 24.28s/epoch, loss=1.13, accuracy=0.759, val_loss=1.49, val_accuracy=0.627, lr=0.1] 68%|██████▊   | 73/107 [30:48<13:53, 24.50s/epoch, loss=1.13, accuracy=0.757, val_loss=2.19, val_accuracy=0.522, lr=0.1] 69%|██████▉   | 74/107 [31:13<13:27, 24.47s/epoch, loss=1.12, accuracy=0.758, val_loss=1.77, val_accuracy=0.521, lr=0.1] 70%|███████   | 75/107 [31:37<13:02, 24.46s/epoch, loss=1.12, accuracy=0.757, val_loss=2.64, val_accuracy=0.324, lr=0.0316] 71%|███████   | 76/107 [32:01<12:32, 24.27s/epoch, loss=1.13, accuracy=0.757, val_loss=3.68, val_accuracy=0.356, lr=0.1]    72%|███████▏  | 77/107 [32:26<12:11, 24.38s/epoch, loss=1.12, accuracy=0.758, val_loss=1.73, val_accuracy=0.569, lr=0.1] 73%|███████▎  | 78/107 [32:50<11:48, 24.43s/epoch, loss=1.12, accuracy=0.758, val_loss=2.37, val_accuracy=0.449, lr=0.1] 74%|███████▍  | 79/107 [33:15<11:24, 24.45s/epoch, loss=1.11, accuracy=0.761, val_loss=2.78, val_accuracy=0.294, lr=0.1] 75%|███████▍  | 80/107 [33:39<10:57, 24.35s/epoch, loss=1.12, accuracy=0.756, val_loss=2.43, val_accuracy=0.335, lr=0.0316] 76%|███████▌  | 81/107 [34:03<10:31, 24.29s/epoch, loss=1.12, accuracy=0.76, val_loss=2.89, val_accuracy=0.344, lr=0.1]     77%|███████▋  | 82/107 [34:27<10:05, 24.24s/epoch, loss=0.909, accuracy=0.818, val_loss=1, val_accuracy=0.76, lr=0.01]  78%|███████▊  | 83/107 [34:52<09:46, 24.42s/epoch, loss=0.727, accuracy=0.851, val_loss=0.805, val_accuracy=0.807, lr=0.01] 79%|███████▊  | 84/107 [35:16<09:20, 24.37s/epoch, loss=0.645, accuracy=0.858, val_loss=0.7, val_accuracy=0.832, lr=0.01]   79%|███████▉  | 85/107 [35:41<09:00, 24.55s/epoch, loss=0.605, accuracy=0.86, val_loss=0.67, val_accuracy=0.836, lr=0.01] 80%|████████  | 86/107 [36:06<08:35, 24.56s/epoch, loss=0.584, accuracy=0.861, val_loss=0.707, val_accuracy=0.822, lr=0.01] 81%|████████▏ | 87/107 [36:30<08:11, 24.58s/epoch, loss=0.569, accuracy=0.863, val_loss=0.82, val_accuracy=0.78, lr=0.01]   82%|████████▏ | 88/107 [36:55<07:47, 24.62s/epoch, loss=0.57, accuracy=0.863, val_loss=0.898, val_accuracy=0.758, lr=0.01] 83%|████████▎ | 89/107 [37:19<07:19, 24.40s/epoch, loss=0.566, accuracy=0.863, val_loss=1.16, val_accuracy=0.699, lr=0.01] 84%|████████▍ | 90/107 [37:43<06:54, 24.36s/epoch, loss=0.561, accuracy=0.868, val_loss=0.851, val_accuracy=0.77, lr=0.00316] 85%|████████▌ | 91/107 [38:07<06:29, 24.34s/epoch, loss=0.557, accuracy=0.869, val_loss=0.881, val_accuracy=0.769, lr=0.01]   86%|████████▌ | 92/107 [38:32<06:05, 24.35s/epoch, loss=0.559, accuracy=0.87, val_loss=0.76, val_accuracy=0.803, lr=0.01]   87%|████████▋ | 93/107 [38:57<05:43, 24.53s/epoch, loss=0.557, accuracy=0.871, val_loss=0.796, val_accuracy=0.792, lr=0.01] 88%|████████▊ | 94/107 [39:22<05:20, 24.68s/epoch, loss=0.558, accuracy=0.87, val_loss=0.738, val_accuracy=0.814, lr=0.01]  89%|████████▉ | 95/107 [39:46<04:53, 24.42s/epoch, loss=0.557, accuracy=0.872, val_loss=1.03, val_accuracy=0.736, lr=0.00316] 90%|████████▉ | 96/107 [40:09<04:26, 24.25s/epoch, loss=0.552, accuracy=0.876, val_loss=0.759, val_accuracy=0.812, lr=0.01]   91%|█████████ | 97/107 [40:33<04:01, 24.10s/epoch, loss=0.558, accuracy=0.874, val_loss=0.735, val_accuracy=0.822, lr=0.01] 92%|█████████▏| 98/107 [40:58<03:37, 24.16s/epoch, loss=0.553, accuracy=0.877, val_loss=0.87, val_accuracy=0.779, lr=0.01]  93%|█████████▎| 99/107 [41:21<03:12, 24.10s/epoch, loss=0.554, accuracy=0.877, val_loss=0.807, val_accuracy=0.803, lr=0.01] 93%|█████████▎| 100/107 [41:46<02:49, 24.16s/epoch, loss=0.554, accuracy=0.878, val_loss=1.2, val_accuracy=0.696, lr=0.00316] 94%|█████████▍| 101/107 [42:10<02:24, 24.10s/epoch, loss=0.55, accuracy=0.879, val_loss=0.96, val_accuracy=0.743, lr=0.01]    95%|█████████▌| 102/107 [42:34<02:00, 24.05s/epoch, loss=0.548, accuracy=0.879, val_loss=0.729, val_accuracy=0.818, lr=0.01] 96%|█████████▋| 103/107 [42:59<01:37, 24.39s/epoch, loss=0.552, accuracy=0.878, val_loss=0.729, val_accuracy=0.826, lr=0.01] 97%|█████████▋| 104/107 [43:23<01:12, 24.29s/epoch, loss=0.553, accuracy=0.879, val_loss=0.688, val_accuracy=0.839, lr=0.01] 98%|█████████▊| 105/107 [43:47<00:48, 24.28s/epoch, loss=0.552, accuracy=0.88, val_loss=0.753, val_accuracy=0.816, lr=0.00316] 99%|█████████▉| 106/107 [44:12<00:24, 24.50s/epoch, loss=0.551, accuracy=0.88, val_loss=0.802, val_accuracy=0.799, lr=0.01]   100%|██████████| 107/107 [44:37<00:00, 24.54s/epoch, loss=0.552, accuracy=0.881, val_loss=0.814, val_accuracy=0.8, lr=0.01] 100%|██████████| 107/107 [44:37<00:00, 25.02s/epoch, loss=0.552, accuracy=0.881, val_loss=0.814, val_accuracy=0.8, lr=0.01]
Using real-time data augmentation.
Test loss: 0.8142356872558594
Test accuracy: 0.7997000217437744


* * * Run SGD for ID = 14_13. * * *


2024-02-15 22:00:47.067380: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 22:00:50.027250: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 22:00:50.028747: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-15 22:00:50.069486: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 22:00:50.069529: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 22:00:50.072908: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 22:00:50.072981: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 22:00:50.075243: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 22:00:50.075953: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 22:00:50.078613: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 22:00:50.080294: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 22:00:50.085022: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 22:00:50.085565: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 22:00:50.085699: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 22:00:51.408120: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-15 22:00:51.409168: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 22:00:51.409742: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 22:00:51.409775: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 22:00:51.409817: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 22:00:51.409836: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 22:00:51.409853: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 22:00:51.409887: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 22:00:51.409905: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 22:00:51.409922: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 22:00:51.409940: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 22:00:51.410515: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 22:00:51.410550: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 22:00:52.130820: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-15 22:00:52.130893: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-15 22:00:52.130903: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-15 22:00:52.132212: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:03:00.0, compute capability: 6.1)
{'id': 1413, 'batch_size': 128, 'epochs': 107, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/107 [00:00<?, ?epoch/s]2024-02-15 22:00:52.927288: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-15 22:00:52.927886: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199950000 Hz
2024-02-15 22:00:54.903090: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 22:00:55.172548: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 22:00:56.132202: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-15 22:00:56.192650: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/107 [01:05<1:54:57, 65.07s/epoch, loss=3.23, accuracy=0.305, val_loss=2.47, val_accuracy=0.215, lr=0.1]  2%|▏         | 2/107 [01:28<1:10:51, 40.49s/epoch, loss=1.53, accuracy=0.545, val_loss=2.45, val_accuracy=0.392, lr=0.1]  3%|▎         | 3/107 [01:53<58:11, 33.57s/epoch, loss=1.31, accuracy=0.646, val_loss=1.68, val_accuracy=0.533, lr=0.1]    4%|▎         | 4/107 [02:18<51:27, 29.97s/epoch, loss=1.25, accuracy=0.685, val_loss=2.32, val_accuracy=0.382, lr=0.1]  5%|▍         | 5/107 [02:43<47:51, 28.15s/epoch, loss=1.22, accuracy=0.702, val_loss=2.56, val_accuracy=0.424, lr=0.1]  6%|▌         | 6/107 [03:07<45:32, 27.06s/epoch, loss=1.21, accuracy=0.712, val_loss=1.98, val_accuracy=0.469, lr=0.1]  7%|▋         | 7/107 [03:32<43:26, 26.07s/epoch, loss=1.2, accuracy=0.718, val_loss=2.02, val_accuracy=0.461, lr=0.1]   7%|▋         | 8/107 [03:57<42:39, 25.85s/epoch, loss=1.19, accuracy=0.725, val_loss=2.01, val_accuracy=0.502, lr=0.0316]  8%|▊         | 9/107 [04:22<41:50, 25.62s/epoch, loss=1.18, accuracy=0.729, val_loss=3.41, val_accuracy=0.313, lr=0.1]     9%|▉         | 10/107 [04:46<40:36, 25.12s/epoch, loss=1.18, accuracy=0.73, val_loss=6.54, val_accuracy=0.213, lr=0.1] 10%|█         | 11/107 [05:10<39:25, 24.65s/epoch, loss=1.17, accuracy=0.734, val_loss=3.08, val_accuracy=0.359, lr=0.1] 11%|█         | 12/107 [05:34<39:04, 24.68s/epoch, loss=1.17, accuracy=0.737, val_loss=2.36, val_accuracy=0.424, lr=0.1] 12%|█▏        | 13/107 [05:59<38:51, 24.80s/epoch, loss=1.17, accuracy=0.739, val_loss=2.91, val_accuracy=0.424, lr=0.0316] 13%|█▎        | 14/107 [06:25<38:37, 24.91s/epoch, loss=1.17, accuracy=0.738, val_loss=2.06, val_accuracy=0.508, lr=0.1]    14%|█▍        | 15/107 [06:49<37:57, 24.75s/epoch, loss=1.16, accuracy=0.743, val_loss=2.06, val_accuracy=0.546, lr=0.1] 15%|█▍        | 16/107 [07:12<36:56, 24.35s/epoch, loss=1.16, accuracy=0.742, val_loss=1.6, val_accuracy=0.583, lr=0.1]  16%|█▌        | 17/107 [07:37<36:34, 24.38s/epoch, loss=1.16, accuracy=0.745, val_loss=3.85, val_accuracy=0.304, lr=0.1] 17%|█▋        | 18/107 [08:01<36:14, 24.43s/epoch, loss=1.15, accuracy=0.748, val_loss=1.5, val_accuracy=0.621, lr=0.1]  18%|█▊        | 19/107 [08:25<35:38, 24.30s/epoch, loss=1.15, accuracy=0.748, val_loss=3.02, val_accuracy=0.366, lr=0.1] 19%|█▊        | 20/107 [08:50<35:24, 24.42s/epoch, loss=1.15, accuracy=0.745, val_loss=2.86, val_accuracy=0.43, lr=0.1]  20%|█▉        | 21/107 [09:14<34:56, 24.38s/epoch, loss=1.15, accuracy=0.745, val_loss=2.15, val_accuracy=0.482, lr=0.1] 21%|██        | 22/107 [09:38<34:23, 24.27s/epoch, loss=1.15, accuracy=0.747, val_loss=2.68, val_accuracy=0.381, lr=0.1] 21%|██▏       | 23/107 [10:03<34:15, 24.47s/epoch, loss=1.14, accuracy=0.748, val_loss=1.9, val_accuracy=0.502, lr=0.0316] 22%|██▏       | 24/107 [10:28<33:54, 24.51s/epoch, loss=1.14, accuracy=0.75, val_loss=1.91, val_accuracy=0.556, lr=0.1]    23%|██▎       | 25/107 [10:53<33:39, 24.62s/epoch, loss=1.14, accuracy=0.752, val_loss=1.94, val_accuracy=0.449, lr=0.1] 24%|██▍       | 26/107 [11:17<33:13, 24.61s/epoch, loss=1.14, accuracy=0.749, val_loss=1.61, val_accuracy=0.598, lr=0.1] 25%|██▌       | 27/107 [11:42<32:53, 24.67s/epoch, loss=1.13, accuracy=0.753, val_loss=1.41, val_accuracy=0.667, lr=0.1] 26%|██▌       | 28/107 [12:07<32:30, 24.69s/epoch, loss=1.15, accuracy=0.749, val_loss=2.49, val_accuracy=0.432, lr=0.1] 27%|██▋       | 29/107 [12:32<32:04, 24.67s/epoch, loss=1.13, accuracy=0.75, val_loss=2.99, val_accuracy=0.475, lr=0.1]  28%|██▊       | 30/107 [12:56<31:44, 24.73s/epoch, loss=1.13, accuracy=0.752, val_loss=2.32, val_accuracy=0.511, lr=0.1] 29%|██▉       | 31/107 [13:21<31:14, 24.66s/epoch, loss=1.13, accuracy=0.751, val_loss=2.43, val_accuracy=0.297, lr=0.1] 30%|██▉       | 32/107 [13:45<30:35, 24.48s/epoch, loss=1.13, accuracy=0.753, val_loss=1.95, val_accuracy=0.511, lr=0.0316] 31%|███       | 33/107 [14:10<30:22, 24.63s/epoch, loss=1.13, accuracy=0.751, val_loss=2.13, val_accuracy=0.493, lr=0.1]    32%|███▏      | 34/107 [14:35<30:03, 24.70s/epoch, loss=1.12, accuracy=0.753, val_loss=2.13, val_accuracy=0.512, lr=0.1] 33%|███▎      | 35/107 [15:00<29:40, 24.74s/epoch, loss=1.12, accuracy=0.754, val_loss=1.93, val_accuracy=0.558, lr=0.1] 34%|███▎      | 36/107 [15:25<29:20, 24.79s/epoch, loss=1.13, accuracy=0.754, val_loss=2.04, val_accuracy=0.41, lr=0.1]  35%|███▍      | 37/107 [15:50<29:01, 24.87s/epoch, loss=1.12, accuracy=0.756, val_loss=3.88, val_accuracy=0.358, lr=0.0316] 36%|███▌      | 38/107 [16:14<28:30, 24.79s/epoch, loss=1.13, accuracy=0.755, val_loss=2.84, val_accuracy=0.227, lr=0.1]    36%|███▋      | 39/107 [16:39<28:06, 24.80s/epoch, loss=1.12, accuracy=0.755, val_loss=4.06, val_accuracy=0.405, lr=0.1] 37%|███▋      | 40/107 [17:04<27:45, 24.86s/epoch, loss=1.12, accuracy=0.757, val_loss=1.83, val_accuracy=0.513, lr=0.1] 38%|███▊      | 41/107 [17:28<26:58, 24.53s/epoch, loss=1.13, accuracy=0.752, val_loss=4.19, val_accuracy=0.23, lr=0.1]  39%|███▉      | 42/107 [17:52<26:18, 24.28s/epoch, loss=1.12, accuracy=0.757, val_loss=2.81, val_accuracy=0.35, lr=0.0316] 40%|████      | 43/107 [18:16<26:02, 24.41s/epoch, loss=1.12, accuracy=0.753, val_loss=1.67, val_accuracy=0.56, lr=0.1]    41%|████      | 44/107 [18:41<25:38, 24.42s/epoch, loss=1.13, accuracy=0.756, val_loss=1.38, val_accuracy=0.68, lr=0.1] 42%|████▏     | 45/107 [19:05<25:15, 24.45s/epoch, loss=1.12, accuracy=0.755, val_loss=2.34, val_accuracy=0.372, lr=0.1] 43%|████▎     | 46/107 [19:30<24:49, 24.42s/epoch, loss=1.12, accuracy=0.755, val_loss=1.5, val_accuracy=0.627, lr=0.1]  44%|████▍     | 47/107 [19:53<24:15, 24.26s/epoch, loss=1.13, accuracy=0.755, val_loss=2.03, val_accuracy=0.51, lr=0.1] 45%|████▍     | 48/107 [20:18<23:52, 24.27s/epoch, loss=1.12, accuracy=0.757, val_loss=2.27, val_accuracy=0.443, lr=0.1] 46%|████▌     | 49/107 [20:42<23:29, 24.30s/epoch, loss=1.11, accuracy=0.757, val_loss=3.44, val_accuracy=0.411, lr=0.0316] 47%|████▋     | 50/107 [21:07<23:13, 24.45s/epoch, loss=1.12, accuracy=0.757, val_loss=2.42, val_accuracy=0.342, lr=0.1]    48%|████▊     | 51/107 [21:31<22:42, 24.34s/epoch, loss=1.12, accuracy=0.757, val_loss=1.7, val_accuracy=0.569, lr=0.1]  49%|████▊     | 52/107 [21:56<22:29, 24.54s/epoch, loss=1.12, accuracy=0.758, val_loss=3.44, val_accuracy=0.264, lr=0.1] 50%|████▉     | 53/107 [22:20<21:54, 24.33s/epoch, loss=1.12, accuracy=0.758, val_loss=1.57, val_accuracy=0.606, lr=0.1] 50%|█████     | 54/107 [22:44<21:25, 24.26s/epoch, loss=1.12, accuracy=0.755, val_loss=1.52, val_accuracy=0.593, lr=0.0316] 51%|█████▏    | 55/107 [23:09<21:11, 24.46s/epoch, loss=1.12, accuracy=0.757, val_loss=2.17, val_accuracy=0.518, lr=0.1]    52%|█████▏    | 56/107 [23:34<20:51, 24.54s/epoch, loss=1.12, accuracy=0.756, val_loss=1.97, val_accuracy=0.474, lr=0.1] 53%|█████▎    | 57/107 [23:58<20:28, 24.57s/epoch, loss=1.12, accuracy=0.756, val_loss=1.83, val_accuracy=0.485, lr=0.1] 54%|█████▍    | 58/107 [24:23<20:07, 24.65s/epoch, loss=1.12, accuracy=0.756, val_loss=3.64, val_accuracy=0.248, lr=0.1]
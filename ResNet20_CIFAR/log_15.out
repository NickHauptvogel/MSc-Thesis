Wed Mar 13 02:36:41 2024       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 545.23.08              Driver Version: 545.23.08    CUDA Version: 12.3     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA TITAN Xp                Off | 00000000:02:00.0 Off |                  N/A |
| 46%   59C    P8              12W / 250W |      0MiB / 12288MiB |      0%      Default |
|                                         |                      |                  N/A |
+-----------------------------------------+----------------------+----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
|  No running processes found                                                           |
+---------------------------------------------------------------------------------------+


* * * Run SGD for cluster size = 15. * * *


Budget: 100


* * * Run SGD for ID = 15_1. * * *


2024-03-13 02:36:42.512267: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 02:36:48.849980: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 02:36:48.852488: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-13 02:36:48.894926: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-13 02:36:48.894964: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 02:36:48.928611: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 02:36:48.928676: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 02:36:48.994601: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 02:36:49.016102: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 02:36:49.039788: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 02:36:49.074013: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 02:36:49.098154: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 02:36:49.098814: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 02:36:49.098943: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 02:36:50.925508: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-13 02:36:50.926070: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 02:36:50.926531: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-13 02:36:50.926567: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 02:36:50.926604: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 02:36:50.926622: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 02:36:50.926638: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 02:36:50.926655: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 02:36:50.926672: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 02:36:50.926689: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 02:36:50.926706: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 02:36:50.927290: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 02:36:50.927348: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 02:36:52.090545: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-13 02:36:52.090831: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-13 02:36:52.090846: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-13 02:36:52.091806: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:02:00.0, compute capability: 6.1)
{'id': '15_01', 'seed': 1, 'out_folder': 'results/epoch_budget_2', 'batch_size': 128, 'epochs': 100, 'validation_split': 0.0, 'checkpointing': False, 'checkpoint_every': -1, 'hold_out_validation_split': 0.0, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'num_classes': 10, 'SSE_lr': False, 'test_time_augmentation': False, 'debug': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
y_train shape: (50000, 10)
x_val shape: (10000, 32, 32, 3)
y_val shape: (10000, 10)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/100 [00:00<?, ?epoch/s]2024-03-13 02:36:52.854278: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-13 02:36:52.866191: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199825000 Hz
2024-03-13 02:36:55.052980: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 02:36:55.318620: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 02:36:57.244032: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-13 02:36:57.277472: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/100 [00:56<1:33:46, 56.84s/epoch, loss=3.24, accuracy=0.314, val_loss=2.63, val_accuracy=0.216, lr=0.1]  2%|▏         | 2/100 [01:19<59:58, 36.72s/epoch, loss=1.62, accuracy=0.511, val_loss=1.99, val_accuracy=0.402, lr=0.1]    3%|▎         | 3/100 [01:41<48:40, 30.11s/epoch, loss=1.46, accuracy=0.594, val_loss=2.05, val_accuracy=0.441, lr=0.1]  4%|▍         | 4/100 [02:03<43:12, 27.01s/epoch, loss=1.37, accuracy=0.649, val_loss=2.53, val_accuracy=0.425, lr=0.1]  5%|▌         | 5/100 [02:26<40:09, 25.37s/epoch, loss=1.3, accuracy=0.687, val_loss=1.56, val_accuracy=0.613, lr=0.1]   6%|▌         | 6/100 [02:48<38:07, 24.33s/epoch, loss=1.27, accuracy=0.703, val_loss=2.14, val_accuracy=0.427, lr=0.1]  7%|▋         | 7/100 [03:11<36:44, 23.70s/epoch, loss=1.25, accuracy=0.712, val_loss=1.63, val_accuracy=0.573, lr=0.1]  8%|▊         | 8/100 [03:33<35:41, 23.27s/epoch, loss=1.24, accuracy=0.719, val_loss=2, val_accuracy=0.523, lr=0.1]     9%|▉         | 9/100 [03:55<34:50, 22.98s/epoch, loss=1.23, accuracy=0.723, val_loss=2.33, val_accuracy=0.425, lr=0.1] 10%|█         | 10/100 [04:18<34:05, 22.73s/epoch, loss=1.22, accuracy=0.728, val_loss=2.59, val_accuracy=0.408, lr=0.1] 11%|█         | 11/100 [04:40<33:29, 22.58s/epoch, loss=1.22, accuracy=0.729, val_loss=1.87, val_accuracy=0.512, lr=0.1] 12%|█▏        | 12/100 [05:02<33:04, 22.55s/epoch, loss=1.21, accuracy=0.731, val_loss=1.84, val_accuracy=0.539, lr=0.1] 13%|█▎        | 13/100 [05:25<32:37, 22.50s/epoch, loss=1.21, accuracy=0.733, val_loss=2.01, val_accuracy=0.507, lr=0.1] 14%|█▍        | 14/100 [05:47<32:11, 22.45s/epoch, loss=1.21, accuracy=0.735, val_loss=2.49, val_accuracy=0.43, lr=0.1]  15%|█▌        | 15/100 [06:09<31:42, 22.38s/epoch, loss=1.2, accuracy=0.737, val_loss=1.6, val_accuracy=0.626, lr=0.1]  16%|█▌        | 16/100 [06:32<31:24, 22.43s/epoch, loss=1.2, accuracy=0.74, val_loss=1.81, val_accuracy=0.54, lr=0.1]  17%|█▋        | 17/100 [06:54<30:58, 22.39s/epoch, loss=1.2, accuracy=0.74, val_loss=2.39, val_accuracy=0.484, lr=0.1] 18%|█▊        | 18/100 [07:17<30:40, 22.45s/epoch, loss=1.19, accuracy=0.744, val_loss=1.97, val_accuracy=0.51, lr=0.1] 19%|█▉        | 19/100 [07:39<30:16, 22.43s/epoch, loss=1.18, accuracy=0.743, val_loss=1.85, val_accuracy=0.518, lr=0.1] 20%|██        | 20/100 [08:01<29:55, 22.45s/epoch, loss=1.19, accuracy=0.743, val_loss=1.76, val_accuracy=0.549, lr=0.1] 21%|██        | 21/100 [08:24<29:33, 22.44s/epoch, loss=1.19, accuracy=0.743, val_loss=1.51, val_accuracy=0.626, lr=0.1] 22%|██▏       | 22/100 [08:46<29:09, 22.43s/epoch, loss=1.17, accuracy=0.747, val_loss=1.88, val_accuracy=0.523, lr=0.1] 23%|██▎       | 23/100 [09:09<28:48, 22.45s/epoch, loss=1.18, accuracy=0.746, val_loss=3.28, val_accuracy=0.279, lr=0.1] 24%|██▍       | 24/100 [09:31<28:25, 22.44s/epoch, loss=1.18, accuracy=0.748, val_loss=1.68, val_accuracy=0.569, lr=0.1] 25%|██▌       | 25/100 [09:54<28:02, 22.43s/epoch, loss=1.17, accuracy=0.747, val_loss=2.1, val_accuracy=0.471, lr=0.1]  26%|██▌       | 26/100 [10:16<27:38, 22.41s/epoch, loss=1.17, accuracy=0.748, val_loss=1.54, val_accuracy=0.618, lr=0.1] 27%|██▋       | 27/100 [10:38<27:14, 22.39s/epoch, loss=1.17, accuracy=0.747, val_loss=2.47, val_accuracy=0.338, lr=0.1] 28%|██▊       | 28/100 [11:01<26:51, 22.38s/epoch, loss=1.17, accuracy=0.748, val_loss=2.52, val_accuracy=0.451, lr=0.1] 29%|██▉       | 29/100 [11:23<26:30, 22.40s/epoch, loss=1.16, accuracy=0.75, val_loss=1.85, val_accuracy=0.494, lr=0.1]  30%|███       | 30/100 [11:46<26:12, 22.46s/epoch, loss=1.17, accuracy=0.747, val_loss=1.8, val_accuracy=0.535, lr=0.1] 31%|███       | 31/100 [12:08<25:50, 22.47s/epoch, loss=1.16, accuracy=0.751, val_loss=1.79, val_accuracy=0.528, lr=0.1] 32%|███▏      | 32/100 [12:31<25:27, 22.47s/epoch, loss=1.16, accuracy=0.751, val_loss=2.44, val_accuracy=0.488, lr=0.1] 33%|███▎      | 33/100 [12:53<25:01, 22.42s/epoch, loss=1.17, accuracy=0.751, val_loss=1.54, val_accuracy=0.623, lr=0.1] 34%|███▍      | 34/100 [13:15<24:40, 22.43s/epoch, loss=1.17, accuracy=0.75, val_loss=2.8, val_accuracy=0.358, lr=0.1]   35%|███▌      | 35/100 [13:38<24:18, 22.44s/epoch, loss=1.16, accuracy=0.75, val_loss=1.85, val_accuracy=0.535, lr=0.1] 36%|███▌      | 36/100 [14:00<23:55, 22.42s/epoch, loss=1.16, accuracy=0.75, val_loss=2.31, val_accuracy=0.511, lr=0.1] 37%|███▋      | 37/100 [14:23<23:36, 22.48s/epoch, loss=1.15, accuracy=0.753, val_loss=2.5, val_accuracy=0.433, lr=0.1] 38%|███▊      | 38/100 [14:45<23:09, 22.41s/epoch, loss=1.16, accuracy=0.75, val_loss=2.36, val_accuracy=0.47, lr=0.1]  39%|███▉      | 39/100 [15:08<22:54, 22.54s/epoch, loss=1.16, accuracy=0.752, val_loss=2.73, val_accuracy=0.444, lr=0.1] 40%|████      | 40/100 [15:31<22:33, 22.56s/epoch, loss=1.16, accuracy=0.75, val_loss=1.86, val_accuracy=0.542, lr=0.1]  41%|████      | 41/100 [15:53<22:10, 22.55s/epoch, loss=1.15, accuracy=0.753, val_loss=2.42, val_accuracy=0.502, lr=0.1] 42%|████▏     | 42/100 [16:16<21:48, 22.56s/epoch, loss=0.934, accuracy=0.815, val_loss=0.943, val_accuracy=0.795, lr=0.01] 43%|████▎     | 43/100 [16:38<21:23, 22.52s/epoch, loss=0.75, accuracy=0.849, val_loss=0.84, val_accuracy=0.804, lr=0.01]   44%|████▍     | 44/100 [17:01<21:00, 22.50s/epoch, loss=0.665, accuracy=0.855, val_loss=0.727, val_accuracy=0.827, lr=0.01] 45%|████▌     | 45/100 [17:23<20:38, 22.51s/epoch, loss=0.619, accuracy=0.859, val_loss=0.695, val_accuracy=0.827, lr=0.01] 46%|████▌     | 46/100 [17:46<20:16, 22.53s/epoch, loss=0.598, accuracy=0.861, val_loss=0.707, val_accuracy=0.825, lr=0.01] 47%|████▋     | 47/100 [18:08<19:52, 22.50s/epoch, loss=0.582, accuracy=0.863, val_loss=0.842, val_accuracy=0.783, lr=0.01] 48%|████▊     | 48/100 [18:31<19:29, 22.49s/epoch, loss=0.577, accuracy=0.863, val_loss=0.826, val_accuracy=0.788, lr=0.01] 49%|████▉     | 49/100 [18:53<19:08, 22.51s/epoch, loss=0.575, accuracy=0.865, val_loss=0.811, val_accuracy=0.792, lr=0.01] 50%|█████     | 50/100 [19:16<18:43, 22.48s/epoch, loss=0.569, accuracy=0.868, val_loss=0.759, val_accuracy=0.806, lr=0.01] 51%|█████     | 51/100 [19:38<18:18, 22.43s/epoch, loss=0.569, accuracy=0.868, val_loss=0.693, val_accuracy=0.827, lr=0.01] 52%|█████▏    | 52/100 [20:00<17:56, 22.42s/epoch, loss=0.567, accuracy=0.87, val_loss=0.674, val_accuracy=0.833, lr=0.01]  53%|█████▎    | 53/100 [20:23<17:37, 22.51s/epoch, loss=0.568, accuracy=0.871, val_loss=0.728, val_accuracy=0.827, lr=0.01] 54%|█████▍    | 54/100 [20:46<17:16, 22.54s/epoch, loss=0.569, accuracy=0.872, val_loss=0.844, val_accuracy=0.791, lr=0.01] 55%|█████▌    | 55/100 [21:08<16:52, 22.50s/epoch, loss=0.563, accuracy=0.874, val_loss=0.787, val_accuracy=0.806, lr=0.01] 56%|█████▌    | 56/100 [21:31<16:29, 22.50s/epoch, loss=0.565, accuracy=0.875, val_loss=0.785, val_accuracy=0.811, lr=0.01] 57%|█████▋    | 57/100 [21:53<16:07, 22.50s/epoch, loss=0.564, accuracy=0.878, val_loss=0.727, val_accuracy=0.827, lr=0.01] 58%|█████▊    | 58/100 [22:16<15:49, 22.60s/epoch, loss=0.565, accuracy=0.876, val_loss=0.75, val_accuracy=0.822, lr=0.01]  59%|█████▉    | 59/100 [22:38<15:25, 22.58s/epoch, loss=0.562, accuracy=0.879, val_loss=0.719, val_accuracy=0.827, lr=0.01] 60%|██████    | 60/100 [23:01<15:01, 22.53s/epoch, loss=0.559, accuracy=0.88, val_loss=0.929, val_accuracy=0.784, lr=0.01]  61%|██████    | 61/100 [23:23<14:36, 22.49s/epoch, loss=0.56, accuracy=0.881, val_loss=0.753, val_accuracy=0.816, lr=0.01] 62%|██████▏   | 62/100 [23:46<14:15, 22.51s/epoch, loss=0.485, accuracy=0.906, val_loss=0.546, val_accuracy=0.886, lr=0.001] 63%|██████▎   | 63/100 [24:08<13:51, 22.48s/epoch, loss=0.436, accuracy=0.921, val_loss=0.526, val_accuracy=0.89, lr=0.001]  64%|██████▍   | 64/100 [24:31<13:27, 22.44s/epoch, loss=0.413, accuracy=0.928, val_loss=0.513, val_accuracy=0.892, lr=0.001] 65%|██████▌   | 65/100 [24:53<13:05, 22.44s/epoch, loss=0.397, accuracy=0.931, val_loss=0.512, val_accuracy=0.892, lr=0.001] 66%|██████▌   | 66/100 [25:15<12:41, 22.41s/epoch, loss=0.384, accuracy=0.934, val_loss=0.497, val_accuracy=0.894, lr=0.001] 67%|██████▋   | 67/100 [25:38<12:18, 22.38s/epoch, loss=0.37, accuracy=0.937, val_loss=0.49, val_accuracy=0.896, lr=0.001]   68%|██████▊   | 68/100 [26:00<11:56, 22.38s/epoch, loss=0.361, accuracy=0.938, val_loss=0.49, val_accuracy=0.897, lr=0.001] 69%|██████▉   | 69/100 [26:22<11:34, 22.40s/epoch, loss=0.348, accuracy=0.942, val_loss=0.485, val_accuracy=0.894, lr=0.001] 70%|███████   | 70/100 [26:45<11:12, 22.42s/epoch, loss=0.34, accuracy=0.943, val_loss=0.48, val_accuracy=0.899, lr=0.001]   71%|███████   | 71/100 [27:07<10:51, 22.48s/epoch, loss=0.331, accuracy=0.944, val_loss=0.477, val_accuracy=0.897, lr=0.001] 72%|███████▏  | 72/100 [27:30<10:27, 22.43s/epoch, loss=0.323, accuracy=0.945, val_loss=0.471, val_accuracy=0.894, lr=0.001] 73%|███████▎  | 73/100 [27:52<10:04, 22.37s/epoch, loss=0.313, accuracy=0.948, val_loss=0.459, val_accuracy=0.9, lr=0.001]   74%|███████▍  | 74/100 [28:15<09:42, 22.40s/epoch, loss=0.307, accuracy=0.948, val_loss=0.47, val_accuracy=0.897, lr=0.001] 75%|███████▌  | 75/100 [28:37<09:19, 22.39s/epoch, loss=0.301, accuracy=0.949, val_loss=0.467, val_accuracy=0.892, lr=0.001] 76%|███████▌  | 76/100 [28:59<08:58, 22.42s/epoch, loss=0.295, accuracy=0.95, val_loss=0.456, val_accuracy=0.901, lr=0.001]  77%|███████▋  | 77/100 [29:22<08:36, 22.47s/epoch, loss=0.287, accuracy=0.951, val_loss=0.472, val_accuracy=0.895, lr=0.001] 78%|███████▊  | 78/100 [29:44<08:14, 22.48s/epoch, loss=0.282, accuracy=0.952, val_loss=0.463, val_accuracy=0.895, lr=0.001] 79%|███████▉  | 79/100 [30:07<07:51, 22.45s/epoch, loss=0.276, accuracy=0.954, val_loss=0.478, val_accuracy=0.892, lr=0.001] 80%|████████  | 80/100 [30:29<07:29, 22.47s/epoch, loss=0.271, accuracy=0.954, val_loss=0.467, val_accuracy=0.89, lr=0.001]  81%|████████  | 81/100 [30:52<07:06, 22.43s/epoch, loss=0.268, accuracy=0.953, val_loss=0.453, val_accuracy=0.896, lr=0.001] 82%|████████▏ | 82/100 [31:14<06:42, 22.38s/epoch, loss=0.251, accuracy=0.96, val_loss=0.428, val_accuracy=0.906, lr=1e-04]  83%|████████▎ | 83/100 [31:36<06:19, 22.33s/epoch, loss=0.243, accuracy=0.964, val_loss=0.427, val_accuracy=0.906, lr=1e-04] 84%|████████▍ | 84/100 [31:59<05:57, 22.35s/epoch, loss=0.238, accuracy=0.966, val_loss=0.422, val_accuracy=0.906, lr=1e-04] 85%|████████▌ | 85/100 [32:21<05:35, 22.34s/epoch, loss=0.235, accuracy=0.967, val_loss=0.42, val_accuracy=0.907, lr=1e-04]  86%|████████▌ | 86/100 [32:43<05:13, 22.37s/epoch, loss=0.232, accuracy=0.968, val_loss=0.423, val_accuracy=0.907, lr=1e-04] 87%|████████▋ | 87/100 [33:06<04:50, 22.36s/epoch, loss=0.233, accuracy=0.967, val_loss=0.42, val_accuracy=0.908, lr=1e-04]  88%|████████▊ | 88/100 [33:28<04:28, 22.35s/epoch, loss=0.228, accuracy=0.969, val_loss=0.423, val_accuracy=0.908, lr=1e-04] 89%|████████▉ | 89/100 [33:50<04:05, 22.33s/epoch, loss=0.229, accuracy=0.968, val_loss=0.42, val_accuracy=0.907, lr=1e-04]  90%|█████████ | 90/100 [34:13<03:43, 22.35s/epoch, loss=0.226, accuracy=0.97, val_loss=0.417, val_accuracy=0.909, lr=1e-04] 91%|█████████ | 91/100 [34:35<03:21, 22.36s/epoch, loss=0.228, accuracy=0.968, val_loss=0.42, val_accuracy=0.908, lr=1e-04] 92%|█████████▏| 92/100 [34:57<02:58, 22.36s/epoch, loss=0.223, accuracy=0.969, val_loss=0.42, val_accuracy=0.908, lr=5e-5]  93%|█████████▎| 93/100 [35:20<02:36, 22.35s/epoch, loss=0.223, accuracy=0.97, val_loss=0.42, val_accuracy=0.907, lr=5e-5]  94%|█████████▍| 94/100 [35:42<02:13, 22.29s/epoch, loss=0.223, accuracy=0.969, val_loss=0.419, val_accuracy=0.909, lr=5e-5] 95%|█████████▌| 95/100 [36:04<01:51, 22.30s/epoch, loss=0.223, accuracy=0.97, val_loss=0.42, val_accuracy=0.908, lr=5e-5]   96%|█████████▌| 96/100 [36:27<01:29, 22.33s/epoch, loss=0.222, accuracy=0.97, val_loss=0.419, val_accuracy=0.907, lr=5e-5] 97%|█████████▋| 97/100 [36:49<01:06, 22.30s/epoch, loss=0.219, accuracy=0.971, val_loss=0.419, val_accuracy=0.907, lr=5e-5] 98%|█████████▊| 98/100 [37:11<00:44, 22.28s/epoch, loss=0.221, accuracy=0.97, val_loss=0.419, val_accuracy=0.907, lr=5e-5]  99%|█████████▉| 99/100 [37:33<00:22, 22.27s/epoch, loss=0.22, accuracy=0.971, val_loss=0.417, val_accuracy=0.908, lr=5e-5]100%|██████████| 100/100 [37:56<00:00, 22.29s/epoch, loss=0.217, accuracy=0.972, val_loss=0.419, val_accuracy=0.908, lr=5e-5]100%|██████████| 100/100 [37:56<00:00, 22.76s/epoch, loss=0.217, accuracy=0.972, val_loss=0.419, val_accuracy=0.908, lr=5e-5]
Using real-time data augmentation.
Only one model saved

Loading model: 15_01_cifar10_ResNet20v1.h5
Test score: 0.41933637857437134
Test accuracy: 0.90829998254776


* * * Run SGD for ID = 15_2. * * *


2024-03-13 03:14:56.975412: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 03:15:02.280264: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 03:15:02.281282: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-13 03:15:02.321106: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-13 03:15:02.321143: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 03:15:02.323620: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 03:15:02.323659: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 03:15:02.325671: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 03:15:02.326272: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 03:15:02.328521: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 03:15:02.329908: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 03:15:02.334593: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 03:15:02.335136: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 03:15:02.335227: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 03:15:03.619186: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-13 03:15:03.620215: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 03:15:03.620992: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-13 03:15:03.621024: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 03:15:03.621085: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 03:15:03.621104: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 03:15:03.621120: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 03:15:03.621136: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 03:15:03.621153: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 03:15:03.621170: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 03:15:03.621188: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 03:15:03.621649: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 03:15:03.621683: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 03:15:04.293738: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-13 03:15:04.293784: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-13 03:15:04.293795: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-13 03:15:04.294735: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:02:00.0, compute capability: 6.1)
{'id': '15_02', 'seed': 2, 'out_folder': 'results/epoch_budget_2', 'batch_size': 128, 'epochs': 100, 'validation_split': 0.0, 'checkpointing': False, 'checkpoint_every': -1, 'hold_out_validation_split': 0.0, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'num_classes': 10, 'SSE_lr': False, 'test_time_augmentation': False, 'debug': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
y_train shape: (50000, 10)
x_val shape: (10000, 32, 32, 3)
y_val shape: (10000, 10)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/100 [00:00<?, ?epoch/s]2024-03-13 03:15:04.939560: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-13 03:15:04.951184: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199825000 Hz
2024-03-13 03:15:07.059711: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 03:15:07.461378: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 03:15:08.175579: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-13 03:15:08.212738: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/100 [00:53<1:28:25, 53.60s/epoch, loss=2.93, accuracy=0.354, val_loss=2.46, val_accuracy=0.278, lr=0.1]  2%|▏         | 2/100 [01:16<57:36, 35.27s/epoch, loss=1.5, accuracy=0.567, val_loss=1.75, val_accuracy=0.503, lr=0.1]     3%|▎         | 3/100 [01:38<47:30, 29.39s/epoch, loss=1.32, accuracy=0.651, val_loss=2.19, val_accuracy=0.477, lr=0.1]  4%|▍         | 4/100 [02:00<42:32, 26.59s/epoch, loss=1.25, accuracy=0.693, val_loss=3.05, val_accuracy=0.38, lr=0.1]   5%|▌         | 5/100 [02:23<39:41, 25.06s/epoch, loss=1.23, accuracy=0.709, val_loss=2.69, val_accuracy=0.329, lr=0.1]  6%|▌         | 6/100 [02:45<37:46, 24.11s/epoch, loss=1.21, accuracy=0.721, val_loss=2.18, val_accuracy=0.471, lr=0.1]  7%|▋         | 7/100 [03:07<36:34, 23.59s/epoch, loss=1.21, accuracy=0.723, val_loss=2.02, val_accuracy=0.442, lr=0.1]  8%|▊         | 8/100 [03:30<35:48, 23.36s/epoch, loss=1.19, accuracy=0.73, val_loss=1.87, val_accuracy=0.492, lr=0.1]   9%|▉         | 9/100 [03:53<35:02, 23.11s/epoch, loss=1.18, accuracy=0.731, val_loss=2.57, val_accuracy=0.379, lr=0.1] 10%|█         | 10/100 [04:15<34:18, 22.87s/epoch, loss=1.18, accuracy=0.735, val_loss=2.94, val_accuracy=0.376, lr=0.1] 11%|█         | 11/100 [04:37<33:37, 22.67s/epoch, loss=1.17, accuracy=0.741, val_loss=2.51, val_accuracy=0.453, lr=0.1] 12%|█▏        | 12/100 [05:00<33:10, 22.62s/epoch, loss=1.16, accuracy=0.741, val_loss=3.48, val_accuracy=0.333, lr=0.1] 13%|█▎        | 13/100 [05:22<32:43, 22.57s/epoch, loss=1.16, accuracy=0.741, val_loss=1.96, val_accuracy=0.556, lr=0.1] 14%|█▍        | 14/100 [05:45<32:17, 22.53s/epoch, loss=1.15, accuracy=0.745, val_loss=1.5, val_accuracy=0.635, lr=0.1]  15%|█▌        | 15/100 [06:07<31:50, 22.47s/epoch, loss=1.15, accuracy=0.745, val_loss=4.84, val_accuracy=0.282, lr=0.1] 16%|█▌        | 16/100 [06:29<31:24, 22.43s/epoch, loss=1.15, accuracy=0.745, val_loss=1.7, val_accuracy=0.539, lr=0.1]  17%|█▋        | 17/100 [06:52<30:59, 22.40s/epoch, loss=1.14, accuracy=0.747, val_loss=2.88, val_accuracy=0.285, lr=0.1] 18%|█▊        | 18/100 [07:14<30:38, 22.42s/epoch, loss=1.14, accuracy=0.75, val_loss=1.74, val_accuracy=0.572, lr=0.1]  19%|█▉        | 19/100 [07:37<30:14, 22.40s/epoch, loss=1.14, accuracy=0.747, val_loss=1.77, val_accuracy=0.529, lr=0.1] 20%|██        | 20/100 [07:59<29:52, 22.41s/epoch, loss=1.13, accuracy=0.75, val_loss=1.94, val_accuracy=0.465, lr=0.1]  21%|██        | 21/100 [08:21<29:29, 22.40s/epoch, loss=1.13, accuracy=0.753, val_loss=1.55, val_accuracy=0.599, lr=0.1] 22%|██▏       | 22/100 [08:44<29:13, 22.48s/epoch, loss=1.13, accuracy=0.75, val_loss=3.14, val_accuracy=0.349, lr=0.1]  23%|██▎       | 23/100 [09:07<28:50, 22.48s/epoch, loss=1.14, accuracy=0.752, val_loss=1.46, val_accuracy=0.644, lr=0.1] 24%|██▍       | 24/100 [09:29<28:26, 22.46s/epoch, loss=1.13, accuracy=0.753, val_loss=1.95, val_accuracy=0.501, lr=0.1] 25%|██▌       | 25/100 [09:52<28:08, 22.51s/epoch, loss=1.12, accuracy=0.755, val_loss=2.9, val_accuracy=0.401, lr=0.1]  26%|██▌       | 26/100 [10:14<27:44, 22.50s/epoch, loss=1.13, accuracy=0.755, val_loss=1.48, val_accuracy=0.668, lr=0.1] 27%|██▋       | 27/100 [10:36<27:18, 22.44s/epoch, loss=1.12, accuracy=0.755, val_loss=1.44, val_accuracy=0.626, lr=0.1] 28%|██▊       | 28/100 [10:59<26:56, 22.45s/epoch, loss=1.12, accuracy=0.754, val_loss=1.5, val_accuracy=0.623, lr=0.1]  29%|██▉       | 29/100 [11:21<26:32, 22.43s/epoch, loss=1.12, accuracy=0.757, val_loss=3.11, val_accuracy=0.329, lr=0.1] 30%|███       | 30/100 [11:44<26:11, 22.45s/epoch, loss=1.12, accuracy=0.755, val_loss=4.9, val_accuracy=0.311, lr=0.1]  31%|███       | 31/100 [12:06<25:45, 22.40s/epoch, loss=1.12, accuracy=0.757, val_loss=1.81, val_accuracy=0.525, lr=0.1] 32%|███▏      | 32/100 [12:28<25:24, 22.42s/epoch, loss=1.12, accuracy=0.756, val_loss=3.09, val_accuracy=0.39, lr=0.1]  33%|███▎      | 33/100 [12:51<25:00, 22.39s/epoch, loss=1.12, accuracy=0.755, val_loss=2.5, val_accuracy=0.39, lr=0.1]  34%|███▍      | 34/100 [13:13<24:34, 22.35s/epoch, loss=1.11, accuracy=0.758, val_loss=1.83, val_accuracy=0.523, lr=0.1] 35%|███▌      | 35/100 [13:35<24:12, 22.34s/epoch, loss=1.12, accuracy=0.756, val_loss=2.08, val_accuracy=0.464, lr=0.1] 36%|███▌      | 36/100 [13:58<23:52, 22.39s/epoch, loss=1.12, accuracy=0.755, val_loss=1.98, val_accuracy=0.499, lr=0.1] 37%|███▋      | 37/100 [14:20<23:28, 22.36s/epoch, loss=1.12, accuracy=0.755, val_loss=2.47, val_accuracy=0.456, lr=0.1] 38%|███▊      | 38/100 [14:42<23:06, 22.36s/epoch, loss=1.11, accuracy=0.759, val_loss=2.08, val_accuracy=0.491, lr=0.1] 39%|███▉      | 39/100 [15:05<22:45, 22.38s/epoch, loss=1.12, accuracy=0.756, val_loss=2.04, val_accuracy=0.534, lr=0.1] 40%|████      | 40/100 [15:27<22:22, 22.38s/epoch, loss=1.1, accuracy=0.76, val_loss=1.76, val_accuracy=0.514, lr=0.1]   41%|████      | 41/100 [15:50<22:00, 22.38s/epoch, loss=1.11, accuracy=0.757, val_loss=1.92, val_accuracy=0.501, lr=0.1] 42%|████▏     | 42/100 [16:12<21:35, 22.33s/epoch, loss=0.885, accuracy=0.82, val_loss=0.88, val_accuracy=0.808, lr=0.01] 43%|████▎     | 43/100 [16:34<21:13, 22.35s/epoch, loss=0.715, accuracy=0.851, val_loss=0.925, val_accuracy=0.759, lr=0.01] 44%|████▍     | 44/100 [16:57<20:56, 22.43s/epoch, loss=0.639, accuracy=0.858, val_loss=0.702, val_accuracy=0.831, lr=0.01] 45%|████▌     | 45/100 [17:19<20:33, 22.42s/epoch, loss=0.597, accuracy=0.861, val_loss=0.726, val_accuracy=0.819, lr=0.01] 46%|████▌     | 46/100 [17:42<20:12, 22.46s/epoch, loss=0.579, accuracy=0.863, val_loss=0.918, val_accuracy=0.754, lr=0.01] 47%|████▋     | 47/100 [18:04<19:50, 22.47s/epoch, loss=0.571, accuracy=0.864, val_loss=0.768, val_accuracy=0.797, lr=0.01] 48%|████▊     | 48/100 [18:27<19:27, 22.45s/epoch, loss=0.564, accuracy=0.865, val_loss=0.75, val_accuracy=0.801, lr=0.01]  49%|████▉     | 49/100 [18:49<19:05, 22.45s/epoch, loss=0.56, accuracy=0.868, val_loss=0.714, val_accuracy=0.811, lr=0.01] 50%|█████     | 50/100 [19:12<18:43, 22.46s/epoch, loss=0.558, accuracy=0.868, val_loss=1.04, val_accuracy=0.727, lr=0.01] 51%|█████     | 51/100 [19:34<18:20, 22.45s/epoch, loss=0.554, accuracy=0.87, val_loss=0.875, val_accuracy=0.765, lr=0.01] 52%|█████▏    | 52/100 [19:56<17:56, 22.43s/epoch, loss=0.556, accuracy=0.871, val_loss=1.29, val_accuracy=0.678, lr=0.01] 53%|█████▎    | 53/100 [20:19<17:34, 22.44s/epoch, loss=0.552, accuracy=0.874, val_loss=1.12, val_accuracy=0.718, lr=0.01] 54%|█████▍    | 54/100 [20:41<17:13, 22.47s/epoch, loss=0.555, accuracy=0.872, val_loss=0.849, val_accuracy=0.788, lr=0.01] 55%|█████▌    | 55/100 [21:04<16:51, 22.47s/epoch, loss=0.554, accuracy=0.875, val_loss=1.14, val_accuracy=0.715, lr=0.01]  56%|█████▌    | 56/100 [21:26<16:27, 22.44s/epoch, loss=0.552, accuracy=0.875, val_loss=0.78, val_accuracy=0.805, lr=0.01] 57%|█████▋    | 57/100 [21:49<16:04, 22.43s/epoch, loss=0.549, accuracy=0.877, val_loss=0.899, val_accuracy=0.779, lr=0.01] 58%|█████▊    | 58/100 [22:11<15:42, 22.43s/epoch, loss=0.554, accuracy=0.875, val_loss=1.01, val_accuracy=0.727, lr=0.01]  59%|█████▉    | 59/100 [22:34<15:20, 22.45s/epoch, loss=0.549, accuracy=0.878, val_loss=0.796, val_accuracy=0.809, lr=0.01] 60%|██████    | 60/100 [22:56<14:57, 22.43s/epoch, loss=0.549, accuracy=0.88, val_loss=0.72, val_accuracy=0.823, lr=0.01]   61%|██████    | 61/100 [23:19<14:35, 22.44s/epoch, loss=0.549, accuracy=0.881, val_loss=0.939, val_accuracy=0.758, lr=0.01] 62%|██████▏   | 62/100 [23:41<14:11, 22.40s/epoch, loss=0.474, accuracy=0.906, val_loss=0.526, val_accuracy=0.888, lr=0.001] 63%|██████▎   | 63/100 [24:03<13:49, 22.41s/epoch, loss=0.421, accuracy=0.923, val_loss=0.506, val_accuracy=0.895, lr=0.001] 64%|██████▍   | 64/100 [24:26<13:29, 22.49s/epoch, loss=0.4, accuracy=0.929, val_loss=0.5, val_accuracy=0.894, lr=0.001]     65%|██████▌   | 65/100 [24:49<13:08, 22.53s/epoch, loss=0.384, accuracy=0.931, val_loss=0.493, val_accuracy=0.899, lr=0.001] 66%|██████▌   | 66/100 [25:11<12:45, 22.51s/epoch, loss=0.37, accuracy=0.935, val_loss=0.498, val_accuracy=0.892, lr=0.001]  67%|██████▋   | 67/100 [25:33<12:20, 22.43s/epoch, loss=0.36, accuracy=0.937, val_loss=0.477, val_accuracy=0.901, lr=0.001] 68%|██████▊   | 68/100 [25:56<11:57, 22.42s/epoch, loss=0.348, accuracy=0.939, val_loss=0.491, val_accuracy=0.892, lr=0.001] 69%|██████▉   | 69/100 [26:18<11:35, 22.43s/epoch, loss=0.338, accuracy=0.942, val_loss=0.488, val_accuracy=0.893, lr=0.001] 70%|███████   | 70/100 [26:40<11:08, 22.28s/epoch, loss=0.329, accuracy=0.943, val_loss=0.473, val_accuracy=0.897, lr=0.001] 71%|███████   | 71/100 [27:02<10:40, 22.09s/epoch, loss=0.319, accuracy=0.946, val_loss=0.497, val_accuracy=0.891, lr=0.001] 72%|███████▏  | 72/100 [27:23<10:15, 21.96s/epoch, loss=0.314, accuracy=0.945, val_loss=0.47, val_accuracy=0.895, lr=0.001]  73%|███████▎  | 73/100 [27:45<09:51, 21.89s/epoch, loss=0.31, accuracy=0.945, val_loss=0.472, val_accuracy=0.895, lr=0.001] 74%|███████▍  | 74/100 [28:07<09:28, 21.85s/epoch, loss=0.299, accuracy=0.948, val_loss=0.466, val_accuracy=0.897, lr=0.001] 75%|███████▌  | 75/100 [28:29<09:08, 21.93s/epoch, loss=0.293, accuracy=0.948, val_loss=0.463, val_accuracy=0.895, lr=0.001] 76%|███████▌  | 76/100 [28:51<08:46, 21.92s/epoch, loss=0.291, accuracy=0.949, val_loss=0.469, val_accuracy=0.894, lr=0.001] 77%|███████▋  | 77/100 [29:13<08:23, 21.90s/epoch, loss=0.28, accuracy=0.951, val_loss=0.475, val_accuracy=0.888, lr=0.001]  78%|███████▊  | 78/100 [29:35<08:01, 21.91s/epoch, loss=0.278, accuracy=0.951, val_loss=0.452, val_accuracy=0.894, lr=0.001] 79%|███████▉  | 79/100 [29:57<07:41, 21.98s/epoch, loss=0.27, accuracy=0.952, val_loss=0.467, val_accuracy=0.892, lr=0.001]  80%|████████  | 80/100 [30:19<07:19, 21.98s/epoch, loss=0.267, accuracy=0.953, val_loss=0.49, val_accuracy=0.886, lr=0.001] 81%|████████  | 81/100 [30:41<07:01, 22.16s/epoch, loss=0.263, accuracy=0.952, val_loss=0.49, val_accuracy=0.883, lr=0.001] 82%|████████▏ | 82/100 [31:03<06:37, 22.08s/epoch, loss=0.244, accuracy=0.961, val_loss=0.425, val_accuracy=0.903, lr=1e-04] 83%|████████▎ | 83/100 [31:25<06:14, 22.04s/epoch, loss=0.235, accuracy=0.965, val_loss=0.425, val_accuracy=0.905, lr=1e-04] 84%|████████▍ | 84/100 [31:47<05:52, 22.04s/epoch, loss=0.23, accuracy=0.966, val_loss=0.423, val_accuracy=0.904, lr=1e-04]  85%|████████▌ | 85/100 [32:10<05:32, 22.19s/epoch, loss=0.228, accuracy=0.966, val_loss=0.426, val_accuracy=0.905, lr=1e-04] 86%|████████▌ | 86/100 [32:32<05:10, 22.17s/epoch, loss=0.226, accuracy=0.968, val_loss=0.424, val_accuracy=0.905, lr=1e-04] 87%|████████▋ | 87/100 [32:54<04:47, 22.14s/epoch, loss=0.223, accuracy=0.969, val_loss=0.424, val_accuracy=0.904, lr=1e-04] 88%|████████▊ | 88/100 [33:16<04:25, 22.13s/epoch, loss=0.223, accuracy=0.968, val_loss=0.423, val_accuracy=0.903, lr=1e-04] 89%|████████▉ | 89/100 [33:38<04:03, 22.15s/epoch, loss=0.223, accuracy=0.967, val_loss=0.423, val_accuracy=0.903, lr=1e-04] 90%|█████████ | 90/100 [34:01<03:41, 22.18s/epoch, loss=0.222, accuracy=0.967, val_loss=0.426, val_accuracy=0.903, lr=1e-04] 91%|█████████ | 91/100 [34:23<03:19, 22.19s/epoch, loss=0.22, accuracy=0.969, val_loss=0.426, val_accuracy=0.903, lr=1e-04]  92%|█████████▏| 92/100 [34:45<02:57, 22.22s/epoch, loss=0.216, accuracy=0.97, val_loss=0.425, val_accuracy=0.904, lr=5e-5]  93%|█████████▎| 93/100 [35:07<02:35, 22.18s/epoch, loss=0.217, accuracy=0.97, val_loss=0.425, val_accuracy=0.903, lr=5e-5] 94%|█████████▍| 94/100 [35:29<02:12, 22.14s/epoch, loss=0.216, accuracy=0.97, val_loss=0.427, val_accuracy=0.903, lr=5e-5] 95%|█████████▌| 95/100 [35:51<01:50, 22.15s/epoch, loss=0.216, accuracy=0.971, val_loss=0.425, val_accuracy=0.903, lr=5e-5] 96%|█████████▌| 96/100 [36:14<01:28, 22.23s/epoch, loss=0.214, accuracy=0.971, val_loss=0.426, val_accuracy=0.903, lr=5e-5] 97%|█████████▋| 97/100 [36:36<01:06, 22.27s/epoch, loss=0.216, accuracy=0.97, val_loss=0.425, val_accuracy=0.903, lr=5e-5]  98%|█████████▊| 98/100 [36:58<00:44, 22.29s/epoch, loss=0.215, accuracy=0.97, val_loss=0.426, val_accuracy=0.903, lr=5e-5] 99%|█████████▉| 99/100 [37:21<00:22, 22.29s/epoch, loss=0.211, accuracy=0.972, val_loss=0.425, val_accuracy=0.904, lr=5e-5]100%|██████████| 100/100 [37:43<00:00, 22.26s/epoch, loss=0.212, accuracy=0.971, val_loss=0.426, val_accuracy=0.903, lr=5e-5]100%|██████████| 100/100 [37:43<00:00, 22.63s/epoch, loss=0.212, accuracy=0.971, val_loss=0.426, val_accuracy=0.903, lr=5e-5]
Using real-time data augmentation.
Only one model saved

Loading model: 15_02_cifar10_ResNet20v1.h5
Test score: 0.4262034296989441
Test accuracy: 0.9027000069618225


* * * Run SGD for ID = 15_3. * * *


2024-03-13 03:52:52.868512: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 03:52:55.571884: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 03:52:55.573084: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-13 03:52:55.612511: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-13 03:52:55.612543: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 03:52:55.615406: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 03:52:55.615448: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 03:52:55.617709: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 03:52:55.618916: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 03:52:55.621378: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 03:52:55.622864: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 03:52:55.627935: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 03:52:55.633785: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 03:52:55.633868: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 03:52:57.059553: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-13 03:52:57.060589: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 03:52:57.061458: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-13 03:52:57.061504: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 03:52:57.061547: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 03:52:57.061566: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 03:52:57.061581: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 03:52:57.061599: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 03:52:57.061614: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 03:52:57.061630: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 03:52:57.061646: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 03:52:57.062119: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 03:52:57.062156: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 03:52:57.763592: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-13 03:52:57.763647: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-13 03:52:57.763656: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-13 03:52:57.764650: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:02:00.0, compute capability: 6.1)
{'id': '15_03', 'seed': 3, 'out_folder': 'results/epoch_budget_2', 'batch_size': 128, 'epochs': 100, 'validation_split': 0.0, 'checkpointing': False, 'checkpoint_every': -1, 'hold_out_validation_split': 0.0, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'num_classes': 10, 'SSE_lr': False, 'test_time_augmentation': False, 'debug': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
y_train shape: (50000, 10)
x_val shape: (10000, 32, 32, 3)
y_val shape: (10000, 10)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/100 [00:00<?, ?epoch/s]2024-03-13 03:52:58.441962: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-13 03:52:58.454183: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199825000 Hz
2024-03-13 03:53:00.598538: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 03:53:00.855546: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 03:53:01.633567: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-13 03:53:01.683436: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/100 [00:59<1:38:29, 59.70s/epoch, loss=2.89, accuracy=0.385, val_loss=2.69, val_accuracy=0.347, lr=0.1]  2%|▏         | 2/100 [01:22<1:01:35, 37.71s/epoch, loss=1.47, accuracy=0.584, val_loss=1.78, val_accuracy=0.473, lr=0.1]  3%|▎         | 3/100 [01:44<49:34, 30.67s/epoch, loss=1.3, accuracy=0.663, val_loss=1.88, val_accuracy=0.502, lr=0.1]     4%|▍         | 4/100 [02:06<43:34, 27.24s/epoch, loss=1.25, accuracy=0.694, val_loss=1.9, val_accuracy=0.496, lr=0.1]  5%|▌         | 5/100 [02:28<40:07, 25.34s/epoch, loss=1.24, accuracy=0.707, val_loss=3.2, val_accuracy=0.296, lr=0.1]  6%|▌         | 6/100 [02:50<37:54, 24.20s/epoch, loss=1.23, accuracy=0.714, val_loss=1.74, val_accuracy=0.571, lr=0.1]  7%|▋         | 7/100 [03:12<36:22, 23.47s/epoch, loss=1.22, accuracy=0.721, val_loss=1.61, val_accuracy=0.571, lr=0.1]  8%|▊         | 8/100 [03:34<35:16, 23.01s/epoch, loss=1.21, accuracy=0.726, val_loss=1.61, val_accuracy=0.589, lr=0.1]  9%|▉         | 9/100 [03:56<34:26, 22.71s/epoch, loss=1.2, accuracy=0.731, val_loss=1.67, val_accuracy=0.562, lr=0.1]  10%|█         | 10/100 [04:18<33:43, 22.49s/epoch, loss=1.19, accuracy=0.734, val_loss=2.52, val_accuracy=0.329, lr=0.1] 11%|█         | 11/100 [04:40<33:07, 22.34s/epoch, loss=1.19, accuracy=0.735, val_loss=1.67, val_accuracy=0.589, lr=0.1] 12%|█▏        | 12/100 [05:02<32:33, 22.20s/epoch, loss=1.2, accuracy=0.736, val_loss=2.14, val_accuracy=0.445, lr=0.1]  13%|█▎        | 13/100 [05:24<32:07, 22.16s/epoch, loss=1.18, accuracy=0.74, val_loss=3.27, val_accuracy=0.278, lr=0.1] 14%|█▍        | 14/100 [05:46<31:39, 22.08s/epoch, loss=1.18, accuracy=0.739, val_loss=1.84, val_accuracy=0.521, lr=0.1] 15%|█▌        | 15/100 [06:08<31:16, 22.07s/epoch, loss=1.18, accuracy=0.741, val_loss=1.39, val_accuracy=0.667, lr=0.1] 16%|█▌        | 16/100 [06:30<30:53, 22.07s/epoch, loss=1.18, accuracy=0.743, val_loss=1.47, val_accuracy=0.64, lr=0.1]  17%|█▋        | 17/100 [06:52<30:33, 22.09s/epoch, loss=1.17, accuracy=0.744, val_loss=3.73, val_accuracy=0.327, lr=0.1] 18%|█▊        | 18/100 [07:14<30:08, 22.06s/epoch, loss=1.17, accuracy=0.743, val_loss=1.88, val_accuracy=0.521, lr=0.1] 19%|█▉        | 19/100 [07:36<29:49, 22.09s/epoch, loss=1.17, accuracy=0.746, val_loss=1.76, val_accuracy=0.566, lr=0.1] 20%|██        | 20/100 [07:58<29:30, 22.13s/epoch, loss=1.16, accuracy=0.746, val_loss=2.07, val_accuracy=0.493, lr=0.1] 21%|██        | 21/100 [08:20<29:07, 22.12s/epoch, loss=1.17, accuracy=0.747, val_loss=1.82, val_accuracy=0.548, lr=0.1] 22%|██▏       | 22/100 [08:42<28:44, 22.11s/epoch, loss=1.16, accuracy=0.751, val_loss=2.01, val_accuracy=0.498, lr=0.1] 23%|██▎       | 23/100 [09:05<28:23, 22.12s/epoch, loss=1.16, accuracy=0.751, val_loss=1.65, val_accuracy=0.592, lr=0.1] 24%|██▍       | 24/100 [09:27<28:03, 22.15s/epoch, loss=1.17, accuracy=0.749, val_loss=1.55, val_accuracy=0.613, lr=0.1] 25%|██▌       | 25/100 [09:49<27:39, 22.12s/epoch, loss=1.16, accuracy=0.748, val_loss=1.91, val_accuracy=0.557, lr=0.1] 26%|██▌       | 26/100 [10:11<27:17, 22.13s/epoch, loss=1.16, accuracy=0.751, val_loss=1.91, val_accuracy=0.48, lr=0.1]  27%|██▋       | 27/100 [10:33<26:54, 22.12s/epoch, loss=1.16, accuracy=0.75, val_loss=6.79, val_accuracy=0.148, lr=0.1] 28%|██▊       | 28/100 [10:55<26:31, 22.11s/epoch, loss=1.15, accuracy=0.751, val_loss=2.53, val_accuracy=0.447, lr=0.1] 29%|██▉       | 29/100 [11:17<26:09, 22.10s/epoch, loss=1.15, accuracy=0.753, val_loss=1.79, val_accuracy=0.536, lr=0.1] 30%|███       | 30/100 [11:39<25:48, 22.11s/epoch, loss=1.15, accuracy=0.752, val_loss=2.2, val_accuracy=0.395, lr=0.1]  31%|███       | 31/100 [12:01<25:23, 22.07s/epoch, loss=1.15, accuracy=0.752, val_loss=1.71, val_accuracy=0.574, lr=0.1] 32%|███▏      | 32/100 [12:23<24:58, 22.03s/epoch, loss=1.13, accuracy=0.756, val_loss=2.15, val_accuracy=0.439, lr=0.1] 33%|███▎      | 33/100 [12:45<24:36, 22.03s/epoch, loss=1.14, accuracy=0.754, val_loss=1.31, val_accuracy=0.693, lr=0.1] 34%|███▍      | 34/100 [13:07<24:13, 22.02s/epoch, loss=1.14, accuracy=0.753, val_loss=1.55, val_accuracy=0.612, lr=0.1] 35%|███▌      | 35/100 [13:29<23:50, 22.01s/epoch, loss=1.14, accuracy=0.755, val_loss=1.59, val_accuracy=0.593, lr=0.1] 36%|███▌      | 36/100 [13:51<23:27, 21.99s/epoch, loss=1.13, accuracy=0.753, val_loss=1.54, val_accuracy=0.63, lr=0.1]  37%|███▋      | 37/100 [14:13<23:05, 22.00s/epoch, loss=1.13, accuracy=0.756, val_loss=1.72, val_accuracy=0.573, lr=0.1] 38%|███▊      | 38/100 [14:35<22:42, 21.98s/epoch, loss=1.13, accuracy=0.754, val_loss=1.48, val_accuracy=0.628, lr=0.1] 39%|███▉      | 39/100 [14:57<22:22, 22.01s/epoch, loss=1.14, accuracy=0.754, val_loss=1.93, val_accuracy=0.496, lr=0.1] 40%|████      | 40/100 [15:19<22:01, 22.03s/epoch, loss=1.14, accuracy=0.756, val_loss=1.95, val_accuracy=0.541, lr=0.1] 41%|████      | 41/100 [15:41<21:39, 22.03s/epoch, loss=1.14, accuracy=0.755, val_loss=3.79, val_accuracy=0.266, lr=0.1] 42%|████▏     | 42/100 [16:03<21:16, 22.01s/epoch, loss=0.924, accuracy=0.817, val_loss=0.951, val_accuracy=0.791, lr=0.01] 43%|████▎     | 43/100 [16:25<20:56, 22.04s/epoch, loss=0.74, accuracy=0.848, val_loss=0.821, val_accuracy=0.808, lr=0.01]  44%|████▍     | 44/100 [16:48<20:35, 22.07s/epoch, loss=0.656, accuracy=0.858, val_loss=0.742, val_accuracy=0.822, lr=0.01] 45%|████▌     | 45/100 [17:10<20:15, 22.10s/epoch, loss=0.611, accuracy=0.859, val_loss=0.755, val_accuracy=0.807, lr=0.01] 46%|████▌     | 46/100 [17:32<19:52, 22.09s/epoch, loss=0.587, accuracy=0.863, val_loss=0.858, val_accuracy=0.782, lr=0.01] 47%|████▋     | 47/100 [17:54<19:30, 22.09s/epoch, loss=0.58, accuracy=0.861, val_loss=0.709, val_accuracy=0.823, lr=0.01]  48%|████▊     | 48/100 [18:16<19:15, 22.22s/epoch, loss=0.576, accuracy=0.862, val_loss=0.779, val_accuracy=0.798, lr=0.01] 49%|████▉     | 49/100 [18:39<18:54, 22.24s/epoch, loss=0.568, accuracy=0.867, val_loss=0.969, val_accuracy=0.731, lr=0.01] 50%|█████     | 50/100 [19:01<18:29, 22.19s/epoch, loss=0.565, accuracy=0.868, val_loss=0.954, val_accuracy=0.753, lr=0.01] 51%|█████     | 51/100 [19:23<18:04, 22.14s/epoch, loss=0.562, accuracy=0.87, val_loss=0.751, val_accuracy=0.812, lr=0.01]  52%|█████▏    | 52/100 [19:45<17:40, 22.08s/epoch, loss=0.561, accuracy=0.87, val_loss=0.738, val_accuracy=0.814, lr=0.01] 53%|█████▎    | 53/100 [20:07<17:19, 22.11s/epoch, loss=0.559, accuracy=0.874, val_loss=0.762, val_accuracy=0.807, lr=0.01] 54%|█████▍    | 54/100 [20:29<16:57, 22.12s/epoch, loss=0.56, accuracy=0.873, val_loss=1.17, val_accuracy=0.715, lr=0.01]   55%|█████▌    | 55/100 [20:51<16:34, 22.10s/epoch, loss=0.562, accuracy=0.874, val_loss=0.887, val_accuracy=0.771, lr=0.01] 56%|█████▌    | 56/100 [21:13<16:14, 22.14s/epoch, loss=0.561, accuracy=0.875, val_loss=0.769, val_accuracy=0.815, lr=0.01] 57%|█████▋    | 57/100 [21:36<15:51, 22.13s/epoch, loss=0.559, accuracy=0.877, val_loss=0.829, val_accuracy=0.786, lr=0.01] 58%|█████▊    | 58/100 [21:58<15:29, 22.14s/epoch, loss=0.565, accuracy=0.875, val_loss=0.783, val_accuracy=0.8, lr=0.01]   59%|█████▉    | 59/100 [22:20<15:08, 22.15s/epoch, loss=0.555, accuracy=0.879, val_loss=0.749, val_accuracy=0.82, lr=0.01] 60%|██████    | 60/100 [22:42<14:46, 22.15s/epoch, loss=0.557, accuracy=0.879, val_loss=0.859, val_accuracy=0.789, lr=0.01] 61%|██████    | 61/100 [23:04<14:22, 22.11s/epoch, loss=0.559, accuracy=0.878, val_loss=0.836, val_accuracy=0.782, lr=0.01] 62%|██████▏   | 62/100 [23:26<13:59, 22.09s/epoch, loss=0.476, accuracy=0.908, val_loss=0.543, val_accuracy=0.887, lr=0.001] 63%|██████▎   | 63/100 [23:48<13:36, 22.08s/epoch, loss=0.427, accuracy=0.923, val_loss=0.517, val_accuracy=0.893, lr=0.001] 64%|██████▍   | 64/100 [24:10<13:14, 22.08s/epoch, loss=0.404, accuracy=0.93, val_loss=0.505, val_accuracy=0.896, lr=0.001]  65%|██████▌   | 65/100 [24:32<12:53, 22.09s/epoch, loss=0.388, accuracy=0.934, val_loss=0.499, val_accuracy=0.896, lr=0.001] 66%|██████▌   | 66/100 [24:54<12:29, 22.06s/epoch, loss=0.374, accuracy=0.937, val_loss=0.492, val_accuracy=0.896, lr=0.001] 67%|██████▋   | 67/100 [25:16<12:07, 22.03s/epoch, loss=0.362, accuracy=0.939, val_loss=0.495, val_accuracy=0.894, lr=0.001] 68%|██████▊   | 68/100 [25:38<11:44, 22.03s/epoch, loss=0.35, accuracy=0.941, val_loss=0.481, val_accuracy=0.9, lr=0.001]    69%|██████▉   | 69/100 [26:00<11:23, 22.04s/epoch, loss=0.341, accuracy=0.942, val_loss=0.478, val_accuracy=0.901, lr=0.001] 70%|███████   | 70/100 [26:22<11:01, 22.04s/epoch, loss=0.333, accuracy=0.944, val_loss=0.499, val_accuracy=0.891, lr=0.001] 71%|███████   | 71/100 [26:44<10:38, 22.02s/epoch, loss=0.324, accuracy=0.946, val_loss=0.488, val_accuracy=0.895, lr=0.001] 72%|███████▏  | 72/100 [27:06<10:17, 22.05s/epoch, loss=0.317, accuracy=0.946, val_loss=0.472, val_accuracy=0.9, lr=0.001]   73%|███████▎  | 73/100 [27:29<09:56, 22.10s/epoch, loss=0.307, accuracy=0.949, val_loss=0.486, val_accuracy=0.893, lr=0.001] 74%|███████▍  | 74/100 [27:51<09:35, 22.13s/epoch, loss=0.3, accuracy=0.949, val_loss=0.466, val_accuracy=0.899, lr=0.001]   75%|███████▌  | 75/100 [28:13<09:13, 22.13s/epoch, loss=0.294, accuracy=0.951, val_loss=0.465, val_accuracy=0.898, lr=0.001] 76%|███████▌  | 76/100 [28:35<08:51, 22.15s/epoch, loss=0.287, accuracy=0.952, val_loss=0.476, val_accuracy=0.894, lr=0.001] 77%|███████▋  | 77/100 [28:57<08:29, 22.15s/epoch, loss=0.282, accuracy=0.954, val_loss=0.482, val_accuracy=0.894, lr=0.001] 78%|███████▊  | 78/100 [29:20<08:07, 22.18s/epoch, loss=0.276, accuracy=0.954, val_loss=0.472, val_accuracy=0.895, lr=0.001] 79%|███████▉  | 79/100 [29:42<07:45, 22.18s/epoch, loss=0.271, accuracy=0.954, val_loss=0.477, val_accuracy=0.894, lr=0.001] 80%|████████  | 80/100 [30:04<07:23, 22.18s/epoch, loss=0.265, accuracy=0.956, val_loss=0.459, val_accuracy=0.895, lr=0.001] 81%|████████  | 81/100 [30:26<06:59, 22.10s/epoch, loss=0.261, accuracy=0.956, val_loss=0.486, val_accuracy=0.891, lr=0.001] 82%|████████▏ | 82/100 [30:48<06:38, 22.11s/epoch, loss=0.243, accuracy=0.963, val_loss=0.434, val_accuracy=0.905, lr=1e-04] 83%|████████▎ | 83/100 [31:10<06:15, 22.07s/epoch, loss=0.234, accuracy=0.967, val_loss=0.433, val_accuracy=0.905, lr=1e-04] 84%|████████▍ | 84/100 [31:32<05:52, 22.04s/epoch, loss=0.23, accuracy=0.969, val_loss=0.434, val_accuracy=0.907, lr=1e-04]  85%|████████▌ | 85/100 [31:54<05:29, 21.99s/epoch, loss=0.23, accuracy=0.967, val_loss=0.433, val_accuracy=0.907, lr=1e-04] 86%|████████▌ | 86/100 [32:16<05:07, 21.96s/epoch, loss=0.228, accuracy=0.968, val_loss=0.432, val_accuracy=0.907, lr=1e-04] 87%|████████▋ | 87/100 [32:38<04:45, 21.95s/epoch, loss=0.226, accuracy=0.968, val_loss=0.431, val_accuracy=0.907, lr=1e-04] 88%|████████▊ | 88/100 [33:00<04:23, 21.98s/epoch, loss=0.222, accuracy=0.971, val_loss=0.433, val_accuracy=0.908, lr=1e-04] 89%|████████▉ | 89/100 [33:22<04:01, 21.97s/epoch, loss=0.222, accuracy=0.97, val_loss=0.432, val_accuracy=0.907, lr=1e-04]  90%|█████████ | 90/100 [33:44<03:39, 21.94s/epoch, loss=0.22, accuracy=0.971, val_loss=0.432, val_accuracy=0.906, lr=1e-04] 91%|█████████ | 91/100 [34:06<03:17, 21.95s/epoch, loss=0.218, accuracy=0.971, val_loss=0.432, val_accuracy=0.907, lr=1e-04] 92%|█████████▏| 92/100 [34:27<02:55, 21.91s/epoch, loss=0.218, accuracy=0.971, val_loss=0.432, val_accuracy=0.907, lr=5e-5]  93%|█████████▎| 93/100 [34:49<02:33, 21.88s/epoch, loss=0.215, accuracy=0.973, val_loss=0.431, val_accuracy=0.909, lr=5e-5] 94%|█████████▍| 94/100 [35:11<02:11, 21.89s/epoch, loss=0.213, accuracy=0.973, val_loss=0.431, val_accuracy=0.907, lr=5e-5] 95%|█████████▌| 95/100 [35:33<01:49, 21.90s/epoch, loss=0.215, accuracy=0.973, val_loss=0.432, val_accuracy=0.907, lr=5e-5] 96%|█████████▌| 96/100 [35:55<01:27, 21.89s/epoch, loss=0.212, accuracy=0.974, val_loss=0.433, val_accuracy=0.908, lr=5e-5] 97%|█████████▋| 97/100 [36:17<01:05, 21.89s/epoch, loss=0.214, accuracy=0.972, val_loss=0.431, val_accuracy=0.907, lr=5e-5] 98%|█████████▊| 98/100 [36:39<00:43, 21.93s/epoch, loss=0.214, accuracy=0.972, val_loss=0.433, val_accuracy=0.906, lr=5e-5] 99%|█████████▉| 99/100 [37:01<00:21, 21.95s/epoch, loss=0.213, accuracy=0.973, val_loss=0.432, val_accuracy=0.905, lr=5e-5]100%|██████████| 100/100 [37:23<00:00, 21.95s/epoch, loss=0.212, accuracy=0.973, val_loss=0.432, val_accuracy=0.907, lr=5e-5]100%|██████████| 100/100 [37:23<00:00, 22.43s/epoch, loss=0.212, accuracy=0.973, val_loss=0.432, val_accuracy=0.907, lr=5e-5]
Using real-time data augmentation.
Only one model saved

Loading model: 15_03_cifar10_ResNet20v1.h5
Test score: 0.43225806951522827
Test accuracy: 0.9070000052452087


* * * Run SGD for ID = 15_4. * * *


2024-03-13 04:30:25.661787: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 04:30:28.304492: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 04:30:28.305486: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-13 04:30:28.344490: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-13 04:30:28.344520: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 04:30:28.347335: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 04:30:28.347392: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 04:30:28.349687: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 04:30:28.350319: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 04:30:28.352835: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 04:30:28.354274: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 04:30:28.359175: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 04:30:28.359718: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 04:30:28.359809: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 04:30:29.678369: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-13 04:30:29.679422: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 04:30:29.680254: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-13 04:30:29.680289: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 04:30:29.680329: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 04:30:29.680347: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 04:30:29.680382: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 04:30:29.680399: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 04:30:29.680423: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 04:30:29.680441: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 04:30:29.680474: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 04:30:29.680932: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 04:30:29.680966: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 04:30:30.353373: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-13 04:30:30.353429: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-13 04:30:30.353439: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-13 04:30:30.354417: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:02:00.0, compute capability: 6.1)
{'id': '15_04', 'seed': 4, 'out_folder': 'results/epoch_budget_2', 'batch_size': 128, 'epochs': 100, 'validation_split': 0.0, 'checkpointing': False, 'checkpoint_every': -1, 'hold_out_validation_split': 0.0, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'num_classes': 10, 'SSE_lr': False, 'test_time_augmentation': False, 'debug': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
y_train shape: (50000, 10)
x_val shape: (10000, 32, 32, 3)
y_val shape: (10000, 10)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/100 [00:00<?, ?epoch/s]2024-03-13 04:30:31.041927: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-13 04:30:31.054190: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199825000 Hz
2024-03-13 04:30:33.134903: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 04:30:33.381765: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 04:30:34.160532: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-13 04:30:34.211897: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/100 [00:59<1:37:42, 59.22s/epoch, loss=2.86, accuracy=0.396, val_loss=2.66, val_accuracy=0.22, lr=0.1]  2%|▏         | 2/100 [01:22<1:01:50, 37.86s/epoch, loss=1.47, accuracy=0.583, val_loss=2.26, val_accuracy=0.376, lr=0.1]  3%|▎         | 3/100 [01:44<49:41, 30.74s/epoch, loss=1.3, accuracy=0.662, val_loss=2.01, val_accuracy=0.422, lr=0.1]     4%|▍         | 4/100 [02:06<43:47, 27.36s/epoch, loss=1.25, accuracy=0.696, val_loss=5.01, val_accuracy=0.23, lr=0.1]  5%|▌         | 5/100 [02:28<40:20, 25.48s/epoch, loss=1.24, accuracy=0.708, val_loss=1.82, val_accuracy=0.502, lr=0.1]  6%|▌         | 6/100 [02:50<38:10, 24.37s/epoch, loss=1.22, accuracy=0.716, val_loss=1.9, val_accuracy=0.511, lr=0.1]   7%|▋         | 7/100 [03:13<36:45, 23.72s/epoch, loss=1.22, accuracy=0.72, val_loss=1.8, val_accuracy=0.554, lr=0.1]   8%|▊         | 8/100 [03:35<35:37, 23.23s/epoch, loss=1.21, accuracy=0.724, val_loss=1.94, val_accuracy=0.498, lr=0.1]  9%|▉         | 9/100 [03:57<34:42, 22.89s/epoch, loss=1.2, accuracy=0.73, val_loss=1.63, val_accuracy=0.617, lr=0.1]   10%|█         | 10/100 [04:19<34:03, 22.71s/epoch, loss=1.21, accuracy=0.729, val_loss=2.65, val_accuracy=0.364, lr=0.1] 11%|█         | 11/100 [04:42<33:35, 22.64s/epoch, loss=1.21, accuracy=0.731, val_loss=2.41, val_accuracy=0.438, lr=0.1] 12%|█▏        | 12/100 [05:04<32:57, 22.47s/epoch, loss=1.2, accuracy=0.734, val_loss=1.93, val_accuracy=0.487, lr=0.1]  13%|█▎        | 13/100 [05:26<32:26, 22.37s/epoch, loss=1.19, accuracy=0.737, val_loss=2.86, val_accuracy=0.346, lr=0.1] 14%|█▍        | 14/100 [05:48<32:01, 22.34s/epoch, loss=1.2, accuracy=0.734, val_loss=1.95, val_accuracy=0.479, lr=0.1]  15%|█▌        | 15/100 [06:11<31:35, 22.30s/epoch, loss=1.2, accuracy=0.737, val_loss=1.88, val_accuracy=0.469, lr=0.1] 16%|█▌        | 16/100 [06:33<31:13, 22.31s/epoch, loss=1.19, accuracy=0.738, val_loss=3.46, val_accuracy=0.307, lr=0.1] 17%|█▋        | 17/100 [06:55<30:48, 22.27s/epoch, loss=1.19, accuracy=0.741, val_loss=1.48, val_accuracy=0.638, lr=0.1] 18%|█▊        | 18/100 [07:17<30:25, 22.26s/epoch, loss=1.19, accuracy=0.741, val_loss=2.02, val_accuracy=0.524, lr=0.1] 19%|█▉        | 19/100 [07:40<30:08, 22.33s/epoch, loss=1.18, accuracy=0.743, val_loss=2.09, val_accuracy=0.474, lr=0.1] 20%|██        | 20/100 [08:02<29:49, 22.36s/epoch, loss=1.18, accuracy=0.744, val_loss=2.15, val_accuracy=0.398, lr=0.1] 21%|██        | 21/100 [08:25<29:24, 22.34s/epoch, loss=1.19, accuracy=0.744, val_loss=2.42, val_accuracy=0.453, lr=0.1] 22%|██▏       | 22/100 [08:47<29:01, 22.33s/epoch, loss=1.18, accuracy=0.745, val_loss=1.69, val_accuracy=0.597, lr=0.1] 23%|██▎       | 23/100 [09:09<28:37, 22.31s/epoch, loss=1.18, accuracy=0.746, val_loss=1.78, val_accuracy=0.561, lr=0.1] 24%|██▍       | 24/100 [09:32<28:18, 22.34s/epoch, loss=1.18, accuracy=0.746, val_loss=1.59, val_accuracy=0.6, lr=0.1]   25%|██▌       | 25/100 [09:54<27:53, 22.32s/epoch, loss=1.18, accuracy=0.744, val_loss=1.75, val_accuracy=0.538, lr=0.1] 26%|██▌       | 26/100 [10:16<27:31, 22.32s/epoch, loss=1.17, accuracy=0.746, val_loss=2.18, val_accuracy=0.418, lr=0.1] 27%|██▋       | 27/100 [10:38<27:07, 22.29s/epoch, loss=1.17, accuracy=0.743, val_loss=2.68, val_accuracy=0.368, lr=0.1] 28%|██▊       | 28/100 [11:01<26:44, 22.28s/epoch, loss=1.17, accuracy=0.747, val_loss=1.81, val_accuracy=0.554, lr=0.1] 29%|██▉       | 29/100 [11:23<26:22, 22.29s/epoch, loss=1.17, accuracy=0.747, val_loss=1.92, val_accuracy=0.513, lr=0.1] 30%|███       | 30/100 [11:45<25:58, 22.27s/epoch, loss=1.16, accuracy=0.75, val_loss=2.17, val_accuracy=0.462, lr=0.1]  31%|███       | 31/100 [12:07<25:35, 22.25s/epoch, loss=1.16, accuracy=0.748, val_loss=2.04, val_accuracy=0.532, lr=0.1] 32%|███▏      | 32/100 [12:30<25:14, 22.27s/epoch, loss=1.16, accuracy=0.751, val_loss=1.8, val_accuracy=0.544, lr=0.1]  33%|███▎      | 33/100 [12:52<24:49, 22.23s/epoch, loss=1.17, accuracy=0.748, val_loss=2.24, val_accuracy=0.437, lr=0.1] 34%|███▍      | 34/100 [13:14<24:26, 22.23s/epoch, loss=1.16, accuracy=0.747, val_loss=2.19, val_accuracy=0.4, lr=0.1]   35%|███▌      | 35/100 [13:36<24:06, 22.26s/epoch, loss=1.17, accuracy=0.75, val_loss=2.05, val_accuracy=0.438, lr=0.1] 36%|███▌      | 36/100 [13:59<23:42, 22.22s/epoch, loss=1.16, accuracy=0.749, val_loss=2.55, val_accuracy=0.441, lr=0.1] 37%|███▋      | 37/100 [14:21<23:18, 22.20s/epoch, loss=1.16, accuracy=0.752, val_loss=1.59, val_accuracy=0.614, lr=0.1] 38%|███▊      | 38/100 [14:43<22:53, 22.15s/epoch, loss=1.16, accuracy=0.751, val_loss=1.65, val_accuracy=0.577, lr=0.1] 39%|███▉      | 39/100 [15:05<22:30, 22.14s/epoch, loss=1.17, accuracy=0.747, val_loss=1.83, val_accuracy=0.539, lr=0.1] 40%|████      | 40/100 [15:27<22:06, 22.11s/epoch, loss=1.16, accuracy=0.752, val_loss=1.69, val_accuracy=0.575, lr=0.1] 41%|████      | 41/100 [15:49<21:43, 22.09s/epoch, loss=1.15, accuracy=0.752, val_loss=2.17, val_accuracy=0.494, lr=0.1] 42%|████▏     | 42/100 [16:11<21:19, 22.06s/epoch, loss=0.937, accuracy=0.814, val_loss=0.941, val_accuracy=0.791, lr=0.01] 43%|████▎     | 43/100 [16:33<20:59, 22.10s/epoch, loss=0.749, accuracy=0.846, val_loss=0.782, val_accuracy=0.827, lr=0.01] 44%|████▍     | 44/100 [16:55<20:38, 22.12s/epoch, loss=0.665, accuracy=0.854, val_loss=0.852, val_accuracy=0.781, lr=0.01] 45%|████▌     | 45/100 [17:17<20:17, 22.13s/epoch, loss=0.623, accuracy=0.858, val_loss=0.772, val_accuracy=0.8, lr=0.01]   46%|████▌     | 46/100 [17:40<19:55, 22.14s/epoch, loss=0.599, accuracy=0.859, val_loss=0.933, val_accuracy=0.75, lr=0.01] 47%|████▋     | 47/100 [18:02<19:34, 22.15s/epoch, loss=0.589, accuracy=0.859, val_loss=0.744, val_accuracy=0.81, lr=0.01] 48%|████▊     | 48/100 [18:24<19:10, 22.13s/epoch, loss=0.583, accuracy=0.861, val_loss=0.777, val_accuracy=0.8, lr=0.01]  49%|████▉     | 49/100 [18:46<18:47, 22.10s/epoch, loss=0.581, accuracy=0.863, val_loss=0.83, val_accuracy=0.784, lr=0.01] 50%|█████     | 50/100 [19:08<18:26, 22.13s/epoch, loss=0.577, accuracy=0.865, val_loss=0.795, val_accuracy=0.796, lr=0.01] 51%|█████     | 51/100 [19:30<18:03, 22.12s/epoch, loss=0.574, accuracy=0.868, val_loss=0.8, val_accuracy=0.804, lr=0.01]   52%|█████▏    | 52/100 [19:52<17:39, 22.08s/epoch, loss=0.573, accuracy=0.867, val_loss=0.688, val_accuracy=0.83, lr=0.01] 53%|█████▎    | 53/100 [20:14<17:20, 22.13s/epoch, loss=0.575, accuracy=0.868, val_loss=0.796, val_accuracy=0.803, lr=0.01] 54%|█████▍    | 54/100 [20:37<17:01, 22.20s/epoch, loss=0.572, accuracy=0.871, val_loss=0.771, val_accuracy=0.808, lr=0.01] 55%|█████▌    | 55/100 [20:59<16:39, 22.21s/epoch, loss=0.567, accuracy=0.874, val_loss=0.874, val_accuracy=0.794, lr=0.01] 56%|█████▌    | 56/100 [21:21<16:17, 22.21s/epoch, loss=0.575, accuracy=0.872, val_loss=0.9, val_accuracy=0.772, lr=0.01]   57%|█████▋    | 57/100 [21:43<15:54, 22.19s/epoch, loss=0.57, accuracy=0.872, val_loss=0.779, val_accuracy=0.803, lr=0.01] 58%|█████▊    | 58/100 [22:06<15:34, 22.24s/epoch, loss=0.569, accuracy=0.875, val_loss=0.856, val_accuracy=0.78, lr=0.01] 59%|█████▉    | 59/100 [22:28<15:10, 22.22s/epoch, loss=0.567, accuracy=0.875, val_loss=0.765, val_accuracy=0.811, lr=0.01] 60%|██████    | 60/100 [22:50<14:48, 22.22s/epoch, loss=0.57, accuracy=0.875, val_loss=0.771, val_accuracy=0.815, lr=0.01]  61%|██████    | 61/100 [23:12<14:24, 22.17s/epoch, loss=0.57, accuracy=0.877, val_loss=1.2, val_accuracy=0.72, lr=0.01]    62%|██████▏   | 62/100 [23:34<14:02, 22.16s/epoch, loss=0.493, accuracy=0.904, val_loss=0.542, val_accuracy=0.887, lr=0.001] 63%|██████▎   | 63/100 [23:56<13:38, 22.12s/epoch, loss=0.437, accuracy=0.922, val_loss=0.525, val_accuracy=0.891, lr=0.001] 64%|██████▍   | 64/100 [24:18<13:16, 22.12s/epoch, loss=0.416, accuracy=0.927, val_loss=0.516, val_accuracy=0.893, lr=0.001] 65%|██████▌   | 65/100 [24:41<12:54, 22.12s/epoch, loss=0.4, accuracy=0.93, val_loss=0.505, val_accuracy=0.895, lr=0.001]    66%|██████▌   | 66/100 [25:03<12:33, 22.15s/epoch, loss=0.383, accuracy=0.934, val_loss=0.503, val_accuracy=0.896, lr=0.001] 67%|██████▋   | 67/100 [25:25<12:10, 22.13s/epoch, loss=0.372, accuracy=0.936, val_loss=0.497, val_accuracy=0.895, lr=0.001] 68%|██████▊   | 68/100 [25:47<11:46, 22.09s/epoch, loss=0.363, accuracy=0.937, val_loss=0.485, val_accuracy=0.898, lr=0.001] 69%|██████▉   | 69/100 [26:09<11:23, 22.06s/epoch, loss=0.349, accuracy=0.942, val_loss=0.497, val_accuracy=0.893, lr=0.001] 70%|███████   | 70/100 [26:31<11:02, 22.07s/epoch, loss=0.339, accuracy=0.943, val_loss=0.48, val_accuracy=0.9, lr=0.001]    71%|███████   | 71/100 [26:53<10:39, 22.06s/epoch, loss=0.331, accuracy=0.944, val_loss=0.476, val_accuracy=0.897, lr=0.001] 72%|███████▏  | 72/100 [27:15<10:17, 22.07s/epoch, loss=0.324, accuracy=0.945, val_loss=0.474, val_accuracy=0.898, lr=0.001] 73%|███████▎  | 73/100 [27:37<09:55, 22.06s/epoch, loss=0.315, accuracy=0.947, val_loss=0.496, val_accuracy=0.893, lr=0.001] 74%|███████▍  | 74/100 [27:59<09:35, 22.13s/epoch, loss=0.308, accuracy=0.948, val_loss=0.477, val_accuracy=0.894, lr=0.001] 75%|███████▌  | 75/100 [28:22<09:13, 22.13s/epoch, loss=0.302, accuracy=0.949, val_loss=0.468, val_accuracy=0.898, lr=0.001] 76%|███████▌  | 76/100 [28:44<08:51, 22.16s/epoch, loss=0.294, accuracy=0.951, val_loss=0.49, val_accuracy=0.892, lr=0.001]  77%|███████▋  | 77/100 [29:06<08:29, 22.13s/epoch, loss=0.288, accuracy=0.951, val_loss=0.466, val_accuracy=0.895, lr=0.001] 78%|███████▊  | 78/100 [29:28<08:07, 22.17s/epoch, loss=0.282, accuracy=0.953, val_loss=0.467, val_accuracy=0.894, lr=0.001] 79%|███████▉  | 79/100 [29:50<07:44, 22.13s/epoch, loss=0.278, accuracy=0.952, val_loss=0.469, val_accuracy=0.895, lr=0.001] 80%|████████  | 80/100 [30:12<07:23, 22.15s/epoch, loss=0.275, accuracy=0.953, val_loss=0.47, val_accuracy=0.894, lr=0.001]  81%|████████  | 81/100 [30:34<06:59, 22.08s/epoch, loss=0.271, accuracy=0.952, val_loss=0.477, val_accuracy=0.892, lr=0.001] 82%|████████▏ | 82/100 [30:56<06:37, 22.08s/epoch, loss=0.253, accuracy=0.96, val_loss=0.441, val_accuracy=0.905, lr=1e-04]  83%|████████▎ | 83/100 [31:18<06:15, 22.06s/epoch, loss=0.241, accuracy=0.964, val_loss=0.437, val_accuracy=0.905, lr=1e-04] 84%|████████▍ | 84/100 [31:40<05:52, 22.06s/epoch, loss=0.24, accuracy=0.965, val_loss=0.437, val_accuracy=0.905, lr=1e-04]  85%|████████▌ | 85/100 [32:02<05:30, 22.02s/epoch, loss=0.237, accuracy=0.965, val_loss=0.436, val_accuracy=0.905, lr=1e-04] 86%|████████▌ | 86/100 [32:24<05:07, 21.99s/epoch, loss=0.236, accuracy=0.966, val_loss=0.435, val_accuracy=0.905, lr=1e-04] 87%|████████▋ | 87/100 [32:46<04:45, 21.96s/epoch, loss=0.231, accuracy=0.967, val_loss=0.434, val_accuracy=0.905, lr=1e-04] 88%|████████▊ | 88/100 [33:08<04:23, 21.95s/epoch, loss=0.232, accuracy=0.968, val_loss=0.437, val_accuracy=0.904, lr=1e-04] 89%|████████▉ | 89/100 [33:30<04:01, 21.93s/epoch, loss=0.229, accuracy=0.967, val_loss=0.439, val_accuracy=0.905, lr=1e-04] 90%|█████████ | 90/100 [33:52<03:39, 21.95s/epoch, loss=0.229, accuracy=0.968, val_loss=0.435, val_accuracy=0.904, lr=1e-04] 91%|█████████ | 91/100 [34:14<03:17, 21.95s/epoch, loss=0.226, accuracy=0.97, val_loss=0.436, val_accuracy=0.905, lr=1e-04]  92%|█████████▏| 92/100 [34:36<02:55, 21.98s/epoch, loss=0.227, accuracy=0.969, val_loss=0.436, val_accuracy=0.905, lr=5e-5] 93%|█████████▎| 93/100 [34:58<02:33, 21.98s/epoch, loss=0.226, accuracy=0.969, val_loss=0.435, val_accuracy=0.906, lr=5e-5] 94%|█████████▍| 94/100 [35:20<02:11, 21.97s/epoch, loss=0.223, accuracy=0.97, val_loss=0.436, val_accuracy=0.905, lr=5e-5]  95%|█████████▌| 95/100 [35:42<01:49, 21.96s/epoch, loss=0.223, accuracy=0.971, val_loss=0.435, val_accuracy=0.905, lr=5e-5] 96%|█████████▌| 96/100 [36:04<01:27, 21.97s/epoch, loss=0.222, accuracy=0.97, val_loss=0.436, val_accuracy=0.906, lr=5e-5]  97%|█████████▋| 97/100 [36:26<01:06, 22.01s/epoch, loss=0.221, accuracy=0.97, val_loss=0.436, val_accuracy=0.906, lr=5e-5] 98%|█████████▊| 98/100 [36:48<00:44, 22.04s/epoch, loss=0.22, accuracy=0.972, val_loss=0.437, val_accuracy=0.906, lr=5e-5] 99%|█████████▉| 99/100 [37:10<00:22, 22.04s/epoch, loss=0.22, accuracy=0.971, val_loss=0.435, val_accuracy=0.907, lr=5e-5]100%|██████████| 100/100 [37:32<00:00, 22.05s/epoch, loss=0.22, accuracy=0.971, val_loss=0.436, val_accuracy=0.907, lr=5e-5]100%|██████████| 100/100 [37:32<00:00, 22.53s/epoch, loss=0.22, accuracy=0.971, val_loss=0.436, val_accuracy=0.907, lr=5e-5]
Using real-time data augmentation.
Only one model saved

Loading model: 15_04_cifar10_ResNet20v1.h5
Test score: 0.4362514615058899
Test accuracy: 0.9067000150680542


* * * Run SGD for ID = 15_5. * * *


2024-03-13 05:08:07.510191: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 05:08:10.110959: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 05:08:10.112130: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-13 05:08:10.154442: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-13 05:08:10.154475: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 05:08:10.157379: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 05:08:10.157422: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 05:08:10.159794: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 05:08:10.160946: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 05:08:10.163441: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 05:08:10.164947: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 05:08:10.169879: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 05:08:10.170439: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 05:08:10.170520: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 05:08:11.515867: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-13 05:08:11.516913: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 05:08:11.517585: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-13 05:08:11.517618: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 05:08:11.517657: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 05:08:11.517674: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 05:08:11.517690: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 05:08:11.517706: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 05:08:11.517723: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 05:08:11.517739: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 05:08:11.517756: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 05:08:11.518237: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 05:08:11.518273: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 05:08:12.191517: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-13 05:08:12.191573: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-13 05:08:12.191583: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-13 05:08:12.192537: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:02:00.0, compute capability: 6.1)
{'id': '15_05', 'seed': 5, 'out_folder': 'results/epoch_budget_2', 'batch_size': 128, 'epochs': 100, 'validation_split': 0.0, 'checkpointing': False, 'checkpoint_every': -1, 'hold_out_validation_split': 0.0, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'num_classes': 10, 'SSE_lr': False, 'test_time_augmentation': False, 'debug': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
y_train shape: (50000, 10)
x_val shape: (10000, 32, 32, 3)
y_val shape: (10000, 10)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/100 [00:00<?, ?epoch/s]2024-03-13 05:08:12.883607: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-13 05:08:12.896192: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199825000 Hz
2024-03-13 05:08:15.087447: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 05:08:15.362434: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 05:08:16.240292: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-13 05:08:16.293297: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/100 [00:59<1:38:26, 59.67s/epoch, loss=3.01, accuracy=0.312, val_loss=2.42, val_accuracy=0.277, lr=0.1]  2%|▏         | 2/100 [01:21<1:01:34, 37.70s/epoch, loss=1.53, accuracy=0.548, val_loss=2.35, val_accuracy=0.382, lr=0.1]  3%|▎         | 3/100 [01:44<49:30, 30.62s/epoch, loss=1.32, accuracy=0.644, val_loss=2.59, val_accuracy=0.343, lr=0.1]    4%|▍         | 4/100 [02:06<43:39, 27.29s/epoch, loss=1.26, accuracy=0.686, val_loss=4.02, val_accuracy=0.259, lr=0.1]  5%|▌         | 5/100 [02:28<40:15, 25.43s/epoch, loss=1.23, accuracy=0.704, val_loss=3.15, val_accuracy=0.386, lr=0.1]  6%|▌         | 6/100 [02:50<38:03, 24.30s/epoch, loss=1.21, accuracy=0.713, val_loss=1.61, val_accuracy=0.569, lr=0.1]  7%|▋         | 7/100 [03:12<36:37, 23.63s/epoch, loss=1.2, accuracy=0.721, val_loss=2.82, val_accuracy=0.379, lr=0.1]   8%|▊         | 8/100 [03:35<35:33, 23.19s/epoch, loss=1.19, accuracy=0.726, val_loss=1.79, val_accuracy=0.533, lr=0.1]  9%|▉         | 9/100 [03:57<34:41, 22.87s/epoch, loss=1.18, accuracy=0.728, val_loss=1.62, val_accuracy=0.584, lr=0.1] 10%|█         | 10/100 [04:19<34:02, 22.69s/epoch, loss=1.18, accuracy=0.732, val_loss=1.46, val_accuracy=0.628, lr=0.1] 11%|█         | 11/100 [04:41<33:26, 22.54s/epoch, loss=1.16, accuracy=0.735, val_loss=1.88, val_accuracy=0.474, lr=0.1] 12%|█▏        | 12/100 [05:03<32:51, 22.40s/epoch, loss=1.17, accuracy=0.737, val_loss=2.39, val_accuracy=0.391, lr=0.1] 13%|█▎        | 13/100 [05:25<32:18, 22.28s/epoch, loss=1.17, accuracy=0.738, val_loss=1.33, val_accuracy=0.675, lr=0.1] 14%|█▍        | 14/100 [05:47<31:51, 22.23s/epoch, loss=1.16, accuracy=0.742, val_loss=3.16, val_accuracy=0.351, lr=0.1] 15%|█▌        | 15/100 [06:10<31:25, 22.18s/epoch, loss=1.16, accuracy=0.741, val_loss=1.82, val_accuracy=0.527, lr=0.1] 16%|█▌        | 16/100 [06:32<31:00, 22.15s/epoch, loss=1.15, accuracy=0.742, val_loss=1.85, val_accuracy=0.519, lr=0.1] 17%|█▋        | 17/100 [06:54<30:36, 22.13s/epoch, loss=1.15, accuracy=0.744, val_loss=1.99, val_accuracy=0.504, lr=0.1] 18%|█▊        | 18/100 [07:16<30:14, 22.12s/epoch, loss=1.14, accuracy=0.747, val_loss=1.91, val_accuracy=0.469, lr=0.1] 19%|█▉        | 19/100 [07:38<29:49, 22.09s/epoch, loss=1.15, accuracy=0.745, val_loss=1.76, val_accuracy=0.547, lr=0.1] 20%|██        | 20/100 [08:00<29:24, 22.05s/epoch, loss=1.14, accuracy=0.746, val_loss=3.71, val_accuracy=0.296, lr=0.1] 21%|██        | 21/100 [08:22<29:06, 22.11s/epoch, loss=1.14, accuracy=0.747, val_loss=5.09, val_accuracy=0.287, lr=0.1] 22%|██▏       | 22/100 [08:44<28:42, 22.09s/epoch, loss=1.14, accuracy=0.751, val_loss=1.69, val_accuracy=0.619, lr=0.1] 23%|██▎       | 23/100 [09:06<28:23, 22.13s/epoch, loss=1.13, accuracy=0.749, val_loss=2.28, val_accuracy=0.493, lr=0.1] 24%|██▍       | 24/100 [09:28<28:00, 22.11s/epoch, loss=1.14, accuracy=0.75, val_loss=2.36, val_accuracy=0.352, lr=0.1]  25%|██▌       | 25/100 [09:50<27:35, 22.08s/epoch, loss=1.13, accuracy=0.752, val_loss=1.92, val_accuracy=0.534, lr=0.1] 26%|██▌       | 26/100 [10:12<27:12, 22.06s/epoch, loss=1.13, accuracy=0.751, val_loss=1.64, val_accuracy=0.605, lr=0.1] 27%|██▋       | 27/100 [10:34<26:51, 22.07s/epoch, loss=1.13, accuracy=0.749, val_loss=2.79, val_accuracy=0.35, lr=0.1]  28%|██▊       | 28/100 [10:56<26:25, 22.02s/epoch, loss=1.12, accuracy=0.754, val_loss=1.69, val_accuracy=0.599, lr=0.1] 29%|██▉       | 29/100 [11:18<26:02, 22.01s/epoch, loss=1.12, accuracy=0.754, val_loss=1.51, val_accuracy=0.619, lr=0.1] 30%|███       | 30/100 [11:40<25:41, 22.02s/epoch, loss=1.13, accuracy=0.752, val_loss=1.6, val_accuracy=0.593, lr=0.1]  31%|███       | 31/100 [12:03<25:21, 22.06s/epoch, loss=1.12, accuracy=0.753, val_loss=1.38, val_accuracy=0.665, lr=0.1] 32%|███▏      | 32/100 [12:24<24:57, 22.02s/epoch, loss=1.11, accuracy=0.756, val_loss=2.03, val_accuracy=0.549, lr=0.1] 33%|███▎      | 33/100 [12:46<24:34, 22.01s/epoch, loss=1.11, accuracy=0.757, val_loss=1.37, val_accuracy=0.663, lr=0.1] 34%|███▍      | 34/100 [13:09<24:17, 22.09s/epoch, loss=1.12, accuracy=0.756, val_loss=1.9, val_accuracy=0.545, lr=0.1]  35%|███▌      | 35/100 [13:31<23:52, 22.04s/epoch, loss=1.12, accuracy=0.755, val_loss=2.11, val_accuracy=0.465, lr=0.1] 36%|███▌      | 36/100 [13:53<23:33, 22.08s/epoch, loss=1.12, accuracy=0.754, val_loss=1.56, val_accuracy=0.63, lr=0.1]  37%|███▋      | 37/100 [14:15<23:09, 22.05s/epoch, loss=1.12, accuracy=0.755, val_loss=4.22, val_accuracy=0.342, lr=0.1] 38%|███▊      | 38/100 [14:37<22:46, 22.05s/epoch, loss=1.12, accuracy=0.755, val_loss=1.39, val_accuracy=0.659, lr=0.1] 39%|███▉      | 39/100 [14:59<22:22, 22.01s/epoch, loss=1.11, accuracy=0.757, val_loss=1.79, val_accuracy=0.55, lr=0.1]  40%|████      | 40/100 [15:21<22:00, 22.01s/epoch, loss=1.12, accuracy=0.756, val_loss=1.49, val_accuracy=0.629, lr=0.1] 41%|████      | 41/100 [15:43<21:39, 22.02s/epoch, loss=1.12, accuracy=0.755, val_loss=1.43, val_accuracy=0.653, lr=0.1] 42%|████▏     | 42/100 [16:05<21:20, 22.08s/epoch, loss=0.895, accuracy=0.817, val_loss=0.888, val_accuracy=0.807, lr=0.01] 43%|████▎     | 43/100 [16:27<21:01, 22.13s/epoch, loss=0.723, accuracy=0.848, val_loss=0.752, val_accuracy=0.829, lr=0.01] 44%|████▍     | 44/100 [16:49<20:36, 22.08s/epoch, loss=0.646, accuracy=0.857, val_loss=0.783, val_accuracy=0.802, lr=0.01] 45%|████▌     | 45/100 [17:11<20:16, 22.12s/epoch, loss=0.609, accuracy=0.859, val_loss=0.811, val_accuracy=0.781, lr=0.01] 46%|████▌     | 46/100 [17:34<19:54, 22.12s/epoch, loss=0.585, accuracy=0.861, val_loss=0.703, val_accuracy=0.819, lr=0.01] 47%|████▋     | 47/100 [17:56<19:35, 22.17s/epoch, loss=0.575, accuracy=0.862, val_loss=0.9, val_accuracy=0.761, lr=0.01]   48%|████▊     | 48/100 [18:18<19:11, 22.14s/epoch, loss=0.571, accuracy=0.862, val_loss=0.829, val_accuracy=0.78, lr=0.01] 49%|████▉     | 49/100 [18:40<18:48, 22.13s/epoch, loss=0.567, accuracy=0.863, val_loss=0.668, val_accuracy=0.829, lr=0.01] 50%|█████     | 50/100 [19:02<18:24, 22.10s/epoch, loss=0.561, accuracy=0.867, val_loss=0.758, val_accuracy=0.807, lr=0.01] 51%|█████     | 51/100 [19:24<18:00, 22.06s/epoch, loss=0.562, accuracy=0.866, val_loss=1.09, val_accuracy=0.718, lr=0.01]  52%|█████▏    | 52/100 [19:46<17:36, 22.01s/epoch, loss=0.556, accuracy=0.868, val_loss=0.77, val_accuracy=0.799, lr=0.01] 53%|█████▎    | 53/100 [20:08<17:17, 22.07s/epoch, loss=0.556, accuracy=0.872, val_loss=0.923, val_accuracy=0.756, lr=0.01] 54%|█████▍    | 54/100 [20:30<16:56, 22.11s/epoch, loss=0.56, accuracy=0.87, val_loss=0.82, val_accuracy=0.79, lr=0.01]     55%|█████▌    | 55/100 [20:53<16:35, 22.13s/epoch, loss=0.558, accuracy=0.872, val_loss=1.14, val_accuracy=0.732, lr=0.01] 56%|█████▌    | 56/100 [21:15<16:12, 22.11s/epoch, loss=0.554, accuracy=0.872, val_loss=0.86, val_accuracy=0.769, lr=0.01] 57%|█████▋    | 57/100 [21:37<15:49, 22.08s/epoch, loss=0.555, accuracy=0.875, val_loss=0.89, val_accuracy=0.76, lr=0.01]  58%|█████▊    | 58/100 [21:59<15:26, 22.07s/epoch, loss=0.559, accuracy=0.873, val_loss=0.876, val_accuracy=0.764, lr=0.01] 59%|█████▉    | 59/100 [22:21<15:06, 22.11s/epoch, loss=0.555, accuracy=0.876, val_loss=1.13, val_accuracy=0.717, lr=0.01]  60%|██████    | 60/100 [22:43<14:43, 22.10s/epoch, loss=0.553, accuracy=0.877, val_loss=0.976, val_accuracy=0.758, lr=0.01] 61%|██████    | 61/100 [23:05<14:20, 22.06s/epoch, loss=0.55, accuracy=0.879, val_loss=0.891, val_accuracy=0.766, lr=0.01]  62%|██████▏   | 62/100 [23:27<13:57, 22.05s/epoch, loss=0.479, accuracy=0.905, val_loss=0.537, val_accuracy=0.884, lr=0.001] 63%|██████▎   | 63/100 [23:49<13:35, 22.03s/epoch, loss=0.424, accuracy=0.922, val_loss=0.519, val_accuracy=0.889, lr=0.001] 64%|██████▍   | 64/100 [24:11<13:12, 22.01s/epoch, loss=0.406, accuracy=0.925, val_loss=0.518, val_accuracy=0.889, lr=0.001] 65%|██████▌   | 65/100 [24:33<12:50, 22.00s/epoch, loss=0.388, accuracy=0.93, val_loss=0.507, val_accuracy=0.89, lr=0.001]   66%|██████▌   | 66/100 [24:55<12:27, 21.99s/epoch, loss=0.374, accuracy=0.932, val_loss=0.496, val_accuracy=0.894, lr=0.001] 67%|██████▋   | 67/100 [25:17<12:03, 21.94s/epoch, loss=0.362, accuracy=0.937, val_loss=0.497, val_accuracy=0.893, lr=0.001] 68%|██████▊   | 68/100 [25:38<11:40, 21.90s/epoch, loss=0.354, accuracy=0.936, val_loss=0.486, val_accuracy=0.894, lr=0.001] 69%|██████▉   | 69/100 [26:00<11:18, 21.88s/epoch, loss=0.342, accuracy=0.941, val_loss=0.472, val_accuracy=0.898, lr=0.001] 70%|███████   | 70/100 [26:22<10:55, 21.85s/epoch, loss=0.332, accuracy=0.941, val_loss=0.469, val_accuracy=0.899, lr=0.001] 71%|███████   | 71/100 [26:44<10:33, 21.84s/epoch, loss=0.327, accuracy=0.942, val_loss=0.485, val_accuracy=0.892, lr=0.001] 72%|███████▏  | 72/100 [27:06<10:11, 21.83s/epoch, loss=0.317, accuracy=0.944, val_loss=0.48, val_accuracy=0.892, lr=0.001]  73%|███████▎  | 73/100 [27:27<09:48, 21.80s/epoch, loss=0.311, accuracy=0.946, val_loss=0.476, val_accuracy=0.893, lr=0.001] 74%|███████▍  | 74/100 [27:49<09:28, 21.86s/epoch, loss=0.3, accuracy=0.946, val_loss=0.492, val_accuracy=0.888, lr=0.001]   75%|███████▌  | 75/100 [28:11<09:06, 21.87s/epoch, loss=0.298, accuracy=0.947, val_loss=0.466, val_accuracy=0.895, lr=0.001] 76%|███████▌  | 76/100 [28:33<08:45, 21.90s/epoch, loss=0.29, accuracy=0.947, val_loss=0.47, val_accuracy=0.894, lr=0.001]   77%|███████▋  | 77/100 [28:55<08:24, 21.93s/epoch, loss=0.283, accuracy=0.95, val_loss=0.459, val_accuracy=0.897, lr=0.001] 78%|███████▊  | 78/100 [29:17<08:01, 21.89s/epoch, loss=0.278, accuracy=0.951, val_loss=0.494, val_accuracy=0.886, lr=0.001] 79%|███████▉  | 79/100 [29:39<07:40, 21.95s/epoch, loss=0.273, accuracy=0.953, val_loss=0.481, val_accuracy=0.892, lr=0.001] 80%|████████  | 80/100 [30:01<07:18, 21.94s/epoch, loss=0.266, accuracy=0.952, val_loss=0.483, val_accuracy=0.886, lr=0.001] 81%|████████  | 81/100 [30:23<06:56, 21.92s/epoch, loss=0.267, accuracy=0.952, val_loss=0.514, val_accuracy=0.882, lr=0.001] 82%|████████▏ | 82/100 [30:45<06:34, 21.91s/epoch, loss=0.246, accuracy=0.96, val_loss=0.44, val_accuracy=0.902, lr=1e-04]   83%|████████▎ | 83/100 [31:07<06:12, 21.89s/epoch, loss=0.235, accuracy=0.964, val_loss=0.436, val_accuracy=0.903, lr=1e-04] 84%|████████▍ | 84/100 [31:29<05:49, 21.87s/epoch, loss=0.232, accuracy=0.966, val_loss=0.437, val_accuracy=0.903, lr=1e-04] 85%|████████▌ | 85/100 [31:50<05:27, 21.83s/epoch, loss=0.231, accuracy=0.965, val_loss=0.435, val_accuracy=0.903, lr=1e-04] 86%|████████▌ | 86/100 [32:12<05:05, 21.80s/epoch, loss=0.229, accuracy=0.965, val_loss=0.436, val_accuracy=0.902, lr=1e-04] 87%|████████▋ | 87/100 [32:34<04:43, 21.79s/epoch, loss=0.226, accuracy=0.967, val_loss=0.437, val_accuracy=0.902, lr=1e-04] 88%|████████▊ | 88/100 [32:56<04:21, 21.81s/epoch, loss=0.225, accuracy=0.966, val_loss=0.434, val_accuracy=0.903, lr=1e-04] 89%|████████▉ | 89/100 [33:17<03:59, 21.80s/epoch, loss=0.223, accuracy=0.968, val_loss=0.434, val_accuracy=0.903, lr=1e-04] 90%|█████████ | 90/100 [33:39<03:37, 21.80s/epoch, loss=0.222, accuracy=0.967, val_loss=0.437, val_accuracy=0.903, lr=1e-04] 91%|█████████ | 91/100 [34:01<03:16, 21.79s/epoch, loss=0.221, accuracy=0.968, val_loss=0.435, val_accuracy=0.903, lr=1e-04] 92%|█████████▏| 92/100 [34:23<02:54, 21.81s/epoch, loss=0.22, accuracy=0.968, val_loss=0.434, val_accuracy=0.903, lr=5e-5]   93%|█████████▎| 93/100 [34:44<02:32, 21.78s/epoch, loss=0.218, accuracy=0.969, val_loss=0.434, val_accuracy=0.903, lr=5e-5] 94%|█████████▍| 94/100 [35:06<02:10, 21.77s/epoch, loss=0.219, accuracy=0.969, val_loss=0.434, val_accuracy=0.902, lr=5e-5] 95%|█████████▌| 95/100 [35:28<01:48, 21.74s/epoch, loss=0.216, accuracy=0.97, val_loss=0.435, val_accuracy=0.901, lr=5e-5]  96%|█████████▌| 96/100 [35:50<01:26, 21.73s/epoch, loss=0.216, accuracy=0.97, val_loss=0.435, val_accuracy=0.903, lr=5e-5] 97%|█████████▋| 97/100 [36:11<01:05, 21.68s/epoch, loss=0.216, accuracy=0.969, val_loss=0.435, val_accuracy=0.901, lr=5e-5] 98%|█████████▊| 98/100 [36:33<00:43, 21.69s/epoch, loss=0.215, accuracy=0.97, val_loss=0.435, val_accuracy=0.901, lr=5e-5]  99%|█████████▉| 99/100 [36:55<00:21, 21.71s/epoch, loss=0.213, accuracy=0.971, val_loss=0.434, val_accuracy=0.902, lr=5e-5]100%|██████████| 100/100 [37:16<00:00, 21.73s/epoch, loss=0.216, accuracy=0.97, val_loss=0.434, val_accuracy=0.903, lr=5e-5]100%|██████████| 100/100 [37:16<00:00, 22.37s/epoch, loss=0.216, accuracy=0.97, val_loss=0.434, val_accuracy=0.903, lr=5e-5]
Using real-time data augmentation.
Only one model saved

Loading model: 15_05_cifar10_ResNet20v1.h5
Test score: 0.4339509904384613
Test accuracy: 0.902999997138977


* * * Run SGD for ID = 15_6. * * *


2024-03-13 05:45:33.595221: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 05:45:36.108653: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 05:45:36.109607: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-13 05:45:36.150641: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-13 05:45:36.150672: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 05:45:36.153391: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 05:45:36.153434: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 05:45:36.155754: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 05:45:36.156362: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 05:45:36.158634: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 05:45:36.160032: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 05:45:36.164808: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 05:45:36.165340: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 05:45:36.165419: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 05:45:37.462982: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-13 05:45:37.463570: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 05:45:37.464374: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-13 05:45:37.464407: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 05:45:37.464445: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 05:45:37.464463: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 05:45:37.464480: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 05:45:37.464497: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 05:45:37.464516: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 05:45:37.464535: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 05:45:37.464554: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 05:45:37.465025: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 05:45:37.465074: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 05:45:38.145732: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-13 05:45:38.145786: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-13 05:45:38.145796: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-13 05:45:38.146764: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:02:00.0, compute capability: 6.1)
{'id': '15_06', 'seed': 6, 'out_folder': 'results/epoch_budget_2', 'batch_size': 128, 'epochs': 100, 'validation_split': 0.0, 'checkpointing': False, 'checkpoint_every': -1, 'hold_out_validation_split': 0.0, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'num_classes': 10, 'SSE_lr': False, 'test_time_augmentation': False, 'debug': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
y_train shape: (50000, 10)
x_val shape: (10000, 32, 32, 3)
y_val shape: (10000, 10)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/100 [00:00<?, ?epoch/s]2024-03-13 05:45:38.819715: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-13 05:45:38.832195: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199825000 Hz
2024-03-13 05:45:41.014268: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 05:45:41.251819: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 05:45:41.995524: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-13 05:45:42.047512: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/100 [00:55<1:32:11, 55.87s/epoch, loss=3.05, accuracy=0.344, val_loss=2.91, val_accuracy=0.235, lr=0.1]  2%|▏         | 2/100 [01:19<59:56, 36.70s/epoch, loss=1.56, accuracy=0.528, val_loss=2.04, val_accuracy=0.386, lr=0.1]    3%|▎         | 3/100 [01:41<48:50, 30.21s/epoch, loss=1.36, accuracy=0.622, val_loss=1.83, val_accuracy=0.478, lr=0.1]  4%|▍         | 4/100 [02:04<43:26, 27.15s/epoch, loss=1.28, accuracy=0.675, val_loss=1.58, val_accuracy=0.576, lr=0.1]  5%|▌         | 5/100 [02:26<40:22, 25.50s/epoch, loss=1.23, accuracy=0.701, val_loss=2.25, val_accuracy=0.384, lr=0.1]  6%|▌         | 6/100 [02:49<38:16, 24.43s/epoch, loss=1.22, accuracy=0.716, val_loss=2.3, val_accuracy=0.402, lr=0.1]   7%|▋         | 7/100 [03:11<36:52, 23.79s/epoch, loss=1.21, accuracy=0.722, val_loss=2.32, val_accuracy=0.451, lr=0.1]  8%|▊         | 8/100 [03:34<35:51, 23.39s/epoch, loss=1.2, accuracy=0.728, val_loss=1.79, val_accuracy=0.572, lr=0.1]   9%|▉         | 9/100 [03:56<35:08, 23.17s/epoch, loss=1.19, accuracy=0.731, val_loss=1.83, val_accuracy=0.519, lr=0.1] 10%|█         | 10/100 [04:19<34:28, 22.98s/epoch, loss=1.2, accuracy=0.732, val_loss=1.63, val_accuracy=0.599, lr=0.1] 11%|█         | 11/100 [04:41<33:49, 22.80s/epoch, loss=1.18, accuracy=0.74, val_loss=3.01, val_accuracy=0.281, lr=0.1] 12%|█▏        | 12/100 [05:04<33:20, 22.73s/epoch, loss=1.18, accuracy=0.739, val_loss=4.3, val_accuracy=0.27, lr=0.1]  13%|█▎        | 13/100 [05:26<32:51, 22.66s/epoch, loss=1.17, accuracy=0.741, val_loss=1.54, val_accuracy=0.595, lr=0.1] 14%|█▍        | 14/100 [05:49<32:23, 22.60s/epoch, loss=1.17, accuracy=0.743, val_loss=1.98, val_accuracy=0.488, lr=0.1] 15%|█▌        | 15/100 [06:11<31:59, 22.58s/epoch, loss=1.17, accuracy=0.747, val_loss=1.62, val_accuracy=0.588, lr=0.1] 16%|█▌        | 16/100 [06:34<31:33, 22.54s/epoch, loss=1.17, accuracy=0.744, val_loss=2.7, val_accuracy=0.438, lr=0.1]  17%|█▋        | 17/100 [06:56<31:07, 22.50s/epoch, loss=1.16, accuracy=0.745, val_loss=2.1, val_accuracy=0.496, lr=0.1] 18%|█▊        | 18/100 [07:19<30:50, 22.57s/epoch, loss=1.15, accuracy=0.75, val_loss=2.26, val_accuracy=0.455, lr=0.1] 19%|█▉        | 19/100 [07:41<30:26, 22.54s/epoch, loss=1.16, accuracy=0.748, val_loss=1.78, val_accuracy=0.579, lr=0.1] 20%|██        | 20/100 [08:04<30:05, 22.57s/epoch, loss=1.15, accuracy=0.75, val_loss=2.32, val_accuracy=0.506, lr=0.1]  21%|██        | 21/100 [08:26<29:38, 22.51s/epoch, loss=1.15, accuracy=0.749, val_loss=3.65, val_accuracy=0.304, lr=0.1] 22%|██▏       | 22/100 [08:49<29:13, 22.48s/epoch, loss=1.15, accuracy=0.752, val_loss=2.96, val_accuracy=0.414, lr=0.1] 23%|██▎       | 23/100 [09:11<28:51, 22.49s/epoch, loss=1.15, accuracy=0.749, val_loss=1.64, val_accuracy=0.544, lr=0.1] 24%|██▍       | 24/100 [09:34<28:27, 22.47s/epoch, loss=1.15, accuracy=0.751, val_loss=2.61, val_accuracy=0.398, lr=0.1] 25%|██▌       | 25/100 [09:56<28:03, 22.45s/epoch, loss=1.15, accuracy=0.751, val_loss=1.71, val_accuracy=0.543, lr=0.1] 26%|██▌       | 26/100 [10:18<27:39, 22.43s/epoch, loss=1.14, accuracy=0.752, val_loss=3, val_accuracy=0.374, lr=0.1]    27%|██▋       | 27/100 [10:41<27:12, 22.36s/epoch, loss=1.14, accuracy=0.751, val_loss=1.91, val_accuracy=0.465, lr=0.1] 28%|██▊       | 28/100 [11:03<26:46, 22.32s/epoch, loss=1.14, accuracy=0.749, val_loss=2.19, val_accuracy=0.483, lr=0.1] 29%|██▉       | 29/100 [11:25<26:23, 22.31s/epoch, loss=1.14, accuracy=0.751, val_loss=2.27, val_accuracy=0.475, lr=0.1] 30%|███       | 30/100 [11:47<26:01, 22.31s/epoch, loss=1.13, accuracy=0.753, val_loss=2.85, val_accuracy=0.315, lr=0.1] 31%|███       | 31/100 [12:10<25:36, 22.26s/epoch, loss=1.13, accuracy=0.753, val_loss=2.8, val_accuracy=0.392, lr=0.1]  32%|███▏      | 32/100 [12:32<25:13, 22.26s/epoch, loss=1.13, accuracy=0.755, val_loss=3.03, val_accuracy=0.363, lr=0.1] 33%|███▎      | 33/100 [12:54<24:54, 22.30s/epoch, loss=1.13, accuracy=0.758, val_loss=1.98, val_accuracy=0.466, lr=0.1] 34%|███▍      | 34/100 [13:16<24:30, 22.29s/epoch, loss=1.13, accuracy=0.756, val_loss=1.54, val_accuracy=0.597, lr=0.1] 35%|███▌      | 35/100 [13:39<24:06, 22.26s/epoch, loss=1.14, accuracy=0.754, val_loss=2.06, val_accuracy=0.499, lr=0.1] 36%|███▌      | 36/100 [14:01<23:43, 22.24s/epoch, loss=1.12, accuracy=0.756, val_loss=1.86, val_accuracy=0.503, lr=0.1] 37%|███▋      | 37/100 [14:23<23:24, 22.29s/epoch, loss=1.12, accuracy=0.757, val_loss=2.27, val_accuracy=0.423, lr=0.1] 38%|███▊      | 38/100 [14:46<23:01, 22.29s/epoch, loss=1.12, accuracy=0.756, val_loss=1.46, val_accuracy=0.627, lr=0.1] 39%|███▉      | 39/100 [15:08<22:37, 22.26s/epoch, loss=1.12, accuracy=0.756, val_loss=3.45, val_accuracy=0.347, lr=0.1] 40%|████      | 40/100 [15:30<22:15, 22.25s/epoch, loss=1.12, accuracy=0.755, val_loss=1.99, val_accuracy=0.447, lr=0.1] 41%|████      | 41/100 [15:52<21:54, 22.28s/epoch, loss=1.13, accuracy=0.755, val_loss=1.78, val_accuracy=0.537, lr=0.1] 42%|████▏     | 42/100 [16:14<21:30, 22.24s/epoch, loss=0.89, accuracy=0.819, val_loss=0.93, val_accuracy=0.787, lr=0.01] 43%|████▎     | 43/100 [16:37<21:07, 22.24s/epoch, loss=0.724, accuracy=0.848, val_loss=0.857, val_accuracy=0.793, lr=0.01] 44%|████▍     | 44/100 [16:59<20:46, 22.25s/epoch, loss=0.65, accuracy=0.855, val_loss=0.795, val_accuracy=0.795, lr=0.01]  45%|████▌     | 45/100 [17:21<20:24, 22.26s/epoch, loss=0.609, accuracy=0.859, val_loss=0.693, val_accuracy=0.826, lr=0.01] 46%|████▌     | 46/100 [17:44<20:05, 22.33s/epoch, loss=0.584, accuracy=0.861, val_loss=0.755, val_accuracy=0.8, lr=0.01]   47%|████▋     | 47/100 [18:06<19:45, 22.37s/epoch, loss=0.58, accuracy=0.861, val_loss=0.815, val_accuracy=0.778, lr=0.01] 48%|████▊     | 48/100 [18:29<19:22, 22.36s/epoch, loss=0.57, accuracy=0.864, val_loss=0.777, val_accuracy=0.799, lr=0.01] 49%|████▉     | 49/100 [18:51<18:58, 22.33s/epoch, loss=0.575, accuracy=0.863, val_loss=0.738, val_accuracy=0.811, lr=0.01] 50%|█████     | 50/100 [19:13<18:35, 22.30s/epoch, loss=0.566, accuracy=0.866, val_loss=0.928, val_accuracy=0.76, lr=0.01]  51%|█████     | 51/100 [19:35<18:11, 22.27s/epoch, loss=0.563, accuracy=0.869, val_loss=0.901, val_accuracy=0.77, lr=0.01] 52%|█████▏    | 52/100 [19:58<17:49, 22.27s/epoch, loss=0.561, accuracy=0.87, val_loss=0.899, val_accuracy=0.782, lr=0.01] 53%|█████▎    | 53/100 [20:20<17:28, 22.30s/epoch, loss=0.56, accuracy=0.871, val_loss=0.95, val_accuracy=0.754, lr=0.01]  54%|█████▍    | 54/100 [20:42<17:06, 22.31s/epoch, loss=0.563, accuracy=0.872, val_loss=0.909, val_accuracy=0.775, lr=0.01] 55%|█████▌    | 55/100 [21:05<16:44, 22.32s/epoch, loss=0.56, accuracy=0.874, val_loss=0.821, val_accuracy=0.79, lr=0.01]   56%|█████▌    | 56/100 [21:27<16:21, 22.31s/epoch, loss=0.56, accuracy=0.874, val_loss=0.753, val_accuracy=0.811, lr=0.01] 57%|█████▋    | 57/100 [21:49<15:59, 22.31s/epoch, loss=0.561, accuracy=0.876, val_loss=1.54, val_accuracy=0.645, lr=0.01] 58%|█████▊    | 58/100 [22:12<15:37, 22.32s/epoch, loss=0.56, accuracy=0.877, val_loss=0.987, val_accuracy=0.743, lr=0.01] 59%|█████▉    | 59/100 [22:34<15:14, 22.30s/epoch, loss=0.558, accuracy=0.877, val_loss=0.947, val_accuracy=0.76, lr=0.01] 60%|██████    | 60/100 [22:56<14:52, 22.30s/epoch, loss=0.556, accuracy=0.878, val_loss=0.806, val_accuracy=0.803, lr=0.01] 61%|██████    | 61/100 [23:18<14:28, 22.26s/epoch, loss=0.555, accuracy=0.879, val_loss=0.805, val_accuracy=0.803, lr=0.01] 62%|██████▏   | 62/100 [23:41<14:05, 22.26s/epoch, loss=0.483, accuracy=0.906, val_loss=0.543, val_accuracy=0.886, lr=0.001] 63%|██████▎   | 63/100 [24:03<13:42, 22.22s/epoch, loss=0.431, accuracy=0.922, val_loss=0.527, val_accuracy=0.888, lr=0.001] 64%|██████▍   | 64/100 [24:25<13:21, 22.26s/epoch, loss=0.411, accuracy=0.928, val_loss=0.516, val_accuracy=0.89, lr=0.001]  65%|██████▌   | 65/100 [24:47<12:58, 22.24s/epoch, loss=0.396, accuracy=0.931, val_loss=0.503, val_accuracy=0.895, lr=0.001] 66%|██████▌   | 66/100 [25:09<12:36, 22.25s/epoch, loss=0.381, accuracy=0.933, val_loss=0.501, val_accuracy=0.894, lr=0.001] 67%|██████▋   | 67/100 [25:32<12:13, 22.24s/epoch, loss=0.367, accuracy=0.936, val_loss=0.493, val_accuracy=0.894, lr=0.001] 68%|██████▊   | 68/100 [25:54<11:53, 22.29s/epoch, loss=0.357, accuracy=0.938, val_loss=0.49, val_accuracy=0.896, lr=0.001]  69%|██████▉   | 69/100 [26:16<11:30, 22.26s/epoch, loss=0.347, accuracy=0.94, val_loss=0.483, val_accuracy=0.897, lr=0.001] 70%|███████   | 70/100 [26:39<11:07, 22.26s/epoch, loss=0.335, accuracy=0.942, val_loss=0.501, val_accuracy=0.89, lr=0.001] 71%|███████   | 71/100 [27:01<10:44, 22.23s/epoch, loss=0.328, accuracy=0.943, val_loss=0.479, val_accuracy=0.894, lr=0.001] 72%|███████▏  | 72/100 [27:23<10:24, 22.31s/epoch, loss=0.319, accuracy=0.946, val_loss=0.487, val_accuracy=0.894, lr=0.001] 73%|███████▎  | 73/100 [27:45<10:02, 22.30s/epoch, loss=0.31, accuracy=0.947, val_loss=0.474, val_accuracy=0.897, lr=0.001]  74%|███████▍  | 74/100 [28:08<09:39, 22.28s/epoch, loss=0.304, accuracy=0.948, val_loss=0.468, val_accuracy=0.896, lr=0.001] 75%|███████▌  | 75/100 [28:30<09:16, 22.26s/epoch, loss=0.3, accuracy=0.948, val_loss=0.479, val_accuracy=0.892, lr=0.001]   76%|███████▌  | 76/100 [28:52<08:55, 22.30s/epoch, loss=0.292, accuracy=0.95, val_loss=0.476, val_accuracy=0.891, lr=0.001] 77%|███████▋  | 77/100 [29:15<08:33, 22.31s/epoch, loss=0.286, accuracy=0.951, val_loss=0.492, val_accuracy=0.887, lr=0.001] 78%|███████▊  | 78/100 [29:37<08:11, 22.34s/epoch, loss=0.281, accuracy=0.952, val_loss=0.471, val_accuracy=0.895, lr=0.001] 79%|███████▉  | 79/100 [29:59<07:48, 22.32s/epoch, loss=0.275, accuracy=0.952, val_loss=0.47, val_accuracy=0.896, lr=0.001]  80%|████████  | 80/100 [30:22<07:25, 22.28s/epoch, loss=0.267, accuracy=0.955, val_loss=0.457, val_accuracy=0.897, lr=0.001] 81%|████████  | 81/100 [30:44<07:02, 22.25s/epoch, loss=0.268, accuracy=0.953, val_loss=0.476, val_accuracy=0.893, lr=0.001] 82%|████████▏ | 82/100 [31:06<06:40, 22.24s/epoch, loss=0.249, accuracy=0.96, val_loss=0.435, val_accuracy=0.903, lr=1e-04]  83%|████████▎ | 83/100 [31:28<06:17, 22.22s/epoch, loss=0.239, accuracy=0.963, val_loss=0.434, val_accuracy=0.902, lr=1e-04] 84%|████████▍ | 84/100 [31:50<05:55, 22.20s/epoch, loss=0.236, accuracy=0.966, val_loss=0.432, val_accuracy=0.903, lr=1e-04] 85%|████████▌ | 85/100 [32:12<05:32, 22.17s/epoch, loss=0.231, accuracy=0.967, val_loss=0.432, val_accuracy=0.904, lr=1e-04] 86%|████████▌ | 86/100 [32:34<05:10, 22.16s/epoch, loss=0.231, accuracy=0.967, val_loss=0.433, val_accuracy=0.904, lr=1e-04] 87%|████████▋ | 87/100 [32:57<04:48, 22.16s/epoch, loss=0.229, accuracy=0.967, val_loss=0.431, val_accuracy=0.906, lr=1e-04] 88%|████████▊ | 88/100 [33:19<04:25, 22.15s/epoch, loss=0.228, accuracy=0.968, val_loss=0.431, val_accuracy=0.905, lr=1e-04] 89%|████████▉ | 89/100 [33:41<04:03, 22.16s/epoch, loss=0.226, accuracy=0.969, val_loss=0.434, val_accuracy=0.906, lr=1e-04] 90%|█████████ | 90/100 [34:03<03:41, 22.15s/epoch, loss=0.225, accuracy=0.969, val_loss=0.432, val_accuracy=0.905, lr=1e-04] 91%|█████████ | 91/100 [34:25<03:19, 22.16s/epoch, loss=0.223, accuracy=0.969, val_loss=0.431, val_accuracy=0.906, lr=1e-04] 92%|█████████▏| 92/100 [34:47<02:57, 22.16s/epoch, loss=0.221, accuracy=0.971, val_loss=0.431, val_accuracy=0.906, lr=5e-5]  93%|█████████▎| 93/100 [35:10<02:35, 22.18s/epoch, loss=0.22, accuracy=0.97, val_loss=0.43, val_accuracy=0.905, lr=5e-5]    94%|█████████▍| 94/100 [35:32<02:13, 22.18s/epoch, loss=0.221, accuracy=0.969, val_loss=0.43, val_accuracy=0.905, lr=5e-5] 95%|█████████▌| 95/100 [35:54<01:50, 22.15s/epoch, loss=0.22, accuracy=0.971, val_loss=0.429, val_accuracy=0.905, lr=5e-5] 96%|█████████▌| 96/100 [36:16<01:28, 22.18s/epoch, loss=0.219, accuracy=0.971, val_loss=0.43, val_accuracy=0.905, lr=5e-5] 97%|█████████▋| 97/100 [36:38<01:06, 22.20s/epoch, loss=0.217, accuracy=0.971, val_loss=0.43, val_accuracy=0.905, lr=5e-5] 98%|█████████▊| 98/100 [37:01<00:44, 22.23s/epoch, loss=0.216, accuracy=0.972, val_loss=0.43, val_accuracy=0.906, lr=5e-5] 99%|█████████▉| 99/100 [37:23<00:22, 22.23s/epoch, loss=0.218, accuracy=0.971, val_loss=0.429, val_accuracy=0.906, lr=5e-5]100%|██████████| 100/100 [37:45<00:00, 22.23s/epoch, loss=0.217, accuracy=0.971, val_loss=0.428, val_accuracy=0.906, lr=5e-5]100%|██████████| 100/100 [37:45<00:00, 22.66s/epoch, loss=0.217, accuracy=0.971, val_loss=0.428, val_accuracy=0.906, lr=5e-5]
Using real-time data augmentation.
Only one model saved

Loading model: 15_06_cifar10_ResNet20v1.h5
Test score: 0.428135484457016
Test accuracy: 0.9059000015258789


* * * Run SGD for ID = 15_7. * * *


2024-03-13 06:23:28.073425: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 06:23:30.615010: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 06:23:30.616135: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-13 06:23:30.656132: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-13 06:23:30.656164: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 06:23:30.658822: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 06:23:30.658865: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 06:23:30.661159: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 06:23:30.661775: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 06:23:30.664132: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 06:23:30.665634: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 06:23:30.670546: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 06:23:30.671114: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 06:23:30.671198: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 06:23:31.993382: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-13 06:23:31.993934: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 06:23:31.994769: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-13 06:23:31.994802: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 06:23:31.994838: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 06:23:31.994856: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 06:23:31.994872: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 06:23:31.994890: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 06:23:31.994906: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 06:23:31.994922: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 06:23:31.994938: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 06:23:31.995471: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 06:23:31.995509: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 06:23:32.676165: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-13 06:23:32.676221: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-13 06:23:32.676230: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-13 06:23:32.677183: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:02:00.0, compute capability: 6.1)
{'id': '15_07', 'seed': 7, 'out_folder': 'results/epoch_budget_2', 'batch_size': 128, 'epochs': 100, 'validation_split': 0.0, 'checkpointing': False, 'checkpoint_every': -1, 'hold_out_validation_split': 0.0, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'num_classes': 10, 'SSE_lr': False, 'test_time_augmentation': False, 'debug': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
y_train shape: (50000, 10)
x_val shape: (10000, 32, 32, 3)
y_val shape: (10000, 10)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/100 [00:00<?, ?epoch/s]2024-03-13 06:23:33.375626: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-13 06:23:33.376274: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199825000 Hz
2024-03-13 06:23:35.578641: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 06:23:35.809725: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 06:23:36.610355: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-13 06:23:36.657211: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/100 [01:00<1:39:25, 60.26s/epoch, loss=3.05, accuracy=0.322, val_loss=2.38, val_accuracy=0.291, lr=0.1]  2%|▏         | 2/100 [01:22<1:01:59, 37.95s/epoch, loss=1.48, accuracy=0.577, val_loss=2.41, val_accuracy=0.368, lr=0.1]  3%|▎         | 3/100 [01:44<49:42, 30.75s/epoch, loss=1.31, accuracy=0.652, val_loss=2.52, val_accuracy=0.347, lr=0.1]    4%|▍         | 4/100 [02:06<43:47, 27.37s/epoch, loss=1.25, accuracy=0.688, val_loss=2.99, val_accuracy=0.36, lr=0.1]   5%|▌         | 5/100 [02:29<40:24, 25.53s/epoch, loss=1.22, accuracy=0.703, val_loss=2.04, val_accuracy=0.477, lr=0.1]  6%|▌         | 6/100 [02:51<38:21, 24.48s/epoch, loss=1.21, accuracy=0.712, val_loss=2.56, val_accuracy=0.378, lr=0.1]  7%|▋         | 7/100 [03:13<36:48, 23.75s/epoch, loss=1.2, accuracy=0.721, val_loss=1.88, val_accuracy=0.514, lr=0.1]   8%|▊         | 8/100 [03:36<35:38, 23.24s/epoch, loss=1.19, accuracy=0.727, val_loss=3.34, val_accuracy=0.33, lr=0.1]  9%|▉         | 9/100 [03:58<34:45, 22.92s/epoch, loss=1.19, accuracy=0.727, val_loss=1.49, val_accuracy=0.622, lr=0.1] 10%|█         | 10/100 [04:20<33:58, 22.65s/epoch, loss=1.18, accuracy=0.731, val_loss=2.2, val_accuracy=0.453, lr=0.1] 11%|█         | 11/100 [04:42<33:20, 22.48s/epoch, loss=1.18, accuracy=0.734, val_loss=1.68, val_accuracy=0.582, lr=0.1] 12%|█▏        | 12/100 [05:04<32:52, 22.41s/epoch, loss=1.17, accuracy=0.736, val_loss=3.71, val_accuracy=0.326, lr=0.1] 13%|█▎        | 13/100 [05:26<32:24, 22.35s/epoch, loss=1.18, accuracy=0.735, val_loss=2.21, val_accuracy=0.436, lr=0.1] 14%|█▍        | 14/100 [05:49<31:59, 22.32s/epoch, loss=1.17, accuracy=0.738, val_loss=1.85, val_accuracy=0.539, lr=0.1] 15%|█▌        | 15/100 [06:11<31:31, 22.25s/epoch, loss=1.17, accuracy=0.74, val_loss=1.98, val_accuracy=0.479, lr=0.1]  16%|█▌        | 16/100 [06:33<31:07, 22.24s/epoch, loss=1.16, accuracy=0.744, val_loss=1.67, val_accuracy=0.59, lr=0.1] 17%|█▋        | 17/100 [06:55<30:45, 22.23s/epoch, loss=1.16, accuracy=0.744, val_loss=1.38, val_accuracy=0.666, lr=0.1] 18%|█▊        | 18/100 [07:17<30:22, 22.22s/epoch, loss=1.16, accuracy=0.745, val_loss=1.35, val_accuracy=0.678, lr=0.1] 19%|█▉        | 19/100 [07:39<29:56, 22.18s/epoch, loss=1.15, accuracy=0.744, val_loss=1.95, val_accuracy=0.453, lr=0.1] 20%|██        | 20/100 [08:01<29:30, 22.14s/epoch, loss=1.15, accuracy=0.747, val_loss=1.65, val_accuracy=0.566, lr=0.1] 21%|██        | 21/100 [08:24<29:08, 22.13s/epoch, loss=1.15, accuracy=0.746, val_loss=1.73, val_accuracy=0.517, lr=0.1] 22%|██▏       | 22/100 [08:46<28:48, 22.16s/epoch, loss=1.14, accuracy=0.745, val_loss=1.57, val_accuracy=0.589, lr=0.1] 23%|██▎       | 23/100 [09:08<28:28, 22.19s/epoch, loss=1.15, accuracy=0.746, val_loss=1.65, val_accuracy=0.597, lr=0.1] 24%|██▍       | 24/100 [09:30<28:04, 22.16s/epoch, loss=1.14, accuracy=0.749, val_loss=2.27, val_accuracy=0.354, lr=0.1] 25%|██▌       | 25/100 [09:53<27:46, 22.22s/epoch, loss=1.14, accuracy=0.748, val_loss=2.6, val_accuracy=0.414, lr=0.1]  26%|██▌       | 26/100 [10:15<27:24, 22.22s/epoch, loss=1.14, accuracy=0.75, val_loss=2.07, val_accuracy=0.485, lr=0.1] 27%|██▋       | 27/100 [10:37<27:02, 22.23s/epoch, loss=1.14, accuracy=0.749, val_loss=1.67, val_accuracy=0.555, lr=0.1] 28%|██▊       | 28/100 [10:59<26:37, 22.19s/epoch, loss=1.14, accuracy=0.751, val_loss=1.93, val_accuracy=0.54, lr=0.1]  29%|██▉       | 29/100 [11:21<26:13, 22.16s/epoch, loss=1.14, accuracy=0.749, val_loss=1.5, val_accuracy=0.642, lr=0.1] 30%|███       | 30/100 [11:44<25:56, 22.23s/epoch, loss=1.14, accuracy=0.749, val_loss=1.78, val_accuracy=0.515, lr=0.1] 31%|███       | 31/100 [12:06<25:29, 22.17s/epoch, loss=1.13, accuracy=0.752, val_loss=2.8, val_accuracy=0.363, lr=0.1]  32%|███▏      | 32/100 [12:28<25:08, 22.18s/epoch, loss=1.13, accuracy=0.75, val_loss=2.95, val_accuracy=0.361, lr=0.1] 33%|███▎      | 33/100 [12:50<24:45, 22.17s/epoch, loss=1.13, accuracy=0.75, val_loss=1.6, val_accuracy=0.609, lr=0.1]  34%|███▍      | 34/100 [13:12<24:15, 22.06s/epoch, loss=1.13, accuracy=0.751, val_loss=1.58, val_accuracy=0.599, lr=0.1] 35%|███▌      | 35/100 [13:34<23:51, 22.02s/epoch, loss=1.13, accuracy=0.755, val_loss=2.44, val_accuracy=0.504, lr=0.1] 36%|███▌      | 36/100 [13:56<23:27, 21.99s/epoch, loss=1.13, accuracy=0.753, val_loss=2.19, val_accuracy=0.531, lr=0.1] 37%|███▋      | 37/100 [14:18<23:03, 21.97s/epoch, loss=1.12, accuracy=0.754, val_loss=1.47, val_accuracy=0.628, lr=0.1] 38%|███▊      | 38/100 [14:39<22:40, 21.95s/epoch, loss=1.13, accuracy=0.753, val_loss=1.81, val_accuracy=0.532, lr=0.1] 39%|███▉      | 39/100 [15:01<22:20, 21.97s/epoch, loss=1.12, accuracy=0.756, val_loss=1.54, val_accuracy=0.627, lr=0.1] 40%|████      | 40/100 [15:24<22:01, 22.02s/epoch, loss=1.12, accuracy=0.754, val_loss=1.69, val_accuracy=0.585, lr=0.1] 41%|████      | 41/100 [15:46<21:37, 21.99s/epoch, loss=1.12, accuracy=0.753, val_loss=2.89, val_accuracy=0.384, lr=0.1] 42%|████▏     | 42/100 [16:07<21:15, 21.98s/epoch, loss=0.912, accuracy=0.816, val_loss=0.892, val_accuracy=0.803, lr=0.01] 43%|████▎     | 43/100 [16:29<20:53, 22.00s/epoch, loss=0.734, accuracy=0.847, val_loss=0.796, val_accuracy=0.81, lr=0.01]  44%|████▍     | 44/100 [16:52<20:32, 22.01s/epoch, loss=0.661, accuracy=0.854, val_loss=0.877, val_accuracy=0.768, lr=0.01] 45%|████▌     | 45/100 [17:14<20:12, 22.05s/epoch, loss=0.614, accuracy=0.858, val_loss=0.77, val_accuracy=0.804, lr=0.01]  46%|████▌     | 46/100 [17:36<19:49, 22.03s/epoch, loss=0.593, accuracy=0.859, val_loss=0.741, val_accuracy=0.807, lr=0.01] 47%|████▋     | 47/100 [17:58<19:27, 22.03s/epoch, loss=0.582, accuracy=0.859, val_loss=0.745, val_accuracy=0.806, lr=0.01] 48%|████▊     | 48/100 [18:20<19:08, 22.08s/epoch, loss=0.581, accuracy=0.859, val_loss=0.78, val_accuracy=0.792, lr=0.01]  49%|████▉     | 49/100 [18:42<18:44, 22.04s/epoch, loss=0.571, accuracy=0.865, val_loss=1.03, val_accuracy=0.743, lr=0.01] 50%|█████     | 50/100 [19:04<18:20, 22.01s/epoch, loss=0.569, accuracy=0.863, val_loss=0.847, val_accuracy=0.784, lr=0.01] 51%|█████     | 51/100 [19:26<17:57, 22.00s/epoch, loss=0.572, accuracy=0.864, val_loss=0.823, val_accuracy=0.779, lr=0.01] 52%|█████▏    | 52/100 [19:48<17:33, 21.96s/epoch, loss=0.569, accuracy=0.866, val_loss=1.07, val_accuracy=0.734, lr=0.01]  53%|█████▎    | 53/100 [20:10<17:11, 21.94s/epoch, loss=0.566, accuracy=0.868, val_loss=0.83, val_accuracy=0.788, lr=0.01] 54%|█████▍    | 54/100 [20:32<16:52, 22.01s/epoch, loss=0.564, accuracy=0.869, val_loss=0.747, val_accuracy=0.816, lr=0.01] 55%|█████▌    | 55/100 [20:54<16:32, 22.05s/epoch, loss=0.565, accuracy=0.87, val_loss=1.14, val_accuracy=0.726, lr=0.01]   56%|█████▌    | 56/100 [21:16<16:11, 22.07s/epoch, loss=0.567, accuracy=0.87, val_loss=0.821, val_accuracy=0.798, lr=0.01] 57%|█████▋    | 57/100 [21:38<15:49, 22.07s/epoch, loss=0.568, accuracy=0.871, val_loss=0.784, val_accuracy=0.803, lr=0.01] 58%|█████▊    | 58/100 [22:00<15:26, 22.06s/epoch, loss=0.564, accuracy=0.872, val_loss=0.839, val_accuracy=0.776, lr=0.01] 59%|█████▉    | 59/100 [22:22<15:05, 22.09s/epoch, loss=0.564, accuracy=0.872, val_loss=0.745, val_accuracy=0.821, lr=0.01] 60%|██████    | 60/100 [22:44<14:45, 22.14s/epoch, loss=0.562, accuracy=0.875, val_loss=0.842, val_accuracy=0.783, lr=0.01] 61%|██████    | 61/100 [23:06<14:21, 22.09s/epoch, loss=0.565, accuracy=0.875, val_loss=0.781, val_accuracy=0.819, lr=0.01] 62%|██████▏   | 62/100 [23:28<13:57, 22.04s/epoch, loss=0.485, accuracy=0.901, val_loss=0.543, val_accuracy=0.881, lr=0.001] 63%|██████▎   | 63/100 [23:50<13:34, 22.02s/epoch, loss=0.435, accuracy=0.918, val_loss=0.534, val_accuracy=0.885, lr=0.001] 64%|██████▍   | 64/100 [24:12<13:13, 22.05s/epoch, loss=0.415, accuracy=0.923, val_loss=0.531, val_accuracy=0.884, lr=0.001] 65%|██████▌   | 65/100 [24:34<12:50, 22.01s/epoch, loss=0.397, accuracy=0.927, val_loss=0.514, val_accuracy=0.887, lr=0.001] 66%|██████▌   | 66/100 [24:56<12:27, 21.99s/epoch, loss=0.383, accuracy=0.93, val_loss=0.505, val_accuracy=0.889, lr=0.001]  67%|██████▋   | 67/100 [25:18<12:04, 21.96s/epoch, loss=0.373, accuracy=0.931, val_loss=0.502, val_accuracy=0.887, lr=0.001] 68%|██████▊   | 68/100 [25:40<11:42, 21.95s/epoch, loss=0.363, accuracy=0.933, val_loss=0.514, val_accuracy=0.884, lr=0.001] 69%|██████▉   | 69/100 [26:02<11:18, 21.89s/epoch, loss=0.351, accuracy=0.937, val_loss=0.531, val_accuracy=0.879, lr=0.001] 70%|███████   | 70/100 [26:24<10:56, 21.88s/epoch, loss=0.342, accuracy=0.938, val_loss=0.511, val_accuracy=0.884, lr=0.001] 71%|███████   | 71/100 [26:46<10:35, 21.90s/epoch, loss=0.338, accuracy=0.937, val_loss=0.507, val_accuracy=0.884, lr=0.001] 72%|███████▏  | 72/100 [27:08<10:12, 21.88s/epoch, loss=0.328, accuracy=0.939, val_loss=0.514, val_accuracy=0.882, lr=0.001] 73%|███████▎  | 73/100 [27:29<09:51, 21.90s/epoch, loss=0.319, accuracy=0.942, val_loss=0.512, val_accuracy=0.885, lr=0.001] 74%|███████▍  | 74/100 [27:51<09:30, 21.93s/epoch, loss=0.315, accuracy=0.942, val_loss=0.492, val_accuracy=0.889, lr=0.001] 75%|███████▌  | 75/100 [28:13<09:08, 21.94s/epoch, loss=0.308, accuracy=0.943, val_loss=0.518, val_accuracy=0.878, lr=0.001] 76%|███████▌  | 76/100 [28:35<08:47, 21.96s/epoch, loss=0.303, accuracy=0.946, val_loss=0.498, val_accuracy=0.885, lr=0.001] 77%|███████▋  | 77/100 [28:57<08:24, 21.95s/epoch, loss=0.295, accuracy=0.945, val_loss=0.494, val_accuracy=0.884, lr=0.001] 78%|███████▊  | 78/100 [29:19<08:03, 21.96s/epoch, loss=0.292, accuracy=0.945, val_loss=0.487, val_accuracy=0.885, lr=0.001] 79%|███████▉  | 79/100 [29:41<07:39, 21.90s/epoch, loss=0.285, accuracy=0.947, val_loss=0.498, val_accuracy=0.884, lr=0.001] 80%|████████  | 80/100 [30:03<07:17, 21.89s/epoch, loss=0.28, accuracy=0.948, val_loss=0.569, val_accuracy=0.867, lr=0.001]  81%|████████  | 81/100 [30:25<06:55, 21.87s/epoch, loss=0.279, accuracy=0.948, val_loss=0.463, val_accuracy=0.891, lr=0.001] 82%|████████▏ | 82/100 [30:47<06:33, 21.88s/epoch, loss=0.257, accuracy=0.956, val_loss=0.45, val_accuracy=0.897, lr=1e-04]  83%|████████▎ | 83/100 [31:08<06:11, 21.83s/epoch, loss=0.246, accuracy=0.96, val_loss=0.448, val_accuracy=0.899, lr=1e-04] 84%|████████▍ | 84/100 [31:30<05:48, 21.80s/epoch, loss=0.241, accuracy=0.962, val_loss=0.445, val_accuracy=0.9, lr=1e-04]  85%|████████▌ | 85/100 [31:52<05:26, 21.80s/epoch, loss=0.238, accuracy=0.964, val_loss=0.446, val_accuracy=0.9, lr=1e-04] 86%|████████▌ | 86/100 [32:14<05:05, 21.80s/epoch, loss=0.236, accuracy=0.963, val_loss=0.446, val_accuracy=0.902, lr=1e-04] 87%|████████▋ | 87/100 [32:36<04:43, 21.78s/epoch, loss=0.231, accuracy=0.965, val_loss=0.449, val_accuracy=0.899, lr=1e-04] 88%|████████▊ | 88/100 [32:57<04:22, 21.83s/epoch, loss=0.232, accuracy=0.964, val_loss=0.447, val_accuracy=0.9, lr=1e-04]   89%|████████▉ | 89/100 [33:19<03:59, 21.82s/epoch, loss=0.232, accuracy=0.965, val_loss=0.449, val_accuracy=0.899, lr=1e-04] 90%|█████████ | 90/100 [33:41<03:38, 21.82s/epoch, loss=0.227, accuracy=0.966, val_loss=0.448, val_accuracy=0.901, lr=1e-04] 91%|█████████ | 91/100 [34:03<03:16, 21.79s/epoch, loss=0.225, accuracy=0.967, val_loss=0.447, val_accuracy=0.902, lr=1e-04] 92%|█████████▏| 92/100 [34:25<02:54, 21.78s/epoch, loss=0.225, accuracy=0.967, val_loss=0.448, val_accuracy=0.901, lr=5e-5]  93%|█████████▎| 93/100 [34:46<02:32, 21.82s/epoch, loss=0.223, accuracy=0.967, val_loss=0.447, val_accuracy=0.901, lr=5e-5] 94%|█████████▍| 94/100 [35:08<02:10, 21.80s/epoch, loss=0.223, accuracy=0.968, val_loss=0.449, val_accuracy=0.9, lr=5e-5]   95%|█████████▌| 95/100 [35:30<01:48, 21.79s/epoch, loss=0.222, accuracy=0.967, val_loss=0.447, val_accuracy=0.901, lr=5e-5] 96%|█████████▌| 96/100 [35:52<01:27, 21.77s/epoch, loss=0.22, accuracy=0.969, val_loss=0.448, val_accuracy=0.901, lr=5e-5]  97%|█████████▋| 97/100 [36:13<01:05, 21.75s/epoch, loss=0.221, accuracy=0.967, val_loss=0.449, val_accuracy=0.901, lr=5e-5] 98%|█████████▊| 98/100 [36:35<00:43, 21.74s/epoch, loss=0.221, accuracy=0.967, val_loss=0.449, val_accuracy=0.901, lr=5e-5] 99%|█████████▉| 99/100 [36:57<00:21, 21.81s/epoch, loss=0.218, accuracy=0.968, val_loss=0.448, val_accuracy=0.9, lr=5e-5]  100%|██████████| 100/100 [37:21<00:00, 22.43s/epoch, loss=0.218, accuracy=0.968, val_loss=0.448, val_accuracy=0.902, lr=5e-5]100%|██████████| 100/100 [37:21<00:00, 22.41s/epoch, loss=0.218, accuracy=0.968, val_loss=0.448, val_accuracy=0.902, lr=5e-5]
Using real-time data augmentation.
Only one model saved

Loading model: 15_07_cifar10_ResNet20v1.h5
Test score: 0.4482329189777374
Test accuracy: 0.9021000266075134


* * * Run SGD for ID = 15_8. * * *


2024-03-13 07:00:58.807108: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 07:01:04.208840: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 07:01:04.210039: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-13 07:01:04.251208: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-13 07:01:04.251241: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 07:01:04.255604: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 07:01:04.255648: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 07:01:04.259204: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 07:01:04.260877: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 07:01:04.264392: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 07:01:04.267042: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 07:01:04.272428: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 07:01:04.272956: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 07:01:04.273036: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 07:01:05.618882: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-13 07:01:05.619401: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 07:01:05.619884: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-13 07:01:05.619914: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 07:01:05.619947: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 07:01:05.619964: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 07:01:05.619980: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 07:01:05.620004: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 07:01:05.620020: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 07:01:05.620036: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 07:01:05.620081: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 07:01:05.620559: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 07:01:05.620594: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 07:01:06.318024: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-13 07:01:06.318123: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-13 07:01:06.318142: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-13 07:01:06.319525: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:02:00.0, compute capability: 6.1)
{'id': '15_08', 'seed': 8, 'out_folder': 'results/epoch_budget_2', 'batch_size': 128, 'epochs': 100, 'validation_split': 0.0, 'checkpointing': False, 'checkpoint_every': -1, 'hold_out_validation_split': 0.0, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'num_classes': 10, 'SSE_lr': False, 'test_time_augmentation': False, 'debug': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
y_train shape: (50000, 10)
x_val shape: (10000, 32, 32, 3)
y_val shape: (10000, 10)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/100 [00:00<?, ?epoch/s]2024-03-13 07:01:06.985998: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-13 07:01:06.998186: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199825000 Hz
2024-03-13 07:01:09.179784: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 07:01:09.426012: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 07:01:10.179645: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-13 07:01:10.236840: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/100 [00:59<1:37:22, 59.02s/epoch, loss=2.9, accuracy=0.371, val_loss=2.12, val_accuracy=0.361, lr=0.1]  2%|▏         | 2/100 [01:21<1:01:28, 37.63s/epoch, loss=1.49, accuracy=0.573, val_loss=1.99, val_accuracy=0.454, lr=0.1]  3%|▎         | 3/100 [01:44<49:39, 30.72s/epoch, loss=1.32, accuracy=0.661, val_loss=2.06, val_accuracy=0.457, lr=0.1]    4%|▍         | 4/100 [02:06<44:01, 27.51s/epoch, loss=1.26, accuracy=0.694, val_loss=2.05, val_accuracy=0.477, lr=0.1]  5%|▌         | 5/100 [02:29<40:39, 25.68s/epoch, loss=1.23, accuracy=0.711, val_loss=2.47, val_accuracy=0.365, lr=0.1]  6%|▌         | 6/100 [02:51<38:31, 24.59s/epoch, loss=1.22, accuracy=0.718, val_loss=1.89, val_accuracy=0.525, lr=0.1]  7%|▋         | 7/100 [03:14<37:02, 23.90s/epoch, loss=1.2, accuracy=0.727, val_loss=3.25, val_accuracy=0.234, lr=0.1]   8%|▊         | 8/100 [03:36<35:55, 23.43s/epoch, loss=1.2, accuracy=0.733, val_loss=4.22, val_accuracy=0.213, lr=0.1]  9%|▉         | 9/100 [03:58<35:02, 23.10s/epoch, loss=1.19, accuracy=0.734, val_loss=2.68, val_accuracy=0.38, lr=0.1] 10%|█         | 10/100 [04:21<34:23, 22.92s/epoch, loss=1.19, accuracy=0.735, val_loss=3.72, val_accuracy=0.246, lr=0.1] 11%|█         | 11/100 [04:43<33:44, 22.75s/epoch, loss=1.17, accuracy=0.74, val_loss=1.52, val_accuracy=0.63, lr=0.1]   12%|█▏        | 12/100 [05:06<33:15, 22.68s/epoch, loss=1.18, accuracy=0.741, val_loss=2, val_accuracy=0.519, lr=0.1]  13%|█▎        | 13/100 [05:28<32:45, 22.59s/epoch, loss=1.17, accuracy=0.746, val_loss=2.13, val_accuracy=0.506, lr=0.1] 14%|█▍        | 14/100 [05:51<32:20, 22.56s/epoch, loss=1.17, accuracy=0.744, val_loss=2.49, val_accuracy=0.391, lr=0.1] 15%|█▌        | 15/100 [06:13<31:55, 22.54s/epoch, loss=1.16, accuracy=0.749, val_loss=2.26, val_accuracy=0.391, lr=0.1] 16%|█▌        | 16/100 [06:36<31:33, 22.54s/epoch, loss=1.16, accuracy=0.747, val_loss=2.06, val_accuracy=0.525, lr=0.1] 17%|█▋        | 17/100 [06:58<31:07, 22.50s/epoch, loss=1.16, accuracy=0.746, val_loss=2.14, val_accuracy=0.509, lr=0.1] 18%|█▊        | 18/100 [07:21<30:48, 22.54s/epoch, loss=1.16, accuracy=0.746, val_loss=2.73, val_accuracy=0.428, lr=0.1] 19%|█▉        | 19/100 [07:43<30:25, 22.54s/epoch, loss=1.15, accuracy=0.75, val_loss=2.1, val_accuracy=0.454, lr=0.1]   20%|██        | 20/100 [08:06<30:08, 22.60s/epoch, loss=1.15, accuracy=0.751, val_loss=1.42, val_accuracy=0.643, lr=0.1] 21%|██        | 21/100 [08:29<29:42, 22.57s/epoch, loss=1.16, accuracy=0.749, val_loss=2.02, val_accuracy=0.521, lr=0.1] 22%|██▏       | 22/100 [08:51<29:21, 22.59s/epoch, loss=1.15, accuracy=0.75, val_loss=2.16, val_accuracy=0.483, lr=0.1]  23%|██▎       | 23/100 [09:14<28:57, 22.56s/epoch, loss=1.14, accuracy=0.751, val_loss=1.94, val_accuracy=0.513, lr=0.1] 24%|██▍       | 24/100 [09:36<28:33, 22.54s/epoch, loss=1.14, accuracy=0.75, val_loss=1.75, val_accuracy=0.565, lr=0.1]  25%|██▌       | 25/100 [09:59<28:12, 22.57s/epoch, loss=1.14, accuracy=0.752, val_loss=2.49, val_accuracy=0.367, lr=0.1] 26%|██▌       | 26/100 [10:21<27:47, 22.54s/epoch, loss=1.14, accuracy=0.753, val_loss=1.93, val_accuracy=0.554, lr=0.1] 27%|██▋       | 27/100 [10:44<27:24, 22.53s/epoch, loss=1.14, accuracy=0.754, val_loss=1.78, val_accuracy=0.565, lr=0.1] 28%|██▊       | 28/100 [11:06<26:58, 22.47s/epoch, loss=1.14, accuracy=0.755, val_loss=1.62, val_accuracy=0.591, lr=0.1] 29%|██▉       | 29/100 [11:29<26:33, 22.44s/epoch, loss=1.13, accuracy=0.753, val_loss=1.76, val_accuracy=0.55, lr=0.1]  30%|███       | 30/100 [11:51<26:10, 22.43s/epoch, loss=1.13, accuracy=0.755, val_loss=1.8, val_accuracy=0.529, lr=0.1] 31%|███       | 31/100 [12:14<25:51, 22.49s/epoch, loss=1.13, accuracy=0.757, val_loss=1.48, val_accuracy=0.642, lr=0.1] 32%|███▏      | 32/100 [12:36<25:29, 22.49s/epoch, loss=1.13, accuracy=0.757, val_loss=2.56, val_accuracy=0.437, lr=0.1] 33%|███▎      | 33/100 [12:58<25:03, 22.44s/epoch, loss=1.13, accuracy=0.755, val_loss=1.76, val_accuracy=0.571, lr=0.1] 34%|███▍      | 34/100 [13:21<24:41, 22.45s/epoch, loss=1.13, accuracy=0.756, val_loss=1.9, val_accuracy=0.488, lr=0.1]  35%|███▌      | 35/100 [13:43<24:21, 22.49s/epoch, loss=1.12, accuracy=0.756, val_loss=3.08, val_accuracy=0.321, lr=0.1] 36%|███▌      | 36/100 [14:06<23:55, 22.44s/epoch, loss=1.13, accuracy=0.755, val_loss=1.48, val_accuracy=0.647, lr=0.1] 37%|███▋      | 37/100 [14:28<23:30, 22.39s/epoch, loss=1.12, accuracy=0.756, val_loss=2.24, val_accuracy=0.419, lr=0.1] 38%|███▊      | 38/100 [14:50<23:07, 22.37s/epoch, loss=1.12, accuracy=0.757, val_loss=1.83, val_accuracy=0.545, lr=0.1] 39%|███▉      | 39/100 [15:13<22:44, 22.37s/epoch, loss=1.11, accuracy=0.759, val_loss=2.04, val_accuracy=0.43, lr=0.1]  40%|████      | 40/100 [15:35<22:19, 22.32s/epoch, loss=1.12, accuracy=0.757, val_loss=6.64, val_accuracy=0.174, lr=0.1] 41%|████      | 41/100 [15:57<21:56, 22.31s/epoch, loss=1.11, accuracy=0.756, val_loss=2.44, val_accuracy=0.339, lr=0.1] 42%|████▏     | 42/100 [16:20<21:34, 22.31s/epoch, loss=0.898, accuracy=0.82, val_loss=0.881, val_accuracy=0.812, lr=0.01] 43%|████▎     | 43/100 [16:42<21:13, 22.34s/epoch, loss=0.722, accuracy=0.85, val_loss=0.796, val_accuracy=0.812, lr=0.01] 44%|████▍     | 44/100 [17:04<20:52, 22.36s/epoch, loss=0.641, accuracy=0.86, val_loss=0.829, val_accuracy=0.788, lr=0.01] 45%|████▌     | 45/100 [17:27<20:29, 22.36s/epoch, loss=0.6, accuracy=0.863, val_loss=1.08, val_accuracy=0.709, lr=0.01]   46%|████▌     | 46/100 [17:49<20:06, 22.35s/epoch, loss=0.581, accuracy=0.863, val_loss=0.99, val_accuracy=0.737, lr=0.01] 47%|████▋     | 47/100 [18:11<19:44, 22.35s/epoch, loss=0.571, accuracy=0.865, val_loss=0.816, val_accuracy=0.791, lr=0.01] 48%|████▊     | 48/100 [18:34<19:23, 22.37s/epoch, loss=0.566, accuracy=0.866, val_loss=0.83, val_accuracy=0.785, lr=0.01]  49%|████▉     | 49/100 [18:56<19:03, 22.42s/epoch, loss=0.558, accuracy=0.868, val_loss=0.892, val_accuracy=0.767, lr=0.01] 50%|█████     | 50/100 [19:19<18:39, 22.40s/epoch, loss=0.561, accuracy=0.869, val_loss=0.752, val_accuracy=0.804, lr=0.01] 51%|█████     | 51/100 [19:41<18:15, 22.36s/epoch, loss=0.555, accuracy=0.872, val_loss=0.821, val_accuracy=0.787, lr=0.01] 52%|█████▏    | 52/100 [20:03<17:51, 22.33s/epoch, loss=0.552, accuracy=0.872, val_loss=0.782, val_accuracy=0.797, lr=0.01] 53%|█████▎    | 53/100 [20:26<17:32, 22.39s/epoch, loss=0.552, accuracy=0.874, val_loss=0.748, val_accuracy=0.818, lr=0.01] 54%|█████▍    | 54/100 [20:48<17:13, 22.47s/epoch, loss=0.553, accuracy=0.873, val_loss=1.36, val_accuracy=0.68, lr=0.01]   55%|█████▌    | 55/100 [21:11<16:52, 22.51s/epoch, loss=0.551, accuracy=0.877, val_loss=0.943, val_accuracy=0.768, lr=0.01] 56%|█████▌    | 56/100 [21:33<16:30, 22.50s/epoch, loss=0.551, accuracy=0.878, val_loss=0.74, val_accuracy=0.817, lr=0.01]  57%|█████▋    | 57/100 [21:56<16:05, 22.46s/epoch, loss=0.549, accuracy=0.879, val_loss=0.751, val_accuracy=0.812, lr=0.01] 58%|█████▊    | 58/100 [22:18<15:42, 22.45s/epoch, loss=0.548, accuracy=0.879, val_loss=0.833, val_accuracy=0.796, lr=0.01] 59%|█████▉    | 59/100 [22:41<15:21, 22.48s/epoch, loss=0.553, accuracy=0.878, val_loss=0.754, val_accuracy=0.812, lr=0.01] 60%|██████    | 60/100 [23:03<14:57, 22.45s/epoch, loss=0.553, accuracy=0.88, val_loss=0.753, val_accuracy=0.813, lr=0.01]  61%|██████    | 61/100 [23:26<14:34, 22.43s/epoch, loss=0.549, accuracy=0.881, val_loss=0.725, val_accuracy=0.821, lr=0.01] 62%|██████▏   | 62/100 [23:48<14:14, 22.48s/epoch, loss=0.47, accuracy=0.911, val_loss=0.524, val_accuracy=0.891, lr=0.001] 63%|██████▎   | 63/100 [24:11<13:50, 22.46s/epoch, loss=0.423, accuracy=0.924, val_loss=0.511, val_accuracy=0.894, lr=0.001] 64%|██████▍   | 64/100 [24:33<13:29, 22.49s/epoch, loss=0.4, accuracy=0.93, val_loss=0.502, val_accuracy=0.893, lr=0.001]    65%|██████▌   | 65/100 [24:55<13:04, 22.42s/epoch, loss=0.385, accuracy=0.933, val_loss=0.504, val_accuracy=0.891, lr=0.001] 66%|██████▌   | 66/100 [25:18<12:41, 22.38s/epoch, loss=0.373, accuracy=0.936, val_loss=0.497, val_accuracy=0.894, lr=0.001] 67%|██████▋   | 67/100 [25:40<12:18, 22.37s/epoch, loss=0.358, accuracy=0.939, val_loss=0.506, val_accuracy=0.889, lr=0.001] 68%|██████▊   | 68/100 [26:02<11:53, 22.31s/epoch, loss=0.348, accuracy=0.941, val_loss=0.476, val_accuracy=0.898, lr=0.001] 69%|██████▉   | 69/100 [26:24<11:30, 22.28s/epoch, loss=0.337, accuracy=0.943, val_loss=0.478, val_accuracy=0.896, lr=0.001] 70%|███████   | 70/100 [26:47<11:07, 22.24s/epoch, loss=0.328, accuracy=0.945, val_loss=0.472, val_accuracy=0.896, lr=0.001] 71%|███████   | 71/100 [27:09<10:45, 22.25s/epoch, loss=0.322, accuracy=0.946, val_loss=0.475, val_accuracy=0.894, lr=0.001] 72%|███████▏  | 72/100 [27:31<10:21, 22.21s/epoch, loss=0.313, accuracy=0.947, val_loss=0.473, val_accuracy=0.896, lr=0.001] 73%|███████▎  | 73/100 [27:53<10:01, 22.26s/epoch, loss=0.304, accuracy=0.949, val_loss=0.466, val_accuracy=0.894, lr=0.001] 74%|███████▍  | 74/100 [28:16<09:39, 22.29s/epoch, loss=0.298, accuracy=0.95, val_loss=0.473, val_accuracy=0.896, lr=0.001]  75%|███████▌  | 75/100 [28:38<09:17, 22.31s/epoch, loss=0.291, accuracy=0.952, val_loss=0.459, val_accuracy=0.899, lr=0.001] 76%|███████▌  | 76/100 [29:01<08:56, 22.36s/epoch, loss=0.283, accuracy=0.952, val_loss=0.47, val_accuracy=0.895, lr=0.001]  77%|███████▋  | 77/100 [29:23<08:33, 22.35s/epoch, loss=0.28, accuracy=0.952, val_loss=0.459, val_accuracy=0.896, lr=0.001] 78%|███████▊  | 78/100 [29:45<08:12, 22.39s/epoch, loss=0.271, accuracy=0.955, val_loss=0.479, val_accuracy=0.889, lr=0.001] 79%|███████▉  | 79/100 [30:08<07:49, 22.36s/epoch, loss=0.267, accuracy=0.955, val_loss=0.475, val_accuracy=0.89, lr=0.001]  80%|████████  | 80/100 [30:30<07:26, 22.35s/epoch, loss=0.26, accuracy=0.957, val_loss=0.457, val_accuracy=0.896, lr=0.001] 81%|████████  | 81/100 [30:52<07:03, 22.30s/epoch, loss=0.258, accuracy=0.956, val_loss=0.447, val_accuracy=0.899, lr=0.001] 82%|████████▏ | 82/100 [31:14<06:41, 22.28s/epoch, loss=0.242, accuracy=0.963, val_loss=0.425, val_accuracy=0.906, lr=1e-04] 83%|████████▎ | 83/100 [31:37<06:18, 22.26s/epoch, loss=0.234, accuracy=0.966, val_loss=0.421, val_accuracy=0.908, lr=1e-04] 84%|████████▍ | 84/100 [31:59<05:55, 22.25s/epoch, loss=0.228, accuracy=0.968, val_loss=0.422, val_accuracy=0.907, lr=1e-04] 85%|████████▌ | 85/100 [32:21<05:33, 22.23s/epoch, loss=0.226, accuracy=0.968, val_loss=0.421, val_accuracy=0.907, lr=1e-04] 86%|████████▌ | 86/100 [32:43<05:11, 22.25s/epoch, loss=0.225, accuracy=0.969, val_loss=0.421, val_accuracy=0.908, lr=1e-04] 87%|████████▋ | 87/100 [33:05<04:49, 22.25s/epoch, loss=0.222, accuracy=0.97, val_loss=0.42, val_accuracy=0.908, lr=1e-04]   88%|████████▊ | 88/100 [33:28<04:26, 22.23s/epoch, loss=0.222, accuracy=0.97, val_loss=0.421, val_accuracy=0.907, lr=1e-04] 89%|████████▉ | 89/100 [33:50<04:04, 22.20s/epoch, loss=0.219, accuracy=0.97, val_loss=0.419, val_accuracy=0.908, lr=1e-04] 90%|█████████ | 90/100 [34:12<03:42, 22.21s/epoch, loss=0.217, accuracy=0.97, val_loss=0.421, val_accuracy=0.908, lr=1e-04] 91%|█████████ | 91/100 [34:34<03:19, 22.22s/epoch, loss=0.218, accuracy=0.971, val_loss=0.42, val_accuracy=0.91, lr=1e-04]  92%|█████████▏| 92/100 [34:57<02:57, 22.24s/epoch, loss=0.217, accuracy=0.971, val_loss=0.42, val_accuracy=0.908, lr=5e-5] 93%|█████████▎| 93/100 [35:19<02:35, 22.24s/epoch, loss=0.214, accuracy=0.972, val_loss=0.42, val_accuracy=0.908, lr=5e-5] 94%|█████████▍| 94/100 [35:41<02:13, 22.26s/epoch, loss=0.214, accuracy=0.972, val_loss=0.42, val_accuracy=0.907, lr=5e-5] 95%|█████████▌| 95/100 [36:03<01:51, 22.22s/epoch, loss=0.211, accuracy=0.973, val_loss=0.42, val_accuracy=0.907, lr=5e-5] 96%|█████████▌| 96/100 [36:25<01:28, 22.23s/epoch, loss=0.213, accuracy=0.972, val_loss=0.419, val_accuracy=0.908, lr=5e-5] 97%|█████████▋| 97/100 [36:48<01:06, 22.29s/epoch, loss=0.211, accuracy=0.974, val_loss=0.419, val_accuracy=0.907, lr=5e-5] 98%|█████████▊| 98/100 [37:10<00:44, 22.29s/epoch, loss=0.213, accuracy=0.972, val_loss=0.419, val_accuracy=0.909, lr=5e-5] 99%|█████████▉| 99/100 [37:32<00:22, 22.27s/epoch, loss=0.212, accuracy=0.972, val_loss=0.418, val_accuracy=0.908, lr=5e-5]100%|██████████| 100/100 [37:55<00:00, 22.28s/epoch, loss=0.212, accuracy=0.972, val_loss=0.418, val_accuracy=0.909, lr=5e-5]100%|██████████| 100/100 [37:55<00:00, 22.75s/epoch, loss=0.212, accuracy=0.972, val_loss=0.418, val_accuracy=0.909, lr=5e-5]
Using real-time data augmentation.
Only one model saved

Loading model: 15_08_cifar10_ResNet20v1.h5
Test score: 0.4177340865135193
Test accuracy: 0.9089000225067139


* * * Run SGD for ID = 15_9. * * *


2024-03-13 07:39:06.085102: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 07:39:08.768863: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 07:39:08.769906: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-13 07:39:08.810631: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-13 07:39:08.810664: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 07:39:08.813835: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 07:39:08.813878: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 07:39:08.816225: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 07:39:08.816906: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 07:39:08.819396: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 07:39:08.820966: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 07:39:08.826026: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 07:39:08.826624: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 07:39:08.826708: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 07:39:10.150439: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-13 07:39:10.151120: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 07:39:10.151932: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-13 07:39:10.151964: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 07:39:10.152003: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 07:39:10.152021: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 07:39:10.152037: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 07:39:10.152080: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 07:39:10.152119: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 07:39:10.152138: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 07:39:10.152158: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 07:39:10.152648: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 07:39:10.152688: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 07:39:10.832479: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-13 07:39:10.832533: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-13 07:39:10.832543: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-13 07:39:10.833506: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:02:00.0, compute capability: 6.1)
{'id': '15_09', 'seed': 9, 'out_folder': 'results/epoch_budget_2', 'batch_size': 128, 'epochs': 100, 'validation_split': 0.0, 'checkpointing': False, 'checkpoint_every': -1, 'hold_out_validation_split': 0.0, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'num_classes': 10, 'SSE_lr': False, 'test_time_augmentation': False, 'debug': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
y_train shape: (50000, 10)
x_val shape: (10000, 32, 32, 3)
y_val shape: (10000, 10)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/100 [00:00<?, ?epoch/s]2024-03-13 07:39:11.522032: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-13 07:39:11.534188: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199825000 Hz
2024-03-13 07:39:13.752229: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 07:39:14.007120: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 07:39:14.755826: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-13 07:39:14.814610: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/100 [01:01<1:40:50, 61.12s/epoch, loss=2.8, accuracy=0.415, val_loss=3.15, val_accuracy=0.231, lr=0.1]  2%|▏         | 2/100 [01:23<1:02:42, 38.40s/epoch, loss=1.45, accuracy=0.597, val_loss=1.71, val_accuracy=0.508, lr=0.1]  3%|▎         | 3/100 [01:45<50:08, 31.01s/epoch, loss=1.29, accuracy=0.665, val_loss=1.76, val_accuracy=0.531, lr=0.1]    4%|▍         | 4/100 [02:08<44:03, 27.53s/epoch, loss=1.24, accuracy=0.698, val_loss=2.13, val_accuracy=0.418, lr=0.1]  5%|▌         | 5/100 [02:30<40:30, 25.58s/epoch, loss=1.22, accuracy=0.712, val_loss=1.68, val_accuracy=0.544, lr=0.1]  6%|▌         | 6/100 [02:52<38:11, 24.37s/epoch, loss=1.2, accuracy=0.721, val_loss=1.62, val_accuracy=0.564, lr=0.1]   7%|▋         | 7/100 [03:14<36:38, 23.64s/epoch, loss=1.2, accuracy=0.724, val_loss=2.5, val_accuracy=0.275, lr=0.1]   8%|▊         | 8/100 [03:36<35:30, 23.15s/epoch, loss=1.18, accuracy=0.729, val_loss=1.83, val_accuracy=0.485, lr=0.1]  9%|▉         | 9/100 [03:58<34:36, 22.82s/epoch, loss=1.18, accuracy=0.734, val_loss=3.63, val_accuracy=0.323, lr=0.1] 10%|█         | 10/100 [04:20<33:54, 22.60s/epoch, loss=1.17, accuracy=0.736, val_loss=1.69, val_accuracy=0.592, lr=0.1] 11%|█         | 11/100 [04:42<33:20, 22.47s/epoch, loss=1.16, accuracy=0.738, val_loss=1.89, val_accuracy=0.513, lr=0.1] 12%|█▏        | 12/100 [05:05<32:50, 22.40s/epoch, loss=1.16, accuracy=0.74, val_loss=1.53, val_accuracy=0.607, lr=0.1]  13%|█▎        | 13/100 [05:27<32:25, 22.36s/epoch, loss=1.15, accuracy=0.741, val_loss=2.86, val_accuracy=0.415, lr=0.1] 14%|█▍        | 14/100 [05:49<31:58, 22.30s/epoch, loss=1.15, accuracy=0.742, val_loss=2.69, val_accuracy=0.483, lr=0.1] 15%|█▌        | 15/100 [06:11<31:26, 22.19s/epoch, loss=1.14, accuracy=0.747, val_loss=3.27, val_accuracy=0.414, lr=0.1] 16%|█▌        | 16/100 [06:33<31:01, 22.16s/epoch, loss=1.15, accuracy=0.745, val_loss=1.37, val_accuracy=0.662, lr=0.1] 17%|█▋        | 17/100 [06:55<30:37, 22.13s/epoch, loss=1.13, accuracy=0.75, val_loss=2, val_accuracy=0.531, lr=0.1]     18%|█▊        | 18/100 [07:17<30:13, 22.11s/epoch, loss=1.13, accuracy=0.75, val_loss=2.22, val_accuracy=0.39, lr=0.1] 19%|█▉        | 19/100 [07:39<29:56, 22.18s/epoch, loss=1.13, accuracy=0.748, val_loss=1.96, val_accuracy=0.503, lr=0.1] 20%|██        | 20/100 [08:02<29:38, 22.23s/epoch, loss=1.13, accuracy=0.751, val_loss=1.74, val_accuracy=0.539, lr=0.1] 21%|██        | 21/100 [08:24<29:18, 22.26s/epoch, loss=1.13, accuracy=0.753, val_loss=1.67, val_accuracy=0.576, lr=0.1] 22%|██▏       | 22/100 [08:46<28:57, 22.27s/epoch, loss=1.12, accuracy=0.754, val_loss=2.06, val_accuracy=0.5, lr=0.1]   23%|██▎       | 23/100 [09:09<28:36, 22.29s/epoch, loss=1.13, accuracy=0.753, val_loss=1.73, val_accuracy=0.589, lr=0.1] 24%|██▍       | 24/100 [09:31<28:10, 22.24s/epoch, loss=1.13, accuracy=0.755, val_loss=1.99, val_accuracy=0.517, lr=0.1] 25%|██▌       | 25/100 [09:53<27:45, 22.21s/epoch, loss=1.11, accuracy=0.756, val_loss=2.09, val_accuracy=0.516, lr=0.1] 26%|██▌       | 26/100 [10:15<27:23, 22.21s/epoch, loss=1.12, accuracy=0.752, val_loss=1.52, val_accuracy=0.6, lr=0.1]   27%|██▋       | 27/100 [10:37<27:00, 22.20s/epoch, loss=1.12, accuracy=0.754, val_loss=2.85, val_accuracy=0.401, lr=0.1] 28%|██▊       | 28/100 [10:59<26:34, 22.15s/epoch, loss=1.13, accuracy=0.753, val_loss=1.68, val_accuracy=0.62, lr=0.1]  29%|██▉       | 29/100 [11:22<26:12, 22.15s/epoch, loss=1.12, accuracy=0.759, val_loss=1.82, val_accuracy=0.551, lr=0.1] 30%|███       | 30/100 [11:44<25:49, 22.14s/epoch, loss=1.12, accuracy=0.757, val_loss=2.37, val_accuracy=0.388, lr=0.1] 31%|███       | 31/100 [12:06<25:26, 22.13s/epoch, loss=1.12, accuracy=0.754, val_loss=2.3, val_accuracy=0.451, lr=0.1]  32%|███▏      | 32/100 [12:28<25:05, 22.14s/epoch, loss=1.12, accuracy=0.756, val_loss=1.85, val_accuracy=0.548, lr=0.1] 33%|███▎      | 33/100 [12:50<24:42, 22.13s/epoch, loss=1.12, accuracy=0.758, val_loss=2.44, val_accuracy=0.324, lr=0.1] 34%|███▍      | 34/100 [13:12<24:20, 22.12s/epoch, loss=1.12, accuracy=0.756, val_loss=1.47, val_accuracy=0.633, lr=0.1] 35%|███▌      | 35/100 [13:34<23:57, 22.12s/epoch, loss=1.11, accuracy=0.756, val_loss=1.84, val_accuracy=0.552, lr=0.1] 36%|███▌      | 36/100 [13:57<23:38, 22.16s/epoch, loss=1.11, accuracy=0.757, val_loss=1.81, val_accuracy=0.57, lr=0.1]  37%|███▋      | 37/100 [14:19<23:16, 22.17s/epoch, loss=1.12, accuracy=0.756, val_loss=1.44, val_accuracy=0.632, lr=0.1] 38%|███▊      | 38/100 [14:41<22:53, 22.15s/epoch, loss=1.11, accuracy=0.757, val_loss=2.1, val_accuracy=0.436, lr=0.1]  39%|███▉      | 39/100 [15:03<22:29, 22.12s/epoch, loss=1.12, accuracy=0.757, val_loss=1.84, val_accuracy=0.531, lr=0.1] 40%|████      | 40/100 [15:25<22:05, 22.09s/epoch, loss=1.11, accuracy=0.758, val_loss=1.57, val_accuracy=0.596, lr=0.1] 41%|████      | 41/100 [15:47<21:45, 22.13s/epoch, loss=1.11, accuracy=0.757, val_loss=1.98, val_accuracy=0.563, lr=0.1] 42%|████▏     | 42/100 [16:09<21:25, 22.16s/epoch, loss=0.891, accuracy=0.821, val_loss=0.889, val_accuracy=0.803, lr=0.01] 43%|████▎     | 43/100 [16:32<21:03, 22.16s/epoch, loss=0.716, accuracy=0.851, val_loss=0.786, val_accuracy=0.815, lr=0.01] 44%|████▍     | 44/100 [16:54<20:43, 22.21s/epoch, loss=0.639, accuracy=0.86, val_loss=0.844, val_accuracy=0.779, lr=0.01]  45%|████▌     | 45/100 [17:16<20:21, 22.21s/epoch, loss=0.597, accuracy=0.862, val_loss=0.783, val_accuracy=0.801, lr=0.01] 46%|████▌     | 46/100 [17:38<19:57, 22.17s/epoch, loss=0.579, accuracy=0.863, val_loss=0.734, val_accuracy=0.806, lr=0.01] 47%|████▋     | 47/100 [18:00<19:33, 22.15s/epoch, loss=0.568, accuracy=0.864, val_loss=0.773, val_accuracy=0.805, lr=0.01] 48%|████▊     | 48/100 [18:22<19:11, 22.15s/epoch, loss=0.561, accuracy=0.867, val_loss=0.87, val_accuracy=0.78, lr=0.01]   49%|████▉     | 49/100 [18:44<18:47, 22.12s/epoch, loss=0.559, accuracy=0.867, val_loss=0.75, val_accuracy=0.807, lr=0.01] 50%|█████     | 50/100 [19:07<18:26, 22.13s/epoch, loss=0.554, accuracy=0.869, val_loss=1.15, val_accuracy=0.705, lr=0.01] 51%|█████     | 51/100 [19:29<18:02, 22.10s/epoch, loss=0.558, accuracy=0.869, val_loss=0.786, val_accuracy=0.806, lr=0.01] 52%|█████▏    | 52/100 [19:51<17:38, 22.05s/epoch, loss=0.55, accuracy=0.874, val_loss=1.1, val_accuracy=0.734, lr=0.01]    53%|█████▎    | 53/100 [20:13<17:16, 22.06s/epoch, loss=0.551, accuracy=0.874, val_loss=0.717, val_accuracy=0.819, lr=0.01] 54%|█████▍    | 54/100 [20:35<16:55, 22.07s/epoch, loss=0.55, accuracy=0.876, val_loss=1.14, val_accuracy=0.717, lr=0.01]   55%|█████▌    | 55/100 [20:57<16:32, 22.05s/epoch, loss=0.552, accuracy=0.874, val_loss=0.772, val_accuracy=0.814, lr=0.01] 56%|█████▌    | 56/100 [21:19<16:10, 22.05s/epoch, loss=0.551, accuracy=0.877, val_loss=0.997, val_accuracy=0.766, lr=0.01] 57%|█████▋    | 57/100 [21:41<15:47, 22.02s/epoch, loss=0.549, accuracy=0.877, val_loss=0.729, val_accuracy=0.818, lr=0.01] 58%|█████▊    | 58/100 [22:03<15:24, 22.02s/epoch, loss=0.549, accuracy=0.878, val_loss=0.77, val_accuracy=0.808, lr=0.01]  59%|█████▉    | 59/100 [22:25<15:04, 22.06s/epoch, loss=0.55, accuracy=0.878, val_loss=0.832, val_accuracy=0.786, lr=0.01] 60%|██████    | 60/100 [22:47<14:41, 22.04s/epoch, loss=0.546, accuracy=0.88, val_loss=0.926, val_accuracy=0.748, lr=0.01] 61%|██████    | 61/100 [23:09<14:18, 22.00s/epoch, loss=0.55, accuracy=0.881, val_loss=0.753, val_accuracy=0.821, lr=0.01] 62%|██████▏   | 62/100 [23:31<13:54, 21.97s/epoch, loss=0.472, accuracy=0.909, val_loss=0.518, val_accuracy=0.891, lr=0.001] 63%|██████▎   | 63/100 [23:53<13:31, 21.92s/epoch, loss=0.421, accuracy=0.923, val_loss=0.506, val_accuracy=0.895, lr=0.001] 64%|██████▍   | 64/100 [24:14<13:09, 21.92s/epoch, loss=0.4, accuracy=0.931, val_loss=0.492, val_accuracy=0.897, lr=0.001]   65%|██████▌   | 65/100 [24:36<12:45, 21.87s/epoch, loss=0.385, accuracy=0.933, val_loss=0.485, val_accuracy=0.899, lr=0.001] 66%|██████▌   | 66/100 [24:58<12:26, 21.94s/epoch, loss=0.371, accuracy=0.935, val_loss=0.483, val_accuracy=0.898, lr=0.001] 67%|██████▋   | 67/100 [25:20<12:04, 21.94s/epoch, loss=0.359, accuracy=0.938, val_loss=0.485, val_accuracy=0.898, lr=0.001] 68%|██████▊   | 68/100 [25:42<11:41, 21.93s/epoch, loss=0.345, accuracy=0.941, val_loss=0.469, val_accuracy=0.9, lr=0.001]   69%|██████▉   | 69/100 [26:04<11:18, 21.89s/epoch, loss=0.337, accuracy=0.942, val_loss=0.462, val_accuracy=0.905, lr=0.001] 70%|███████   | 70/100 [26:26<10:56, 21.89s/epoch, loss=0.329, accuracy=0.944, val_loss=0.485, val_accuracy=0.895, lr=0.001] 71%|███████   | 71/100 [26:48<10:33, 21.86s/epoch, loss=0.322, accuracy=0.945, val_loss=0.475, val_accuracy=0.896, lr=0.001] 72%|███████▏  | 72/100 [27:10<10:12, 21.88s/epoch, loss=0.311, accuracy=0.947, val_loss=0.468, val_accuracy=0.895, lr=0.001] 73%|███████▎  | 73/100 [27:31<09:50, 21.87s/epoch, loss=0.303, accuracy=0.949, val_loss=0.468, val_accuracy=0.896, lr=0.001] 74%|███████▍  | 74/100 [27:53<09:29, 21.89s/epoch, loss=0.298, accuracy=0.949, val_loss=0.465, val_accuracy=0.899, lr=0.001] 75%|███████▌  | 75/100 [28:15<09:07, 21.89s/epoch, loss=0.287, accuracy=0.951, val_loss=0.463, val_accuracy=0.894, lr=0.001] 76%|███████▌  | 76/100 [28:37<08:45, 21.91s/epoch, loss=0.285, accuracy=0.951, val_loss=0.477, val_accuracy=0.893, lr=0.001] 77%|███████▋  | 77/100 [28:59<08:24, 21.93s/epoch, loss=0.28, accuracy=0.952, val_loss=0.467, val_accuracy=0.89, lr=0.001]   78%|███████▊  | 78/100 [29:21<08:02, 21.94s/epoch, loss=0.275, accuracy=0.953, val_loss=0.442, val_accuracy=0.9, lr=0.001] 79%|███████▉  | 79/100 [29:43<07:40, 21.93s/epoch, loss=0.269, accuracy=0.954, val_loss=0.451, val_accuracy=0.897, lr=0.001] 80%|████████  | 80/100 [30:05<07:18, 21.92s/epoch, loss=0.264, accuracy=0.954, val_loss=0.449, val_accuracy=0.898, lr=0.001] 81%|████████  | 81/100 [30:27<06:56, 21.91s/epoch, loss=0.259, accuracy=0.954, val_loss=0.461, val_accuracy=0.892, lr=0.001] 82%|████████▏ | 82/100 [30:49<06:34, 21.93s/epoch, loss=0.242, accuracy=0.963, val_loss=0.42, val_accuracy=0.906, lr=1e-04]  83%|████████▎ | 83/100 [31:10<06:11, 21.84s/epoch, loss=0.232, accuracy=0.966, val_loss=0.419, val_accuracy=0.906, lr=1e-04] 84%|████████▍ | 84/100 [31:32<05:50, 21.90s/epoch, loss=0.228, accuracy=0.966, val_loss=0.416, val_accuracy=0.906, lr=1e-04] 85%|████████▌ | 85/100 [31:54<05:28, 21.90s/epoch, loss=0.225, accuracy=0.968, val_loss=0.416, val_accuracy=0.908, lr=1e-04] 86%|████████▌ | 86/100 [32:16<05:07, 21.95s/epoch, loss=0.225, accuracy=0.967, val_loss=0.417, val_accuracy=0.908, lr=1e-04] 87%|████████▋ | 87/100 [32:38<04:45, 21.94s/epoch, loss=0.224, accuracy=0.968, val_loss=0.418, val_accuracy=0.908, lr=1e-04] 88%|████████▊ | 88/100 [33:00<04:22, 21.89s/epoch, loss=0.222, accuracy=0.968, val_loss=0.414, val_accuracy=0.908, lr=1e-04] 89%|████████▉ | 89/100 [33:22<04:00, 21.87s/epoch, loss=0.221, accuracy=0.968, val_loss=0.415, val_accuracy=0.908, lr=1e-04] 90%|█████████ | 90/100 [33:44<03:38, 21.87s/epoch, loss=0.217, accuracy=0.97, val_loss=0.416, val_accuracy=0.908, lr=1e-04]  91%|█████████ | 91/100 [34:06<03:16, 21.87s/epoch, loss=0.218, accuracy=0.97, val_loss=0.416, val_accuracy=0.908, lr=1e-04] 92%|█████████▏| 92/100 [34:28<02:55, 21.88s/epoch, loss=0.216, accuracy=0.97, val_loss=0.414, val_accuracy=0.909, lr=5e-5]  93%|█████████▎| 93/100 [34:50<02:33, 21.89s/epoch, loss=0.215, accuracy=0.97, val_loss=0.415, val_accuracy=0.908, lr=5e-5] 94%|█████████▍| 94/100 [35:11<02:11, 21.87s/epoch, loss=0.214, accuracy=0.971, val_loss=0.414, val_accuracy=0.909, lr=5e-5] 95%|█████████▌| 95/100 [35:33<01:49, 21.84s/epoch, loss=0.211, accuracy=0.972, val_loss=0.412, val_accuracy=0.908, lr=5e-5] 96%|█████████▌| 96/100 [35:55<01:27, 21.84s/epoch, loss=0.211, accuracy=0.972, val_loss=0.414, val_accuracy=0.908, lr=5e-5] 97%|█████████▋| 97/100 [36:17<01:05, 21.85s/epoch, loss=0.21, accuracy=0.973, val_loss=0.413, val_accuracy=0.908, lr=5e-5]  98%|█████████▊| 98/100 [36:39<00:43, 21.84s/epoch, loss=0.212, accuracy=0.972, val_loss=0.413, val_accuracy=0.908, lr=5e-5] 99%|█████████▉| 99/100 [37:01<00:21, 21.88s/epoch, loss=0.208, accuracy=0.973, val_loss=0.413, val_accuracy=0.907, lr=5e-5]100%|██████████| 100/100 [37:23<00:00, 21.93s/epoch, loss=0.211, accuracy=0.972, val_loss=0.413, val_accuracy=0.909, lr=5e-5]100%|██████████| 100/100 [37:23<00:00, 22.43s/epoch, loss=0.211, accuracy=0.972, val_loss=0.413, val_accuracy=0.909, lr=5e-5]
Using real-time data augmentation.
Only one model saved

Loading model: 15_09_cifar10_ResNet20v1.h5
Test score: 0.41266295313835144
Test accuracy: 0.9086999893188477


* * * Run SGD for ID = 15_10. * * *


2024-03-13 08:16:39.963295: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 08:16:53.149946: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 08:16:53.151143: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-13 08:16:53.193278: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-13 08:16:53.193333: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 08:16:53.307674: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 08:16:53.307718: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 08:16:53.312002: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 08:16:53.314286: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 08:16:53.318243: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 08:16:53.321083: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 08:16:53.327794: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 08:16:53.328409: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 08:16:53.328489: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 08:16:54.835587: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-13 08:16:54.836677: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 08:16:54.837137: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-13 08:16:54.837169: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 08:16:54.837203: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 08:16:54.837220: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 08:16:54.837236: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 08:16:54.837252: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 08:16:54.837268: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 08:16:54.837284: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 08:16:54.837300: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 08:16:54.837779: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 08:16:54.837818: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 08:16:55.548277: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-13 08:16:55.548338: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-13 08:16:55.548349: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-13 08:16:55.549777: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:02:00.0, compute capability: 6.1)
{'id': '15_10', 'seed': 10, 'out_folder': 'results/epoch_budget_2', 'batch_size': 128, 'epochs': 100, 'validation_split': 0.0, 'checkpointing': False, 'checkpoint_every': -1, 'hold_out_validation_split': 0.0, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'num_classes': 10, 'SSE_lr': False, 'test_time_augmentation': False, 'debug': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
y_train shape: (50000, 10)
x_val shape: (10000, 32, 32, 3)
y_val shape: (10000, 10)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/100 [00:00<?, ?epoch/s]2024-03-13 08:16:56.255660: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-13 08:16:56.268179: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199825000 Hz
2024-03-13 08:16:58.446180: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 08:16:58.704322: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 08:16:59.594533: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-13 08:16:59.638356: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/100 [00:55<1:32:07, 55.84s/epoch, loss=2.89, accuracy=0.376, val_loss=2.82, val_accuracy=0.262, lr=0.1]  2%|▏         | 2/100 [01:18<59:30, 36.44s/epoch, loss=1.52, accuracy=0.572, val_loss=2.28, val_accuracy=0.386, lr=0.1]    3%|▎         | 3/100 [01:40<48:27, 29.97s/epoch, loss=1.33, accuracy=0.656, val_loss=3.06, val_accuracy=0.314, lr=0.1]  4%|▍         | 4/100 [02:03<43:03, 26.91s/epoch, loss=1.28, accuracy=0.691, val_loss=2.01, val_accuracy=0.477, lr=0.1]  5%|▌         | 5/100 [02:25<39:58, 25.25s/epoch, loss=1.25, accuracy=0.705, val_loss=1.48, val_accuracy=0.623, lr=0.1]  6%|▌         | 6/100 [02:47<38:03, 24.29s/epoch, loss=1.23, accuracy=0.717, val_loss=3.47, val_accuracy=0.328, lr=0.1]  7%|▋         | 7/100 [03:10<36:32, 23.58s/epoch, loss=1.21, accuracy=0.722, val_loss=1.93, val_accuracy=0.556, lr=0.1]  8%|▊         | 8/100 [03:32<35:32, 23.18s/epoch, loss=1.2, accuracy=0.726, val_loss=1.91, val_accuracy=0.49, lr=0.1]    9%|▉         | 9/100 [03:54<34:41, 22.88s/epoch, loss=1.2, accuracy=0.728, val_loss=1.66, val_accuracy=0.56, lr=0.1] 10%|█         | 10/100 [04:16<33:59, 22.66s/epoch, loss=1.19, accuracy=0.733, val_loss=2.2, val_accuracy=0.47, lr=0.1] 11%|█         | 11/100 [04:38<33:22, 22.51s/epoch, loss=1.19, accuracy=0.735, val_loss=2.26, val_accuracy=0.458, lr=0.1] 12%|█▏        | 12/100 [05:01<32:53, 22.42s/epoch, loss=1.18, accuracy=0.739, val_loss=2, val_accuracy=0.553, lr=0.1]    13%|█▎        | 13/100 [05:23<32:26, 22.37s/epoch, loss=1.17, accuracy=0.741, val_loss=4.42, val_accuracy=0.186, lr=0.1] 14%|█▍        | 14/100 [05:45<32:01, 22.34s/epoch, loss=1.17, accuracy=0.743, val_loss=2.25, val_accuracy=0.423, lr=0.1] 15%|█▌        | 15/100 [06:07<31:36, 22.31s/epoch, loss=1.17, accuracy=0.743, val_loss=4.15, val_accuracy=0.344, lr=0.1] 16%|█▌        | 16/100 [06:30<31:12, 22.29s/epoch, loss=1.17, accuracy=0.744, val_loss=1.64, val_accuracy=0.573, lr=0.1] 17%|█▋        | 17/100 [06:52<30:50, 22.30s/epoch, loss=1.17, accuracy=0.744, val_loss=2.43, val_accuracy=0.405, lr=0.1] 18%|█▊        | 18/100 [07:14<30:26, 22.27s/epoch, loss=1.17, accuracy=0.745, val_loss=1.69, val_accuracy=0.586, lr=0.1] 19%|█▉        | 19/100 [07:36<30:00, 22.23s/epoch, loss=1.16, accuracy=0.748, val_loss=2.32, val_accuracy=0.458, lr=0.1] 20%|██        | 20/100 [07:59<29:37, 22.22s/epoch, loss=1.16, accuracy=0.75, val_loss=2.39, val_accuracy=0.448, lr=0.1]  21%|██        | 21/100 [08:21<29:18, 22.25s/epoch, loss=1.16, accuracy=0.75, val_loss=5.14, val_accuracy=0.238, lr=0.1] 22%|██▏       | 22/100 [08:43<29:02, 22.34s/epoch, loss=1.15, accuracy=0.748, val_loss=2.53, val_accuracy=0.386, lr=0.1] 23%|██▎       | 23/100 [09:06<28:44, 22.39s/epoch, loss=1.15, accuracy=0.751, val_loss=1.55, val_accuracy=0.622, lr=0.1] 24%|██▍       | 24/100 [09:28<28:24, 22.43s/epoch, loss=1.15, accuracy=0.749, val_loss=1.87, val_accuracy=0.572, lr=0.1] 25%|██▌       | 25/100 [09:51<27:56, 22.35s/epoch, loss=1.16, accuracy=0.75, val_loss=2.72, val_accuracy=0.371, lr=0.1]  26%|██▌       | 26/100 [10:13<27:32, 22.34s/epoch, loss=1.16, accuracy=0.748, val_loss=1.45, val_accuracy=0.658, lr=0.1] 27%|██▋       | 27/100 [10:35<27:07, 22.29s/epoch, loss=1.15, accuracy=0.751, val_loss=2.76, val_accuracy=0.39, lr=0.1]  28%|██▊       | 28/100 [10:57<26:45, 22.30s/epoch, loss=1.15, accuracy=0.752, val_loss=1.85, val_accuracy=0.567, lr=0.1] 29%|██▉       | 29/100 [11:20<26:23, 22.30s/epoch, loss=1.15, accuracy=0.751, val_loss=1.81, val_accuracy=0.55, lr=0.1]  30%|███       | 30/100 [11:42<25:59, 22.27s/epoch, loss=1.15, accuracy=0.752, val_loss=2.43, val_accuracy=0.438, lr=0.1] 31%|███       | 31/100 [12:04<25:36, 22.27s/epoch, loss=1.14, accuracy=0.753, val_loss=1.67, val_accuracy=0.554, lr=0.1] 32%|███▏      | 32/100 [12:26<25:13, 22.26s/epoch, loss=1.14, accuracy=0.752, val_loss=1.91, val_accuracy=0.518, lr=0.1] 33%|███▎      | 33/100 [12:48<24:48, 22.22s/epoch, loss=1.14, accuracy=0.755, val_loss=1.52, val_accuracy=0.64, lr=0.1]  34%|███▍      | 34/100 [13:11<24:29, 22.27s/epoch, loss=1.15, accuracy=0.752, val_loss=2.4, val_accuracy=0.367, lr=0.1] 35%|███▌      | 35/100 [13:33<24:06, 22.26s/epoch, loss=1.15, accuracy=0.755, val_loss=3.02, val_accuracy=0.458, lr=0.1] 36%|███▌      | 36/100 [13:55<23:43, 22.24s/epoch, loss=1.14, accuracy=0.756, val_loss=1.49, val_accuracy=0.646, lr=0.1] 37%|███▋      | 37/100 [14:18<23:21, 22.24s/epoch, loss=1.14, accuracy=0.754, val_loss=2.23, val_accuracy=0.446, lr=0.1] 38%|███▊      | 38/100 [14:40<22:57, 22.22s/epoch, loss=1.14, accuracy=0.753, val_loss=1.97, val_accuracy=0.554, lr=0.1] 39%|███▉      | 39/100 [15:02<22:34, 22.21s/epoch, loss=1.15, accuracy=0.755, val_loss=1.95, val_accuracy=0.597, lr=0.1] 40%|████      | 40/100 [15:24<22:12, 22.20s/epoch, loss=1.14, accuracy=0.754, val_loss=1.96, val_accuracy=0.5, lr=0.1]   41%|████      | 41/100 [15:46<21:50, 22.22s/epoch, loss=1.14, accuracy=0.755, val_loss=1.63, val_accuracy=0.599, lr=0.1] 42%|████▏     | 42/100 [16:09<21:30, 22.25s/epoch, loss=0.92, accuracy=0.819, val_loss=0.984, val_accuracy=0.777, lr=0.01] 43%|████▎     | 43/100 [16:31<21:09, 22.27s/epoch, loss=0.736, accuracy=0.851, val_loss=0.846, val_accuracy=0.797, lr=0.01] 44%|████▍     | 44/100 [16:53<20:47, 22.28s/epoch, loss=0.653, accuracy=0.857, val_loss=0.798, val_accuracy=0.803, lr=0.01] 45%|████▌     | 45/100 [17:16<20:25, 22.29s/epoch, loss=0.611, accuracy=0.86, val_loss=0.816, val_accuracy=0.791, lr=0.01]  46%|████▌     | 46/100 [17:38<20:03, 22.29s/epoch, loss=0.588, accuracy=0.862, val_loss=1.02, val_accuracy=0.742, lr=0.01] 47%|████▋     | 47/100 [18:00<19:42, 22.31s/epoch, loss=0.574, accuracy=0.864, val_loss=0.75, val_accuracy=0.809, lr=0.01] 48%|████▊     | 48/100 [18:23<19:24, 22.39s/epoch, loss=0.565, accuracy=0.867, val_loss=0.846, val_accuracy=0.78, lr=0.01] 49%|████▉     | 49/100 [18:45<19:01, 22.39s/epoch, loss=0.565, accuracy=0.866, val_loss=0.771, val_accuracy=0.8, lr=0.01]  50%|█████     | 50/100 [19:08<18:39, 22.39s/epoch, loss=0.561, accuracy=0.869, val_loss=0.924, val_accuracy=0.776, lr=0.01] 51%|█████     | 51/100 [19:30<18:16, 22.37s/epoch, loss=0.561, accuracy=0.87, val_loss=0.818, val_accuracy=0.791, lr=0.01]  52%|█████▏    | 52/100 [19:52<17:50, 22.29s/epoch, loss=0.564, accuracy=0.87, val_loss=0.846, val_accuracy=0.779, lr=0.01] 53%|█████▎    | 53/100 [20:14<17:26, 22.27s/epoch, loss=0.556, accuracy=0.874, val_loss=0.917, val_accuracy=0.772, lr=0.01] 54%|█████▍    | 54/100 [20:37<17:05, 22.30s/epoch, loss=0.555, accuracy=0.877, val_loss=0.746, val_accuracy=0.817, lr=0.01] 55%|█████▌    | 55/100 [20:59<16:42, 22.28s/epoch, loss=0.553, accuracy=0.877, val_loss=0.983, val_accuracy=0.747, lr=0.01] 56%|█████▌    | 56/100 [21:21<16:21, 22.30s/epoch, loss=0.557, accuracy=0.877, val_loss=0.744, val_accuracy=0.817, lr=0.01] 57%|█████▋    | 57/100 [21:44<15:58, 22.30s/epoch, loss=0.556, accuracy=0.878, val_loss=1.07, val_accuracy=0.715, lr=0.01]  58%|█████▊    | 58/100 [22:06<15:36, 22.30s/epoch, loss=0.559, accuracy=0.878, val_loss=0.845, val_accuracy=0.791, lr=0.01] 59%|█████▉    | 59/100 [22:28<15:12, 22.24s/epoch, loss=0.557, accuracy=0.88, val_loss=0.965, val_accuracy=0.74, lr=0.01]   60%|██████    | 60/100 [22:50<14:50, 22.26s/epoch, loss=0.555, accuracy=0.881, val_loss=0.766, val_accuracy=0.81, lr=0.01] 61%|██████    | 61/100 [23:13<14:28, 22.26s/epoch, loss=0.554, accuracy=0.883, val_loss=0.891, val_accuracy=0.784, lr=0.01] 62%|██████▏   | 62/100 [23:35<14:03, 22.21s/epoch, loss=0.482, accuracy=0.908, val_loss=0.532, val_accuracy=0.89, lr=0.001] 63%|██████▎   | 63/100 [23:57<13:40, 22.17s/epoch, loss=0.43, accuracy=0.923, val_loss=0.514, val_accuracy=0.892, lr=0.001] 64%|██████▍   | 64/100 [24:19<13:17, 22.16s/epoch, loss=0.408, accuracy=0.929, val_loss=0.506, val_accuracy=0.894, lr=0.001] 65%|██████▌   | 65/100 [24:41<12:54, 22.13s/epoch, loss=0.391, accuracy=0.934, val_loss=0.505, val_accuracy=0.892, lr=0.001] 66%|██████▌   | 66/100 [25:03<12:33, 22.15s/epoch, loss=0.376, accuracy=0.937, val_loss=0.487, val_accuracy=0.899, lr=0.001] 67%|██████▋   | 67/100 [25:25<12:11, 22.15s/epoch, loss=0.363, accuracy=0.94, val_loss=0.485, val_accuracy=0.897, lr=0.001]  68%|██████▊   | 68/100 [25:47<11:49, 22.17s/epoch, loss=0.354, accuracy=0.941, val_loss=0.48, val_accuracy=0.895, lr=0.001] 69%|██████▉   | 69/100 [26:09<11:25, 22.12s/epoch, loss=0.343, accuracy=0.943, val_loss=0.475, val_accuracy=0.898, lr=0.001] 70%|███████   | 70/100 [26:31<11:02, 22.08s/epoch, loss=0.334, accuracy=0.945, val_loss=0.48, val_accuracy=0.895, lr=0.001]  71%|███████   | 71/100 [26:54<10:40, 22.09s/epoch, loss=0.326, accuracy=0.945, val_loss=0.487, val_accuracy=0.895, lr=0.001] 72%|███████▏  | 72/100 [27:16<10:18, 22.08s/epoch, loss=0.319, accuracy=0.946, val_loss=0.459, val_accuracy=0.902, lr=0.001] 73%|███████▎  | 73/100 [27:38<09:55, 22.04s/epoch, loss=0.309, accuracy=0.949, val_loss=0.479, val_accuracy=0.895, lr=0.001] 74%|███████▍  | 74/100 [28:00<09:33, 22.05s/epoch, loss=0.302, accuracy=0.95, val_loss=0.466, val_accuracy=0.897, lr=0.001]  75%|███████▌  | 75/100 [28:22<09:11, 22.07s/epoch, loss=0.297, accuracy=0.95, val_loss=0.459, val_accuracy=0.899, lr=0.001] 76%|███████▌  | 76/100 [28:44<08:50, 22.10s/epoch, loss=0.287, accuracy=0.953, val_loss=0.455, val_accuracy=0.898, lr=0.001] 77%|███████▋  | 77/100 [29:06<08:28, 22.11s/epoch, loss=0.282, accuracy=0.953, val_loss=0.464, val_accuracy=0.894, lr=0.001] 78%|███████▊  | 78/100 [29:28<08:05, 22.08s/epoch, loss=0.277, accuracy=0.954, val_loss=0.455, val_accuracy=0.895, lr=0.001] 79%|███████▉  | 79/100 [29:50<07:43, 22.06s/epoch, loss=0.272, accuracy=0.955, val_loss=0.449, val_accuracy=0.897, lr=0.001] 80%|████████  | 80/100 [30:12<07:20, 22.03s/epoch, loss=0.268, accuracy=0.956, val_loss=0.467, val_accuracy=0.892, lr=0.001] 81%|████████  | 81/100 [30:34<06:58, 22.01s/epoch, loss=0.263, accuracy=0.956, val_loss=0.454, val_accuracy=0.899, lr=0.001] 82%|████████▏ | 82/100 [30:56<06:36, 22.01s/epoch, loss=0.245, accuracy=0.962, val_loss=0.422, val_accuracy=0.906, lr=1e-04] 83%|████████▎ | 83/100 [31:18<06:14, 22.02s/epoch, loss=0.239, accuracy=0.966, val_loss=0.42, val_accuracy=0.906, lr=1e-04]  84%|████████▍ | 84/100 [31:40<05:52, 22.05s/epoch, loss=0.233, accuracy=0.967, val_loss=0.417, val_accuracy=0.906, lr=1e-04] 85%|████████▌ | 85/100 [32:02<05:30, 22.04s/epoch, loss=0.232, accuracy=0.967, val_loss=0.419, val_accuracy=0.906, lr=1e-04] 86%|████████▌ | 86/100 [32:24<05:08, 22.01s/epoch, loss=0.229, accuracy=0.969, val_loss=0.417, val_accuracy=0.908, lr=1e-04] 87%|████████▋ | 87/100 [32:46<04:45, 21.99s/epoch, loss=0.227, accuracy=0.969, val_loss=0.417, val_accuracy=0.908, lr=1e-04] 88%|████████▊ | 88/100 [33:08<04:24, 22.02s/epoch, loss=0.227, accuracy=0.968, val_loss=0.417, val_accuracy=0.906, lr=1e-04] 89%|████████▉ | 89/100 [33:30<04:02, 22.04s/epoch, loss=0.225, accuracy=0.969, val_loss=0.417, val_accuracy=0.907, lr=1e-04] 90%|█████████ | 90/100 [33:52<03:40, 22.03s/epoch, loss=0.222, accuracy=0.971, val_loss=0.414, val_accuracy=0.907, lr=1e-04] 91%|█████████ | 91/100 [34:14<03:18, 22.01s/epoch, loss=0.223, accuracy=0.969, val_loss=0.414, val_accuracy=0.907, lr=1e-04] 92%|█████████▏| 92/100 [34:36<02:56, 22.02s/epoch, loss=0.219, accuracy=0.971, val_loss=0.414, val_accuracy=0.909, lr=5e-5]  93%|█████████▎| 93/100 [34:58<02:33, 21.98s/epoch, loss=0.219, accuracy=0.972, val_loss=0.414, val_accuracy=0.909, lr=5e-5] 94%|█████████▍| 94/100 [35:20<02:11, 21.97s/epoch, loss=0.218, accuracy=0.971, val_loss=0.414, val_accuracy=0.908, lr=5e-5] 95%|█████████▌| 95/100 [35:42<01:49, 21.92s/epoch, loss=0.219, accuracy=0.971, val_loss=0.413, val_accuracy=0.909, lr=5e-5] 96%|█████████▌| 96/100 [36:04<01:27, 21.93s/epoch, loss=0.217, accuracy=0.971, val_loss=0.414, val_accuracy=0.909, lr=5e-5] 97%|█████████▋| 97/100 [36:26<01:05, 21.90s/epoch, loss=0.217, accuracy=0.972, val_loss=0.414, val_accuracy=0.908, lr=5e-5] 98%|█████████▊| 98/100 [36:48<00:43, 21.91s/epoch, loss=0.216, accuracy=0.973, val_loss=0.415, val_accuracy=0.909, lr=5e-5] 99%|█████████▉| 99/100 [37:10<00:21, 21.96s/epoch, loss=0.215, accuracy=0.972, val_loss=0.414, val_accuracy=0.909, lr=5e-5]100%|██████████| 100/100 [37:32<00:00, 21.95s/epoch, loss=0.216, accuracy=0.972, val_loss=0.413, val_accuracy=0.908, lr=5e-5]100%|██████████| 100/100 [37:32<00:00, 22.52s/epoch, loss=0.216, accuracy=0.972, val_loss=0.413, val_accuracy=0.908, lr=5e-5]
Using real-time data augmentation.
Only one model saved

Loading model: 15_10_cifar10_ResNet20v1.h5
Test score: 0.4130769968032837
Test accuracy: 0.9083999991416931


* * * Run SGD for ID = 15_11. * * *


2024-03-13 08:54:32.383870: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 08:54:34.913692: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 08:54:34.914734: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-13 08:54:34.954634: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-13 08:54:34.954666: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 08:54:34.957455: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 08:54:34.957498: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 08:54:34.959761: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 08:54:34.960826: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 08:54:34.963197: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 08:54:34.964618: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 08:54:34.969470: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 08:54:34.969995: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 08:54:34.970100: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 08:54:36.299502: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-13 08:54:36.300605: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 08:54:36.301479: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-13 08:54:36.301518: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 08:54:36.301555: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 08:54:36.301574: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 08:54:36.301593: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 08:54:36.301610: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 08:54:36.301626: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 08:54:36.301642: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 08:54:36.301659: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 08:54:36.302124: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 08:54:36.302164: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 08:54:36.989123: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-13 08:54:36.989180: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-13 08:54:36.989190: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-13 08:54:36.990149: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:02:00.0, compute capability: 6.1)
{'id': '15_11', 'seed': 11, 'out_folder': 'results/epoch_budget_2', 'batch_size': 128, 'epochs': 100, 'validation_split': 0.0, 'checkpointing': False, 'checkpoint_every': -1, 'hold_out_validation_split': 0.0, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'num_classes': 10, 'SSE_lr': False, 'test_time_augmentation': False, 'debug': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
y_train shape: (50000, 10)
x_val shape: (10000, 32, 32, 3)
y_val shape: (10000, 10)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/100 [00:00<?, ?epoch/s]2024-03-13 08:54:37.665028: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-13 08:54:37.677185: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199825000 Hz
2024-03-13 08:54:39.838603: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 08:54:40.083909: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 08:54:40.811689: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-13 08:54:40.859518: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/100 [00:56<1:33:17, 56.54s/epoch, loss=2.77, accuracy=0.414, val_loss=2.11, val_accuracy=0.354, lr=0.1]  2%|▏         | 2/100 [01:19<1:00:27, 37.02s/epoch, loss=1.43, accuracy=0.608, val_loss=2.69, val_accuracy=0.42, lr=0.1]   3%|▎         | 3/100 [01:43<49:37, 30.70s/epoch, loss=1.28, accuracy=0.676, val_loss=2.5, val_accuracy=0.377, lr=0.1]    4%|▍         | 4/100 [02:06<44:16, 27.67s/epoch, loss=1.25, accuracy=0.701, val_loss=2.01, val_accuracy=0.543, lr=0.1]  5%|▌         | 5/100 [02:29<41:06, 25.97s/epoch, loss=1.23, accuracy=0.71, val_loss=2.29, val_accuracy=0.335, lr=0.1]   6%|▌         | 6/100 [02:52<39:07, 24.97s/epoch, loss=1.22, accuracy=0.72, val_loss=2.9, val_accuracy=0.391, lr=0.1]   7%|▋         | 7/100 [03:14<37:38, 24.28s/epoch, loss=1.21, accuracy=0.726, val_loss=6.7, val_accuracy=0.214, lr=0.1]  8%|▊         | 8/100 [03:37<36:35, 23.86s/epoch, loss=1.2, accuracy=0.727, val_loss=1.8, val_accuracy=0.539, lr=0.1]   9%|▉         | 9/100 [04:00<35:45, 23.58s/epoch, loss=1.2, accuracy=0.729, val_loss=1.93, val_accuracy=0.482, lr=0.1] 10%|█         | 10/100 [04:23<35:06, 23.41s/epoch, loss=1.19, accuracy=0.733, val_loss=3.22, val_accuracy=0.37, lr=0.1] 11%|█         | 11/100 [04:46<34:31, 23.28s/epoch, loss=1.19, accuracy=0.736, val_loss=1.5, val_accuracy=0.642, lr=0.1] 12%|█▏        | 12/100 [05:09<33:59, 23.17s/epoch, loss=1.18, accuracy=0.74, val_loss=2.3, val_accuracy=0.488, lr=0.1]  13%|█▎        | 13/100 [05:32<33:29, 23.09s/epoch, loss=1.18, accuracy=0.739, val_loss=3.03, val_accuracy=0.234, lr=0.1] 14%|█▍        | 14/100 [05:55<33:01, 23.05s/epoch, loss=1.18, accuracy=0.74, val_loss=3.37, val_accuracy=0.388, lr=0.1]  15%|█▌        | 15/100 [06:18<32:37, 23.03s/epoch, loss=1.18, accuracy=0.739, val_loss=1.93, val_accuracy=0.525, lr=0.1] 16%|█▌        | 16/100 [06:41<32:15, 23.04s/epoch, loss=1.18, accuracy=0.742, val_loss=1.57, val_accuracy=0.592, lr=0.1] 17%|█▋        | 17/100 [07:04<31:46, 22.97s/epoch, loss=1.17, accuracy=0.745, val_loss=2.4, val_accuracy=0.491, lr=0.1]  18%|█▊        | 18/100 [07:27<31:21, 22.94s/epoch, loss=1.17, accuracy=0.744, val_loss=2.25, val_accuracy=0.429, lr=0.1] 19%|█▉        | 19/100 [07:50<30:59, 22.96s/epoch, loss=1.17, accuracy=0.744, val_loss=1.73, val_accuracy=0.595, lr=0.1] 20%|██        | 20/100 [08:13<30:37, 22.97s/epoch, loss=1.17, accuracy=0.744, val_loss=1.82, val_accuracy=0.501, lr=0.1] 21%|██        | 21/100 [08:36<30:15, 22.98s/epoch, loss=1.17, accuracy=0.746, val_loss=2.3, val_accuracy=0.423, lr=0.1]  22%|██▏       | 22/100 [08:59<29:52, 22.98s/epoch, loss=1.16, accuracy=0.748, val_loss=2.71, val_accuracy=0.32, lr=0.1] 23%|██▎       | 23/100 [09:22<29:31, 23.01s/epoch, loss=1.15, accuracy=0.749, val_loss=1.71, val_accuracy=0.576, lr=0.1] 24%|██▍       | 24/100 [09:45<29:09, 23.02s/epoch, loss=1.15, accuracy=0.751, val_loss=1.77, val_accuracy=0.559, lr=0.1] 25%|██▌       | 25/100 [10:08<28:47, 23.03s/epoch, loss=1.16, accuracy=0.749, val_loss=1.83, val_accuracy=0.607, lr=0.1] 26%|██▌       | 26/100 [10:31<28:25, 23.05s/epoch, loss=1.15, accuracy=0.753, val_loss=1.76, val_accuracy=0.528, lr=0.1] 27%|██▋       | 27/100 [10:54<27:58, 22.99s/epoch, loss=1.15, accuracy=0.751, val_loss=5.85, val_accuracy=0.206, lr=0.1] 28%|██▊       | 28/100 [11:17<27:34, 22.98s/epoch, loss=1.14, accuracy=0.75, val_loss=2.44, val_accuracy=0.445, lr=0.1]  29%|██▉       | 29/100 [11:40<27:11, 22.98s/epoch, loss=1.14, accuracy=0.752, val_loss=1.75, val_accuracy=0.568, lr=0.1] 30%|███       | 30/100 [12:03<26:49, 22.99s/epoch, loss=1.14, accuracy=0.752, val_loss=5.67, val_accuracy=0.267, lr=0.1] 31%|███       | 31/100 [12:26<26:24, 22.96s/epoch, loss=1.14, accuracy=0.752, val_loss=2.31, val_accuracy=0.371, lr=0.1] 32%|███▏      | 32/100 [12:49<25:59, 22.94s/epoch, loss=1.13, accuracy=0.751, val_loss=1.82, val_accuracy=0.487, lr=0.1] 33%|███▎      | 33/100 [13:12<25:36, 22.94s/epoch, loss=1.14, accuracy=0.749, val_loss=1.82, val_accuracy=0.538, lr=0.1] 34%|███▍      | 34/100 [13:35<25:15, 22.96s/epoch, loss=1.14, accuracy=0.753, val_loss=2, val_accuracy=0.491, lr=0.1]    35%|███▌      | 35/100 [13:57<24:48, 22.90s/epoch, loss=1.13, accuracy=0.754, val_loss=1.89, val_accuracy=0.505, lr=0.1] 36%|███▌      | 36/100 [14:20<24:27, 22.93s/epoch, loss=1.12, accuracy=0.754, val_loss=2.48, val_accuracy=0.442, lr=0.1] 37%|███▋      | 37/100 [14:43<24:05, 22.95s/epoch, loss=1.13, accuracy=0.754, val_loss=1.63, val_accuracy=0.58, lr=0.1]  38%|███▊      | 38/100 [15:06<23:43, 22.97s/epoch, loss=1.13, accuracy=0.751, val_loss=2.18, val_accuracy=0.419, lr=0.1] 39%|███▉      | 39/100 [15:29<23:20, 22.96s/epoch, loss=1.13, accuracy=0.754, val_loss=1.83, val_accuracy=0.546, lr=0.1] 40%|████      | 40/100 [15:52<22:53, 22.89s/epoch, loss=1.12, accuracy=0.756, val_loss=2.29, val_accuracy=0.404, lr=0.1] 41%|████      | 41/100 [16:15<22:32, 22.93s/epoch, loss=1.12, accuracy=0.755, val_loss=2.61, val_accuracy=0.441, lr=0.1] 42%|████▏     | 42/100 [16:38<22:08, 22.91s/epoch, loss=0.906, accuracy=0.819, val_loss=0.892, val_accuracy=0.805, lr=0.01] 43%|████▎     | 43/100 [17:01<21:47, 22.93s/epoch, loss=0.731, accuracy=0.848, val_loss=0.866, val_accuracy=0.792, lr=0.01] 44%|████▍     | 44/100 [17:24<21:24, 22.93s/epoch, loss=0.65, accuracy=0.857, val_loss=0.758, val_accuracy=0.811, lr=0.01]  45%|████▌     | 45/100 [17:47<21:02, 22.96s/epoch, loss=0.609, accuracy=0.859, val_loss=0.727, val_accuracy=0.82, lr=0.01] 46%|████▌     | 46/100 [18:10<20:40, 22.97s/epoch, loss=0.584, accuracy=0.861, val_loss=0.795, val_accuracy=0.794, lr=0.01] 47%|████▋     | 47/100 [18:33<20:17, 22.98s/epoch, loss=0.575, accuracy=0.863, val_loss=0.948, val_accuracy=0.747, lr=0.01] 48%|████▊     | 48/100 [18:56<19:53, 22.95s/epoch, loss=0.572, accuracy=0.864, val_loss=0.802, val_accuracy=0.795, lr=0.01] 49%|████▉     | 49/100 [19:19<19:29, 22.92s/epoch, loss=0.567, accuracy=0.866, val_loss=1.02, val_accuracy=0.721, lr=0.01]  50%|█████     | 50/100 [19:42<19:07, 22.94s/epoch, loss=0.56, accuracy=0.87, val_loss=0.82, val_accuracy=0.791, lr=0.01]   51%|█████     | 51/100 [20:05<18:43, 22.92s/epoch, loss=0.562, accuracy=0.869, val_loss=0.775, val_accuracy=0.802, lr=0.01] 52%|█████▏    | 52/100 [20:27<18:20, 22.93s/epoch, loss=0.564, accuracy=0.869, val_loss=0.815, val_accuracy=0.797, lr=0.01] 53%|█████▎    | 53/100 [20:51<17:58, 22.96s/epoch, loss=0.56, accuracy=0.871, val_loss=0.764, val_accuracy=0.807, lr=0.01]  54%|█████▍    | 54/100 [21:14<17:37, 22.98s/epoch, loss=0.56, accuracy=0.871, val_loss=0.817, val_accuracy=0.796, lr=0.01] 55%|█████▌    | 55/100 [21:36<17:12, 22.95s/epoch, loss=0.559, accuracy=0.875, val_loss=0.669, val_accuracy=0.842, lr=0.01] 56%|█████▌    | 56/100 [21:59<16:49, 22.95s/epoch, loss=0.555, accuracy=0.875, val_loss=1.11, val_accuracy=0.705, lr=0.01]  57%|█████▋    | 57/100 [22:22<16:26, 22.94s/epoch, loss=0.557, accuracy=0.877, val_loss=0.763, val_accuracy=0.813, lr=0.01] 58%|█████▊    | 58/100 [22:45<16:04, 22.95s/epoch, loss=0.555, accuracy=0.879, val_loss=0.791, val_accuracy=0.807, lr=0.01] 59%|█████▉    | 59/100 [23:08<15:41, 22.96s/epoch, loss=0.553, accuracy=0.878, val_loss=0.873, val_accuracy=0.784, lr=0.01] 60%|██████    | 60/100 [23:31<15:20, 23.01s/epoch, loss=0.556, accuracy=0.878, val_loss=0.829, val_accuracy=0.798, lr=0.01] 61%|██████    | 61/100 [23:54<14:57, 23.02s/epoch, loss=0.553, accuracy=0.88, val_loss=0.72, val_accuracy=0.826, lr=0.01]   62%|██████▏   | 62/100 [24:18<14:35, 23.04s/epoch, loss=0.477, accuracy=0.907, val_loss=0.531, val_accuracy=0.888, lr=0.001] 63%|██████▎   | 63/100 [24:40<14:10, 22.98s/epoch, loss=0.428, accuracy=0.922, val_loss=0.515, val_accuracy=0.892, lr=0.001] 64%|██████▍   | 64/100 [25:03<13:45, 22.94s/epoch, loss=0.406, accuracy=0.928, val_loss=0.507, val_accuracy=0.894, lr=0.001] 65%|██████▌   | 65/100 [25:26<13:21, 22.91s/epoch, loss=0.388, accuracy=0.934, val_loss=0.495, val_accuracy=0.896, lr=0.001] 66%|██████▌   | 66/100 [25:49<12:58, 22.91s/epoch, loss=0.377, accuracy=0.935, val_loss=0.5, val_accuracy=0.894, lr=0.001]   67%|██████▋   | 67/100 [26:12<12:36, 22.91s/epoch, loss=0.363, accuracy=0.939, val_loss=0.495, val_accuracy=0.896, lr=0.001] 68%|██████▊   | 68/100 [26:35<12:12, 22.91s/epoch, loss=0.356, accuracy=0.939, val_loss=0.479, val_accuracy=0.896, lr=0.001] 69%|██████▉   | 69/100 [26:58<11:49, 22.90s/epoch, loss=0.344, accuracy=0.941, val_loss=0.479, val_accuracy=0.898, lr=0.001] 70%|███████   | 70/100 [27:21<11:28, 22.95s/epoch, loss=0.332, accuracy=0.943, val_loss=0.483, val_accuracy=0.894, lr=0.001] 71%|███████   | 71/100 [27:44<11:04, 22.93s/epoch, loss=0.325, accuracy=0.945, val_loss=0.467, val_accuracy=0.896, lr=0.001] 72%|███████▏  | 72/100 [28:06<10:41, 22.93s/epoch, loss=0.315, accuracy=0.948, val_loss=0.461, val_accuracy=0.897, lr=0.001] 73%|███████▎  | 73/100 [28:29<10:19, 22.93s/epoch, loss=0.307, accuracy=0.948, val_loss=0.48, val_accuracy=0.891, lr=0.001]  74%|███████▍  | 74/100 [28:52<09:55, 22.92s/epoch, loss=0.301, accuracy=0.949, val_loss=0.463, val_accuracy=0.896, lr=0.001] 75%|███████▌  | 75/100 [29:15<09:33, 22.93s/epoch, loss=0.296, accuracy=0.948, val_loss=0.47, val_accuracy=0.892, lr=0.001]  76%|███████▌  | 76/100 [29:38<09:10, 22.95s/epoch, loss=0.287, accuracy=0.952, val_loss=0.474, val_accuracy=0.894, lr=0.001] 77%|███████▋  | 77/100 [30:01<08:47, 22.94s/epoch, loss=0.281, accuracy=0.952, val_loss=0.466, val_accuracy=0.895, lr=0.001] 78%|███████▊  | 78/100 [30:24<08:25, 22.98s/epoch, loss=0.277, accuracy=0.954, val_loss=0.494, val_accuracy=0.888, lr=0.001] 79%|███████▉  | 79/100 [30:47<08:01, 22.95s/epoch, loss=0.27, accuracy=0.954, val_loss=0.487, val_accuracy=0.889, lr=0.001]  80%|████████  | 80/100 [31:10<07:39, 22.96s/epoch, loss=0.265, accuracy=0.955, val_loss=0.468, val_accuracy=0.891, lr=0.001] 81%|████████  | 81/100 [31:33<07:15, 22.94s/epoch, loss=0.262, accuracy=0.955, val_loss=0.48, val_accuracy=0.892, lr=0.001]  82%|████████▏ | 82/100 [31:56<06:51, 22.87s/epoch, loss=0.243, accuracy=0.963, val_loss=0.424, val_accuracy=0.901, lr=1e-04] 83%|████████▎ | 83/100 [32:19<06:28, 22.84s/epoch, loss=0.234, accuracy=0.966, val_loss=0.422, val_accuracy=0.904, lr=1e-04] 84%|████████▍ | 84/100 [32:41<06:05, 22.82s/epoch, loss=0.232, accuracy=0.966, val_loss=0.421, val_accuracy=0.905, lr=1e-04] 85%|████████▌ | 85/100 [33:04<05:41, 22.76s/epoch, loss=0.229, accuracy=0.967, val_loss=0.424, val_accuracy=0.904, lr=1e-04] 86%|████████▌ | 86/100 [33:27<05:18, 22.76s/epoch, loss=0.227, accuracy=0.968, val_loss=0.424, val_accuracy=0.903, lr=1e-04] 87%|████████▋ | 87/100 [33:50<04:56, 22.78s/epoch, loss=0.225, accuracy=0.969, val_loss=0.424, val_accuracy=0.902, lr=1e-04] 88%|████████▊ | 88/100 [34:12<04:33, 22.75s/epoch, loss=0.223, accuracy=0.97, val_loss=0.422, val_accuracy=0.904, lr=1e-04]  89%|████████▉ | 89/100 [34:38<04:20, 23.71s/epoch, loss=0.222, accuracy=0.969, val_loss=0.42, val_accuracy=0.905, lr=1e-04] 90%|█████████ | 90/100 [35:01<03:53, 23.36s/epoch, loss=0.221, accuracy=0.97, val_loss=0.424, val_accuracy=0.903, lr=1e-04] 91%|█████████ | 91/100 [35:23<03:28, 23.15s/epoch, loss=0.22, accuracy=0.97, val_loss=0.422, val_accuracy=0.904, lr=1e-04]  92%|█████████▏| 92/100 [35:46<03:04, 23.02s/epoch, loss=0.217, accuracy=0.971, val_loss=0.424, val_accuracy=0.903, lr=5e-5] 93%|█████████▎| 93/100 [36:09<02:40, 22.93s/epoch, loss=0.217, accuracy=0.971, val_loss=0.424, val_accuracy=0.904, lr=5e-5] 94%|█████████▍| 94/100 [36:31<02:17, 22.83s/epoch, loss=0.216, accuracy=0.971, val_loss=0.424, val_accuracy=0.903, lr=5e-5] 95%|█████████▌| 95/100 [36:54<01:53, 22.78s/epoch, loss=0.216, accuracy=0.972, val_loss=0.424, val_accuracy=0.903, lr=5e-5] 96%|█████████▌| 96/100 [37:17<01:30, 22.73s/epoch, loss=0.213, accuracy=0.972, val_loss=0.423, val_accuracy=0.904, lr=5e-5] 97%|█████████▋| 97/100 [37:39<01:08, 22.73s/epoch, loss=0.214, accuracy=0.972, val_loss=0.424, val_accuracy=0.903, lr=5e-5] 98%|█████████▊| 98/100 [38:02<00:45, 22.71s/epoch, loss=0.212, accuracy=0.973, val_loss=0.423, val_accuracy=0.905, lr=5e-5] 99%|█████████▉| 99/100 [38:25<00:22, 22.71s/epoch, loss=0.213, accuracy=0.972, val_loss=0.425, val_accuracy=0.904, lr=5e-5]100%|██████████| 100/100 [38:47<00:00, 22.71s/epoch, loss=0.212, accuracy=0.972, val_loss=0.424, val_accuracy=0.905, lr=5e-5]100%|██████████| 100/100 [38:47<00:00, 23.28s/epoch, loss=0.212, accuracy=0.972, val_loss=0.424, val_accuracy=0.905, lr=5e-5]
Using real-time data augmentation.
Only one model saved

Loading model: 15_11_cifar10_ResNet20v1.h5
Test score: 0.4238917827606201
Test accuracy: 0.904699981212616


* * * Run SGD for ID = 15_12. * * *


2024-03-13 09:33:29.290323: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 09:33:31.868698: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 09:33:31.869842: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-13 09:33:31.910686: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-13 09:33:31.910717: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 09:33:31.913482: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 09:33:31.913525: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 09:33:31.915814: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 09:33:31.916441: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 09:33:31.918819: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 09:33:31.920271: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 09:33:31.925035: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 09:33:31.925627: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 09:33:31.925705: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 09:33:33.244493: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-13 09:33:33.245076: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 09:33:33.245856: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-13 09:33:33.245889: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 09:33:33.245927: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 09:33:33.245945: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 09:33:33.245962: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 09:33:33.245979: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 09:33:33.245998: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 09:33:33.246017: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 09:33:33.246037: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 09:33:33.246563: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 09:33:33.246595: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 09:33:33.918545: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-13 09:33:33.918601: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-13 09:33:33.918620: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-13 09:33:33.919633: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:02:00.0, compute capability: 6.1)
{'id': '15_12', 'seed': 12, 'out_folder': 'results/epoch_budget_2', 'batch_size': 128, 'epochs': 100, 'validation_split': 0.0, 'checkpointing': False, 'checkpoint_every': -1, 'hold_out_validation_split': 0.0, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'num_classes': 10, 'SSE_lr': False, 'test_time_augmentation': False, 'debug': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
y_train shape: (50000, 10)
x_val shape: (10000, 32, 32, 3)
y_val shape: (10000, 10)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/100 [00:00<?, ?epoch/s]2024-03-13 09:33:34.606612: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-13 09:33:34.619203: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199825000 Hz
2024-03-13 09:33:36.804735: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 09:33:37.089993: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 09:33:37.931647: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-13 09:33:37.991389: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/100 [00:59<1:38:13, 59.53s/epoch, loss=3.03, accuracy=0.337, val_loss=3.79, val_accuracy=0.166, lr=0.1]  2%|▏         | 2/100 [01:22<1:01:42, 37.78s/epoch, loss=1.53, accuracy=0.551, val_loss=2.76, val_accuracy=0.351, lr=0.1]  3%|▎         | 3/100 [01:44<49:53, 30.86s/epoch, loss=1.34, accuracy=0.649, val_loss=1.84, val_accuracy=0.502, lr=0.1]    4%|▍         | 4/100 [02:07<44:06, 27.57s/epoch, loss=1.28, accuracy=0.688, val_loss=2.38, val_accuracy=0.394, lr=0.1]  5%|▌         | 5/100 [02:29<40:47, 25.77s/epoch, loss=1.26, accuracy=0.701, val_loss=1.6, val_accuracy=0.591, lr=0.1]   6%|▌         | 6/100 [02:52<38:35, 24.63s/epoch, loss=1.24, accuracy=0.713, val_loss=3.89, val_accuracy=0.284, lr=0.1]  7%|▋         | 7/100 [03:14<37:06, 23.94s/epoch, loss=1.22, accuracy=0.721, val_loss=2, val_accuracy=0.518, lr=0.1]     8%|▊         | 8/100 [03:37<36:04, 23.53s/epoch, loss=1.21, accuracy=0.724, val_loss=1.96, val_accuracy=0.517, lr=0.1]  9%|▉         | 9/100 [03:59<35:11, 23.20s/epoch, loss=1.2, accuracy=0.727, val_loss=5.47, val_accuracy=0.199, lr=0.1]  10%|█         | 10/100 [04:22<34:31, 23.02s/epoch, loss=1.2, accuracy=0.732, val_loss=1.91, val_accuracy=0.514, lr=0.1] 11%|█         | 11/100 [04:45<33:56, 22.88s/epoch, loss=1.2, accuracy=0.731, val_loss=1.7, val_accuracy=0.593, lr=0.1]  12%|█▏        | 12/100 [05:07<33:20, 22.73s/epoch, loss=1.19, accuracy=0.737, val_loss=1.9, val_accuracy=0.559, lr=0.1] 13%|█▎        | 13/100 [05:29<32:49, 22.63s/epoch, loss=1.18, accuracy=0.736, val_loss=2.25, val_accuracy=0.477, lr=0.1] 14%|█▍        | 14/100 [05:52<32:22, 22.59s/epoch, loss=1.17, accuracy=0.742, val_loss=2.14, val_accuracy=0.469, lr=0.1] 15%|█▌        | 15/100 [06:14<32:01, 22.60s/epoch, loss=1.17, accuracy=0.74, val_loss=2.29, val_accuracy=0.431, lr=0.1]  16%|█▌        | 16/100 [06:37<31:36, 22.57s/epoch, loss=1.17, accuracy=0.741, val_loss=1.87, val_accuracy=0.56, lr=0.1] 17%|█▋        | 17/100 [07:00<31:13, 22.57s/epoch, loss=1.16, accuracy=0.742, val_loss=2.4, val_accuracy=0.407, lr=0.1] 18%|█▊        | 18/100 [07:22<30:54, 22.62s/epoch, loss=1.17, accuracy=0.744, val_loss=1.68, val_accuracy=0.597, lr=0.1] 19%|█▉        | 19/100 [07:45<30:37, 22.68s/epoch, loss=1.16, accuracy=0.746, val_loss=2.21, val_accuracy=0.382, lr=0.1] 20%|██        | 20/100 [08:08<30:10, 22.63s/epoch, loss=1.16, accuracy=0.746, val_loss=1.54, val_accuracy=0.624, lr=0.1] 21%|██        | 21/100 [08:30<29:46, 22.61s/epoch, loss=1.16, accuracy=0.748, val_loss=2.26, val_accuracy=0.355, lr=0.1] 22%|██▏       | 22/100 [08:53<29:26, 22.65s/epoch, loss=1.15, accuracy=0.748, val_loss=3.18, val_accuracy=0.331, lr=0.1] 23%|██▎       | 23/100 [09:15<29:01, 22.62s/epoch, loss=1.15, accuracy=0.748, val_loss=2.58, val_accuracy=0.393, lr=0.1] 24%|██▍       | 24/100 [09:38<28:37, 22.60s/epoch, loss=1.15, accuracy=0.748, val_loss=1.95, val_accuracy=0.493, lr=0.1] 25%|██▌       | 25/100 [10:01<28:14, 22.59s/epoch, loss=1.15, accuracy=0.748, val_loss=2.31, val_accuracy=0.43, lr=0.1]  26%|██▌       | 26/100 [10:23<27:52, 22.60s/epoch, loss=1.14, accuracy=0.751, val_loss=1.92, val_accuracy=0.483, lr=0.1] 27%|██▋       | 27/100 [10:46<27:27, 22.57s/epoch, loss=1.14, accuracy=0.751, val_loss=1.76, val_accuracy=0.593, lr=0.1] 28%|██▊       | 28/100 [11:08<27:01, 22.52s/epoch, loss=1.14, accuracy=0.751, val_loss=2.62, val_accuracy=0.458, lr=0.1] 29%|██▉       | 29/100 [11:31<26:39, 22.52s/epoch, loss=1.15, accuracy=0.749, val_loss=2.27, val_accuracy=0.52, lr=0.1]  30%|███       | 30/100 [11:53<26:14, 22.50s/epoch, loss=1.14, accuracy=0.753, val_loss=1.73, val_accuracy=0.567, lr=0.1] 31%|███       | 31/100 [12:15<25:50, 22.47s/epoch, loss=1.14, accuracy=0.753, val_loss=2.01, val_accuracy=0.469, lr=0.1] 32%|███▏      | 32/100 [12:38<25:28, 22.48s/epoch, loss=1.14, accuracy=0.752, val_loss=1.77, val_accuracy=0.599, lr=0.1] 33%|███▎      | 33/100 [13:00<25:05, 22.48s/epoch, loss=1.14, accuracy=0.752, val_loss=2.2, val_accuracy=0.384, lr=0.1]  34%|███▍      | 34/100 [13:23<24:44, 22.49s/epoch, loss=1.14, accuracy=0.753, val_loss=1.42, val_accuracy=0.649, lr=0.1] 35%|███▌      | 35/100 [13:45<24:20, 22.47s/epoch, loss=1.13, accuracy=0.756, val_loss=4.47, val_accuracy=0.266, lr=0.1] 36%|███▌      | 36/100 [14:08<23:56, 22.45s/epoch, loss=1.13, accuracy=0.753, val_loss=3.17, val_accuracy=0.391, lr=0.1] 37%|███▋      | 37/100 [14:30<23:33, 22.44s/epoch, loss=1.13, accuracy=0.752, val_loss=1.7, val_accuracy=0.598, lr=0.1]  38%|███▊      | 38/100 [14:53<23:11, 22.44s/epoch, loss=1.14, accuracy=0.754, val_loss=3.59, val_accuracy=0.363, lr=0.1] 39%|███▉      | 39/100 [15:15<22:48, 22.43s/epoch, loss=1.13, accuracy=0.755, val_loss=2.71, val_accuracy=0.429, lr=0.1] 40%|████      | 40/100 [15:38<22:28, 22.47s/epoch, loss=1.13, accuracy=0.757, val_loss=2.04, val_accuracy=0.562, lr=0.1] 41%|████      | 41/100 [16:00<22:04, 22.44s/epoch, loss=1.14, accuracy=0.755, val_loss=1.84, val_accuracy=0.554, lr=0.1] 42%|████▏     | 42/100 [16:23<21:43, 22.47s/epoch, loss=0.917, accuracy=0.817, val_loss=0.892, val_accuracy=0.803, lr=0.01] 43%|████▎     | 43/100 [16:45<21:25, 22.56s/epoch, loss=0.733, accuracy=0.849, val_loss=0.764, val_accuracy=0.827, lr=0.01] 44%|████▍     | 44/100 [17:08<21:03, 22.56s/epoch, loss=0.653, accuracy=0.856, val_loss=0.746, val_accuracy=0.821, lr=0.01] 45%|████▌     | 45/100 [17:31<20:44, 22.62s/epoch, loss=0.605, accuracy=0.861, val_loss=0.753, val_accuracy=0.81, lr=0.01]  46%|████▌     | 46/100 [17:53<20:23, 22.66s/epoch, loss=0.588, accuracy=0.861, val_loss=0.806, val_accuracy=0.793, lr=0.01] 47%|████▋     | 47/100 [18:16<20:00, 22.66s/epoch, loss=0.575, accuracy=0.862, val_loss=0.739, val_accuracy=0.811, lr=0.01] 48%|████▊     | 48/100 [18:38<19:34, 22.60s/epoch, loss=0.568, accuracy=0.865, val_loss=0.929, val_accuracy=0.754, lr=0.01] 49%|████▉     | 49/100 [19:01<19:09, 22.54s/epoch, loss=0.568, accuracy=0.865, val_loss=0.951, val_accuracy=0.75, lr=0.01]  50%|█████     | 50/100 [19:24<18:48, 22.57s/epoch, loss=0.564, accuracy=0.868, val_loss=0.709, val_accuracy=0.817, lr=0.01] 51%|█████     | 51/100 [19:46<18:25, 22.57s/epoch, loss=0.559, accuracy=0.871, val_loss=0.97, val_accuracy=0.748, lr=0.01]  52%|█████▏    | 52/100 [20:09<18:01, 22.54s/epoch, loss=0.562, accuracy=0.871, val_loss=0.769, val_accuracy=0.808, lr=0.01] 53%|█████▎    | 53/100 [20:31<17:39, 22.54s/epoch, loss=0.558, accuracy=0.872, val_loss=0.741, val_accuracy=0.813, lr=0.01] 54%|█████▍    | 54/100 [20:54<17:17, 22.56s/epoch, loss=0.56, accuracy=0.873, val_loss=0.708, val_accuracy=0.826, lr=0.01]  55%|█████▌    | 55/100 [21:16<16:55, 22.57s/epoch, loss=0.56, accuracy=0.874, val_loss=0.926, val_accuracy=0.761, lr=0.01] 56%|█████▌    | 56/100 [21:39<16:35, 22.63s/epoch, loss=0.558, accuracy=0.876, val_loss=0.884, val_accuracy=0.782, lr=0.01] 57%|█████▋    | 57/100 [22:02<16:12, 22.63s/epoch, loss=0.551, accuracy=0.879, val_loss=1.01, val_accuracy=0.734, lr=0.01]  58%|█████▊    | 58/100 [22:24<15:50, 22.64s/epoch, loss=0.557, accuracy=0.877, val_loss=0.873, val_accuracy=0.776, lr=0.01] 59%|█████▉    | 59/100 [22:47<15:28, 22.65s/epoch, loss=0.555, accuracy=0.879, val_loss=0.941, val_accuracy=0.78, lr=0.01]  60%|██████    | 60/100 [23:10<15:05, 22.64s/epoch, loss=0.554, accuracy=0.88, val_loss=0.706, val_accuracy=0.836, lr=0.01] 61%|██████    | 61/100 [23:32<14:38, 22.52s/epoch, loss=0.551, accuracy=0.879, val_loss=0.816, val_accuracy=0.805, lr=0.01] 62%|██████▏   | 62/100 [23:54<14:14, 22.50s/epoch, loss=0.477, accuracy=0.908, val_loss=0.541, val_accuracy=0.885, lr=0.001] 63%|██████▎   | 63/100 [24:17<13:52, 22.50s/epoch, loss=0.424, accuracy=0.924, val_loss=0.517, val_accuracy=0.891, lr=0.001] 64%|██████▍   | 64/100 [24:39<13:28, 22.47s/epoch, loss=0.404, accuracy=0.929, val_loss=0.501, val_accuracy=0.895, lr=0.001] 65%|██████▌   | 65/100 [25:02<13:05, 22.44s/epoch, loss=0.386, accuracy=0.934, val_loss=0.5, val_accuracy=0.894, lr=0.001]   66%|██████▌   | 66/100 [25:24<12:42, 22.42s/epoch, loss=0.372, accuracy=0.937, val_loss=0.503, val_accuracy=0.889, lr=0.001] 67%|██████▋   | 67/100 [25:46<12:18, 22.37s/epoch, loss=0.36, accuracy=0.94, val_loss=0.486, val_accuracy=0.894, lr=0.001]   68%|██████▊   | 68/100 [26:09<11:55, 22.36s/epoch, loss=0.348, accuracy=0.943, val_loss=0.48, val_accuracy=0.897, lr=0.001] 69%|██████▉   | 69/100 [26:31<11:33, 22.36s/epoch, loss=0.338, accuracy=0.944, val_loss=0.479, val_accuracy=0.897, lr=0.001] 70%|███████   | 70/100 [26:53<11:09, 22.33s/epoch, loss=0.329, accuracy=0.945, val_loss=0.482, val_accuracy=0.892, lr=0.001] 71%|███████   | 71/100 [27:15<10:47, 22.32s/epoch, loss=0.32, accuracy=0.947, val_loss=0.472, val_accuracy=0.896, lr=0.001]  72%|███████▏  | 72/100 [27:38<10:24, 22.32s/epoch, loss=0.314, accuracy=0.947, val_loss=0.457, val_accuracy=0.899, lr=0.001] 73%|███████▎  | 73/100 [28:00<10:01, 22.29s/epoch, loss=0.306, accuracy=0.949, val_loss=0.456, val_accuracy=0.899, lr=0.001] 74%|███████▍  | 74/100 [28:22<09:40, 22.32s/epoch, loss=0.298, accuracy=0.95, val_loss=0.465, val_accuracy=0.895, lr=0.001]  75%|███████▌  | 75/100 [28:45<09:18, 22.35s/epoch, loss=0.293, accuracy=0.951, val_loss=0.466, val_accuracy=0.895, lr=0.001] 76%|███████▌  | 76/100 [29:07<08:56, 22.37s/epoch, loss=0.283, accuracy=0.953, val_loss=0.463, val_accuracy=0.897, lr=0.001] 77%|███████▋  | 77/100 [29:30<08:34, 22.39s/epoch, loss=0.279, accuracy=0.953, val_loss=0.457, val_accuracy=0.895, lr=0.001] 78%|███████▊  | 78/100 [29:52<08:12, 22.40s/epoch, loss=0.275, accuracy=0.954, val_loss=0.491, val_accuracy=0.887, lr=0.001] 79%|███████▉  | 79/100 [30:14<07:50, 22.39s/epoch, loss=0.269, accuracy=0.955, val_loss=0.478, val_accuracy=0.887, lr=0.001] 80%|████████  | 80/100 [30:37<07:28, 22.40s/epoch, loss=0.265, accuracy=0.955, val_loss=0.447, val_accuracy=0.895, lr=0.001] 81%|████████  | 81/100 [30:59<07:05, 22.39s/epoch, loss=0.259, accuracy=0.956, val_loss=0.501, val_accuracy=0.882, lr=0.001] 82%|████████▏ | 82/100 [31:22<06:42, 22.36s/epoch, loss=0.244, accuracy=0.961, val_loss=0.423, val_accuracy=0.902, lr=1e-04] 83%|████████▎ | 83/100 [31:44<06:19, 22.33s/epoch, loss=0.234, accuracy=0.966, val_loss=0.422, val_accuracy=0.903, lr=1e-04] 84%|████████▍ | 84/100 [32:06<05:57, 22.33s/epoch, loss=0.229, accuracy=0.969, val_loss=0.422, val_accuracy=0.904, lr=1e-04] 85%|████████▌ | 85/100 [32:28<05:34, 22.32s/epoch, loss=0.228, accuracy=0.969, val_loss=0.421, val_accuracy=0.904, lr=1e-04] 86%|████████▌ | 86/100 [32:51<05:12, 22.34s/epoch, loss=0.226, accuracy=0.969, val_loss=0.422, val_accuracy=0.904, lr=1e-04] 87%|████████▋ | 87/100 [33:13<04:50, 22.36s/epoch, loss=0.222, accuracy=0.97, val_loss=0.422, val_accuracy=0.904, lr=1e-04]  88%|████████▊ | 88/100 [33:35<04:27, 22.31s/epoch, loss=0.223, accuracy=0.97, val_loss=0.423, val_accuracy=0.904, lr=1e-04] 89%|████████▉ | 89/100 [33:58<04:04, 22.27s/epoch, loss=0.223, accuracy=0.969, val_loss=0.423, val_accuracy=0.901, lr=1e-04] 90%|█████████ | 90/100 [34:20<03:42, 22.27s/epoch, loss=0.22, accuracy=0.971, val_loss=0.42, val_accuracy=0.903, lr=1e-04]   91%|█████████ | 91/100 [34:42<03:20, 22.29s/epoch, loss=0.219, accuracy=0.971, val_loss=0.421, val_accuracy=0.903, lr=1e-04] 92%|█████████▏| 92/100 [35:04<02:58, 22.28s/epoch, loss=0.217, accuracy=0.972, val_loss=0.421, val_accuracy=0.902, lr=5e-5]  93%|█████████▎| 93/100 [35:27<02:35, 22.24s/epoch, loss=0.217, accuracy=0.971, val_loss=0.422, val_accuracy=0.904, lr=5e-5] 94%|█████████▍| 94/100 [35:49<02:13, 22.27s/epoch, loss=0.215, accuracy=0.972, val_loss=0.42, val_accuracy=0.904, lr=5e-5]  95%|█████████▌| 95/100 [36:11<01:51, 22.26s/epoch, loss=0.215, accuracy=0.972, val_loss=0.42, val_accuracy=0.904, lr=5e-5] 96%|█████████▌| 96/100 [36:33<01:28, 22.24s/epoch, loss=0.213, accuracy=0.973, val_loss=0.42, val_accuracy=0.903, lr=5e-5] 97%|█████████▋| 97/100 [36:56<01:06, 22.26s/epoch, loss=0.214, accuracy=0.973, val_loss=0.422, val_accuracy=0.904, lr=5e-5] 98%|█████████▊| 98/100 [37:18<00:44, 22.23s/epoch, loss=0.214, accuracy=0.972, val_loss=0.422, val_accuracy=0.904, lr=5e-5] 99%|█████████▉| 99/100 [37:40<00:22, 22.27s/epoch, loss=0.212, accuracy=0.973, val_loss=0.422, val_accuracy=0.905, lr=5e-5]100%|██████████| 100/100 [38:03<00:00, 22.31s/epoch, loss=0.213, accuracy=0.972, val_loss=0.421, val_accuracy=0.903, lr=5e-5]100%|██████████| 100/100 [38:03<00:00, 22.83s/epoch, loss=0.213, accuracy=0.972, val_loss=0.421, val_accuracy=0.903, lr=5e-5]
Using real-time data augmentation.
Only one model saved

Loading model: 15_12_cifar10_ResNet20v1.h5
Test score: 0.4213084578514099
Test accuracy: 0.9025999903678894


* * * Run SGD for ID = 15_13. * * *


2024-03-13 10:11:51.210486: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 10:11:54.119287: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 10:11:54.120474: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-13 10:11:54.161163: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-13 10:11:54.161198: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 10:11:54.164226: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 10:11:54.164271: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 10:11:54.166765: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 10:11:54.167594: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 10:11:54.170287: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 10:11:54.171863: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 10:11:54.176839: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 10:11:54.177437: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 10:11:54.177517: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 10:11:55.507238: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-13 10:11:55.507903: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 10:11:55.508705: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-13 10:11:55.508737: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 10:11:55.508773: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 10:11:55.508790: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 10:11:55.508806: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 10:11:55.508824: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 10:11:55.508841: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 10:11:55.508856: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 10:11:55.508873: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 10:11:55.509401: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 10:11:55.509435: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 10:11:56.193818: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-13 10:11:56.193871: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-13 10:11:56.193881: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-13 10:11:56.194773: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:02:00.0, compute capability: 6.1)
{'id': '15_13', 'seed': 13, 'out_folder': 'results/epoch_budget_2', 'batch_size': 128, 'epochs': 100, 'validation_split': 0.0, 'checkpointing': False, 'checkpoint_every': -1, 'hold_out_validation_split': 0.0, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'num_classes': 10, 'SSE_lr': False, 'test_time_augmentation': False, 'debug': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
y_train shape: (50000, 10)
x_val shape: (10000, 32, 32, 3)
y_val shape: (10000, 10)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/100 [00:00<?, ?epoch/s]2024-03-13 10:11:56.850322: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-13 10:11:56.862206: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199825000 Hz
2024-03-13 10:11:58.953543: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 10:11:59.217239: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 10:11:59.971454: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-13 10:12:00.027900: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/100 [01:07<1:51:04, 67.32s/epoch, loss=2.83, accuracy=0.405, val_loss=3.23, val_accuracy=0.168, lr=0.1]  2%|▏         | 2/100 [01:29<1:06:39, 40.81s/epoch, loss=1.44, accuracy=0.609, val_loss=2.1, val_accuracy=0.418, lr=0.1]   3%|▎         | 3/100 [01:51<52:14, 32.31s/epoch, loss=1.29, accuracy=0.673, val_loss=3.6, val_accuracy=0.242, lr=0.1]    4%|▍         | 4/100 [02:14<45:37, 28.51s/epoch, loss=1.26, accuracy=0.695, val_loss=3.57, val_accuracy=0.322, lr=0.1]  5%|▌         | 5/100 [02:36<41:35, 26.27s/epoch, loss=1.23, accuracy=0.712, val_loss=1.42, val_accuracy=0.644, lr=0.1]  6%|▌         | 6/100 [02:59<39:01, 24.91s/epoch, loss=1.22, accuracy=0.717, val_loss=3.2, val_accuracy=0.294, lr=0.1]   7%|▋         | 7/100 [03:21<37:17, 24.06s/epoch, loss=1.21, accuracy=0.725, val_loss=2.49, val_accuracy=0.434, lr=0.1]  8%|▊         | 8/100 [03:43<36:01, 23.49s/epoch, loss=1.2, accuracy=0.73, val_loss=1.75, val_accuracy=0.532, lr=0.1]    9%|▉         | 9/100 [04:05<35:00, 23.08s/epoch, loss=1.19, accuracy=0.734, val_loss=2.1, val_accuracy=0.398, lr=0.1] 10%|█         | 10/100 [04:28<34:14, 22.83s/epoch, loss=1.19, accuracy=0.738, val_loss=1.99, val_accuracy=0.519, lr=0.1] 11%|█         | 11/100 [04:50<33:34, 22.64s/epoch, loss=1.18, accuracy=0.74, val_loss=1.88, val_accuracy=0.538, lr=0.1]  12%|█▏        | 12/100 [05:12<33:00, 22.51s/epoch, loss=1.18, accuracy=0.742, val_loss=1.68, val_accuracy=0.592, lr=0.1] 13%|█▎        | 13/100 [05:34<32:31, 22.44s/epoch, loss=1.18, accuracy=0.74, val_loss=1.52, val_accuracy=0.627, lr=0.1]  14%|█▍        | 14/100 [05:56<32:02, 22.36s/epoch, loss=1.17, accuracy=0.744, val_loss=2.61, val_accuracy=0.357, lr=0.1] 15%|█▌        | 15/100 [06:19<31:41, 22.38s/epoch, loss=1.16, accuracy=0.748, val_loss=2.41, val_accuracy=0.424, lr=0.1] 16%|█▌        | 16/100 [06:41<31:16, 22.34s/epoch, loss=1.16, accuracy=0.746, val_loss=2.04, val_accuracy=0.508, lr=0.1] 17%|█▋        | 17/100 [07:03<30:52, 22.32s/epoch, loss=1.16, accuracy=0.747, val_loss=1.97, val_accuracy=0.523, lr=0.1] 18%|█▊        | 18/100 [07:26<30:29, 22.31s/epoch, loss=1.16, accuracy=0.746, val_loss=2, val_accuracy=0.495, lr=0.1]    19%|█▉        | 19/100 [07:48<30:08, 22.33s/epoch, loss=1.16, accuracy=0.748, val_loss=1.39, val_accuracy=0.664, lr=0.1] 20%|██        | 20/100 [08:10<29:47, 22.34s/epoch, loss=1.15, accuracy=0.748, val_loss=1.66, val_accuracy=0.583, lr=0.1] 21%|██        | 21/100 [08:33<29:24, 22.34s/epoch, loss=1.15, accuracy=0.75, val_loss=2.45, val_accuracy=0.375, lr=0.1]  22%|██▏       | 22/100 [08:55<29:02, 22.34s/epoch, loss=1.16, accuracy=0.752, val_loss=1.46, val_accuracy=0.633, lr=0.1] 23%|██▎       | 23/100 [09:17<28:40, 22.35s/epoch, loss=1.16, accuracy=0.749, val_loss=1.66, val_accuracy=0.593, lr=0.1] 24%|██▍       | 24/100 [09:40<28:22, 22.41s/epoch, loss=1.15, accuracy=0.751, val_loss=1.53, val_accuracy=0.629, lr=0.1] 25%|██▌       | 25/100 [10:02<27:59, 22.39s/epoch, loss=1.15, accuracy=0.753, val_loss=1.89, val_accuracy=0.508, lr=0.1] 26%|██▌       | 26/100 [10:25<27:41, 22.45s/epoch, loss=1.15, accuracy=0.751, val_loss=1.9, val_accuracy=0.522, lr=0.1]  27%|██▋       | 27/100 [10:47<27:18, 22.45s/epoch, loss=1.15, accuracy=0.752, val_loss=2.02, val_accuracy=0.536, lr=0.1] 28%|██▊       | 28/100 [11:10<26:53, 22.42s/epoch, loss=1.14, accuracy=0.752, val_loss=2, val_accuracy=0.517, lr=0.1]    29%|██▉       | 29/100 [11:32<26:30, 22.40s/epoch, loss=1.14, accuracy=0.755, val_loss=2.87, val_accuracy=0.389, lr=0.1] 30%|███       | 30/100 [11:54<26:05, 22.36s/epoch, loss=1.15, accuracy=0.753, val_loss=1.94, val_accuracy=0.557, lr=0.1] 31%|███       | 31/100 [12:17<25:44, 22.38s/epoch, loss=1.14, accuracy=0.755, val_loss=2.59, val_accuracy=0.442, lr=0.1] 32%|███▏      | 32/100 [12:39<25:19, 22.34s/epoch, loss=1.15, accuracy=0.753, val_loss=2.7, val_accuracy=0.394, lr=0.1]  33%|███▎      | 33/100 [13:01<24:55, 22.33s/epoch, loss=1.14, accuracy=0.754, val_loss=3.49, val_accuracy=0.243, lr=0.1] 34%|███▍      | 34/100 [13:24<24:32, 22.31s/epoch, loss=1.13, accuracy=0.755, val_loss=3.14, val_accuracy=0.417, lr=0.1] 35%|███▌      | 35/100 [13:46<24:09, 22.30s/epoch, loss=1.15, accuracy=0.753, val_loss=1.78, val_accuracy=0.578, lr=0.1] 36%|███▌      | 36/100 [14:08<23:46, 22.29s/epoch, loss=1.14, accuracy=0.756, val_loss=2.32, val_accuracy=0.432, lr=0.1] 37%|███▋      | 37/100 [14:30<23:20, 22.24s/epoch, loss=1.14, accuracy=0.755, val_loss=2.12, val_accuracy=0.521, lr=0.1] 38%|███▊      | 38/100 [14:52<22:58, 22.24s/epoch, loss=1.14, accuracy=0.756, val_loss=1.99, val_accuracy=0.494, lr=0.1] 39%|███▉      | 39/100 [15:15<22:41, 22.33s/epoch, loss=1.14, accuracy=0.757, val_loss=3.03, val_accuracy=0.321, lr=0.1] 40%|████      | 40/100 [15:37<22:16, 22.27s/epoch, loss=1.13, accuracy=0.758, val_loss=1.69, val_accuracy=0.538, lr=0.1] 41%|████      | 41/100 [15:59<21:54, 22.27s/epoch, loss=1.14, accuracy=0.754, val_loss=1.81, val_accuracy=0.537, lr=0.1] 42%|████▏     | 42/100 [16:22<21:30, 22.26s/epoch, loss=0.919, accuracy=0.819, val_loss=0.913, val_accuracy=0.802, lr=0.01] 43%|████▎     | 43/100 [16:44<21:12, 22.33s/epoch, loss=0.735, accuracy=0.849, val_loss=0.804, val_accuracy=0.812, lr=0.01] 44%|████▍     | 44/100 [17:06<20:48, 22.30s/epoch, loss=0.657, accuracy=0.858, val_loss=0.77, val_accuracy=0.815, lr=0.01]  45%|████▌     | 45/100 [17:29<20:25, 22.28s/epoch, loss=0.61, accuracy=0.86, val_loss=0.74, val_accuracy=0.806, lr=0.01]   46%|████▌     | 46/100 [17:51<20:03, 22.28s/epoch, loss=0.587, accuracy=0.861, val_loss=0.772, val_accuracy=0.799, lr=0.01] 47%|████▋     | 47/100 [18:13<19:41, 22.28s/epoch, loss=0.579, accuracy=0.863, val_loss=0.728, val_accuracy=0.813, lr=0.01] 48%|████▊     | 48/100 [18:36<19:19, 22.30s/epoch, loss=0.573, accuracy=0.862, val_loss=0.741, val_accuracy=0.805, lr=0.01] 49%|████▉     | 49/100 [18:58<19:01, 22.37s/epoch, loss=0.566, accuracy=0.865, val_loss=0.71, val_accuracy=0.825, lr=0.01]  50%|█████     | 50/100 [19:20<18:37, 22.35s/epoch, loss=0.566, accuracy=0.866, val_loss=0.953, val_accuracy=0.747, lr=0.01] 51%|█████     | 51/100 [19:43<18:14, 22.35s/epoch, loss=0.561, accuracy=0.869, val_loss=0.817, val_accuracy=0.792, lr=0.01] 52%|█████▏    | 52/100 [20:05<17:50, 22.31s/epoch, loss=0.564, accuracy=0.87, val_loss=0.798, val_accuracy=0.797, lr=0.01]  53%|█████▎    | 53/100 [20:27<17:27, 22.28s/epoch, loss=0.561, accuracy=0.871, val_loss=0.905, val_accuracy=0.779, lr=0.01] 54%|█████▍    | 54/100 [20:50<17:08, 22.36s/epoch, loss=0.556, accuracy=0.874, val_loss=0.744, val_accuracy=0.815, lr=0.01] 55%|█████▌    | 55/100 [21:12<16:46, 22.36s/epoch, loss=0.558, accuracy=0.875, val_loss=0.918, val_accuracy=0.765, lr=0.01] 56%|█████▌    | 56/100 [21:35<16:25, 22.41s/epoch, loss=0.555, accuracy=0.876, val_loss=0.795, val_accuracy=0.801, lr=0.01] 57%|█████▋    | 57/100 [21:57<16:01, 22.37s/epoch, loss=0.556, accuracy=0.878, val_loss=0.792, val_accuracy=0.811, lr=0.01] 58%|█████▊    | 58/100 [22:19<15:39, 22.36s/epoch, loss=0.556, accuracy=0.878, val_loss=0.818, val_accuracy=0.797, lr=0.01] 59%|█████▉    | 59/100 [22:41<15:15, 22.34s/epoch, loss=0.554, accuracy=0.88, val_loss=0.76, val_accuracy=0.817, lr=0.01]   60%|██████    | 60/100 [23:04<14:53, 22.33s/epoch, loss=0.561, accuracy=0.879, val_loss=0.805, val_accuracy=0.8, lr=0.01] 61%|██████    | 61/100 [23:26<14:32, 22.36s/epoch, loss=0.554, accuracy=0.881, val_loss=0.801, val_accuracy=0.802, lr=0.01] 62%|██████▏   | 62/100 [23:49<14:09, 22.35s/epoch, loss=0.48, accuracy=0.907, val_loss=0.536, val_accuracy=0.882, lr=0.001] 63%|██████▎   | 63/100 [24:11<13:46, 22.33s/epoch, loss=0.428, accuracy=0.924, val_loss=0.514, val_accuracy=0.891, lr=0.001] 64%|██████▍   | 64/100 [24:33<13:23, 22.32s/epoch, loss=0.407, accuracy=0.929, val_loss=0.518, val_accuracy=0.888, lr=0.001] 65%|██████▌   | 65/100 [24:56<13:02, 22.34s/epoch, loss=0.39, accuracy=0.933, val_loss=0.5, val_accuracy=0.892, lr=0.001]    66%|██████▌   | 66/100 [25:18<12:39, 22.33s/epoch, loss=0.376, accuracy=0.937, val_loss=0.5, val_accuracy=0.893, lr=0.001] 67%|██████▋   | 67/100 [25:40<12:16, 22.32s/epoch, loss=0.366, accuracy=0.938, val_loss=0.485, val_accuracy=0.896, lr=0.001] 68%|██████▊   | 68/100 [26:02<11:53, 22.30s/epoch, loss=0.352, accuracy=0.94, val_loss=0.485, val_accuracy=0.899, lr=0.001]  69%|██████▉   | 69/100 [26:25<11:30, 22.27s/epoch, loss=0.343, accuracy=0.942, val_loss=0.474, val_accuracy=0.898, lr=0.001] 70%|███████   | 70/100 [26:47<11:06, 22.20s/epoch, loss=0.335, accuracy=0.943, val_loss=0.474, val_accuracy=0.897, lr=0.001] 71%|███████   | 71/100 [27:09<10:43, 22.18s/epoch, loss=0.325, accuracy=0.945, val_loss=0.48, val_accuracy=0.896, lr=0.001]  72%|███████▏  | 72/100 [27:31<10:21, 22.20s/epoch, loss=0.318, accuracy=0.947, val_loss=0.467, val_accuracy=0.896, lr=0.001] 73%|███████▎  | 73/100 [27:53<09:58, 22.18s/epoch, loss=0.31, accuracy=0.948, val_loss=0.472, val_accuracy=0.9, lr=0.001]    74%|███████▍  | 74/100 [28:15<09:37, 22.19s/epoch, loss=0.303, accuracy=0.95, val_loss=0.468, val_accuracy=0.896, lr=0.001] 75%|███████▌  | 75/100 [28:37<09:14, 22.18s/epoch, loss=0.297, accuracy=0.95, val_loss=0.466, val_accuracy=0.896, lr=0.001] 76%|███████▌  | 76/100 [29:00<08:52, 22.21s/epoch, loss=0.289, accuracy=0.951, val_loss=0.47, val_accuracy=0.892, lr=0.001] 77%|███████▋  | 77/100 [29:22<08:30, 22.19s/epoch, loss=0.284, accuracy=0.952, val_loss=0.459, val_accuracy=0.895, lr=0.001] 78%|███████▊  | 78/100 [29:44<08:08, 22.20s/epoch, loss=0.279, accuracy=0.953, val_loss=0.471, val_accuracy=0.893, lr=0.001] 79%|███████▉  | 79/100 [30:06<07:45, 22.18s/epoch, loss=0.274, accuracy=0.954, val_loss=0.464, val_accuracy=0.892, lr=0.001] 80%|████████  | 80/100 [30:29<07:24, 22.20s/epoch, loss=0.266, accuracy=0.955, val_loss=0.484, val_accuracy=0.893, lr=0.001] 81%|████████  | 81/100 [30:51<07:01, 22.20s/epoch, loss=0.264, accuracy=0.954, val_loss=0.48, val_accuracy=0.888, lr=0.001]  82%|████████▏ | 82/100 [31:13<06:39, 22.20s/epoch, loss=0.245, accuracy=0.962, val_loss=0.429, val_accuracy=0.904, lr=1e-04] 83%|████████▎ | 83/100 [31:35<06:16, 22.15s/epoch, loss=0.235, accuracy=0.965, val_loss=0.425, val_accuracy=0.905, lr=1e-04] 84%|████████▍ | 84/100 [31:57<05:53, 22.12s/epoch, loss=0.233, accuracy=0.966, val_loss=0.422, val_accuracy=0.905, lr=1e-04] 85%|████████▌ | 85/100 [32:19<05:31, 22.12s/epoch, loss=0.232, accuracy=0.967, val_loss=0.426, val_accuracy=0.906, lr=1e-04] 86%|████████▌ | 86/100 [32:41<05:09, 22.09s/epoch, loss=0.229, accuracy=0.968, val_loss=0.425, val_accuracy=0.906, lr=1e-04] 87%|████████▋ | 87/100 [33:03<04:47, 22.08s/epoch, loss=0.229, accuracy=0.967, val_loss=0.423, val_accuracy=0.905, lr=1e-04] 88%|████████▊ | 88/100 [33:25<04:24, 22.06s/epoch, loss=0.225, accuracy=0.969, val_loss=0.428, val_accuracy=0.905, lr=1e-04] 89%|████████▉ | 89/100 [33:47<04:02, 22.07s/epoch, loss=0.225, accuracy=0.969, val_loss=0.424, val_accuracy=0.905, lr=1e-04] 90%|█████████ | 90/100 [34:09<03:40, 22.07s/epoch, loss=0.223, accuracy=0.969, val_loss=0.425, val_accuracy=0.905, lr=1e-04] 91%|█████████ | 91/100 [34:31<03:18, 22.06s/epoch, loss=0.224, accuracy=0.968, val_loss=0.423, val_accuracy=0.906, lr=1e-04] 92%|█████████▏| 92/100 [34:54<02:57, 22.13s/epoch, loss=0.221, accuracy=0.97, val_loss=0.423, val_accuracy=0.906, lr=5e-5]   93%|█████████▎| 93/100 [35:16<02:34, 22.10s/epoch, loss=0.219, accuracy=0.971, val_loss=0.424, val_accuracy=0.906, lr=5e-5] 94%|█████████▍| 94/100 [35:38<02:12, 22.06s/epoch, loss=0.218, accuracy=0.971, val_loss=0.425, val_accuracy=0.905, lr=5e-5] 95%|█████████▌| 95/100 [36:00<01:49, 22.00s/epoch, loss=0.218, accuracy=0.972, val_loss=0.425, val_accuracy=0.906, lr=5e-5] 96%|█████████▌| 96/100 [36:22<01:28, 22.01s/epoch, loss=0.219, accuracy=0.971, val_loss=0.424, val_accuracy=0.906, lr=5e-5] 97%|█████████▋| 97/100 [36:44<01:06, 22.00s/epoch, loss=0.217, accuracy=0.971, val_loss=0.424, val_accuracy=0.906, lr=5e-5] 98%|█████████▊| 98/100 [37:06<00:44, 22.02s/epoch, loss=0.216, accuracy=0.972, val_loss=0.424, val_accuracy=0.906, lr=5e-5] 99%|█████████▉| 99/100 [37:28<00:22, 22.04s/epoch, loss=0.216, accuracy=0.971, val_loss=0.423, val_accuracy=0.906, lr=5e-5]100%|██████████| 100/100 [37:50<00:00, 22.04s/epoch, loss=0.215, accuracy=0.972, val_loss=0.425, val_accuracy=0.907, lr=5e-5]100%|██████████| 100/100 [37:50<00:00, 22.70s/epoch, loss=0.215, accuracy=0.972, val_loss=0.425, val_accuracy=0.907, lr=5e-5]
Using real-time data augmentation.
Only one model saved

Loading model: 15_13_cifar10_ResNet20v1.h5
Test score: 0.42512276768684387
Test accuracy: 0.9067999720573425


* * * Run SGD for ID = 15_14. * * *


2024-03-13 10:49:51.634814: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 10:49:54.406167: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 10:49:54.407199: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-13 10:49:54.448274: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-13 10:49:54.448308: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 10:49:54.451211: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 10:49:54.451257: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 10:49:54.453620: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 10:49:54.454318: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 10:49:54.456902: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 10:49:54.458445: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 10:49:54.463399: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 10:49:54.463937: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 10:49:54.464016: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 10:49:55.846109: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-13 10:49:55.847241: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 10:49:55.848023: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-13 10:49:55.848082: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 10:49:55.848121: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 10:49:55.848142: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 10:49:55.848160: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 10:49:55.848177: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 10:49:55.848195: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 10:49:55.848212: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 10:49:55.848229: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 10:49:55.848699: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 10:49:55.848738: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 10:49:56.521011: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-13 10:49:56.521091: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-13 10:49:56.521102: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-13 10:49:56.522120: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:02:00.0, compute capability: 6.1)
{'id': '15_14', 'seed': 14, 'out_folder': 'results/epoch_budget_2', 'batch_size': 128, 'epochs': 100, 'validation_split': 0.0, 'checkpointing': False, 'checkpoint_every': -1, 'hold_out_validation_split': 0.0, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'num_classes': 10, 'SSE_lr': False, 'test_time_augmentation': False, 'debug': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
y_train shape: (50000, 10)
x_val shape: (10000, 32, 32, 3)
y_val shape: (10000, 10)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/100 [00:00<?, ?epoch/s]2024-03-13 10:49:57.205654: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-13 10:49:57.218205: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199825000 Hz
2024-03-13 10:49:59.406349: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 10:49:59.656159: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 10:50:00.469592: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-13 10:50:00.551451: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/100 [01:00<1:39:47, 60.48s/epoch, loss=3.49, accuracy=0.267, val_loss=2.24, val_accuracy=0.27, lr=0.1]  2%|▏         | 2/100 [01:23<1:02:55, 38.53s/epoch, loss=1.65, accuracy=0.495, val_loss=1.89, val_accuracy=0.428, lr=0.1]  3%|▎         | 3/100 [01:46<50:41, 31.36s/epoch, loss=1.42, accuracy=0.602, val_loss=1.77, val_accuracy=0.499, lr=0.1]    4%|▍         | 4/100 [02:09<44:39, 27.91s/epoch, loss=1.32, accuracy=0.658, val_loss=1.99, val_accuracy=0.487, lr=0.1]  5%|▌         | 5/100 [02:31<41:12, 26.02s/epoch, loss=1.28, accuracy=0.688, val_loss=1.97, val_accuracy=0.488, lr=0.1]  6%|▌         | 6/100 [02:54<38:59, 24.89s/epoch, loss=1.25, accuracy=0.705, val_loss=2.75, val_accuracy=0.274, lr=0.1]  7%|▋         | 7/100 [03:17<37:28, 24.17s/epoch, loss=1.25, accuracy=0.708, val_loss=2.06, val_accuracy=0.489, lr=0.1]  8%|▊         | 8/100 [03:39<36:18, 23.68s/epoch, loss=1.24, accuracy=0.711, val_loss=2.52, val_accuracy=0.396, lr=0.1]  9%|▉         | 9/100 [04:02<35:24, 23.34s/epoch, loss=1.23, accuracy=0.72, val_loss=1.7, val_accuracy=0.577, lr=0.1]   10%|█         | 10/100 [04:25<34:43, 23.15s/epoch, loss=1.22, accuracy=0.722, val_loss=1.55, val_accuracy=0.604, lr=0.1] 11%|█         | 11/100 [04:47<34:10, 23.04s/epoch, loss=1.22, accuracy=0.725, val_loss=1.6, val_accuracy=0.588, lr=0.1]  12%|█▏        | 12/100 [05:10<33:39, 22.94s/epoch, loss=1.21, accuracy=0.728, val_loss=1.56, val_accuracy=0.626, lr=0.1] 13%|█▎        | 13/100 [05:33<33:07, 22.84s/epoch, loss=1.21, accuracy=0.732, val_loss=1.69, val_accuracy=0.571, lr=0.1] 14%|█▍        | 14/100 [05:55<32:40, 22.79s/epoch, loss=1.21, accuracy=0.732, val_loss=1.6, val_accuracy=0.607, lr=0.1]  15%|█▌        | 15/100 [06:18<32:15, 22.78s/epoch, loss=1.2, accuracy=0.733, val_loss=2.63, val_accuracy=0.372, lr=0.1] 16%|█▌        | 16/100 [06:41<31:48, 22.72s/epoch, loss=1.19, accuracy=0.739, val_loss=2.24, val_accuracy=0.465, lr=0.1] 17%|█▋        | 17/100 [07:03<31:24, 22.70s/epoch, loss=1.2, accuracy=0.738, val_loss=1.85, val_accuracy=0.574, lr=0.1]  18%|█▊        | 18/100 [07:26<30:59, 22.68s/epoch, loss=1.18, accuracy=0.739, val_loss=1.93, val_accuracy=0.534, lr=0.1] 19%|█▉        | 19/100 [07:49<30:42, 22.75s/epoch, loss=1.19, accuracy=0.738, val_loss=2.45, val_accuracy=0.322, lr=0.1] 20%|██        | 20/100 [08:12<30:24, 22.81s/epoch, loss=1.18, accuracy=0.743, val_loss=3.59, val_accuracy=0.284, lr=0.1] 21%|██        | 21/100 [08:35<30:02, 22.82s/epoch, loss=1.18, accuracy=0.74, val_loss=1.63, val_accuracy=0.617, lr=0.1]  22%|██▏       | 22/100 [08:58<29:39, 22.81s/epoch, loss=1.17, accuracy=0.745, val_loss=3.37, val_accuracy=0.275, lr=0.1] 23%|██▎       | 23/100 [09:20<29:18, 22.83s/epoch, loss=1.19, accuracy=0.74, val_loss=1.94, val_accuracy=0.525, lr=0.1]  24%|██▍       | 24/100 [09:43<28:53, 22.81s/epoch, loss=1.18, accuracy=0.743, val_loss=1.72, val_accuracy=0.601, lr=0.1] 25%|██▌       | 25/100 [10:06<28:28, 22.78s/epoch, loss=1.17, accuracy=0.745, val_loss=2.05, val_accuracy=0.515, lr=0.1] 26%|██▌       | 26/100 [10:29<28:09, 22.83s/epoch, loss=1.17, accuracy=0.747, val_loss=1.64, val_accuracy=0.586, lr=0.1] 27%|██▋       | 27/100 [10:52<27:46, 22.83s/epoch, loss=1.17, accuracy=0.747, val_loss=1.54, val_accuracy=0.611, lr=0.1] 28%|██▊       | 28/100 [11:14<27:24, 22.84s/epoch, loss=1.17, accuracy=0.747, val_loss=1.65, val_accuracy=0.596, lr=0.1] 29%|██▉       | 29/100 [11:37<26:55, 22.75s/epoch, loss=1.16, accuracy=0.747, val_loss=1.82, val_accuracy=0.536, lr=0.1] 30%|███       | 30/100 [12:00<26:30, 22.71s/epoch, loss=1.17, accuracy=0.748, val_loss=2.78, val_accuracy=0.39, lr=0.1]  31%|███       | 31/100 [12:22<26:07, 22.71s/epoch, loss=1.17, accuracy=0.746, val_loss=1.65, val_accuracy=0.571, lr=0.1] 32%|███▏      | 32/100 [12:45<25:45, 22.73s/epoch, loss=1.17, accuracy=0.748, val_loss=1.55, val_accuracy=0.615, lr=0.1] 33%|███▎      | 33/100 [13:08<25:25, 22.77s/epoch, loss=1.16, accuracy=0.749, val_loss=1.86, val_accuracy=0.492, lr=0.1] 34%|███▍      | 34/100 [13:31<25:03, 22.77s/epoch, loss=1.16, accuracy=0.749, val_loss=1.75, val_accuracy=0.557, lr=0.1] 35%|███▌      | 35/100 [13:54<24:41, 22.79s/epoch, loss=1.17, accuracy=0.748, val_loss=3.01, val_accuracy=0.388, lr=0.1] 36%|███▌      | 36/100 [14:16<24:14, 22.73s/epoch, loss=1.16, accuracy=0.749, val_loss=2.42, val_accuracy=0.372, lr=0.1] 37%|███▋      | 37/100 [14:39<23:49, 22.70s/epoch, loss=1.16, accuracy=0.748, val_loss=1.85, val_accuracy=0.499, lr=0.1] 38%|███▊      | 38/100 [15:01<23:25, 22.67s/epoch, loss=1.16, accuracy=0.748, val_loss=1.81, val_accuracy=0.522, lr=0.1] 39%|███▉      | 39/100 [15:24<23:03, 22.68s/epoch, loss=1.15, accuracy=0.752, val_loss=2.67, val_accuracy=0.278, lr=0.1] 40%|████      | 40/100 [15:47<22:39, 22.65s/epoch, loss=1.15, accuracy=0.751, val_loss=2.33, val_accuracy=0.439, lr=0.1] 41%|████      | 41/100 [16:09<22:17, 22.66s/epoch, loss=1.16, accuracy=0.752, val_loss=3.02, val_accuracy=0.44, lr=0.1]  42%|████▏     | 42/100 [16:32<21:56, 22.70s/epoch, loss=0.931, accuracy=0.811, val_loss=0.915, val_accuracy=0.802, lr=0.01] 43%|████▎     | 43/100 [16:55<21:36, 22.74s/epoch, loss=0.75, accuracy=0.842, val_loss=0.799, val_accuracy=0.818, lr=0.01]  44%|████▍     | 44/100 [17:18<21:14, 22.76s/epoch, loss=0.667, accuracy=0.852, val_loss=0.812, val_accuracy=0.797, lr=0.01] 45%|████▌     | 45/100 [17:41<20:53, 22.78s/epoch, loss=0.624, accuracy=0.856, val_loss=0.715, val_accuracy=0.821, lr=0.01] 46%|████▌     | 46/100 [18:03<20:29, 22.77s/epoch, loss=0.598, accuracy=0.858, val_loss=0.821, val_accuracy=0.778, lr=0.01] 47%|████▋     | 47/100 [18:26<20:05, 22.75s/epoch, loss=0.587, accuracy=0.86, val_loss=0.725, val_accuracy=0.811, lr=0.01]  48%|████▊     | 48/100 [18:49<19:43, 22.76s/epoch, loss=0.581, accuracy=0.863, val_loss=0.768, val_accuracy=0.8, lr=0.01]  49%|████▉     | 49/100 [19:12<19:22, 22.79s/epoch, loss=0.579, accuracy=0.862, val_loss=0.874, val_accuracy=0.765, lr=0.01] 50%|█████     | 50/100 [19:35<19:00, 22.81s/epoch, loss=0.58, accuracy=0.864, val_loss=0.772, val_accuracy=0.807, lr=0.01]  51%|█████     | 51/100 [19:57<18:35, 22.76s/epoch, loss=0.574, accuracy=0.867, val_loss=0.901, val_accuracy=0.765, lr=0.01] 52%|█████▏    | 52/100 [20:20<18:10, 22.73s/epoch, loss=0.573, accuracy=0.867, val_loss=0.901, val_accuracy=0.769, lr=0.01] 53%|█████▎    | 53/100 [20:43<17:49, 22.76s/epoch, loss=0.568, accuracy=0.872, val_loss=0.74, val_accuracy=0.818, lr=0.01]  54%|█████▍    | 54/100 [21:06<17:29, 22.81s/epoch, loss=0.572, accuracy=0.871, val_loss=0.88, val_accuracy=0.778, lr=0.01] 55%|█████▌    | 55/100 [21:29<17:09, 22.88s/epoch, loss=0.57, accuracy=0.872, val_loss=0.732, val_accuracy=0.816, lr=0.01] 56%|█████▌    | 56/100 [21:52<16:45, 22.86s/epoch, loss=0.563, accuracy=0.875, val_loss=0.774, val_accuracy=0.814, lr=0.01] 57%|█████▋    | 57/100 [22:14<16:22, 22.85s/epoch, loss=0.574, accuracy=0.872, val_loss=0.937, val_accuracy=0.762, lr=0.01] 58%|█████▊    | 58/100 [22:37<15:59, 22.84s/epoch, loss=0.571, accuracy=0.875, val_loss=0.866, val_accuracy=0.787, lr=0.01] 59%|█████▉    | 59/100 [23:03<16:13, 23.75s/epoch, loss=0.567, accuracy=0.876, val_loss=1.14, val_accuracy=0.725, lr=0.01]  60%|██████    | 60/100 [23:26<15:38, 23.46s/epoch, loss=0.569, accuracy=0.877, val_loss=0.777, val_accuracy=0.807, lr=0.01] 61%|██████    | 61/100 [23:49<15:05, 23.23s/epoch, loss=0.566, accuracy=0.876, val_loss=0.895, val_accuracy=0.77, lr=0.01]  62%|██████▏   | 62/100 [24:11<14:38, 23.12s/epoch, loss=0.488, accuracy=0.906, val_loss=0.541, val_accuracy=0.886, lr=0.001] 63%|██████▎   | 63/100 [24:34<14:11, 23.00s/epoch, loss=0.435, accuracy=0.923, val_loss=0.518, val_accuracy=0.891, lr=0.001] 64%|██████▍   | 64/100 [24:57<13:46, 22.97s/epoch, loss=0.417, accuracy=0.927, val_loss=0.517, val_accuracy=0.89, lr=0.001]  65%|██████▌   | 65/100 [25:20<13:19, 22.85s/epoch, loss=0.4, accuracy=0.932, val_loss=0.505, val_accuracy=0.892, lr=0.001]  66%|██████▌   | 66/100 [25:42<12:55, 22.80s/epoch, loss=0.385, accuracy=0.934, val_loss=0.496, val_accuracy=0.896, lr=0.001] 67%|██████▋   | 67/100 [26:05<12:32, 22.79s/epoch, loss=0.372, accuracy=0.937, val_loss=0.492, val_accuracy=0.896, lr=0.001] 68%|██████▊   | 68/100 [26:28<12:07, 22.75s/epoch, loss=0.363, accuracy=0.937, val_loss=0.485, val_accuracy=0.898, lr=0.001] 69%|██████▉   | 69/100 [26:50<11:43, 22.70s/epoch, loss=0.352, accuracy=0.939, val_loss=0.488, val_accuracy=0.895, lr=0.001] 70%|███████   | 70/100 [27:13<11:22, 22.76s/epoch, loss=0.342, accuracy=0.942, val_loss=0.489, val_accuracy=0.892, lr=0.001] 71%|███████   | 71/100 [27:36<11:00, 22.77s/epoch, loss=0.33, accuracy=0.945, val_loss=0.483, val_accuracy=0.895, lr=0.001]  72%|███████▏  | 72/100 [27:59<10:37, 22.76s/epoch, loss=0.323, accuracy=0.945, val_loss=0.468, val_accuracy=0.9, lr=0.001]  73%|███████▎  | 73/100 [28:21<10:13, 22.74s/epoch, loss=0.318, accuracy=0.947, val_loss=0.468, val_accuracy=0.897, lr=0.001] 74%|███████▍  | 74/100 [28:44<09:51, 22.75s/epoch, loss=0.312, accuracy=0.947, val_loss=0.464, val_accuracy=0.897, lr=0.001] 75%|███████▌  | 75/100 [29:07<09:29, 22.78s/epoch, loss=0.302, accuracy=0.949, val_loss=0.47, val_accuracy=0.896, lr=0.001]  76%|███████▌  | 76/100 [29:30<09:07, 22.83s/epoch, loss=0.295, accuracy=0.95, val_loss=0.452, val_accuracy=0.897, lr=0.001] 77%|███████▋  | 77/100 [29:53<08:45, 22.83s/epoch, loss=0.292, accuracy=0.95, val_loss=0.46, val_accuracy=0.896, lr=0.001]  78%|███████▊  | 78/100 [30:16<08:21, 22.81s/epoch, loss=0.284, accuracy=0.952, val_loss=0.461, val_accuracy=0.895, lr=0.001] 79%|███████▉  | 79/100 [30:51<09:20, 26.68s/epoch, loss=0.28, accuracy=0.952, val_loss=0.469, val_accuracy=0.892, lr=0.001]  80%|████████  | 80/100 [31:14<08:29, 25.49s/epoch, loss=0.276, accuracy=0.952, val_loss=0.482, val_accuracy=0.892, lr=0.001] 81%|████████  | 81/100 [31:37<07:49, 24.69s/epoch, loss=0.273, accuracy=0.952, val_loss=0.491, val_accuracy=0.888, lr=0.001] 82%|████████▏ | 82/100 [31:59<07:13, 24.08s/epoch, loss=0.252, accuracy=0.961, val_loss=0.429, val_accuracy=0.901, lr=1e-04] 83%|████████▎ | 83/100 [32:22<06:41, 23.63s/epoch, loss=0.244, accuracy=0.964, val_loss=0.427, val_accuracy=0.903, lr=1e-04] 84%|████████▍ | 84/100 [32:45<06:13, 23.34s/epoch, loss=0.241, accuracy=0.964, val_loss=0.425, val_accuracy=0.905, lr=1e-04] 85%|████████▌ | 85/100 [33:07<05:46, 23.11s/epoch, loss=0.238, accuracy=0.965, val_loss=0.426, val_accuracy=0.905, lr=1e-04] 86%|████████▌ | 86/100 [33:30<05:22, 23.06s/epoch, loss=0.237, accuracy=0.966, val_loss=0.424, val_accuracy=0.904, lr=1e-04] 87%|████████▋ | 87/100 [33:53<04:57, 22.91s/epoch, loss=0.237, accuracy=0.966, val_loss=0.423, val_accuracy=0.905, lr=1e-04] 88%|████████▊ | 88/100 [34:15<04:34, 22.84s/epoch, loss=0.234, accuracy=0.967, val_loss=0.422, val_accuracy=0.905, lr=1e-04] 89%|████████▉ | 89/100 [34:38<04:10, 22.78s/epoch, loss=0.233, accuracy=0.967, val_loss=0.424, val_accuracy=0.905, lr=1e-04] 90%|█████████ | 90/100 [35:01<03:47, 22.73s/epoch, loss=0.231, accuracy=0.967, val_loss=0.424, val_accuracy=0.905, lr=1e-04] 91%|█████████ | 91/100 [35:23<03:24, 22.72s/epoch, loss=0.231, accuracy=0.967, val_loss=0.424, val_accuracy=0.905, lr=1e-04] 92%|█████████▏| 92/100 [35:46<03:01, 22.68s/epoch, loss=0.227, accuracy=0.969, val_loss=0.422, val_accuracy=0.904, lr=5e-5]  93%|█████████▎| 93/100 [36:09<02:38, 22.65s/epoch, loss=0.226, accuracy=0.969, val_loss=0.424, val_accuracy=0.905, lr=5e-5] 94%|█████████▍| 94/100 [36:31<02:15, 22.64s/epoch, loss=0.224, accuracy=0.969, val_loss=0.424, val_accuracy=0.905, lr=5e-5] 95%|█████████▌| 95/100 [36:54<01:52, 22.60s/epoch, loss=0.226, accuracy=0.968, val_loss=0.422, val_accuracy=0.905, lr=5e-5] 96%|█████████▌| 96/100 [37:16<01:30, 22.57s/epoch, loss=0.224, accuracy=0.969, val_loss=0.423, val_accuracy=0.904, lr=5e-5] 97%|█████████▋| 97/100 [37:39<01:07, 22.58s/epoch, loss=0.224, accuracy=0.971, val_loss=0.422, val_accuracy=0.905, lr=5e-5] 98%|█████████▊| 98/100 [38:02<00:45, 22.63s/epoch, loss=0.222, accuracy=0.969, val_loss=0.423, val_accuracy=0.904, lr=5e-5] 99%|█████████▉| 99/100 [38:24<00:22, 22.61s/epoch, loss=0.223, accuracy=0.97, val_loss=0.422, val_accuracy=0.905, lr=5e-5] 100%|██████████| 100/100 [38:47<00:00, 22.59s/epoch, loss=0.224, accuracy=0.97, val_loss=0.421, val_accuracy=0.904, lr=5e-5]100%|██████████| 100/100 [38:47<00:00, 23.27s/epoch, loss=0.224, accuracy=0.97, val_loss=0.421, val_accuracy=0.904, lr=5e-5]
Using real-time data augmentation.
Only one model saved

Loading model: 15_14_cifar10_ResNet20v1.h5
Test score: 0.4210891127586365
Test accuracy: 0.9043999910354614


* * * Run SGD for ID = 15_15. * * *


2024-03-13 11:28:48.264240: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 11:28:51.210373: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 11:28:51.211415: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-03-13 11:28:51.253442: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-13 11:28:51.253530: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 11:28:51.256465: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 11:28:51.256507: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 11:28:51.258970: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 11:28:51.260107: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 11:28:51.262481: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 11:28:51.263969: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 11:28:51.269098: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 11:28:51.269669: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 11:28:51.269753: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 11:28:52.691901: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-13 11:28:52.692479: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-03-13 11:28:52.693318: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-03-13 11:28:52.693366: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 11:28:52.693404: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 11:28:52.693421: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-03-13 11:28:52.693436: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-03-13 11:28:52.693451: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-03-13 11:28:52.693470: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-03-13 11:28:52.693486: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-03-13 11:28:52.693504: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 11:28:52.693951: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-03-13 11:28:52.693985: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-03-13 11:28:53.375379: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-03-13 11:28:53.375430: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-03-13 11:28:53.375447: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-03-13 11:28:53.376437: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:02:00.0, compute capability: 6.1)
{'id': '15_15', 'seed': 15, 'out_folder': 'results/epoch_budget_2', 'batch_size': 128, 'epochs': 100, 'validation_split': 0.0, 'checkpointing': False, 'checkpoint_every': -1, 'hold_out_validation_split': 0.0, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'bootstrapping': False, 'num_classes': 10, 'SSE_lr': False, 'test_time_augmentation': False, 'debug': False, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
y_train shape: (50000, 10)
x_val shape: (10000, 32, 32, 3)
y_val shape: (10000, 10)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/100 [00:00<?, ?epoch/s]2024-03-13 11:28:54.093489: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-03-13 11:28:54.094117: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199825000 Hz
2024-03-13 11:28:56.283454: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-03-13 11:28:56.580900: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-03-13 11:29:08.959258: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-03-13 11:29:09.017923: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/100 [01:08<1:52:14, 68.02s/epoch, loss=3.18, accuracy=0.292, val_loss=2.26, val_accuracy=0.234, lr=0.1]  2%|▏         | 2/100 [01:30<1:07:22, 41.25s/epoch, loss=1.54, accuracy=0.539, val_loss=2.89, val_accuracy=0.274, lr=0.1]  3%|▎         | 3/100 [01:53<52:58, 32.77s/epoch, loss=1.33, accuracy=0.646, val_loss=2.22, val_accuracy=0.413, lr=0.1]    4%|▍         | 4/100 [02:15<45:49, 28.64s/epoch, loss=1.27, accuracy=0.684, val_loss=2.56, val_accuracy=0.338, lr=0.1]  5%|▌         | 5/100 [02:37<41:36, 26.28s/epoch, loss=1.25, accuracy=0.701, val_loss=1.95, val_accuracy=0.485, lr=0.1]  6%|▌         | 6/100 [02:59<38:55, 24.84s/epoch, loss=1.23, accuracy=0.712, val_loss=3.28, val_accuracy=0.342, lr=0.1]  7%|▋         | 7/100 [03:21<37:08, 23.96s/epoch, loss=1.23, accuracy=0.719, val_loss=2.05, val_accuracy=0.52, lr=0.1]   8%|▊         | 8/100 [03:43<35:49, 23.37s/epoch, loss=1.22, accuracy=0.723, val_loss=2.07, val_accuracy=0.524, lr=0.1]  9%|▉         | 9/100 [04:06<34:50, 22.98s/epoch, loss=1.21, accuracy=0.727, val_loss=1.91, val_accuracy=0.567, lr=0.1] 10%|█         | 10/100 [04:27<33:57, 22.64s/epoch, loss=1.2, accuracy=0.729, val_loss=2.31, val_accuracy=0.413, lr=0.1] 11%|█         | 11/100 [04:50<33:20, 22.48s/epoch, loss=1.2, accuracy=0.733, val_loss=1.66, val_accuracy=0.639, lr=0.1] 12%|█▏        | 12/100 [05:12<32:47, 22.36s/epoch, loss=1.19, accuracy=0.733, val_loss=1.47, val_accuracy=0.631, lr=0.1] 13%|█▎        | 13/100 [05:34<32:17, 22.28s/epoch, loss=1.19, accuracy=0.734, val_loss=1.39, val_accuracy=0.654, lr=0.1] 14%|█▍        | 14/100 [05:56<31:49, 22.20s/epoch, loss=1.18, accuracy=0.737, val_loss=1.64, val_accuracy=0.572, lr=0.1] 15%|█▌        | 15/100 [06:18<31:23, 22.16s/epoch, loss=1.17, accuracy=0.738, val_loss=1.68, val_accuracy=0.586, lr=0.1] 16%|█▌        | 16/100 [06:40<31:01, 22.16s/epoch, loss=1.18, accuracy=0.741, val_loss=1.94, val_accuracy=0.513, lr=0.1] 17%|█▋        | 17/100 [07:02<30:37, 22.14s/epoch, loss=1.18, accuracy=0.742, val_loss=1.75, val_accuracy=0.545, lr=0.1] 18%|█▊        | 18/100 [07:24<30:14, 22.13s/epoch, loss=1.16, accuracy=0.744, val_loss=4.05, val_accuracy=0.259, lr=0.1] 19%|█▉        | 19/100 [07:46<29:55, 22.17s/epoch, loss=1.16, accuracy=0.744, val_loss=2.9, val_accuracy=0.393, lr=0.1]  20%|██        | 20/100 [08:09<29:33, 22.17s/epoch, loss=1.17, accuracy=0.743, val_loss=2.55, val_accuracy=0.433, lr=0.1] 21%|██        | 21/100 [08:31<29:10, 22.16s/epoch, loss=1.17, accuracy=0.744, val_loss=3.1, val_accuracy=0.369, lr=0.1]  22%|██▏       | 22/100 [08:53<28:51, 22.20s/epoch, loss=1.17, accuracy=0.746, val_loss=3.39, val_accuracy=0.359, lr=0.1] 23%|██▎       | 23/100 [09:15<28:32, 22.24s/epoch, loss=1.16, accuracy=0.745, val_loss=1.76, val_accuracy=0.589, lr=0.1] 24%|██▍       | 24/100 [09:38<28:10, 22.24s/epoch, loss=1.15, accuracy=0.747, val_loss=1.5, val_accuracy=0.629, lr=0.1]  25%|██▌       | 25/100 [10:00<27:49, 22.26s/epoch, loss=1.16, accuracy=0.748, val_loss=8.38, val_accuracy=0.19, lr=0.1] 26%|██▌       | 26/100 [10:22<27:27, 22.27s/epoch, loss=1.15, accuracy=0.749, val_loss=2.23, val_accuracy=0.511, lr=0.1] 27%|██▋       | 27/100 [10:44<27:02, 22.23s/epoch, loss=1.16, accuracy=0.747, val_loss=1.6, val_accuracy=0.593, lr=0.1]  28%|██▊       | 28/100 [11:07<26:39, 22.21s/epoch, loss=1.15, accuracy=0.747, val_loss=1.86, val_accuracy=0.481, lr=0.1] 29%|██▉       | 29/100 [11:29<26:13, 22.16s/epoch, loss=1.15, accuracy=0.748, val_loss=2.23, val_accuracy=0.468, lr=0.1] 30%|███       | 30/100 [11:51<25:48, 22.13s/epoch, loss=1.15, accuracy=0.75, val_loss=2.77, val_accuracy=0.465, lr=0.1]  31%|███       | 31/100 [12:13<25:27, 22.13s/epoch, loss=1.15, accuracy=0.75, val_loss=2.05, val_accuracy=0.507, lr=0.1] 32%|███▏      | 32/100 [12:35<25:06, 22.16s/epoch, loss=1.14, accuracy=0.751, val_loss=1.71, val_accuracy=0.61, lr=0.1] 33%|███▎      | 33/100 [12:57<24:42, 22.13s/epoch, loss=1.13, accuracy=0.754, val_loss=1.66, val_accuracy=0.59, lr=0.1] 34%|███▍      | 34/100 [13:19<24:24, 22.19s/epoch, loss=1.15, accuracy=0.748, val_loss=1.79, val_accuracy=0.579, lr=0.1] 35%|███▌      | 35/100 [13:41<23:59, 22.15s/epoch, loss=1.14, accuracy=0.752, val_loss=1.44, val_accuracy=0.652, lr=0.1] 36%|███▌      | 36/100 [14:04<23:36, 22.14s/epoch, loss=1.14, accuracy=0.753, val_loss=1.74, val_accuracy=0.55, lr=0.1]  37%|███▋      | 37/100 [14:26<23:14, 22.14s/epoch, loss=1.15, accuracy=0.754, val_loss=1.87, val_accuracy=0.545, lr=0.1] 38%|███▊      | 38/100 [14:48<22:53, 22.16s/epoch, loss=1.14, accuracy=0.751, val_loss=1.75, val_accuracy=0.584, lr=0.1] 39%|███▉      | 39/100 [15:10<22:30, 22.15s/epoch, loss=1.14, accuracy=0.751, val_loss=2.1, val_accuracy=0.57, lr=0.1]   40%|████      | 40/100 [15:32<22:07, 22.13s/epoch, loss=1.14, accuracy=0.751, val_loss=4.57, val_accuracy=0.217, lr=0.1] 41%|████      | 41/100 [15:54<21:43, 22.10s/epoch, loss=1.14, accuracy=0.753, val_loss=2.4, val_accuracy=0.479, lr=0.1]  42%|████▏     | 42/100 [16:16<21:19, 22.06s/epoch, loss=0.928, accuracy=0.815, val_loss=0.978, val_accuracy=0.783, lr=0.01] 43%|████▎     | 43/100 [16:38<20:57, 22.05s/epoch, loss=0.747, accuracy=0.844, val_loss=0.802, val_accuracy=0.815, lr=0.01] 44%|████▍     | 44/100 [17:00<20:38, 22.11s/epoch, loss=0.664, accuracy=0.853, val_loss=0.784, val_accuracy=0.804, lr=0.01] 45%|████▌     | 45/100 [17:23<20:17, 22.14s/epoch, loss=0.615, accuracy=0.859, val_loss=0.822, val_accuracy=0.783, lr=0.01] 46%|████▌     | 46/100 [17:45<19:55, 22.15s/epoch, loss=0.591, accuracy=0.859, val_loss=0.816, val_accuracy=0.78, lr=0.01]  47%|████▋     | 47/100 [18:07<19:37, 22.23s/epoch, loss=0.583, accuracy=0.861, val_loss=0.78, val_accuracy=0.793, lr=0.01] 48%|████▊     | 48/100 [18:29<19:16, 22.23s/epoch, loss=0.572, accuracy=0.863, val_loss=0.945, val_accuracy=0.757, lr=0.01] 49%|████▉     | 49/100 [18:52<18:52, 22.21s/epoch, loss=0.572, accuracy=0.863, val_loss=0.861, val_accuracy=0.778, lr=0.01] 50%|█████     | 50/100 [19:14<18:31, 22.24s/epoch, loss=0.567, accuracy=0.865, val_loss=1.01, val_accuracy=0.733, lr=0.01]  51%|█████     | 51/100 [19:36<18:09, 22.23s/epoch, loss=0.567, accuracy=0.866, val_loss=0.974, val_accuracy=0.759, lr=0.01] 52%|█████▏    | 52/100 [19:58<17:46, 22.21s/epoch, loss=0.57, accuracy=0.864, val_loss=0.968, val_accuracy=0.759, lr=0.01]  53%|█████▎    | 53/100 [20:21<17:25, 22.24s/epoch, loss=0.564, accuracy=0.87, val_loss=0.923, val_accuracy=0.786, lr=0.01] 54%|█████▍    | 54/100 [20:43<17:03, 22.25s/epoch, loss=0.568, accuracy=0.869, val_loss=1.22, val_accuracy=0.687, lr=0.01] 55%|█████▌    | 55/100 [21:05<16:42, 22.27s/epoch, loss=0.565, accuracy=0.871, val_loss=0.863, val_accuracy=0.779, lr=0.01] 56%|█████▌    | 56/100 [21:27<16:18, 22.25s/epoch, loss=0.564, accuracy=0.873, val_loss=0.843, val_accuracy=0.798, lr=0.01] 57%|█████▋    | 57/100 [21:49<15:55, 22.23s/epoch, loss=0.56, accuracy=0.875, val_loss=0.803, val_accuracy=0.791, lr=0.01]  58%|█████▊    | 58/100 [22:12<15:36, 22.30s/epoch, loss=0.557, accuracy=0.877, val_loss=0.935, val_accuracy=0.762, lr=0.01] 59%|█████▉    | 59/100 [22:34<15:12, 22.26s/epoch, loss=0.559, accuracy=0.877, val_loss=0.889, val_accuracy=0.786, lr=0.01] 60%|██████    | 60/100 [22:56<14:48, 22.22s/epoch, loss=0.563, accuracy=0.875, val_loss=0.944, val_accuracy=0.765, lr=0.01] 61%|██████    | 61/100 [23:19<14:27, 22.23s/epoch, loss=0.559, accuracy=0.877, val_loss=0.976, val_accuracy=0.757, lr=0.01] 62%|██████▏   | 62/100 [23:41<14:05, 22.24s/epoch, loss=0.484, accuracy=0.902, val_loss=0.534, val_accuracy=0.886, lr=0.001] 63%|██████▎   | 63/100 [24:03<13:42, 22.22s/epoch, loss=0.435, accuracy=0.919, val_loss=0.506, val_accuracy=0.892, lr=0.001] 64%|██████▍   | 64/100 [24:25<13:20, 22.24s/epoch, loss=0.41, accuracy=0.927, val_loss=0.497, val_accuracy=0.893, lr=0.001]  65%|██████▌   | 65/100 [24:47<12:57, 22.22s/epoch, loss=0.396, accuracy=0.928, val_loss=0.491, val_accuracy=0.892, lr=0.001] 66%|██████▌   | 66/100 [25:09<12:33, 22.17s/epoch, loss=0.383, accuracy=0.932, val_loss=0.485, val_accuracy=0.895, lr=0.001] 67%|██████▋   | 67/100 [25:32<12:11, 22.17s/epoch, loss=0.369, accuracy=0.935, val_loss=0.489, val_accuracy=0.895, lr=0.001] 68%|██████▊   | 68/100 [25:54<11:48, 22.13s/epoch, loss=0.36, accuracy=0.937, val_loss=0.485, val_accuracy=0.892, lr=0.001]  69%|██████▉   | 69/100 [26:16<11:26, 22.14s/epoch, loss=0.35, accuracy=0.937, val_loss=0.476, val_accuracy=0.895, lr=0.001] 70%|███████   | 70/100 [26:38<11:04, 22.16s/epoch, loss=0.342, accuracy=0.939, val_loss=0.477, val_accuracy=0.895, lr=0.001] 71%|███████   | 71/100 [27:00<10:43, 22.18s/epoch, loss=0.334, accuracy=0.939, val_loss=0.461, val_accuracy=0.897, lr=0.001] 72%|███████▏  | 72/100 [27:22<10:20, 22.16s/epoch, loss=0.325, accuracy=0.942, val_loss=0.463, val_accuracy=0.896, lr=0.001] 73%|███████▎  | 73/100 [27:45<09:58, 22.16s/epoch, loss=0.316, accuracy=0.943, val_loss=0.465, val_accuracy=0.895, lr=0.001] 74%|███████▍  | 74/100 [28:07<09:36, 22.16s/epoch, loss=0.307, accuracy=0.947, val_loss=0.462, val_accuracy=0.896, lr=0.001] 75%|███████▌  | 75/100 [28:29<09:15, 22.23s/epoch, loss=0.305, accuracy=0.944, val_loss=0.479, val_accuracy=0.888, lr=0.001] 76%|███████▌  | 76/100 [28:53<09:04, 22.68s/epoch, loss=0.296, accuracy=0.948, val_loss=0.465, val_accuracy=0.895, lr=0.001] 77%|███████▋  | 77/100 [29:15<08:37, 22.50s/epoch, loss=0.291, accuracy=0.948, val_loss=0.46, val_accuracy=0.894, lr=0.001]  78%|███████▊  | 78/100 [29:37<08:10, 22.30s/epoch, loss=0.284, accuracy=0.949, val_loss=0.459, val_accuracy=0.895, lr=0.001] 79%|███████▉  | 79/100 [29:58<07:44, 22.11s/epoch, loss=0.282, accuracy=0.949, val_loss=0.477, val_accuracy=0.889, lr=0.001] 80%|████████  | 80/100 [30:20<07:20, 22.00s/epoch, loss=0.277, accuracy=0.95, val_loss=0.471, val_accuracy=0.891, lr=0.001]  81%|████████  | 81/100 [30:42<06:56, 21.93s/epoch, loss=0.274, accuracy=0.949, val_loss=0.485, val_accuracy=0.886, lr=0.001] 82%|████████▏ | 82/100 [31:04<06:33, 21.89s/epoch, loss=0.252, accuracy=0.959, val_loss=0.428, val_accuracy=0.901, lr=1e-04] 83%|████████▎ | 83/100 [31:26<06:11, 21.88s/epoch, loss=0.244, accuracy=0.961, val_loss=0.424, val_accuracy=0.903, lr=1e-04] 84%|████████▍ | 84/100 [31:47<05:48, 21.81s/epoch, loss=0.239, accuracy=0.963, val_loss=0.421, val_accuracy=0.903, lr=1e-04] 85%|████████▌ | 85/100 [32:09<05:26, 21.76s/epoch, loss=0.237, accuracy=0.964, val_loss=0.419, val_accuracy=0.904, lr=1e-04] 86%|████████▌ | 86/100 [32:31<05:04, 21.78s/epoch, loss=0.238, accuracy=0.963, val_loss=0.42, val_accuracy=0.904, lr=1e-04]  87%|████████▋ | 87/100 [32:52<04:42, 21.71s/epoch, loss=0.234, accuracy=0.965, val_loss=0.418, val_accuracy=0.905, lr=1e-04] 88%|████████▊ | 88/100 [33:14<04:19, 21.66s/epoch, loss=0.234, accuracy=0.965, val_loss=0.419, val_accuracy=0.905, lr=1e-04] 89%|████████▉ | 89/100 [33:35<03:57, 21.60s/epoch, loss=0.232, accuracy=0.965, val_loss=0.42, val_accuracy=0.903, lr=1e-04]  90%|█████████ | 90/100 [33:57<03:36, 21.64s/epoch, loss=0.23, accuracy=0.965, val_loss=0.418, val_accuracy=0.905, lr=1e-04] 91%|█████████ | 91/100 [34:18<03:14, 21.57s/epoch, loss=0.23, accuracy=0.966, val_loss=0.418, val_accuracy=0.905, lr=1e-04] 92%|█████████▏| 92/100 [34:40<02:51, 21.48s/epoch, loss=0.228, accuracy=0.966, val_loss=0.418, val_accuracy=0.906, lr=5e-5] 93%|█████████▎| 93/100 [35:01<02:30, 21.53s/epoch, loss=0.226, accuracy=0.967, val_loss=0.417, val_accuracy=0.905, lr=5e-5] 94%|█████████▍| 94/100 [35:23<02:09, 21.53s/epoch, loss=0.225, accuracy=0.967, val_loss=0.419, val_accuracy=0.905, lr=5e-5] 95%|█████████▌| 95/100 [35:44<01:47, 21.49s/epoch, loss=0.224, accuracy=0.968, val_loss=0.416, val_accuracy=0.906, lr=5e-5] 96%|█████████▌| 96/100 [36:06<01:25, 21.47s/epoch, loss=0.224, accuracy=0.968, val_loss=0.418, val_accuracy=0.906, lr=5e-5] 97%|█████████▋| 97/100 [36:27<01:04, 21.53s/epoch, loss=0.225, accuracy=0.966, val_loss=0.418, val_accuracy=0.905, lr=5e-5] 98%|█████████▊| 98/100 [36:49<00:43, 21.51s/epoch, loss=0.222, accuracy=0.968, val_loss=0.418, val_accuracy=0.906, lr=5e-5] 99%|█████████▉| 99/100 [37:10<00:21, 21.53s/epoch, loss=0.222, accuracy=0.969, val_loss=0.418, val_accuracy=0.906, lr=5e-5]100%|██████████| 100/100 [37:32<00:00, 21.54s/epoch, loss=0.222, accuracy=0.968, val_loss=0.417, val_accuracy=0.905, lr=5e-5]100%|██████████| 100/100 [37:32<00:00, 22.52s/epoch, loss=0.222, accuracy=0.968, val_loss=0.417, val_accuracy=0.905, lr=5e-5]
Using real-time data augmentation.
Only one model saved

Loading model: 15_15_cifar10_ResNet20v1.h5
Test score: 0.417019784450531
Test accuracy: 0.9047999978065491

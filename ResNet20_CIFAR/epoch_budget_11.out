Thu Feb 15 11:45:15 2024       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 535.104.05             Driver Version: 535.104.05   CUDA Version: 12.2     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA TITAN Xp                Off | 00000000:18:00.0 Off |                  N/A |
| 23%   41C    P8              10W / 250W |      0MiB / 12288MiB |      0%      Default |
|                                         |                      |                  N/A |
+-----------------------------------------+----------------------+----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
|  No running processes found                                                           |
+---------------------------------------------------------------------------------------+


* * * Run SGD for cluster size = 11. * * *


Budget: 136


* * * Run SGD for ID = 11_1. * * *


2024-02-15 11:45:15.924207: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 11:45:21.781510: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 11:45:21.783075: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-15 11:45:21.818540: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 11:45:21.818609: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 11:45:21.823740: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 11:45:21.823814: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 11:45:21.827367: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 11:45:21.828508: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 11:45:21.832628: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 11:45:21.834932: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 11:45:21.842309: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 11:45:21.843628: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 11:45:21.843722: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 11:45:23.175092: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-15 11:45:23.176069: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 11:45:23.177625: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 11:45:23.177685: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 11:45:23.177763: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 11:45:23.177789: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 11:45:23.177813: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 11:45:23.177837: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 11:45:23.177870: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 11:45:23.177903: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 11:45:23.177936: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 11:45:23.178636: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 11:45:23.178688: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 11:45:23.861194: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-15 11:45:23.861253: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-15 11:45:23.861265: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-15 11:45:23.862324: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:18:00.0, compute capability: 6.1)
{'id': 111, 'batch_size': 128, 'epochs': 136, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/136 [00:00<?, ?epoch/s]2024-02-15 11:45:24.709543: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-15 11:45:24.721659: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-02-15 11:45:26.707071: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 11:45:27.007060: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 11:45:27.864295: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-15 11:45:27.923318: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/136 [01:14<2:47:58, 74.66s/epoch, loss=3.3, accuracy=0.247, val_loss=2.71, val_accuracy=0.169, lr=0.1]  1%|▏         | 2/136 [01:43<1:46:56, 47.89s/epoch, loss=1.62, accuracy=0.493, val_loss=3.59, val_accuracy=0.267, lr=0.1]  2%|▏         | 3/136 [02:13<1:28:13, 39.80s/epoch, loss=1.41, accuracy=0.594, val_loss=2.38, val_accuracy=0.378, lr=0.1]  3%|▎         | 4/136 [02:44<1:19:27, 36.11s/epoch, loss=1.31, accuracy=0.656, val_loss=2.82, val_accuracy=0.395, lr=0.1]  4%|▎         | 5/136 [03:14<1:14:11, 33.98s/epoch, loss=1.27, accuracy=0.684, val_loss=3.19, val_accuracy=0.292, lr=0.1]  4%|▍         | 6/136 [03:44<1:10:55, 32.74s/epoch, loss=1.24, accuracy=0.698, val_loss=1.74, val_accuracy=0.513, lr=0.1]  5%|▌         | 7/136 [04:15<1:08:37, 31.91s/epoch, loss=1.23, accuracy=0.711, val_loss=1.83, val_accuracy=0.552, lr=0.1]  6%|▌         | 8/136 [04:45<1:06:45, 31.29s/epoch, loss=1.23, accuracy=0.715, val_loss=1.97, val_accuracy=0.506, lr=0.1]  7%|▋         | 9/136 [05:15<1:05:33, 30.97s/epoch, loss=1.22, accuracy=0.717, val_loss=2.1, val_accuracy=0.466, lr=0.1]   7%|▋         | 10/136 [05:45<1:04:21, 30.65s/epoch, loss=1.21, accuracy=0.727, val_loss=1.99, val_accuracy=0.484, lr=0.1]  8%|▊         | 11/136 [06:14<1:02:56, 30.21s/epoch, loss=1.2, accuracy=0.725, val_loss=4.59, val_accuracy=0.174, lr=0.0316]  9%|▉         | 12/136 [06:44<1:02:29, 30.24s/epoch, loss=1.21, accuracy=0.727, val_loss=1.6, val_accuracy=0.578, lr=0.1]    10%|▉         | 13/136 [07:14<1:01:54, 30.20s/epoch, loss=1.2, accuracy=0.731, val_loss=2.08, val_accuracy=0.467, lr=0.1] 10%|█         | 14/136 [07:45<1:01:19, 30.16s/epoch, loss=1.2, accuracy=0.734, val_loss=2.81, val_accuracy=0.425, lr=0.1] 11%|█         | 15/136 [08:15<1:00:59, 30.24s/epoch, loss=1.19, accuracy=0.734, val_loss=1.73, val_accuracy=0.579, lr=0.1] 12%|█▏        | 16/136 [08:45<1:00:31, 30.26s/epoch, loss=1.18, accuracy=0.736, val_loss=1.52, val_accuracy=0.609, lr=0.1] 12%|█▎        | 17/136 [09:15<59:33, 30.03s/epoch, loss=1.18, accuracy=0.736, val_loss=2.43, val_accuracy=0.411, lr=0.1]   13%|█▎        | 18/136 [09:45<59:00, 30.00s/epoch, loss=1.18, accuracy=0.735, val_loss=1.82, val_accuracy=0.539, lr=0.1] 14%|█▍        | 19/136 [10:15<58:35, 30.04s/epoch, loss=1.17, accuracy=0.741, val_loss=3.09, val_accuracy=0.352, lr=0.1] 15%|█▍        | 20/136 [10:44<57:49, 29.91s/epoch, loss=1.17, accuracy=0.738, val_loss=1.98, val_accuracy=0.48, lr=0.1]  15%|█▌        | 21/136 [11:14<56:56, 29.71s/epoch, loss=1.17, accuracy=0.741, val_loss=1.91, val_accuracy=0.548, lr=0.0316] 16%|█▌        | 22/136 [11:43<56:23, 29.68s/epoch, loss=1.17, accuracy=0.743, val_loss=2.13, val_accuracy=0.483, lr=0.1]    17%|█▋        | 23/136 [12:14<56:11, 29.84s/epoch, loss=1.16, accuracy=0.743, val_loss=2.36, val_accuracy=0.4, lr=0.1]   18%|█▊        | 24/136 [12:43<55:43, 29.86s/epoch, loss=1.16, accuracy=0.744, val_loss=1.64, val_accuracy=0.575, lr=0.1] 18%|█▊        | 25/136 [13:14<55:27, 29.98s/epoch, loss=1.15, accuracy=0.747, val_loss=2.64, val_accuracy=0.323, lr=0.1] 19%|█▉        | 26/136 [13:44<55:05, 30.05s/epoch, loss=1.16, accuracy=0.745, val_loss=1.69, val_accuracy=0.572, lr=0.0316] 20%|█▉        | 27/136 [14:14<54:42, 30.11s/epoch, loss=1.16, accuracy=0.748, val_loss=1.64, val_accuracy=0.595, lr=0.1]    21%|██        | 28/136 [14:45<54:27, 30.25s/epoch, loss=1.15, accuracy=0.746, val_loss=2.11, val_accuracy=0.466, lr=0.1] 21%|██▏       | 29/136 [15:14<53:21, 29.92s/epoch, loss=1.16, accuracy=0.745, val_loss=2.97, val_accuracy=0.332, lr=0.1] 22%|██▏       | 30/136 [15:44<53:01, 30.02s/epoch, loss=1.15, accuracy=0.749, val_loss=2.16, val_accuracy=0.43, lr=0.1]  23%|██▎       | 31/136 [16:14<52:39, 30.09s/epoch, loss=1.16, accuracy=0.748, val_loss=2.75, val_accuracy=0.395, lr=0.0316] 24%|██▎       | 32/136 [16:44<52:10, 30.10s/epoch, loss=1.16, accuracy=0.748, val_loss=2.01, val_accuracy=0.557, lr=0.1]    24%|██▍       | 33/136 [17:15<51:44, 30.14s/epoch, loss=1.15, accuracy=0.751, val_loss=2.16, val_accuracy=0.468, lr=0.1] 25%|██▌       | 34/136 [17:44<51:00, 30.01s/epoch, loss=1.15, accuracy=0.748, val_loss=3, val_accuracy=0.411, lr=0.1]    26%|██▌       | 35/136 [18:14<50:11, 29.82s/epoch, loss=1.15, accuracy=0.749, val_loss=4.67, val_accuracy=0.27, lr=0.1] 26%|██▋       | 36/136 [18:44<49:49, 29.90s/epoch, loss=1.15, accuracy=0.75, val_loss=1.7, val_accuracy=0.595, lr=0.0316] 27%|██▋       | 37/136 [19:14<49:16, 29.86s/epoch, loss=1.15, accuracy=0.749, val_loss=2.13, val_accuracy=0.41, lr=0.1]   28%|██▊       | 38/136 [19:44<48:54, 29.95s/epoch, loss=1.14, accuracy=0.748, val_loss=1.84, val_accuracy=0.583, lr=0.1] 29%|██▊       | 39/136 [20:13<48:16, 29.86s/epoch, loss=1.14, accuracy=0.752, val_loss=2.48, val_accuracy=0.46, lr=0.1]  29%|██▉       | 40/136 [20:43<47:37, 29.77s/epoch, loss=1.14, accuracy=0.751, val_loss=2.04, val_accuracy=0.525, lr=0.1] 30%|███       | 41/136 [21:13<47:20, 29.90s/epoch, loss=1.15, accuracy=0.749, val_loss=2.42, val_accuracy=0.403, lr=0.0316] 31%|███       | 42/136 [21:42<46:12, 29.49s/epoch, loss=1.15, accuracy=0.75, val_loss=3.33, val_accuracy=0.29, lr=0.1]      32%|███▏      | 43/136 [22:12<45:53, 29.61s/epoch, loss=1.14, accuracy=0.752, val_loss=1.79, val_accuracy=0.52, lr=0.1] 32%|███▏      | 44/136 [22:42<45:36, 29.74s/epoch, loss=1.14, accuracy=0.75, val_loss=1.74, val_accuracy=0.542, lr=0.1] 33%|███▎      | 45/136 [23:12<45:11, 29.80s/epoch, loss=1.14, accuracy=0.75, val_loss=2.08, val_accuracy=0.429, lr=0.1] 34%|███▍      | 46/136 [23:41<44:16, 29.52s/epoch, loss=1.15, accuracy=0.753, val_loss=1.7, val_accuracy=0.564, lr=0.0316] 35%|███▍      | 47/136 [24:11<44:03, 29.70s/epoch, loss=1.14, accuracy=0.754, val_loss=2.3, val_accuracy=0.476, lr=0.1]    35%|███▌      | 48/136 [24:41<43:56, 29.96s/epoch, loss=1.13, accuracy=0.753, val_loss=1.71, val_accuracy=0.557, lr=0.1] 36%|███▌      | 49/136 [25:11<43:24, 29.93s/epoch, loss=1.13, accuracy=0.751, val_loss=3.36, val_accuracy=0.353, lr=0.1] 37%|███▋      | 50/136 [25:41<42:46, 29.84s/epoch, loss=1.14, accuracy=0.751, val_loss=1.63, val_accuracy=0.604, lr=0.1] 38%|███▊      | 51/136 [26:11<42:23, 29.92s/epoch, loss=1.13, accuracy=0.754, val_loss=2.75, val_accuracy=0.444, lr=0.0316] 38%|███▊      | 52/136 [26:41<41:51, 29.90s/epoch, loss=1.14, accuracy=0.752, val_loss=3.19, val_accuracy=0.368, lr=0.1]    39%|███▉      | 53/136 [27:11<41:29, 29.99s/epoch, loss=1.14, accuracy=0.752, val_loss=1.64, val_accuracy=0.58, lr=0.1]  40%|███▉      | 54/136 [27:41<41:05, 30.06s/epoch, loss=1.14, accuracy=0.753, val_loss=2.47, val_accuracy=0.447, lr=0.1] 40%|████      | 55/136 [28:11<40:21, 29.89s/epoch, loss=1.13, accuracy=0.755, val_loss=2.64, val_accuracy=0.481, lr=0.1] 41%|████      | 56/136 [28:41<39:55, 29.94s/epoch, loss=1.13, accuracy=0.754, val_loss=2.83, val_accuracy=0.286, lr=0.0316] 42%|████▏     | 57/136 [29:11<39:25, 29.94s/epoch, loss=1.14, accuracy=0.753, val_loss=1.51, val_accuracy=0.628, lr=0.1]    43%|████▎     | 58/136 [29:40<38:41, 29.76s/epoch, loss=1.14, accuracy=0.755, val_loss=1.81, val_accuracy=0.57, lr=0.1]  43%|████▎     | 59/136 [30:10<38:22, 29.90s/epoch, loss=1.14, accuracy=0.752, val_loss=3.89, val_accuracy=0.344, lr=0.1] 44%|████▍     | 60/136 [30:40<37:53, 29.91s/epoch, loss=1.14, accuracy=0.753, val_loss=4.61, val_accuracy=0.222, lr=0.1] 45%|████▍     | 61/136 [31:10<37:32, 30.04s/epoch, loss=1.14, accuracy=0.752, val_loss=2.65, val_accuracy=0.38, lr=0.1]  46%|████▌     | 62/136 [31:40<36:51, 29.88s/epoch, loss=1.14, accuracy=0.752, val_loss=2.79, val_accuracy=0.439, lr=0.0316] 46%|████▋     | 63/136 [32:09<36:07, 29.69s/epoch, loss=1.13, accuracy=0.754, val_loss=1.95, val_accuracy=0.496, lr=0.1]    47%|████▋     | 64/136 [32:39<35:43, 29.76s/epoch, loss=1.14, accuracy=0.754, val_loss=2.06, val_accuracy=0.467, lr=0.1] 48%|████▊     | 65/136 [33:09<35:23, 29.91s/epoch, loss=1.14, accuracy=0.753, val_loss=2.18, val_accuracy=0.456, lr=0.1] 49%|████▊     | 66/136 [33:39<34:52, 29.89s/epoch, loss=1.13, accuracy=0.755, val_loss=1.67, val_accuracy=0.581, lr=0.1] 49%|████▉     | 67/136 [34:09<34:16, 29.80s/epoch, loss=1.14, accuracy=0.752, val_loss=2.61, val_accuracy=0.497, lr=0.0316] 50%|█████     | 68/136 [34:38<33:40, 29.72s/epoch, loss=1.14, accuracy=0.753, val_loss=3.11, val_accuracy=0.366, lr=0.1]    51%|█████     | 69/136 [35:07<32:48, 29.39s/epoch, loss=1.13, accuracy=0.753, val_loss=2.44, val_accuracy=0.388, lr=0.1] 51%|█████▏    | 70/136 [35:37<32:26, 29.50s/epoch, loss=1.13, accuracy=0.756, val_loss=1.66, val_accuracy=0.554, lr=0.1] 52%|█████▏    | 71/136 [36:06<31:58, 29.52s/epoch, loss=1.13, accuracy=0.756, val_loss=2.55, val_accuracy=0.412, lr=0.1] 53%|█████▎    | 72/136 [36:35<31:22, 29.41s/epoch, loss=1.13, accuracy=0.754, val_loss=1.6, val_accuracy=0.587, lr=0.0316] 54%|█████▎    | 73/136 [37:05<30:59, 29.52s/epoch, loss=1.13, accuracy=0.754, val_loss=3.15, val_accuracy=0.385, lr=0.1]   54%|█████▍    | 74/136 [37:35<30:40, 29.69s/epoch, loss=1.13, accuracy=0.757, val_loss=3.8, val_accuracy=0.385, lr=0.1]  55%|█████▌    | 75/136 [38:05<30:07, 29.64s/epoch, loss=1.13, accuracy=0.754, val_loss=1.98, val_accuracy=0.492, lr=0.1] 56%|█████▌    | 76/136 [38:34<29:36, 29.61s/epoch, loss=1.13, accuracy=0.753, val_loss=1.78, val_accuracy=0.573, lr=0.1] 57%|█████▋    | 77/136 [39:04<29:02, 29.54s/epoch, loss=1.13, accuracy=0.755, val_loss=1.98, val_accuracy=0.537, lr=0.0316] 57%|█████▋    | 78/136 [39:33<28:29, 29.48s/epoch, loss=1.13, accuracy=0.755, val_loss=1.66, val_accuracy=0.588, lr=0.1]    58%|█████▊    | 79/136 [40:02<27:56, 29.42s/epoch, loss=1.13, accuracy=0.754, val_loss=1.79, val_accuracy=0.531, lr=0.1] 59%|█████▉    | 80/136 [40:33<27:42, 29.68s/epoch, loss=1.13, accuracy=0.756, val_loss=1.59, val_accuracy=0.559, lr=0.1] 60%|█████▉    | 81/136 [41:02<27:11, 29.67s/epoch, loss=1.13, accuracy=0.753, val_loss=1.99, val_accuracy=0.544, lr=0.1] 60%|██████    | 82/136 [41:32<26:49, 29.81s/epoch, loss=0.914, accuracy=0.814, val_loss=0.878, val_accuracy=0.809, lr=0.01] 61%|██████    | 83/136 [42:01<26:00, 29.44s/epoch, loss=0.733, accuracy=0.847, val_loss=0.853, val_accuracy=0.793, lr=0.01] 62%|██████▏   | 84/136 [42:31<25:38, 29.59s/epoch, loss=0.656, accuracy=0.853, val_loss=0.727, val_accuracy=0.826, lr=0.01] 62%|██████▎   | 85/136 [43:01<25:11, 29.63s/epoch, loss=0.607, accuracy=0.86, val_loss=0.699, val_accuracy=0.825, lr=0.01]  63%|██████▎   | 86/136 [43:29<24:17, 29.15s/epoch, loss=0.591, accuracy=0.859, val_loss=0.797, val_accuracy=0.787, lr=0.01] 64%|██████▍   | 87/136 [43:59<24:04, 29.49s/epoch, loss=0.581, accuracy=0.859, val_loss=0.791, val_accuracy=0.796, lr=0.01] 65%|██████▍   | 88/136 [44:29<23:44, 29.67s/epoch, loss=0.575, accuracy=0.861, val_loss=0.796, val_accuracy=0.791, lr=0.01] 65%|██████▌   | 89/136 [44:59<23:17, 29.73s/epoch, loss=0.571, accuracy=0.862, val_loss=0.766, val_accuracy=0.8, lr=0.01]   66%|██████▌   | 90/136 [45:29<22:51, 29.82s/epoch, loss=0.568, accuracy=0.863, val_loss=1.05, val_accuracy=0.726, lr=0.00316] 67%|██████▋   | 91/136 [45:59<22:20, 29.78s/epoch, loss=0.566, accuracy=0.866, val_loss=0.818, val_accuracy=0.789, lr=0.01]   68%|██████▊   | 92/136 [46:29<21:52, 29.84s/epoch, loss=0.563, accuracy=0.866, val_loss=0.829, val_accuracy=0.782, lr=0.01] 68%|██████▊   | 93/136 [46:58<21:19, 29.76s/epoch, loss=0.564, accuracy=0.866, val_loss=0.8, val_accuracy=0.801, lr=0.01]   69%|██████▉   | 94/136 [47:28<20:48, 29.72s/epoch, loss=0.564, accuracy=0.869, val_loss=0.957, val_accuracy=0.761, lr=0.01] 70%|██████▉   | 95/136 [47:58<20:19, 29.75s/epoch, loss=0.559, accuracy=0.872, val_loss=0.846, val_accuracy=0.783, lr=0.00316] 71%|███████   | 96/136 [48:27<19:51, 29.78s/epoch, loss=0.564, accuracy=0.871, val_loss=0.901, val_accuracy=0.765, lr=0.01]    71%|███████▏  | 97/136 [48:56<19:01, 29.26s/epoch, loss=0.564, accuracy=0.869, val_loss=0.832, val_accuracy=0.783, lr=0.01] 72%|███████▏  | 98/136 [49:25<18:37, 29.40s/epoch, loss=0.561, accuracy=0.872, val_loss=0.795, val_accuracy=0.797, lr=0.01] 73%|███████▎  | 99/136 [49:55<18:12, 29.52s/epoch, loss=0.563, accuracy=0.872, val_loss=0.975, val_accuracy=0.748, lr=0.01] 74%|███████▎  | 100/136 [50:25<17:42, 29.53s/epoch, loss=0.564, accuracy=0.872, val_loss=0.781, val_accuracy=0.802, lr=0.00316] 74%|███████▍  | 101/136 [50:54<17:11, 29.47s/epoch, loss=0.56, accuracy=0.875, val_loss=0.84, val_accuracy=0.79, lr=0.01]       75%|███████▌  | 102/136 [51:23<16:41, 29.46s/epoch, loss=0.563, accuracy=0.874, val_loss=0.953, val_accuracy=0.754, lr=0.01] 76%|███████▌  | 103/136 [51:53<16:15, 29.56s/epoch, loss=0.561, accuracy=0.876, val_loss=0.891, val_accuracy=0.777, lr=0.01] 76%|███████▋  | 104/136 [52:23<15:50, 29.69s/epoch, loss=0.557, accuracy=0.877, val_loss=0.884, val_accuracy=0.781, lr=0.01] 77%|███████▋  | 105/136 [52:53<15:18, 29.64s/epoch, loss=0.565, accuracy=0.876, val_loss=0.751, val_accuracy=0.816, lr=0.00316] 78%|███████▊  | 106/136 [53:21<14:39, 29.32s/epoch, loss=0.56, accuracy=0.879, val_loss=0.84, val_accuracy=0.787, lr=0.01]      79%|███████▊  | 107/136 [53:50<14:05, 29.15s/epoch, loss=0.56, accuracy=0.878, val_loss=0.895, val_accuracy=0.775, lr=0.01] 79%|███████▉  | 108/136 [54:19<13:36, 29.14s/epoch, loss=0.562, accuracy=0.875, val_loss=0.944, val_accuracy=0.77, lr=0.01] 80%|████████  | 109/136 [54:49<13:11, 29.30s/epoch, loss=0.561, accuracy=0.879, val_loss=0.957, val_accuracy=0.753, lr=0.01] 81%|████████  | 110/136 [55:19<12:45, 29.42s/epoch, loss=0.56, accuracy=0.878, val_loss=0.956, val_accuracy=0.745, lr=0.00316] 82%|████████▏ | 111/136 [55:47<12:09, 29.20s/epoch, loss=0.558, accuracy=0.879, val_loss=0.963, val_accuracy=0.737, lr=0.01]   82%|████████▏ | 112/136 [56:16<11:41, 29.22s/epoch, loss=0.561, accuracy=0.879, val_loss=0.792, val_accuracy=0.799, lr=0.01] 83%|████████▎ | 113/136 [56:46<11:16, 29.41s/epoch, loss=0.557, accuracy=0.881, val_loss=0.799, val_accuracy=0.798, lr=0.01] 84%|████████▍ | 114/136 [57:16<10:48, 29.46s/epoch, loss=0.56, accuracy=0.879, val_loss=0.811, val_accuracy=0.802, lr=0.01]  85%|████████▍ | 115/136 [57:46<10:21, 29.60s/epoch, loss=0.553, accuracy=0.882, val_loss=0.945, val_accuracy=0.766, lr=0.00316] 85%|████████▌ | 116/136 [58:16<09:54, 29.73s/epoch, loss=0.557, accuracy=0.881, val_loss=0.883, val_accuracy=0.786, lr=0.01]    86%|████████▌ | 117/136 [58:45<09:19, 29.47s/epoch, loss=0.555, accuracy=0.88, val_loss=0.789, val_accuracy=0.812, lr=0.01]  87%|████████▋ | 118/136 [59:13<08:43, 29.11s/epoch, loss=0.558, accuracy=0.88, val_loss=0.873, val_accuracy=0.79, lr=0.01]  88%|████████▊ | 119/136 [59:42<08:12, 28.99s/epoch, loss=0.554, accuracy=0.882, val_loss=0.809, val_accuracy=0.797, lr=0.01] 88%|████████▊ | 120/136 [1:00:11<07:46, 29.13s/epoch, loss=0.556, accuracy=0.882, val_loss=0.941, val_accuracy=0.778, lr=0.00316] 89%|████████▉ | 121/136 [1:00:41<07:19, 29.30s/epoch, loss=0.556, accuracy=0.883, val_loss=0.864, val_accuracy=0.79, lr=0.01]     90%|████████▉ | 122/136 [1:01:11<06:52, 29.43s/epoch, loss=0.481, accuracy=0.908, val_loss=0.539, val_accuracy=0.892, lr=0.001] 90%|█████████ | 123/136 [1:01:40<06:22, 29.46s/epoch, loss=0.425, accuracy=0.925, val_loss=0.525, val_accuracy=0.894, lr=0.001] 91%|█████████ | 124/136 [1:02:09<05:53, 29.42s/epoch, loss=0.405, accuracy=0.932, val_loss=0.522, val_accuracy=0.894, lr=0.001] 92%|█████████▏| 125/136 [1:02:39<05:24, 29.54s/epoch, loss=0.386, accuracy=0.935, val_loss=0.502, val_accuracy=0.896, lr=0.001] 93%|█████████▎| 126/136 [1:03:09<04:56, 29.63s/epoch, loss=0.377, accuracy=0.937, val_loss=0.497, val_accuracy=0.9, lr=0.001]   93%|█████████▎| 127/136 [1:03:39<04:26, 29.64s/epoch, loss=0.363, accuracy=0.94, val_loss=0.495, val_accuracy=0.899, lr=0.001] 94%|█████████▍| 128/136 [1:04:09<03:57, 29.68s/epoch, loss=0.349, accuracy=0.943, val_loss=0.493, val_accuracy=0.9, lr=0.001]  95%|█████████▍| 129/136 [1:04:38<03:27, 29.69s/epoch, loss=0.341, accuracy=0.944, val_loss=0.487, val_accuracy=0.9, lr=0.001] 96%|█████████▌| 130/136 [1:05:08<02:57, 29.66s/epoch, loss=0.331, accuracy=0.946, val_loss=0.49, val_accuracy=0.897, lr=0.001] 96%|█████████▋| 131/136 [1:05:37<02:27, 29.51s/epoch, loss=0.323, accuracy=0.947, val_loss=0.487, val_accuracy=0.897, lr=0.001] 97%|█████████▋| 132/136 [1:06:07<01:58, 29.69s/epoch, loss=0.316, accuracy=0.948, val_loss=0.491, val_accuracy=0.895, lr=0.001] 98%|█████████▊| 133/136 [1:06:37<01:29, 29.79s/epoch, loss=0.306, accuracy=0.95, val_loss=0.462, val_accuracy=0.9, lr=0.001]    99%|█████████▊| 134/136 [1:07:07<00:59, 29.76s/epoch, loss=0.299, accuracy=0.951, val_loss=0.479, val_accuracy=0.898, lr=0.001] 99%|█████████▉| 135/136 [1:07:37<00:29, 29.77s/epoch, loss=0.293, accuracy=0.951, val_loss=0.485, val_accuracy=0.896, lr=0.001]100%|██████████| 136/136 [1:08:06<00:00, 29.75s/epoch, loss=0.291, accuracy=0.95, val_loss=0.483, val_accuracy=0.895, lr=0.001] 100%|██████████| 136/136 [1:08:06<00:00, 30.05s/epoch, loss=0.291, accuracy=0.95, val_loss=0.483, val_accuracy=0.895, lr=0.001]
Using real-time data augmentation.
Test loss: 0.48288604617118835
Test accuracy: 0.8952000141143799


* * * Run SGD for ID = 11_2. * * *


2024-02-15 12:53:35.385866: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 12:53:44.374024: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 12:53:44.375589: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-15 12:53:44.420256: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 12:53:44.420306: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 12:53:44.428154: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 12:53:44.428242: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 12:53:44.431791: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 12:53:44.433153: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 12:53:44.436957: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 12:53:44.439155: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 12:53:44.445798: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 12:53:44.446563: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 12:53:44.446673: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 12:53:45.823389: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-15 12:53:45.824156: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 12:53:45.827250: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 12:53:45.827308: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 12:53:45.827386: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 12:53:45.827413: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 12:53:45.827432: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 12:53:45.827451: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 12:53:45.827468: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 12:53:45.827484: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 12:53:45.827500: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 12:53:45.828160: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 12:53:45.828202: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 12:53:46.533979: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-15 12:53:46.534044: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-15 12:53:46.534057: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-15 12:53:46.535225: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:18:00.0, compute capability: 6.1)
{'id': 112, 'batch_size': 128, 'epochs': 136, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/136 [00:00<?, ?epoch/s]2024-02-15 12:53:47.359945: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-15 12:53:47.372676: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-02-15 12:53:49.489824: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 12:53:49.776117: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 12:53:51.019895: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-15 12:53:51.076600: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/136 [01:16<2:51:21, 76.16s/epoch, loss=3.22, accuracy=0.258, val_loss=2.6, val_accuracy=0.223, lr=0.1]  1%|▏         | 2/136 [01:46<1:49:43, 49.13s/epoch, loss=1.68, accuracy=0.463, val_loss=1.78, val_accuracy=0.435, lr=0.1]  2%|▏         | 3/136 [02:16<1:29:21, 40.31s/epoch, loss=1.4, accuracy=0.6, val_loss=1.65, val_accuracy=0.544, lr=0.1]     3%|▎         | 4/136 [02:46<1:19:49, 36.29s/epoch, loss=1.29, accuracy=0.669, val_loss=2.59, val_accuracy=0.306, lr=0.1]  4%|▎         | 5/136 [03:16<1:14:16, 34.02s/epoch, loss=1.27, accuracy=0.689, val_loss=2.35, val_accuracy=0.396, lr=0.1]  4%|▍         | 6/136 [03:46<1:10:44, 32.65s/epoch, loss=1.24, accuracy=0.703, val_loss=2.43, val_accuracy=0.409, lr=0.1]  5%|▌         | 7/136 [04:16<1:08:36, 31.91s/epoch, loss=1.23, accuracy=0.711, val_loss=1.53, val_accuracy=0.589, lr=0.1]  6%|▌         | 8/136 [04:46<1:06:27, 31.15s/epoch, loss=1.22, accuracy=0.723, val_loss=1.77, val_accuracy=0.559, lr=0.1]  7%|▋         | 9/136 [05:16<1:05:27, 30.92s/epoch, loss=1.22, accuracy=0.723, val_loss=2.36, val_accuracy=0.424, lr=0.1]  7%|▋         | 10/136 [05:46<1:04:35, 30.75s/epoch, loss=1.21, accuracy=0.725, val_loss=1.75, val_accuracy=0.573, lr=0.1]  8%|▊         | 11/136 [06:16<1:03:21, 30.41s/epoch, loss=1.21, accuracy=0.728, val_loss=1.91, val_accuracy=0.478, lr=0.1]  9%|▉         | 12/136 [06:46<1:02:37, 30.31s/epoch, loss=1.19, accuracy=0.733, val_loss=2.17, val_accuracy=0.455, lr=0.0316] 10%|▉         | 13/136 [07:16<1:01:55, 30.20s/epoch, loss=1.19, accuracy=0.732, val_loss=1.72, val_accuracy=0.534, lr=0.1]    10%|█         | 14/136 [07:46<1:01:25, 30.21s/epoch, loss=1.18, accuracy=0.74, val_loss=1.99, val_accuracy=0.498, lr=0.1]  11%|█         | 15/136 [08:17<1:01:02, 30.27s/epoch, loss=1.18, accuracy=0.738, val_loss=2.4, val_accuracy=0.304, lr=0.1] 12%|█▏        | 16/136 [08:47<1:00:17, 30.15s/epoch, loss=1.17, accuracy=0.739, val_loss=1.68, val_accuracy=0.576, lr=0.1] 12%|█▎        | 17/136 [09:17<59:55, 30.21s/epoch, loss=1.17, accuracy=0.741, val_loss=1.84, val_accuracy=0.522, lr=0.0316] 13%|█▎        | 18/136 [09:47<59:26, 30.22s/epoch, loss=1.16, accuracy=0.741, val_loss=1.66, val_accuracy=0.561, lr=0.1]    14%|█▍        | 19/136 [10:18<59:06, 30.31s/epoch, loss=1.16, accuracy=0.744, val_loss=2.1, val_accuracy=0.456, lr=0.1]  15%|█▍        | 20/136 [10:48<58:22, 30.19s/epoch, loss=1.16, accuracy=0.745, val_loss=1.4, val_accuracy=0.657, lr=0.1] 15%|█▌        | 21/136 [11:18<57:48, 30.16s/epoch, loss=1.16, accuracy=0.745, val_loss=2.68, val_accuracy=0.419, lr=0.1] 16%|█▌        | 22/136 [11:48<57:15, 30.14s/epoch, loss=1.15, accuracy=0.746, val_loss=2.68, val_accuracy=0.287, lr=0.1] 17%|█▋        | 23/136 [12:18<56:36, 30.06s/epoch, loss=1.15, accuracy=0.747, val_loss=1.59, val_accuracy=0.598, lr=0.1] 18%|█▊        | 24/136 [12:48<56:05, 30.05s/epoch, loss=1.15, accuracy=0.748, val_loss=2.29, val_accuracy=0.454, lr=0.1] 18%|█▊        | 25/136 [13:19<55:57, 30.25s/epoch, loss=1.15, accuracy=0.744, val_loss=1.54, val_accuracy=0.605, lr=0.0316] 19%|█▉        | 26/136 [13:49<55:31, 30.29s/epoch, loss=1.15, accuracy=0.748, val_loss=3.41, val_accuracy=0.366, lr=0.1]    20%|█▉        | 27/136 [14:19<55:03, 30.30s/epoch, loss=1.15, accuracy=0.75, val_loss=2.11, val_accuracy=0.49, lr=0.1]   21%|██        | 28/136 [14:49<54:26, 30.25s/epoch, loss=1.14, accuracy=0.75, val_loss=2.48, val_accuracy=0.451, lr=0.1] 21%|██▏       | 29/136 [15:20<53:54, 30.23s/epoch, loss=1.14, accuracy=0.751, val_loss=2.37, val_accuracy=0.385, lr=0.1] 22%|██▏       | 30/136 [15:50<53:18, 30.18s/epoch, loss=1.15, accuracy=0.747, val_loss=2.85, val_accuracy=0.409, lr=0.0316] 23%|██▎       | 31/136 [16:20<52:54, 30.23s/epoch, loss=1.15, accuracy=0.745, val_loss=2.29, val_accuracy=0.509, lr=0.1]    24%|██▎       | 32/136 [16:50<52:14, 30.14s/epoch, loss=1.15, accuracy=0.749, val_loss=1.56, val_accuracy=0.623, lr=0.1] 24%|██▍       | 33/136 [17:20<51:47, 30.17s/epoch, loss=1.13, accuracy=0.753, val_loss=2.01, val_accuracy=0.518, lr=0.1] 25%|██▌       | 34/136 [17:50<50:58, 29.99s/epoch, loss=1.15, accuracy=0.748, val_loss=1.7, val_accuracy=0.576, lr=0.1]  26%|██▌       | 35/136 [18:20<50:40, 30.11s/epoch, loss=1.14, accuracy=0.75, val_loss=1.93, val_accuracy=0.542, lr=0.0316] 26%|██▋       | 36/136 [18:49<49:38, 29.78s/epoch, loss=1.13, accuracy=0.752, val_loss=1.8, val_accuracy=0.538, lr=0.1]    27%|██▋       | 37/136 [19:19<49:21, 29.92s/epoch, loss=1.14, accuracy=0.749, val_loss=1.73, val_accuracy=0.565, lr=0.1] 28%|██▊       | 38/136 [19:49<48:41, 29.82s/epoch, loss=1.13, accuracy=0.751, val_loss=2.05, val_accuracy=0.458, lr=0.1] 29%|██▊       | 39/136 [20:19<48:18, 29.88s/epoch, loss=1.13, accuracy=0.752, val_loss=2.09, val_accuracy=0.493, lr=0.1] 29%|██▉       | 40/136 [20:49<47:43, 29.83s/epoch, loss=1.13, accuracy=0.754, val_loss=3.65, val_accuracy=0.249, lr=0.0316] 30%|███       | 41/136 [21:18<47:05, 29.75s/epoch, loss=1.14, accuracy=0.753, val_loss=2.35, val_accuracy=0.476, lr=0.1]    31%|███       | 42/136 [21:48<46:44, 29.83s/epoch, loss=1.13, accuracy=0.754, val_loss=1.88, val_accuracy=0.516, lr=0.1] 32%|███▏      | 43/136 [22:18<46:26, 29.96s/epoch, loss=1.13, accuracy=0.755, val_loss=2.17, val_accuracy=0.513, lr=0.1] 32%|███▏      | 44/136 [22:49<46:10, 30.12s/epoch, loss=1.13, accuracy=0.752, val_loss=2.3, val_accuracy=0.465, lr=0.1]  33%|███▎      | 45/136 [23:19<45:38, 30.10s/epoch, loss=1.13, accuracy=0.755, val_loss=2.96, val_accuracy=0.369, lr=0.0316] 34%|███▍      | 46/136 [23:48<44:49, 29.88s/epoch, loss=1.13, accuracy=0.75, val_loss=5.1, val_accuracy=0.312, lr=0.1]      35%|███▍      | 47/136 [24:18<43:59, 29.65s/epoch, loss=1.14, accuracy=0.752, val_loss=2.89, val_accuracy=0.412, lr=0.1] 35%|███▌      | 48/136 [24:47<43:34, 29.71s/epoch, loss=1.13, accuracy=0.752, val_loss=2.05, val_accuracy=0.424, lr=0.1] 36%|███▌      | 49/136 [25:18<43:16, 29.84s/epoch, loss=1.13, accuracy=0.754, val_loss=2.3, val_accuracy=0.448, lr=0.1]  37%|███▋      | 50/136 [25:48<43:05, 30.06s/epoch, loss=1.13, accuracy=0.753, val_loss=2.75, val_accuracy=0.432, lr=0.0316] 38%|███▊      | 51/136 [26:18<42:41, 30.13s/epoch, loss=1.14, accuracy=0.754, val_loss=1.75, val_accuracy=0.555, lr=0.1]    38%|███▊      | 52/136 [26:48<42:00, 30.01s/epoch, loss=1.13, accuracy=0.753, val_loss=2.64, val_accuracy=0.429, lr=0.1] 39%|███▉      | 53/136 [27:18<41:24, 29.94s/epoch, loss=1.13, accuracy=0.753, val_loss=1.69, val_accuracy=0.575, lr=0.1] 40%|███▉      | 54/136 [27:49<41:16, 30.20s/epoch, loss=1.12, accuracy=0.753, val_loss=2.78, val_accuracy=0.255, lr=0.1] 40%|████      | 55/136 [28:19<40:56, 30.33s/epoch, loss=1.12, accuracy=0.756, val_loss=2.26, val_accuracy=0.396, lr=0.0316] 41%|████      | 56/136 [28:49<40:21, 30.27s/epoch, loss=1.12, accuracy=0.751, val_loss=2.73, val_accuracy=0.376, lr=0.1]    42%|████▏     | 57/136 [29:20<39:46, 30.21s/epoch, loss=1.13, accuracy=0.751, val_loss=1.79, val_accuracy=0.539, lr=0.1] 43%|████▎     | 58/136 [29:49<39:08, 30.11s/epoch, loss=1.13, accuracy=0.752, val_loss=1.87, val_accuracy=0.52, lr=0.1]  43%|████▎     | 59/136 [30:20<38:40, 30.13s/epoch, loss=1.13, accuracy=0.754, val_loss=2.89, val_accuracy=0.415, lr=0.1] 44%|████▍     | 60/136 [30:50<38:06, 30.09s/epoch, loss=1.12, accuracy=0.758, val_loss=2.34, val_accuracy=0.436, lr=0.0316] 45%|████▍     | 61/136 [31:20<37:41, 30.15s/epoch, loss=1.13, accuracy=0.752, val_loss=2.34, val_accuracy=0.466, lr=0.1]    46%|████▌     | 62/136 [31:50<37:17, 30.24s/epoch, loss=1.13, accuracy=0.753, val_loss=2.02, val_accuracy=0.448, lr=0.1] 46%|████▋     | 63/136 [32:20<36:45, 30.22s/epoch, loss=1.12, accuracy=0.755, val_loss=1.71, val_accuracy=0.577, lr=0.1] 47%|████▋     | 64/136 [32:51<36:19, 30.27s/epoch, loss=1.12, accuracy=0.756, val_loss=1.54, val_accuracy=0.623, lr=0.1] 48%|████▊     | 65/136 [33:21<35:36, 30.09s/epoch, loss=1.12, accuracy=0.756, val_loss=2.65, val_accuracy=0.438, lr=0.0316] 49%|████▊     | 66/136 [33:50<34:58, 29.99s/epoch, loss=1.12, accuracy=0.755, val_loss=2.5, val_accuracy=0.466, lr=0.1]     49%|████▉     | 67/136 [34:19<34:12, 29.75s/epoch, loss=1.12, accuracy=0.755, val_loss=4.42, val_accuracy=0.319, lr=0.1] 50%|█████     | 68/136 [34:50<33:49, 29.85s/epoch, loss=1.12, accuracy=0.753, val_loss=1.75, val_accuracy=0.572, lr=0.1] 51%|█████     | 69/136 [35:20<33:24, 29.92s/epoch, loss=1.13, accuracy=0.755, val_loss=1.93, val_accuracy=0.541, lr=0.1] 51%|█████▏    | 70/136 [35:50<32:57, 29.97s/epoch, loss=1.12, accuracy=0.757, val_loss=1.64, val_accuracy=0.582, lr=0.0316] 52%|█████▏    | 71/136 [36:19<32:15, 29.78s/epoch, loss=1.12, accuracy=0.756, val_loss=2.55, val_accuracy=0.349, lr=0.1]    53%|█████▎    | 72/136 [36:48<31:35, 29.62s/epoch, loss=1.12, accuracy=0.753, val_loss=2.03, val_accuracy=0.465, lr=0.1] 54%|█████▎    | 73/136 [37:18<31:03, 29.58s/epoch, loss=1.12, accuracy=0.754, val_loss=2.53, val_accuracy=0.43, lr=0.1]  54%|█████▍    | 74/136 [37:48<30:46, 29.77s/epoch, loss=1.12, accuracy=0.755, val_loss=4.28, val_accuracy=0.346, lr=0.1] 55%|█████▌    | 75/136 [38:17<30:09, 29.66s/epoch, loss=1.12, accuracy=0.754, val_loss=2.81, val_accuracy=0.376, lr=0.0316] 56%|█████▌    | 76/136 [38:47<29:37, 29.62s/epoch, loss=1.12, accuracy=0.753, val_loss=3.06, val_accuracy=0.437, lr=0.1]    57%|█████▋    | 77/136 [39:17<29:20, 29.83s/epoch, loss=1.12, accuracy=0.755, val_loss=3.56, val_accuracy=0.234, lr=0.1] 57%|█████▋    | 78/136 [39:47<28:55, 29.92s/epoch, loss=1.12, accuracy=0.755, val_loss=2.85, val_accuracy=0.396, lr=0.1] 58%|█████▊    | 79/136 [40:18<28:30, 30.01s/epoch, loss=1.13, accuracy=0.755, val_loss=1.67, val_accuracy=0.572, lr=0.1] 59%|█████▉    | 80/136 [40:48<28:02, 30.05s/epoch, loss=1.12, accuracy=0.754, val_loss=1.48, val_accuracy=0.653, lr=0.0316] 60%|█████▉    | 81/136 [41:17<27:20, 29.83s/epoch, loss=1.12, accuracy=0.757, val_loss=2.57, val_accuracy=0.41, lr=0.1]     60%|██████    | 82/136 [41:46<26:35, 29.55s/epoch, loss=0.909, accuracy=0.815, val_loss=0.914, val_accuracy=0.797, lr=0.01] 61%|██████    | 83/136 [42:16<26:14, 29.71s/epoch, loss=0.734, accuracy=0.845, val_loss=0.816, val_accuracy=0.803, lr=0.01] 62%|██████▏   | 84/136 [42:45<25:31, 29.45s/epoch, loss=0.656, accuracy=0.854, val_loss=0.746, val_accuracy=0.817, lr=0.01] 62%|██████▎   | 85/136 [43:16<25:24, 29.89s/epoch, loss=0.617, accuracy=0.854, val_loss=0.783, val_accuracy=0.798, lr=0.01] 63%|██████▎   | 86/136 [43:45<24:42, 29.64s/epoch, loss=0.59, accuracy=0.858, val_loss=0.81, val_accuracy=0.776, lr=0.01]   64%|██████▍   | 87/136 [44:15<24:13, 29.67s/epoch, loss=0.58, accuracy=0.858, val_loss=0.864, val_accuracy=0.775, lr=0.01] 65%|██████▍   | 88/136 [44:44<23:39, 29.57s/epoch, loss=0.571, accuracy=0.861, val_loss=0.881, val_accuracy=0.761, lr=0.01] 65%|██████▌   | 89/136 [45:14<23:15, 29.68s/epoch, loss=0.57, accuracy=0.862, val_loss=0.969, val_accuracy=0.756, lr=0.00316] 66%|██████▌   | 90/136 [45:43<22:40, 29.58s/epoch, loss=0.572, accuracy=0.861, val_loss=0.77, val_accuracy=0.8, lr=0.01]      67%|██████▋   | 91/136 [46:12<22:03, 29.42s/epoch, loss=0.566, accuracy=0.864, val_loss=0.846, val_accuracy=0.781, lr=0.01] 68%|██████▊   | 92/136 [46:42<21:34, 29.43s/epoch, loss=0.566, accuracy=0.866, val_loss=0.862, val_accuracy=0.769, lr=0.01] 68%|██████▊   | 93/136 [47:11<21:03, 29.38s/epoch, loss=0.563, accuracy=0.868, val_loss=0.895, val_accuracy=0.761, lr=0.01] 69%|██████▉   | 94/136 [47:41<20:36, 29.44s/epoch, loss=0.564, accuracy=0.867, val_loss=0.732, val_accuracy=0.815, lr=0.01] 70%|██████▉   | 95/136 [48:10<20:07, 29.44s/epoch, loss=0.559, accuracy=0.871, val_loss=0.769, val_accuracy=0.806, lr=0.01] 71%|███████   | 96/136 [48:40<19:41, 29.53s/epoch, loss=0.565, accuracy=0.87, val_loss=0.726, val_accuracy=0.819, lr=0.01]  71%|███████▏  | 97/136 [49:09<19:13, 29.59s/epoch, loss=0.562, accuracy=0.87, val_loss=0.862, val_accuracy=0.782, lr=0.01] 72%|███████▏  | 98/136 [49:38<18:34, 29.33s/epoch, loss=0.562, accuracy=0.872, val_loss=0.898, val_accuracy=0.758, lr=0.01] 73%|███████▎  | 99/136 [50:08<18:12, 29.54s/epoch, loss=0.558, accuracy=0.873, val_loss=0.853, val_accuracy=0.788, lr=0.01] 74%|███████▎  | 100/136 [50:38<17:41, 29.50s/epoch, loss=0.557, accuracy=0.875, val_loss=0.851, val_accuracy=0.784, lr=0.01] 74%|███████▍  | 101/136 [51:08<17:16, 29.61s/epoch, loss=0.561, accuracy=0.873, val_loss=0.78, val_accuracy=0.805, lr=0.00316] 75%|███████▌  | 102/136 [51:37<16:50, 29.72s/epoch, loss=0.558, accuracy=0.876, val_loss=0.867, val_accuracy=0.782, lr=0.01]   76%|███████▌  | 103/136 [52:07<16:23, 29.80s/epoch, loss=0.554, accuracy=0.878, val_loss=0.93, val_accuracy=0.764, lr=0.01]  76%|███████▋  | 104/136 [52:37<15:52, 29.77s/epoch, loss=0.556, accuracy=0.876, val_loss=0.744, val_accuracy=0.814, lr=0.01] 77%|███████▋  | 105/136 [53:07<15:22, 29.75s/epoch, loss=0.562, accuracy=0.875, val_loss=0.909, val_accuracy=0.753, lr=0.01] 78%|███████▊  | 106/136 [53:36<14:48, 29.62s/epoch, loss=0.56, accuracy=0.877, val_loss=0.856, val_accuracy=0.782, lr=0.00316] 79%|███████▊  | 107/136 [54:05<14:15, 29.49s/epoch, loss=0.559, accuracy=0.879, val_loss=0.819, val_accuracy=0.792, lr=0.01]   79%|███████▉  | 108/136 [54:35<13:48, 29.60s/epoch, loss=0.56, accuracy=0.877, val_loss=0.877, val_accuracy=0.783, lr=0.01]  80%|████████  | 109/136 [55:05<13:19, 29.60s/epoch, loss=0.555, accuracy=0.879, val_loss=0.742, val_accuracy=0.817, lr=0.01] 81%|████████  | 110/136 [55:35<12:50, 29.64s/epoch, loss=0.557, accuracy=0.878, val_loss=0.989, val_accuracy=0.756, lr=0.01] 82%|████████▏ | 111/136 [56:04<12:19, 29.57s/epoch, loss=0.56, accuracy=0.88, val_loss=0.772, val_accuracy=0.814, lr=0.00316] 82%|████████▏ | 112/136 [56:34<11:50, 29.61s/epoch, loss=0.558, accuracy=0.879, val_loss=0.851, val_accuracy=0.788, lr=0.01]  83%|████████▎ | 113/136 [57:04<11:23, 29.72s/epoch, loss=0.555, accuracy=0.88, val_loss=0.744, val_accuracy=0.817, lr=0.01]  84%|████████▍ | 114/136 [57:33<10:54, 29.73s/epoch, loss=0.554, accuracy=0.881, val_loss=1.01, val_accuracy=0.755, lr=0.01] 85%|████████▍ | 115/136 [58:03<10:23, 29.71s/epoch, loss=0.554, accuracy=0.881, val_loss=0.847, val_accuracy=0.794, lr=0.01] 85%|████████▌ | 116/136 [58:32<09:51, 29.60s/epoch, loss=0.557, accuracy=0.88, val_loss=1.05, val_accuracy=0.747, lr=0.00316] 86%|████████▌ | 117/136 [59:02<09:20, 29.50s/epoch, loss=0.557, accuracy=0.881, val_loss=1.06, val_accuracy=0.736, lr=0.01]   87%|████████▋ | 118/136 [59:31<08:50, 29.45s/epoch, loss=0.555, accuracy=0.882, val_loss=0.787, val_accuracy=0.811, lr=0.01] 88%|████████▊ | 119/136 [1:00:00<08:20, 29.44s/epoch, loss=0.556, accuracy=0.884, val_loss=0.719, val_accuracy=0.829, lr=0.01] 88%|████████▊ | 120/136 [1:00:30<07:52, 29.55s/epoch, loss=0.553, accuracy=0.882, val_loss=1.14, val_accuracy=0.731, lr=0.01]  89%|████████▉ | 121/136 [1:01:00<07:23, 29.58s/epoch, loss=0.555, accuracy=0.883, val_loss=0.823, val_accuracy=0.805, lr=0.01] 90%|████████▉ | 122/136 [1:01:30<06:55, 29.71s/epoch, loss=0.484, accuracy=0.907, val_loss=0.528, val_accuracy=0.89, lr=0.001] 90%|█████████ | 123/136 [1:02:00<06:27, 29.83s/epoch, loss=0.429, accuracy=0.925, val_loss=0.516, val_accuracy=0.892, lr=0.001] 91%|█████████ | 124/136 [1:02:30<05:57, 29.82s/epoch, loss=0.408, accuracy=0.931, val_loss=0.507, val_accuracy=0.894, lr=0.001] 92%|█████████▏| 125/136 [1:03:00<05:28, 29.85s/epoch, loss=0.389, accuracy=0.934, val_loss=0.499, val_accuracy=0.893, lr=0.001] 93%|█████████▎| 126/136 [1:03:29<04:56, 29.69s/epoch, loss=0.375, accuracy=0.938, val_loss=0.489, val_accuracy=0.896, lr=0.001] 93%|█████████▎| 127/136 [1:03:59<04:27, 29.70s/epoch, loss=0.362, accuracy=0.939, val_loss=0.489, val_accuracy=0.895, lr=0.001] 94%|█████████▍| 128/136 [1:04:28<03:57, 29.69s/epoch, loss=0.352, accuracy=0.942, val_loss=0.477, val_accuracy=0.899, lr=0.001] 95%|█████████▍| 129/136 [1:04:58<03:27, 29.68s/epoch, loss=0.344, accuracy=0.944, val_loss=0.475, val_accuracy=0.898, lr=0.001] 96%|█████████▌| 130/136 [1:05:28<02:58, 29.75s/epoch, loss=0.332, accuracy=0.946, val_loss=0.477, val_accuracy=0.899, lr=0.001] 96%|█████████▋| 131/136 [1:05:57<02:28, 29.61s/epoch, loss=0.324, accuracy=0.946, val_loss=0.475, val_accuracy=0.895, lr=0.001] 97%|█████████▋| 132/136 [1:06:27<01:58, 29.58s/epoch, loss=0.317, accuracy=0.947, val_loss=0.469, val_accuracy=0.895, lr=0.001] 98%|█████████▊| 133/136 [1:06:57<01:28, 29.65s/epoch, loss=0.308, accuracy=0.949, val_loss=0.468, val_accuracy=0.896, lr=0.001] 99%|█████████▊| 134/136 [1:07:27<00:59, 29.76s/epoch, loss=0.305, accuracy=0.949, val_loss=0.473, val_accuracy=0.896, lr=0.001] 99%|█████████▉| 135/136 [1:07:56<00:29, 29.69s/epoch, loss=0.294, accuracy=0.952, val_loss=0.462, val_accuracy=0.9, lr=0.001]  100%|██████████| 136/136 [1:08:24<00:00, 29.18s/epoch, loss=0.289, accuracy=0.951, val_loss=0.472, val_accuracy=0.895, lr=0.001]100%|██████████| 136/136 [1:08:24<00:00, 30.18s/epoch, loss=0.289, accuracy=0.951, val_loss=0.472, val_accuracy=0.895, lr=0.001]
Using real-time data augmentation.
Test loss: 0.47249409556388855
Test accuracy: 0.8945000171661377


* * * Run SGD for ID = 11_3. * * *


2024-02-15 14:02:14.843501: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 14:02:19.742867: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 14:02:19.744425: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-15 14:02:19.785264: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 14:02:19.785310: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 14:02:19.792961: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 14:02:19.793024: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 14:02:19.795898: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 14:02:19.797060: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 14:02:19.800431: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 14:02:19.872085: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 14:02:19.877703: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 14:02:19.878359: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 14:02:19.878440: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 14:02:21.369607: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-15 14:02:21.370648: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 14:02:21.371228: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 14:02:21.371269: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 14:02:21.371317: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 14:02:21.371332: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 14:02:21.371347: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 14:02:21.371363: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 14:02:21.371377: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 14:02:21.371392: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 14:02:21.371407: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 14:02:21.371987: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 14:02:21.372031: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 14:02:22.077588: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-15 14:02:22.077696: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-15 14:02:22.077709: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-15 14:02:22.081331: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:18:00.0, compute capability: 6.1)
{'id': 113, 'batch_size': 128, 'epochs': 136, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/136 [00:00<?, ?epoch/s]2024-02-15 14:02:22.920043: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-15 14:02:22.932725: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-02-15 14:02:24.894188: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 14:02:25.210237: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 14:02:26.318228: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-15 14:02:26.378075: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/136 [01:12<2:42:03, 72.03s/epoch, loss=3.57, accuracy=0.25, val_loss=2.42, val_accuracy=0.233, lr=0.1]  1%|▏         | 2/136 [01:42<1:45:43, 47.34s/epoch, loss=1.64, accuracy=0.49, val_loss=4.38, val_accuracy=0.149, lr=0.1]  2%|▏         | 3/136 [02:12<1:27:42, 39.57s/epoch, loss=1.39, accuracy=0.603, val_loss=2.68, val_accuracy=0.308, lr=0.1]  3%|▎         | 4/136 [02:41<1:18:23, 35.63s/epoch, loss=1.29, accuracy=0.662, val_loss=2.3, val_accuracy=0.393, lr=0.1]   4%|▎         | 5/136 [03:12<1:13:24, 33.62s/epoch, loss=1.26, accuracy=0.689, val_loss=1.45, val_accuracy=0.626, lr=0.1]  4%|▍         | 6/136 [03:41<1:10:03, 32.34s/epoch, loss=1.23, accuracy=0.701, val_loss=5.72, val_accuracy=0.283, lr=0.1]  5%|▌         | 7/136 [04:11<1:07:23, 31.35s/epoch, loss=1.23, accuracy=0.709, val_loss=2.98, val_accuracy=0.317, lr=0.1]  6%|▌         | 8/136 [04:41<1:05:50, 30.87s/epoch, loss=1.22, accuracy=0.713, val_loss=1.74, val_accuracy=0.526, lr=0.1]  7%|▋         | 9/136 [05:11<1:04:47, 30.61s/epoch, loss=1.22, accuracy=0.72, val_loss=2.64, val_accuracy=0.426, lr=0.1]   7%|▋         | 10/136 [05:41<1:04:15, 30.60s/epoch, loss=1.21, accuracy=0.723, val_loss=1.5, val_accuracy=0.626, lr=0.0316]  8%|▊         | 11/136 [06:11<1:03:21, 30.41s/epoch, loss=1.21, accuracy=0.724, val_loss=1.65, val_accuracy=0.585, lr=0.1]    9%|▉         | 12/136 [06:41<1:02:43, 30.35s/epoch, loss=1.2, accuracy=0.729, val_loss=2.68, val_accuracy=0.436, lr=0.1]  10%|▉         | 13/136 [07:12<1:02:14, 30.36s/epoch, loss=1.2, accuracy=0.731, val_loss=1.68, val_accuracy=0.596, lr=0.1] 10%|█         | 14/136 [07:40<1:00:43, 29.87s/epoch, loss=1.18, accuracy=0.734, val_loss=1.93, val_accuracy=0.479, lr=0.1] 11%|█         | 15/136 [08:09<59:24, 29.45s/epoch, loss=1.18, accuracy=0.735, val_loss=3.51, val_accuracy=0.391, lr=0.0316] 12%|█▏        | 16/136 [08:39<59:06, 29.55s/epoch, loss=1.18, accuracy=0.736, val_loss=2.19, val_accuracy=0.53, lr=0.1]     12%|█▎        | 17/136 [09:09<58:56, 29.72s/epoch, loss=1.18, accuracy=0.736, val_loss=1.41, val_accuracy=0.66, lr=0.1] 13%|█▎        | 18/136 [09:39<58:42, 29.85s/epoch, loss=1.18, accuracy=0.736, val_loss=1.79, val_accuracy=0.554, lr=0.1] 14%|█▍        | 19/136 [10:09<58:15, 29.87s/epoch, loss=1.17, accuracy=0.741, val_loss=1.83, val_accuracy=0.569, lr=0.1] 15%|█▍        | 20/136 [10:38<57:27, 29.72s/epoch, loss=1.16, accuracy=0.742, val_loss=2.42, val_accuracy=0.437, lr=0.1] 15%|█▌        | 21/136 [11:09<57:15, 29.88s/epoch, loss=1.17, accuracy=0.74, val_loss=1.92, val_accuracy=0.522, lr=0.1]  16%|█▌        | 22/136 [11:39<57:04, 30.04s/epoch, loss=1.17, accuracy=0.744, val_loss=2.62, val_accuracy=0.431, lr=0.0316] 17%|█▋        | 23/136 [12:09<56:23, 29.95s/epoch, loss=1.17, accuracy=0.744, val_loss=1.92, val_accuracy=0.55, lr=0.1]     18%|█▊        | 24/136 [12:39<55:49, 29.90s/epoch, loss=1.17, accuracy=0.741, val_loss=1.63, val_accuracy=0.574, lr=0.1] 18%|█▊        | 25/136 [13:09<55:28, 29.99s/epoch, loss=1.16, accuracy=0.743, val_loss=2.01, val_accuracy=0.529, lr=0.1] 19%|█▉        | 26/136 [13:39<55:10, 30.10s/epoch, loss=1.16, accuracy=0.744, val_loss=1.79, val_accuracy=0.568, lr=0.1] 20%|█▉        | 27/136 [14:08<54:01, 29.74s/epoch, loss=1.16, accuracy=0.746, val_loss=1.48, val_accuracy=0.637, lr=0.0316] 21%|██        | 28/136 [14:38<53:46, 29.87s/epoch, loss=1.16, accuracy=0.745, val_loss=3.88, val_accuracy=0.291, lr=0.1]    21%|██▏       | 29/136 [15:08<53:23, 29.94s/epoch, loss=1.16, accuracy=0.746, val_loss=1.59, val_accuracy=0.626, lr=0.1] 22%|██▏       | 30/136 [15:38<52:43, 29.84s/epoch, loss=1.16, accuracy=0.745, val_loss=2.12, val_accuracy=0.424, lr=0.1] 23%|██▎       | 31/136 [16:09<52:40, 30.10s/epoch, loss=1.15, accuracy=0.747, val_loss=2.06, val_accuracy=0.546, lr=0.1] 24%|██▎       | 32/136 [16:39<52:18, 30.18s/epoch, loss=1.15, accuracy=0.747, val_loss=3.34, val_accuracy=0.305, lr=0.0316] 24%|██▍       | 33/136 [17:09<51:43, 30.14s/epoch, loss=1.15, accuracy=0.748, val_loss=2, val_accuracy=0.473, lr=0.1]       25%|██▌       | 34/136 [17:39<51:11, 30.11s/epoch, loss=1.14, accuracy=0.749, val_loss=1.86, val_accuracy=0.463, lr=0.1] 26%|██▌       | 35/136 [18:09<50:27, 29.98s/epoch, loss=1.14, accuracy=0.749, val_loss=1.79, val_accuracy=0.562, lr=0.1] 26%|██▋       | 36/136 [18:39<50:00, 30.01s/epoch, loss=1.14, accuracy=0.75, val_loss=1.68, val_accuracy=0.572, lr=0.1]  27%|██▋       | 37/136 [19:09<49:34, 30.04s/epoch, loss=1.15, accuracy=0.748, val_loss=1.59, val_accuracy=0.62, lr=0.0316] 28%|██▊       | 38/136 [19:39<49:06, 30.06s/epoch, loss=1.15, accuracy=0.75, val_loss=2.07, val_accuracy=0.442, lr=0.1]    29%|██▊       | 39/136 [20:08<48:16, 29.86s/epoch, loss=1.14, accuracy=0.75, val_loss=2.81, val_accuracy=0.426, lr=0.1] 29%|██▉       | 40/136 [20:38<47:46, 29.86s/epoch, loss=1.14, accuracy=0.751, val_loss=1.98, val_accuracy=0.486, lr=0.1] 30%|███       | 41/136 [21:08<47:00, 29.68s/epoch, loss=1.14, accuracy=0.75, val_loss=2.04, val_accuracy=0.458, lr=0.1]  31%|███       | 42/136 [21:37<46:38, 29.77s/epoch, loss=1.14, accuracy=0.75, val_loss=3.75, val_accuracy=0.284, lr=0.0316] 32%|███▏      | 43/136 [22:07<46:07, 29.76s/epoch, loss=1.14, accuracy=0.75, val_loss=5.22, val_accuracy=0.24, lr=0.1]     32%|███▏      | 44/136 [22:37<45:35, 29.73s/epoch, loss=1.14, accuracy=0.752, val_loss=2.21, val_accuracy=0.478, lr=0.1] 33%|███▎      | 45/136 [23:06<44:59, 29.67s/epoch, loss=1.14, accuracy=0.75, val_loss=1.47, val_accuracy=0.634, lr=0.1]  34%|███▍      | 46/136 [23:35<44:05, 29.40s/epoch, loss=1.14, accuracy=0.752, val_loss=1.83, val_accuracy=0.527, lr=0.1] 35%|███▍      | 47/136 [24:05<43:44, 29.49s/epoch, loss=1.15, accuracy=0.749, val_loss=1.86, val_accuracy=0.513, lr=0.0316] 35%|███▌      | 48/136 [24:33<42:50, 29.22s/epoch, loss=1.13, accuracy=0.753, val_loss=1.35, val_accuracy=0.667, lr=0.1]    36%|███▌      | 49/136 [25:03<42:18, 29.18s/epoch, loss=1.14, accuracy=0.75, val_loss=2.48, val_accuracy=0.44, lr=0.1]   37%|███▋      | 50/136 [25:33<42:14, 29.47s/epoch, loss=1.13, accuracy=0.752, val_loss=1.48, val_accuracy=0.637, lr=0.1] 38%|███▊      | 51/136 [26:02<41:51, 29.55s/epoch, loss=1.14, accuracy=0.751, val_loss=1.8, val_accuracy=0.532, lr=0.1]  38%|███▊      | 52/136 [26:32<41:28, 29.62s/epoch, loss=1.13, accuracy=0.755, val_loss=1.66, val_accuracy=0.585, lr=0.1] 39%|███▉      | 53/136 [27:02<40:53, 29.56s/epoch, loss=1.13, accuracy=0.753, val_loss=1.98, val_accuracy=0.518, lr=0.0316] 40%|███▉      | 54/136 [27:31<40:18, 29.50s/epoch, loss=1.13, accuracy=0.752, val_loss=1.68, val_accuracy=0.602, lr=0.1]    40%|████      | 55/136 [28:01<39:58, 29.62s/epoch, loss=1.13, accuracy=0.753, val_loss=2, val_accuracy=0.482, lr=0.1]    41%|████      | 56/136 [28:31<39:30, 29.63s/epoch, loss=1.13, accuracy=0.756, val_loss=1.67, val_accuracy=0.571, lr=0.1] 42%|████▏     | 57/136 [29:00<38:55, 29.57s/epoch, loss=1.14, accuracy=0.751, val_loss=2.04, val_accuracy=0.542, lr=0.1] 43%|████▎     | 58/136 [29:31<38:50, 29.87s/epoch, loss=1.14, accuracy=0.752, val_loss=2.37, val_accuracy=0.366, lr=0.0316] 43%|████▎     | 59/136 [30:00<38:19, 29.86s/epoch, loss=1.13, accuracy=0.754, val_loss=1.65, val_accuracy=0.568, lr=0.1]    44%|████▍     | 60/136 [30:31<37:57, 29.97s/epoch, loss=1.13, accuracy=0.753, val_loss=1.58, val_accuracy=0.606, lr=0.1] 45%|████▍     | 61/136 [31:00<37:20, 29.87s/epoch, loss=1.13, accuracy=0.753, val_loss=1.96, val_accuracy=0.513, lr=0.1] 46%|████▌     | 62/136 [31:30<36:47, 29.83s/epoch, loss=1.13, accuracy=0.755, val_loss=1.49, val_accuracy=0.632, lr=0.1] 46%|████▋     | 63/136 [32:00<36:14, 29.79s/epoch, loss=1.13, accuracy=0.754, val_loss=1.59, val_accuracy=0.606, lr=0.0316] 47%|████▋     | 64/136 [32:29<35:37, 29.69s/epoch, loss=1.13, accuracy=0.753, val_loss=2.58, val_accuracy=0.461, lr=0.1]    48%|████▊     | 65/136 [32:59<35:18, 29.83s/epoch, loss=1.13, accuracy=0.749, val_loss=1.77, val_accuracy=0.541, lr=0.1] 49%|████▊     | 66/136 [33:29<34:47, 29.82s/epoch, loss=1.12, accuracy=0.753, val_loss=4.72, val_accuracy=0.203, lr=0.1] 49%|████▉     | 67/136 [33:59<34:17, 29.82s/epoch, loss=1.13, accuracy=0.752, val_loss=1.82, val_accuracy=0.524, lr=0.1] 50%|█████     | 68/136 [34:27<33:18, 29.38s/epoch, loss=1.12, accuracy=0.754, val_loss=2.02, val_accuracy=0.475, lr=0.0316] 51%|█████     | 69/136 [34:57<32:53, 29.45s/epoch, loss=1.13, accuracy=0.753, val_loss=2.02, val_accuracy=0.529, lr=0.1]    51%|█████▏    | 70/136 [35:27<32:29, 29.54s/epoch, loss=1.12, accuracy=0.757, val_loss=3.9, val_accuracy=0.365, lr=0.1]  52%|█████▏    | 71/136 [35:56<32:02, 29.57s/epoch, loss=1.12, accuracy=0.755, val_loss=4.61, val_accuracy=0.261, lr=0.1] 53%|█████▎    | 72/136 [36:26<31:44, 29.75s/epoch, loss=1.13, accuracy=0.756, val_loss=2.24, val_accuracy=0.493, lr=0.1] 54%|█████▎    | 73/136 [36:56<31:16, 29.78s/epoch, loss=1.13, accuracy=0.753, val_loss=1.94, val_accuracy=0.486, lr=0.0316] 54%|█████▍    | 74/136 [37:27<30:54, 29.92s/epoch, loss=1.13, accuracy=0.756, val_loss=2.47, val_accuracy=0.438, lr=0.1]    55%|█████▌    | 75/136 [37:56<30:17, 29.80s/epoch, loss=1.12, accuracy=0.759, val_loss=1.72, val_accuracy=0.547, lr=0.1] 56%|█████▌    | 76/136 [38:26<29:47, 29.79s/epoch, loss=1.12, accuracy=0.755, val_loss=2.63, val_accuracy=0.413, lr=0.1] 57%|█████▋    | 77/136 [38:54<28:53, 29.38s/epoch, loss=1.12, accuracy=0.754, val_loss=2.08, val_accuracy=0.486, lr=0.1] 57%|█████▋    | 78/136 [39:23<28:18, 29.28s/epoch, loss=1.12, accuracy=0.753, val_loss=1.99, val_accuracy=0.502, lr=0.0316] 58%|█████▊    | 79/136 [39:54<28:05, 29.56s/epoch, loss=1.13, accuracy=0.752, val_loss=1.87, val_accuracy=0.488, lr=0.1]    59%|█████▉    | 80/136 [40:22<27:12, 29.16s/epoch, loss=1.12, accuracy=0.757, val_loss=2.26, val_accuracy=0.458, lr=0.1] 60%|█████▉    | 81/136 [40:51<26:49, 29.26s/epoch, loss=1.11, accuracy=0.755, val_loss=1.42, val_accuracy=0.661, lr=0.1] 60%|██████    | 82/136 [41:21<26:34, 29.53s/epoch, loss=0.896, accuracy=0.816, val_loss=0.913, val_accuracy=0.793, lr=0.01] 61%|██████    | 83/136 [41:51<26:14, 29.70s/epoch, loss=0.731, accuracy=0.846, val_loss=0.873, val_accuracy=0.78, lr=0.01]  62%|██████▏   | 84/136 [42:21<25:45, 29.72s/epoch, loss=0.652, accuracy=0.85, val_loss=0.747, val_accuracy=0.816, lr=0.01] 62%|██████▎   | 85/136 [42:51<25:16, 29.74s/epoch, loss=0.613, accuracy=0.855, val_loss=0.806, val_accuracy=0.79, lr=0.01] 63%|██████▎   | 86/136 [43:21<24:48, 29.77s/epoch, loss=0.591, accuracy=0.858, val_loss=0.742, val_accuracy=0.804, lr=0.01] 64%|██████▍   | 87/136 [43:50<24:04, 29.49s/epoch, loss=0.586, accuracy=0.857, val_loss=0.824, val_accuracy=0.789, lr=0.01] 65%|██████▍   | 88/136 [44:19<23:37, 29.54s/epoch, loss=0.576, accuracy=0.859, val_loss=0.863, val_accuracy=0.771, lr=0.01] 65%|██████▌   | 89/136 [44:49<23:11, 29.60s/epoch, loss=0.576, accuracy=0.859, val_loss=0.736, val_accuracy=0.812, lr=0.01] 66%|██████▌   | 90/136 [45:18<22:31, 29.38s/epoch, loss=0.572, accuracy=0.861, val_loss=0.741, val_accuracy=0.801, lr=0.01] 67%|██████▋   | 91/136 [45:48<22:06, 29.49s/epoch, loss=0.571, accuracy=0.861, val_loss=0.886, val_accuracy=0.767, lr=0.01] 68%|██████▊   | 92/136 [46:18<21:46, 29.69s/epoch, loss=0.566, accuracy=0.865, val_loss=0.716, val_accuracy=0.812, lr=0.01] 68%|██████▊   | 93/136 [46:47<21:13, 29.61s/epoch, loss=0.569, accuracy=0.864, val_loss=0.994, val_accuracy=0.744, lr=0.01] 69%|██████▉   | 94/136 [47:17<20:41, 29.57s/epoch, loss=0.566, accuracy=0.866, val_loss=0.742, val_accuracy=0.817, lr=0.01] 70%|██████▉   | 95/136 [47:46<20:14, 29.61s/epoch, loss=0.561, accuracy=0.868, val_loss=0.867, val_accuracy=0.772, lr=0.01] 71%|███████   | 96/136 [48:16<19:45, 29.63s/epoch, loss=0.567, accuracy=0.867, val_loss=0.704, val_accuracy=0.827, lr=0.01] 71%|███████▏  | 97/136 [48:46<19:19, 29.73s/epoch, loss=0.563, accuracy=0.87, val_loss=0.796, val_accuracy=0.799, lr=0.01]  72%|███████▏  | 98/136 [49:16<18:48, 29.69s/epoch, loss=0.565, accuracy=0.868, val_loss=0.747, val_accuracy=0.811, lr=0.01] 73%|███████▎  | 99/136 [49:46<18:24, 29.84s/epoch, loss=0.561, accuracy=0.871, val_loss=1.04, val_accuracy=0.73, lr=0.01]   74%|███████▎  | 100/136 [50:16<17:58, 29.95s/epoch, loss=0.563, accuracy=0.87, val_loss=0.834, val_accuracy=0.794, lr=0.01] 74%|███████▍  | 101/136 [50:46<17:28, 29.96s/epoch, loss=0.563, accuracy=0.87, val_loss=0.815, val_accuracy=0.796, lr=0.00316] 75%|███████▌  | 102/136 [51:16<17:00, 30.02s/epoch, loss=0.568, accuracy=0.87, val_loss=1.22, val_accuracy=0.681, lr=0.01]     76%|███████▌  | 103/136 [51:46<16:26, 29.89s/epoch, loss=0.561, accuracy=0.873, val_loss=0.802, val_accuracy=0.799, lr=0.01] 76%|███████▋  | 104/136 [52:16<15:55, 29.85s/epoch, loss=0.562, accuracy=0.873, val_loss=0.92, val_accuracy=0.769, lr=0.01]  77%|███████▋  | 105/136 [52:45<15:23, 29.80s/epoch, loss=0.564, accuracy=0.873, val_loss=1.11, val_accuracy=0.743, lr=0.01] 78%|███████▊  | 106/136 [53:15<14:50, 29.67s/epoch, loss=0.558, accuracy=0.875, val_loss=1.06, val_accuracy=0.74, lr=0.00316] 79%|███████▊  | 107/136 [53:45<14:22, 29.75s/epoch, loss=0.562, accuracy=0.874, val_loss=0.897, val_accuracy=0.771, lr=0.01]  79%|███████▉  | 108/136 [54:13<13:45, 29.47s/epoch, loss=0.558, accuracy=0.877, val_loss=0.816, val_accuracy=0.804, lr=0.01] 80%|████████  | 109/136 [54:43<13:18, 29.56s/epoch, loss=0.559, accuracy=0.876, val_loss=0.795, val_accuracy=0.808, lr=0.01] 81%|████████  | 110/136 [55:13<12:50, 29.63s/epoch, loss=0.561, accuracy=0.876, val_loss=0.789, val_accuracy=0.808, lr=0.01] 82%|████████▏ | 111/136 [55:43<12:20, 29.63s/epoch, loss=0.561, accuracy=0.876, val_loss=0.873, val_accuracy=0.794, lr=0.00316] 82%|████████▏ | 112/136 [56:12<11:47, 29.47s/epoch, loss=0.56, accuracy=0.877, val_loss=0.805, val_accuracy=0.803, lr=0.01]     83%|████████▎ | 113/136 [56:41<11:15, 29.38s/epoch, loss=0.563, accuracy=0.876, val_loss=0.794, val_accuracy=0.803, lr=0.01] 84%|████████▍ | 114/136 [57:10<10:47, 29.41s/epoch, loss=0.563, accuracy=0.877, val_loss=0.897, val_accuracy=0.779, lr=0.01] 85%|████████▍ | 115/136 [57:39<10:15, 29.30s/epoch, loss=0.554, accuracy=0.88, val_loss=1.26, val_accuracy=0.684, lr=0.01]   85%|████████▌ | 116/136 [58:09<09:46, 29.30s/epoch, loss=0.562, accuracy=0.877, val_loss=0.758, val_accuracy=0.812, lr=0.00316] 86%|████████▌ | 117/136 [58:38<09:18, 29.40s/epoch, loss=0.561, accuracy=0.877, val_loss=0.84, val_accuracy=0.796, lr=0.01]     87%|████████▋ | 118/136 [59:08<08:51, 29.50s/epoch, loss=0.558, accuracy=0.88, val_loss=1.08, val_accuracy=0.735, lr=0.01]  88%|████████▊ | 119/136 [59:38<08:24, 29.66s/epoch, loss=0.56, accuracy=0.879, val_loss=0.87, val_accuracy=0.793, lr=0.01] 88%|████████▊ | 120/136 [1:00:08<07:55, 29.72s/epoch, loss=0.563, accuracy=0.877, val_loss=0.811, val_accuracy=0.796, lr=0.01] 89%|████████▉ | 121/136 [1:00:37<07:22, 29.50s/epoch, loss=0.559, accuracy=0.879, val_loss=0.753, val_accuracy=0.824, lr=0.00316] 90%|████████▉ | 122/136 [1:01:07<06:54, 29.61s/epoch, loss=0.481, accuracy=0.906, val_loss=0.543, val_accuracy=0.889, lr=0.001]   90%|█████████ | 123/136 [1:01:37<06:27, 29.78s/epoch, loss=0.429, accuracy=0.923, val_loss=0.527, val_accuracy=0.891, lr=0.001] 91%|█████████ | 124/136 [1:02:06<05:55, 29.59s/epoch, loss=0.409, accuracy=0.927, val_loss=0.534, val_accuracy=0.887, lr=0.001] 92%|█████████▏| 125/136 [1:02:36<05:27, 29.78s/epoch, loss=0.392, accuracy=0.931, val_loss=0.507, val_accuracy=0.898, lr=0.001] 93%|█████████▎| 126/136 [1:03:06<04:56, 29.61s/epoch, loss=0.381, accuracy=0.934, val_loss=0.505, val_accuracy=0.894, lr=0.001] 93%|█████████▎| 127/136 [1:03:34<04:23, 29.25s/epoch, loss=0.368, accuracy=0.936, val_loss=0.519, val_accuracy=0.892, lr=0.001] 94%|█████████▍| 128/136 [1:04:03<03:53, 29.22s/epoch, loss=0.357, accuracy=0.937, val_loss=0.491, val_accuracy=0.896, lr=0.001] 95%|█████████▍| 129/136 [1:04:33<03:25, 29.33s/epoch, loss=0.348, accuracy=0.94, val_loss=0.483, val_accuracy=0.898, lr=0.001]  96%|█████████▌| 130/136 [1:05:01<02:55, 29.17s/epoch, loss=0.339, accuracy=0.94, val_loss=0.491, val_accuracy=0.893, lr=0.001] 96%|█████████▋| 131/136 [1:05:31<02:26, 29.27s/epoch, loss=0.329, accuracy=0.943, val_loss=0.496, val_accuracy=0.893, lr=0.001] 97%|█████████▋| 132/136 [1:06:00<01:57, 29.31s/epoch, loss=0.322, accuracy=0.944, val_loss=0.497, val_accuracy=0.89, lr=0.001]  98%|█████████▊| 133/136 [1:06:30<01:28, 29.52s/epoch, loss=0.315, accuracy=0.944, val_loss=0.503, val_accuracy=0.891, lr=0.001] 99%|█████████▊| 134/136 [1:07:00<00:59, 29.61s/epoch, loss=0.306, accuracy=0.947, val_loss=0.486, val_accuracy=0.893, lr=0.000316] 99%|█████████▉| 135/136 [1:07:30<00:29, 29.69s/epoch, loss=0.303, accuracy=0.947, val_loss=0.496, val_accuracy=0.891, lr=0.001]   100%|██████████| 136/136 [1:08:00<00:00, 29.63s/epoch, loss=0.294, accuracy=0.948, val_loss=0.5, val_accuracy=0.893, lr=0.001]  100%|██████████| 136/136 [1:08:00<00:00, 30.00s/epoch, loss=0.294, accuracy=0.948, val_loss=0.5, val_accuracy=0.893, lr=0.001]
Using real-time data augmentation.
Test loss: 0.5000472664833069
Test accuracy: 0.8931000232696533


* * * Run SGD for ID = 11_4. * * *


2024-02-15 15:10:27.249539: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 15:10:34.401937: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 15:10:34.403357: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-15 15:10:34.445942: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 15:10:34.445996: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 15:10:34.449769: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 15:10:34.449842: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 15:10:34.571453: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 15:10:34.572283: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 15:10:34.575261: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 15:10:34.576990: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 15:10:34.582611: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 15:10:34.583337: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 15:10:34.583422: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 15:10:36.042760: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-15 15:10:36.043861: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 15:10:36.044460: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 15:10:36.044502: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 15:10:36.044550: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 15:10:36.044579: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 15:10:36.044594: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 15:10:36.044609: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 15:10:36.044624: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 15:10:36.044639: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 15:10:36.044654: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 15:10:36.045244: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 15:10:36.045282: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 15:10:36.762213: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-15 15:10:36.762305: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-15 15:10:36.762318: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-15 15:10:36.765963: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:18:00.0, compute capability: 6.1)
{'id': 114, 'batch_size': 128, 'epochs': 136, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/136 [00:00<?, ?epoch/s]2024-02-15 15:10:37.598931: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-15 15:10:37.610719: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-02-15 15:10:39.711170: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 15:10:40.023571: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 15:10:41.157207: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-15 15:10:41.214605: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/136 [01:07<2:31:37, 67.39s/epoch, loss=3.23, accuracy=0.305, val_loss=2.19, val_accuracy=0.298, lr=0.1]  1%|▏         | 2/136 [01:35<1:38:57, 44.31s/epoch, loss=1.67, accuracy=0.478, val_loss=2.57, val_accuracy=0.291, lr=0.1]  2%|▏         | 3/136 [02:04<1:22:53, 37.39s/epoch, loss=1.45, accuracy=0.593, val_loss=1.79, val_accuracy=0.529, lr=0.1]  3%|▎         | 4/136 [02:35<1:16:16, 34.67s/epoch, loss=1.32, accuracy=0.668, val_loss=1.86, val_accuracy=0.517, lr=0.1]  4%|▎         | 5/136 [03:04<1:11:27, 32.73s/epoch, loss=1.27, accuracy=0.697, val_loss=3.11, val_accuracy=0.29, lr=0.1]   4%|▍         | 6/136 [03:34<1:09:02, 31.86s/epoch, loss=1.26, accuracy=0.71, val_loss=1.83, val_accuracy=0.518, lr=0.1]  5%|▌         | 7/136 [04:04<1:07:10, 31.24s/epoch, loss=1.24, accuracy=0.718, val_loss=1.71, val_accuracy=0.55, lr=0.1]  6%|▌         | 8/136 [04:35<1:06:34, 31.20s/epoch, loss=1.23, accuracy=0.724, val_loss=2.65, val_accuracy=0.382, lr=0.1]  7%|▋         | 9/136 [05:04<1:04:41, 30.57s/epoch, loss=1.22, accuracy=0.724, val_loss=1.91, val_accuracy=0.457, lr=0.1]  7%|▋         | 10/136 [05:35<1:04:09, 30.55s/epoch, loss=1.22, accuracy=0.73, val_loss=2.15, val_accuracy=0.452, lr=0.1]  8%|▊         | 11/136 [06:04<1:02:53, 30.19s/epoch, loss=1.21, accuracy=0.73, val_loss=2.86, val_accuracy=0.292, lr=0.1]  9%|▉         | 12/136 [06:35<1:02:25, 30.21s/epoch, loss=1.2, accuracy=0.735, val_loss=1.42, val_accuracy=0.661, lr=0.1] 10%|▉         | 13/136 [07:05<1:02:11, 30.34s/epoch, loss=1.2, accuracy=0.738, val_loss=1.52, val_accuracy=0.613, lr=0.1] 10%|█         | 14/136 [07:33<1:00:19, 29.67s/epoch, loss=1.2, accuracy=0.737, val_loss=1.81, val_accuracy=0.597, lr=0.1] 11%|█         | 15/136 [08:02<59:08, 29.33s/epoch, loss=1.2, accuracy=0.738, val_loss=3.2, val_accuracy=0.242, lr=0.1]    12%|█▏        | 16/136 [08:32<59:03, 29.53s/epoch, loss=1.19, accuracy=0.741, val_loss=1.95, val_accuracy=0.563, lr=0.1] 12%|█▎        | 17/136 [09:00<57:58, 29.23s/epoch, loss=1.19, accuracy=0.741, val_loss=1.86, val_accuracy=0.537, lr=0.0316] 13%|█▎        | 18/136 [09:29<57:03, 29.02s/epoch, loss=1.19, accuracy=0.742, val_loss=3.55, val_accuracy=0.384, lr=0.1]    14%|█▍        | 19/136 [09:57<56:04, 28.76s/epoch, loss=1.19, accuracy=0.742, val_loss=1.61, val_accuracy=0.591, lr=0.1] 15%|█▍        | 20/136 [10:25<55:14, 28.57s/epoch, loss=1.18, accuracy=0.742, val_loss=5.52, val_accuracy=0.252, lr=0.1] 15%|█▌        | 21/136 [10:54<54:38, 28.51s/epoch, loss=1.18, accuracy=0.742, val_loss=1.58, val_accuracy=0.605, lr=0.1] 16%|█▌        | 22/136 [11:24<55:09, 29.03s/epoch, loss=1.18, accuracy=0.745, val_loss=1.33, val_accuracy=0.685, lr=0.1] 17%|█▋        | 23/136 [11:53<54:31, 28.95s/epoch, loss=1.18, accuracy=0.742, val_loss=1.74, val_accuracy=0.558, lr=0.1] 18%|█▊        | 24/136 [12:22<54:24, 29.15s/epoch, loss=1.18, accuracy=0.744, val_loss=3.21, val_accuracy=0.312, lr=0.1] 18%|█▊        | 25/136 [12:52<54:29, 29.45s/epoch, loss=1.17, accuracy=0.746, val_loss=3.31, val_accuracy=0.335, lr=0.1] 19%|█▉        | 26/136 [13:21<53:20, 29.10s/epoch, loss=1.17, accuracy=0.749, val_loss=2.52, val_accuracy=0.48, lr=0.1]  20%|█▉        | 27/136 [13:51<53:48, 29.62s/epoch, loss=1.17, accuracy=0.749, val_loss=2.06, val_accuracy=0.526, lr=0.0316] 21%|██        | 28/136 [14:21<53:00, 29.45s/epoch, loss=1.17, accuracy=0.746, val_loss=1.63, val_accuracy=0.583, lr=0.1]    21%|██▏       | 29/136 [14:51<52:56, 29.69s/epoch, loss=1.17, accuracy=0.745, val_loss=1.93, val_accuracy=0.519, lr=0.1] 22%|██▏       | 30/136 [15:19<51:43, 29.27s/epoch, loss=1.17, accuracy=0.747, val_loss=2.05, val_accuracy=0.503, lr=0.1] 23%|██▎       | 31/136 [15:50<51:51, 29.63s/epoch, loss=1.17, accuracy=0.747, val_loss=1.91, val_accuracy=0.494, lr=0.1] 24%|██▎       | 32/136 [16:20<51:42, 29.83s/epoch, loss=1.17, accuracy=0.747, val_loss=2.03, val_accuracy=0.468, lr=0.0316] 24%|██▍       | 33/136 [16:48<50:32, 29.44s/epoch, loss=1.16, accuracy=0.749, val_loss=1.81, val_accuracy=0.541, lr=0.1]    25%|██▌       | 34/136 [17:17<49:47, 29.29s/epoch, loss=1.17, accuracy=0.749, val_loss=2.24, val_accuracy=0.478, lr=0.1] 26%|██▌       | 35/136 [17:45<48:43, 28.94s/epoch, loss=1.16, accuracy=0.751, val_loss=2.2, val_accuracy=0.42, lr=0.1]   26%|██▋       | 36/136 [18:14<48:04, 28.84s/epoch, loss=1.16, accuracy=0.751, val_loss=2.24, val_accuracy=0.399, lr=0.1] 27%|██▋       | 37/136 [18:42<47:13, 28.62s/epoch, loss=1.15, accuracy=0.752, val_loss=2, val_accuracy=0.442, lr=0.0316] 28%|██▊       | 38/136 [19:12<47:23, 29.01s/epoch, loss=1.15, accuracy=0.753, val_loss=2.43, val_accuracy=0.488, lr=0.1] 29%|██▊       | 39/136 [19:42<47:33, 29.42s/epoch, loss=1.15, accuracy=0.752, val_loss=1.92, val_accuracy=0.508, lr=0.1] 29%|██▉       | 40/136 [20:13<47:49, 29.89s/epoch, loss=1.15, accuracy=0.752, val_loss=2.98, val_accuracy=0.393, lr=0.1] 30%|███       | 41/136 [20:42<46:39, 29.47s/epoch, loss=1.16, accuracy=0.751, val_loss=1.86, val_accuracy=0.535, lr=0.1] 31%|███       | 42/136 [21:11<46:07, 29.44s/epoch, loss=1.16, accuracy=0.75, val_loss=2.08, val_accuracy=0.503, lr=0.0316] 32%|███▏      | 43/136 [21:41<45:37, 29.44s/epoch, loss=1.15, accuracy=0.752, val_loss=2.03, val_accuracy=0.402, lr=0.1]   32%|███▏      | 44/136 [22:11<45:40, 29.79s/epoch, loss=1.15, accuracy=0.755, val_loss=2.03, val_accuracy=0.512, lr=0.1] 33%|███▎      | 45/136 [22:40<44:41, 29.46s/epoch, loss=1.15, accuracy=0.754, val_loss=1.79, val_accuracy=0.582, lr=0.1] 34%|███▍      | 46/136 [23:08<43:44, 29.16s/epoch, loss=1.15, accuracy=0.753, val_loss=1.93, val_accuracy=0.534, lr=0.1] 35%|███▍      | 47/136 [23:38<43:18, 29.20s/epoch, loss=1.15, accuracy=0.754, val_loss=1.44, val_accuracy=0.641, lr=0.0316] 35%|███▌      | 48/136 [24:07<42:42, 29.12s/epoch, loss=1.15, accuracy=0.754, val_loss=1.6, val_accuracy=0.592, lr=0.1]     36%|███▌      | 49/136 [24:36<42:25, 29.26s/epoch, loss=1.15, accuracy=0.756, val_loss=1.81, val_accuracy=0.535, lr=0.1] 37%|███▋      | 50/136 [25:07<42:33, 29.69s/epoch, loss=1.15, accuracy=0.752, val_loss=2.06, val_accuracy=0.491, lr=0.1] 38%|███▊      | 51/136 [25:37<42:13, 29.81s/epoch, loss=1.15, accuracy=0.752, val_loss=4.71, val_accuracy=0.188, lr=0.1] 38%|███▊      | 52/136 [26:07<41:55, 29.95s/epoch, loss=1.15, accuracy=0.755, val_loss=1.94, val_accuracy=0.5, lr=0.0316] 39%|███▉      | 53/136 [26:38<41:46, 30.20s/epoch, loss=1.15, accuracy=0.754, val_loss=2.05, val_accuracy=0.515, lr=0.1]  40%|███▉      | 54/136 [27:07<40:51, 29.89s/epoch, loss=1.14, accuracy=0.756, val_loss=1.9, val_accuracy=0.528, lr=0.1]  40%|████      | 55/136 [27:37<40:22, 29.91s/epoch, loss=1.14, accuracy=0.756, val_loss=3.77, val_accuracy=0.33, lr=0.1] 41%|████      | 56/136 [28:08<40:09, 30.12s/epoch, loss=1.14, accuracy=0.756, val_loss=1.85, val_accuracy=0.515, lr=0.1] 42%|████▏     | 57/136 [28:38<39:35, 30.07s/epoch, loss=1.15, accuracy=0.751, val_loss=2.1, val_accuracy=0.509, lr=0.0316] 43%|████▎     | 58/136 [29:07<38:38, 29.73s/epoch, loss=1.14, accuracy=0.754, val_loss=1.73, val_accuracy=0.574, lr=0.1]   43%|████▎     | 59/136 [29:35<37:27, 29.18s/epoch, loss=1.14, accuracy=0.755, val_loss=1.58, val_accuracy=0.612, lr=0.1] 44%|████▍     | 60/136 [30:05<37:23, 29.52s/epoch, loss=1.15, accuracy=0.753, val_loss=3.03, val_accuracy=0.36, lr=0.1]  45%|████▍     | 61/136 [30:33<36:27, 29.16s/epoch, loss=1.15, accuracy=0.755, val_loss=1.76, val_accuracy=0.552, lr=0.1] 46%|████▌     | 62/136 [31:02<35:41, 28.93s/epoch, loss=1.14, accuracy=0.755, val_loss=2.94, val_accuracy=0.294, lr=0.0316] 46%|████▋     | 63/136 [31:30<34:53, 28.68s/epoch, loss=1.14, accuracy=0.757, val_loss=2.4, val_accuracy=0.45, lr=0.1]      47%|████▋     | 64/136 [31:58<34:16, 28.56s/epoch, loss=1.14, accuracy=0.755, val_loss=2.1, val_accuracy=0.403, lr=0.1] 48%|████▊     | 65/136 [32:26<33:43, 28.50s/epoch, loss=1.14, accuracy=0.756, val_loss=2.78, val_accuracy=0.37, lr=0.1] 49%|████▊     | 66/136 [32:55<33:18, 28.55s/epoch, loss=1.14, accuracy=0.754, val_loss=2.46, val_accuracy=0.46, lr=0.1] 49%|████▉     | 67/136 [33:25<33:24, 29.05s/epoch, loss=1.13, accuracy=0.756, val_loss=1.66, val_accuracy=0.575, lr=0.0316] 50%|█████     | 68/136 [33:56<33:27, 29.52s/epoch, loss=1.14, accuracy=0.755, val_loss=1.64, val_accuracy=0.594, lr=0.1]    51%|█████     | 69/136 [34:25<32:42, 29.29s/epoch, loss=1.14, accuracy=0.755, val_loss=2.08, val_accuracy=0.489, lr=0.1] 51%|█████▏    | 70/136 [34:55<32:42, 29.73s/epoch, loss=1.13, accuracy=0.757, val_loss=1.46, val_accuracy=0.661, lr=0.1] 52%|█████▏    | 71/136 [35:26<32:33, 30.05s/epoch, loss=1.13, accuracy=0.756, val_loss=2.12, val_accuracy=0.49, lr=0.1]  53%|█████▎    | 72/136 [35:55<31:40, 29.69s/epoch, loss=1.13, accuracy=0.757, val_loss=1.46, val_accuracy=0.648, lr=0.0316] 54%|█████▎    | 73/136 [36:23<30:42, 29.25s/epoch, loss=1.14, accuracy=0.756, val_loss=1.59, val_accuracy=0.616, lr=0.1]    54%|█████▍    | 74/136 [36:52<30:09, 29.19s/epoch, loss=1.13, accuracy=0.756, val_loss=1.7, val_accuracy=0.566, lr=0.1]  55%|█████▌    | 75/136 [37:20<29:15, 28.78s/epoch, loss=1.14, accuracy=0.756, val_loss=4.44, val_accuracy=0.236, lr=0.1] 56%|█████▌    | 76/136 [37:50<29:07, 29.13s/epoch, loss=1.14, accuracy=0.756, val_loss=2.43, val_accuracy=0.491, lr=0.1] 57%|█████▋    | 77/136 [38:21<29:08, 29.64s/epoch, loss=1.14, accuracy=0.756, val_loss=2.28, val_accuracy=0.421, lr=0.0316] 57%|█████▋    | 78/136 [38:51<28:47, 29.78s/epoch, loss=1.14, accuracy=0.756, val_loss=1.97, val_accuracy=0.502, lr=0.1]    58%|█████▊    | 79/136 [39:22<28:29, 29.99s/epoch, loss=1.14, accuracy=0.756, val_loss=3.65, val_accuracy=0.299, lr=0.1] 59%|█████▉    | 80/136 [39:51<27:45, 29.74s/epoch, loss=1.13, accuracy=0.757, val_loss=2.53, val_accuracy=0.427, lr=0.1] 60%|█████▉    | 81/136 [40:19<26:55, 29.36s/epoch, loss=1.12, accuracy=0.757, val_loss=2.36, val_accuracy=0.42, lr=0.1]  60%|██████    | 82/136 [40:47<25:58, 28.86s/epoch, loss=0.906, accuracy=0.819, val_loss=0.86, val_accuracy=0.818, lr=0.01] 61%|██████    | 83/136 [41:15<25:24, 28.76s/epoch, loss=0.729, accuracy=0.848, val_loss=0.875, val_accuracy=0.794, lr=0.01] 62%|██████▏   | 84/136 [41:45<25:09, 29.02s/epoch, loss=0.65, accuracy=0.856, val_loss=1.02, val_accuracy=0.738, lr=0.01]   62%|██████▎   | 85/136 [42:14<24:41, 29.05s/epoch, loss=0.609, accuracy=0.859, val_loss=0.819, val_accuracy=0.787, lr=0.01] 63%|██████▎   | 86/136 [42:44<24:25, 29.30s/epoch, loss=0.585, accuracy=0.862, val_loss=0.829, val_accuracy=0.782, lr=0.01] 64%|██████▍   | 87/136 [43:14<24:11, 29.63s/epoch, loss=0.575, accuracy=0.863, val_loss=0.865, val_accuracy=0.774, lr=0.01] 65%|██████▍   | 88/136 [43:44<23:42, 29.64s/epoch, loss=0.567, accuracy=0.865, val_loss=0.973, val_accuracy=0.734, lr=0.01] 65%|██████▌   | 89/136 [44:14<23:19, 29.77s/epoch, loss=0.566, accuracy=0.865, val_loss=0.703, val_accuracy=0.82, lr=0.01]  66%|██████▌   | 90/136 [44:43<22:32, 29.40s/epoch, loss=0.563, accuracy=0.866, val_loss=0.935, val_accuracy=0.763, lr=0.01] 67%|██████▋   | 91/136 [45:13<22:17, 29.72s/epoch, loss=0.566, accuracy=0.867, val_loss=0.853, val_accuracy=0.777, lr=0.01] 68%|██████▊   | 92/136 [45:42<21:37, 29.48s/epoch, loss=0.561, accuracy=0.871, val_loss=0.681, val_accuracy=0.832, lr=0.01] 68%|██████▊   | 93/136 [46:13<21:22, 29.83s/epoch, loss=0.558, accuracy=0.872, val_loss=0.71, val_accuracy=0.822, lr=0.01]  69%|██████▉   | 94/136 [46:42<20:50, 29.76s/epoch, loss=0.557, accuracy=0.874, val_loss=0.781, val_accuracy=0.81, lr=0.01] 70%|██████▉   | 95/136 [47:12<20:17, 29.69s/epoch, loss=0.551, accuracy=0.875, val_loss=0.821, val_accuracy=0.793, lr=0.01] 71%|███████   | 96/136 [47:41<19:46, 29.67s/epoch, loss=0.551, accuracy=0.875, val_loss=0.794, val_accuracy=0.807, lr=0.01] 71%|███████▏  | 97/136 [48:10<19:01, 29.28s/epoch, loss=0.556, accuracy=0.875, val_loss=0.973, val_accuracy=0.747, lr=0.00316] 72%|███████▏  | 98/136 [48:40<18:47, 29.66s/epoch, loss=0.562, accuracy=0.875, val_loss=0.865, val_accuracy=0.787, lr=0.01]    73%|███████▎  | 99/136 [49:09<18:02, 29.25s/epoch, loss=0.557, accuracy=0.877, val_loss=0.744, val_accuracy=0.819, lr=0.01] 74%|███████▎  | 100/136 [49:37<17:23, 28.99s/epoch, loss=0.557, accuracy=0.877, val_loss=0.879, val_accuracy=0.783, lr=0.01] 74%|███████▍  | 101/136 [50:06<16:56, 29.04s/epoch, loss=0.555, accuracy=0.877, val_loss=1.08, val_accuracy=0.723, lr=0.01]  75%|███████▌  | 102/136 [50:36<16:37, 29.35s/epoch, loss=0.56, accuracy=0.877, val_loss=0.742, val_accuracy=0.82, lr=0.00316] 76%|███████▌  | 103/136 [51:06<16:16, 29.59s/epoch, loss=0.555, accuracy=0.879, val_loss=0.848, val_accuracy=0.79, lr=0.01]   76%|███████▋  | 104/136 [51:34<15:28, 29.01s/epoch, loss=0.554, accuracy=0.879, val_loss=0.965, val_accuracy=0.768, lr=0.01] 77%|███████▋  | 105/136 [52:04<15:06, 29.23s/epoch, loss=0.552, accuracy=0.881, val_loss=0.816, val_accuracy=0.8, lr=0.01]   78%|███████▊  | 106/136 [52:34<14:42, 29.40s/epoch, loss=0.552, accuracy=0.88, val_loss=0.84, val_accuracy=0.792, lr=0.01] 79%|███████▊  | 107/136 [53:03<14:15, 29.49s/epoch, loss=0.557, accuracy=0.88, val_loss=0.751, val_accuracy=0.812, lr=0.00316] 79%|███████▉  | 108/136 [53:34<13:54, 29.79s/epoch, loss=0.555, accuracy=0.883, val_loss=0.78, val_accuracy=0.818, lr=0.01]    80%|████████  | 109/136 [54:04<13:30, 30.00s/epoch, loss=0.554, accuracy=0.881, val_loss=0.833, val_accuracy=0.792, lr=0.01] 81%|████████  | 110/136 [54:35<13:01, 30.07s/epoch, loss=0.551, accuracy=0.883, val_loss=1.07, val_accuracy=0.753, lr=0.01]  82%|████████▏ | 111/136 [55:05<12:36, 30.25s/epoch, loss=0.557, accuracy=0.882, val_loss=0.734, val_accuracy=0.831, lr=0.01] 82%|████████▏ | 112/136 [55:36<12:07, 30.30s/epoch, loss=0.556, accuracy=0.883, val_loss=0.806, val_accuracy=0.803, lr=0.00316] 83%|████████▎ | 113/136 [56:04<11:24, 29.75s/epoch, loss=0.552, accuracy=0.884, val_loss=0.79, val_accuracy=0.803, lr=0.01]     84%|████████▍ | 114/136 [56:34<10:54, 29.73s/epoch, loss=0.555, accuracy=0.882, val_loss=1.1, val_accuracy=0.728, lr=0.01]  85%|████████▍ | 115/136 [57:04<10:28, 29.95s/epoch, loss=0.556, accuracy=0.883, val_loss=0.969, val_accuracy=0.758, lr=0.01] 85%|████████▌ | 116/136 [57:34<09:56, 29.84s/epoch, loss=0.554, accuracy=0.885, val_loss=0.704, val_accuracy=0.839, lr=0.01] 86%|████████▌ | 117/136 [58:03<09:24, 29.70s/epoch, loss=0.553, accuracy=0.884, val_loss=0.96, val_accuracy=0.785, lr=0.00316] 87%|████████▋ | 118/136 [58:33<08:53, 29.64s/epoch, loss=0.553, accuracy=0.885, val_loss=0.811, val_accuracy=0.803, lr=0.01]   88%|████████▊ | 119/136 [59:02<08:24, 29.68s/epoch, loss=0.552, accuracy=0.885, val_loss=0.928, val_accuracy=0.774, lr=0.01] 88%|████████▊ | 120/136 [59:32<07:54, 29.64s/epoch, loss=0.551, accuracy=0.887, val_loss=0.926, val_accuracy=0.766, lr=0.01] 89%|████████▉ | 121/136 [1:00:02<07:24, 29.63s/epoch, loss=0.556, accuracy=0.886, val_loss=0.906, val_accuracy=0.786, lr=0.01] 90%|████████▉ | 122/136 [1:00:32<06:55, 29.71s/epoch, loss=0.477, accuracy=0.914, val_loss=0.527, val_accuracy=0.897, lr=0.001] 90%|█████████ | 123/136 [1:01:02<06:29, 29.97s/epoch, loss=0.422, accuracy=0.93, val_loss=0.508, val_accuracy=0.899, lr=0.001]  91%|█████████ | 124/136 [1:01:32<06:00, 30.02s/epoch, loss=0.4, accuracy=0.937, val_loss=0.501, val_accuracy=0.901, lr=0.001]  92%|█████████▏| 125/136 [1:02:03<05:32, 30.23s/epoch, loss=0.385, accuracy=0.939, val_loss=0.484, val_accuracy=0.904, lr=0.001] 93%|█████████▎| 126/136 [1:02:31<04:55, 29.60s/epoch, loss=0.37, accuracy=0.942, val_loss=0.482, val_accuracy=0.902, lr=0.001]  93%|█████████▎| 127/136 [1:03:00<04:23, 29.32s/epoch, loss=0.36, accuracy=0.943, val_loss=0.48, val_accuracy=0.904, lr=0.001]  94%|█████████▍| 128/136 [1:03:29<03:54, 29.29s/epoch, loss=0.349, accuracy=0.945, val_loss=0.48, val_accuracy=0.901, lr=0.001] 95%|█████████▍| 129/136 [1:03:58<03:23, 29.14s/epoch, loss=0.338, accuracy=0.947, val_loss=0.474, val_accuracy=0.902, lr=0.001] 96%|█████████▌| 130/136 [1:04:26<02:53, 28.99s/epoch, loss=0.327, accuracy=0.95, val_loss=0.471, val_accuracy=0.902, lr=0.001]  96%|█████████▋| 131/136 [1:04:56<02:26, 29.25s/epoch, loss=0.32, accuracy=0.951, val_loss=0.461, val_accuracy=0.902, lr=0.001] 97%|█████████▋| 132/136 [1:05:26<01:57, 29.43s/epoch, loss=0.311, accuracy=0.951, val_loss=0.454, val_accuracy=0.9, lr=0.001]  98%|█████████▊| 133/136 [1:05:54<01:27, 29.05s/epoch, loss=0.303, accuracy=0.952, val_loss=0.463, val_accuracy=0.9, lr=0.001] 99%|█████████▊| 134/136 [1:06:23<00:58, 29.05s/epoch, loss=0.297, accuracy=0.953, val_loss=0.45, val_accuracy=0.903, lr=0.001] 99%|█████████▉| 135/136 [1:06:53<00:29, 29.31s/epoch, loss=0.289, accuracy=0.955, val_loss=0.459, val_accuracy=0.897, lr=0.001]100%|██████████| 136/136 [1:07:23<00:00, 29.44s/epoch, loss=0.283, accuracy=0.956, val_loss=0.447, val_accuracy=0.902, lr=0.001]100%|██████████| 136/136 [1:07:23<00:00, 29.73s/epoch, loss=0.283, accuracy=0.956, val_loss=0.447, val_accuracy=0.902, lr=0.001]
Using real-time data augmentation.
Test loss: 0.44699355959892273
Test accuracy: 0.9023000001907349


* * * Run SGD for ID = 11_5. * * *


2024-02-15 16:18:03.831246: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 16:18:06.769654: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 16:18:06.770999: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-15 16:18:06.812305: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 16:18:06.812352: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 16:18:06.815989: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 16:18:06.816067: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 16:18:06.818747: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 16:18:06.819495: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 16:18:06.822470: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 16:18:06.824289: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 16:18:06.830096: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 16:18:06.830817: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 16:18:06.830905: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 16:18:08.151948: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-15 16:18:08.153081: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 16:18:08.153597: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 16:18:08.153632: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 16:18:08.153668: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 16:18:08.153683: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 16:18:08.153697: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 16:18:08.153712: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 16:18:08.153726: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 16:18:08.153740: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 16:18:08.153755: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 16:18:08.154345: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 16:18:08.154382: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 16:18:08.881780: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-15 16:18:08.881850: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-15 16:18:08.881861: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-15 16:18:08.883688: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:18:00.0, compute capability: 6.1)
{'id': 115, 'batch_size': 128, 'epochs': 136, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/136 [00:00<?, ?epoch/s]2024-02-15 16:18:09.732063: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-15 16:18:09.744755: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-02-15 16:18:11.819030: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 16:18:12.212641: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 16:18:13.172582: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-15 16:18:13.227347: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/136 [01:05<2:27:21, 65.50s/epoch, loss=3.16, accuracy=0.324, val_loss=2.06, val_accuracy=0.335, lr=0.1]  1%|▏         | 2/136 [01:34<1:38:02, 43.90s/epoch, loss=1.58, accuracy=0.524, val_loss=1.8, val_accuracy=0.449, lr=0.1]   2%|▏         | 3/136 [02:03<1:22:53, 37.40s/epoch, loss=1.35, accuracy=0.632, val_loss=2.62, val_accuracy=0.332, lr=0.1]  3%|▎         | 4/136 [02:32<1:14:38, 33.93s/epoch, loss=1.28, accuracy=0.68, val_loss=2.92, val_accuracy=0.4, lr=0.1]     4%|▎         | 5/136 [03:01<1:09:47, 31.97s/epoch, loss=1.24, accuracy=0.7, val_loss=2.08, val_accuracy=0.491, lr=0.1]  4%|▍         | 6/136 [03:29<1:06:23, 30.64s/epoch, loss=1.23, accuracy=0.711, val_loss=1.51, val_accuracy=0.611, lr=0.1]  5%|▌         | 7/136 [03:57<1:04:18, 29.91s/epoch, loss=1.21, accuracy=0.721, val_loss=4.32, val_accuracy=0.354, lr=0.1]  6%|▌         | 8/136 [04:27<1:03:39, 29.84s/epoch, loss=1.21, accuracy=0.726, val_loss=2.86, val_accuracy=0.315, lr=0.1]  7%|▋         | 9/136 [04:58<1:03:58, 30.23s/epoch, loss=1.19, accuracy=0.731, val_loss=1.56, val_accuracy=0.565, lr=0.1]  7%|▋         | 10/136 [05:27<1:03:03, 30.03s/epoch, loss=1.2, accuracy=0.733, val_loss=1.9, val_accuracy=0.47, lr=0.1]    8%|▊         | 11/136 [05:55<1:01:19, 29.43s/epoch, loss=1.18, accuracy=0.736, val_loss=2.17, val_accuracy=0.397, lr=0.0316]  9%|▉         | 12/136 [06:26<1:01:23, 29.70s/epoch, loss=1.18, accuracy=0.736, val_loss=1.7, val_accuracy=0.572, lr=0.1]     10%|▉         | 13/136 [06:55<1:00:45, 29.64s/epoch, loss=1.17, accuracy=0.741, val_loss=1.43, val_accuracy=0.67, lr=0.1] 10%|█         | 14/136 [07:25<1:00:01, 29.52s/epoch, loss=1.17, accuracy=0.742, val_loss=2.32, val_accuracy=0.485, lr=0.1] 11%|█         | 15/136 [07:55<1:00:20, 29.92s/epoch, loss=1.17, accuracy=0.741, val_loss=1.4, val_accuracy=0.662, lr=0.1]  12%|█▏        | 16/136 [08:27<1:00:45, 30.38s/epoch, loss=1.17, accuracy=0.742, val_loss=1.7, val_accuracy=0.573, lr=0.1] 12%|█▎        | 17/136 [08:58<1:00:41, 30.60s/epoch, loss=1.17, accuracy=0.743, val_loss=2.24, val_accuracy=0.439, lr=0.1] 13%|█▎        | 18/136 [09:29<1:00:16, 30.64s/epoch, loss=1.15, accuracy=0.747, val_loss=1.81, val_accuracy=0.572, lr=0.1] 14%|█▍        | 19/136 [10:00<1:00:01, 30.79s/epoch, loss=1.16, accuracy=0.746, val_loss=1.87, val_accuracy=0.515, lr=0.1] 15%|█▍        | 20/136 [10:31<59:47, 30.93s/epoch, loss=1.16, accuracy=0.748, val_loss=2.68, val_accuracy=0.43, lr=0.0316] 15%|█▌        | 21/136 [11:03<59:43, 31.16s/epoch, loss=1.15, accuracy=0.749, val_loss=2.32, val_accuracy=0.412, lr=0.1]   16%|█▌        | 22/136 [11:34<59:12, 31.16s/epoch, loss=1.15, accuracy=0.75, val_loss=1.44, val_accuracy=0.65, lr=0.1]   17%|█▋        | 23/136 [12:05<58:32, 31.09s/epoch, loss=1.15, accuracy=0.751, val_loss=1.73, val_accuracy=0.562, lr=0.1] 18%|█▊        | 24/136 [12:35<57:27, 30.78s/epoch, loss=1.14, accuracy=0.752, val_loss=1.85, val_accuracy=0.495, lr=0.1] 18%|█▊        | 25/136 [13:06<56:52, 30.74s/epoch, loss=1.14, accuracy=0.753, val_loss=1.7, val_accuracy=0.612, lr=0.0316] 19%|█▉        | 26/136 [13:35<55:48, 30.44s/epoch, loss=1.14, accuracy=0.751, val_loss=1.83, val_accuracy=0.546, lr=0.1]   20%|█▉        | 27/136 [14:06<55:32, 30.58s/epoch, loss=1.13, accuracy=0.752, val_loss=2.6, val_accuracy=0.468, lr=0.1]  21%|██        | 28/136 [14:36<54:33, 30.31s/epoch, loss=1.14, accuracy=0.752, val_loss=1.52, val_accuracy=0.59, lr=0.1] 21%|██▏       | 29/136 [15:07<54:14, 30.41s/epoch, loss=1.13, accuracy=0.753, val_loss=3.14, val_accuracy=0.423, lr=0.1] 22%|██▏       | 30/136 [15:37<53:43, 30.41s/epoch, loss=1.13, accuracy=0.754, val_loss=1.85, val_accuracy=0.534, lr=0.0316] 23%|██▎       | 31/136 [16:08<53:39, 30.66s/epoch, loss=1.14, accuracy=0.753, val_loss=2.48, val_accuracy=0.312, lr=0.1]    24%|██▎       | 32/136 [16:39<53:04, 30.62s/epoch, loss=1.13, accuracy=0.753, val_loss=2.25, val_accuracy=0.477, lr=0.1] 24%|██▍       | 33/136 [17:09<52:19, 30.48s/epoch, loss=1.13, accuracy=0.754, val_loss=1.62, val_accuracy=0.628, lr=0.1] 25%|██▌       | 34/136 [17:40<51:56, 30.55s/epoch, loss=1.12, accuracy=0.755, val_loss=1.51, val_accuracy=0.626, lr=0.1] 26%|██▌       | 35/136 [18:08<50:08, 29.79s/epoch, loss=1.13, accuracy=0.755, val_loss=2.92, val_accuracy=0.337, lr=0.0316] 26%|██▋       | 36/136 [18:36<49:07, 29.47s/epoch, loss=1.13, accuracy=0.755, val_loss=2.04, val_accuracy=0.549, lr=0.1]    27%|██▋       | 37/136 [19:04<47:54, 29.04s/epoch, loss=1.12, accuracy=0.755, val_loss=2.94, val_accuracy=0.274, lr=0.1] 28%|██▊       | 38/136 [19:33<47:03, 28.81s/epoch, loss=1.13, accuracy=0.755, val_loss=2.19, val_accuracy=0.387, lr=0.1] 29%|██▊       | 39/136 [20:02<46:47, 28.95s/epoch, loss=1.12, accuracy=0.755, val_loss=1.38, val_accuracy=0.662, lr=0.1] 29%|██▉       | 40/136 [20:30<45:54, 28.69s/epoch, loss=1.12, accuracy=0.755, val_loss=2.21, val_accuracy=0.419, lr=0.1] 30%|███       | 41/136 [20:59<45:41, 28.86s/epoch, loss=1.11, accuracy=0.757, val_loss=3.35, val_accuracy=0.311, lr=0.1] 31%|███       | 42/136 [21:28<45:22, 28.96s/epoch, loss=1.12, accuracy=0.755, val_loss=3.79, val_accuracy=0.352, lr=0.1] 32%|███▏      | 43/136 [21:57<44:38, 28.80s/epoch, loss=1.12, accuracy=0.756, val_loss=3.71, val_accuracy=0.284, lr=0.1] 32%|███▏      | 44/136 [22:26<44:23, 28.95s/epoch, loss=1.11, accuracy=0.756, val_loss=2.52, val_accuracy=0.405, lr=0.0316] 33%|███▎      | 45/136 [22:55<44:04, 29.06s/epoch, loss=1.12, accuracy=0.755, val_loss=2.36, val_accuracy=0.414, lr=0.1]    34%|███▍      | 46/136 [23:23<43:07, 28.76s/epoch, loss=1.11, accuracy=0.757, val_loss=1.57, val_accuracy=0.615, lr=0.1] 35%|███▍      | 47/136 [23:52<42:29, 28.65s/epoch, loss=1.12, accuracy=0.756, val_loss=3.14, val_accuracy=0.378, lr=0.1] 35%|███▌      | 48/136 [24:20<41:52, 28.55s/epoch, loss=1.11, accuracy=0.756, val_loss=1.93, val_accuracy=0.514, lr=0.1] 36%|███▌      | 49/136 [24:48<41:05, 28.34s/epoch, loss=1.12, accuracy=0.755, val_loss=1.47, val_accuracy=0.636, lr=0.0316] 37%|███▋      | 50/136 [25:18<41:14, 28.77s/epoch, loss=1.11, accuracy=0.757, val_loss=2.25, val_accuracy=0.436, lr=0.1]    38%|███▊      | 51/136 [25:47<40:48, 28.80s/epoch, loss=1.11, accuracy=0.756, val_loss=1.61, val_accuracy=0.61, lr=0.1]  38%|███▊      | 52/136 [26:17<40:49, 29.16s/epoch, loss=1.11, accuracy=0.757, val_loss=1.89, val_accuracy=0.534, lr=0.1] 39%|███▉      | 53/136 [26:45<40:10, 29.04s/epoch, loss=1.11, accuracy=0.758, val_loss=1.73, val_accuracy=0.559, lr=0.1] 40%|███▉      | 54/136 [27:14<39:32, 28.93s/epoch, loss=1.12, accuracy=0.756, val_loss=2.73, val_accuracy=0.421, lr=0.0316] 40%|████      | 55/136 [27:45<39:48, 29.49s/epoch, loss=1.12, accuracy=0.756, val_loss=2.01, val_accuracy=0.551, lr=0.1]    41%|████      | 56/136 [28:16<39:59, 29.99s/epoch, loss=1.11, accuracy=0.758, val_loss=1.82, val_accuracy=0.539, lr=0.1] 42%|████▏     | 57/136 [28:46<39:37, 30.09s/epoch, loss=1.11, accuracy=0.757, val_loss=1.64, val_accuracy=0.579, lr=0.1] 43%|████▎     | 58/136 [29:16<39:04, 30.06s/epoch, loss=1.1, accuracy=0.759, val_loss=2.2, val_accuracy=0.509, lr=0.1]   43%|████▎     | 59/136 [29:48<39:00, 30.40s/epoch, loss=1.11, accuracy=0.756, val_loss=4.07, val_accuracy=0.331, lr=0.0316] 44%|████▍     | 60/136 [30:19<38:48, 30.64s/epoch, loss=1.11, accuracy=0.755, val_loss=1.74, val_accuracy=0.535, lr=0.1]    45%|████▍     | 61/136 [30:50<38:18, 30.65s/epoch, loss=1.11, accuracy=0.758, val_loss=1.74, val_accuracy=0.551, lr=0.1] 46%|████▌     | 62/136 [31:21<38:00, 30.81s/epoch, loss=1.11, accuracy=0.758, val_loss=2.27, val_accuracy=0.427, lr=0.1] 46%|████▋     | 63/136 [31:51<37:26, 30.77s/epoch, loss=1.11, accuracy=0.757, val_loss=1.4, val_accuracy=0.639, lr=0.1]  47%|████▋     | 64/136 [32:22<37:00, 30.84s/epoch, loss=1.11, accuracy=0.757, val_loss=1.86, val_accuracy=0.528, lr=0.0316] 48%|████▊     | 65/136 [32:53<36:25, 30.79s/epoch, loss=1.11, accuracy=0.756, val_loss=2.7, val_accuracy=0.39, lr=0.1]      49%|████▊     | 66/136 [33:24<36:02, 30.89s/epoch, loss=1.11, accuracy=0.758, val_loss=2.35, val_accuracy=0.441, lr=0.1] 49%|████▉     | 67/136 [33:56<35:47, 31.12s/epoch, loss=1.11, accuracy=0.757, val_loss=2.18, val_accuracy=0.405, lr=0.1] 50%|█████     | 68/136 [34:25<34:41, 30.60s/epoch, loss=1.11, accuracy=0.76, val_loss=2.26, val_accuracy=0.417, lr=0.1]  51%|█████     | 69/136 [34:55<34:00, 30.45s/epoch, loss=1.11, accuracy=0.757, val_loss=1.69, val_accuracy=0.557, lr=0.0316] 51%|█████▏    | 70/136 [35:26<33:25, 30.39s/epoch, loss=1.11, accuracy=0.756, val_loss=2.55, val_accuracy=0.426, lr=0.1]    52%|█████▏    | 71/136 [35:55<32:40, 30.16s/epoch, loss=1.1, accuracy=0.76, val_loss=2.06, val_accuracy=0.496, lr=0.1]   53%|█████▎    | 72/136 [36:24<31:36, 29.64s/epoch, loss=1.1, accuracy=0.758, val_loss=2.45, val_accuracy=0.407, lr=0.1] 54%|█████▎    | 73/136 [36:52<30:44, 29.28s/epoch, loss=1.1, accuracy=0.758, val_loss=2.69, val_accuracy=0.408, lr=0.1] 54%|█████▍    | 74/136 [37:21<30:11, 29.22s/epoch, loss=1.11, accuracy=0.757, val_loss=2.14, val_accuracy=0.438, lr=0.0316] 55%|█████▌    | 75/136 [37:50<29:38, 29.16s/epoch, loss=1.12, accuracy=0.758, val_loss=2.54, val_accuracy=0.418, lr=0.1]    56%|█████▌    | 76/136 [38:21<29:41, 29.70s/epoch, loss=1.11, accuracy=0.76, val_loss=2.31, val_accuracy=0.454, lr=0.1]  57%|█████▋    | 77/136 [38:51<29:19, 29.82s/epoch, loss=1.1, accuracy=0.758, val_loss=1.69, val_accuracy=0.565, lr=0.1] 57%|█████▋    | 78/136 [39:22<29:05, 30.10s/epoch, loss=1.1, accuracy=0.759, val_loss=2.24, val_accuracy=0.475, lr=0.1] 58%|█████▊    | 79/136 [39:53<28:54, 30.43s/epoch, loss=1.1, accuracy=0.758, val_loss=2.94, val_accuracy=0.363, lr=0.0316] 59%|█████▉    | 80/136 [40:24<28:30, 30.54s/epoch, loss=1.1, accuracy=0.758, val_loss=1.97, val_accuracy=0.473, lr=0.1]    60%|█████▉    | 81/136 [40:55<28:14, 30.80s/epoch, loss=1.11, accuracy=0.758, val_loss=1.99, val_accuracy=0.495, lr=0.1] 60%|██████    | 82/136 [41:24<27:13, 30.25s/epoch, loss=0.909, accuracy=0.813, val_loss=0.882, val_accuracy=0.805, lr=0.01] 61%|██████    | 83/136 [41:55<26:56, 30.50s/epoch, loss=0.727, accuracy=0.846, val_loss=0.855, val_accuracy=0.786, lr=0.01] 62%|██████▏   | 84/136 [42:27<26:42, 30.82s/epoch, loss=0.646, accuracy=0.854, val_loss=0.877, val_accuracy=0.772, lr=0.01] 62%|██████▎   | 85/136 [42:57<25:53, 30.47s/epoch, loss=0.606, accuracy=0.858, val_loss=0.827, val_accuracy=0.786, lr=0.01] 63%|██████▎   | 86/136 [43:27<25:19, 30.38s/epoch, loss=0.58, accuracy=0.859, val_loss=0.99, val_accuracy=0.741, lr=0.01]   64%|██████▍   | 87/136 [43:56<24:34, 30.09s/epoch, loss=0.572, accuracy=0.862, val_loss=0.797, val_accuracy=0.794, lr=0.01] 65%|██████▍   | 88/136 [44:27<24:18, 30.39s/epoch, loss=0.569, accuracy=0.863, val_loss=0.866, val_accuracy=0.779, lr=0.01] 65%|██████▌   | 89/136 [44:57<23:31, 30.04s/epoch, loss=0.564, accuracy=0.864, val_loss=0.885, val_accuracy=0.768, lr=0.01] 66%|██████▌   | 90/136 [45:28<23:15, 30.33s/epoch, loss=0.563, accuracy=0.865, val_loss=0.948, val_accuracy=0.759, lr=0.01] 67%|██████▋   | 91/136 [45:59<22:55, 30.57s/epoch, loss=0.558, accuracy=0.867, val_loss=0.804, val_accuracy=0.796, lr=0.01] 68%|██████▊   | 92/136 [46:29<22:20, 30.47s/epoch, loss=0.555, accuracy=0.869, val_loss=0.82, val_accuracy=0.795, lr=0.00316] 68%|██████▊   | 93/136 [46:59<21:46, 30.38s/epoch, loss=0.557, accuracy=0.869, val_loss=0.896, val_accuracy=0.758, lr=0.01]   69%|██████▉   | 94/136 [47:27<20:48, 29.73s/epoch, loss=0.556, accuracy=0.871, val_loss=0.998, val_accuracy=0.739, lr=0.01] 70%|██████▉   | 95/136 [47:59<20:37, 30.19s/epoch, loss=0.556, accuracy=0.871, val_loss=0.68, val_accuracy=0.831, lr=0.01]  71%|███████   | 96/136 [48:30<20:21, 30.53s/epoch, loss=0.552, accuracy=0.874, val_loss=1.71, val_accuracy=0.603, lr=0.01] 71%|███████▏  | 97/136 [49:01<19:52, 30.56s/epoch, loss=0.554, accuracy=0.873, val_loss=0.793, val_accuracy=0.799, lr=0.01] 72%|███████▏  | 98/136 [49:31<19:18, 30.50s/epoch, loss=0.552, accuracy=0.875, val_loss=0.956, val_accuracy=0.746, lr=0.01] 73%|███████▎  | 99/136 [50:02<18:56, 30.73s/epoch, loss=0.548, accuracy=0.876, val_loss=1.27, val_accuracy=0.629, lr=0.01]  74%|███████▎  | 100/136 [50:32<18:12, 30.34s/epoch, loss=0.555, accuracy=0.875, val_loss=1.06, val_accuracy=0.715, lr=0.00316] 74%|███████▍  | 101/136 [51:02<17:39, 30.26s/epoch, loss=0.547, accuracy=0.877, val_loss=0.836, val_accuracy=0.796, lr=0.01]   75%|███████▌  | 102/136 [51:32<17:10, 30.31s/epoch, loss=0.549, accuracy=0.878, val_loss=0.965, val_accuracy=0.761, lr=0.01] 76%|███████▌  | 103/136 [52:02<16:40, 30.33s/epoch, loss=0.556, accuracy=0.876, val_loss=0.719, val_accuracy=0.823, lr=0.01] 76%|███████▋  | 104/136 [52:31<15:54, 29.84s/epoch, loss=0.548, accuracy=0.881, val_loss=0.862, val_accuracy=0.778, lr=0.01] 77%|███████▋  | 105/136 [53:01<15:20, 29.71s/epoch, loss=0.552, accuracy=0.878, val_loss=0.908, val_accuracy=0.781, lr=0.00316] 78%|███████▊  | 106/136 [53:31<14:54, 29.81s/epoch, loss=0.552, accuracy=0.878, val_loss=0.694, val_accuracy=0.837, lr=0.01]    79%|███████▊  | 107/136 [54:01<14:30, 30.00s/epoch, loss=0.549, accuracy=0.879, val_loss=0.913, val_accuracy=0.776, lr=0.01] 79%|███████▉  | 108/136 [54:29<13:45, 29.47s/epoch, loss=0.549, accuracy=0.88, val_loss=0.848, val_accuracy=0.789, lr=0.01]  80%|████████  | 109/136 [54:59<13:19, 29.62s/epoch, loss=0.553, accuracy=0.879, val_loss=0.956, val_accuracy=0.775, lr=0.01] 81%|████████  | 110/136 [55:30<12:58, 29.93s/epoch, loss=0.552, accuracy=0.881, val_loss=0.734, val_accuracy=0.822, lr=0.00316] 82%|████████▏ | 111/136 [56:00<12:32, 30.11s/epoch, loss=0.552, accuracy=0.881, val_loss=0.813, val_accuracy=0.796, lr=0.01]    82%|████████▏ | 112/136 [56:31<12:03, 30.15s/epoch, loss=0.549, accuracy=0.881, val_loss=0.894, val_accuracy=0.785, lr=0.01] 83%|████████▎ | 113/136 [56:59<11:21, 29.62s/epoch, loss=0.548, accuracy=0.882, val_loss=0.971, val_accuracy=0.767, lr=0.01] 84%|████████▍ | 114/136 [57:31<11:04, 30.20s/epoch, loss=0.555, accuracy=0.881, val_loss=0.791, val_accuracy=0.812, lr=0.01] 85%|████████▍ | 115/136 [58:00<10:27, 29.88s/epoch, loss=0.546, accuracy=0.885, val_loss=0.779, val_accuracy=0.81, lr=0.00316] 85%|████████▌ | 116/136 [58:29<09:55, 29.79s/epoch, loss=0.551, accuracy=0.882, val_loss=0.836, val_accuracy=0.8, lr=0.01]     86%|████████▌ | 117/136 [59:00<09:29, 29.95s/epoch, loss=0.547, accuracy=0.884, val_loss=0.8, val_accuracy=0.812, lr=0.01] 87%|████████▋ | 118/136 [59:30<09:01, 30.08s/epoch, loss=0.551, accuracy=0.884, val_loss=0.712, val_accuracy=0.83, lr=0.01] 88%|████████▊ | 119/136 [59:59<08:24, 29.70s/epoch, loss=0.551, accuracy=0.884, val_loss=1.1, val_accuracy=0.723, lr=0.01]  88%|████████▊ | 120/136 [1:00:28<07:50, 29.43s/epoch, loss=0.548, accuracy=0.885, val_loss=0.808, val_accuracy=0.811, lr=0.00316] 89%|████████▉ | 121/136 [1:00:57<07:19, 29.30s/epoch, loss=0.548, accuracy=0.883, val_loss=0.99, val_accuracy=0.75, lr=0.01]      90%|████████▉ | 122/136 [1:01:27<06:54, 29.60s/epoch, loss=0.476, accuracy=0.911, val_loss=0.526, val_accuracy=0.893, lr=0.001] 90%|█████████ | 123/136 [1:01:58<06:28, 29.89s/epoch, loss=0.424, accuracy=0.927, val_loss=0.508, val_accuracy=0.897, lr=0.001] 91%|█████████ | 124/136 [1:02:27<05:58, 29.85s/epoch, loss=0.399, accuracy=0.934, val_loss=0.501, val_accuracy=0.899, lr=0.001] 92%|█████████▏| 125/136 [1:02:56<05:24, 29.54s/epoch, loss=0.383, accuracy=0.938, val_loss=0.492, val_accuracy=0.9, lr=0.001]   93%|█████████▎| 126/136 [1:03:24<04:51, 29.16s/epoch, loss=0.371, accuracy=0.94, val_loss=0.488, val_accuracy=0.897, lr=0.001] 93%|█████████▎| 127/136 [1:03:54<04:24, 29.37s/epoch, loss=0.357, accuracy=0.942, val_loss=0.488, val_accuracy=0.898, lr=0.001] 94%|█████████▍| 128/136 [1:04:24<03:54, 29.37s/epoch, loss=0.347, accuracy=0.944, val_loss=0.474, val_accuracy=0.9, lr=0.001]   95%|█████████▍| 129/136 [1:04:52<03:24, 29.16s/epoch, loss=0.337, accuracy=0.946, val_loss=0.471, val_accuracy=0.901, lr=0.001] 96%|█████████▌| 130/136 [1:05:22<02:55, 29.30s/epoch, loss=0.327, accuracy=0.948, val_loss=0.478, val_accuracy=0.897, lr=0.001] 96%|█████████▋| 131/136 [1:05:50<02:24, 28.92s/epoch, loss=0.319, accuracy=0.949, val_loss=0.462, val_accuracy=0.902, lr=0.001] 97%|█████████▋| 132/136 [1:06:20<01:56, 29.20s/epoch, loss=0.312, accuracy=0.95, val_loss=0.47, val_accuracy=0.897, lr=0.001]   98%|█████████▊| 133/136 [1:06:48<01:27, 29.01s/epoch, loss=0.304, accuracy=0.951, val_loss=0.461, val_accuracy=0.903, lr=0.001] 99%|█████████▊| 134/136 [1:07:19<00:59, 29.53s/epoch, loss=0.298, accuracy=0.951, val_loss=0.46, val_accuracy=0.897, lr=0.001]  99%|█████████▉| 135/136 [1:07:49<00:29, 29.53s/epoch, loss=0.288, accuracy=0.954, val_loss=0.459, val_accuracy=0.898, lr=0.001]100%|██████████| 136/136 [1:08:18<00:00, 29.48s/epoch, loss=0.282, accuracy=0.955, val_loss=0.473, val_accuracy=0.893, lr=0.001]100%|██████████| 136/136 [1:08:18<00:00, 30.14s/epoch, loss=0.282, accuracy=0.955, val_loss=0.473, val_accuracy=0.893, lr=0.001]
Using real-time data augmentation.
Test loss: 0.4725377559661865
Test accuracy: 0.8931999802589417


* * * Run SGD for ID = 11_6. * * *


2024-02-15 17:26:31.167352: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 17:26:33.932163: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 17:26:33.933485: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-15 17:26:33.977380: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 17:26:33.977427: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 17:26:33.980969: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 17:26:33.981038: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 17:26:33.983608: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 17:26:33.984396: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 17:26:33.987100: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 17:26:33.988712: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 17:26:33.994096: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 17:26:33.994759: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 17:26:33.995154: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 17:26:35.270218: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-15 17:26:35.271225: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 17:26:35.271745: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 17:26:35.271783: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 17:26:35.271819: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 17:26:35.271835: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 17:26:35.271850: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 17:26:35.271874: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 17:26:35.271889: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 17:26:35.271904: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 17:26:35.271919: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 17:26:35.272484: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 17:26:35.272523: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 17:26:35.928845: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-15 17:26:35.928905: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-15 17:26:35.928917: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-15 17:26:35.930438: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:18:00.0, compute capability: 6.1)
{'id': 116, 'batch_size': 128, 'epochs': 136, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/136 [00:00<?, ?epoch/s]2024-02-15 17:26:36.736704: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-15 17:26:36.748733: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-02-15 17:26:38.743916: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 17:26:39.092601: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 17:26:40.101751: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-15 17:26:40.151105: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/136 [01:06<2:30:35, 66.93s/epoch, loss=3.45, accuracy=0.263, val_loss=3.09, val_accuracy=0.129, lr=0.1]  1%|▏         | 2/136 [01:36<1:39:45, 44.67s/epoch, loss=1.67, accuracy=0.468, val_loss=2.35, val_accuracy=0.405, lr=0.1]  2%|▏         | 3/136 [02:05<1:24:01, 37.91s/epoch, loss=1.41, accuracy=0.592, val_loss=2.09, val_accuracy=0.495, lr=0.1]  3%|▎         | 4/136 [02:34<1:15:16, 34.22s/epoch, loss=1.29, accuracy=0.665, val_loss=2.63, val_accuracy=0.371, lr=0.1]  4%|▎         | 5/136 [03:02<1:10:11, 32.15s/epoch, loss=1.24, accuracy=0.693, val_loss=1.5, val_accuracy=0.596, lr=0.1]   4%|▍         | 6/136 [03:32<1:07:34, 31.19s/epoch, loss=1.22, accuracy=0.709, val_loss=1.63, val_accuracy=0.561, lr=0.1]  5%|▌         | 7/136 [04:00<1:05:06, 30.28s/epoch, loss=1.22, accuracy=0.715, val_loss=1.85, val_accuracy=0.526, lr=0.1]  6%|▌         | 8/136 [04:30<1:04:33, 30.26s/epoch, loss=1.21, accuracy=0.723, val_loss=4.43, val_accuracy=0.372, lr=0.1]  7%|▋         | 9/136 [05:00<1:03:42, 30.10s/epoch, loss=1.21, accuracy=0.723, val_loss=1.65, val_accuracy=0.578, lr=0.1]  7%|▋         | 10/136 [05:30<1:03:14, 30.12s/epoch, loss=1.2, accuracy=0.729, val_loss=2.48, val_accuracy=0.353, lr=0.0316]  8%|▊         | 11/136 [06:00<1:02:47, 30.14s/epoch, loss=1.2, accuracy=0.734, val_loss=2.45, val_accuracy=0.413, lr=0.1]     9%|▉         | 12/136 [06:31<1:02:40, 30.33s/epoch, loss=1.2, accuracy=0.735, val_loss=2.71, val_accuracy=0.36, lr=0.1]  10%|▉         | 13/136 [07:01<1:01:56, 30.21s/epoch, loss=1.2, accuracy=0.737, val_loss=1.69, val_accuracy=0.576, lr=0.1] 10%|█         | 14/136 [07:30<1:00:16, 29.64s/epoch, loss=1.18, accuracy=0.739, val_loss=2.06, val_accuracy=0.459, lr=0.1] 11%|█         | 15/136 [08:00<1:00:19, 29.91s/epoch, loss=1.19, accuracy=0.737, val_loss=2.54, val_accuracy=0.301, lr=0.0316] 12%|█▏        | 16/136 [08:30<1:00:07, 30.06s/epoch, loss=1.19, accuracy=0.742, val_loss=1.72, val_accuracy=0.583, lr=0.1]    12%|█▎        | 17/136 [09:00<59:24, 29.95s/epoch, loss=1.18, accuracy=0.742, val_loss=2.15, val_accuracy=0.443, lr=0.1]   13%|█▎        | 18/136 [09:29<58:14, 29.61s/epoch, loss=1.18, accuracy=0.741, val_loss=4.39, val_accuracy=0.326, lr=0.1] 14%|█▍        | 19/136 [09:57<57:02, 29.25s/epoch, loss=1.17, accuracy=0.744, val_loss=1.58, val_accuracy=0.578, lr=0.1] 15%|█▍        | 20/136 [10:27<56:57, 29.46s/epoch, loss=1.17, accuracy=0.744, val_loss=1.69, val_accuracy=0.563, lr=0.0316] 15%|█▌        | 21/136 [10:57<56:48, 29.64s/epoch, loss=1.17, accuracy=0.744, val_loss=2.17, val_accuracy=0.505, lr=0.1]    16%|█▌        | 22/136 [11:27<56:22, 29.67s/epoch, loss=1.17, accuracy=0.746, val_loss=1.47, val_accuracy=0.656, lr=0.1] 17%|█▋        | 23/136 [11:56<55:34, 29.51s/epoch, loss=1.17, accuracy=0.746, val_loss=3.54, val_accuracy=0.322, lr=0.1] 18%|█▊        | 24/136 [12:26<55:12, 29.57s/epoch, loss=1.15, accuracy=0.747, val_loss=2.48, val_accuracy=0.333, lr=0.1] 18%|█▊        | 25/136 [12:54<54:03, 29.22s/epoch, loss=1.17, accuracy=0.744, val_loss=2.43, val_accuracy=0.455, lr=0.1] 19%|█▉        | 26/136 [13:22<52:46, 28.79s/epoch, loss=1.16, accuracy=0.746, val_loss=2.07, val_accuracy=0.482, lr=0.1] 20%|█▉        | 27/136 [13:51<52:06, 28.69s/epoch, loss=1.16, accuracy=0.749, val_loss=1.65, val_accuracy=0.598, lr=0.0316] 21%|██        | 28/136 [14:20<52:16, 29.04s/epoch, loss=1.16, accuracy=0.749, val_loss=1.7, val_accuracy=0.567, lr=0.1]     21%|██▏       | 29/136 [14:50<52:16, 29.31s/epoch, loss=1.16, accuracy=0.749, val_loss=2.14, val_accuracy=0.421, lr=0.1] 22%|██▏       | 30/136 [15:21<52:22, 29.65s/epoch, loss=1.16, accuracy=0.749, val_loss=3, val_accuracy=0.328, lr=0.1]    23%|██▎       | 31/136 [15:50<51:38, 29.51s/epoch, loss=1.15, accuracy=0.752, val_loss=1.59, val_accuracy=0.584, lr=0.1] 24%|██▎       | 32/136 [16:18<50:30, 29.13s/epoch, loss=1.15, accuracy=0.753, val_loss=1.64, val_accuracy=0.567, lr=0.0316] 24%|██▍       | 33/136 [16:48<50:25, 29.37s/epoch, loss=1.14, accuracy=0.754, val_loss=5.05, val_accuracy=0.271, lr=0.1]    25%|██▌       | 34/136 [17:17<49:53, 29.34s/epoch, loss=1.14, accuracy=0.752, val_loss=1.86, val_accuracy=0.499, lr=0.1] 26%|██▌       | 35/136 [17:47<49:38, 29.49s/epoch, loss=1.15, accuracy=0.752, val_loss=2.52, val_accuracy=0.452, lr=0.1] 26%|██▋       | 36/136 [18:17<49:05, 29.46s/epoch, loss=1.14, accuracy=0.754, val_loss=2.36, val_accuracy=0.39, lr=0.1]  27%|██▋       | 37/136 [18:45<48:06, 29.16s/epoch, loss=1.14, accuracy=0.752, val_loss=1.65, val_accuracy=0.594, lr=0.0316] 28%|██▊       | 38/136 [19:16<48:12, 29.51s/epoch, loss=1.15, accuracy=0.756, val_loss=1.56, val_accuracy=0.613, lr=0.1]    29%|██▊       | 39/136 [19:45<47:29, 29.38s/epoch, loss=1.14, accuracy=0.756, val_loss=1.86, val_accuracy=0.479, lr=0.1] 29%|██▉       | 40/136 [20:15<47:36, 29.75s/epoch, loss=1.15, accuracy=0.754, val_loss=1.5, val_accuracy=0.64, lr=0.1]   30%|███       | 41/136 [20:46<47:32, 30.03s/epoch, loss=1.14, accuracy=0.752, val_loss=1.88, val_accuracy=0.524, lr=0.1] 31%|███       | 42/136 [21:16<47:12, 30.14s/epoch, loss=1.15, accuracy=0.751, val_loss=2.13, val_accuracy=0.445, lr=0.0316] 32%|███▏      | 43/136 [21:45<46:03, 29.71s/epoch, loss=1.14, accuracy=0.753, val_loss=2.89, val_accuracy=0.261, lr=0.1]    32%|███▏      | 44/136 [22:15<45:45, 29.84s/epoch, loss=1.13, accuracy=0.755, val_loss=1.31, val_accuracy=0.687, lr=0.1] 33%|███▎      | 45/136 [22:45<45:15, 29.85s/epoch, loss=1.14, accuracy=0.753, val_loss=1.35, val_accuracy=0.673, lr=0.1] 34%|███▍      | 46/136 [23:14<44:33, 29.71s/epoch, loss=1.14, accuracy=0.755, val_loss=2.35, val_accuracy=0.422, lr=0.1] 35%|███▍      | 47/136 [23:45<44:37, 30.08s/epoch, loss=1.13, accuracy=0.757, val_loss=2.64, val_accuracy=0.382, lr=0.1] 35%|███▌      | 48/136 [24:16<44:21, 30.24s/epoch, loss=1.13, accuracy=0.754, val_loss=1.68, val_accuracy=0.573, lr=0.1] 36%|███▌      | 49/136 [24:44<43:03, 29.70s/epoch, loss=1.13, accuracy=0.758, val_loss=1.98, val_accuracy=0.5, lr=0.0316] 37%|███▋      | 50/136 [25:14<42:26, 29.62s/epoch, loss=1.13, accuracy=0.756, val_loss=2.25, val_accuracy=0.411, lr=0.1]  38%|███▊      | 51/136 [25:45<42:28, 29.98s/epoch, loss=1.13, accuracy=0.754, val_loss=3.24, val_accuracy=0.238, lr=0.1] 38%|███▊      | 52/136 [26:14<41:54, 29.93s/epoch, loss=1.14, accuracy=0.756, val_loss=2.09, val_accuracy=0.52, lr=0.1]  39%|███▉      | 53/136 [26:45<41:39, 30.12s/epoch, loss=1.14, accuracy=0.756, val_loss=1.78, val_accuracy=0.573, lr=0.1] 40%|███▉      | 54/136 [27:15<41:16, 30.20s/epoch, loss=1.14, accuracy=0.757, val_loss=4.12, val_accuracy=0.229, lr=0.0316] 40%|████      | 55/136 [27:46<40:51, 30.26s/epoch, loss=1.14, accuracy=0.756, val_loss=2.06, val_accuracy=0.47, lr=0.1]     41%|████      | 56/136 [28:15<40:00, 30.00s/epoch, loss=1.13, accuracy=0.755, val_loss=1.74, val_accuracy=0.546, lr=0.1] 42%|████▏     | 57/136 [28:45<39:19, 29.87s/epoch, loss=1.13, accuracy=0.759, val_loss=1.71, val_accuracy=0.533, lr=0.1] 43%|████▎     | 58/136 [29:14<38:38, 29.73s/epoch, loss=1.13, accuracy=0.757, val_loss=3.87, val_accuracy=0.269, lr=0.1] 43%|████▎     | 59/136 [29:43<37:53, 29.53s/epoch, loss=1.14, accuracy=0.755, val_loss=1.64, val_accuracy=0.613, lr=0.0316] 44%|████▍     | 60/136 [30:13<37:32, 29.64s/epoch, loss=1.13, accuracy=0.755, val_loss=1.63, val_accuracy=0.568, lr=0.1]    45%|████▍     | 61/136 [30:42<36:50, 29.47s/epoch, loss=1.13, accuracy=0.756, val_loss=2.82, val_accuracy=0.347, lr=0.1] 46%|████▌     | 62/136 [31:10<35:54, 29.11s/epoch, loss=1.13, accuracy=0.756, val_loss=1.4, val_accuracy=0.657, lr=0.1]  46%|████▋     | 63/136 [31:40<35:25, 29.12s/epoch, loss=1.13, accuracy=0.756, val_loss=1.44, val_accuracy=0.649, lr=0.1] 47%|████▋     | 64/136 [32:08<34:51, 29.05s/epoch, loss=1.13, accuracy=0.758, val_loss=2.43, val_accuracy=0.4, lr=0.0316] 48%|████▊     | 65/136 [32:39<34:55, 29.51s/epoch, loss=1.13, accuracy=0.758, val_loss=1.85, val_accuracy=0.567, lr=0.1]  49%|████▊     | 66/136 [33:08<34:12, 29.32s/epoch, loss=1.13, accuracy=0.757, val_loss=1.59, val_accuracy=0.616, lr=0.1] 49%|████▉     | 67/136 [33:37<33:46, 29.37s/epoch, loss=1.13, accuracy=0.76, val_loss=1.46, val_accuracy=0.642, lr=0.1]  50%|█████     | 68/136 [34:08<33:32, 29.60s/epoch, loss=1.13, accuracy=0.757, val_loss=2.73, val_accuracy=0.291, lr=0.1] 51%|█████     | 69/136 [34:37<33:03, 29.61s/epoch, loss=1.13, accuracy=0.755, val_loss=2.31, val_accuracy=0.521, lr=0.0316] 51%|█████▏    | 70/136 [35:08<32:59, 30.00s/epoch, loss=1.13, accuracy=0.758, val_loss=2.03, val_accuracy=0.471, lr=0.1]    52%|█████▏    | 71/136 [35:38<32:32, 30.03s/epoch, loss=1.12, accuracy=0.759, val_loss=2.61, val_accuracy=0.346, lr=0.1] 53%|█████▎    | 72/136 [36:08<32:05, 30.08s/epoch, loss=1.13, accuracy=0.758, val_loss=2.32, val_accuracy=0.423, lr=0.1] 54%|█████▎    | 73/136 [36:38<31:19, 29.83s/epoch, loss=1.13, accuracy=0.758, val_loss=2.12, val_accuracy=0.45, lr=0.1]  54%|█████▍    | 74/136 [37:06<30:18, 29.33s/epoch, loss=1.12, accuracy=0.761, val_loss=1.72, val_accuracy=0.57, lr=0.0316] 55%|█████▌    | 75/136 [37:35<29:38, 29.15s/epoch, loss=1.12, accuracy=0.757, val_loss=1.96, val_accuracy=0.534, lr=0.1]   56%|█████▌    | 76/136 [38:04<29:16, 29.28s/epoch, loss=1.12, accuracy=0.758, val_loss=2.08, val_accuracy=0.395, lr=0.1] 57%|█████▋    | 77/136 [38:34<28:52, 29.37s/epoch, loss=1.13, accuracy=0.757, val_loss=3.53, val_accuracy=0.413, lr=0.1] 57%|█████▋    | 78/136 [39:05<28:50, 29.83s/epoch, loss=1.13, accuracy=0.758, val_loss=1.83, val_accuracy=0.529, lr=0.1] 58%|█████▊    | 79/136 [39:35<28:21, 29.85s/epoch, loss=1.12, accuracy=0.759, val_loss=2.73, val_accuracy=0.373, lr=0.0316] 59%|█████▉    | 80/136 [40:05<28:03, 30.06s/epoch, loss=1.12, accuracy=0.759, val_loss=2.61, val_accuracy=0.452, lr=0.1]    60%|█████▉    | 81/136 [40:35<27:34, 30.08s/epoch, loss=1.13, accuracy=0.758, val_loss=1.51, val_accuracy=0.639, lr=0.1] 60%|██████    | 82/136 [41:05<26:58, 29.98s/epoch, loss=0.912, accuracy=0.817, val_loss=0.914, val_accuracy=0.799, lr=0.01] 61%|██████    | 83/136 [41:36<26:41, 30.21s/epoch, loss=0.727, accuracy=0.852, val_loss=0.823, val_accuracy=0.808, lr=0.01] 62%|██████▏   | 84/136 [42:04<25:39, 29.61s/epoch, loss=0.645, accuracy=0.859, val_loss=0.741, val_accuracy=0.818, lr=0.01] 62%|██████▎   | 85/136 [42:34<25:19, 29.80s/epoch, loss=0.603, accuracy=0.86, val_loss=0.752, val_accuracy=0.807, lr=0.01]  63%|██████▎   | 86/136 [43:05<24:59, 29.99s/epoch, loss=0.586, accuracy=0.863, val_loss=0.799, val_accuracy=0.796, lr=0.01] 64%|██████▍   | 87/136 [43:35<24:29, 30.00s/epoch, loss=0.579, accuracy=0.862, val_loss=0.783, val_accuracy=0.796, lr=0.01] 65%|██████▍   | 88/136 [44:04<23:57, 29.95s/epoch, loss=0.569, accuracy=0.865, val_loss=1.05, val_accuracy=0.737, lr=0.01]  65%|██████▌   | 89/136 [44:33<23:11, 29.60s/epoch, loss=0.564, accuracy=0.868, val_loss=0.832, val_accuracy=0.789, lr=0.00316] 66%|██████▌   | 90/136 [45:04<22:54, 29.88s/epoch, loss=0.557, accuracy=0.869, val_loss=0.733, val_accuracy=0.805, lr=0.01]    67%|██████▋   | 91/136 [45:34<22:28, 29.97s/epoch, loss=0.56, accuracy=0.87, val_loss=0.9, val_accuracy=0.768, lr=0.01]     68%|██████▊   | 92/136 [46:04<21:55, 29.89s/epoch, loss=0.56, accuracy=0.868, val_loss=0.766, val_accuracy=0.806, lr=0.01] 68%|██████▊   | 93/136 [46:33<21:20, 29.79s/epoch, loss=0.555, accuracy=0.872, val_loss=0.829, val_accuracy=0.795, lr=0.01] 69%|██████▉   | 94/136 [47:03<20:48, 29.73s/epoch, loss=0.56, accuracy=0.871, val_loss=0.984, val_accuracy=0.769, lr=0.01]  70%|██████▉   | 95/136 [47:31<20:03, 29.34s/epoch, loss=0.559, accuracy=0.874, val_loss=0.924, val_accuracy=0.776, lr=0.00316] 71%|███████   | 96/136 [48:01<19:45, 29.63s/epoch, loss=0.556, accuracy=0.875, val_loss=0.721, val_accuracy=0.825, lr=0.01]    71%|███████▏  | 97/136 [48:31<19:11, 29.52s/epoch, loss=0.556, accuracy=0.875, val_loss=0.752, val_accuracy=0.815, lr=0.01] 72%|███████▏  | 98/136 [49:01<18:44, 29.59s/epoch, loss=0.552, accuracy=0.878, val_loss=0.844, val_accuracy=0.775, lr=0.01] 73%|███████▎  | 99/136 [49:31<18:19, 29.72s/epoch, loss=0.554, accuracy=0.877, val_loss=0.926, val_accuracy=0.756, lr=0.01] 74%|███████▎  | 100/136 [50:01<17:53, 29.81s/epoch, loss=0.55, accuracy=0.88, val_loss=0.698, val_accuracy=0.834, lr=0.01]  74%|███████▍  | 101/136 [50:31<17:26, 29.89s/epoch, loss=0.555, accuracy=0.879, val_loss=0.927, val_accuracy=0.755, lr=0.01] 75%|███████▌  | 102/136 [51:01<17:03, 30.09s/epoch, loss=0.554, accuracy=0.878, val_loss=0.73, val_accuracy=0.823, lr=0.01]  76%|███████▌  | 103/136 [51:31<16:34, 30.15s/epoch, loss=0.553, accuracy=0.88, val_loss=0.793, val_accuracy=0.801, lr=0.01] 76%|███████▋  | 104/136 [52:02<16:06, 30.22s/epoch, loss=0.551, accuracy=0.879, val_loss=0.757, val_accuracy=0.811, lr=0.01] 77%|███████▋  | 105/136 [52:32<15:33, 30.12s/epoch, loss=0.553, accuracy=0.882, val_loss=0.964, val_accuracy=0.749, lr=0.00316] 78%|███████▊  | 106/136 [53:00<14:50, 29.69s/epoch, loss=0.555, accuracy=0.882, val_loss=0.832, val_accuracy=0.79, lr=0.01]     79%|███████▊  | 107/136 [53:29<14:14, 29.45s/epoch, loss=0.551, accuracy=0.882, val_loss=0.884, val_accuracy=0.792, lr=0.01] 79%|███████▉  | 108/136 [53:58<13:38, 29.22s/epoch, loss=0.555, accuracy=0.883, val_loss=0.87, val_accuracy=0.8, lr=0.01]    80%|████████  | 109/136 [54:28<13:13, 29.37s/epoch, loss=0.549, accuracy=0.883, val_loss=0.918, val_accuracy=0.777, lr=0.01] 81%|████████  | 110/136 [54:57<12:39, 29.23s/epoch, loss=0.553, accuracy=0.882, val_loss=0.812, val_accuracy=0.811, lr=0.00316] 82%|████████▏ | 111/136 [55:25<12:07, 29.10s/epoch, loss=0.548, accuracy=0.884, val_loss=0.773, val_accuracy=0.806, lr=0.01]    82%|████████▏ | 112/136 [55:55<11:41, 29.23s/epoch, loss=0.547, accuracy=0.884, val_loss=0.81, val_accuracy=0.809, lr=0.01]  83%|████████▎ | 113/136 [56:25<11:16, 29.40s/epoch, loss=0.553, accuracy=0.883, val_loss=1.22, val_accuracy=0.707, lr=0.01] 84%|████████▍ | 114/136 [56:55<10:54, 29.73s/epoch, loss=0.547, accuracy=0.887, val_loss=0.755, val_accuracy=0.82, lr=0.01] 85%|████████▍ | 115/136 [57:25<10:25, 29.81s/epoch, loss=0.55, accuracy=0.885, val_loss=0.748, val_accuracy=0.825, lr=0.00316] 85%|████████▌ | 116/136 [57:54<09:49, 29.48s/epoch, loss=0.553, accuracy=0.886, val_loss=0.792, val_accuracy=0.814, lr=0.01]   86%|████████▌ | 117/136 [58:24<09:22, 29.58s/epoch, loss=0.553, accuracy=0.886, val_loss=0.914, val_accuracy=0.786, lr=0.01] 87%|████████▋ | 118/136 [58:54<08:54, 29.68s/epoch, loss=0.548, accuracy=0.887, val_loss=0.743, val_accuracy=0.83, lr=0.01]  88%|████████▊ | 119/136 [59:24<08:29, 29.97s/epoch, loss=0.546, accuracy=0.886, val_loss=1.91, val_accuracy=0.573, lr=0.01] 88%|████████▊ | 120/136 [59:55<08:01, 30.09s/epoch, loss=0.555, accuracy=0.884, val_loss=0.774, val_accuracy=0.815, lr=0.00316] 89%|████████▉ | 121/136 [1:00:24<07:30, 30.00s/epoch, loss=0.548, accuracy=0.888, val_loss=0.783, val_accuracy=0.809, lr=0.01]  90%|████████▉ | 122/136 [1:00:55<07:00, 30.04s/epoch, loss=0.469, accuracy=0.914, val_loss=0.537, val_accuracy=0.894, lr=0.001] 90%|█████████ | 123/136 [1:01:24<06:29, 29.96s/epoch, loss=0.42, accuracy=0.93, val_loss=0.515, val_accuracy=0.898, lr=0.001]   91%|█████████ | 124/136 [1:01:55<06:01, 30.17s/epoch, loss=0.398, accuracy=0.936, val_loss=0.504, val_accuracy=0.901, lr=0.001] 92%|█████████▏| 125/136 [1:02:24<05:29, 29.95s/epoch, loss=0.381, accuracy=0.94, val_loss=0.487, val_accuracy=0.905, lr=0.001]  93%|█████████▎| 126/136 [1:02:54<04:59, 29.96s/epoch, loss=0.367, accuracy=0.943, val_loss=0.479, val_accuracy=0.905, lr=0.001] 93%|█████████▎| 127/136 [1:03:24<04:27, 29.75s/epoch, loss=0.353, accuracy=0.945, val_loss=0.474, val_accuracy=0.906, lr=0.001] 94%|█████████▍| 128/136 [1:03:54<03:58, 29.77s/epoch, loss=0.344, accuracy=0.947, val_loss=0.474, val_accuracy=0.904, lr=0.001] 95%|█████████▍| 129/136 [1:04:22<03:24, 29.26s/epoch, loss=0.332, accuracy=0.949, val_loss=0.485, val_accuracy=0.9, lr=0.001]   96%|█████████▌| 130/136 [1:04:51<02:56, 29.35s/epoch, loss=0.324, accuracy=0.95, val_loss=0.466, val_accuracy=0.906, lr=0.001] 96%|█████████▋| 131/136 [1:05:21<02:27, 29.48s/epoch, loss=0.316, accuracy=0.951, val_loss=0.472, val_accuracy=0.904, lr=0.001] 97%|█████████▋| 132/136 [1:05:50<01:56, 29.24s/epoch, loss=0.307, accuracy=0.953, val_loss=0.464, val_accuracy=0.907, lr=0.001] 98%|█████████▊| 133/136 [1:06:20<01:28, 29.46s/epoch, loss=0.298, accuracy=0.954, val_loss=0.471, val_accuracy=0.902, lr=0.001] 99%|█████████▊| 134/136 [1:06:48<00:58, 29.22s/epoch, loss=0.292, accuracy=0.956, val_loss=0.471, val_accuracy=0.9, lr=0.001]   99%|█████████▉| 135/136 [1:07:18<00:29, 29.24s/epoch, loss=0.286, accuracy=0.956, val_loss=0.448, val_accuracy=0.908, lr=0.001]100%|██████████| 136/136 [1:07:47<00:00, 29.27s/epoch, loss=0.281, accuracy=0.955, val_loss=0.461, val_accuracy=0.901, lr=0.001]100%|██████████| 136/136 [1:07:47<00:00, 29.91s/epoch, loss=0.281, accuracy=0.955, val_loss=0.461, val_accuracy=0.901, lr=0.001]
Using real-time data augmentation.
Test loss: 0.4610683023929596
Test accuracy: 0.9014999866485596


* * * Run SGD for ID = 11_7. * * *


2024-02-15 18:34:26.739182: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 18:34:29.495926: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 18:34:29.497222: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-15 18:34:29.543547: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 18:34:29.543607: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 18:34:29.547303: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 18:34:29.547376: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 18:34:29.550129: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 18:34:29.550872: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 18:34:29.553805: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 18:34:29.555581: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 18:34:29.561560: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 18:34:29.562281: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 18:34:29.562732: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 18:34:30.818507: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-15 18:34:30.819059: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 18:34:30.819586: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 18:34:30.819632: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 18:34:30.819670: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 18:34:30.819683: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 18:34:30.819696: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 18:34:30.819708: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 18:34:30.819721: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 18:34:30.819733: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 18:34:30.819746: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 18:34:30.820264: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 18:34:30.820298: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 18:34:31.468588: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-15 18:34:31.468647: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-15 18:34:31.468658: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-15 18:34:31.469748: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:18:00.0, compute capability: 6.1)
{'id': 117, 'batch_size': 128, 'epochs': 136, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/136 [00:00<?, ?epoch/s]2024-02-15 18:34:32.284718: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-15 18:34:32.285417: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-02-15 18:34:34.304575: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 18:34:34.594852: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 18:34:35.719016: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-15 18:34:35.781358: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/136 [01:17<2:54:43, 77.65s/epoch, loss=3.17, accuracy=0.261, val_loss=2.49, val_accuracy=0.23, lr=0.1]  1%|▏         | 2/136 [01:44<1:46:56, 47.89s/epoch, loss=1.62, accuracy=0.491, val_loss=4.67, val_accuracy=0.153, lr=0.1]  2%|▏         | 3/136 [02:13<1:26:49, 39.17s/epoch, loss=1.39, accuracy=0.596, val_loss=2.53, val_accuracy=0.366, lr=0.1]  3%|▎         | 4/136 [02:41<1:16:45, 34.89s/epoch, loss=1.28, accuracy=0.662, val_loss=2.13, val_accuracy=0.447, lr=0.1]  4%|▎         | 5/136 [03:11<1:11:53, 32.93s/epoch, loss=1.25, accuracy=0.686, val_loss=1.67, val_accuracy=0.522, lr=0.1]  4%|▍         | 6/136 [03:40<1:08:55, 31.81s/epoch, loss=1.22, accuracy=0.703, val_loss=1.84, val_accuracy=0.536, lr=0.1]  5%|▌         | 7/136 [04:11<1:07:33, 31.42s/epoch, loss=1.21, accuracy=0.715, val_loss=1.76, val_accuracy=0.547, lr=0.1]  6%|▌         | 8/136 [04:41<1:05:52, 30.88s/epoch, loss=1.21, accuracy=0.72, val_loss=1.99, val_accuracy=0.516, lr=0.1]   7%|▋         | 9/136 [05:10<1:04:13, 30.34s/epoch, loss=1.2, accuracy=0.725, val_loss=2.67, val_accuracy=0.316, lr=0.1]  7%|▋         | 10/136 [05:40<1:03:22, 30.18s/epoch, loss=1.19, accuracy=0.731, val_loss=2.06, val_accuracy=0.473, lr=0.0316]  8%|▊         | 11/136 [06:08<1:01:37, 29.58s/epoch, loss=1.18, accuracy=0.733, val_loss=2.99, val_accuracy=0.245, lr=0.1]     9%|▉         | 12/136 [06:36<1:00:19, 29.19s/epoch, loss=1.17, accuracy=0.736, val_loss=1.93, val_accuracy=0.564, lr=0.1] 10%|▉         | 13/136 [07:06<59:53, 29.22s/epoch, loss=1.18, accuracy=0.734, val_loss=1.99, val_accuracy=0.465, lr=0.1]   10%|█         | 14/136 [07:35<59:51, 29.44s/epoch, loss=1.17, accuracy=0.738, val_loss=1.95, val_accuracy=0.531, lr=0.1] 11%|█         | 15/136 [08:05<59:09, 29.34s/epoch, loss=1.16, accuracy=0.742, val_loss=1.73, val_accuracy=0.532, lr=0.0316] 12%|█▏        | 16/136 [08:33<58:09, 29.08s/epoch, loss=1.16, accuracy=0.74, val_loss=2.36, val_accuracy=0.437, lr=0.1]     12%|█▎        | 17/136 [09:02<57:23, 28.94s/epoch, loss=1.15, accuracy=0.743, val_loss=2.15, val_accuracy=0.487, lr=0.1] 13%|█▎        | 18/136 [09:31<57:16, 29.12s/epoch, loss=1.15, accuracy=0.745, val_loss=1.73, val_accuracy=0.556, lr=0.1] 14%|█▍        | 19/136 [10:00<56:21, 28.90s/epoch, loss=1.16, accuracy=0.744, val_loss=2.33, val_accuracy=0.37, lr=0.1]  15%|█▍        | 20/136 [10:29<55:57, 28.94s/epoch, loss=1.15, accuracy=0.745, val_loss=1.82, val_accuracy=0.521, lr=0.0316] 15%|█▌        | 21/136 [10:57<55:09, 28.78s/epoch, loss=1.15, accuracy=0.748, val_loss=1.69, val_accuracy=0.567, lr=0.1]    16%|█▌        | 22/136 [11:26<54:50, 28.86s/epoch, loss=1.15, accuracy=0.747, val_loss=1.83, val_accuracy=0.534, lr=0.1] 17%|█▋        | 23/136 [11:55<54:17, 28.83s/epoch, loss=1.14, accuracy=0.752, val_loss=1.57, val_accuracy=0.59, lr=0.1]  18%|█▊        | 24/136 [12:25<54:29, 29.20s/epoch, loss=1.14, accuracy=0.748, val_loss=3.23, val_accuracy=0.348, lr=0.1] 18%|█▊        | 25/136 [12:54<53:49, 29.09s/epoch, loss=1.13, accuracy=0.749, val_loss=2.39, val_accuracy=0.495, lr=0.1] 19%|█▉        | 26/136 [13:23<53:35, 29.23s/epoch, loss=1.14, accuracy=0.752, val_loss=2.29, val_accuracy=0.463, lr=0.1] 20%|█▉        | 27/136 [13:53<53:21, 29.37s/epoch, loss=1.14, accuracy=0.748, val_loss=2.55, val_accuracy=0.449, lr=0.1] 21%|██        | 28/136 [14:23<52:57, 29.42s/epoch, loss=1.14, accuracy=0.75, val_loss=2.71, val_accuracy=0.345, lr=0.0316] 21%|██▏       | 29/136 [14:52<52:16, 29.31s/epoch, loss=1.14, accuracy=0.752, val_loss=1.48, val_accuracy=0.642, lr=0.1]   22%|██▏       | 30/136 [15:22<52:15, 29.58s/epoch, loss=1.13, accuracy=0.753, val_loss=1.99, val_accuracy=0.573, lr=0.1] 23%|██▎       | 31/136 [15:51<51:31, 29.44s/epoch, loss=1.13, accuracy=0.753, val_loss=1.89, val_accuracy=0.547, lr=0.1] 24%|██▎       | 32/136 [16:21<51:27, 29.69s/epoch, loss=1.13, accuracy=0.752, val_loss=1.91, val_accuracy=0.495, lr=0.1] 24%|██▍       | 33/136 [16:50<50:26, 29.38s/epoch, loss=1.13, accuracy=0.754, val_loss=2.04, val_accuracy=0.543, lr=0.1] 25%|██▌       | 34/136 [17:18<49:17, 28.99s/epoch, loss=1.12, accuracy=0.752, val_loss=1.58, val_accuracy=0.59, lr=0.0316] 26%|██▌       | 35/136 [17:47<48:45, 28.97s/epoch, loss=1.12, accuracy=0.752, val_loss=1.78, val_accuracy=0.564, lr=0.1]   26%|██▋       | 36/136 [18:16<48:08, 28.88s/epoch, loss=1.12, accuracy=0.756, val_loss=2.45, val_accuracy=0.463, lr=0.1] 27%|██▋       | 37/136 [18:44<47:19, 28.68s/epoch, loss=1.12, accuracy=0.754, val_loss=1.82, val_accuracy=0.507, lr=0.1] 28%|██▊       | 38/136 [19:12<46:48, 28.66s/epoch, loss=1.12, accuracy=0.755, val_loss=1.49, val_accuracy=0.646, lr=0.1] 29%|██▊       | 39/136 [19:40<45:37, 28.22s/epoch, loss=1.11, accuracy=0.756, val_loss=2.98, val_accuracy=0.356, lr=0.0316] 29%|██▉       | 40/136 [20:08<45:12, 28.25s/epoch, loss=1.12, accuracy=0.755, val_loss=1.56, val_accuracy=0.605, lr=0.1]    30%|███       | 41/136 [20:37<45:12, 28.55s/epoch, loss=1.11, accuracy=0.758, val_loss=2.02, val_accuracy=0.513, lr=0.1] 31%|███       | 42/136 [21:05<44:35, 28.46s/epoch, loss=1.11, accuracy=0.757, val_loss=1.94, val_accuracy=0.509, lr=0.1] 32%|███▏      | 43/136 [21:35<44:44, 28.86s/epoch, loss=1.11, accuracy=0.755, val_loss=1.9, val_accuracy=0.493, lr=0.1]  32%|███▏      | 44/136 [22:03<44:00, 28.70s/epoch, loss=1.12, accuracy=0.756, val_loss=1.41, val_accuracy=0.649, lr=0.1] 33%|███▎      | 45/136 [22:33<44:00, 29.02s/epoch, loss=1.11, accuracy=0.757, val_loss=2.06, val_accuracy=0.486, lr=0.1] 34%|███▍      | 46/136 [23:03<44:02, 29.36s/epoch, loss=1.11, accuracy=0.757, val_loss=2.79, val_accuracy=0.396, lr=0.1] 35%|███▍      | 47/136 [23:33<43:42, 29.47s/epoch, loss=1.11, accuracy=0.757, val_loss=1.47, val_accuracy=0.646, lr=0.1] 35%|███▌      | 48/136 [24:03<43:14, 29.48s/epoch, loss=1.1, accuracy=0.759, val_loss=2.39, val_accuracy=0.454, lr=0.1]  36%|███▌      | 49/136 [24:32<42:44, 29.47s/epoch, loss=1.11, accuracy=0.759, val_loss=1.74, val_accuracy=0.565, lr=0.0316] 37%|███▋      | 50/136 [25:02<42:23, 29.58s/epoch, loss=1.1, accuracy=0.758, val_loss=1.65, val_accuracy=0.587, lr=0.1]     38%|███▊      | 51/136 [25:32<42:05, 29.72s/epoch, loss=1.11, accuracy=0.758, val_loss=1.93, val_accuracy=0.528, lr=0.1] 38%|███▊      | 52/136 [25:59<40:41, 29.07s/epoch, loss=1.11, accuracy=0.758, val_loss=1.72, val_accuracy=0.573, lr=0.1] 39%|███▉      | 53/136 [26:30<40:40, 29.40s/epoch, loss=1.11, accuracy=0.759, val_loss=1.68, val_accuracy=0.606, lr=0.1] 40%|███▉      | 54/136 [27:00<40:32, 29.67s/epoch, loss=1.11, accuracy=0.758, val_loss=3.14, val_accuracy=0.301, lr=0.0316] 40%|████      | 55/136 [27:30<40:16, 29.83s/epoch, loss=1.1, accuracy=0.758, val_loss=1.77, val_accuracy=0.523, lr=0.1]     41%|████      | 56/136 [27:59<39:22, 29.53s/epoch, loss=1.11, accuracy=0.757, val_loss=1.97, val_accuracy=0.473, lr=0.1] 42%|████▏     | 57/136 [28:28<38:31, 29.26s/epoch, loss=1.11, accuracy=0.758, val_loss=1.95, val_accuracy=0.524, lr=0.1] 43%|████▎     | 58/136 [28:56<37:44, 29.03s/epoch, loss=1.11, accuracy=0.758, val_loss=2.45, val_accuracy=0.481, lr=0.1] 43%|████▎     | 59/136 [29:25<37:19, 29.08s/epoch, loss=1.11, accuracy=0.755, val_loss=2.02, val_accuracy=0.55, lr=0.0316] 44%|████▍     | 60/136 [29:55<37:05, 29.28s/epoch, loss=1.1, accuracy=0.759, val_loss=4.09, val_accuracy=0.298, lr=0.1]    45%|████▍     | 61/136 [30:25<36:51, 29.49s/epoch, loss=1.12, accuracy=0.755, val_loss=1.62, val_accuracy=0.568, lr=0.1] 46%|████▌     | 62/136 [30:52<35:36, 28.87s/epoch, loss=1.11, accuracy=0.754, val_loss=2.14, val_accuracy=0.498, lr=0.1] 46%|████▋     | 63/136 [31:22<35:31, 29.20s/epoch, loss=1.1, accuracy=0.757, val_loss=1.78, val_accuracy=0.591, lr=0.1]  47%|████▋     | 64/136 [31:53<35:27, 29.55s/epoch, loss=1.1, accuracy=0.759, val_loss=2.71, val_accuracy=0.461, lr=0.0316] 48%|████▊     | 65/136 [32:22<35:00, 29.58s/epoch, loss=1.1, accuracy=0.757, val_loss=1.64, val_accuracy=0.585, lr=0.1]    49%|████▊     | 66/136 [32:52<34:29, 29.57s/epoch, loss=1.11, accuracy=0.757, val_loss=2.62, val_accuracy=0.464, lr=0.1] 49%|████▉     | 67/136 [33:22<33:59, 29.56s/epoch, loss=1.11, accuracy=0.756, val_loss=2.12, val_accuracy=0.496, lr=0.1] 50%|█████     | 68/136 [33:51<33:26, 29.51s/epoch, loss=1.1, accuracy=0.76, val_loss=2.85, val_accuracy=0.352, lr=0.1]   51%|█████     | 69/136 [34:19<32:36, 29.20s/epoch, loss=1.11, accuracy=0.756, val_loss=4.54, val_accuracy=0.341, lr=0.0316] 51%|█████▏    | 70/136 [34:48<31:59, 29.09s/epoch, loss=1.1, accuracy=0.759, val_loss=2.15, val_accuracy=0.49, lr=0.1]      52%|█████▏    | 71/136 [35:16<31:10, 28.78s/epoch, loss=1.1, accuracy=0.758, val_loss=1.86, val_accuracy=0.573, lr=0.1] 53%|█████▎    | 72/136 [35:45<30:41, 28.77s/epoch, loss=1.1, accuracy=0.757, val_loss=1.47, val_accuracy=0.623, lr=0.1] 54%|█████▎    | 73/136 [36:15<30:43, 29.27s/epoch, loss=1.1, accuracy=0.76, val_loss=1.79, val_accuracy=0.545, lr=0.1]  54%|█████▍    | 74/136 [36:44<30:03, 29.09s/epoch, loss=1.1, accuracy=0.758, val_loss=2.3, val_accuracy=0.489, lr=0.0316] 55%|█████▌    | 75/136 [37:13<29:27, 28.98s/epoch, loss=1.1, accuracy=0.758, val_loss=1.87, val_accuracy=0.507, lr=0.1]   56%|█████▌    | 76/136 [37:42<29:08, 29.14s/epoch, loss=1.1, accuracy=0.757, val_loss=3.26, val_accuracy=0.312, lr=0.1] 57%|█████▋    | 77/136 [38:11<28:30, 28.99s/epoch, loss=1.1, accuracy=0.759, val_loss=1.95, val_accuracy=0.529, lr=0.1] 57%|█████▋    | 78/136 [38:41<28:23, 29.36s/epoch, loss=1.1, accuracy=0.759, val_loss=1.82, val_accuracy=0.512, lr=0.1] 58%|█████▊    | 79/136 [39:11<28:08, 29.62s/epoch, loss=1.1, accuracy=0.757, val_loss=2.28, val_accuracy=0.352, lr=0.0316] 59%|█████▉    | 80/136 [39:42<27:47, 29.78s/epoch, loss=1.1, accuracy=0.759, val_loss=2.27, val_accuracy=0.456, lr=0.1]    60%|█████▉    | 81/136 [40:10<26:52, 29.32s/epoch, loss=1.1, accuracy=0.759, val_loss=3.63, val_accuracy=0.374, lr=0.1] 60%|██████    | 82/136 [40:37<25:54, 28.79s/epoch, loss=0.896, accuracy=0.815, val_loss=0.941, val_accuracy=0.786, lr=0.01] 61%|██████    | 83/136 [41:06<25:16, 28.62s/epoch, loss=0.72, accuracy=0.848, val_loss=0.848, val_accuracy=0.795, lr=0.01]  62%|██████▏   | 84/136 [41:34<24:48, 28.62s/epoch, loss=0.642, accuracy=0.855, val_loss=0.717, val_accuracy=0.823, lr=0.01] 62%|██████▎   | 85/136 [42:03<24:19, 28.62s/epoch, loss=0.606, accuracy=0.857, val_loss=0.751, val_accuracy=0.809, lr=0.01] 63%|██████▎   | 86/136 [42:32<24:05, 28.91s/epoch, loss=0.575, accuracy=0.861, val_loss=0.948, val_accuracy=0.751, lr=0.01] 64%|██████▍   | 87/136 [43:01<23:34, 28.86s/epoch, loss=0.57, accuracy=0.862, val_loss=0.717, val_accuracy=0.808, lr=0.01]  65%|██████▍   | 88/136 [43:30<23:03, 28.82s/epoch, loss=0.567, accuracy=0.862, val_loss=0.877, val_accuracy=0.756, lr=0.01] 65%|██████▌   | 89/136 [44:00<22:50, 29.17s/epoch, loss=0.559, accuracy=0.866, val_loss=0.703, val_accuracy=0.815, lr=0.01] 66%|██████▌   | 90/136 [44:29<22:18, 29.10s/epoch, loss=0.555, accuracy=0.866, val_loss=0.919, val_accuracy=0.761, lr=0.01] 67%|██████▋   | 91/136 [44:58<21:54, 29.21s/epoch, loss=0.559, accuracy=0.866, val_loss=0.961, val_accuracy=0.756, lr=0.01] 68%|██████▊   | 92/136 [45:28<21:31, 29.36s/epoch, loss=0.555, accuracy=0.867, val_loss=0.72, val_accuracy=0.81, lr=0.01]   68%|██████▊   | 93/136 [45:57<20:58, 29.27s/epoch, loss=0.552, accuracy=0.87, val_loss=1.24, val_accuracy=0.678, lr=0.01] 69%|██████▉   | 94/136 [46:27<20:36, 29.45s/epoch, loss=0.554, accuracy=0.87, val_loss=1.08, val_accuracy=0.722, lr=0.00316] 70%|██████▉   | 95/136 [46:55<19:53, 29.11s/epoch, loss=0.551, accuracy=0.87, val_loss=0.76, val_accuracy=0.812, lr=0.01]    71%|███████   | 96/136 [47:24<19:22, 29.06s/epoch, loss=0.549, accuracy=0.872, val_loss=0.742, val_accuracy=0.811, lr=0.01] 71%|███████▏  | 97/136 [47:54<19:06, 29.40s/epoch, loss=0.553, accuracy=0.871, val_loss=0.763, val_accuracy=0.813, lr=0.01] 72%|███████▏  | 98/136 [48:22<18:13, 28.77s/epoch, loss=0.548, accuracy=0.874, val_loss=0.747, val_accuracy=0.817, lr=0.01] 73%|███████▎  | 99/136 [48:51<17:51, 28.97s/epoch, loss=0.55, accuracy=0.875, val_loss=0.796, val_accuracy=0.797, lr=0.00316] 74%|███████▎  | 100/136 [49:22<17:39, 29.44s/epoch, loss=0.551, accuracy=0.876, val_loss=0.773, val_accuracy=0.798, lr=0.01]  74%|███████▍  | 101/136 [49:51<17:08, 29.39s/epoch, loss=0.548, accuracy=0.877, val_loss=1.18, val_accuracy=0.696, lr=0.01]  75%|███████▌  | 102/136 [50:19<16:28, 29.07s/epoch, loss=0.551, accuracy=0.876, val_loss=0.706, val_accuracy=0.828, lr=0.01] 76%|███████▌  | 103/136 [50:48<15:53, 28.89s/epoch, loss=0.548, accuracy=0.877, val_loss=0.777, val_accuracy=0.807, lr=0.01] 76%|███████▋  | 104/136 [51:18<15:37, 29.29s/epoch, loss=0.551, accuracy=0.877, val_loss=0.775, val_accuracy=0.815, lr=0.00316] 77%|███████▋  | 105/136 [51:48<15:16, 29.55s/epoch, loss=0.546, accuracy=0.88, val_loss=1.43, val_accuracy=0.663, lr=0.01]      78%|███████▊  | 106/136 [52:19<14:54, 29.81s/epoch, loss=0.548, accuracy=0.879, val_loss=0.896, val_accuracy=0.773, lr=0.01] 79%|███████▊  | 107/136 [52:47<14:10, 29.32s/epoch, loss=0.548, accuracy=0.88, val_loss=0.688, val_accuracy=0.838, lr=0.01]  79%|███████▉  | 108/136 [53:17<13:49, 29.64s/epoch, loss=0.55, accuracy=0.878, val_loss=1.04, val_accuracy=0.746, lr=0.01]  80%|████████  | 109/136 [53:47<13:21, 29.67s/epoch, loss=0.547, accuracy=0.883, val_loss=0.833, val_accuracy=0.788, lr=0.01] 81%|████████  | 110/136 [54:17<12:51, 29.68s/epoch, loss=0.546, accuracy=0.882, val_loss=0.987, val_accuracy=0.743, lr=0.01] 82%|████████▏ | 111/136 [54:46<12:17, 29.49s/epoch, loss=0.543, accuracy=0.881, val_loss=0.757, val_accuracy=0.816, lr=0.01] 82%|████████▏ | 112/136 [55:15<11:44, 29.37s/epoch, loss=0.552, accuracy=0.88, val_loss=1.04, val_accuracy=0.734, lr=0.00316] 83%|████████▎ | 113/136 [55:42<11:02, 28.79s/epoch, loss=0.546, accuracy=0.882, val_loss=0.781, val_accuracy=0.812, lr=0.01]  84%|████████▍ | 114/136 [56:10<10:26, 28.47s/epoch, loss=0.544, accuracy=0.883, val_loss=0.852, val_accuracy=0.78, lr=0.01]  85%|████████▍ | 115/136 [56:40<10:10, 29.05s/epoch, loss=0.547, accuracy=0.882, val_loss=0.969, val_accuracy=0.777, lr=0.01] 85%|████████▌ | 116/136 [57:10<09:43, 29.18s/epoch, loss=0.546, accuracy=0.882, val_loss=1.02, val_accuracy=0.729, lr=0.01]  86%|████████▌ | 117/136 [57:39<09:17, 29.33s/epoch, loss=0.545, accuracy=0.883, val_loss=0.918, val_accuracy=0.776, lr=0.00316] 87%|████████▋ | 118/136 [58:09<08:47, 29.28s/epoch, loss=0.546, accuracy=0.884, val_loss=0.868, val_accuracy=0.79, lr=0.01]     88%|████████▊ | 119/136 [58:38<08:18, 29.30s/epoch, loss=0.548, accuracy=0.882, val_loss=1.06, val_accuracy=0.737, lr=0.01] 88%|████████▊ | 120/136 [59:08<07:52, 29.53s/epoch, loss=0.548, accuracy=0.885, val_loss=0.748, val_accuracy=0.825, lr=0.01] 89%|████████▉ | 121/136 [59:36<07:17, 29.13s/epoch, loss=0.55, accuracy=0.882, val_loss=0.889, val_accuracy=0.779, lr=0.01]  90%|████████▉ | 122/136 [1:00:06<06:48, 29.19s/epoch, loss=0.474, accuracy=0.909, val_loss=0.529, val_accuracy=0.89, lr=0.001] 90%|█████████ | 123/136 [1:00:34<06:15, 28.92s/epoch, loss=0.422, accuracy=0.927, val_loss=0.518, val_accuracy=0.894, lr=0.001] 91%|█████████ | 124/136 [1:01:03<05:49, 29.12s/epoch, loss=0.399, accuracy=0.933, val_loss=0.501, val_accuracy=0.898, lr=0.001] 92%|█████████▏| 125/136 [1:01:33<05:21, 29.25s/epoch, loss=0.382, accuracy=0.937, val_loss=0.497, val_accuracy=0.899, lr=0.001] 93%|█████████▎| 126/136 [1:02:03<04:54, 29.40s/epoch, loss=0.368, accuracy=0.94, val_loss=0.49, val_accuracy=0.899, lr=0.001]   93%|█████████▎| 127/136 [1:02:31<04:20, 28.92s/epoch, loss=0.355, accuracy=0.942, val_loss=0.484, val_accuracy=0.899, lr=0.001] 94%|█████████▍| 128/136 [1:03:00<03:53, 29.21s/epoch, loss=0.345, accuracy=0.943, val_loss=0.477, val_accuracy=0.901, lr=0.001] 95%|█████████▍| 129/136 [1:03:28<03:21, 28.72s/epoch, loss=0.335, accuracy=0.945, val_loss=0.468, val_accuracy=0.9, lr=0.001]   96%|█████████▌| 130/136 [1:03:58<02:53, 28.96s/epoch, loss=0.325, accuracy=0.948, val_loss=0.469, val_accuracy=0.9, lr=0.001] 96%|█████████▋| 131/136 [1:04:28<02:26, 29.33s/epoch, loss=0.318, accuracy=0.948, val_loss=0.477, val_accuracy=0.899, lr=0.001] 97%|█████████▋| 132/136 [1:04:58<01:57, 29.49s/epoch, loss=0.31, accuracy=0.95, val_loss=0.458, val_accuracy=0.904, lr=0.001]   98%|█████████▊| 133/136 [1:05:27<01:28, 29.39s/epoch, loss=0.302, accuracy=0.951, val_loss=0.456, val_accuracy=0.903, lr=0.001] 99%|█████████▊| 134/136 [1:05:55<00:58, 29.05s/epoch, loss=0.295, accuracy=0.951, val_loss=0.458, val_accuracy=0.902, lr=0.001] 99%|█████████▉| 135/136 [1:06:23<00:28, 28.64s/epoch, loss=0.287, accuracy=0.953, val_loss=0.464, val_accuracy=0.897, lr=0.001]100%|██████████| 136/136 [1:06:53<00:00, 29.09s/epoch, loss=0.283, accuracy=0.954, val_loss=0.462, val_accuracy=0.901, lr=0.001]100%|██████████| 136/136 [1:06:53<00:00, 29.51s/epoch, loss=0.283, accuracy=0.954, val_loss=0.462, val_accuracy=0.901, lr=0.001]
Using real-time data augmentation.
Test loss: 0.46226266026496887
Test accuracy: 0.9009000062942505


* * * Run SGD for ID = 11_8. * * *


2024-02-15 19:41:28.271426: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 19:41:31.100661: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 19:41:31.102038: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-15 19:41:31.144751: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 19:41:31.144798: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 19:41:31.148596: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 19:41:31.148670: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 19:41:31.151480: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 19:41:31.152300: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 19:41:31.155237: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 19:41:31.157179: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 19:41:31.163138: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 19:41:31.163856: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 19:41:31.163942: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 19:41:32.498131: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-15 19:41:32.498860: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 19:41:32.499398: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 19:41:32.499432: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 19:41:32.499470: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 19:41:32.499485: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 19:41:32.499499: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 19:41:32.499514: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 19:41:32.499528: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 19:41:32.499543: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 19:41:32.499569: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 19:41:32.500136: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 19:41:32.500176: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 19:41:33.209782: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-15 19:41:33.209848: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-15 19:41:33.209860: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-15 19:41:33.211685: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:18:00.0, compute capability: 6.1)
{'id': 118, 'batch_size': 128, 'epochs': 136, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/136 [00:00<?, ?epoch/s]2024-02-15 19:41:34.054243: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-15 19:41:34.066739: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-02-15 19:41:36.183510: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 19:41:36.556875: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 19:41:37.715973: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-15 19:41:37.787973: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/136 [01:08<2:33:01, 68.01s/epoch, loss=3.24, accuracy=0.281, val_loss=2.14, val_accuracy=0.3, lr=0.1]  1%|▏         | 2/136 [01:38<1:42:05, 45.71s/epoch, loss=1.67, accuracy=0.474, val_loss=1.66, val_accuracy=0.483, lr=0.1]  2%|▏         | 3/136 [02:07<1:24:20, 38.05s/epoch, loss=1.44, accuracy=0.58, val_loss=2.06, val_accuracy=0.4, lr=0.1]     3%|▎         | 4/136 [02:36<1:15:59, 34.54s/epoch, loss=1.32, accuracy=0.656, val_loss=3.6, val_accuracy=0.213, lr=0.1]  4%|▎         | 5/136 [03:06<1:12:10, 33.06s/epoch, loss=1.26, accuracy=0.686, val_loss=3.25, val_accuracy=0.305, lr=0.1]  4%|▍         | 6/136 [03:36<1:09:19, 31.99s/epoch, loss=1.25, accuracy=0.702, val_loss=2.68, val_accuracy=0.4, lr=0.1]    5%|▌         | 7/136 [04:06<1:07:40, 31.48s/epoch, loss=1.24, accuracy=0.711, val_loss=5.6, val_accuracy=0.234, lr=0.0316]  6%|▌         | 8/136 [04:37<1:06:45, 31.29s/epoch, loss=1.23, accuracy=0.718, val_loss=1.77, val_accuracy=0.529, lr=0.1]    7%|▋         | 9/136 [05:07<1:05:08, 30.78s/epoch, loss=1.21, accuracy=0.724, val_loss=2.31, val_accuracy=0.497, lr=0.1]  7%|▋         | 10/136 [05:37<1:03:54, 30.43s/epoch, loss=1.2, accuracy=0.728, val_loss=1.68, val_accuracy=0.557, lr=0.1]  8%|▊         | 11/136 [06:05<1:02:14, 29.88s/epoch, loss=1.2, accuracy=0.73, val_loss=1.81, val_accuracy=0.588, lr=0.1]   9%|▉         | 12/136 [06:35<1:01:41, 29.85s/epoch, loss=1.2, accuracy=0.73, val_loss=1.94, val_accuracy=0.489, lr=0.0316] 10%|▉         | 13/136 [07:03<1:00:14, 29.38s/epoch, loss=1.18, accuracy=0.737, val_loss=2.85, val_accuracy=0.401, lr=0.1]  10%|█         | 14/136 [07:33<1:00:03, 29.54s/epoch, loss=1.19, accuracy=0.738, val_loss=2.2, val_accuracy=0.33, lr=0.1]   11%|█         | 15/136 [08:03<59:36, 29.56s/epoch, loss=1.18, accuracy=0.74, val_loss=2.5, val_accuracy=0.397, lr=0.1]   12%|█▏        | 16/136 [08:33<59:22, 29.69s/epoch, loss=1.19, accuracy=0.741, val_loss=2.03, val_accuracy=0.484, lr=0.1] 12%|█▎        | 17/136 [08:59<56:33, 28.52s/epoch, loss=1.19, accuracy=0.742, val_loss=1.8, val_accuracy=0.527, lr=0.0316] 13%|█▎        | 18/136 [09:26<55:22, 28.16s/epoch, loss=1.17, accuracy=0.744, val_loss=1.93, val_accuracy=0.518, lr=0.1]   14%|█▍        | 19/136 [09:53<54:12, 27.80s/epoch, loss=1.17, accuracy=0.744, val_loss=1.97, val_accuracy=0.451, lr=0.1] 15%|█▍        | 20/136 [10:23<54:48, 28.35s/epoch, loss=1.17, accuracy=0.747, val_loss=2.91, val_accuracy=0.327, lr=0.1] 15%|█▌        | 21/136 [10:51<54:07, 28.24s/epoch, loss=1.17, accuracy=0.745, val_loss=1.77, val_accuracy=0.513, lr=0.1] 16%|█▌        | 22/136 [11:18<53:17, 28.05s/epoch, loss=1.17, accuracy=0.747, val_loss=1.79, val_accuracy=0.54, lr=0.0316] 17%|█▋        | 23/136 [11:48<53:34, 28.45s/epoch, loss=1.17, accuracy=0.746, val_loss=3.26, val_accuracy=0.245, lr=0.1]   18%|█▊        | 24/136 [12:18<54:12, 29.04s/epoch, loss=1.16, accuracy=0.749, val_loss=2.26, val_accuracy=0.526, lr=0.1] 18%|█▊        | 25/136 [12:48<54:13, 29.31s/epoch, loss=1.16, accuracy=0.748, val_loss=1.64, val_accuracy=0.589, lr=0.1] 19%|█▉        | 26/136 [13:17<53:34, 29.22s/epoch, loss=1.16, accuracy=0.745, val_loss=2.24, val_accuracy=0.479, lr=0.1] 20%|█▉        | 27/136 [13:47<53:22, 29.38s/epoch, loss=1.15, accuracy=0.748, val_loss=2.65, val_accuracy=0.32, lr=0.1]  21%|██        | 28/136 [14:16<52:59, 29.44s/epoch, loss=1.16, accuracy=0.75, val_loss=3.43, val_accuracy=0.318, lr=0.1] 21%|██▏       | 29/136 [14:45<52:11, 29.26s/epoch, loss=1.15, accuracy=0.751, val_loss=5.03, val_accuracy=0.27, lr=0.1] 22%|██▏       | 30/136 [15:15<52:00, 29.43s/epoch, loss=1.15, accuracy=0.753, val_loss=2.74, val_accuracy=0.362, lr=0.0316] 23%|██▎       | 31/136 [15:43<50:52, 29.07s/epoch, loss=1.15, accuracy=0.75, val_loss=2.88, val_accuracy=0.461, lr=0.1]     24%|██▎       | 32/136 [16:14<51:03, 29.46s/epoch, loss=1.15, accuracy=0.751, val_loss=1.62, val_accuracy=0.565, lr=0.1] 24%|██▍       | 33/136 [16:43<50:43, 29.55s/epoch, loss=1.15, accuracy=0.751, val_loss=2.08, val_accuracy=0.562, lr=0.1] 25%|██▌       | 34/136 [17:14<50:43, 29.83s/epoch, loss=1.14, accuracy=0.754, val_loss=1.85, val_accuracy=0.551, lr=0.1] 26%|██▌       | 35/136 [17:43<50:06, 29.77s/epoch, loss=1.14, accuracy=0.751, val_loss=2.69, val_accuracy=0.256, lr=0.1] 26%|██▋       | 36/136 [18:12<49:01, 29.42s/epoch, loss=1.14, accuracy=0.751, val_loss=1.85, val_accuracy=0.564, lr=0.1] 27%|██▋       | 37/136 [18:41<48:24, 29.34s/epoch, loss=1.13, accuracy=0.755, val_loss=1.7, val_accuracy=0.569, lr=0.0316] 28%|██▊       | 38/136 [19:11<48:15, 29.55s/epoch, loss=1.15, accuracy=0.752, val_loss=3, val_accuracy=0.361, lr=0.1]      29%|██▊       | 39/136 [19:40<47:32, 29.41s/epoch, loss=1.14, accuracy=0.754, val_loss=2.74, val_accuracy=0.398, lr=0.1] 29%|██▉       | 40/136 [20:10<47:01, 29.39s/epoch, loss=1.14, accuracy=0.754, val_loss=2.33, val_accuracy=0.416, lr=0.1] 30%|███       | 41/136 [20:39<46:32, 29.40s/epoch, loss=1.14, accuracy=0.751, val_loss=1.43, val_accuracy=0.64, lr=0.1]  31%|███       | 42/136 [21:09<46:30, 29.68s/epoch, loss=1.14, accuracy=0.753, val_loss=2.11, val_accuracy=0.423, lr=0.1] 32%|███▏      | 43/136 [21:39<45:46, 29.53s/epoch, loss=1.14, accuracy=0.753, val_loss=1.5, val_accuracy=0.623, lr=0.1]  32%|███▏      | 44/136 [22:06<44:30, 29.02s/epoch, loss=1.14, accuracy=0.753, val_loss=2.26, val_accuracy=0.422, lr=0.1] 33%|███▎      | 45/136 [22:36<44:24, 29.28s/epoch, loss=1.13, accuracy=0.753, val_loss=2.7, val_accuracy=0.389, lr=0.1]  34%|███▍      | 46/136 [23:05<43:47, 29.19s/epoch, loss=1.13, accuracy=0.754, val_loss=1.69, val_accuracy=0.555, lr=0.0316] 35%|███▍      | 47/136 [23:34<43:08, 29.09s/epoch, loss=1.13, accuracy=0.754, val_loss=2.67, val_accuracy=0.433, lr=0.1]    35%|███▌      | 48/136 [24:03<42:26, 28.93s/epoch, loss=1.13, accuracy=0.754, val_loss=1.77, val_accuracy=0.552, lr=0.1] 36%|███▌      | 49/136 [24:33<42:25, 29.26s/epoch, loss=1.13, accuracy=0.757, val_loss=2.95, val_accuracy=0.292, lr=0.1] 37%|███▋      | 50/136 [25:03<42:15, 29.48s/epoch, loss=1.14, accuracy=0.755, val_loss=3.77, val_accuracy=0.385, lr=0.1] 38%|███▊      | 51/136 [25:32<41:49, 29.53s/epoch, loss=1.14, accuracy=0.755, val_loss=2.09, val_accuracy=0.435, lr=0.0316] 38%|███▊      | 52/136 [26:03<41:39, 29.75s/epoch, loss=1.13, accuracy=0.758, val_loss=2.3, val_accuracy=0.448, lr=0.1]     39%|███▉      | 53/136 [26:32<40:49, 29.51s/epoch, loss=1.14, accuracy=0.754, val_loss=2.22, val_accuracy=0.493, lr=0.1] 40%|███▉      | 54/136 [27:00<39:46, 29.11s/epoch, loss=1.13, accuracy=0.756, val_loss=2.6, val_accuracy=0.474, lr=0.1]  40%|████      | 55/136 [27:29<39:18, 29.11s/epoch, loss=1.13, accuracy=0.754, val_loss=2.18, val_accuracy=0.434, lr=0.1] 41%|████      | 56/136 [27:59<39:05, 29.32s/epoch, loss=1.13, accuracy=0.756, val_loss=1.69, val_accuracy=0.612, lr=0.0316] 42%|████▏     | 57/136 [28:29<38:54, 29.55s/epoch, loss=1.13, accuracy=0.755, val_loss=2, val_accuracy=0.45, lr=0.1]        43%|████▎     | 58/136 [28:59<38:35, 29.69s/epoch, loss=1.13, accuracy=0.754, val_loss=2.19, val_accuracy=0.473, lr=0.1] 43%|████▎     | 59/136 [29:27<37:35, 29.29s/epoch, loss=1.13, accuracy=0.754, val_loss=3.86, val_accuracy=0.298, lr=0.1] 44%|████▍     | 60/136 [29:56<37:04, 29.26s/epoch, loss=1.12, accuracy=0.755, val_loss=1.62, val_accuracy=0.616, lr=0.1] 45%|████▍     | 61/136 [30:25<36:28, 29.17s/epoch, loss=1.13, accuracy=0.757, val_loss=1.9, val_accuracy=0.535, lr=0.0316] 46%|████▌     | 62/136 [30:54<35:40, 28.92s/epoch, loss=1.13, accuracy=0.754, val_loss=1.83, val_accuracy=0.565, lr=0.1]   46%|████▋     | 63/136 [31:22<35:07, 28.87s/epoch, loss=1.13, accuracy=0.756, val_loss=1.7, val_accuracy=0.563, lr=0.1]  47%|████▋     | 64/136 [31:51<34:29, 28.75s/epoch, loss=1.13, accuracy=0.756, val_loss=1.94, val_accuracy=0.493, lr=0.1] 48%|████▊     | 65/136 [32:21<34:29, 29.15s/epoch, loss=1.12, accuracy=0.756, val_loss=2.02, val_accuracy=0.457, lr=0.1] 49%|████▊     | 66/136 [32:49<33:37, 28.82s/epoch, loss=1.12, accuracy=0.755, val_loss=1.65, val_accuracy=0.603, lr=0.0316] 49%|████▉     | 67/136 [33:17<32:52, 28.59s/epoch, loss=1.13, accuracy=0.757, val_loss=3.36, val_accuracy=0.354, lr=0.1]    50%|█████     | 68/136 [33:46<32:39, 28.81s/epoch, loss=1.12, accuracy=0.756, val_loss=3.27, val_accuracy=0.26, lr=0.1]  51%|█████     | 69/136 [34:16<32:17, 28.92s/epoch, loss=1.12, accuracy=0.757, val_loss=3.66, val_accuracy=0.228, lr=0.1] 51%|█████▏    | 70/136 [34:44<31:46, 28.88s/epoch, loss=1.12, accuracy=0.758, val_loss=3.03, val_accuracy=0.225, lr=0.1] 52%|█████▏    | 71/136 [35:13<31:20, 28.93s/epoch, loss=1.12, accuracy=0.755, val_loss=2.06, val_accuracy=0.479, lr=0.0316] 53%|█████▎    | 72/136 [35:44<31:28, 29.51s/epoch, loss=1.12, accuracy=0.759, val_loss=1.77, val_accuracy=0.576, lr=0.1]    54%|█████▎    | 73/136 [36:15<31:14, 29.76s/epoch, loss=1.12, accuracy=0.757, val_loss=1.75, val_accuracy=0.539, lr=0.1] 54%|█████▍    | 74/136 [36:44<30:41, 29.70s/epoch, loss=1.12, accuracy=0.757, val_loss=2.53, val_accuracy=0.408, lr=0.1] 55%|█████▌    | 75/136 [37:13<29:56, 29.45s/epoch, loss=1.12, accuracy=0.756, val_loss=2.03, val_accuracy=0.569, lr=0.1] 56%|█████▌    | 76/136 [37:43<29:27, 29.46s/epoch, loss=1.12, accuracy=0.759, val_loss=2.95, val_accuracy=0.414, lr=0.0316] 57%|█████▋    | 77/136 [38:10<28:25, 28.90s/epoch, loss=1.12, accuracy=0.757, val_loss=1.72, val_accuracy=0.585, lr=0.1]    57%|█████▋    | 78/136 [38:40<28:20, 29.32s/epoch, loss=1.11, accuracy=0.761, val_loss=1.55, val_accuracy=0.606, lr=0.1] 58%|█████▊    | 79/136 [39:10<27:59, 29.46s/epoch, loss=1.11, accuracy=0.762, val_loss=1.68, val_accuracy=0.577, lr=0.1] 59%|█████▉    | 80/136 [39:39<27:11, 29.13s/epoch, loss=1.12, accuracy=0.757, val_loss=2.75, val_accuracy=0.399, lr=0.1] 60%|█████▉    | 81/136 [40:09<27:03, 29.52s/epoch, loss=1.12, accuracy=0.759, val_loss=3.72, val_accuracy=0.17, lr=0.0316] 60%|██████    | 82/136 [40:39<26:43, 29.69s/epoch, loss=0.91, accuracy=0.815, val_loss=0.909, val_accuracy=0.799, lr=0.01] 61%|██████    | 83/136 [41:09<26:17, 29.77s/epoch, loss=0.734, accuracy=0.847, val_loss=0.792, val_accuracy=0.813, lr=0.01] 62%|██████▏   | 84/136 [41:38<25:32, 29.47s/epoch, loss=0.647, accuracy=0.859, val_loss=0.792, val_accuracy=0.801, lr=0.01] 62%|██████▎   | 85/136 [42:07<24:58, 29.38s/epoch, loss=0.606, accuracy=0.859, val_loss=0.919, val_accuracy=0.763, lr=0.01] 63%|██████▎   | 86/136 [42:37<24:40, 29.61s/epoch, loss=0.586, accuracy=0.861, val_loss=0.807, val_accuracy=0.784, lr=0.01] 64%|██████▍   | 87/136 [43:07<24:10, 29.61s/epoch, loss=0.578, accuracy=0.86, val_loss=0.917, val_accuracy=0.752, lr=0.01]  65%|██████▍   | 88/136 [43:34<23:14, 29.05s/epoch, loss=0.566, accuracy=0.864, val_loss=0.78, val_accuracy=0.798, lr=0.01] 65%|██████▌   | 89/136 [44:05<22:59, 29.36s/epoch, loss=0.566, accuracy=0.864, val_loss=0.878, val_accuracy=0.769, lr=0.01] 66%|██████▌   | 90/136 [44:34<22:29, 29.34s/epoch, loss=0.568, accuracy=0.866, val_loss=1.02, val_accuracy=0.723, lr=0.01]  67%|██████▋   | 91/136 [45:04<22:04, 29.44s/epoch, loss=0.561, accuracy=0.868, val_loss=0.799, val_accuracy=0.797, lr=0.01] 68%|██████▊   | 92/136 [45:32<21:25, 29.21s/epoch, loss=0.56, accuracy=0.869, val_loss=0.91, val_accuracy=0.76, lr=0.01]    68%|██████▊   | 93/136 [46:00<20:33, 28.68s/epoch, loss=0.56, accuracy=0.87, val_loss=1.18, val_accuracy=0.705, lr=0.00316] 69%|██████▉   | 94/136 [46:28<20:03, 28.65s/epoch, loss=0.554, accuracy=0.872, val_loss=0.832, val_accuracy=0.785, lr=0.01] 70%|██████▉   | 95/136 [46:56<19:26, 28.45s/epoch, loss=0.555, accuracy=0.874, val_loss=0.767, val_accuracy=0.807, lr=0.01] 71%|███████   | 96/136 [47:26<19:15, 28.88s/epoch, loss=0.555, accuracy=0.875, val_loss=0.873, val_accuracy=0.773, lr=0.01] 71%|███████▏  | 97/136 [47:56<18:53, 29.07s/epoch, loss=0.557, accuracy=0.874, val_loss=0.893, val_accuracy=0.774, lr=0.01] 72%|███████▏  | 98/136 [48:26<18:38, 29.44s/epoch, loss=0.555, accuracy=0.877, val_loss=0.832, val_accuracy=0.785, lr=0.01] 73%|███████▎  | 99/136 [48:56<18:16, 29.63s/epoch, loss=0.556, accuracy=0.876, val_loss=0.81, val_accuracy=0.793, lr=0.01]  74%|███████▎  | 100/136 [49:26<17:53, 29.82s/epoch, loss=0.554, accuracy=0.877, val_loss=0.995, val_accuracy=0.739, lr=0.00316] 74%|███████▍  | 101/136 [49:56<17:18, 29.66s/epoch, loss=0.554, accuracy=0.878, val_loss=0.879, val_accuracy=0.79, lr=0.01]     75%|███████▌  | 102/136 [50:26<16:54, 29.85s/epoch, loss=0.552, accuracy=0.878, val_loss=0.713, val_accuracy=0.827, lr=0.01] 76%|███████▌  | 103/136 [50:55<16:19, 29.67s/epoch, loss=0.556, accuracy=0.877, val_loss=1.24, val_accuracy=0.698, lr=0.01]  76%|███████▋  | 104/136 [51:25<15:50, 29.69s/epoch, loss=0.554, accuracy=0.88, val_loss=1.47, val_accuracy=0.647, lr=0.01]  77%|███████▋  | 105/136 [51:54<15:17, 29.61s/epoch, loss=0.547, accuracy=0.88, val_loss=0.735, val_accuracy=0.824, lr=0.01] 78%|███████▊  | 106/136 [52:24<14:47, 29.59s/epoch, loss=0.557, accuracy=0.878, val_loss=0.884, val_accuracy=0.784, lr=0.01] 79%|███████▊  | 107/136 [52:52<14:09, 29.31s/epoch, loss=0.552, accuracy=0.881, val_loss=0.764, val_accuracy=0.817, lr=0.00316] 79%|███████▉  | 108/136 [53:22<13:44, 29.44s/epoch, loss=0.556, accuracy=0.879, val_loss=0.783, val_accuracy=0.805, lr=0.01]    80%|████████  | 109/136 [53:52<13:21, 29.70s/epoch, loss=0.553, accuracy=0.882, val_loss=0.917, val_accuracy=0.779, lr=0.01] 81%|████████  | 110/136 [54:21<12:45, 29.45s/epoch, loss=0.552, accuracy=0.881, val_loss=0.886, val_accuracy=0.792, lr=0.01] 82%|████████▏ | 111/136 [54:52<12:23, 29.74s/epoch, loss=0.559, accuracy=0.879, val_loss=0.948, val_accuracy=0.758, lr=0.01] 82%|████████▏ | 112/136 [55:20<11:43, 29.33s/epoch, loss=0.558, accuracy=0.88, val_loss=0.773, val_accuracy=0.814, lr=0.00316] 83%|████████▎ | 113/136 [55:49<11:08, 29.08s/epoch, loss=0.553, accuracy=0.884, val_loss=0.806, val_accuracy=0.8, lr=0.01]     84%|████████▍ | 114/136 [56:18<10:40, 29.13s/epoch, loss=0.552, accuracy=0.885, val_loss=0.803, val_accuracy=0.808, lr=0.01] 85%|████████▍ | 115/136 [56:47<10:11, 29.12s/epoch, loss=0.55, accuracy=0.885, val_loss=0.772, val_accuracy=0.808, lr=0.01]  85%|████████▌ | 116/136 [57:16<09:40, 29.04s/epoch, loss=0.554, accuracy=0.884, val_loss=1.61, val_accuracy=0.567, lr=0.01] 86%|████████▌ | 117/136 [57:46<09:16, 29.28s/epoch, loss=0.556, accuracy=0.884, val_loss=0.867, val_accuracy=0.786, lr=0.00316] 87%|████████▋ | 118/136 [58:16<08:51, 29.52s/epoch, loss=0.548, accuracy=0.887, val_loss=0.947, val_accuracy=0.768, lr=0.01]    88%|████████▊ | 119/136 [58:46<08:27, 29.84s/epoch, loss=0.554, accuracy=0.885, val_loss=0.85, val_accuracy=0.791, lr=0.01]  88%|████████▊ | 120/136 [59:16<07:55, 29.71s/epoch, loss=0.547, accuracy=0.885, val_loss=0.909, val_accuracy=0.783, lr=0.01] 89%|████████▉ | 121/136 [59:44<07:17, 29.18s/epoch, loss=0.55, accuracy=0.885, val_loss=1.74, val_accuracy=0.583, lr=0.01]   90%|████████▉ | 122/136 [1:00:13<06:50, 29.32s/epoch, loss=0.477, accuracy=0.911, val_loss=0.55, val_accuracy=0.885, lr=0.001] 90%|█████████ | 123/136 [1:00:44<06:28, 29.86s/epoch, loss=0.424, accuracy=0.927, val_loss=0.529, val_accuracy=0.892, lr=0.001] 91%|█████████ | 124/136 [1:01:14<05:57, 29.75s/epoch, loss=0.403, accuracy=0.933, val_loss=0.532, val_accuracy=0.892, lr=0.001] 92%|█████████▏| 125/136 [1:01:44<05:29, 29.94s/epoch, loss=0.386, accuracy=0.938, val_loss=0.509, val_accuracy=0.898, lr=0.001] 93%|█████████▎| 126/136 [1:02:12<04:53, 29.38s/epoch, loss=0.37, accuracy=0.941, val_loss=0.504, val_accuracy=0.896, lr=0.001]  93%|█████████▎| 127/136 [1:02:40<04:20, 28.92s/epoch, loss=0.358, accuracy=0.943, val_loss=0.501, val_accuracy=0.897, lr=0.001] 94%|█████████▍| 128/136 [1:03:10<03:53, 29.22s/epoch, loss=0.349, accuracy=0.944, val_loss=0.499, val_accuracy=0.895, lr=0.001] 95%|█████████▍| 129/136 [1:03:41<03:26, 29.57s/epoch, loss=0.338, accuracy=0.946, val_loss=0.485, val_accuracy=0.897, lr=0.001] 96%|█████████▌| 130/136 [1:04:10<02:56, 29.39s/epoch, loss=0.331, accuracy=0.947, val_loss=0.503, val_accuracy=0.893, lr=0.001] 96%|█████████▋| 131/136 [1:04:38<02:25, 29.14s/epoch, loss=0.321, accuracy=0.949, val_loss=0.503, val_accuracy=0.89, lr=0.001]  97%|█████████▋| 132/136 [1:05:06<01:55, 28.89s/epoch, loss=0.312, accuracy=0.951, val_loss=0.484, val_accuracy=0.898, lr=0.001] 98%|█████████▊| 133/136 [1:05:36<01:27, 29.22s/epoch, loss=0.303, accuracy=0.952, val_loss=0.492, val_accuracy=0.891, lr=0.001] 99%|█████████▊| 134/136 [1:06:07<00:59, 29.53s/epoch, loss=0.296, accuracy=0.953, val_loss=0.485, val_accuracy=0.897, lr=0.001] 99%|█████████▉| 135/136 [1:06:36<00:29, 29.58s/epoch, loss=0.293, accuracy=0.953, val_loss=0.483, val_accuracy=0.896, lr=0.001]100%|██████████| 136/136 [1:07:05<00:00, 29.44s/epoch, loss=0.283, accuracy=0.956, val_loss=0.487, val_accuracy=0.897, lr=0.001]100%|██████████| 136/136 [1:07:05<00:00, 29.60s/epoch, loss=0.283, accuracy=0.956, val_loss=0.487, val_accuracy=0.897, lr=0.001]
Using real-time data augmentation.
Test loss: 0.48701226711273193
Test accuracy: 0.8966000080108643


* * * Run SGD for ID = 11_9. * * *


2024-02-15 20:48:42.914540: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 20:48:45.673102: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 20:48:45.674510: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-15 20:48:45.715654: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 20:48:45.715700: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 20:48:45.719357: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 20:48:45.719431: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 20:48:45.721892: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 20:48:45.722609: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 20:48:45.725473: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 20:48:45.727196: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 20:48:45.733209: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 20:48:45.733936: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 20:48:45.734026: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 20:48:47.012440: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-15 20:48:47.013102: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 20:48:47.013671: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 20:48:47.013713: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 20:48:47.013763: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 20:48:47.013779: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 20:48:47.013794: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 20:48:47.013809: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 20:48:47.013825: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 20:48:47.013840: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 20:48:47.013855: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 20:48:47.014435: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 20:48:47.014478: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 20:48:47.714287: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-15 20:48:47.714434: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-15 20:48:47.714447: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-15 20:48:47.718277: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:18:00.0, compute capability: 6.1)
{'id': 119, 'batch_size': 128, 'epochs': 136, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/136 [00:00<?, ?epoch/s]2024-02-15 20:48:48.537362: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-15 20:48:48.538006: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-02-15 20:48:50.525252: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 20:48:50.850972: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 20:48:51.749124: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-15 20:48:51.817205: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/136 [01:17<2:54:53, 77.73s/epoch, loss=3.65, accuracy=0.319, val_loss=2.75, val_accuracy=0.18, lr=0.1]  1%|▏         | 2/136 [01:46<1:48:46, 48.70s/epoch, loss=1.58, accuracy=0.532, val_loss=3.93, val_accuracy=0.221, lr=0.1]  2%|▏         | 3/136 [02:15<1:28:50, 40.08s/epoch, loss=1.33, accuracy=0.646, val_loss=2.17, val_accuracy=0.368, lr=0.1]  3%|▎         | 4/136 [02:44<1:18:00, 35.46s/epoch, loss=1.26, accuracy=0.684, val_loss=2.16, val_accuracy=0.478, lr=0.1]  4%|▎         | 5/136 [03:12<1:12:00, 32.98s/epoch, loss=1.24, accuracy=0.698, val_loss=1.73, val_accuracy=0.502, lr=0.1]  4%|▍         | 6/136 [03:43<1:09:49, 32.23s/epoch, loss=1.22, accuracy=0.71, val_loss=1.51, val_accuracy=0.618, lr=0.1]   5%|▌         | 7/136 [04:14<1:08:05, 31.67s/epoch, loss=1.21, accuracy=0.718, val_loss=2.68, val_accuracy=0.454, lr=0.1]  6%|▌         | 8/136 [04:42<1:05:23, 30.65s/epoch, loss=1.2, accuracy=0.724, val_loss=1.79, val_accuracy=0.533, lr=0.1]   7%|▋         | 9/136 [05:11<1:03:54, 30.19s/epoch, loss=1.19, accuracy=0.727, val_loss=1.41, val_accuracy=0.648, lr=0.1]  7%|▋         | 10/136 [05:42<1:03:50, 30.40s/epoch, loss=1.19, accuracy=0.729, val_loss=2.58, val_accuracy=0.377, lr=0.1]  8%|▊         | 11/136 [06:13<1:03:40, 30.57s/epoch, loss=1.18, accuracy=0.735, val_loss=1.73, val_accuracy=0.574, lr=0.1]  9%|▉         | 12/136 [06:44<1:03:29, 30.72s/epoch, loss=1.18, accuracy=0.735, val_loss=2.01, val_accuracy=0.523, lr=0.1] 10%|▉         | 13/136 [07:15<1:03:00, 30.74s/epoch, loss=1.17, accuracy=0.738, val_loss=1.66, val_accuracy=0.593, lr=0.1] 10%|█         | 14/136 [07:45<1:02:18, 30.64s/epoch, loss=1.17, accuracy=0.739, val_loss=1.65, val_accuracy=0.557, lr=0.0316] 11%|█         | 15/136 [08:17<1:02:18, 30.90s/epoch, loss=1.17, accuracy=0.742, val_loss=1.8, val_accuracy=0.521, lr=0.1]     12%|█▏        | 16/136 [08:48<1:01:37, 30.81s/epoch, loss=1.16, accuracy=0.744, val_loss=1.54, val_accuracy=0.618, lr=0.1] 12%|█▎        | 17/136 [09:17<1:00:14, 30.38s/epoch, loss=1.16, accuracy=0.742, val_loss=2.99, val_accuracy=0.282, lr=0.1] 13%|█▎        | 18/136 [09:46<59:13, 30.12s/epoch, loss=1.17, accuracy=0.743, val_loss=2.2, val_accuracy=0.458, lr=0.1]    14%|█▍        | 19/136 [10:16<58:09, 29.82s/epoch, loss=1.15, accuracy=0.746, val_loss=2.1, val_accuracy=0.492, lr=0.0316] 15%|█▍        | 20/136 [10:46<58:04, 30.04s/epoch, loss=1.15, accuracy=0.745, val_loss=2.87, val_accuracy=0.312, lr=0.1]   15%|█▌        | 21/136 [11:16<57:36, 30.05s/epoch, loss=1.15, accuracy=0.747, val_loss=1.53, val_accuracy=0.615, lr=0.1] 16%|█▌        | 22/136 [11:46<56:47, 29.89s/epoch, loss=1.15, accuracy=0.747, val_loss=1.86, val_accuracy=0.583, lr=0.1] 17%|█▋        | 23/136 [12:14<55:31, 29.49s/epoch, loss=1.16, accuracy=0.747, val_loss=2.3, val_accuracy=0.465, lr=0.1]  18%|█▊        | 24/136 [12:45<55:35, 29.78s/epoch, loss=1.15, accuracy=0.746, val_loss=2.06, val_accuracy=0.451, lr=0.0316] 18%|█▊        | 25/136 [13:15<55:10, 29.82s/epoch, loss=1.14, accuracy=0.747, val_loss=1.68, val_accuracy=0.556, lr=0.1]    19%|█▉        | 26/136 [13:45<55:06, 30.06s/epoch, loss=1.14, accuracy=0.749, val_loss=2.47, val_accuracy=0.382, lr=0.1] 20%|█▉        | 27/136 [14:14<53:58, 29.71s/epoch, loss=1.14, accuracy=0.749, val_loss=2.2, val_accuracy=0.452, lr=0.1]  21%|██        | 28/136 [14:42<52:32, 29.19s/epoch, loss=1.14, accuracy=0.75, val_loss=1.68, val_accuracy=0.586, lr=0.1] 21%|██▏       | 29/136 [15:10<51:30, 28.88s/epoch, loss=1.14, accuracy=0.75, val_loss=2.28, val_accuracy=0.441, lr=0.0316] 22%|██▏       | 30/136 [15:39<51:10, 28.96s/epoch, loss=1.14, accuracy=0.748, val_loss=3.32, val_accuracy=0.318, lr=0.1]   23%|██▎       | 31/136 [16:07<50:07, 28.64s/epoch, loss=1.13, accuracy=0.751, val_loss=4.85, val_accuracy=0.285, lr=0.1] 24%|██▎       | 32/136 [16:33<48:09, 27.78s/epoch, loss=1.13, accuracy=0.752, val_loss=3.5, val_accuracy=0.31, lr=0.1]   24%|██▍       | 33/136 [17:01<47:52, 27.88s/epoch, loss=1.13, accuracy=0.751, val_loss=3.21, val_accuracy=0.399, lr=0.1] 25%|██▌       | 34/136 [17:28<46:57, 27.62s/epoch, loss=1.14, accuracy=0.75, val_loss=2.02, val_accuracy=0.52, lr=0.0316] 26%|██▌       | 35/136 [17:55<46:19, 27.52s/epoch, loss=1.14, accuracy=0.754, val_loss=2.13, val_accuracy=0.493, lr=0.1]  26%|██▋       | 36/136 [18:25<46:53, 28.14s/epoch, loss=1.14, accuracy=0.751, val_loss=1.98, val_accuracy=0.49, lr=0.1]  27%|██▋       | 37/136 [18:53<46:28, 28.17s/epoch, loss=1.14, accuracy=0.752, val_loss=1.61, val_accuracy=0.613, lr=0.1] 28%|██▊       | 38/136 [19:24<47:13, 28.92s/epoch, loss=1.14, accuracy=0.75, val_loss=2.76, val_accuracy=0.472, lr=0.1]  29%|██▊       | 39/136 [19:54<47:14, 29.22s/epoch, loss=1.13, accuracy=0.753, val_loss=2.88, val_accuracy=0.376, lr=0.0316] 29%|██▉       | 40/136 [20:25<47:28, 29.67s/epoch, loss=1.13, accuracy=0.752, val_loss=2.13, val_accuracy=0.464, lr=0.1]    30%|███       | 41/136 [20:55<47:14, 29.83s/epoch, loss=1.13, accuracy=0.755, val_loss=2.48, val_accuracy=0.457, lr=0.1] 31%|███       | 42/136 [21:25<46:55, 29.96s/epoch, loss=1.13, accuracy=0.753, val_loss=1.78, val_accuracy=0.568, lr=0.1] 32%|███▏      | 43/136 [21:54<45:47, 29.54s/epoch, loss=1.12, accuracy=0.755, val_loss=3.3, val_accuracy=0.371, lr=0.1]  32%|███▏      | 44/136 [22:23<45:03, 29.39s/epoch, loss=1.12, accuracy=0.756, val_loss=2.18, val_accuracy=0.503, lr=0.0316] 33%|███▎      | 45/136 [22:53<44:49, 29.55s/epoch, loss=1.13, accuracy=0.752, val_loss=1.76, val_accuracy=0.571, lr=0.1]    34%|███▍      | 46/136 [23:22<44:02, 29.36s/epoch, loss=1.13, accuracy=0.756, val_loss=1.8, val_accuracy=0.511, lr=0.1]  35%|███▍      | 47/136 [23:52<44:01, 29.68s/epoch, loss=1.12, accuracy=0.753, val_loss=2.54, val_accuracy=0.488, lr=0.1] 35%|███▌      | 48/136 [24:23<43:58, 29.98s/epoch, loss=1.12, accuracy=0.754, val_loss=1.61, val_accuracy=0.601, lr=0.1] 36%|███▌      | 49/136 [24:53<43:29, 30.00s/epoch, loss=1.13, accuracy=0.755, val_loss=2, val_accuracy=0.495, lr=0.0316] 37%|███▋      | 50/136 [25:23<43:02, 30.03s/epoch, loss=1.12, accuracy=0.755, val_loss=1.49, val_accuracy=0.63, lr=0.1]  38%|███▊      | 51/136 [25:52<42:02, 29.68s/epoch, loss=1.13, accuracy=0.753, val_loss=2.05, val_accuracy=0.545, lr=0.1] 38%|███▊      | 52/136 [26:21<41:18, 29.51s/epoch, loss=1.13, accuracy=0.754, val_loss=2.01, val_accuracy=0.507, lr=0.1] 39%|███▉      | 53/136 [26:52<41:21, 29.90s/epoch, loss=1.13, accuracy=0.755, val_loss=2.99, val_accuracy=0.367, lr=0.1] 40%|███▉      | 54/136 [27:22<41:11, 30.15s/epoch, loss=1.12, accuracy=0.757, val_loss=1.77, val_accuracy=0.529, lr=0.0316] 40%|████      | 55/136 [27:50<39:46, 29.46s/epoch, loss=1.13, accuracy=0.755, val_loss=2.46, val_accuracy=0.466, lr=0.1]    41%|████      | 56/136 [28:18<38:45, 29.07s/epoch, loss=1.13, accuracy=0.754, val_loss=3.24, val_accuracy=0.386, lr=0.1] 42%|████▏     | 57/136 [28:46<37:50, 28.74s/epoch, loss=1.12, accuracy=0.755, val_loss=2.02, val_accuracy=0.535, lr=0.1] 43%|████▎     | 58/136 [29:16<37:42, 29.01s/epoch, loss=1.12, accuracy=0.756, val_loss=1.52, val_accuracy=0.646, lr=0.1] 43%|████▎     | 59/136 [29:45<37:24, 29.15s/epoch, loss=1.13, accuracy=0.753, val_loss=2.85, val_accuracy=0.311, lr=0.0316] 44%|████▍     | 60/136 [30:14<36:53, 29.12s/epoch, loss=1.12, accuracy=0.755, val_loss=2.11, val_accuracy=0.475, lr=0.1]    45%|████▍     | 61/136 [30:44<36:39, 29.33s/epoch, loss=1.13, accuracy=0.755, val_loss=3.42, val_accuracy=0.373, lr=0.1] 46%|████▌     | 62/136 [31:15<36:39, 29.72s/epoch, loss=1.11, accuracy=0.756, val_loss=1.87, val_accuracy=0.534, lr=0.1] 46%|████▋     | 63/136 [31:44<35:51, 29.47s/epoch, loss=1.12, accuracy=0.754, val_loss=3.33, val_accuracy=0.307, lr=0.1] 47%|████▋     | 64/136 [32:14<35:47, 29.83s/epoch, loss=1.12, accuracy=0.756, val_loss=2.28, val_accuracy=0.406, lr=0.0316] 48%|████▊     | 65/136 [32:45<35:24, 29.93s/epoch, loss=1.12, accuracy=0.756, val_loss=1.67, val_accuracy=0.562, lr=0.1]    49%|████▊     | 66/136 [33:13<34:26, 29.53s/epoch, loss=1.12, accuracy=0.757, val_loss=2.55, val_accuracy=0.421, lr=0.1] 49%|████▉     | 67/136 [33:41<33:20, 29.00s/epoch, loss=1.12, accuracy=0.754, val_loss=2.27, val_accuracy=0.459, lr=0.1] 50%|█████     | 68/136 [34:09<32:22, 28.56s/epoch, loss=1.12, accuracy=0.757, val_loss=2.83, val_accuracy=0.411, lr=0.1] 51%|█████     | 69/136 [34:38<32:08, 28.78s/epoch, loss=1.12, accuracy=0.758, val_loss=1.37, val_accuracy=0.668, lr=0.1] 51%|█████▏    | 70/136 [35:07<31:45, 28.87s/epoch, loss=1.12, accuracy=0.756, val_loss=1.62, val_accuracy=0.578, lr=0.1] 52%|█████▏    | 71/136 [35:36<31:16, 28.88s/epoch, loss=1.12, accuracy=0.754, val_loss=1.93, val_accuracy=0.519, lr=0.1] 53%|█████▎    | 72/136 [36:06<31:11, 29.24s/epoch, loss=1.11, accuracy=0.757, val_loss=2.08, val_accuracy=0.494, lr=0.1] 54%|█████▎    | 73/136 [36:36<30:51, 29.39s/epoch, loss=1.12, accuracy=0.757, val_loss=2.74, val_accuracy=0.338, lr=0.1] 54%|█████▍    | 74/136 [37:06<30:40, 29.69s/epoch, loss=1.12, accuracy=0.755, val_loss=3.06, val_accuracy=0.405, lr=0.0316] 55%|█████▌    | 75/136 [37:35<29:51, 29.37s/epoch, loss=1.12, accuracy=0.757, val_loss=2.69, val_accuracy=0.42, lr=0.1]     56%|█████▌    | 76/136 [38:03<29:12, 29.21s/epoch, loss=1.12, accuracy=0.756, val_loss=8.61, val_accuracy=0.262, lr=0.1] 57%|█████▋    | 77/136 [38:33<28:57, 29.45s/epoch, loss=1.11, accuracy=0.758, val_loss=1.94, val_accuracy=0.497, lr=0.1] 57%|█████▋    | 78/136 [39:03<28:34, 29.56s/epoch, loss=1.12, accuracy=0.758, val_loss=2.11, val_accuracy=0.464, lr=0.1] 58%|█████▊    | 79/136 [39:33<28:02, 29.52s/epoch, loss=1.11, accuracy=0.759, val_loss=1.89, val_accuracy=0.519, lr=0.0316] 59%|█████▉    | 80/136 [40:03<27:44, 29.73s/epoch, loss=1.11, accuracy=0.755, val_loss=2.22, val_accuracy=0.492, lr=0.1]    60%|█████▉    | 81/136 [40:33<27:21, 29.85s/epoch, loss=1.12, accuracy=0.757, val_loss=1.73, val_accuracy=0.6, lr=0.1]   60%|██████    | 82/136 [41:03<26:52, 29.86s/epoch, loss=0.911, accuracy=0.815, val_loss=0.9, val_accuracy=0.804, lr=0.01] 61%|██████    | 83/136 [41:33<26:29, 30.00s/epoch, loss=0.733, accuracy=0.847, val_loss=0.828, val_accuracy=0.803, lr=0.01] 62%|██████▏   | 84/136 [42:02<25:42, 29.67s/epoch, loss=0.656, accuracy=0.852, val_loss=0.9, val_accuracy=0.762, lr=0.01]   62%|██████▎   | 85/136 [42:33<25:31, 30.02s/epoch, loss=0.61, accuracy=0.857, val_loss=0.733, val_accuracy=0.808, lr=0.01] 63%|██████▎   | 86/136 [43:02<24:42, 29.64s/epoch, loss=0.589, accuracy=0.858, val_loss=0.897, val_accuracy=0.762, lr=0.01] 64%|██████▍   | 87/136 [43:33<24:34, 30.10s/epoch, loss=0.578, accuracy=0.86, val_loss=0.762, val_accuracy=0.798, lr=0.01]  65%|██████▍   | 88/136 [44:03<24:06, 30.13s/epoch, loss=0.574, accuracy=0.862, val_loss=0.727, val_accuracy=0.816, lr=0.01] 65%|██████▌   | 89/136 [44:32<23:22, 29.85s/epoch, loss=0.57, accuracy=0.861, val_loss=0.961, val_accuracy=0.748, lr=0.01]  66%|██████▌   | 90/136 [45:01<22:30, 29.36s/epoch, loss=0.562, accuracy=0.867, val_loss=0.955, val_accuracy=0.734, lr=0.01] 67%|██████▋   | 91/136 [45:28<21:35, 28.79s/epoch, loss=0.566, accuracy=0.864, val_loss=0.897, val_accuracy=0.774, lr=0.01] 68%|██████▊   | 92/136 [45:56<21:00, 28.65s/epoch, loss=0.563, accuracy=0.867, val_loss=0.931, val_accuracy=0.767, lr=0.01] 68%|██████▊   | 93/136 [46:24<20:16, 28.29s/epoch, loss=0.561, accuracy=0.869, val_loss=0.908, val_accuracy=0.758, lr=0.00316] 69%|██████▉   | 94/136 [46:54<20:11, 28.84s/epoch, loss=0.561, accuracy=0.869, val_loss=0.852, val_accuracy=0.78, lr=0.01]     70%|██████▉   | 95/136 [47:22<19:35, 28.67s/epoch, loss=0.56, accuracy=0.87, val_loss=0.7, val_accuracy=0.824, lr=0.01]    71%|███████   | 96/136 [47:51<19:08, 28.72s/epoch, loss=0.564, accuracy=0.87, val_loss=0.9, val_accuracy=0.773, lr=0.01] 71%|███████▏  | 97/136 [48:22<19:02, 29.30s/epoch, loss=0.555, accuracy=0.872, val_loss=0.918, val_accuracy=0.762, lr=0.01] 72%|███████▏  | 98/136 [48:53<18:54, 29.87s/epoch, loss=0.559, accuracy=0.871, val_loss=0.937, val_accuracy=0.758, lr=0.01] 73%|███████▎  | 99/136 [49:23<18:32, 30.07s/epoch, loss=0.559, accuracy=0.874, val_loss=0.8, val_accuracy=0.803, lr=0.01]   74%|███████▎  | 100/136 [49:54<18:13, 30.36s/epoch, loss=0.554, accuracy=0.875, val_loss=0.895, val_accuracy=0.782, lr=0.00316] 74%|███████▍  | 101/136 [50:24<17:35, 30.17s/epoch, loss=0.55, accuracy=0.878, val_loss=0.941, val_accuracy=0.742, lr=0.01]     75%|███████▌  | 102/136 [50:55<17:13, 30.39s/epoch, loss=0.555, accuracy=0.875, val_loss=0.741, val_accuracy=0.814, lr=0.01] 76%|███████▌  | 103/136 [51:26<16:44, 30.44s/epoch, loss=0.558, accuracy=0.875, val_loss=1.03, val_accuracy=0.751, lr=0.01]  76%|███████▋  | 104/136 [51:55<16:08, 30.26s/epoch, loss=0.558, accuracy=0.876, val_loss=0.827, val_accuracy=0.789, lr=0.01] 77%|███████▋  | 105/136 [52:25<15:29, 29.99s/epoch, loss=0.553, accuracy=0.876, val_loss=0.998, val_accuracy=0.753, lr=0.00316] 78%|███████▊  | 106/136 [52:53<14:44, 29.49s/epoch, loss=0.559, accuracy=0.876, val_loss=1.17, val_accuracy=0.702, lr=0.01]     79%|███████▊  | 107/136 [53:24<14:23, 29.76s/epoch, loss=0.557, accuracy=0.878, val_loss=0.789, val_accuracy=0.81, lr=0.01] 79%|███████▉  | 108/136 [53:54<13:57, 29.92s/epoch, loss=0.555, accuracy=0.879, val_loss=0.75, val_accuracy=0.815, lr=0.01] 80%|████████  | 109/136 [54:22<13:16, 29.51s/epoch, loss=0.556, accuracy=0.879, val_loss=0.964, val_accuracy=0.767, lr=0.01] 81%|████████  | 110/136 [54:52<12:45, 29.45s/epoch, loss=0.556, accuracy=0.879, val_loss=1.11, val_accuracy=0.722, lr=0.00316] 82%|████████▏ | 111/136 [55:20<12:08, 29.15s/epoch, loss=0.553, accuracy=0.882, val_loss=0.762, val_accuracy=0.816, lr=0.01]   82%|████████▏ | 112/136 [55:50<11:43, 29.33s/epoch, loss=0.556, accuracy=0.881, val_loss=1.07, val_accuracy=0.735, lr=0.01]  83%|████████▎ | 113/136 [56:19<11:09, 29.12s/epoch, loss=0.557, accuracy=0.878, val_loss=1, val_accuracy=0.754, lr=0.01]    84%|████████▍ | 114/136 [56:49<10:52, 29.66s/epoch, loss=0.553, accuracy=0.881, val_loss=1.01, val_accuracy=0.76, lr=0.01] 85%|████████▍ | 115/136 [57:20<10:29, 30.00s/epoch, loss=0.55, accuracy=0.882, val_loss=0.938, val_accuracy=0.758, lr=0.00316] 85%|████████▌ | 116/136 [57:50<10:00, 30.04s/epoch, loss=0.555, accuracy=0.88, val_loss=0.992, val_accuracy=0.749, lr=0.01]    86%|████████▌ | 117/136 [58:20<09:25, 29.78s/epoch, loss=0.55, accuracy=0.882, val_loss=0.778, val_accuracy=0.811, lr=0.01] 87%|████████▋ | 118/136 [58:50<08:57, 29.86s/epoch, loss=0.555, accuracy=0.881, val_loss=0.772, val_accuracy=0.807, lr=0.01] 88%|████████▊ | 119/136 [59:17<08:16, 29.23s/epoch, loss=0.552, accuracy=0.883, val_loss=1.23, val_accuracy=0.706, lr=0.01]  88%|████████▊ | 120/136 [59:46<07:43, 28.94s/epoch, loss=0.55, accuracy=0.883, val_loss=1.12, val_accuracy=0.732, lr=0.00316] 89%|████████▉ | 121/136 [1:00:14<07:09, 28.62s/epoch, loss=0.554, accuracy=0.883, val_loss=0.995, val_accuracy=0.761, lr=0.01] 90%|████████▉ | 122/136 [1:00:41<06:37, 28.41s/epoch, loss=0.47, accuracy=0.911, val_loss=0.528, val_accuracy=0.888, lr=0.001] 90%|█████████ | 123/136 [1:01:11<06:12, 28.64s/epoch, loss=0.421, accuracy=0.927, val_loss=0.504, val_accuracy=0.902, lr=0.001] 91%|█████████ | 124/136 [1:01:40<05:46, 28.89s/epoch, loss=0.399, accuracy=0.933, val_loss=0.503, val_accuracy=0.896, lr=0.001] 92%|█████████▏| 125/136 [1:02:10<05:19, 29.05s/epoch, loss=0.385, accuracy=0.936, val_loss=0.492, val_accuracy=0.899, lr=0.001] 93%|█████████▎| 126/136 [1:02:40<04:55, 29.55s/epoch, loss=0.371, accuracy=0.939, val_loss=0.495, val_accuracy=0.9, lr=0.001]   93%|█████████▎| 127/136 [1:03:10<04:26, 29.63s/epoch, loss=0.358, accuracy=0.942, val_loss=0.477, val_accuracy=0.902, lr=0.001] 94%|█████████▍| 128/136 [1:03:38<03:54, 29.26s/epoch, loss=0.347, accuracy=0.944, val_loss=0.476, val_accuracy=0.9, lr=0.001]   95%|█████████▍| 129/136 [1:04:08<03:25, 29.42s/epoch, loss=0.337, accuracy=0.945, val_loss=0.467, val_accuracy=0.902, lr=0.001] 96%|█████████▌| 130/136 [1:04:39<02:59, 29.90s/epoch, loss=0.328, accuracy=0.946, val_loss=0.467, val_accuracy=0.905, lr=0.001] 96%|█████████▋| 131/136 [1:05:09<02:29, 29.83s/epoch, loss=0.319, accuracy=0.947, val_loss=0.471, val_accuracy=0.9, lr=0.001]   97%|█████████▋| 132/136 [1:05:39<01:59, 29.99s/epoch, loss=0.314, accuracy=0.949, val_loss=0.471, val_accuracy=0.898, lr=0.001] 98%|█████████▊| 133/136 [1:06:09<01:29, 29.79s/epoch, loss=0.303, accuracy=0.951, val_loss=0.484, val_accuracy=0.897, lr=0.001] 99%|█████████▊| 134/136 [1:06:40<01:00, 30.15s/epoch, loss=0.302, accuracy=0.95, val_loss=0.462, val_accuracy=0.899, lr=0.001]  99%|█████████▉| 135/136 [1:07:09<00:29, 29.97s/epoch, loss=0.292, accuracy=0.951, val_loss=0.48, val_accuracy=0.892, lr=0.001]100%|██████████| 136/136 [1:07:40<00:00, 30.31s/epoch, loss=0.287, accuracy=0.953, val_loss=0.463, val_accuracy=0.898, lr=0.001]100%|██████████| 136/136 [1:07:40<00:00, 29.86s/epoch, loss=0.287, accuracy=0.953, val_loss=0.463, val_accuracy=0.898, lr=0.001]
Using real-time data augmentation.
Test loss: 0.46312767267227173
Test accuracy: 0.8982999920845032


* * * Run SGD for ID = 11_10. * * *


2024-02-15 21:56:33.359070: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 21:56:42.667953: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 21:56:42.669352: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-15 21:56:42.716553: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 21:56:42.716615: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 21:56:42.720553: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 21:56:42.720645: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 21:56:42.723664: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 21:56:42.726279: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 21:56:42.729293: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 21:56:42.731114: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 21:56:42.737114: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 21:56:42.737895: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 21:56:42.737990: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 21:56:44.135851: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-15 21:56:44.136574: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 21:56:44.137099: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 21:56:44.137136: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 21:56:44.137173: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 21:56:44.137188: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 21:56:44.137203: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 21:56:44.137217: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 21:56:44.137232: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 21:56:44.137246: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 21:56:44.137261: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 21:56:44.137825: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 21:56:44.137865: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 21:56:44.874609: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-15 21:56:44.874685: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-15 21:56:44.874697: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-15 21:56:44.876537: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:18:00.0, compute capability: 6.1)
{'id': 1110, 'batch_size': 128, 'epochs': 136, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/136 [00:00<?, ?epoch/s]2024-02-15 21:56:45.721863: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-15 21:56:45.733735: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-02-15 21:56:47.911072: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 21:56:48.324717: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 21:56:49.187975: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-15 21:56:49.273395: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/136 [01:09<2:36:17, 69.46s/epoch, loss=3.53, accuracy=0.276, val_loss=2.44, val_accuracy=0.254, lr=0.1]  1%|▏         | 2/136 [01:40<1:44:52, 46.96s/epoch, loss=1.7, accuracy=0.465, val_loss=2.1, val_accuracy=0.308, lr=0.1]    2%|▏         | 3/136 [02:12<1:28:30, 39.93s/epoch, loss=1.5, accuracy=0.562, val_loss=1.93, val_accuracy=0.45, lr=0.1]  3%|▎         | 4/136 [02:43<1:20:09, 36.44s/epoch, loss=1.41, accuracy=0.616, val_loss=2.12, val_accuracy=0.412, lr=0.1]  4%|▎         | 5/136 [03:14<1:15:33, 34.61s/epoch, loss=1.38, accuracy=0.639, val_loss=1.9, val_accuracy=0.459, lr=0.1]   4%|▍         | 6/136 [03:46<1:12:57, 33.67s/epoch, loss=1.34, accuracy=0.664, val_loss=2.5, val_accuracy=0.45, lr=0.1]   5%|▌         | 7/136 [04:16<1:09:51, 32.49s/epoch, loss=1.32, accuracy=0.674, val_loss=1.91, val_accuracy=0.495, lr=0.1]  6%|▌         | 8/136 [04:45<1:07:02, 31.43s/epoch, loss=1.31, accuracy=0.683, val_loss=1.53, val_accuracy=0.606, lr=0.1]  7%|▋         | 9/136 [05:17<1:07:02, 31.67s/epoch, loss=1.3, accuracy=0.691, val_loss=2.28, val_accuracy=0.493, lr=0.1]   7%|▋         | 10/136 [05:49<1:06:32, 31.68s/epoch, loss=1.28, accuracy=0.699, val_loss=3.72, val_accuracy=0.311, lr=0.1]  8%|▊         | 11/136 [06:21<1:06:00, 31.69s/epoch, loss=1.27, accuracy=0.705, val_loss=1.69, val_accuracy=0.558, lr=0.1]  9%|▉         | 12/136 [06:51<1:04:12, 31.07s/epoch, loss=1.26, accuracy=0.706, val_loss=1.85, val_accuracy=0.538, lr=0.1] 10%|▉         | 13/136 [07:22<1:04:10, 31.31s/epoch, loss=1.25, accuracy=0.715, val_loss=2.32, val_accuracy=0.427, lr=0.0316] 10%|█         | 14/136 [07:54<1:03:50, 31.39s/epoch, loss=1.24, accuracy=0.715, val_loss=2.41, val_accuracy=0.394, lr=0.1]    11%|█         | 15/136 [08:26<1:03:45, 31.62s/epoch, loss=1.24, accuracy=0.719, val_loss=2.1, val_accuracy=0.456, lr=0.1]  12%|█▏        | 16/136 [08:58<1:03:07, 31.56s/epoch, loss=1.23, accuracy=0.723, val_loss=1.93, val_accuracy=0.477, lr=0.1] 12%|█▎        | 17/136 [09:28<1:01:56, 31.23s/epoch, loss=1.22, accuracy=0.726, val_loss=3.14, val_accuracy=0.178, lr=0.1] 13%|█▎        | 18/136 [09:58<1:00:34, 30.80s/epoch, loss=1.22, accuracy=0.724, val_loss=2.28, val_accuracy=0.392, lr=0.0316] 14%|█▍        | 19/136 [10:28<59:41, 30.61s/epoch, loss=1.22, accuracy=0.727, val_loss=1.54, val_accuracy=0.628, lr=0.1]      15%|█▍        | 20/136 [10:58<59:00, 30.52s/epoch, loss=1.22, accuracy=0.729, val_loss=1.95, val_accuracy=0.562, lr=0.1] 15%|█▌        | 21/136 [11:30<59:12, 30.89s/epoch, loss=1.21, accuracy=0.73, val_loss=1.85, val_accuracy=0.572, lr=0.1]  16%|█▌        | 22/136 [12:01<58:47, 30.95s/epoch, loss=1.21, accuracy=0.729, val_loss=1.58, val_accuracy=0.621, lr=0.1] 17%|█▋        | 23/136 [12:31<57:35, 30.58s/epoch, loss=1.21, accuracy=0.733, val_loss=3.31, val_accuracy=0.348, lr=0.0316] 18%|█▊        | 24/136 [13:03<57:41, 30.91s/epoch, loss=1.2, accuracy=0.733, val_loss=3.89, val_accuracy=0.347, lr=0.1]     18%|█▊        | 25/136 [13:33<57:08, 30.89s/epoch, loss=1.21, accuracy=0.732, val_loss=1.79, val_accuracy=0.538, lr=0.1] 19%|█▉        | 26/136 [14:04<56:31, 30.83s/epoch, loss=1.2, accuracy=0.732, val_loss=1.78, val_accuracy=0.538, lr=0.1]  20%|█▉        | 27/136 [14:35<56:14, 30.96s/epoch, loss=1.2, accuracy=0.734, val_loss=2.01, val_accuracy=0.499, lr=0.1] 21%|██        | 28/136 [15:07<55:58, 31.10s/epoch, loss=1.2, accuracy=0.73, val_loss=4.06, val_accuracy=0.317, lr=0.0316] 21%|██▏       | 29/136 [15:38<55:35, 31.17s/epoch, loss=1.2, accuracy=0.737, val_loss=2.53, val_accuracy=0.421, lr=0.1]   22%|██▏       | 30/136 [16:09<54:52, 31.06s/epoch, loss=1.19, accuracy=0.736, val_loss=1.87, val_accuracy=0.544, lr=0.1] 23%|██▎       | 31/136 [16:38<53:26, 30.54s/epoch, loss=1.19, accuracy=0.737, val_loss=3.25, val_accuracy=0.42, lr=0.1]  24%|██▎       | 32/136 [17:10<53:41, 30.97s/epoch, loss=1.18, accuracy=0.738, val_loss=1.71, val_accuracy=0.558, lr=0.1] 24%|██▍       | 33/136 [17:41<52:52, 30.80s/epoch, loss=1.19, accuracy=0.739, val_loss=1.79, val_accuracy=0.521, lr=0.0316] 25%|██▌       | 34/136 [18:12<52:44, 31.02s/epoch, loss=1.19, accuracy=0.74, val_loss=1.68, val_accuracy=0.579, lr=0.1]     26%|██▌       | 35/136 [18:44<52:26, 31.15s/epoch, loss=1.19, accuracy=0.741, val_loss=1.77, val_accuracy=0.546, lr=0.1] 26%|██▋       | 36/136 [19:15<52:14, 31.34s/epoch, loss=1.19, accuracy=0.742, val_loss=3.06, val_accuracy=0.35, lr=0.1]  27%|██▋       | 37/136 [19:45<50:56, 30.88s/epoch, loss=1.18, accuracy=0.742, val_loss=2.36, val_accuracy=0.431, lr=0.1] 28%|██▊       | 38/136 [20:17<50:41, 31.03s/epoch, loss=1.18, accuracy=0.741, val_loss=2.33, val_accuracy=0.444, lr=0.0316] 29%|██▊       | 39/136 [20:48<50:18, 31.12s/epoch, loss=1.18, accuracy=0.74, val_loss=1.68, val_accuracy=0.602, lr=0.1]     29%|██▉       | 40/136 [21:19<49:51, 31.16s/epoch, loss=1.18, accuracy=0.742, val_loss=3.46, val_accuracy=0.288, lr=0.1] 30%|███       | 41/136 [21:50<49:17, 31.13s/epoch, loss=1.18, accuracy=0.741, val_loss=1.9, val_accuracy=0.516, lr=0.1]  31%|███       | 42/136 [22:21<48:39, 31.06s/epoch, loss=1.18, accuracy=0.743, val_loss=2.26, val_accuracy=0.475, lr=0.1] 32%|███▏      | 43/136 [22:52<48:08, 31.06s/epoch, loss=1.17, accuracy=0.744, val_loss=2.16, val_accuracy=0.456, lr=0.0316] 32%|███▏      | 44/136 [23:24<48:03, 31.35s/epoch, loss=1.16, accuracy=0.745, val_loss=2.67, val_accuracy=0.447, lr=0.1]    33%|███▎      | 45/136 [23:55<47:09, 31.09s/epoch, loss=1.17, accuracy=0.745, val_loss=3.04, val_accuracy=0.381, lr=0.1] 34%|███▍      | 46/136 [24:25<46:16, 30.85s/epoch, loss=1.17, accuracy=0.748, val_loss=2.68, val_accuracy=0.35, lr=0.1]  35%|███▍      | 47/136 [24:55<45:26, 30.64s/epoch, loss=1.17, accuracy=0.746, val_loss=3.64, val_accuracy=0.367, lr=0.1] 35%|███▌      | 48/136 [25:26<44:55, 30.63s/epoch, loss=1.16, accuracy=0.748, val_loss=1.78, val_accuracy=0.506, lr=0.0316] 36%|███▌      | 49/136 [25:56<44:11, 30.48s/epoch, loss=1.16, accuracy=0.747, val_loss=3.54, val_accuracy=0.283, lr=0.1]    37%|███▋      | 50/136 [26:27<43:49, 30.58s/epoch, loss=1.16, accuracy=0.747, val_loss=1.87, val_accuracy=0.54, lr=0.1]  38%|███▊      | 51/136 [26:55<42:18, 29.86s/epoch, loss=1.16, accuracy=0.748, val_loss=2.35, val_accuracy=0.404, lr=0.1] 38%|███▊      | 52/136 [27:24<41:30, 29.65s/epoch, loss=1.16, accuracy=0.747, val_loss=2.84, val_accuracy=0.362, lr=0.1] 39%|███▉      | 53/136 [27:52<40:32, 29.30s/epoch, loss=1.16, accuracy=0.747, val_loss=1.94, val_accuracy=0.475, lr=0.0316] 40%|███▉      | 54/136 [28:20<39:29, 28.89s/epoch, loss=1.16, accuracy=0.748, val_loss=2.31, val_accuracy=0.387, lr=0.1]    40%|████      | 55/136 [28:50<39:22, 29.16s/epoch, loss=1.16, accuracy=0.748, val_loss=2.29, val_accuracy=0.408, lr=0.1]
Thu Feb 15 11:10:31 2024       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 535.104.05             Driver Version: 535.104.05   CUDA Version: 12.2     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA TITAN Xp                Off | 00000000:3B:00.0 Off |                  N/A |
| 23%   37C    P8               9W / 250W |      0MiB / 12288MiB |      0%      Default |
|                                         |                      |                  N/A |
+-----------------------------------------+----------------------+----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
|  No running processes found                                                           |
+---------------------------------------------------------------------------------------+


* * * Run SGD for cluster size = 10. * * *


Budget: 150


* * * Run SGD for ID = 10_1. * * *


2024-02-15 11:10:32.136268: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 11:10:35.971588: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 11:10:35.972792: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-15 11:10:36.007675: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 11:10:36.007717: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 11:10:36.011493: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 11:10:36.011587: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 11:10:36.014469: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 11:10:36.015435: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 11:10:36.018614: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 11:10:36.020486: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 11:10:36.026090: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 11:10:36.026769: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 11:10:36.026849: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 11:10:37.225725: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-15 11:10:37.226913: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 11:10:37.227428: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 11:10:37.227471: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 11:10:37.227510: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 11:10:37.227529: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 11:10:37.227548: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 11:10:37.227585: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 11:10:37.227612: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 11:10:37.227637: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 11:10:37.227661: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 11:10:37.228252: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 11:10:37.228304: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 11:10:37.878434: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-15 11:10:37.878495: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-15 11:10:37.878506: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-15 11:10:37.879540: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:3b:00.0, compute capability: 6.1)
{'id': 101, 'batch_size': 128, 'epochs': 150, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/150 [00:00<?, ?epoch/s]2024-02-15 11:10:38.640945: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-15 11:10:38.652721: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-02-15 11:10:40.502072: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 11:10:40.838122: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 11:10:41.624497: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-15 11:10:41.675781: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/150 [01:00<2:30:45, 60.71s/epoch, loss=3.29, accuracy=0.302, val_loss=2.18, val_accuracy=0.281, lr=0.1]  1%|▏         | 2/150 [01:26<1:39:12, 40.22s/epoch, loss=1.59, accuracy=0.517, val_loss=1.84, val_accuracy=0.47, lr=0.1]   2%|▏         | 3/150 [01:51<1:21:38, 33.32s/epoch, loss=1.37, accuracy=0.626, val_loss=2.55, val_accuracy=0.379, lr=0.1]  3%|▎         | 4/150 [02:18<1:15:16, 30.94s/epoch, loss=1.3, accuracy=0.67, val_loss=1.5, val_accuracy=0.594, lr=0.1]     3%|▎         | 5/150 [02:45<1:10:56, 29.35s/epoch, loss=1.26, accuracy=0.691, val_loss=4.19, val_accuracy=0.231, lr=0.1]  4%|▍         | 6/150 [03:12<1:08:50, 28.68s/epoch, loss=1.25, accuracy=0.701, val_loss=1.5, val_accuracy=0.622, lr=0.1]   5%|▍         | 7/150 [03:40<1:07:12, 28.20s/epoch, loss=1.23, accuracy=0.711, val_loss=1.94, val_accuracy=0.467, lr=0.1]  5%|▌         | 8/150 [04:07<1:06:20, 28.03s/epoch, loss=1.23, accuracy=0.72, val_loss=2.2, val_accuracy=0.473, lr=0.1]    6%|▌         | 9/150 [04:33<1:04:01, 27.25s/epoch, loss=1.22, accuracy=0.723, val_loss=1.64, val_accuracy=0.591, lr=0.1]  7%|▋         | 10/150 [04:57<1:01:40, 26.43s/epoch, loss=1.22, accuracy=0.726, val_loss=3.53, val_accuracy=0.327, lr=0.1]  7%|▋         | 11/150 [05:25<1:02:06, 26.81s/epoch, loss=1.21, accuracy=0.73, val_loss=2.29, val_accuracy=0.419, lr=0.0316]  8%|▊         | 12/150 [05:50<1:00:18, 26.22s/epoch, loss=1.21, accuracy=0.733, val_loss=2.1, val_accuracy=0.492, lr=0.1]     9%|▊         | 13/150 [06:17<1:00:08, 26.34s/epoch, loss=1.2, accuracy=0.737, val_loss=1.53, val_accuracy=0.63, lr=0.1]   9%|▉         | 14/150 [06:44<1:00:17, 26.60s/epoch, loss=1.2, accuracy=0.737, val_loss=1.89, val_accuracy=0.501, lr=0.1] 10%|█         | 15/150 [07:11<1:00:03, 26.69s/epoch, loss=1.2, accuracy=0.739, val_loss=1.66, val_accuracy=0.563, lr=0.1] 11%|█         | 16/150 [07:38<1:00:14, 26.97s/epoch, loss=1.19, accuracy=0.74, val_loss=3.89, val_accuracy=0.248, lr=0.0316] 11%|█▏        | 17/150 [08:06<1:00:06, 27.12s/epoch, loss=1.19, accuracy=0.741, val_loss=1.64, val_accuracy=0.563, lr=0.1]   12%|█▏        | 18/150 [08:33<59:58, 27.26s/epoch, loss=1.19, accuracy=0.743, val_loss=2.38, val_accuracy=0.483, lr=0.1]   13%|█▎        | 19/150 [08:59<58:43, 26.89s/epoch, loss=1.19, accuracy=0.743, val_loss=7.47, val_accuracy=0.153, lr=0.1] 13%|█▎        | 20/150 [09:27<58:39, 27.08s/epoch, loss=1.18, accuracy=0.746, val_loss=2.67, val_accuracy=0.303, lr=0.1] 14%|█▍        | 21/150 [09:54<58:28, 27.20s/epoch, loss=1.18, accuracy=0.745, val_loss=3.13, val_accuracy=0.354, lr=0.0316] 15%|█▍        | 22/150 [10:20<56:47, 26.62s/epoch, loss=1.17, accuracy=0.746, val_loss=1.74, val_accuracy=0.56, lr=0.1]     15%|█▌        | 23/150 [10:45<55:49, 26.38s/epoch, loss=1.19, accuracy=0.742, val_loss=2.65, val_accuracy=0.312, lr=0.1] 16%|█▌        | 24/150 [11:10<53:57, 25.69s/epoch, loss=1.17, accuracy=0.747, val_loss=1.77, val_accuracy=0.544, lr=0.1] 17%|█▋        | 25/150 [11:35<53:04, 25.48s/epoch, loss=1.18, accuracy=0.748, val_loss=2.16, val_accuracy=0.426, lr=0.1] 17%|█▋        | 26/150 [11:58<51:36, 24.97s/epoch, loss=1.17, accuracy=0.748, val_loss=1.93, val_accuracy=0.542, lr=0.0316] 18%|█▊        | 27/150 [12:25<51:57, 25.35s/epoch, loss=1.17, accuracy=0.746, val_loss=1.64, val_accuracy=0.564, lr=0.1]    19%|█▊        | 28/150 [12:51<52:20, 25.74s/epoch, loss=1.17, accuracy=0.748, val_loss=2.95, val_accuracy=0.326, lr=0.1] 19%|█▉        | 29/150 [13:19<53:18, 26.44s/epoch, loss=1.17, accuracy=0.746, val_loss=2.71, val_accuracy=0.368, lr=0.1] 20%|██        | 30/150 [13:46<52:46, 26.39s/epoch, loss=1.17, accuracy=0.747, val_loss=2.1, val_accuracy=0.393, lr=0.1]  21%|██        | 31/150 [14:13<52:50, 26.64s/epoch, loss=1.17, accuracy=0.75, val_loss=2.76, val_accuracy=0.378, lr=0.0316] 21%|██▏       | 32/150 [14:41<53:12, 27.05s/epoch, loss=1.17, accuracy=0.749, val_loss=1.72, val_accuracy=0.603, lr=0.1]   22%|██▏       | 33/150 [15:09<53:13, 27.29s/epoch, loss=1.17, accuracy=0.75, val_loss=2.23, val_accuracy=0.513, lr=0.1]  23%|██▎       | 34/150 [15:37<53:23, 27.62s/epoch, loss=1.16, accuracy=0.75, val_loss=1.63, val_accuracy=0.569, lr=0.1] 23%|██▎       | 35/150 [16:03<52:06, 27.19s/epoch, loss=1.17, accuracy=0.748, val_loss=2.45, val_accuracy=0.416, lr=0.1] 24%|██▍       | 36/150 [16:28<50:21, 26.51s/epoch, loss=1.15, accuracy=0.751, val_loss=2.14, val_accuracy=0.435, lr=0.0316] 25%|██▍       | 37/150 [16:53<49:15, 26.16s/epoch, loss=1.16, accuracy=0.749, val_loss=2.13, val_accuracy=0.421, lr=0.1]    25%|██▌       | 38/150 [17:21<49:26, 26.48s/epoch, loss=1.17, accuracy=0.751, val_loss=2.67, val_accuracy=0.385, lr=0.1] 26%|██▌       | 39/150 [17:48<49:29, 26.75s/epoch, loss=1.16, accuracy=0.751, val_loss=1.87, val_accuracy=0.53, lr=0.1]  27%|██▋       | 40/150 [18:14<48:50, 26.64s/epoch, loss=1.16, accuracy=0.751, val_loss=2.06, val_accuracy=0.529, lr=0.1] 27%|██▋       | 41/150 [18:40<47:46, 26.30s/epoch, loss=1.16, accuracy=0.751, val_loss=2.16, val_accuracy=0.44, lr=0.0316] 28%|██▊       | 42/150 [19:08<48:00, 26.68s/epoch, loss=1.16, accuracy=0.751, val_loss=1.97, val_accuracy=0.534, lr=0.1]   29%|██▊       | 43/150 [19:34<47:29, 26.63s/epoch, loss=1.16, accuracy=0.753, val_loss=2.82, val_accuracy=0.406, lr=0.1] 29%|██▉       | 44/150 [20:02<47:31, 26.90s/epoch, loss=1.14, accuracy=0.754, val_loss=2.56, val_accuracy=0.383, lr=0.1] 30%|███       | 45/150 [20:29<47:14, 26.99s/epoch, loss=1.15, accuracy=0.753, val_loss=2.19, val_accuracy=0.477, lr=0.1] 31%|███       | 46/150 [20:57<47:11, 27.23s/epoch, loss=1.15, accuracy=0.755, val_loss=2.81, val_accuracy=0.333, lr=0.0316] 31%|███▏      | 47/150 [21:23<46:27, 27.07s/epoch, loss=1.16, accuracy=0.75, val_loss=1.64, val_accuracy=0.608, lr=0.1]     32%|███▏      | 48/150 [21:52<46:59, 27.64s/epoch, loss=1.16, accuracy=0.752, val_loss=2.02, val_accuracy=0.437, lr=0.1] 33%|███▎      | 49/150 [22:19<46:19, 27.52s/epoch, loss=1.15, accuracy=0.752, val_loss=2.54, val_accuracy=0.427, lr=0.1] 33%|███▎      | 50/150 [22:46<45:33, 27.34s/epoch, loss=1.14, accuracy=0.755, val_loss=2.29, val_accuracy=0.495, lr=0.1] 34%|███▍      | 51/150 [23:13<44:43, 27.11s/epoch, loss=1.14, accuracy=0.757, val_loss=1.92, val_accuracy=0.569, lr=0.0316] 35%|███▍      | 52/150 [23:41<44:35, 27.30s/epoch, loss=1.14, accuracy=0.755, val_loss=1.85, val_accuracy=0.509, lr=0.1]    35%|███▌      | 53/150 [24:06<42:56, 26.56s/epoch, loss=1.14, accuracy=0.756, val_loss=2.82, val_accuracy=0.416, lr=0.1] 36%|███▌      | 54/150 [24:33<42:45, 26.73s/epoch, loss=1.14, accuracy=0.754, val_loss=3.76, val_accuracy=0.226, lr=0.1] 37%|███▋      | 55/150 [24:59<42:05, 26.58s/epoch, loss=1.14, accuracy=0.754, val_loss=1.89, val_accuracy=0.53, lr=0.1]  37%|███▋      | 56/150 [25:27<42:08, 26.90s/epoch, loss=1.14, accuracy=0.754, val_loss=1.74, val_accuracy=0.584, lr=0.0316] 38%|███▊      | 57/150 [25:54<41:52, 27.02s/epoch, loss=1.13, accuracy=0.756, val_loss=2.15, val_accuracy=0.483, lr=0.1]    39%|███▊      | 58/150 [26:21<41:39, 27.17s/epoch, loss=1.14, accuracy=0.753, val_loss=1.89, val_accuracy=0.547, lr=0.1] 39%|███▉      | 59/150 [26:49<41:31, 27.38s/epoch, loss=1.15, accuracy=0.752, val_loss=2.1, val_accuracy=0.555, lr=0.1]  40%|████      | 60/150 [27:18<41:37, 27.75s/epoch, loss=1.14, accuracy=0.753, val_loss=1.81, val_accuracy=0.536, lr=0.1] 41%|████      | 61/150 [27:47<41:35, 28.04s/epoch, loss=1.14, accuracy=0.756, val_loss=4.28, val_accuracy=0.355, lr=0.0316] 41%|████▏     | 62/150 [28:15<41:18, 28.17s/epoch, loss=1.13, accuracy=0.758, val_loss=2.83, val_accuracy=0.404, lr=0.1]    42%|████▏     | 63/150 [28:43<40:49, 28.16s/epoch, loss=1.14, accuracy=0.756, val_loss=2.14, val_accuracy=0.465, lr=0.1] 43%|████▎     | 64/150 [29:10<39:49, 27.78s/epoch, loss=1.13, accuracy=0.757, val_loss=2.75, val_accuracy=0.417, lr=0.1] 43%|████▎     | 65/150 [29:38<39:37, 27.97s/epoch, loss=1.14, accuracy=0.754, val_loss=1.86, val_accuracy=0.539, lr=0.1] 44%|████▍     | 66/150 [30:07<39:19, 28.09s/epoch, loss=1.13, accuracy=0.757, val_loss=1.73, val_accuracy=0.581, lr=0.0316] 45%|████▍     | 67/150 [30:32<37:49, 27.34s/epoch, loss=1.13, accuracy=0.756, val_loss=2.15, val_accuracy=0.448, lr=0.1]    45%|████▌     | 68/150 [31:00<37:19, 27.31s/epoch, loss=1.12, accuracy=0.757, val_loss=2.35, val_accuracy=0.369, lr=0.1] 46%|████▌     | 69/150 [31:27<36:53, 27.33s/epoch, loss=1.13, accuracy=0.758, val_loss=2, val_accuracy=0.456, lr=0.1]    47%|████▋     | 70/150 [31:55<36:31, 27.40s/epoch, loss=1.14, accuracy=0.755, val_loss=1.77, val_accuracy=0.526, lr=0.1] 47%|████▋     | 71/150 [32:21<35:32, 27.00s/epoch, loss=1.13, accuracy=0.757, val_loss=2.24, val_accuracy=0.348, lr=0.0316] 48%|████▊     | 72/150 [32:48<35:09, 27.04s/epoch, loss=1.12, accuracy=0.759, val_loss=3.54, val_accuracy=0.349, lr=0.1]    49%|████▊     | 73/150 [33:14<34:24, 26.81s/epoch, loss=1.13, accuracy=0.756, val_loss=2.09, val_accuracy=0.498, lr=0.1] 49%|████▉     | 74/150 [33:41<33:59, 26.84s/epoch, loss=1.13, accuracy=0.758, val_loss=2.45, val_accuracy=0.427, lr=0.1] 50%|█████     | 75/150 [34:08<33:31, 26.82s/epoch, loss=1.12, accuracy=0.759, val_loss=2.71, val_accuracy=0.414, lr=0.1] 51%|█████     | 76/150 [34:35<33:17, 26.99s/epoch, loss=1.12, accuracy=0.758, val_loss=4.64, val_accuracy=0.195, lr=0.0316] 51%|█████▏    | 77/150 [35:04<33:41, 27.69s/epoch, loss=1.13, accuracy=0.757, val_loss=2.06, val_accuracy=0.433, lr=0.1]    52%|█████▏    | 78/150 [35:35<34:05, 28.41s/epoch, loss=1.12, accuracy=0.756, val_loss=2.74, val_accuracy=0.421, lr=0.1] 53%|█████▎    | 79/150 [36:04<34:00, 28.74s/epoch, loss=1.13, accuracy=0.757, val_loss=2.1, val_accuracy=0.486, lr=0.1]  53%|█████▎    | 80/150 [36:34<33:47, 28.96s/epoch, loss=1.12, accuracy=0.759, val_loss=1.71, val_accuracy=0.558, lr=0.1] 54%|█████▍    | 81/150 [37:03<33:20, 29.00s/epoch, loss=1.13, accuracy=0.759, val_loss=2.39, val_accuracy=0.421, lr=0.0316] 55%|█████▍    | 82/150 [37:32<33:06, 29.21s/epoch, loss=0.908, accuracy=0.817, val_loss=0.906, val_accuracy=0.801, lr=0.01] 55%|█████▌    | 83/150 [38:02<32:46, 29.35s/epoch, loss=0.729, accuracy=0.85, val_loss=0.888, val_accuracy=0.781, lr=0.01]  56%|█████▌    | 84/150 [38:32<32:20, 29.40s/epoch, loss=0.647, accuracy=0.858, val_loss=0.69, val_accuracy=0.837, lr=0.01] 57%|█████▋    | 85/150 [39:01<31:51, 29.41s/epoch, loss=0.606, accuracy=0.861, val_loss=0.72, val_accuracy=0.821, lr=0.01] 57%|█████▋    | 86/150 [39:31<31:27, 29.48s/epoch, loss=0.584, accuracy=0.86, val_loss=0.76, val_accuracy=0.812, lr=0.01]  58%|█████▊    | 87/150 [40:00<30:58, 29.49s/epoch, loss=0.575, accuracy=0.863, val_loss=0.758, val_accuracy=0.804, lr=0.01] 59%|█████▊    | 88/150 [40:29<30:18, 29.34s/epoch, loss=0.563, accuracy=0.866, val_loss=1.01, val_accuracy=0.739, lr=0.01]  59%|█████▉    | 89/150 [40:59<29:55, 29.43s/epoch, loss=0.565, accuracy=0.866, val_loss=0.689, val_accuracy=0.824, lr=0.01] 60%|██████    | 90/150 [41:28<29:31, 29.52s/epoch, loss=0.558, accuracy=0.868, val_loss=0.844, val_accuracy=0.776, lr=0.01] 61%|██████    | 91/150 [41:58<29:08, 29.64s/epoch, loss=0.558, accuracy=0.869, val_loss=0.74, val_accuracy=0.807, lr=0.01]  61%|██████▏   | 92/150 [42:28<28:46, 29.77s/epoch, loss=0.559, accuracy=0.869, val_loss=0.915, val_accuracy=0.767, lr=0.01] 62%|██████▏   | 93/150 [42:57<27:54, 29.38s/epoch, loss=0.553, accuracy=0.874, val_loss=0.887, val_accuracy=0.775, lr=0.01] 63%|██████▎   | 94/150 [43:27<27:35, 29.57s/epoch, loss=0.559, accuracy=0.872, val_loss=0.71, val_accuracy=0.825, lr=0.00316] 63%|██████▎   | 95/150 [43:56<27:02, 29.50s/epoch, loss=0.554, accuracy=0.874, val_loss=0.888, val_accuracy=0.775, lr=0.01]   64%|██████▍   | 96/150 [44:27<26:47, 29.77s/epoch, loss=0.552, accuracy=0.875, val_loss=0.922, val_accuracy=0.758, lr=0.01] 65%|██████▍   | 97/150 [44:56<26:06, 29.56s/epoch, loss=0.553, accuracy=0.876, val_loss=0.719, val_accuracy=0.82, lr=0.01]  65%|██████▌   | 98/150 [45:25<25:34, 29.50s/epoch, loss=0.552, accuracy=0.876, val_loss=0.992, val_accuracy=0.762, lr=0.01] 66%|██████▌   | 99/150 [45:55<25:05, 29.52s/epoch, loss=0.55, accuracy=0.878, val_loss=0.74, val_accuracy=0.817, lr=0.00316] 67%|██████▋   | 100/150 [46:24<24:30, 29.42s/epoch, loss=0.552, accuracy=0.877, val_loss=1.26, val_accuracy=0.693, lr=0.01]  67%|██████▋   | 101/150 [46:53<23:54, 29.28s/epoch, loss=0.554, accuracy=0.878, val_loss=0.852, val_accuracy=0.777, lr=0.01] 68%|██████▊   | 102/150 [47:22<23:28, 29.35s/epoch, loss=0.553, accuracy=0.88, val_loss=0.918, val_accuracy=0.78, lr=0.01]   69%|██████▊   | 103/150 [47:52<23:08, 29.55s/epoch, loss=0.555, accuracy=0.877, val_loss=1.01, val_accuracy=0.736, lr=0.01] 69%|██████▉   | 104/150 [48:21<22:21, 29.16s/epoch, loss=0.551, accuracy=0.88, val_loss=0.872, val_accuracy=0.784, lr=0.00316] 70%|███████   | 105/150 [48:50<22:01, 29.38s/epoch, loss=0.554, accuracy=0.877, val_loss=0.912, val_accuracy=0.766, lr=0.01]   71%|███████   | 106/150 [49:20<21:33, 29.39s/epoch, loss=0.552, accuracy=0.88, val_loss=0.793, val_accuracy=0.805, lr=0.01]  71%|███████▏  | 107/150 [49:49<21:03, 29.38s/epoch, loss=0.55, accuracy=0.881, val_loss=1.48, val_accuracy=0.656, lr=0.01]  72%|███████▏  | 108/150 [50:19<20:34, 29.38s/epoch, loss=0.552, accuracy=0.882, val_loss=0.815, val_accuracy=0.8, lr=0.01] 73%|███████▎  | 109/150 [50:48<20:08, 29.48s/epoch, loss=0.549, accuracy=0.883, val_loss=0.867, val_accuracy=0.797, lr=0.00316] 73%|███████▎  | 110/150 [51:17<19:34, 29.37s/epoch, loss=0.549, accuracy=0.884, val_loss=1.26, val_accuracy=0.709, lr=0.01]     74%|███████▍  | 111/150 [51:47<19:03, 29.32s/epoch, loss=0.548, accuracy=0.884, val_loss=0.998, val_accuracy=0.737, lr=0.01] 75%|███████▍  | 112/150 [52:16<18:36, 29.37s/epoch, loss=0.548, accuracy=0.885, val_loss=0.994, val_accuracy=0.757, lr=0.01] 75%|███████▌  | 113/150 [52:45<17:58, 29.16s/epoch, loss=0.552, accuracy=0.883, val_loss=1.03, val_accuracy=0.756, lr=0.01]  76%|███████▌  | 114/150 [53:15<17:35, 29.31s/epoch, loss=0.557, accuracy=0.883, val_loss=1.17, val_accuracy=0.724, lr=0.00316] 77%|███████▋  | 115/150 [53:43<16:56, 29.04s/epoch, loss=0.55, accuracy=0.885, val_loss=0.893, val_accuracy=0.78, lr=0.01]     77%|███████▋  | 116/150 [54:12<16:26, 29.02s/epoch, loss=0.548, accuracy=0.885, val_loss=0.837, val_accuracy=0.787, lr=0.01] 78%|███████▊  | 117/150 [54:41<15:56, 28.98s/epoch, loss=0.552, accuracy=0.883, val_loss=1.21, val_accuracy=0.726, lr=0.01]  79%|███████▊  | 118/150 [55:11<15:34, 29.21s/epoch, loss=0.552, accuracy=0.885, val_loss=1.43, val_accuracy=0.678, lr=0.01] 79%|███████▉  | 119/150 [55:39<14:58, 28.97s/epoch, loss=0.551, accuracy=0.885, val_loss=0.736, val_accuracy=0.826, lr=0.00316] 80%|████████  | 120/150 [56:09<14:37, 29.24s/epoch, loss=0.552, accuracy=0.884, val_loss=0.828, val_accuracy=0.797, lr=0.01]    81%|████████  | 121/150 [56:38<14:10, 29.33s/epoch, loss=0.552, accuracy=0.883, val_loss=0.89, val_accuracy=0.782, lr=0.01]  81%|████████▏ | 122/150 [57:07<13:35, 29.11s/epoch, loss=0.476, accuracy=0.912, val_loss=0.531, val_accuracy=0.893, lr=0.001] 82%|████████▏ | 123/150 [57:36<13:08, 29.22s/epoch, loss=0.424, accuracy=0.928, val_loss=0.514, val_accuracy=0.897, lr=0.001] 83%|████████▎ | 124/150 [58:05<12:38, 29.18s/epoch, loss=0.404, accuracy=0.932, val_loss=0.502, val_accuracy=0.899, lr=0.001] 83%|████████▎ | 125/150 [58:35<12:10, 29.23s/epoch, loss=0.386, accuracy=0.937, val_loss=0.499, val_accuracy=0.899, lr=0.001] 84%|████████▍ | 126/150 [59:05<11:46, 29.42s/epoch, loss=0.374, accuracy=0.939, val_loss=0.487, val_accuracy=0.901, lr=0.001] 85%|████████▍ | 127/150 [59:34<11:18, 29.51s/epoch, loss=0.359, accuracy=0.943, val_loss=0.486, val_accuracy=0.899, lr=0.001] 85%|████████▌ | 128/150 [1:00:04<10:50, 29.59s/epoch, loss=0.346, accuracy=0.946, val_loss=0.483, val_accuracy=0.9, lr=0.001] 86%|████████▌ | 129/150 [1:00:33<10:15, 29.30s/epoch, loss=0.337, accuracy=0.947, val_loss=0.477, val_accuracy=0.902, lr=0.001] 87%|████████▋ | 130/150 [1:01:02<09:45, 29.28s/epoch, loss=0.327, accuracy=0.949, val_loss=0.477, val_accuracy=0.902, lr=0.001] 87%|████████▋ | 131/150 [1:01:31<09:16, 29.31s/epoch, loss=0.319, accuracy=0.949, val_loss=0.476, val_accuracy=0.899, lr=0.001] 88%|████████▊ | 132/150 [1:02:01<08:47, 29.31s/epoch, loss=0.312, accuracy=0.95, val_loss=0.471, val_accuracy=0.899, lr=0.001]  89%|████████▊ | 133/150 [1:02:30<08:17, 29.28s/epoch, loss=0.304, accuracy=0.952, val_loss=0.467, val_accuracy=0.9, lr=0.001]  89%|████████▉ | 134/150 [1:03:00<07:50, 29.40s/epoch, loss=0.297, accuracy=0.953, val_loss=0.463, val_accuracy=0.897, lr=0.001] 90%|█████████ | 135/150 [1:03:30<07:24, 29.65s/epoch, loss=0.292, accuracy=0.954, val_loss=0.467, val_accuracy=0.896, lr=0.001] 91%|█████████ | 136/150 [1:04:00<06:55, 29.67s/epoch, loss=0.285, accuracy=0.954, val_loss=0.463, val_accuracy=0.899, lr=0.001] 91%|█████████▏| 137/150 [1:04:29<06:23, 29.49s/epoch, loss=0.278, accuracy=0.955, val_loss=0.461, val_accuracy=0.901, lr=0.001] 92%|█████████▏| 138/150 [1:04:58<05:52, 29.34s/epoch, loss=0.273, accuracy=0.956, val_loss=0.466, val_accuracy=0.9, lr=0.001]   93%|█████████▎| 139/150 [1:05:28<05:24, 29.50s/epoch, loss=0.268, accuracy=0.957, val_loss=0.473, val_accuracy=0.895, lr=0.001] 93%|█████████▎| 140/150 [1:05:57<04:54, 29.45s/epoch, loss=0.261, accuracy=0.959, val_loss=0.462, val_accuracy=0.901, lr=0.001] 94%|█████████▍| 141/150 [1:06:26<04:23, 29.24s/epoch, loss=0.259, accuracy=0.958, val_loss=0.465, val_accuracy=0.897, lr=0.001] 95%|█████████▍| 142/150 [1:06:55<03:55, 29.40s/epoch, loss=0.254, accuracy=0.959, val_loss=0.474, val_accuracy=0.895, lr=0.000316] 95%|█████████▌| 143/150 [1:07:25<03:27, 29.62s/epoch, loss=0.249, accuracy=0.96, val_loss=0.458, val_accuracy=0.896, lr=0.001]     96%|█████████▌| 144/150 [1:07:56<02:58, 29.76s/epoch, loss=0.247, accuracy=0.96, val_loss=0.491, val_accuracy=0.892, lr=0.001] 97%|█████████▋| 145/150 [1:08:25<02:28, 29.70s/epoch, loss=0.242, accuracy=0.96, val_loss=0.485, val_accuracy=0.891, lr=0.001] 97%|█████████▋| 146/150 [1:08:54<01:58, 29.59s/epoch, loss=0.241, accuracy=0.96, val_loss=0.483, val_accuracy=0.892, lr=0.001] 98%|█████████▊| 147/150 [1:09:24<01:28, 29.46s/epoch, loss=0.237, accuracy=0.96, val_loss=0.469, val_accuracy=0.891, lr=0.001] 99%|█████████▊| 148/150 [1:09:53<00:58, 29.46s/epoch, loss=0.233, accuracy=0.961, val_loss=0.471, val_accuracy=0.892, lr=0.000316] 99%|█████████▉| 149/150 [1:10:22<00:29, 29.35s/epoch, loss=0.232, accuracy=0.961, val_loss=0.473, val_accuracy=0.897, lr=0.001]   100%|██████████| 150/150 [1:10:52<00:00, 29.46s/epoch, loss=0.23, accuracy=0.962, val_loss=0.472, val_accuracy=0.892, lr=0.001] 100%|██████████| 150/150 [1:10:52<00:00, 28.35s/epoch, loss=0.23, accuracy=0.962, val_loss=0.472, val_accuracy=0.892, lr=0.001]
Using real-time data augmentation.
Test loss: 0.47168487310409546
Test accuracy: 0.891700029373169


* * * Run SGD for ID = 10_2. * * *


2024-02-15 12:21:34.068798: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 12:21:36.875064: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 12:21:36.876313: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-15 12:21:36.916682: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 12:21:36.916727: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 12:21:36.920328: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 12:21:36.920403: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 12:21:36.923320: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 12:21:36.924159: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 12:21:36.927179: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 12:21:36.929082: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 12:21:36.934793: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 12:21:36.935589: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 12:21:36.935691: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 12:21:38.182450: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-15 12:21:38.183136: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 12:21:38.183692: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 12:21:38.183729: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 12:21:38.183769: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 12:21:38.183787: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 12:21:38.183803: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 12:21:38.183820: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 12:21:38.183837: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 12:21:38.183854: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 12:21:38.183879: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 12:21:38.184498: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 12:21:38.184541: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 12:21:38.841613: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-15 12:21:38.841700: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-15 12:21:38.841712: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-15 12:21:38.843601: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:3b:00.0, compute capability: 6.1)
{'id': 102, 'batch_size': 128, 'epochs': 150, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/150 [00:00<?, ?epoch/s]2024-02-15 12:21:39.628681: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-15 12:21:39.640755: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-02-15 12:21:41.669278: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 12:21:41.977634: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 12:21:42.976712: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-15 12:21:43.036280: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/150 [01:20<3:20:39, 80.80s/epoch, loss=3.09, accuracy=0.315, val_loss=2.99, val_accuracy=0.163, lr=0.1]  1%|▏         | 2/150 [01:51<2:06:09, 51.14s/epoch, loss=1.52, accuracy=0.554, val_loss=2.66, val_accuracy=0.411, lr=0.1]  2%|▏         | 3/150 [02:20<1:40:29, 41.01s/epoch, loss=1.31, accuracy=0.652, val_loss=2.36, val_accuracy=0.438, lr=0.1]  3%|▎         | 4/150 [02:50<1:29:20, 36.72s/epoch, loss=1.26, accuracy=0.686, val_loss=1.8, val_accuracy=0.515, lr=0.1]   3%|▎         | 5/150 [03:20<1:22:47, 34.26s/epoch, loss=1.23, accuracy=0.702, val_loss=1.88, val_accuracy=0.49, lr=0.1]  4%|▍         | 6/150 [03:49<1:18:25, 32.68s/epoch, loss=1.22, accuracy=0.711, val_loss=1.58, val_accuracy=0.595, lr=0.1]  5%|▍         | 7/150 [04:20<1:16:02, 31.91s/epoch, loss=1.2, accuracy=0.72, val_loss=2.11, val_accuracy=0.444, lr=0.1]    5%|▌         | 8/150 [04:48<1:12:47, 30.76s/epoch, loss=1.2, accuracy=0.724, val_loss=3.02, val_accuracy=0.429, lr=0.1]  6%|▌         | 9/150 [05:18<1:11:33, 30.45s/epoch, loss=1.19, accuracy=0.732, val_loss=1.67, val_accuracy=0.583, lr=0.1]  7%|▋         | 10/150 [05:48<1:10:45, 30.33s/epoch, loss=1.19, accuracy=0.731, val_loss=2.41, val_accuracy=0.366, lr=0.1]  7%|▋         | 11/150 [06:18<1:09:54, 30.17s/epoch, loss=1.19, accuracy=0.732, val_loss=1.58, val_accuracy=0.583, lr=0.0316]  8%|▊         | 12/150 [06:47<1:09:13, 30.10s/epoch, loss=1.18, accuracy=0.739, val_loss=1.56, val_accuracy=0.622, lr=0.1]     9%|▊         | 13/150 [07:17<1:08:35, 30.04s/epoch, loss=1.17, accuracy=0.74, val_loss=2.41, val_accuracy=0.474, lr=0.1]   9%|▉         | 14/150 [07:47<1:07:47, 29.91s/epoch, loss=1.17, accuracy=0.741, val_loss=1.87, val_accuracy=0.539, lr=0.1] 10%|█         | 15/150 [08:17<1:07:32, 30.02s/epoch, loss=1.18, accuracy=0.737, val_loss=2.25, val_accuracy=0.417, lr=0.1] 11%|█         | 16/150 [08:47<1:07:08, 30.06s/epoch, loss=1.17, accuracy=0.74, val_loss=2.32, val_accuracy=0.517, lr=0.1]  11%|█▏        | 17/150 [09:17<1:06:31, 30.01s/epoch, loss=1.16, accuracy=0.743, val_loss=1.88, val_accuracy=0.544, lr=0.0316] 12%|█▏        | 18/150 [09:46<1:04:53, 29.49s/epoch, loss=1.16, accuracy=0.746, val_loss=2.14, val_accuracy=0.457, lr=0.1]    13%|█▎        | 19/150 [10:15<1:04:32, 29.56s/epoch, loss=1.16, accuracy=0.748, val_loss=1.88, val_accuracy=0.548, lr=0.1] 13%|█▎        | 20/150 [10:46<1:04:30, 29.78s/epoch, loss=1.16, accuracy=0.746, val_loss=2.04, val_accuracy=0.492, lr=0.1] 14%|█▍        | 21/150 [11:15<1:03:57, 29.75s/epoch, loss=1.17, accuracy=0.745, val_loss=1.4, val_accuracy=0.666, lr=0.1]  15%|█▍        | 22/150 [11:45<1:03:30, 29.77s/epoch, loss=1.15, accuracy=0.746, val_loss=1.51, val_accuracy=0.631, lr=0.1] 15%|█▌        | 23/150 [12:15<1:03:23, 29.95s/epoch, loss=1.16, accuracy=0.747, val_loss=1.63, val_accuracy=0.591, lr=0.1] 16%|█▌        | 24/150 [12:45<1:02:42, 29.86s/epoch, loss=1.15, accuracy=0.747, val_loss=1.86, val_accuracy=0.522, lr=0.1] 17%|█▋        | 25/150 [13:15<1:02:04, 29.79s/epoch, loss=1.15, accuracy=0.748, val_loss=1.85, val_accuracy=0.55, lr=0.1]  17%|█▋        | 26/150 [13:45<1:01:50, 29.92s/epoch, loss=1.15, accuracy=0.746, val_loss=1.9, val_accuracy=0.552, lr=0.0316] 18%|█▊        | 27/150 [14:15<1:01:33, 30.03s/epoch, loss=1.15, accuracy=0.749, val_loss=2.47, val_accuracy=0.439, lr=0.1]   19%|█▊        | 28/150 [14:45<1:01:01, 30.02s/epoch, loss=1.15, accuracy=0.751, val_loss=1.85, val_accuracy=0.576, lr=0.1] 19%|█▉        | 29/150 [15:14<59:57, 29.73s/epoch, loss=1.15, accuracy=0.75, val_loss=2.57, val_accuracy=0.468, lr=0.1]    20%|██        | 30/150 [15:44<59:38, 29.82s/epoch, loss=1.15, accuracy=0.75, val_loss=2.58, val_accuracy=0.416, lr=0.1] 21%|██        | 31/150 [16:14<59:17, 29.89s/epoch, loss=1.15, accuracy=0.75, val_loss=1.86, val_accuracy=0.526, lr=0.0316] 21%|██▏       | 32/150 [16:43<57:51, 29.42s/epoch, loss=1.15, accuracy=0.75, val_loss=1.61, val_accuracy=0.612, lr=0.1]    22%|██▏       | 33/150 [17:13<57:38, 29.56s/epoch, loss=1.14, accuracy=0.752, val_loss=2.63, val_accuracy=0.404, lr=0.1] 23%|██▎       | 34/150 [17:43<57:37, 29.80s/epoch, loss=1.14, accuracy=0.753, val_loss=1.69, val_accuracy=0.585, lr=0.1] 23%|██▎       | 35/150 [18:12<56:52, 29.67s/epoch, loss=1.13, accuracy=0.751, val_loss=3.68, val_accuracy=0.317, lr=0.1] 24%|██▍       | 36/150 [18:42<56:38, 29.81s/epoch, loss=1.13, accuracy=0.756, val_loss=2.57, val_accuracy=0.443, lr=0.0316] 25%|██▍       | 37/150 [19:12<56:01, 29.75s/epoch, loss=1.14, accuracy=0.752, val_loss=1.48, val_accuracy=0.632, lr=0.1]    25%|██▌       | 38/150 [19:41<55:04, 29.51s/epoch, loss=1.13, accuracy=0.755, val_loss=1.56, val_accuracy=0.614, lr=0.1] 26%|██▌       | 39/150 [20:11<54:44, 29.59s/epoch, loss=1.13, accuracy=0.751, val_loss=1.9, val_accuracy=0.558, lr=0.1]  27%|██▋       | 40/150 [20:41<54:36, 29.79s/epoch, loss=1.13, accuracy=0.755, val_loss=1.67, val_accuracy=0.598, lr=0.1] 27%|██▋       | 41/150 [21:11<54:05, 29.78s/epoch, loss=1.13, accuracy=0.751, val_loss=1.56, val_accuracy=0.613, lr=0.0316] 28%|██▊       | 42/150 [21:40<53:19, 29.63s/epoch, loss=1.12, accuracy=0.755, val_loss=2.26, val_accuracy=0.474, lr=0.1]    29%|██▊       | 43/150 [22:10<52:55, 29.68s/epoch, loss=1.12, accuracy=0.754, val_loss=1.97, val_accuracy=0.497, lr=0.1] 29%|██▉       | 44/150 [22:40<52:34, 29.76s/epoch, loss=1.12, accuracy=0.755, val_loss=2.61, val_accuracy=0.299, lr=0.1] 30%|███       | 45/150 [23:09<51:52, 29.64s/epoch, loss=1.13, accuracy=0.753, val_loss=2.04, val_accuracy=0.522, lr=0.1] 31%|███       | 46/150 [23:39<51:12, 29.55s/epoch, loss=1.12, accuracy=0.758, val_loss=1.7, val_accuracy=0.561, lr=0.0316] 31%|███▏      | 47/150 [24:07<50:07, 29.19s/epoch, loss=1.12, accuracy=0.757, val_loss=1.85, val_accuracy=0.516, lr=0.1]   32%|███▏      | 48/150 [24:36<49:34, 29.16s/epoch, loss=1.12, accuracy=0.758, val_loss=2.23, val_accuracy=0.411, lr=0.1] 33%|███▎      | 49/150 [25:06<49:30, 29.41s/epoch, loss=1.12, accuracy=0.758, val_loss=1.89, val_accuracy=0.515, lr=0.1] 33%|███▎      | 50/150 [25:36<49:27, 29.67s/epoch, loss=1.12, accuracy=0.758, val_loss=2.27, val_accuracy=0.452, lr=0.1] 34%|███▍      | 51/150 [26:06<49:00, 29.71s/epoch, loss=1.12, accuracy=0.756, val_loss=1.59, val_accuracy=0.608, lr=0.0316] 35%|███▍      | 52/150 [26:36<48:33, 29.73s/epoch, loss=1.1, accuracy=0.759, val_loss=2.75, val_accuracy=0.376, lr=0.1]     35%|███▌      | 53/150 [27:06<48:19, 29.90s/epoch, loss=1.11, accuracy=0.754, val_loss=2.12, val_accuracy=0.448, lr=0.1] 36%|███▌      | 54/150 [27:36<48:02, 30.03s/epoch, loss=1.12, accuracy=0.758, val_loss=2.03, val_accuracy=0.516, lr=0.1] 37%|███▋      | 55/150 [28:06<47:18, 29.88s/epoch, loss=1.12, accuracy=0.757, val_loss=1.81, val_accuracy=0.545, lr=0.1] 37%|███▋      | 56/150 [28:35<46:27, 29.65s/epoch, loss=1.12, accuracy=0.755, val_loss=1.73, val_accuracy=0.61, lr=0.0316] 38%|███▊      | 57/150 [29:04<45:36, 29.43s/epoch, loss=1.11, accuracy=0.759, val_loss=2.31, val_accuracy=0.492, lr=0.1]   39%|███▊      | 58/150 [29:34<45:20, 29.57s/epoch, loss=1.11, accuracy=0.756, val_loss=2.58, val_accuracy=0.438, lr=0.1] 39%|███▉      | 59/150 [30:03<44:39, 29.45s/epoch, loss=1.11, accuracy=0.757, val_loss=2.73, val_accuracy=0.481, lr=0.1] 40%|████      | 60/150 [30:33<44:29, 29.67s/epoch, loss=1.11, accuracy=0.76, val_loss=1.81, val_accuracy=0.55, lr=0.1]   41%|████      | 61/150 [31:03<44:14, 29.83s/epoch, loss=1.11, accuracy=0.757, val_loss=2.11, val_accuracy=0.516, lr=0.0316] 41%|████▏     | 62/150 [31:32<43:01, 29.33s/epoch, loss=1.11, accuracy=0.756, val_loss=11.1, val_accuracy=0.164, lr=0.1]    42%|████▏     | 63/150 [31:59<41:52, 28.88s/epoch, loss=1.11, accuracy=0.756, val_loss=2.18, val_accuracy=0.473, lr=0.1] 43%|████▎     | 64/150 [32:29<41:47, 29.16s/epoch, loss=1.11, accuracy=0.755, val_loss=3.94, val_accuracy=0.252, lr=0.1] 43%|████▎     | 65/150 [32:59<41:37, 29.38s/epoch, loss=1.11, accuracy=0.756, val_loss=2.71, val_accuracy=0.374, lr=0.1] 44%|████▍     | 66/150 [33:29<41:28, 29.62s/epoch, loss=1.11, accuracy=0.758, val_loss=2.3, val_accuracy=0.454, lr=0.0316] 45%|████▍     | 67/150 [33:59<41:06, 29.72s/epoch, loss=1.11, accuracy=0.758, val_loss=1.75, val_accuracy=0.544, lr=0.1]   45%|████▌     | 68/150 [34:28<40:19, 29.50s/epoch, loss=1.1, accuracy=0.758, val_loss=1.83, val_accuracy=0.481, lr=0.1]  46%|████▌     | 69/150 [34:58<39:59, 29.63s/epoch, loss=1.1, accuracy=0.759, val_loss=2.01, val_accuracy=0.46, lr=0.1]  47%|████▋     | 70/150 [35:28<39:32, 29.66s/epoch, loss=1.11, accuracy=0.757, val_loss=1.62, val_accuracy=0.563, lr=0.1] 47%|████▋     | 71/150 [35:58<39:03, 29.67s/epoch, loss=1.12, accuracy=0.755, val_loss=1.89, val_accuracy=0.516, lr=0.0316] 48%|████▊     | 72/150 [36:27<38:17, 29.46s/epoch, loss=1.11, accuracy=0.761, val_loss=2.52, val_accuracy=0.416, lr=0.1]    49%|████▊     | 73/150 [36:56<37:47, 29.45s/epoch, loss=1.1, accuracy=0.76, val_loss=4.37, val_accuracy=0.332, lr=0.1]   49%|████▉     | 74/150 [37:26<37:27, 29.58s/epoch, loss=1.1, accuracy=0.76, val_loss=2.04, val_accuracy=0.493, lr=0.1] 50%|█████     | 75/150 [37:55<36:55, 29.54s/epoch, loss=1.11, accuracy=0.758, val_loss=2.33, val_accuracy=0.364, lr=0.1] 51%|█████     | 76/150 [38:24<36:11, 29.34s/epoch, loss=1.1, accuracy=0.758, val_loss=2.6, val_accuracy=0.379, lr=0.0316] 51%|█████▏    | 77/150 [38:54<35:55, 29.53s/epoch, loss=1.1, accuracy=0.758, val_loss=1.49, val_accuracy=0.629, lr=0.1]   52%|█████▏    | 78/150 [39:24<35:33, 29.63s/epoch, loss=1.1, accuracy=0.757, val_loss=1.92, val_accuracy=0.528, lr=0.1] 53%|█████▎    | 79/150 [39:54<35:03, 29.63s/epoch, loss=1.11, accuracy=0.758, val_loss=5.11, val_accuracy=0.266, lr=0.1] 53%|█████▎    | 80/150 [40:22<34:09, 29.28s/epoch, loss=1.1, accuracy=0.76, val_loss=2.09, val_accuracy=0.515, lr=0.1]   54%|█████▍    | 81/150 [40:52<33:49, 29.41s/epoch, loss=1.1, accuracy=0.758, val_loss=10.1, val_accuracy=0.139, lr=0.0316] 55%|█████▍    | 82/150 [41:21<33:09, 29.25s/epoch, loss=0.892, accuracy=0.817, val_loss=0.911, val_accuracy=0.795, lr=0.01] 55%|█████▌    | 83/150 [41:51<32:50, 29.41s/epoch, loss=0.721, accuracy=0.847, val_loss=0.771, val_accuracy=0.815, lr=0.01] 56%|█████▌    | 84/150 [42:19<32:08, 29.22s/epoch, loss=0.642, accuracy=0.858, val_loss=0.785, val_accuracy=0.798, lr=0.01] 57%|█████▋    | 85/150 [42:49<31:48, 29.37s/epoch, loss=0.605, accuracy=0.858, val_loss=0.722, val_accuracy=0.812, lr=0.01] 57%|█████▋    | 86/150 [43:18<31:05, 29.15s/epoch, loss=0.578, accuracy=0.861, val_loss=0.703, val_accuracy=0.817, lr=0.01] 58%|█████▊    | 87/150 [43:47<30:47, 29.32s/epoch, loss=0.572, accuracy=0.862, val_loss=0.714, val_accuracy=0.81, lr=0.01]  59%|█████▊    | 88/150 [44:17<30:26, 29.45s/epoch, loss=0.566, accuracy=0.862, val_loss=0.8, val_accuracy=0.796, lr=0.01]  59%|█████▉    | 89/150 [44:46<29:52, 29.38s/epoch, loss=0.56, accuracy=0.865, val_loss=0.843, val_accuracy=0.782, lr=0.01] 60%|██████    | 90/150 [45:15<29:12, 29.21s/epoch, loss=0.563, accuracy=0.864, val_loss=1.04, val_accuracy=0.74, lr=0.01]  61%|██████    | 91/150 [45:44<28:34, 29.06s/epoch, loss=0.558, accuracy=0.866, val_loss=1.07, val_accuracy=0.722, lr=0.00316] 61%|██████▏   | 92/150 [46:14<28:15, 29.23s/epoch, loss=0.556, accuracy=0.868, val_loss=0.758, val_accuracy=0.809, lr=0.01]   62%|██████▏   | 93/150 [46:44<28:02, 29.51s/epoch, loss=0.557, accuracy=0.868, val_loss=1.28, val_accuracy=0.691, lr=0.01]  63%|██████▎   | 94/150 [47:13<27:36, 29.58s/epoch, loss=0.556, accuracy=0.87, val_loss=0.939, val_accuracy=0.753, lr=0.01] 63%|██████▎   | 95/150 [47:43<27:04, 29.53s/epoch, loss=0.554, accuracy=0.871, val_loss=0.763, val_accuracy=0.806, lr=0.01] 64%|██████▍   | 96/150 [48:12<26:21, 29.28s/epoch, loss=0.554, accuracy=0.871, val_loss=1.12, val_accuracy=0.712, lr=0.00316] 65%|██████▍   | 97/150 [48:41<25:58, 29.40s/epoch, loss=0.555, accuracy=0.874, val_loss=0.775, val_accuracy=0.809, lr=0.01]   65%|██████▌   | 98/150 [49:11<25:33, 29.48s/epoch, loss=0.554, accuracy=0.874, val_loss=1.18, val_accuracy=0.683, lr=0.01]  66%|██████▌   | 99/150 [49:41<25:05, 29.52s/epoch, loss=0.555, accuracy=0.874, val_loss=0.793, val_accuracy=0.795, lr=0.01] 67%|██████▋   | 100/150 [50:10<24:33, 29.47s/epoch, loss=0.547, accuracy=0.878, val_loss=1.49, val_accuracy=0.633, lr=0.01] 67%|██████▋   | 101/150 [50:40<24:08, 29.57s/epoch, loss=0.556, accuracy=0.874, val_loss=0.889, val_accuracy=0.78, lr=0.00316] 68%|██████▊   | 102/150 [51:09<23:41, 29.61s/epoch, loss=0.55, accuracy=0.878, val_loss=0.891, val_accuracy=0.772, lr=0.01]    69%|██████▊   | 103/150 [51:39<23:14, 29.67s/epoch, loss=0.549, accuracy=0.879, val_loss=0.911, val_accuracy=0.763, lr=0.01] 69%|██████▉   | 104/150 [52:08<22:32, 29.41s/epoch, loss=0.552, accuracy=0.878, val_loss=1.16, val_accuracy=0.714, lr=0.01]  70%|███████   | 105/150 [52:37<22:00, 29.35s/epoch, loss=0.551, accuracy=0.878, val_loss=1.02, val_accuracy=0.728, lr=0.01] 71%|███████   | 106/150 [53:06<21:17, 29.04s/epoch, loss=0.553, accuracy=0.878, val_loss=1.1, val_accuracy=0.735, lr=0.00316] 71%|███████▏  | 107/150 [53:35<20:53, 29.15s/epoch, loss=0.55, accuracy=0.882, val_loss=0.808, val_accuracy=0.812, lr=0.01]   72%|███████▏  | 108/150 [54:04<20:27, 29.23s/epoch, loss=0.552, accuracy=0.881, val_loss=0.839, val_accuracy=0.802, lr=0.01] 73%|███████▎  | 109/150 [54:34<20:00, 29.29s/epoch, loss=0.551, accuracy=0.881, val_loss=0.886, val_accuracy=0.782, lr=0.01] 73%|███████▎  | 110/150 [55:03<19:36, 29.41s/epoch, loss=0.551, accuracy=0.881, val_loss=0.887, val_accuracy=0.772, lr=0.01] 74%|███████▍  | 111/150 [55:31<18:48, 28.94s/epoch, loss=0.547, accuracy=0.883, val_loss=0.751, val_accuracy=0.81, lr=0.00316] 75%|███████▍  | 112/150 [56:00<18:18, 28.90s/epoch, loss=0.545, accuracy=0.885, val_loss=0.94, val_accuracy=0.762, lr=0.01]    75%|███████▌  | 113/150 [56:28<17:40, 28.67s/epoch, loss=0.55, accuracy=0.882, val_loss=0.88, val_accuracy=0.789, lr=0.01]  76%|███████▌  | 114/150 [56:57<17:11, 28.65s/epoch, loss=0.55, accuracy=0.882, val_loss=1.07, val_accuracy=0.75, lr=0.01]  77%|███████▋  | 115/150 [57:27<16:53, 28.97s/epoch, loss=0.55, accuracy=0.883, val_loss=0.889, val_accuracy=0.783, lr=0.01] 77%|███████▋  | 116/150 [57:56<16:29, 29.10s/epoch, loss=0.549, accuracy=0.883, val_loss=0.833, val_accuracy=0.804, lr=0.00316] 78%|███████▊  | 117/150 [58:26<16:05, 29.27s/epoch, loss=0.548, accuracy=0.885, val_loss=0.873, val_accuracy=0.8, lr=0.01]      79%|███████▊  | 118/150 [58:55<15:40, 29.38s/epoch, loss=0.549, accuracy=0.885, val_loss=0.777, val_accuracy=0.815, lr=0.01] 79%|███████▉  | 119/150 [59:25<15:14, 29.49s/epoch, loss=0.543, accuracy=0.886, val_loss=0.878, val_accuracy=0.805, lr=0.01] 80%|████████  | 120/150 [59:54<14:44, 29.48s/epoch, loss=0.552, accuracy=0.883, val_loss=0.795, val_accuracy=0.808, lr=0.01] 81%|████████  | 121/150 [1:00:24<14:17, 29.55s/epoch, loss=0.55, accuracy=0.885, val_loss=1.11, val_accuracy=0.727, lr=0.00316] 81%|████████▏ | 122/150 [1:00:54<13:48, 29.58s/epoch, loss=0.471, accuracy=0.913, val_loss=0.545, val_accuracy=0.887, lr=0.001] 82%|████████▏ | 123/150 [1:01:23<13:12, 29.36s/epoch, loss=0.418, accuracy=0.929, val_loss=0.509, val_accuracy=0.897, lr=0.001] 83%|████████▎ | 124/150 [1:01:51<12:37, 29.14s/epoch, loss=0.396, accuracy=0.935, val_loss=0.511, val_accuracy=0.896, lr=0.001] 83%|████████▎ | 125/150 [1:02:21<12:14, 29.40s/epoch, loss=0.379, accuracy=0.938, val_loss=0.494, val_accuracy=0.9, lr=0.001]   84%|████████▍ | 126/150 [1:02:51<11:46, 29.42s/epoch, loss=0.365, accuracy=0.941, val_loss=0.49, val_accuracy=0.899, lr=0.001] 85%|████████▍ | 127/150 [1:03:21<11:19, 29.53s/epoch, loss=0.349, accuracy=0.945, val_loss=0.48, val_accuracy=0.902, lr=0.001] 85%|████████▌ | 128/150 [1:03:50<10:46, 29.40s/epoch, loss=0.343, accuracy=0.944, val_loss=0.468, val_accuracy=0.904, lr=0.001] 86%|████████▌ | 129/150 [1:04:19<10:16, 29.38s/epoch, loss=0.331, accuracy=0.948, val_loss=0.469, val_accuracy=0.905, lr=0.001] 87%|████████▋ | 130/150 [1:04:48<09:43, 29.17s/epoch, loss=0.324, accuracy=0.948, val_loss=0.468, val_accuracy=0.903, lr=0.001] 87%|████████▋ | 131/150 [1:05:17<09:17, 29.33s/epoch, loss=0.312, accuracy=0.951, val_loss=0.475, val_accuracy=0.901, lr=0.001] 88%|████████▊ | 132/150 [1:05:47<08:47, 29.30s/epoch, loss=0.305, accuracy=0.951, val_loss=0.468, val_accuracy=0.9, lr=0.001]   89%|████████▊ | 133/150 [1:06:16<08:18, 29.32s/epoch, loss=0.299, accuracy=0.952, val_loss=0.471, val_accuracy=0.899, lr=0.001] 89%|████████▉ | 134/150 [1:06:46<07:51, 29.46s/epoch, loss=0.291, accuracy=0.954, val_loss=0.461, val_accuracy=0.905, lr=0.001] 90%|█████████ | 135/150 [1:07:15<07:22, 29.49s/epoch, loss=0.284, accuracy=0.955, val_loss=0.488, val_accuracy=0.894, lr=0.001] 91%|█████████ | 136/150 [1:07:45<06:53, 29.54s/epoch, loss=0.277, accuracy=0.957, val_loss=0.462, val_accuracy=0.9, lr=0.001]   91%|█████████▏| 137/150 [1:08:14<06:21, 29.31s/epoch, loss=0.272, accuracy=0.956, val_loss=0.468, val_accuracy=0.899, lr=0.001] 92%|█████████▏| 138/150 [1:08:43<05:53, 29.45s/epoch, loss=0.266, accuracy=0.958, val_loss=0.458, val_accuracy=0.901, lr=0.001] 93%|█████████▎| 139/150 [1:09:13<05:25, 29.60s/epoch, loss=0.26, accuracy=0.959, val_loss=0.46, val_accuracy=0.901, lr=0.001]   93%|█████████▎| 140/150 [1:09:43<04:56, 29.64s/epoch, loss=0.258, accuracy=0.958, val_loss=0.461, val_accuracy=0.895, lr=0.001] 94%|█████████▍| 141/150 [1:10:12<04:25, 29.54s/epoch, loss=0.255, accuracy=0.957, val_loss=0.482, val_accuracy=0.89, lr=0.001]  95%|█████████▍| 142/150 [1:10:41<03:54, 29.36s/epoch, loss=0.25, accuracy=0.958, val_loss=0.48, val_accuracy=0.895, lr=0.001]  95%|█████████▌| 143/150 [1:11:11<03:25, 29.38s/epoch, loss=0.242, accuracy=0.96, val_loss=0.45, val_accuracy=0.899, lr=0.001] 96%|█████████▌| 144/150 [1:11:40<02:56, 29.38s/epoch, loss=0.244, accuracy=0.958, val_loss=0.467, val_accuracy=0.896, lr=0.001] 97%|█████████▋| 145/150 [1:12:08<02:24, 28.99s/epoch, loss=0.236, accuracy=0.961, val_loss=0.496, val_accuracy=0.888, lr=0.001] 97%|█████████▋| 146/150 [1:12:38<01:56, 29.05s/epoch, loss=0.236, accuracy=0.961, val_loss=0.52, val_accuracy=0.885, lr=0.001]  98%|█████████▊| 147/150 [1:13:07<01:27, 29.08s/epoch, loss=0.232, accuracy=0.962, val_loss=0.459, val_accuracy=0.896, lr=0.001] 99%|█████████▊| 148/150 [1:13:35<00:57, 28.93s/epoch, loss=0.229, accuracy=0.961, val_loss=0.461, val_accuracy=0.899, lr=0.000316] 99%|█████████▉| 149/150 [1:14:04<00:29, 29.02s/epoch, loss=0.225, accuracy=0.962, val_loss=0.467, val_accuracy=0.899, lr=0.001]   100%|██████████| 150/150 [1:14:34<00:00, 29.10s/epoch, loss=0.227, accuracy=0.96, val_loss=0.532, val_accuracy=0.876, lr=0.001] 100%|██████████| 150/150 [1:14:34<00:00, 29.83s/epoch, loss=0.227, accuracy=0.96, val_loss=0.532, val_accuracy=0.876, lr=0.001]
Using real-time data augmentation.
Test loss: 0.5317405462265015
Test accuracy: 0.8755999803543091


* * * Run SGD for ID = 10_3. * * *


2024-02-15 13:36:16.836021: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 13:36:19.652708: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 13:36:19.654016: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-15 13:36:19.696248: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 13:36:19.696293: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 13:36:19.699849: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 13:36:19.699919: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 13:36:19.702594: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 13:36:19.703359: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 13:36:19.706322: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 13:36:19.708134: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 13:36:19.713857: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 13:36:19.714546: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 13:36:19.714640: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 13:36:20.978098: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-15 13:36:20.979210: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 13:36:20.979803: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 13:36:20.979844: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 13:36:20.979894: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 13:36:20.979910: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 13:36:20.979925: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 13:36:20.979939: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 13:36:20.979955: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 13:36:20.979969: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 13:36:20.979985: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 13:36:20.980567: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 13:36:20.980614: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 13:36:21.687720: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-15 13:36:21.687811: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-15 13:36:21.687824: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-15 13:36:21.691279: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:3b:00.0, compute capability: 6.1)
{'id': 103, 'batch_size': 128, 'epochs': 150, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/150 [00:00<?, ?epoch/s]2024-02-15 13:36:22.533353: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-15 13:36:22.545750: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-02-15 13:36:24.603740: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 13:36:24.843406: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 13:36:25.844469: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-15 13:36:25.903902: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/150 [01:09<2:53:08, 69.72s/epoch, loss=3.15, accuracy=0.312, val_loss=2.34, val_accuracy=0.248, lr=0.1]  1%|▏         | 2/150 [01:40<1:55:27, 46.81s/epoch, loss=1.57, accuracy=0.529, val_loss=1.82, val_accuracy=0.444, lr=0.1]  2%|▏         | 3/150 [02:10<1:36:17, 39.30s/epoch, loss=1.35, accuracy=0.64, val_loss=1.99, val_accuracy=0.46, lr=0.1]    3%|▎         | 4/150 [02:41<1:27:19, 35.89s/epoch, loss=1.28, accuracy=0.687, val_loss=2.68, val_accuracy=0.365, lr=0.1]  3%|▎         | 5/150 [03:10<1:20:43, 33.40s/epoch, loss=1.26, accuracy=0.699, val_loss=1.86, val_accuracy=0.541, lr=0.1]  4%|▍         | 6/150 [03:40<1:17:45, 32.40s/epoch, loss=1.24, accuracy=0.711, val_loss=2.13, val_accuracy=0.425, lr=0.1]  5%|▍         | 7/150 [04:10<1:14:54, 31.43s/epoch, loss=1.22, accuracy=0.722, val_loss=2.56, val_accuracy=0.4, lr=0.0316]  5%|▌         | 8/150 [04:40<1:13:32, 31.07s/epoch, loss=1.21, accuracy=0.724, val_loss=2, val_accuracy=0.479, lr=0.1]      6%|▌         | 9/150 [05:10<1:12:01, 30.65s/epoch, loss=1.21, accuracy=0.731, val_loss=1.46, val_accuracy=0.645, lr=0.1]  7%|▋         | 10/150 [05:41<1:11:30, 30.64s/epoch, loss=1.21, accuracy=0.73, val_loss=1.61, val_accuracy=0.599, lr=0.1]  7%|▋         | 11/150 [06:11<1:10:57, 30.63s/epoch, loss=1.2, accuracy=0.733, val_loss=1.69, val_accuracy=0.598, lr=0.1]  8%|▊         | 12/150 [06:42<1:10:29, 30.65s/epoch, loss=1.2, accuracy=0.735, val_loss=2.22, val_accuracy=0.418, lr=0.1]  9%|▊         | 13/150 [07:12<1:09:37, 30.49s/epoch, loss=1.2, accuracy=0.738, val_loss=1.57, val_accuracy=0.589, lr=0.1]  9%|▉         | 14/150 [07:42<1:09:02, 30.46s/epoch, loss=1.19, accuracy=0.739, val_loss=2.35, val_accuracy=0.458, lr=0.0316] 10%|█         | 15/150 [08:12<1:07:57, 30.20s/epoch, loss=1.19, accuracy=0.742, val_loss=1.88, val_accuracy=0.552, lr=0.1]    11%|█         | 16/150 [08:42<1:07:29, 30.22s/epoch, loss=1.19, accuracy=0.739, val_loss=2.02, val_accuracy=0.448, lr=0.1] 11%|█▏        | 17/150 [09:12<1:06:57, 30.21s/epoch, loss=1.19, accuracy=0.739, val_loss=1.74, val_accuracy=0.55, lr=0.1]  12%|█▏        | 18/150 [09:43<1:06:40, 30.31s/epoch, loss=1.18, accuracy=0.743, val_loss=1.67, val_accuracy=0.6, lr=0.1]  13%|█▎        | 19/150 [10:13<1:06:10, 30.31s/epoch, loss=1.18, accuracy=0.743, val_loss=1.6, val_accuracy=0.602, lr=0.0316] 13%|█▎        | 20/150 [10:44<1:05:39, 30.30s/epoch, loss=1.17, accuracy=0.746, val_loss=1.95, val_accuracy=0.511, lr=0.1]   14%|█▍        | 21/150 [11:13<1:04:29, 30.00s/epoch, loss=1.16, accuracy=0.747, val_loss=2.94, val_accuracy=0.286, lr=0.1] 15%|█▍        | 22/150 [11:42<1:03:27, 29.75s/epoch, loss=1.17, accuracy=0.748, val_loss=1.9, val_accuracy=0.522, lr=0.1]  15%|█▌        | 23/150 [12:12<1:03:22, 29.94s/epoch, loss=1.17, accuracy=0.749, val_loss=1.78, val_accuracy=0.582, lr=0.1] 16%|█▌        | 24/150 [12:42<1:02:33, 29.79s/epoch, loss=1.16, accuracy=0.748, val_loss=1.85, val_accuracy=0.552, lr=0.0316] 17%|█▋        | 25/150 [13:12<1:02:21, 29.94s/epoch, loss=1.15, accuracy=0.752, val_loss=1.89, val_accuracy=0.504, lr=0.1]    17%|█▋        | 26/150 [13:41<1:01:27, 29.74s/epoch, loss=1.16, accuracy=0.749, val_loss=2.09, val_accuracy=0.523, lr=0.1] 18%|█▊        | 27/150 [14:11<1:01:01, 29.77s/epoch, loss=1.16, accuracy=0.75, val_loss=2.11, val_accuracy=0.426, lr=0.1]  19%|█▊        | 28/150 [14:41<1:00:45, 29.88s/epoch, loss=1.15, accuracy=0.752, val_loss=2.41, val_accuracy=0.506, lr=0.1] 19%|█▉        | 29/150 [15:11<1:00:06, 29.81s/epoch, loss=1.15, accuracy=0.752, val_loss=4.85, val_accuracy=0.192, lr=0.0316] 20%|██        | 30/150 [15:41<59:49, 29.91s/epoch, loss=1.14, accuracy=0.753, val_loss=2.48, val_accuracy=0.396, lr=0.1]      21%|██        | 31/150 [16:11<59:24, 29.96s/epoch, loss=1.14, accuracy=0.754, val_loss=1.88, val_accuracy=0.517, lr=0.1] 21%|██▏       | 32/150 [16:42<59:21, 30.18s/epoch, loss=1.16, accuracy=0.749, val_loss=2.75, val_accuracy=0.41, lr=0.1]  22%|██▏       | 33/150 [17:11<58:23, 29.95s/epoch, loss=1.14, accuracy=0.754, val_loss=2.9, val_accuracy=0.328, lr=0.1] 23%|██▎       | 34/150 [17:42<58:14, 30.12s/epoch, loss=1.15, accuracy=0.753, val_loss=2.35, val_accuracy=0.412, lr=0.0316] 23%|██▎       | 35/150 [18:11<57:25, 29.96s/epoch, loss=1.15, accuracy=0.752, val_loss=1.61, val_accuracy=0.591, lr=0.1]    24%|██▍       | 36/150 [18:42<57:02, 30.02s/epoch, loss=1.14, accuracy=0.753, val_loss=1.71, val_accuracy=0.546, lr=0.1] 25%|██▍       | 37/150 [19:12<56:35, 30.05s/epoch, loss=1.14, accuracy=0.754, val_loss=2.01, val_accuracy=0.512, lr=0.1] 25%|██▌       | 38/150 [19:42<56:08, 30.07s/epoch, loss=1.14, accuracy=0.754, val_loss=3.72, val_accuracy=0.356, lr=0.1] 26%|██▌       | 39/150 [20:12<55:36, 30.06s/epoch, loss=1.14, accuracy=0.756, val_loss=1.83, val_accuracy=0.578, lr=0.0316] 27%|██▋       | 40/150 [20:40<54:12, 29.57s/epoch, loss=1.14, accuracy=0.755, val_loss=2.28, val_accuracy=0.441, lr=0.1]    27%|██▋       | 41/150 [21:10<54:00, 29.73s/epoch, loss=1.14, accuracy=0.755, val_loss=2.49, val_accuracy=0.418, lr=0.1] 28%|██▊       | 42/150 [21:41<53:55, 29.96s/epoch, loss=1.13, accuracy=0.755, val_loss=3.66, val_accuracy=0.3, lr=0.1]   29%|██▊       | 43/150 [22:10<52:59, 29.71s/epoch, loss=1.13, accuracy=0.759, val_loss=1.43, val_accuracy=0.656, lr=0.1] 29%|██▉       | 44/150 [22:40<52:31, 29.73s/epoch, loss=1.14, accuracy=0.755, val_loss=2.13, val_accuracy=0.428, lr=0.1] 30%|███       | 45/150 [23:09<51:53, 29.65s/epoch, loss=1.14, accuracy=0.754, val_loss=1.85, val_accuracy=0.548, lr=0.1] 31%|███       | 46/150 [23:39<51:31, 29.73s/epoch, loss=1.13, accuracy=0.757, val_loss=2.27, val_accuracy=0.381, lr=0.1] 31%|███▏      | 47/150 [24:09<51:13, 29.84s/epoch, loss=1.13, accuracy=0.758, val_loss=4.2, val_accuracy=0.274, lr=0.1]  32%|███▏      | 48/150 [24:39<50:25, 29.67s/epoch, loss=1.13, accuracy=0.756, val_loss=1.56, val_accuracy=0.614, lr=0.0316] 33%|███▎      | 49/150 [25:08<49:38, 29.49s/epoch, loss=1.13, accuracy=0.757, val_loss=1.95, val_accuracy=0.528, lr=0.1]    33%|███▎      | 50/150 [25:38<49:24, 29.64s/epoch, loss=1.13, accuracy=0.757, val_loss=2.76, val_accuracy=0.268, lr=0.1] 34%|███▍      | 51/150 [26:08<49:08, 29.78s/epoch, loss=1.13, accuracy=0.756, val_loss=2.02, val_accuracy=0.48, lr=0.1]  35%|███▍      | 52/150 [26:38<49:05, 30.05s/epoch, loss=1.12, accuracy=0.756, val_loss=2.49, val_accuracy=0.399, lr=0.1] 35%|███▌      | 53/150 [27:09<48:42, 30.13s/epoch, loss=1.12, accuracy=0.757, val_loss=2.14, val_accuracy=0.464, lr=0.0316] 36%|███▌      | 54/150 [27:37<47:31, 29.70s/epoch, loss=1.12, accuracy=0.755, val_loss=1.82, val_accuracy=0.544, lr=0.1]    37%|███▋      | 55/150 [28:07<46:49, 29.57s/epoch, loss=1.12, accuracy=0.756, val_loss=2.55, val_accuracy=0.416, lr=0.1] 37%|███▋      | 56/150 [28:35<45:56, 29.32s/epoch, loss=1.12, accuracy=0.756, val_loss=1.94, val_accuracy=0.479, lr=0.1] 38%|███▊      | 57/150 [29:05<45:28, 29.33s/epoch, loss=1.11, accuracy=0.76, val_loss=4.17, val_accuracy=0.19, lr=0.1]   39%|███▊      | 58/150 [29:35<45:11, 29.47s/epoch, loss=1.12, accuracy=0.757, val_loss=1.81, val_accuracy=0.563, lr=0.0316] 39%|███▉      | 59/150 [30:04<44:38, 29.44s/epoch, loss=1.11, accuracy=0.761, val_loss=2.48, val_accuracy=0.465, lr=0.1]    40%|████      | 60/150 [30:34<44:27, 29.64s/epoch, loss=1.12, accuracy=0.757, val_loss=1.54, val_accuracy=0.611, lr=0.1] 41%|████      | 61/150 [31:04<43:59, 29.66s/epoch, loss=1.12, accuracy=0.757, val_loss=1.53, val_accuracy=0.623, lr=0.1] 41%|████▏     | 62/150 [31:33<43:19, 29.54s/epoch, loss=1.12, accuracy=0.755, val_loss=1.66, val_accuracy=0.584, lr=0.1] 42%|████▏     | 63/150 [32:03<43:02, 29.68s/epoch, loss=1.11, accuracy=0.759, val_loss=1.69, val_accuracy=0.565, lr=0.0316] 43%|████▎     | 64/150 [32:33<42:46, 29.85s/epoch, loss=1.12, accuracy=0.757, val_loss=2.07, val_accuracy=0.509, lr=0.1]    43%|████▎     | 65/150 [33:04<42:29, 29.99s/epoch, loss=1.11, accuracy=0.759, val_loss=3.36, val_accuracy=0.221, lr=0.1] 44%|████▍     | 66/150 [33:33<41:51, 29.90s/epoch, loss=1.13, accuracy=0.755, val_loss=1.74, val_accuracy=0.553, lr=0.1] 45%|████▍     | 67/150 [34:03<41:24, 29.94s/epoch, loss=1.12, accuracy=0.759, val_loss=2.4, val_accuracy=0.473, lr=0.1]  45%|████▌     | 68/150 [34:32<40:23, 29.55s/epoch, loss=1.11, accuracy=0.761, val_loss=2.84, val_accuracy=0.432, lr=0.0316] 46%|████▌     | 69/150 [35:02<40:00, 29.63s/epoch, loss=1.11, accuracy=0.758, val_loss=1.75, val_accuracy=0.586, lr=0.1]    47%|████▋     | 70/150 [35:31<39:12, 29.41s/epoch, loss=1.12, accuracy=0.757, val_loss=1.66, val_accuracy=0.573, lr=0.1] 47%|████▋     | 71/150 [36:00<38:45, 29.43s/epoch, loss=1.11, accuracy=0.76, val_loss=2.95, val_accuracy=0.418, lr=0.1]  48%|████▊     | 72/150 [36:30<38:20, 29.50s/epoch, loss=1.12, accuracy=0.758, val_loss=1.93, val_accuracy=0.519, lr=0.1] 49%|████▊     | 73/150 [37:00<38:11, 29.76s/epoch, loss=1.11, accuracy=0.76, val_loss=1.76, val_accuracy=0.531, lr=0.0316] 49%|████▉     | 74/150 [37:31<37:59, 29.99s/epoch, loss=1.12, accuracy=0.759, val_loss=2.08, val_accuracy=0.472, lr=0.1]   50%|█████     | 75/150 [38:00<37:25, 29.94s/epoch, loss=1.11, accuracy=0.76, val_loss=2.37, val_accuracy=0.435, lr=0.1]  51%|█████     | 76/150 [38:31<37:02, 30.03s/epoch, loss=1.11, accuracy=0.759, val_loss=2.05, val_accuracy=0.487, lr=0.1] 51%|█████▏    | 77/150 [39:00<36:24, 29.93s/epoch, loss=1.12, accuracy=0.759, val_loss=1.53, val_accuracy=0.615, lr=0.1] 52%|█████▏    | 78/150 [39:30<35:48, 29.83s/epoch, loss=1.11, accuracy=0.758, val_loss=3.85, val_accuracy=0.176, lr=0.0316] 53%|█████▎    | 79/150 [40:00<35:24, 29.93s/epoch, loss=1.11, accuracy=0.758, val_loss=2.24, val_accuracy=0.398, lr=0.1]    53%|█████▎    | 80/150 [40:30<34:43, 29.77s/epoch, loss=1.12, accuracy=0.757, val_loss=1.93, val_accuracy=0.56, lr=0.1]  54%|█████▍    | 81/150 [40:58<33:47, 29.38s/epoch, loss=1.11, accuracy=0.76, val_loss=2, val_accuracy=0.484, lr=0.1]    55%|█████▍    | 82/150 [41:28<33:34, 29.63s/epoch, loss=0.896, accuracy=0.82, val_loss=0.853, val_accuracy=0.818, lr=0.01] 55%|█████▌    | 83/150 [41:58<33:05, 29.64s/epoch, loss=0.725, accuracy=0.849, val_loss=0.759, val_accuracy=0.827, lr=0.01] 56%|█████▌    | 84/150 [42:28<32:37, 29.66s/epoch, loss=0.642, accuracy=0.857, val_loss=0.725, val_accuracy=0.824, lr=0.01] 57%|█████▋    | 85/150 [42:56<31:44, 29.30s/epoch, loss=0.601, accuracy=0.861, val_loss=0.704, val_accuracy=0.827, lr=0.01] 57%|█████▋    | 86/150 [43:26<31:27, 29.49s/epoch, loss=0.578, accuracy=0.864, val_loss=0.736, val_accuracy=0.811, lr=0.01] 58%|█████▊    | 87/150 [43:56<31:10, 29.69s/epoch, loss=0.568, accuracy=0.863, val_loss=0.73, val_accuracy=0.804, lr=0.01]  59%|█████▊    | 88/150 [44:27<30:55, 29.93s/epoch, loss=0.563, accuracy=0.864, val_loss=0.993, val_accuracy=0.736, lr=0.01] 59%|█████▉    | 89/150 [44:56<30:22, 29.88s/epoch, loss=0.559, accuracy=0.866, val_loss=0.84, val_accuracy=0.774, lr=0.01]  60%|██████    | 90/150 [45:27<29:59, 29.99s/epoch, loss=0.553, accuracy=0.87, val_loss=0.962, val_accuracy=0.745, lr=0.00316] 61%|██████    | 91/150 [45:57<29:33, 30.05s/epoch, loss=0.552, accuracy=0.87, val_loss=1.07, val_accuracy=0.731, lr=0.01]     61%|██████▏   | 92/150 [46:27<29:04, 30.08s/epoch, loss=0.554, accuracy=0.871, val_loss=0.69, val_accuracy=0.829, lr=0.01] 62%|██████▏   | 93/150 [46:57<28:35, 30.10s/epoch, loss=0.551, accuracy=0.873, val_loss=0.779, val_accuracy=0.804, lr=0.01] 63%|██████▎   | 94/150 [47:28<28:12, 30.23s/epoch, loss=0.548, accuracy=0.874, val_loss=0.892, val_accuracy=0.77, lr=0.01]  63%|██████▎   | 95/150 [47:58<27:38, 30.15s/epoch, loss=0.552, accuracy=0.874, val_loss=1.27, val_accuracy=0.694, lr=0.01] 64%|██████▍   | 96/150 [48:28<27:03, 30.06s/epoch, loss=0.547, accuracy=0.877, val_loss=0.938, val_accuracy=0.757, lr=0.01] 65%|██████▍   | 97/150 [48:58<26:34, 30.09s/epoch, loss=0.549, accuracy=0.877, val_loss=0.757, val_accuracy=0.811, lr=0.00316] 65%|██████▌   | 98/150 [49:27<25:57, 29.95s/epoch, loss=0.548, accuracy=0.876, val_loss=0.773, val_accuracy=0.801, lr=0.01]    66%|██████▌   | 99/150 [49:58<25:34, 30.09s/epoch, loss=0.543, accuracy=0.88, val_loss=0.717, val_accuracy=0.83, lr=0.01]   67%|██████▋   | 100/150 [50:28<25:01, 30.03s/epoch, loss=0.548, accuracy=0.879, val_loss=1.19, val_accuracy=0.696, lr=0.01] 67%|██████▋   | 101/150 [50:56<24:14, 29.69s/epoch, loss=0.541, accuracy=0.881, val_loss=0.788, val_accuracy=0.799, lr=0.01] 68%|██████▊   | 102/150 [51:26<23:43, 29.65s/epoch, loss=0.544, accuracy=0.881, val_loss=1.07, val_accuracy=0.709, lr=0.00316] 69%|██████▊   | 103/150 [51:55<23:06, 29.50s/epoch, loss=0.549, accuracy=0.879, val_loss=0.947, val_accuracy=0.767, lr=0.01]   69%|██████▉   | 104/150 [52:25<22:44, 29.67s/epoch, loss=0.541, accuracy=0.883, val_loss=0.823, val_accuracy=0.803, lr=0.01] 70%|███████   | 105/150 [52:55<22:18, 29.75s/epoch, loss=0.545, accuracy=0.882, val_loss=0.81, val_accuracy=0.801, lr=0.01]  71%|███████   | 106/150 [53:25<21:49, 29.76s/epoch, loss=0.544, accuracy=0.883, val_loss=0.746, val_accuracy=0.815, lr=0.01] 71%|███████▏  | 107/150 [53:55<21:21, 29.81s/epoch, loss=0.545, accuracy=0.884, val_loss=0.785, val_accuracy=0.814, lr=0.00316] 72%|███████▏  | 108/150 [54:24<20:39, 29.51s/epoch, loss=0.543, accuracy=0.884, val_loss=0.786, val_accuracy=0.804, lr=0.01]    73%|███████▎  | 109/150 [54:53<20:09, 29.49s/epoch, loss=0.546, accuracy=0.884, val_loss=1.24, val_accuracy=0.664, lr=0.01]  73%|███████▎  | 110/150 [55:23<19:41, 29.54s/epoch, loss=0.547, accuracy=0.884, val_loss=1.02, val_accuracy=0.755, lr=0.01] 74%|███████▍  | 111/150 [55:52<19:11, 29.54s/epoch, loss=0.539, accuracy=0.887, val_loss=0.811, val_accuracy=0.815, lr=0.01] 75%|███████▍  | 112/150 [56:22<18:47, 29.68s/epoch, loss=0.546, accuracy=0.884, val_loss=0.826, val_accuracy=0.805, lr=0.00316] 75%|███████▌  | 113/150 [56:52<18:18, 29.69s/epoch, loss=0.545, accuracy=0.885, val_loss=0.779, val_accuracy=0.812, lr=0.01]    76%|███████▌  | 114/150 [57:21<17:36, 29.36s/epoch, loss=0.543, accuracy=0.886, val_loss=0.856, val_accuracy=0.788, lr=0.01] 77%|███████▋  | 115/150 [57:51<17:13, 29.52s/epoch, loss=0.544, accuracy=0.887, val_loss=0.939, val_accuracy=0.779, lr=0.01] 77%|███████▋  | 116/150 [58:21<16:48, 29.66s/epoch, loss=0.543, accuracy=0.886, val_loss=0.947, val_accuracy=0.782, lr=0.01] 78%|███████▊  | 117/150 [58:50<16:13, 29.51s/epoch, loss=0.546, accuracy=0.886, val_loss=1.01, val_accuracy=0.75, lr=0.00316] 79%|███████▊  | 118/150 [59:20<15:50, 29.70s/epoch, loss=0.543, accuracy=0.886, val_loss=0.842, val_accuracy=0.804, lr=0.01]  79%|███████▉  | 119/150 [59:50<15:24, 29.83s/epoch, loss=0.544, accuracy=0.888, val_loss=0.72, val_accuracy=0.839, lr=0.01]  80%|████████  | 120/150 [1:00:20<14:54, 29.81s/epoch, loss=0.543, accuracy=0.888, val_loss=0.776, val_accuracy=0.814, lr=0.01] 81%|████████  | 121/150 [1:00:49<14:22, 29.74s/epoch, loss=0.542, accuracy=0.89, val_loss=1.11, val_accuracy=0.719, lr=0.01]   81%|████████▏ | 122/150 [1:01:20<13:56, 29.89s/epoch, loss=0.465, accuracy=0.916, val_loss=0.539, val_accuracy=0.89, lr=0.001] 82%|████████▏ | 123/150 [1:01:50<13:29, 30.00s/epoch, loss=0.415, accuracy=0.931, val_loss=0.525, val_accuracy=0.894, lr=0.001] 83%|████████▎ | 124/150 [1:02:20<13:03, 30.15s/epoch, loss=0.393, accuracy=0.937, val_loss=0.504, val_accuracy=0.897, lr=0.001] 83%|████████▎ | 125/150 [1:02:51<12:35, 30.22s/epoch, loss=0.376, accuracy=0.941, val_loss=0.495, val_accuracy=0.9, lr=0.001]   84%|████████▍ | 126/150 [1:03:20<12:02, 30.09s/epoch, loss=0.362, accuracy=0.944, val_loss=0.486, val_accuracy=0.901, lr=0.001] 85%|████████▍ | 127/150 [1:03:51<11:36, 30.27s/epoch, loss=0.352, accuracy=0.944, val_loss=0.482, val_accuracy=0.899, lr=0.001] 85%|████████▌ | 128/150 [1:04:20<10:56, 29.82s/epoch, loss=0.338, accuracy=0.949, val_loss=0.481, val_accuracy=0.9, lr=0.001]   86%|████████▌ | 129/150 [1:04:49<10:23, 29.68s/epoch, loss=0.329, accuracy=0.949, val_loss=0.476, val_accuracy=0.9, lr=0.001] 87%|████████▋ | 130/150 [1:05:19<09:53, 29.69s/epoch, loss=0.321, accuracy=0.95, val_loss=0.478, val_accuracy=0.901, lr=0.001] 87%|████████▋ | 131/150 [1:05:49<09:26, 29.79s/epoch, loss=0.312, accuracy=0.952, val_loss=0.474, val_accuracy=0.899, lr=0.001] 88%|████████▊ | 132/150 [1:06:19<08:57, 29.85s/epoch, loss=0.307, accuracy=0.953, val_loss=0.469, val_accuracy=0.902, lr=0.001] 89%|████████▊ | 133/150 [1:06:49<08:25, 29.74s/epoch, loss=0.295, accuracy=0.955, val_loss=0.467, val_accuracy=0.9, lr=0.001]   89%|████████▉ | 134/150 [1:07:18<07:56, 29.79s/epoch, loss=0.292, accuracy=0.954, val_loss=0.461, val_accuracy=0.901, lr=0.001] 90%|█████████ | 135/150 [1:07:49<07:28, 29.88s/epoch, loss=0.283, accuracy=0.957, val_loss=0.473, val_accuracy=0.9, lr=0.001]   91%|█████████ | 136/150 [1:08:18<06:58, 29.86s/epoch, loss=0.277, accuracy=0.958, val_loss=0.459, val_accuracy=0.902, lr=0.001] 91%|█████████▏| 137/150 [1:08:49<06:29, 29.97s/epoch, loss=0.272, accuracy=0.958, val_loss=0.464, val_accuracy=0.899, lr=0.001] 92%|█████████▏| 138/150 [1:09:18<05:58, 29.85s/epoch, loss=0.265, accuracy=0.958, val_loss=0.445, val_accuracy=0.902, lr=0.001] 93%|█████████▎| 139/150 [1:09:48<05:27, 29.79s/epoch, loss=0.262, accuracy=0.959, val_loss=0.438, val_accuracy=0.904, lr=0.001] 93%|█████████▎| 140/150 [1:10:17<04:54, 29.49s/epoch, loss=0.254, accuracy=0.961, val_loss=0.442, val_accuracy=0.903, lr=0.001] 94%|█████████▍| 141/150 [1:10:46<04:26, 29.58s/epoch, loss=0.252, accuracy=0.96, val_loss=0.455, val_accuracy=0.9, lr=0.001]    95%|█████████▍| 142/150 [1:11:16<03:57, 29.65s/epoch, loss=0.246, accuracy=0.961, val_loss=0.443, val_accuracy=0.902, lr=0.001] 95%|█████████▌| 143/150 [1:11:46<03:28, 29.82s/epoch, loss=0.241, accuracy=0.963, val_loss=0.443, val_accuracy=0.901, lr=0.001] 96%|█████████▌| 144/150 [1:12:17<02:59, 29.97s/epoch, loss=0.239, accuracy=0.962, val_loss=0.471, val_accuracy=0.896, lr=0.000316] 97%|█████████▋| 145/150 [1:12:47<02:30, 30.05s/epoch, loss=0.234, accuracy=0.963, val_loss=0.474, val_accuracy=0.894, lr=0.001]    97%|█████████▋| 146/150 [1:13:17<02:00, 30.07s/epoch, loss=0.232, accuracy=0.962, val_loss=0.463, val_accuracy=0.895, lr=0.001] 98%|█████████▊| 147/150 [1:13:47<01:30, 30.04s/epoch, loss=0.23, accuracy=0.962, val_loss=0.457, val_accuracy=0.897, lr=0.001]  99%|█████████▊| 148/150 [1:14:17<01:00, 30.03s/epoch, loss=0.226, accuracy=0.963, val_loss=0.483, val_accuracy=0.893, lr=0.001] 99%|█████████▉| 149/150 [1:14:47<00:30, 30.08s/epoch, loss=0.224, accuracy=0.964, val_loss=0.538, val_accuracy=0.88, lr=0.000316]100%|██████████| 150/150 [1:15:18<00:00, 30.21s/epoch, loss=0.224, accuracy=0.962, val_loss=0.461, val_accuracy=0.893, lr=0.001]  100%|██████████| 150/150 [1:15:18<00:00, 30.12s/epoch, loss=0.224, accuracy=0.962, val_loss=0.461, val_accuracy=0.893, lr=0.001]
Using real-time data augmentation.
Test loss: 0.46052730083465576
Test accuracy: 0.8934000134468079


* * * Run SGD for ID = 10_4. * * *


2024-02-15 14:51:43.757016: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 14:51:46.483124: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 14:51:46.484458: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-15 14:51:46.529197: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 14:51:46.529249: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 14:51:46.532509: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 14:51:46.532587: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 14:51:46.534913: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 14:51:46.535681: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 14:51:46.538443: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 14:51:46.540123: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 14:51:46.545278: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 14:51:46.545951: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 14:51:46.546336: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 14:51:47.808360: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-15 14:51:47.809378: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 14:51:47.809898: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 14:51:47.809942: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 14:51:47.809979: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 14:51:47.809994: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 14:51:47.810009: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 14:51:47.810024: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 14:51:47.810038: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 14:51:47.810053: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 14:51:47.810068: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 14:51:47.810631: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 14:51:47.810676: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 14:51:48.465777: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-15 14:51:48.465838: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-15 14:51:48.465848: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-15 14:51:48.466825: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:3b:00.0, compute capability: 6.1)
{'id': 104, 'batch_size': 128, 'epochs': 150, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/150 [00:00<?, ?epoch/s]2024-02-15 14:51:49.268234: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-15 14:51:49.280716: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-02-15 14:51:51.410708: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 14:51:51.687518: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 14:51:52.723785: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-15 14:51:52.782990: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/150 [01:09<2:51:58, 69.25s/epoch, loss=3.39, accuracy=0.254, val_loss=2.63, val_accuracy=0.176, lr=0.1]  1%|▏         | 2/150 [01:38<1:52:24, 45.57s/epoch, loss=1.66, accuracy=0.479, val_loss=2.65, val_accuracy=0.287, lr=0.1]  2%|▏         | 3/150 [02:08<1:34:43, 38.66s/epoch, loss=1.44, accuracy=0.588, val_loss=2.06, val_accuracy=0.38, lr=0.1]   3%|▎         | 4/150 [02:38<1:25:36, 35.18s/epoch, loss=1.32, accuracy=0.651, val_loss=2.01, val_accuracy=0.478, lr=0.1]  3%|▎         | 5/150 [03:08<1:20:19, 33.24s/epoch, loss=1.28, accuracy=0.681, val_loss=2.58, val_accuracy=0.303, lr=0.1]  4%|▍         | 6/150 [03:37<1:16:45, 31.98s/epoch, loss=1.25, accuracy=0.701, val_loss=1.7, val_accuracy=0.548, lr=0.1]   5%|▍         | 7/150 [04:07<1:14:22, 31.20s/epoch, loss=1.24, accuracy=0.712, val_loss=1.66, val_accuracy=0.587, lr=0.1]  5%|▌         | 8/150 [04:36<1:12:24, 30.59s/epoch, loss=1.22, accuracy=0.721, val_loss=2.22, val_accuracy=0.48, lr=0.1]   6%|▌         | 9/150 [05:06<1:11:37, 30.48s/epoch, loss=1.22, accuracy=0.728, val_loss=1.93, val_accuracy=0.553, lr=0.1]  7%|▋         | 10/150 [05:36<1:10:45, 30.33s/epoch, loss=1.21, accuracy=0.726, val_loss=2.63, val_accuracy=0.288, lr=0.1]  7%|▋         | 11/150 [06:07<1:10:09, 30.29s/epoch, loss=1.21, accuracy=0.728, val_loss=2.39, val_accuracy=0.368, lr=0.1]  8%|▊         | 12/150 [06:37<1:09:22, 30.16s/epoch, loss=1.2, accuracy=0.735, val_loss=2.12, val_accuracy=0.436, lr=0.0316]  9%|▊         | 13/150 [07:07<1:08:55, 30.19s/epoch, loss=1.2, accuracy=0.738, val_loss=2.35, val_accuracy=0.46, lr=0.1]      9%|▉         | 14/150 [07:37<1:08:24, 30.18s/epoch, loss=1.2, accuracy=0.739, val_loss=1.65, val_accuracy=0.58, lr=0.1] 10%|█         | 15/150 [08:05<1:06:47, 29.69s/epoch, loss=1.18, accuracy=0.741, val_loss=1.62, val_accuracy=0.598, lr=0.1] 11%|█         | 16/150 [08:36<1:06:40, 29.86s/epoch, loss=1.19, accuracy=0.739, val_loss=1.45, val_accuracy=0.648, lr=0.1] 11%|█▏        | 17/150 [09:06<1:06:34, 30.03s/epoch, loss=1.18, accuracy=0.745, val_loss=1.81, val_accuracy=0.548, lr=0.1] 12%|█▏        | 18/150 [09:36<1:06:12, 30.10s/epoch, loss=1.18, accuracy=0.745, val_loss=1.72, val_accuracy=0.584, lr=0.1] 13%|█▎        | 19/150 [10:07<1:05:56, 30.20s/epoch, loss=1.18, accuracy=0.745, val_loss=1.66, val_accuracy=0.594, lr=0.1] 13%|█▎        | 20/150 [10:36<1:04:47, 29.90s/epoch, loss=1.18, accuracy=0.747, val_loss=1.87, val_accuracy=0.558, lr=0.1] 14%|█▍        | 21/150 [11:06<1:04:17, 29.90s/epoch, loss=1.17, accuracy=0.75, val_loss=2.04, val_accuracy=0.502, lr=0.0316] 15%|█▍        | 22/150 [11:36<1:03:56, 29.97s/epoch, loss=1.18, accuracy=0.75, val_loss=3.02, val_accuracy=0.384, lr=0.1]    15%|█▌        | 23/150 [12:06<1:03:23, 29.95s/epoch, loss=1.18, accuracy=0.748, val_loss=2.76, val_accuracy=0.395, lr=0.1] 16%|█▌        | 24/150 [12:36<1:02:55, 29.96s/epoch, loss=1.17, accuracy=0.75, val_loss=1.73, val_accuracy=0.593, lr=0.1]  17%|█▋        | 25/150 [13:06<1:02:41, 30.09s/epoch, loss=1.17, accuracy=0.747, val_loss=1.7, val_accuracy=0.604, lr=0.1] 17%|█▋        | 26/150 [13:36<1:02:07, 30.06s/epoch, loss=1.17, accuracy=0.75, val_loss=1.78, val_accuracy=0.545, lr=0.0316] 18%|█▊        | 27/150 [14:07<1:01:46, 30.13s/epoch, loss=1.16, accuracy=0.752, val_loss=1.49, val_accuracy=0.643, lr=0.1]   19%|█▊        | 28/150 [14:37<1:01:23, 30.19s/epoch, loss=1.17, accuracy=0.751, val_loss=1.84, val_accuracy=0.546, lr=0.1] 19%|█▉        | 29/150 [15:06<1:00:01, 29.77s/epoch, loss=1.16, accuracy=0.753, val_loss=2.84, val_accuracy=0.416, lr=0.1] 20%|██        | 30/150 [15:36<59:38, 29.82s/epoch, loss=1.16, accuracy=0.751, val_loss=2.13, val_accuracy=0.462, lr=0.1]   21%|██        | 31/150 [16:05<59:01, 29.76s/epoch, loss=1.16, accuracy=0.751, val_loss=1.83, val_accuracy=0.534, lr=0.0316] 21%|██▏       | 32/150 [16:36<58:47, 29.89s/epoch, loss=1.15, accuracy=0.753, val_loss=2.13, val_accuracy=0.532, lr=0.1]    22%|██▏       | 33/150 [17:06<58:38, 30.08s/epoch, loss=1.15, accuracy=0.753, val_loss=2.01, val_accuracy=0.498, lr=0.1] 23%|██▎       | 34/150 [17:36<58:10, 30.09s/epoch, loss=1.15, accuracy=0.755, val_loss=3.57, val_accuracy=0.26, lr=0.1]  23%|██▎       | 35/150 [18:06<57:36, 30.06s/epoch, loss=1.15, accuracy=0.753, val_loss=2.16, val_accuracy=0.488, lr=0.1] 24%|██▍       | 36/150 [18:35<56:09, 29.56s/epoch, loss=1.16, accuracy=0.752, val_loss=3.91, val_accuracy=0.35, lr=0.0316] 25%|██▍       | 37/150 [19:05<56:05, 29.78s/epoch, loss=1.15, accuracy=0.754, val_loss=3.31, val_accuracy=0.38, lr=0.1]    25%|██▌       | 38/150 [19:35<55:59, 29.99s/epoch, loss=1.15, accuracy=0.753, val_loss=1.85, val_accuracy=0.51, lr=0.1] 26%|██▌       | 39/150 [20:06<55:48, 30.17s/epoch, loss=1.15, accuracy=0.754, val_loss=1.66, val_accuracy=0.558, lr=0.1] 27%|██▋       | 40/150 [20:36<55:14, 30.13s/epoch, loss=1.15, accuracy=0.754, val_loss=2.67, val_accuracy=0.438, lr=0.1] 27%|██▋       | 41/150 [21:06<54:31, 30.01s/epoch, loss=1.14, accuracy=0.755, val_loss=1.75, val_accuracy=0.564, lr=0.0316] 28%|██▊       | 42/150 [21:36<54:23, 30.22s/epoch, loss=1.14, accuracy=0.757, val_loss=1.7, val_accuracy=0.594, lr=0.1]     29%|██▊       | 43/150 [22:05<53:06, 29.78s/epoch, loss=1.13, accuracy=0.757, val_loss=1.88, val_accuracy=0.526, lr=0.1] 29%|██▉       | 44/150 [22:35<52:41, 29.82s/epoch, loss=1.14, accuracy=0.758, val_loss=1.82, val_accuracy=0.539, lr=0.1] 30%|███       | 45/150 [23:04<51:49, 29.62s/epoch, loss=1.14, accuracy=0.755, val_loss=3.14, val_accuracy=0.386, lr=0.1] 31%|███       | 46/150 [23:34<51:31, 29.72s/epoch, loss=1.14, accuracy=0.753, val_loss=1.82, val_accuracy=0.571, lr=0.0316] 31%|███▏      | 47/150 [24:04<51:01, 29.72s/epoch, loss=1.13, accuracy=0.756, val_loss=3.16, val_accuracy=0.349, lr=0.1]    32%|███▏      | 48/150 [24:33<50:17, 29.59s/epoch, loss=1.14, accuracy=0.755, val_loss=1.65, val_accuracy=0.563, lr=0.1] 33%|███▎      | 49/150 [25:02<49:33, 29.44s/epoch, loss=1.13, accuracy=0.758, val_loss=2.2, val_accuracy=0.456, lr=0.1]  33%|███▎      | 50/150 [25:31<48:57, 29.38s/epoch, loss=1.13, accuracy=0.757, val_loss=2.22, val_accuracy=0.467, lr=0.1] 34%|███▍      | 51/150 [26:00<48:01, 29.10s/epoch, loss=1.14, accuracy=0.757, val_loss=2.4, val_accuracy=0.417, lr=0.0316] 35%|███▍      | 52/150 [26:31<48:22, 29.62s/epoch, loss=1.12, accuracy=0.759, val_loss=1.99, val_accuracy=0.469, lr=0.1]   35%|███▌      | 53/150 [27:01<48:24, 29.95s/epoch, loss=1.13, accuracy=0.757, val_loss=1.58, val_accuracy=0.583, lr=0.1] 36%|███▌      | 54/150 [27:29<46:54, 29.32s/epoch, loss=1.13, accuracy=0.758, val_loss=1.59, val_accuracy=0.596, lr=0.1] 37%|███▋      | 55/150 [28:00<47:08, 29.77s/epoch, loss=1.14, accuracy=0.757, val_loss=1.98, val_accuracy=0.501, lr=0.1] 37%|███▋      | 56/150 [28:30<46:28, 29.67s/epoch, loss=1.14, accuracy=0.756, val_loss=1.44, val_accuracy=0.638, lr=0.1] 38%|███▊      | 57/150 [29:00<46:16, 29.86s/epoch, loss=1.13, accuracy=0.756, val_loss=2, val_accuracy=0.513, lr=0.1]    39%|███▊      | 58/150 [29:31<46:07, 30.08s/epoch, loss=1.13, accuracy=0.756, val_loss=4.85, val_accuracy=0.273, lr=0.1] 39%|███▉      | 59/150 [30:00<45:14, 29.83s/epoch, loss=1.13, accuracy=0.757, val_loss=2.81, val_accuracy=0.4, lr=0.1]   40%|████      | 60/150 [30:29<44:24, 29.60s/epoch, loss=1.13, accuracy=0.757, val_loss=1.83, val_accuracy=0.594, lr=0.1] 41%|████      | 61/150 [30:58<43:41, 29.45s/epoch, loss=1.13, accuracy=0.757, val_loss=2.38, val_accuracy=0.442, lr=0.0316] 41%|████▏     | 62/150 [31:27<43:10, 29.44s/epoch, loss=1.12, accuracy=0.758, val_loss=1.27, val_accuracy=0.701, lr=0.1]    42%|████▏     | 63/150 [31:56<42:28, 29.30s/epoch, loss=1.12, accuracy=0.756, val_loss=1.74, val_accuracy=0.566, lr=0.1] 43%|████▎     | 64/150 [32:25<41:50, 29.19s/epoch, loss=1.12, accuracy=0.758, val_loss=2.16, val_accuracy=0.526, lr=0.1] 43%|████▎     | 65/150 [32:55<41:24, 29.23s/epoch, loss=1.13, accuracy=0.755, val_loss=2.14, val_accuracy=0.437, lr=0.1] 44%|████▍     | 66/150 [33:24<41:01, 29.30s/epoch, loss=1.13, accuracy=0.757, val_loss=1.56, val_accuracy=0.596, lr=0.1] 45%|████▍     | 67/150 [33:53<40:32, 29.30s/epoch, loss=1.12, accuracy=0.754, val_loss=1.5, val_accuracy=0.618, lr=0.0316] 45%|████▌     | 68/150 [34:24<40:27, 29.61s/epoch, loss=1.11, accuracy=0.76, val_loss=2.06, val_accuracy=0.526, lr=0.1]    46%|████▌     | 69/150 [34:54<40:04, 29.68s/epoch, loss=1.12, accuracy=0.759, val_loss=2.86, val_accuracy=0.413, lr=0.1] 47%|████▋     | 70/150 [35:23<39:38, 29.73s/epoch, loss=1.12, accuracy=0.755, val_loss=2.3, val_accuracy=0.441, lr=0.1]  47%|████▋     | 71/150 [35:54<39:20, 29.89s/epoch, loss=1.12, accuracy=0.758, val_loss=1.67, val_accuracy=0.585, lr=0.1] 48%|████▊     | 72/150 [36:24<38:54, 29.92s/epoch, loss=1.12, accuracy=0.757, val_loss=1.83, val_accuracy=0.578, lr=0.0316] 49%|████▊     | 73/150 [36:54<38:29, 29.99s/epoch, loss=1.12, accuracy=0.758, val_loss=2.38, val_accuracy=0.409, lr=0.1]    49%|████▉     | 74/150 [37:24<38:15, 30.21s/epoch, loss=1.12, accuracy=0.758, val_loss=2.2, val_accuracy=0.493, lr=0.1]  50%|█████     | 75/150 [37:54<37:19, 29.86s/epoch, loss=1.12, accuracy=0.758, val_loss=1.55, val_accuracy=0.591, lr=0.1] 51%|█████     | 76/150 [38:22<36:18, 29.44s/epoch, loss=1.12, accuracy=0.759, val_loss=2.01, val_accuracy=0.506, lr=0.1] 51%|█████▏    | 77/150 [38:50<35:27, 29.15s/epoch, loss=1.11, accuracy=0.76, val_loss=1.75, val_accuracy=0.579, lr=0.0316] 52%|█████▏    | 78/150 [39:20<35:13, 29.35s/epoch, loss=1.12, accuracy=0.759, val_loss=2.24, val_accuracy=0.486, lr=0.1]   53%|█████▎    | 79/150 [39:50<34:53, 29.49s/epoch, loss=1.12, accuracy=0.756, val_loss=1.65, val_accuracy=0.581, lr=0.1] 53%|█████▎    | 80/150 [40:20<34:24, 29.49s/epoch, loss=1.11, accuracy=0.761, val_loss=4.61, val_accuracy=0.191, lr=0.1] 54%|█████▍    | 81/150 [40:49<33:55, 29.50s/epoch, loss=1.12, accuracy=0.756, val_loss=1.68, val_accuracy=0.555, lr=0.1] 55%|█████▍    | 82/150 [41:19<33:27, 29.53s/epoch, loss=0.902, accuracy=0.819, val_loss=0.855, val_accuracy=0.818, lr=0.01] 55%|█████▌    | 83/150 [41:49<33:09, 29.69s/epoch, loss=0.733, accuracy=0.847, val_loss=0.793, val_accuracy=0.808, lr=0.01] 56%|█████▌    | 84/150 [42:19<32:49, 29.84s/epoch, loss=0.65, accuracy=0.856, val_loss=0.761, val_accuracy=0.815, lr=0.01]  57%|█████▋    | 85/150 [42:49<32:22, 29.89s/epoch, loss=0.602, accuracy=0.859, val_loss=0.782, val_accuracy=0.801, lr=0.01] 57%|█████▋    | 86/150 [43:19<31:47, 29.81s/epoch, loss=0.588, accuracy=0.86, val_loss=0.791, val_accuracy=0.788, lr=0.01]  58%|█████▊    | 87/150 [43:46<30:38, 29.18s/epoch, loss=0.577, accuracy=0.86, val_loss=0.84, val_accuracy=0.775, lr=0.01]  59%|█████▊    | 88/150 [44:16<30:11, 29.22s/epoch, loss=0.568, accuracy=0.863, val_loss=0.869, val_accuracy=0.775, lr=0.01] 59%|█████▉    | 89/150 [44:46<30:01, 29.53s/epoch, loss=0.566, accuracy=0.865, val_loss=0.97, val_accuracy=0.731, lr=0.00316] 60%|██████    | 90/150 [45:16<29:39, 29.65s/epoch, loss=0.562, accuracy=0.867, val_loss=0.922, val_accuracy=0.757, lr=0.01]   61%|██████    | 91/150 [45:46<29:17, 29.79s/epoch, loss=0.559, accuracy=0.87, val_loss=0.842, val_accuracy=0.777, lr=0.01]  61%|██████▏   | 92/150 [46:16<28:52, 29.87s/epoch, loss=0.56, accuracy=0.871, val_loss=0.803, val_accuracy=0.797, lr=0.01] 62%|██████▏   | 93/150 [46:46<28:19, 29.82s/epoch, loss=0.557, accuracy=0.871, val_loss=0.825, val_accuracy=0.804, lr=0.01] 63%|██████▎   | 94/150 [47:15<27:36, 29.58s/epoch, loss=0.556, accuracy=0.873, val_loss=0.868, val_accuracy=0.78, lr=0.00316] 63%|██████▎   | 95/150 [47:43<26:52, 29.32s/epoch, loss=0.556, accuracy=0.873, val_loss=0.936, val_accuracy=0.748, lr=0.01]   64%|██████▍   | 96/150 [48:14<26:41, 29.66s/epoch, loss=0.554, accuracy=0.874, val_loss=0.901, val_accuracy=0.773, lr=0.01] 65%|██████▍   | 97/150 [48:43<26:08, 29.60s/epoch, loss=0.553, accuracy=0.876, val_loss=0.844, val_accuracy=0.788, lr=0.01] 65%|██████▌   | 98/150 [49:13<25:46, 29.73s/epoch, loss=0.556, accuracy=0.876, val_loss=1.37, val_accuracy=0.685, lr=0.01]  66%|██████▌   | 99/150 [49:44<25:25, 29.90s/epoch, loss=0.554, accuracy=0.877, val_loss=0.866, val_accuracy=0.786, lr=0.00316] 67%|██████▋   | 100/150 [50:14<24:59, 30.00s/epoch, loss=0.554, accuracy=0.875, val_loss=1.31, val_accuracy=0.697, lr=0.01]    67%|██████▋   | 101/150 [50:44<24:29, 29.99s/epoch, loss=0.556, accuracy=0.877, val_loss=0.815, val_accuracy=0.81, lr=0.01] 68%|██████▊   | 102/150 [51:14<24:04, 30.10s/epoch, loss=0.554, accuracy=0.877, val_loss=0.841, val_accuracy=0.789, lr=0.01] 69%|██████▊   | 103/150 [51:44<23:26, 29.93s/epoch, loss=0.555, accuracy=0.878, val_loss=0.88, val_accuracy=0.773, lr=0.01]  69%|██████▉   | 104/150 [52:12<22:36, 29.49s/epoch, loss=0.551, accuracy=0.88, val_loss=0.894, val_accuracy=0.782, lr=0.00316] 70%|███████   | 105/150 [52:41<21:58, 29.29s/epoch, loss=0.558, accuracy=0.877, val_loss=1.37, val_accuracy=0.66, lr=0.01]     71%|███████   | 106/150 [53:11<21:42, 29.61s/epoch, loss=0.55, accuracy=0.879, val_loss=0.891, val_accuracy=0.766, lr=0.01] 71%|███████▏  | 107/150 [53:39<20:51, 29.11s/epoch, loss=0.552, accuracy=0.879, val_loss=0.822, val_accuracy=0.804, lr=0.01] 72%|███████▏  | 108/150 [54:08<20:21, 29.07s/epoch, loss=0.55, accuracy=0.881, val_loss=0.951, val_accuracy=0.753, lr=0.01]  73%|███████▎  | 109/150 [54:38<20:04, 29.39s/epoch, loss=0.548, accuracy=0.884, val_loss=0.859, val_accuracy=0.789, lr=0.00316] 73%|███████▎  | 110/150 [55:09<19:44, 29.62s/epoch, loss=0.551, accuracy=0.883, val_loss=1, val_accuracy=0.746, lr=0.01]        74%|███████▍  | 111/150 [55:38<19:14, 29.59s/epoch, loss=0.55, accuracy=0.882, val_loss=0.767, val_accuracy=0.813, lr=0.01] 75%|███████▍  | 112/150 [56:08<18:49, 29.71s/epoch, loss=0.548, accuracy=0.884, val_loss=0.817, val_accuracy=0.796, lr=0.01] 75%|███████▌  | 113/150 [56:38<18:26, 29.90s/epoch, loss=0.551, accuracy=0.882, val_loss=0.939, val_accuracy=0.762, lr=0.01] 76%|███████▌  | 114/150 [57:08<17:47, 29.66s/epoch, loss=0.553, accuracy=0.882, val_loss=0.975, val_accuracy=0.758, lr=0.00316] 77%|███████▋  | 115/150 [57:37<17:13, 29.54s/epoch, loss=0.555, accuracy=0.883, val_loss=0.899, val_accuracy=0.77, lr=0.01]     77%|███████▋  | 116/150 [58:06<16:36, 29.32s/epoch, loss=0.549, accuracy=0.884, val_loss=0.685, val_accuracy=0.837, lr=0.01] 78%|███████▊  | 117/150 [58:35<16:05, 29.27s/epoch, loss=0.55, accuracy=0.884, val_loss=0.729, val_accuracy=0.836, lr=0.01]  79%|███████▊  | 118/150 [59:05<15:48, 29.65s/epoch, loss=0.551, accuracy=0.882, val_loss=0.891, val_accuracy=0.788, lr=0.01] 79%|███████▉  | 119/150 [59:35<15:23, 29.79s/epoch, loss=0.549, accuracy=0.885, val_loss=0.878, val_accuracy=0.792, lr=0.01] 80%|████████  | 120/150 [1:00:06<14:58, 29.95s/epoch, loss=0.55, accuracy=0.885, val_loss=0.815, val_accuracy=0.809, lr=0.01] 81%|████████  | 121/150 [1:00:36<14:27, 29.91s/epoch, loss=0.549, accuracy=0.885, val_loss=0.924, val_accuracy=0.771, lr=0.00316] 81%|████████▏ | 122/150 [1:01:05<13:52, 29.73s/epoch, loss=0.479, accuracy=0.909, val_loss=0.541, val_accuracy=0.891, lr=0.001]   82%|████████▏ | 123/150 [1:01:33<13:10, 29.27s/epoch, loss=0.422, accuracy=0.928, val_loss=0.515, val_accuracy=0.897, lr=0.001] 83%|████████▎ | 124/150 [1:02:02<12:40, 29.25s/epoch, loss=0.401, accuracy=0.933, val_loss=0.505, val_accuracy=0.899, lr=0.001] 83%|████████▎ | 125/150 [1:02:33<12:18, 29.55s/epoch, loss=0.383, accuracy=0.938, val_loss=0.502, val_accuracy=0.898, lr=0.001] 84%|████████▍ | 126/150 [1:03:02<11:50, 29.58s/epoch, loss=0.367, accuracy=0.942, val_loss=0.491, val_accuracy=0.902, lr=0.001] 85%|████████▍ | 127/150 [1:03:32<11:22, 29.67s/epoch, loss=0.359, accuracy=0.941, val_loss=0.481, val_accuracy=0.901, lr=0.001] 85%|████████▌ | 128/150 [1:04:00<10:42, 29.19s/epoch, loss=0.347, accuracy=0.945, val_loss=0.472, val_accuracy=0.903, lr=0.001] 86%|████████▌ | 129/150 [1:04:31<10:20, 29.57s/epoch, loss=0.34, accuracy=0.945, val_loss=0.477, val_accuracy=0.903, lr=0.001]  87%|████████▋ | 130/150 [1:04:58<09:40, 29.03s/epoch, loss=0.331, accuracy=0.946, val_loss=0.468, val_accuracy=0.901, lr=0.001] 87%|████████▋ | 131/150 [1:05:28<09:15, 29.21s/epoch, loss=0.319, accuracy=0.949, val_loss=0.479, val_accuracy=0.9, lr=0.001]   88%|████████▊ | 132/150 [1:05:56<08:41, 28.99s/epoch, loss=0.311, accuracy=0.95, val_loss=0.469, val_accuracy=0.902, lr=0.001] 89%|████████▊ | 133/150 [1:06:26<08:14, 29.11s/epoch, loss=0.301, accuracy=0.952, val_loss=0.464, val_accuracy=0.899, lr=0.001] 89%|████████▉ | 134/150 [1:06:56<07:49, 29.37s/epoch, loss=0.295, accuracy=0.954, val_loss=0.453, val_accuracy=0.903, lr=0.001] 90%|█████████ | 135/150 [1:07:24<07:15, 29.03s/epoch, loss=0.289, accuracy=0.953, val_loss=0.46, val_accuracy=0.902, lr=0.001]  91%|█████████ | 136/150 [1:07:55<06:53, 29.50s/epoch, loss=0.284, accuracy=0.954, val_loss=0.457, val_accuracy=0.9, lr=0.001]  91%|█████████▏| 137/150 [1:08:25<06:26, 29.70s/epoch, loss=0.275, accuracy=0.956, val_loss=0.451, val_accuracy=0.899, lr=0.001] 92%|█████████▏| 138/150 [1:08:54<05:56, 29.68s/epoch, loss=0.269, accuracy=0.956, val_loss=0.456, val_accuracy=0.901, lr=0.001] 93%|█████████▎| 139/150 [1:09:25<05:27, 29.79s/epoch, loss=0.265, accuracy=0.957, val_loss=0.476, val_accuracy=0.893, lr=0.001] 93%|█████████▎| 140/150 [1:09:54<04:56, 29.70s/epoch, loss=0.261, accuracy=0.958, val_loss=0.448, val_accuracy=0.9, lr=0.001]   94%|█████████▍| 141/150 [1:10:24<04:28, 29.83s/epoch, loss=0.256, accuracy=0.959, val_loss=0.507, val_accuracy=0.888, lr=0.001] 95%|█████████▍| 142/150 [1:10:52<03:53, 29.21s/epoch, loss=0.251, accuracy=0.959, val_loss=0.459, val_accuracy=0.899, lr=0.001] 95%|█████████▌| 143/150 [1:11:22<03:26, 29.54s/epoch, loss=0.251, accuracy=0.957, val_loss=0.489, val_accuracy=0.887, lr=0.001] 96%|█████████▌| 144/150 [1:11:52<02:57, 29.53s/epoch, loss=0.246, accuracy=0.96, val_loss=0.457, val_accuracy=0.891, lr=0.001]  97%|█████████▋| 145/150 [1:12:20<02:25, 29.15s/epoch, loss=0.244, accuracy=0.958, val_loss=0.453, val_accuracy=0.894, lr=0.000316] 97%|█████████▋| 146/150 [1:12:48<01:55, 28.88s/epoch, loss=0.24, accuracy=0.96, val_loss=0.514, val_accuracy=0.882, lr=0.001]      98%|█████████▊| 147/150 [1:13:18<01:27, 29.17s/epoch, loss=0.237, accuracy=0.96, val_loss=0.448, val_accuracy=0.897, lr=0.001] 99%|█████████▊| 148/150 [1:13:46<00:57, 28.72s/epoch, loss=0.231, accuracy=0.961, val_loss=0.464, val_accuracy=0.895, lr=0.001] 99%|█████████▉| 149/150 [1:14:13<00:28, 28.26s/epoch, loss=0.232, accuracy=0.96, val_loss=0.455, val_accuracy=0.888, lr=0.001] 100%|██████████| 150/150 [1:14:41<00:00, 28.24s/epoch, loss=0.233, accuracy=0.96, val_loss=0.472, val_accuracy=0.888, lr=0.000316]100%|██████████| 150/150 [1:14:41<00:00, 29.88s/epoch, loss=0.233, accuracy=0.96, val_loss=0.472, val_accuracy=0.888, lr=0.000316]
Using real-time data augmentation.
Test loss: 0.47223544120788574
Test accuracy: 0.8881000280380249


* * * Run SGD for ID = 10_5. * * *


2024-02-15 16:06:33.877626: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 16:06:36.875180: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 16:06:36.876720: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-15 16:06:36.917477: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 16:06:36.917530: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 16:06:36.921612: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 16:06:36.921681: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 16:06:36.924472: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 16:06:36.928994: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 16:06:36.932349: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 16:06:36.934162: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 16:06:36.939761: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 16:06:36.940572: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 16:06:36.940979: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 16:06:38.158940: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-15 16:06:38.159645: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 16:06:38.160171: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 16:06:38.160209: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 16:06:38.160246: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 16:06:38.160262: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 16:06:38.160276: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 16:06:38.160291: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 16:06:38.160306: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 16:06:38.160321: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 16:06:38.160336: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 16:06:38.160921: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 16:06:38.160961: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 16:06:38.801544: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-15 16:06:38.801625: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-15 16:06:38.801641: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-15 16:06:38.802657: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:3b:00.0, compute capability: 6.1)
{'id': 105, 'batch_size': 128, 'epochs': 150, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/150 [00:00<?, ?epoch/s]2024-02-15 16:06:39.610732: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-15 16:06:39.622746: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-02-15 16:06:41.809794: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 16:06:42.168515: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 16:06:43.097494: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-15 16:06:43.150341: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/150 [01:11<2:56:32, 71.09s/epoch, loss=3.4, accuracy=0.275, val_loss=2.22, val_accuracy=0.293, lr=0.1]  1%|▏         | 2/150 [01:41<1:56:16, 47.14s/epoch, loss=1.69, accuracy=0.461, val_loss=1.87, val_accuracy=0.415, lr=0.1]  2%|▏         | 3/150 [02:10<1:35:12, 38.86s/epoch, loss=1.48, accuracy=0.565, val_loss=2.48, val_accuracy=0.416, lr=0.1]  3%|▎         | 4/150 [02:40<1:25:43, 35.23s/epoch, loss=1.36, accuracy=0.648, val_loss=3.09, val_accuracy=0.372, lr=0.1]  3%|▎         | 5/150 [03:10<1:20:52, 33.46s/epoch, loss=1.29, accuracy=0.685, val_loss=2.02, val_accuracy=0.478, lr=0.1]  4%|▍         | 6/150 [03:39<1:17:03, 32.11s/epoch, loss=1.27, accuracy=0.702, val_loss=1.58, val_accuracy=0.61, lr=0.1]   5%|▍         | 7/150 [04:08<1:14:02, 31.07s/epoch, loss=1.24, accuracy=0.715, val_loss=2.01, val_accuracy=0.437, lr=0.1]  5%|▌         | 8/150 [04:38<1:12:04, 30.45s/epoch, loss=1.24, accuracy=0.723, val_loss=1.51, val_accuracy=0.635, lr=0.1]  6%|▌         | 9/150 [05:07<1:10:50, 30.14s/epoch, loss=1.23, accuracy=0.727, val_loss=1.46, val_accuracy=0.625, lr=0.1]  7%|▋         | 10/150 [05:35<1:08:34, 29.39s/epoch, loss=1.22, accuracy=0.729, val_loss=1.83, val_accuracy=0.544, lr=0.1]  7%|▋         | 11/150 [06:03<1:07:34, 29.17s/epoch, loss=1.22, accuracy=0.732, val_loss=2.25, val_accuracy=0.496, lr=0.1]  8%|▊         | 12/150 [06:34<1:08:11, 29.65s/epoch, loss=1.21, accuracy=0.736, val_loss=1.84, val_accuracy=0.525, lr=0.1]  9%|▊         | 13/150 [07:04<1:08:01, 29.79s/epoch, loss=1.21, accuracy=0.736, val_loss=1.99, val_accuracy=0.49, lr=0.1]   9%|▉         | 14/150 [07:33<1:06:34, 29.37s/epoch, loss=1.21, accuracy=0.737, val_loss=1.95, val_accuracy=0.493, lr=0.0316] 10%|█         | 15/150 [08:03<1:06:52, 29.73s/epoch, loss=1.2, accuracy=0.739, val_loss=1.82, val_accuracy=0.527, lr=0.1]     11%|█         | 16/150 [08:33<1:06:47, 29.91s/epoch, loss=1.2, accuracy=0.739, val_loss=2.41, val_accuracy=0.504, lr=0.1] 11%|█▏        | 17/150 [09:03<1:05:48, 29.69s/epoch, loss=1.19, accuracy=0.74, val_loss=1.43, val_accuracy=0.667, lr=0.1] 12%|█▏        | 18/150 [09:31<1:04:16, 29.21s/epoch, loss=1.2, accuracy=0.742, val_loss=3.04, val_accuracy=0.314, lr=0.1] 13%|█▎        | 19/150 [10:02<1:04:47, 29.67s/epoch, loss=1.19, accuracy=0.744, val_loss=1.74, val_accuracy=0.579, lr=0.1] 13%|█▎        | 20/150 [10:32<1:04:52, 29.94s/epoch, loss=1.19, accuracy=0.746, val_loss=1.42, val_accuracy=0.661, lr=0.1] 14%|█▍        | 21/150 [11:02<1:04:26, 29.97s/epoch, loss=1.18, accuracy=0.742, val_loss=1.89, val_accuracy=0.516, lr=0.1] 15%|█▍        | 22/150 [11:30<1:02:52, 29.47s/epoch, loss=1.18, accuracy=0.745, val_loss=1.61, val_accuracy=0.58, lr=0.1]  15%|█▌        | 23/150 [12:00<1:02:31, 29.54s/epoch, loss=1.18, accuracy=0.745, val_loss=1.68, val_accuracy=0.587, lr=0.1] 16%|█▌        | 24/150 [12:28<1:00:49, 28.96s/epoch, loss=1.18, accuracy=0.746, val_loss=1.89, val_accuracy=0.519, lr=0.1] 17%|█▋        | 25/150 [12:56<59:49, 28.72s/epoch, loss=1.18, accuracy=0.745, val_loss=1.76, val_accuracy=0.556, lr=0.0316] 17%|█▋        | 26/150 [13:25<59:37, 28.85s/epoch, loss=1.18, accuracy=0.743, val_loss=1.63, val_accuracy=0.603, lr=0.1]    18%|█▊        | 27/150 [13:54<59:10, 28.87s/epoch, loss=1.18, accuracy=0.747, val_loss=1.87, val_accuracy=0.545, lr=0.1] 19%|█▊        | 28/150 [14:23<58:32, 28.79s/epoch, loss=1.17, accuracy=0.747, val_loss=1.94, val_accuracy=0.542, lr=0.1] 19%|█▉        | 29/150 [14:51<58:02, 28.78s/epoch, loss=1.18, accuracy=0.747, val_loss=2.12, val_accuracy=0.463, lr=0.1] 20%|██        | 30/150 [15:20<57:44, 28.87s/epoch, loss=1.17, accuracy=0.746, val_loss=2.43, val_accuracy=0.438, lr=0.0316] 21%|██        | 31/150 [15:49<57:01, 28.76s/epoch, loss=1.17, accuracy=0.746, val_loss=1.82, val_accuracy=0.511, lr=0.1]    21%|██▏       | 32/150 [16:17<56:23, 28.67s/epoch, loss=1.17, accuracy=0.747, val_loss=1.74, val_accuracy=0.578, lr=0.1] 22%|██▏       | 33/150 [16:48<56:49, 29.14s/epoch, loss=1.17, accuracy=0.746, val_loss=2.14, val_accuracy=0.523, lr=0.1] 23%|██▎       | 34/150 [17:18<57:09, 29.57s/epoch, loss=1.17, accuracy=0.752, val_loss=1.45, val_accuracy=0.652, lr=0.1] 23%|██▎       | 35/150 [17:48<56:48, 29.64s/epoch, loss=1.16, accuracy=0.751, val_loss=2.01, val_accuracy=0.477, lr=0.0316] 24%|██▍       | 36/150 [18:17<56:09, 29.55s/epoch, loss=1.16, accuracy=0.751, val_loss=2.51, val_accuracy=0.436, lr=0.1]    25%|██▍       | 37/150 [18:47<55:36, 29.53s/epoch, loss=1.16, accuracy=0.752, val_loss=1.7, val_accuracy=0.568, lr=0.1]  25%|██▌       | 38/150 [19:18<55:49, 29.90s/epoch, loss=1.16, accuracy=0.751, val_loss=2.13, val_accuracy=0.472, lr=0.1] 26%|██▌       | 39/150 [19:47<55:17, 29.88s/epoch, loss=1.16, accuracy=0.751, val_loss=1.99, val_accuracy=0.558, lr=0.1] 27%|██▋       | 40/150 [20:18<55:14, 30.13s/epoch, loss=1.16, accuracy=0.75, val_loss=2.16, val_accuracy=0.423, lr=0.0316] 27%|██▋       | 41/150 [20:49<54:55, 30.24s/epoch, loss=1.16, accuracy=0.75, val_loss=1.85, val_accuracy=0.495, lr=0.1]    28%|██▊       | 42/150 [21:19<54:44, 30.41s/epoch, loss=1.16, accuracy=0.751, val_loss=2.15, val_accuracy=0.538, lr=0.1] 29%|██▊       | 43/150 [21:49<53:56, 30.25s/epoch, loss=1.15, accuracy=0.754, val_loss=1.42, val_accuracy=0.662, lr=0.1] 29%|██▉       | 44/150 [22:20<53:53, 30.50s/epoch, loss=1.15, accuracy=0.752, val_loss=2.68, val_accuracy=0.388, lr=0.1] 30%|███       | 45/150 [22:51<53:30, 30.57s/epoch, loss=1.15, accuracy=0.752, val_loss=1.87, val_accuracy=0.496, lr=0.0316] 31%|███       | 46/150 [23:19<51:23, 29.65s/epoch, loss=1.15, accuracy=0.752, val_loss=1.47, val_accuracy=0.64, lr=0.1]     31%|███▏      | 47/150 [23:47<50:16, 29.29s/epoch, loss=1.16, accuracy=0.75, val_loss=2.16, val_accuracy=0.468, lr=0.1] 32%|███▏      | 48/150 [24:16<49:50, 29.32s/epoch, loss=1.15, accuracy=0.752, val_loss=3.99, val_accuracy=0.306, lr=0.1] 33%|███▎      | 49/150 [24:45<49:12, 29.23s/epoch, loss=1.14, accuracy=0.754, val_loss=2.11, val_accuracy=0.497, lr=0.1] 33%|███▎      | 50/150 [25:13<48:01, 28.82s/epoch, loss=1.15, accuracy=0.75, val_loss=2.09, val_accuracy=0.516, lr=0.0316] 34%|███▍      | 51/150 [25:41<46:47, 28.36s/epoch, loss=1.15, accuracy=0.754, val_loss=1.48, val_accuracy=0.637, lr=0.1]   35%|███▍      | 52/150 [26:10<46:34, 28.52s/epoch, loss=1.15, accuracy=0.75, val_loss=1.68, val_accuracy=0.581, lr=0.1]  35%|███▌      | 53/150 [26:37<45:47, 28.32s/epoch, loss=1.15, accuracy=0.752, val_loss=2.76, val_accuracy=0.308, lr=0.1] 36%|███▌      | 54/150 [27:06<45:16, 28.30s/epoch, loss=1.15, accuracy=0.755, val_loss=2.25, val_accuracy=0.406, lr=0.1] 37%|███▋      | 55/150 [27:33<44:24, 28.05s/epoch, loss=1.15, accuracy=0.753, val_loss=1.56, val_accuracy=0.63, lr=0.0316] 37%|███▋      | 56/150 [28:01<43:58, 28.07s/epoch, loss=1.15, accuracy=0.751, val_loss=1.86, val_accuracy=0.533, lr=0.1]   38%|███▊      | 57/150 [28:29<43:31, 28.08s/epoch, loss=1.15, accuracy=0.753, val_loss=1.94, val_accuracy=0.53, lr=0.1]  39%|███▊      | 58/150 [28:57<43:04, 28.09s/epoch, loss=1.15, accuracy=0.75, val_loss=1.76, val_accuracy=0.527, lr=0.1] 39%|███▉      | 59/150 [29:27<43:09, 28.46s/epoch, loss=1.14, accuracy=0.754, val_loss=2.88, val_accuracy=0.443, lr=0.1] 40%|████      | 60/150 [29:56<42:49, 28.55s/epoch, loss=1.15, accuracy=0.755, val_loss=2.78, val_accuracy=0.387, lr=0.0316] 41%|████      | 61/150 [30:24<42:24, 28.59s/epoch, loss=1.14, accuracy=0.752, val_loss=2.34, val_accuracy=0.39, lr=0.1]     41%|████▏     | 62/150 [30:54<42:40, 29.10s/epoch, loss=1.14, accuracy=0.752, val_loss=2.06, val_accuracy=0.486, lr=0.1] 42%|████▏     | 63/150 [31:25<43:00, 29.67s/epoch, loss=1.15, accuracy=0.755, val_loss=1.85, val_accuracy=0.529, lr=0.1] 43%|████▎     | 64/150 [31:55<42:28, 29.63s/epoch, loss=1.14, accuracy=0.754, val_loss=1.42, val_accuracy=0.664, lr=0.1] 43%|████▎     | 65/150 [32:25<42:15, 29.83s/epoch, loss=1.14, accuracy=0.755, val_loss=3.39, val_accuracy=0.281, lr=0.1] 44%|████▍     | 66/150 [32:56<42:08, 30.10s/epoch, loss=1.15, accuracy=0.752, val_loss=1.96, val_accuracy=0.535, lr=0.1] 45%|████▍     | 67/150 [33:27<41:49, 30.24s/epoch, loss=1.14, accuracy=0.753, val_loss=2.32, val_accuracy=0.495, lr=0.1] 45%|████▌     | 68/150 [33:55<40:41, 29.77s/epoch, loss=1.14, accuracy=0.755, val_loss=2.84, val_accuracy=0.332, lr=0.1] 46%|████▌     | 69/150 [34:24<39:54, 29.57s/epoch, loss=1.14, accuracy=0.754, val_loss=1.81, val_accuracy=0.539, lr=0.0316] 47%|████▋     | 70/150 [34:54<39:26, 29.58s/epoch, loss=1.14, accuracy=0.758, val_loss=2.04, val_accuracy=0.491, lr=0.1]    47%|████▋     | 71/150 [35:24<38:56, 29.57s/epoch, loss=1.14, accuracy=0.757, val_loss=2.08, val_accuracy=0.522, lr=0.1] 48%|████▊     | 72/150 [35:54<38:45, 29.82s/epoch, loss=1.14, accuracy=0.757, val_loss=4.46, val_accuracy=0.236, lr=0.1] 49%|████▊     | 73/150 [36:24<38:22, 29.90s/epoch, loss=1.14, accuracy=0.755, val_loss=2.39, val_accuracy=0.408, lr=0.1] 49%|████▉     | 74/150 [36:54<37:49, 29.86s/epoch, loss=1.14, accuracy=0.755, val_loss=2.01, val_accuracy=0.472, lr=0.0316] 50%|█████     | 75/150 [37:24<37:21, 29.89s/epoch, loss=1.13, accuracy=0.754, val_loss=1.53, val_accuracy=0.619, lr=0.1]    51%|█████     | 76/150 [37:54<36:53, 29.91s/epoch, loss=1.14, accuracy=0.752, val_loss=1.88, val_accuracy=0.543, lr=0.1] 51%|█████▏    | 77/150 [38:25<36:48, 30.25s/epoch, loss=1.13, accuracy=0.755, val_loss=1.71, val_accuracy=0.597, lr=0.1] 52%|█████▏    | 78/150 [38:56<36:44, 30.62s/epoch, loss=1.13, accuracy=0.755, val_loss=3.6, val_accuracy=0.316, lr=0.1]  53%|█████▎    | 79/150 [39:27<36:24, 30.77s/epoch, loss=1.14, accuracy=0.755, val_loss=2.05, val_accuracy=0.53, lr=0.0316] 53%|█████▎    | 80/150 [39:59<36:04, 30.92s/epoch, loss=1.13, accuracy=0.756, val_loss=2.21, val_accuracy=0.497, lr=0.1]   54%|█████▍    | 81/150 [40:29<35:14, 30.64s/epoch, loss=1.14, accuracy=0.755, val_loss=3, val_accuracy=0.402, lr=0.1]    55%|█████▍    | 82/150 [40:59<34:47, 30.69s/epoch, loss=0.926, accuracy=0.813, val_loss=0.954, val_accuracy=0.779, lr=0.01] 55%|█████▌    | 83/150 [41:30<34:06, 30.54s/epoch, loss=0.742, accuracy=0.847, val_loss=0.863, val_accuracy=0.797, lr=0.01] 56%|█████▌    | 84/150 [42:00<33:23, 30.36s/epoch, loss=0.66, accuracy=0.854, val_loss=0.725, val_accuracy=0.826, lr=0.01]  57%|█████▋    | 85/150 [42:30<33:00, 30.48s/epoch, loss=0.612, accuracy=0.859, val_loss=0.739, val_accuracy=0.814, lr=0.01] 57%|█████▋    | 86/150 [43:01<32:25, 30.40s/epoch, loss=0.593, accuracy=0.859, val_loss=0.801, val_accuracy=0.797, lr=0.01] 58%|█████▊    | 87/150 [43:30<31:45, 30.24s/epoch, loss=0.578, accuracy=0.863, val_loss=0.738, val_accuracy=0.809, lr=0.01] 59%|█████▊    | 88/150 [44:01<31:30, 30.49s/epoch, loss=0.578, accuracy=0.863, val_loss=0.79, val_accuracy=0.792, lr=0.01]  59%|█████▉    | 89/150 [44:30<30:28, 29.98s/epoch, loss=0.576, accuracy=0.862, val_loss=0.709, val_accuracy=0.82, lr=0.01] 60%|██████    | 90/150 [45:00<29:58, 29.97s/epoch, loss=0.568, accuracy=0.865, val_loss=0.806, val_accuracy=0.794, lr=0.01] 61%|██████    | 91/150 [45:31<29:39, 30.16s/epoch, loss=0.568, accuracy=0.867, val_loss=0.763, val_accuracy=0.797, lr=0.01] 61%|██████▏   | 92/150 [46:01<29:14, 30.26s/epoch, loss=0.567, accuracy=0.869, val_loss=0.856, val_accuracy=0.776, lr=0.01] 62%|██████▏   | 93/150 [46:32<28:50, 30.36s/epoch, loss=0.566, accuracy=0.869, val_loss=0.831, val_accuracy=0.788, lr=0.01] 63%|██████▎   | 94/150 [47:03<28:24, 30.45s/epoch, loss=0.562, accuracy=0.871, val_loss=1.06, val_accuracy=0.723, lr=0.00316] 63%|██████▎   | 95/150 [47:33<27:55, 30.46s/epoch, loss=0.559, accuracy=0.874, val_loss=0.772, val_accuracy=0.804, lr=0.01]   64%|██████▍   | 96/150 [48:03<27:14, 30.27s/epoch, loss=0.562, accuracy=0.875, val_loss=1.03, val_accuracy=0.727, lr=0.01]  65%|██████▍   | 97/150 [48:34<26:56, 30.51s/epoch, loss=0.564, accuracy=0.872, val_loss=0.764, val_accuracy=0.81, lr=0.01] 65%|██████▌   | 98/150 [49:03<26:10, 30.21s/epoch, loss=0.56, accuracy=0.876, val_loss=0.893, val_accuracy=0.78, lr=0.01]  66%|██████▌   | 99/150 [49:33<25:31, 30.03s/epoch, loss=0.561, accuracy=0.875, val_loss=0.884, val_accuracy=0.778, lr=0.00316] 67%|██████▋   | 100/150 [50:02<24:49, 29.79s/epoch, loss=0.562, accuracy=0.876, val_loss=0.803, val_accuracy=0.811, lr=0.01]   67%|██████▋   | 101/150 [50:31<23:58, 29.35s/epoch, loss=0.561, accuracy=0.876, val_loss=0.74, val_accuracy=0.825, lr=0.01]  68%|██████▊   | 102/150 [50:58<23:05, 28.86s/epoch, loss=0.557, accuracy=0.879, val_loss=0.839, val_accuracy=0.793, lr=0.01] 69%|██████▊   | 103/150 [51:27<22:29, 28.71s/epoch, loss=0.558, accuracy=0.878, val_loss=1.07, val_accuracy=0.719, lr=0.01]  69%|██████▉   | 104/150 [51:58<22:30, 29.35s/epoch, loss=0.565, accuracy=0.876, val_loss=0.869, val_accuracy=0.781, lr=0.00316] 70%|███████   | 105/150 [52:28<22:14, 29.65s/epoch, loss=0.562, accuracy=0.877, val_loss=0.783, val_accuracy=0.814, lr=0.01]    71%|███████   | 106/150 [52:59<22:00, 30.02s/epoch, loss=0.563, accuracy=0.878, val_loss=1.05, val_accuracy=0.74, lr=0.01]   71%|███████▏  | 107/150 [53:27<21:08, 29.51s/epoch, loss=0.559, accuracy=0.881, val_loss=0.828, val_accuracy=0.798, lr=0.01] 72%|███████▏  | 108/150 [53:58<20:57, 29.94s/epoch, loss=0.558, accuracy=0.881, val_loss=1, val_accuracy=0.744, lr=0.01]     73%|███████▎  | 109/150 [54:28<20:22, 29.82s/epoch, loss=0.559, accuracy=0.879, val_loss=0.84, val_accuracy=0.789, lr=0.00316] 73%|███████▎  | 110/150 [54:57<19:50, 29.75s/epoch, loss=0.559, accuracy=0.882, val_loss=0.734, val_accuracy=0.823, lr=0.01]   74%|███████▍  | 111/150 [55:27<19:18, 29.71s/epoch, loss=0.559, accuracy=0.882, val_loss=0.921, val_accuracy=0.773, lr=0.01] 75%|███████▍  | 112/150 [55:56<18:44, 29.59s/epoch, loss=0.555, accuracy=0.883, val_loss=0.949, val_accuracy=0.749, lr=0.01] 75%|███████▌  | 113/150 [56:26<18:18, 29.68s/epoch, loss=0.562, accuracy=0.882, val_loss=0.806, val_accuracy=0.807, lr=0.01] 76%|███████▌  | 114/150 [56:56<17:55, 29.86s/epoch, loss=0.564, accuracy=0.882, val_loss=0.85, val_accuracy=0.784, lr=0.00316] 77%|███████▋  | 115/150 [57:26<17:20, 29.72s/epoch, loss=0.559, accuracy=0.882, val_loss=0.959, val_accuracy=0.771, lr=0.01]   77%|███████▋  | 116/150 [57:55<16:51, 29.76s/epoch, loss=0.56, accuracy=0.884, val_loss=0.776, val_accuracy=0.818, lr=0.01]  78%|███████▊  | 117/150 [58:26<16:31, 30.05s/epoch, loss=0.562, accuracy=0.881, val_loss=0.835, val_accuracy=0.798, lr=0.01] 79%|███████▊  | 118/150 [58:58<16:13, 30.43s/epoch, loss=0.564, accuracy=0.881, val_loss=0.871, val_accuracy=0.79, lr=0.01]  79%|███████▉  | 119/150 [59:28<15:46, 30.52s/epoch, loss=0.555, accuracy=0.885, val_loss=0.836, val_accuracy=0.791, lr=0.00316] 80%|████████  | 120/150 [59:58<15:07, 30.25s/epoch, loss=0.561, accuracy=0.884, val_loss=0.728, val_accuracy=0.825, lr=0.01]    81%|████████  | 121/150 [1:00:29<14:41, 30.39s/epoch, loss=0.558, accuracy=0.885, val_loss=0.936, val_accuracy=0.782, lr=0.01] 81%|████████▏ | 122/150 [1:00:59<14:12, 30.44s/epoch, loss=0.483, accuracy=0.911, val_loss=0.55, val_accuracy=0.886, lr=0.001] 82%|████████▏ | 123/150 [1:01:27<13:23, 29.77s/epoch, loss=0.433, accuracy=0.926, val_loss=0.529, val_accuracy=0.892, lr=0.001] 83%|████████▎ | 124/150 [1:01:59<13:05, 30.23s/epoch, loss=0.41, accuracy=0.933, val_loss=0.513, val_accuracy=0.894, lr=0.001]  83%|████████▎ | 125/150 [1:02:29<12:39, 30.39s/epoch, loss=0.394, accuracy=0.936, val_loss=0.508, val_accuracy=0.895, lr=0.001] 84%|████████▍ | 126/150 [1:03:00<12:10, 30.43s/epoch, loss=0.378, accuracy=0.941, val_loss=0.502, val_accuracy=0.898, lr=0.001] 85%|████████▍ | 127/150 [1:03:29<11:31, 30.05s/epoch, loss=0.369, accuracy=0.941, val_loss=0.495, val_accuracy=0.899, lr=0.001] 85%|████████▌ | 128/150 [1:03:59<10:57, 29.90s/epoch, loss=0.357, accuracy=0.943, val_loss=0.485, val_accuracy=0.899, lr=0.001] 86%|████████▌ | 129/150 [1:04:30<10:35, 30.27s/epoch, loss=0.344, accuracy=0.945, val_loss=0.502, val_accuracy=0.895, lr=0.001] 87%|████████▋ | 130/150 [1:05:00<10:06, 30.35s/epoch, loss=0.334, accuracy=0.948, val_loss=0.478, val_accuracy=0.899, lr=0.001] 87%|████████▋ | 131/150 [1:05:30<09:34, 30.26s/epoch, loss=0.327, accuracy=0.949, val_loss=0.48, val_accuracy=0.902, lr=0.001]  88%|████████▊ | 132/150 [1:06:00<08:59, 29.97s/epoch, loss=0.318, accuracy=0.95, val_loss=0.464, val_accuracy=0.903, lr=0.001] 89%|████████▊ | 133/150 [1:06:30<08:30, 30.02s/epoch, loss=0.31, accuracy=0.952, val_loss=0.466, val_accuracy=0.901, lr=0.001] 89%|████████▉ | 134/150 [1:06:59<07:56, 29.78s/epoch, loss=0.305, accuracy=0.951, val_loss=0.473, val_accuracy=0.9, lr=0.001]  90%|█████████ | 135/150 [1:07:30<07:29, 29.99s/epoch, loss=0.295, accuracy=0.954, val_loss=0.466, val_accuracy=0.903, lr=0.001] 91%|█████████ | 136/150 [1:08:00<07:02, 30.19s/epoch, loss=0.289, accuracy=0.954, val_loss=0.457, val_accuracy=0.904, lr=0.001] 91%|█████████▏| 137/150 [1:08:30<06:32, 30.17s/epoch, loss=0.284, accuracy=0.954, val_loss=0.463, val_accuracy=0.902, lr=0.001] 92%|█████████▏| 138/150 [1:09:01<06:04, 30.37s/epoch, loss=0.279, accuracy=0.955, val_loss=0.466, val_accuracy=0.898, lr=0.001] 93%|█████████▎| 139/150 [1:09:31<05:34, 30.37s/epoch, loss=0.272, accuracy=0.956, val_loss=0.475, val_accuracy=0.893, lr=0.001] 93%|█████████▎| 140/150 [1:10:02<05:03, 30.36s/epoch, loss=0.268, accuracy=0.957, val_loss=0.473, val_accuracy=0.899, lr=0.001] 94%|█████████▍| 141/150 [1:10:30<04:26, 29.60s/epoch, loss=0.262, accuracy=0.958, val_loss=0.494, val_accuracy=0.889, lr=0.000316] 95%|█████████▍| 142/150 [1:10:58<03:52, 29.12s/epoch, loss=0.259, accuracy=0.959, val_loss=0.457, val_accuracy=0.896, lr=0.001]    95%|█████████▌| 143/150 [1:11:27<03:23, 29.10s/epoch, loss=0.257, accuracy=0.957, val_loss=0.468, val_accuracy=0.898, lr=0.001] 96%|█████████▌| 144/150 [1:11:56<02:55, 29.23s/epoch, loss=0.251, accuracy=0.959, val_loss=0.485, val_accuracy=0.889, lr=0.001] 97%|█████████▋| 145/150 [1:12:25<02:25, 29.13s/epoch, loss=0.25, accuracy=0.958, val_loss=0.457, val_accuracy=0.899, lr=0.001]  97%|█████████▋| 146/150 [1:12:54<01:56, 29.16s/epoch, loss=0.246, accuracy=0.959, val_loss=0.492, val_accuracy=0.89, lr=0.001] 98%|█████████▊| 147/150 [1:13:23<01:26, 28.99s/epoch, loss=0.242, accuracy=0.96, val_loss=0.472, val_accuracy=0.893, lr=0.001] 99%|█████████▊| 148/150 [1:13:52<00:58, 29.15s/epoch, loss=0.24, accuracy=0.96, val_loss=0.493, val_accuracy=0.89, lr=0.001]   99%|█████████▉| 149/150 [1:14:22<00:29, 29.27s/epoch, loss=0.242, accuracy=0.958, val_loss=0.46, val_accuracy=0.892, lr=0.001]100%|██████████| 150/150 [1:14:52<00:00, 29.47s/epoch, loss=0.234, accuracy=0.961, val_loss=0.471, val_accuracy=0.894, lr=0.000316]100%|██████████| 150/150 [1:14:52<00:00, 29.95s/epoch, loss=0.234, accuracy=0.961, val_loss=0.471, val_accuracy=0.894, lr=0.000316]
Using real-time data augmentation.
Test loss: 0.4708181619644165
Test accuracy: 0.8938999772071838


* * * Run SGD for ID = 10_6. * * *


2024-02-15 17:21:34.840769: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 17:21:37.493644: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 17:21:37.495115: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-15 17:21:37.537186: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 17:21:37.537233: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 17:21:37.540830: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 17:21:37.540897: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 17:21:37.543599: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 17:21:37.544297: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 17:21:37.547219: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 17:21:37.549045: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 17:21:37.558503: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 17:21:37.560044: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 17:21:37.560473: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 17:21:38.797270: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-15 17:21:38.798272: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 17:21:38.798788: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 17:21:38.798824: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 17:21:38.798887: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 17:21:38.798907: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 17:21:38.798924: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 17:21:38.798942: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 17:21:38.798960: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 17:21:38.798978: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 17:21:38.798998: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 17:21:38.799567: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 17:21:38.799610: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 17:21:39.436930: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-15 17:21:39.436990: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-15 17:21:39.437001: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-15 17:21:39.438015: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:3b:00.0, compute capability: 6.1)
{'id': 106, 'batch_size': 128, 'epochs': 150, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/150 [00:00<?, ?epoch/s]2024-02-15 17:21:40.222120: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-15 17:21:40.234719: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-02-15 17:21:42.141753: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 17:21:42.480542: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 17:21:43.435514: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-15 17:21:43.486804: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/150 [01:12<3:00:51, 72.83s/epoch, loss=3.15, accuracy=0.321, val_loss=2.57, val_accuracy=0.196, lr=0.1]  1%|▏         | 2/150 [01:42<1:57:29, 47.64s/epoch, loss=1.61, accuracy=0.512, val_loss=2.9, val_accuracy=0.305, lr=0.1]   2%|▏         | 3/150 [02:13<1:37:13, 39.68s/epoch, loss=1.44, accuracy=0.601, val_loss=1.91, val_accuracy=0.496, lr=0.1]  3%|▎         | 4/150 [02:42<1:26:48, 35.67s/epoch, loss=1.35, accuracy=0.656, val_loss=1.62, val_accuracy=0.562, lr=0.1]  3%|▎         | 5/150 [03:12<1:21:31, 33.74s/epoch, loss=1.31, accuracy=0.685, val_loss=1.49, val_accuracy=0.617, lr=0.1]  4%|▍         | 6/150 [03:41<1:16:48, 32.00s/epoch, loss=1.27, accuracy=0.701, val_loss=1.94, val_accuracy=0.499, lr=0.1]  5%|▍         | 7/150 [04:11<1:14:46, 31.37s/epoch, loss=1.26, accuracy=0.709, val_loss=1.86, val_accuracy=0.5, lr=0.1]    5%|▌         | 8/150 [04:40<1:12:40, 30.70s/epoch, loss=1.25, accuracy=0.716, val_loss=1.72, val_accuracy=0.561, lr=0.1]  6%|▌         | 9/150 [05:11<1:12:20, 30.78s/epoch, loss=1.24, accuracy=0.718, val_loss=2.34, val_accuracy=0.488, lr=0.1]  7%|▋         | 10/150 [05:42<1:11:56, 30.83s/epoch, loss=1.24, accuracy=0.722, val_loss=1.82, val_accuracy=0.53, lr=0.0316]  7%|▋         | 11/150 [06:12<1:10:48, 30.57s/epoch, loss=1.22, accuracy=0.726, val_loss=1.9, val_accuracy=0.553, lr=0.1]     8%|▊         | 12/150 [06:42<1:09:38, 30.28s/epoch, loss=1.23, accuracy=0.728, val_loss=1.9, val_accuracy=0.522, lr=0.1]  9%|▊         | 13/150 [07:12<1:09:08, 30.28s/epoch, loss=1.21, accuracy=0.733, val_loss=1.66, val_accuracy=0.594, lr=0.1]  9%|▉         | 14/150 [07:43<1:08:46, 30.34s/epoch, loss=1.21, accuracy=0.735, val_loss=2.06, val_accuracy=0.481, lr=0.1] 10%|█         | 15/150 [08:13<1:08:28, 30.43s/epoch, loss=1.21, accuracy=0.732, val_loss=2.03, val_accuracy=0.528, lr=0.0316] 11%|█         | 16/150 [08:44<1:08:16, 30.57s/epoch, loss=1.2, accuracy=0.738, val_loss=1.8, val_accuracy=0.518, lr=0.1]      11%|█▏        | 17/150 [09:14<1:07:27, 30.43s/epoch, loss=1.21, accuracy=0.739, val_loss=1.68, val_accuracy=0.57, lr=0.1] 12%|█▏        | 18/150 [09:44<1:06:26, 30.20s/epoch, loss=1.2, accuracy=0.737, val_loss=2.69, val_accuracy=0.41, lr=0.1]  13%|█▎        | 19/150 [10:14<1:05:35, 30.04s/epoch, loss=1.2, accuracy=0.74, val_loss=1.51, val_accuracy=0.64, lr=0.1]  13%|█▎        | 20/150 [10:43<1:04:28, 29.75s/epoch, loss=1.2, accuracy=0.74, val_loss=1.59, val_accuracy=0.603, lr=0.0316] 14%|█▍        | 21/150 [11:11<1:03:07, 29.36s/epoch, loss=1.2, accuracy=0.742, val_loss=1.75, val_accuracy=0.54, lr=0.1]    15%|█▍        | 22/150 [11:40<1:02:06, 29.12s/epoch, loss=1.19, accuracy=0.743, val_loss=1.92, val_accuracy=0.561, lr=0.1] 15%|█▌        | 23/150 [12:08<1:01:05, 28.86s/epoch, loss=1.19, accuracy=0.743, val_loss=1.82, val_accuracy=0.54, lr=0.1]  16%|█▌        | 24/150 [12:39<1:01:53, 29.48s/epoch, loss=1.18, accuracy=0.747, val_loss=1.91, val_accuracy=0.523, lr=0.1] 17%|█▋        | 25/150 [13:08<1:01:28, 29.51s/epoch, loss=1.18, accuracy=0.746, val_loss=1.34, val_accuracy=0.687, lr=0.1] 17%|█▋        | 26/150 [13:36<59:56, 29.00s/epoch, loss=1.18, accuracy=0.745, val_loss=2.39, val_accuracy=0.388, lr=0.1]   18%|█▊        | 27/150 [14:07<1:00:13, 29.38s/epoch, loss=1.18, accuracy=0.745, val_loss=1.68, val_accuracy=0.58, lr=0.1] 19%|█▊        | 28/150 [14:37<1:00:17, 29.66s/epoch, loss=1.17, accuracy=0.748, val_loss=1.76, val_accuracy=0.557, lr=0.1] 19%|█▉        | 29/150 [15:07<1:00:25, 29.96s/epoch, loss=1.18, accuracy=0.747, val_loss=1.98, val_accuracy=0.518, lr=0.1] 20%|██        | 30/150 [15:37<59:43, 29.87s/epoch, loss=1.17, accuracy=0.747, val_loss=1.65, val_accuracy=0.619, lr=0.0316] 21%|██        | 31/150 [16:07<59:05, 29.80s/epoch, loss=1.17, accuracy=0.746, val_loss=2.1, val_accuracy=0.523, lr=0.1]     21%|██▏       | 32/150 [16:37<59:00, 30.01s/epoch, loss=1.17, accuracy=0.749, val_loss=1.68, val_accuracy=0.593, lr=0.1] 22%|██▏       | 33/150 [17:08<58:53, 30.20s/epoch, loss=1.17, accuracy=0.745, val_loss=1.93, val_accuracy=0.577, lr=0.1] 23%|██▎       | 34/150 [17:38<58:26, 30.23s/epoch, loss=1.16, accuracy=0.747, val_loss=2.34, val_accuracy=0.464, lr=0.1] 23%|██▎       | 35/150 [18:09<58:01, 30.28s/epoch, loss=1.17, accuracy=0.75, val_loss=1.52, val_accuracy=0.614, lr=0.0316] 24%|██▍       | 36/150 [18:39<57:48, 30.43s/epoch, loss=1.16, accuracy=0.749, val_loss=1.73, val_accuracy=0.611, lr=0.1]   25%|██▍       | 37/150 [19:09<57:03, 30.30s/epoch, loss=1.17, accuracy=0.748, val_loss=2, val_accuracy=0.51, lr=0.1]     25%|██▌       | 38/150 [19:39<56:14, 30.13s/epoch, loss=1.16, accuracy=0.751, val_loss=3.04, val_accuracy=0.467, lr=0.1] 26%|██▌       | 39/150 [20:09<55:20, 29.92s/epoch, loss=1.16, accuracy=0.751, val_loss=2.21, val_accuracy=0.438, lr=0.1] 27%|██▋       | 40/150 [20:39<55:16, 30.15s/epoch, loss=1.15, accuracy=0.752, val_loss=3.66, val_accuracy=0.298, lr=0.0316] 27%|██▋       | 41/150 [21:10<54:57, 30.25s/epoch, loss=1.16, accuracy=0.751, val_loss=1.76, val_accuracy=0.535, lr=0.1]    28%|██▊       | 42/150 [21:40<54:27, 30.26s/epoch, loss=1.16, accuracy=0.751, val_loss=1.52, val_accuracy=0.627, lr=0.1] 29%|██▊       | 43/150 [22:11<54:08, 30.36s/epoch, loss=1.15, accuracy=0.749, val_loss=2.3, val_accuracy=0.475, lr=0.1]  29%|██▉       | 44/150 [22:41<53:43, 30.41s/epoch, loss=1.15, accuracy=0.75, val_loss=1.99, val_accuracy=0.476, lr=0.1] 30%|███       | 45/150 [23:10<52:20, 29.91s/epoch, loss=1.15, accuracy=0.75, val_loss=1.49, val_accuracy=0.646, lr=0.0316] 31%|███       | 46/150 [23:40<52:05, 30.06s/epoch, loss=1.16, accuracy=0.75, val_loss=3.58, val_accuracy=0.251, lr=0.1]    31%|███▏      | 47/150 [24:09<50:46, 29.58s/epoch, loss=1.15, accuracy=0.753, val_loss=1.86, val_accuracy=0.536, lr=0.1] 32%|███▏      | 48/150 [24:39<50:30, 29.71s/epoch, loss=1.14, accuracy=0.752, val_loss=1.96, val_accuracy=0.505, lr=0.1] 33%|███▎      | 49/150 [25:07<49:16, 29.27s/epoch, loss=1.15, accuracy=0.752, val_loss=1.73, val_accuracy=0.559, lr=0.1] 33%|███▎      | 50/150 [25:35<47:59, 28.79s/epoch, loss=1.15, accuracy=0.751, val_loss=1.62, val_accuracy=0.588, lr=0.0316] 34%|███▍      | 51/150 [26:03<47:29, 28.79s/epoch, loss=1.15, accuracy=0.751, val_loss=2.51, val_accuracy=0.46, lr=0.1]     35%|███▍      | 52/150 [26:33<47:33, 29.12s/epoch, loss=1.14, accuracy=0.753, val_loss=4.3, val_accuracy=0.343, lr=0.1] 35%|███▌      | 53/150 [27:03<47:20, 29.29s/epoch, loss=1.15, accuracy=0.751, val_loss=2.15, val_accuracy=0.502, lr=0.1] 36%|███▌      | 54/150 [27:33<47:14, 29.53s/epoch, loss=1.15, accuracy=0.754, val_loss=1.88, val_accuracy=0.525, lr=0.1] 37%|███▋      | 55/150 [28:03<46:50, 29.58s/epoch, loss=1.14, accuracy=0.755, val_loss=1.65, val_accuracy=0.564, lr=0.0316] 37%|███▋      | 56/150 [28:32<46:23, 29.61s/epoch, loss=1.14, accuracy=0.755, val_loss=1.94, val_accuracy=0.462, lr=0.1]    38%|███▊      | 57/150 [29:01<45:33, 29.39s/epoch, loss=1.15, accuracy=0.751, val_loss=2.3, val_accuracy=0.473, lr=0.1]  39%|███▊      | 58/150 [29:31<45:24, 29.61s/epoch, loss=1.14, accuracy=0.752, val_loss=2.69, val_accuracy=0.376, lr=0.1] 39%|███▉      | 59/150 [30:02<45:16, 29.85s/epoch, loss=1.15, accuracy=0.75, val_loss=1.77, val_accuracy=0.54, lr=0.1]   40%|████      | 60/150 [30:31<44:15, 29.50s/epoch, loss=1.15, accuracy=0.753, val_loss=2.22, val_accuracy=0.431, lr=0.0316] 41%|████      | 61/150 [31:01<44:11, 29.80s/epoch, loss=1.14, accuracy=0.756, val_loss=1.44, val_accuracy=0.656, lr=0.1]    41%|████▏     | 62/150 [31:32<44:05, 30.06s/epoch, loss=1.14, accuracy=0.753, val_loss=2.69, val_accuracy=0.371, lr=0.1] 42%|████▏     | 63/150 [32:03<43:56, 30.31s/epoch, loss=1.14, accuracy=0.754, val_loss=4.3, val_accuracy=0.244, lr=0.1]  43%|████▎     | 64/150 [32:33<43:27, 30.32s/epoch, loss=1.14, accuracy=0.752, val_loss=2.39, val_accuracy=0.454, lr=0.1] 43%|████▎     | 65/150 [33:04<43:02, 30.38s/epoch, loss=1.15, accuracy=0.753, val_loss=1.76, val_accuracy=0.539, lr=0.0316] 44%|████▍     | 66/150 [33:34<42:36, 30.43s/epoch, loss=1.14, accuracy=0.753, val_loss=3.43, val_accuracy=0.326, lr=0.1]    45%|████▍     | 67/150 [34:03<41:39, 30.11s/epoch, loss=1.14, accuracy=0.754, val_loss=1.91, val_accuracy=0.517, lr=0.1] 45%|████▌     | 68/150 [34:33<41:04, 30.06s/epoch, loss=1.14, accuracy=0.755, val_loss=1.88, val_accuracy=0.519, lr=0.1] 46%|████▌     | 69/150 [35:03<40:32, 30.03s/epoch, loss=1.14, accuracy=0.753, val_loss=1.62, val_accuracy=0.595, lr=0.1] 47%|████▋     | 70/150 [35:32<39:37, 29.71s/epoch, loss=1.13, accuracy=0.753, val_loss=1.45, val_accuracy=0.622, lr=0.0316] 47%|████▋     | 71/150 [36:01<38:47, 29.47s/epoch, loss=1.13, accuracy=0.755, val_loss=1.5, val_accuracy=0.63, lr=0.1]      48%|████▊     | 72/150 [36:30<38:08, 29.34s/epoch, loss=1.13, accuracy=0.755, val_loss=5.09, val_accuracy=0.295, lr=0.1] 49%|████▊     | 73/150 [36:59<37:32, 29.25s/epoch, loss=1.14, accuracy=0.753, val_loss=2.37, val_accuracy=0.418, lr=0.1] 49%|████▉     | 74/150 [37:28<36:45, 29.02s/epoch, loss=1.14, accuracy=0.754, val_loss=2.02, val_accuracy=0.478, lr=0.1] 50%|█████     | 75/150 [37:58<36:42, 29.37s/epoch, loss=1.14, accuracy=0.753, val_loss=1.86, val_accuracy=0.549, lr=0.0316] 51%|█████     | 76/150 [38:27<36:15, 29.39s/epoch, loss=1.14, accuracy=0.753, val_loss=2.21, val_accuracy=0.416, lr=0.1]    51%|█████▏    | 77/150 [38:57<35:51, 29.47s/epoch, loss=1.14, accuracy=0.752, val_loss=1.72, val_accuracy=0.55, lr=0.1]  52%|█████▏    | 78/150 [39:26<35:15, 29.38s/epoch, loss=1.14, accuracy=0.756, val_loss=2.05, val_accuracy=0.47, lr=0.1] 53%|█████▎    | 79/150 [39:55<34:29, 29.15s/epoch, loss=1.13, accuracy=0.756, val_loss=1.37, val_accuracy=0.678, lr=0.1] 53%|█████▎    | 80/150 [40:24<34:00, 29.15s/epoch, loss=1.14, accuracy=0.752, val_loss=1.75, val_accuracy=0.584, lr=0.0316] 54%|█████▍    | 81/150 [40:53<33:28, 29.10s/epoch, loss=1.14, accuracy=0.753, val_loss=1.87, val_accuracy=0.527, lr=0.1]    55%|█████▍    | 82/150 [41:22<33:06, 29.21s/epoch, loss=0.925, accuracy=0.812, val_loss=0.989, val_accuracy=0.778, lr=0.01] 55%|█████▌    | 83/150 [41:51<32:30, 29.12s/epoch, loss=0.744, accuracy=0.845, val_loss=0.824, val_accuracy=0.809, lr=0.01] 56%|█████▌    | 84/150 [42:19<31:33, 28.69s/epoch, loss=0.66, accuracy=0.855, val_loss=0.858, val_accuracy=0.781, lr=0.01]  57%|█████▋    | 85/150 [42:47<30:41, 28.34s/epoch, loss=0.617, accuracy=0.858, val_loss=0.759, val_accuracy=0.814, lr=0.01] 57%|█████▋    | 86/150 [43:15<30:18, 28.41s/epoch, loss=0.597, accuracy=0.86, val_loss=0.715, val_accuracy=0.82, lr=0.01]   58%|█████▊    | 87/150 [43:43<29:34, 28.17s/epoch, loss=0.583, accuracy=0.861, val_loss=0.699, val_accuracy=0.819, lr=0.01] 59%|█████▊    | 88/150 [44:11<29:09, 28.22s/epoch, loss=0.575, accuracy=0.861, val_loss=0.909, val_accuracy=0.77, lr=0.01]  59%|█████▉    | 89/150 [44:39<28:35, 28.12s/epoch, loss=0.576, accuracy=0.86, val_loss=0.859, val_accuracy=0.77, lr=0.01]  60%|██████    | 90/150 [45:08<28:25, 28.42s/epoch, loss=0.573, accuracy=0.864, val_loss=0.948, val_accuracy=0.757, lr=0.01] 61%|██████    | 91/150 [45:38<28:16, 28.76s/epoch, loss=0.572, accuracy=0.867, val_loss=1.4, val_accuracy=0.653, lr=0.01]   61%|██████▏   | 92/150 [46:06<27:36, 28.56s/epoch, loss=0.569, accuracy=0.866, val_loss=0.776, val_accuracy=0.804, lr=0.00316] 62%|██████▏   | 93/150 [46:33<26:47, 28.21s/epoch, loss=0.566, accuracy=0.867, val_loss=0.948, val_accuracy=0.754, lr=0.01]    63%|██████▎   | 94/150 [47:03<26:52, 28.79s/epoch, loss=0.565, accuracy=0.871, val_loss=0.823, val_accuracy=0.791, lr=0.01] 63%|██████▎   | 95/150 [47:34<26:50, 29.28s/epoch, loss=0.57, accuracy=0.869, val_loss=0.979, val_accuracy=0.755, lr=0.01]  64%|██████▍   | 96/150 [48:02<26:09, 29.06s/epoch, loss=0.564, accuracy=0.873, val_loss=1.32, val_accuracy=0.692, lr=0.01] 65%|██████▍   | 97/150 [48:32<25:44, 29.15s/epoch, loss=0.563, accuracy=0.875, val_loss=0.826, val_accuracy=0.782, lr=0.00316] 65%|██████▌   | 98/150 [49:01<25:26, 29.37s/epoch, loss=0.562, accuracy=0.874, val_loss=0.951, val_accuracy=0.769, lr=0.01]    66%|██████▌   | 99/150 [49:32<25:13, 29.68s/epoch, loss=0.563, accuracy=0.873, val_loss=1.05, val_accuracy=0.751, lr=0.01]  67%|██████▋   | 100/150 [50:02<24:50, 29.80s/epoch, loss=0.564, accuracy=0.875, val_loss=0.959, val_accuracy=0.757, lr=0.01] 67%|██████▋   | 101/150 [50:32<24:18, 29.76s/epoch, loss=0.563, accuracy=0.875, val_loss=1.09, val_accuracy=0.734, lr=0.01]  68%|██████▊   | 102/150 [51:01<23:39, 29.57s/epoch, loss=0.561, accuracy=0.875, val_loss=0.762, val_accuracy=0.816, lr=0.00316] 69%|██████▊   | 103/150 [51:31<23:15, 29.69s/epoch, loss=0.561, accuracy=0.877, val_loss=1.12, val_accuracy=0.733, lr=0.01]     69%|██████▉   | 104/150 [52:01<22:55, 29.90s/epoch, loss=0.563, accuracy=0.877, val_loss=1.06, val_accuracy=0.748, lr=0.01] 70%|███████   | 105/150 [52:32<22:35, 30.12s/epoch, loss=0.563, accuracy=0.877, val_loss=0.935, val_accuracy=0.754, lr=0.01] 71%|███████   | 106/150 [53:01<21:56, 29.93s/epoch, loss=0.564, accuracy=0.877, val_loss=0.832, val_accuracy=0.786, lr=0.01] 71%|███████▏  | 107/150 [53:31<21:25, 29.90s/epoch, loss=0.564, accuracy=0.879, val_loss=0.859, val_accuracy=0.78, lr=0.00316] 72%|███████▏  | 108/150 [54:00<20:43, 29.60s/epoch, loss=0.561, accuracy=0.88, val_loss=0.825, val_accuracy=0.793, lr=0.01]    73%|███████▎  | 109/150 [54:28<19:51, 29.06s/epoch, loss=0.557, accuracy=0.88, val_loss=0.881, val_accuracy=0.789, lr=0.01] 73%|███████▎  | 110/150 [54:55<19:03, 28.59s/epoch, loss=0.559, accuracy=0.881, val_loss=0.896, val_accuracy=0.789, lr=0.01] 74%|███████▍  | 111/150 [55:23<18:24, 28.31s/epoch, loss=0.559, accuracy=0.881, val_loss=0.851, val_accuracy=0.788, lr=0.01] 75%|███████▍  | 112/150 [55:51<17:54, 28.28s/epoch, loss=0.563, accuracy=0.88, val_loss=0.983, val_accuracy=0.778, lr=0.00316] 75%|███████▌  | 113/150 [56:19<17:22, 28.18s/epoch, loss=0.557, accuracy=0.881, val_loss=0.734, val_accuracy=0.827, lr=0.01]   76%|███████▌  | 114/150 [56:47<16:47, 27.98s/epoch, loss=0.561, accuracy=0.882, val_loss=0.802, val_accuracy=0.802, lr=0.01] 77%|███████▋  | 115/150 [57:14<16:16, 27.90s/epoch, loss=0.556, accuracy=0.884, val_loss=0.942, val_accuracy=0.77, lr=0.01]  77%|███████▋  | 116/150 [57:45<16:17, 28.75s/epoch, loss=0.56, accuracy=0.881, val_loss=0.866, val_accuracy=0.789, lr=0.01] 78%|███████▊  | 117/150 [58:15<16:05, 29.25s/epoch, loss=0.558, accuracy=0.883, val_loss=0.809, val_accuracy=0.803, lr=0.00316] 79%|███████▊  | 118/150 [58:45<15:39, 29.36s/epoch, loss=0.56, accuracy=0.884, val_loss=0.816, val_accuracy=0.802, lr=0.01]     79%|███████▉  | 119/150 [59:15<15:11, 29.41s/epoch, loss=0.562, accuracy=0.881, val_loss=0.782, val_accuracy=0.812, lr=0.01] 80%|████████  | 120/150 [59:44<14:39, 29.33s/epoch, loss=0.562, accuracy=0.882, val_loss=0.783, val_accuracy=0.817, lr=0.01] 81%|████████  | 121/150 [1:00:14<14:20, 29.67s/epoch, loss=0.558, accuracy=0.885, val_loss=0.754, val_accuracy=0.822, lr=0.01] 81%|████████▏ | 122/150 [1:00:44<13:49, 29.62s/epoch, loss=0.483, accuracy=0.91, val_loss=0.543, val_accuracy=0.889, lr=0.001] 82%|████████▏ | 123/150 [1:01:13<13:21, 29.68s/epoch, loss=0.43, accuracy=0.927, val_loss=0.525, val_accuracy=0.894, lr=0.001] 83%|████████▎ | 124/150 [1:01:43<12:50, 29.64s/epoch, loss=0.409, accuracy=0.931, val_loss=0.518, val_accuracy=0.896, lr=0.001] 83%|████████▎ | 125/150 [1:02:11<12:11, 29.25s/epoch, loss=0.39, accuracy=0.937, val_loss=0.515, val_accuracy=0.898, lr=0.001]  84%|████████▍ | 126/150 [1:02:40<11:38, 29.11s/epoch, loss=0.375, accuracy=0.94, val_loss=0.509, val_accuracy=0.896, lr=0.001] 85%|████████▍ | 127/150 [1:03:11<11:19, 29.53s/epoch, loss=0.364, accuracy=0.942, val_loss=0.51, val_accuracy=0.897, lr=0.001] 85%|████████▌ | 128/150 [1:03:39<10:45, 29.32s/epoch, loss=0.355, accuracy=0.943, val_loss=0.497, val_accuracy=0.898, lr=0.001] 86%|████████▌ | 129/150 [1:04:07<10:07, 28.93s/epoch, loss=0.345, accuracy=0.945, val_loss=0.492, val_accuracy=0.897, lr=0.001] 87%|████████▋ | 130/150 [1:04:36<09:37, 28.88s/epoch, loss=0.332, accuracy=0.948, val_loss=0.498, val_accuracy=0.897, lr=0.001] 87%|████████▋ | 131/150 [1:05:07<09:17, 29.32s/epoch, loss=0.324, accuracy=0.949, val_loss=0.488, val_accuracy=0.899, lr=0.001] 88%|████████▊ | 132/150 [1:05:36<08:49, 29.40s/epoch, loss=0.315, accuracy=0.95, val_loss=0.512, val_accuracy=0.891, lr=0.001]  89%|████████▊ | 133/150 [1:06:05<08:19, 29.37s/epoch, loss=0.31, accuracy=0.951, val_loss=0.486, val_accuracy=0.895, lr=0.001] 89%|████████▉ | 134/150 [1:06:34<07:46, 29.18s/epoch, loss=0.301, accuracy=0.952, val_loss=0.482, val_accuracy=0.898, lr=0.001] 90%|█████████ | 135/150 [1:07:03<07:16, 29.10s/epoch, loss=0.297, accuracy=0.951, val_loss=0.493, val_accuracy=0.894, lr=0.001] 91%|█████████ | 136/150 [1:07:32<06:44, 28.89s/epoch, loss=0.291, accuracy=0.952, val_loss=0.491, val_accuracy=0.893, lr=0.001] 91%|█████████▏| 137/150 [1:08:00<06:15, 28.90s/epoch, loss=0.287, accuracy=0.953, val_loss=0.48, val_accuracy=0.895, lr=0.001]  92%|█████████▏| 138/150 [1:08:30<05:48, 29.06s/epoch, loss=0.277, accuracy=0.955, val_loss=0.473, val_accuracy=0.894, lr=0.001] 93%|█████████▎| 139/150 [1:09:00<05:23, 29.37s/epoch, loss=0.272, accuracy=0.957, val_loss=0.476, val_accuracy=0.895, lr=0.001] 93%|█████████▎| 140/150 [1:09:30<04:55, 29.52s/epoch, loss=0.266, accuracy=0.957, val_loss=0.467, val_accuracy=0.898, lr=0.001] 94%|█████████▍| 141/150 [1:09:59<04:25, 29.48s/epoch, loss=0.266, accuracy=0.956, val_loss=0.47, val_accuracy=0.895, lr=0.001]  95%|█████████▍| 142/150 [1:10:28<03:54, 29.26s/epoch, loss=0.259, accuracy=0.958, val_loss=0.496, val_accuracy=0.885, lr=0.001] 95%|█████████▌| 143/150 [1:10:59<03:27, 29.67s/epoch, loss=0.255, accuracy=0.959, val_loss=0.476, val_accuracy=0.891, lr=0.001] 96%|█████████▌| 144/150 [1:11:29<02:58, 29.79s/epoch, loss=0.25, accuracy=0.959, val_loss=0.458, val_accuracy=0.895, lr=0.001]  97%|█████████▋| 145/150 [1:11:58<02:28, 29.70s/epoch, loss=0.25, accuracy=0.957, val_loss=0.489, val_accuracy=0.891, lr=0.001] 97%|█████████▋| 146/150 [1:12:28<01:59, 29.77s/epoch, loss=0.243, accuracy=0.959, val_loss=0.466, val_accuracy=0.895, lr=0.001] 98%|█████████▊| 147/150 [1:12:58<01:29, 29.72s/epoch, loss=0.242, accuracy=0.961, val_loss=0.552, val_accuracy=0.873, lr=0.001] 99%|█████████▊| 148/150 [1:13:26<00:58, 29.39s/epoch, loss=0.24, accuracy=0.959, val_loss=0.5, val_accuracy=0.891, lr=0.001]    99%|█████████▉| 149/150 [1:13:55<00:29, 29.30s/epoch, loss=0.238, accuracy=0.959, val_loss=0.479, val_accuracy=0.889, lr=0.000316]100%|██████████| 150/150 [1:14:26<00:00, 29.58s/epoch, loss=0.237, accuracy=0.958, val_loss=0.53, val_accuracy=0.881, lr=0.001]    100%|██████████| 150/150 [1:14:26<00:00, 29.77s/epoch, loss=0.237, accuracy=0.958, val_loss=0.53, val_accuracy=0.881, lr=0.001]
Using real-time data augmentation.
Test loss: 0.5303548574447632
Test accuracy: 0.8806999921798706


* * * Run SGD for ID = 10_7. * * *


2024-02-15 18:36:08.979991: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 18:36:11.195030: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 18:36:11.196341: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-15 18:36:11.236095: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 18:36:11.236139: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 18:36:11.239581: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 18:36:11.239653: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 18:36:11.242359: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 18:36:11.243128: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 18:36:11.246177: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 18:36:11.247966: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 18:36:11.253711: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 18:36:11.254419: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 18:36:11.254503: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 18:36:12.498706: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-15 18:36:12.499298: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 18:36:12.500216: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 18:36:12.500259: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 18:36:12.500328: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 18:36:12.500349: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 18:36:12.500378: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 18:36:12.500398: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 18:36:12.500417: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 18:36:12.500437: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 18:36:12.500458: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 18:36:12.501108: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 18:36:12.501151: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 18:36:13.146294: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-15 18:36:13.146357: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-15 18:36:13.146369: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-15 18:36:13.147488: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:3b:00.0, compute capability: 6.1)
{'id': 107, 'batch_size': 128, 'epochs': 150, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/150 [00:00<?, ?epoch/s]2024-02-15 18:36:13.952460: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-15 18:36:13.964748: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-02-15 18:36:16.109246: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 18:36:16.358850: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 18:36:17.434401: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-15 18:36:17.538568: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/150 [01:11<2:57:56, 71.66s/epoch, loss=3.37, accuracy=0.274, val_loss=2.26, val_accuracy=0.283, lr=0.1]  1%|▏         | 2/150 [01:40<1:54:05, 46.25s/epoch, loss=1.61, accuracy=0.501, val_loss=1.99, val_accuracy=0.424, lr=0.1]  2%|▏         | 3/150 [02:07<1:32:29, 37.75s/epoch, loss=1.36, accuracy=0.622, val_loss=1.94, val_accuracy=0.502, lr=0.1]  3%|▎         | 4/150 [02:35<1:22:09, 33.77s/epoch, loss=1.27, accuracy=0.673, val_loss=2.11, val_accuracy=0.435, lr=0.1]  3%|▎         | 5/150 [03:03<1:16:17, 31.57s/epoch, loss=1.25, accuracy=0.692, val_loss=1.83, val_accuracy=0.516, lr=0.1]  4%|▍         | 6/150 [03:31<1:13:18, 30.54s/epoch, loss=1.23, accuracy=0.707, val_loss=2.07, val_accuracy=0.405, lr=0.1]  5%|▍         | 7/150 [04:00<1:11:39, 30.06s/epoch, loss=1.22, accuracy=0.716, val_loss=1.9, val_accuracy=0.52, lr=0.1]    5%|▌         | 8/150 [04:31<1:11:35, 30.25s/epoch, loss=1.2, accuracy=0.721, val_loss=2.86, val_accuracy=0.378, lr=0.1]  6%|▌         | 9/150 [05:01<1:10:56, 30.19s/epoch, loss=1.21, accuracy=0.725, val_loss=1.82, val_accuracy=0.531, lr=0.1]  7%|▋         | 10/150 [05:30<1:09:51, 29.94s/epoch, loss=1.21, accuracy=0.725, val_loss=1.89, val_accuracy=0.509, lr=0.1]  7%|▋         | 11/150 [06:00<1:09:23, 29.96s/epoch, loss=1.2, accuracy=0.731, val_loss=1.97, val_accuracy=0.479, lr=0.1]   8%|▊         | 12/150 [06:29<1:08:16, 29.69s/epoch, loss=1.2, accuracy=0.732, val_loss=1.59, val_accuracy=0.596, lr=0.1]  9%|▊         | 13/150 [07:00<1:08:29, 30.00s/epoch, loss=1.19, accuracy=0.737, val_loss=2.1, val_accuracy=0.515, lr=0.1]  9%|▉         | 14/150 [07:29<1:07:19, 29.70s/epoch, loss=1.19, accuracy=0.738, val_loss=1.89, val_accuracy=0.508, lr=0.1] 10%|█         | 15/150 [07:59<1:07:06, 29.82s/epoch, loss=1.19, accuracy=0.741, val_loss=2.86, val_accuracy=0.293, lr=0.1] 11%|█         | 16/150 [08:30<1:07:04, 30.03s/epoch, loss=1.18, accuracy=0.739, val_loss=2.55, val_accuracy=0.366, lr=0.1] 11%|█▏        | 17/150 [09:00<1:06:49, 30.14s/epoch, loss=1.19, accuracy=0.74, val_loss=2.21, val_accuracy=0.392, lr=0.0316] 12%|█▏        | 18/150 [09:29<1:05:43, 29.87s/epoch, loss=1.18, accuracy=0.744, val_loss=2.31, val_accuracy=0.35, lr=0.1]    13%|█▎        | 19/150 [10:00<1:05:32, 30.02s/epoch, loss=1.17, accuracy=0.743, val_loss=3.53, val_accuracy=0.327, lr=0.1] 13%|█▎        | 20/150 [10:29<1:04:14, 29.65s/epoch, loss=1.18, accuracy=0.742, val_loss=2.2, val_accuracy=0.468, lr=0.1]  14%|█▍        | 21/150 [10:58<1:03:31, 29.55s/epoch, loss=1.17, accuracy=0.744, val_loss=3.07, val_accuracy=0.363, lr=0.1] 15%|█▍        | 22/150 [11:28<1:03:41, 29.86s/epoch, loss=1.16, accuracy=0.747, val_loss=1.66, val_accuracy=0.588, lr=0.0316] 15%|█▌        | 23/150 [11:57<1:02:12, 29.39s/epoch, loss=1.16, accuracy=0.747, val_loss=2.22, val_accuracy=0.428, lr=0.1]    16%|█▌        | 24/150 [12:27<1:02:16, 29.65s/epoch, loss=1.16, accuracy=0.745, val_loss=1.97, val_accuracy=0.482, lr=0.1] 17%|█▋        | 25/150 [12:57<1:02:08, 29.83s/epoch, loss=1.15, accuracy=0.749, val_loss=2.45, val_accuracy=0.357, lr=0.1] 17%|█▋        | 26/150 [13:27<1:01:28, 29.74s/epoch, loss=1.15, accuracy=0.748, val_loss=1.94, val_accuracy=0.511, lr=0.1] 18%|█▊        | 27/150 [13:57<1:01:05, 29.80s/epoch, loss=1.15, accuracy=0.749, val_loss=2.27, val_accuracy=0.472, lr=0.0316] 19%|█▊        | 28/150 [14:26<1:00:18, 29.66s/epoch, loss=1.15, accuracy=0.749, val_loss=2.45, val_accuracy=0.438, lr=0.1]    19%|█▉        | 29/150 [14:55<59:35, 29.55s/epoch, loss=1.15, accuracy=0.751, val_loss=4.33, val_accuracy=0.231, lr=0.1]   20%|██        | 30/150 [15:26<59:31, 29.76s/epoch, loss=1.15, accuracy=0.748, val_loss=1.66, val_accuracy=0.566, lr=0.1] 21%|██        | 31/150 [15:55<58:55, 29.71s/epoch, loss=1.14, accuracy=0.752, val_loss=2.23, val_accuracy=0.368, lr=0.1] 21%|██▏       | 32/150 [16:26<58:48, 29.90s/epoch, loss=1.15, accuracy=0.748, val_loss=2.32, val_accuracy=0.503, lr=0.0316] 22%|██▏       | 33/150 [16:54<57:31, 29.50s/epoch, loss=1.15, accuracy=0.75, val_loss=1.9, val_accuracy=0.493, lr=0.1]      23%|██▎       | 34/150 [17:25<57:36, 29.80s/epoch, loss=1.15, accuracy=0.748, val_loss=2.13, val_accuracy=0.513, lr=0.1] 23%|██▎       | 35/150 [17:55<57:36, 30.06s/epoch, loss=1.14, accuracy=0.751, val_loss=2.01, val_accuracy=0.534, lr=0.1] 24%|██▍       | 36/150 [18:26<57:26, 30.23s/epoch, loss=1.14, accuracy=0.752, val_loss=3.33, val_accuracy=0.282, lr=0.1] 25%|██▍       | 37/150 [18:56<56:37, 30.07s/epoch, loss=1.15, accuracy=0.751, val_loss=2.31, val_accuracy=0.456, lr=0.0316] 25%|██▌       | 38/150 [19:26<56:15, 30.14s/epoch, loss=1.14, accuracy=0.75, val_loss=3.3, val_accuracy=0.37, lr=0.1]       26%|██▌       | 39/150 [19:56<55:57, 30.25s/epoch, loss=1.14, accuracy=0.754, val_loss=2.32, val_accuracy=0.374, lr=0.1] 27%|██▋       | 40/150 [20:27<55:31, 30.29s/epoch, loss=1.14, accuracy=0.752, val_loss=2.5, val_accuracy=0.319, lr=0.1]  27%|██▋       | 41/150 [20:56<54:23, 29.94s/epoch, loss=1.15, accuracy=0.751, val_loss=2.21, val_accuracy=0.375, lr=0.1] 28%|██▊       | 42/150 [21:25<53:22, 29.65s/epoch, loss=1.14, accuracy=0.753, val_loss=1.95, val_accuracy=0.487, lr=0.0316] 29%|██▊       | 43/150 [21:54<52:29, 29.43s/epoch, loss=1.14, accuracy=0.754, val_loss=2.07, val_accuracy=0.523, lr=0.1]    29%|██▉       | 44/150 [22:23<51:52, 29.36s/epoch, loss=1.14, accuracy=0.753, val_loss=1.77, val_accuracy=0.566, lr=0.1] 30%|███       | 45/150 [22:52<51:17, 29.31s/epoch, loss=1.14, accuracy=0.753, val_loss=2.1, val_accuracy=0.458, lr=0.1]  31%|███       | 46/150 [23:22<50:54, 29.37s/epoch, loss=1.13, accuracy=0.753, val_loss=1.72, val_accuracy=0.566, lr=0.1] 31%|███▏      | 47/150 [23:51<50:15, 29.28s/epoch, loss=1.13, accuracy=0.755, val_loss=2.42, val_accuracy=0.41, lr=0.0316] 32%|███▏      | 48/150 [24:22<50:33, 29.74s/epoch, loss=1.13, accuracy=0.754, val_loss=1.84, val_accuracy=0.526, lr=0.1]   33%|███▎      | 49/150 [24:50<49:14, 29.25s/epoch, loss=1.14, accuracy=0.753, val_loss=2.02, val_accuracy=0.46, lr=0.1]  33%|███▎      | 50/150 [25:19<48:49, 29.30s/epoch, loss=1.13, accuracy=0.754, val_loss=1.71, val_accuracy=0.525, lr=0.1] 34%|███▍      | 51/150 [25:49<48:35, 29.44s/epoch, loss=1.14, accuracy=0.753, val_loss=1.49, val_accuracy=0.614, lr=0.1] 35%|███▍      | 52/150 [26:19<48:32, 29.72s/epoch, loss=1.14, accuracy=0.754, val_loss=1.84, val_accuracy=0.56, lr=0.1]  35%|███▌      | 53/150 [26:50<48:31, 30.01s/epoch, loss=1.13, accuracy=0.754, val_loss=2.96, val_accuracy=0.357, lr=0.1] 36%|███▌      | 54/150 [27:20<48:14, 30.15s/epoch, loss=1.13, accuracy=0.754, val_loss=2.39, val_accuracy=0.448, lr=0.1] 37%|███▋      | 55/150 [27:50<47:23, 29.93s/epoch, loss=1.12, accuracy=0.755, val_loss=4.06, val_accuracy=0.24, lr=0.1]  37%|███▋      | 56/150 [28:18<46:01, 29.37s/epoch, loss=1.13, accuracy=0.755, val_loss=2.6, val_accuracy=0.412, lr=0.0316] 38%|███▊      | 57/150 [28:47<45:38, 29.45s/epoch, loss=1.13, accuracy=0.754, val_loss=2.31, val_accuracy=0.409, lr=0.1]   39%|███▊      | 58/150 [29:18<45:41, 29.80s/epoch, loss=1.13, accuracy=0.754, val_loss=2.34, val_accuracy=0.45, lr=0.1]  39%|███▉      | 59/150 [29:47<44:57, 29.64s/epoch, loss=1.13, accuracy=0.755, val_loss=2.08, val_accuracy=0.444, lr=0.1] 40%|████      | 60/150 [30:16<44:05, 29.39s/epoch, loss=1.14, accuracy=0.754, val_loss=1.57, val_accuracy=0.597, lr=0.1] 41%|████      | 61/150 [30:45<43:23, 29.26s/epoch, loss=1.14, accuracy=0.752, val_loss=3.46, val_accuracy=0.289, lr=0.0316] 41%|████▏     | 62/150 [31:14<42:56, 29.28s/epoch, loss=1.12, accuracy=0.757, val_loss=1.79, val_accuracy=0.569, lr=0.1]    42%|████▏     | 63/150 [31:44<42:31, 29.33s/epoch, loss=1.13, accuracy=0.755, val_loss=2.55, val_accuracy=0.395, lr=0.1] 43%|████▎     | 64/150 [32:13<41:48, 29.17s/epoch, loss=1.13, accuracy=0.756, val_loss=1.71, val_accuracy=0.569, lr=0.1] 43%|████▎     | 65/150 [32:42<41:18, 29.16s/epoch, loss=1.12, accuracy=0.759, val_loss=1.67, val_accuracy=0.604, lr=0.1] 44%|████▍     | 66/150 [33:11<41:01, 29.31s/epoch, loss=1.12, accuracy=0.756, val_loss=2.48, val_accuracy=0.368, lr=0.0316] 45%|████▍     | 67/150 [33:41<40:34, 29.33s/epoch, loss=1.12, accuracy=0.757, val_loss=2.1, val_accuracy=0.473, lr=0.1]     45%|████▌     | 68/150 [34:10<40:00, 29.27s/epoch, loss=1.13, accuracy=0.756, val_loss=1.93, val_accuracy=0.5, lr=0.1]  46%|████▌     | 69/150 [34:37<38:46, 28.72s/epoch, loss=1.12, accuracy=0.757, val_loss=2.78, val_accuracy=0.378, lr=0.1] 47%|████▋     | 70/150 [35:07<38:39, 28.99s/epoch, loss=1.14, accuracy=0.756, val_loss=1.51, val_accuracy=0.658, lr=0.1] 47%|████▋     | 71/150 [35:37<38:30, 29.24s/epoch, loss=1.12, accuracy=0.756, val_loss=2.34, val_accuracy=0.469, lr=0.0316] 48%|████▊     | 72/150 [36:07<38:09, 29.36s/epoch, loss=1.12, accuracy=0.756, val_loss=2.19, val_accuracy=0.495, lr=0.1]    49%|████▊     | 73/150 [36:37<37:55, 29.55s/epoch, loss=1.13, accuracy=0.755, val_loss=1.99, val_accuracy=0.544, lr=0.1] 49%|████▉     | 74/150 [37:05<37:01, 29.24s/epoch, loss=1.12, accuracy=0.758, val_loss=2.29, val_accuracy=0.421, lr=0.1] 50%|█████     | 75/150 [37:33<36:10, 28.94s/epoch, loss=1.12, accuracy=0.758, val_loss=2.04, val_accuracy=0.494, lr=0.1] 51%|█████     | 76/150 [38:01<35:17, 28.62s/epoch, loss=1.12, accuracy=0.757, val_loss=4.22, val_accuracy=0.271, lr=0.0316] 51%|█████▏    | 77/150 [38:31<35:06, 28.86s/epoch, loss=1.13, accuracy=0.757, val_loss=1.78, val_accuracy=0.524, lr=0.1]    52%|█████▏    | 78/150 [39:01<35:07, 29.28s/epoch, loss=1.12, accuracy=0.757, val_loss=2.47, val_accuracy=0.361, lr=0.1] 53%|█████▎    | 79/150 [39:30<34:44, 29.36s/epoch, loss=1.12, accuracy=0.758, val_loss=1.98, val_accuracy=0.493, lr=0.1] 53%|█████▎    | 80/150 [40:00<34:22, 29.46s/epoch, loss=1.11, accuracy=0.758, val_loss=2.54, val_accuracy=0.419, lr=0.1] 54%|█████▍    | 81/150 [40:29<33:49, 29.42s/epoch, loss=1.12, accuracy=0.758, val_loss=1.72, val_accuracy=0.58, lr=0.0316] 55%|█████▍    | 82/150 [40:57<32:53, 29.02s/epoch, loss=0.91, accuracy=0.816, val_loss=0.881, val_accuracy=0.812, lr=0.01] 55%|█████▌    | 83/150 [41:27<32:43, 29.31s/epoch, loss=0.733, accuracy=0.848, val_loss=0.891, val_accuracy=0.776, lr=0.01] 56%|█████▌    | 84/150 [41:57<32:20, 29.40s/epoch, loss=0.654, accuracy=0.855, val_loss=0.798, val_accuracy=0.795, lr=0.01] 57%|█████▋    | 85/150 [42:27<31:52, 29.42s/epoch, loss=0.608, accuracy=0.86, val_loss=0.728, val_accuracy=0.818, lr=0.01]  57%|█████▋    | 86/150 [42:56<31:16, 29.32s/epoch, loss=0.587, accuracy=0.859, val_loss=1.14, val_accuracy=0.707, lr=0.01] 58%|█████▊    | 87/150 [43:25<30:39, 29.19s/epoch, loss=0.577, accuracy=0.861, val_loss=0.848, val_accuracy=0.779, lr=0.01] 59%|█████▊    | 88/150 [43:53<29:54, 28.95s/epoch, loss=0.57, accuracy=0.862, val_loss=0.726, val_accuracy=0.811, lr=0.01]  59%|█████▉    | 89/150 [44:22<29:28, 28.99s/epoch, loss=0.561, accuracy=0.866, val_loss=0.827, val_accuracy=0.79, lr=0.01] 60%|██████    | 90/150 [44:52<29:11, 29.19s/epoch, loss=0.564, accuracy=0.866, val_loss=0.875, val_accuracy=0.77, lr=0.01] 61%|██████    | 91/150 [45:22<29:04, 29.58s/epoch, loss=0.563, accuracy=0.866, val_loss=0.979, val_accuracy=0.727, lr=0.01] 61%|██████▏   | 92/150 [45:51<28:25, 29.40s/epoch, loss=0.557, accuracy=0.87, val_loss=0.887, val_accuracy=0.752, lr=0.01]  62%|██████▏   | 93/150 [46:19<27:25, 28.87s/epoch, loss=0.562, accuracy=0.868, val_loss=0.723, val_accuracy=0.814, lr=0.01] 63%|██████▎   | 94/150 [46:49<27:25, 29.38s/epoch, loss=0.558, accuracy=0.871, val_loss=0.87, val_accuracy=0.768, lr=0.01]  63%|██████▎   | 95/150 [47:17<26:35, 29.01s/epoch, loss=0.556, accuracy=0.873, val_loss=0.744, val_accuracy=0.813, lr=0.01] 64%|██████▍   | 96/150 [47:45<25:43, 28.58s/epoch, loss=0.556, accuracy=0.873, val_loss=0.837, val_accuracy=0.779, lr=0.01] 65%|██████▍   | 97/150 [48:15<25:36, 29.00s/epoch, loss=0.553, accuracy=0.876, val_loss=0.977, val_accuracy=0.74, lr=0.01]  65%|██████▌   | 98/150 [48:45<25:25, 29.33s/epoch, loss=0.552, accuracy=0.877, val_loss=0.838, val_accuracy=0.791, lr=0.00316] 66%|██████▌   | 99/150 [49:13<24:35, 28.93s/epoch, loss=0.557, accuracy=0.874, val_loss=0.708, val_accuracy=0.83, lr=0.01]     67%|██████▋   | 100/150 [49:42<24:00, 28.82s/epoch, loss=0.552, accuracy=0.876, val_loss=1, val_accuracy=0.743, lr=0.01]   67%|██████▋   | 101/150 [50:11<23:33, 28.85s/epoch, loss=0.557, accuracy=0.877, val_loss=0.899, val_accuracy=0.777, lr=0.01] 68%|██████▊   | 102/150 [50:38<22:48, 28.51s/epoch, loss=0.557, accuracy=0.876, val_loss=0.805, val_accuracy=0.794, lr=0.01] 69%|██████▊   | 103/150 [51:08<22:40, 28.95s/epoch, loss=0.556, accuracy=0.878, val_loss=1.11, val_accuracy=0.731, lr=0.01]  69%|██████▉   | 104/150 [51:36<22:00, 28.71s/epoch, loss=0.557, accuracy=0.879, val_loss=0.753, val_accuracy=0.813, lr=0.00316] 70%|███████   | 105/150 [52:04<21:22, 28.51s/epoch, loss=0.551, accuracy=0.881, val_loss=0.755, val_accuracy=0.815, lr=0.01]    71%|███████   | 106/150 [52:34<21:01, 28.68s/epoch, loss=0.554, accuracy=0.879, val_loss=0.799, val_accuracy=0.801, lr=0.01] 71%|███████▏  | 107/150 [53:03<20:45, 28.97s/epoch, loss=0.56, accuracy=0.879, val_loss=0.725, val_accuracy=0.831, lr=0.01]  72%|███████▏  | 108/150 [53:33<20:33, 29.36s/epoch, loss=0.549, accuracy=0.883, val_loss=0.88, val_accuracy=0.787, lr=0.01] 73%|███████▎  | 109/150 [54:04<20:14, 29.63s/epoch, loss=0.558, accuracy=0.881, val_loss=1.1, val_accuracy=0.726, lr=0.00316] 73%|███████▎  | 110/150 [54:34<19:54, 29.87s/epoch, loss=0.554, accuracy=0.881, val_loss=0.839, val_accuracy=0.802, lr=0.01]  74%|███████▍  | 111/150 [55:04<19:27, 29.92s/epoch, loss=0.556, accuracy=0.882, val_loss=1.05, val_accuracy=0.729, lr=0.01]  75%|███████▍  | 112/150 [55:33<18:39, 29.45s/epoch, loss=0.56, accuracy=0.879, val_loss=0.843, val_accuracy=0.798, lr=0.01] 75%|███████▌  | 113/150 [56:01<18:04, 29.30s/epoch, loss=0.555, accuracy=0.881, val_loss=0.768, val_accuracy=0.814, lr=0.01] 76%|███████▌  | 114/150 [56:31<17:36, 29.36s/epoch, loss=0.555, accuracy=0.881, val_loss=0.853, val_accuracy=0.79, lr=0.00316] 77%|███████▋  | 115/150 [57:01<17:15, 29.58s/epoch, loss=0.553, accuracy=0.884, val_loss=0.981, val_accuracy=0.762, lr=0.01]   77%|███████▋  | 116/150 [57:30<16:39, 29.40s/epoch, loss=0.553, accuracy=0.883, val_loss=0.816, val_accuracy=0.807, lr=0.01] 78%|███████▊  | 117/150 [58:00<16:14, 29.54s/epoch, loss=0.552, accuracy=0.884, val_loss=0.943, val_accuracy=0.753, lr=0.01] 79%|███████▊  | 118/150 [58:29<15:42, 29.46s/epoch, loss=0.558, accuracy=0.883, val_loss=1.02, val_accuracy=0.744, lr=0.01]  79%|███████▉  | 119/150 [58:59<15:20, 29.69s/epoch, loss=0.554, accuracy=0.884, val_loss=0.823, val_accuracy=0.809, lr=0.00316] 80%|████████  | 120/150 [59:28<14:37, 29.25s/epoch, loss=0.554, accuracy=0.882, val_loss=1.21, val_accuracy=0.718, lr=0.01]     81%|████████  | 121/150 [59:57<14:05, 29.17s/epoch, loss=0.555, accuracy=0.885, val_loss=1.01, val_accuracy=0.743, lr=0.01] 81%|████████▏ | 122/150 [1:00:26<13:37, 29.20s/epoch, loss=0.474, accuracy=0.912, val_loss=0.541, val_accuracy=0.891, lr=0.001] 82%|████████▏ | 123/150 [1:00:56<13:18, 29.57s/epoch, loss=0.423, accuracy=0.928, val_loss=0.528, val_accuracy=0.893, lr=0.001] 83%|████████▎ | 124/150 [1:01:25<12:42, 29.34s/epoch, loss=0.4, accuracy=0.934, val_loss=0.522, val_accuracy=0.893, lr=0.001]   83%|████████▎ | 125/150 [1:01:56<12:21, 29.65s/epoch, loss=0.386, accuracy=0.936, val_loss=0.507, val_accuracy=0.897, lr=0.001] 84%|████████▍ | 126/150 [1:02:24<11:41, 29.23s/epoch, loss=0.373, accuracy=0.94, val_loss=0.498, val_accuracy=0.897, lr=0.001]  85%|████████▍ | 127/150 [1:02:53<11:11, 29.22s/epoch, loss=0.36, accuracy=0.942, val_loss=0.491, val_accuracy=0.9, lr=0.001]   85%|████████▌ | 128/150 [1:03:21<10:34, 28.83s/epoch, loss=0.348, accuracy=0.945, val_loss=0.497, val_accuracy=0.897, lr=0.001] 86%|████████▌ | 129/150 [1:03:51<10:14, 29.27s/epoch, loss=0.342, accuracy=0.944, val_loss=0.482, val_accuracy=0.899, lr=0.001] 87%|████████▋ | 130/150 [1:04:21<09:47, 29.40s/epoch, loss=0.33, accuracy=0.947, val_loss=0.48, val_accuracy=0.9, lr=0.001]     87%|████████▋ | 131/150 [1:04:50<09:18, 29.41s/epoch, loss=0.322, accuracy=0.949, val_loss=0.469, val_accuracy=0.902, lr=0.001] 88%|████████▊ | 132/150 [1:05:19<08:45, 29.17s/epoch, loss=0.314, accuracy=0.95, val_loss=0.48, val_accuracy=0.896, lr=0.001]   89%|████████▊ | 133/150 [1:05:49<08:22, 29.58s/epoch, loss=0.307, accuracy=0.952, val_loss=0.468, val_accuracy=0.899, lr=0.001] 89%|████████▉ | 134/150 [1:06:18<07:46, 29.14s/epoch, loss=0.3, accuracy=0.952, val_loss=0.481, val_accuracy=0.898, lr=0.001]   90%|█████████ | 135/150 [1:06:47<07:19, 29.28s/epoch, loss=0.292, accuracy=0.953, val_loss=0.487, val_accuracy=0.891, lr=0.001] 91%|█████████ | 136/150 [1:07:16<06:49, 29.21s/epoch, loss=0.284, accuracy=0.955, val_loss=0.465, val_accuracy=0.9, lr=0.001]   91%|█████████▏| 137/150 [1:07:46<06:20, 29.25s/epoch, loss=0.278, accuracy=0.956, val_loss=0.477, val_accuracy=0.897, lr=0.001] 92%|█████████▏| 138/150 [1:08:13<05:44, 28.73s/epoch, loss=0.274, accuracy=0.955, val_loss=0.472, val_accuracy=0.897, lr=0.001] 93%|█████████▎| 139/150 [1:08:42<05:16, 28.76s/epoch, loss=0.268, accuracy=0.957, val_loss=0.459, val_accuracy=0.899, lr=0.001] 93%|█████████▎| 140/150 [1:09:10<04:45, 28.59s/epoch, loss=0.26, accuracy=0.958, val_loss=0.518, val_accuracy=0.88, lr=0.001]   94%|█████████▍| 141/150 [1:09:38<04:14, 28.27s/epoch, loss=0.258, accuracy=0.959, val_loss=0.494, val_accuracy=0.886, lr=0.001] 95%|█████████▍| 142/150 [1:10:07<03:48, 28.57s/epoch, loss=0.256, accuracy=0.958, val_loss=0.476, val_accuracy=0.892, lr=0.001] 95%|█████████▌| 143/150 [1:10:36<03:20, 28.58s/epoch, loss=0.249, accuracy=0.96, val_loss=0.467, val_accuracy=0.896, lr=0.001]  96%|█████████▌| 144/150 [1:11:04<02:51, 28.66s/epoch, loss=0.244, accuracy=0.961, val_loss=0.495, val_accuracy=0.888, lr=0.000316] 97%|█████████▋| 145/150 [1:11:35<02:26, 29.21s/epoch, loss=0.243, accuracy=0.959, val_loss=0.466, val_accuracy=0.896, lr=0.001]    97%|█████████▋| 146/150 [1:12:04<01:56, 29.25s/epoch, loss=0.24, accuracy=0.96, val_loss=0.471, val_accuracy=0.896, lr=0.001]   98%|█████████▊| 147/150 [1:12:34<01:28, 29.38s/epoch, loss=0.238, accuracy=0.959, val_loss=0.467, val_accuracy=0.891, lr=0.001] 99%|█████████▊| 148/150 [1:13:03<00:58, 29.44s/epoch, loss=0.235, accuracy=0.961, val_loss=0.482, val_accuracy=0.892, lr=0.001] 99%|█████████▉| 149/150 [1:13:32<00:29, 29.16s/epoch, loss=0.233, accuracy=0.961, val_loss=0.489, val_accuracy=0.883, lr=0.000316]100%|██████████| 150/150 [1:14:02<00:00, 29.35s/epoch, loss=0.232, accuracy=0.961, val_loss=0.48, val_accuracy=0.89, lr=0.001]     100%|██████████| 150/150 [1:14:02<00:00, 29.62s/epoch, loss=0.232, accuracy=0.961, val_loss=0.48, val_accuracy=0.89, lr=0.001]
Using real-time data augmentation.
Test loss: 0.47974130511283875
Test accuracy: 0.8898000121116638


* * * Run SGD for ID = 10_8. * * *


2024-02-15 19:50:19.098205: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 19:50:21.959528: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 19:50:21.960760: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-15 19:50:22.003258: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 19:50:22.003310: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 19:50:22.006657: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 19:50:22.006727: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 19:50:22.009110: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 19:50:22.009794: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 19:50:22.012475: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 19:50:22.014153: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 19:50:22.020063: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 19:50:22.020715: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 19:50:22.020795: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 19:50:23.318294: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-15 19:50:23.319368: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 19:50:23.321876: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 19:50:23.321910: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 19:50:23.321945: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 19:50:23.321959: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 19:50:23.321972: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 19:50:23.321985: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 19:50:23.321998: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 19:50:23.322011: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 19:50:23.322024: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 19:50:23.322537: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 19:50:23.322600: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 19:50:24.020428: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-15 19:50:24.020494: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-15 19:50:24.020506: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-15 19:50:24.023475: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:3b:00.0, compute capability: 6.1)
{'id': 108, 'batch_size': 128, 'epochs': 150, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/150 [00:00<?, ?epoch/s]2024-02-15 19:50:24.819744: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-15 19:50:24.831745: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-02-15 19:50:26.850181: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 19:50:27.197010: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 19:50:28.200077: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-15 19:50:28.255729: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/150 [01:00<2:31:22, 60.96s/epoch, loss=3.24, accuracy=0.299, val_loss=2.16, val_accuracy=0.284, lr=0.1]  1%|▏         | 2/150 [01:29<1:42:47, 41.67s/epoch, loss=1.57, accuracy=0.526, val_loss=1.97, val_accuracy=0.423, lr=0.1]  2%|▏         | 3/150 [01:57<1:27:39, 35.78s/epoch, loss=1.36, accuracy=0.622, val_loss=1.87, val_accuracy=0.463, lr=0.1]  3%|▎         | 4/150 [02:28<1:22:11, 33.78s/epoch, loss=1.27, accuracy=0.672, val_loss=1.85, val_accuracy=0.491, lr=0.1]  3%|▎         | 5/150 [02:57<1:17:20, 32.00s/epoch, loss=1.25, accuracy=0.692, val_loss=1.6, val_accuracy=0.564, lr=0.1]   4%|▍         | 6/150 [03:25<1:13:44, 30.72s/epoch, loss=1.22, accuracy=0.708, val_loss=3.4, val_accuracy=0.323, lr=0.1]  5%|▍         | 7/150 [03:55<1:12:42, 30.51s/epoch, loss=1.21, accuracy=0.717, val_loss=2.48, val_accuracy=0.37, lr=0.1]  5%|▌         | 8/150 [04:26<1:12:07, 30.48s/epoch, loss=1.21, accuracy=0.722, val_loss=2.97, val_accuracy=0.337, lr=0.1]  6%|▌         | 9/150 [04:54<1:10:05, 29.83s/epoch, loss=1.21, accuracy=0.728, val_loss=2.22, val_accuracy=0.442, lr=0.1]  7%|▋         | 10/150 [05:24<1:09:40, 29.86s/epoch, loss=1.2, accuracy=0.729, val_loss=1.94, val_accuracy=0.516, lr=0.0316]  7%|▋         | 11/150 [05:54<1:09:33, 30.02s/epoch, loss=1.2, accuracy=0.73, val_loss=1.71, val_accuracy=0.532, lr=0.1]      8%|▊         | 12/150 [06:24<1:08:49, 29.92s/epoch, loss=1.19, accuracy=0.737, val_loss=1.73, val_accuracy=0.597, lr=0.1]  9%|▊         | 13/150 [06:54<1:08:38, 30.06s/epoch, loss=1.19, accuracy=0.737, val_loss=1.86, val_accuracy=0.584, lr=0.1]  9%|▉         | 14/150 [07:24<1:07:28, 29.77s/epoch, loss=1.18, accuracy=0.739, val_loss=3.22, val_accuracy=0.371, lr=0.1] 10%|█         | 15/150 [07:53<1:06:28, 29.54s/epoch, loss=1.19, accuracy=0.737, val_loss=1.54, val_accuracy=0.618, lr=0.1] 11%|█         | 16/150 [08:22<1:05:47, 29.46s/epoch, loss=1.18, accuracy=0.741, val_loss=2.15, val_accuracy=0.487, lr=0.1] 11%|█▏        | 17/150 [08:52<1:05:47, 29.68s/epoch, loss=1.17, accuracy=0.744, val_loss=3.27, val_accuracy=0.387, lr=0.1] 12%|█▏        | 18/150 [09:22<1:05:27, 29.75s/epoch, loss=1.17, accuracy=0.745, val_loss=1.52, val_accuracy=0.625, lr=0.1] 13%|█▎        | 19/150 [09:51<1:04:48, 29.69s/epoch, loss=1.18, accuracy=0.742, val_loss=1.25, val_accuracy=0.72, lr=0.1]  13%|█▎        | 20/150 [10:21<1:03:58, 29.53s/epoch, loss=1.17, accuracy=0.743, val_loss=1.89, val_accuracy=0.536, lr=0.1] 14%|█▍        | 21/150 [10:50<1:03:07, 29.36s/epoch, loss=1.17, accuracy=0.746, val_loss=1.51, val_accuracy=0.623, lr=0.1] 15%|█▍        | 22/150 [11:20<1:03:35, 29.81s/epoch, loss=1.17, accuracy=0.745, val_loss=2.44, val_accuracy=0.384, lr=0.1] 15%|█▌        | 23/150 [11:50<1:02:46, 29.66s/epoch, loss=1.17, accuracy=0.747, val_loss=2.18, val_accuracy=0.437, lr=0.1] 16%|█▌        | 24/150 [12:18<1:01:26, 29.26s/epoch, loss=1.17, accuracy=0.747, val_loss=1.88, val_accuracy=0.547, lr=0.0316] 17%|█▋        | 25/150 [12:48<1:01:18, 29.43s/epoch, loss=1.16, accuracy=0.747, val_loss=1.61, val_accuracy=0.601, lr=0.1]    17%|█▋        | 26/150 [13:18<1:01:13, 29.63s/epoch, loss=1.16, accuracy=0.751, val_loss=2.76, val_accuracy=0.39, lr=0.1]  18%|█▊        | 27/150 [13:48<1:00:38, 29.58s/epoch, loss=1.16, accuracy=0.748, val_loss=1.74, val_accuracy=0.558, lr=0.1] 19%|█▊        | 28/150 [14:18<1:00:51, 29.93s/epoch, loss=1.16, accuracy=0.751, val_loss=1.7, val_accuracy=0.596, lr=0.1]  19%|█▉        | 29/150 [14:49<1:01:01, 30.26s/epoch, loss=1.15, accuracy=0.752, val_loss=2.33, val_accuracy=0.464, lr=0.0316] 20%|██        | 30/150 [15:20<1:00:41, 30.34s/epoch, loss=1.15, accuracy=0.752, val_loss=1.58, val_accuracy=0.622, lr=0.1]    21%|██        | 31/150 [15:50<1:00:20, 30.43s/epoch, loss=1.16, accuracy=0.749, val_loss=1.43, val_accuracy=0.648, lr=0.1] 21%|██▏       | 32/150 [16:21<1:00:10, 30.60s/epoch, loss=1.15, accuracy=0.75, val_loss=1.5, val_accuracy=0.614, lr=0.1]   22%|██▏       | 33/150 [16:50<58:16, 29.89s/epoch, loss=1.16, accuracy=0.748, val_loss=1.99, val_accuracy=0.522, lr=0.1] 23%|██▎       | 34/150 [17:19<57:29, 29.74s/epoch, loss=1.16, accuracy=0.75, val_loss=1.74, val_accuracy=0.587, lr=0.0316] 23%|██▎       | 35/150 [17:50<57:30, 30.00s/epoch, loss=1.15, accuracy=0.753, val_loss=1.5, val_accuracy=0.614, lr=0.1]    24%|██▍       | 36/150 [18:20<57:10, 30.10s/epoch, loss=1.15, accuracy=0.753, val_loss=1.67, val_accuracy=0.572, lr=0.1] 25%|██▍       | 37/150 [18:49<55:58, 29.72s/epoch, loss=1.15, accuracy=0.753, val_loss=2.84, val_accuracy=0.386, lr=0.1] 25%|██▌       | 38/150 [19:19<55:34, 29.77s/epoch, loss=1.15, accuracy=0.754, val_loss=3.16, val_accuracy=0.269, lr=0.1] 26%|██▌       | 39/150 [19:47<54:26, 29.42s/epoch, loss=1.14, accuracy=0.755, val_loss=2.17, val_accuracy=0.489, lr=0.0316] 27%|██▋       | 40/150 [20:17<54:21, 29.65s/epoch, loss=1.15, accuracy=0.754, val_loss=1.77, val_accuracy=0.599, lr=0.1]    27%|██▋       | 41/150 [20:48<54:20, 29.91s/epoch, loss=1.14, accuracy=0.754, val_loss=2.1, val_accuracy=0.498, lr=0.1]  28%|██▊       | 42/150 [21:18<53:54, 29.95s/epoch, loss=1.14, accuracy=0.755, val_loss=1.4, val_accuracy=0.67, lr=0.1]  29%|██▊       | 43/150 [21:48<53:08, 29.80s/epoch, loss=1.14, accuracy=0.756, val_loss=2.5, val_accuracy=0.463, lr=0.1] 29%|██▉       | 44/150 [22:18<53:06, 30.07s/epoch, loss=1.14, accuracy=0.757, val_loss=3.59, val_accuracy=0.309, lr=0.0316] 30%|███       | 45/150 [22:48<52:17, 29.88s/epoch, loss=1.14, accuracy=0.756, val_loss=1.61, val_accuracy=0.586, lr=0.1]    31%|███       | 46/150 [23:16<50:52, 29.35s/epoch, loss=1.14, accuracy=0.756, val_loss=1.64, val_accuracy=0.571, lr=0.1] 31%|███▏      | 47/150 [23:45<50:28, 29.40s/epoch, loss=1.14, accuracy=0.756, val_loss=2.31, val_accuracy=0.5, lr=0.1]   32%|███▏      | 48/150 [24:16<50:37, 29.78s/epoch, loss=1.13, accuracy=0.755, val_loss=1.77, val_accuracy=0.53, lr=0.1] 33%|███▎      | 49/150 [24:45<49:58, 29.69s/epoch, loss=1.14, accuracy=0.754, val_loss=2.03, val_accuracy=0.499, lr=0.0316] 33%|███▎      | 50/150 [25:16<49:53, 29.93s/epoch, loss=1.13, accuracy=0.755, val_loss=1.43, val_accuracy=0.667, lr=0.1]    34%|███▍      | 51/150 [25:46<49:15, 29.85s/epoch, loss=1.14, accuracy=0.751, val_loss=1.78, val_accuracy=0.543, lr=0.1] 35%|███▍      | 52/150 [26:16<49:15, 30.15s/epoch, loss=1.15, accuracy=0.755, val_loss=3.79, val_accuracy=0.273, lr=0.1] 35%|███▌      | 53/150 [26:45<47:51, 29.60s/epoch, loss=1.14, accuracy=0.754, val_loss=2.73, val_accuracy=0.292, lr=0.1] 36%|███▌      | 54/150 [27:13<46:42, 29.20s/epoch, loss=1.13, accuracy=0.755, val_loss=1.78, val_accuracy=0.533, lr=0.0316] 37%|███▋      | 55/150 [27:44<46:50, 29.58s/epoch, loss=1.14, accuracy=0.755, val_loss=1.49, val_accuracy=0.649, lr=0.1]    37%|███▋      | 56/150 [28:12<45:56, 29.32s/epoch, loss=1.13, accuracy=0.754, val_loss=2.1, val_accuracy=0.444, lr=0.1]  38%|███▊      | 57/150 [28:43<46:00, 29.69s/epoch, loss=1.13, accuracy=0.757, val_loss=1.74, val_accuracy=0.543, lr=0.1] 39%|███▊      | 58/150 [29:13<45:36, 29.75s/epoch, loss=1.13, accuracy=0.757, val_loss=1.79, val_accuracy=0.549, lr=0.1] 39%|███▉      | 59/150 [29:41<44:22, 29.26s/epoch, loss=1.13, accuracy=0.761, val_loss=1.43, val_accuracy=0.631, lr=0.0316] 40%|████      | 60/150 [30:10<43:54, 29.27s/epoch, loss=1.13, accuracy=0.757, val_loss=2.05, val_accuracy=0.463, lr=0.1]    41%|████      | 61/150 [30:40<43:39, 29.43s/epoch, loss=1.12, accuracy=0.757, val_loss=3.49, val_accuracy=0.294, lr=0.1] 41%|████▏     | 62/150 [31:11<43:50, 29.90s/epoch, loss=1.13, accuracy=0.756, val_loss=1.66, val_accuracy=0.592, lr=0.1] 42%|████▏     | 63/150 [31:40<43:13, 29.81s/epoch, loss=1.12, accuracy=0.756, val_loss=1.99, val_accuracy=0.478, lr=0.1] 43%|████▎     | 64/150 [32:09<42:09, 29.42s/epoch, loss=1.13, accuracy=0.755, val_loss=2.07, val_accuracy=0.554, lr=0.0316] 43%|████▎     | 65/150 [32:39<41:48, 29.51s/epoch, loss=1.12, accuracy=0.756, val_loss=2.06, val_accuracy=0.462, lr=0.1]    44%|████▍     | 66/150 [33:09<41:43, 29.81s/epoch, loss=1.12, accuracy=0.759, val_loss=1.41, val_accuracy=0.669, lr=0.1] 45%|████▍     | 67/150 [33:40<41:28, 29.98s/epoch, loss=1.13, accuracy=0.756, val_loss=1.74, val_accuracy=0.576, lr=0.1] 45%|████▌     | 68/150 [34:10<41:07, 30.09s/epoch, loss=1.13, accuracy=0.759, val_loss=2.08, val_accuracy=0.422, lr=0.1] 46%|████▌     | 69/150 [34:40<40:46, 30.21s/epoch, loss=1.12, accuracy=0.76, val_loss=2.31, val_accuracy=0.455, lr=0.0316] 47%|████▋     | 70/150 [35:10<40:09, 30.11s/epoch, loss=1.13, accuracy=0.756, val_loss=1.98, val_accuracy=0.48, lr=0.1]    47%|████▋     | 71/150 [35:41<39:45, 30.20s/epoch, loss=1.13, accuracy=0.758, val_loss=2.21, val_accuracy=0.488, lr=0.1] 48%|████▊     | 72/150 [36:11<39:08, 30.11s/epoch, loss=1.12, accuracy=0.758, val_loss=1.91, val_accuracy=0.527, lr=0.1] 49%|████▊     | 73/150 [36:40<38:24, 29.93s/epoch, loss=1.12, accuracy=0.76, val_loss=2.64, val_accuracy=0.369, lr=0.1]  49%|████▉     | 74/150 [37:10<37:51, 29.89s/epoch, loss=1.12, accuracy=0.758, val_loss=1.8, val_accuracy=0.554, lr=0.0316] 50%|█████     | 75/150 [37:39<37:12, 29.77s/epoch, loss=1.13, accuracy=0.757, val_loss=1.98, val_accuracy=0.513, lr=0.1]   51%|█████     | 76/150 [38:09<36:43, 29.77s/epoch, loss=1.12, accuracy=0.758, val_loss=2.11, val_accuracy=0.415, lr=0.1] 51%|█████▏    | 77/150 [38:38<36:03, 29.64s/epoch, loss=1.13, accuracy=0.758, val_loss=1.71, val_accuracy=0.582, lr=0.1] 52%|█████▏    | 78/150 [39:07<35:18, 29.42s/epoch, loss=1.13, accuracy=0.757, val_loss=1.76, val_accuracy=0.534, lr=0.1] 53%|█████▎    | 79/150 [39:37<35:03, 29.62s/epoch, loss=1.13, accuracy=0.757, val_loss=2.19, val_accuracy=0.51, lr=0.0316] 53%|█████▎    | 80/150 [40:06<34:06, 29.23s/epoch, loss=1.12, accuracy=0.758, val_loss=1.83, val_accuracy=0.535, lr=0.1]   54%|█████▍    | 81/150 [40:34<33:10, 28.85s/epoch, loss=1.12, accuracy=0.758, val_loss=2.55, val_accuracy=0.444, lr=0.1] 55%|█████▍    | 82/150 [41:03<32:54, 29.04s/epoch, loss=0.904, accuracy=0.82, val_loss=0.954, val_accuracy=0.78, lr=0.01] 55%|█████▌    | 83/150 [41:33<32:31, 29.13s/epoch, loss=0.727, accuracy=0.848, val_loss=0.783, val_accuracy=0.819, lr=0.01] 56%|█████▌    | 84/150 [42:03<32:25, 29.47s/epoch, loss=0.648, accuracy=0.858, val_loss=0.899, val_accuracy=0.765, lr=0.01] 57%|█████▋    | 85/150 [42:33<32:07, 29.65s/epoch, loss=0.609, accuracy=0.859, val_loss=0.709, val_accuracy=0.82, lr=0.01]  57%|█████▋    | 86/150 [43:03<31:42, 29.73s/epoch, loss=0.581, accuracy=0.863, val_loss=0.753, val_accuracy=0.806, lr=0.01] 58%|█████▊    | 87/150 [43:33<31:25, 29.93s/epoch, loss=0.574, accuracy=0.863, val_loss=0.716, val_accuracy=0.817, lr=0.01] 59%|█████▊    | 88/150 [44:03<30:44, 29.75s/epoch, loss=0.568, accuracy=0.863, val_loss=0.709, val_accuracy=0.818, lr=0.01] 59%|█████▉    | 89/150 [44:33<30:23, 29.90s/epoch, loss=0.566, accuracy=0.865, val_loss=0.721, val_accuracy=0.814, lr=0.01] 60%|██████    | 90/150 [45:03<29:55, 29.92s/epoch, loss=0.565, accuracy=0.865, val_loss=0.692, val_accuracy=0.822, lr=0.01] 61%|██████    | 91/150 [45:33<29:37, 30.13s/epoch, loss=0.559, accuracy=0.868, val_loss=1.13, val_accuracy=0.723, lr=0.01]  61%|██████▏   | 92/150 [46:02<28:37, 29.62s/epoch, loss=0.559, accuracy=0.871, val_loss=0.834, val_accuracy=0.781, lr=0.01] 62%|██████▏   | 93/150 [46:32<28:20, 29.83s/epoch, loss=0.557, accuracy=0.872, val_loss=0.879, val_accuracy=0.769, lr=0.01] 63%|██████▎   | 94/150 [47:02<27:47, 29.78s/epoch, loss=0.554, accuracy=0.872, val_loss=0.74, val_accuracy=0.814, lr=0.01]  63%|██████▎   | 95/150 [47:32<27:26, 29.93s/epoch, loss=0.558, accuracy=0.873, val_loss=0.993, val_accuracy=0.751, lr=0.00316] 64%|██████▍   | 96/150 [48:02<27:03, 30.06s/epoch, loss=0.557, accuracy=0.874, val_loss=0.729, val_accuracy=0.827, lr=0.01]    65%|██████▍   | 97/150 [48:32<26:30, 30.01s/epoch, loss=0.555, accuracy=0.874, val_loss=0.918, val_accuracy=0.749, lr=0.01] 65%|██████▌   | 98/150 [49:01<25:32, 29.47s/epoch, loss=0.551, accuracy=0.877, val_loss=0.83, val_accuracy=0.794, lr=0.01]  66%|██████▌   | 99/150 [49:29<24:53, 29.29s/epoch, loss=0.555, accuracy=0.876, val_loss=1.47, val_accuracy=0.684, lr=0.01] 67%|██████▋   | 100/150 [49:59<24:32, 29.45s/epoch, loss=0.555, accuracy=0.878, val_loss=0.848, val_accuracy=0.781, lr=0.00316] 67%|██████▋   | 101/150 [50:26<23:29, 28.76s/epoch, loss=0.554, accuracy=0.877, val_loss=0.756, val_accuracy=0.808, lr=0.01]    68%|██████▊   | 102/150 [50:56<23:15, 29.08s/epoch, loss=0.553, accuracy=0.878, val_loss=0.989, val_accuracy=0.766, lr=0.01] 69%|██████▊   | 103/150 [51:26<23:01, 29.39s/epoch, loss=0.553, accuracy=0.877, val_loss=1.02, val_accuracy=0.734, lr=0.01]  69%|██████▉   | 104/150 [51:56<22:41, 29.59s/epoch, loss=0.552, accuracy=0.879, val_loss=0.801, val_accuracy=0.8, lr=0.01]  70%|███████   | 105/150 [52:27<22:21, 29.80s/epoch, loss=0.553, accuracy=0.879, val_loss=0.957, val_accuracy=0.764, lr=0.00316] 71%|███████   | 106/150 [52:56<21:47, 29.72s/epoch, loss=0.548, accuracy=0.882, val_loss=0.957, val_accuracy=0.772, lr=0.01]    71%|███████▏  | 107/150 [53:24<20:58, 29.27s/epoch, loss=0.551, accuracy=0.881, val_loss=0.846, val_accuracy=0.791, lr=0.01] 72%|███████▏  | 108/150 [53:55<20:50, 29.78s/epoch, loss=0.551, accuracy=0.88, val_loss=0.737, val_accuracy=0.825, lr=0.01]  73%|███████▎  | 109/150 [54:23<19:50, 29.05s/epoch, loss=0.552, accuracy=0.881, val_loss=0.766, val_accuracy=0.82, lr=0.01] 73%|███████▎  | 110/150 [54:50<18:59, 28.49s/epoch, loss=0.552, accuracy=0.881, val_loss=1.16, val_accuracy=0.732, lr=0.00316] 74%|███████▍  | 111/150 [55:20<18:43, 28.82s/epoch, loss=0.552, accuracy=0.882, val_loss=0.837, val_accuracy=0.791, lr=0.01]   75%|███████▍  | 112/150 [55:50<18:28, 29.17s/epoch, loss=0.554, accuracy=0.881, val_loss=0.986, val_accuracy=0.762, lr=0.01] 75%|███████▌  | 113/150 [56:21<18:20, 29.75s/epoch, loss=0.55, accuracy=0.883, val_loss=0.857, val_accuracy=0.795, lr=0.01]  76%|███████▌  | 114/150 [56:49<17:40, 29.46s/epoch, loss=0.552, accuracy=0.883, val_loss=0.706, val_accuracy=0.834, lr=0.01] 77%|███████▋  | 115/150 [57:18<17:04, 29.27s/epoch, loss=0.551, accuracy=0.883, val_loss=1.05, val_accuracy=0.73, lr=0.00316] 77%|███████▋  | 116/150 [57:48<16:37, 29.34s/epoch, loss=0.548, accuracy=0.885, val_loss=0.86, val_accuracy=0.786, lr=0.01]   78%|███████▊  | 117/150 [58:17<16:06, 29.30s/epoch, loss=0.549, accuracy=0.885, val_loss=0.971, val_accuracy=0.769, lr=0.01] 79%|███████▊  | 118/150 [58:46<15:37, 29.31s/epoch, loss=0.547, accuracy=0.886, val_loss=1.09, val_accuracy=0.73, lr=0.01]   79%|███████▉  | 119/150 [59:17<15:20, 29.71s/epoch, loss=0.551, accuracy=0.884, val_loss=0.748, val_accuracy=0.824, lr=0.01] 80%|████████  | 120/150 [59:46<14:45, 29.52s/epoch, loss=0.549, accuracy=0.883, val_loss=0.768, val_accuracy=0.818, lr=0.00316] 81%|████████  | 121/150 [1:00:15<14:13, 29.44s/epoch, loss=0.551, accuracy=0.885, val_loss=0.768, val_accuracy=0.814, lr=0.01]  81%|████████▏ | 122/150 [1:00:44<13:40, 29.30s/epoch, loss=0.472, accuracy=0.912, val_loss=0.53, val_accuracy=0.89, lr=0.001]  82%|████████▏ | 123/150 [1:01:15<13:19, 29.60s/epoch, loss=0.42, accuracy=0.928, val_loss=0.518, val_accuracy=0.893, lr=0.001] 83%|████████▎ | 124/150 [1:01:43<12:39, 29.23s/epoch, loss=0.396, accuracy=0.934, val_loss=0.498, val_accuracy=0.898, lr=0.001] 83%|████████▎ | 125/150 [1:02:12<12:06, 29.06s/epoch, loss=0.385, accuracy=0.937, val_loss=0.49, val_accuracy=0.9, lr=0.001]    84%|████████▍ | 126/150 [1:02:41<11:38, 29.10s/epoch, loss=0.37, accuracy=0.94, val_loss=0.486, val_accuracy=0.901, lr=0.001] 85%|████████▍ | 127/150 [1:03:11<11:20, 29.60s/epoch, loss=0.357, accuracy=0.942, val_loss=0.481, val_accuracy=0.902, lr=0.001] 85%|████████▌ | 128/150 [1:03:42<10:54, 29.73s/epoch, loss=0.347, accuracy=0.943, val_loss=0.475, val_accuracy=0.902, lr=0.001] 86%|████████▌ | 129/150 [1:04:11<10:24, 29.73s/epoch, loss=0.337, accuracy=0.946, val_loss=0.466, val_accuracy=0.905, lr=0.001] 87%|████████▋ | 130/150 [1:04:42<10:03, 30.17s/epoch, loss=0.327, accuracy=0.947, val_loss=0.462, val_accuracy=0.903, lr=0.001] 87%|████████▋ | 131/150 [1:05:13<09:36, 30.34s/epoch, loss=0.318, accuracy=0.949, val_loss=0.46, val_accuracy=0.905, lr=0.001]  88%|████████▊ | 132/150 [1:05:43<09:02, 30.15s/epoch, loss=0.312, accuracy=0.95, val_loss=0.467, val_accuracy=0.902, lr=0.001] 89%|████████▊ | 133/150 [1:06:14<08:36, 30.40s/epoch, loss=0.309, accuracy=0.949, val_loss=0.482, val_accuracy=0.895, lr=0.001] 89%|████████▉ | 134/150 [1:06:45<08:08, 30.53s/epoch, loss=0.297, accuracy=0.952, val_loss=0.47, val_accuracy=0.897, lr=0.001]  90%|█████████ | 135/150 [1:07:15<07:37, 30.49s/epoch, loss=0.292, accuracy=0.952, val_loss=0.466, val_accuracy=0.901, lr=0.001] 91%|█████████ | 136/150 [1:07:44<07:00, 30.03s/epoch, loss=0.286, accuracy=0.953, val_loss=0.462, val_accuracy=0.901, lr=0.000316] 91%|█████████▏| 137/150 [1:08:14<06:30, 30.06s/epoch, loss=0.279, accuracy=0.955, val_loss=0.464, val_accuracy=0.899, lr=0.001]    92%|█████████▏| 138/150 [1:08:45<06:01, 30.13s/epoch, loss=0.272, accuracy=0.957, val_loss=0.465, val_accuracy=0.9, lr=0.001]   93%|█████████▎| 139/150 [1:09:12<05:24, 29.48s/epoch, loss=0.267, accuracy=0.956, val_loss=0.451, val_accuracy=0.901, lr=0.001] 93%|█████████▎| 140/150 [1:09:42<04:54, 29.44s/epoch, loss=0.264, accuracy=0.956, val_loss=0.472, val_accuracy=0.893, lr=0.001] 94%|█████████▍| 141/150 [1:10:12<04:25, 29.55s/epoch, loss=0.258, accuracy=0.957, val_loss=0.456, val_accuracy=0.899, lr=0.001] 95%|█████████▍| 142/150 [1:10:42<03:57, 29.75s/epoch, loss=0.252, accuracy=0.959, val_loss=0.461, val_accuracy=0.894, lr=0.001] 95%|█████████▌| 143/150 [1:11:10<03:25, 29.34s/epoch, loss=0.249, accuracy=0.959, val_loss=0.465, val_accuracy=0.897, lr=0.001] 96%|█████████▌| 144/150 [1:11:40<02:56, 29.35s/epoch, loss=0.247, accuracy=0.958, val_loss=0.461, val_accuracy=0.898, lr=0.000316] 97%|█████████▋| 145/150 [1:12:07<02:23, 28.73s/epoch, loss=0.245, accuracy=0.959, val_loss=0.503, val_accuracy=0.888, lr=0.001]    97%|█████████▋| 146/150 [1:12:37<01:57, 29.25s/epoch, loss=0.241, accuracy=0.959, val_loss=0.466, val_accuracy=0.888, lr=0.001] 98%|█████████▊| 147/150 [1:13:07<01:28, 29.49s/epoch, loss=0.24, accuracy=0.959, val_loss=0.452, val_accuracy=0.898, lr=0.001]  99%|█████████▊| 148/150 [1:13:37<00:59, 29.58s/epoch, loss=0.238, accuracy=0.958, val_loss=0.484, val_accuracy=0.887, lr=0.001] 99%|█████████▉| 149/150 [1:14:05<00:28, 28.99s/epoch, loss=0.235, accuracy=0.96, val_loss=0.532, val_accuracy=0.877, lr=0.000316]100%|██████████| 150/150 [1:14:35<00:00, 29.31s/epoch, loss=0.23, accuracy=0.961, val_loss=0.477, val_accuracy=0.895, lr=0.001]   100%|██████████| 150/150 [1:14:35<00:00, 29.84s/epoch, loss=0.23, accuracy=0.961, val_loss=0.477, val_accuracy=0.895, lr=0.001]
Using real-time data augmentation.
Test loss: 0.47700512409210205
Test accuracy: 0.894599974155426


* * * Run SGD for ID = 10_9. * * *


2024-02-15 21:05:03.499780: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 21:05:10.912351: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 21:05:10.913722: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-15 21:05:10.957004: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 21:05:10.957136: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 21:05:10.960957: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 21:05:10.961037: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 21:05:10.964065: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 21:05:10.965673: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 21:05:10.968840: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 21:05:10.970950: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 21:05:10.977231: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 21:05:10.977975: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 21:05:10.978067: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 21:05:12.308453: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-15 21:05:12.309137: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 21:05:12.309686: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 21:05:12.309724: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 21:05:12.309763: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 21:05:12.309778: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 21:05:12.309793: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 21:05:12.309807: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 21:05:12.309822: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 21:05:12.309837: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 21:05:12.309852: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 21:05:12.310416: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 21:05:12.310457: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 21:05:13.030087: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-15 21:05:13.030163: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-15 21:05:13.030176: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-15 21:05:13.032016: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:3b:00.0, compute capability: 6.1)
{'id': 109, 'batch_size': 128, 'epochs': 150, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/150 [00:00<?, ?epoch/s]2024-02-15 21:05:13.852356: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-15 21:05:13.864739: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-02-15 21:05:15.954042: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 21:05:16.323690: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 21:05:17.196832: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-15 21:05:17.247327: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/150 [01:11<2:56:38, 71.13s/epoch, loss=3.17, accuracy=0.311, val_loss=2.57, val_accuracy=0.263, lr=0.1]  1%|▏         | 2/150 [01:40<1:54:36, 46.47s/epoch, loss=1.65, accuracy=0.485, val_loss=2.57, val_accuracy=0.363, lr=0.1]  2%|▏         | 3/150 [02:09<1:34:22, 38.52s/epoch, loss=1.42, accuracy=0.598, val_loss=3.1, val_accuracy=0.303, lr=0.1]   3%|▎         | 4/150 [02:39<1:25:13, 35.02s/epoch, loss=1.31, accuracy=0.667, val_loss=2.6, val_accuracy=0.414, lr=0.1]  3%|▎         | 5/150 [03:07<1:19:14, 32.79s/epoch, loss=1.27, accuracy=0.695, val_loss=1.61, val_accuracy=0.581, lr=0.1]  4%|▍         | 6/150 [03:36<1:15:14, 31.35s/epoch, loss=1.25, accuracy=0.704, val_loss=1.64, val_accuracy=0.583, lr=0.1]  5%|▍         | 7/150 [04:04<1:12:03, 30.23s/epoch, loss=1.23, accuracy=0.716, val_loss=2.18, val_accuracy=0.485, lr=0.1]  5%|▌         | 8/150 [04:32<1:09:57, 29.56s/epoch, loss=1.22, accuracy=0.721, val_loss=2.9, val_accuracy=0.449, lr=0.1]   6%|▌         | 9/150 [05:01<1:08:55, 29.33s/epoch, loss=1.2, accuracy=0.726, val_loss=1.75, val_accuracy=0.549, lr=0.1]  7%|▋         | 10/150 [05:31<1:09:00, 29.57s/epoch, loss=1.2, accuracy=0.73, val_loss=3.33, val_accuracy=0.318, lr=0.0316]  7%|▋         | 11/150 [06:01<1:08:54, 29.75s/epoch, loss=1.19, accuracy=0.732, val_loss=1.86, val_accuracy=0.533, lr=0.1]   8%|▊         | 12/150 [06:30<1:08:02, 29.58s/epoch, loss=1.19, accuracy=0.736, val_loss=2.58, val_accuracy=0.43, lr=0.1]   9%|▊         | 13/150 [07:01<1:08:03, 29.81s/epoch, loss=1.18, accuracy=0.737, val_loss=1.68, val_accuracy=0.577, lr=0.1]  9%|▉         | 14/150 [07:29<1:06:23, 29.29s/epoch, loss=1.19, accuracy=0.736, val_loss=3.3, val_accuracy=0.315, lr=0.1]  10%|█         | 15/150 [07:57<1:05:13, 28.99s/epoch, loss=1.18, accuracy=0.739, val_loss=1.64, val_accuracy=0.571, lr=0.0316] 11%|█         | 16/150 [08:27<1:05:22, 29.27s/epoch, loss=1.18, accuracy=0.741, val_loss=1.59, val_accuracy=0.601, lr=0.1]    11%|█▏        | 17/150 [08:56<1:05:03, 29.35s/epoch, loss=1.17, accuracy=0.742, val_loss=1.38, val_accuracy=0.667, lr=0.1] 12%|█▏        | 18/150 [09:27<1:05:21, 29.71s/epoch, loss=1.18, accuracy=0.742, val_loss=2.43, val_accuracy=0.43, lr=0.1]  13%|█▎        | 19/150 [09:57<1:04:43, 29.65s/epoch, loss=1.17, accuracy=0.743, val_loss=2.61, val_accuracy=0.419, lr=0.1] 13%|█▎        | 20/150 [10:25<1:03:40, 29.39s/epoch, loss=1.17, accuracy=0.744, val_loss=1.57, val_accuracy=0.579, lr=0.1] 14%|█▍        | 21/150 [10:53<1:02:15, 28.96s/epoch, loss=1.16, accuracy=0.745, val_loss=2.04, val_accuracy=0.496, lr=0.1] 15%|█▍        | 22/150 [11:24<1:02:45, 29.42s/epoch, loss=1.17, accuracy=0.745, val_loss=2.3, val_accuracy=0.388, lr=0.0316] 15%|█▌        | 23/150 [11:54<1:02:52, 29.71s/epoch, loss=1.16, accuracy=0.748, val_loss=2.22, val_accuracy=0.452, lr=0.1]   16%|█▌        | 24/150 [12:25<1:02:55, 29.96s/epoch, loss=1.16, accuracy=0.747, val_loss=1.5, val_accuracy=0.647, lr=0.1]  17%|█▋        | 25/150 [12:55<1:02:29, 30.00s/epoch, loss=1.16, accuracy=0.748, val_loss=1.63, val_accuracy=0.607, lr=0.1] 17%|█▋        | 26/150 [13:24<1:01:32, 29.78s/epoch, loss=1.16, accuracy=0.75, val_loss=5.1, val_accuracy=0.291, lr=0.1]   18%|█▊        | 27/150 [13:54<1:01:24, 29.96s/epoch, loss=1.16, accuracy=0.748, val_loss=1.66, val_accuracy=0.608, lr=0.0316] 19%|█▊        | 28/150 [14:23<1:00:17, 29.65s/epoch, loss=1.15, accuracy=0.75, val_loss=1.83, val_accuracy=0.547, lr=0.1]     19%|█▉        | 29/150 [14:52<59:18, 29.41s/epoch, loss=1.16, accuracy=0.75, val_loss=2.18, val_accuracy=0.465, lr=0.1]   20%|██        | 30/150 [15:21<58:16, 29.14s/epoch, loss=1.15, accuracy=0.752, val_loss=1.51, val_accuracy=0.635, lr=0.1] 21%|██        | 31/150 [15:50<57:37, 29.06s/epoch, loss=1.15, accuracy=0.751, val_loss=1.41, val_accuracy=0.665, lr=0.1] 21%|██▏       | 32/150 [16:18<56:40, 28.81s/epoch, loss=1.15, accuracy=0.75, val_loss=1.43, val_accuracy=0.657, lr=0.0316] 22%|██▏       | 33/150 [16:47<56:40, 29.06s/epoch, loss=1.15, accuracy=0.749, val_loss=1.62, val_accuracy=0.572, lr=0.1]   23%|██▎       | 34/150 [17:17<56:37, 29.29s/epoch, loss=1.14, accuracy=0.751, val_loss=2.05, val_accuracy=0.459, lr=0.1] 23%|██▎       | 35/150 [17:47<56:33, 29.51s/epoch, loss=1.15, accuracy=0.753, val_loss=1.93, val_accuracy=0.532, lr=0.1] 24%|██▍       | 36/150 [18:17<56:00, 29.47s/epoch, loss=1.15, accuracy=0.75, val_loss=4.17, val_accuracy=0.259, lr=0.1]  25%|██▍       | 37/150 [18:46<55:14, 29.33s/epoch, loss=1.15, accuracy=0.753, val_loss=1.74, val_accuracy=0.545, lr=0.0316] 25%|██▌       | 38/150 [19:15<54:39, 29.29s/epoch, loss=1.14, accuracy=0.754, val_loss=1.64, val_accuracy=0.601, lr=0.1]    26%|██▌       | 39/150 [19:43<53:43, 29.04s/epoch, loss=1.14, accuracy=0.754, val_loss=1.85, val_accuracy=0.522, lr=0.1] 27%|██▋       | 40/150 [20:13<53:26, 29.15s/epoch, loss=1.14, accuracy=0.754, val_loss=1.54, val_accuracy=0.621, lr=0.1] 27%|██▋       | 41/150 [20:41<52:34, 28.94s/epoch, loss=1.14, accuracy=0.754, val_loss=2.52, val_accuracy=0.304, lr=0.1] 28%|██▊       | 42/150 [21:11<52:34, 29.21s/epoch, loss=1.14, accuracy=0.75, val_loss=1.64, val_accuracy=0.567, lr=0.0316] 29%|██▊       | 43/150 [21:42<52:49, 29.62s/epoch, loss=1.13, accuracy=0.754, val_loss=1.72, val_accuracy=0.572, lr=0.1]   29%|██▉       | 44/150 [22:10<51:44, 29.28s/epoch, loss=1.15, accuracy=0.752, val_loss=1.58, val_accuracy=0.59, lr=0.1]  30%|███       | 45/150 [22:40<51:23, 29.37s/epoch, loss=1.14, accuracy=0.755, val_loss=1.83, val_accuracy=0.521, lr=0.1] 31%|███       | 46/150 [23:10<51:12, 29.54s/epoch, loss=1.14, accuracy=0.755, val_loss=2.05, val_accuracy=0.445, lr=0.1] 31%|███▏      | 47/150 [23:39<50:42, 29.54s/epoch, loss=1.14, accuracy=0.755, val_loss=2.87, val_accuracy=0.328, lr=0.0316] 32%|███▏      | 48/150 [24:09<50:19, 29.60s/epoch, loss=1.14, accuracy=0.752, val_loss=2.55, val_accuracy=0.389, lr=0.1]    33%|███▎      | 49/150 [24:38<49:27, 29.38s/epoch, loss=1.13, accuracy=0.754, val_loss=5.15, val_accuracy=0.226, lr=0.1] 33%|███▎      | 50/150 [25:08<49:14, 29.55s/epoch, loss=1.14, accuracy=0.756, val_loss=2.36, val_accuracy=0.407, lr=0.1] 34%|███▍      | 51/150 [25:38<49:20, 29.90s/epoch, loss=1.13, accuracy=0.757, val_loss=2, val_accuracy=0.52, lr=0.1]     35%|███▍      | 52/150 [26:06<47:48, 29.28s/epoch, loss=1.13, accuracy=0.758, val_loss=1.78, val_accuracy=0.542, lr=0.0316] 35%|███▌      | 53/150 [26:34<46:31, 28.78s/epoch, loss=1.13, accuracy=0.757, val_loss=3.7, val_accuracy=0.259, lr=0.1]     36%|███▌      | 54/150 [27:02<45:30, 28.44s/epoch, loss=1.13, accuracy=0.757, val_loss=1.5, val_accuracy=0.63, lr=0.1]  37%|███▋      | 55/150 [27:30<44:51, 28.33s/epoch, loss=1.13, accuracy=0.756, val_loss=1.73, val_accuracy=0.564, lr=0.1] 37%|███▋      | 56/150 [27:58<44:15, 28.25s/epoch, loss=1.13, accuracy=0.755, val_loss=1.73, val_accuracy=0.577, lr=0.1] 38%|███▊      | 57/150 [28:26<43:44, 28.22s/epoch, loss=1.13, accuracy=0.756, val_loss=2.03, val_accuracy=0.456, lr=0.0316] 39%|███▊      | 58/150 [28:56<44:04, 28.75s/epoch, loss=1.13, accuracy=0.759, val_loss=8.24, val_accuracy=0.18, lr=0.1]     39%|███▉      | 59/150 [29:26<44:02, 29.04s/epoch, loss=1.13, accuracy=0.756, val_loss=2.22, val_accuracy=0.405, lr=0.1] 40%|████      | 60/150 [29:56<44:00, 29.34s/epoch, loss=1.12, accuracy=0.758, val_loss=2.2, val_accuracy=0.477, lr=0.1]  41%|████      | 61/150 [30:25<43:29, 29.32s/epoch, loss=1.12, accuracy=0.757, val_loss=3.16, val_accuracy=0.394, lr=0.1] 41%|████▏     | 62/150 [30:55<43:28, 29.64s/epoch, loss=1.13, accuracy=0.756, val_loss=2.58, val_accuracy=0.36, lr=0.0316] 42%|████▏     | 63/150 [31:26<43:17, 29.85s/epoch, loss=1.13, accuracy=0.758, val_loss=1.4, val_accuracy=0.652, lr=0.1]    43%|████▎     | 64/150 [31:55<42:44, 29.82s/epoch, loss=1.12, accuracy=0.756, val_loss=1.44, val_accuracy=0.646, lr=0.1] 43%|████▎     | 65/150 [32:26<42:28, 29.98s/epoch, loss=1.12, accuracy=0.759, val_loss=1.77, val_accuracy=0.539, lr=0.1] 44%|████▍     | 66/150 [32:56<42:10, 30.13s/epoch, loss=1.13, accuracy=0.755, val_loss=2.01, val_accuracy=0.501, lr=0.1] 45%|████▍     | 67/150 [33:27<41:56, 30.31s/epoch, loss=1.12, accuracy=0.757, val_loss=2.18, val_accuracy=0.497, lr=0.0316] 45%|████▌     | 68/150 [33:57<41:30, 30.37s/epoch, loss=1.12, accuracy=0.759, val_loss=2.95, val_accuracy=0.428, lr=0.1]    46%|████▌     | 69/150 [34:26<40:25, 29.94s/epoch, loss=1.12, accuracy=0.757, val_loss=2.14, val_accuracy=0.507, lr=0.1] 47%|████▋     | 70/150 [34:57<40:15, 30.19s/epoch, loss=1.13, accuracy=0.755, val_loss=1.55, val_accuracy=0.602, lr=0.1] 47%|████▋     | 71/150 [35:27<39:48, 30.23s/epoch, loss=1.13, accuracy=0.758, val_loss=6.6, val_accuracy=0.152, lr=0.1]  48%|████▊     | 72/150 [35:58<39:17, 30.23s/epoch, loss=1.13, accuracy=0.755, val_loss=1.86, val_accuracy=0.518, lr=0.0316] 49%|████▊     | 73/150 [36:28<38:53, 30.30s/epoch, loss=1.12, accuracy=0.757, val_loss=1.82, val_accuracy=0.525, lr=0.1]    49%|████▉     | 74/150 [36:58<38:05, 30.08s/epoch, loss=1.12, accuracy=0.756, val_loss=2.19, val_accuracy=0.43, lr=0.1]  50%|█████     | 75/150 [37:26<37:00, 29.61s/epoch, loss=1.12, accuracy=0.757, val_loss=4.94, val_accuracy=0.251, lr=0.1] 51%|█████     | 76/150 [37:56<36:28, 29.58s/epoch, loss=1.12, accuracy=0.758, val_loss=1.95, val_accuracy=0.468, lr=0.1] 51%|█████▏    | 77/150 [38:26<36:21, 29.88s/epoch, loss=1.12, accuracy=0.758, val_loss=2.09, val_accuracy=0.407, lr=0.0316] 52%|█████▏    | 78/150 [38:56<35:53, 29.91s/epoch, loss=1.12, accuracy=0.759, val_loss=1.83, val_accuracy=0.572, lr=0.1]    53%|█████▎    | 79/150 [39:26<35:10, 29.73s/epoch, loss=1.12, accuracy=0.756, val_loss=2.01, val_accuracy=0.43, lr=0.1]  53%|█████▎    | 80/150 [39:55<34:40, 29.72s/epoch, loss=1.13, accuracy=0.756, val_loss=2.2, val_accuracy=0.503, lr=0.1] 54%|█████▍    | 81/150 [40:23<33:27, 29.10s/epoch, loss=1.13, accuracy=0.757, val_loss=1.85, val_accuracy=0.569, lr=0.1] 55%|█████▍    | 82/150 [40:50<32:27, 28.64s/epoch, loss=0.912, accuracy=0.821, val_loss=0.877, val_accuracy=0.816, lr=0.01] 55%|█████▌    | 83/150 [41:18<31:40, 28.36s/epoch, loss=0.736, accuracy=0.848, val_loss=0.819, val_accuracy=0.808, lr=0.01] 56%|█████▌    | 84/150 [41:46<31:08, 28.31s/epoch, loss=0.651, accuracy=0.856, val_loss=0.743, val_accuracy=0.82, lr=0.01]  57%|█████▋    | 85/150 [42:14<30:21, 28.02s/epoch, loss=0.606, accuracy=0.862, val_loss=0.787, val_accuracy=0.799, lr=0.01] 57%|█████▋    | 86/150 [42:44<30:28, 28.58s/epoch, loss=0.583, accuracy=0.862, val_loss=0.716, val_accuracy=0.817, lr=0.01] 58%|█████▊    | 87/150 [43:12<29:51, 28.44s/epoch, loss=0.573, accuracy=0.863, val_loss=0.802, val_accuracy=0.781, lr=0.01] 59%|█████▊    | 88/150 [43:41<29:39, 28.71s/epoch, loss=0.573, accuracy=0.863, val_loss=0.721, val_accuracy=0.811, lr=0.01] 59%|█████▉    | 89/150 [44:10<29:10, 28.70s/epoch, loss=0.563, accuracy=0.865, val_loss=0.913, val_accuracy=0.751, lr=0.01] 60%|██████    | 90/150 [44:40<29:13, 29.23s/epoch, loss=0.559, accuracy=0.868, val_loss=0.867, val_accuracy=0.771, lr=0.01] 61%|██████    | 91/150 [45:10<28:56, 29.44s/epoch, loss=0.559, accuracy=0.869, val_loss=0.688, val_accuracy=0.826, lr=0.01] 61%|██████▏   | 92/150 [45:41<28:58, 29.97s/epoch, loss=0.562, accuracy=0.869, val_loss=0.852, val_accuracy=0.783, lr=0.01] 62%|██████▏   | 93/150 [46:13<28:49, 30.34s/epoch, loss=0.555, accuracy=0.87, val_loss=1.09, val_accuracy=0.708, lr=0.01]   63%|██████▎   | 94/150 [46:44<28:33, 30.59s/epoch, loss=0.559, accuracy=0.87, val_loss=1.36, val_accuracy=0.688, lr=0.01] 63%|██████▎   | 95/150 [47:15<28:06, 30.67s/epoch, loss=0.556, accuracy=0.872, val_loss=0.726, val_accuracy=0.816, lr=0.01] 64%|██████▍   | 96/150 [47:44<27:22, 30.42s/epoch, loss=0.553, accuracy=0.875, val_loss=0.817, val_accuracy=0.79, lr=0.00316] 65%|██████▍   | 97/150 [48:15<26:58, 30.53s/epoch, loss=0.56, accuracy=0.873, val_loss=0.721, val_accuracy=0.826, lr=0.01]    65%|██████▌   | 98/150 [48:45<26:20, 30.39s/epoch, loss=0.555, accuracy=0.876, val_loss=0.868, val_accuracy=0.778, lr=0.01] 66%|██████▌   | 99/150 [49:15<25:38, 30.16s/epoch, loss=0.554, accuracy=0.876, val_loss=0.803, val_accuracy=0.806, lr=0.01] 67%|██████▋   | 100/150 [49:45<25:08, 30.17s/epoch, loss=0.552, accuracy=0.878, val_loss=1.02, val_accuracy=0.748, lr=0.01] 67%|██████▋   | 101/150 [50:16<24:53, 30.48s/epoch, loss=0.555, accuracy=0.879, val_loss=0.788, val_accuracy=0.8, lr=0.00316] 68%|██████▊   | 102/150 [50:48<24:37, 30.79s/epoch, loss=0.555, accuracy=0.878, val_loss=0.889, val_accuracy=0.784, lr=0.01]  69%|██████▊   | 103/150 [51:16<23:37, 30.15s/epoch, loss=0.554, accuracy=0.879, val_loss=0.907, val_accuracy=0.752, lr=0.01] 69%|██████▉   | 104/150 [51:47<23:12, 30.26s/epoch, loss=0.552, accuracy=0.879, val_loss=1.05, val_accuracy=0.739, lr=0.01]  70%|███████   | 105/150 [52:18<22:50, 30.46s/epoch, loss=0.552, accuracy=0.88, val_loss=0.751, val_accuracy=0.817, lr=0.01] 71%|███████   | 106/150 [52:47<22:06, 30.16s/epoch, loss=0.554, accuracy=0.88, val_loss=0.836, val_accuracy=0.798, lr=0.00316] 71%|███████▏  | 107/150 [53:17<21:28, 29.96s/epoch, loss=0.555, accuracy=0.881, val_loss=0.801, val_accuracy=0.811, lr=0.01]   72%|███████▏  | 108/150 [53:47<21:01, 30.05s/epoch, loss=0.55, accuracy=0.882, val_loss=0.698, val_accuracy=0.837, lr=0.01]  73%|███████▎  | 109/150 [54:17<20:26, 29.92s/epoch, loss=0.554, accuracy=0.881, val_loss=0.741, val_accuracy=0.822, lr=0.01] 73%|███████▎  | 110/150 [54:48<20:11, 30.29s/epoch, loss=0.55, accuracy=0.885, val_loss=0.789, val_accuracy=0.811, lr=0.01]  74%|███████▍  | 111/150 [55:19<19:49, 30.49s/epoch, loss=0.553, accuracy=0.884, val_loss=0.782, val_accuracy=0.816, lr=0.00316] 75%|███████▍  | 112/150 [55:49<19:11, 30.29s/epoch, loss=0.556, accuracy=0.882, val_loss=0.953, val_accuracy=0.768, lr=0.01]    75%|███████▌  | 113/150 [56:19<18:40, 30.28s/epoch, loss=0.555, accuracy=0.883, val_loss=0.942, val_accuracy=0.772, lr=0.01] 76%|███████▌  | 114/150 [56:49<18:11, 30.31s/epoch, loss=0.551, accuracy=0.885, val_loss=1.13, val_accuracy=0.716, lr=0.01]  77%|███████▋  | 115/150 [57:21<17:52, 30.63s/epoch, loss=0.553, accuracy=0.884, val_loss=0.993, val_accuracy=0.771, lr=0.01] 77%|███████▋  | 116/150 [57:51<17:17, 30.52s/epoch, loss=0.554, accuracy=0.884, val_loss=0.75, val_accuracy=0.816, lr=0.00316] 78%|███████▊  | 117/150 [58:22<16:50, 30.61s/epoch, loss=0.551, accuracy=0.885, val_loss=0.957, val_accuracy=0.76, lr=0.01]    79%|███████▊  | 118/150 [58:53<16:25, 30.81s/epoch, loss=0.552, accuracy=0.885, val_loss=0.923, val_accuracy=0.777, lr=0.01] 79%|███████▉  | 119/150 [59:24<15:56, 30.87s/epoch, loss=0.553, accuracy=0.885, val_loss=0.902, val_accuracy=0.772, lr=0.01] 80%|████████  | 120/150 [59:52<15:00, 30.02s/epoch, loss=0.551, accuracy=0.884, val_loss=1.02, val_accuracy=0.745, lr=0.01]  81%|████████  | 121/150 [1:00:23<14:36, 30.22s/epoch, loss=0.553, accuracy=0.885, val_loss=0.836, val_accuracy=0.801, lr=0.00316] 81%|████████▏ | 122/150 [1:00:54<14:16, 30.60s/epoch, loss=0.477, accuracy=0.911, val_loss=0.539, val_accuracy=0.893, lr=0.001]   82%|████████▏ | 123/150 [1:01:26<13:52, 30.82s/epoch, loss=0.423, accuracy=0.929, val_loss=0.521, val_accuracy=0.893, lr=0.001] 83%|████████▎ | 124/150 [1:01:57<13:23, 30.89s/epoch, loss=0.403, accuracy=0.934, val_loss=0.507, val_accuracy=0.9, lr=0.001]   83%|████████▎ | 125/150 [1:02:26<12:41, 30.47s/epoch, loss=0.384, accuracy=0.938, val_loss=0.505, val_accuracy=0.9, lr=0.001] 84%|████████▍ | 126/150 [1:02:57<12:14, 30.62s/epoch, loss=0.37, accuracy=0.941, val_loss=0.49, val_accuracy=0.902, lr=0.001] 85%|████████▍ | 127/150 [1:03:27<11:38, 30.36s/epoch, loss=0.356, accuracy=0.945, val_loss=0.495, val_accuracy=0.9, lr=0.001] 85%|████████▌ | 128/150 [1:03:57<11:05, 30.27s/epoch, loss=0.347, accuracy=0.945, val_loss=0.486, val_accuracy=0.9, lr=0.001] 86%|████████▌ | 129/150 [1:04:27<10:35, 30.25s/epoch, loss=0.339, accuracy=0.947, val_loss=0.495, val_accuracy=0.898, lr=0.001] 87%|████████▋ | 130/150 [1:04:58<10:06, 30.33s/epoch, loss=0.331, accuracy=0.947, val_loss=0.472, val_accuracy=0.903, lr=0.001] 87%|████████▋ | 131/150 [1:05:28<09:34, 30.21s/epoch, loss=0.319, accuracy=0.95, val_loss=0.485, val_accuracy=0.899, lr=0.001]  88%|████████▊ | 132/150 [1:05:57<09:00, 30.01s/epoch, loss=0.31, accuracy=0.952, val_loss=0.468, val_accuracy=0.902, lr=0.001] 89%|████████▊ | 133/150 [1:06:26<08:24, 29.65s/epoch, loss=0.304, accuracy=0.952, val_loss=0.463, val_accuracy=0.902, lr=0.001] 89%|████████▉ | 134/150 [1:06:56<07:58, 29.90s/epoch, loss=0.297, accuracy=0.953, val_loss=0.465, val_accuracy=0.902, lr=0.001] 90%|█████████ | 135/150 [1:07:27<07:31, 30.07s/epoch, loss=0.29, accuracy=0.955, val_loss=0.47, val_accuracy=0.898, lr=0.001]   91%|█████████ | 136/150 [1:07:58<07:04, 30.35s/epoch, loss=0.283, accuracy=0.956, val_loss=0.461, val_accuracy=0.9, lr=0.001] 91%|█████████▏| 137/150 [1:08:27<06:29, 29.96s/epoch, loss=0.279, accuracy=0.955, val_loss=0.46, val_accuracy=0.898, lr=0.001] 92%|█████████▏| 138/150 [1:08:57<06:01, 30.13s/epoch, loss=0.273, accuracy=0.956, val_loss=0.494, val_accuracy=0.89, lr=0.001] 93%|█████████▎| 139/150 [1:09:28<05:33, 30.34s/epoch, loss=0.266, accuracy=0.959, val_loss=0.481, val_accuracy=0.895, lr=0.001] 93%|█████████▎| 140/150 [1:09:59<05:02, 30.30s/epoch, loss=0.263, accuracy=0.957, val_loss=0.468, val_accuracy=0.895, lr=0.001] 94%|█████████▍| 141/150 [1:10:29<04:33, 30.35s/epoch, loss=0.255, accuracy=0.961, val_loss=0.472, val_accuracy=0.893, lr=0.001] 95%|█████████▍| 142/150 [1:10:59<04:03, 30.39s/epoch, loss=0.252, accuracy=0.959, val_loss=0.461, val_accuracy=0.897, lr=0.000316] 95%|█████████▌| 143/150 [1:11:31<03:34, 30.60s/epoch, loss=0.25, accuracy=0.959, val_loss=0.471, val_accuracy=0.897, lr=0.001]     96%|█████████▌| 144/150 [1:11:59<02:59, 29.83s/epoch, loss=0.244, accuracy=0.96, val_loss=0.464, val_accuracy=0.896, lr=0.001] 97%|█████████▋| 145/150 [1:12:28<02:28, 29.79s/epoch, loss=0.239, accuracy=0.961, val_loss=0.463, val_accuracy=0.897, lr=0.001] 97%|█████████▋| 146/150 [1:13:00<02:00, 30.24s/epoch, loss=0.238, accuracy=0.96, val_loss=0.496, val_accuracy=0.891, lr=0.001]  98%|█████████▊| 147/150 [1:13:30<01:30, 30.29s/epoch, loss=0.235, accuracy=0.961, val_loss=0.473, val_accuracy=0.89, lr=0.000316] 99%|█████████▊| 148/150 [1:14:01<01:01, 30.64s/epoch, loss=0.233, accuracy=0.961, val_loss=0.479, val_accuracy=0.892, lr=0.001]   99%|█████████▉| 149/150 [1:14:32<00:30, 30.53s/epoch, loss=0.231, accuracy=0.961, val_loss=0.474, val_accuracy=0.894, lr=0.001]100%|██████████| 150/150 [1:15:02<00:00, 30.43s/epoch, loss=0.231, accuracy=0.96, val_loss=0.488, val_accuracy=0.889, lr=0.001] 100%|██████████| 150/150 [1:15:02<00:00, 30.02s/epoch, loss=0.231, accuracy=0.96, val_loss=0.488, val_accuracy=0.889, lr=0.001]
Using real-time data augmentation.
Test loss: 0.48778408765792847
Test accuracy: 0.8892999887466431


* * * Run SGD for ID = 10_10. * * *


2024-02-15 22:20:19.896159: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 22:20:22.702830: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 22:20:22.704087: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-02-15 22:20:22.746777: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 22:20:22.746825: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 22:20:22.750392: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 22:20:22.750468: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 22:20:22.753303: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 22:20:22.754092: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 22:20:22.757075: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 22:20:22.758875: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 22:20:22.764720: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 22:20:22.765440: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 22:20:22.765526: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 22:20:24.042189: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-15 22:20:24.042918: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-02-15 22:20:24.043501: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA TITAN Xp computeCapability: 6.1
coreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.90GiB deviceMemoryBandwidth: 510.07GiB/s
2024-02-15 22:20:24.043538: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 22:20:24.043583: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 22:20:24.043599: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-02-15 22:20:24.043613: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-02-15 22:20:24.043628: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-02-15 22:20:24.043643: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-02-15 22:20:24.043667: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-02-15 22:20:24.043682: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 22:20:24.045328: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-02-15 22:20:24.045373: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2024-02-15 22:20:24.738369: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-02-15 22:20:24.738462: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-02-15 22:20:24.738475: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-02-15 22:20:24.740337: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11217 MB memory) -> physical GPU (device: 0, name: NVIDIA TITAN Xp, pci bus id: 0000:3b:00.0, compute capability: 6.1)
{'id': 1010, 'batch_size': 128, 'epochs': 150, 'validation_split': 0.0, 'checkpointing': False, 'data_augmentation': True, 'augm_shift': 4, 'initial_lr': 0.1, 'l2_reg': 0.002, 'optimizer': 'sgd', 'momentum': 0.9, 'nesterov': True, 'model': 'ResNet20v1', 'tf_version': '2.4.1', 'keras_version': '2.4.3', 'GPU': 'NVIDIA TITAN Xp'}
Using test set as validation set
x_train shape: (50000, 32, 32, 3)
50000 train samples
10000 validation samples
10000 test samples
y_train shape: (50000, 1)
ResNet20v1
0epoch [00:00, ?epoch/s]  0%|          | 0/150 [00:00<?, ?epoch/s]2024-02-15 22:20:25.577856: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2024-02-15 22:20:25.589742: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-02-15 22:20:27.818649: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-02-15 22:20:28.179671: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2024-02-15 22:20:29.079318: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-02-15 22:20:29.135744: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
  1%|          | 1/150 [01:07<2:48:02, 67.67s/epoch, loss=3.16, accuracy=0.307, val_loss=2.8, val_accuracy=0.15, lr=0.1]  1%|▏         | 2/150 [01:36<1:49:55, 44.56s/epoch, loss=1.53, accuracy=0.549, val_loss=2.03, val_accuracy=0.396, lr=0.1]  2%|▏         | 3/150 [02:03<1:30:30, 36.94s/epoch, loss=1.35, accuracy=0.641, val_loss=2.01, val_accuracy=0.44, lr=0.1]   3%|▎         | 4/150 [02:32<1:22:07, 33.75s/epoch, loss=1.27, accuracy=0.685, val_loss=2.18, val_accuracy=0.44, lr=0.1]  3%|▎         | 5/150 [03:01<1:17:11, 31.94s/epoch, loss=1.26, accuracy=0.697, val_loss=1.76, val_accuracy=0.539, lr=0.1]  4%|▍         | 6/150 [03:32<1:15:54, 31.63s/epoch, loss=1.23, accuracy=0.708, val_loss=1.87, val_accuracy=0.512, lr=0.1]  5%|▍         | 7/150 [04:01<1:13:29, 30.83s/epoch, loss=1.22, accuracy=0.719, val_loss=1.49, val_accuracy=0.629, lr=0.1]  5%|▌         | 8/150 [04:31<1:12:29, 30.63s/epoch, loss=1.21, accuracy=0.719, val_loss=2.06, val_accuracy=0.444, lr=0.1]  6%|▌         | 9/150 [05:01<1:11:02, 30.23s/epoch, loss=1.2, accuracy=0.724, val_loss=4.25, val_accuracy=0.339, lr=0.1] 